* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51******************************************************************
    52 ENVIRONMENT DIVISION.
    53
    54 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page   3
* EL050.cbl
    56 WORKING-STORAGE SECTION.
    57 01  DFH-START PIC X(04).
    58
    59 77  FILLER   PIC X(32) VALUE '********************************'.
    60 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    61 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    62
    63 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    64 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    65                                   USAGE POINTER.
    66 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    67 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    69                                   USAGE IS POINTER.
    70 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    72                                   USAGE IS POINTER.
    73 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    75                                   USAGE IS POINTER.
    76
    77 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    79                                   USAGE IS POINTER.
    80
    81*    COPY ELC50WS.
    82*****************************************************************
    83*                                                               *
    84*                            ELC50WS.                           *
    85*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    86*                            VMOD=2.061.                        *
    87*                                                               *
    88*   THIS IS THE WORKING STORAGE FOR EL050                       *
    89*                                   EL517                       *
    90*****************************************************************
    91******************************************************************
    92*                   C H A N G E   L O G
    93*
    94* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    95*-----------------------------------------------------------------
    96*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    97* EFFECTIVE    NUMBER
    98*-----------------------------------------------------------------
    99* 123102                   PEMA  ADD DCC PROCESSING
   100* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   101* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   102* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   103* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   104* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   105* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   106* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   107* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   108* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   109* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   110* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   111* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   112* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   113* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page   4
* EL050.cbl
   114* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   115* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   116* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   117* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   118* 030309  CR2009021700001  PEMA  ADD ER-2883
   119* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   120* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   121* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   122* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   123* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   124* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   125* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   126* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   127* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   128* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   129* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   130* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   131* 061412  CR2011022800001  AJRA  NAPERSOFT
   132* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   133* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   134* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   135* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   136* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   137* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   138* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   139* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   140* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   141*-----------------------------------------------------------------
   142
   143 01  WORK-AREAS.
   144
   145*****************************************************************
   146*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   147*****************************************************************
   148
   149     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   150     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   151     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   152     12  WS-NAME-EDIT-WORK-AREA.
   153         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   154         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   155             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   156         16  WS-WORK-NAME.
   157             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   158             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   159             20  FILLER           PIC X(10)     VALUE SPACES.
   160         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   161             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   162
   163*****************************************************************
   164*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   165*****************************************************************
   166
   167     12  WS-ERRESC-KEY.
   168         16 WS-ERRESC-SEARCH-KEY.
   169             20  WS-ERRESC-COMPANY-CD PIC  X.
   170             20  WS-ERRESC-CARRIER    PIC  X.
   171             20  WS-ERRESC-GROUP      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page   5
* EL050.cbl
   172             20  WS-ERRESC-STATE      PIC XX.
   173             20  WS-ERRESC-ACCOUNT    PIC X(10).
   174         16 WS-ERRESC-RESIDUAL-KEY.
   175             20  WS-ERRESC-AGENT      PIC X(10).
   176             20  WS-ERRESC-RES-STATE  PIC XX.
   177             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   178*                                          YYYYMMDD
   179     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   180     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   181
   182*RESIDENT STATE TAX MASTER(ERRESS)
   183*
   184     12  WS-ERRESS-KEY.
   185         16  WS-ERRESS-COMPANY-CD      PIC  X.
   186         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   187         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   188         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   189*                                          YYYYMMDD
   190
   191     12  WS-CONTRACT-DATE              PIC 9(8).
   192*                                          YYYYMMDD
   193     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   194     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   195         16 WS-YEAR-YY                 PIC   9999.
   196         16 FILLER                     PIC 9(4).
   197*                                          YYYYMMDD
   198     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   199     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   200     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   201     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   202
   203     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   204         88  DPRB-1ST-TIME                      VALUE ' '.
   205
   206*****************************************************************
   207*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   208*****************************************************************
   209
   210     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   211     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   212     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   213     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   214     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   215     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   216     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   217     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   218     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   219     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   220     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   221         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   222         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   223     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   224         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   225         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   226     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   227
   228     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   229     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page   6
* EL050.cbl
   230
   231     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   232     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   237     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   238     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   243     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   244     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   245     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   246     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   262     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   263     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   264     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   267     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   268     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   269     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   270     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   271     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   272     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   273     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   274     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   275     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   279     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   280     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   281     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   282     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   283     12  WS-2671-SW               PIC X         VALUE SPACE.
   284     12  WS-2672-SW               PIC X         VALUE SPACE.
   285     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   286         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   287     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page   7
* EL050.cbl
   288         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   289     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   290
   291     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   292         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   293         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   294         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   295         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   296
   297     12  WS-CREDIT-EDIT-CONTROLS.
   298         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   299         16  WS-MIN-AGE           PIC 99                VALUE  0.
   300         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   301         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   302         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   303         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   304
   305     12  WS-AGE-FIELDS.
   306         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   307         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   308         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   309         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   310
   311     12  WS-SAVE-ALLOWABLE-BENEFIT.
   312         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   313         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   314         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   315         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   316         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   317         16  FILLER                      PIC XX.
   318
   319     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   320     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   321     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   322     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   323     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   324     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   325     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   326     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   327     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   328     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   329
   330     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   331     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   332     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   333     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   334     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   335     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   336     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   337     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   338         88  WS-REDUCING              VALUE 'R'.
   339         88  WS-LEVEL                 VALUE 'L' 'P'.
   340     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   341
   342     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   343     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   344     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   345     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page   8
* EL050.cbl
   346     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   347     12  ws-ah-max-bens           pic 99        value zeros.
   348     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   349     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   350     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   351     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   352
   353     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   354     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   355     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   356     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   357     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   358     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   359     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   360     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   361     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   362     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   363     12  WS-ACCT-SIG-SW.
   364         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   365         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   366     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   367     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   368     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   369     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   370     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   371     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   372     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   373     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   374     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  WS-INITIALS.
   376         16  WS-INIT-1            PIC X         VALUE SPACES.
   377         16  WS-INIT-2            PIC X         VALUE SPACES.
   378
   379     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   380     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   381     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   382     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   383     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   384*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   385     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   386     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   387     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   388     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   389     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   390     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   391     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   392     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   393     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   395     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   396     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   397     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   398     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   399     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   400     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   401     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   402     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   403     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page   9
* EL050.cbl
   404     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   405     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   406     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   407******** FLA
   408     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   409     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   410     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   411     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   412     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   413********
   414     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   415     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   416     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   417     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   418     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   419     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   420     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   421     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   422     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   423     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   424
   425     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   426         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   427                                         '0' THRU '9'.
   428
   429     12  NUMBER-OF-MONTHS.
   430         16  SK-MO OCCURS 12 TIMES PIC X.
   431
   432     12  WS-WORK-DATE.
   433         16  WS-YEAR            PIC 99    VALUE 00.
   434         16  WS-MONTH           PIC 99    VALUE 00.
   435         16  WS-DAY             PIC 99    VALUE 00.
   436
   437     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   438     12  WS-WORK-CRIT-DEV       REDEFINES
   439         WS-WORK-LF-CRIT-PER    PIC X(03).
   440
   441     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   442     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   443
   444     12  WS-WORK-DATE-FROM.
   445         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   446         16  FILLER             PIC X  VALUE SPACE.
   447         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   448         16  FILLER             PIC X         VALUE SPACE.
   449         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   450
   451     12  WS-WORK-DATE-THRU.
   452         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   453         16  FILLER             PIC X         VALUE SPACE.
   454         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   455         16  FILLER             PIC X         VALUE SPACE.
   456         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   457
   458     12  WS-LF-INPUT-CD.
   459         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   460         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   461
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  10
* EL050.cbl
   462     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   463     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   464         16  WS-AH-INPUT-CD-1   PIC X.
   465         16  WS-AH-INPUT-CD-2-3 PIC XX.
   466
   467     12  WS-SWITCHES.
   468         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   469         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   470             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   471         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   472             88  BANK-ACCT-FOUND          VALUE 'Y'.
   473         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   474             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   475         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   476             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   477         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   478             88  COMP-MASTER-FOUND        VALUE 'Y'.
   479         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   480             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   481         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   482             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   483         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   484             88  STAT-MASTER-FOUND        VALUE 'Y'.
   485         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   486             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   487         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   488             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   489         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   490             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   491         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   492             88  FORM-MASTER-FOUND        VALUE 'Y'.
   493         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   494             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   495         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   496             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   497         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   498             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   499         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   500             88  NO-BENEFIT-FOUND         VALUE 'N'.
   501         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   502             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   503         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   504             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   505         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   506             88  AH-BENEFIT-FOUND         VALUE ' '.
   507             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   508         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   509             88  LF-BENEFIT-FOUND         VALUE ' '.
   510             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   511         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   512             88  NO-STATE-RECORD          VALUE '1'.
   513         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   514             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   515         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   516             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   517         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   518             88  CERT-WAS-FOUND           VALUE ' '.
   519             88  CERT-WAS-NOT-FOUND       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  11
* EL050.cbl
   520         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   521             88  BROWSE-STARTED           VALUE 'Y'.
   522         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   523             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   524         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   525             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   526         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   527             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   528         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   529             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   530         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   531             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   532         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   533             88  APP-CERT-USED            VALUE 'Y' 'A'.
   534         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   535             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   536             88  FIRST-TIME-THROUGH       VALUE '1'.
   537             88  CTBL-NOT-FOUND           VALUE '2'.
   538
   539         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   540             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   541
   542         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   543             88  DLO-ERROR-FOUND          VALUE 'Y'.
   544
   545********FLA
   546     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   547     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   548********
   549     12  RC-SW-1                  PIC X           VALUE '0'.
   550     12  RC-SW-2                  PIC X           VALUE '0'.
   551     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   552     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   553     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   554     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   555     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   556     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   557     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   558     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   559     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   560     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   561     12  LIT-SPACES               PIC X           VALUE SPACES.
   562     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   563     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   564     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   565     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   566     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   567     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   568     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   569         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   570         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   571     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   572         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   573
   574 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   575     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   576     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   577 01  WS-CRI-SSN-WORK-AREA.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  12
* EL050.cbl
   578     05  WS-CRI-SOC-SEC-NO.
   579         10  WS-SS-REPT-CD       PIC X(5).
   580         10  WS-SS-LAST-NAME     PIC X(5).
   581         10  WS-SS-INITIAL       PIC X.
   582
   583     05  WS-CRI-REPORT-CODE.
   584         10  FILLER              PIC X(5).
   585         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   586
   587     05  WS-CRI-LAST-NAME.
   588         10  WS-CRI-NAME-MOVE    PIC X(5).
   589         10  FILLER              PIC X(10).
   590
   591 01  WS-NUM-TABLE                PIC X(26)  VALUE
   592     '12345678012345070923456789'.
   593 01  FILLER REDEFINES WS-NUM-TABLE.
   594     05  WS-NUM OCCURS 26        PIC 9.
   595 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   596 01  V1                          PIC S999 COMP-3.
   597 01  V2                          PIC S999 COMP-3.
   598 01  V3                          PIC S999 COMP-3.
   599 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   600 01  FILLER REDEFINES WS-WORK-VIN.
   601     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   602 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   603 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   604 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   605 01  WS-HEX-WORK.
   606     05  FILLER                  PIC X  VALUE LOW-VALUES.
   607     05  WS-HEX-BYTE             PIC X.
   608 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   609 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   610 01  WS-WORK-HIN-ROW-B.
   611     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   612
   613 01  ws-benefit-cd-chg-sw      pic x value spaces.
   614     88  benefit-code-chg           value 'Y'.
   615 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   616 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   617     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   618 01  WS-ROW-D-TABLE.
   619     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   620
   621 01  WS-HIN-TABLE-B.
   622     05  F                       PIC XX VALUE 'A2'.
   623     05  F                       PIC XX VALUE 'B3'.
   624     05  F                       PIC XX VALUE 'C4'.
   625     05  F                       PIC XX VALUE 'D5'.
   626     05  F                       PIC XX VALUE 'E6'.
   627     05  F                       PIC XX VALUE 'F7'.
   628     05  F                       PIC XX VALUE 'G8'.
   629     05  F                       PIC XX VALUE 'H9'.
   630     05  F                       PIC XX VALUE 'I1'.
   631     05  F                       PIC XX VALUE 'J2'.
   632     05  F                       PIC XX VALUE 'K3'.
   633     05  F                       PIC XX VALUE 'L4'.
   634     05  F                       PIC XX VALUE 'M5'.
   635     05  F                       PIC XX VALUE 'N6'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  13
* EL050.cbl
   636     05  F                       PIC XX VALUE 'O0'.
   637     05  F                       PIC XX VALUE 'P7'.
   638     05  F                       PIC XX VALUE 'Q0'.
   639     05  F                       PIC XX VALUE 'R8'.
   640     05  F                       PIC XX VALUE 'S9'.
   641     05  F                       PIC XX VALUE 'T2'.
   642     05  F                       PIC XX VALUE 'U3'.
   643     05  F                       PIC XX VALUE 'V4'.
   644     05  F                       PIC XX VALUE 'W5'.
   645     05  F                       PIC XX VALUE 'X6'.
   646     05  F                       PIC XX VALUE 'Y7'.
   647     05  F                       PIC XX VALUE 'Z8'.
   648 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   649     05  WS-VAL-IN               PIC X.
   650     05  WS-VAL-OUT              PIC 9.
   651 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   652 01  WS-COMPARE-BINARY-DATES.
   653     05  WS-971231                PIC XX VALUE X'92FF'.
   654     05  WS-931231                PIC XX VALUE X'8CFF'.
   655     05  WS-791231                PIC XX VALUE X'77FF'.
   656     05  WS-771001                PIC XX VALUE X'74A1'.
   657     05  WS-820301                PIC XX VALUE X'7B41'.
   658     05  WS-831031                PIC XX VALUE X'7DBF'.
   659     05  WS-831231                PIC XX VALUE X'7DFF'.
   660     05  WS-810831                PIC XX VALUE X'7A7F'.
   661     05  WS-830901                PIC XX VALUE X'7D81'.
   662
   663 01  FILE-ACCESS-IDS.
   664     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   665     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   666     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   667     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   668     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   669     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   670     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   671     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   672     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   673     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   674     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   675     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   676     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   677     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   678     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   679     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   680     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   681 01  DD-IU-SW                    PIC X   VALUE ' '.
   682     88  DD-IU-PRESENT                 VALUE 'Y'.
   683
   684 01  ACCESS-KEYS.
   685     12  ELMSTR-KEY.
   686         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   687         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   688     12  W-CLAIM-KEY.
   689         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   690         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   691
   692     12  ELCNTL-KEY.
   693         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  14
* EL050.cbl
   694         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   695         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   696         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   697
   698     12  ELCERT-KEY.
   699         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  CERT-CARRIER         PIC X       VALUE SPACE.
   701         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   702         16  CERT-STATE           PIC XX      VALUE SPACES.
   703         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   704         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   705         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   706
   707     12  ELCERT2-KEY.
   708         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   709         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   710
   711     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   712
   713     12  ELCERT-SAVE.
   714         16  FILLER                      PIC XX    VALUE SPACES.
   715
   716         16  WCS-CONTROL-PRIMARY.
   717             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   718             20  WCS-CARRIER             PIC X     VALUE SPACE.
   719             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   720             20  WCS-STATE               PIC XX    VALUE SPACES.
   721             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   722             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   723             20  WCS-CERT-NO.
   724                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   725                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   726
   727         16  CS-CONTROL-BY-NAME.
   728             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   729             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   730             20  CS-INSURED-INITIALS.
   731                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   732                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   733
   734         16  CS-CONTROL-BY-SSN.
   735             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   736             20  CS-SOC-SEC-NO.
   737                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   738                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   739                 24  CS-SSN-LN3.
   740                     28 CS-INSURED-INITIALS-A2   PIC XX
   741                                     VALUE SPACES.
   742                     28 CS-PART-LAST-NAME-A2     PIC X
   743                                     VALUE SPACE.
   744
   745         16  CS-CONTROL-BY-CERT-NO.
   746             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   747             20  CS-CERT-NO-A4           PIC X(11)
   748                                     VALUE SPACES.
   749
   750         16  CS-CONTROL-BY-MEMB.
   751             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  15
* EL050.cbl
   752             20  CS-MEMBER-NO.
   753                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   754                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   755                 24  CS-MEMB-LN4.
   756                     28 CS-INSURED-INITIALS-A5   PIC XX
   757                                      VALUE SPACES.
   758                     28 CS-PART-LAST-NAME-A5     PIC XX
   759                                      VALUE SPACES.
   760
   761         16  FILLER              PIC X(360) VALUE SPACES.
   762
   763     12  ERACCT-KEY.
   764         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   765         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   766         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   767         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   768         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   769         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   770
   771     12  ERCOMP-KEY.
   772         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   773         16  COMP-CARRIER         PIC X     VALUE SPACES.
   774         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   775         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   776         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   777         16  COMP-TYPE            PIC X     VALUE SPACES.
   778
   779     12  ERLOFC-KEY.
   780         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   782         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   783         16  LOFC-STATE           PIC XX    VALUE SPACES.
   784         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   785         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   786
   787     12  WS-ELCRTT-KEY.
   788         16  WS-ELCRTT-PRIMARY       PIC X(33).
   789         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   790
   791     12  ERBXRF-KEY.
   792         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   793         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   794         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   795         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   796
   797     12  ERAGTC-KEY.
   798         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   799         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   800         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   801         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   802         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   803         16  AGTC-TYPE            PIC X     VALUE SPACES.
   804
   805     12  ERPLAN-KEY.
   806         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   807         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   808         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   809         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  16
* EL050.cbl
   810         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   811         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   812         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   813         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   814
   815     12  ERFORM-KEY.
   816         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   817         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   818         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   819         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   820
   821     12  ERREIN-KEY.
   822         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   823         16  REIN-TYPE            PIC X     VALUE SPACES.
   824         16  REIN-TABLE-CO.
   825             20  REIN-CODE-1      PIC X     VALUE SPACE.
   826             20  REIN-CODE-2      PIC X     VALUE SPACE.
   827             20  REIN-CODE-3      PIC X     VALUE SPACE.
   828         16  FILLER               PIC X(3)  VALUE SPACES.
   829
   830     12  ERCTBL-KEY.
   831         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   832         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   833         16  CTBL-CNTRL-2.
   834             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   835             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   836
   837     12  ELCRTO-KEY.
   838         16  ELCRTO-COMPANY-CD       PIC X.
   839         16  ELCRTO-CARRIER          PIC X.
   840         16  ELCRTO-GROUPING         PIC X(6).
   841         16  ELCRTO-STATE            PIC XX.
   842         16  ELCRTO-ACCOUNT          PIC X(10).
   843         16  ELCRTO-CERT-EFF-DT      PIC XX.
   844         16  ELCRTO-CERT-NO.
   845             20  ELCRTO-CERT-PRIME   PIC X(10).
   846             20  ELCRTO-CERT-SFX     PIC X.
   847         16  ELCRTO-RECORD-TYPE      PIC X.
   848         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   849
   850
   851     12  WS-ACCESS.
   852         16  FILLER               PIC XX    VALUE SPACES.
   853         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   854
   855     12  WS-CARR-ACCESS.
   856         16  FILLER               PIC X(3)  VALUE SPACES.
   857         16  WS-CARR              PIC X     VALUE SPACE.
   858*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   859*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   860     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   861         88  WS-DMD-LF-RATING   VALUE 'Y'.
   862         88  WS-DMD-AH-RATING   VALUE 'Y'.
   863         88  WS-DMD-NO-RATING   VALUE 'N'.
   864
   865     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   866         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   867                                         'NJ' 'NL'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  17
* EL050.cbl
   868                                         'PJ' 'PL'
   869                                         'SJ' 'SL'.
   870     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   871         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   872                                         'NI' 'NJ' 'NL' 'NU'
   873                                         'PJ' 'PL' 'PI' 'PU'
   874                                         'SI' 'SJ' 'SL' 'SU'
   875                                         'MX' 'MY' 'MZ'.
   876 01  ERPDEF-KEY-SAVE             PIC X(18).
   877 01  ERPDEF-KEY.
   878     12  ERPDEF-COMPANY-CD       PIC X.
   879     12  ERPDEF-STATE            PIC XX.
   880     12  ERPDEF-PROD-CD          PIC XXX.
   881     12  F                       PIC X(7).
   882     12  ERPDEF-BEN-TYPE         PIC X.
   883     12  ERPDEF-BEN-CODE         PIC XX.
   884     12  ERPDEF-EXP-DT           PIC XX.
   885
   886 01  ELSTAT-KEY-SAVE             PIC X(20).
   887 01  ELSTAT-KEY.
   888     12  ELSTAT-COMPANY-ID       PIC XXX.
   889     12  ELSTAT-CARRIER          PIC X.
   890     12  ELSTAT-GROUP            PIC X(6).
   891     12  ELSTAT-STATE            PIC XX.
   892     12  ELSTAT-EXP-DT           PIC 9(8).
   893 01  WS-ERROR-VALUES.
   894     12  ER-1570                     PIC S9(4)   VALUE +1570.
   895     12  ER-1571                     PIC S9(4)   VALUE +1571.
   896     12  er-1572                     pic s9(4)   value +1572.
   897     12  er-1573                     pic s9(4)   value +1573.
   898     12  er-1574                     pic s9(4)   value +1574.
   899     12  ER-1575                     PIC S9(4)   VALUE +1575.
   900     12  er-1576                     pic s9(4)   value +1576.
   901     12  ER-1891                     PIC S9(4)   VALUE +1891.
   902     12  ER-1892                     PIC S9(4)   VALUE +1892.
   903     12  ER-1893                     PIC S9(4)   VALUE +1893.
   904     12  ER-1894                     PIC S9(4)   VALUE +1894.
   905     12  ER-1895                     PIC S9(4)   VALUE +1895.
   906     12  ER-1896                     PIC S9(4)   VALUE +1896.
   907     12  ER-1897                     PIC S9(4)   VALUE +1897.
   908     12  ER-1898                     PIC S9(4)   VALUE +1898.
   909     12  ER-1899                     PIC S9(4)   VALUE +1899.
   910     12  ER-1900                     PIC S9(4)   VALUE +1900.
   911     12  ER-1901                     PIC S9(4)   VALUE +1901.
   912     12  ER-1902                     PIC S9(4)   VALUE +1902.
   913     12  ER-1903                     PIC S9(4)   VALUE +1903.
   914     12  ER-1904                     PIC S9(4)   VALUE +1904.
   915     12  ER-1905                     PIC S9(4)   VALUE +1905.
   916     12  ER-1906                     PIC S9(4)   VALUE +1906.
   917     12  ER-1907                     PIC S9(4)   VALUE +1907.
   918     12  ER-1909                     PIC S9(4)   VALUE +1909.
   919     12  ER-1910                     PIC S9(4)   VALUE +1910.
   920     12  ER-1911                     PIC S9(4)   VALUE +1911.
   921     12  ER-1912                     PIC S9(4)   VALUE +1912.
   922     12  ER-1913                     PIC S9(4)   VALUE +1913.
   923     12  ER-1914                     PIC S9(4)   VALUE +1914.
   924     12  ER-1915                     PIC S9(4)   VALUE +1915.
   925     12  ER-1916                     PIC S9(4)   VALUE +1916.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  18
* EL050.cbl
   926     12  ER-1917                     PIC S9(4)   VALUE +1917.
   927     12  ER-1918                     PIC S9(4)   VALUE +1918.
   928     12  ER-1919                     PIC S9(4)   VALUE +1919.
   929     12  ER-1920                     PIC S9(4)   VALUE +1920.
   930     12  ER-1921                     PIC S9(4)   VALUE +1921.
   931     12  ER-1922                     PIC S9(4)   VALUE +1922.
   932     12  ER-1923                     PIC S9(4)   VALUE +1923.
   933     12  ER-1924                     PIC S9(4)   VALUE +1924.
   934     12  ER-1925                     PIC S9(4)   VALUE +1925.
   935     12  ER-1926                     PIC S9(4)   VALUE +1926.
   936     12  ER-1927                     PIC S9(4)   VALUE +1927.
   937     12  ER-2393                     PIC S9(4)   VALUE +2393.
   938     12  ER-2600                     PIC S9(4)   VALUE +2600.
   939     12  ER-2601                     PIC S9(4)   VALUE +2601.
   940     12  ER-2602                     PIC S9(4)   VALUE +2602.
   941     12  ER-2603                     PIC S9(4)   VALUE +2603.
   942     12  ER-2604                     PIC S9(4)   VALUE +2604.
   943     12  ER-2605                     PIC S9(4)   VALUE +2605.
   944     12  ER-2606                     PIC S9(4)   VALUE +2606.
   945     12  ER-2607                     PIC S9(4)   VALUE +2607.
   946     12  ER-2608                     PIC S9(4)   VALUE +2608.
   947     12  ER-2609                     PIC S9(4)   VALUE +2609.
   948     12  ER-2610                     PIC S9(4)   VALUE +2610.
   949     12  ER-2611                     PIC S9(4)   VALUE +2611.
   950     12  ER-2612                     PIC S9(4)   VALUE +2612.
   951     12  ER-2613                     PIC S9(4)   VALUE +2613.
   952     12  ER-2614                     PIC S9(4)   VALUE +2614.
   953     12  ER-2615                     PIC S9(4)   VALUE +2615.
   954     12  ER-2616                     PIC S9(4)   VALUE +2616.
   955     12  ER-2617                     PIC S9(4)   VALUE +2617.
   956     12  ER-2618                     PIC S9(4)   VALUE +2618.
   957     12  ER-2619                     PIC S9(4)   VALUE +2619.
   958     12  ER-2620                     PIC S9(4)   VALUE +2620.
   959     12  ER-2621                     PIC S9(4)   VALUE +2621.
   960     12  ER-2622                     PIC S9(4)   VALUE +2622.
   961     12  ER-2623                     PIC S9(4)   VALUE +2623.
   962     12  ER-2624                     PIC S9(4)   VALUE +2624.
   963     12  ER-2625                     PIC S9(4)   VALUE +2625.
   964     12  ER-2626                     PIC S9(4)   VALUE +2626.
   965     12  ER-2627                     PIC S9(4)   VALUE +2627.
   966     12  ER-2628                     PIC S9(4)   VALUE +2628.
   967     12  ER-2629                     PIC S9(4)   VALUE +2629.
   968     12  ER-2630                     PIC S9(4)   VALUE +2630.
   969     12  ER-2631                     PIC S9(4)   VALUE +2631.
   970     12  ER-2632                     PIC S9(4)   VALUE +2632.
   971     12  ER-2633                     PIC S9(4)   VALUE +2633.
   972     12  ER-2634                     PIC S9(4)   VALUE +2634.
   973     12  ER-2635                     PIC S9(4)   VALUE +2635.
   974     12  ER-2636                     PIC S9(4)   VALUE +2636.
   975     12  ER-2637                     PIC S9(4)   VALUE +2637.
   976     12  ER-2638                     PIC S9(4)   VALUE +2638.
   977     12  ER-2639                     PIC S9(4)   VALUE +2639.
   978     12  ER-2640                     PIC S9(4)   VALUE +2640.
   979     12  ER-2641                     PIC S9(4)   VALUE +2641.
   980     12  ER-2642                     PIC S9(4)   VALUE +2642.
   981     12  ER-2643                     PIC S9(4)   VALUE +2643.
   982     12  ER-2644                     PIC S9(4)   VALUE +2644.
   983     12  ER-2645                     PIC S9(4)   VALUE +2645.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  19
* EL050.cbl
   984     12  ER-2646                     PIC S9(4)   VALUE +2646.
   985     12  ER-2647                     PIC S9(4)   VALUE +2647.
   986     12  ER-2648                     PIC S9(4)   VALUE +2648.
   987     12  ER-2649                     PIC S9(4)   VALUE +2649.
   988     12  ER-2650                     PIC S9(4)   VALUE +2650.
   989     12  ER-2651                     PIC S9(4)   VALUE +2651.
   990     12  ER-2652                     PIC S9(4)   VALUE +2652.
   991     12  ER-2653                     PIC S9(4)   VALUE +2653.
   992     12  ER-2654                     PIC S9(4)   VALUE +2654.
   993     12  ER-2655                     PIC S9(4)   VALUE +2655.
   994     12  ER-2656                     PIC S9(4)   VALUE +2656.
   995     12  ER-2657                     PIC S9(4)   VALUE +2657.
   996     12  ER-2658                     PIC S9(4)   VALUE +2658.
   997     12  ER-2659                     PIC S9(4)   VALUE +2659.
   998     12  ER-2660                     PIC S9(4)   VALUE +2660.
   999     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1000     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1001     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1002     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1003     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1004     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1005     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1006     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1007     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1008     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1009     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1010     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1011     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1012     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1013     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1014     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1015     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1016     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1017     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1018     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1019     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1020     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1021     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1022     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1023     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1024     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1025     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1026     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1027     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1028     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1029     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1030     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1031     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1032     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1033     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1034     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1035     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1036     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1037     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1038     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1039     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1040     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1041     12  ER-2703                     PIC S9(4)   VALUE +2703.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  20
* EL050.cbl
  1042     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1043     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1044     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1045     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1046     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1047     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1048     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1049     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1050     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1051     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1052     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1053     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1054     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1055     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1056     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1057     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1058     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1059     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1060     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1061     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1062     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1063     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1064     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1065     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1066     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1067     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1068     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1069     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1070     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1071     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1072     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1073     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1074     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1075     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1076     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1077     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1078     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1079     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1080     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1081     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1082     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1083     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1084     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1085     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1086     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1087     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1088     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1089     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1090     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1091     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1092     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1093     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1094     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1095     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1096     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1097     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1098     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1099     12  ER-2771                     PIC S9(4)   VALUE +2771.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  21
* EL050.cbl
  1100     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1101     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1102     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1103     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1104     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1105     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1106     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1107     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1108     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1109     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1110     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1111     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1112     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1113     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1114     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1115     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1116     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1117     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1118     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1119     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1120     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1121     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1122     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1123     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1124     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1125     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1126     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1127     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1128     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1129     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1130     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1131     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1132     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1133     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1134     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1135     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1136     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1137     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1138     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1139     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1140     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1141     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1142     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1143     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1144     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1145     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1146     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1147     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1148     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1149     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1150     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1151     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1152     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1153     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1154     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1155     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1156     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1157     12  ER-3843                     PIC S9(4)   VALUE +3843.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  22
* EL050.cbl
  1158     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1159     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1160     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1161     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1162     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1163     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1164     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1165     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1166     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1167     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1168     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1169     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1170     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1171     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1172     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1173     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1174     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1175     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1176     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1177     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1178     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1179     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1180     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1181     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1182     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1183     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1184     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1185     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1186     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1187     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1188     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1189     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1190     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1191     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1192     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1193     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1194     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1195     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1196     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1197     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1198     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1199     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1200     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1201     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1202     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1203     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1204     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1205     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1206     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1207     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1208     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1209     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1210     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1211     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1212     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1213     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1214     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1215     12  ER-8109                     PIC S9(4)   VALUE +8109.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  23
* EL050.cbl
  1216     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1217     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1218     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1219     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1220     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1221     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1222     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1223     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1224     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1225     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1226     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1227     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1228     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1229     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1230     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1231     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1232     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1233     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1234     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1235     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1236     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1237     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1238     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1239     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1240     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1241     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1242******************************************************************
  1243***************   END OF ELC50WS     ****************************
  1244******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  24
* EL050.cbl
  1247 01  WORKING-STORAGE-WORK-AREAS.
  1248     12  WS-RESPONSE             PIC S9(8)  COMP.
  1249         88  WS-RESP-NORMAL           VALUE +00.
  1250         88  WS-RESP-ERROR            VALUE +01.
  1251         88  WS-RESP-NOTFND           VALUE +13.
  1252         88  WS-RESP-DUPREC           VALUE +14.
  1253         88  WS-RESP-ENDFILE          VALUE +20.
  1254     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1255     12  WORK-AREAS.
  1256         16  WK-CONV-GREG.
  1257             24  WCG-CENT             PIC XX.
  1258             24  WCG-REST             PIC X(4).
  1259         16  WORK-GREGORIAN-DATE.
  1260             24  WK-GREG-CENT         PIC XX.
  1261             24  WK-GREG-DATE-YYMMDD.
  1262                 28  WK-GREG-YYMM     PIC X(4).
  1263                 28  WK-GREG-DD       PIC XX.
  1264
  1265         16  WORK-SELECT-DATE.
  1266             24  WK-SELECT-CENT            PIC XX.
  1267             24  WK-SELECT-DATE-YYMMDD.
  1268                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1269                 28  FILLER                PIC XX.
  1270
  1271         16  WK-FORM-NO.
  1272             24  WK-FORM-BANK-ID       PIC X(5).
  1273             24  WK-FORM-UNDRWRTR      PIC X(1).
  1274             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1275
  1276         16  WK-MEMBER-NO.
  1277             24  WK-MEMBER-1-6        PIC X(6).
  1278             24  WK-MEMBER-7-12       PIC X(6).
  1279
  1280         16  WK-FULL-CERT-NO.
  1281             24  WK-CERT-POS-1-2      PIC X(2).
  1282             24  WK-CERT-POS-3        PIC X(1).
  1283             24  WK-CERT-POS-4        PIC X(1).
  1284             24  WK-CERT-POS-5-6      PIC X(2).
  1285             24  WK-CERT-POS-7        PIC X(1).
  1286             24  WK-CERT-POS-8-11     PIC X(4).
  1287
  1288         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1289             88  VALID-RATE-CODE        VALUE 'Y'.
  1290             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1291
  1292         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1293         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1294         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1295         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1296         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1297         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1298         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1299         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1300         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1301         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1302
  1303* DLO001
  1304 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  25
* EL050.cbl
  1305     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1306     12  DMPF-RETURN-CODE          PIC XX.
  1307         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1308         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1309         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1310         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1311         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1312         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1313
  1314* DLO002
  1315 01  WS-DLO-INTERNAL-POLICY-FORM.
  1316     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1317     12  DIPF-RETURN-CODE          PIC XX.
  1318         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1319         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1320         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1321         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1322         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1323         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1324
  1325* DLO003
  1326 01  WS-DLO-VALID-BANK-ID.
  1327     12  DVBI-BANK-ID              PIC X(5).
  1328     12  DVBI-BANK-ID-TYPE         PIC X.
  1329         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1330         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1331         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1332         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1333         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1334     12  DVBI-RETURN-CODE          PIC XX.
  1335         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1336         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1337         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1338         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1339         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1340         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1341         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1342         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1343         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1344
  1345* DLO007
  1346 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1347     12  DCUA-RES-STATE            PIC XX.
  1348     12  DCUA-BEN-TYPE             PIC XX.
  1349     12  DCUA-SYS-IDENT            PIC X.
  1350         88  DCUA-CLAIM                        VALUE 'C'.
  1351         88  DCUA-PREMIUM                      VALUE 'P'.
  1352     12  DCUA-COVERAGE-RULE        PIC X.
  1353     12  DCUA-CLIENT-ID            PIC X(10).
  1354     12  DCUA-EFF-DATE             PIC X(8).
  1355     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1356     12  DCUA-RETURN-CODE          PIC XX.
  1357         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1358     12  DCUA-CERT-NUMBER          PIC X(11).
  1359     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1360     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1361
  1362* DLO011
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  26
* EL050.cbl
  1363 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1364     12  DPRB-RATE-CODE            PIC X(4).
  1365     12  DPRB-COVERAGE-CATEG       PIC X.
  1366     12  DPRB-RETURN-CODE          PIC XX.
  1367         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1368         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1369         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1370         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1371         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1372         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1373         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1374         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1375         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1376     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1377     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1378     12  DPRB-BEN-TYPE             PIC XX.
  1379
  1380* DLO017
  1381 01  WS-DLO-VALID-RATE-CODE.
  1382     12  DVRC-RATE-CODE            PIC X(4).
  1383     12  DVRC-RETURN-CODE          PIC XX.
  1384         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1385         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1386         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1387         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1388         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1389         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1390
  1391* DLO019
  1392 01  WS-DLO-ORIG-COV-CAT.
  1393     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1394     12  DOCC-RETURN-CODE          PIC XX.
  1395     12  DOCC-ORIG-COV-CAT         PIC X.
  1396     12  DOCC-UNDERWITER           PIC XX.
  1397     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1398     12  DOCC-FILLER               PIC X(6).
  1399
  1400* DLO021
  1401 01  WS-DLO-VALID-LOAN-OFFICER.
  1402     12  DVLO-LOAN-OFFICER.
  1403         16  DVLO-BILL-TYPE        PIC X.
  1404         16  DVLO-BILL-SOURCE      PIC X.
  1405         16  DVLO-BATCH-TYPE       PIC X.
  1406     12  DVLO-RETURN-CODE          PIC XX.
  1407         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1408         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1409         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1410         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1411         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1412         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1413
  1414* DLO022
  1415 01  WS-DLO-VALID-STATE-CODE.
  1416     12  DVSC-STATE-CODE           PIC XX.
  1417     12  DVSC-RETURN-CODE          PIC XX.
  1418         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1419
  1420* DLO023
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  27
* EL050.cbl
  1421 01  WS-DLO-VALID-CODE-VALUES.
  1422     12  DVCV-SYSTEM-ID            PIC XX.
  1423         88  DVCV-CLAIMS                       VALUE 'CL'.
  1424         88  DVCV-CREDIT                       VALUE 'CR'.
  1425     12  DVCV-RECORD-TYPE          PIC XX.
  1426         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1427         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1428         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1429         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1430         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1431         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1432         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1433         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1434     12  DVCV-RECORD-KEY           PIC X(6).
  1435     12  DVCV-RETURN-CODE          PIC XX.
  1436         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1437         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1438         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1439         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1440         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1441         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1442         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1443     12  DVCV-CODE-DESC            PIC X(60).
  1444     12  DVCV-GEN-DESC-1           PIC X(20).
  1445     12  DVCV-GEN-DESC-2           PIC X(20).
  1446     12  DVCV-GEN-DESC-3           PIC X(20).
  1447
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  28
* EL050.cbl
  1449*    COPY ERCBXRF.
  1450******************************************************************
  1451*                                                                *
  1452*                                                                *
  1453*                            ERCBXRF                             *
  1454*                                                                *
  1455*   ONLINE CREDIT SYSTEM                                         *
  1456*                                                                *
  1457*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1458*                                                                *
  1459*   FILE TYPE = VSAM,KSDS                                        *
  1460*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1461*                                                                *
  1462*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1463*       ALTERNATE PATH = NONE                                    *
  1464*                                                                *
  1465*   LOG = NO                                                     *
  1466*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1467*                                                                *
  1468******************************************************************
  1469
  1470 01  BANK-CROSS-REFERENCE.
  1471     12  BK-RECORD-ID                PIC XX.
  1472         88  VALID-BK-ID             VALUE 'BK'.
  1473
  1474     12  BK-CONTROL-PRIMARY.
  1475         16  BK-COMPANY-CD           PIC X.
  1476         16  BK-CARRIER              PIC X.
  1477         16  BK-GROUPING             PIC X(6).
  1478         16  BK-BANK-NO              PIC X(10).
  1479
  1480     12  BK-MAINT-INFORMATION.
  1481         16  BK-LAST-MAINT-DT        PIC XX.
  1482         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1483         16  BK-LAST-MAINT-USER      PIC X(4).
  1484         16  FILLER                  PIC X(9).
  1485
  1486     12  FILLER                      PIC X(37).
  1487
  1488     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1489
  1490     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1491                            DEPENDING ON BK-BANK-POINTER-CNT.
  1492         16  BK-AM-ACCOUNT           PIC X(10).
  1493         16  BK-AM-EXP-DT            PIC XX.
  1494         16  BK-AM-EFF-DT            PIC XX.
  1495         16  BK-AM-STATE             PIC XX.
  1496         16  FILLER                  PIC X(20).
  1497
  1498******************************************************************
  1499
  1500*    COPY ERCCOMP.
  1501******************************************************************
  1502*                                                                *
  1503*                                                                *
  1504*                            ERCCOMP                             *
  1505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1506*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  29
* EL050.cbl
  1507*                                                                *
  1508*   ONLINE CREDIT SYSTEM                                         *
  1509*                                                                *
  1510*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1511*                                                                *
  1512*   FILE TYPE = VSAM,KSDS                                        *
  1513*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1514*                                                                *
  1515*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1516*       ALTERNATE PATH = NONE                                    *
  1517*                                                                *
  1518*   LOG = NO                                                     *
  1519*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1520*                                                                *
  1521******************************************************************
  1522*                   C H A N G E   L O G
  1523*
  1524* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1525*-----------------------------------------------------------------
  1526*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1527* EFFECTIVE    NUMBER
  1528*-----------------------------------------------------------------
  1529* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1530* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1531* 092205    2005050300006  PEMA  ADD LEASE FEE
  1532* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1533* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1534* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1535* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1536* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1537* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1538******************************************************************
  1539
  1540 01  COMPENSATION-MASTER.
  1541     12  CO-RECORD-ID                          PIC XX.
  1542         88  VALID-CO-ID                          VALUE 'CO'.
  1543
  1544     12  CO-CONTROL-PRIMARY.
  1545         16  CO-COMPANY-CD                     PIC X.
  1546         16  CO-CONTROL.
  1547             20  CO-CTL-1.
  1548                 24  CO-CARR-GROUP.
  1549                     28  CO-CARRIER            PIC X.
  1550                     28  CO-GROUPING.
  1551                         32  CO-GROUP-PREFIX   PIC XXX.
  1552                         32  CO-GROUP-PRIME    PIC XXX.
  1553                 24  CO-RESP-NO.
  1554                     28  CO-RESP-PREFIX        PIC X(4).
  1555                     28  CO-RESP-PRIME         PIC X(6).
  1556             20  CO-CTL-2.
  1557                 24  CO-ACCOUNT.
  1558                     28  CO-ACCT-PREFIX        PIC X(4).
  1559                     28  CO-ACCT-PRIME         PIC X(6).
  1560         16  CO-TYPE                           PIC X.
  1561             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1562             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1563             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1564
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  30
* EL050.cbl
  1565     12  CO-MAINT-INFORMATION.
  1566         16  CO-LAST-MAINT-DT                  PIC XX.
  1567         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1568         16  CO-LAST-MAINT-USER                PIC X(4).
  1569     12  FILLER                                PIC XX.
  1570     12  CO-STMT-TYPE                          PIC XXX.
  1571     12  CO-COMP-TYPE                          PIC X.
  1572         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1573     12  CO-STMT-OWNER                         PIC X(4).
  1574     12  CO-BALANCE-CONTROL                    PIC X.
  1575         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1576         88  CO-NO-BALANCE                        VALUE 'N'.
  1577
  1578     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1579         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1580         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1581         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1582
  1583     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1584         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1585         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1586
  1587     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1588     12  CO-GA-DIRECT-DEP                      PIC X.
  1589     12  CO-FUTURE-SPACE                       PIC X.
  1590         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1591
  1592     12  CO-ACCT-NAME                          PIC X(30).
  1593     12  CO-MAIL-NAME                          PIC X(30).
  1594     12  CO-ADDR-1                             PIC X(30).
  1595     12  CO-ADDR-2                             PIC X(30).
  1596     12  CO-ADDR-3.
  1597         16  CO-ADDR-CITY                      PIC X(27).
  1598         16  CO-ADDR-STATE                     PIC XX.
  1599     12  CO-CSO-1099                           PIC X.
  1600     12  CO-ZIP.
  1601         16  CO-ZIP-PRIME.
  1602             20  CO-ZIP-PRI-1ST                PIC X.
  1603                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1604             20  FILLER                        PIC X(4).
  1605         16  CO-ZIP-PLUS4                      PIC X(4).
  1606     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1607         16  CO-CAN-POSTAL-1                   PIC XXX.
  1608         16  CO-CAN-POSTAL-2                   PIC XXX.
  1609         16  FILLER                            PIC XXX.
  1610     12  CO-SOC-SEC                            PIC X(13).
  1611     12  CO-TELEPHONE.
  1612         16  CO-AREA-CODE                      PIC XXX.
  1613         16  CO-PREFIX                         PIC XXX.
  1614         16  CO-PHONE                          PIC X(4).
  1615
  1616     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1617
  1618     12  CO-AR-BAL-LEVEL                       PIC X.
  1619         88  CO-AR-REF-LVL                        VALUE '1'.
  1620         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1621         88  CO-AR-BILL-LVL                       VALUE '2'.
  1622         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  31
* EL050.cbl
  1623         88  CO-AR-FR-LVL                         VALUE '4'.
  1624
  1625     12  CO-AR-NORMAL-PRINT                    PIC X.
  1626         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1627         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1628
  1629     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1630
  1631     12  CO-AR-REPORTING                       PIC X.
  1632         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1633         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1634
  1635     12  CO-AR-PULL-CHECK                      PIC X.
  1636         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1637         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1638
  1639     12  CO-AR-BALANCE-PRINT                   PIC X.
  1640         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1641
  1642     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1643         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1644         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1645         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1646
  1647     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1648
  1649     12  CO-USER-CODE                          PIC X.
  1650     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1651
  1652******************************************************************
  1653*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1654*    THE LAST MONTH END RUN.
  1655******************************************************************
  1656
  1657     12  CO-LAST-ACTIVITY-DATE.
  1658         16  CO-ACT-YEAR                       PIC 99.
  1659         16  CO-ACT-MONTH                      PIC 99.
  1660         16  CO-ACT-DAY                        PIC 99.
  1661
  1662     12  CO-LAST-STMT-DT.
  1663         16  CO-LAST-STMT-YEAR                 PIC 99.
  1664         16  CO-LAST-STMT-MONTH                PIC 99.
  1665         16  CO-LAST-STMT-DAY                  PIC 99.
  1666
  1667     12  CO-MO-END-TOTALS.
  1668         16  CO-MONTHLY-TOTALS.
  1669             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1670             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1671             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1672             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1673             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1674
  1675         16  CO-AGING-TOTALS.
  1676             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1677             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1678             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1679             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1680
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  32
* EL050.cbl
  1681         16  CO-YTD-TOTALS.
  1682             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1683             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1684
  1685         16  CO-OVER-UNDER-TOTALS.
  1686             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1687             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1688
  1689     12  CO-MISCELLANEOUS-TOTALS.
  1690         16  CO-FICA-TOTALS.
  1691             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1692             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1693
  1694         16  CO-CLAIM-TOTALS.
  1695             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1696             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1697
  1698******************************************************************
  1699*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1700*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1701******************************************************************
  1702
  1703     12  CO-CURRENT-TOTALS.
  1704         16  CO-CURRENT-LAST-STMT-DT.
  1705             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1706             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1707             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1708
  1709         16  CO-CURRENT-MONTHLY-TOTALS.
  1710             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1711             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1712             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1713             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1714             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1715
  1716         16  CO-CURRENT-AGING-TOTALS.
  1717             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1718             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1719             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1720             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1721
  1722         16  CO-CURRENT-YTD-TOTALS.
  1723             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1724             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1725
  1726     12  CO-PAID-COMM-TOTALS.
  1727         16  CO-YTD-PAID-COMMS.
  1728             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1729             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1730
  1731     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1732         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1733         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1734
  1735     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1736         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1737         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1738         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  33
* EL050.cbl
  1739         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1740         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1741         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1742         88  CO-FINAL-LETTER                  VALUE 'F'.
  1743         88  CO-RECONCILING                   VALUE 'R'.
  1744         88  CO-PHONE-CALL                    VALUE 'P'.
  1745         88  CO-LEGAL                         VALUE 'L'.
  1746         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1747         88  CO-WRITE-OFF                     VALUE 'W'.
  1748         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1749
  1750     12  CO-CSR-CODE                       PIC X(4).
  1751
  1752     12  CO-GA-STATUS-INFO.
  1753         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1754         16  CO-GA-TERMINATION-DT          PIC XX.
  1755         16  CO-GA-STATUS-CODE             PIC X.
  1756             88  CO-GA-ACTIVE                 VALUE 'A'.
  1757             88  CO-GA-INACTIVE               VALUE 'I'.
  1758             88  CO-GA-PENDING                VALUE 'P'.
  1759         16  CO-GA-COMMENTS.
  1760             20  CO-GA-COMMENT-1           PIC X(40).
  1761             20  CO-GA-COMMENT-2           PIC X(40).
  1762             20  CO-GA-COMMENT-3           PIC X(40).
  1763             20  CO-GA-COMMENT-4           PIC X(40).
  1764
  1765     12  CO-RPTCD2                         PIC X(10).
  1766     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1767         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1768         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1769
  1770     12  CO-TYPE-AGENT                     PIC X(01).
  1771         88  CO-CORPORATION                   VALUE 'C'.
  1772         88  CO-PARTNERSHIP                   VALUE 'P'.
  1773         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1774         88  CO-TRUST                         VALUE 'T'.
  1775         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1776
  1777     12  CO-FAXNO.
  1778         16  CO-FAX-AREA-CODE                  PIC XXX.
  1779         16  CO-FAX-PREFIX                     PIC XXX.
  1780         16  CO-FAX-PHONE                      PIC X(4).
  1781
  1782     12  CO-BANK-INFORMATION.
  1783         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1784         16  CO-BANK-TRANSIT-NON REDEFINES
  1785             CO-BANK-TRANSIT-NO                PIC 9(8).
  1786
  1787         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1788     12  CO-MISC-DEDUCT-INFO REDEFINES
  1789                  CO-BANK-INFORMATION.
  1790         16  CO-MD-GL-ACCT                     PIC X(10).
  1791         16  CO-MD-DIV                         PIC XX.
  1792         16  CO-MD-CENTER                      PIC X(4).
  1793         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1794         16  CO-CREATE-AP-CHECK                PIC X.
  1795         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1796         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  34
* EL050.cbl
  1797     12  CO-ACH-STATUS                         PIC X.
  1798         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1799         88  CO-ACH-PENDING                        VALUE 'P'.
  1800
  1801     12  CO-BILL-SW                            PIC X.
  1802     12  CO-CONTROL-NAME                       PIC X(30).
  1803     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1804     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1805     12  CO-CLP-STATE                          PIC XX.
  1806     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1807     12  CO-SPP-REFUND-EDIT                    PIC X.
  1808
  1809******************************************************************
  1810
  1811*    COPY ERCAGTC.
  1812******************************************************************
  1813*                                                                *
  1814*                                                                *
  1815*                            ERCAGTC                             *
  1816*                            VMOD=2.001                          *
  1817*                                                                *
  1818*   ONLINE CREDIT SYSTEM                                         *
  1819*                                                                *
  1820*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1821*                                                                *
  1822*   FILE TYPE = VSAM,KSDS                                        *
  1823*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1824*                                                                *
  1825*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1826*       ALTERNATE PATH = NONE                                    *
  1827*                                                                *
  1828*   LOG = NO                                                     *
  1829*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1830*                                                                *
  1831******************************************************************
  1832*                   C H A N G E   L O G
  1833*
  1834* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1835*-----------------------------------------------------------------
  1836*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1837* EFFECTIVE    NUMBER
  1838*-----------------------------------------------------------------
  1839* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1840* 111004                         NEW FILE AND COPYBOOK
  1841* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1842******************************************************************
  1843 01  AGENT-COMMISSIONS.
  1844     12  AG-RECORD-ID                          PIC XX.
  1845         88  VALID-CO-ID                          VALUE 'AG'.
  1846     12  AG-CONTROL-PRIMARY.
  1847         16  AG-COMPANY-CD                     PIC X.
  1848         16  AG-CONTROL.
  1849             20  AG-CTL-1.
  1850                 24  AG-CARR-GROUP.
  1851                     28  AG-CARRIER            PIC X.
  1852                     28  AG-GROUPING           PIC X(6).
  1853                 24  AG-BANK                   PIC X(10).
  1854             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  35
* EL050.cbl
  1855                 24  AG-EXP-DT                 PIC XX.
  1856         16  AG-TYPE                           PIC X.
  1857             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1858             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1859     12  AG-MAINT-INFORMATION.
  1860         16  AG-LAST-MAINT-DT                  PIC XX.
  1861         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1862         16  AG-LAST-MAINT-USER                PIC X(4).
  1863         16  FILLER                            PIC X(10).
  1864     12  AG-EFF-DT                             PIC XX.
  1865     12  AG-COMM-STRUCTURE.
  1866         16  AG-AGT-COMMS OCCURS 10.
  1867             20  AG-AGT                PIC X(10).
  1868             20  AG-COM-TYP            PIC X.
  1869             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1870             20  AG-RECALC-LV-INDIC    PIC X.
  1871             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1872             20  AG-LRCALC-LV-INDIC    PIC X.
  1873             20  FILLER                PIC X(05).
  1874     12  FILLER                  PIC X(145).
  1875******************************************************************
  1876*    COPY ERCRESS.
  1877******************************************************************
  1878*                                                                *
  1879*                            ERCRESS                             *
  1880*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1881*                            VMOD=2.002                          *
  1882*                                                                *
  1883*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1884*                                                                *
  1885*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1886*   VSAM RESIDENT STATE TAX MASTER                              *
  1887*                                                                *
  1888*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1889*                                                                *
  1890*   FILE TYPE = VSAM,KSDS                                        *
  1891*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1892*                                                                *
  1893*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1894*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1895*                                                                *
  1896*   LOG = NO                                                     *
  1897*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1898*                                                                *
  1899*                                                                *
  1900******************************************************************
  1901
  1902 01  RESIDENT-STATE-TAX-MASTER.
  1903
  1904     10  ERRESS-PRIMARY-KEY.
  1905         15  RES-COMPANY-CD        PIC X.
  1906         15  RES-RESIDENT-STATE    PIC XX.
  1907         15  RES-COVERAGE-CATEGORY PIC X.
  1908         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1909*                                      YYYYMMDD
  1910*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1911
  1912     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  36
* EL050.cbl
  1913
  1914         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1915         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1916         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1917         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1918
  1919     10 RES-RECALC-SW              PIC   X.
  1920         88 RECALC                VALUE 'Y'.
  1921         88 NO-RECALC             VALUE 'N'.
  1922     10  RES-MAINT-BY              PIC X(4).
  1923     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1924     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1925*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  37
* EL050.cbl
  1927*    COPY ERCRESC.
  1928******************************************************************
  1929*                                                                *
  1930*                            ERCRESC                             *
  1931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1932*                            VMOD=2.003                          *
  1933*                                                                *
  1934*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1935*                                                                *
  1936*   FILE TYPE = VSAM,KSDS                                        *
  1937*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1938*                                                                *
  1939*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1940*       ALTERNATE PATH1 = NONE                                   *
  1941*                                                                *
  1942*   LOG = NO                                                     *
  1943*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1944*                                                                *
  1945******************************************************************
  1946
  1947 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1948
  1949     10  ERRESC-RECORD-KEY.
  1950         15  RESC-COMPANY-CD           PIC   X.
  1951         15  RESC-CARRIER              PIC   X.
  1952         15  RESC-GROUP                PIC   X(6).
  1953         15  RESC-STATE                PIC   XX.
  1954         15  RESC-ACCOUNT              PIC   X(10).
  1955         15  RESC-AGENT                PIC   X(10).
  1956         15  RESC-RESIDENT-STATE       PIC   XX.
  1957         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1958*                                           YYYYMMDD
  1959     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1960
  1961     10  RESC-COMM-RECORD-DATA.
  1962         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1963             20 RESC-COVERAGE-CAT      PIC    X.
  1964             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1965             20 RESC-COMMISSION-TAB REDEFINES
  1966                RESC-COMMISSION-PER    PIC  XXX.
  1967
  1968     10  RESC-MAINT-BY                 PIC X(4).
  1969     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1970     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1971*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  38
* EL050.cbl
  1973*    COPY ERCPLAN.
  1974******************************************************************
  1975*                                                                *
  1976*                                                                *
  1977*                            ERCPLAN                             *
  1978*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1979*                            VMOD=2.003                          *
  1980*                                                                *
  1981*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1982*                                                                *
  1983*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1984*   PLAN MASTER                                                  *
  1985*                                                                *
  1986*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1987*                                                                *
  1988*   FILE TYPE = VSAM,KSDS                                        *
  1989*   RECORD SIZE = 420   RECFORM = FIX                            *
  1990*                                                                *
  1991*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1992*       ALTERNATE PATH1 = N/A                                    *
  1993*                                                                *
  1994*   LOG = NO                                                     *
  1995*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1996*                                                                *
  1997*                                                                *
  1998******************************************************************
  1999
  2000 01  PLAN-MASTER.
  2001     12  PL-RECORD-ID                      PIC XX.
  2002         88  VALID-PL-ID                      VALUE 'PL'.
  2003
  2004     12  PL-CONTROL-PRIMARY.
  2005         16  PL-COMPANY-CD                 PIC X.
  2006         16  PL-MSTR-CNTRL.
  2007             20  PL-CONTROL-A.
  2008                 24  PL-CARRIER            PIC X.
  2009                 24  PL-GROUPING           PIC X(6).
  2010                 24  PL-STATE              PIC XX.
  2011                 24  PL-ACCOUNT            PIC X(10).
  2012             20  PL-BENEFIT-TYPE           PIC X.
  2013             20  PL-BENEFIT-CODE           PIC XX.
  2014             20  PL-REVISION-NO            PIC X(3).
  2015
  2016     12  PL-CONTROL-BY-VAR-GRP.
  2017         16  PL-COMPANY-CD-A1              PIC X.
  2018         16  PL-VG-CARRIER                 PIC X.
  2019         16  PL-VG-GROUPING                PIC X(6).
  2020         16  PL-VG-STATE                   PIC XX.
  2021         16  PL-VG-ACCOUNT                 PIC X(10).
  2022         16  PL-BENEFIT-TYPE-A1            PIC X.
  2023         16  PL-BENEFIT-CODE-A1            PIC XX.
  2024         16  PL-REVISION-NO-A1             PIC 999.
  2025
  2026     12  PL-MAINT-INFORMATION.
  2027         16  PL-LAST-MAINT-DT              PIC XX.
  2028         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2029         16  PL-LAST-MAINT-USER            PIC X(4).
  2030         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  39
* EL050.cbl
  2031
  2032     12  PL-LIABILITY-LIMITS.
  2033         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2034         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2035             20  PL-LM-AGE                 PIC S99        COMP-3.
  2036             20  PL-LM-DUR                 PIC S999       COMP-3.
  2037             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2038             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2039
  2040     12  FILLER                            PIC X(30).
  2041
  2042     12  PL-GL-ACCOUNT-NOS.
  2043         16  PL-PREMIUM-GL                 PIC X(8).
  2044         16  PL-COMM-GL                    PIC X(8).
  2045         16  PL-CLAIM-GL                   PIC X(8).
  2046     12  FILLER                            PIC X(24).
  2047     12  PL-TOLERANCES.
  2048         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2049         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2050         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2051         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2052         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2053         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2054     12  PL-OVER-SHORT.
  2055         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2056         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2057     12  FILLER                            PIC X(24).
  2058     12  PLAN-MISC.
  2059         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2060         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2061         16  PL-IG                         PIC X.
  2062         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2063         16  PL-POLICY-FORM                PIC X(12).
  2064         16  PL-EDIT-FOR-FORM              PIC X(01).
  2065         16  PL-DEV-CODE                   PIC XXX.
  2066         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2067         16  PL-CALC-METHOD                PIC X.
  2068         16  PL-BENEFIT-GROUP              PIC X(05).
  2069         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2070
  2071         16  FILLER                        PIC X(99).
  2072******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  40
* EL050.cbl
  2074*    COPY ELCCERT.
  2075******************************************************************
  2076*                                                                *
  2077*                            ELCCERT.                            *
  2078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2079*                            VMOD=2.013                          *
  2080*                                                                *
  2081*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2082*                                                                *
  2083*   FILE TYPE = VSAM,KSDS                                        *
  2084*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2085*                                                                *
  2086*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2087*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2088*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2089*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2090*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2091*                                                                *
  2092*   LOG = YES                                                    *
  2093*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2094******************************************************************
  2095*                   C H A N G E   L O G
  2096*
  2097* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2098*-----------------------------------------------------------------
  2099*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2100* EFFECTIVE    NUMBER
  2101*-----------------------------------------------------------------
  2102* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2103* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2104* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2105* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2106* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2107* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2109* 032612  CR2011110200001  PEMA  AHL CHANGES
  2110******************************************************************
  2111
  2112 01  CERTIFICATE-MASTER.
  2113     12  CM-RECORD-ID                      PIC XX.
  2114         88  VALID-CM-ID                      VALUE 'CM'.
  2115
  2116     12  CM-CONTROL-PRIMARY.
  2117         16  CM-COMPANY-CD                 PIC X.
  2118         16  CM-CARRIER                    PIC X.
  2119         16  CM-GROUPING.
  2120             20  CM-GROUPING-PREFIX        PIC X(3).
  2121             20  CM-GROUPING-PRIME         PIC X(3).
  2122         16  CM-STATE                      PIC XX.
  2123         16  CM-ACCOUNT.
  2124             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2125             20  CM-ACCOUNT-PRIME          PIC X(6).
  2126         16  CM-CERT-EFF-DT                PIC XX.
  2127         16  CM-CERT-NO.
  2128             20  CM-CERT-PRIME             PIC X(10).
  2129             20  CM-CERT-SFX               PIC X.
  2130
  2131     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  41
* EL050.cbl
  2132         16  CM-COMPANY-CD-A1              PIC X.
  2133         16  CM-INSURED-LAST-NAME          PIC X(15).
  2134         16  CM-INSURED-INITIALS.
  2135             20  CM-INSURED-INITIAL1       PIC X.
  2136             20  CM-INSURED-INITIAL2       PIC X.
  2137
  2138     12  CM-CONTROL-BY-SSN.
  2139         16  CM-COMPANY-CD-A2              PIC X.
  2140         16  CM-SOC-SEC-NO.
  2141             20  CM-SSN-STATE              PIC XX.
  2142             20  CM-SSN-ACCOUNT            PIC X(6).
  2143             20  CM-SSN-LN3.
  2144                 25  CM-INSURED-INITIALS-A2.
  2145                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2146                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2147                 25 CM-PART-LAST-NAME-A2         PIC X.
  2148
  2149     12  CM-CONTROL-BY-CERT-NO.
  2150         16  CM-COMPANY-CD-A4              PIC X.
  2151         16  CM-CERT-NO-A4                 PIC X(11).
  2152
  2153     12  CM-CONTROL-BY-MEMB.
  2154         16  CM-COMPANY-CD-A5              PIC X.
  2155         16  CM-MEMBER-NO.
  2156             20  CM-MEMB-STATE             PIC XX.
  2157             20  CM-MEMB-ACCOUNT           PIC X(6).
  2158             20  CM-MEMB-LN4.
  2159                 25  CM-INSURED-INITIALS-A5.
  2160                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2161                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2162                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2163
  2164     12  CM-INSURED-PROFILE-DATA.
  2165         16  CM-INSURED-FIRST-NAME.
  2166             20  CM-INSURED-1ST-INIT       PIC X.
  2167             20  FILLER                    PIC X(9).
  2168         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2169         16  CM-INSURED-SEX                PIC X.
  2170             88  CM-SEX-MALE                  VALUE 'M'.
  2171             88  CM-SEX-FEMAL                 VALUE 'F'.
  2172         16  CM-INSURED-JOINT-AGE          PIC 99.
  2173         16  CM-JOINT-INSURED-NAME.
  2174             20  CM-JT-LAST-NAME           PIC X(15).
  2175             20  CM-JT-FIRST-NAME.
  2176                 24  CM-JT-1ST-INIT        PIC X.
  2177                 24  FILLER                PIC X(9).
  2178             20  CM-JT-INITIAL             PIC X.
  2179
  2180     12  CM-LIFE-DATA.
  2181         16  CM-LF-BENEFIT-CD              PIC XX.
  2182         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2183         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2184         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2185         16  CM-LF-DEV-CODE                PIC XXX.
  2186         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2187         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2188         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2189         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  42
* EL050.cbl
  2190         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2191         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2192         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2193         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2194         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2195         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2196         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2197         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2198         16  FILLER                        PIC XX.
  2199
  2200     12  CM-AH-DATA.
  2201         16  CM-AH-BENEFIT-CD              PIC XX.
  2202         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2203         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2204         16  CM-AH-DEV-CODE                PIC XXX.
  2205         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2206         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2207         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2208         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2209         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2210         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2211         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2212         16  CM-AH-PAID-THRU-DT            PIC XX.
  2213             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2214         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2215         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2216         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2217         16  FILLER                        PIC X.
  2218
  2219     12  CM-LOAN-INFORMATION.
  2220         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2221         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2222                                           PIC S9(5)V99  COMP-3.
  2223         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2224         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2225         16  CM-PAY-FREQUENCY              PIC S99.
  2226         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2227         16  CM-RATE-CLASS                 PIC XX.
  2228         16  CM-BENEFICIARY                PIC X(25).
  2229         16  CM-POLICY-FORM-NO             PIC X(12).
  2230         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2231         16  CM-LAST-ADD-ON-DT             PIC XX.
  2232         16  CM-DEDUCTIBLE-AMOUNTS.
  2233             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2234             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2235         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2236             20  CM-RESIDENT-STATE         PIC XX.
  2237             20  CM-RATE-CODE              PIC X(4).
  2238             20  FILLER                    PIC XX.
  2239         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2240             20  CM-LOAN-OFFICER           PIC X(5).
  2241             20  FILLER                    PIC XXX.
  2242         16  CM-CSR-CODE                   PIC XXX.
  2243         16  CM-UNDERWRITING-CODE          PIC X.
  2244             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2245         16  CM-POST-CARD-IND              PIC X.
  2246         16  CM-NH-INTERFACE-SW            PIC X.
  2247         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  43
* EL050.cbl
  2248             88  CM-SING-PRM                  VALUE '1'.
  2249             88  CM-O-B-COVERAGE              VALUE '2'.
  2250             88  CM-OPEN-END                  VALUE '3'.
  2251         16  CM-IND-GRP-TYPE               PIC X.
  2252             88  CM-INDIVIDUAL                VALUE 'I'.
  2253             88  CM-GROUP                     VALUE 'G'.
  2254         16  CM-SKIP-CODE                  PIC X.
  2255             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2256             88  SKIP-JULY                    VALUE '1'.
  2257             88  SKIP-AUGUST                  VALUE '2'.
  2258             88  SKIP-SEPTEMBER               VALUE '3'.
  2259             88  SKIP-JULY-AUG                VALUE '4'.
  2260             88  SKIP-AUG-SEPT                VALUE '5'.
  2261             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2262             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2263             88  SKIP-JUNE                    VALUE '8'.
  2264             88  SKIP-JUNE-JULY               VALUE '9'.
  2265             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2266             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2267         16  CM-PAYMENT-MODE               PIC X.
  2268             88  PAY-MONTHLY                  VALUE SPACE.
  2269             88  PAY-WEEKLY                   VALUE '1'.
  2270             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2271             88  PAY-BI-WEEKLY                VALUE '3'.
  2272             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2273         16  CM-LOAN-NUMBER                PIC X(8).
  2274         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2275         16  CM-OLD-LOF                    PIC XXX.
  2276*        16  CM-LOAN-OFFICER               PIC XXX.
  2277         16  CM-REIN-TABLE                 PIC XXX.
  2278         16  CM-SPECIAL-REIN-CODE          PIC X.
  2279         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2280         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2281         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2282
  2283     12  CM-STATUS-DATA.
  2284         16  CM-ENTRY-STATUS               PIC X.
  2285         16  CM-ENTRY-DT                   PIC XX.
  2286
  2287         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2288         16  CM-LF-CANCEL-DT               PIC XX.
  2289         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2290
  2291         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2292         16  CM-LF-DEATH-DT                PIC XX.
  2293         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2294
  2295         16  CM-LF-CURRENT-STATUS          PIC X.
  2296             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2297                                                'M' '4' '5' '9'.
  2298             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2299             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2300             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2301             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2302             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2303             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2304             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2305             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  44
* EL050.cbl
  2306             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2307             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2308             88  CM-LF-DECLINED               VALUE 'D'.
  2309             88  CM-LF-VOIDED                 VALUE 'V'.
  2310
  2311         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2312         16  CM-AH-CANCEL-DT               PIC XX.
  2313         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2314
  2315         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2316         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2317         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2318
  2319         16  CM-AH-CURRENT-STATUS          PIC X.
  2320             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2321                                                'M' '4' '5' '9'.
  2322             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2323             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2324             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2325             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2326             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2327             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2328             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2329             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2330             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2331             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2332             88  CM-AH-DECLINED               VALUE 'D'.
  2333             88  CM-AH-VOIDED                 VALUE 'V'.
  2334
  2335         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2336             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2337             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2338             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2339         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2340
  2341         16  CM-ENTRY-BATCH                PIC X(6).
  2342         16  CM-LF-EXIT-BATCH              PIC X(6).
  2343         16  CM-AH-EXIT-BATCH              PIC X(6).
  2344         16  CM-LAST-MONTH-END             PIC XX.
  2345
  2346     12  CM-NOTE-SW                        PIC X.
  2347         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2348         88  CERT-NOTES-PRESENT               VALUE '1'.
  2349         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2350         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2351         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2352         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2353         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2354         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2355     12  CM-COMP-EXCP-SW                   PIC X.
  2356         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2357         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2358     12  CM-INSURED-ADDRESS-SW             PIC X.
  2359         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2360         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2361
  2362*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2363     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  45
* EL050.cbl
  2364     12  FILLER                            PIC X.
  2365
  2366*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2367     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2368     12  FILLER                            PIC X.
  2369*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2370     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2371
  2372     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2373         88  CERT-ADDED-BATCH                 VALUE ' '.
  2374         88  CERT-ADDED-ONLINE                VALUE '1'.
  2375         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2376         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2377         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2378     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2379         88  CERT-AS-LOADED                   VALUE ' '.
  2380         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2381         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2382         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2383         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2384         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2385         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2386         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2387
  2388     12  CM-ACCOUNT-COMM-PCTS.
  2389         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2390         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2391
  2392     12  CM-USER-FIELD                     PIC X.
  2393     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2394     12  CM-CLP-STATE                      PIC XX.
  2395     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2396     12  CM-USER-RESERVED                  PIC XXX.
  2397     12  FILLER REDEFINES CM-USER-RESERVED.
  2398         16  CM-AH-CLASS-CD                PIC XX.
  2399         16  F                             PIC X.
  2400******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  46
* EL050.cbl
  2402*    COPY ERCMAIL.
  2403******************************************************************
  2404*                                                                *
  2405*                                                                *
  2406*                            ERCMAIL                             *
  2407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2408*                            VMOD=2.003                          *
  2409*                                                                *
  2410*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2411*                                                                *
  2412*   FILE TYPE = VSAM,KSDS                                        *
  2413*   RECORD SIZE = 374   RECFORM = FIX                            *
  2414*                                                                *
  2415*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2416*   ALTERNATE PATH    = NOT USED                                 *
  2417*                                                                *
  2418*   LOG = YES                                                    *
  2419*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2420******************************************************************
  2421*                   C H A N G E   L O G
  2422*
  2423* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2424*-----------------------------------------------------------------
  2425*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2426* EFFECTIVE    NUMBER
  2427*-----------------------------------------------------------------
  2428* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2429* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2430* 111108                   PEMA  ADD CRED BENE ADDR2
  2431******************************************************************
  2432
  2433 01  MAILING-DATA.
  2434     12  MA-RECORD-ID                      PIC XX.
  2435         88  VALID-MA-ID                       VALUE 'MA'.
  2436
  2437     12  MA-CONTROL-PRIMARY.
  2438         16  MA-COMPANY-CD                 PIC X.
  2439         16  MA-CARRIER                    PIC X.
  2440         16  MA-GROUPING.
  2441             20  MA-GROUPING-PREFIX        PIC XXX.
  2442             20  MA-GROUPING-PRIME         PIC XXX.
  2443         16  MA-STATE                      PIC XX.
  2444         16  MA-ACCOUNT.
  2445             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2446             20  MA-ACCOUNT-PRIME          PIC X(6).
  2447         16  MA-CERT-EFF-DT                PIC XX.
  2448         16  MA-CERT-NO.
  2449             20  MA-CERT-PRIME             PIC X(10).
  2450             20  MA-CERT-SFX               PIC X.
  2451
  2452     12  FILLER                            PIC XX.
  2453
  2454     12  MA-ACCESS-CONTROL.
  2455         16  MA-SOURCE-SYSTEM              PIC XX.
  2456             88  MA-FROM-CREDIT                VALUE 'CR'.
  2457             88  MA-FROM-VSI                   VALUE 'VS'.
  2458             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2459             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  47
* EL050.cbl
  2460         16  MA-RECORD-ADD-DT              PIC XX.
  2461         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2462         16  MA-LAST-MAINT-DT              PIC XX.
  2463         16  MA-LAST-MAINT-BY              PIC XXXX.
  2464         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2465
  2466     12  MA-PROFILE-INFO.
  2467         16  MA-QUALIFY-CODE-1             PIC XX.
  2468         16  MA-QUALIFY-CODE-2             PIC XX.
  2469         16  MA-QUALIFY-CODE-3             PIC XX.
  2470         16  MA-QUALIFY-CODE-4             PIC XX.
  2471         16  MA-QUALIFY-CODE-5             PIC XX.
  2472
  2473         16  MA-INSURED-LAST-NAME          PIC X(15).
  2474         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2475         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2476         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2477         16  MA-INSURED-BIRTH-DT           PIC XX.
  2478         16  MA-INSURED-SEX                PIC X.
  2479             88  MA-SEX-MALE                   VALUE 'M'.
  2480             88  MA-SEX-FEMALE                 VALUE 'F'.
  2481         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2482
  2483         16  MA-ADDRESS-CORRECTED          PIC X.
  2484         16  MA-JOINT-BIRTH-DT             PIC XX.
  2485*        16  FILLER                        PIC X(12).
  2486
  2487         16  MA-ADDRESS-LINE-1             PIC X(30).
  2488         16  MA-ADDRESS-LINE-2             PIC X(30).
  2489         16  MA-CITY-STATE.
  2490             20  MA-CITY                   PIC X(28).
  2491             20  MA-ADDR-STATE             PIC XX.
  2492         16  MA-ZIP.
  2493             20  MA-ZIP-CODE.
  2494                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2495                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2496                 24  FILLER                PIC X(4).
  2497             20  MA-ZIP-PLUS4              PIC X(4).
  2498         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2499             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2500             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2501             20  FILLER                    PIC X(3).
  2502
  2503         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2504
  2505         16  FILLER                        PIC XXX.
  2506*        16  FILLER                        PIC X(10).
  2507
  2508     12  MA-CRED-BENE-INFO.
  2509         16  MA-CRED-BENE-NAME                 PIC X(25).
  2510         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2511         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2512         16  MA-CRED-BENE-CTYST.
  2513             20  MA-CRED-BENE-CITY             PIC X(28).
  2514             20  MA-CRED-BENE-STATE            PIC XX.
  2515         16  MA-CRED-BENE-ZIP.
  2516             20  MA-CB-ZIP-CODE.
  2517                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  48
* EL050.cbl
  2518                     88  MA-CB-CANADIAN-POST-CODE
  2519                                           VALUE 'A' THRU 'Z'.
  2520                 24  FILLER                    PIC X(4).
  2521             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2522         16  MA-CB-CANADIAN-POSTAL-CODE
  2523                            REDEFINES MA-CRED-BENE-ZIP.
  2524             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2525             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2526             20  FILLER                        PIC X(3).
  2527     12  MA-POST-CARD-MAIL-DATA.
  2528         16  MA-MAIL-DATA OCCURS 7.
  2529             20  MA-MAIL-TYPE              PIC X.
  2530                 88  MA-12MO-MAILING           VALUE '1'.
  2531                 88  MA-EXP-MAILING            VALUE '2'.
  2532             20  MA-MAIL-STATUS            PIC X.
  2533                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2534                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2535                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2536             20  MA-MAIL-DATE              PIC XX.
  2537     12  FILLER                            PIC XX.
  2538     12  FILLER                            PIC XX.
  2539*    12  FILLER                            PIC X(30).
  2540******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  49
* EL050.cbl
  2542*    COPY ERCPNDM.
  2543******************************************************************
  2544*                                                                *
  2545*                                                                *
  2546*                            ERCPNDM                             *
  2547*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2548*                            VMOD=2.003                          *
  2549*                                                                *
  2550*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2551*                                                                *
  2552*   FILE TYPE = VSAM,KSDS                                        *
  2553*   RECORD SIZE = 374   RECFORM = FIX                            *
  2554*                                                                *
  2555*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2556*   ALTERNATE PATH    = NOT USED                                 *
  2557*                                                                *
  2558*   LOG = YES                                                    *
  2559*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2560******************************************************************
  2561*                   C H A N G E   L O G
  2562*
  2563* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2564*-----------------------------------------------------------------
  2565*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2566* EFFECTIVE    NUMBER
  2567*-----------------------------------------------------------------
  2568* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2569* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2570* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2571******************************************************************
  2572
  2573 01  PENDING-MAILING-DATA.
  2574     12  PM-RECORD-ID                      PIC XX.
  2575         88  VALID-MA-ID                       VALUE 'PM'.
  2576
  2577     12  PM-CONTROL-PRIMARY.
  2578         16  PM-COMPANY-CD                 PIC X.
  2579         16  PM-ENTRY-BATCH                PIC X(6).
  2580         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2581         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2582
  2583     12  FILLER                            PIC X(14).
  2584
  2585     12  PM-ACCESS-CONTROL.
  2586         16  PM-SOURCE-SYSTEM              PIC XX.
  2587             88  PM-FROM-CREDIT                VALUE 'CR'.
  2588             88  PM-FROM-VSI                   VALUE 'VS'.
  2589             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2590             88  PM-FROM-OTHER                 VALUE 'OT'.
  2591         16  PM-RECORD-ADD-DT              PIC XX.
  2592         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2593         16  PM-LAST-MAINT-DT              PIC XX.
  2594         16  PM-LAST-MAINT-BY              PIC XXXX.
  2595         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2596
  2597     12  PM-PROFILE-INFO.
  2598         16  PM-QUALIFY-CODE-1             PIC XX.
  2599         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  50
* EL050.cbl
  2600         16  PM-QUALIFY-CODE-3             PIC XX.
  2601         16  PM-QUALIFY-CODE-4             PIC XX.
  2602         16  PM-QUALIFY-CODE-5             PIC XX.
  2603
  2604         16  PM-INSURED-LAST-NAME          PIC X(15).
  2605         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2606         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2607         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2608         16  PM-INSURED-BIRTH-DT           PIC XX.
  2609         16  PM-INSURED-SEX                PIC X.
  2610             88  PM-SEX-MALE                   VALUE 'M'.
  2611             88  PM-SEX-FEMALE                 VALUE 'F'.
  2612         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2613
  2614         16  PM-ADDRESS-CORRECTED          PIC X.
  2615         16  PM-JOINT-BIRTH-DT             PIC XX.
  2616*        16  FILLER                        PIC X(12).
  2617
  2618         16  PM-ADDRESS-LINE-1             PIC X(30).
  2619         16  PM-ADDRESS-LINE-2             PIC X(30).
  2620         16  PM-CITY-STATE.
  2621             20  PM-CITY                   PIC X(28).
  2622             20  PM-STATE                  PIC XX.
  2623         16  PM-ZIP.
  2624             20  PM-ZIP-CODE.
  2625                 24  PM-ZIP-1              PIC X.
  2626                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2627                 24  FILLER                PIC X(4).
  2628             20  PM-ZIP-PLUS4              PIC X(4).
  2629         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2630             20  PM-CAN-POST1              PIC XXX.
  2631             20  PM-CAN-POST2              PIC XXX.
  2632             20  FILLER                    PIC XXX.
  2633
  2634         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2635
  2636         16  FILLER                        PIC X(03).
  2637
  2638     12  PM-CRED-BENE-INFO.
  2639         16  PM-CRED-BENE-NAME             PIC X(25).
  2640         16  PM-CRED-BENE-ADDR             PIC X(30).
  2641         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2642         16  PM-CRED-BENE-CTYST.
  2643             20  PM-CRED-BENE-CITY         PIC X(28).
  2644             20  PM-CRED-BENE-STATE        PIC XX.
  2645         16  PM-CRED-BENE-ZIP.
  2646             20  PM-CB-ZIP-CODE.
  2647                 24  PM-CB-ZIP-1           PIC X.
  2648                     88  PM-CB-CANADIAN-POST-CODE
  2649                                  VALUE 'A' THRU 'Z'.
  2650                 24  FILLER                PIC X(4).
  2651             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2652         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2653             20  PM-CB-CAN-POST1           PIC XXX.
  2654             20  PM-CB-CAN-POST2           PIC XXX.
  2655             20  FILLER                    PIC XXX.
  2656     12  PM-POST-CARD-MAIL-DATA.
  2657         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  51
* EL050.cbl
  2658             20  PM-MAIL-TYPE              PIC X.
  2659                 88  PM-12MO-MAILING           VALUE '1'.
  2660                 88  PM-EXP-MAILING            VALUE '2'.
  2661             20  PM-MAIL-STATUS            PIC X.
  2662                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2663                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2664                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2665             20  PM-MAIL-DATE              PIC XX.
  2666     12  FILLER                            PIC XX.
  2667     12  FILLER                            PIC X(12).
  2668*    12  FILLER                            PIC X(30).
  2669
  2670******************************************************************
  2671*                                COPY ERCLOFC.
  2672******************************************************************
  2673*                                                                *
  2674*                                                                *
  2675*                            ERCLOFC                             *
  2676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2677*                            VMOD=2.003                          *
  2678*                                                                *
  2679*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2680*                                                                *
  2681*   FILE TYPE = VSAM,KSDS                                        *
  2682*   RECORD SIZE = 670   RECFORM = FIX                            *
  2683*                                                                *
  2684*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2685*                                                                *
  2686*   LOG = YES                                                    *
  2687*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2688*                                                                *
  2689******************************************************************
  2690
  2691 01  LOAN-OFFICER-MASTER.
  2692     12  LO-RECORD-ID                PIC XX.
  2693         88  VALID-LO-ID                VALUE 'LO'.
  2694
  2695     12  LO-CONTROL-PRIMARY.
  2696         16  LO-COMPANY-CD           PIC X.
  2697         16  LO-CARRIER              PIC X.
  2698         16  LO-GROUPING.
  2699             20  LO-GROUPING-PREFIX  PIC XXX.
  2700             20  LO-GROUPING-PRIME   PIC XXX.
  2701         16  LO-STATE                PIC XX.
  2702         16  LO-ACCOUNT.
  2703             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2704             20  LO-ACCOUNT-PRIME    PIC X(6).
  2705         16  LO-OFFICER-CODE         PIC X(5).
  2706
  2707     12  LO-OFFICER-NAME             PIC X(30).
  2708
  2709     12  LO-LAST-MAINT-DT            PIC XX.
  2710     12  LO-LAST-USER                PIC X(4).
  2711     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2712
  2713     12  LO-COMP-CONTROL             PIC X.
  2714             88  LO-SHOW-COMP           VALUE 'Y'.
  2715             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  52
* EL050.cbl
  2716     12  LO-DETAIL-CONTROL           PIC X.
  2717             88  LO-PRINT-DETAIL        VALUE 'D'.
  2718             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2719
  2720     12  LO-SV-CARRIER               PIC X.
  2721     12  LO-SV-GROUPING              PIC X(6).
  2722     12  LO-SV-STATE                 PIC XX.
  2723
  2724     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2725     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2726
  2727     12  LO-OFFICER-INFO.
  2728         16  FILLER OCCURS 12 TIMES.
  2729             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2730             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2731             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2732             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2733             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2734             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2735             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2736             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2737     12  FILLER                      PIC X(198).
  2738******************************************************************
  2739*                                COPY ERCPDEF.
  2740******************************************************************
  2741*                                                                *
  2742*                                                                *
  2743*                            ERCPDEF.                            *
  2744*                                                                *
  2745*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2746*                                                                *
  2747*    FILE TYPE = VSAM,KSDS                                       *
  2748*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2749*                                                                *
  2750*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2751*                                                                *
  2752*    LOG = YES                                                   *
  2753*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2754******************************************************************
  2755*                   C H A N G E   L O G
  2756*
  2757* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2758*-----------------------------------------------------------------
  2759*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2760* EFFECTIVE    NUMBER
  2761*-----------------------------------------------------------------
  2762* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2763* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2764******************************************************************
  2765 01  PRODUCT-MASTER.
  2766    12  PD-RECORD-ID                 PIC X(02).
  2767        88  VALID-PD-ID                  VALUE 'PD'.
  2768    12  PD-CONTROL-PRIMARY.
  2769        16  PD-COMPANY-CD            PIC X.
  2770        16  PD-STATE                 PIC XX.
  2771        16  PD-PRODUCT-CD            PIC XXX.
  2772        16  PD-FILLER                PIC X(7).
  2773        16  PD-BEN-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  53
* EL050.cbl
  2774        16  PD-BEN-CODE              PIC XX.
  2775        16  PD-PROD-EXP-DT           PIC XX.
  2776    12  FILLER                       PIC X(50).
  2777    12  PD-PRODUCT-DATA OCCURS 8.
  2778        16  PD-PROD-CODE             PIC X.
  2779            88  PD-PROD-LIFE           VALUE 'L'.
  2780            88  PD-PROD-PROP           VALUE 'P'.
  2781            88  PD-PROD-AH             VALUE 'A'.
  2782            88  PD-PROD-IU             VALUE 'I'.
  2783            88  PD-PROD-GAP            VALUE 'G'.
  2784            88  PD-PROD-FAML           VALUE 'F'.
  2785        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2786        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2787        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2788        16  PD-MAX-TERM              PIC S999        COMP-3.
  2789        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2790        16  FILLER                   PIC X.
  2791        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2792        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2793        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2794        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2795        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2796        16  PD-REC-CRIT-PERIOD       PIC 99.
  2797        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2798            20  PD-RECURRING-YN      PIC X.
  2799            20  FILLER               PIC X.
  2800        16  PD-RTW-MOS               PIC 99.
  2801        16  PD-MAX-EXTENSION         PIC 99.
  2802        16  FILLER                   PIC XX.
  2803    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2804    12  PD-TERM-LIMITS OCCURS 15.
  2805        16  PD-LOW-TERM              PIC S999        COMP-3.
  2806        16  PD-HI-TERM               PIC S999        COMP-3.
  2807*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2808    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2809        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2810        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2811    12  PD-EARN-FACTORS.
  2812        16  FILLER OCCURS 15.
  2813            20  FILLER OCCURS 15.
  2814                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2815    12  PD-PRODUCT-DESC              PIC X(80).
  2816    12  PD-TRUNCATED                 PIC X.
  2817    12  FILLER                       PIC X(59).
  2818    12  PD-MAINT-INFORMATION.
  2819        16  PD-LAST-MAINT-DT         PIC X(02).
  2820        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2821        16  PD-LAST-MAINT-BY         PIC X(04).
  2822*                                COPY ELCSTATE.
  2823******************************************************************
  2824*                                                                *
  2825*                                                                *
  2826*                            ELCSTATE.                           *
  2827*                                                                *
  2828*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2829*                                                                *
  2830*   FILE TYPE = VSAM,KSDS                                        *
  2831*   RECORD SIZE = 250  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  54
* EL050.cbl
  2832*                                                                *
  2833*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2834*       ALTERNATE INDEX = NONE                                   *
  2835*                                                                *
  2836*   LOG = YES                                                    *
  2837*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2838******************************************************************
  2839*                   C H A N G E   L O G
  2840*
  2841* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2842*-----------------------------------------------------------------
  2843*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2844* EFFECTIVE    NUMBER
  2845*-----------------------------------------------------------------
  2846* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2847******************************************************************
  2848*
  2849 01  STATE-FILE.
  2850     12  SF-RECORD-ID                       PIC XX.
  2851         88  VALID-CF-ID                        VALUE 'SF'.
  2852     12  SF-CONTROL-PRIMARY.
  2853         16  SF-COMPANY-ID                  PIC XXX.
  2854         16  SF-CARRIER-CODE                PIC X.
  2855         16  SF-GROUPING                    PIC X(6).
  2856         16  SF-STATE-CODE                  PIC XX.
  2857         16  SF-EXPIRE-DATE                 PIC 9(8).
  2858****************************************************************
  2859*             STATE CONTROLS
  2860****************************************************************
  2861     12  SF-LAST-MAINT-DT                   PIC XX.
  2862     12  SF-LAST-MAINT-BY                   PIC X(4).
  2863     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2864     12  SF-STATE-RT-CONTROLS.
  2865         16  SF-ST-RT-CALC                  PIC X.
  2866     12  SF-ST-TAX-CONTROLS.
  2867         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2868         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2869         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2870     12  SF-ST-REFUND-OPTIONS.
  2871         16  SF-ST-RF-LR-CALC               PIC X.
  2872         16  SF-ST-RF-LL-CALC               PIC X.
  2873         16  SF-ST-RF-LN-CALC               PIC X.
  2874         16  SF-ST-RF-AH-CALC               PIC X.
  2875         16  SF-ST-RF-CP-CALC               PIC X.
  2876     12  SF-ST-UNEARN-PREM-OPTIONS.
  2877         16  SF-ST-LUEP-R78                 PIC X.
  2878         16  SF-ST-LUEP-PRO                 PIC X.
  2879         16  SF-ST-LUEP-ST                  PIC X.
  2880         16  SF-ST-LUEP-DOM                 PIC X.
  2881         16  SF-ST-AUEP-R78                 PIC X.
  2882         16  SF-ST-AUEP-PRO                 PIC X.
  2883         16  SF-ST-AUEP-ST                  PIC X.
  2884         16  SF-ST-AUEP-DOM                 PIC X.
  2885         16  SF-ST-CUEP-R78                 PIC X.
  2886         16  SF-ST-CUEP-PRO                 PIC X.
  2887         16  SF-ST-CUEP-ST                  PIC X.
  2888         16  SF-ST-CUEP-DOM                 PIC X.
  2889     12  SF-ST-EARN-PREM-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  55
* EL050.cbl
  2890         16  SF-ST-LEP-R78                  PIC X.
  2891         16  SF-ST-LEP-PRO                  PIC X.
  2892         16  SF-ST-LEP-ST                   PIC X.
  2893         16  SF-ST-LEP-DOM                  PIC X.
  2894         16  SF-ST-AEP-R78                  PIC X.
  2895         16  SF-ST-AEP-PRO                  PIC X.
  2896         16  SF-ST-AEP-ST                   PIC X.
  2897         16  SF-ST-AEP-DOM                  PIC X.
  2898         16  SF-ST-CEP-R78                  PIC X.
  2899         16  SF-ST-CEP-PRO                  PIC X.
  2900         16  SF-ST-CEP-ST                   PIC X.
  2901         16  SF-ST-CEP-DOM                  PIC X.
  2902     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  56
* EL050.cbl
  2904*    COPY ELCCRTT.
  2905******************************************************************
  2906*                                                                *
  2907*                            ELCCRTT.                            *
  2908*                                                                *
  2909*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2910*                                                                *
  2911*   FILE TYPE = VSAM,KSDS                                        *
  2912*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2913*                                                                *
  2914*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2915*                                                                *
  2916*   LOG = YES                                                    *
  2917*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2918******************************************************************
  2919*                   C H A N G E   L O G
  2920*
  2921* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2922*-----------------------------------------------------------------
  2923*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2924* EFFECTIVE    NUMBER
  2925*-----------------------------------------------------------------
  2926* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2927* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2928* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2929* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2930* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2931* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2932* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2933******************************************************************
  2934
  2935 01  CERTIFICATE-TRAILERS.
  2936     12  CS-RECORD-ID                      PIC XX.
  2937         88  VALID-CS-ID                      VALUE 'CS'.
  2938
  2939     12  CS-CONTROL-PRIMARY.
  2940         16  CS-COMPANY-CD                 PIC X.
  2941         16  CS-CARRIER                    PIC X.
  2942         16  CS-GROUPING                   PIC X(6).
  2943         16  CS-STATE                      PIC XX.
  2944         16  CS-ACCOUNT                    PIC X(10).
  2945         16  CS-CERT-EFF-DT                PIC XX.
  2946         16  CS-CERT-NO.
  2947             20  CS-CERT-PRIME             PIC X(10).
  2948             20  CS-CERT-SFX               PIC X.
  2949         16  CS-TRAILER-TYPE               PIC X.
  2950             88  COMM-TRLR           VALUE 'A'.
  2951             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2952             88  CERT-DATA-TRLR      VALUE 'C'.
  2953
  2954     12  CS-DATA-AREA                      PIC X(516).
  2955
  2956     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2957         16  CS-BANK-COMMISSION-AREA.
  2958             20  CS-BANK-COMMS       OCCURS 10.
  2959                 24  CS-AGT                PIC X(10).
  2960                 24  CS-COM-TYP            PIC X.
  2961                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  57
* EL050.cbl
  2962                 24  CS-RECALC-LV-INDIC    PIC X.
  2963                 24  FILLER                PIC X(10).
  2964         16  FILLER                        PIC X(256).
  2965
  2966     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2967****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2968         16  CS-MB-CLAIM-DATA OCCURS 24.
  2969             20  CS-CLAIM-NO               PIC X(7).
  2970             20  CS-CLAIM-TYPE             PIC X.
  2971                 88  CS-AH-CLM               VALUE 'A'.
  2972                 88  CS-IU-CLM               VALUE 'I'.
  2973                 88  CS-GP-CLM               VALUE 'G'.
  2974                 88  CS-LF-CLM               VALUE 'L'.
  2975                 88  CS-PR-CLM               VALUE 'P'.
  2976                 88  CS-FL-CLM               VALUE 'F'.
  2977             20  CS-INSURED-TYPE           PIC X.
  2978                 88  CS-PRIM-INSURED          VALUE 'P'.
  2979                 88  CS-CO-BORROWER           VALUE 'C'.
  2980             20  CS-BENEFIT-PERIOD         PIC 99.
  2981             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2982             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2983             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2984         16  FILLER                        PIC X(12).
  2985     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2986         16  CS-VIN-NUMBER                 PIC X(17).
  2987         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2988         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2989         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2990         16  FILLER                        PIC X(496).
  2991*    COPY ELCCRTO.
  2992******************************************************************
  2993*                                                                *
  2994*                            ELCCRTO.                            *
  2995*                                                                *
  2996*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2997*                                                                *
  2998*   FILE TYPE = VSAM,KSDS                                        *
  2999*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3000*                                                                *
  3001*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3002*                                                                *
  3003*   LOG = YES                                                    *
  3004*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3005******************************************************************
  3006*                   C H A N G E   L O G
  3007*
  3008* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3009*-----------------------------------------------------------------
  3010*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3011* EFFECTIVE    NUMBER
  3012*-----------------------------------------------------------------
  3013* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3014* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3015* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3016* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3017* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3018******************************************************************
  3019 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  58
* EL050.cbl
  3020     12  OC-RECORD-ID                      PIC XX.
  3021         88  VALID-OC-ID                      VALUE 'OC'.
  3022     12  OC-CONTROL-PRIMARY.
  3023         16  OC-COMPANY-CD                 PIC X.
  3024         16  OC-CARRIER                    PIC X.
  3025         16  OC-GROUPING                   PIC X(6).
  3026         16  OC-STATE                      PIC XX.
  3027         16  OC-ACCOUNT                    PIC X(10).
  3028         16  OC-CERT-EFF-DT                PIC XX.
  3029         16  OC-CERT-NO.
  3030             20  OC-CERT-PRIME             PIC X(10).
  3031             20  OC-CERT-SFX               PIC X.
  3032         16  OC-RECORD-TYPE                PIC X.
  3033         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3034     12  OC-LAST-MAINT-DT                  PIC XX.
  3035     12  OC-LAST-MAINT-BY                  PIC X(4).
  3036     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3037     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3038     12  FILLER                            PIC X(49).
  3039     12  OC-ORIG-REC.
  3040         16  OC-INS-LAST-NAME              PIC X(15).
  3041         16  OC-INS-FIRST-NAME             PIC X(10).
  3042         16  OC-INS-MIDDLE-INIT            PIC X.
  3043         16  OC-INS-AGE                    PIC S999     COMP-3.
  3044         16  OC-JNT-LAST-NAME              PIC X(15).
  3045         16  OC-JNT-FIRST-NAME             PIC X(10).
  3046         16  OC-JNT-MIDDLE-INIT            PIC X.
  3047         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3048         16  OC-LF-BENCD                   PIC XX.
  3049         16  OC-LF-TERM                    PIC S999      COMP-3.
  3050         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3051         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3052         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3053         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3054         16  OC-LF-EXP-DT                  PIC XX.
  3055         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3056         16  OC-LF-CANCEL-DT               PIC XX.
  3057         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3058         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3059         16  OC-AH-BENCD                   PIC XX.
  3060         16  OC-AH-TERM                    PIC S999      COMP-3.
  3061         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3062         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3063         16  OC-AH-EXP-DT                  PIC XX.
  3064         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3065         16  OC-AH-CP                      PIC 99.
  3066         16  OC-AH-CANCEL-DT               PIC XX.
  3067         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3068         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3069         16  OC-CRED-BENE-NAME             PIC X(25).
  3070         16  OC-1ST-PMT-DT                 PIC XX.
  3071         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3072         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3073         16  OC-ISSUE-TRAN-IND             PIC X.
  3074         16  OC-CANCEL-TRAN-IND            PIC X.
  3075         16  FILLER                        PIC X(211).
  3076
  3077     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  59
* EL050.cbl
  3078******************************************************************
  3079
  3080*    COPY ELCDATE.
  3081******************************************************************
  3082*                                                                *
  3083*                                                                *
  3084*                            ELCDATE.                            *
  3085*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3086*                            VMOD=2.003
  3087*                                                                *
  3088*                                                                *
  3089*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3090*                 LENGTH = 200                                   *
  3091******************************************************************
  3092
  3093 01  DATE-CONVERSION-DATA.
  3094     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3095     12  DC-OPTION-CODE                PIC X.
  3096         88  BIN-TO-GREG                VALUE ' '.
  3097         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3098         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3099         88  YMD-GREG-TO-BIN            VALUE '3'.
  3100         88  MDY-GREG-TO-BIN            VALUE '4'.
  3101         88  JULIAN-TO-BIN              VALUE '5'.
  3102         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3103         88  FIND-CENTURY               VALUE '7'.
  3104         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3105         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3106         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3107         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3108         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3109         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3110         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3111         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3112         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3113         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3114         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3115         88  BIN-3-TO-GREG              VALUE 'I'.
  3116         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3117         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3118         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3119         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3120         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3121         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3122         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3123         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3124         88  THREE-CHARACTER-BIN
  3125                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3126         88  GREGORIAN-TO-BIN
  3127                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3128         88  BIN-TO-GREGORIAN
  3129                  VALUES ' ' '1' 'I' '8' 'G'.
  3130         88  JULIAN-TO-BINARY
  3131                  VALUES '5' 'C' 'E' 'F'.
  3132     12  DC-ERROR-CODE                 PIC X.
  3133         88  NO-CONVERSION-ERROR        VALUE ' '.
  3134         88  DATE-CONVERSION-ERROR
  3135                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  60
* EL050.cbl
  3136         88  DATE-IS-ZERO               VALUE '1'.
  3137         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3138         88  DATE-IS-INVALID            VALUE '3'.
  3139         88  DATE1-GREATER-DATE2        VALUE '4'.
  3140         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3141         88  DATE-INVALID-OPTION        VALUE '9'.
  3142         88  INVALID-CENTURY            VALUE 'A'.
  3143         88  ONLY-CENTURY               VALUE 'B'.
  3144         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3145         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3146     12  DC-END-OF-MONTH               PIC X.
  3147         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3148     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3149         88  USE-NORMAL-PROCESS         VALUE ' '.
  3150         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3151         88  ADJUST-UP-100-YRS          VALUE '2'.
  3152     12  FILLER                        PIC X.
  3153     12  DC-CONVERSION-DATES.
  3154         16  DC-BIN-DATE-1             PIC XX.
  3155         16  DC-BIN-DATE-2             PIC XX.
  3156         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3157         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3158                       DC-GREG-DATE-1-EDIT.
  3159             20  DC-EDIT1-MONTH        PIC 99.
  3160             20  SLASH1-1              PIC X.
  3161             20  DC-EDIT1-DAY          PIC 99.
  3162             20  SLASH1-2              PIC X.
  3163             20  DC-EDIT1-YEAR         PIC 99.
  3164         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3165         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3166                     DC-GREG-DATE-2-EDIT.
  3167             20  DC-EDIT2-MONTH        PIC 99.
  3168             20  SLASH2-1              PIC X.
  3169             20  DC-EDIT2-DAY          PIC 99.
  3170             20  SLASH2-2              PIC X.
  3171             20  DC-EDIT2-YEAR         PIC 99.
  3172         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3173         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3174                     DC-GREG-DATE-1-YMD.
  3175             20  DC-YMD-YEAR           PIC 99.
  3176             20  DC-YMD-MONTH          PIC 99.
  3177             20  DC-YMD-DAY            PIC 99.
  3178         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3179         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3180                      DC-GREG-DATE-1-MDY.
  3181             20  DC-MDY-MONTH          PIC 99.
  3182             20  DC-MDY-DAY            PIC 99.
  3183             20  DC-MDY-YEAR           PIC 99.
  3184         16  DC-GREG-DATE-1-ALPHA.
  3185             20  DC-ALPHA-MONTH        PIC X(10).
  3186             20  DC-ALPHA-DAY          PIC 99.
  3187             20  FILLER                PIC XX.
  3188             20  DC-ALPHA-CENTURY.
  3189                 24 DC-ALPHA-CEN-N     PIC 99.
  3190             20  DC-ALPHA-YEAR         PIC 99.
  3191         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3192         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3193         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  61
* EL050.cbl
  3194         16  DC-JULIAN-DATE            PIC 9(05).
  3195         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3196                                       PIC 9(05).
  3197         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3198             20  DC-JULIAN-YEAR        PIC 99.
  3199             20  DC-JULIAN-DAYS        PIC 999.
  3200         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3201         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3202         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3203     12  DATE-CONVERSION-VARIBLES.
  3204         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3205         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3206             20  FILLER                PIC 9(3).
  3207             20  HOLD-CEN-1-CCYY.
  3208                 24  HOLD-CEN-1-CC     PIC 99.
  3209                 24  HOLD-CEN-1-YY     PIC 99.
  3210             20  HOLD-CEN-1-MO         PIC 99.
  3211             20  HOLD-CEN-1-DA         PIC 99.
  3212         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3213             20  HOLD-CEN-1-R-MO       PIC 99.
  3214             20  HOLD-CEN-1-R-DA       PIC 99.
  3215             20  HOLD-CEN-1-R-CCYY.
  3216                 24  HOLD-CEN-1-R-CC   PIC 99.
  3217                 24  HOLD-CEN-1-R-YY   PIC 99.
  3218             20  FILLER                PIC 9(3).
  3219         16  HOLD-CENTURY-1-X.
  3220             20  FILLER                PIC X(3)  VALUE SPACES.
  3221             20  HOLD-CEN-1-X-CCYY.
  3222                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3223                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3224             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3225             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3226         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3227             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3228             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3229             20  HOLD-CEN-1-R-X-CCYY.
  3230                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3231                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3232             20  FILLER                PIC XXX.
  3233         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3234         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3235         16  DC-JULIAN-DATE-1          PIC 9(07).
  3236         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3237             20  DC-JULIAN-1-CCYY.
  3238                 24  DC-JULIAN-1-CC    PIC 99.
  3239                 24  DC-JULIAN-1-YR    PIC 99.
  3240             20  DC-JULIAN-DA-1        PIC 999.
  3241         16  DC-JULIAN-DATE-2          PIC 9(07).
  3242         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3243             20  DC-JULIAN-2-CCYY.
  3244                 24  DC-JULIAN-2-CC    PIC 99.
  3245                 24  DC-JULIAN-2-YR    PIC 99.
  3246             20  DC-JULIAN-DA-2        PIC 999.
  3247         16  DC-GREG-DATE-A-EDIT.
  3248             20  DC-EDITA-MONTH        PIC 99.
  3249             20  SLASHA-1              PIC X VALUE '/'.
  3250             20  DC-EDITA-DAY          PIC 99.
  3251             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  62
* EL050.cbl
  3252             20  DC-EDITA-CCYY.
  3253                 24  DC-EDITA-CENT     PIC 99.
  3254                 24  DC-EDITA-YEAR     PIC 99.
  3255         16  DC-GREG-DATE-B-EDIT.
  3256             20  DC-EDITB-MONTH        PIC 99.
  3257             20  SLASHB-1              PIC X VALUE '/'.
  3258             20  DC-EDITB-DAY          PIC 99.
  3259             20  SLASHB-2              PIC X VALUE '/'.
  3260             20  DC-EDITB-CCYY.
  3261                 24  DC-EDITB-CENT     PIC 99.
  3262                 24  DC-EDITB-YEAR     PIC 99.
  3263         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3264         16  DC-GREG-DATE-CYMD-R REDEFINES
  3265                              DC-GREG-DATE-CYMD.
  3266             20  DC-CYMD-CEN           PIC 99.
  3267             20  DC-CYMD-YEAR          PIC 99.
  3268             20  DC-CYMD-MONTH         PIC 99.
  3269             20  DC-CYMD-DAY           PIC 99.
  3270         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3271         16  DC-GREG-DATE-MDCY-R REDEFINES
  3272                              DC-GREG-DATE-MDCY.
  3273             20  DC-MDCY-MONTH         PIC 99.
  3274             20  DC-MDCY-DAY           PIC 99.
  3275             20  DC-MDCY-CEN           PIC 99.
  3276             20  DC-MDCY-YEAR          PIC 99.
  3277    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3278        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3279    12  DC-EL310-DATE                  PIC X(21).
  3280    12  FILLER                         PIC X(28).
  3281
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  63
* EL050.cbl
  3283*    COPY ELCCALC.
  3284******************************************************************
  3285*                                                                *
  3286*                           ELCCALC.                            *
  3287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3288*                            VMOD=2.025                          *
  3289*                                                                *
  3290*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3291*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3292*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3293*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3294*                                                                *
  3295*  PASSED TO ELRTRM                                              *
  3296*  -----------------                                             *
  3297*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3298*  ORIGINAL TERM                                                 *
  3299*  BEGINNING DATE                                                *
  3300*  ENDING DATE                                                   *
  3301*  COMPANY I.D.                                                  *
  3302*  ACCOUNT MASTER USER FIELD                                     *
  3303*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3304*  FREE LOOK DAYS                                                *
  3305*                                                                *
  3306*  RETURNED FROM ELRTRM                                          *
  3307*  ---------------------                                         *
  3308*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3309*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3310*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3311*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3312*----------------------------------------------------------------*
  3313*  PASSED TO ELRAMT                                              *
  3314*  ----------------                                              *
  3315*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3316*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3317*  ORIGINAL AMOUNT                                               *
  3318*  ALTERNATE BENEFIT (BALLON)                                    *
  3319*  A.P.R. - NET PAY ONLY                                         *
  3320*  METHOD
  3321*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3322*  COMPANY I.D.                                                  *
  3323*  BENEFIT TYPE                                                  *
  3324*                                                                *
  3325*  RETURNED FROM ELRAMT                                          *
  3326*  --------------------                                          *
  3327*  REMAINING AMOUNT 1 - CURRENT                                  *
  3328*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3329*  REMAINING AMOUNT FACTOR
  3330*----------------------------------------------------------------*
  3331*  PASSED TO ELRESV                                              *
  3332*  -----------------                                             *
  3333*  CERTIFICATE EFFECTIVE DATE                                    *
  3334*  VALUATION DATE                                                *
  3335*  PAID THRU DATE                                                *
  3336*  BENEFIT                                                       *
  3337*  INCURRED DATE                                                 *
  3338*  REPORTED DATE                                                 *
  3339*  ISSUE AGE                                                     *
  3340*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  64
* EL050.cbl
  3341*  CDT PERCENT                                                   *
  3342*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3343* *CLAIM TYPE (LIFE, A/H)                                        *
  3344* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3345* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3346*                                                                *
  3347*  RETURNED FROM ELRESV                                          *
  3348*  --------------------                                          *
  3349*  CDT TABLE USED                                                *
  3350*  CDT FACTOR USED                                               *
  3351*  PAY TO CURRENT RESERVE                                        *
  3352*  I.B.N.R. - A/H ONLY                                           *
  3353*  FUTURE (ACCRUED) AH ONLY                                      *
  3354*----------------------------------------------------------------*
  3355*  PASSED TO ELRATE                                              *
  3356*  ----------------                                              *
  3357*  CERT ISSUE DATE                                               *
  3358*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3359*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3360*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3361*  STATE CODE (CLIENT DEFINED)                                   *
  3362*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3363*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3364*  DEVIATION CODE                                                *
  3365*  ISSUE AGE                                                     *
  3366*  ORIGINAL BENEFIT AMOUNT                                       *
  3367*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3368*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3369*  BENEFIT KIND (LIFE OR A/H)                                    *
  3370*  A.P.R.                                                        *
  3371*  METHOD
  3372*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3373*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3374*  COMPANY I.D. (3 CHARACTER)                                    *
  3375*  BENEFIT CODE                                                  *
  3376*  BENEFIT OVERRIDE CODE                                         *
  3377*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3378*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3379*  JOINT INDICATOR (CSL ONLY)                                    *
  3380*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3381*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3382*                                                                *
  3383*  RETURNED FROM ELRATE                                          *
  3384*  --------------------                                          *
  3385*  CALCULATED PREMIUM                                            *
  3386*  PREMIUM RATE                                                  *
  3387*  MORTALITY CODE                                                *
  3388*  MAX ATTAINED AGE                                              *
  3389*  MAX AGE                                                       *
  3390*  MAX TERM                                                      *
  3391*  MAX MONTHLY BENEFIT                                           *
  3392*  MAX TOTAL BENIFIT                                             *
  3393*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3394*----------------------------------------------------------------*
  3395*  PASSED TO ELRFND                                              *
  3396*  ----------------                                              *
  3397*  CERT ISSUE DATE                                               *
  3398*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  65
* EL050.cbl
  3399*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3400*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3401*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3402*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3403*  STATE CODE (CLIENT DEFINED)                                   *
  3404*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3405*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3406*  DEVIATION CODE                                                *
  3407*  ISSUE AGE                                                     *
  3408*  ORIGINAL BENEFIT AMOUNT                                       *
  3409*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3410*  PROCESS TYPE (CANCEL)                                         *
  3411*  BENEFIT KIND (LIFE OR A/H)                                    *
  3412*  A.P.R.                                                        *
  3413*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3414*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3415*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3416*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3417*  COMPANY I.D. (3 CHARACTER)                                    *
  3418*  BENEFIT CODE                                                  *
  3419*  BENEFIT OVERRIDE CODE                                         *
  3420*                                                                *
  3421*  RETURNED FROM ELRFND                                          *
  3422*  --------------------                                          *
  3423*  CALCULATED REFUND                                             *
  3424*----------------------------------------------------------------*
  3425*  PASSED TO ELEARN                                              *
  3426*  ----------------                                              *
  3427*  CERT ISSUE DATE                                               *
  3428*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3429*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3430*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3431*  STATE CODE (CLIENT DEFINED)                                   *
  3432*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3433*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3434*  DEVIATION CODE                                                *
  3435*  ISSUE AGE                                                     *
  3436*  ORIGINAL BENEFIT AMOUNT                                       *
  3437*  BENEFIT KIND (LIFE OR A/H)                                    *
  3438*  A.P.R.                                                        *
  3439*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3440*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3441*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3442*  COMPANY I.D. (3 CHARACTER)                                    *
  3443*  BENEFIT CODE                                                  *
  3444*  BENEFIT OVERRIDE CODE                                         *
  3445*                                                                *
  3446*  RETURNED FROM ELEARN                                          *
  3447*  --------------------                                          *
  3448*  INDICATED  EARNINGS                                           *
  3449*----------------------------------------------------------------*
  3450*                 LENGTH = 450                                   *
  3451*                                                                *
  3452******************************************************************
  3453******************************************************************
  3454*                   C H A N G E   L O G
  3455*
  3456* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  66
* EL050.cbl
  3457*-----------------------------------------------------------------
  3458*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3459* EFFECTIVE    NUMBER
  3460*-----------------------------------------------------------------
  3461* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3462* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3463* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3464* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3465* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3466* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3467* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3468* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3469* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3470******************************************************************
  3471
  3472 01  CALCULATION-PASS-AREA.
  3473     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3474                                     COMP.
  3475
  3476     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3477       88  NO-CP-ERROR                             VALUE ZERO.
  3478       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3479                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3480       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3481       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3482       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3483       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3484       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3485       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3486       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3487       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3488       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3489       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3490       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3491       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3492       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3493       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3494       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3495       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3496       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3497
  3498     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3499       88  NO-CP-ERROR-2                           VALUE ZERO.
  3500***********************  INPUT AREAS ****************************
  3501
  3502     12  CP-CALCULATION-AREA.
  3503         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3504         16  CP-CERT-EFF-DT        PIC XX.
  3505         16  CP-VALUATION-DT       PIC XX.
  3506         16  CP-PAID-THRU-DT       PIC XX.
  3507         16  CP-BENEFIT-TYPE       PIC X.
  3508           88  CP-AH                               VALUE 'A' 'D'
  3509                                                   'I' 'U'.
  3510           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3511           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3512         16  CP-INCURRED-DT        PIC XX.
  3513         16  CP-REPORTED-DT        PIC XX.
  3514         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  67
* EL050.cbl
  3515         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3516         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3517                                     COMP-3.
  3518         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3519                                     COMP-3.
  3520         16  CP-CDT-METHOD         PIC X.
  3521           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3522           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3523           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3524         16  CP-CLAIM-TYPE         PIC X.
  3525           88  CP-AH-CLAIM                         VALUE 'A'.
  3526           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3527         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3530                                     COMP-3.
  3531         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3532                                     COMP-3.
  3533         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3534                                     COMP-3.
  3535         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3536                                     COMP-3.
  3537         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3538                                     COMP-3.
  3539         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3540                                     COMP-3.
  3541         16  CP-REM-TERM-METHOD    PIC X.
  3542           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3543           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3544           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3545           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3546           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3547           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3548           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3549         16  CP-EARNING-METHOD     PIC X.
  3550           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3551           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3552           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3553           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3554           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3555           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3556           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3557           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3558           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3559           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3560           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3561           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3562           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3563           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3564         16  CP-PROCESS-TYPE       PIC X.
  3565           88  CP-CLAIM                            VALUE '1'.
  3566           88  CP-CANCEL                           VALUE '2'.
  3567           88  CP-ISSUE                            VALUE '3'.
  3568         16  CP-SPECIAL-CALC-CD    PIC X.
  3569           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3570           88  CP-1-MTH-INTEREST               VALUE ' '.
  3571           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3572           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  68
* EL050.cbl
  3573           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3574           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3575           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3576           88  CP-FARM-PLAN                    VALUE 'F'.
  3577           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3578           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3579           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3580           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3581           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3582           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3583           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3584           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3585           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3586           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3587                                                     'W' 'X'.
  3588           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3589           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3590           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3591           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3592           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3593           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3594           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3595           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3596           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3597           88  CP-CSL-METH-1                   VALUE '5'.
  3598           88  CP-CSL-METH-2                   VALUE '6'.
  3599           88  CP-CSL-METH-3                   VALUE '7'.
  3600           88  CP-CSL-METH-4                   VALUE '8'.
  3601
  3602         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3603                                     COMP-3.
  3604         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3605         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3606         16  CP-STATE              PIC XX          VALUE SPACE.
  3607         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3608         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3609           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3610               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3611         16  CP-R78-OPTION         PIC X.
  3612           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3613           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3614
  3615         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3616         16  CP-IBNR-RESERVE-SW    PIC X.
  3617         16  CP-CLAIM-STATUS       PIC X.
  3618         16  CP-RATE-FILE          PIC X.
  3619         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3620                                     COMP-3.
  3621
  3622         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3623         16  CP-AH-OVERRIDE-CODE   PIC X.
  3624
  3625         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3626                                     COMP-3.
  3627         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3628                                   PIC S9(5)V99 COMP-3.
  3629         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3630                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  69
* EL050.cbl
  3631         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3632                                     COMP-3.
  3633         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3634                                     COMP-3.
  3635         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3636                                  PIC S9(7)V99 COMP-3.
  3637
  3638         16  CP-PAID-FROM-DATE     PIC X(02).
  3639         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3640         16  CP-EXT-DAYS-CALC      PIC X.
  3641           88  CP-EXT-NO-CHG                   VALUE ' '.
  3642           88  CP-EXT-CHG-LF                   VALUE '1'.
  3643           88  CP-EXT-CHG-AH                   VALUE '2'.
  3644           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3645         16  CP-DOMICILE-STATE     PIC XX.
  3646         16  CP-CARRIER            PIC X.
  3647         16  CP-REIN-FLAG          PIC X.
  3648         16  CP-REM-TRM-CALC-OPTION PIC X.
  3649           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3650                      '2' '3' '4' '5'.
  3651           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3652           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3653           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3654           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3655           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3656           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3657           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3658           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3659         16  CP-SIG-SWITCH         PIC X.
  3660         16  CP-RATING-METHOD      PIC X.
  3661           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3662           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3663           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3664           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3665           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3666           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3667           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3668           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3669           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3670         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3671                                     COMP-3.
  3672         16  CP-BEN-CATEGORY       PIC X.
  3673         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3674         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3675                                   PIC S99V9(5) COMP-3.
  3676         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3677         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3678                                   PIC S99V9(5) COMP-3.
  3679         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3680         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3681         16  CP-EXPIRE-DT          PIC XX.
  3682         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3683         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3684         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3685         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3686         16  CP-DDF-SPEC-CALC      PIC X.
  3687             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3688             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  70
* EL050.cbl
  3689         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3690         16  CP-CANCEL-REASON      PIC X.
  3691         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3692         16  CP-PMT-MODE           PIC X.
  3693         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3694         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3695         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3696         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3697         16  FILLER                PIC X.
  3698
  3699***************    OUTPUT FROM ELRESV   ************************
  3700
  3701         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3702
  3703         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3704                                     COMP-3.
  3705         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3706                                     COMP-3.
  3707         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  FILLER                PIC X(09).
  3712***************    OUTPUT FROM ELRTRM   *************************
  3713
  3714         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3719                                     COMP-3.
  3720         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3721                                     COMP-3.
  3722         16  FILLER                PIC X(12).
  3723
  3724***************    OUTPUT FROM ELRAMT   *************************
  3725
  3726         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3727                                     COMP-3.
  3728         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3729                                     COMP-3.
  3730         16  FILLER                PIC X(12).
  3731
  3732***************    OUTPUT FROM ELRATE   *************************
  3733
  3734         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-MORTALITY-CODE     PIC X(4).
  3739         16  CP-RATE-EDIT-FLAG     PIC X.
  3740             88  CP-RATES-NEED-APR                  VALUE '1'.
  3741         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3742                                     COMP-3.
  3743         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3744         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3745         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3746                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  71
* EL050.cbl
  3747         16  FILLER                PIC X(07).
  3748
  3749***************    OUTPUT FROM ELRFND   *************************
  3750
  3751         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3752                                     COMP-3.
  3753         16  CP-REFUND-TYPE-USED   PIC X.
  3754           88  CP-R-AS-R78                         VALUE '1'.
  3755           88  CP-R-AS-PRORATA                     VALUE '2'.
  3756           88  CP-R-AS-CALIF                       VALUE '3'.
  3757           88  CP-R-AS-TEXAS                       VALUE '4'.
  3758           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3759           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3760           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3761           88  CP-R-AS-MEAN                        VALUE '8'.
  3762           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3763           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3764           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3765           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3766           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3767           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3768         16  FILLER                PIC X(12).
  3769
  3770***************    OUTPUT FROM ELEARN   *************************
  3771
  3772         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3773                                     COMP-3.
  3774         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3775                                     COMP-3.
  3776         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3783                                     COMP-3.
  3784         16  CP-EARNING-TYPE-USED  PIC X.
  3785           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3786           88  CP-E-AS-R78                         VALUE '1'.
  3787           88  CP-E-AS-PRORATA                     VALUE '2'.
  3788           88  CP-E-AS-TEXAS                       VALUE '4'.
  3789           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3790           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3791           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3792           88  CP-E-AS-MEAN                        VALUE '8'.
  3793           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3794         16  FILLER                PIC X(12).
  3795
  3796***************    OUTPUT FROM ELPMNT   *************************
  3797
  3798         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3799                                     COMP-3.
  3800         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3801                                     COMP-3.
  3802         16  FILLER                PIC X(12).
  3803
  3804***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  72
* EL050.cbl
  3805         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3806                                     COMP-3.
  3807         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3808                                     COMP-3.
  3809         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3814                                     COMP-3.
  3815         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3816                                     COMP-3.
  3817         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3818             88  OPEN-RATE-FILE                   VALUE 'O'.
  3819             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3820             88  IO-ERROR                         VALUE 'E'.
  3821
  3822         16  CP-FIRST-PAY-DATE     PIC XX.
  3823
  3824         16  CP-JOINT-INDICATOR    PIC X.
  3825
  3826         16  CP-RESERVE-REMAINING-TERM
  3827                                   PIC S9(4)V9    VALUE ZERO
  3828                                     COMP-3.
  3829
  3830         16  CP-INSURED-BIRTH-DT   PIC XX.
  3831
  3832         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3833                                     COMP-3.
  3834
  3835         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3836                                     COMP-3.
  3837
  3838         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3839                                     COMP-3.
  3840
  3841         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3842                                     COMP-3.
  3843
  3844         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3845                                     COMP-3.
  3846
  3847         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3848                                     COMP-3.
  3849
  3850         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3851                                     COMP-3.
  3852
  3853         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3854             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3855
  3856         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3857                                     COMP-3.
  3858         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3859                                     COMP-3.
  3860         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3861         16  FILLER                PIC X(15).
  3862******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  73
* EL050.cbl
  3864******************************************************************
  3865*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3866*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3867*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3868*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3869*** MODIFICATION.                                              ***
  3870*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3871*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3872******************************************************************
  3873*    COPY ERCPNDB.
  3874******************************************************************
  3875*                                                                *
  3876*                                                                *
  3877*                            ERCPNDB.                            *
  3878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3879*                            VMOD=2.025                          *
  3880*                                                                *
  3881*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3882*                                                                *
  3883******************************************************************
  3884*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3885*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3886******************************************************************
  3887*                                                                *
  3888*                                                                *
  3889*   FILE TYPE = VSAM,KSDS                                        *
  3890*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3891*                                                                *
  3892*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3893*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3894*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3895*                                                 RKP=13,LEN=36  *
  3896*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3897*                                      AND CHG-SEQ.)             *
  3898*                                                RKP=49,LEN=11   *
  3899*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3900*                                      AND CHG-SEQ.)             *
  3901*                                                RKP=60,LEN=15   *
  3902*                                                                *
  3903*   LOG = NO                                                     *
  3904*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3905******************************************************************
  3906******************************************************************
  3907*                   C H A N G E   L O G
  3908*
  3909* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3910*-----------------------------------------------------------------
  3911*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3912* EFFECTIVE    NUMBER
  3913*-----------------------------------------------------------------
  3914* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3915* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3916* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3917* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3918* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3919* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3920* 032306                   PEMA  ADD BOW LOAN NUMBER
  3921* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  74
* EL050.cbl
  3922* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3923* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3924* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3925* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3926* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3927* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3928* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3929******************************************************************
  3930
  3931 01  PENDING-BUSINESS.
  3932     12  PB-RECORD-ID                     PIC XX.
  3933         88  VALID-PB-ID                        VALUE 'PB'.
  3934
  3935     12  PB-CONTROL-PRIMARY.
  3936         16  PB-COMPANY-CD                PIC X.
  3937         16  PB-ENTRY-BATCH               PIC X(6).
  3938         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3939         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3940
  3941     12  PB-CONTROL-BY-ACCOUNT.
  3942         16  PB-COMPANY-CD-A1             PIC X.
  3943         16  PB-CARRIER                   PIC X.
  3944         16  PB-GROUPING.
  3945             20  PB-GROUPING-PREFIX       PIC XXX.
  3946             20  PB-GROUPING-PRIME        PIC XXX.
  3947         16  PB-STATE                     PIC XX.
  3948         16  PB-ACCOUNT.
  3949             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3950             20  PB-ACCOUNT-PRIME         PIC X(6).
  3951         16  PB-CERT-EFF-DT               PIC XX.
  3952         16  PB-CERT-NO.
  3953             20  PB-CERT-PRIME            PIC X(10).
  3954             20  PB-CERT-SFX              PIC X.
  3955         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3956
  3957         16  PB-RECORD-TYPE               PIC X.
  3958             88  PB-MAILING-DATA                VALUE '0'.
  3959             88  PB-ISSUE                       VALUE '1'.
  3960             88  PB-CANCELLATION                VALUE '2'.
  3961             88  PB-BATCH-TRAILER               VALUE '9'.
  3962
  3963     12  PB-CONTROL-BY-ORIG-BATCH.
  3964         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3965         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3966         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3967         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3968
  3969     12  PB-CONTROL-BY-CSR.
  3970         16  PB-CSR-COMPANY-CD            PIC X.
  3971         16  PB-CSR-ID                    PIC X(4).
  3972         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3973         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3974         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3975******************************************************************
  3976*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3977******************************************************************
  3978
  3979     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  75
* EL050.cbl
  3980     12  PB-LAST-MAINT-BY                 PIC X(4).
  3981     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3982
  3983     12  PB-RECORD-BODY                   PIC X(375).
  3984
  3985     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3986         16  PB-CERT-ORIGIN               PIC X.
  3987             88  CLASIC-CREATED-CERT         VALUE '1'.
  3988         16  PB-I-NAME.
  3989             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3990             20  PB-I-INSURED-FIRST-NAME.
  3991                 24  PB-I-INSURED-1ST-INIT PIC X.
  3992                 24  FILLER                PIC X(9).
  3993             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3994         16  PB-I-AGE                     PIC S99   COMP-3.
  3995         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3996         16  PB-I-BIRTHDAY                PIC XX.
  3997         16  PB-I-INSURED-SEX             PIC X.
  3998             88  PB-SEX-MALE     VALUE 'M'.
  3999             88  PB-SEX-FEMALE   VALUE 'F'.
  4000
  4001         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4002         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4003         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4004         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4005         16  PB-I-SKIP-CODE               PIC X.
  4006             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4007             88  PB-SKIP-JULY              VALUE '1'.
  4008             88  PB-SKIP-AUGUST            VALUE '2'.
  4009             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4010             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4011             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4012             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4013             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4014             88  PB-SKIP-JUNE              VALUE '8'.
  4015             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4016             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4017             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4018         16  PB-I-TERM-TYPE               PIC X.
  4019             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4020             88  PB-PAID-WEEKLY            VALUE 'W'.
  4021             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4022             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4023             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4024         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4025         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4026         16  PB-I-DATA-ENTRY-SW           PIC X.
  4027             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4028             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4029             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4030             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4031         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4032         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4033*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4034         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4035         16  FILLER                       PIC X.
  4036
  4037         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  76
* EL050.cbl
  4038             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4039             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4040                                                   '90' THRU '99'.
  4041         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4042                                          PIC XX.
  4043         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4044         16  PB-I-AMOUNT-FINANCED REDEFINES
  4045                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4046         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4047         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4048                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4049         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4050         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4051         16  PB-I-CLP-AMOUNT REDEFINES
  4052                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4053         16  PB-I-LF-CALC-FLAG            PIC X.
  4054             88 PB-COMP-LF-PREM               VALUE '?'.
  4055         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4056         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4057         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4058         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4059         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4060         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4061         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4062         16  PB-I-LF-ABBR                 PIC XXX.
  4063         16  PB-I-LF-INPUT-CD             PIC XX.
  4064
  4065         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4066             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4067             88  PB-INVALID-AH               VALUE '  ' '00'
  4068                                                   '90' THRU '99'.
  4069         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4070         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4071         16  PB-I-AH-CALC-FLAG            PIC X.
  4072             88 PB-COMP-AH-PREM                  VALUE '?'.
  4073         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4074         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4075         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4076         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4077         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4078         16  PB-I-AH-ABBR                 PIC XXX.
  4079         16  PB-I-AH-INPUT-CD             PIC XXX.
  4080
  4081         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4082         16  PB-I-REIN-TABLE              PIC XXX.
  4083         16  PB-I-BUSINESS-TYPE           PIC 99.
  4084         16  PB-I-INDV-GRP-CD             PIC X.
  4085         16  PB-I-MORT-CODE.
  4086             20  PB-I-TABLE               PIC X.
  4087             20  PB-I-INTEREST            PIC XX.
  4088             20  PB-I-MORT-TYP            PIC X.
  4089         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4090         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4091         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4092         16  PB-I-INDV-GRP-OVRD           PIC X.
  4093         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4094         16  PB-I-SIG-SW                  PIC X.
  4095             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  77
* EL050.cbl
  4096         16  PB-I-RATE-CLASS              PIC XX.
  4097         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4098         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4099         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4100         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4101         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4102         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4103         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4104         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4105         16  PB-I-OB-FLAG                 PIC X.
  4106             88  PB-I-OB                      VALUE 'B'.
  4107             88  PB-I-SUMMARY                 VALUE 'Z'.
  4108         16  PB-I-ENTRY-STATUS            PIC X.
  4109             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4110                                              'M' '5' '9' '2'.
  4111             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4112             88  PB-I-POLICY-PENDING          VALUE '2'.
  4113             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4114             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4115             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4116             88  PB-I-REIN-ONLY               VALUE '9'.
  4117             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4118             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4119             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4120             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4121         16  PB-I-INT-CODE                PIC X.
  4122             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4123             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4124         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4125         16  PB-I-SOC-SEC-NO              PIC X(11).
  4126         16  PB-I-MEMBER-NO               PIC X(12).
  4127         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4128*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4129         16  PB-I-OLD-LOF                 PIC XXX.
  4130         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4131         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4132         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4133         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4134         16  PB-I-LIFE-INDICATOR          PIC X.
  4135             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4136         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4137         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4138                                          PIC S9(5)V99    COMP-3.
  4139         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4140             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4141             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4142         16  PB-I-1ST-PMT-DT              PIC XX.
  4143         16  PB-I-JOINT-INSURED.
  4144             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4145             20 PB-I-JOINT-FIRST-NAME.
  4146                24  PB-I-JOINT-FIRST-INIT PIC X.
  4147                24  FILLER                PIC X(9).
  4148             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4149*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4150         16  PB-I-BENEFICIARY-NAME.
  4151             20  PB-I-BANK-NUMBER         PIC X(10).
  4152             20  FILLER                   PIC X(15).
  4153         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  78
* EL050.cbl
  4154         16  PB-I-REFERENCE               PIC X(12).
  4155         16  FILLER REDEFINES PB-I-REFERENCE.
  4156             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4157             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4158             20  PB-I-CLP-STATE           PIC XX.
  4159         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4160             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4161             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4162             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4163         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4164         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4165         16  PB-I-RESIDENT-STATE          PIC XX.
  4166         16  PB-I-RATE-CODE               PIC X(4).
  4167         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4168         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4169         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4170         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4171         16  PB-I-BANK-NOCHRGB            PIC 99.
  4172         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4173         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4174
  4175     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4176         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4177             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4178         16  PB-C-CANCEL-ORIGIN           PIC X.
  4179             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4180         16  PB-C-LF-CANCEL-DT            PIC XX.
  4181         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4182         16  PB-C-LF-CALC-REQ             PIC X.
  4183             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4184         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4185         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4186         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4187             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4188         16  PB-C-AH-CANCEL-DT            PIC XX.
  4189         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4190         16  PB-C-AH-CALC-REQ             PIC X.
  4191             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4192         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4193         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4194         16  PB-C-LAST-NAME               PIC X(15).
  4195         16  PB-C-REFUND-SW               PIC X.
  4196             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4197             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4198         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4199         16  PB-C-PAYEE-CODE              PIC X(6).
  4200         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4201         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4202         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4203         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4204         16  PB-C-REFERENCE               PIC X(12).
  4205         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4206         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4207         16  PB-C-POST-CARD-IND           PIC X.
  4208         16  PB-C-CANCEL-REASON           PIC X.
  4209         16  PB-C-REF-INTERFACE-SW        PIC X.
  4210         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4211         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  79
* EL050.cbl
  4212         16  FILLER                       PIC X(01).
  4213*        16  FILLER                       PIC X(18).
  4214         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4215*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4216         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4217         16  PB-CANCELED-CERT-DATA.
  4218             20  PB-CI-INSURED-NAME.
  4219                 24  PB-CI-LAST-NAME      PIC X(15).
  4220                 24  PB-CI-INITIALS       PIC XX.
  4221             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4222             20  PB-CI-INSURED-SEX        PIC X.
  4223             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4224             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4225             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4226             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4227             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4228             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4229             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4230             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4231             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4232             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4233             20  PB-CI-RATE-CLASS         PIC XX.
  4234             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4235             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4236             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4237             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4238             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4239             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4240             20  PB-CI-LF-ABBR            PIC X(3).
  4241             20  PB-CI-AH-ABBR            PIC X(3).
  4242             20  PB-CI-OB-FLAG            PIC X.
  4243                 88  PB-CI-OB                VALUE 'B'.
  4244             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4245                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4246                                           'M' '4' '5' '9' '2'.
  4247                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4248                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4249                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4250                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4251                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4252                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4253                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4254                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4255                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4256                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4257                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4258                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4259             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4260                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4261                                           'M' '4' '5' '9' '2'.
  4262                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4263                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4264                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4265                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4266                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4267                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4268                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4269                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  80
* EL050.cbl
  4270                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4271                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4272                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4273                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4274             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4275             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4276             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4277             20  PB-CI-MEMBER-NO          PIC X(12).
  4278             20  PB-CI-INT-CODE           PIC X.
  4279                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4280                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4281             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4282             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4283             20  PB-CI-COMP-EXCP-SW       PIC X.
  4284                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4285                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4286             20  PB-CI-ENTRY-STATUS       PIC X.
  4287             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4288             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4289             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4290             20  PB-CI-DEATH-DT           PIC XX.
  4291             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4292             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4293             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4294             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4295             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4296             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4297             20  PB-CI-ENTRY-DT              PIC XX.
  4298             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4299             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4300             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4301             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4302             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4303             20  PB-CI-OLD-LOF               PIC XXX.
  4304*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4305             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4306             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4307             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4308             20  PB-CI-INDV-GRP-CD           PIC X.
  4309             20  PB-CI-BENEFICIARY-NAME.
  4310                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4311                 24  FILLER                  PIC X(15).
  4312             20  PB-CI-NOTE-SW               PIC X.
  4313             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4314             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4315             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4316             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4317             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4318             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4319             20  PB-CI-FIRST-NAME            PIC X(10).
  4320             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4321
  4322         16  FILLER                       PIC X(13).
  4323*032306  16  FILLER                       PIC X(27).
  4324*        16  FILLER                       PIC X(46).
  4325
  4326     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4327         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  81
* EL050.cbl
  4328         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4329         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4330         16  PB-M-INSURED-MID-INIT        PIC X.
  4331         16  PB-M-INSURED-AGE             PIC 99.
  4332         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4333         16  PB-M-INSURED-SEX             PIC X.
  4334         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4335         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4336         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4337         16  PB-M-INSURED-CITY-STATE.
  4338             20  PB-M-INSURED-CITY        PIC X(28).
  4339             20  PB-M-INSURED-STATE       PIC XX.
  4340         16  PB-M-INSURED-ZIP-CODE.
  4341             20  PB-M-INSURED-ZIP-PRIME.
  4342                 24  PB-M-INSURED-ZIP-1   PIC X.
  4343                     88  PB-M-CANADIAN-POST-CODE
  4344                                             VALUE 'A' THRU 'Z'.
  4345                 24  FILLER               PIC X(4).
  4346             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4347         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4348                                        PB-M-INSURED-ZIP-CODE.
  4349             20  PM-M-INS-CAN-POST1       PIC XXX.
  4350             20  PM-M-INS-CAN-POST2       PIC XXX.
  4351             20  FILLER                   PIC XXX.
  4352         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4353         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4354         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4355         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4356         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4357         16  PB-M-CRED-BENE-CITYST.
  4358             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4359             20  PB-M-CRED-BENE-STATE     PIC XX.
  4360         16  FILLER                       PIC X(92).
  4361
  4362     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4363         16  FILLER                       PIC X(10).
  4364         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4365         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4366         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4367         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4368         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4369         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4370         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4371         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4372         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4373         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4374         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4375         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4376         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4377         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4378         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4379         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4380         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4381         16  PB-ACCOUNT-NAME              PIC X(30).
  4382         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4383         16  PB-REFERENCE                 PIC X(12).
  4384         16  PB-B-RECEIVED-DT             PIC XX.
  4385         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  82
* EL050.cbl
  4386
  4387     12  PB-RECORD-STATUS.
  4388         16  PB-CREDIT-SELECT-DT          PIC XX.
  4389         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4390         16  PB-BILLED-DT                 PIC XX.
  4391         16  PB-BILLING-STATUS            PIC X.
  4392             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4393             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4394             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4395         16  PB-RECORD-BILL               PIC X.
  4396             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4397             88  PB-RECORD-RETURNED           VALUE 'R'.
  4398             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4399             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4400             88  PB-OVERRIDE-AH               VALUE 'A'.
  4401             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4402         16  PB-BATCH-ENTRY               PIC X.
  4403             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4404             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4405             88  PB-REISSUED-CERT             VALUE 'E'.
  4406             88  PB-MONTHLY-CERT              VALUE 'M'.
  4407             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4408             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4409             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4410         16  PB-FORCE-CODE                PIC X.
  4411             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4412             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4413             88  PB-CANCEL-FORCE              VALUE '8'.
  4414             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4415             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4416             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4417             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4418             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4419             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4420             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4421         16  PB-FATAL-FLAG                PIC X.
  4422             88  PB-FATAL-ERRORS              VALUE 'X'.
  4423         16  PB-FORCE-ER-CD               PIC X.
  4424             88  PB-FORCE-ERRORS              VALUE 'F'.
  4425             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4426         16  PB-WARN-ER-CD                PIC X.
  4427             88  PB-WARNING-ERRORS            VALUE 'W'.
  4428         16  FILLER                       PIC X.
  4429         16  PB-OUT-BAL-CD                PIC X.
  4430             88  PB-OUT-OF-BAL                VALUE 'O'.
  4431         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4432         16  PB-AH-OVERRIDE-L1            PIC X.
  4433         16  PB-INPUT-DT                  PIC XX.
  4434         16  PB-INPUT-BY                  PIC X(4).
  4435         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4436         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4437         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4438         16  PB-LF-EARNING-METHOD         PIC X.
  4439         16  PB-AH-EARNING-METHOD         PIC X.
  4440         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4441         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4442         16  PB-REIN-CD                   PIC XXX.
  4443         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  83
* EL050.cbl
  4444         16  PB-AH-REFUND-TYPE            PIC X.
  4445         16  PB-ACCT-EFF-DT               PIC XX.
  4446         16  PB-ACCT-EXP-DT               PIC XX.
  4447         16  PB-COMPANY-ID                PIC X(3).
  4448         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4449         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4450         16  PB-SV-CARRIER                PIC X.
  4451         16  PB-SV-GROUPING               PIC X(6).
  4452         16  PB-SV-STATE                  PIC XX.
  4453         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4454         16  PB-GA-BILLING-INFO.
  4455             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4456                                          PIC XX.
  4457         16  PB-SV-REMIT-TO  REDEFINES
  4458             PB-GA-BILLING-INFO           PIC X(10).
  4459         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4460         16  PB-I-LOAN-OFFICER            PIC X(5).
  4461         16  PB-I-VIN                     PIC X(17).
  4462
  4463         16  FILLER                       PIC X(04).
  4464         16  IMNET-BYPASS-SW              PIC X.
  4465
  4466******************************************************************
  4467*                COMMON EDIT ERRORS                              *
  4468******************************************************************
  4469
  4470     12  PB-COMMON-ERRORS.
  4471         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4472                                           PIC S9(4)     COMP.
  4473
  4474******************************************************************
  4475
  4476* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4477*    COPY ELC50W1.
  4478******************************************************************
  4479*                                                                *
  4480*                                                                *
  4481*                             ELC50W1                            *
  4482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4483*                            VMOD=2.004                          *
  4484*                                                                *
  4485*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4486*                                                                *
  4487*                                                                *
  4488******************************************************************
  4489
  4490     12  WK-WORK-AREA.
  4491         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4492         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4493         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4494         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4495         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4496         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4497         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4498         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4499         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4500         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4501         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  84
* EL050.cbl
  4502         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4503         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4504         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4505         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4506         16  WK-CREDIT-EDIT-CONTROLS.
  4507             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4508             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4509             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4510             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4511             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4512             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4513         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4514         16  WK-SAVE-REIN-DATA.
  4515             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4516             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4517             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4518         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4519             88  ENTRY-FROM-EL6311       VALUE '6'.
  4520         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4521         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4522     12  WK-RECORD-ADDRESSES.
  4523         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4524         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4525         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4526         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4527         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4528         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4529         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4530         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4531     12  WK-OVER-SHORT-AREA.
  4532         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4533         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4534         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4535             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4536         16  FILLER                   PIC X(5) VALUE SPACES.
  4537
  4538*    COPY ELCEDITC.
  4539******************************************************************
  4540*                                                                *
  4541*                                                                *
  4542*                            ELCEDITC                            *
  4543*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4544*                            VMOD=2.012                          *
  4545*                                                                *
  4546*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4547*                     EL6313, EL050 AND EL517.                   *
  4548*                                                                *
  4549******************************************************************
  4550******************************************************************
  4551*                   C H A N G E   L O G
  4552*
  4553* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4554*-----------------------------------------------------------------
  4555*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4556* EFFECTIVE    NUMBER
  4557*-----------------------------------------------------------------
  4558* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4559******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  85
* EL050.cbl
  4560
  4561     12  EDIT-CRITERIA-DATA.
  4562         16  EC-CO-MONTH-END-DT       PIC XX.
  4563         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4564         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4565         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4566         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4567         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4568         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4569         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4570         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4571         16  EC-CO-REM-TERM-CALC      PIC X.
  4572               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4573               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4574               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4575               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4576
  4577         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4578               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4579               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4580               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4581               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4582               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4583               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4584               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4585               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4586               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4587               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4588
  4589         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4590               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4591               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4592               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4593               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4594               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4595               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4596               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4597               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4598
  4599         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4600                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4601                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4602
  4603         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4604                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4605                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4606                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4607                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4608                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4609                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4610                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4611                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4612
  4613         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4614               88  EC-BR-REDUCING                   VALUE 'R'.
  4615               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4616
  4617         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  86
* EL050.cbl
  4618         16  EC-BR-LF-DESC             PIC X(10).
  4619         16  EC-BR-AH-DESC             PIC X(10).
  4620         16  EC-BR-LF-COMMENT          PIC X(10).
  4621         16  EC-BR-AH-COMMENT          PIC X(10).
  4622
  4623         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4624               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4625               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4626               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4627               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4628
  4629         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4630               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4631               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4632               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4633               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4634
  4635         16  EC-BR-LF-REFUND-CALC      PIC X.
  4636                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4637                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4638                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4639                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4640                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4641                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4642                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4643
  4644         16  EC-BR-AH-REFUND-CALC      PIC X.
  4645                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4646                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4647                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4648                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4649                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4650                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4651                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4652                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4653
  4654         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4655                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4656                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4657                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4658
  4659         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4660                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4661                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4662                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4663
  4664         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4665         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4666         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4667         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4668
  4669         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4670         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4671                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4672                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4673                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4674                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4675
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  87
* EL050.cbl
  4676         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4677               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4678               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4679               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4680               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4681               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4682
  4683         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4684               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4685               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4686               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4687               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4688               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4689
  4690         16  EC-ST-LF-REFUND-CALC      PIC X.
  4691                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4692                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4693                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4694                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4695                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4696                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4697                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4698                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4699
  4700         16  EC-ST-AH-REFUND-CALC      PIC X.
  4701                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4702                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4703                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4704                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4705                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4706                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4707                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4708                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4709
  4710         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4711         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4712         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4713         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4714         16  EC-AM-EXPIRATION-DT       PIC XX.
  4715         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4716         16  EC-AM-CLASS-CD            PIC XX.
  4717         16  EC-AM-LF-DEVIATION        PIC XXX.
  4718         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4719         16  EC-AM-AH-DEVIATION        PIC XXX.
  4720         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4721         16  EC-AM-PHONE-NO            PIC X(10).
  4722
  4723         16  EC-AM-LF-REFUND-CALC      PIC X.
  4724                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4725                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4726                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4727                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4728                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4729                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4730                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4731
  4732         16  EC-AM-AH-REFUND-CALC      PIC X.
  4733                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  88
* EL050.cbl
  4734                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4735                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4736                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4737                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4738                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4739                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4740
  4741         16  EC-AM-BEN-I-G-CD          PIC X.
  4742                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4743                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4744                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4745
  4746         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4747         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4748         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4749         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4750         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4751         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4752         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4753         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4754         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4755
  4756         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4757         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4758         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4759         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4760         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4761         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4762         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4763         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4764         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4765         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4766         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4767         16  EC-RT-LF-NSP-ST           PIC XX.
  4768         16  EC-RT-AH-NSP-ST           PIC XX.
  4769         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4770         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4771
  4772         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4773             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4774                                             'M' '5' '9' '2'.
  4775             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4776             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4777             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4778             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4779             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4780             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4781             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4782             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4783             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4784             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4785
  4786         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4787             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4788                                             'M' '5' '9' '2'.
  4789             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4790             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4791             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  89
* EL050.cbl
  4792             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4793             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4794             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4795             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4796             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4797             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4798             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4799
  4800         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4801         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4802         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4803         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4804         16  EC-CM-DEATH-DT            PIC XX.
  4805
  4806*DMD CUSTOM CODING FIELDS BELOW
  4807*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4808         16  EC-BR-DMD-RATING-SW       PIC X.
  4809                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4810                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4811                 88  NO-DMD-RATING               VALUE 'N'.
  4812
  4813         16  EC-NEW-CERT               PIC X(11).
  4814         16  EC-NEW-STATE              PIC XX.
  4815         16  FILLER                    PIC X.
  4816*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4817         16  OVER-SHORT-EDIT-FIELDS.
  4818             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4819             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4820             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4821             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4822             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4823             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4824             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4825             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4826             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4827         16  FILLER                    PIC X(71).
  4828******************************************************************
  4829
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  90
* EL050.cbl
  4831*    COPY ELCDIFRD.
  4832******************************************************************
  4833*                                                                *
  4834*                                                                *
  4835*                            ELCDIFRD.                           *
  4836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4837*                            VMOD=2.004                          *
  4838*                                                                *
  4839*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4840*                                                                *
  4841******************************************************************
  4842*
  4843  01  WS-DIFFERENCE-CALCULATION.
  4844        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4845        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4846        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4847        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4848        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4849        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4850        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4851        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4852        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4853        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4854        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4855
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  91
* EL050.cbl
  4857****************************************************************
  4858*
  4859* Copyright (c) 2007 by Clerity Solutions, Inc.
  4860* All rights reserved.
  4861*
  4862****************************************************************
  4863 01  DFHEIV.
  4864   02  DFHEIV0               PIC X(35).
  4865   02  DFHEIV1               PIC X(08).
  4866   02  DFHEIV2               PIC X(08).
  4867   02  DFHEIV3               PIC X(08).
  4868   02  DFHEIV4               PIC X(06).
  4869   02  DFHEIV5               PIC X(04).
  4870   02  DFHEIV6               PIC X(04).
  4871   02  DFHEIV7               PIC X(02).
  4872   02  DFHEIV8               PIC X(02).
  4873   02  DFHEIV9               PIC X(01).
  4874   02  DFHEIV10              PIC S9(7) COMP-3.
  4875   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4876   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4877   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4878   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4879   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4880   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4881   02  DFHEIV17              PIC X(04).
  4882   02  DFHEIV18              PIC X(04).
  4883   02  DFHEIV19              PIC X(04).
  4884   02  DFHEIV20              USAGE IS POINTER.
  4885   02  DFHEIV21              USAGE IS POINTER.
  4886   02  DFHEIV22              USAGE IS POINTER.
  4887   02  DFHEIV23              USAGE IS POINTER.
  4888   02  DFHEIV24              USAGE IS POINTER.
  4889   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4890   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4891   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4892   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4893   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4894   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4895   02  FILLER                PIC X(02).
  4896   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4897   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4898   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4899   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4900   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4901 LINKAGE  SECTION.
  4902*****************************************************************
  4903*                                                               *
  4904* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4905* All rights reserved.                                          *
  4906*                                                               *
  4907*****************************************************************
  4908 01  dfheiblk.
  4909     02  eibtime          pic s9(7) comp-3.
  4910     02  eibdate          pic s9(7) comp-3.
  4911     02  eibtrnid         pic x(4).
  4912     02  eibtaskn         pic s9(7) comp-3.
  4913     02  eibtrmid         pic x(4).
  4914     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  92
* EL050.cbl
  4915     02  eibcposn         pic s9(4) comp.
  4916     02  eibcalen         pic s9(4) comp.
  4917     02  eibaid           pic x(1).
  4918     02  eibfiller1       pic x(1).
  4919     02  eibfn            pic x(2).
  4920     02  eibfiller2       pic x(2).
  4921     02  eibrcode         pic x(6).
  4922     02  eibfiller3       pic x(2).
  4923     02  eibds            pic x(8).
  4924     02  eibreqid         pic x(8).
  4925     02  eibrsrce         pic x(8).
  4926     02  eibsync          pic x(1).
  4927     02  eibfree          pic x(1).
  4928     02  eibrecv          pic x(1).
  4929     02  eibsend          pic x(1).
  4930     02  eibatt           pic x(1).
  4931     02  eibeoc           pic x(1).
  4932     02  eibfmh           pic x(1).
  4933     02  eibcompl         pic x(1).
  4934     02  eibsig           pic x(1).
  4935     02  eibconf          pic x(1).
  4936     02  eiberr           pic x(1).
  4937     02  eibrldbk         pic x(1).
  4938     02  eiberrcd         pic x(4).
  4939     02  eibsynrb         pic x(1).
  4940     02  eibnodat         pic x(1).
  4941     02  eibfiller5       pic x(2).
  4942     02  eibresp          pic 9(09) comp.
  4943     02  eibresp2         pic 9(09) comp.
  4944     02  dfheigdj         pic s9(4) comp.
  4945     02  dfheigdk         pic s9(4) comp.
  4946
  4947 01  DFHCOMMAREA                   PIC X(1036).
  4948
  4949*01 PARMLIST .
  4950*    02  FILLER                    PIC S9(8)   COMP.
  4951*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4952*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4953*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4954*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4955*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4956*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4957*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4958
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  93
* EL050.cbl
  4960*    COPY ELCCNTL.
  4961******************************************************************
  4962*                                                                *
  4963*                                                                *
  4964*                            ELCCNTL.                            *
  4965*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4966*                            VMOD=2.059                          *
  4967*                                                                *
  4968*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4969*                                                                *
  4970*   FILE TYPE = VSAM,KSDS                                        *
  4971*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4972*                                                                *
  4973*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4974*       ALTERNATE INDEX = NONE                                   *
  4975*                                                                *
  4976*   LOG = YES                                                    *
  4977*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4978******************************************************************
  4979*                   C H A N G E   L O G
  4980*
  4981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4982*-----------------------------------------------------------------
  4983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4984* EFFECTIVE    NUMBER
  4985*-----------------------------------------------------------------
  4986* 082503                   PEMA  ADD BENEFIT GROUP
  4987* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4988* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4989* 092705    2005050300006  PEMA  ADD SPP LEASES
  4990* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4991* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4992* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4993* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4994* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4995* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4996* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4997* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4998* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4999* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5000******************************************************************
  5001*
  5002 01  CONTROL-FILE.
  5003     12  CF-RECORD-ID                       PIC XX.
  5004         88  VALID-CF-ID                        VALUE 'CF'.
  5005
  5006     12  CF-CONTROL-PRIMARY.
  5007         16  CF-COMPANY-ID                  PIC XXX.
  5008         16  CF-RECORD-TYPE                 PIC X.
  5009             88  CF-COMPANY-MASTER              VALUE '1'.
  5010             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5011             88  CF-STATE-MASTER                VALUE '3'.
  5012             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5013             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5014             88  CF-CARRIER-MASTER              VALUE '6'.
  5015             88  CF-MORTALITY-MASTER            VALUE '7'.
  5016             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5017             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  94
* EL050.cbl
  5018             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5019             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5020             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5021             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5022             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5023             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5024             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5025             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5026             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5027         16  CF-ACCESS-CD-GENL              PIC X(4).
  5028         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5029             20  CF-PROCESSOR               PIC X(4).
  5030         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5031             20  CF-STATE-CODE              PIC XX.
  5032             20  FILLER                     PIC XX.
  5033         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5034             20  FILLER                     PIC XX.
  5035             20  CF-HI-BEN-IN-REC           PIC XX.
  5036         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5037             20  FILLER                     PIC XXX.
  5038             20  CF-CARRIER-CNTL            PIC X.
  5039         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5040             20  FILLER                     PIC XX.
  5041             20  CF-HI-TYPE-IN-REC          PIC 99.
  5042         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5043             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5044                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5045             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5046             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5047         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5048             20  FILLER                     PIC X.
  5049             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5050         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5051             20  FILLER                     PIC XX.
  5052             20  CF-MORTGAGE-PLAN           PIC XX.
  5053         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5054
  5055     12  CF-LAST-MAINT-DT                   PIC XX.
  5056     12  CF-LAST-MAINT-BY                   PIC X(4).
  5057     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5058
  5059     12  CF-RECORD-BODY                     PIC X(728).
  5060
  5061
  5062****************************************************************
  5063*             COMPANY MASTER RECORD                            *
  5064****************************************************************
  5065
  5066     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5067         16  CF-COMPANY-ADDRESS.
  5068             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5069             20  CF-CL-IN-CARE-OF           PIC X(30).
  5070             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5071             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5072             20  CF-CL-CITY-STATE           PIC X(30).
  5073             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5074             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5075         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  95
* EL050.cbl
  5076         16  CF-COMPANY-PASSWORD            PIC X(8).
  5077         16  CF-SECURITY-OPTION             PIC X.
  5078             88  ALL-SECURITY                   VALUE '1'.
  5079             88  COMPANY-VERIFY                 VALUE '2'.
  5080             88  PROCESSOR-VERIFY               VALUE '3'.
  5081             88  NO-SECURITY                    VALUE '4'.
  5082             88  ALL-BUT-TERM                   VALUE '5'.
  5083         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5084             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5085         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5086             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5087         16  CF-INFORCE-LOCATION            PIC X.
  5088             88  CERTS-ARE-ONLINE               VALUE '1'.
  5089             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5090             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5091         16  CF-LOWER-CASE-LETTERS          PIC X.
  5092         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5093             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5094             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5095             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5096             88  CF-ACCNT-CNTL                  VALUE '3'.
  5097             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5098
  5099         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5100         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5101
  5102         16  CF-LGX-CREDIT-USER             PIC X.
  5103             88  CO-IS-NOT-USER                 VALUE 'N'.
  5104             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5105
  5106         16 CF-CREDIT-CALC-CODES.
  5107             20  CF-CR-REM-TERM-CALC PIC X.
  5108               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5109               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5110               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5111               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5112               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5113               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5114               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5115             20  CF-CR-R78-METHOD           PIC X.
  5116               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5117               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5118
  5119         16  CF-CLAIM-CONTROL-COUNTS.
  5120             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5121                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5122
  5123             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5124                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5125
  5126             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5127                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5128
  5129             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5130                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5131
  5132         16  CF-CURRENT-MONTH-END           PIC XX.
  5133
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  96
* EL050.cbl
  5134         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5135             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5136             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5137             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5138             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5139                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5140                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5141             20  CF-CO-PREM-REJECT-SW       PIC X.
  5142                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5143                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5144             20  CF-CO-REF-REJECT-SW        PIC X.
  5145                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5146                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5147
  5148         16  CF-CO-REPORTING-DT             PIC XX.
  5149         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5150         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5151           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5152           88  CF-CO-MONTH-END                  VALUE '1'.
  5153
  5154         16  CF-LGX-CLAIM-USER              PIC X.
  5155             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5156             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5157
  5158         16  CF-CREDIT-EDIT-CONTROLS.
  5159             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5160             20  CF-MIN-AGE                 PIC 99.
  5161             20  CF-DEFAULT-AGE             PIC 99.
  5162             20  CF-MIN-TERM                PIC S999      COMP-3.
  5163             20  CF-MAX-TERM                PIC S999      COMP-3.
  5164             20  CF-DEFAULT-SEX             PIC X.
  5165             20  CF-JOINT-AGE-INPUT         PIC X.
  5166                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5167             20  CF-BIRTH-DATE-INPUT        PIC X.
  5168                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5169             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5170                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5171                 88  CF-ZERO-CARRIER            VALUE '1'.
  5172                 88  CF-ZERO-GROUPING           VALUE '2'.
  5173                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5174             20  CF-EDIT-SW                 PIC X.
  5175                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5176             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5177             20  CF-CR-PR-METHOD            PIC X.
  5178               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5179               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5180             20  FILLER                     PIC X.
  5181
  5182         16  CF-CREDIT-MISC-CONTROLS.
  5183             20  CF-REIN-TABLE-SW           PIC X.
  5184                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5185             20  CF-COMP-TABLE-SW           PIC X.
  5186                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5187             20  CF-EXPERIENCE-RETENTION-AGE
  5188                                            PIC S9        COMP-3.
  5189             20  CF-CONVERSION-DT           PIC XX.
  5190             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5191             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  97
* EL050.cbl
  5192                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5193                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5194
  5195             20  CF-CR-CHECK-NO-CONTROL.
  5196                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5197                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5198                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5199                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5200                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5201                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5202
  5203                 24  CF-CR-CHECK-COUNT       REDEFINES
  5204                     CF-CR-CHECK-COUNTER      PIC X(4).
  5205
  5206                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5207                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5208
  5209                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5210                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5211                 24  CF-MAIL-PROCESSING       PIC X.
  5212                     88  MAIL-PROCESSING          VALUE 'Y'.
  5213
  5214         16  CF-MISC-SYSTEM-CONTROL.
  5215             20  CF-SYSTEM-C                 PIC X.
  5216                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5217             20  CF-SYSTEM-D                 PIC X.
  5218                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5219             20  CF-SOC-SEC-NO-SW            PIC X.
  5220                 88  SOC-SEC-NO-USED             VALUE '1'.
  5221             20  CF-MEMBER-NO-SW             PIC X.
  5222                 88  MEMBER-NO-USED              VALUE '1'.
  5223             20  CF-TAX-ID-NUMBER            PIC X(11).
  5224             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5225             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5226                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5227                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5228                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5229                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5230             20  CF-SYSTEM-E                 PIC X.
  5231                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5232
  5233         16  CF-LGX-LIFE-USER               PIC X.
  5234             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5235             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5236
  5237         16  CF-CR-MONTH-END-DT             PIC XX.
  5238
  5239         16  CF-FILE-MAINT-DATES.
  5240             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5241                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5242             20  CF-LAST-BATCH       REDEFINES
  5243                 CF-LAST-BATCH-NO               PIC X(4).
  5244             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5245             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5246             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5247             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5248             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5249             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  98
* EL050.cbl
  5250             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5251             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5252             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5253             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5254
  5255         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5256         16  FILLER                         PIC X.
  5257
  5258         16  CF-ALT-MORT-CODE               PIC X(4).
  5259         16  CF-MEMBER-CAPTION              PIC X(10).
  5260
  5261         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5262             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5263             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5264             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5265             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5266             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5267
  5268         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5269
  5270         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5271         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5272         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5273         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5274
  5275         16  CF-AH-OVERRIDE-L1              PIC X.
  5276         16  CF-AH-OVERRIDE-L2              PIC XX.
  5277         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5278         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5279
  5280         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5281         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5282
  5283         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5284         16  CF-AR-LAST-EL860-DT            PIC XX.
  5285         16  CF-MP-MONTH-END-DT             PIC XX.
  5286
  5287         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5288         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5289             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5290
  5291         16  CF-AR-MONTH-END-DT             PIC XX.
  5292
  5293         16  CF-CRDTCRD-USER                PIC X.
  5294             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5295             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5296
  5297         16  CF-CC-MONTH-END-DT             PIC XX.
  5298
  5299         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5300
  5301         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5302             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5303             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5304             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5305         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5306         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5307         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page  99
* EL050.cbl
  5308         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5309             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5310             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5311         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5312         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5313         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5314             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5315         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5316
  5317         16  CF-CL-ZIP-CODE.
  5318             20  CF-CL-ZIP-PRIME.
  5319                 24  CF-CL-ZIP-1ST          PIC X.
  5320                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5321                 24  FILLER                 PIC X(4).
  5322             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5323         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5324             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5325             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5326             20  FILLER                     PIC XXX.
  5327
  5328         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5329         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5330         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5331         16  CF-CO-OPTION-START-DATE        PIC XX.
  5332         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5333           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5334                                                      '3' '4'.
  5335           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5336           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5337           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5338           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5339           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5340           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5341
  5342         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5343
  5344         16  CF-PAYMENT-APPROVAL-LEVELS.
  5345             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5346             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5347             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5348             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5349             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5350             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5351
  5352         16  CF-END-USER-REPORTING-USER     PIC X.
  5353             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5354             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5355
  5356         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5357             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5358             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5359
  5360         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5361
  5362         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5363         16  FILLER                         PIC X.
  5364
  5365         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 100
* EL050.cbl
  5366             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5367             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5368             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5369
  5370         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5371
  5372         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5373             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5374             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5375
  5376         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5377             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5378             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5379
  5380         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5381
  5382         16  CF-CO-ACH-ID-CODE              PIC  X.
  5383             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5384             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5385             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5386         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5387         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5388         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5389         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5390         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5391         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5392         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5393         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5394         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5395                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5396         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5397                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5398
  5399         16  CF-CO-OVER-SHORT.
  5400             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5401             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5402
  5403*         16  FILLER                         PIC X(102).
  5404         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5405             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5406             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5407
  5408         16  CF-AH-APPROVAL-DAYS.
  5409             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5410             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5411             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5412             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5413
  5414         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5415
  5416         16  CF-APPROV-LEV-5.
  5417             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5418             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5419             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5420
  5421         16  FILLER                         PIC X(68).
  5422****************************************************************
  5423*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 101
* EL050.cbl
  5424****************************************************************
  5425
  5426     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5427         16  CF-PROCESSOR-NAME              PIC X(30).
  5428         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5429         16  CF-PROCESSOR-TITLE             PIC X(26).
  5430         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5431                 88  MESSAGE-YES                VALUE 'Y'.
  5432                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5433
  5434*****************************************************
  5435****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5436****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5437****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5438****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5439*****************************************************
  5440
  5441         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5442             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5443             20  CF-APPLICATION-FORCE       PIC X.
  5444             20  CF-INDIVIDUAL-APP.
  5445                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5446                     28  CF-BROWSE-APP      PIC X.
  5447                     28  CF-UPDATE-APP      PIC X.
  5448
  5449         16  CF-CURRENT-TERM-ON             PIC X(4).
  5450         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5451             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5452             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5453             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5454             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5455             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5456             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5457             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5458         16  CF-PROCESSOR-CARRIER           PIC X.
  5459             88  NO-CARRIER-SECURITY            VALUE ' '.
  5460         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5461             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5462         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5463             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5464         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5465             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5466
  5467         16  CF-PROC-SYS-ACCESS-SW.
  5468             20  CF-PROC-CREDIT-CLAIMS-SW.
  5469                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5470                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5471                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5472                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5473             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5474                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5475                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5476             20  CF-PROC-LIFE-GNRLDGR-SW.
  5477                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5478                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5479                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5480                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5481             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 102
* EL050.cbl
  5482                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5483                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5484         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5485             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5486             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5487         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5488
  5489         16  CF-APPROVAL-LEVEL                  PIC X.
  5490             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5491             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5492             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5493             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5494             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5495
  5496         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5497
  5498         16  CF-LANGUAGE-TYPE                   PIC X.
  5499             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5500             88  CF-LANG-IS-FR                      VALUE 'F'.
  5501
  5502         16  CF-CSR-IND                         PIC X.
  5503         16  FILLER                             PIC X(239).
  5504
  5505****************************************************************
  5506*             PROCESSOR/REMINDERS RECORD                       *
  5507****************************************************************
  5508
  5509     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5510         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5511             20  CF-START-REMIND-DT         PIC XX.
  5512             20  CF-END-REMIND-DT           PIC XX.
  5513             20  CF-REMINDER-TEXT           PIC X(50).
  5514         16  FILLER                         PIC X(296).
  5515
  5516
  5517****************************************************************
  5518*             STATE MASTER RECORD                              *
  5519****************************************************************
  5520
  5521     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5522         16  CF-STATE-ABBREVIATION          PIC XX.
  5523         16  CF-STATE-NAME                  PIC X(25).
  5524         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5525         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5526             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5527             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5528             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5529             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5530                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5531                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5532             20  CF-ST-PREM-REJECT-SW       PIC X.
  5533                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5534                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5535             20  CF-ST-REF-REJECT-SW        PIC X.
  5536                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5537                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5538         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5539         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 103
* EL050.cbl
  5540         16  CF-ST-REFUND-RULES.
  5541             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5542             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5543             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5544         16  CF-ST-FST-PMT-EXTENSION.
  5545             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5546             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5547                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5548                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5549                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5550                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5551         16  CF-ST-STATE-CALL.
  5552             20  CF-ST-CALL-UNEARNED        PIC X.
  5553             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5554             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5555         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5556             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5557             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5558         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5559         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5560         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5561         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5562         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5563         16  FILLER                         PIC X.
  5564         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5565             20  CF-ST-BENEFIT-CD           PIC XX.
  5566             20  CF-ST-BENEFIT-KIND         PIC X.
  5567                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5568                 88  CF-ST-AH-KIND              VALUE 'A'.
  5569             20  CF-ST-REM-TERM-CALC        PIC X.
  5570                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5571                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5572                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5573                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5574                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5575                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5576                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5577                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5578
  5579             20  CF-ST-REFUND-CALC          PIC X.
  5580                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5581                 88  ST-REFD-BY-R78             VALUE '1'.
  5582                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5583                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5584                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5585                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5586                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5587                 88  ST-REFD-UTAH               VALUE '7'.
  5588                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5589                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5590                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5591
  5592             20  CF-ST-EARNING-CALC         PIC X.
  5593                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5594                 88  ST-EARN-BY-R78             VALUE '1'.
  5595                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5596                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5597                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 104
* EL050.cbl
  5598                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5599                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5600                 88  ST-EARN-MEAN               VALUE '8'.
  5601                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5602
  5603             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5604                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5605                 88  ST-OVRD-BY-R78             VALUE '1'.
  5606                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5607                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5608                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5609                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5610                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5611                 88  ST-OVRD-MEAN               VALUE '8'.
  5612                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5613             20  FILLER                     PIC X.
  5614
  5615         16  CF-ST-COMMISSION-CAPS.
  5616             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5617             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5618             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5619             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5620         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5621                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5622
  5623         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5624
  5625         16  CF-ST-STATUTORY-INTEREST.
  5626             20  CF-ST-STAT-DATE-FROM       PIC X.
  5627                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5628                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5629             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5630             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5631             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5632             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5633             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5634
  5635         16  CF-ST-OVER-SHORT.
  5636             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5637             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5638
  5639         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5640
  5641         16  CF-ST-RT-CALC                  PIC X.
  5642
  5643         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5644         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5645         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5646         16  CF-ST-RF-LR-CALC               PIC X.
  5647         16  CF-ST-RF-LL-CALC               PIC X.
  5648         16  CF-ST-RF-LN-CALC               PIC X.
  5649         16  CF-ST-RF-AH-CALC               PIC X.
  5650         16  CF-ST-RF-CP-CALC               PIC X.
  5651*        16  FILLER                         PIC X(206).
  5652*CIDMOD         16  FILLER                         PIC X(192).
  5653         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5654             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5655         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 105
* EL050.cbl
  5656         16  CF-ST-VFY-2ND-BENE             PIC X.
  5657         16  CF-ST-CAUSAL-STATE             PIC X.
  5658         16  FILLER                         PIC X(185).
  5659
  5660****************************************************************
  5661*             BENEFIT MASTER RECORD                            *
  5662****************************************************************
  5663
  5664     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5665         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5666             20  CF-BENEFIT-CODE            PIC XX.
  5667             20  CF-BENEFIT-NUMERIC  REDEFINES
  5668                 CF-BENEFIT-CODE            PIC XX.
  5669             20  CF-BENEFIT-ALPHA           PIC XXX.
  5670             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5671             20  CF-BENEFIT-COMMENT         PIC X(10).
  5672
  5673             20  CF-LF-COVERAGE-TYPE        PIC X.
  5674                 88  CF-REDUCING                VALUE 'R'.
  5675                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5676
  5677             20  CF-SPECIAL-CALC-CD         PIC X.
  5678                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5679                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5680                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5681                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5682                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5683                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5684                 88  CF-FARM-PLAN               VALUE 'F'.
  5685                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5686                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5687                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5688                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5689                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5690                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5691                 88  CF-PRUDENTIAL              VALUE 'P'.
  5692                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5693                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5694                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5695                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5696                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5697                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5698
  5699             20  CF-JOINT-INDICATOR         PIC X.
  5700                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5701
  5702*            20  FILLER                     PIC X(12).
  5703             20  cf-maximum-benefits        pic s999 comp-3.
  5704             20  FILLER                     PIC X(09).
  5705             20  CF-BENEFIT-CATEGORY        PIC X.
  5706             20  CF-LOAN-TYPE               PIC X(8).
  5707
  5708             20  CF-CO-REM-TERM-CALC        PIC X.
  5709                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5710                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5711                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5712                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5713                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 106
* EL050.cbl
  5714
  5715             20  CF-CO-EARNINGS-CALC        PIC X.
  5716                 88  CO-EARN-BY-R78             VALUE '1'.
  5717                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5718                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5719                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5720                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5721                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5722                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5723                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5724
  5725             20  CF-CO-REFUND-CALC          PIC X.
  5726                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5727                 88  CO-REFD-BY-R78             VALUE '1'.
  5728                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5729                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5730                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5731                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5732                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5733                 88  CO-REFD-MEAN               VALUE '8'.
  5734                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5735                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5736                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5737
  5738             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5739                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5740                 88  CO-OVRD-BY-R78             VALUE '1'.
  5741                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5742                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5743                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5744                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5745                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5746                 88  CO-OVRD-MEAN               VALUE '8'.
  5747                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5748
  5749             20  CF-CO-BEN-I-G-CD           PIC X.
  5750                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5751                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5752                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5753
  5754         16  FILLER                         PIC X(304).
  5755
  5756
  5757****************************************************************
  5758*             CARRIER MASTER RECORD                            *
  5759****************************************************************
  5760
  5761     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5762         16  CF-ADDRESS-DATA.
  5763             20  CF-MAIL-TO-NAME            PIC X(30).
  5764             20  CF-IN-CARE-OF              PIC X(30).
  5765             20  CF-ADDRESS-LINE-1          PIC X(30).
  5766             20  CF-ADDRESS-LINE-2          PIC X(30).
  5767             20  CF-CITY-STATE              PIC X(30).
  5768             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5769             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5770
  5771         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 107
* EL050.cbl
  5772             20  CF-CLAIM-NO-METHOD         PIC X.
  5773                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5774                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5775                 88  CLAIM-NO-SEQ               VALUE '3'.
  5776                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5777             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5778                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5779                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5780                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5781
  5782         16  CF-CHECK-NO-CONTROL.
  5783             20  CF-CHECK-NO-METHOD         PIC X.
  5784                 88  CHECK-NO-MANUAL            VALUE '1'.
  5785                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5786                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5787                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5788             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5789                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5790
  5791         16  CF-DOMICILE-STATE              PIC XX.
  5792
  5793         16  CF-EXPENSE-CONTROLS.
  5794             20  CF-EXPENSE-METHOD          PIC X.
  5795                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5796                 88  DOLLARS-PER-PMT            VALUE '2'.
  5797                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5798                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5799             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5800             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5801
  5802         16  CF-CORRESPONDENCE-CONTROL.
  5803             20  CF-LETTER-RESEND-OPT       PIC X.
  5804                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5805                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5806             20  FILLER                     PIC X(4).
  5807
  5808         16  CF-RESERVE-CONTROLS.
  5809             20  CF-MANUAL-SW               PIC X.
  5810                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5811             20  CF-FUTURE-SW               PIC X.
  5812                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5813             20  CF-PTC-SW                  PIC X.
  5814                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5815             20  CF-IBNR-SW                 PIC X.
  5816                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5817             20  CF-PTC-LF-SW               PIC X.
  5818                 88  CF-LF-PTC-USED             VALUE '1'.
  5819             20  CF-CDT-ACCESS-METHOD       PIC X.
  5820                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5821                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5822                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5823             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5824
  5825         16  CF-CLAIM-CALC-METHOD           PIC X.
  5826             88  360-PLUS-MONTHS                VALUE '1'.
  5827             88  365-PLUS-MONTHS                VALUE '2'.
  5828             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5829             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 108
* EL050.cbl
  5830             88  365-DAILY                      VALUE '5'.
  5831
  5832         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5833         16  FILLER                         PIC X(11).
  5834
  5835         16  CF-LIMIT-AMOUNTS.
  5836             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5837             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5838             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5839             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5840             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5841             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5842             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5843             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5844             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5845             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5846
  5847         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5848         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5849         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5850
  5851         16  CF-ZIP-CODE.
  5852             20  CF-ZIP-PRIME.
  5853                 24  CF-ZIP-1ST             PIC X.
  5854                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5855                 24  FILLER                 PIC X(4).
  5856             20  CF-ZIP-PLUS4               PIC X(4).
  5857         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5858             20  CF-CAN-POSTAL-1            PIC XXX.
  5859             20  CF-CAN-POSTAL-2            PIC XXX.
  5860             20  FILLER                     PIC XXX.
  5861
  5862         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5863         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5864         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5865
  5866         16  CF-RATING-SWITCH               PIC X.
  5867             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5868             88  CF-NO-RATING                   VALUE 'N'.
  5869
  5870         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5871
  5872         16  CF-CARRIER-OVER-SHORT.
  5873             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5874             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5875
  5876         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5877         16  CF-SECPAY-SWITCH               PIC X.
  5878             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5879             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5880         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5881         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5882         16  FILLER                         PIC X(444).
  5883*        16  FILLER                         PIC X(452).
  5884
  5885
  5886****************************************************************
  5887*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 109
* EL050.cbl
  5888****************************************************************
  5889
  5890     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5891         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5892                                INDEXED BY CF-MORT-NDX.
  5893             20  CF-MORT-TABLE              PIC X(5).
  5894             20  CF-MORT-TABLE-TYPE         PIC X.
  5895                 88  CF-MORT-JOINT              VALUE 'J'.
  5896                 88  CF-MORT-SINGLE             VALUE 'S'.
  5897                 88  CF-MORT-COMBINED           VALUE 'C'.
  5898                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5899                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5900             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5901             20  CF-MORT-AGE-METHOD         PIC XX.
  5902                 88  CF-AGE-LAST                VALUE 'AL'.
  5903                 88  CF-AGE-NEAR                VALUE 'AN'.
  5904             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5905             20  CF-MORT-ADJUSTMENT-DIRECTION
  5906                                            PIC X.
  5907                 88  CF-MINUS                   VALUE '-'.
  5908                 88  CF-PLUS                    VALUE '+'.
  5909             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5910             20  CF-MORT-JOINT-CODE         PIC X.
  5911                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5912             20  CF-MORT-PC-Q               PIC X.
  5913                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5914             20  CF-MORT-TABLE-CODE         PIC X(4).
  5915             20  CF-MORT-COMMENTS           PIC X(15).
  5916             20  FILLER                     PIC X(14).
  5917
  5918         16  FILLER                         PIC X(251).
  5919
  5920
  5921****************************************************************
  5922*             BUSSINESS TYPE MASTER RECORD                     *
  5923****************************************************************
  5924
  5925     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5926* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5927* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5928* AND RECORD 05 IS TYPES 81-99
  5929         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5930             20  CF-BUSINESS-TITLE          PIC  X(19).
  5931             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5932                                            PIC S9V9(4) COMP-3.
  5933             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5934             20  FILLER                     PIC  X.
  5935         16  FILLER                         PIC  X(248).
  5936
  5937
  5938****************************************************************
  5939*             TERMINAL MASTER RECORD                           *
  5940****************************************************************
  5941
  5942     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5943
  5944         16  CF-COMPANY-TERMINALS.
  5945             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 110
* EL050.cbl
  5946                                  PIC X(4).
  5947         16  FILLER               PIC X(248).
  5948
  5949
  5950****************************************************************
  5951*             LIFE EDIT MASTER RECORD                          *
  5952****************************************************************
  5953
  5954     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5955         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5956             20  CF-LIFE-CODE-IN            PIC XX.
  5957             20  CF-LIFE-CODE-OUT           PIC XX.
  5958         16  FILLER                         PIC X(248).
  5959
  5960
  5961****************************************************************
  5962*             AH EDIT MASTER RECORD                            *
  5963****************************************************************
  5964
  5965     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5966         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5967             20  CF-AH-CODE-IN              PIC XXX.
  5968             20  CF-AH-CODE-OUT             PIC XX.
  5969         16  FILLER                         PIC X(248).
  5970
  5971
  5972****************************************************************
  5973*             CREDIBILITY TABLES                               *
  5974****************************************************************
  5975
  5976     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5977         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5978                             INDEXED BY CF-CRDB-NDX.
  5979             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5980             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5981             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5982         16  FILLER                         PIC  X(332).
  5983
  5984
  5985****************************************************************
  5986*             REPORT CUSTOMIZATION RECORD                      *
  5987****************************************************************
  5988
  5989     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5990         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5991             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5992             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5993             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5994**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5995****       A T-TRANSFER.                                   ****
  5996             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5997
  5998         16  FILLER                         PIC XX.
  5999
  6000         16  CF-CARRIER-CNTL-OPT.
  6001             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6002                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6003                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 111
* EL050.cbl
  6004             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6005                                            PIC X.
  6006         16  CF-GROUP-CNTL-OPT.
  6007             20  CF-GROUP-OPT-SEQ           PIC 9.
  6008                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6009                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6010             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6011                                            PIC X(6).
  6012         16  CF-STATE-CNTL-OPT.
  6013             20  CF-STATE-OPT-SEQ           PIC 9.
  6014                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6015                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6016             20  CF-STATE-SELECT OCCURS 3 TIMES
  6017                                            PIC XX.
  6018         16  CF-ACCOUNT-CNTL-OPT.
  6019             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6020                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6021                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6022             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6023                                            PIC X(10).
  6024         16  CF-BUS-TYP-CNTL-OPT.
  6025             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6026                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6027                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6028             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6029                                            PIC XX.
  6030         16  CF-LF-TYP-CNTL-OPT.
  6031             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6032                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6033                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6034             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6035                                            PIC XX.
  6036         16  CF-AH-TYP-CNTL-OPT.
  6037             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6038                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6039                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6040             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6041                                            PIC XX.
  6042         16  CF-REPTCD1-CNTL-OPT.
  6043             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6044                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6045                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6046             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6047                                            PIC X(10).
  6048         16  CF-REPTCD2-CNTL-OPT.
  6049             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6050                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6051                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6052             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6053                                            PIC X(10).
  6054         16  CF-USER1-CNTL-OPT.
  6055             20  CF-USER1-OPT-SEQ           PIC 9.
  6056                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6057                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6058             20  CF-USER1-SELECT OCCURS 3 TIMES
  6059                                            PIC X(10).
  6060         16  CF-USER2-CNTL-OPT.
  6061             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 112
* EL050.cbl
  6062                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6063                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6064             20  CF-USER2-SELECT OCCURS 3 TIMES
  6065                                            PIC X(10).
  6066         16  CF-USER3-CNTL-OPT.
  6067             20  CF-USER3-OPT-SEQ           PIC 9.
  6068                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6069                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6070             20  CF-USER3-SELECT OCCURS 3 TIMES
  6071                                            PIC X(10).
  6072         16  CF-USER4-CNTL-OPT.
  6073             20  CF-USER4-OPT-SEQ           PIC 9.
  6074                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6075                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6076             20  CF-USER4-SELECT OCCURS 3 TIMES
  6077                                            PIC X(10).
  6078         16  CF-USER5-CNTL-OPT.
  6079             20  CF-USER5-OPT-SEQ           PIC 9.
  6080                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6081                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6082             20  CF-USER5-SELECT OCCURS 3 TIMES
  6083                                            PIC X(10).
  6084         16  CF-REINS-CNTL-OPT.
  6085             20  CF-REINS-OPT-SEQ           PIC 9.
  6086                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6087                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6088             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6089                 24  CF-REINS-PRIME         PIC XXX.
  6090                 24  CF-REINS-SUB           PIC XXX.
  6091
  6092         16  CF-AGENT-CNTL-OPT.
  6093             20  CF-AGENT-OPT-SEQ           PIC 9.
  6094                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6095                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6096             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6097                                            PIC X(10).
  6098
  6099         16  FILLER                         PIC X(43).
  6100
  6101         16  CF-LOSS-RATIO-SELECT.
  6102             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6103             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6104         16  CF-ENTRY-DATE-SELECT.
  6105             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6106             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6107         16  CF-EFFECTIVE-DATE-SELECT.
  6108             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6109             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6110
  6111         16  CF-EXCEPTION-LIST-IND          PIC X.
  6112             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6113
  6114         16  FILLER                         PIC X(318).
  6115
  6116****************************************************************
  6117*                  EXCEPTION REPORTING RECORD                  *
  6118****************************************************************
  6119
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 113
* EL050.cbl
  6120     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6121         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6122             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6123
  6124         16  CF-COMBINED-LIFE-AH-OPT.
  6125             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6126             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6127             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6128             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6129
  6130         16  CF-LIFE-OPT.
  6131             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6132             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6133             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6134             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6135             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6136             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6137             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6138             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6139             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6140             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6141
  6142         16  CF-AH-OPT.
  6143             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6144             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6145             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6146             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6147             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6148             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6149             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6150             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6151             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6152             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6153
  6154         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6155             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6156             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6157             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6158
  6159         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6160
  6161         16  FILLER                         PIC X(673).
  6162
  6163
  6164****************************************************************
  6165*             MORTGAGE SYSTEM PLAN RECORD                      *
  6166****************************************************************
  6167
  6168     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6169         16  CF-PLAN-TYPE                   PIC X.
  6170             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6171             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6172             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6173         16  CF-PLAN-ABBREV                 PIC XXX.
  6174         16  CF-PLAN-DESCRIPT               PIC X(10).
  6175         16  CF-PLAN-NOTES                  PIC X(20).
  6176         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6177         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 114
* EL050.cbl
  6178             20  CF-PLAN-TERM-DATA.
  6179                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6180                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6181             20  CF-PLAN-AGE-DATA.
  6182                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6183                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6184                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6185             20  CF-PLAN-BENEFIT-DATA.
  6186                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6187                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6188                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6189                                            PIC S9(7)V99  COMP-3.
  6190         16  CF-PLAN-POLICY-FORMS.
  6191             20  CF-POLICY-FORM             PIC X(12).
  6192             20  CF-MASTER-APPLICATION      PIC X(12).
  6193             20  CF-MASTER-POLICY           PIC X(12).
  6194         16  CF-PLAN-RATING.
  6195             20  CF-RATE-CODE               PIC X(5).
  6196             20  CF-SEX-RATING              PIC X.
  6197                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6198                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6199             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6200             20  CF-SUB-STD-TYPE            PIC X.
  6201                 88  CF-PCT-OF-PREM            VALUE '1'.
  6202                 88  CF-PCT-OF-BENE            VALUE '2'.
  6203         16  CF-PLAN-PREM-TOLERANCES.
  6204             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6205             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6206         16  CF-PLAN-PYMT-TOLERANCES.
  6207             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6208             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6209         16  CF-PLAN-MISC-DATA.
  6210             20  FILLER                     PIC X.
  6211             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6212             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6213         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6214         16  CF-PLAN-IND-GRP                PIC X.
  6215             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6216                                                     '1'.
  6217             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6218                                                     '2'.
  6219         16  CF-MIB-SEARCH-SW               PIC X.
  6220             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6221             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6222             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6223             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6224         16  CF-ALPHA-SEARCH-SW             PIC X.
  6225             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6226             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6227             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6228             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6229             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6230             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6231             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6232             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6233             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6234             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6235                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 115
* EL050.cbl
  6236                                                     'X' 'Y' 'Z'.
  6237         16  CF-EFF-DT-RULE-SW              PIC X.
  6238             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6239             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6240             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6241             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6242             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6243         16  FILLER                         PIC X(4).
  6244         16  CF-HEALTH-QUESTIONS            PIC X.
  6245             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6246         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6247         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6248         16  CF-PLAN-SNGL-JNT               PIC X.
  6249             88  CF-COMBINED-PLAN              VALUE 'C'.
  6250             88  CF-JNT-PLAN                   VALUE 'J'.
  6251             88  CF-SNGL-PLAN                  VALUE 'S'.
  6252         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6253         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6254         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6255         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6256         16  CF-RERATE-CNTL                 PIC  X.
  6257             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6258             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6259             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6260             88  CF-AUTO-RECALC                 VALUE '4'.
  6261         16  CF-BENEFIT-TYPE                PIC  X.
  6262             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6263             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6264         16  CF-POLICY-FEE                  PIC S999V99
  6265                                                    COMP-3.
  6266         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6267         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6268         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6269         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6270         16  FILLER                         PIC  X(32).
  6271         16  CF-TERMINATION-FORM            PIC  X(04).
  6272         16  FILLER                         PIC  X(08).
  6273         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6274                                                       COMP-3.
  6275         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6276         16  CF-ISSUE-LETTER                PIC  X(4).
  6277         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6278         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6279             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6280             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6281         16  CF-MP-REFUND-CALC              PIC X.
  6282             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6283             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6284             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6285             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6286             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6287             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6288             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6289             88  CF-MP-REFD-MEAN                VALUE '8'.
  6290         16  CF-ALT-RATE-CODE               PIC  X(5).
  6291
  6292
  6293         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 116
* EL050.cbl
  6294****************************************************************
  6295*             MORTGAGE COMPANY MASTER RECORD                   *
  6296****************************************************************
  6297
  6298     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6299         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6300         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6301             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6302             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6303             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6304             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6305             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6306
  6307         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6308         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6309         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6310         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6311         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6312
  6313         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6314             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6315         16  CF-MP-RECON-USE-IND            PIC X(1).
  6316             88  CF-MP-USE-RECON             VALUE 'Y'.
  6317         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6318             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6319         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6320             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6321             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6322         16  FILLER                         PIC X(1).
  6323         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6324             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6325         16  CF-MORTG-MIB-VERSION           PIC X.
  6326             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6327             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6328             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6329         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6330             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6331                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6332             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6333                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6334             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6335                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6336             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6337                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6338             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6339                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6340             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6341                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6342         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6343         16  FILLER                         PIC X(7).
  6344         16  CF-MORTG-DESTINATION-SYMBOL.
  6345             20  CF-MORTG-MIB-COMM          PIC X(5).
  6346             20  CF-MORTG-MIB-TERM          PIC X(5).
  6347         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6348             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6349         16  FILLER                         PIC X(03).
  6350         16  CF-MP-CHECK-NO-CONTROL.
  6351             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 117
* EL050.cbl
  6352                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6353                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6354                                                ' ' LOW-VALUES.
  6355                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6356                                               VALUE '3'.
  6357         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6358         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6359         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6360             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6361                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6362             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6363                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6364             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6365                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6366             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6367                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6368             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6369                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6370             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6371                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6372         16  CF-MORTG-BILLING-AREA.
  6373             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6374                                            PIC X.
  6375         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6376         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6377         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6378         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6379             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6380             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6381         16  FILLER                         PIC X.
  6382         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6383             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6384             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6385         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6386         16  FILLER                         PIC X(8).
  6387         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6388         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6389         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6390         16  CF-ACH-COMPANY-ID.
  6391             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6392                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6393                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6394                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6395             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6396         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6397             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6398         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6399             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6400             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6401         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6402         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6403         16  FILLER                         PIC X(536).
  6404
  6405****************************************************************
  6406*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6407****************************************************************
  6408
  6409     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 118
* EL050.cbl
  6410         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6411             20  CF-FEMALE-HEIGHT.
  6412                 24  CF-FEMALE-FT           PIC 99.
  6413                 24  CF-FEMALE-IN           PIC 99.
  6414             20  CF-FEMALE-MIN-WT           PIC 999.
  6415             20  CF-FEMALE-MAX-WT           PIC 999.
  6416         16  FILLER                         PIC X(428).
  6417
  6418     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6419         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6420             20  CF-MALE-HEIGHT.
  6421                 24  CF-MALE-FT             PIC 99.
  6422                 24  CF-MALE-IN             PIC 99.
  6423             20  CF-MALE-MIN-WT             PIC 999.
  6424             20  CF-MALE-MAX-WT             PIC 999.
  6425         16  FILLER                         PIC X(428).
  6426******************************************************************
  6427*             AUTOMATIC ACTIVITY RECORD                          *
  6428******************************************************************
  6429     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6430         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6431             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6432             20  CF-SYS-LETTER-ID           PIC X(04).
  6433             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6434             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6435             20  CF-SYS-RESET-SW            PIC X(01).
  6436             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6437             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6438
  6439         16  FILLER                         PIC X(50).
  6440
  6441         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6442             20  CF-USER-ACTIVE-SW          PIC X(01).
  6443             20  CF-USER-LETTER-ID          PIC X(04).
  6444             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6445             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6446             20  CF-USER-RESET-SW           PIC X(01).
  6447             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6448             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6449             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6450
  6451         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 119
* EL050.cbl
  6453*    COPY ERCACCT.
  6454******************************************************************
  6455*                                                                *
  6456*                                                                *
  6457*                            ERCACCT                             *
  6458*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6459*                            VMOD=2.031                          *
  6460*                                                                *
  6461*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6462*                                                                *
  6463*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6464*   VSAM ACCOUNT MASTER FILES.                                   *
  6465*                                                                *
  6466*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6467*                                                                *
  6468*   FILE TYPE = VSAM,KSDS                                        *
  6469*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6470*                                                                *
  6471*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6472*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6473*                                                                *
  6474*   LOG = NO                                                     *
  6475*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6476*                                                                *
  6477*                                                                *
  6478******************************************************************
  6479*                   C H A N G E   L O G
  6480*
  6481* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6482*-----------------------------------------------------------------
  6483*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6484* EFFECTIVE    NUMBER
  6485*-----------------------------------------------------------------
  6486* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6487* 092705    2005050300006  PEMA  ADD SPP LEASES
  6488* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6489* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6490* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6491* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6492* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6493******************************************************************
  6494
  6495 01  ACCOUNT-MASTER.
  6496     12  AM-RECORD-ID                      PIC XX.
  6497         88  VALID-AM-ID                      VALUE 'AM'.
  6498
  6499     12  AM-CONTROL-PRIMARY.
  6500         16  AM-COMPANY-CD                 PIC X.
  6501         16  AM-MSTR-CNTRL.
  6502             20  AM-CONTROL-A.
  6503                 24  AM-CARRIER            PIC X.
  6504                 24  AM-GROUPING.
  6505                     28 AM-GROUPING-PREFIX PIC XXX.
  6506                     28 AM-GROUPING-PRIME  PIC XXX.
  6507                 24  AM-STATE              PIC XX.
  6508                 24  AM-ACCOUNT.
  6509                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6510                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 120
* EL050.cbl
  6511             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6512                                           PIC X(19).
  6513             20  AM-CNTRL-B.
  6514                 24  AM-EXPIRATION-DT      PIC XX.
  6515                 24  FILLER                PIC X(4).
  6516             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6517                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6518
  6519     12  AM-CONTROL-BY-VAR-GRP.
  6520         16  AM-COMPANY-CD-A1              PIC X.
  6521         16  AM-VG-CARRIER                 PIC X.
  6522         16  AM-VG-GROUPING                PIC X(6).
  6523         16  AM-VG-STATE                   PIC XX.
  6524         16  AM-VG-ACCOUNT                 PIC X(10).
  6525         16  AM-VG-DATE.
  6526             20  AM-VG-EXPIRATION-DT       PIC XX.
  6527             20  FILLER                    PIC X(4).
  6528         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6529                                           PIC 9(11)      COMP-3.
  6530     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6531         16  FILLER                        PIC X(10).
  6532         16  AM-VG-KEY3.
  6533             20  AM-VG3-ACCOUNT            PIC X(10).
  6534             20  AM-VG3-EXP-DT             PIC XX.
  6535         16  FILLER                        PIC X(4).
  6536     12  AM-MAINT-INFORMATION.
  6537         16  AM-LAST-MAINT-DT              PIC XX.
  6538         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6539         16  AM-LAST-MAINT-USER            PIC X(4).
  6540         16  FILLER                        PIC XX.
  6541
  6542     12  AM-EFFECTIVE-DT                   PIC XX.
  6543     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6544
  6545     12  AM-PREV-DATES  COMP-3.
  6546         16  AM-PREV-EXP-DT                PIC 9(11).
  6547         16  AM-PREV-EFF-DT                PIC 9(11).
  6548
  6549     12  AM-REPORT-CODE-1                  PIC X(10).
  6550     12  AM-REPORT-CODE-2                  PIC X(10).
  6551
  6552     12  AM-CITY-CODE                      PIC X(4).
  6553     12  AM-COUNTY-PARISH                  PIC X(6).
  6554
  6555     12  AM-NAME                           PIC X(30).
  6556     12  AM-PERSON                         PIC X(30).
  6557     12  AM-ADDRS                          PIC X(30).
  6558     12  AM-CITY.
  6559         16  AM-ADDR-CITY                  PIC X(28).
  6560         16  AM-ADDR-STATE                 PIC XX.
  6561     12  AM-ZIP.
  6562         16  AM-ZIP-PRIME.
  6563             20  AM-ZIP-PRI-1ST            PIC X.
  6564                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6565             20  FILLER                    PIC X(4).
  6566         16  AM-ZIP-PLUS4                  PIC X(4).
  6567     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6568         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 121
* EL050.cbl
  6569         16  AM-CAN-POSTAL-2               PIC XXX.
  6570         16  FILLER                        PIC XXX.
  6571     12  AM-TEL-NO.
  6572         16  AM-AREA-CODE                  PIC 999.
  6573         16  AM-TEL-PRE                    PIC 999.
  6574         16  AM-TEL-NBR                    PIC 9(4).
  6575     12  AM-TEL-LOC                        PIC X.
  6576         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6577         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6578
  6579     12  AM-COMM-STRUCTURE.
  6580         16  AM-DEFN-1.
  6581             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6582                 24  AM-AGT.
  6583                     28  AM-AGT-PREFIX     PIC X(4).
  6584                     28  AM-AGT-PRIME      PIC X(6).
  6585                 24  AM-COM-TYP            PIC X.
  6586                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6587                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6588                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6589                 24  AM-RECALC-LV-INDIC    PIC X.
  6590                 24  AM-RETRO-LV-INDIC     PIC X.
  6591                 24  AM-GL-CODES           PIC X.
  6592                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6593                 24  FILLER                PIC X(01).
  6594         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6595             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6596                 24  FILLER                PIC X(11).
  6597                 24  AM-L-COMA             PIC XXX.
  6598                 24  AM-J-COMA             PIC XXX.
  6599                 24  AM-A-COMA             PIC XXX.
  6600                 24  FILLER                PIC X(6).
  6601
  6602     12  AM-COMM-CHANGE-STATUS             PIC X.
  6603         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6604
  6605     12  AM-CSR-CODE                       PIC X(4).
  6606
  6607     12  AM-BILLING-STATUS                 PIC X.
  6608         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6609         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6610     12  AM-AUTO-REFUND-SW                 PIC X.
  6611         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6612         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6613     12  AM-GPCD                           PIC 99.
  6614     12  AM-IG                             PIC X.
  6615         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6616         88  AM-HAS-GROUP                     VALUE '2'.
  6617     12  AM-STATUS                         PIC X.
  6618         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6619         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6620         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6621         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6622         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6623         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6624     12  AM-REMIT-TO                       PIC 99.
  6625     12  AM-ID-NO                          PIC X(11).
  6626
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 122
* EL050.cbl
  6627     12  AM-CAL-TABLE                      PIC XX.
  6628     12  AM-LF-DEVIATION                   PIC XXX.
  6629     12  AM-AH-DEVIATION                   PIC XXX.
  6630     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6631     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6632     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6633     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6634     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6635     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6636
  6637     12  AM-USER-FIELDS.
  6638         16  AM-FLD-1                      PIC XX.
  6639         16  AM-FLD-2                      PIC XX.
  6640         16  AM-FLD-3                      PIC XX.
  6641         16  AM-FLD-4                      PIC XX.
  6642         16  AM-FLD-5                      PIC XX.
  6643
  6644     12  AM-1ST-PROD-DATE.
  6645         16  AM-1ST-PROD-YR                PIC XX.
  6646         16  AM-1ST-PROD-MO                PIC XX.
  6647         16  AM-1ST-PROD-DA                PIC XX.
  6648     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6649     12  AM-CERTS-PURGED-DATE.
  6650         16  AM-PUR-YR                     PIC XX.
  6651         16  AM-PUR-MO                     PIC XX.
  6652         16  AM-PUR-DA                     PIC XX.
  6653     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6654     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6655     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6656     12  AM-INACTIVE-DATE.
  6657         16  AM-INA-MO                     PIC 99.
  6658         16  AM-INA-DA                     PIC 99.
  6659         16  AM-INA-YR                     PIC 99.
  6660     12  AM-AR-HI-CERT-DATE                PIC XX.
  6661
  6662     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6663     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6664
  6665     12  AM-OB-PAYMENT-MODE                PIC X.
  6666         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6667         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6668         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6669         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6670
  6671     12  AM-AH-ONLY-INDICATOR              PIC X.
  6672         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6673         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6674
  6675     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6676
  6677     12  AM-OVER-SHORT.
  6678         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6679         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6680
  6681     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6682     12  AM-DCC-CLP-STATE                  PIC XX.
  6683
  6684     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 123
* EL050.cbl
  6685     12  AM-RECALC-REIN                    PIC X.
  6686
  6687     12  AM-REI-TABLE                      PIC XXX.
  6688     12  AM-REI-ET-LF                      PIC X.
  6689     12  AM-REI-ET-AH                      PIC X.
  6690     12  AM-REI-PE-LF                      PIC X.
  6691     12  AM-REI-PE-AH                      PIC X.
  6692     12  AM-REI-PRT-ST                     PIC X.
  6693     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6694     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6695     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6696     12  AM-REI-GROUP-A                    PIC X(6).
  6697     12  AM-REI-MORT                       PIC X(4).
  6698     12  AM-REI-PRT-OW                     PIC X.
  6699     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6700     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6701     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6702     12  AM-REI-GROUP-B                    PIC X(6).
  6703
  6704     12  AM-TRUST-TYPE                     PIC X(2).
  6705
  6706     12  AM-EMPLOYER-STMT-USED             PIC X.
  6707     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6708
  6709     12  AM-STD-AH-TYPE                    PIC XX.
  6710     12  AM-EARN-METHODS.
  6711         16  AM-EARN-METHOD-R              PIC X.
  6712             88 AM-REF-RL-R78                 VALUE 'R'.
  6713             88 AM-REF-RL-PR                  VALUE 'P'.
  6714             88 AM-REF-RL-MEAN                VALUE 'M'.
  6715             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6716         16  AM-EARN-METHOD-L              PIC X.
  6717             88 AM-REF-LL-R78                 VALUE 'R'.
  6718             88 AM-REF-LL-PR                  VALUE 'P'.
  6719             88 AM-REF-LL-MEAN                VALUE 'M'.
  6720             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6721         16  AM-EARN-METHOD-A              PIC X.
  6722             88 AM-REF-AH-R78                 VALUE 'R'.
  6723             88 AM-REF-AH-PR                  VALUE 'P'.
  6724             88 AM-REF-AH-MEAN                VALUE 'M'.
  6725             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6726             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6727             88 AM-REF-AH-NET                 VALUE 'N'.
  6728
  6729     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6730     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6731     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6732
  6733     12  AM-RET-Y-N                        PIC X.
  6734     12  AM-RET-P-E                        PIC X.
  6735     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6736     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6737     12  AM-RET-GRP                        PIC X(6).
  6738     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6739         16  AM-POOL-PRIME                 PIC XXX.
  6740         16  AM-POOL-SUB                   PIC XXX.
  6741     12  AM-RETRO-EARNINGS.
  6742         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 124
* EL050.cbl
  6743         16  AM-RET-EARN-L                 PIC X.
  6744         16  AM-RET-EARN-A                 PIC X.
  6745     12  AM-RET-ST-TAX-USE                 PIC X.
  6746         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6747         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6748     12  AM-RETRO-BEG-EARNINGS.
  6749         16  AM-RET-BEG-EARN-R             PIC X.
  6750         16  AM-RET-BEG-EARN-L             PIC X.
  6751         16  AM-RET-BEG-EARN-A             PIC X.
  6752     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6753     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6754
  6755     12  AM-USER-SELECT-OPTIONS.
  6756         16  AM-USER-SELECT-1              PIC X(10).
  6757         16  AM-USER-SELECT-2              PIC X(10).
  6758         16  AM-USER-SELECT-3              PIC X(10).
  6759         16  AM-USER-SELECT-4              PIC X(10).
  6760         16  AM-USER-SELECT-5              PIC X(10).
  6761
  6762     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6763
  6764     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6765
  6766     12  AM-RPT045A-SWITCH                 PIC X.
  6767         88  RPT045A-OFF                   VALUE 'N'.
  6768
  6769     12  AM-INSURANCE-LIMITS.
  6770         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6771         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6772
  6773     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6774         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6775
  6776     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6777         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6778         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6779
  6780     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6781
  6782     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6783     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6784     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6785     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6786     12  AM-DCC-UEF-STATE                  PIC XX.
  6787     12  FILLER                            PIC XXX.
  6788     12  AM-REPORT-CODE-3                  PIC X(10).
  6789*    12  FILLER                            PIC X(22).
  6790
  6791     12  AM-RESERVE-DATE.
  6792         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6793         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6794         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6795
  6796     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6797     12  AM-NOTIFICATION-TYPES.
  6798         16  AM-NOTIF-OF-LETTERS           PIC X.
  6799         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6800         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 125
* EL050.cbl
  6801         16  AM-NOTIF-OF-STATUS            PIC X.
  6802
  6803     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6804         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6805         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6806         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6807         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6808
  6809     12  AM-BENEFIT-CONTROLS.
  6810         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6811             20  AM-BENEFIT-CODE           PIC XX.
  6812             20  AM-BENEFIT-TYPE           PIC X.
  6813             20  AM-BENEFIT-REVISION       PIC XXX.
  6814             20  AM-BENEFIT-REM-TERM       PIC X.
  6815             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6816             20  FILLER                    PIC XX.
  6817         16  FILLER                        PIC X(80).
  6818
  6819     12  AM-TRANSFER-DATA.
  6820         16  AM-TRANSFERRED-FROM.
  6821             20  AM-TRNFROM-CARRIER        PIC X.
  6822             20  AM-TRNFROM-GROUPING.
  6823                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6824                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6825             20  AM-TRNFROM-STATE          PIC XX.
  6826             20  AM-TRNFROM-ACCOUNT.
  6827                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6828                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6829             20  AM-TRNFROM-DTE            PIC XX.
  6830         16  AM-TRANSFERRED-TO.
  6831             20  AM-TRNTO-CARRIER          PIC X.
  6832             20  AM-TRNTO-GROUPING.
  6833                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6834                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6835             20  AM-TRNTO-STATE            PIC XX.
  6836             20  AM-TRNTO-ACCOUNT.
  6837                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6838                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6839             20  AM-TRNTO-DTE              PIC XX.
  6840         16  FILLER                        PIC X(10).
  6841
  6842     12  AM-SAVED-REMIT-TO                 PIC 99.
  6843
  6844     12  AM-COMM-STRUCTURE-SAVED.
  6845         16  AM-DEFN-1-SAVED.
  6846             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6847                 24  AM-AGT-SV             PIC X(10).
  6848                 24  AM-COM-TYP-SV         PIC X.
  6849                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6850                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6851                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6852                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6853                 24  FILLER                PIC X.
  6854                 24  AM-GL-CODES-SV        PIC X.
  6855                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6856                 24  FILLER                PIC X.
  6857         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6858             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 126
* EL050.cbl
  6859                 24  FILLER                PIC X(11).
  6860                 24  AM-L-COMA-SV          PIC XXX.
  6861                 24  AM-J-COMA-SV          PIC XXX.
  6862                 24  AM-A-COMA-SV          PIC XXX.
  6863                 24  FILLER                PIC X(6).
  6864
  6865     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6866         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6867            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6868            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6869            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6870
  6871     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6872     12  FILLER                            PIC X(120).
  6873
  6874     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6875         16  AM-CONTROL-NAME               PIC X(30).
  6876         16  AM-EXECUTIVE-ONE.
  6877             20  AM-EXEC1-NAME             PIC X(15).
  6878             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6879                                                          COMP-3.
  6880             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6881                                                          COMP-3.
  6882         16  AM-EXECUTIVE-TWO.
  6883             20  AM-EXEC2-NAME             PIC X(15).
  6884             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6885                                                          COMP-3.
  6886             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6887                                                          COMP-3.
  6888
  6889     12  AM-RETRO-ADDITIONAL-DATA.
  6890         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6891         16  AM-RETRO-PREM-P-E             PIC X.
  6892         16  AM-RETRO-CLMS-P-I             PIC X.
  6893         16  AM-RETRO-RET-BRACKET-LF.
  6894             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6895                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6896                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6897             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6898                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6899                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6900             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6901                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6902                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6903         16  AM-RETRO-RET-BRACKET-AH.
  6904             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6905                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6906                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6907                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6908             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6909                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6910                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6911             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6912                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6913                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6914
  6915     12  AM-COMMENTS.
  6916         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 127
* EL050.cbl
  6917
  6918     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6919         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6920         16  AM-FLI-BILLING-CODE           PIC X.
  6921         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6922         16  AM-FLI-UNITED-IDENT           PIC X.
  6923         16  AM-FLI-INTEREST-LOST-DATA.
  6924             20  AM-FLI-BANK-NO            PIC X(5).
  6925             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6926             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6927             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6928         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6929             20  AM-FLI-AGT                PIC X(9).
  6930             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6931             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6932         16  FILLER                        PIC X(102).
  6933
  6934     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6935         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6936             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6937             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6938             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6939             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6940             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6941         16  FILLER                          PIC X(10).
  6942******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 128
* EL050.cbl
  6944*    COPY ERCREIN.
  6945******************************************************************
  6946*                                                                *
  6947*                            ERCREIN                             *
  6948*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6949*                            VMOD=2.010                          *
  6950*                                                                *
  6951*   ONLINE CREDIT SYSTEM                                         *
  6952*                                                                *
  6953*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6954*                                                                *
  6955*   FILE TYPE = VSAM,KSDS                                        *
  6956*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6957*                                                                *
  6958*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6959*       ALTERNATE PATH = NONE                                    *
  6960*                                                                *
  6961*   LOG = NO                                                     *
  6962*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6963*                                                                *
  6964******************************************************************
  6965*                   C H A N G E   L O G
  6966*
  6967* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6968*-----------------------------------------------------------------
  6969*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6970* EFFECTIVE    NUMBER
  6971*-----------------------------------------------------------------
  6972* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6973* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6974******************************************************************
  6975 01  REINSURANCE-RECORD.
  6976     12  RE-RECORD-ID                      PIC XX.
  6977         88  VALID-RE-ID                      VALUE 'RE'.
  6978
  6979     12  RE-CONTROL-PRIMARY.
  6980         16  RE-COMPANY-CD                 PIC X.
  6981         16  RE-KEY.
  6982             20  RE-CODE                   PIC X.
  6983                 88  RE-TABLE-RECORD          VALUE 'A'.
  6984                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6985             20  RE-TABLE                  PIC XXX.
  6986             20  FILLER                    PIC XXX.
  6987         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6988             20  FILLER                    PIC X.
  6989             20  RE-COMPANY.
  6990                 24  RE-COMP-PRIME         PIC XXX.
  6991                 24  RE-COMP-SUB           PIC XXX.
  6992
  6993     12  RE-MAINT-INFORMATION.
  6994         16  RE-LAST-MAINT-DT              PIC XX.
  6995         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6996         16  RE-LAST-MAINT-USER            PIC X(4).
  6997         16  FILLER                        PIC X(10).
  6998
  6999     12  RE-TABLE-DATA.
  7000         16  RE-100-COMP                   PIC 99.
  7001
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 129
* EL050.cbl
  7002         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7003             20  RE-REI-COMP-NO.
  7004                 24  RE-REI-COMP           PIC XXX.
  7005                 24  RE-REI-COMP-SUB       PIC XXX.
  7006             20  RE-LF-QC                  PIC X.
  7007             20  RE-AH-QC                  PIC X.
  7008             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7009             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7010             20  RE-LFAGE-LO               PIC 99.
  7011             20  RE-LFAGE-HI               PIC 99.
  7012             20  RE-AHAGE-LO               PIC 99.
  7013             20  RE-AHAGE-HI               PIC 99.
  7014             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7015             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7016             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7017             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7018             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7019             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7020             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7021             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7022             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7023             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7024             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7025             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7026             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7027             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7028             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7029             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7030             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7031             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7032             20  RE-LF-BEN-CODE            PIC X.
  7033             20  RE-AH-BEN-CODE            PIC X.
  7034             20  RE-INTERACTIVE            PIC X.
  7035             20  RE-REMAINING              PIC X.
  7036             20  RE-LF-RUNOFF-SW           PIC X.
  7037             20  RE-AH-RUNOFF-SW           PIC X.
  7038             20  FILLER                    PIC X(19).
  7039
  7040         16  RE-COMP-INFO-END              PIC X(6).
  7041         16  RE-NSP-ST-CD-LF               PIC XX.
  7042         16  RE-NSP-ST-CD-AH               PIC XX.
  7043         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7044             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7045
  7046         16  FILLER                        PIC X(27).
  7047
  7048     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7049         16  RE-NAME                       PIC X(30).
  7050         16  RE-LF-PE                      PIC X.
  7051         16  RE-AH-PE                      PIC X.
  7052         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7053         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7054         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7055         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7056         16  RE-PRT-ST                     PIC X.
  7057         16  RE-PRT-OW                     PIC X.
  7058         16  RE-MORT-CODE                  PIC X(4).
  7059         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 130
* EL050.cbl
  7060         16  RE-ZERO-LF-FEE                PIC X.
  7061         16  RE-ZERO-AH-FEE                PIC X.
  7062         16  RE-CEDE-NAME                  PIC X(30).
  7063         16  RE-LF-COMM                    PIC X.
  7064         16  RE-AH-COMM                    PIC X.
  7065         16  RE-LF-TAX                     PIC X.
  7066         16  RE-AH-TAX                     PIC X.
  7067         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7068         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7069         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7070
  7071         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7072             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7073
  7074         16  RE-LF-CEDING-FEE-BRACKETS.
  7075             20  RE-LF-FEE-METHOD          PIC X.
  7076                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7077                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7078                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7079                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7080             20  RE-LF-FEE-BASIS           PIC X.
  7081                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7082                 88  RE-LF-NET-CEDED               VALUE '2'.
  7083                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7084                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7085                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7086                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7087                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7088                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7089             20  FILLER                    PIC XXX.
  7090             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7091                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7092                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7093
  7094         16  RE-AH-CEDING-FEE-BRACKETS.
  7095             20  RE-AH-FEE-METHOD          PIC X.
  7096                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7097                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7098                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7099                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7100             20  RE-AH-FEE-BASIS           PIC X.
  7101                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7102                 88  RE-AH-NET-CEDED               VALUE '2'.
  7103                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7104                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7105                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7106                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7107                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7108                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7109             20  FILLER                    PIC XXX.
  7110             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7111                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7112                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7113
  7114         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7115
  7116         16  RE-OLD-CEDING-STMT            PIC X.
  7117
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 131
* EL050.cbl
  7118         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7119         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7120         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7121         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7122         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7123         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7124         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7125         16  RE-MORT-SW                    PIC X.
  7126         16  RE-CEDING-TYPE-FLAG           PIC X.
  7127             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7128             88  RE-CEDED                          VALUE 'C'.
  7129             88  RE-ASSUMED                        VALUE 'A'.
  7130             88  RE-PHANTOM                        VALUE 'P'.
  7131
  7132         16  RE-CEDING-STMT-OPT-A          PIC X.
  7133             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7134         16  RE-CEDING-STMT-OPT-B          PIC X.
  7135             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7136         16  RE-CEDING-STMT-OPT-C          PIC X.
  7137             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7138         16  RE-CEDING-STMT-OPT-D          PIC X.
  7139             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7140         16  RE-CEDING-STMT-OPT-E          PIC X.
  7141             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7142
  7143         16  RE-PRT-CRSV                   PIC X.
  7144
  7145         16  RE-GL-CENTER                  PIC X(4).
  7146
  7147         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7148
  7149         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7150
  7151         16  RE-EARN-STOP-CODE             PIC X.
  7152             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7153             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7154
  7155         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7156             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7157
  7158         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7159         16  FILLER                        PIC X(2281).
  7160
  7161         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7162
  7163******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 132
* EL050.cbl
  7165*    COPY ERCCTBL.
  7166******************************************************************
  7167*                                                                *
  7168*                                                                *
  7169*                            ERCCTBL                             *
  7170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7171*                            VMOD=2.003
  7172*                                                                *
  7173*   ONLINE CREDIT SYSTEM                                         *
  7174*                                                                *
  7175*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7176*                                                                *
  7177*   FILE TYPE = VSAM,KSDS                                        *
  7178*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7179*                                                                *
  7180*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7181*       ALTERNATE PATH = NONE                                    *
  7182*                                                                *
  7183*   LOG = NO                                                     *
  7184*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7185*                                                                *
  7186*                                                                *
  7187******************************************************************
  7188
  7189 01  COMM-TABLE-RECORD.
  7190     12  CT-RECORD-ID                      PIC XX.
  7191         88  VALID-CT-ID                      VALUE 'CT'.
  7192
  7193     12  CT-CONTROL-PRIMARY.
  7194         16  CT-COMPANY-CD                 PIC X.
  7195         16  CT-TABLE                      PIC XXX.
  7196         16  CT-CNTRL-2.
  7197             20  CT-BEN-TYPE               PIC X.
  7198             20  CT-BEN-CODE               PIC XX.
  7199
  7200     12  CT-MAINT-INFORMATION.
  7201         16  CT-LAST-MAINT-DT              PIC XX.
  7202         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7203         16  CT-LAST-MAINT-USER            PIC X(4).
  7204         16  FILLER                        PIC X(31).
  7205
  7206     12  CT-LIMITS.
  7207         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7208
  7209         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7210
  7211         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7212
  7213     12  CT-RATES.
  7214         16  CT-RTX          OCCURS 27 TIMES.
  7215             20  CT-RT                     PIC SV9(5)     COMP-3.
  7216             20  CT-RT-R   REDEFINES
  7217                 CT-RT                     PIC XXX.
  7218
  7219     12  FILLER                            PIC  X(42).
  7220
  7221******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 133
* EL050.cbl
  7223*    COPY ERCFORM.
  7224******************************************************************
  7225*                                                                *
  7226*                                                                *
  7227*                            ERCFORM.                            *
  7228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7229*                            VMOD=2.003                          *
  7230*                                                                *
  7231*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7232*                                                                *
  7233*    FILE TYPE = VSAM,KSDS                                       *
  7234*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7235*                                                                *
  7236*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7237*                                                                *
  7238*    LOG = YES                                                   *
  7239*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7240******************************************************************
  7241 01  FORM-MASTER.
  7242    12  FO-RECORD-ID                 PIC X(02).
  7243        88  VALID-FO-ID                  VALUE 'FO'.
  7244
  7245    12  FO-CONTROL-PRIMARY.
  7246        16  FO-COMPANY-CD            PIC X(01).
  7247        16  FO-STATE                 PIC X(02).
  7248        16  FO-FORM-ID               PIC X(12).
  7249        16  FO-FORM-EXP-DT           PIC X(02).
  7250
  7251    12  FO-POLICY-FORM-DATA.
  7252        16  FO-IND-GRP-CD            PIC X(01).
  7253        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7254        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7255        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7256        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7257        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7258        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7259        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7260        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7261        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7262        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7263        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7264        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7265        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7266        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7267        16  FO-APP-CERT-USE-CD       PIC X(01).
  7268
  7269    12  FILLER                       PIC X(29).
  7270
  7271    12  FO-FORM-PLAN-TABLE.
  7272        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7273            20  FO-PLAN-TYPE         PIC X(01).
  7274            20  FO-PLAN-ID           PIC X(02).
  7275            20  FO-PLAN-TERM         PIC 9(03).
  7276            20  FO-PLAN-REFUND-METHOD
  7277                                     PIC X.
  7278
  7279    12  FILLER                       PIC X(30).
  7280
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 134
* EL050.cbl
  7281    12  FO-COMMENTS-AREA.
  7282        16  FO-COMMENT-LINE-1        PIC X(78).
  7283
  7284    12  FILLER                       PIC X(20).
  7285
  7286    12  FO-MAINT-INFORMATION.
  7287        16  FO-LAST-MAINT-DT         PIC X(02).
  7288        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7289        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 135
* EL050.cbl
  7291*    COPY ELCMSTR.
  7292******************************************************************
  7293*                                                                *
  7294*                            ELCMSTR.                            *
  7295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7296*                            VMOD=2.012                          *
  7297*                                                                *
  7298*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7299*                                                                *
  7300*   FILE TYPE = VSAM,KSDS                                        *
  7301*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7302*                                                                *
  7303*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7304*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7305*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7306*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7307*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7308*                                                 RKP=75,LEN=21  *
  7309*                                                                *
  7310*   **** NOTE ****                                               *
  7311*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7312*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7313*                                                                *
  7314*   LOG = YES                                                    *
  7315*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7316******************************************************************
  7317*                   C H A N G E   L O G
  7318*
  7319* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7320*-----------------------------------------------------------------
  7321*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7322* EFFECTIVE    NUMBER
  7323*-----------------------------------------------------------------
  7324* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7325* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7326* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7327* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7328* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7329******************************************************************
  7330 01  CLAIM-MASTER.
  7331     12  CL-RECORD-ID                PIC XX.
  7332         88  VALID-CL-ID         VALUE 'CL'.
  7333
  7334     12  CL-CONTROL-PRIMARY.
  7335         16  CL-COMPANY-CD           PIC X.
  7336         16  CL-CARRIER              PIC X.
  7337         16  CL-CLAIM-NO             PIC X(7).
  7338         16  CL-CERT-NO.
  7339             20  CL-CERT-PRIME       PIC X(10).
  7340             20  CL-CERT-SFX         PIC X.
  7341
  7342     12  CL-CONTROL-BY-NAME.
  7343         16  CL-COMPANY-CD-A1        PIC X.
  7344         16  CL-INSURED-LAST-NAME    PIC X(15).
  7345         16  CL-INSURED-NAME.
  7346             20  CL-INSURED-1ST-NAME PIC X(12).
  7347             20  CL-INSURED-MID-INIT PIC X.
  7348
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 136
* EL050.cbl
  7349     12  CL-CONTROL-BY-SSN.
  7350         16  CL-COMPANY-CD-A2        PIC X.
  7351         16  CL-SOC-SEC-NO.
  7352             20  CL-SSN-STATE        PIC XX.
  7353             20  CL-SSN-ACCOUNT      PIC X(6).
  7354             20  CL-SSN-LN3          PIC X(3).
  7355
  7356     12  CL-CONTROL-BY-CERT-NO.
  7357         16  CL-COMPANY-CD-A4        PIC X.
  7358         16  CL-CERT-NO-A4.
  7359             20  CL-CERT-A4-PRIME    PIC X(10).
  7360             20  CL-CERT-A4-SFX      PIC X.
  7361
  7362     12  CL-CONTROL-BY-CCN.
  7363         16  CL-COMPANY-CD-A5        PIC X.
  7364         16  CL-CCN-A5.
  7365             20  CL-CCN.
  7366                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7367                 24  CL-CCN-PRIME-A5 PIC X(12).
  7368             20  CL-CCN-FILLER-A5    PIC X(4).
  7369
  7370     12  CL-INSURED-PROFILE-DATA.
  7371         16  CL-INSURED-BIRTH-DT     PIC XX.
  7372         16  CL-INSURED-SEX-CD       PIC X.
  7373             88  INSURED-IS-MALE        VALUE 'M'.
  7374             88  INSURED-IS-FEMALE      VALUE 'F'.
  7375             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7376         16  CL-INSURED-OCC-CD       PIC X(6).
  7377         16  FILLER                  PIC X(5).
  7378
  7379     12  CL-PROCESSING-INFO.
  7380         16  CL-PROCESSOR-ID         PIC X(4).
  7381         16  CL-CLAIM-STATUS         PIC X.
  7382             88  CLAIM-IS-OPEN          VALUE 'O'.
  7383             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7384         16  CL-CLAIM-TYPE           PIC X.
  7385*            88  AH-CLAIM               VALUE 'A'.
  7386*            88  LIFE-CLAIM             VALUE 'L'.
  7387*            88  PROPERTY-CLAIM         VALUE 'P'.
  7388*            88  IUI-CLAIM              VALUE 'I'.
  7389*            88  GAP-CLAIM              VALUE 'G'.
  7390*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7391         16  CL-CLAIM-PREM-TYPE      PIC X.
  7392             88  SINGLE-PREMIUM         VALUE '1'.
  7393             88  O-B-COVERAGE           VALUE '2'.
  7394             88  OPEN-END-COVERAGE      VALUE '3'.
  7395         16  CL-INCURRED-DT          PIC XX.
  7396         16  CL-REPORTED-DT          PIC XX.
  7397         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7398         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7399         16  CL-LAST-PMT-DT          PIC XX.
  7400         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7401         16  CL-PAID-THRU-DT         PIC XX.
  7402         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7403         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7404         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7405         16  CL-PMT-CALC-METHOD      PIC X.
  7406             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 137
* EL050.cbl
  7407             88  CL-365-DAY-YR          VALUE '2'.
  7408             88  CL-FULL-MONTHS         VALUE '3'.
  7409         16  CL-CAUSE-CD             PIC X(6).
  7410
  7411         16  CL-PRIME-CERT-NO.
  7412             20  CL-PRIME-CERT-PRIME PIC X(10).
  7413             20  CL-PRIME-CERT-SFX   PIC X.
  7414
  7415         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7416             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7417             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7418
  7419         16  CL-MICROFILM-NO         PIC X(10).
  7420         16  FILLER REDEFINES CL-MICROFILM-NO.
  7421             20  CL-BENEFIT-PERIOD   PIC 99.
  7422             20  FILLER              PIC X(8).
  7423         16  CL-PROG-FORM-TYPE       PIC X.
  7424         16  CL-LAST-ADD-ON-DT       PIC XX.
  7425
  7426         16  CL-LAST-REOPEN-DT       PIC XX.
  7427         16  CL-LAST-CLOSE-DT        PIC XX.
  7428         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7429             88  FINAL-PAID             VALUE '1'.
  7430             88  CLAIM-DENIED           VALUE '2'.
  7431             88  AUTO-CLOSE             VALUE '3'.
  7432             88  MANUAL-CLOSE           VALUE '4'.
  7433             88  BENEFITS-CHANGED       VALUE 'C'.
  7434             88  SETUP-ERRORS           VALUE 'E'.
  7435         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7436         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7437         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7438             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7439         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7440         16  FILLER                  PIC X.
  7441
  7442     12  CL-CERTIFICATE-DATA.
  7443         16  CL-CERT-ORIGIN          PIC X.
  7444             88  CERT-WAS-ONLINE        VALUE '1'.
  7445             88  CERT-WAS-CREATED       VALUE '2'.
  7446             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7447         16  CL-CERT-KEY-DATA.
  7448             20  CL-CERT-CARRIER     PIC X.
  7449             20  CL-CERT-GROUPING    PIC X(6).
  7450             20  CL-CERT-STATE       PIC XX.
  7451             20  CL-CERT-ACCOUNT.
  7452                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7453                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7454             20  CL-CERT-EFF-DT      PIC XX.
  7455
  7456     12  CL-STATUS-CONTROLS.
  7457         16  CL-PRIORITY-CD          PIC X.
  7458             88  CONFIDENTIAL-DATA      VALUE '8'.
  7459             88  HIGHEST-PRIORITY       VALUE '9'.
  7460         16  CL-SUPV-ATTN-CD         PIC X.
  7461             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7462             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7463         16  CL-PURGED-DT            PIC XX.
  7464         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 138
* EL050.cbl
  7465         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7466         16  CL-NEXT-RESEND-DT       PIC XX.
  7467         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7468         16  CL-CRITICAL-PERIOD      PIC 99.
  7469*        16  FILLER                  PIC XX.
  7470         16  CL-LAST-MAINT-DT        PIC XX.
  7471         16  CL-LAST-MAINT-USER      PIC X(4).
  7472         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7473         16  CL-LAST-MAINT-TYPE      PIC X.
  7474             88  CLAIM-SET-UP           VALUE ' '.
  7475             88  PAYMENT-MADE           VALUE '1'.
  7476             88  LETTER-SENT            VALUE '2'.
  7477             88  MASTER-WAS-ALTERED     VALUE '3'.
  7478             88  MASTER-WAS-RESTORED    VALUE '4'.
  7479             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7480             88  FILE-CONVERTED         VALUE '6'.
  7481             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7482             88  ERROR-CORRECTION       VALUE 'E'.
  7483         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7484         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7485         16  CL-BENEFICIARY          PIC X(10).
  7486         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7487         16  CL-DENIAL-TYPE          PIC X.
  7488             88  CL-TYPE-DENIAL          VALUE '1'.
  7489             88  CL-TYPE-RESCISSION      VALUE '2'.
  7490             88  CL-TYPE-REFORMATION     VALUE '3'.
  7491             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7492             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7493         16  filler                  pic x(5).
  7494*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7495*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7496*        16  CL-RTW-DT               PIC XX.
  7497
  7498     12  CL-TRAILER-CONTROLS.
  7499         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7500             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7501             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7502             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7503         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7504         16  FILLER                  PIC XX.
  7505         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7506         16  CL-ADDRESS-TRAILER-CNT.
  7507             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7508                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7509             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7510                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7511             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7512                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7513             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7514                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7515             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7516                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7517             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7518                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7519             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7520                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7521
  7522     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 139
* EL050.cbl
  7523         16  CL-CV-REFNO-PRIME       PIC X(18).
  7524         16  CL-CV-REFNO-SFX         PIC XX.
  7525
  7526     12  CL-FILE-LOCATION            PIC X(4).
  7527
  7528     12  CL-PROCESS-ERRORS.
  7529         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7530             88  NO-FATAL-ERRORS        VALUE ZERO.
  7531         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7532             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7533
  7534     12  CL-PRODUCT-CD               PIC X.
  7535
  7536     12  CL-CURRENT-KEY-DATA.
  7537         16  CL-CURRENT-CARRIER      PIC X.
  7538         16  CL-CURRENT-GROUPING     PIC X(6).
  7539         16  CL-CURRENT-STATE        PIC XX.
  7540         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7541
  7542     12  CL-ASSOCIATES               PIC X.
  7543         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7544         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7545         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7546         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7547
  7548     12  CL-ACTIVITY-CODE            PIC 99.
  7549     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7550     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7551
  7552     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7553     12  CL-LAG-REPORT-CODE          PIC 9.
  7554     12  CL-LOAN-TYPE                PIC XX.
  7555     12  CL-LEGAL-STATE              PIC XX.
  7556
  7557     12  CL-YESNOSW                  PIC X.
  7558     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7559         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7560         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7561         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7562     12  cl-insured-type             pic x.
  7563         88  cl-claim-on-primary         value 'P'.
  7564         88  cl-claim-on-co-borrower     value 'C'.
  7565     12  cl-benefit-expiration-dt    PIC XX.
  7566
  7567 01  PLAN-RECORDS.
  7568     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7569     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7570
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 140
* EL050.cbl
  7572 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7573                          ACCOUNT-MASTER REINSURANCE-RECORD
  7574                          COMM-TABLE-RECORD FORM-MASTER
  7575                          CLAIM-MASTER PLAN-RECORDS.
  7576 0000-DFHEXIT SECTION.
  7577     MOVE '9#                    $   ' TO DFHEIV0.
  7578     MOVE 'EL050' TO DFHEIV1.
  7579     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7580
  7581     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7582
  7583
  7584* EXEC CICS  HANDLE CONDITION
  7585*           ERROR    (9300-ABEND)
  7586*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7587*    END-EXEC.
  7588*    MOVE '"$.J                  ! " #00007579' TO DFHEIV0
  7589     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7591     MOVE X'2220233030303037353739' TO DFHEIV0(25:11)
  7592     CALL 'kxdfhei1' USING DFHEIV0
  7593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7594
  7595
  7596 0000-COPY-PROCEDURE-DIV.
  7597*                          COPY ELC50PD.
  7598******************************************************************
  7599*                                                                *
  7600*                            ELC50PD                             *
  7601*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7602*                            VMOD=2.188                          *
  7603*                                                                *
  7604******************************************************************
  7605*                   C H A N G E   L O G
  7606*
  7607* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7608*-----------------------------------------------------------------
  7609*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7610* EFFECTIVE    NUMBER
  7611*-----------------------------------------------------------------
  7612* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7613* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7614* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7615*                             2709 AND 2718
  7616* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7617* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7618* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7619* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7620* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7621*                                IS OPEN OR CNC DT < PD THRU
  7622* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7623* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7624* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7625* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7626* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7627* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7628* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7629* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 141
* EL050.cbl
  7630* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7631* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7632* 020906                   PEMA  EXPAND LOAN OFFICER
  7633* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7634* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7635* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7636* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7637* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7638* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7639* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7640* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7641* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7642* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7643* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7644* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7645* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7646* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7647* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7648* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7649* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7650* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7651* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7652* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7653* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7654* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7655* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7656* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7657* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7658*                                UPDATE VIN ON CERT TRAILER
  7659* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7660* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7661* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7662* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7663* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7664* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7665* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7666* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7667* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7668* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7669* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7670* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7671* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7672* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7673* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7674* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7675* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7676* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7677* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7678* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7679* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7680* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7681* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7682* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7683* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7684* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7685* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7686* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7687* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 142
* EL050.cbl
  7688* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7689* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7690* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7691* 032912  CR2011110200001  PEMA  AHL CHANGES
  7692* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7693* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7694* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7695* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7696* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7697* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7698* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7699* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7700* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7701* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7702* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7703* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7704* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7705* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7706* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7707* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7708* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7709* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7710* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7711* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7712* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7713* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7714* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7715* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7716******************************************************************
  7717************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7718******************************************************************
  7719
  7720     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7721
  7722     MOVE SPACES                 TO PB-FATAL-FLAG
  7723                                    PB-FORCE-ER-CD
  7724                                    PB-WARN-ER-CD
  7725                                    PB-OUT-BAL-CD.
  7726
  7727     MOVE SPACE                  TO WS-IG-OVRD-AH
  7728                                    WS-IG-OVRD-LF
  7729                                    WS-IG-OVRD-AM
  7730                                    WS-IG-OVRD
  7731                                    WS-IG-OVRD-AH-PL
  7732                                    WS-IG-OVRD-LF-PL
  7733                                    WS-IG-OVRD-AH-BEN
  7734                                    WS-IG-OVRD-LF-BEN.
  7735
  7736******************************************************************
  7737*************       INITIALIZE COMMON ERRORS       ***************
  7738******************************************************************
  7739
  7740     MOVE +0                     TO PB-NO-OF-ERRORS.
  7741     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7742
  7743******************************************************************
  7744
  7745     MOVE EIBDATE                TO DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 143
* EL050.cbl
  7746     SET JULIAN-TO-BIN           TO TRUE.
  7747*    MOVE 5                      TO DC-OPTION-CODE.
  7748     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7749     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7750
  7751     MOVE ZERO                   TO  SUB4.
  7752
  7753 0040-INITIALIZE-GA-BILL-DT.
  7754
  7755     ADD +1                      TO  SUB4.
  7756
  7757     IF  SUB4 GREATER THAN +5
  7758         GO TO 0050-CHECK-CNTL-FOUND.
  7759
  7760     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7761         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7762
  7763     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7764
  7765 0050-CHECK-CNTL-FOUND.
  7766
  7767     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7768        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7769                                         WS-AH-REM-TERM-CALC
  7770                                         EC-CO-REM-TERM-CALC
  7771        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7772        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7773        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7774                                         WS-TOL-AH-CLAIM
  7775        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7776                                         WS-TOL-AH-PREM
  7777                                         EC-CO-TOL-PREM
  7778        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7779                                         WS-TOL-AH-REFUND
  7780                                         EC-CO-TOL-REFUND
  7781        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7782                                         WS-AH-REFUND-OVS-AMT
  7783                                         EC-CO-OVR-SHT-AMT
  7784        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7785                                         WS-TOL-AH-PREM-PCT
  7786                                         EC-CO-TOL-PREM-PCT
  7787        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7788                                         WS-TOL-AH-REFUND-PCT
  7789                                         EC-CO-TOL-REFUND-PCT
  7790        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7791                                         WS-AH-REFUND-OVS-PCT
  7792                                         EC-CO-OVR-SHT-PCT
  7793        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7794        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7795        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7796        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7797        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7798        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7799        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7800        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7801        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7802        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7803        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 144
* EL050.cbl
  7804        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7805                                         EC-CO-MONTH-END-DT
  7806        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7807          GO TO 0100-READ-ACCT.
  7808
  7809     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7810     MOVE SPACES                 TO CNTL-ACCESS.
  7811     MOVE '1'                    TO CNTL-REC-TYPE.
  7812     MOVE +0                     TO CNTL-SEQ-NO.
  7813
  7814     MOVE '1' TO RC-SW-1.
  7815     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7816     IF NOT CF-COMPANY-MASTER
  7817         MOVE ZEROS             TO WK-CO-TOL-PREM
  7818                                   WK-CO-TOL-CLAIM
  7819                                   WK-CO-TOL-REFUND
  7820                                   WK-REFUND-OVS-AMT
  7821                                   WK-REFUND-OVS-PCT
  7822                                   WK-CO-TOL-PREM-PCT
  7823                                   WK-CO-TOL-REFUND-PCT
  7824                                   WK-DEFAULT-APR
  7825                                   WK-CO-MAX-CAP
  7826        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7827                                   WK-CR-R78-METHOD
  7828                                   WK-CO-REF-REJECT-SW
  7829                                   WK-CO-PREM-REJECT-SW
  7830                                   WK-REM-TRM-CALC-OPTION
  7831                                   WK-BIRTH-DATE-INPUT
  7832                                   WK-JOINT-AGE-INPUT
  7833        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7834        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7835        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7836        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7837          GO TO 0099-COMPANY-NOT-FOUND.
  7838
  7839     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7840        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7841     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7842        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7843     IF CF-CO-TOL-CAP NOT NUMERIC
  7844        MOVE +0                    TO CF-CO-TOL-CAP.
  7845     IF CF-DEFAULT-APR NOT NUMERIC
  7846        MOVE +0                    TO CF-DEFAULT-APR.
  7847
  7848     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7849     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7850     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7851     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7852     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7853     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7854     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7855     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7856     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7857     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7858     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7859     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7860
  7861     IF CF-CO-OVR-SHT-AMT NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 145
* EL050.cbl
  7862          CF-CO-OVR-SHT-AMT > +0
  7863        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7864
  7865     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7866          CF-CO-OVR-SHT-PCT > +0
  7867        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7868
  7869     IF CF-VALID-REM-TRM-OPTION
  7870         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7871     ELSE
  7872         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7873
  7874     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7875     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7876     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7877     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7878
  7879     GO TO 0050-CHECK-CNTL-FOUND.
  7880
  7881 0099-COMPANY-NOT-FOUND.
  7882
  7883     MOVE ER-2616                TO WS-ERROR.
  7884     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7885
  7886 0100-READ-ACCT.
  7887
  7888     MOVE SPACES                 TO DATE-RANGE-SW.
  7889
  7890     IF WK-ACCT-ADDR = ZEROS
  7891        GO TO 0102-ACCT-GETMAIN.
  7892
  7893     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7894     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7895     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7896
  7897     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7898        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7899        GO TO 0105-READ-ACCT
  7900     END-IF
  7901
  7902     IF PB-CARRIER NOT = SPACES
  7903        IF PB-CARRIER NOT = AM-VG-CARRIER
  7904           GO TO 0105-READ-ACCT.
  7905
  7906     IF PB-STATE NOT = SPACES
  7907        IF PB-STATE NOT = AM-VG-STATE
  7908           GO TO 0105-READ-ACCT.
  7909
  7910     IF PB-GROUPING NOT = SPACES
  7911        IF PB-GROUPING NOT = AM-VG-GROUPING
  7912           GO TO 0105-READ-ACCT.
  7913
  7914     MOVE 'X'                 TO DATE-RANGE-SW.
  7915
  7916     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7917        MOVE 'X'                 TO DATE-RANGE-SW
  7918        GO TO 0105-READ-ACCT.
  7919
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 146
* EL050.cbl
  7920     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7921        GO TO 0105-READ-ACCT.
  7922
  7923     GO TO 0180-ACCOUNT-FOUND.
  7924
  7925 0102-ACCT-GETMAIN.
  7926     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7927     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7928
  7929 0105-READ-ACCT.
  7930     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7931     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7932     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7933     MOVE PB-STATE               TO ACCT-STATE.
  7934     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7935     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7936
  7937     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7938
  7939     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7940
  7941 0110-FIND-ACCT-TOLERANCES-LOOP.
  7942     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7943
  7944     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7945        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7946        GO TO 0199-ACCT-NOT-FOUND
  7947     END-IF
  7948     IF PB-CARRIER NOT = SPACES
  7949        IF PB-CARRIER NOT = AM-VG-CARRIER
  7950           GO TO 0199-ACCT-NOT-FOUND.
  7951
  7952     IF PB-STATE NOT = SPACES
  7953        IF PB-STATE NOT = AM-VG-STATE
  7954           GO TO 0199-ACCT-NOT-FOUND.
  7955
  7956     IF PB-GROUPING NOT = SPACES
  7957        IF PB-GROUPING NOT = AM-VG-GROUPING
  7958           GO TO 0199-ACCT-NOT-FOUND.
  7959
  7960     MOVE 'X'                    TO DATE-RANGE-SW.
  7961
  7962     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7963        MOVE 'X'                 TO DATE-RANGE-SW
  7964        GO TO 0199-ACCT-NOT-FOUND.
  7965
  7966     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7967        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7968
  7969 0180-ACCOUNT-FOUND.
  7970     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7971     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7972     MOVE AM-STATE               TO PB-SV-STATE.
  7973     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7974
  7975     IF AM-CANCEL-FEE  NOT NUMERIC
  7976        MOVE ZEROS TO AM-CANCEL-FEE.
  7977
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 147
* EL050.cbl
  7978     IF AM-MAX-MON-BEN NOT NUMERIC
  7979        MOVE ZEROS TO AM-MAX-MON-BEN.
  7980
  7981     IF AM-MAX-TOT-BEN NOT NUMERIC
  7982        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7983
  7984     IF AM-CLP-TOL-PCT NOT NUMERIC
  7985        MOVE +0                  TO AM-CLP-TOL-PCT
  7986     END-IF
  7987     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7988        MOVE +0                  TO AM-SPP-LEASE-COMM
  7989     END-IF
  7990     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7991        MOVE ER-2611             TO   WS-ERROR
  7992        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7993
  7994     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7995        MOVE ER-2621             TO   WS-ERROR
  7996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7997
  7998     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7999        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8000        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8001        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8002         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8003
  8004     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8005     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8006     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8007     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8008     IF AM-CLP-TOL-PCT NOT = ZEROS
  8009        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8010     END-IF
  8011     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8012        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8013     END-IF
  8014*    IF PB-COMPANY-ID = 'DCC'
  8015*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8016*                                   WS-ADMIN-FEES
  8017*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8018*          (SUB5 > +10)
  8019*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8020*             AND (AM-A-COM (SUB5) NUMERIC)
  8021*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8022*                + (AM-A-COM (SUB5) * 1000)
  8023*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8024*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8025*                + (AM-A-COM (SUB5) * 1000)
  8026*             END-IF
  8027*             IF AM-COM-TYP (SUB5) = 'N'
  8028*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8029*                + (AM-A-COM (SUB5) * 1000)
  8030*             END-IF
  8031*          END-IF
  8032*       END-PERFORM
  8033*    END-IF
  8034     IF (PB-COMPANY-ID = 'DCC')
  8035        AND (PB-ISSUE)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 148
* EL050.cbl
  8036        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8037        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8038           (SUB5 > +10)
  8039           MOVE +0 TO WS-WK-RATE
  8040           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8041              IF (AM-A-COM (SUB5) NUMERIC)
  8042                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8043                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8044              ELSE
  8045                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8046                 IF PB-ISSUE
  8047                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8048                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8049                 ELSE
  8050                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8051                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8052                 END-IF
  8053                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8054                 MOVE ZEROS             TO WS-SUB1
  8055                                           WS-COMMISSION
  8056                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8057                 MOVE '0530'               TO CTBL-SW
  8058                 MOVE ' '                  TO WS-CTBL-READ-SW
  8059                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8060                 IF FIRST-TIME-THROUGH
  8061                    MOVE 'AA'              TO CTBL-BEN-CODE
  8062                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8063                 END-IF
  8064                 IF CTBL-TABLE-FOUND
  8065                    IF PB-ISSUE
  8066                       COMPUTE WS-COMM-CK-AMT =
  8067                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8068                    ELSE
  8069                       COMPUTE WS-COMM-CK-AMT =
  8070                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8071                    END-IF
  8072                    PERFORM 8800-GET-COMP-RATE
  8073                              THRU 8800-EXIT
  8074                 END-IF
  8075              END-IF
  8076              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8077                + (WS-WK-RATE * 1000)
  8078           END-IF
  8079        END-PERFORM
  8080     END-IF
  8081     IF PB-COMPANY-ID EQUAL 'CRI'
  8082         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8083
  8084     IF PB-COMPANY-ID EQUAL 'NCL'
  8085         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8086     END-IF
  8087
  8088     GO TO 0200-READ-CERT.
  8089
  8090 0199-ACCT-NOT-FOUND.
  8091
  8092     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8093
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 149
* EL050.cbl
  8094     IF DATE-RANGE-SW NOT = SPACES
  8095        MOVE ER-2601             TO WS-ERROR
  8096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8097     ELSE
  8098        MOVE ER-2619             TO WS-ERROR
  8099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8100
  8101     GO TO 9990-RETURN.
  8102
  8103 0200-READ-CERT.
  8104
  8105     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8106     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8107     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8108     MOVE PB-SV-STATE            TO CERT-STATE.
  8109     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8110     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8111     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8112
  8113     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8114
  8115     IF CERT-WAS-NOT-FOUND
  8116        GO TO 0299-CERT-NOT-FOUND.
  8117
  8118     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8119        MOVE ER-2759             TO WS-ERROR
  8120        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8121        GO TO 0298-UNLOCK-RETURN.
  8122
  8123     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8124         MOVE ER-2758            TO WS-ERROR
  8125         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8126         GO TO 0298-UNLOCK-RETURN.
  8127
  8128     IF PB-ISSUE
  8129        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8130           IF CERT-WAS-CREATED-FOR-CLAIM
  8131              NEXT SENTENCE
  8132            ELSE
  8133              MOVE ER-2626       TO WS-ERROR
  8134              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8135              GO TO 0298-UNLOCK-RETURN.
  8136
  8137     IF NOT PB-CANCELLATION
  8138        GO TO 0300-CONTINUE-EDIT.
  8139
  8140     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8141     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8142     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8143     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8144     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8145     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8146
  8147     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8148     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8149     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8150     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8151     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 150
* EL050.cbl
  8152     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8153     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8154     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8155     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8156
  8157     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8158     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8159     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8160     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8161     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8162     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8163     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8164
  8165     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8166     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8167
  8168     MOVE CM-CREDIT-INTERFACE-SW-1
  8169                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8170     MOVE CM-CREDIT-INTERFACE-SW-2
  8171                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8172
  8173     IF CM-O-B-COVERAGE
  8174         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8175
  8176     IF CM-LIVES NOT NUMERIC
  8177         MOVE ZERO                TO CM-LIVES.
  8178
  8179     IF CM-BILLED NOT NUMERIC
  8180         MOVE ZERO                TO CM-BILLED.
  8181
  8182     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8183         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8184         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8185         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8186         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8187         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8188         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8189         MOVE CM-LIVES             TO PB-CI-LIVES
  8190*The next line causes a problem with my change  I dont think it is
  8191*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8192
  8193     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8194     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8195     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8196     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8197     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8198     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8199
  8200     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8201     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8202     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8203     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8204
  8205     IF CM-LIFE-COMM-PCT NUMERIC
  8206         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8207     ELSE
  8208         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8209
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 151
* EL050.cbl
  8210     IF CM-AH-COMM-PCT NUMERIC
  8211         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8212     ELSE
  8213         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8214
  8215     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8216
  8217     IF CM-LOAN-APR       NOT NUMERIC
  8218           MOVE ZERO               TO CM-LOAN-APR.
  8219
  8220     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8221           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8222
  8223     IF CM-LOAN-TERM      NOT NUMERIC
  8224           MOVE ZERO               TO CM-LOAN-TERM.
  8225
  8226     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8227           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8228
  8229     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8230           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8231
  8232     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8233     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8234     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8235     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8236     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8237     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8238     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8239     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8240     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8241     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8242     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8243     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8244
  8245     IF CM-STATE = CM-SSN-STATE
  8246         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8247
  8248     IF CM-STATE NOT = CM-MEMB-STATE
  8249         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8250
  8251     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8252
  8253     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8254        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8255        IF CM-ADDL-CLP NOT NUMERIC
  8256           MOVE +0               TO CM-ADDL-CLP
  8257        END-IF
  8258        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8259        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8260           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8261        END-IF
  8262     END-IF
  8263     IF PB-COMPANY-ID = 'DCC'
  8264        MOVE +0                  TO WS-ADMIN-FEES
  8265                                    WS-CSO-ADMIN-FEE
  8266                                    WS-COMM-AND-MFEE
  8267                                    WS-1ST-YR-ALLOW
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 152
* EL050.cbl
  8268        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8269           (SUB5 > +10)
  8270           MOVE +0 TO WS-WK-RATE
  8271           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8272              IF (AM-A-COM (SUB5) NUMERIC)
  8273                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8274                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8275              ELSE
  8276                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8277                 IF PB-ISSUE
  8278                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8279                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8280                 ELSE
  8281                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8282                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8283                 END-IF
  8284                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8285                 MOVE ZEROS             TO WS-SUB1
  8286                                           WS-COMMISSION
  8287                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8288                 MOVE '0530'               TO CTBL-SW
  8289                 MOVE ' '                  TO WS-CTBL-READ-SW
  8290                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8291                 IF FIRST-TIME-THROUGH
  8292                    MOVE 'AA'              TO CTBL-BEN-CODE
  8293                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8294                 END-IF
  8295                 IF CTBL-TABLE-FOUND
  8296                    IF PB-ISSUE
  8297                       COMPUTE WS-COMM-CK-AMT =
  8298                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8299                    ELSE
  8300                       COMPUTE WS-COMM-CK-AMT =
  8301                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8302                    END-IF
  8303                    PERFORM 8800-GET-COMP-RATE
  8304                              THRU 8800-EXIT
  8305                 END-IF
  8306              END-IF
  8307              IF AM-COM-TYP (SUB5) = 'I'
  8308                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8309                   + (WS-WK-RATE * 1000)
  8310              END-IF
  8311              IF AM-COM-TYP (SUB5) = 'N'
  8312                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8313                   + (WS-WK-RATE * 1000)
  8314              END-IF
  8315              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8316                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8317                   + (WS-WK-RATE * 1000)
  8318              END-IF
  8319              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8320                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8321                   + (WS-WK-RATE * 1000)
  8322              END-IF
  8323           END-IF
  8324        END-PERFORM
  8325     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 153
* EL050.cbl
  8326     GO TO 0300-CONTINUE-EDIT.
  8327
  8328 0298-UNLOCK-RETURN.
  8329      PERFORM 9250-UNLOCK-RETURN
  8330      GO TO 9990-RETURN.
  8331
  8332 0299-CERT-NOT-FOUND.
  8333
  8334     MOVE '1'                     TO CERT-STATUS-SW.
  8335
  8336     IF PB-COMPANY-ID = 'UCL'
  8337         IF WS-ERROR = ER-2799
  8338             GO TO 3000-CONTINUE-EDIT.
  8339
  8340     IF NOT PB-CANCELLATION
  8341         GO TO 0300-CONTINUE-EDIT.
  8342
  8343     MOVE ER-2726                  TO  WS-ERROR.
  8344     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8345     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8346     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8347                                    PB-CI-LF-TERM
  8348                                    PB-C-LF-REM-TERM
  8349                                    PB-CI-AH-TERM
  8350                                    PB-C-AH-REM-TERM
  8351                                    PB-CI-LF-BENEFIT-CD
  8352                                    PB-CI-LF-BENEFIT-AMT
  8353                                    PB-CI-LF-ALT-BENEFIT-AMT
  8354                                    PB-CI-LF-PREMIUM-AMT
  8355                                    PB-CI-LF-ALT-PREMIUM-AMT
  8356                                    PB-CI-AH-BENEFIT-CD
  8357                                    PB-CI-AH-BENEFIT-AMT
  8358                                    PB-CI-AH-PREMIUM-AMT
  8359                                    PB-CI-PAY-FREQUENCY
  8360                                    PB-CI-LOAN-APR
  8361                                    PB-CI-LOAN-TERM
  8362                                    PB-CI-LIFE-COMMISSION
  8363                                    PB-CI-AH-COMMISSION
  8364                                    PB-CI-CURR-SEQ
  8365                                    PB-CI-AH-CANCEL-AMT
  8366                                    PB-CI-LF-CANCEL-AMT
  8367                                    PB-CI-RATE-DEV-PCT-LF
  8368                                    PB-CI-RATE-DEV-PCT-AH
  8369                                    PB-CI-EXTENTION-DAYS
  8370                                    PB-CI-TERM-IN-DAYS
  8371                                    PB-CI-LIVES
  8372                                    PB-CI-LF-CRIT-PER
  8373                                    PB-CI-AH-CRIT-PER
  8374                                    PB-CI-ADDL-CLP
  8375                                    PB-CI-DDF-IU-RATE-UP.
  8376
  8377     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8378                                    PB-CI-AH-SETTLEMENT-DT
  8379                                    PB-CI-DEATH-DT
  8380                                    PB-CI-LF-PRIOR-CANCEL-DT
  8381                                    PB-CI-AH-PRIOR-CANCEL-DT
  8382                                    PB-CI-ENTRY-DT
  8383                                    PB-CI-LF-EXPIRE-DT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 154
* EL050.cbl
  8384                                    PB-CI-AH-EXPIRE-DT
  8385                                    PB-CI-LOAN-1ST-PMT-DT.
  8386
  8387     IF ACCOUNT-MAST-FOUND
  8388        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8389        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8390
  8391
  8392 0300-CONTINUE-EDIT.
  8393
  8394     IF PB-ISSUE
  8395        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8396            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8397
  8398     IF PB-ISSUE
  8399        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8400            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8401
  8402     IF PB-ISSUE
  8403       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8404          (AM-NO-AH-ONLY)
  8405           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8406               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8407                   MOVE ER-2679 TO WS-ERROR
  8408                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8409
  8410     IF PB-ISSUE
  8411        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8412        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8413        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8414     ELSE
  8415        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8416        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8417        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8418
  8419     MOVE 'N'                    TO PLAN-MASTER-SW
  8420                                    PLAN-MASTER-LIFE-SW
  8421                                    FORM-MASTER-SW
  8422                                    WS-APP-CERT-SW.
  8423
  8424     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8425                                    WS-PL-TOL-LF-REFUND
  8426                                    WS-PL-REF-OVS-AMT
  8427                                    WS-PL-TOL-LF-PREM-PCT
  8428                                    WS-PL-TOL-LF-REFUND-PCT
  8429                                    WS-PL-REF-OVS-PCT
  8430                                    WS-PL-TOL-LF-CLAIM.
  8431
  8432     IF PB-COMPANY-ID = 'NCL'
  8433       IF PB-ISSUE
  8434         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8435             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8436             IF FORM-MASTER-FOUND
  8437                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8438
  8439     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8440        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8441
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 155
* EL050.cbl
  8442********************** MON CODE **********************
  8443     IF PB-COMPANY-ID = 'MON'
  8444     IF PB-ISSUE
  8445     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8446        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8447             PB-I-LOAN-APR = ZERO)
  8448               MOVE 14.0         TO PB-I-LOAN-APR.
  8449******************************************************
  8450
  8451     IF PB-COMPANY-ID = 'NCL'
  8452       IF PB-ISSUE
  8453           IF FORM-MASTER-FOUND
  8454             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8455                AM-DISMBR-COVERAGE
  8456                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8457                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8458                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8459                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8460                                           PB-I-LIFE-BENEFIT-CD.
  8461
  8462     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8463
  8464     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8465         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8466         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8467         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8468         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8469         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8470           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8471             GO TO 0301-LIFE-BENEFIT-SEARCH
  8472         ELSE
  8473             NEXT SENTENCE
  8474     ELSE
  8475         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8476
  8477     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8478     MOVE '4'                    TO CNTL-REC-TYPE.
  8479     MOVE +0                     TO CNTL-SEQ-NO.
  8480     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8481
  8482     MOVE '1' TO RC-SW-2.
  8483     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8484
  8485     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8486        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8487         GO TO 0305-BENEFIT-NOT-FOUND.
  8488
  8489     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8490
  8491 0301-LIFE-BENEFIT-SEARCH.
  8492
  8493     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8494
  8495     IF NO-BENEFIT-FOUND
  8496        GO TO 0305-BENEFIT-NOT-FOUND.
  8497
  8498     IF WS-BEN-CD = '99'
  8499        GO TO 0305-BENEFIT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 156
* EL050.cbl
  8500
  8501     IF PB-COMPANY-ID = 'NCL'
  8502         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8503             GO TO 0304-LIFE-BENEFIT-FOUND.
  8504
  8505     MOVE +1                     TO SUB5.
  8506     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8507
  8508* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8509* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8510     IF PB-COMPANY-ID = 'DMD'
  8511         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8512
  8513 0302-EDIT-ACCT-LF-BENEFITS.
  8514
  8515     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8516        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8517           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8518                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8519           GO TO 03XX-GET-LIFE-ERPLAN.
  8520
  8521     IF SUB5 LESS THAN +20
  8522        ADD +1                   TO SUB5
  8523        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8524
  8525     MOVE +1                     TO SUB5.
  8526
  8527     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8528        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8529
  8530 0303-EDIT-DMD-EXTRA-BENEFITS.
  8531
  8532     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8533        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8534           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8535                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8536           GO TO 03XX-GET-LIFE-ERPLAN.
  8537
  8538     IF SUB5 LESS THAN +30
  8539        ADD +1                   TO SUB5
  8540        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8541
  8542     MOVE +1                     TO SUB5.
  8543
  8544 03XX-EDIT-FOR-NINETY-LF.
  8545
  8546***************************************************************
  8547*                                                             *
  8548*    NINETY BENEFIT PLAN TYPES:                               *
  8549*                                                             *
  8550*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8551*      92 = ALL GROUP REDUCING BENEFITS                       *
  8552*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8553*      94 = ALL GROUP LEVEL BENEFITS                          *
  8554*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8555*           BENEFIT CONTROLS.                                 *
  8556*      99 = ALL BENEFITS                                      *
  8557*                                                             *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 157
* EL050.cbl
  8558***************************************************************
  8559
  8560     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8561                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8562
  8563     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8564       AND
  8565        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8566        GO TO 03XX-GET-LIFE-ERPLAN.
  8567
  8568     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8569       AND
  8570        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8571        IF CF-REDUCING (SUB3)
  8572           IF (PB-I-INDV-GRP-OVRD = 'I')
  8573              OR
  8574           ((AM-IG = '1') AND
  8575           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8576              OR
  8577           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8578           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8579           (AM-IG NOT = '2'))
  8580              GO TO 03XX-GET-LIFE-ERPLAN.
  8581
  8582     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8583       AND
  8584        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8585        IF CF-REDUCING (SUB3)
  8586           IF (PB-I-INDV-GRP-OVRD = 'G')
  8587              OR
  8588           ((AM-IG = '2') AND
  8589           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8590              OR
  8591           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8592           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8593           (AM-IG NOT = '1'))
  8594              GO TO 03XX-GET-LIFE-ERPLAN.
  8595
  8596     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8597       AND
  8598        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8599        IF CF-LEVEL    (SUB3)
  8600           IF (PB-I-INDV-GRP-OVRD = 'I')
  8601              OR
  8602           ((AM-IG = '1') AND
  8603           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8604              OR
  8605           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8606           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8607            (AM-IG NOT = '2'))
  8608              GO TO 03XX-GET-LIFE-ERPLAN.
  8609
  8610     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8611       AND
  8612        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8613        IF CF-LEVEL    (SUB3)
  8614           IF (PB-I-INDV-GRP-OVRD = 'G')
  8615              OR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 158
* EL050.cbl
  8616           ((AM-IG = '2') AND
  8617           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8618              OR
  8619           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8620           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8621           (AM-IG NOT = '1'))
  8622              GO TO 03XX-GET-LIFE-ERPLAN.
  8623
  8624     IF SUB5 LESS THAN +20
  8625        ADD +1                   TO SUB5
  8626        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8627
  8628     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8629
  8630     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8631        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8632
  8633     MOVE +1                     TO SUB5.
  8634
  8635 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8636
  8637     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8638                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8639
  8640     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8641       AND
  8642        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8643        GO TO 03XX-GET-LIFE-ERPLAN.
  8644
  8645     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8646       AND
  8647        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8648        IF CF-REDUCING (SUB3)
  8649           IF (PB-I-INDV-GRP-OVRD = 'I')
  8650              OR
  8651           ((AM-IG = '1') AND
  8652           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8653              OR
  8654           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8655           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8656           (AM-IG NOT = '2'))
  8657              GO TO 03XX-GET-LIFE-ERPLAN.
  8658
  8659     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8660       AND
  8661        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8662        IF CF-REDUCING (SUB3)
  8663           IF (PB-I-INDV-GRP-OVRD = 'G')
  8664              OR
  8665           ((AM-IG = '2') AND
  8666           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8667              OR
  8668           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8669           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8670           (AM-IG NOT = '1'))
  8671              GO TO 03XX-GET-LIFE-ERPLAN.
  8672
  8673     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 159
* EL050.cbl
  8674       AND
  8675        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8676        IF CF-LEVEL    (SUB3)
  8677           IF (PB-I-INDV-GRP-OVRD = 'I')
  8678              OR
  8679           ((AM-IG = '1') AND
  8680           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8681              OR
  8682           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8683           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8684            (AM-IG NOT = '2'))
  8685              GO TO 03XX-GET-LIFE-ERPLAN.
  8686
  8687     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8688       AND
  8689        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8690        IF CF-LEVEL    (SUB3)
  8691           IF (PB-I-INDV-GRP-OVRD = 'G')
  8692              OR
  8693           ((AM-IG = '2') AND
  8694           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8695              OR
  8696           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8697           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8698           (AM-IG NOT = '1'))
  8699              GO TO 03XX-GET-LIFE-ERPLAN.
  8700
  8701     IF SUB5 LESS THAN +30
  8702        ADD +1                   TO SUB5
  8703        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8704
  8705     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8706
  8707 03XX-EDIT-FOR-NINETY-LF-CONT.
  8708
  8709     MOVE +99                    TO SUB5.
  8710
  8711     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8712        IF PB-ISSUE
  8713           MOVE ER-1924          TO  WS-ERROR
  8714           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8715
  8716     GO TO 0304-LIFE-BENEFIT-FOUND.
  8717
  8718 03XX-GET-LIFE-ERPLAN.
  8719
  8720     IF WK-PLAN-ADDR EQUAL +0
  8721        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8722
  8723     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8724     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8725     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8726     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8727     MOVE 'Y'                    TO PLAN-MASTER-SW
  8728                                    PLAN-MASTER-LIFE-SW.
  8729     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8730
  8731 03XX-ERPLAN-LIFE-GETMAIN.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 160
* EL050.cbl
  8732
  8733     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8734     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8735
  8736 03XX-ERPLAN-LIFE-READ.
  8737
  8738     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8739     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8740     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8741     MOVE PB-SV-STATE            TO PLAN-STATE.
  8742     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8743     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8744     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8745     MOVE WS-SAVE-BENEFIT-REVISION
  8746                                 TO PLAN-REVISION-NO.
  8747
  8748     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8749     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8750
  8751     IF PB-COMPANY-ID = 'NCL'
  8752       IF NOT LF-PLAN-MASTER-FOUND
  8753         IF NOT PB-POLICY-IS-DECLINED  AND
  8754            NOT PB-POLICY-IS-VOIDED
  8755             MOVE  ER-1921         TO  WS-ERROR
  8756             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8757             GO TO 0304-LIFE-BENEFIT-FOUND.
  8758
  8759     IF NOT LF-PLAN-MASTER-FOUND
  8760        GO TO 0304-LIFE-BENEFIT-FOUND.
  8761
  8762 XXXX-CHECK-LF-PLAN-KEY.
  8763
  8764     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8765        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8766        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8767        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8768        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8769        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8770        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8771        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8772        MOVE 'N'                 TO PLAN-MASTER-SW
  8773          GO TO 03XX-ERPLAN-LIFE-READ.
  8774
  8775     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8776
  8777     IF  PB-CANCELLATION
  8778         GO TO  0303-LF-ACCT-BEN-FOUND.
  8779
  8780     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8781        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8782           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8783           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8784              MOVE ER-2644             TO WS-ERROR
  8785              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8786           ELSE
  8787              NEXT SENTENCE
  8788        ELSE
  8789           IF PB-COMPANY-ID NOT = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 161
* EL050.cbl
  8790              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8791                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8792
  8793 0303-LF-ACCT-BEN-FOUND.
  8794
  8795     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8796
  8797     IF PL-DEV-CODE NOT = SPACES
  8798        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8799
  8800     IF PL-DEV-PCT NUMERIC AND
  8801        PL-DEV-PCT NOT = ZEROS
  8802        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8803
  8804     IF PL-TOL-PREM-AMT GREATER THAN +0
  8805        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8806
  8807     IF PL-TOL-REF-AMT GREATER THAN +0
  8808        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8809
  8810     IF PL-TOL-PREM-PCT GREATER THAN +0
  8811        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8812
  8813     IF PL-TOL-REF-PCT GREATER THAN +0
  8814        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8815
  8816     IF PL-TOL-CLM-AMT GREATER THAN +0
  8817        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8818
  8819     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8820                          PL-OVER-SHORT-AMT > +0
  8821        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8822
  8823     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8824                          PL-OVER-SHORT-PCT > +0
  8825        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8826
  8827     IF PL-SALES-TAX NUMERIC AND
  8828                          PL-SALES-TAX > +0
  8829         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8830
  8831     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8832        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8833                                    WS-IG-OVRD-AM.
  8834
  8835 0304-LIFE-BENEFIT-FOUND.
  8836
  8837     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8838
  8839     IF PB-ISSUE
  8840        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8841     ELSE
  8842        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8843
  8844     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8845     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8846     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8847     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 162
* EL050.cbl
  8848     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8849                                         WS-LF-REFUND-CALC.
  8850     if (ws-lf-earnings-calc = '5')
  8851        and (pb-i-loan-apr = zeros)
  8852        and (benefit-code-chg)
  8853        move +99.9999 to pb-i-loan-apr
  8854     end-if
  8855
  8856     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8857        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8858
  8859     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8860        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8861     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8862
  8863     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8864     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8865     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8866     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8867     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8868     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8869
  8870     IF PB-COMPANY-ID = 'NCL'  AND
  8871        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8872         NEXT SENTENCE
  8873     ELSE
  8874         IF SUB5 NOT GREATER THAN +20
  8875            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8876               MOVE WS-SAVE-BENEFIT-REM-TERM
  8877                                      TO WS-AM-LF-BENE-REM-TERM
  8878                                         EC-BR-LF-REM-TERM-CALC.
  8879
  8880     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8881     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8882
  8883     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8884
  8885 0305-BENEFIT-NOT-FOUND.
  8886
  8887     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8888     MOVE ER-2604                TO WS-ERROR.
  8889     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8890
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 163
* EL050.cbl
  8892
  8893 0310-FIND-AH-BENEFIT-RECORD.
  8894
  8895     MOVE 'N'                    TO PLAN-MASTER-SW
  8896                                    PLAN-MASTER-AH-SW.
  8897
  8898     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8899                                    WS-PL-TOL-AH-REFUND
  8900                                    WS-AH-PL-REF-OVS-AMT
  8901                                    WS-PL-TOL-AH-PREM-PCT
  8902                                    WS-PL-TOL-AH-REFUND-PCT
  8903                                    WS-AH-PL-REF-OVS-PCT
  8904                                    WS-PL-TOL-AH-CLAIM.
  8905     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8906
  8907
  8908     if pb-issue
  8909        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8910           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8911        end-if
  8912        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8913           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8914           GO TO 0399-BENEFIT-NOT-FOUND
  8915        end-if
  8916     end-if
  8917
  8918     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8919        GO TO 0400-FIND-CARRIER.
  8920
  8921     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8922
  8923     IF WK-AH-BEN-ADDR NOT = ZEROS
  8924         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8925         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8926         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8927         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8928           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8929             GO TO 0311-AH-BENEFIT-SEARCH
  8930         ELSE
  8931             NEXT SENTENCE
  8932     ELSE
  8933         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8934
  8935     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8936     MOVE '5'                    TO CNTL-REC-TYPE.
  8937     MOVE +0                     TO CNTL-SEQ-NO.
  8938     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8939
  8940     MOVE '2' TO RC-SW-2.
  8941     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8942
  8943     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8944        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8945          GO TO 0399-BENEFIT-NOT-FOUND.
  8946
  8947     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8948
  8949 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 164
* EL050.cbl
  8950
  8951     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8952
  8953     IF NO-BENEFIT-FOUND
  8954         GO TO 0399-BENEFIT-NOT-FOUND.
  8955
  8956     IF WS-BEN-CD = '99'
  8957        GO TO 0399-BENEFIT-NOT-FOUND.
  8958
  8959     IF PB-COMPANY-ID  =  'NCL'
  8960         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8961             GO TO 0314-A-H-BENEFIT-FOUND.
  8962
  8963     MOVE +1                     TO SUB5.
  8964     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8965
  8966* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8967* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8968     IF PB-COMPANY-ID = 'DMD'
  8969         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8970
  8971 0312-EDIT-ACCT-AH-BENEFITS.
  8972
  8973     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8974        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8975           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8976                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8977           GO TO 03XX-GET-AH-ERPLAN.
  8978
  8979     IF SUB5 LESS THAN +20
  8980        ADD +1                   TO SUB5
  8981        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8982
  8983     MOVE +1                     TO SUB5.
  8984
  8985     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8986        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8987
  8988 0313-EDIT-DMD-EXTRA-BENEFITS.
  8989
  8990     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8991        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8992           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8993                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8994           GO TO 03XX-GET-AH-ERPLAN.
  8995
  8996     IF SUB5 LESS THAN +30
  8997        ADD +1                   TO SUB5
  8998        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8999
  9000     MOVE +1                     TO SUB5.
  9001
  9002 03XX-EDIT-FOR-NINETY-AH.
  9003
  9004***************************************************************
  9005*                                                             *
  9006*    NINETY BENEFIT PLAN TYPES:                               *
  9007*                                                             *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 165
* EL050.cbl
  9008*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9009*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9010*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9011*           BENEFIT CONTROLS.                                 *
  9012*      99 = ALL BENEFITS.                                     *
  9013*                                                             *
  9014***************************************************************
  9015
  9016     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9017                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9018
  9019     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9020       AND
  9021        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9022        GO TO 03XX-GET-AH-ERPLAN.
  9023
  9024     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9025       AND
  9026        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9027           IF (PB-I-INDV-GRP-OVRD = 'I')
  9028              OR
  9029           ((AM-IG = '1') AND
  9030           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9031              OR
  9032           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9033           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9034           (AM-IG NOT = '2'))
  9035              GO TO 03XX-GET-AH-ERPLAN.
  9036
  9037     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9038       AND
  9039        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9040           IF (PB-I-INDV-GRP-OVRD = 'G')
  9041              OR
  9042           ((AM-IG = '2') AND
  9043           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9044              OR
  9045           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9046           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9047           (AM-IG NOT = '1'))
  9048              GO TO 03XX-GET-AH-ERPLAN.
  9049
  9050     IF SUB5 LESS THAN +20
  9051        ADD +1                   TO SUB5
  9052        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9053
  9054     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9055        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9056
  9057     MOVE +1                    TO SUB5.
  9058
  9059 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9060
  9061     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9062                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9063
  9064     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9065       AND
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 166
* EL050.cbl
  9066        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9067        GO TO 03XX-GET-AH-ERPLAN.
  9068
  9069     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9070       AND
  9071        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9072           IF (PB-I-INDV-GRP-OVRD = 'I')
  9073              OR
  9074           ((AM-IG = '1') AND
  9075           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9076              OR
  9077           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9078           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9079           (AM-IG NOT = '2'))
  9080              GO TO 03XX-GET-AH-ERPLAN.
  9081
  9082     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9083       AND
  9084        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9085           IF (PB-I-INDV-GRP-OVRD = 'G')
  9086              OR
  9087           ((AM-IG = '2') AND
  9088           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9089              OR
  9090           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9091           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9092           (AM-IG NOT = '1'))
  9093              GO TO 03XX-GET-AH-ERPLAN.
  9094
  9095     IF SUB5 LESS THAN +30
  9096        ADD +1                   TO SUB5
  9097        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9098
  9099 03XX-EDIT-FOR-NINETY-AH-CONT.
  9100
  9101     MOVE +99                    TO SUB5.
  9102
  9103     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9104
  9105     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9106        IF PB-ISSUE
  9107           MOVE ER-1925          TO  WS-ERROR
  9108           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9109
  9110     GO TO 0314-A-H-BENEFIT-FOUND.
  9111
  9112 03XX-GET-AH-ERPLAN.
  9113
  9114     IF WK-PLAN-ADDR EQUAL +0
  9115         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9116
  9117     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9118     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9119     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9120     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9121     MOVE 'Y'                    TO PLAN-MASTER-SW
  9122                                    PLAN-MASTER-AH-SW.
  9123*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 167
* EL050.cbl
  9124     GO TO 03XX-ERPLAN-AH-READ.
  9125
  9126 03XX-ERPLAN-AH-GETMAIN.
  9127
  9128     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9129     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9130
  9131 03XX-ERPLAN-AH-READ.
  9132
  9133     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9134     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9135     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9136     MOVE PB-SV-STATE            TO PLAN-STATE.
  9137     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9138     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9139     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9140     MOVE WS-SAVE-BENEFIT-REVISION
  9141                                 TO PLAN-REVISION-NO.
  9142
  9143     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9144     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9145
  9146     IF PB-COMPANY-ID = 'NCL'
  9147       IF NOT AH-PLAN-MASTER-FOUND
  9148         IF NOT PB-POLICY-IS-DECLINED  AND
  9149            NOT PB-POLICY-IS-VOIDED
  9150             MOVE  ER-1922         TO  WS-ERROR
  9151             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9152             GO TO 0314-A-H-BENEFIT-FOUND.
  9153
  9154     IF NOT AH-PLAN-MASTER-FOUND
  9155        GO TO 0314-A-H-BENEFIT-FOUND.
  9156
  9157 XXXX-CHECK-AH-PLAN-KEY.
  9158
  9159     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9160        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9161        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9162        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9163        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9164        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9165        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9166        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9167        MOVE 'N'                 TO PLAN-MASTER-SW
  9168          GO TO 03XX-ERPLAN-AH-READ.
  9169
  9170     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9171
  9172     IF  PB-CANCELLATION
  9173         GO TO  0313-AH-ACCT-BEN-FOUND.
  9174
  9175     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9176       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9177          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9178          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9179             MOVE ER-2644             TO WS-ERROR
  9180             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9181          ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 168
* EL050.cbl
  9182             NEXT SENTENCE
  9183       ELSE
  9184          IF PB-COMPANY-ID NOT = 'NCL'
  9185             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9186                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9187
  9188 0313-AH-ACCT-BEN-FOUND.
  9189
  9190     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9191
  9192     IF PL-DEV-CODE NOT = SPACES
  9193        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9194
  9195     IF PL-DEV-PCT NUMERIC AND
  9196        PL-DEV-PCT NOT = ZEROS
  9197        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9198
  9199     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9200        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9201
  9202     IF PL-TOL-REF-AMT NOT EQUAL +0
  9203        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9204
  9205     IF PL-TOL-PREM-PCT GREATER THAN +0
  9206        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9207
  9208     IF PL-TOL-REF-PCT GREATER THAN +0
  9209        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9210
  9211     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9212        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9213
  9214     IF PL-OVER-SHORT-AMT NUMERIC AND
  9215                          PL-OVER-SHORT-AMT > +0
  9216        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9217
  9218     IF PL-OVER-SHORT-PCT NUMERIC AND
  9219                          PL-OVER-SHORT-PCT > +0
  9220        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9221
  9222     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9223        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9224        IF WS-IG-OVRD-AM EQUAL SPACES
  9225            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9226
  9227 0314-A-H-BENEFIT-FOUND.
  9228
  9229     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9230
  9231     IF PB-ISSUE
  9232        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9233       ELSE
  9234        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9235
  9236     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9237     if cf-maximum-benefits (sub3) numeric
  9238        move cf-maximum-benefits  (sub3) to ws-ah-max-bens
  9239     else
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 169
* EL050.cbl
  9240        move zeros               to ws-ah-max-bens
  9241     end-if
  9242     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9243     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9244     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9245                                         WS-AH-REFUND-CALC.
  9246
  9247     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9248        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9249
  9250     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9251        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9252     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9253
  9254     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9255     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9256     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9257     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9258     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9259     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9260
  9261     IF PB-COMPANY-ID = 'NCL'  AND
  9262        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9263         NEXT SENTENCE
  9264     ELSE
  9265         IF SUB5 NOT GREATER THAN +20
  9266            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9267                MOVE WS-SAVE-BENEFIT-REM-TERM
  9268                                      TO WS-AM-AH-BENE-REM-TERM
  9269                                         EC-BR-AH-REM-TERM-CALC.
  9270
  9271     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9272     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9273
  9274     GO TO 0400-FIND-CARRIER.
  9275
  9276 0399-BENEFIT-NOT-FOUND.
  9277
  9278     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9279     MOVE ER-2605                TO WS-ERROR.
  9280     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9281
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 170
* EL050.cbl
  9283
  9284 0400-FIND-CARRIER.
  9285
  9286     MOVE PB-SV-CARRIER          TO WS-CARR.
  9287
  9288     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9289     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9290     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9291     MOVE '6'                    TO CNTL-REC-TYPE.
  9292
  9293*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9294     MOVE SPACE                  TO WS-DMD-RATING-SW
  9295                                    EC-BR-DMD-RATING-SW.
  9296
  9297     MOVE '2'                    TO RC-SW-1.
  9298     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9299
  9300     IF NOT CF-CARRIER-MASTER
  9301        GO TO 0400-CARRIER-NOT-FOUND.
  9302
  9303 0400-BUILD-CARR-TOL.
  9304
  9305     IF CF-CR-TOL-PREM NUMERIC AND
  9306        CF-CR-TOL-PREM GREATER THAN +0
  9307        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9308                                    WS-TOL-AH-PREM.
  9309
  9310     IF CF-CR-TOL-REFUND NUMERIC AND
  9311        CF-CR-TOL-REFUND GREATER THAN +0
  9312        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9313                                    WS-TOL-AH-REFUND.
  9314
  9315     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9316        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9317        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9318                                    WS-AH-REFUND-OVS-AMT.
  9319
  9320     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9321        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9322        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9323                                    WS-AH-REFUND-OVS-PCT.
  9324
  9325     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9326        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9327        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9328                                    WS-TOL-AH-PREM-PCT.
  9329
  9330     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9331        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9332        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9333                                     WS-TOL-AH-REFUND-PCT.
  9334
  9335     IF CF-COMPANY-ID EQUAL 'DMD'
  9336         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9337                                    EC-BR-DMD-RATING-SW.
  9338
  9339     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9340     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 171
* EL050.cbl
  9341        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9342     END-IF
  9343     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9344        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9345     END-IF
  9346     IF WS-TOL-CLP-PCT = ZEROS
  9347        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9348     END-IF
  9349
  9350     IF WS-SPP-LEASE-COMM = ZEROS
  9351        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9352     END-IF
  9353     GO TO 0400-FIND-ERPDEF.
  9354
  9355 0400-CARRIER-NOT-FOUND.
  9356
  9357     MOVE ER-2602                TO WS-ERROR.
  9358     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9359
  9360 0400-FIND-ERPDEF.
  9361     IF PB-COMPANY-ID = 'DCC'
  9362        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9363        CONTINUE
  9364     ELSE
  9365        GO TO 0400-FIND-ERCOMP
  9366     END-IF
  9367     MOVE ' '                    TO PDEF-MASTER-SW
  9368     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9369     MOVE PB-STATE               TO ERPDEF-STATE
  9370     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9371     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9372     IF PB-ISSUE
  9373        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9374     ELSE
  9375        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9376     END-IF
  9377     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9378     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9379     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9380     IF PDEF-MASTER-FOUND
  9381        MOVE 'N'                 TO PDEF-MASTER-SW
  9382        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9383        IF PDEF-MASTER-FOUND
  9384           IF (ERPDEF-KEY-SAVE (1:16) =
  9385                        PD-CONTROL-PRIMARY (1:16))
  9386              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9387              CONTINUE
  9388           ELSE
  9389              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9390              IF (ERPDEF-KEY-SAVE (1:16) =
  9391                        PD-CONTROL-PRIMARY (1:16))
  9392                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9393                 CONTINUE
  9394              ELSE
  9395                 MOVE 'N'        TO PDEF-MASTER-SW
  9396              END-IF
  9397           END-IF
  9398        END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 172
* EL050.cbl
  9399        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9400     END-IF
  9401     IF PDEF-MASTER-FOUND
  9402        IF PD-TRUNCATED = 'Y'
  9403           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9404        END-IF
  9405     END-IF
  9406     .
  9407 0400-FIND-ERCOMP.
  9408     IF PB-COMPANY-ID = 'DCC'
  9409        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9410           (WS-SUB1 > +10)
  9411           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9412                 OR 'A' OR 'N'
  9413              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9414              MOVE PB-CARRIER    TO COMP-CARRIER
  9415              MOVE PB-GROUPING   TO COMP-GROUPING
  9416              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9417              MOVE AM-AGT (WS-SUB1)
  9418                                 TO COMP-FIN-RESP
  9419              MOVE 'G'           TO COMP-TYPE
  9420              PERFORM 8582-READ-COMPENSATION-MASTER
  9421                                 THRU 8582-EXIT
  9422              IF COMP-MASTER-FOUND
  9423                 IF CO-GA-INACTIVE
  9424                    MOVE ER-2763 TO WS-ERROR
  9425                    PERFORM 9900-ERROR-FORMAT
  9426                                 THRU 9900-EXIT
  9427                    MOVE +11     TO WS-SUB1
  9428                 END-IF
  9429                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9430                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9431                    MOVE ER-2788 TO WS-ERROR
  9432                    PERFORM 9900-ERROR-FORMAT
  9433                                 THRU 9900-EXIT
  9434                    MOVE +11     TO WS-SUB1
  9435                 END-IF
  9436              END-IF
  9437           END-IF
  9438        END-PERFORM
  9439     END-IF
  9440     IF PB-COMPANY-ID = 'DCC'
  9441        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9442           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9443                                    WS-CLP-STATE
  9444        ELSE
  9445           MOVE SPACES           TO PB-I-CLP-STATE
  9446                                    WS-CLP-STATE
  9447        END-IF
  9448     END-IF
  9449
  9450     IF (PB-COMPANY-ID = 'DCC')
  9451        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9452        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9453        CONTINUE
  9454     ELSE
  9455        GO TO 0400-FIND-STATE-RECORD
  9456     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 173
* EL050.cbl
  9457     MOVE SPACES                 TO WS-CLP-STATE
  9458     MOVE +0                     TO WS-BANK-FEE
  9459                                    WS-BANK-LFEE
  9460                                    WS-BANK-NOCHRGB
  9461
  9462     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9463     IF (PB-ISSUE)
  9464        AND (PB-I-BANK-NUMBER NOT =
  9465            SPACES AND ZEROS AND LOW-VALUES)
  9466        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9467     ELSE
  9468        IF (PB-CANCELLATION)
  9469           AND (PB-CI-BANK-NUMBER NOT =
  9470                SPACES AND ZEROS AND LOW-VALUES)
  9471           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9472        END-IF
  9473     END-IF
  9474     IF COMP-FIN-RESP NOT = LOW-VALUES
  9475        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9476        MOVE PB-CARRIER          TO COMP-CARRIER
  9477        MOVE PB-GROUPING         TO COMP-GROUPING
  9478        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9479        MOVE 'B'                 TO COMP-TYPE
  9480        PERFORM 8582-READ-COMPENSATION-MASTER
  9481                                 THRU 8582-EXIT
  9482        IF COMP-MASTER-FOUND
  9483           IF CO-MAX-BANK-FEE NOT NUMERIC
  9484              MOVE +0            TO CO-MAX-BANK-FEE
  9485           END-IF
  9486           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9487              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9488           END-IF
  9489           IF CO-GA-INACTIVE
  9490              MOVE ER-2763       TO WS-ERROR
  9491              PERFORM 9900-ERROR-FORMAT
  9492                                 THRU 9900-EXIT
  9493           END-IF
  9494           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9495              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9496              MOVE ER-2788 TO WS-ERROR
  9497              PERFORM 9900-ERROR-FORMAT
  9498                                 THRU 9900-EXIT
  9499              MOVE +11     TO WS-SUB1
  9500           END-IF
  9501           IF WS-AH-BEN-CATEGORY = 'G'
  9502              MOVE CO-MAX-BANK-FEE
  9503                                 TO WS-BANK-FEE
  9504                                    PB-I-BANK-FEE
  9505           ELSE
  9506              MOVE CO-MAX-BANK-FEE-LEASE
  9507                                 TO WS-BANK-LFEE
  9508                                    PB-I-BANK-FEE
  9509           END-IF
  9510           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9511              AND (WS-AH-REFUND-CALC = 'G'))
  9512                        OR
  9513              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9514              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 174
* EL050.cbl
  9515              CONTINUE
  9516           ELSE
  9517              MOVE ER-2789 TO WS-ERROR
  9518              PERFORM 9900-ERROR-FORMAT
  9519                                 THRU 9900-EXIT
  9520           END-IF
  9521           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9522                                    PB-I-CLP-STATE
  9523           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9524           MOVE CO-CARRIER       TO BXRF-CARRIER
  9525           MOVE CO-GROUPING      TO BXRF-GROUPING
  9526           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9527           MOVE BXRF-MAX-REC-LENGTH
  9528                                 TO BXRF-REC-LENGTH
  9529           PERFORM 8584-READ-BANK-CROSS-REF
  9530                                 THRU 8584-EXIT
  9531           IF BXRF-MASTER-FOUND
  9532              MOVE ' '           TO BANK-ACCT-SW
  9533              MOVE BK-BANK-POINTER-CNT
  9534                                 TO BK-BANK-POINTER-CNT
  9535              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9536                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9537                 OR (BANK-ACCT-FOUND)
  9538                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9539                    AND (BK-AM-EXP-DT (WS-SUB1)
  9540                                 > PB-CERT-EFF-DT)
  9541                    AND (BK-AM-EFF-DT (WS-SUB1)
  9542                                 NOT > PB-CERT-EFF-DT)
  9543                    SET BANK-ACCT-FOUND TO TRUE
  9544                 END-IF
  9545              END-PERFORM
  9546              IF NOT BANK-ACCT-FOUND
  9547                 MOVE ZEROS      TO WS-BANK-FEE
  9548                                    WS-BANK-LFEE
  9549                 MOVE ER-2869    TO WS-ERROR
  9550                 PERFORM 9900-ERROR-FORMAT
  9551                                 THRU 9900-EXIT
  9552              ELSE
  9553                 PERFORM 5000-PROCESS-REPS
  9554                                 THRU 5000-EXIT
  9555                 IF AGENT-MASTER-FOUND
  9556                    MOVE +0      TO WS-BANK-FEE
  9557                                    WS-BANK-LFEE
  9558*                   MOVE AG-SPP-FEES (1)
  9559*                                TO PB-I-BANK-FEE
  9560*                                   WS-BANK-FEE
  9561                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9562                       (WS-SUB1 > +10)
  9563                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9564                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9565                       END-IF
  9566                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9567                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9568                       END-IF
  9569                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9570                          AG-SPP-FEES (WS-SUB1)
  9571                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9572                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 175
* EL050.cbl
  9573                    END-PERFORM
  9574                    IF WS-AH-BEN-CATEGORY = 'G'
  9575                       MOVE WS-BANK-FEE
  9576                                 TO PB-I-BANK-FEE
  9577                    ELSE
  9578                       MOVE WS-BANK-LFEE
  9579                                 TO PB-I-BANK-FEE
  9580                    END-IF
  9581                 END-IF
  9582              END-IF
  9583           END-IF
  9584        ELSE
  9585           MOVE ER-2879          TO WS-ERROR
  9586           PERFORM 9900-ERROR-FORMAT
  9587                                 THRU 9900-EXIT
  9588        END-IF
  9589     ELSE
  9590        MOVE ER-2879             TO WS-ERROR
  9591        PERFORM 9900-ERROR-FORMAT
  9592                                 THRU 9900-EXIT
  9593     END-IF
  9594     IF WS-AH-BEN-CATEGORY = 'G'
  9595        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9596        + WS-BANK-FEE
  9597     ELSE
  9598        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9599        + WS-BANK-LFEE
  9600     END-IF
  9601     .
  9602 0400-FIND-STATE-RECORD.
  9603
  9604     IF WK-STATE-ADDR NOT = ZEROS
  9605         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9606         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9607         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9608         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9609         IF PB-SV-STATE = CF-STATE-CODE
  9610             GO TO 0405-CONTINUE-EDIT
  9611         ELSE
  9612             NEXT SENTENCE
  9613     ELSE
  9614         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9615
  9616     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9617     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9618     MOVE '3'                    TO CNTL-REC-TYPE.
  9619     MOVE +0                     TO CNTL-SEQ-NO.
  9620
  9621     MOVE '3'                    TO RC-SW-2.
  9622     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9623
  9624     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9625        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9626        PB-SV-STATE   NOT = CF-STATE-CODE)
  9627        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9628                                    WS-TOL-AH-CLAIM
  9629                                    WS-MINIMUM-REFUND
  9630                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 176
* EL050.cbl
  9631                                    WS-TOL-AH-PREM
  9632                                    WS-TOL-LF-REFUND
  9633                                    WS-TOL-AH-REFUND
  9634                                    EC-ST-TOL-PREM-PCT
  9635                                    WS-TOL-LF-PREM-PCT
  9636                                    WS-TOL-AH-PREM-PCT
  9637                                    EC-ST-TOL-REFUND-PCT
  9638                                    WS-TOL-LF-REFUND-PCT
  9639                                    WS-TOL-AH-REFUND-PCT
  9640                                    EC-ST-TOL-PREM
  9641                                    EC-ST-TOL-REFUND
  9642                                    EC-ST-FST-PMT-DAYS-MAX
  9643                                    WS-FREE-LOOK-PERIOD
  9644                                    WS-ST-LF-PREM-TAX
  9645                                    WS-ST-AH-PREM-TAX-I
  9646                                    WS-ST-AH-PREM-TAX-G
  9647                                    WS-BANK-FEE
  9648                                    WS-BANK-LFEE
  9649                                    WS-TOL-CLP-PCT
  9650                                    WS-SPP-LEASE-COMM
  9651        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9652                                    EC-ST-FST-PMT-DAYS-CHG
  9653                                    WS-LF-REM-TERM-CALC
  9654                                    WS-LF-REFUND-CALC
  9655                                    EC-ST-LF-REM-TERM-CALC
  9656                                    EC-ST-LF-REFUND-CALC
  9657                                    WS-AH-REM-TERM-CALC
  9658                                    WS-AH-REFUND-CALC
  9659                                    WS-LF-BEN-CATEGORY
  9660                                    WS-AH-BEN-CATEGORY
  9661                                    WS-CLP-STATE
  9662                                    WS-ST-REFUND-CLAIM-FLAG
  9663                                    WS-ST-CAUSAL-STATE
  9664                                    EC-ST-AH-REM-TERM-CALC
  9665                                    EC-ST-AH-REFUND-CALC
  9666          GO TO 0499-STATE-NOT-FOUND.
  9667
  9668     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9669
  9670 0405-CONTINUE-EDIT.
  9671
  9672     if pb-company-id = 'AHL'
  9673        continue
  9674     else
  9675        IF PB-CERT-PRIME NOT NUMERIC
  9676           MOVE ER-2722          TO WS-ERROR
  9677           PERFORM 9900-ERROR-FORMAT
  9678                                 THRU 9900-EXIT
  9679        end-if
  9680     END-IF
  9681*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9682*       MOVE +0                  TO SUB3
  9683*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9684*       IF SUB3 > +0
  9685*          MOVE ER-2722          TO WS-ERROR
  9686*          PERFORM 9900-ERROR-FORMAT
  9687*                                THRU 9900-EXIT
  9688*       END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 177
* EL050.cbl
  9689*    END-IF
  9690*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9691*       IF PB-CERT-PRIME NOT NUMERIC
  9692*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9693*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9694*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9695*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9696*
  9697*          MOVE ER-2722          TO WS-ERROR
  9698*          PERFORM 9900-ERROR-FORMAT
  9699*                                THRU 9900-EXIT
  9700*       END-IF
  9701*    END-IF
  9702
  9703     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9704
  9705     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9706        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9707                                    WS-TOL-AH-CLAIM.
  9708
  9709     IF CF-ST-REFUND-MIN NOT NUMERIC
  9710        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9711
  9712     IF CF-ST-REFUND-MIN NOT = ZEROS
  9713        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9714
  9715     IF CF-ST-TOL-PREM  NOT = ZEROS
  9716        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9717                                    WS-TOL-AH-PREM
  9718        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9719
  9720     IF CF-ST-TOL-REFUND NOT = ZEROS
  9721        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9722                                    WS-TOL-AH-REFUND
  9723        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9724
  9725     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9726        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9727        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9728                                    WS-AH-REFUND-OVS-AMT
  9729                                    EC-ST-OVR-SHT-AMT.
  9730
  9731     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9732        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9733        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9734                                    WS-TOL-LF-PREM-PCT
  9735                                    WS-TOL-AH-PREM-PCT.
  9736
  9737     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9738        CF-ST-TOL-REF-PCT GREATER THAN +0
  9739        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9740                                    WS-TOL-LF-REFUND-PCT
  9741                                    WS-TOL-AH-REFUND-PCT.
  9742
  9743     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9744        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9745        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9746                                    WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 178
* EL050.cbl
  9747                                    EC-ST-OVR-SHT-PCT.
  9748
  9749     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9750     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9751
  9752     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9753          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9754
  9755     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9756     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9757     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9758
  9759     IF CF-ST-LF-PREM-TAX NUMERIC
  9760        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9761     END-IF
  9762     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9763        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9764     END-IF
  9765     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9766        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9767     END-IF
  9768
  9769     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9770         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9771     END-IF.
  9772
  9773     IF CF-ST-CAUSAL-STATE > SPACES
  9774         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9775     END-IF.
  9776
  9777     IF WS-LF-BENEFIT-CD = ZEROS
  9778        GO TO 0410-CHECK-AH.
  9779
  9780     IF CF-ST-RT-CALC NOT = SPACES
  9781        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9782                                    EC-ST-LF-REM-TERM-CALC
  9783     END-IF
  9784
  9785     IF WS-LF-COVERAGE-TYPE = 'R'
  9786        IF WS-LF-EARNINGS-CALC = '5'
  9787           IF CF-ST-RF-LN-CALC > '0'
  9788              MOVE CF-ST-RF-LN-CALC
  9789                                 TO WS-LF-REFUND-CALC
  9790                                    EC-ST-LF-REFUND-CALC
  9791           END-IF
  9792        ELSE
  9793           IF CF-ST-RF-LR-CALC > '0'
  9794              MOVE CF-ST-RF-LR-CALC
  9795                                 TO WS-LF-REFUND-CALC
  9796                                    EC-ST-LF-REFUND-CALC
  9797           END-IF
  9798        END-IF
  9799     ELSE
  9800        IF CF-ST-RF-LL-CALC > '0'
  9801           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9802                                    EC-ST-LF-REFUND-CALC
  9803        END-IF
  9804     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 179
* EL050.cbl
  9805
  9806     IF CF-ST-RT-CALC NOT = SPACES
  9807        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9808                                    EC-ST-LF-REM-TERM-CALC
  9809     END-IF
  9810
  9811     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9812     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9813
  9814     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9815
  9816     IF NO-BENEFIT-FOUND
  9817        GO TO 0410-CHECK-AH.
  9818
  9819     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9820        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9821                                 TO EC-ST-LF-REM-TERM-CALC
  9822                                    WS-LF-REM-TERM-CALC
  9823     END-IF
  9824
  9825     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9826        MOVE CF-ST-REFUND-CALC (SUB3)
  9827                                 TO WS-LF-REFUND-CALC
  9828                                    EC-ST-LF-REFUND-CALC
  9829     END-IF
  9830*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9831
  9832     .
  9833 0410-CHECK-AH.
  9834
  9835     IF WS-AH-BENEFIT-CD = ZEROS
  9836        GO TO 0500-SET-ACCOUNT.
  9837
  9838     IF CF-ST-RT-CALC NOT = SPACES
  9839        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9840                                    EC-ST-AH-REM-TERM-CALC
  9841     END-IF
  9842
  9843     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9844        IF CF-ST-RF-CP-CALC > '0'
  9845           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9846                                    EC-ST-AH-REFUND-CALC
  9847        END-IF
  9848     ELSE
  9849        IF CF-ST-RF-AH-CALC > '0'
  9850           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9851                                    EC-ST-AH-REFUND-CALC
  9852        END-IF
  9853     END-IF
  9854     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9855     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9856
  9857     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9858
  9859     IF NO-BENEFIT-FOUND
  9860        GO TO 0500-SET-ACCOUNT.
  9861
  9862     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 180
* EL050.cbl
  9863        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9864                                 TO WS-AH-REM-TERM-CALC
  9865                                    EC-ST-AH-REM-TERM-CALC
  9866     END-IF
  9867
  9868     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9869        MOVE CF-ST-REFUND-CALC (SUB3)
  9870                                 TO WS-AH-REFUND-CALC
  9871                                    EC-ST-AH-REFUND-CALC
  9872     END-IF
  9873
  9874*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9875
  9876     GO TO 0500-SET-ACCOUNT.
  9877
  9878 0499-STATE-NOT-FOUND.
  9879
  9880     MOVE ER-2603                TO WS-ERROR.
  9881     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9882
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 181
* EL050.cbl
  9884
  9885 0500-SET-ACCOUNT.
  9886*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9887     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9888        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9889        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9890        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9891        MOVE '3'                 TO CNTL-REC-TYPE
  9892        MOVE +0                  TO CNTL-SEQ-NO
  9893
  9894        MOVE '3'                 TO RC-SW-2
  9895        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9896
  9897        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9898           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9899           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9900           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9901                                    WS-ST-AH-PREM-TAX-I
  9902                                    WS-ST-AH-PREM-TAX-G
  9903        ELSE
  9904           IF CF-ST-LF-PREM-TAX NUMERIC
  9905              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9906           END-IF
  9907           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9908              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9909           END-IF
  9910           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9911              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9912           END-IF
  9913        END-IF
  9914        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9915     END-IF
  9916*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9917*  FOR DCC ONLY
  9918     IF PB-COMPANY-ID = 'DCC'
  9919
  9920     MOVE ' '                    TO STAT-MASTER-SW
  9921     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9922     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9923     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9924     MOVE PB-STATE               TO ELSTAT-STATE
  9925     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9926        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9927     END-IF
  9928
  9929     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9930     SET BIN-TO-GREG             TO TRUE
  9931     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9932     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9933     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9934
  9935     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9936     IF STAT-MASTER-FOUND
  9937        MOVE 'N'                 TO STAT-MASTER-SW
  9938        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9939        IF STAT-MASTER-FOUND
  9940           IF (ELSTAT-KEY-SAVE (1:12) =
  9941                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 182
* EL050.cbl
  9942              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9943                 MOVE 'F'        TO STAT-MASTER-SW
  9944              ELSE
  9945                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9946                 IF (STAT-MASTER-FOUND)
  9947                    AND (ELSTAT-KEY-SAVE (1:12) =
  9948                        SF-CONTROL-PRIMARY (1:12))
  9949                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9950                    MOVE 'F'     TO STAT-MASTER-SW
  9951                 END-IF
  9952              END-IF
  9953           END-IF
  9954        END-IF
  9955     END-IF
  9956
  9957     IF STAT-MASTER-SW = 'F'
  9958        IF SF-ST-LF-PREM-TAX NUMERIC
  9959           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9960        END-IF
  9961        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9962           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9963        END-IF
  9964        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9965           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9966        END-IF
  9967     END-IF
  9968
  9969     END-IF
  9970     IF (PB-COMPANY-ID = 'DCC')
  9971        AND (PB-ISSUE)
  9972        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9973        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9974        AND (AM-GPCD = 06)
  9975        MOVE 'Y'                 TO WS-GOOD-HIN
  9976        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9977           MOVE PB-I-VIN         TO WS-WORK-VIN
  9978           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9979              (V1 > 16)
  9980              IF WS-WORK-VIN (V1:1) NUMERIC
  9981                 MOVE WS-WORK-VIN-N (V1)
  9982                                 TO WS-ROW-B-VAL (V1)
  9983              ELSE
  9984                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9985                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9986                    OR (V2 > 26)
  9987                 END-PERFORM
  9988                 IF V2 < 27
  9989                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9990                 ELSE
  9991                    MOVE 'N'     TO WS-GOOD-HIN
  9992                 END-IF
  9993              END-IF
  9994              COMPUTE WS-ROW-D-VAL (V1) =
  9995                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9996              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9997                 WS-ROW-D-VAL (V1)
  9998           END-PERFORM
  9999           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 183
* EL050.cbl
 10000           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10001             REMAINDER WS-VIN-REMAINDER
 10002           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10003              CONTINUE
 10004           ELSE
 10005              MOVE 'N'           TO WS-GOOD-HIN
 10006           END-IF
 10007        ELSE
 10008           MOVE 'N'              TO WS-GOOD-HIN
 10009        END-IF
 10010        IF WS-GOOD-HIN NOT = 'Y'
 10011           MOVE ER-3826           TO WS-ERROR
 10012           PERFORM 9900-ERROR-FORMAT
 10013                                 THRU 9900-EXIT
 10014        END-IF
 10015     END-IF
 10016     IF (PB-COMPANY-ID = 'DCC')
 10017        AND (PB-ISSUE)
 10018        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10019        AND (AM-GPCD NOT = 06)
 10020        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10021          MOVE PB-I-VIN          TO WS-WORK-VIN
 10022          MOVE +8                TO V2
 10023          MOVE ZEROS             TO WS-VIN-TOTAL
 10024          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10025           (V1 > 17)
 10026             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10027                MOVE ER-3825     TO WS-ERROR
 10028                PERFORM 9900-ERROR-FORMAT
 10029                                 THRU 9900-EXIT
 10030             ELSE
 10031                IF V1 = 8
 10032                   MOVE 10       TO V2
 10033                END-IF
 10034                IF V1 = 9
 10035                   MOVE 0        TO V2
 10036                END-IF
 10037                IF V1 = 10
 10038                   MOVE 9        TO V2
 10039                END-IF
 10040                IF WS-WORK-VIN (V1:1) NUMERIC
 10041                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10042                    + (WS-WORK-VIN-N (V1) * V2)
 10043                ELSE
 10044                   MOVE WS-WORK-VIN (V1:1)
 10045                                 TO WS-HEX-BYTE
 10046                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10047                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10048                    + (WS-NUM (V3) * V2)
 10049                END-IF
 10050                COMPUTE V2 = V2 - 1
 10051             END-IF
 10052          END-PERFORM
 10053          MOVE ZEROS TO WS-VIN-REMAINDER
 10054          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10055             REMAINDER WS-VIN-REMAINDER
 10056          IF ((WS-WORK-VIN (9:1) = 'X')
 10057             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 184
* EL050.cbl
 10058                     OR
 10059             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10060             CONTINUE
 10061          ELSE
 10062             MOVE ER-3826        TO WS-ERROR
 10063             PERFORM 9900-ERROR-FORMAT
 10064                                 THRU 9900-EXIT
 10065          END-IF
 10066        ELSE
 10067          MOVE ER-3826           TO WS-ERROR
 10068          PERFORM 9900-ERROR-FORMAT
 10069                                 THRU 9900-EXIT
 10070        END-IF
 10071     END-IF
 10072******************************************************************
 10073******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10074******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10075******* METHODS.
 10076******************************************************************
 10077     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10078        IF PB-CANCELLATION
 10079           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10080              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10081                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10082                IF FORM-MASTER-FOUND
 10083                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10084******************************************************************
 10085
 10086     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10087     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10088
 10089     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10090     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10091     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10092     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10093
 10094
 10095     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10096     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10097     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10098
 10099     IF AM-LF-OB-RATE NOT NUMERIC
 10100         MOVE ZERO               TO AM-LF-OB-RATE.
 10101
 10102     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10103         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10104
 10105     IF AM-AH-OB-RATE NOT NUMERIC
 10106         MOVE ZERO               TO AM-AH-OB-RATE.
 10107
 10108     IF WS-LF-JOINT-INDICATOR = 'J'
 10109         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10110     ELSE
 10111         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10112
 10113     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10114
 10115     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 185
* EL050.cbl
 10116         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10117
 10118     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10119         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10120                                       WS-IG-OVRD
 10121     ELSE
 10122         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10123             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10124                                       WS-IG-OVRD
 10125         ELSE
 10126             MOVE AM-IG             TO WS-IG-OVRD-AH
 10127                                       WS-IG-OVRD.
 10128
 10129     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10130         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10131                                       WS-IG-OVRD
 10132     ELSE
 10133         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10134             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10135                                       WS-IG-OVRD
 10136         ELSE
 10137             MOVE AM-IG             TO WS-IG-OVRD-LF
 10138                                       WS-IG-OVRD.
 10139
 10140     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10141     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10142     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10143     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10144     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10145
 10146     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10147     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10148     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10149     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10150
 10151     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10152     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10153     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10154     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10155     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10156     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10157     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10158
 10159     IF WS-ACCT-AH-DEV-PCT > +0
 10160        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10161     ELSE
 10162        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10163
 10164     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10165        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10166     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10167        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10168
 10169        IF AM-EARN-METHOD-L = 'S'
 10170            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10171                                        WS-LF-REFUND-CALC.
 10172
 10173        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 186
* EL050.cbl
 10174            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10175                                        WS-LF-REFUND-CALC.
 10176
 10177     IF WS-LF-COVERAGE-TYPE = 'R'
 10178         IF AM-EARN-METHOD-R = 'R'
 10179            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10180                                    WS-LF-REFUND-CALC.
 10181     IF WS-LF-COVERAGE-TYPE = 'R'
 10182         IF AM-EARN-METHOD-R = 'P'
 10183            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10184                                    WS-LF-REFUND-CALC.
 10185     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10186         IF AM-EARN-METHOD-L = 'R'
 10187            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10188                                    WS-LF-REFUND-CALC.
 10189     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10190         IF AM-EARN-METHOD-L = 'P'
 10191            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10192                                    WS-LF-REFUND-CALC.
 10193     IF WS-LF-COVERAGE-TYPE = 'R'
 10194         IF AM-EARN-METHOD-R = 'A'
 10195            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10196                                    WS-LF-REFUND-CALC.
 10197     IF WS-LF-COVERAGE-TYPE = 'R'
 10198         IF AM-EARN-METHOD-R = 'M'
 10199            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10200                                    WS-LF-REFUND-CALC.
 10201     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10202         IF AM-EARN-METHOD-L = 'A'
 10203            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10204                                    WS-LF-REFUND-CALC.
 10205     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10206         IF AM-EARN-METHOD-L = 'M'
 10207            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10208                                    WS-LF-REFUND-CALC.
 10209
 10210     IF AM-EARN-METHOD-A = 'R'
 10211        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10212                                    WS-AH-REFUND-CALC.
 10213     IF AM-EARN-METHOD-A = 'P'
 10214        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10215                                    WS-AH-REFUND-CALC.
 10216     IF AM-EARN-METHOD-A = 'C'
 10217        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10218                                    WS-AH-REFUND-CALC.
 10219     IF AM-EARN-METHOD-A = 'A'
 10220        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10221                                    WS-AH-REFUND-CALC.
 10222     IF AM-EARN-METHOD-A = 'M'
 10223        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10224                                    WS-AH-REFUND-CALC.
 10225     IF AM-EARN-METHOD-A = 'N'
 10226        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10227                                    WS-AH-REFUND-CALC.
 10228     IF AM-EARN-METHOD-A = 'S'
 10229        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10230                                    WS-AH-REFUND-CALC.
 10231
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 187
* EL050.cbl
 10232     IF AM-TOL-PREM NOT = ZEROS
 10233        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10234                                    WS-TOL-AH-PREM.
 10235
 10236     IF AM-OVR-SHT-AMT NUMERIC AND
 10237                  AM-OVR-SHT-AMT > 0
 10238        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10239                                    EC-AM-LF-OVR-SHT-AMT
 10240                                    WS-AH-REFUND-OVS-AMT
 10241                                    EC-AM-AH-OVR-SHT-AMT.
 10242
 10243     IF AM-OVR-SHT-PCT NUMERIC AND
 10244                    AM-OVR-SHT-PCT > 0
 10245        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10246                                    EC-AM-LF-OVR-SHT-PCT
 10247                                    WS-AH-REFUND-OVS-PCT
 10248                                    EC-AM-AH-OVR-SHT-PCT.
 10249
 10250     IF AM-TOL-REF-PCT NUMERIC AND
 10251                  AM-TOL-REF-PCT > 0
 10252        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10253                                    WS-TOL-AH-REFUND-PCT.
 10254
 10255     IF AM-TOL-REF  NOT = ZEROS  AND
 10256                  AM-TOL-REF NUMERIC
 10257        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10258                                    EC-AM-LF-TOL-REFUND
 10259                                    WS-TOL-AH-REFUND
 10260                                    EC-AM-AH-TOL-REFUND.
 10261
 10262     IF AM-TOL-CLM  NOT = ZEROS
 10263        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10264                                    WS-TOL-AH-CLAIM.
 10265
 10266     IF AM-CLP-TOL-PCT NOT NUMERIC
 10267        MOVE +0                  TO AM-CLP-TOL-PCT
 10268     END-IF
 10269
 10270     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10271        MOVE +0                  TO AM-SPP-LEASE-COMM
 10272     END-IF
 10273     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10274        MOVE WS-PL-TOL-LF-PREM-PCT
 10275                                 TO WS-TOL-LF-PREM-PCT.
 10276
 10277     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10278        MOVE WS-PL-TOL-AH-PREM-PCT
 10279                                 TO WS-TOL-AH-PREM-PCT.
 10280
 10281     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10282        MOVE WS-PL-TOL-LF-REFUND-PCT
 10283                                 TO WS-TOL-LF-REFUND-PCT.
 10284
 10285     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10286        MOVE WS-PL-TOL-AH-REFUND-PCT
 10287                                 TO WS-TOL-AH-REFUND-PCT.
 10288
 10289     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 188
* EL050.cbl
 10290        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10291
 10292     IF WS-PL-REF-OVS-PCT > +0
 10293        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10294
 10295     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10296        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10297     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10298        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10299     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10300        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10301     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10302        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10303     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10304        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10305     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10306        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10307
 10308     IF WS-AH-PL-REF-OVS-AMT > +0
 10309        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10310
 10311     IF WS-AH-PL-REF-OVS-PCT > +0
 10312        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10313
 10314     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10315     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10316
 10317     IF PB-CANCELLATION
 10318        GO TO 3000-CONTINUE-EDIT.
 10319
 10320     MOVE +1 TO SUB1.
 10321     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10322     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10323
 10324     IF CF-COMPANY-ID = 'DMD'
 10325       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10326         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10327        ELSE
 10328         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10329
 10330  0525-FIND-ACCT-COMM.
 10331     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10332        NEXT SENTENCE
 10333      ELSE
 10334         ADD +1 TO SUB1
 10335         IF SUB1 LESS +11
 10336            GO TO 0525-FIND-ACCT-COMM
 10337          ELSE
 10338             GO TO 0560-EDIT-CONTINUE.
 10339
 10340     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10341     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10342                                    PB-I-LIFE-COMMISSION.
 10343***  IF PB-COMPANY-ID = 'CRI'
 10344     IF PB-PREM-ACCTNG-ONLY
 10345         GO TO 0560-EDIT-CONTINUE.
 10346
 10347     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 189
* EL050.cbl
 10348     MOVE ' '    TO WS-CTBL-READ-SW.
 10349
 10350
 10351 0530-GET-AH-COMP.
 10352     IF NO-AH-COVERAGE  OR
 10353        NO-AH-BENEFIT-MATCH
 10354           GO TO 0540-NEXT-READ-STEP.
 10355
 10356     IF AM-A-COM (SUB1) NUMERIC
 10357        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10358         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10359         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10360         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10361         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10362     ELSE
 10363          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10364          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10365          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10366          MOVE ZEROS             TO WS-SUB1
 10367                                    WS-COMMISSION
 10368          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10369          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10370          IF WS-COMMISSION > ZEROS
 10371             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10372             GO TO 0540-NEXT-READ-STEP
 10373          END-IF
 10374          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10375          IF CTBL-TABLE-FOUND
 10376             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10377                                        PB-I-AH-TERM
 10378             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10379             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10380             GO TO 0540-NEXT-READ-STEP
 10381          ELSE
 10382             IF FIRST-TIME-THROUGH
 10383                 GO TO 0530-GET-AH-COMP
 10384             ELSE
 10385                 MOVE ER-2609                TO WS-ERROR
 10386                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10387
 10388 0540-NEXT-READ-STEP.
 10389     MOVE '0540' TO CTBL-SW.
 10390     MOVE ' '    TO WS-CTBL-READ-SW.
 10391
 10392 0540-GET-LF-COMP.
 10393     IF NO-LIFE-COVERAGE  OR
 10394        NO-LF-BENEFIT-MATCH
 10395           GO TO 0560-EDIT-CONTINUE.
 10396
 10397     IF WS-LF-JOINT-INDICATOR = 'J'
 10398        IF AM-J-COM (SUB1) NUMERIC
 10399           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10400           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10401           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10402           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10403           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10404        ELSE
 10405           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 190
* EL050.cbl
 10406           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10407           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10408           MOVE ZEROS                TO WS-SUB1
 10409                                        WS-COMMISSION
 10410           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10411           IF WS-COMMISSION > ZEROS
 10412              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10413              GO TO 0560-EDIT-CONTINUE
 10414           END-IF
 10415           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10416           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10417           IF CTBL-TABLE-FOUND
 10418              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10419              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10420              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10421              GO TO 0560-EDIT-CONTINUE
 10422           ELSE
 10423              IF FIRST-TIME-THROUGH
 10424                  GO TO 0540-GET-LF-COMP
 10425              ELSE
 10426                  MOVE ER-2609                TO WS-ERROR
 10427                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10428                  GO TO 0560-EDIT-CONTINUE.
 10429
 10430     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10431        IF AM-L-COM (SUB1) NUMERIC
 10432           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10433           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10434           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10435           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10436           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10437        ELSE
 10438           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10439           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10440           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10441           MOVE ZEROS                TO WS-SUB1
 10442                                        WS-COMMISSION
 10443           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10444           IF WS-COMMISSION IS GREATER THAN ZEROS
 10445              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10446              GO TO 0560-EDIT-CONTINUE
 10447           END-IF
 10448           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10449           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10450           IF CTBL-TABLE-FOUND
 10451              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10452              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10453              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10454              GO TO 0560-EDIT-CONTINUE
 10455           ELSE
 10456              IF FIRST-TIME-THROUGH
 10457                  GO TO 0540-GET-LF-COMP
 10458              ELSE
 10459                  MOVE ER-2609                TO WS-ERROR
 10460                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10461
 10462*    GO TO 0560-EDIT-CONTINUE.
 10463
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 191
* EL050.cbl
 10464 0560-EDIT-CONTINUE.
 10465     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10466                                    WS-AH-PMF-COMM
 10467*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10468*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10469     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10470        (SUB1 > +10)
 10471        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10472           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10473           MOVE '0530'           TO CTBL-SW
 10474           MOVE ' '              TO WS-CTBL-READ-SW
 10475           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10476           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10477           MOVE '0540'           TO CTBL-SW
 10478           MOVE ' '              TO WS-CTBL-READ-SW
 10479           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10480        END-IF
 10481     END-PERFORM
 10482     GO TO 0564-EDIT-CONTINUE
 10483     .
 10484 0561-CHECK-AH.
 10485     IF (NO-AH-COVERAGE)
 10486        OR (NO-AH-BENEFIT-MATCH)
 10487        CONTINUE
 10488     ELSE
 10489        IF (AM-A-COM (SUB1) NUMERIC)
 10490           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10491           IF (AM-COM-TYP (SUB1) = 'A')
 10492              AND (WS-AH-PMF-COMM = ZEROS)
 10493              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10494           END-IF
 10495           CONTINUE
 10496        ELSE
 10497           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10498           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10499           MOVE PB-AH-OVERRIDE-L1
 10500                                 TO CTBL-BEN-TYPE
 10501           MOVE ZEROS            TO WS-SUB1
 10502                                    WS-COMMISSION
 10503           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10504           PERFORM 8300-READ-CTBL-TABLE
 10505                                 THRU 8300-EXIT
 10506           IF CTBL-TABLE-FOUND
 10507              IF (AM-COM-TYP (SUB1) = 'A')
 10508                 AND (WS-AH-PMF-COMM = ZEROS)
 10509                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10510                                        PB-I-AH-TERM
 10511                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10512                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10513              END-IF
 10514              CONTINUE
 10515           ELSE
 10516              IF FIRST-TIME-THROUGH
 10517                 GO TO 0561-CHECK-AH
 10518              ELSE
 10519                 MOVE ER-2609    TO WS-ERROR
 10520                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10521              END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 192
* EL050.cbl
 10522           END-IF
 10523        END-IF
 10524     END-IF
 10525     .
 10526 0561-EXIT.
 10527     EXIT.
 10528 0563-CHECK-LF.
 10529     IF (NO-LIFE-COVERAGE)
 10530        OR (NO-LF-BENEFIT-MATCH)
 10531        CONTINUE
 10532     ELSE
 10533        IF WS-LF-JOINT-INDICATOR = 'J'
 10534           IF AM-J-COM (SUB1) NUMERIC
 10535              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10536              IF (AM-COM-TYP (SUB1) = 'A')
 10537                 AND (WS-LF-PMF-COMM = ZEROS)
 10538                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10539              END-IF
 10540              CONTINUE
 10541           ELSE
 10542              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10543              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10544              MOVE PB-LIFE-OVERRIDE-L1
 10545                                 TO CTBL-BEN-TYPE
 10546              MOVE ZEROS         TO WS-SUB1
 10547                                    WS-COMMISSION
 10548              MOVE AM-J-COMA (SUB1)
 10549                                 TO CTBL-TABLE
 10550              PERFORM 8300-READ-CTBL-TABLE
 10551                                 THRU 8300-EXIT
 10552              IF CTBL-TABLE-FOUND
 10553                 IF (AM-COM-TYP (SUB1) = 'A')
 10554                    AND (WS-LF-PMF-COMM = ZEROS)
 10555                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10556                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10557                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10558                 END-IF
 10559                 CONTINUE
 10560              ELSE
 10561                 IF FIRST-TIME-THROUGH
 10562                    GO TO 0563-CHECK-LF
 10563                 ELSE
 10564                    MOVE ER-2609 TO WS-ERROR
 10565                    PERFORM 9900-ERROR-FORMAT
 10566                                 THRU 9900-EXIT
 10567*                   GO TO 0560-EDIT-CONTINUE
 10568                 END-IF
 10569              END-IF
 10570           END-IF
 10571        ELSE
 10572           IF AM-L-COM (SUB1) NUMERIC
 10573              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10574              IF (AM-COM-TYP (SUB1) = 'A')
 10575                 AND (WS-LF-PMF-COMM = ZEROS)
 10576                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10577              END-IF
 10578              CONTINUE
 10579           ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 193
* EL050.cbl
 10580              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10581              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10582              MOVE PB-LIFE-OVERRIDE-L1
 10583                                 TO CTBL-BEN-TYPE
 10584              MOVE ZEROS         TO WS-SUB1
 10585                                    WS-COMMISSION
 10586              MOVE AM-L-COMA (SUB1)
 10587                                 TO CTBL-TABLE
 10588              PERFORM 8300-READ-CTBL-TABLE
 10589                                 THRU 8300-EXIT
 10590              IF CTBL-TABLE-FOUND
 10591                 CONTINUE
 10592              ELSE
 10593                 IF FIRST-TIME-THROUGH
 10594                    GO TO 0563-CHECK-LF
 10595                 ELSE
 10596                    MOVE ER-2609 TO WS-ERROR
 10597                    PERFORM 9900-ERROR-FORMAT
 10598                                 THRU 9900-EXIT
 10599                 END-IF
 10600              END-IF
 10601           END-IF
 10602        END-IF
 10603     END-IF
 10604     .
 10605 0563-EXIT.
 10606     EXIT.
 10607 0564-EDIT-CONTINUE.
 10608
 10609     IF  PB-COMPANY-ID EQUAL 'DMD'
 10610         IF PB-I-NUM-BILLED EQUAL ZEROS
 10611            MOVE ER-8148       TO WS-ERROR
 10612            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10613
 10614*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10615*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10616*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10617*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10618*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10619*         IF NO-CONVERSION-ERROR
 10620*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10621*         ELSE
 10622*             IF PB-COMPANY-ID EQUAL 'HAN'
 10623*                 MOVE ZEROS     TO PB-I-AGE.
 10624     IF PB-I-BIRTHDAY > LOW-VALUES
 10625        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10626        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10627        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10628        PERFORM 8500-DATE-CONVERT
 10629                                 THRU 8500-EXIT
 10630        IF NO-CONVERSION-ERROR
 10631           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10632           IF PB-I-AGE > ZEROS
 10633              IF WS-WORK-AGE NOT = PB-I-AGE
 10634                 MOVE ER-9501    TO WS-ERROR
 10635                 PERFORM 9900-ERROR-FORMAT
 10636                                 THRU 9900-EXIT
 10637              END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 194
* EL050.cbl
 10638           ELSE
 10639              MOVE WS-WORK-AGE   TO PB-I-AGE
 10640           END-IF
 10641        END-IF
 10642     END-IF
 10643     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10644                                   WS-INS-AGE-SET
 10645     IF PB-I-AGE = ZEROS
 10646        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10647           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10648                                   WS-INS-AGE-SET
 10649           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10650
 10651     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10652                                   WS-AH-EDIT-AGE.
 10653
 10654     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10655        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10656        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10657        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10658        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10659        IF NO-CONVERSION-ERROR
 10660           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10661           IF PB-I-JOINT-AGE > 0
 10662              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10663                 MOVE ER-9503    TO WS-ERROR
 10664                 PERFORM 9900-ERROR-FORMAT
 10665                                 THRU 9900-EXIT
 10666              END-IF
 10667           ELSE
 10668              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10669           END-IF
 10670        ELSE
 10671           MOVE ZEROS            TO PB-I-JOINT-AGE
 10672        END-IF
 10673     END-IF
 10674     IF PB-I-JOINT-AGE NOT NUMERIC
 10675        MOVE ZERO               TO PB-I-JOINT-AGE.
 10676
 10677     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10678                                   WS-JNT-AGE-SET
 10679     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10680        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10681           (WS-AH-JOINT-INDICATOR = 'J')
 10682           IF PB-I-JOINT-AGE = ZEROS
 10683               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10684                                          WS-JNT-AGE-SET
 10685               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10686           END-IF
 10687        END-IF
 10688     END-IF
 10689
 10690     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10691     IF WS-LF-JOINT-INDICATOR = 'J'
 10692        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10693        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10694            IF  PB-I-JOINT-AGE = ZERO
 10695                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 195
* EL050.cbl
 10696                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10697            ELSE
 10698                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10699                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10700                    IF PB-COMPANY-ID NOT = 'LBL'
 10701                        MOVE ER-2685    TO WS-ERROR
 10702                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10703
 10704     IF WS-AH-JOINT-INDICATOR = 'J'
 10705        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10706            IF  PB-I-JOINT-AGE = ZERO
 10707                MOVE ER-2686       TO WS-ERROR
 10708                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10709            ELSE
 10710                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10711                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10712                                           WS-EDIT-AGE
 10713                    IF PB-COMPANY-ID NOT = 'LBL'
 10714                        MOVE ER-2685    TO WS-ERROR
 10715                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10716
 10717******************************************************************
 10718*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10719******************************************************************
 10720
 10721     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10722        (WS-AH-SPECIAL-CALC-CD = 'O')
 10723        NEXT SENTENCE
 10724     ELSE
 10725        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10726          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10727           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10728            WS-AH-JOINT-INDICATOR = 'J')  AND
 10729           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10730            MOVE ER-2627             TO WS-ERROR
 10731            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10732
 10733     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10734        (WS-AH-SPECIAL-CALC-CD = 'O')
 10735         NEXT SENTENCE
 10736     ELSE
 10737         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10738            WS-AH-JOINT-INDICATOR = 'J'
 10739             IF PB-I-JOINT-INSURED = SPACES
 10740                 IF PB-COMPANY-ID NOT = 'JAL'
 10741                     MOVE ER-2696    TO WS-ERROR
 10742                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10743
 10744     IF PB-COMPANY-ID NOT = 'BOA'
 10745        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10746           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10747           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10748               PB-I-JOINT-INSURED NOT = SPACES)
 10749                MOVE ER-2691         TO WS-ERROR
 10750                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10751
 10752     IF PB-COMPANY-ID = 'BOA'
 10753        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 196
* EL050.cbl
 10754           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10755            IF PB-I-JOINT-AGE NOT = ZEROS
 10756                MOVE ER-2691         TO WS-ERROR
 10757                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10758
 10759     IF PB-COMPANY-ID = 'CRI'
 10760        IF PB-I-SIG-SW = 'J'
 10761           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10762              WS-AH-JOINT-INDICATOR NOT = 'J'
 10763              MOVE ER-2675       TO WS-ERROR
 10764              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10765
 10766     IF PB-COMPANY-ID = 'CRI'
 10767        IF PB-I-SIG-SW = 'S'
 10768           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10769              WS-AH-JOINT-INDICATOR = 'J'
 10770              MOVE ER-2676       TO WS-ERROR
 10771              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10772
 10773     IF PB-COMPANY-ID = 'CVL'
 10774         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10775            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10776              MOVE ER-2783           TO WS-ERROR
 10777              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10778     IF (WS-LF-JOINT-INDICATOR = 'J')
 10779        AND (WS-AH-JOINT-INDICATOR = 'J')
 10780        AND (PB-I-LF-TERM > 120)
 10781        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10782        MOVE ER-2783             TO WS-ERROR
 10783        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10784     END-IF
 10785     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10786
 10787     IF PB-I-INDV-GRP-OVRD = 'I'
 10788        MOVE ER-2666             TO WS-ERROR
 10789        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10790        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10791
 10792     IF PB-I-INDV-GRP-OVRD = 'G'
 10793        MOVE ER-2666             TO WS-ERROR
 10794        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10795        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10796
 10797     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10798        NEXT SENTENCE
 10799     ELSE
 10800        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10801
 10802     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10803        IF WS-ERROR = ER-2666
 10804           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10805           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10806
 10807     IF PB-COMPANY-ID = 'CID'
 10808        IF PB-STATE = 'UT' OR 'MO'
 10809           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10810                 OR '76' OR '77')
 10811                      OR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 197
* EL050.cbl
 10812               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10813                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10814                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10815                   OR '2K' OR '2L'))
 10816              AND PB-I-INDV-GRP-CD = 'I'
 10817              MOVE ER-2721             TO WS-ERROR
 10818              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10819           END-IF
 10820        END-IF
 10821     END-IF
 10822
 10823     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10824     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10825        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10826     ELSE
 10827        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10828     END-IF
 10829
 10830*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10831*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10832     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10833                                    ACCOUNT-AH-CK-SW.
 10834
 10835     IF PB-REISSUED-CERT       OR
 10836        PB-REIN-ONLY-CERT      OR
 10837        PB-POLICY-IS-DECLINED  OR
 10838        PB-POLICY-IS-VOIDED
 10839*       OR PB-MONTHLY-CERT
 10840         GO TO 3000-CONTINUE-EDIT.
 10841
 10842     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10843        IF WS-EDIT-AGE           > +65
 10844           MOVE ER-2709          TO WS-ERROR
 10845           PERFORM 9900-ERROR-FORMAT
 10846                                 THRU 9900-EXIT
 10847        ELSE
 10848           IF WS-EDIT-AGE        > +55
 10849              MOVE ER-2718       TO WS-ERROR
 10850              PERFORM 9900-ERROR-FORMAT
 10851                                 THRU 9900-EXIT
 10852           END-IF
 10853        END-IF
 10854     IF PB-COMPANY-ID = 'DCC'
 10855        IF WS-EDIT-AGE           > +65
 10856           MOVE ER-2709          TO WS-ERROR
 10857           PERFORM 9900-ERROR-FORMAT
 10858                                 THRU 9900-EXIT
 10859        END-IF
 10860     END-IF
 10861     .
 10862
 10863 0565-LIFE-PLAN-LIMIT-EDITS.
 10864
 10865     IF NOT LF-PLAN-MASTER-FOUND
 10866        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10867                                    EC-AM-LF-MAX-TOT-BEN
 10868        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10869
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 198
* EL050.cbl
 10870     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10871
 10872     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10873         IF PL-LM-AGE (1) = ZEROS
 10874             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10875
 10876     IF NO-LF-BENEFIT-MATCH          OR
 10877        WS-LF-BENEFIT-CD = ZEROS     OR
 10878        WS-LF-SPECIAL-CALC-CD = 'M'
 10879        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10880
 10881     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10882     MOVE +1                     TO SUB2.
 10883
 10884     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10885        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10886           MOVE +5   TO SUB2
 10887           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10888              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10889              (PL-LM-AGE (SUB2) EQUAL +0)
 10890              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10891              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10892
 10893     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10894
 10895     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10896                               + PB-I-LF-ALT-BENEFIT-AMT.
 10897
 10898 0568-CHECK-LIFE-ATT-AGE.
 10899
 10900     IF PL-ATT-AGE NUMERIC AND
 10901        PL-ATT-AGE > +0
 10902        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10903     END-IF
 10904*    IF PL-ATT-AGE NUMERIC AND
 10905*       PL-ATT-AGE > +0
 10906*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10907*       IF PB-I-BIRTHDAY > LOW-VALUES
 10908*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10909*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10910*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10911*          SET BIN-PLUS-ELAPSED  TO TRUE
 10912*          PERFORM 8500-DATE-CONVERT
 10913*                                THRU 8500-EXIT
 10914*          IF NO-CONVERSION-ERROR
 10915*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10916*             MOVE ER-2669       TO WS-ERROR
 10917*             PERFORM 9900-ERROR-FORMAT
 10918*                                THRU 9900-EXIT
 10919*          END-IF
 10920*       ELSE
 10921*          IF WS-ATT-AGE >= PL-ATT-AGE
 10922*             MOVE ER-2669       TO WS-ERROR
 10923*             PERFORM 9900-ERROR-FORMAT
 10924*                                THRU 9900-EXIT
 10925*          END-IF
 10926*       END-IF
 10927*    END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 199
* EL050.cbl
 10928     .
 10929 0570-CHECK-LIFE-LIMITS.
 10930
 10931     IF PB-COMPANY-ID EQUAL 'CRI'
 10932        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10933           IF SUB2 GREATER THAN +4
 10934              MOVE ER-2637 TO WS-ERROR
 10935              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10936              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10937
 10938     IF PB-COMPANY-ID  =  'NCL'
 10939        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10940            SUB2 GREATER THAN +8
 10941             MOVE 'U'         TO PB-BATCH-ENTRY
 10942             MOVE ER-2637     TO WS-ERROR
 10943             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10944             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10945
 10946     IF SUB2 > +8
 10947        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10948           AND (PB-I-SIG-SW = 'Y')
 10949           CONTINUE
 10950        ELSE
 10951           MOVE ER-2637          TO WS-ERROR
 10952           PERFORM 9900-ERROR-FORMAT
 10953                                 THRU 9900-EXIT
 10954        END-IF
 10955        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10956     END-IF
 10957     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10958     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10959     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10960
 10961     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10962        ADD +1  TO SUB2
 10963        GO TO 0570-CHECK-LIFE-LIMITS.
 10964
 10965     IF PB-COMPANY-ID = 'NCL'
 10966         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10967
 10968     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10969        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10970        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10971           AND (PB-I-SIG-SW = 'Y')
 10972           CONTINUE
 10973        ELSE
 10974           MOVE ER-2637          TO WS-ERROR
 10975           PERFORM 9900-ERROR-FORMAT
 10976                                 THRU 9900-EXIT
 10977        END-IF
 10978     END-IF
 10979     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10980
 10981
 10982 0570-CHECK-NCL-LIFE-LIMITS.
 10983
 10984     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10985        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 200
* EL050.cbl
 10986         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10987
 10988     IF APP-CERT-USED
 10989         IF SUB2  LESS THAN  +5
 10990             MOVE +5          TO SUB2
 10991             GO TO 0570-CHECK-LIFE-LIMITS.
 10992
 10993     MOVE ER-2637             TO WS-ERROR.
 10994     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10995
 10996     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10997
 10998 0575-CHECK-NCL-SIG-SWITCH.
 10999
 11000     IF NOT APP-CERT-USED
 11001         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11002
 11003     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11004        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11005        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11006        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11007         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11008
 11009     IF SUB2 GREATER THAN +4
 11010         IF PL-LM-AGE (5) = ZEROS  AND
 11011            PL-LM-AGE (6) = ZEROS  AND
 11012            PL-LM-AGE (7) = ZEROS  AND
 11013            PL-LM-AGE (8) = ZEROS
 11014             MOVE  ER-1927        TO WS-ERROR
 11015             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11016             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11017         ELSE
 11018             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11019                 MOVE  ER-1920    TO WS-ERROR
 11020                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11021
 11022     IF PB-I-SIG-SW  = 'Y'
 11023       IF NOT PB-I-POLICY-ACCEPTED  AND
 11024          NOT PB-I-POLICY-DECLINED
 11025           MOVE 'U'               TO PB-BATCH-ENTRY
 11026           MOVE  ER-1926          TO WS-ERROR
 11027           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11028
 11029
 11030 0580-AH-PLAN-LIMIT-EDITS.
 11031
 11032     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11033        IF PB-I-AH-BENEFIT-AMT > +1250
 11034           MOVE ER-2702          TO WS-ERROR
 11035           PERFORM 9900-ERROR-FORMAT
 11036                                 THRU 9900-EXIT
 11037        END-IF
 11038     END-IF
 11039
 11040     IF (PB-COMPANY-ID = 'DCC')
 11041        AND (PB-MONTHLY-CERT)
 11042        IF PB-I-AH-BENEFIT-AMT > +3000
 11043           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 201
* EL050.cbl
 11044           PERFORM 9900-ERROR-FORMAT
 11045                                 THRU 9900-EXIT
 11046        END-IF
 11047     END-IF
 11048     IF NOT AH-PLAN-MASTER-FOUND
 11049        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11050        GO TO 3000-CONTINUE-EDIT.
 11051
 11052     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11053
 11054     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11055         IF PL-LM-AGE (1) = ZEROS
 11056             GO TO 3000-CONTINUE-EDIT.
 11057
 11058     IF NO-AH-BENEFIT-MATCH          OR
 11059        WS-AH-BENEFIT-CD = ZEROS     OR
 11060        WS-AH-SPECIAL-CALC-CD = 'M'
 11061        GO TO 3000-CONTINUE-EDIT.
 11062
 11063     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11064     MOVE +1                     TO SUB2.
 11065
 11066     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11067        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11068           MOVE +5 TO SUB2
 11069           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11070              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11071              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11072              (PL-LM-AGE (SUB2) EQUAL +0)
 11073              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11074              GO TO 3000-CONTINUE-EDIT.
 11075
 11076     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11077
 11078 0590-CHECK-AH-ATT-AGE.
 11079
 11080     IF PL-ATT-AGE NUMERIC AND
 11081        PL-ATT-AGE GREATER THAN +0
 11082        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11083     END-IF
 11084*       IF WS-ATT-AGE >= PL-ATT-AGE
 11085*          MOVE ER-3054          TO WS-ERROR
 11086*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11087     .
 11088 0597-CHECK-AH-LIMITS.
 11089
 11090     IF PB-COMPANY-ID EQUAL 'CRI'
 11091        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11092           IF SUB2 GREATER THAN +4
 11093              MOVE ER-2638       TO WS-ERROR
 11094              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11095              GO TO 3000-CONTINUE-EDIT.
 11096
 11097     IF PB-COMPANY-ID  =  'NCL'
 11098        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11099            SUB2 GREATER THAN +8
 11100             MOVE 'U'            TO PB-BATCH-ENTRY
 11101             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 202
* EL050.cbl
 11102             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11103             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11104
 11105     IF SUB2 > +8
 11106        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11107           AND (PB-I-SIG-SW = 'Y')
 11108           CONTINUE
 11109        ELSE
 11110           MOVE ER-2638          TO WS-ERROR
 11111           PERFORM 9900-ERROR-FORMAT
 11112                                 THRU 9900-EXIT
 11113        END-IF
 11114        GO TO 3000-CONTINUE-EDIT
 11115     END-IF
 11116
 11117     IF PB-COMPANY-ID = 'CRI'
 11118        IF WS-ERROR = ER-2638
 11119           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11120
 11121     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11122     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11123     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11124     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11125
 11126     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11127        ADD +1                   TO SUB2
 11128        GO TO 0597-CHECK-AH-LIMITS.
 11129
 11130     IF PB-COMPANY-ID = 'NCL'
 11131         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11132
 11133     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11134        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11135        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11136                                 > PL-LM-AMT (SUB2))
 11137        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11138           AND (PB-I-SIG-SW = 'Y')
 11139           CONTINUE
 11140        ELSE
 11141           MOVE ER-2638          TO WS-ERROR
 11142           PERFORM 9900-ERROR-FORMAT
 11143                                 THRU 9900-EXIT
 11144        END-IF
 11145     END-IF
 11146
 11147     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11148         IF  WS-ERROR    EQUAL    ER-2638
 11149             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11150                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11151                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11152                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11153                MOVE  ER-1910    TO  WS-ERROR
 11154                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11155
 11156     IF PB-COMPANY-ID = 'CRI'
 11157        IF WS-ERROR = ER-2638
 11158            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11159            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 203
* EL050.cbl
 11160            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11161
 11162     GO TO 3000-CONTINUE-EDIT.
 11163
 11164 0597-CHECK-NCL-AH-LIMITS.
 11165
 11166     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11167        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11168        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11169                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11170         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11171
 11172     IF APP-CERT-USED
 11173         IF SUB2  LESS THAN  +5
 11174             MOVE +5             TO SUB2
 11175             GO TO 0597-CHECK-AH-LIMITS.
 11176
 11177     MOVE ER-2638                TO WS-ERROR.
 11178     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11179
 11180     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11181
 11182 0599-CHECK-NCL-SIG-SWITCH.
 11183
 11184     IF NOT APP-CERT-USED
 11185         GO TO 3000-CONTINUE-EDIT.
 11186
 11187     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11188        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11189        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11190        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11191         GO TO 3000-CONTINUE-EDIT.
 11192
 11193     IF SUB2 GREATER THAN +4
 11194         IF PL-LM-AGE (5) = ZEROS  AND
 11195            PL-LM-AGE (6) = ZEROS  AND
 11196            PL-LM-AGE (7) = ZEROS  AND
 11197            PL-LM-AGE (8) = ZEROS
 11198             MOVE  ER-1927        TO WS-ERROR
 11199             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11200             GO TO 3000-CONTINUE-EDIT
 11201         ELSE
 11202             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11203                 MOVE  ER-1920    TO WS-ERROR
 11204                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11205
 11206     IF PB-I-SIG-SW  = 'Y'
 11207       IF NOT PB-I-POLICY-ACCEPTED  AND
 11208          NOT PB-I-POLICY-DECLINED
 11209           MOVE 'U'               TO PB-BATCH-ENTRY
 11210           MOVE  ER-1926          TO WS-ERROR
 11211           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11212
 11213******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 204
* EL050.cbl
 11215
 11216 3000-CONTINUE-EDIT.
 11217
 11218     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11219     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11220     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11221     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11222     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11223
 11224     IF BROWSE-STARTED
 11225        PERFORM 9990-RETURN THRU 9990-EXIT
 11226        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11227
 11228     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11229        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11230        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11231        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11232*       MOVE 1                   TO DC-OPTION-CODE
 11233        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11234        IF DATE-CONVERSION-ERROR
 11235           MOVE ER-2622          TO WS-ERROR
 11236           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11237        ELSE
 11238           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11239              MOVE ER-2623       TO WS-ERROR
 11240              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11241           ELSE
 11242              MOVE ER-2622       TO WS-ERROR
 11243              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11244
 11245     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11246     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11247     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11248*    MOVE 1                      TO DC-OPTION-CODE.
 11249     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11250     IF DATE-CONVERSION-ERROR
 11251        GO TO 3005-EDIT-CONTINUE
 11252     ELSE
 11253        IF DC-ELAPSED-DAYS GREATER +180
 11254           MOVE ER-2613          TO WS-ERROR
 11255           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11256        ELSE
 11257           IF DC-ELAPSED-DAYS GREATER +90
 11258              MOVE ER-2612       TO WS-ERROR
 11259              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11260           ELSE
 11261             IF DC-ELAPSED-DAYS GREATER +60
 11262                MOVE ER-2614     TO WS-ERROR
 11263                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11264
 11265 3005-EDIT-CONTINUE.
 11266
 11267     IF PB-CANCELLATION
 11268         GO TO 3700-EDIT-CANCEL.
 11269
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 205
* EL050.cbl
 11271******************************************************************
 11272*                  E D I T   I S S U E                           *
 11273******************************************************************
 11274
 11275 3020-EDIT-ISSUE.
 11276
 11277      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11278      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11279      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11280      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11281      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11282
 11283     IF PB-ISSUE-FORCE
 11284        OR PB-ISSUE-DATE-FORCED
 11285        OR PB-FORCE-OFF
 11286        OR PB-OVERCHARGE-FORCE
 11287        CONTINUE
 11288     ELSE
 11289        MOVE ER-2670             TO WS-ERROR
 11290        PERFORM 9900-ERROR-FORMAT
 11291                                 THRU 9900-EXIT
 11292     END-IF
 11293     .
 11294 3022-SET-POLICY-STATUS.
 11295
 11296     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11297
 11298     IF (PB-REISSUED-CERT)
 11299             OR
 11300        ((PB-COMPANY-ID NOT = 'DCC')
 11301         AND (PB-MONTHLY-CERT))
 11302         MOVE '5'                TO PB-I-ENTRY-STATUS
 11303         MOVE 'E'                TO PB-BATCH-ENTRY
 11304     END-IF
 11305
 11306     IF PB-COMPANY-ID = 'DCC'
 11307        IF PB-MONTHLY-CERT
 11308           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11309        END-IF
 11310     END-IF
 11311     IF PB-POLICY-IS-DECLINED
 11312         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11313     IF PB-POLICY-IS-VOIDED
 11314         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11315     IF PB-NEEDS-UNDERWRITING
 11316         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11317     IF PB-REIN-ONLY-CERT
 11318         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11319     IF PB-PREM-ACCTNG-ONLY
 11320         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11321
 11322     MOVE SPACE                  TO PB-I-OB-FLAG.
 11323
 11324     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11325         MOVE ER-2665            TO WS-ERROR
 11326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11327         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11328
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 206
* EL050.cbl
 11329     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11330        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11331           MOVE 'Z'             TO PB-I-OB-FLAG.
 11332
 11333     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11334        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11335           MOVE 'Z'             TO PB-I-OB-FLAG.
 11336
 11337     IF ACCOUNT-MAST-FOUND
 11338         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11339         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11340         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11341         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11342         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11343         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11344         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11345     END-IF
 11346
 11347     IF ACCOUNT-MAST-FOUND
 11348        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11349         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11350
 11351     IF (ACCOUNT-MAST-FOUND)
 11352        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11353        IF PB-REISSUED-CERT
 11354           CONTINUE
 11355        ELSE
 11356           MOVE ER-2608          TO WS-ERROR
 11357           PERFORM 9900-ERROR-FORMAT
 11358                                 THRU 9900-EXIT
 11359         END-IF
 11360     END-IF
 11361
 11362     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11363        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11364        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11365
 11366**********   DMD CUSTOM CODE FOLLOWS  **********
 11367 3024-EDIT-DMD-FIELDS.
 11368     IF PB-COMPANY-ID NOT = 'DMD'
 11369        GO TO 3025-EDIT-REINSURANCE.
 11370
 11371*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11372*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11373*** ERROR IF THEY ARE NOT EQUAL.
 11374
 11375     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11376     SET BIN-TO-GREG               TO TRUE.
 11377     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11378     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11379**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11380
 11381     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11382     SET BIN-TO-GREG               TO TRUE.
 11383     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11384     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11385**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11386
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 207
* EL050.cbl
 11387     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11388        MOVE ER-8116               TO WS-ERROR
 11389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11390
 11391     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11392
 11393     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11394                                      WK-FULL-CERT-NO.
 11395     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11396
 11397     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11398
 11399     IF PB-VALID-LIFE
 11400        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11401     ELSE
 11402        IF PB-VALID-AH
 11403          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11404
 11405
 11406     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11407     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11408     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11409                                      DCUA-UNDRWRTR-CODE
 11410                                      DCUA-UNDRWRTR-GROUP-CODE
 11411                                      DCUA-RETURN-CODE.
 11412
 11413****************************************************************
 11414*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11415***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11416***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11417***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11418***   TO THIS RECORD.                                        ***
 11419****************************************************************
 11420     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11421     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11422     IF DCUA-SUCCESSFUL-PROCESS
 11423        GO TO 3024-EDIT-DL7-CONT.
 11424
 11425     IF DCUA-RETURN-CODE EQUAL '01'
 11426        MOVE ER-8110               TO WS-ERROR
 11427        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11429        GO TO 3024-EDIT-DL7-CONT.
 11430
 11431     IF DCUA-RETURN-CODE EQUAL '02'
 11432        MOVE ER-8111               TO WS-ERROR
 11433        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11435        GO TO 3024-EDIT-DL7-CONT.
 11436
 11437     IF DCUA-RETURN-CODE EQUAL '03'
 11438        MOVE ER-8074               TO WS-ERROR
 11439        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11441        GO TO 3024-EDIT-DL7-CONT.
 11442
 11443     IF DCUA-RETURN-CODE EQUAL '04'
 11444        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 208
* EL050.cbl
 11445        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11447        GO TO 3024-EDIT-DL7-CONT.
 11448
 11449     IF DCUA-RETURN-CODE EQUAL '05'
 11450        MOVE ER-8076               TO WS-ERROR
 11451        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11453        GO TO 3024-EDIT-DL7-CONT.
 11454
 11455     IF DCUA-RETURN-CODE EQUAL '06'
 11456        MOVE ER-8077               TO WS-ERROR
 11457        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11459        GO TO 3024-EDIT-DL7-CONT.
 11460
 11461     IF DCUA-RETURN-CODE EQUAL '07'
 11462        MOVE ER-8078               TO WS-ERROR
 11463        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11464        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11465        GO TO 3024-EDIT-DL7-CONT.
 11466
 11467     IF DCUA-RETURN-CODE EQUAL 'E1'
 11468        MOVE ER-8079               TO WS-ERROR
 11469        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11471        GO TO 3024-EDIT-DL7-CONT.
 11472
 11473     IF DCUA-RETURN-CODE EQUAL 'E2'
 11474        MOVE ER-8080               TO WS-ERROR
 11475        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11477        GO TO 3024-EDIT-DL7-CONT.
 11478
 11479     IF DCUA-RETURN-CODE EQUAL 'E3'
 11480        MOVE ER-8098               TO WS-ERROR
 11481        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11483        GO TO 3024-EDIT-DL7-CONT.
 11484
 11485     IF DCUA-RETURN-CODE EQUAL 'C1'
 11486        MOVE ER-8099               TO WS-ERROR
 11487        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11488        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11489        GO TO 3024-EDIT-DL7-CONT.
 11490
 11491     IF DCUA-RETURN-CODE EQUAL 'U1'
 11492        MOVE ER-8109               TO WS-ERROR
 11493        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11495        GO TO 3024-EDIT-DL7-CONT.
 11496
 11497     IF DCUA-RETURN-CODE EQUAL 'N1'
 11498        MOVE ER-8112               TO WS-ERROR
 11499        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11501        GO TO 3024-EDIT-DL7-CONT.
 11502
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 209
* EL050.cbl
 11503     IF DCUA-RETURN-CODE EQUAL 'N2'
 11504        MOVE ER-8113               TO WS-ERROR
 11505        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507        GO TO 3024-EDIT-DL7-CONT.
 11508
 11509     IF DCUA-RETURN-CODE EQUAL 'N3'
 11510        MOVE ER-8114               TO WS-ERROR
 11511        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11513        GO TO 3024-EDIT-DL7-CONT.
 11514
 11515     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11516     MOVE ER-8097                  TO WS-ERROR.
 11517     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11518     GO TO 3024-EDIT-DL7-CONT.
 11519
 11520 3024-EDIT-DL7-CONT.
 11521
 11522     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11523     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11524     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11525        NEXT SENTENCE
 11526     ELSE
 11527        MOVE ER-9263               TO WS-ERROR
 11528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11529
 11530******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11531******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11532     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11533        NEXT SENTENCE
 11534     ELSE
 11535        MOVE ER-8039               TO WS-ERROR
 11536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11537
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 210
* EL050.cbl
 11539****************************************************************
 11540*** VALIDATE STATE  : DLO022                                 ***
 11541****************************************************************
 11542     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11543     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11544
 11545     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11546     IF DVSC-SUCCESSFUL-EDIT
 11547        GO TO 3024-EDIT-DL22-CONT.
 11548
 11549     IF DVSC-RETURN-CODE EQUAL '01'
 11550        MOVE ER-8300               TO WS-ERROR
 11551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11552        GO TO 3024-EDIT-DL22-CONT.
 11553
 11554     IF DVSC-RETURN-CODE EQUAL '02'
 11555        MOVE ER-8301               TO WS-ERROR
 11556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11557        GO TO 3024-EDIT-DL22-CONT.
 11558
 11559     IF DVSC-RETURN-CODE EQUAL '03'
 11560        MOVE ER-8302               TO WS-ERROR
 11561        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11562        GO TO 3024-EDIT-DL22-CONT.
 11563
 11564     IF DVSC-RETURN-CODE EQUAL 'N1'
 11565        MOVE ER-8304               TO WS-ERROR
 11566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11567        GO TO 3024-EDIT-DL22-CONT.
 11568
 11569     MOVE ER-8303                  TO WS-ERROR
 11570     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11571
 11572 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 211
* EL050.cbl
 11574****************************************************************
 11575*** VALIDATE LOAN OFFICER : DLO021                           ***
 11576****************************************************************
 11577
 11578     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11579     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11580     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11581     IF DVLO-SUCCESSFUL-EDIT
 11582        GO TO 3024-EDIT-DL21-CONT.
 11583
 11584     IF DVLO-RETURN-CODE EQUAL '01'
 11585        MOVE ER-8081               TO WS-ERROR
 11586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11587        GO TO 3024-EDIT-DL21-CONT.
 11588
 11589     IF DVLO-RETURN-CODE EQUAL '02'
 11590        MOVE ER-8082               TO WS-ERROR
 11591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11592        GO TO 3024-EDIT-DL21-CONT.
 11593
 11594     IF DVLO-RETURN-CODE EQUAL '03'
 11595        MOVE ER-8083               TO WS-ERROR
 11596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11597        GO TO 3024-EDIT-DL21-CONT.
 11598
 11599     IF DVLO-RETURN-CODE EQUAL '04'
 11600        MOVE ER-8084               TO WS-ERROR
 11601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11602        GO TO 3024-EDIT-DL21-CONT.
 11603
 11604     IF DVLO-RETURN-CODE EQUAL '05'
 11605        MOVE ER-8085               TO WS-ERROR
 11606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11607        GO TO 3024-EDIT-DL21-CONT.
 11608
 11609     MOVE ER-7825                  TO WS-ERROR
 11610     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11611     GO TO 3024-EDIT-DL21-CONT.
 11612
 11613 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 212
* EL050.cbl
 11615
 11616****************************************************************
 11617*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11618****************************************************************
 11619
 11620     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11621     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11622     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11623     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11624     IF DIPF-SUCCESSFUL-EDIT
 11625        GO TO 3024-EDIT-DL02-CONT.
 11626
 11627     IF DIPF-RETURN-CODE EQUAL '01'
 11628        MOVE ER-8086               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630        GO TO 3024-EDIT-DL02-CONT.
 11631
 11632     IF DIPF-RETURN-CODE EQUAL '02'
 11633        MOVE ER-8087               TO WS-ERROR
 11634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11635        GO TO 3024-EDIT-DL02-CONT.
 11636
 11637     IF DIPF-RETURN-CODE EQUAL '03'
 11638        MOVE ER-8088               TO WS-ERROR
 11639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11640        GO TO 3024-EDIT-DL02-CONT.
 11641
 11642     MOVE ER-8095                  TO WS-ERROR
 11643     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11644     GO TO 3024-EDIT-DL02-CONT.
 11645
 11646 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 213
* EL050.cbl
 11648
 11649****************************************************************
 11650*** VALIDATE BANK ID : DLO003                                ***
 11651****************************************************************
 11652
 11653     MOVE WK-GREG-CENT           TO WCG-CENT.
 11654     MOVE WK-GREG-YYMM           TO WCG-REST.
 11655     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11656        MOVE ER-8040               TO WS-ERROR
 11657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11658
 11659     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11660     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11661     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11662     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11663     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11664     IF DVBI-SUCCESSFUL-EDIT
 11665        GO TO 3024-EDIT-DL03-CONT.
 11666
 11667     IF DVBI-RETURN-CODE EQUAL '01'
 11668        MOVE ER-8089               TO WS-ERROR
 11669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11670        GO TO 3024-EDIT-DL03-CONT.
 11671
 11672     IF DVBI-RETURN-CODE EQUAL '02'
 11673        MOVE ER-8090               TO WS-ERROR
 11674        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11675        GO TO 3024-EDIT-DL03-CONT.
 11676
 11677     IF DVBI-RETURN-CODE EQUAL '03'
 11678        MOVE ER-8091               TO WS-ERROR
 11679        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11680        GO TO 3024-EDIT-DL03-CONT.
 11681
 11682     IF DVBI-RETURN-CODE EQUAL '04'
 11683        MOVE ER-8092               TO WS-ERROR
 11684        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11685        GO TO 3024-EDIT-DL03-CONT.
 11686
 11687     IF DVBI-RETURN-CODE EQUAL '05'
 11688        MOVE ER-8093               TO WS-ERROR
 11689        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11690        GO TO 3024-EDIT-DL03-CONT.
 11691
 11692     IF DVBI-RETURN-CODE EQUAL '06'
 11693        MOVE ER-8094               TO WS-ERROR
 11694        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11695        GO TO 3024-EDIT-DL03-CONT.
 11696
 11697     MOVE ER-8096                  TO WS-ERROR
 11698     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11699     GO TO 3024-EDIT-DL03-CONT.
 11700
 11701 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 214
* EL050.cbl
 11703
 11704     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11705        NEXT SENTENCE
 11706     ELSE
 11707        MOVE ER-8042               TO WS-ERROR
 11708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11709
 11710     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11711     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11712     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11713
 11714     IF DMPF-RETURN-CODE = '01'
 11715        MOVE ER-8067               TO WS-ERROR
 11716        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11717        GO TO 3024-EDIT-DL01-CONT.
 11718
 11719     IF DMPF-RETURN-CODE = '02'
 11720        MOVE ER-8068               TO WS-ERROR
 11721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11722        GO TO 3024-EDIT-DL01-CONT.
 11723
 11724     IF DMPF-RETURN-CODE = '03'
 11725        MOVE ER-8069               TO WS-ERROR
 11726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11727        GO TO 3024-EDIT-DL01-CONT.
 11728
 11729     IF DMPF-RETURN-CODE = 'E1'
 11730        MOVE ER-8070               TO WS-ERROR
 11731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11732        GO TO 3024-EDIT-DL01-CONT.
 11733
 11734     IF DMPF-RETURN-CODE = 'N1'
 11735        MOVE ER-8071               TO WS-ERROR
 11736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11737        GO TO 3024-EDIT-DL01-CONT.
 11738
 11739     IF DMPF-RETURN-CODE NOT = 'OK'
 11740        MOVE ER-8072               TO WS-ERROR
 11741        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11742
 11743 3024-EDIT-DL01-CONT.
 11744******************************************************************
 11745***  VALIDATES RATE CODES : DLO017                             ***
 11746******************************************************************
 11747
 11748      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11749      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11750      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11751      IF DVRC-SUCCESSFUL-EDIT
 11752        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11753        GO TO 3024-CHECK-VALID-RATE.
 11754
 11755      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11756
 11757      IF DVRC-RETURN-CODE EQUAL '01'
 11758         MOVE ER-7817                   TO WS-ERROR
 11759         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11760         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 215
* EL050.cbl
 11761
 11762      IF DVRC-RETURN-CODE EQUAL '02'
 11763         MOVE ER-7818                   TO WS-ERROR
 11764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11765         GO TO 3025-EDIT-REINSURANCE.
 11766
 11767      IF DVRC-RETURN-CODE EQUAL '03'
 11768         MOVE ER-7819                   TO WS-ERROR
 11769         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11770         GO TO 3025-EDIT-REINSURANCE.
 11771
 11772       MOVE ER-7820                     TO WS-ERROR.
 11773       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11774       GO TO 3025-EDIT-REINSURANCE.
 11775
 11776******************************************************************
 11777***  GET PREMIUM RATES : DLO011                                ***
 11778******************************************************************
 11779
 11780 3024-CHECK-VALID-RATE.
 11781
 11782     IF VALID-RATE-CODE
 11783        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11784        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11785        MOVE SPACES                TO DPRB-RETURN-CODE
 11786        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11787     ELSE
 11788         GO TO 3025-EDIT-REINSURANCE.
 11789
 11790      IF DPRB-SUCCESSFUL-PROCESS
 11791         IF PB-VALID-LIFE
 11792             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11793             GO TO 3025-EDIT-REINSURANCE
 11794         ELSE
 11795             IF PB-VALID-AH
 11796                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11797                 GO TO 3025-EDIT-REINSURANCE.
 11798
 11799      IF DPRB-RETURN-CODE EQUAL '01'
 11800         MOVE ER-7812                   TO WS-ERROR
 11801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11802         GO TO 3025-EDIT-REINSURANCE.
 11803
 11804      IF DPRB-RETURN-CODE EQUAL '02'
 11805         MOVE ER-7813                   TO WS-ERROR
 11806         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11807         GO TO 3025-EDIT-REINSURANCE.
 11808
 11809      IF DPRB-RETURN-CODE EQUAL '03'
 11810         MOVE ER-7814                   TO WS-ERROR
 11811         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11812         GO TO 3025-EDIT-REINSURANCE.
 11813
 11814      IF DPRB-RETURN-CODE EQUAL '04'
 11815         IF NOT DPRB-1ST-TIME
 11816            MOVE ER-7815                   TO WS-ERROR
 11817            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11818            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 216
* EL050.cbl
 11819          ELSE
 11820         IF PB-VALID-LIFE
 11821            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11822          ELSE
 11823            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11824         END-IF
 11825         MOVE SPACES                TO DOCC-RETURN-CODE
 11826         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11827         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11828         IF DOCC-RETURN-CODE = 'OK'
 11829             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11830             GO TO 3024-CHECK-VALID-RATE
 11831           ELSE
 11832             MOVE ER-7823               TO WS-ERROR
 11833             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11834             GO TO 3025-EDIT-REINSURANCE.
 11835
 11836       MOVE ER-7816                     TO WS-ERROR.
 11837       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11838       GO TO 3025-EDIT-REINSURANCE.
 11839
 11840**********   DMD CUSTOM CODE ABOVE    **********
 11841
 11842 3025-EDIT-REINSURANCE.
 11843     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11844         GO TO 3027-EDIT-CONTINUE.
 11845
 11846     MOVE LOW-VALUES               TO ERREIN-KEY.
 11847     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11848     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11849                                      REIN-CODE-2
 11850                                      REIN-CODE-3.
 11851     MOVE 'A'                      TO REIN-TYPE.
 11852
 11853     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11854
 11855     MOVE '3026' TO REIN-SW.
 11856     MOVE ' '                   TO WS-REIN-READ-SW.
 11857
 11858     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11859     IF REIN-TABLE-NOT-FOUND
 11860         GO TO 3026-NO-SPEC-TABLE.
 11861
 11862     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11863     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11864                                   WS-NSP-ST-CD-LF.
 11865     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11866                                   WS-NSP-ST-CD-AH.
 11867
 11868     GO TO 3040-EDIT-CONTINUE.
 11869
 11870 3026-NO-SPEC-TABLE.
 11871
 11872     MOVE ER-2664                TO WS-ERROR.
 11873     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11874     GO TO 3040-EDIT-CONTINUE.
 11875
 11876 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 217
* EL050.cbl
 11877
 11878     IF PB-I-REIN-TABLE = SPACES
 11879       GO TO 3040-EDIT-CONTINUE.
 11880
 11881     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11882          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11883          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11884           GO TO 3040-EDIT-CONTINUE.
 11885
 11886     MOVE LOW-VALUES            TO ERREIN-KEY.
 11887     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11888     MOVE 'A'                   TO REIN-TYPE.
 11889     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11890
 11891     MOVE '3028'                TO REIN-SW.
 11892     MOVE ' '                   TO WS-REIN-READ-SW.
 11893
 11894     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11895     IF REIN-TABLE-NOT-FOUND
 11896         GO TO 3028-NO-REIN-TABLE.
 11897
 11898     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11899     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11900                                   WS-NSP-ST-CD-LF.
 11901     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11902                                   WS-NSP-ST-CD-AH.
 11903
 11904     GO TO 3040-EDIT-CONTINUE.
 11905
 11906 3028-NO-REIN-TABLE.
 11907
 11908     MOVE ER-2615                TO WS-ERROR.
 11909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11910     GO TO 3040-EDIT-CONTINUE.
 11911
 11912 3040-EDIT-CONTINUE.
 11913
 11914     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11915         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11916
 11917     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11918         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11919
 11920     IF (NOT PB-REISSUED-CERT)
 11921        AND (NOT PB-MONTHLY-CERT)
 11922        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11923            MOVE '001'           TO PB-I-LF-TERM
 11924            MOVE 'M'             TO PB-I-INSURED-SEX.
 11925
 11926     IF (NOT PB-REISSUED-CERT)
 11927        AND (NOT PB-MONTHLY-CERT)
 11928        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11929            MOVE '001'           TO PB-I-AH-TERM
 11930            MOVE 'M'             TO PB-I-INSURED-SEX.
 11931
 11932 3040-EDIT-1ST-PMT-DT.
 11933     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11934     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 218
* EL050.cbl
 11935         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11936
 11937******************************************************************
 11938*                                                                *
 11939*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11940*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11941*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11942*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11943*                                                                *
 11944******************************************************************
 11945
 11946     IF PB-EFF-DT-PROCESSING
 11947        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11948                                    PB-I-LF-EXPIRE-DT
 11949                                    PB-I-AH-EXPIRE-DT
 11950        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11951        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11952        MOVE ZERO                TO DC-ELAPSED-DAYS
 11953        MOVE +1                  TO DC-ELAPSED-MONTHS
 11954        SET BIN-PLUS-ELAPSED     TO TRUE
 11955*       MOVE 6                   TO DC-OPTION-CODE
 11956        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11957        IF NO-CONVERSION-ERROR
 11958           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11959
 11960******************************************************************
 11961*                                                                *
 11962*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11963*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11964*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11965*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11966*                                                                *
 11967******************************************************************
 11968
 11969     IF PB-EXT-DAYS-PROCESSING
 11970          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11971                                         PB-I-LF-EXPIRE-DT
 11972                                         PB-I-AH-EXPIRE-DT
 11973          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11974          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11975          MOVE +1                     TO DC-ELAPSED-MONTHS
 11976          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11977          SET BIN-PLUS-ELAPSED        TO TRUE
 11978*         MOVE 6                      TO DC-OPTION-CODE
 11979          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11980          IF NO-CONVERSION-ERROR
 11981             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11982
 11983******************************************************************
 11984*                                                                *
 11985*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11986*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11987*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11988*        (EXPIRE DATE - (TERM -1))  *  -1.
 11989*                                                                *
 11990******************************************************************
 11991
 11992     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 219
* EL050.cbl
 11993        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11994           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11995              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11996              MOVE PB-I-AH-TERM      TO WS-TERM
 11997           ELSE
 11998              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11999              MOVE PB-I-LF-TERM      TO WS-TERM
 12000        ELSE
 12001           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12002              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12003              MOVE PB-I-LF-TERM      TO WS-TERM
 12004           ELSE
 12005              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12006              MOVE PB-I-AH-TERM      TO WS-TERM.
 12007
 12008     IF PB-EXPIRE-DT-PROCESSING
 12009        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12010        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12011        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12012        MOVE ZERO                TO DC-ELAPSED-DAYS
 12013                                    DC-ODD-DAYS-OVER
 12014          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12015          SET BIN-PLUS-ELAPSED    TO TRUE
 12016*         MOVE 6                  TO DC-OPTION-CODE
 12017          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12018          IF NO-CONVERSION-ERROR
 12019             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12020
 12021******************************************************************
 12022*                                                                *
 12023*            1ST PAYMENT DATE PROCESSING                         *
 12024*                                                                *
 12025******************************************************************
 12026
 12027     IF PB-1ST-PMT-DT-PROCESSING
 12028        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12029                                    PB-I-AH-EXPIRE-DT
 12030        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12031
 12032     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12033         NEXT SENTENCE
 12034     ELSE
 12035         MOVE ER-2680                 TO WS-ERROR
 12036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12037         GO TO 3060-ORIG-TERM-CHECK.
 12038
 12039     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12040     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12041     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12042*    MOVE 1                      TO DC-OPTION-CODE.
 12043     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12044                                    DC-ELAPSED-DAYS
 12045                                    DC-ODD-DAYS-OVER.
 12046
 12047     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12048
 12049     IF DATE-CONVERSION-ERROR
 12050        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 220
* EL050.cbl
 12051
 12052     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12053     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12054        AND (WS-LF-COVERAGE-TYPE = 'L')
 12055        IF (DC-ELAPSED-MONTHS > 1)
 12056                      OR
 12057           ((DC-ELAPSED-MONTHS = 1)
 12058           AND (DC-ODD-DAYS-OVER > 0))
 12059           MOVE ER-2882          TO WS-ERROR
 12060           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12061        END-IF
 12062     END-IF
 12063     if dc-elapsed-months > 0
 12064        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12065        + dc-odd-days-over
 12066     end-if
 12067     IF PB-EXT-DAYS-PROCESSING
 12068        CONTINUE
 12069     ELSE
 12070        IF DC-ELAPSED-MONTHS = +0
 12071           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12072        ELSE
 12073           IF (WS-LF-EARNINGS-CALC = '4')
 12074              AND (DC-ELAPSED-MONTHS > ZERO)
 12075              AND (DC-ELAPSED-DAYS > ZERO)
 12076              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12077           ELSE
 12078              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12079                                 THRU 6499-EXIT
 12080              MOVE WS-ODD-DAYS-OVER
 12081                                 TO PB-I-EXTENTION-DAYS
 12082           END-IF
 12083        END-IF
 12084     END-IF
 12085******************************************************************
 12086*                                                                *
 12087*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12088*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12089*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12090*            AND ANY ODD DAYS.                                   *
 12091*                                                                *
 12092******************************************************************
 12093
 12094     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12095                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12096     IF WS-LF-EARNINGS-CALC NOT = '4'
 12097        IF DC-ELAPSED-DAYS > ZEROS
 12098           MOVE ER-2681          TO WS-ERROR
 12099           PERFORM 9900-ERROR-FORMAT
 12100                                 THRU 9900-EXIT
 12101        END-IF
 12102     END-IF
 12103
 12104     IF WS-LF-EARNINGS-CALC NOT = '4'
 12105        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12106           MOVE ER-2681          TO WS-ERROR
 12107           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12108
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 221
* EL050.cbl
 12109     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12110        (PB-I-LF-TERM NOT = ZERO) AND
 12111         NOT NO-LIFE-COVERAGE
 12112          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12113          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12114          IF WS-LF-EARNINGS-CALC = '4'
 12115             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12116             PB-I-PAY-FREQUENCY
 12117          END-IF
 12118          MOVE ZERO              TO DC-ELAPSED-DAYS
 12119                                    DC-ODD-DAYS-OVER
 12120          MOVE 1                 TO DC-END-OF-MONTH
 12121          SET BIN-PLUS-ELAPSED        TO TRUE
 12122*         MOVE 6                 TO DC-OPTION-CODE
 12123          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12124          IF NO-CONVERSION-ERROR
 12125             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12126             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12127                (WS-LF-SPECIAL-CALC-CD = 'L')
 12128                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12129                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12130                  MOVE +1             TO DC-ELAPSED-MONTHS
 12131                  SET BIN-PLUS-ELAPSED  TO TRUE
 12132*                 MOVE 6              TO DC-OPTION-CODE
 12133                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12134                  IF NO-CONVERSION-ERROR
 12135                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12136
 12137* okay, i had to move the new att age edit down here because the
 12138* expiration date could get recalculated and i need the exp date
 12139     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12140        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12141        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12142        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12143           AND ZEROS
 12144           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12145           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12146           SET ELAPSED-BETWEEN-BIN TO TRUE
 12147           PERFORM 8500-DATE-CONVERT
 12148                                 THRU 8500-EXIT
 12149           IF NO-CONVERSION-ERROR
 12150              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12151                 MOVE ER-2669       TO WS-ERROR
 12152*                PERFORM 9900-ERROR-FORMAT
 12153*                                THRU 9900-EXIT
 12154              END-IF
 12155           END-IF
 12156        ELSE
 12157           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12158           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12159              MOVE ER-2669       TO WS-ERROR
 12160*             PERFORM 9900-ERROR-FORMAT
 12161*                                THRU 9900-EXIT
 12162           ELSE
 12163              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12164                 MOVE ER-1570    TO WS-ERROR
 12165                 PERFORM 9900-ERROR-FORMAT
 12166                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 222
* EL050.cbl
 12167              END-IF
 12168           END-IF
 12169        END-IF
 12170        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12171           AND ZEROS
 12172           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12173           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12174           SET ELAPSED-BETWEEN-BIN TO TRUE
 12175           PERFORM 8500-DATE-CONVERT
 12176                                 THRU 8500-EXIT
 12177           IF NO-CONVERSION-ERROR
 12178              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12179                 MOVE ER-2669       TO WS-ERROR
 12180*                PERFORM 9900-ERROR-FORMAT
 12181*                                THRU 9900-EXIT
 12182              END-IF
 12183           END-IF
 12184        ELSE
 12185           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12186             (PB-I-LF-TERM / 12)
 12187           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12188              MOVE ER-2669       TO WS-ERROR
 12189*             PERFORM 9900-ERROR-FORMAT
 12190*                                THRU 9900-EXIT
 12191           ELSE
 12192              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12193                 MOVE ER-1571    TO WS-ERROR
 12194                 PERFORM 9900-ERROR-FORMAT
 12195                                 THRU 9900-EXIT
 12196              END-IF
 12197           END-IF
 12198        END-IF
 12199        IF WS-ERROR = ER-2669
 12200           PERFORM 9900-ERROR-FORMAT
 12201                                 THRU 9900-EXIT
 12202        END-IF
 12203     END-IF
 12204     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12205        (PB-I-AH-TERM NOT = ZERO) AND
 12206         NOT NO-AH-COVERAGE
 12207          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12208             AND (PB-COMPANY-ID = 'DCC')
 12209             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12210             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12211          ELSE
 12212             IF WS-LF-EARNINGS-CALC = '4'
 12213                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12214                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12215                PB-I-PAY-FREQUENCY
 12216             ELSE
 12217                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12218                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12219             END-IF
 12220          END-IF
 12221          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12222                                         DC-ODD-DAYS-OVER
 12223          MOVE 1                      TO DC-END-OF-MONTH
 12224          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 223
* EL050.cbl
 12225*         MOVE 6                      TO DC-OPTION-CODE
 12226          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12227          IF NO-CONVERSION-ERROR
 12228             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12229     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12230        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12231        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12232        IF PB-I-BIRTHDAY > LOW-VALUES
 12233           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12234           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12235           SET ELAPSED-BETWEEN-BIN TO TRUE
 12236           PERFORM 8500-DATE-CONVERT
 12237                                 THRU 8500-EXIT
 12238           IF NO-CONVERSION-ERROR
 12239              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12240                 MOVE ER-3054       TO WS-ERROR
 12241*                PERFORM 9900-ERROR-FORMAT
 12242*                                THRU 9900-EXIT
 12243              END-IF
 12244           END-IF
 12245        ELSE
 12246           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12247           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12248              MOVE ER-3054       TO WS-ERROR
 12249*             PERFORM 9900-ERROR-FORMAT
 12250*                                THRU 9900-EXIT
 12251           END-IF
 12252        END-IF
 12253        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12254           AND ZEROS
 12255           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12256           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12257           SET ELAPSED-BETWEEN-BIN TO TRUE
 12258           PERFORM 8500-DATE-CONVERT
 12259                                 THRU 8500-EXIT
 12260           IF NO-CONVERSION-ERROR
 12261              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12262                 MOVE ER-3054       TO WS-ERROR
 12263*                PERFORM 9900-ERROR-FORMAT
 12264*                                THRU 9900-EXIT
 12265              END-IF
 12266           END-IF
 12267        ELSE
 12268           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12269             (PB-I-AH-TERM / 12)
 12270           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12271              MOVE ER-3054       TO WS-ERROR
 12272*             PERFORM 9900-ERROR-FORMAT
 12273*                                THRU 9900-EXIT
 12274           END-IF
 12275        END-IF
 12276        IF WS-ERROR = ER-3054
 12277           PERFORM 9900-ERROR-FORMAT
 12278                                 THRU 9900-EXIT
 12279        END-IF
 12280     END-IF
 12281     MOVE SPACE                       TO DC-END-OF-MONTH.
 12282
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 224
* EL050.cbl
 12283     IF PB-COMPANY-ID = 'NCB'
 12284        GO TO 3040-EDIT-EXTENSION-DAYS.
 12285
 12286     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12287       AND
 12288        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12289        NEXT SENTENCE
 12290     ELSE
 12291        GO TO 3040-EDIT-EXTENSION-DAYS.
 12292
 12293     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12294        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12295        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12296     ELSE
 12297        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12298        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12299
 12300     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12301*    MOVE '1'      TO DC-OPTION-CODE
 12302     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12303     IF (NO-CONVERSION-ERROR)
 12304        AND (DC-ELAPSED-MONTHS > +1)
 12305        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12306        MOVE ER-2668   TO WS-ERROR
 12307        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12308
 12309 3040-EDIT-EXTENSION-DAYS.
 12310
 12311     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12312        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12313         GO TO 3050-EDIT-TERM-IN-DAYS
 12314     ELSE
 12315         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12316
 12317     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12318         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12319     ELSE
 12320        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12321           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12322           MOVE ER-2681         TO WS-ERROR
 12323           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12324
 12325     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12326        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12327        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12328         GO TO 3060-ORIG-TERM-CHECK.
 12329
 12330     GO TO 3060-ORIG-TERM-CHECK.
 12331
 12332 3050-EDIT-TERM-IN-DAYS.
 12333
 12334     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12335
 12336     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12337         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12338     ELSE
 12339         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12340            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 225
* EL050.cbl
 12341            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12342
 12343     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12344                                       REMAINDER WS-WORK-TERM.
 12345     IF WS-WORK-TERM GREATER THAN ZERO
 12346         ADD +1 TO PB-I-LF-TERM.
 12347
 12348     IF NOT NO-AH-COVERAGE
 12349         MOVE ER-2684            TO WS-ERROR
 12350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12351
 12352
 12353 3060-ORIG-TERM-CHECK.
 12354
 12355******************************************************************
 12356*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12357******************************************************************
 12358
 12359     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12360        NEXT SENTENCE
 12361     ELSE
 12362        IF NOT NO-LIFE-COVERAGE
 12363           IF PB-I-LF-TERM NUMERIC
 12364              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12365              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12366              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12367                  NEXT SENTENCE
 12368           ELSE
 12369              MOVE ER-2647       TO WS-ERROR
 12370              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12371
 12372     IF NOT NO-AH-COVERAGE
 12373         IF PB-I-AH-TERM NUMERIC
 12374            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12375            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12376            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12377             NEXT SENTENCE
 12378          ELSE
 12379              MOVE ER-2658       TO WS-ERROR
 12380              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12381
 12382     IF PB-COMPANY-ID = 'NCB'
 12383        GO TO 3070-LOAN-TERM-CHECK.
 12384
 12385     IF POLICY-HAS-AH
 12386       AND
 12387        POLICY-HAS-LIFE
 12388       AND
 12389        PB-I-LF-TERM NUMERIC
 12390       AND
 12391        PB-I-AH-TERM NUMERIC
 12392        NEXT SENTENCE
 12393     ELSE
 12394        GO TO 3070-LOAN-TERM-CHECK.
 12395
 12396     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12397     IF WS-TEX-FACT-2 LESS THAN +0
 12398        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 226
* EL050.cbl
 12399
 12400     IF WS-TEX-FACT-2 GREATER THAN +1
 12401        MOVE ER-2668             TO WS-ERROR
 12402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12403
 12404 3070-LOAN-TERM-CHECK.
 12405
 12406     IF (WS-LF-BENEFIT-CD = ZERO)
 12407         OR (NO-LF-BENEFIT-MATCH)
 12408            GO TO 3125-EDIT-PMT-FREQ.
 12409*    IF PB-COMPANY-ID NOT = 'DCC'
 12410*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12411*          AND 'V' AND 'W' AND 'X'
 12412*          GO TO 3125-EDIT-PMT-FREQ
 12413*       END-IF
 12414*    ELSE
 12415*       IF WS-AH-DCC-TRUNC = 'T'
 12416*          CONTINUE
 12417*       ELSE
 12418*          GO TO 3125-EDIT-PMT-FREQ
 12419*       END-IF
 12420*    END-IF
 12421     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12422                    OR
 12423        ((PB-COMPANY-ID = 'DCC')
 12424        AND (WS-AH-DCC-TRUNC = 'T'))
 12425        CONTINUE
 12426     ELSE
 12427        GO TO 3125-EDIT-PMT-FREQ
 12428     END-IF
 12429     IF PB-I-LOAN-TERM NOT NUMERIC
 12430         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12431
 12432     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12433        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12434*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12435        PB-I-LOAN-TERM NOT GREATER THAN +360
 12436         NEXT SENTENCE
 12437     ELSE
 12438         MOVE ER-2648            TO WS-ERROR
 12439         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12440
 12441     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12442        MOVE ER-3058             TO WS-ERROR
 12443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12444     end-if
 12445
 12446     IF WS-STATE-ABBREVIATION = 'NC'
 12447        IF PB-I-LOAN-TERM > +59
 12448           CONTINUE
 12449        ELSE
 12450           MOVE ER-2792          TO WS-ERROR
 12451           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12452        END-IF
 12453     END-IF
 12454
 12455     .
 12456 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 227
* EL050.cbl
 12457     IF (WS-LF-BENEFIT-CD = ZERO)
 12458         OR (NO-LF-BENEFIT-MATCH)
 12459            GO TO 3127-EDIT-LOAN-OFFICER.
 12460     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12461                    OR
 12462        ((PB-COMPANY-ID = 'DCC')
 12463        AND (WS-AH-DCC-TRUNC = 'T'))
 12464                    OR
 12465         (PB-COMPANY-ID = 'AHL')
 12466        CONTINUE
 12467     ELSE
 12468        IF (PB-I-LOAN-TERM > ZEROS)
 12469           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12470           MOVE ER-1575          TO WS-ERROR
 12471           PERFORM 9900-ERROR-FORMAT
 12472                                 THRU 9900-EXIT
 12473        END-IF
 12474     END-IF
 12475     IF WS-LF-EARNINGS-CALC NOT = '4'
 12476         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12477            MOVE ER-2653         TO WS-ERROR
 12478            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12479            GO TO 3127-EDIT-LOAN-OFFICER
 12480         ELSE
 12481            GO TO 3127-EDIT-LOAN-OFFICER.
 12482
 12483     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12484         MOVE ER-2655            TO WS-ERROR
 12485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12486         GO TO 3127-EDIT-LOAN-OFFICER.
 12487
 12488     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12489         MOVE ER-2654            TO WS-ERROR
 12490         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12491         GO TO 3127-EDIT-LOAN-OFFICER.
 12492
 12493     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12494         GIVING WS-TEX-FACT-2
 12495             REMAINDER WS-TEX-FACT-3.
 12496
 12497*    IF WS-TEX-FACT-3 NOT = ZERO
 12498*       MOVE ER-2654             TO WS-ERROR
 12499*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12500
 12501
 12502 3127-EDIT-LOAN-OFFICER.
 12503
 12504     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12505        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12506           MOVE ER-2690          TO WS-ERROR
 12507           PERFORM 9900-ERROR-FORMAT
 12508                                 THRU 9900-EXIT
 12509        ELSE
 12510           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12511           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12512           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12513           MOVE PB-SV-STATE      TO LOFC-STATE
 12514           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 228
* EL050.cbl
 12515           MOVE PB-I-LOAN-OFFICER
 12516                                 TO LOFC-CODE
 12517           PERFORM 8586-READ-LOAN-OFFICER
 12518                                 THRU 8586-EXIT
 12519           IF (NOT LOFC-MASTER-FOUND)
 12520              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12521              MOVE ER-3006       TO WS-ERROR
 12522              PERFORM 9900-ERROR-FORMAT
 12523                                 THRU 9900-EXIT
 12524           END-IF
 12525        END-IF
 12526     END-IF
 12527     .
 12528 3129-EDIT-APR.
 12529
 12530     IF (WS-LF-BENEFIT-CD = ZERO)
 12531        OR (NO-LF-BENEFIT-MATCH)
 12532        IF PB-COMPANY-ID NOT = 'DCC'
 12533           GO TO 3130-EDIT-AGE
 12534*       ELSE
 12535*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12536*             GO TO 3130-EDIT-AGE
 12537*          END-IF
 12538        END-IF
 12539     END-IF
 12540
 12541     IF (WS-STATE-ABBREVIATION = 'OH')
 12542         AND (PB-I-RATE-CLASS NOT = 'L ')
 12543         AND (PB-I-LF-TERM GREATER THAN 60)
 12544         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12545         GO TO 3129-APR-CONT.
 12546
 12547     IF (WS-STATE-ABBREVIATION = 'RI')
 12548         AND (PB-I-LF-TERM GREATER THAN 60)
 12549         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12550         GO TO 3129-APR-CONT.
 12551
 12552     IF (WS-STATE-ABBREVIATION = 'UT')
 12553         AND (PB-I-LF-TERM GREATER THAN 62)
 12554         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12555         AND (PB-CERT-EFF-DT LESS WS-830901)
 12556         GO TO 3129-APR-CONT.
 12557
 12558     IF PB-COMPANY-ID = 'LAP'
 12559        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12560           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12561              MOVE ER-2656         TO WS-ERROR
 12562              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12563              GO TO 3130-EDIT-AGE.
 12564
 12565     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12566        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12567        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12568        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12569        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12570        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12571         GO TO 3130-EDIT-AGE.
 12572
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 229
* EL050.cbl
 12573 3129-APR-CONT.
 12574     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12575         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12576         GO TO 3130-EDIT-AGE.
 12577
 12578     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12579         WS-AH-BENEFIT-CD (1:1) = 'S')
 12580        AND (PB-COMPANY-ID = 'DCC')
 12581        AND (PB-I-LOAN-APR = ZERO)
 12582        MOVE ER-2657             TO WS-ERROR
 12583        PERFORM 9900-ERROR-FORMAT
 12584                                 THRU 9900-EXIT
 12585        GO TO 3130-EDIT-AGE
 12586     END-IF
 12587*    IF PB-I-LOAN-APR = ZERO
 12588*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12589*    END-IF
 12590
 12591     if pb-i-loan-apr = +99.9999
 12592        move er-2656             to ws-error
 12593        PERFORM 9900-ERROR-FORMAT
 12594                                 THRU 9900-EXIT
 12595        GO TO 3130-EDIT-AGE
 12596     end-if
 12597*    IF PB-I-LOAN-APR = ZERO
 12598*       MOVE ER-2656             TO WS-ERROR
 12599*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12600*       GO TO 3130-EDIT-AGE.
 12601
 12602*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12603     if pb-i-loan-apr not = +99.9999
 12604        IF PB-I-LOAN-APR > +30.000
 12605           MOVE ER-2657          TO WS-ERROR
 12606           PERFORM 9900-ERROR-FORMAT
 12607                                 THRU 9900-EXIT
 12608        end-if
 12609     end-if
 12610     .
 12611 3130-EDIT-AGE.
 12612
 12613******************************************************************
 12614*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12615******************************************************************
 12616
 12617     IF NOT NO-LIFE-COVERAGE
 12618        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12619           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12620               MOVE ER-2628             TO WS-ERROR
 12621               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12622
 12623     IF NOT NO-AH-COVERAGE
 12624        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12625           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12626               MOVE ER-2628         TO WS-ERROR
 12627               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12628
 12629 3133-SEX-CODE.
 12630     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 230
* EL050.cbl
 12631         IF WS-DEFAULT-SEX = 'M'
 12632             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12633          ELSE
 12634             IF WS-DEFAULT-SEX = 'F'
 12635             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12636
 12637     IF PB-I-INSURED-SEX = '1'
 12638         MOVE 'M' TO PB-I-INSURED-SEX.
 12639
 12640     IF PB-I-INSURED-SEX = '2'
 12641         MOVE 'F' TO PB-I-INSURED-SEX.
 12642
 12643 3134-SIG-SW-EDIT.
 12644     IF PB-I-SIG-SW = SPACE
 12645         MOVE 'N'                TO  PB-I-SIG-SW.
 12646
 12647     IF PB-COMPANY-ID = 'NCL'
 12648         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12649             NEXT SENTENCE
 12650         ELSE
 12651             MOVE ER-1923        TO  WS-ERROR
 12652             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12653     ELSE
 12654     IF PB-COMPANY-ID = 'CRI'
 12655         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12656             NEXT SENTENCE
 12657         ELSE
 12658             MOVE ER-2606        TO  WS-ERROR
 12659             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12660     ELSE
 12661     IF PB-COMPANY-ID = 'TMS'
 12662         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12663             NEXT SENTENCE
 12664         ELSE
 12665             MOVE ER-2689        TO  WS-ERROR
 12666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12667     ELSE
 12668         IF PB-I-SIG-SW = 'Y' OR 'N'
 12669             NEXT SENTENCE
 12670         ELSE
 12671             MOVE ER-2651        TO  WS-ERROR
 12672             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12673
 12674     IF PB-COMPANY-ID = 'FLA'
 12675         IF (WS-EDIT-AGE GREATER 54  OR
 12676             WS-AH-EDIT-AGE GREATER 54)  AND
 12677            PB-I-SIG-SW = 'N'
 12678            MOVE ER-2651         TO  WS-ERROR
 12679            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12680
 12681 3135-NAME-EDIT.
 12682
 12683     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12684        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12685        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12686           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12687                                 TO PB-I-JOINT-FIRST-NAME
 12688        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 231
* EL050.cbl
 12689     END-IF
 12690     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12691        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12692        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12693           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12694                                 TO PB-I-JOINT-LAST-NAME
 12695        END-PERFORM
 12696     END-IF
 12697     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12698        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12699        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12700           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12701                                 TO PB-I-INSURED-FIRST-NAME
 12702        END-PERFORM
 12703     END-IF
 12704     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12705        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12706        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12707           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12708                                 TO PB-I-INSURED-LAST-NAME
 12709        END-PERFORM
 12710     END-IF
 12711     IF PB-I-INSURED-LAST-NAME = SPACES
 12712       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12713       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12714           MOVE ER-2660    TO WS-ERROR
 12715           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12716
 12717 3136-EDIT-SEX.
 12718
 12719******************************************************************
 12720*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12721******************************************************************
 12722
 12723     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12724        (WS-AH-SPECIAL-CALC-CD = 'O')
 12725        NEXT SENTENCE
 12726     ELSE
 12727        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12728           NEXT SENTENCE
 12729        ELSE
 12730           MOVE ER-2629            TO WS-ERROR
 12731           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12732
 12733 3137-EDIT-EFF-DATE.
 12734
 12735     IF PB-REISSUED-CERT       OR
 12736        PB-POLICY-IS-DECLINED  OR
 12737        PB-POLICY-IS-VOIDED
 12738         GO TO 3139-EDIT-COVERAGE-CODES.
 12739
 12740     MOVE SPACE                  TO WS-2671-SW
 12741                                    WS-2672-SW.
 12742
 12743     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12744         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12745             MOVE ER-2703        TO WS-ERROR
 12746             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 232
* EL050.cbl
 12747             GO TO 3139-EDIT-COVERAGE-CODES.
 12748
 12749     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12750         GO TO 3139-EDIT-COVERAGE-CODES.
 12751
 12752     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12753     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12754*    MOVE '1'                    TO DC-OPTION-CODE.
 12755     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12756     MOVE +0                     TO DC-ELAPSED-MONTHS
 12757                                    DC-ELAPSED-DAYS.
 12758     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12759
 12760     IF DATE-CONVERSION-ERROR
 12761         GO TO 3139-EDIT-COVERAGE-CODES.
 12762
 12763     IF DC-ELAPSED-DAYS GREATER +180
 12764         MOVE ER-2672            TO WS-ERROR
 12765         MOVE 'Y'                TO WS-2672-SW
 12766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12767     END-IF
 12768
 12769     IF WS-ERROR = ER-2671  AND
 12770        PB-COMPANY-ID  = 'LBL'
 12771        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12772        MOVE SPACE               TO WS-2671-SW
 12773        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12774
 12775     IF PB-ISSUE-DATE-FORCED  AND
 12776      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12777         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12778         MOVE ER-2673            TO WS-ERROR
 12779         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12780         MOVE SPACE              TO WS-2671-SW
 12781                                    WS-2672-SW.
 12782
 12783     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12784         IF PB-ISSUE-DATE-FORCED
 12785             MOVE ER-2600          TO  WS-ERROR
 12786             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12787         ELSE
 12788             MOVE ER-2692          TO  WS-ERROR
 12789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12790
 12791
 12792 3139-EDIT-COVERAGE-CODES.
 12793
 12794     if pb-company-id not = 'AHL'
 12795        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12796           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12797           MOVE ER-2787          TO WS-ERROR
 12798           PERFORM 9900-ERROR-FORMAT
 12799                                 THRU 9900-EXIT
 12800        END-IF
 12801     end-if
 12802     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12803        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12804                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 233
* EL050.cbl
 12805           MOVE ER-2719          TO WS-ERROR
 12806           PERFORM 9900-ERROR-FORMAT
 12807                                 THRU 9900-EXIT
 12808        END-IF
 12809     END-IF
 12810
 12811     IF PB-POLICY-IS-DECLINED  OR
 12812        PB-POLICY-IS-VOIDED
 12813         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12814
 12815     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12816        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12817         MOVE ER-2630                TO WS-ERROR
 12818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12819
 12820     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12821        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12822        PB-I-LF-PREMIUM-AMT = ZERO
 12823         GO TO 3140-CHECK-AH-FOR-ZERO.
 12824
 12825     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12826        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12827        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12828         GO TO 3140-CHECK-AH-FOR-ZERO.
 12829
 12830     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12831        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12832        MOVE ER-2631             TO WS-ERROR
 12833        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12834     END-IF
 12835
 12836
 12837******************************************************************
 12838*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12839******************************************************************
 12840
 12841     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12842        NEXT SENTENCE
 12843     ELSE
 12844        IF PB-I-LF-BENEFIT-AMT = ZERO
 12845           MOVE ER-2632             TO WS-ERROR
 12846           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12847
 12848
 12849******************************************************************
 12850*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12851******************************************************************
 12852
 12853     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12854        CONTINUE
 12855     ELSE
 12856        IF PB-I-LF-PREMIUM-AMT = ZERO
 12857           IF (NOT PB-COMP-LF-PREM)
 12858              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12859              MOVE ER-2633       TO WS-ERROR
 12860              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12861           END-IF
 12862        END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 234
* EL050.cbl
 12863     END-IF
 12864     .
 12865 3140-CHECK-AH-FOR-ZERO.
 12866
 12867     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12868        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12869        PB-I-AH-PREMIUM-AMT = ZERO
 12870         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12871
 12872     IF PB-COMPANY-ID = 'CSL'  AND
 12873        PB-I-AH-BENEFIT-CD = ZERO  AND
 12874        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12875        PB-I-AH-PREMIUM-AMT = ZERO
 12876         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12877
 12878     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12879        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12880        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12881         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12882
 12883     IF PB-I-AH-BENEFIT-CD = ZERO
 12884         MOVE ER-2634            TO WS-ERROR
 12885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12886
 12887******************************************************************
 12888*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12889******************************************************************
 12890
 12891     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12892        NEXT SENTENCE
 12893     ELSE
 12894        IF PB-I-AH-BENEFIT-AMT = ZERO
 12895           MOVE ER-2635             TO WS-ERROR
 12896           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12897
 12898******************************************************************
 12899*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12900******************************************************************
 12901
 12902     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12903        NEXT SENTENCE
 12904     ELSE
 12905        IF PB-I-AH-PREMIUM-AMT = ZERO
 12906            IF NOT PB-COMP-AH-PREM
 12907                MOVE ER-2636    TO WS-ERROR
 12908                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12909
 12910
 12911 3140-EDIT-MAX-AMT-SIZES.
 12912* CUSTOM CODE FOR CLIENT    'DMD'
 12913     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12914                                     WS-RES-MUNI-TAX
 12915                                     PB-I-STATE-TAX
 12916                                     PB-I-MUNI-TAX.
 12917
 12918     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12919
 12920     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 235
* EL050.cbl
 12921        GO TO 3150-RATE-OUTSTAND-BAL.
 12922
 12923     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12924        GO TO 3150-RATE-OUTSTAND-BAL.
 12925
 12926     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12927        GO TO 3150-RATE-OUTSTAND-BAL.
 12928
 12929     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12930                             OR 'RIC')
 12931        GO TO 3150-RATE-OUTSTAND-BAL.
 12932
 12933     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12934        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12935            GO TO 3150-RATE-OUTSTAND-BAL
 12936        ELSE
 12937           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12938               GO TO 3150-RATE-OUTSTAND-BAL.
 12939
 12940     IF NOT PB-NO-MONTHS-SKIPPED
 12941        GO TO 3150-RATE-OUTSTAND-BAL.
 12942
 12943     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12944        GO TO 3150-RATE-OUTSTAND-BAL.
 12945
 12946     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12947        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12948           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12949             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12950           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12951           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12952              MOVE ER-2693     TO WS-ERROR
 12953              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12954              GO TO 3150-RATE-OUTSTAND-BAL
 12955           ELSE
 12956              GO TO 3150-RATE-OUTSTAND-BAL.
 12957
 12958 3150-RATE-OUTSTAND-BAL.
 12959
 12960* DMD RATING TEST
 12961     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12962         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12963         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12964         MOVE ER-2687                 TO WS-ERROR
 12965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12966         MOVE 'B'                     TO PB-I-OB-FLAG
 12967         GO TO 3260-EDIT-CONTINUE.
 12968
 12969     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12970         IF  WS-ERROR    EQUAL    ER-2693
 12971             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12972                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12973                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12974                 MOVE  +0            TO  WS-ERROR.
 12975
 12976     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12977         IF  WS-ERROR    EQUAL    ER-2693
 12978             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 236
* EL050.cbl
 12979                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12980                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12981                 MOVE  +0            TO  WS-ERROR.
 12982
 12983     IF PLAN-MASTER-AH-SW = 'Y'
 12984        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12985            IF  WS-ERROR    EQUAL    ER-2693
 12986              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12987                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12988                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12989                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12990                 MOVE  ER-1910           TO  WS-ERROR
 12991                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12992
 12993     IF PLAN-MASTER-AH-SW = 'Y'
 12994        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12995            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12996               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12997               MOVE  ER-1910           TO  WS-ERROR
 12998               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12999
 13000     IF PLAN-MASTER-AH-SW = 'Y'
 13001        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13002            IF  WS-ERROR    EQUAL    ER-2693
 13003                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13004                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13005                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13006                 MOVE  +0       TO  WS-ERROR.
 13007
 13008     IF WS-ERROR = ER-2693
 13009        IF PB-COMPANY-ID = 'JAL' AND
 13010           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13011           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13012           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13013
 13014     IF WS-ERROR = ER-2693
 13015        IF PB-COMPANY-ID = 'NCL'  AND
 13016           PB-I-AH-BENEFIT-CD = 'OA'
 13017           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13018           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13019
 13020     IF WS-ERROR = ER-2693
 13021        IF PB-COMPANY-ID = 'CNL' AND
 13022           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13023           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13024           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13025
 13026     IF WS-ERROR = ER-2693
 13027        IF PB-COMPANY-ID = 'HER'
 13028           IF WS-LEVEL
 13029              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13030              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13031
 13032     IF ((LF-BENEFIT-FOUND) AND
 13033         (NOT NO-LIFE-COVERAGE)  AND
 13034         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13035       OR   ((AH-BENEFIT-FOUND) AND
 13036             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 237
* EL050.cbl
 13037             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13038         NEXT SENTENCE
 13039     ELSE
 13040         GO TO 3215-EDIT-RATES.
 13041
 13042     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13043        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13044           MOVE ER-2674          TO WS-ERROR
 13045           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13046           GO TO 3215-EDIT-RATES.
 13047
 13048     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13049        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13050           MOVE ER-2674          TO WS-ERROR
 13051           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13052           GO TO 3215-EDIT-RATES.
 13053
 13054     MOVE 'B'                    TO PB-I-OB-FLAG.
 13055
 13056     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13057         NEXT SENTENCE
 13058     ELSE
 13059         IF NOT NO-LIFE-COVERAGE
 13060             IF WS-ACCT-LF-OB-RT = ZERO
 13061                MOVE ER-2641    TO WS-ERROR
 13062                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13063
 13064     IF PB-COMPANY-ID = 'CRI'
 13065       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13066         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13067         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13068         IF WS-ERROR = ER-2675
 13069            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13070            MOVE ER-2687              TO WS-ERROR
 13071            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13072         ELSE
 13073            MOVE ER-2687              TO WS-ERROR
 13074            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13075
 13076
 13077     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13078         NEXT SENTENCE
 13079     ELSE
 13080       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13081            NEXT SENTENCE
 13082       ELSE
 13083         IF NOT NO-AH-COVERAGE
 13084             IF WS-ACCT-AH-OB-RT = ZERO
 13085                MOVE ER-2642    TO WS-ERROR
 13086                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13087
 13088     IF PB-COMPANY-ID = 'CRI'
 13089       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13090         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13091         IF WS-ERROR = ER-2676
 13092            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13093            MOVE ER-2687              TO WS-ERROR
 13094            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 238
* EL050.cbl
 13095         ELSE
 13096            MOVE ER-2687              TO WS-ERROR
 13097            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13098
 13099     IF PB-COMPANY-ID NOT = 'GIC'
 13100         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13101            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13102     ELSE
 13103         IF PB-I-LF-PREM-CALC = ZEROS
 13104             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13105                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13106
 13107     IF PB-COMPANY-ID NOT = 'GIC'
 13108         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13109            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13110     ELSE
 13111         IF PB-I-AH-PREM-CALC = ZEROS
 13112             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13113                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13114
 13115     MOVE ZEROS TO PB-I-MORT-CODE.
 13116
 13117     GO TO 3260-EDIT-CONTINUE.
 13118
 13119
 13120 3215-EDIT-RATES.
 13121     IF ACCOUNT-MAST-FOUND
 13122         NEXT SENTENCE
 13123     ELSE
 13124         GO TO 3999-END-EDIT.
 13125
 13126 3220-CHECK-LF-RATES.
 13127
 13128     IF PB-COMPANY-ID = 'DCC'
 13129        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13130        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13131        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13132           AND (NOT WS-LF-CASH))
 13133                           OR
 13134           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13135           AND (NOT WS-AH-CASH)))
 13136                       AND
 13137           (PB-I-ENTRY-STATUS NOT = '5')
 13138           MOVE 'M'              TO PB-BATCH-ENTRY
 13139                                    PB-I-ENTRY-STATUS
 13140        END-IF
 13141     END-IF
 13142     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13143                                    PB-I-AH-PREM-CALC
 13144                                    PB-I-LF-ALT-PREM-CALC
 13145                                    PB-I-LF-ALT-RATE
 13146                                    PB-I-LF-REI-RATE
 13147                                    PB-I-LF-ALT-REI-RATE
 13148                                    PB-I-AH-REI-RATE
 13149                                    PB-I-TOT-FEES-CALC.
 13150
 13151     IF PB-COMPANY-ID EQUAL 'DMD'
 13152        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 239
* EL050.cbl
 13153     ELSE
 13154        MOVE ZEROS               TO PB-I-LF-RATE
 13155                                    PB-I-AH-RATE.
 13156
 13157     IF PB-I-TOT-FEES NOT NUMERIC
 13158        MOVE ZEROS               TO PB-I-TOT-FEES
 13159     END-IF
 13160     IF PB-I-LIVES NOT NUMERIC
 13161         MOVE ZERO               TO PB-I-LIVES.
 13162
 13163     IF PB-I-NUM-BILLED NOT NUMERIC
 13164         MOVE ZERO               TO PB-I-NUM-BILLED.
 13165
 13166     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13167        MOVE +0                  TO PB-I-LF-PREM-TAX
 13168     END-IF
 13169
 13170     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13171        MOVE +0                  TO PB-I-AH-PREM-TAX
 13172     END-IF
 13173
 13174     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13175        PB-I-PAY-FREQUENCY = ZEROS
 13176            MOVE 12 TO CP-PAY-FREQUENCY
 13177     ELSE
 13178            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13179
 13180     IF PB-I-STATE-TAX NOT NUMERIC
 13181         MOVE ZEROS               TO PB-I-STATE-TAX.
 13182
 13183     IF PB-I-MUNI-TAX NOT NUMERIC
 13184         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13185
 13186     MOVE SPACES                 TO CP-BEN-CATEGORY
 13187     IF PB-COMPANY-ID  = 'CSL'  AND
 13188        PB-I-LF-TERM NOT = ZERO
 13189        COMPUTE WS-PAYMENT-AMT =
 13190             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13191        COMPUTE WS-CSL-AMT1 =
 13192             PB-I-LF-TERM * AM-MAX-MON-BEN
 13193        COMPUTE WS-CSL-AMT2 =
 13194             WS-PAYMENT-AMT * PB-I-LF-TERM
 13195        IF CP-PAY-FREQUENCY NOT = 12
 13196           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13197           MOVE '8' TO WS-CSL-CALC-CD
 13198        ELSE
 13199           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13200              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13201               AM-MAX-TOT-BEN
 13202               MOVE '6' TO WS-CSL-CALC-CD
 13203           ELSE
 13204              IF (WS-CSL-AMT1  GREATER THAN
 13205                 AM-MAX-TOT-BEN) AND
 13206                 (WS-CSL-AMT2  GREATER THAN
 13207                 AM-MAX-TOT-BEN)
 13208                 MOVE '7' TO WS-CSL-CALC-CD
 13209              ELSE
 13210                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 240
* EL050.cbl
 13211
 13212     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13213         NEXT SENTENCE
 13214     ELSE
 13215         GO TO 3300-CHECK-AH-RATES.
 13216
 13217*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13218
 13219     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13220        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13221              OR
 13222           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13223           MOVE ER-2618          TO WS-ERROR
 13224           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13225           GO TO 3300-CHECK-AH-RATES.
 13226
 13227     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13228           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13229                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13230
 13231     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13232         MOVE ER-2687             TO WS-ERROR
 13233         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13234         MOVE 'Z000'              TO PB-I-MORT-CODE
 13235         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13236         GO TO 3300-CHECK-AH-RATES.
 13237
 13238     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13239        IF PB-I-LIVES = ZERO
 13240           MOVE ER-2688          TO WS-ERROR
 13241           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13242
 13243     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13244
 13245     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13246     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13247     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13248     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13249     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13250     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13251     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13252     MOVE '3'                    TO CP-PROCESS-TYPE.
 13253     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13254     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13255
 13256******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13257     IF PB-COMPANY-ID EQUAL 'CDL'
 13258         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13259            CP-EARN-AS-NET-PAY)
 13260             IF PB-CERT-EFF-DT GREATER  WS-931231
 13261                 MOVE '1'        TO CP-EARNING-METHOD.
 13262*******
 13263
 13264     MOVE PB-SV-STATE            TO CP-STATE.
 13265     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13266     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13267     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13268     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 241
* EL050.cbl
 13269     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13270                                    CP-RATING-BENEFIT-AMT.
 13271     IF CP-STATE-STD-ABBRV = 'OR'
 13272         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13273                                         PB-I-LF-ALT-BENEFIT-AMT.
 13274     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13275     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13276     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13277     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13278     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13279     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13280     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13281     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13282     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13283                                    CP-REMAINING-TERM
 13284                                    CP-LOAN-TERM.
 13285
 13286     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13287         NEXT SENTENCE
 13288     ELSE
 13289         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13290             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13291                                           PB-I-LF-PREMIUM-AMT.
 13292
 13293     IF PB-COMPANY-ID EQUAL 'CSL'
 13294        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13295           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13296                                         PB-I-LF-PREMIUM-AMT.
 13297
 13298     IF PB-COMPANY-ID EQUAL 'NCB'
 13299         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13300            CP-EARN-AS-NET-PAY
 13301             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13302                 PB-I-LF-PREMIUM-AMT.
 13303
 13304     IF (CP-TRUNCATED-LIFE)
 13305        or ((pb-company-id = 'AHL')
 13306           and (pb-i-loan-term > pb-i-lf-term))
 13307        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13308
 13309     IF PB-COMPANY-ID EQUAL 'CRI'
 13310        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13311
 13312     IF CP-TERM-IS-DAYS
 13313         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13314     ELSE
 13315         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13316     IF PB-COMPANY-ID = 'DCC'
 13317        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13318        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13319        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13320        IF WS-LF-BEN-CATEGORY = 'D'
 13321           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13322           MOVE PB-I-LIFE-COMMISSION
 13323                                 TO CP-DCC-ACT-COMM
 13324           MOVE WS-LF-BEN-CATEGORY
 13325                                 TO CP-BEN-CATEGORY
 13326        END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 242
* EL050.cbl
 13327        IF (CP-BENEFIT-CD (1:1) = 'P')
 13328           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13329           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13330           add pb-i-ah-premium-amt to cp-original-premium
 13331        END-IF
 13332     END-IF
 13333     IF PB-COMPANY-ID = 'CSL'
 13334         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13335         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13336         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13337
 13338     IF PB-COMPANY-ID = 'CSL'
 13339        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13340
 13341     IF (CP-SPECIAL-CALC-CD = 'H')
 13342        OR (PB-COMPANY-ID = 'DCC')
 13343         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13344                                    TO CP-ALTERNATE-BENEFIT
 13345         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13346
 13347     IF (PB-COMPANY-ID = 'CID')
 13348        AND (WS-LF-EARNINGS-CALC = 'B')
 13349        AND (CP-STATE-STD-ABBRV = 'MN')
 13350        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13351                                 TO CP-ALTERNATE-BENEFIT
 13352        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13353     END-IF
 13354     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13355     MOVE 'R'                   TO CP-RATE-FILE.
 13356     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13357
 13358     IF CP-ERROR-RATE-NOT-FOUND
 13359        MOVE ER-2641            TO WS-ERROR
 13360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13361        GO TO 3300-CHECK-AH-RATES.
 13362
 13363     IF PB-COMPANY-ID EQUAL 'CRI'
 13364        IF CP-ERROR-NO-LIMITS-CRI
 13365           IF NOT ACCOUNT-LIFE-CHECKED
 13366              MOVE ER-2607      TO WS-ERROR
 13367              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13368
 13369******************************************************************
 13370*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13371*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13372******************************************************************
 13373
 13374* CALC LIFE AGE AT EXPIRATION.
 13375
 13376     COMPUTE WS-AGE-AT-EXPIRE =
 13377          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13378
 13379*    IF PB-STATE = 'CO' OR 'UT'
 13380*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13381*        MOVE 'F'            TO PB-FATAL-FLAG
 13382*        MOVE ER-2709        TO WS-ERROR
 13383*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13384*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 243
* EL050.cbl
 13385
 13386*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13387*        MOVE 'X'            TO PB-FATAL-FLAG
 13388*        MOVE ER-2718        TO WS-ERROR
 13389*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13390*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13391
 13392* CALC A & H AGE AT EXPIRATION.
 13393
 13394     COMPUTE WS-AGE-AT-EXPIRE =
 13395          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13396
 13397*    IF PB-STATE = 'CO' OR 'UT'
 13398*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13399*        MOVE 'F'            TO PB-FATAL-FLAG
 13400*        MOVE ER-2709        TO WS-ERROR
 13401*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13402*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13403
 13404*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13405*        MOVE 'X'            TO PB-FATAL-FLAG
 13406*        MOVE ER-2718        TO WS-ERROR
 13407*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13408*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13409
 13410     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13411        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13412
 13413     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13414        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13415     end-if
 13416
 13417     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13418        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13419
 13420     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13421         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13422         MOVE ER-2639        TO WS-ERROR
 13423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13424
 13425
 13426******************************************************************
 13427*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13428******************************************************************
 13429
 13430 PREMIUM-EDITING-IS-BYPASSED.
 13431     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13432        AND (CP-R-MAX-ATT-AGE > +0)
 13433        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13434        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13435           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13436           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13437           MOVE '1'              TO DC-OPTION-CODE
 13438           PERFORM 8500-DATE-CONVERT
 13439                                 THRU 8500-EXIT
 13440           IF NO-CONVERSION-ERROR
 13441              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13442                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 244
* EL050.cbl
 13443*                PERFORM 9900-ERROR-FORMAT
 13444*                                THRU 9900-EXIT
 13445              END-IF
 13446           END-IF
 13447        ELSE
 13448           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13449           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13450              MOVE ER-2661       TO WS-ERROR
 13451*             PERFORM 9900-ERROR-FORMAT
 13452*                                THRU 9900-EXIT
 13453           ELSE
 13454              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13455                 MOVE ER-1570    TO WS-ERROR
 13456                 PERFORM 9900-ERROR-FORMAT
 13457                                 THRU 9900-EXIT
 13458              END-IF
 13459           END-IF
 13460        END-IF
 13461        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13462           MOVE PB-I-JOINT-BIRTHDAY
 13463                                 TO DC-BIN-DATE-1
 13464           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13465           MOVE '1'              TO DC-OPTION-CODE
 13466           PERFORM 8500-DATE-CONVERT
 13467                                 THRU 8500-EXIT
 13468           IF NO-CONVERSION-ERROR
 13469              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13470                 MOVE ER-2661       TO WS-ERROR
 13471*                PERFORM 9900-ERROR-FORMAT
 13472*                                THRU 9900-EXIT
 13473              END-IF
 13474           ELSE
 13475              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13476           END-IF
 13477        ELSE
 13478           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13479             (PB-I-LF-TERM / 12)
 13480           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13481              MOVE ER-2661       TO WS-ERROR
 13482*             PERFORM 9900-ERROR-FORMAT
 13483*                                THRU 9900-EXIT
 13484           ELSE
 13485              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13486                 MOVE ER-1571    TO WS-ERROR
 13487                 PERFORM 9900-ERROR-FORMAT
 13488                                 THRU 9900-EXIT
 13489              END-IF
 13490           END-IF
 13491        END-IF
 13492        IF WS-ERROR = ER-2661
 13493           PERFORM 9900-ERROR-FORMAT
 13494                                 THRU 9900-EXIT
 13495        END-IF
 13496     END-IF
 13497*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13498*       MOVE ER-2661             TO WS-ERROR
 13499*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13500
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 245
* EL050.cbl
 13501     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13502        MOVE ER-2662             TO WS-ERROR
 13503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13504
 13505     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13506        MOVE ER-2677             TO WS-ERROR
 13507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13508
 13509     IF CP-ERROR-LOAN-TERM
 13510        MOVE ER-2648             TO WS-ERROR
 13511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13512
 13513 3221-CHECK-ERROR-RATE-OPEN.
 13514
 13515     IF CP-ERROR-RATE-FILE-NOTOPEN
 13516         GO TO 3990-FILES-NOT-OPEN.
 13517
 13518     IF PB-COMPANY-ID NOT = 'DMD'
 13519        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13520     END-IF
 13521     .
 13522 3221-CONTINUE.
 13523     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13524                                    WS-DCC-AH-RATE
 13525     IF PB-COMPANY-ID = 'DCC'
 13526        IF WS-LF-BEN-CATEGORY = 'D'
 13527           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13528              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13529        END-IF
 13530     END-IF
 13531     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13532*   X'A4FF' = 12/31/2009
 13533     IF (PB-COMPANY-ID = 'CID')
 13534        AND (WS-LF-EARNINGS-CALC = 'B')
 13535        AND (CP-STATE-STD-ABBRV = 'MN')
 13536        AND (PB-CERT-EFF-DT > X'A4FF')
 13537        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13538     END-IF
 13539     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13540
 13541     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13542     IF (PB-COMPANY-ID = 'DCC')
 13543        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13544        AND (PB-I-POLICY-IS-MONTHLY)
 13545        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13546        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13547     END-IF
 13548     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13549     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13550     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13551     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13552     IF (PB-COMPANY-ID = 'DCC')
 13553        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13554        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13555        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13556        MOVE ER-2786             TO WS-ERROR
 13557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13558     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 246
* EL050.cbl
 13559
 13560     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13561
 13562******************************************************************
 13563*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13564******************************************************************
 13565     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13566        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13567
 13568     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13569        GO TO 3225-CHECK-ALT-LIFE-RATE
 13570     ELSE
 13571       IF PB-I-LF-RATE = ZERO
 13572          MOVE ER-2641          TO WS-ERROR
 13573          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13574
 13575 3225-CHECK-ALT-LIFE-RATE.
 13576
 13577     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13578        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13579        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13580         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13581
 13582     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13583         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13584             AND PB-COMPANY-ID NOT = 'DCC')
 13585                   OR
 13586              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13587              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13588              AND PB-COMPANY-ID NOT = 'DCC')
 13589             MOVE ER-2720        TO  WS-ERROR
 13590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13591             GO TO 3225-RATING-CONT
 13592         ELSE
 13593             GO TO 3225-RATING-CONT.
 13594     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13595        AND (AM-GPCD = 01 OR 06 OR 15)
 13596        MOVE ER-2798             TO WS-ERROR
 13597        PERFORM 9900-ERROR-FORMAT
 13598                                 THRU 9900-EXIT
 13599*       GO TO 3225-RATING-CONT
 13600     END-IF
 13601     IF (PB-COMPANY-ID = 'CID')
 13602        AND (WS-LF-EARNINGS-CALC = 'B')
 13603        AND (CP-STATE-STD-ABBRV = 'MN')
 13604        AND (PB-CERT-EFF-DT > X'A4FF')
 13605        GO TO 3225-RATING-CONT
 13606     END-IF
 13607     IF PB-COMPANY-ID = 'DCC'
 13608        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13609           AND (PB-I-POLICY-IS-MONTHLY)
 13610           GO TO 3225-RATING-CONT
 13611        END-IF
 13612     END-IF
 13613
 13614     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13615        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13616        CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 247
* EL050.cbl
 13617        NEXT SENTENCE
 13618     ELSE
 13619        MOVE '2'                 TO CP-EARNING-METHOD.
 13620
 13621 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13622
 13623     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13624
 13625     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13626        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13627        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13628         NEXT SENTENCE
 13629     ELSE
 13630         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13631
 13632     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13633     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13634     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13635                                     CP-RATING-BENEFIT-AMT.
 13636     IF CP-STATE-STD-ABBRV = 'OR'
 13637         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13638                                         PB-I-LF-ALT-BENEFIT-AMT.
 13639     IF PB-COMPANY-ID = 'DCC'
 13640        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13641     END-IF
 13642     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13643     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13644     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13645                                    CP-REMAINING-TERM
 13646                                    CP-LOAN-TERM.
 13647     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13648        ADD +1                   TO CP-ORIGINAL-TERM
 13649                                    CP-REMAINING-TERM
 13650                                    CP-LOAN-TERM.
 13651
 13652     MOVE 'R'                   TO CP-RATE-FILE.
 13653     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13654
 13655     IF CP-ERROR-RATE-NOT-FOUND
 13656         MOVE ER-2641            TO WS-ERROR
 13657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13658         GO TO 3300-CHECK-AH-RATES.
 13659
 13660     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13661     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13662
 13663     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13664         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13665
 13666     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13667                               + PB-I-LF-ALT-BENEFIT-AMT.
 13668
 13669     IF ACCOUNT-LIFE-CHECKED  OR
 13670        PB-POLICY-IS-VOIDED   OR
 13671        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13672        GO TO 3225-CONTINUE.
 13673
 13674     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 248
* EL050.cbl
 13675        GO TO 3225-CONTINUE.
 13676
 13677     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13678                             EC-RT-LF-MAX-TOT-BEN
 13679        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13680        MOVE ER-2639       TO WS-ERROR
 13681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13682
 13683 3225-CONTINUE.
 13684     IF PB-I-LF-ALT-RATE = ZERO
 13685         MOVE ER-2659            TO WS-ERROR
 13686         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13687
 13688     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13689        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13690        MOVE ER-2698             TO WS-ERROR
 13691        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13692
 13693 3225-RATING-CONT.
 13694
 13695     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13696         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13697         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13698         IF (PB-COMPANY-ID = 'DCC')
 13699            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13700            CONTINUE
 13701         ELSE
 13702            MOVE ER-2687         TO WS-ERROR
 13703            PERFORM 9900-ERROR-FORMAT
 13704                                 THRU 9900-EXIT
 13705         END-IF
 13706         GO TO 3290-EDIT-LF-REIN-RATE
 13707     END-IF
 13708
 13709* DMD RATING TEST
 13710     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13711         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13712         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13713         MOVE ER-2687                 TO WS-ERROR
 13714         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13715         GO TO 3290-EDIT-LF-REIN-RATE.
 13716
 13717 3230-CLIENT-MORT-CD-SPECIALS.
 13718
 13719     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13720     SET BIN-TO-GREG          TO TRUE.
 13721*    MOVE ' '                 TO DC-OPTION-CODE.
 13722     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13723     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13724
 13725 C-POS-3230-MORT-CD.
 13726     IF PB-COMPANY-ID = 'POS' AND
 13727        PB-SV-CARRIER = '2'
 13728         NEXT SENTENCE
 13729     ELSE
 13730         GO TO C-POS-3240-MORT-CD.
 13731
 13732     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 249
* EL050.cbl
 13733        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13734         MOVE '2350' TO PB-I-MORT-CODE
 13735      ELSE
 13736         MOVE '3300' TO PB-I-MORT-CODE.
 13737
 13738
 13739 C-POS-3240-MORT-CD.
 13740     IF PB-COMPANY-ID = 'POS' AND
 13741        PB-SV-CARRIER = '1'
 13742         NEXT SENTENCE
 13743     ELSE
 13744         GO TO 3230-CONTINUE.
 13745
 13746     IF PB-SV-STATE = '45' OR '47'
 13747        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13748         MOVE '5200' TO PB-I-MORT-CODE
 13749     ELSE
 13750         MOVE '8300' TO PB-I-MORT-CODE.
 13751
 13752 3230-CONTINUE.
 13753
 13754     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13755        GO TO 3240-CONTINUE
 13756     END-IF
 13757
 13758     IF PB-CERT-EFF-DT > WS-971231
 13759        GO TO 3240-CONTINUE
 13760     END-IF
 13761
 13762     IF LF-BENEFIT-FOUND AND
 13763        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13764         MOVE 'F250'       TO PB-I-MORT-CODE
 13765     ELSE
 13766         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13767             MOVE '7250'   TO PB-I-MORT-CODE
 13768         ELSE
 13769             MOVE '4251'   TO PB-I-MORT-CODE
 13770         END-IF
 13771     END-IF
 13772
 13773     .
 13774 3240-CONTINUE.
 13775
 13776     IF PB-COMPANY-ID NOT = 'GNL'
 13777         GO TO 3256-CONTINUE.
 13778
 13779     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13780         MOVE 'A300' TO PB-I-MORT-CODE
 13781     ELSE
 13782         MOVE '8350' TO PB-I-MORT-CODE.
 13783
 13784 3256-CONTINUE.
 13785     IF PB-COMPANY-ID NOT = 'ABL'
 13786         GO TO 3260-EDIT-CONTINUE.
 13787
 13788     IF PB-I-LF-TERM GREATER THAN 59
 13789         MOVE 'F550' TO PB-I-MORT-CODE
 13790     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 250
* EL050.cbl
 13791         MOVE 'E550' TO PB-I-MORT-CODE.
 13792
 13793 3260-EDIT-CONTINUE.
 13794     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13795
 13796 3290-EDIT-LF-REIN-RATE.
 13797     IF LF-REIN-NSP-NOT-USED
 13798         GO TO 3290-RATING-CONT.
 13799
 13800     IF PB-COMPANY-ID = 'DCC'
 13801        GO TO 3290-RATING-CONT.
 13802     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13803     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13804     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13805     MOVE '3'                   TO CP-PROCESS-TYPE.
 13806     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13807
 13808******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13809     IF PB-COMPANY-ID EQUAL 'CDL'
 13810         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13811            CP-EARN-AS-NET-PAY)
 13812             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13813*            MOVE SPACE          TO DC-OPTION-CODE
 13814             SET BIN-TO-GREG     TO TRUE
 13815             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13816***  Y2K PROJ 7744
 13817             IF DC-GREG-DATE-CYMD GREATER 19931231
 13818                 MOVE '1'        TO CP-EARNING-METHOD.
 13819***  Y2K PROJ 7744
 13820*******
 13821
 13822     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13823     MOVE PB-SV-STATE           TO CP-STATE.
 13824     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13825     MOVE ZERO                  TO CP-DEVIATION-CODE
 13826                                   CP-RATE-DEV-PCT.
 13827     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13828     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13829                                   CP-RATING-BENEFIT-AMT.
 13830
 13831************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13832     IF PB-COMPANY-ID EQUAL 'NCB'
 13833         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13834            CP-EARN-AS-NET-PAY
 13835             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13836                 PB-I-LF-PREMIUM-AMT.
 13837************
 13838
 13839     IF CP-STATE-STD-ABBRV = 'OR'
 13840         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13841                                         PB-I-LF-ALT-BENEFIT-AMT.
 13842     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13843     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13844     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13845     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13846     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13847     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13848     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 251
* EL050.cbl
 13849     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13850                                   CP-REMAINING-TERM
 13851                                   CP-LOAN-TERM.
 13852     IF CP-TRUNCATED-LIFE
 13853        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13854
 13855     IF CP-TERM-IS-DAYS
 13856         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13857     ELSE
 13858         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13859
 13860     IF PB-COMPANY-ID = 'DCC'
 13861        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13862     END-IF
 13863     IF PB-COMPANY-ID NOT = 'TIC'
 13864          MOVE ZERO          TO CP-CLASS-CODE.
 13865
 13866     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13867
 13868     MOVE 'R'                   TO CP-RATE-FILE.
 13869     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13870
 13871     IF CP-ERROR-RATE-NOT-FOUND
 13872        IF PB-I-OB
 13873           MOVE ER-2625      TO WS-ERROR
 13874           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13875           GO TO 3299-EDIT-CONTINUE
 13876        ELSE
 13877           MOVE ER-2643      TO WS-ERROR
 13878           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13879           GO TO 3299-EDIT-CONTINUE.
 13880
 13881     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13882
 13883     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13884     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13885
 13886     IF PB-I-LF-REI-RATE = ZERO
 13887         MOVE ER-2643        TO WS-ERROR
 13888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13889
 13890 3290-CHECK-ALT-REIN-RATE.
 13891
 13892     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13893        GO TO 3290-RATING-CONT.
 13894
 13895     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13896     MOVE '2'                    TO CP-EARNING-METHOD.
 13897     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13898     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13899     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13900     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13901                                     CP-RATING-BENEFIT-AMT.
 13902     IF CP-STATE-STD-ABBRV = 'OR'
 13903         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13904                                         PB-I-LF-ALT-BENEFIT-AMT.
 13905     IF PB-COMPANY-ID = 'DCC'
 13906        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 252
* EL050.cbl
 13907     END-IF
 13908     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13909     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13910     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13911                                    CP-REMAINING-TERM
 13912                                    CP-LOAN-TERM.
 13913     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13914        ADD +1                   TO CP-ORIGINAL-TERM
 13915                                    CP-REMAINING-TERM
 13916                                    CP-LOAN-TERM.
 13917
 13918     MOVE 'R'                   TO CP-RATE-FILE.
 13919     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13920
 13921     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13922
 13923     IF PB-I-LF-ALT-REI-RATE = ZERO
 13924         MOVE ER-2643            TO WS-ERROR
 13925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13926
 13927 3290-RATING-CONT.
 13928
 13929     IF PB-I-OB
 13930*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13931        GO TO 3300-CHECK-AH-RATES.
 13932
 13933 3299-EDIT-CONTINUE.
 13934
 13935     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13936         NEXT SENTENCE
 13937     ELSE
 13938         MOVE ER-2620           TO WS-ERROR
 13939         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13940
 13941 3300-CHECK-AH-RATES.
 13942     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13943         NEXT SENTENCE
 13944     ELSE
 13945         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13946
 13947     IF (WS-AH-SPECIAL-CALC-CD = 'E')  OR
 13948        ((CF-COMPANY-ID = 'DMD') AND
 13949                (NO-DMD-RATING))
 13950         IF (PB-COMPANY-ID = 'DCC')
 13951            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13952            CONTINUE
 13953         ELSE
 13954            MOVE ER-2687         TO WS-ERROR
 13955            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13956         END-IF
 13957         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13958         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13959     END-IF
 13960
 13961     IF PB-I-OB
 13962        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13963
 13964     IF WS-AH-SPECIAL-CALC-CD = 'M'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 253
* EL050.cbl
 13965         MOVE ER-2687             TO WS-ERROR
 13966         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13967         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13968         GO TO 3999-END-EDIT.
 13969
 13970*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13971     if pb-company-id = 'AHL'
 13972        go to 3300-skip-crit-per
 13973     end-if
 13974     if (pb-i-ah-crit-per not = zeros)
 13975        and (ws-ah-special-calc-cd not = 'C')
 13976        MOVE ER-1572             TO WS-ERROR
 13977        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13978        go to 3300-skip-crit-per
 13979     END-IF
 13980     if (pb-company-id = 'DCC')
 13981        and (am-dcc-product-code not = spaces)
 13982        go to 3300-skip-crit-per
 13983     end-if
 13984     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13985        IF PB-I-AH-CRIT-PER = ZERO
 13986           move ws-ah-max-bens   to pb-i-ah-crit-per
 13987*          MOVE ER-2618       TO WS-ERROR
 13988*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13989*          GO TO 3999-END-EDIT
 13990        END-IF
 13991     END-IF
 13992     if (ws-ah-special-calc-cd = 'C')
 13993        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 13994        MOVE ER-1576             TO WS-ERROR
 13995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13996     end-if
 13997
 13998     .
 13999 3300-skip-crit-per.
 14000     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14001     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14002     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14003     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14004     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14005     MOVE PB-SV-STATE            TO CP-STATE.
 14006     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14007     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14008     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14009*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14010     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14011     MOVE '3'                    TO CP-PROCESS-TYPE.
 14012     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14013     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14014                                    CP-RATING-BENEFIT-AMT.
 14015     IF PB-COMPANY-ID = 'CID'
 14016               OR
 14017        CP-STATE-STD-ABBRV = 'OR'
 14018         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14019                                         PB-I-AH-TERM.
 14020     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14021        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14022           AND (PB-I-POLICY-IS-MONTHLY)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 254
* EL050.cbl
 14023           MOVE PB-I-LF-BENEFIT-AMT
 14024                                 TO CP-NET-BENEFIT-AMT
 14025           move pb-i-ah-premium-amt to cp-original-premium
 14026           add pb-i-lf-premium-amt to cp-original-premium
 14027        END-IF
 14028     END-IF
 14029     MOVE SPACES                 TO CP-BEN-CATEGORY
 14030     IF PB-COMPANY-ID = 'DCC'
 14031        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14032        EVALUATE TRUE
 14033           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14034              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14035              MOVE PB-I-LF-BENEFIT-AMT
 14036                                 TO CP-RATING-BENEFIT-AMT
 14037              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14038           WHEN WS-AH-BEN-CATEGORY = 'G'
 14039              MOVE PB-I-UNPAID-CASH-PRICE
 14040                                 TO CP-RATING-BENEFIT-AMT
 14041           WHEN WS-AH-BEN-CATEGORY = 'D'
 14042              MOVE WS-AH-PMF-COMM
 14043                                 TO CP-DCC-PMF-COMM
 14044              MOVE PB-I-AH-COMMISSION
 14045                                 TO CP-DCC-ACT-COMM
 14046        END-EVALUATE
 14047     END-IF
 14048     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14049     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14050     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14051     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14052     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14053     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14054     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14055                                    CP-REMAINING-TERM
 14056                                    WS-WORK-TERM.
 14057     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14058
 14059     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14060     SET BIN-TO-GREG             TO TRUE.
 14061*    MOVE ' '                    TO DC-OPTION-CODE.
 14062     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14063     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14064
 14065     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14066     IF NOT VALID-SKIP-CODE
 14067         MOVE ER-2683            TO WS-ERROR
 14068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14069         GO TO 3320-RATE-CONTINUE.
 14070
 14071     IF PB-NO-MONTHS-SKIPPED
 14072         GO TO 3320-RATE-CONTINUE.
 14073
 14074     MOVE SPACE TO NUMBER-OF-MONTHS.
 14075
 14076     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14077         MOVE 'S'                TO SK-MO (6).
 14078     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14079         MOVE 'S'                TO SK-MO (7).
 14080     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 255
* EL050.cbl
 14081         MOVE 'S'                TO SK-MO (8).
 14082     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14083         MOVE 'S'                TO SK-MO (9).
 14084     IF PB-I-SKIP-CODE = 'A'
 14085         MOVE 'S'                TO SK-MO (10).
 14086
 14087     MOVE 1                      TO SUB2.
 14088     MOVE PB-I-AH-TERM           TO SUB3.
 14089     MOVE WS-MONTH               TO SUB1.
 14090     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14091     GO TO 3320-RATE-CONTINUE.
 14092
 14093 3310-GET-SKIP-MO.
 14094     IF SUB1 = 13
 14095         MOVE 1                  TO SUB1.
 14096
 14097     IF SK-MO (SUB1) = 'S'
 14098         SUBTRACT 1 FROM WS-WORK-TERM.
 14099
 14100     ADD 1 TO SUB2
 14101              SUB1.
 14102
 14103 3320-RATE-CONTINUE.
 14104
 14105     IF WS-WORK-TERM = ZERO
 14106         MOVE 1                  TO WS-WORK-TERM.
 14107
 14108     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14109                                    CP-LOAN-TERM.
 14110
 14111     IF PB-COMPANY-ID EQUAL 'DMD'
 14112         NEXT SENTENCE
 14113     ELSE
 14114         MOVE ZERO               TO PB-I-AH-RATE
 14115                                    PB-I-AH-REI-RATE.
 14116
 14117
 14118     IF PB-COMPANY-ID EQUAL 'CRI'
 14119        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14120
 14121     IF PB-COMPANY-ID = 'CSL'
 14122         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14123         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14124         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14125         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14126
 14127     IF PB-COMPANY-ID = 'DCC'
 14128        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14129           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14130              PB-I-RATE-DEV-PCT-LF
 14131        END-IF
 14132        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14133                                 TO CP-ALTERNATE-BENEFIT
 14134        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14135        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14136        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14137     END-IF
 14138     IF (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 256
* EL050.cbl
 14139        AND (WS-LF-EARNINGS-CALC = 'B')
 14140        AND (CP-STATE-STD-ABBRV = 'MN')
 14141        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14142     ELSE
 14143        MOVE ' '                 TO CP-AH-BALLOON-SW
 14144     END-IF
 14145     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14146     MOVE 'R'                   TO CP-RATE-FILE.
 14147     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14148
 14149     IF CP-ERROR-RATE-NOT-FOUND
 14150        IF PB-I-OB
 14151           MOVE ER-2624          TO WS-ERROR
 14152           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14153           GO TO 3340-CALCULATE-PREMIUM-AMT
 14154        ELSE
 14155          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14156              NEXT SENTENCE
 14157          ELSE
 14158           MOVE ER-2642          TO WS-ERROR
 14159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14160           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14161
 14162     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14163        CP-ERROR-DIV-BY-ZERO
 14164           MOVE ER-3782          TO WS-ERROR
 14165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14166
 14167     IF PB-COMPANY-ID EQUAL 'CRI'
 14168        IF CP-ERROR-NO-LIMITS-CRI
 14169           IF NOT ACCOUNT-AH-CHECKED
 14170              MOVE ER-2607          TO WS-ERROR
 14171              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14172
 14173     IF ACCOUNT-AH-CHECKED
 14174        NEXT SENTENCE
 14175     ELSE
 14176       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14177          MOVE ER-2640           TO WS-ERROR
 14178          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14179
 14180     IF PB-COMPANY-ID = 'CRI'
 14181         IF WS-ERROR = ER-2640
 14182             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14183     IF ACCOUNT-AH-CHECKED
 14184        CONTINUE
 14185     ELSE
 14186        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14187           AND (CP-R-MAX-ATT-AGE > +0)
 14188           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14189           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14190              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14191              MOVE PB-I-AH-EXPIRE-DT
 14192                                 TO DC-BIN-DATE-2
 14193              MOVE '1'           TO DC-OPTION-CODE
 14194              PERFORM 8500-DATE-CONVERT
 14195                                 THRU 8500-EXIT
 14196              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 257
* EL050.cbl
 14197                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14198                    MOVE ER-2661       TO WS-ERROR
 14199*                   PERFORM 9900-ERROR-FORMAT
 14200*                                THRU 9900-EXIT
 14201                 END-IF
 14202              END-IF
 14203           ELSE
 14204              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14205              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14206                 MOVE ER-2661    TO WS-ERROR
 14207*                PERFORM 9900-ERROR-FORMAT
 14208*                                THRU 9900-EXIT
 14209              ELSE
 14210                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14211                    MOVE ER-1570 TO WS-ERROR
 14212                    PERFORM 9900-ERROR-FORMAT
 14213                                 THRU 9900-EXIT
 14214                 END-IF
 14215              END-IF
 14216           END-IF
 14217           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14218              MOVE PB-I-JOINT-BIRTHDAY
 14219                                    TO DC-BIN-DATE-1
 14220              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14221              MOVE '1'              TO DC-OPTION-CODE
 14222              PERFORM 8500-DATE-CONVERT
 14223                                    THRU 8500-EXIT
 14224              IF NO-CONVERSION-ERROR
 14225                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14226                    MOVE ER-2661       TO WS-ERROR
 14227*                   PERFORM 9900-ERROR-FORMAT
 14228*                                   THRU 9900-EXIT
 14229                 END-IF
 14230              END-IF
 14231           ELSE
 14232              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14233                (PB-I-AH-TERM / 12)
 14234              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14235                 MOVE ER-2661       TO WS-ERROR
 14236*                PERFORM 9900-ERROR-FORMAT
 14237*                                   THRU 9900-EXIT
 14238              ELSE
 14239                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14240                    MOVE ER-1571 TO WS-ERROR
 14241                    PERFORM 9900-ERROR-FORMAT
 14242                                 THRU 9900-EXIT
 14243                 END-IF
 14244              END-IF
 14245           END-IF
 14246           IF WS-ERROR = ER-2661
 14247              PERFORM 9900-ERROR-FORMAT
 14248                                    THRU 9900-EXIT
 14249           END-IF
 14250        END-IF
 14251     END-IF
 14252*    IF ACCOUNT-AH-CHECKED
 14253*       NEXT SENTENCE
 14254*    ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 258
* EL050.cbl
 14255*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14256*          MOVE ER-2661          TO WS-ERROR
 14257*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14258
 14259     IF ACCOUNT-AH-CHECKED
 14260        NEXT SENTENCE
 14261     ELSE
 14262        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14263           MOVE ER-2663          TO WS-ERROR
 14264           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14265
 14266     IF ACCOUNT-AH-CHECKED OR
 14267        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14268         PB-POLICY-IS-VOIDED
 14269        NEXT SENTENCE
 14270     ELSE
 14271        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14272           MOVE ER-2667            TO WS-ERROR
 14273           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14274
 14275     IF PB-COMPANY-ID = 'CRI'
 14276         IF WS-ERROR = ER-2667
 14277             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14278
 14279     IF ACCOUNT-AH-CHECKED
 14280        NEXT SENTENCE
 14281     ELSE
 14282        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14283           MOVE ER-2678            TO WS-ERROR
 14284           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14285
 14286     IF CP-ERROR-RATE-FILE-NOTOPEN
 14287         GO TO 3990-FILES-NOT-OPEN.
 14288
 14289 3321-CONTINUE.
 14290     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14291     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14292     IF (PB-COMPANY-ID = 'DCC')
 14293        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14294        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14295                                    PB-I-LF-ALT-PREM-CALC
 14296        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14297        IF WS-AH-BEN-CATEGORY = 'G'
 14298           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14299           + PB-I-ADDL-CLP)
 14300           * (1 + WS-TOL-CLP-PCT)
 14301*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14302        ELSE
 14303           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14304           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14305*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14306        END-IF
 14307        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14308                                 TO PB-I-AH-PREM-CALC
 14309        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14310           MOVE ER-8152          TO WS-ERROR
 14311           PERFORM 9900-ERROR-FORMAT
 14312                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 259
* EL050.cbl
 14313        ELSE
 14314           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14315                 PB-I-ADDL-CLP)
 14316              MOVE ER-8148       TO WS-ERROR
 14317              PERFORM 9900-ERROR-FORMAT
 14318                                 THRU 9900-EXIT
 14319           END-IF
 14320        END-IF
 14321     END-IF
 14322     IF (PB-COMPANY-ID = 'DCC')
 14323        AND (PB-I-POLICY-IS-MONTHLY)
 14324        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14325        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14326        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14327           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14328        END-IF
 14329     END-IF
 14330     IF (PB-COMPANY-ID = 'DCC')
 14331        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14332        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14333        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14334        MOVE ER-2786             TO WS-ERROR
 14335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14336     END-IF
 14337     MOVE +0                     TO PB-I-AH-CLP
 14338     IF PB-COMPANY-ID = 'DCC'
 14339        IF WS-AH-BEN-CATEGORY = 'D'
 14340           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14341              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14342        ELSE
 14343           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14344              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14345           END-IF
 14346        END-IF
 14347     END-IF
 14348     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14349
 14350     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14351         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14352
 14353     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14354         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14355
 14356     IF PB-COMPANY-ID = 'CRI'
 14357         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14358            PB-I-PAYMENT-AMOUNT = ZERO
 14359             NEXT SENTENCE
 14360         ELSE
 14361             COMPUTE PB-I-AH-PREM-CALC =
 14362                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14363                 (CP-PREMIUM-RATE / 100)
 14364             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14365                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14366                                             PB-I-RATE-DEV-PCT-AH.
 14367
 14368     IF PB-I-AH-RATE  = ZERO
 14369       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14370           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 260
* EL050.cbl
 14371       ELSE
 14372         MOVE ER-2642            TO WS-ERROR
 14373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14374
 14375     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14376     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14377     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14378     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14379     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14380     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14381
 14382     IF (PB-COMPANY-ID = 'DCC')
 14383        AND (WS-AH-BEN-CATEGORY = 'G')
 14384        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14385        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14386        IF CP-DEVIATION-CODE NOT = '000'
 14387           MOVE '000'            TO CP-DEVIATION-CODE
 14388           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14389           IF NO-CP-ERROR
 14390              COMPUTE PB-I-DDF-IU-RATE-UP =
 14391              PB-I-AH-CLP - CP-CALC-PREMIUM
 14392           ELSE
 14393              MOVE ER-3057        TO WS-ERROR
 14394              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14395           END-IF
 14396        END-IF
 14397     END-IF
 14398     .
 14399 3335-EDIT-AH-REIN-NSP-RATE.
 14400     IF AH-REIN-NSP-NOT-USED
 14401         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14402
 14403     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14404     IF PB-COMPANY-ID = 'DCC'
 14405         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14406     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14407     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14408     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14409     MOVE PB-SV-STATE            TO CP-STATE.
 14410     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14411     MOVE ZERO                   TO CP-DEVIATION-CODE
 14412                                    CP-RATE-DEV-PCT.
 14413*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14414     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14415     MOVE '3'                    TO CP-PROCESS-TYPE.
 14416     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14417     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14418                                    CP-RATING-BENEFIT-AMT.
 14419     IF CP-STATE-STD-ABBRV = 'OR'
 14420         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14421                                         PB-I-AH-TERM.
 14422     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14423     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14424     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14425     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14426     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14427     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14428                                    CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 261
* EL050.cbl
 14429                                    WS-WORK-TERM.
 14430     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14431     IF PB-COMPANY-ID = 'DCC'
 14432        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14433     END-IF
 14434     IF  PB-COMPANY-ID = 'TIC'
 14435         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14436            MOVE ZERO TO CP-CLASS-CODE.
 14437
 14438     IF PB-COMPANY-ID NOT = 'TIC'
 14439          MOVE ZERO          TO CP-CLASS-CODE.
 14440
 14441     MOVE ZERO               TO CP-DEVIATION-CODE.
 14442
 14443     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14444
 14445     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14446
 14447     MOVE 'R'                   TO CP-RATE-FILE.
 14448     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14449
 14450     IF CP-ERROR-RATE-NOT-FOUND
 14451         MOVE ER-2645        TO WS-ERROR
 14452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14453         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14454
 14455     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14456
 14457     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14458     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14459
 14460     IF PB-I-AH-REI-RATE = ZERO
 14461         MOVE ER-2645        TO WS-ERROR
 14462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14463
 14464
 14465 3340-CALCULATE-PREMIUM-AMT.
 14466
 14467     IF PB-COMPANY-ID = 'NCL'
 14468         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14469             WS-AH-SPECIAL-CALC-CD = 'O')
 14470             GO TO 3999-END-EDIT.
 14471
 14472     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14473                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14474                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14475                         OR 'AHL'
 14476         NEXT SENTENCE
 14477     ELSE
 14478         IF WS-STATE-ABBREVIATION = 'CT'
 14479             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14480                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14481                 COMPUTE PB-I-LF-PREM-CALC =
 14482                                     PB-I-LF-PREM-CALC * .90
 14483                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14484                                     PB-I-LF-ALT-PREM-CALC * .90
 14485                 COMPUTE PB-I-AH-PREM-CALC =
 14486                                     PB-I-AH-PREM-CALC * .90.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 262
* EL050.cbl
 14487
 14488     IF PB-COMP-LF-PREM
 14489        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14490        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14491
 14492     IF PB-COMP-AH-PREM
 14493        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14494
 14495 3340-CHECK-DCC-TOT-FEES.
 14496     IF (PB-COMPANY-ID = 'DCC')
 14497        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14498        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14499        AND (PB-I-POLICY-IS-MONTHLY)
 14500        CONTINUE
 14501     ELSE
 14502        GO TO 3340-EDIT-LF-AH-TOL
 14503     END-IF
 14504     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14505     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14506     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14507        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14508           PB-I-RATE-DEV-PCT-LF
 14509     END-IF
 14510     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14511        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14512           PB-I-RATE-DEV-PCT-AH
 14513     END-IF
 14514     MOVE 'N'                    TO CP-BEN-CATEGORY
 14515     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14516
 14517     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14518     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14519     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14520     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14521     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14522     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14523     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14524     MOVE '3'                    TO CP-PROCESS-TYPE.
 14525     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14526     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14527
 14528     MOVE PB-SV-STATE            TO CP-STATE.
 14529     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14530     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14531     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14532     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14533     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14534                                    CP-RATING-BENEFIT-AMT.
 14535     IF CP-STATE-STD-ABBRV = 'OR'
 14536         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14537                                         PB-I-LF-ALT-BENEFIT-AMT.
 14538     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14539     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14540     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14541     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14542     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14543     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14544     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 263
* EL050.cbl
 14545     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14546     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14547                                    CP-REMAINING-TERM
 14548                                    CP-LOAN-TERM.
 14549     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14550        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14551           PB-I-LF-PREMIUM-AMT
 14552     end-if
 14553
 14554     IF CP-TRUNCATED-LIFE
 14555        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14556
 14557     IF CP-TERM-IS-DAYS
 14558         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14559     ELSE
 14560         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14561
 14562     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14563     IF CP-SPECIAL-CALC-CD = 'H'
 14564         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14565                                    TO CP-ALTERNATE-BENEFIT
 14566         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14567     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14568     MOVE 'R'                    TO CP-RATE-FILE
 14569     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14570     IF NOT CP-ERROR-RATE-NOT-FOUND
 14571        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14572        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14573           AND (CP-BENEFIT-CD (1:1) = 'S')
 14574           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14575                                    PB-I-LF-PREMIUM-AMT
 14576        END-IF
 14577     ELSE
 14578        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14579     END-IF
 14580     .
 14581 3340-EDIT-LF-AH-TOL.
 14582
 14583***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14584***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14585***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14586***
 14587     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14588         PB-I-AH-PREMIUM-AMT
 14589          GIVING WS-CALC-WORK.
 14590
 14591     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14592        AND WS-CALC-WORK NOT = ZERO
 14593         MOVE ER-2649            TO WS-ERROR
 14594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14595
 14596     SUBTRACT PB-I-LF-PREM-CALC
 14597             FROM PB-I-LF-PREMIUM-AMT
 14598                 GIVING WS-UNSIGN-WRK1.
 14599
 14600     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14601             FROM PB-I-LF-ALT-PREMIUM-AMT
 14602                 GIVING WS-UNSIGN-WRK4.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 264
* EL050.cbl
 14603
 14604     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14605                                + WS-UNSIGN-WRK4.
 14606
 14607     SUBTRACT PB-I-AH-PREM-CALC
 14608             FROM PB-I-AH-PREMIUM-AMT
 14609                 GIVING WS-UNSIGN-WRK2.
 14610
 14611******************************************************************
 14612*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14613******************************************************************
 14614
 14615     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14616         MOVE ZERO TO WS-UNSIGN-WRK1.
 14617
 14618     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14619         MOVE ZERO TO WS-UNSIGN-WRK2.
 14620
 14621     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14622             GIVING WS-UNSIGN-WRK3.
 14623
 14624 3342-CONTINUE.
 14625
 14626     IF (PB-I-LF-RATE = ZERO  AND
 14627         PB-I-AH-RATE = ZERO)
 14628         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14629            WS-AH-SPECIAL-CALC-CD = 'O'
 14630              NEXT SENTENCE
 14631         ELSE
 14632             GO TO 3345-EDIT-CONTINUE.
 14633
 14634     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14635         NEXT SENTENCE
 14636     ELSE
 14637     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14638        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14639           IF (PB-REISSUED-CERT         OR
 14640               PB-POLICY-IS-DECLINED    OR
 14641               PB-POLICY-IS-VOIDED)
 14642              NEXT SENTENCE
 14643           ELSE
 14644              IF WS-PREM-REJECT-SW = SPACE
 14645                 MOVE ER-2652    TO WS-ERROR
 14646                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14647                 GO TO 3344-CHECK-AH
 14648              ELSE
 14649                 MOVE ER-2650    TO WS-ERROR
 14650                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14651                 GO TO 3344-CHECK-AH.
 14652
 14653***
 14654***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14655***
 14656
 14657     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14658         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14659            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14660             (1 + WS-TOL-LF-PREM-PCT)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 265
* EL050.cbl
 14661         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14662            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14663             (1 - WS-TOL-LF-PREM-PCT)
 14664     ELSE
 14665         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14666         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14667
 14668***
 14669***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14670***
 14671
 14672     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14673         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14674          WS-TOL-LF-PREM.
 14675
 14676     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14677         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14678          WS-TOL-LF-PREM.
 14679
 14680     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14681        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14682
 14683     IF PB-REISSUED-CERT
 14684        or PB-POLICY-IS-DECLINED
 14685        or PB-POLICY-IS-VOIDED
 14686        continue
 14687     ELSE
 14688        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14689              > WS-TOL-LF-HIGH-PREM-AMT)
 14690           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14691              < WS-TOL-LF-LOW-PREM-AMT))
 14692                      or
 14693           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14694              > WS-TOL-LF-HIGH-PREM-PCT)
 14695           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14696              < WS-TOL-LF-LOW-PREM-PCT))
 14697           IF WS-PREM-REJECT-SW = SPACE
 14698              MOVE ER-2652       TO WS-ERROR
 14699              PERFORM 9900-ERROR-FORMAT
 14700                                 THRU 9900-EXIT
 14701           ELSE
 14702              MOVE ER-2650       TO WS-ERROR
 14703              PERFORM 9900-ERROR-FORMAT
 14704                                 THRU 9900-EXIT
 14705           end-if
 14706        end-if
 14707     end-if
 14708
 14709*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14710*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14711*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14712*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14713
 14714     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14715        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14716                      OR
 14717           ((PB-COMPANY-ID = 'DCC')
 14718           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 266
* EL050.cbl
 14719           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14720           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14721        END-IF
 14722     END-IF
 14723
 14724     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14725        IF WS-COMP-MAX-CAP GREATER THAN +0
 14726           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14727              IF (PB-REISSUED-CERT         OR
 14728                  PB-POLICY-IS-DECLINED    OR
 14729                  PB-POLICY-IS-VOIDED)
 14730                 NEXT SENTENCE
 14731              ELSE
 14732                  MOVE ER-2646   TO  WS-ERROR
 14733                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14734
 14735 3344-CVL-TOLERANCE-CHECK.
 14736
 14737      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14738          GO TO 3344-CHECK-AH.
 14739
 14740      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14741          GO TO 3344-CHECK-AH.
 14742
 14743      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14744                                     WS-UNSIGN-WRK6.
 14745
 14746      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14747          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14748                                 + PB-I-LF-PREMIUM-AMT
 14749                                 - PB-I-LF-PREM-CALC.
 14750
 14751      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14752          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14753                                 + PB-I-LF-ALT-PREMIUM-AMT
 14754                                 - PB-I-LF-ALT-PREM-CALC.
 14755
 14756      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14757          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14758              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14759                 MOVE ER-2652    TO  WS-ERROR
 14760                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14761              ELSE
 14762                 MOVE ER-2650    TO  WS-ERROR
 14763                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14764
 14765      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14766          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14767              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14768                 MOVE ER-2652    TO  WS-ERROR
 14769                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14770              ELSE
 14771                 MOVE ER-2650    TO  WS-ERROR
 14772                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14773
 14774 3344-CHECK-AH.
 14775
 14776****************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 267
* EL050.cbl
 14777***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14778***
 14779
 14780     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14781         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14782             (1 + WS-TOL-AH-PREM-PCT)
 14783         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14784             (1 - WS-TOL-AH-PREM-PCT)
 14785     ELSE
 14786         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14787         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14788
 14789***
 14790***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14791***
 14792
 14793     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14794         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14795
 14796     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14797         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14798
 14799     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14800        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14801
 14802     IF (PB-REISSUED-CERT)
 14803        OR (PB-POLICY-IS-DECLINED)
 14804        OR (PB-POLICY-IS-VOIDED)
 14805        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14806        CONTINUE
 14807     ELSE
 14808        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14809              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14810                          or
 14811           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14812              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14813           IF WS-PREM-REJECT-SW = SPACE
 14814              MOVE ER-3052       TO WS-ERROR
 14815              PERFORM 9900-ERROR-FORMAT
 14816                                 THRU 9900-EXIT
 14817           ELSE
 14818              MOVE ER-3050       TO WS-ERROR
 14819              PERFORM 9900-ERROR-FORMAT
 14820                                 THRU 9900-EXIT
 14821           END-IF
 14822        END-IF
 14823     END-IF
 14824     if (pb-company-id = 'DCC')
 14825        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14826        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14827        and (pb-i-policy-is-monthly)
 14828        compute ws-tol-ah-high-prem-amt =
 14829           pb-i-tot-fees-calc + ws-tol-ah-prem
 14830        compute ws-tol-ah-low-prem-amt =
 14831           pb-i-tot-fees-calc - ws-tol-ah-prem
 14832        if ws-tol-ah-prem-pct > zeros
 14833           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14834              (1 + ws-tol-ah-prem-pct)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 268
* EL050.cbl
 14835           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14836              (1 - ws-tol-ah-prem-pct)
 14837        else
 14838           move +9999999.99      to ws-tol-ah-high-prem-pct
 14839           move +0               to ws-tol-ah-low-prem-pct
 14840        end-if
 14841        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14842            or
 14843           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14844                          or
 14845           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14846           or
 14847           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14848            move er-3049         to ws-error
 14849           perform 9900-error-format
 14850                                 thru 9900-exit
 14851
 14852        end-if
 14853     end-if
 14854     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14855         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14856             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14857             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14858
 14859     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14860        IF WS-COMP-MAX-CAP GREATER THAN +0
 14861           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14862              IF (PB-REISSUED-CERT         OR
 14863                  PB-POLICY-IS-DECLINED    OR
 14864                  PB-POLICY-IS-VOIDED)
 14865                 NEXT SENTENCE
 14866              ELSE
 14867                  MOVE ER-2646   TO  WS-ERROR
 14868                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14869
 14870     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14871        (WS-COMP-MAX-CAP EQUAL +0)
 14872           GO TO 3345-EDIT-CONTINUE.
 14873
 14874     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14875        GREATER THAN WS-COMP-MAX-CAP
 14876           MOVE ER-2646          TO  WS-ERROR
 14877           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14878
 14879 3345-EDIT-CONTINUE.
 14880
 14881*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14882*       IF PB-ENTRY-BATCH   NUMERIC
 14883*          IF PB-ISSUE
 14884*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14885*          ELSE
 14886*              IF PB-CANCELLATION
 14887*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14888
 14889*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14890*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14891*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14892*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 269
* EL050.cbl
 14893*        ELSE
 14894*            MOVE  ER-1909            TO  WS-ERROR
 14895*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14896
 14897     IF PB-I-POLICY-ACCEPTED
 14898        IF PB-POLICY-IS-DECLINED  OR
 14899           PB-REISSUED-CERT  OR
 14900           PB-REIN-ONLY-CERT  OR
 14901           PB-POLICY-IS-VOIDED
 14902            MOVE  ER-1891         TO  WS-ERROR
 14903            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14904        ELSE
 14905            MOVE SPACE            TO  PB-BATCH-ENTRY
 14906            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14907
 14908     IF PB-I-POLICY-DECLINED
 14909        IF PB-REISSUED-CERT  OR
 14910           PB-REIN-ONLY-CERT  OR
 14911           PB-POLICY-IS-VOIDED
 14912            MOVE  ER-1906         TO  WS-ERROR
 14913            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14914        ELSE
 14915            MOVE  'D'             TO  PB-BATCH-ENTRY
 14916                                      PB-I-ENTRY-STATUS.
 14917
 14918     IF PB-I-NEEDS-UNDERWRITING
 14919        IF PB-POLICY-IS-DECLINED OR
 14920           PB-REISSUED-CERT  OR
 14921           PB-REIN-ONLY-CERT  OR
 14922           PB-POLICY-IS-VOIDED
 14923            MOVE  ER-1907         TO  WS-ERROR
 14924            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14925        ELSE
 14926            MOVE 'U'              TO  PB-BATCH-ENTRY
 14927                                      PB-I-ENTRY-STATUS.
 14928
 14929     IF PB-NEEDS-UNDERWRITING
 14930        MOVE  ER-1901             TO  WS-ERROR
 14931        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14932     IF PB-COMPANY-ID = 'DCC'
 14933        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14934        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14935        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14936           AND (NOT WS-LF-CASH))
 14937                           OR
 14938           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14939           AND (NOT WS-AH-CASH)))
 14940                       AND
 14941           (PB-I-ENTRY-STATUS NOT = '5')
 14942           MOVE 'M'              TO PB-BATCH-ENTRY
 14943                                    PB-I-ENTRY-STATUS
 14944        END-IF
 14945     END-IF
 14946     IF  PB-COMPANY-ID NOT = 'NCL'
 14947         GO TO 3999-END-EDIT.
 14948
 14949     IF PB-REISSUED-CERT  OR
 14950        PB-POLICY-IS-DECLINED  OR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 270
* EL050.cbl
 14951        PB-POLICY-IS-VOIDED  OR
 14952        PB-I-OB
 14953         GO TO 3999-END-EDIT.
 14954
 14955     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14956         MOVE  ER-2644            TO  WS-ERROR
 14957         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14958         GO TO 3999-END-EDIT.
 14959
 14960     MOVE 'N'                     TO  FORM-MASTER-SW.
 14961     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14962
 14963     IF NOT FORM-MASTER-FOUND
 14964         GO TO 3999-END-EDIT.
 14965
 14966     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14967                                      FORM-MASTER-AH-SW.
 14968
 14969     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14970         MOVE  +1                 TO SUB6
 14971         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14972
 14973     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14974         MOVE  +1                 TO SUB6
 14975         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14976
 14977     IF LF-FORM-MASTER-FOUND  OR
 14978        AH-FORM-MASTER-FOUND
 14979         GO TO 3360-CHECK-FORM-LIMITS
 14980     ELSE
 14981         GO TO 3999-END-EDIT.
 14982
 14983******************************************************************
 14984*                  3350-GET-ERFORM                               *
 14985*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14986*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14987******************************************************************
 14988
 14989 3350-GET-ERFORM.
 14990
 14991     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14992         GO TO  3350-ERFORM-GETMAIN.
 14993
 14994     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14995     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14996     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14997     MOVE 'Y'                     TO FORM-MASTER-SW.
 14998
 14999     IF PB-CANCELLATION
 15000         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15001            PB-SV-STATE          EQUAL   FO-STATE       AND
 15002            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15003              GO TO 3350-EXIT
 15004         ELSE
 15005             NEXT SENTENCE
 15006     ELSE
 15007         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15008            PB-SV-STATE          EQUAL   FO-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 271
* EL050.cbl
 15009            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15010              GO TO 3350-EXIT.
 15011
 15012 3350-ERFORM-GETMAIN.
 15013
 15014     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15015     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15016
 15017 3350-ERFORM-READ.
 15018
 15019     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15020     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15021     IF PB-CANCELLATION
 15022         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15023     ELSE
 15024         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15025     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15026
 15027     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15028
 15029     IF FORM-MASTER-FOUND
 15030       IF PB-CANCELLATION
 15031          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15032             PB-SV-STATE          EQUAL   FO-STATE       AND
 15033             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15034              GO  TO 3350-EXIT
 15035          ELSE
 15036              NEXT SENTENCE
 15037       ELSE
 15038          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15039             PB-SV-STATE          EQUAL   FO-STATE       AND
 15040             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15041              GO  TO 3350-EXIT.
 15042
 15043     MOVE  'N'                    TO  FORM-MASTER-SW.
 15044     MOVE  ER-1895                TO  WS-ERROR.
 15045     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15046
 15047 3350-EXIT.
 15048      EXIT.
 15049
 15050******************************************************************
 15051*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15052*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15053*   VALID FOR THE POLICY FORM USED.                              *
 15054******************************************************************
 15055
 15056 3355-EDIT-FORM-LF-BENEFITS.
 15057
 15058     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15059        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15060         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15061         GO TO   3355-EXIT.
 15062
 15063     IF  SUB6    LESS THAN   +40
 15064         ADD  +1      TO  SUB6
 15065         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15066
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 272
* EL050.cbl
 15067     MOVE  ER-1896         TO  WS-ERROR.
 15068     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15069
 15070 3355-EXIT.
 15071      EXIT.
 15072
 15073******************************************************************
 15074*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15075*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15076*   VALID FOR THE POLICY FORM USED.                              *
 15077******************************************************************
 15078
 15079 3356-EDIT-FORM-AH-BENEFITS.
 15080
 15081     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15082        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15083         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15084         GO TO  3356-EXIT.
 15085
 15086      IF  SUB6    LESS THAN     +40
 15087          ADD  +1      TO  SUB6
 15088          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15089
 15090     MOVE  ER-1897         TO  WS-ERROR.
 15091     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15092
 15093 3356-EXIT.
 15094      EXIT.
 15095
 15096******************************************************************
 15097*                  3357-BENEFIT-SEARCH                           *
 15098*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15099*   CANCELLATIONS ONLY.                                          *
 15100******************************************************************
 15101 3357-BENEFIT-SEARCH.
 15102     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15103         MOVE +1                          TO SUB6
 15104         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15105
 15106     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15107         MOVE +1                          TO SUB6
 15108         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15109
 15110 3357-EXIT.
 15111     EXIT.
 15112
 15113******************************************************************
 15114*                  3358-BENEFIT-LIFE-SEARCH                      *
 15115*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15116*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15117*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15118******************************************************************
 15119 3358-BENEFIT-LIFE-SEARCH.
 15120     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15121       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15122         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15123           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15124              IF FO-PLAN-REFUND-METHOD (SUB6)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 273
* EL050.cbl
 15125                     IS GREATER THAN SPACES
 15126                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15127                                          WS-LF-REFUND-CALC
 15128                 GO TO 3358-EXIT.
 15129
 15130     IF SUB6 LESS THAN +40
 15131         ADD +1                 TO SUB6
 15132         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15133
 15134 3358-EXIT.
 15135     EXIT.
 15136******************************************************************
 15137*                  3359-BENEFIT-AH-SEARCH                        *
 15138*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15139*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15140*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15141******************************************************************
 15142 3359-BENEFIT-AH-SEARCH.
 15143     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15144       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15145         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15146           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15147              IF FO-PLAN-REFUND-METHOD (SUB6)
 15148                      IS GREATER THAN SPACES
 15149                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15150                                          WS-AH-REFUND-CALC
 15151                 GO TO 3359-EXIT.
 15152
 15153     IF SUB6 LESS THAN +40
 15154         ADD +1                 TO SUB6
 15155         GO TO 3359-BENEFIT-AH-SEARCH.
 15156
 15157 3359-EXIT.
 15158     EXIT.
 15159
 15160******************************************************************
 15161*                  3360-CHECK-FORM-LIMITS                        *
 15162*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15163*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15164******************************************************************
 15165
 15166 3360-CHECK-FORM-LIMITS.
 15167
 15168     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15169         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15170
 15171     IF NOT LF-FORM-MASTER-FOUND
 15172         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15173
 15174 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15175
 15176     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15177       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15178        WS-LF-JOINT-INDICATOR = 'J'  AND
 15179        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15180         IF PB-COMPANY-ID = 'NCL'
 15181            MOVE  ER-1911          TO  WS-ERROR
 15182            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 274
* EL050.cbl
 15183         ELSE
 15184            MOVE  ER-1892          TO  WS-ERROR
 15185            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15186
 15187 3360-CHECK-FORM-LF-ATT-AGE.
 15188
 15189     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15190
 15191     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15192         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15193         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15194            IF PB-COMPANY-ID = 'NCL'
 15195                MOVE  ER-1913      TO  WS-ERROR
 15196                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15197            ELSE
 15198                MOVE  ER-1894      TO  WS-ERROR
 15199                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15200
 15201 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15202
 15203     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15204         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15205         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15206            IF PB-COMPANY-ID = 'NCL'
 15207                MOVE  ER-1914      TO  WS-ERROR
 15208                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15209            ELSE
 15210                MOVE  ER-1899      TO  WS-ERROR
 15211                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15212
 15213 3360-CHECK-FORM-LF-TERM-BAMT.
 15214
 15215     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15216         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15217         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15218           IF  PB-COMPANY-ID = 'NCL'
 15219               MOVE  ER-1916       TO  WS-ERROR
 15220               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15221           ELSE
 15222               MOVE  ER-1902       TO  WS-ERROR
 15223               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15224
 15225     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15226                                    PB-I-LF-ALT-BENEFIT-AMT.
 15227
 15228     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15229         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15230         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15231             IF  PB-COMPANY-ID = 'NCL'
 15232                 MOVE  ER-1918     TO  WS-ERROR
 15233                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15234             ELSE
 15235                 MOVE  ER-1904     TO  WS-ERROR
 15236                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15237
 15238******************************************************************
 15239*                  3360-CHECK-FORM-AH-LIMITS                     *
 15240*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 275
* EL050.cbl
 15241*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15242******************************************************************
 15243
 15244 3360-CHECK-FORM-AH-LIMITS.
 15245
 15246     IF NOT AH-FORM-MASTER-FOUND
 15247         GO TO 3999-END-EDIT.
 15248
 15249 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15250
 15251     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15252       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15253        WS-AH-JOINT-INDICATOR = 'J'  AND
 15254        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15255         IF PB-COMPANY-ID = 'NCL'
 15256            MOVE  ER-1912          TO  WS-ERROR
 15257            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15258         ELSE
 15259            MOVE  ER-1893          TO  WS-ERROR
 15260            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15261
 15262 3360-CHECK-FORM-AH-ATT-AGE.
 15263
 15264     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15265
 15266     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15267         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15268         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15269            IF PB-COMPANY-ID = 'NCL'
 15270                MOVE  ER-1913      TO  WS-ERROR
 15271                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15272            ELSE
 15273                MOVE  ER-1894      TO  WS-ERROR
 15274                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15275
 15276 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15277
 15278     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15279         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15280         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15281            IF PB-COMPANY-ID = 'NCL'
 15282                MOVE  ER-1915      TO  WS-ERROR
 15283                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15284            ELSE
 15285                MOVE  ER-1900      TO  WS-ERROR
 15286                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15287
 15288 3360-CHECK-FORM-AH-TERM-BAMT.
 15289
 15290     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15291         FO-AH-MAX-TERM    GREATER THAN  +0
 15292         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15293             IF  PB-COMPANY-ID = 'NCL'
 15294                 MOVE  ER-1917     TO  WS-ERROR
 15295                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15296             ELSE
 15297                  MOVE  ER-1903    TO  WS-ERROR
 15298                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 276
* EL050.cbl
 15299
 15300     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15301         FO-MAX-AH-AMT    GREATER THAN  +0
 15302         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15303             IF  PB-COMPANY-ID = 'NCL'
 15304                 MOVE  ER-1919     TO  WS-ERROR
 15305                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15306             ELSE
 15307                 MOVE  ER-1905     TO  WS-ERROR
 15308                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15309
 15310     GO TO 3999-END-EDIT.
 15311
 15312******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 277
* EL050.cbl
 15314******************************************************************
 15315*                  E D I T   C A N C E L                         *
 15316******************************************************************
 15317
 15318 3700-EDIT-CANCEL.
 15319     IF PB-COMPANY-ID = 'DMD'
 15320         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15321                                         WS-RES-MUNI-TAX
 15322                                         PB-CI-STATE-TAX
 15323                                         PB-CI-MUNI-TAX
 15324         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15325
 15326*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15327*       IF PB-ENTRY-BATCH  NUMERIC
 15328*          IF PB-CANCELLATION
 15329*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15330*          ELSE
 15331*             IF PB-ISSUE
 15332*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15333
 15334     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15335        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15336     END-IF
 15337*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15338*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15339
 15340     IF CM-ENTRY-STATUS = 'V'
 15341        MOVE ER-2780             TO WS-ERROR
 15342        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15343        GO TO 3999-END-EDIT.
 15344
 15345     IF CM-ENTRY-STATUS = 'D'
 15346        MOVE ER-2781             TO WS-ERROR
 15347        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15348        GO TO 3999-END-EDIT.
 15349
 15350     IF CM-ENTRY-STATUS = 'U'
 15351        MOVE ER-2782             TO WS-ERROR
 15352        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15353
 15354***************************************************************
 15355*                                                             *
 15356*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15357*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15358*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15359*   OF ANOTHER COVERAGE.                                      *
 15360*                                                             *
 15361***************************************************************
 15362
 15363     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15364                                    PB-C-AH-CANCEL-VOID-SW.
 15365
 15366     IF PB-C-LF-CANCEL-AMT = ZERO
 15367        NEXT SENTENCE
 15368     ELSE
 15369        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15370           AND
 15371           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 278
* EL050.cbl
 15372               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15373               MOVE ER-2745           TO WS-ERROR
 15374               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15375
 15376     IF PB-C-AH-CANCEL-AMT = ZERO
 15377        NEXT SENTENCE
 15378     ELSE
 15379        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15380           AND
 15381           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15382               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15383               MOVE ER-2745           TO WS-ERROR
 15384               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15385
 15386     IF WS-LF-EARNINGS-CALC = '4'
 15387        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15388
 15389     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15390     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15391     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15392     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15393     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15394     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15395
 15396     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15397                                      PB-C-AH-REF-CALC.
 15398     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15399
 15400******************************************************************
 15401*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15402*             TO VALIDATE COVERAGE.                              *
 15403******************************************************************
 15404
 15405     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15406        PB-C-LF-CANCEL-AMT = ZEROS
 15407          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15408      ELSE
 15409          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15410
 15411     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15412        PB-C-AH-CANCEL-AMT = ZEROS
 15413          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15414      ELSE
 15415          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15416
 15417     EVALUATE TRUE
 15418         WHEN PB-CANCEL-FORCE             OR
 15419              PB-CANCEL-DATE-FORCED       OR
 15420              PB-FORCE-OFF
 15421                  IF PB-COMPANY-ID = 'ACE'
 15422                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15423                  END-IF
 15424         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15425               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15426              (PB-COMPANY-ID = 'ACE' )
 15427                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15428         WHEN OTHER
 15429              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 279
* EL050.cbl
 15430                 MOVE ER-2794              TO WS-ERROR
 15431              ELSE
 15432                 MOVE ER-2749              TO WS-ERROR
 15433              END-IF
 15434              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15435     END-EVALUATE.
 15436
 15437
 15438*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15439*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15440*            MOVE  ER-1909            TO  WS-ERROR
 15441*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15442*        ELSE
 15443*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15444
 15445     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15446     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15447        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15448     ELSE
 15449        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15450     END-IF
 15451     .
 15452 3705-EDIT-CANCEL-DT.
 15453
 15454     IF LF-COVERAGE-CANCELLED
 15455        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15456         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15457         MOVE WS-CURRENT-MONTH-END
 15458                                 TO DC-BIN-DATE-2
 15459         SET ELAPSED-BETWEEN-BIN TO TRUE
 15460*        MOVE 1                  TO DC-OPTION-CODE
 15461         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15462         IF DATE-CONVERSION-ERROR
 15463            NEXT SENTENCE
 15464          ELSE
 15465             IF DC-ELAPSED-DAYS GREATER +180
 15466                IF PB-CANCEL-DATE-FORCED  OR
 15467                   PB-CANCEL-DATE-FORCED-NO-FEE
 15468                      MOVE ER-2751  TO WS-ERROR
 15469                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15470                 ELSE
 15471                   MOVE ER-2752  TO WS-ERROR
 15472                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15473
 15474     IF AH-COVERAGE-CANCELLED
 15475        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15476         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15477         MOVE WS-CURRENT-MONTH-END
 15478                                 TO DC-BIN-DATE-2
 15479         SET ELAPSED-BETWEEN-BIN TO TRUE
 15480*        MOVE 1                  TO DC-OPTION-CODE
 15481         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15482         IF DATE-CONVERSION-ERROR
 15483            NEXT SENTENCE
 15484          ELSE
 15485             IF DC-ELAPSED-DAYS GREATER +180
 15486                IF PB-CANCEL-DATE-FORCED OR
 15487                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 280
* EL050.cbl
 15488                      MOVE ER-2751  TO WS-ERROR
 15489                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15490                 ELSE
 15491                   MOVE ER-2752  TO WS-ERROR
 15492                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15493
 15494     IF WS-ERROR = ER-2752
 15495        AND (PB-COMPANY-ID = 'ABL'
 15496         OR  PB-COMPANY-ID = 'FGL'
 15497         OR  PB-COMPANY-ID = 'IST'
 15498         OR  PB-COMPANY-ID = 'JHL'
 15499         OR  PB-COMPANY-ID = 'LAP'
 15500         OR  PB-COMPANY-ID = 'LBL'
 15501         OR  PB-COMPANY-ID = 'NCB'
 15502         OR  PB-COMPANY-ID = 'NLI'
 15503         OR  PB-COMPANY-ID = 'OFI'
 15504         OR  PB-COMPANY-ID = 'PLI'
 15505         OR  PB-COMPANY-ID = 'TAO'
 15506         OR  PB-COMPANY-ID = 'TIC'
 15507         OR  PB-COMPANY-ID = 'HER'
 15508         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15509         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15510            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15511            MOVE ER-2762     TO WS-ERROR
 15512            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15513
 15514     IF LF-COVERAGE-CANCELLED
 15515        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15516        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15517             MOVE ER-2733         TO WS-ERROR
 15518             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15519
 15520     IF AH-COVERAGE-CANCELLED
 15521        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15522        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15523              MOVE ER-2733        TO WS-ERROR
 15524              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15525
 15526     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15527        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15528        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15529           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15530            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15531              IF PB-COMPANY-ID NOT = 'LAP'
 15532               MOVE ER-2704            TO WS-ERROR
 15533               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15534
 15535     IF CERT-WAS-NOT-FOUND
 15536         GO TO 3999-END-EDIT.
 15537
 15538     IF PB-COMPANY-ID EQUAL 'CDC'
 15539        IF LF-COVERAGE-CANCELLED
 15540           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15541            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15542            MOVE PB-C-LF-CANCEL-DT
 15543                                 TO DC-BIN-DATE-2
 15544            SET ELAPSED-BETWEEN-BIN TO TRUE
 15545*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 281
* EL050.cbl
 15546            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15547            IF DATE-CONVERSION-ERROR
 15548               NEXT SENTENCE
 15549             ELSE
 15550                IF DC-ELAPSED-DAYS GREATER +60
 15551                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15552
 15553     IF PB-COMPANY-ID EQUAL 'CDC'
 15554        IF AH-COVERAGE-CANCELLED
 15555           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15556            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15557            MOVE PB-C-AH-CANCEL-DT
 15558                                 TO DC-BIN-DATE-2
 15559            MOVE +0              TO DC-ELAPSED-DAYS
 15560                                    DC-ELAPSED-MONTHS
 15561            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15562*           MOVE 1               TO DC-OPTION-CODE
 15563            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15564            IF DATE-CONVERSION-ERROR
 15565               NEXT SENTENCE
 15566             ELSE
 15567                IF DC-ELAPSED-DAYS GREATER +60
 15568                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15569
 15570     MOVE +0                     TO DC-ELAPSED-DAYS
 15571                                    DC-ELAPSED-MONTHS.
 15572
 15573     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15574        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15575          MOVE 'Z'                TO PB-CI-OB-FLAG
 15576          MOVE ER-2767            TO WS-ERROR
 15577          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15578          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15579          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15580          GO TO 3775-OVER-REF-CHK
 15581        ELSE
 15582          MOVE ZEROS              TO PB-CI-LIVES
 15583                                     PB-C-LIVES
 15584          IF PB-CI-OB-FLAG NOT = 'B'
 15585             MOVE SPACE           TO PB-CI-OB-FLAG.
 15586
 15587     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15588         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15589     ELSE
 15590         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15591
 15592     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15593        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15594            MOVE ER-2760         TO WS-ERROR
 15595            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15596
 15597     IF LF-COVERAGE-CANCELLED
 15598        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15599         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15600            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15601               MOVE ER-2774       TO WS-ERROR
 15602               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15603
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 282
* EL050.cbl
 15604     IF AH-COVERAGE-CANCELLED
 15605        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15606         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15607            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15608               MOVE ER-2775       TO WS-ERROR
 15609               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15610
 15611     IF LF-COVERAGE-CANCELLED
 15612        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15613         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15614            MOVE ER-2776         TO WS-ERROR
 15615            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15616
 15617     IF AH-COVERAGE-CANCELLED
 15618        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15619         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15620            MOVE ER-2777         TO WS-ERROR
 15621            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15622
 15623     IF LF-COVERAGE-CANCELLED
 15624        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15625        if pb-ci-lf-expire-dt = low-values or spaces
 15626           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15627           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15628           MOVE PB-CI-EXTENTION-DAYS
 15629                                 TO DC-ELAPSED-DAYS
 15630           SET BIN-PLUS-ELAPSED  TO TRUE
 15631           PERFORM 8500-DATE-CONVERT
 15632                                 THRU 8500-EXIT
 15633           IF DATE-CONVERSION-ERROR
 15634              move low-values    to dc-bin-date-2
 15635           end-if
 15636        else
 15637           move pb-ci-lf-expire-dt
 15638                                 to dc-bin-date-2
 15639        end-if
 15640        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15641           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15642                             OR  'FIA'
 15643              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15644           ELSE
 15645              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15646              MOVE ER-2731       TO WS-ERROR
 15647              PERFORM 9900-ERROR-FORMAT
 15648                                 THRU 9900-EXIT
 15649           end-if
 15650        end-if
 15651     end-if
 15652*    IF LF-COVERAGE-CANCELLED
 15653*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15654*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15655*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15656*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15657*        SET BIN-PLUS-ELAPSED      TO TRUE
 15658*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15659*        IF DATE-CONVERSION-ERROR
 15660*           NEXT SENTENCE
 15661*         ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 283
* EL050.cbl
 15662*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15663*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15664*                            OR  'FIA'
 15665*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15666*              ELSE
 15667*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15668*               MOVE ER-2731       TO WS-ERROR
 15669*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15670     .
 15671 3705-EDIT-AH-CANCEL-DT.
 15672     IF AH-COVERAGE-CANCELLED
 15673        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15674        if pb-ci-AH-expire-dt = low-values or spaces
 15675           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15676           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15677           MOVE PB-CI-EXTENTION-DAYS
 15678                                 TO DC-ELAPSED-DAYS
 15679           SET BIN-PLUS-ELAPSED  TO TRUE
 15680           PERFORM 8500-DATE-CONVERT
 15681                                 THRU 8500-EXIT
 15682           IF DATE-CONVERSION-ERROR
 15683              move low-values    to dc-bin-date-2
 15684           end-if
 15685        else
 15686           move pb-ci-ah-expire-dt
 15687                                 to dc-bin-date-2
 15688        end-if
 15689        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15690           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15691                             OR  'FIA'
 15692              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15693           ELSE
 15694              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15695              MOVE ER-2771       TO WS-ERROR
 15696              PERFORM 9900-ERROR-FORMAT
 15697                                 THRU 9900-EXIT
 15698           end-if
 15699        end-if
 15700     end-if
 15701*    IF AH-COVERAGE-CANCELLED
 15702*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15703*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15704*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15705*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15706**       MOVE 6                    TO DC-OPTION-CODE
 15707*        SET BIN-PLUS-ELAPSED      TO TRUE
 15708*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15709*        IF DATE-CONVERSION-ERROR
 15710*           NEXT SENTENCE
 15711*         ELSE
 15712*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15713*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15714*                             OR 'FIA'
 15715*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15716*             ELSE
 15717*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15718*              MOVE ER-2771       TO WS-ERROR
 15719*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 284
* EL050.cbl
 15720     .
 15721 3705-EDIT-CONTINUED.
 15722
 15723*    IF LF-COVERAGE-CANCELLED
 15724*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15725*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15726*            MOVE ER-2727         TO WS-ERROR
 15727*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15728*
 15729*    IF AH-COVERAGE-CANCELLED
 15730*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15731*        IF PB-COMPANY-ID = 'ACE'
 15732*           MOVE ER-2727        TO WS-ERROR
 15733*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15734*        ELSE
 15735*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15736*              MOVE ER-2727     TO WS-ERROR
 15737*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15738
 15739     IF PB-COMPANY-ID = 'ACE'
 15740       IF AH-COVERAGE-CANCELLED
 15741         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15742           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15743              MOVE ER-2732      TO WS-ERROR
 15744              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15745
 15746     IF PB-COMPANY-ID      EQUAL   'HER'
 15747        IF WS-ERROR        EQUAL   ER-2727
 15748            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15749            MOVE  ER-2725          TO  WS-ERROR
 15750            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15751
 15752     IF PB-C-CLAIM-CREATED-CANCEL
 15753            MOVE ER-2748         TO WS-ERROR
 15754            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15755
 15756     IF PB-C-LAST-NAME NOT = SPACES
 15757         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15758            MOVE ER-2747         TO WS-ERROR
 15759            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15760
 15761 3710-EDIT-LUMP-SUM-PRIOR.
 15762
 15763     IF AH-COVERAGE-CANCELLED
 15764         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15765             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15766                MOVE ER-2735    TO WS-ERROR
 15767                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15768
 15769     IF LF-COVERAGE-CANCELLED
 15770         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15771             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15772                MOVE ER-2735    TO WS-ERROR
 15773                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15774
 15775 3710-EDIT-PRIOR-DEATH.
 15776
 15777*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 285
* EL050.cbl
 15778*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15779*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15780*           (NOT PB-CI-OB)
 15781*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15782*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15783*                   MOVE ER-2732  TO WS-ERROR
 15784*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15785*
 15786*    IF AH-COVERAGE-CANCELLED
 15787*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15788*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15789*           (NOT PB-CI-OB)
 15790*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15791*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15792*                   MOVE ER-2732  TO WS-ERROR
 15793*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15794
 15795     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15796         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15797            (NOT PB-COMP-LF-CANCEL)
 15798             NEXT SENTENCE
 15799         ELSE
 15800           IF PB-C-LF-CANCEL-VOIDED
 15801              NEXT SENTENCE
 15802           ELSE
 15803              MOVE ER-2753      TO WS-ERROR
 15804              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15805
 15806     IF CANCEL-FUTURE-DT
 15807         GO TO 3999-END-EDIT.
 15808
 15809 3715-GET-REMAIN-TERM-LF.
 15810
 15811     IF NO-LF-BENEFIT-MATCH  OR
 15812        WS-LF-BENEFIT-CD = ZEROS
 15813        GO TO 3730-GET-AH-REMAIN-TERM.
 15814
 15815     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15816     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15817     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15818     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15819     MOVE PB-SV-STATE            TO CP-STATE.
 15820     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15821     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15822     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15823     MOVE '2'                    TO CP-PROCESS-TYPE.
 15824     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15825     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15826     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15827     IF (PB-COMPANY-ID = 'CID')
 15828        AND (CP-STATE-STD-ABBRV = 'WI')
 15829        MOVE '7'                 TO CP-REM-TERM-METHOD
 15830        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15831     ELSE
 15832        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15833        MOVE WS-REM-TRM-CALC-OPTION
 15834                                 TO CP-REM-TRM-CALC-OPTION
 15835     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 286
* EL050.cbl
 15836**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15837     IF (PB-COMPANY-ID = 'CID')
 15838        AND (CP-STATE-STD-ABBRV = 'MO')
 15839        AND (PB-CERT-EFF-DT >= X'9B41')
 15840        AND (PB-CERT-EFF-DT <= X'A2FB')
 15841        MOVE '7'                 TO CP-REM-TERM-METHOD
 15842        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15843     END-IF
 15844     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15845                                    CP-LOAN-TERM.
 15846     IF CP-TRUNCATED-LIFE
 15847        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15848
 15849     IF CP-TERM-IS-DAYS
 15850         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15851     ELSE
 15852         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15853
 15854     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15855
 15856     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15857
 15858     IF LF-COVERAGE-CANCELLED
 15859        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15860        NEXT SENTENCE
 15861      ELSE
 15862          GO TO 3730-GET-AH-REMAIN-TERM.
 15863
 15864 3720-GET-LF-REFUND.
 15865
 15866     IF PB-C-LF-CANCEL-VOIDED
 15867        GO TO 3730-GET-AH-REMAIN-TERM
 15868     end-if
 15869
 15870     IF PB-COMPANY-ID EQUAL 'BOA'
 15871         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15872         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15873         GO TO 3730-GET-AH-REMAIN-TERM.
 15874
 15875     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15876        (WS-AH-SPECIAL-CALC-CD = 'M')
 15877         MOVE ER-2767            TO WS-ERROR
 15878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15879         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15880         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15881         GO TO 3780-UPDATE-CANCEL-CERT.
 15882
 15883*    if (ws-lf-earnings-calc = '6')
 15884*       or (pb-c-lf-refund-override = '6')
 15885*       move cp-remaining-term-1 to cp-remaining-term-2
 15886*    end-if
 15887     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15888
 15889     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15890     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15891     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15892     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15893     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 287
* EL050.cbl
 15894     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15895     IF (PB-COMPANY-ID = 'DCC')
 15896        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15897        IF PDEF-MASTER-FOUND
 15898           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15899              (V1 > +8)
 15900              OR (PD-PROD-CODE (V1) = 'L')
 15901           END-PERFORM
 15902           IF V1 < +9
 15903              MOVE PD-MAX-AMT (V1)
 15904                           TO CP-R-MAX-TOT-BEN
 15905                              EC-AM-LF-MAX-TOT-BEN
 15906           END-IF
 15907        ELSE
 15908        MOVE ' '                 TO PDEF-MASTER-SW
 15909        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15910        MOVE PB-STATE            TO ERPDEF-STATE
 15911        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15912        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15913        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15914        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15915        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15916        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15917        IF PDEF-MASTER-FOUND
 15918           MOVE 'N'              TO PDEF-MASTER-SW
 15919           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15920           IF PDEF-MASTER-FOUND
 15921              IF (ERPDEF-KEY-SAVE (1:16) =
 15922                           PD-CONTROL-PRIMARY (1:16))
 15923                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15924                 CONTINUE
 15925              ELSE
 15926                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15927                 IF (ERPDEF-KEY-SAVE (1:16) =
 15928                           PD-CONTROL-PRIMARY (1:16))
 15929                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15930                    CONTINUE
 15931                 ELSE
 15932                    MOVE 'N'     TO PDEF-MASTER-SW
 15933                 END-IF
 15934              END-IF
 15935
 15936              IF PDEF-MASTER-FOUND
 15937                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15938                    (V1 > +8)
 15939                    OR (PD-PROD-CODE (V1) = 'L')
 15940                 END-PERFORM
 15941                 IF V1 < +9
 15942                    MOVE PD-MAX-AMT (V1)
 15943                                 TO CP-R-MAX-TOT-BEN
 15944                                    EC-AM-LF-MAX-TOT-BEN
 15945                 END-IF
 15946              END-IF
 15947           END-IF
 15948           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15949        END-IF
 15950        END-IF
 15951     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 288
* EL050.cbl
 15952     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15953
 15954     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15955
 15956     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15957                                    PB-C-LF-REM-TERM.
 15958
 15959     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15960     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15961
 15962     IF PB-COMPANY-ID EQUAL 'FLC'
 15963        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15964           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15965           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15966                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15967                    - CM-LF-ITD-DEATH-AMT
 15968           IF PB-C-LF-REF-CALC LESS THAN +0
 15969              MOVE +0            TO PB-C-LF-REF-CALC
 15970              GO TO 3730-GET-AH-REMAIN-TERM
 15971           ELSE
 15972              GO TO 3730-GET-AH-REMAIN-TERM.
 15973
 15974     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15975                            OR '4' OR '5' OR '6' OR '8'
 15976                            OR '9' OR 'G'
 15977        MOVE PB-C-LF-REFUND-OVERRIDE
 15978                                 TO CP-EARNING-METHOD.
 15979
 15980     if pb-company-id = 'AHL'
 15981        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15982        if cp-class-code = spaces
 15983           move zeros            to cp-class-code
 15984        end-if
 15985     ELSE
 15986        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15987     END-IF
 15988*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15989     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15990     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15991                                    CP-RATING-BENEFIT-AMT.
 15992     IF CP-STATE-STD-ABBRV = 'OR'
 15993         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15994                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15995     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15996     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15997     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15998     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15999     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16000     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16001     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16002     IF WS-DEFAULT-APR NOT NUMERIC
 16003         MOVE ZEROS TO WS-DEFAULT-APR.
 16004****   N O T E   ****
 16005*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16006*      THE OH HARD CODING IN ELCRFNDP
 16007
 16008     IF PB-COMPANY-ID = 'CID'
 16009        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 289
* EL050.cbl
 16010           MOVE WS-LF-EARNINGS-CALC
 16011                                 TO CP-EARNING-METHOD
 16012        END-IF
 16013     END-IF
 16014
 16015****   N O T E   ****
 16016
 16017     IF CP-EARN-AS-NET-PAY
 16018         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16019            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16020                MOVE WS-DEFAULT-APR
 16021                                 TO  CP-LOAN-APR
 16022                MOVE ER-3780     TO  WS-ERROR
 16023                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16024            ELSE
 16025                MOVE ER-3781     TO  WS-ERROR
 16026                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16027*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16028     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16029
 16030     IF CP-REFUND-TYPE-USED NOT = SPACE
 16031         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16032
 16033     IF CP-ERROR-RATE-IS-ZERO OR
 16034        CP-ERROR-RATE-NOT-FOUND
 16035        MOVE ER-2740             TO WS-ERROR
 16036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16037
 16038     IF CP-ERROR-RATE-FILE-NOTOPEN
 16039        MOVE ER-2617             TO WS-ERROR
 16040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16041
 16042     IF PB-COMPANY-ID = 'DCC'
 16043        AND PB-CI-ENTRY-STATUS = 'M'
 16044        MOVE +0                  TO PB-C-LF-REF-CALC
 16045     ELSE
 16046        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16047     END-IF
 16048
 16049     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16050         GO TO 3730-GET-AH-REMAIN-TERM.
 16051
 16052*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16053*       ADD +1                   TO PB-C-LF-REM-TERM
 16054*                                   CP-REMAINING-TERM
 16055*                                   CP-ORIGINAL-TERM.
 16056
 16057     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16058     MOVE '2'                    TO CP-EARNING-METHOD
 16059                                    CP-RATING-METHOD.
 16060     IF PB-COMPANY-ID = 'CID'
 16061        IF (CP-STATE-STD-ABBRV = 'MN')
 16062           AND (PB-CERT-EFF-DT > X'A4FF')
 16063           AND (WS-LF-EARNINGS-CALC = 'B')
 16064           MOVE '5'              TO CP-EARNING-METHOD
 16065           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16066        END-IF
 16067     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 290
* EL050.cbl
 16068     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16069                                        CP-REMAINING-BENEFIT
 16070                                        CP-RATING-BENEFIT-AMT.
 16071     IF CP-STATE-STD-ABBRV = 'OR'
 16072         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16073                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16074     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16075     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16076
 16077     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16078
 16079     IF CP-ERROR-RATE-IS-ZERO OR
 16080        CP-ERROR-RATE-NOT-FOUND
 16081        MOVE ER-2740             TO WS-ERROR
 16082        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16083
 16084     IF CP-ERROR-RATE-FILE-NOTOPEN
 16085        MOVE ER-2617             TO WS-ERROR
 16086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16087
 16088     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16089
 16090******************************************************************
 16091
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 291
* EL050.cbl
 16093 3730-GET-AH-REMAIN-TERM.
 16094     IF NO-AH-BENEFIT-MATCH  OR
 16095        WS-AH-BENEFIT-CD = ZEROS
 16096         GO TO 3770-CHECK-REFUNDS.
 16097
 16098     IF PB-CI-AH-LUMP-SUM-DISAB
 16099         IF  PB-C-AH-CANCEL-AMT = ZERO
 16100            IF NOT PB-COMP-AH-CANCEL
 16101             GO TO 3770-CHECK-REFUNDS.
 16102
 16103     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16104     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16105     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16106     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16107     MOVE PB-SV-STATE            TO CP-STATE.
 16108     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16109     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16110     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16111     MOVE '2'                    TO CP-PROCESS-TYPE.
 16112     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16113     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16114     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16115     IF (PB-COMPANY-ID = 'CID')
 16116        AND (CP-STATE-STD-ABBRV = 'WI')
 16117        MOVE '7'                 TO CP-REM-TERM-METHOD
 16118        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16119     ELSE
 16120        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16121        MOVE WS-REM-TRM-CALC-OPTION
 16122                                 TO CP-REM-TRM-CALC-OPTION
 16123     END-IF
 16124     IF (PB-COMPANY-ID = 'CID')
 16125        AND (CP-STATE-STD-ABBRV = 'MO')
 16126        AND (PB-CERT-EFF-DT >= X'9B41')
 16127        AND (PB-CERT-EFF-DT <= X'A2FB')
 16128        MOVE '7'                 TO CP-REM-TERM-METHOD
 16129        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16130     END-IF
 16131     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16132                                    CP-LOAN-TERM.
 16133     IF NOT CP-TERM-IS-DAYS
 16134         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16135
 16136     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16137
 16138     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16139
 16140     IF AH-COVERAGE-CANCELLED
 16141        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16142        NEXT SENTENCE
 16143      ELSE
 16144         GO TO 3770-CHECK-REFUNDS.
 16145
 16146 3740-GET-AH-REFUND.
 16147
 16148     IF PB-C-AH-CANCEL-VOIDED
 16149        GO TO 3780-UPDATE-CANCEL-CERT
 16150     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 292
* EL050.cbl
 16151
 16152     IF PB-COMPANY-ID = 'BOA'
 16153         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16154         GO TO 3770-CHECK-REFUNDS.
 16155
 16156     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16157*    MOVE ' '                    TO DC-OPTION-CODE
 16158     SET BIN-TO-GREG             TO TRUE
 16159     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16160     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16161                                    PB-C-AH-REM-TERM.
 16162     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16163     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16164
 16165     IF PB-COMPANY-ID EQUAL 'FLC'
 16166        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16167           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16168           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16169                    - CM-AH-ITD-AH-PMT)
 16170           IF PB-C-AH-REF-CALC LESS THAN +0
 16171              MOVE +0            TO PB-C-AH-REF-CALC
 16172              GO TO 3770-CHECK-REFUNDS
 16173           ELSE
 16174              GO TO 3770-CHECK-REFUNDS.
 16175
 16176     IF PB-COMPANY-ID = 'DCC'
 16177        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16178            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16179           MOVE 'S'              TO CP-EARNING-METHOD
 16180        END-IF
 16181     END-IF
 16182     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16183                            OR '4' OR '5' OR '6' OR '8'
 16184                            OR '9' OR 'G' OR 'S'
 16185        MOVE PB-C-AH-REFUND-OVERRIDE
 16186                                 TO CP-EARNING-METHOD.
 16187
 16188     if pb-company-id = 'AHL'
 16189        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16190        if cp-class-code = spaces
 16191           move zeros            to cp-class-code
 16192        end-if
 16193     ELSE
 16194        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16195     END-IF
 16196*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16197     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16198     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16199                                    CP-RATING-BENEFIT-AMT.
 16200     IF CP-STATE-STD-ABBRV = 'OR'
 16201         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16202                                         PB-CI-AH-TERM.
 16203     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16204     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16205     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16206     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16207     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16208     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 293
* EL050.cbl
 16209
 16210     IF CP-STATE-STD-ABBRV = 'OH'
 16211        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16212                                AND 'CID' AND 'DCC' AND 'AHL')
 16213           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16214              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16215              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16216              MOVE '6' TO CP-EARNING-METHOD
 16217           END-IF
 16218        END-IF
 16219        IF PB-COMPANY-ID = 'CID'
 16220           IF NO-LIFE-COVERAGE
 16221              IF CP-CRITICAL-PERIOD
 16222                 MOVE '2'       TO CP-EARNING-METHOD
 16223              ELSE
 16224                 MOVE '6'       TO CP-EARNING-METHOD
 16225              END-IF
 16226           ELSE
 16227              IF WS-LF-COVERAGE-TYPE = 'L'
 16228                 MOVE '2'       TO CP-EARNING-METHOD
 16229              ELSE
 16230                 IF (PB-CI-LF-TERM > +60) OR
 16231                    (WS-LF-EARNINGS-CALC = '5')
 16232                    IF CP-CRITICAL-PERIOD
 16233                       MOVE '2'  TO CP-EARNING-METHOD
 16234                    ELSE
 16235                       MOVE '6'  TO CP-EARNING-METHOD
 16236                    END-IF
 16237                 ELSE
 16238                    MOVE '1'     TO CP-EARNING-METHOD
 16239                 END-IF
 16240              END-IF
 16241           END-IF
 16242        END-IF
 16243     END-IF
 16244
 16245*    IF CP-STATE-STD-ABBRV = 'VA'
 16246*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16247*          IF CP-ORIGINAL-TERM GREATER 61
 16248*             MOVE '6' TO CP-EARNING-METHOD
 16249*          ELSE
 16250*             MOVE '1' TO CP-EARNING-METHOD.
 16251
 16252     IF WS-DEFAULT-APR NOT NUMERIC
 16253         MOVE ZEROS TO WS-DEFAULT-APR.
 16254     IF CP-EARN-AS-NET-PAY
 16255         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16256            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16257                MOVE WS-DEFAULT-APR
 16258                                 TO  CP-LOAN-APR
 16259                MOVE ER-3780     TO  WS-ERROR
 16260                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16261            ELSE
 16262                MOVE ER-3781     TO  WS-ERROR
 16263                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16264     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16265     IF PB-COMPANY-ID = 'DCC'
 16266        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 294
* EL050.cbl
 16267        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16268        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16269     END-IF
 16270     IF PB-COMPANY-ID = 'DCC'
 16271        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16272        AND (CP-EARNING-METHOD = 'D')
 16273        AND (CP-CANCEL-REASON NOT = 'R')
 16274        CONTINUE
 16275     ELSE
 16276        GO TO 3750-CONTINUE
 16277     END-IF
 16278     MOVE ' '                    TO DD-IU-SW
 16279     IF NOT PDEF-MASTER-FOUND
 16280        MOVE ' '                 TO PDEF-MASTER-SW
 16281        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16282        MOVE PB-STATE            TO ERPDEF-STATE
 16283        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16284        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16285        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16286        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16287        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16288        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16289        IF PDEF-MASTER-FOUND
 16290           MOVE 'N'              TO PDEF-MASTER-SW
 16291           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16292           IF PDEF-MASTER-FOUND
 16293              IF (ERPDEF-KEY-SAVE (1:16) =
 16294                           PD-CONTROL-PRIMARY (1:16))
 16295                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16296                 CONTINUE
 16297              ELSE
 16298                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16299                 IF (ERPDEF-KEY-SAVE (1:16) =
 16300                           PD-CONTROL-PRIMARY (1:16))
 16301                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16302                    CONTINUE
 16303                 ELSE
 16304                    MOVE ER-2740 TO WS-ERROR
 16305                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16306                    GO TO 3770-CHECK-REFUNDS
 16307                 END-IF
 16308              END-IF
 16309           END-IF
 16310           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16311        END-IF
 16312     END-IF
 16313     IF PDEF-MASTER-FOUND
 16314        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16315           (V1 > +8)
 16316           OR (PD-PROD-CODE (V1) = 'I')
 16317        END-PERFORM
 16318        IF V1 < +9
 16319           SET DD-IU-PRESENT        TO TRUE
 16320        END-IF
 16321        IF WS-AH-DCC-TRUNC = 'T'
 16322           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16323        ELSE
 16324           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 295
* EL050.cbl
 16325        END-IF
 16326        EVALUATE TRUE
 16327           WHEN WS-TERM > +168
 16328              MOVE 15               TO V1
 16329           WHEN WS-TERM > +156
 16330              MOVE 14               TO V1
 16331           WHEN WS-TERM > +144
 16332              MOVE 13               TO V1
 16333           WHEN WS-TERM > +132
 16334              MOVE 12               TO V1
 16335           WHEN WS-TERM > +120
 16336              MOVE 11               TO V1
 16337           WHEN WS-TERM > +108
 16338              MOVE 10               TO V1
 16339           WHEN WS-TERM > +96
 16340              MOVE 9                TO V1
 16341           WHEN WS-TERM > +84
 16342              MOVE 8                TO V1
 16343           WHEN WS-TERM > +72
 16344              MOVE 7                TO V1
 16345           WHEN WS-TERM > +60
 16346              MOVE 6                TO V1
 16347           WHEN WS-TERM > +48
 16348              MOVE 5                TO V1
 16349           WHEN WS-TERM > +36
 16350              MOVE 4                TO V1
 16351           WHEN WS-TERM > +24
 16352              MOVE 3                TO V1
 16353           WHEN WS-TERM > +12
 16354              MOVE 2                TO V1
 16355           WHEN OTHER
 16356              MOVE 1                TO V1
 16357        END-EVALUATE
 16358
 16359        EVALUATE TRUE
 16360*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16361*             < +13)
 16362*             AND (DD-IU-PRESENT)
 16363*             MOVE 2                TO V2
 16364*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16365*             MOVE 1                TO V2
 16366           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16367              MOVE 2                TO V2
 16368           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16369              MOVE 3                TO V2
 16370           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16371              MOVE 4                TO V2
 16372           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16373              MOVE 5                TO V2
 16374           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16375              MOVE 6                TO V2
 16376           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16377              MOVE 7                TO V2
 16378           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16379              MOVE 8                TO V2
 16380           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16381              MOVE 9                TO V2
 16382           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 296
* EL050.cbl
 16383              MOVE 10               TO V2
 16384           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16385              MOVE 11               TO V2
 16386           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16387              MOVE 12               TO V2
 16388           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16389              MOVE 13               TO V2
 16390           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16391              MOVE 14               TO V2
 16392           WHEN OTHER
 16393              MOVE 15               TO V2
 16394        END-EVALUATE
 16395
 16396        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16397                                 TO CP-DDF-LO-FACT
 16398        MOVE PD-UEP-FACTOR (V1 V2)
 16399                                 TO CP-DDF-HI-FACT
 16400
 16401        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16402        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16403        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16404           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16405        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16406        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16407        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16408           + PD-1ST-YR-ADMIN-ALLOW
 16409
 16410        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16411*       IF PI-CLP-YN = 'Y'
 16412*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16413*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16414*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16415*       END-IF
 16416
 16417        IF DD-IU-PRESENT
 16418           MOVE 'I'              TO CP-EARNING-METHOD
 16419        END-IF
 16420        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16421                                     CP-CLP-RATE-UP
 16422        IF CP-IU-RATE-UP NOT = ZEROS
 16423           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16424              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16425           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16426              / (1 - WS-WORK-FACT)
 16427        END-IF
 16428     END-IF
 16429     .
 16430 3750-CONTINUE.
 16431     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16432
 16433     IF CP-REFUND-TYPE-USED NOT = SPACE
 16434         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16435
 16436     IF CP-ERROR-RATE-IS-ZERO OR
 16437        CP-ERROR-RATE-NOT-FOUND
 16438        MOVE ER-2740             TO WS-ERROR
 16439        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16440
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 297
* EL050.cbl
 16441     IF CP-ERROR-RATE-FILE-NOTOPEN
 16442        MOVE ER-2617             TO WS-ERROR
 16443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16444     IF PB-COMPANY-ID = 'DCC'
 16445        AND PB-CI-ENTRY-STATUS = 'M'
 16446        MOVE +0                  TO PB-C-AH-REF-CALC
 16447     ELSE
 16448        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16449     END-IF
 16450     IF PB-COMPANY-ID = 'DCC'
 16451        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16452        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16453        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16454        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16455        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16456        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16457        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16458        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16459*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16460     END-IF
 16461     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 298
* EL050.cbl
 16463
 16464 3770-CHECK-REFUNDS.
 16465
 16466     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16467        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16468           MOVE ER-2766          TO WS-ERROR
 16469           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16470           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16471           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16472              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16473
 16474     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16475        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16476           MOVE ER-2766          TO WS-ERROR
 16477           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16478           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16479           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16480              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16481
 16482     IF PB-COMP-LF-CANCEL
 16483        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16484        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16485           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16486              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16487
 16488     IF PB-COMP-AH-CANCEL
 16489        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16490        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16491           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16492              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16493
 16494     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16495             GIVING WS-UNSIGN-WRK1
 16496     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16497             GIVING WS-UNSIGN-WRK2.
 16498
 16499     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16500         MOVE ZERO TO WS-UNSIGN-WRK1.
 16501
 16502     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16503         MOVE ZERO TO WS-UNSIGN-WRK2.
 16504
 16505     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16506
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 299
* EL050.cbl
 16508
 16509 3772-CONTINUE.
 16510
 16511**********************************
 16512*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16513*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16514*** DOUBLES THE TOLERANCE AMOUNT.
 16515***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16516**********************************
 16517     IF PB-COMPANY-ID = 'MON'
 16518     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16519         IF WS-REF-REJECT-SW = SPACE
 16520             MOVE ER-2754        TO WS-ERROR
 16521             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16522           ELSE
 16523             MOVE ER-2736        TO WS-ERROR
 16524             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16525**********************************
 16526
 16527 3773-CONTINUE.
 16528
 16529     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16530        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16531           MOVE ER-2723          TO WS-ERROR
 16532           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16533
 16534     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16535        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16536           MOVE ER-2724          TO WS-ERROR
 16537           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16538
 16539     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16540         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16541             (1 + WS-LF-REFUND-OVS-PCT)
 16542     ELSE
 16543         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16544
 16545     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16546         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16547             (1 - WS-TOL-LF-REFUND-PCT)
 16548     ELSE
 16549         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16550
 16551     IF (PB-COMPANY-ID = 'DCC')
 16552        AND (PB-CI-ENTRY-STATUS = 'M')
 16553        AND (PB-C-LF-CANCEL-AMT > +0)
 16554        MOVE ER-3843             TO WS-ERROR
 16555        PERFORM 9900-ERROR-FORMAT
 16556                                 THRU 9900-EXIT
 16557     END-IF
 16558     EVALUATE TRUE
 16559        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16560           CONTINUE
 16561        WHEN PB-C-LF-CANCEL-AMT = +0
 16562                 AND PB-C-LF-REF-CALC > +0
 16563           CONTINUE
 16564        WHEN WS-LF-REFUND-OVS-AMT = 0
 16565                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 300
* EL050.cbl
 16566           CONTINUE
 16567        WHEN OTHER
 16568           IF WS-TOL-LF-REFUND  = +0
 16569              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16570           END-IF
 16571           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16572                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16573                          (PB-C-LF-CANCEL-AMT))
 16574              CONTINUE
 16575           ELSE
 16576              IF WS-LF-REFUND-OVS-AMT = +0
 16577                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16578              END-IF
 16579              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16580                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16581                                       PB-C-LF-CANCEL-AMT)
 16582                 CONTINUE
 16583              ELSE
 16584                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16585                   MOVE ER-2754   TO  WS-ERROR
 16586                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16587                 ELSE
 16588                    MOVE ER-2736   TO  WS-ERROR
 16589                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16590                 END-IF
 16591              END-IF
 16592           END-IF
 16593     END-EVALUATE.
 16594
 16595     EVALUATE TRUE
 16596        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16597           CONTINUE
 16598        WHEN PB-C-LF-CANCEL-AMT = +0
 16599                 AND PB-C-LF-REF-CALC > +0
 16600           CONTINUE
 16601        WHEN OTHER
 16602           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16603               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16604              CONTINUE
 16605           ELSE
 16606              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16607               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16608                CONTINUE
 16609              ELSE
 16610                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16611                     MOVE ER-2754   TO  WS-ERROR
 16612                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16613                 ELSE
 16614                     MOVE ER-2736   TO  WS-ERROR
 16615                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16616                 END-IF
 16617              END-IF
 16618           END-IF
 16619     END-EVALUATE.
 16620
 16621     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16622         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16623             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 301
* EL050.cbl
 16624     ELSE
 16625         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16626
 16627     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16628         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16629             (1 - WS-TOL-AH-REFUND-PCT)
 16630     ELSE
 16631         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16632
 16633     IF (PB-COMPANY-ID = 'DCC')
 16634        AND (PB-CI-ENTRY-STATUS = 'M')
 16635        AND (PB-C-AH-CANCEL-AMT > +0)
 16636        MOVE ER-3843             TO WS-ERROR
 16637        PERFORM 9900-ERROR-FORMAT
 16638                                 THRU 9900-EXIT
 16639     END-IF
 16640     EVALUATE TRUE
 16641        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16642           CONTINUE
 16643*       WHEN PB-C-AH-REF-CALC = +0 AND
 16644*                  PB-C-AH-CANCEL-AMT > +0
 16645        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16646                   PB-C-AH-REF-CALC > +0
 16647           CONTINUE
 16648        WHEN WS-AH-REFUND-OVS-AMT = +0
 16649                AND WS-TOL-AH-REFUND = +0
 16650           CONTINUE
 16651        WHEN OTHER
 16652           IF WS-TOL-AH-REFUND = +0
 16653              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16654           END-IF
 16655           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16656               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16657                                         PB-C-AH-CANCEL-AMT)
 16658              CONTINUE
 16659           ELSE
 16660              IF WS-AH-REFUND-OVS-AMT = +0
 16661                 MOVE +9999999.99 TO
 16662                         WS-AH-REFUND-OVS-AMT
 16663              END-IF
 16664              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16665                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16666                                         PB-C-AH-CANCEL-AMT)
 16667                 CONTINUE
 16668              ELSE
 16669                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16670                    MOVE ER-2754   TO  WS-ERROR
 16671                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16672                 ELSE
 16673                    MOVE ER-2736   TO  WS-ERROR
 16674                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16675                 END-IF
 16676              END-IF
 16677           END-IF
 16678     END-EVALUATE.
 16679
 16680     EVALUATE TRUE
 16681        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 302
* EL050.cbl
 16682           CONTINUE
 16683*       WHEN PB-C-AH-REF-CALC > +0 AND
 16684*                  PB-C-AH-CANCEL-AMT = +0
 16685        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16686                   PB-C-AH-REF-CALC = +0
 16687           CONTINUE
 16688        WHEN OTHER
 16689           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16690               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16691              CONTINUE
 16692           ELSE
 16693              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16694                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16695                 CONTINUE
 16696              ELSE
 16697                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16698                     MOVE ER-2754   TO  WS-ERROR
 16699                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16700                 ELSE
 16701                     MOVE ER-2736   TO  WS-ERROR
 16702                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16703                 END-IF
 16704              END-IF
 16705           END-IF
 16706     END-EVALUATE.
 16707
 16708     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16709        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16710        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16711           AND  PB-C-LF-REF-CALC < +1.00
 16712           AND  PB-C-AH-REF-CALC < +1.00
 16713           CONTINUE
 16714        ELSE
 16715           IF (PB-COMPANY-ID = 'DCC')
 16716              AND (PB-CI-ENTRY-STATUS = 'M')
 16717              CONTINUE
 16718           ELSE
 16719              MOVE ER-2741       TO WS-ERROR
 16720              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16721           END-IF
 16722        END-IF
 16723     END-IF
 16724
 16725     IF (PB-C-LF-CANCEL-AMT = ZERO
 16726        AND WS-LF-BENEFIT-CD NOT = ZERO
 16727        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16728        AND PB-C-LF-REF-CALC NOT = ZERO)
 16729        OR
 16730        (PB-C-LF-CANCEL-AMT = ZERO
 16731        AND WS-LF-BENEFIT-CD NOT = ZERO
 16732        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16733             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16734                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16735                NEXT SENTENCE
 16736             ELSE
 16737                MOVE ER-2739        TO WS-ERROR
 16738                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16739
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 303
* EL050.cbl
 16740     IF (PB-C-AH-CANCEL-AMT = ZERO
 16741        AND WS-AH-BENEFIT-CD NOT = ZERO
 16742        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16743        AND PB-C-AH-REF-CALC NOT = ZERO)
 16744        OR
 16745        (PB-C-AH-CANCEL-AMT = ZERO
 16746        AND WS-AH-BENEFIT-CD NOT = ZERO
 16747        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16748             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16749                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16750                NEXT SENTENCE
 16751             ELSE
 16752                MOVE ER-2738        TO WS-ERROR
 16753                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16754
 16755 3775-OVER-REF-CHK.
 16756
 16757     IF PB-CI-ENTRY-STATUS = '5'
 16758        GO TO 3780-UPDATE-CANCEL-CERT.
 16759
 16760     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16761                              PB-CI-LF-ALT-PREMIUM-AMT.
 16762
 16763     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16764        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16765                                 PB-C-LF-REF-CALC
 16766      ELSE
 16767        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16768                                 PB-C-LF-CANCEL-AMT.
 16769
 16770     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16771        MOVE ER-2755             TO WS-ERROR
 16772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16773
 16774     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16775
 16776     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16777        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16778                                 PB-C-AH-REF-CALC
 16779      ELSE
 16780        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16781                                 PB-C-AH-CANCEL-AMT.
 16782
 16783     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16784        MOVE ER-2778             TO WS-ERROR
 16785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16786
 16787     IF PB-CI-OB-FLAG NOT = 'Z'
 16788        NEXT SENTENCE
 16789       ELSE
 16790         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16791            MOVE ER-2757           TO WS-ERROR
 16792            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16793
 16794 3780-UPDATE-CANCEL-CERT.
 16795
 16796     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16797        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 304
* EL050.cbl
 16798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16799
 16800     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16801         MOVE ER-2729              TO WS-ERROR
 16802         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16803
 16804     IF PB-CI-LF-BENEFIT-CD = ZERO
 16805         GO TO 3780-UPDATE-CONT-1.
 16806
 16807     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16808         GO TO 3780-UPDATE-CONT-1.
 16809
 16810     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16811       AND
 16812        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16813       AND
 16814        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16815       AND
 16816        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16817            NEXT SENTENCE
 16818       ELSE
 16819        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16820          AND
 16821***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16822***       AND
 16823           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16824            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16825               MOVE ER-2730      TO WS-ERROR
 16826               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16827               GO TO 3999-END-EDIT
 16828            ELSE
 16829               GO TO 3999-END-EDIT
 16830        ELSE
 16831            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16832               MOVE ER-2765           TO WS-ERROR
 16833               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16834               GO TO 3785-CHECK-NH.
 16835*              GO TO 3999-END-EDIT.
 16836
 16837 3780-UPDATE-CONT-1.
 16838     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16839
 16840     IF PB-CI-AH-BENEFIT-CD = ZERO
 16841         GO TO 3780-UPDATE-CONT-2.
 16842
 16843     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16844         GO TO 3780-UPDATE-CONT-2.
 16845
 16846     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16847
 16848     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16849       AND
 16850        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16851       AND
 16852        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16853       AND
 16854        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16855            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 305
* EL050.cbl
 16856       ELSE
 16857        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16858          AND
 16859***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16860***       AND
 16861           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16862           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16863            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16864               MOVE ER-2773      TO WS-ERROR
 16865               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16866               GO TO 3999-END-EDIT
 16867            ELSE
 16868               GO TO 3999-END-EDIT
 16869            END-IF
 16870           ELSE
 16871             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16872                MOVE ER-2890 TO WS-ERROR
 16873                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16874                GO TO 3999-END-EDIT
 16875             ELSE
 16876                GO TO 3785-CHECK-NH
 16877             END-IF
 16878           END-IF
 16879          ELSE
 16880            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16881              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16882                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16883                   MOVE ER-2890 TO WS-ERROR
 16884                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16885                   GO TO 3999-END-EDIT
 16886                ELSE
 16887                   MOVE ER-2765 TO WS-ERROR
 16888                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16889                   GO TO 3785-CHECK-NH
 16890                END-IF
 16891              ELSE
 16892               MOVE ER-2765      TO WS-ERROR
 16893               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16894               GO TO 3785-CHECK-NH.
 16895*              GO TO 3999-END-EDIT.
 16896
 16897 3780-UPDATE-CONT-2.
 16898
 16899     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16900        AND WS-LF-BENEFIT-CD = ZERO
 16901           MOVE ER-2743           TO WS-ERROR
 16902           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16903
 16904     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16905        AND WS-AH-BENEFIT-CD = ZERO
 16906           MOVE ER-2744           TO WS-ERROR
 16907           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16908
 16909     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16910        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16911        AND
 16912        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16913         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 306
* EL050.cbl
 16914           MOVE ER-2746           TO WS-ERROR
 16915           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16916
 16917     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16918       AND
 16919        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16920             MOVE ER-2737        TO WS-ERROR
 16921             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16922
 16923     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16924       AND
 16925        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16926             MOVE ER-2737        TO WS-ERROR
 16927             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16928
 16929     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16930         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16931             OR 'CID' OR 'DCC' OR 'AHL'
 16932             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16933         ELSE
 16934             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16935                 MOVE ER-2768    TO WS-ERROR
 16936                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16937             ELSE
 16938                 MOVE ER-2756    TO WS-ERROR
 16939                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16940
 16941     IF CERT-PEND-ISSUE-RETURNED
 16942        MOVE ER-2772             TO WS-ERROR
 16943        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16944 3785-CHECK-NH.
 16945     IF PB-STATE NOT = 'NH'
 16946        GO TO 3999-END-EDIT
 16947     END-IF
 16948
 16949     MOVE ER-2796                TO WS-ERROR
 16950     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16951     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16952        OR (CM-NH-INTERFACE-SW = 'Y')
 16953        MOVE ER-2793             TO WS-ERROR
 16954        PERFORM 9900-ERROR-FORMAT
 16955                                 THRU 9900-EXIT
 16956     END-IF
 16957     MOVE +0                     TO WS-PAYMENT-AMT
 16958     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16959        GO TO 3999-END-EDIT
 16960     END-IF
 16961     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16962        GO TO 3999-END-EDIT
 16963     END-IF
 16964     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16965     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16966     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16967        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16968     END-IF
 16969     MOVE '1'                    TO DC-OPTION-CODE
 16970     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16971     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 307
* EL050.cbl
 16972        IF DC-ELAPSED-DAYS < +16
 16973           GO TO 3999-END-EDIT
 16974        END-IF
 16975     END-IF
 16976     MOVE +0                     TO DC-ELAPSED-DAYS
 16977     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16978     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16979     MOVE '1'                    TO DC-OPTION-CODE
 16980     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16981     IF NO-CONVERSION-ERROR
 16982        IF DC-ELAPSED-DAYS > +30
 16983           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16984        ELSE
 16985           GO TO 3999-END-EDIT
 16986        END-IF
 16987     ELSE
 16988        GO TO 3999-END-EDIT
 16989     END-IF
 16990     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16991        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16992           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16993     IF WS-PAYMENT-AMT < 600.00
 16994        GO TO 3999-END-EDIT
 16995     END-IF
 16996     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16997
 16998     IF (ERMAIL-FOUND = ' ')
 16999         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17000         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17001        GO TO 3999-END-EDIT
 17002     END-IF
 17003     MOVE ER-2795                TO WS-ERROR
 17004     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17005
 17006     GO TO 3999-END-EDIT.
 17007******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 308
* EL050.cbl
 17009 3990-FILES-NOT-OPEN.
 17010
 17011     MOVE ER-2617                TO WS-ERROR.
 17012     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17013     GO TO 9990-RETURN.
 17014
 17015 3999-END-EDIT.
 17016
 17017     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17018
 17019     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17020         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17021         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17022             PERFORM 9250-UNLOCK-RETURN
 17023             GO TO 9990-RETURN
 17024          ELSE
 17025             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17026             GO TO 9990-RETURN.
 17027
 17028     IF PB-CANCELLATION
 17029          GO TO 9990-RETURN.
 17030
 17031     IF CERT-WAS-NOT-FOUND
 17032        MOVE SPACES              TO CERTIFICATE-MASTER.
 17033
 17034     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17035
 17036     IF CERT-WAS-FOUND
 17037         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17038             PERFORM 9250-UNLOCK-RETURN
 17039          ELSE
 17040            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17041      ELSE
 17042         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17043
 17044     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17045        IF PB-COMPANY-ID = 'DCC' AND
 17046           (PB-CARRIER = '2' OR '4' OR '6')
 17047              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17048        END-IF
 17049     END-IF.
 17050
 17051     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17052         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17053     END-IF.
 17054     move ' '                    to ws-ins-age-defaulted
 17055     perform 8150-read-elcrtt    thru 8150-exit
 17056     if ws-ins-age-defaulted = 'Y'
 17057        move er-1573             to ws-error
 17058        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17059     end-if
 17060
 17061     if ws-jnt-age-defaulted = 'Y'
 17062        move er-1574             to ws-error
 17063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17064     end-if
 17065
 17066     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 309
* EL050.cbl
 17067     IF ((PB-COMPANY-ID = 'DCC')
 17068        AND (WS-NO-SECURE-PAY))
 17069                  OR
 17070        (WS-LF-SPECIAL-CALC-CD = 'O'
 17071        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17072        SET SKIP-ADDR-EDIT       TO TRUE
 17073     END-IF
 17074     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17075        AND (NOT SKIP-ADDR-EDIT)
 17076        MOVE ER-2963             TO WS-ERROR
 17077        PERFORM 9900-ERROR-FORMAT
 17078                                 THRU 9900-EXIT
 17079        GO TO 9990-RETURN
 17080     END-IF
 17081     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17082     IF ERPNDM-FOUND NOT = 'X'
 17083        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17084           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17085           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17086           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17087           AND (NOT SKIP-ADDR-EDIT)
 17088           MOVE ER-2694          TO WS-ERROR
 17089           PERFORM 9900-ERROR-FORMAT
 17090                                 THRU 9900-EXIT
 17091        END-IF
 17092        MOVE ' '                 TO STATE-RECORD-ERROR
 17093        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17094        MOVE PM-STATE            TO CNTL-ACCESS
 17095        MOVE '3'                 TO CNTL-REC-TYPE
 17096        MOVE +0                  TO CNTL-SEQ-NO
 17097        MOVE '0'                 TO RC-SW-2
 17098        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17099        IF (NO-STATE-RECORD)
 17100           OR (CF-RECORD-TYPE NOT = '3')
 17101           OR (PM-STATE NOT = CF-STATE-CODE)
 17102           IF (PM-STATE = SPACES)
 17103              AND (SKIP-ADDR-EDIT)
 17104              CONTINUE
 17105           ELSE
 17106              MOVE ER-2963       TO WS-ERROR
 17107              PERFORM 9900-ERROR-FORMAT
 17108                                 THRU 9900-EXIT
 17109           END-IF
 17110        END-IF
 17111        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17112           MOVE ER-2883          TO WS-ERROR
 17113           PERFORM 9900-ERROR-FORMAT
 17114                                 THRU 9900-EXIT
 17115        END-IF
 17116        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17117           MOVE ' '                 TO STATE-RECORD-ERROR
 17118           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17119           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17120           MOVE '3'                 TO CNTL-REC-TYPE
 17121           MOVE +0                  TO CNTL-SEQ-NO
 17122           MOVE '0'                 TO RC-SW-2
 17123           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17124           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 310
* EL050.cbl
 17125              OR (CF-RECORD-TYPE NOT = '3')
 17126              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17127              MOVE ER-2964          TO WS-ERROR
 17128              PERFORM 9900-ERROR-FORMAT
 17129                                    THRU 9900-EXIT
 17130           END-IF
 17131        END-IF
 17132     ELSE
 17133        IF NOT SKIP-ADDR-EDIT
 17134           MOVE ER-2393          TO WS-ERROR
 17135           PERFORM 9900-ERROR-FORMAT
 17136                                 THRU 9900-EXIT
 17137        END-IF
 17138     END-IF
 17139
 17140     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17141
 17142     IF (ERMAIL-FOUND = ' ' AND
 17143        ERPNDM-FOUND = ' ')
 17144        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17145           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17146           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17147          OR
 17148           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17149          OR
 17150           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17151           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17152           GO TO 3999-UNLOCK-ERMAIL.
 17153
 17154     IF ERPNDM-FOUND = 'X'
 17155        GO TO 3999-UNLOCK-ERMAIL.
 17156
 17157     IF PM-INSURED-LAST-NAME      = SPACES
 17158        AND PM-INSURED-FIRST-NAME = SPACES
 17159        AND PM-ADDRESS-LINE-1     = SPACES
 17160        AND PM-ADDRESS-LINE-2     = SPACES
 17161        AND PM-CITY-STATE         = SPACES
 17162        AND PM-CRED-BENE-NAME     = SPACES
 17163        AND PM-CRED-BENE-ADDR     = SPACES
 17164        AND PM-CRED-BENE-CTYST    = SPACES
 17165        GO TO 3999-UNLOCK-ERMAIL
 17166     END-IF
 17167
 17168     MOVE SPACES                 TO MAILING-DATA.
 17169
 17170     MOVE 'MA'                   TO MA-RECORD-ID.
 17171     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17172     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17173     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17174     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17175     MOVE PB-SV-STATE            TO MA-STATE.
 17176     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17177     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17178
 17179     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17180     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17181
 17182     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 311
* EL050.cbl
 17183        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17184     ELSE
 17185        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17186        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17187        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17188
 17189     GO TO 9990-RETURN.
 17190
 17191 3999-UNLOCK-ERMAIL.
 17192     IF ERMAIL-FOUND = ' '
 17193        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17194
 17195     GO TO 9990-RETURN.
 17196******************************************************************
 17197
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 312
* EL050.cbl
 17199 4000-UPDATE-CANCELLED-CERT.
 17200     IF CERT-WAS-NOT-FOUND
 17201        GO TO 4299-EXIT.
 17202
 17203*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17204     IF PB-C-NH-INT-ON-REFS > ZEROS
 17205        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17206     END-IF
 17207     IF PB-C-REF-INTERFACE-SW = 'Y'
 17208        MOVE PB-C-REF-INTERFACE-SW
 17209                                 TO CM-NH-INTERFACE-SW
 17210     END-IF
 17211     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17212     IF ERMAIL-FOUND = 'X'
 17213        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17214        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17215        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17216        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17217           MOVE ER-2694          TO WS-ERROR
 17218           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17219     END-IF
 17220
 17221     IF PB-C-POST-CARD-IND = 'Y'
 17222        MOVE +8                  TO SUB
 17223*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17224        IF ERMAIL-FOUND = ' '
 17225           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17226              (SUB > +7)
 17227              OR (MA-MAIL-STATUS (SUB) = '1')
 17228           END-PERFORM
 17229        END-IF
 17230        IF (SUB > +7)
 17231           OR (ERMAIL-FOUND = 'X')
 17232           MOVE ER-3789          TO WS-ERROR
 17233           PERFORM 9900-ERROR-FORMAT
 17234                                 THRU 9900-EXIT
 17235        END-IF
 17236     ELSE
 17237        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17238     END-IF
 17239
 17240     IF ERMAIL-FOUND = ' '
 17241        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17242     END-IF.
 17243
 17244     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17245
 17246     IF PB-CI-OB-FLAG = 'Z'
 17247        GO TO 4150-SUMMARY-CERT-CANCEL.
 17248
 17249     IF PB-C-LF-CANCEL-VOIDED
 17250         PERFORM 4200-REVERSE-LF-CANCEL.
 17251     IF PB-C-AH-CANCEL-VOIDED
 17252         PERFORM 4200-REVERSE-AH-CANCEL.
 17253
 17254 4100-APPLY-LF-CANCEL.
 17255
 17256     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 313
* EL050.cbl
 17257
 17258 4100-CHECK-LF-ERRORS.
 17259
 17260     ADD +1                       TO WS-SUB.
 17261
 17262     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17263        IF LF-COVERAGE-CANCELLED
 17264           GO TO 4100-LF-CANCEL-CONT
 17265        ELSE
 17266           GO TO 4100-UPDATE-LF-COVERAGE.
 17267
 17268     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17269                                   ER-2729 OR
 17270                                   ER-2730 OR
 17271                                   ER-2731 OR
 17272                                   ER-2732 OR
 17273                                   ER-2737 OR
 17274                                   ER-2740 OR
 17275                                   ER-2743 OR
 17276                                   ER-2749 OR
 17277                                   ER-2750 OR
 17278                                   ER-2755 OR
 17279                                   ER-2757 OR
 17280                                   ER-2760 OR
 17281                                   ER-2772 OR
 17282                                   ER-2774 OR
 17283                                   ER-2776 OR
 17284                                   ER-2794
 17285        GO TO 4100-UPDATE-LF-COVERAGE.
 17286
 17287     GO TO 4100-CHECK-LF-ERRORS.
 17288
 17289 4100-UPDATE-LF-COVERAGE.
 17290
 17291     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17292     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17293     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17294        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17295     END-IF
 17296     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17297                                      TO CM-CREDIT-INTERFACE-SW-2.
 17298     IF CM-LF-CANCEL-DT = LOW-VALUE
 17299         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17300
 17301     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17302         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17303                                         CM-LF-STATUS-AT-CANCEL.
 17304
 17305     GO TO 4100-APPLY-AH-CANCEL.
 17306
 17307 4100-LF-CANCEL-CONT.
 17308     IF PB-C-LF-CANCEL-VOIDED
 17309         GO TO 4100-APPLY-AH-CANCEL.
 17310
 17311     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17312         GO TO 4100-APPLY-AH-CANCEL.
 17313
 17314     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 314
* EL050.cbl
 17315        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17316           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17317        ELSE
 17318           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17319
 17320     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17321     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17322
 17323     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17324         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17325
 17326     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17327        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17328         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17329         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17330
 17331     IF PB-RECORD-RETURNED
 17332        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17333      ELSE
 17334        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17335
 17336 4100-APPLY-AH-CANCEL.
 17337
 17338     MOVE +0                      TO WS-SUB.
 17339
 17340 4100-CHECK-AH-ERRORS.
 17341
 17342     ADD +1                       TO WS-SUB.
 17343
 17344     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17345        IF AH-COVERAGE-CANCELLED
 17346           GO TO 4100-AH-CANCEL-CONT
 17347        ELSE
 17348           GO TO 4100-UPDATE-AH-COVERAGE.
 17349
 17350     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17351                                   ER-2729 OR
 17352                                   ER-2732 OR
 17353                                   ER-2737 OR
 17354                                   ER-2740 OR
 17355                                   ER-2744 OR
 17356                                   ER-2749 OR
 17357                                   ER-2750 OR
 17358                                   ER-2755 OR
 17359                                   ER-2757 OR
 17360                                   ER-2760 OR
 17361                                   ER-2771 OR
 17362                                   ER-2772 OR
 17363                                   ER-2773 OR
 17364                                   ER-2775 OR
 17365                                   ER-2777 OR
 17366                                   ER-2778 OR
 17367                                   ER-2794
 17368        GO TO 4100-UPDATE-AH-COVERAGE.
 17369
 17370     GO TO 4100-CHECK-AH-ERRORS.
 17371
 17372 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 315
* EL050.cbl
 17373
 17374     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17375     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17376     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17377     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17378                                      TO CM-CREDIT-INTERFACE-SW-2.
 17379     IF CM-AH-CANCEL-DT = LOW-VALUE
 17380         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17381
 17382     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17383         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17384                                         CM-AH-STATUS-AT-CANCEL.
 17385
 17386     IF LF-COVERAGE-CANCELLED
 17387         IF PB-RECORD-RETURNED
 17388              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17389          ELSE
 17390              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17391
 17392     GO TO 4299-EXIT.
 17393
 17394 4100-AH-CANCEL-CONT.
 17395     IF PB-C-AH-CANCEL-VOIDED
 17396         GO TO 4299-EXIT.
 17397
 17398     if cm-credit-interface-sw-2 = ' '
 17399        if pb-fatal-errors or pb-unforced-errors
 17400           move '4'              to cm-credit-interface-sw-2
 17401        else
 17402           move '1'              to cm-credit-interface-sw-2
 17403        end-if
 17404     end-if
 17405     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17406         GO TO 4299-EXIT.
 17407
 17408     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17409        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17410           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17411        ELSE
 17412           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17413
 17414     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17415     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17416
 17417     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17418         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17419
 17420     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17421         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17422         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17423
 17424     IF PB-RECORD-RETURNED
 17425        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17426      ELSE
 17427        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17428
 17429     GO TO 4299-EXIT.
 17430
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 316
* EL050.cbl
 17431 4150-SUMMARY-CERT-CANCEL.
 17432     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17433
 17434     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17435        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17436                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17437     ELSE
 17438        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17439                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17440
 17441     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17442        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17443                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17444     ELSE
 17445        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17446                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17447
 17448     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17449        NEXT SENTENCE
 17450     ELSE
 17451        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17452
 17453     GO TO 4299-EXIT.
 17454
 17455 4200-REVERSE-LF-CANCEL.
 17456     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17457
 17458     IF CM-LF-CANCEL-APPLIED
 17459        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17460        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17461        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17462
 17463     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17464
 17465     IF PB-RECORD-RETURNED
 17466        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17467       ELSE
 17468        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17469
 17470 4200-REVERSE-LF-EXIT.
 17471       EXIT.
 17472
 17473 4200-REVERSE-AH-CANCEL.
 17474     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17475
 17476     IF CM-AH-CANCEL-APPLIED
 17477        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17478        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17479        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17480
 17481     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17482
 17483     IF PB-RECORD-RETURNED
 17484        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17485       ELSE
 17486        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17487
 17488 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 317
* EL050.cbl
 17489       EXIT.
 17490
 17491 4299-EXIT.
 17492       EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 318
* EL050.cbl
 17494
 17495 4500-UPDATE-NEW-CERT.
 17496     IF CERT-WAS-FOUND
 17497         NEXT SENTENCE
 17498       ELSE
 17499         GO TO 4520-BUILD-NEW-KEY.
 17500
 17501     IF  CLASIC-CREATED-CERT
 17502         GO TO 4999-EXIT.
 17503
 17504     IF  CERT-WAS-CREATED-FOR-CLAIM
 17505         GO TO 4520-BUILD-NEW-KEY.
 17506
 17507     IF CERT-ADDED-BATCH
 17508        IF CM-RECORD-ID = 'CM'
 17509            GO TO 4999-EXIT.
 17510
 17511 4520-BUILD-NEW-KEY.
 17512* BUILD CONTROL PRIMARY
 17513
 17514     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17515                                       CM-COMPANY-CD-A1
 17516                                       CM-COMPANY-CD-A2
 17517                                       CM-COMPANY-CD-A4
 17518                                       CM-COMPANY-CD-A5.
 17519
 17520     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17521     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17522     MOVE PB-SV-STATE               TO CM-STATE.
 17523     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17524     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17525     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17526     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17527
 17528     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17529
 17530     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17531     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17532     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17533     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17534
 17535     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17536        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17537
 17538     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17539         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17540         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17541         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17542         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17543     ELSE
 17544         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17545
 17546     IF PB-COMPANY-ID   EQUAL  'CRI'
 17547         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17548         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17549         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17550         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17551         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 319
* EL050.cbl
 17552
 17553     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17554        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17555         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17556
 17557     IF PB-COMPANY-ID  = 'LBL'
 17558        IF PB-I-JOINT-COVERAGE
 17559            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17560                                           PB-I-MEMBER-NO
 17561            GO TO 4550-CONT-CERT-PROCESS.
 17562
 17563     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17564        NEXT SENTENCE
 17565     ELSE
 17566        GO TO 4540-BUILD-MEMBER-NO.
 17567
 17568******************************************************************
 17569*                                                                *
 17570*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17571*    FOR 'MON'.                                                  *
 17572*                                                                *
 17573******************************************************************
 17574
 17575     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17576     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17577     MOVE +1                     TO WS-SUB1
 17578                                    WS-SUB2.
 17579
 17580 4530-EDIT-MEMB-NAME.
 17581
 17582     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17583        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17584        ADD +1                       TO WS-SUB2.
 17585
 17586     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17587        ADD +1                       TO WS-SUB1
 17588        GO TO 4530-EDIT-MEMB-NAME.
 17589
 17590     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17591     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17592     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17593*    MOVE SPACE                      TO DC-OPTION-CODE.
 17594     SET  BIN-TO-GREG                TO TRUE.
 17595     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17596     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17597
 17598     GO TO 4550-CONT-CERT-PROCESS.
 17599
 17600******************************************************************
 17601*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17602******************************************************************
 17603
 17604 4540-BUILD-MEMBER-NO.
 17605
 17606     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17607         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17608         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17609         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 320
* EL050.cbl
 17610         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17611     ELSE
 17612         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17613
 17614     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17615        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17616         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17617
 17618 4550-CONT-CERT-PROCESS.
 17619
 17620*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17621*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17622*    ELSE
 17623*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17624
 17625     IF CERT-WAS-CREATED-FOR-CLAIM
 17626        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17627        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17628
 17629     IF CERT-AND-CLAIM-ONLINE
 17630        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17631        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17632
 17633     MOVE 'CM'                     TO CM-RECORD-ID.
 17634     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17635
 17636     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17637        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17638        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17639     ELSE
 17640        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17641        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17642
 17643     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17644     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17645     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17646     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17647     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17648     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17649     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17650                                      CM-LF-ITD-CANCEL-AMT
 17651                                      CM-LF-ITD-DEATH-AMT
 17652                                      CM-AH-ITD-AH-PMT
 17653                                      CM-AH-ITD-LUMP-PMT
 17654                                      CM-AH-ITD-CANCEL-AMT
 17655                                      CM-LF-NSP-PREMIUM-AMT
 17656                                      CM-AH-NSP-PREMIUM-AMT.
 17657*                                     CM-CLAIM-DEDUCT-WITHHELD
 17658*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17659     if pb-i-loan-apr = +99.9999
 17660        move zeros                 to cm-loan-apr
 17661     else
 17662        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17663     end-if
 17664     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17665     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17666     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17667     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 321
* EL050.cbl
 17668     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17669     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17670     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17671     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17672     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17673     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17674     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17675
 17676     IF PB-I-LIVES NOT NUMERIC
 17677         MOVE ZERO                 TO PB-I-LIVES.
 17678
 17679     IF PB-I-NUM-BILLED NOT NUMERIC
 17680         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17681
 17682     MOVE PB-I-LIVES               TO CM-LIVES.
 17683     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17684
 17685     IF PB-COMPANY-ID EQUAL  'DMD'
 17686         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17687         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17688
 17689     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17690     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17691     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17692     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17693     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17694     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17695
 17696     IF PB-I-LF-POLICY-FEE NUMERIC
 17697        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17698     ELSE
 17699        MOVE +0                    TO CM-LF-POLICY-FEE.
 17700
 17701     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17702        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17703        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17704     ELSE
 17705        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17706
 17707     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17708     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17709     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17710     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17711     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17712     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17713     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17714     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17715     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17716
 17717     IF PB-I-AH-POLICY-FEE NUMERIC
 17718        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17719     ELSE
 17720        MOVE +0                    TO CM-AH-POLICY-FEE.
 17721
 17722     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17723        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17724     ELSE
 17725        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 322
* EL050.cbl
 17726
 17727     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17728     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17729
 17730     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17731                                      CM-LF-DEATH-EXIT-DT
 17732                                      CM-AH-SETTLEMENT-EXIT-DT.
 17733
 17734*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17735*                       'TIH' OR 'OFL' OR 'FLA' OR
 17736*                       'TII' OR 'TMS' OR 'CRI' OR
 17737*                       'NCL'
 17738     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17739
 17740     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17741         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17742            MOVE '2'                TO CM-PREMIUM-TYPE.
 17743
 17744     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17745         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17746            MOVE '2'                TO CM-PREMIUM-TYPE.
 17747
 17748     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17749         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17750     ELSE
 17751         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17752         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17753
 17754     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17755     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17756     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17757     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17758     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17759     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17760     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17761     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17762
 17763     IF PB-NO-MONTHS-SKIPPED
 17764         MOVE SPACE                 TO CM-SKIP-CODE
 17765     ELSE
 17766         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17767
 17768     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17769     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17770                                       CM-LF-STATUS-AT-CANCEL.
 17771
 17772     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17773     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17774                                       CM-AH-STATUS-AT-CANCEL.
 17775
 17776     MOVE '1'                       TO CM-ENTRY-STATUS.
 17777
 17778     IF PB-REISSUED-CERT
 17779        MOVE '5'                    TO CM-ENTRY-STATUS.
 17780
 17781     IF PB-MONTHLY-CERT
 17782        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17783
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 323
* EL050.cbl
 17784     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17785     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17786     IF PB-POLICY-IS-DECLINED
 17787        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17788
 17789     IF PB-POLICY-IS-VOIDED
 17790        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17791
 17792     IF PB-NEEDS-UNDERWRITING
 17793        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17794
 17795     IF PB-REIN-ONLY-CERT
 17796        MOVE '9'                    TO CM-ENTRY-STATUS.
 17797
 17798     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17799         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17800     ELSE
 17801         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17802
 17803     IF PB-RECORD-RETURNED
 17804        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17805      ELSE
 17806        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17807
 17808     IF PB-I-MAIL-ADDRS-PRESENT
 17809        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17810
 17811     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17812                                       CM-ENTRY-DT.
 17813
 17814 4999-EXIT.
 17815     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 324
* EL050.cbl
 17817
 17818 5000-PROCESS-REPS.
 17819     MOVE ' '                    TO AGTC-MASTER-SW
 17820     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17821     MOVE CO-TYPE                TO AGTC-TYPE
 17822     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17823     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17824     IF (AGTC-MASTER-SW NOT = 'N')
 17825        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17826        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17827        PERFORM 8583-READ-ERAGTC-NEXT
 17828                                 THRU 8583-EXIT
 17829     END-IF
 17830     IF AGTC-MASTER-SW = 'N'
 17831        CONTINUE
 17832     ELSE
 17833        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17834           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17835              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17836              MOVE 'Y'           TO AGTC-MASTER-SW
 17837           END-IF
 17838        END-IF
 17839     END-IF
 17840     .
 17841 5000-EXIT.
 17842     EXIT.
 17843 6370-EDIT-INPUT-LF-CODE.
 17844     move ' ' to ws-benefit-cd-chg-sw
 17845     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17846        MOVE +1                  TO SUB
 17847        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17848        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17849        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17850        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17851        GO TO 6370-SEARCH-LOOP.
 17852
 17853     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17854
 17855     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17856     MOVE SPACES                 TO CNTL-ACCESS.
 17857*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17858     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17859     MOVE +0                     TO CNTL-SEQ-NO.
 17860     MOVE '4' TO RC-SW-2.
 17861     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17862
 17863     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17864        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17865        GO TO 6370-NO-LF-FOUND.
 17866
 17867     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17868     MOVE +1                     TO SUB.
 17869
 17870 6370-SEARCH-LOOP.
 17871     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17872         GO TO 6370-NO-LF-FOUND.
 17873
 17874     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 325
* EL050.cbl
 17875        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17876           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17877           set benefit-code-chg to true
 17878        end-if
 17879        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17880        GO TO 6370-HER-NET-PAY-CHECK.
 17881
 17882     ADD 1   TO SUB.
 17883*    IF SUB GREATER 120
 17884     IF SUB GREATER 200
 17885         GO TO 6370-NO-LF-FOUND.
 17886
 17887     GO TO 6370-SEARCH-LOOP.
 17888
 17889 6370-NO-LF-FOUND.
 17890
 17891     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17892        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17893        set benefit-code-chg to true
 17894     end-if
 17895     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17896
 17897 6370-HER-NET-PAY-CHECK.
 17898
 17899     IF PB-COMPANY-ID = 'CID'
 17900        IF PB-SV-STATE = 'CA' OR 'MN'
 17901           IF PB-I-LF-BENEFIT-CD = '02'
 17902              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17903           ELSE
 17904              IF PB-I-LF-BENEFIT-CD = '04'
 17905                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17906              END-IF
 17907           END-IF
 17908        END-IF
 17909     END-IF
 17910
 17911     IF PB-COMPANY-ID NOT = 'HER'
 17912         GO TO 6370-EXIT.
 17913
 17914     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17915         GO TO 6370-EXIT.
 17916
 17917     IF PB-I-LF-TERM NOT NUMERIC
 17918         MOVE ZEROS              TO PB-I-LF-TERM.
 17919
 17920     IF PB-I-LOAN-TERM NOT NUMERIC
 17921         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17922
 17923     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17924         GO TO 6370-EXIT.
 17925
 17926     IF PB-I-LF-BENEFIT-CD = '33'
 17927         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17928
 17929     IF PB-I-LF-BENEFIT-CD = '34'
 17930         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17931
 17932 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 326
* EL050.cbl
 17933     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 327
* EL050.cbl
 17935
 17936 6380-EDIT-INPUT-AH-CODE.
 17937     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17938        MOVE +1                  TO SUB
 17939        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17940        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17941        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17942        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17943        GO TO 6380-SEARCH-LOOP.
 17944
 17945     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17946
 17947     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17948     MOVE SPACES                 TO CNTL-ACCESS.
 17949     MOVE 'A'                    TO CNTL-REC-TYPE.
 17950*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17951     MOVE +0                     TO CNTL-SEQ-NO.
 17952     MOVE '5' TO RC-SW-2.
 17953     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17954
 17955     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17956        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17957        GO TO 6380-NO-AH-FOUND.
 17958
 17959     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17960     MOVE +1 TO SUB.
 17961
 17962 6380-SEARCH-LOOP.
 17963     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17964         GO TO 6380-NO-AH-FOUND.
 17965
 17966     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17967         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17968         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17969
 17970     ADD 1   TO SUB.
 17971     IF SUB GREATER THAN 96
 17972*    IF SUB GREATER THAN 300
 17973         GO TO 6380-NO-AH-FOUND.
 17974
 17975     GO TO 6380-SEARCH-LOOP.
 17976
 17977 6380-NO-AH-FOUND.
 17978
 17979     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17980
 17981     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17982         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17983     ELSE
 17984         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17985
 17986 6380-CSO-AH-ONLY-CHECKS.
 17987
 17988     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17989        NEXT SENTENCE
 17990      ELSE
 17991        GO TO 6380-EXIT.
 17992
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 328
* EL050.cbl
 17993     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17994         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17995
 17996
 17997     GO TO 6380-EXIT
 17998     .
 17999 6380-CSO-LIFE-WITH-AH-CHECKS.
 18000
 18001
 18002     .
 18003 6380-EXIT.
 18004     EXIT.
 18005
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 329
* EL050.cbl
 18007
 18008 6400-COMPUTE-EXTENSION-DAYS.
 18009
 18010******************************************************************
 18011*                                                                *
 18012*                   COMPUTE EXTENSION DAYS                       *
 18013*                                                                *
 18014*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18015*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18016*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18017*    THE EXTENSION DAYS.                                         *
 18018*                                                                *
 18019******************************************************************
 18020
 18021     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18022     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18023
 18024******************************************************************
 18025*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18026*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18027******************************************************************
 18028
 18029     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18030        COMPUTE WS-ODD-DAYS-OVER =
 18031               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18032     ELSE
 18033        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18034
 18035     IF WS-ODD-DAYS-OVER = ZEROS
 18036           GO TO 6499-EXIT
 18037     ELSE
 18038        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18039           IF WS-WDF-MONTH = 02
 18040              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18041              ADD 2       TO  WS-ODD-DAYS-OVER
 18042              GO TO 6499-EXIT
 18043           ELSE
 18044              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18045                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18046                 GO TO 6499-EXIT
 18047               ELSE
 18048                 GO TO 6499-EXIT
 18049        ELSE
 18050           GO TO 6499-EXIT.
 18051
 18052 6412-CHECK-TO-DAY.
 18053
 18054        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18055           IF WS-WDT-DAY = 28
 18056              ADD 2              TO WS-ODD-DAYS-OVER
 18057           ELSE
 18058              IF WS-WDT-DAY = 29
 18059                 ADD 1           TO WS-ODD-DAYS-OVER
 18060              ELSE
 18061                 NEXT SENTENCE
 18062        ELSE
 18063           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18064              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 330
* EL050.cbl
 18065
 18066     GO TO 6499-EXIT.
 18067
 18068
 18069 6415-CHECK-LEAP-YEAR.
 18070
 18071     IF DC-DAYS-IN-MONTH = 29
 18072        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18073
 18074 6415-EXIT.
 18075     EXIT.
 18076
 18077 6499-EXIT.
 18078      EXIT.
 18079
 18080 6500-END.
 18081     EXIT.
 18082
 18083
 18084******************************************************************
 18085************* PROCEDURE DIVISION FOR EL050 ***********************
 18086********************** ELC50PD END *******************************
 18087
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 331
* EL050.cbl
 18089
 18090**START***********************************************************
 18091*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18092*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18093******************************************************************
 18094*
 18095 6600-GET-STATE-MUNICIPAL-TAX.
 18096
 18097     IF PB-COMPANY-ID NOT = 'DMD'
 18098         GO TO 6640-EXIT.
 18099
 18100     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18101     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18102     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18103*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18104*
 18105***  Y2K PROJ 7744
 18106     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18107     SET BIN-TO-GREG          TO TRUE.
 18108     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18109
 18110     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18111
 18112     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18113     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18114
 18115
 18116* EXEC CICS HANDLE CONDITION
 18117*        INVREQ    (6610-START-BROWSE)
 18118*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18119*        NOTFND    (6630-END-OF-FILE)
 18120*    END-EXEC.
 18121*    MOVE '"$8JI                 ! # #00018103' TO DFHEIV0
 18122     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18124     MOVE X'2320233030303138313033' TO DFHEIV0(25:11)
 18125     CALL 'kxdfhei1' USING DFHEIV0
 18126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18127
 18128
 18129 6610-START-BROWSE.
 18130
 18131
 18132* EXEC CICS HANDLE CONDITION
 18133*        NOTFND    (6630-END-OF-FILE)
 18134*        DISABLED  (6630-ERRESS-PROBLEM)
 18135*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18136*        ENDFILE   (6630-END-OF-FILE)
 18137*    END-EXEC.
 18138*    MOVE '"$IcJ''                ! $ #00018111' TO DFHEIV0
 18139     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18141     MOVE X'2420233030303138313131' TO DFHEIV0(25:11)
 18142     CALL 'kxdfhei1' USING DFHEIV0
 18143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18144
 18145
 18146
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 332
* EL050.cbl
 18147* EXEC CICS STARTBR
 18148*        DATASET (FILE-ID-ERRESS)
 18149*        RIDFLD  (WS-ERRESS-KEY)
 18150*        GTEQ
 18151*    END-EXEC.
 18152     MOVE 0
 18153       TO DFHEIV11
 18154*    MOVE '&,         G          &   #00018118' TO DFHEIV0
 18155     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18156     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18157     MOVE X'2020233030303138313138' TO DFHEIV0(25:11)
 18158     CALL 'kxdfhei1' USING DFHEIV0,
 18159           FILE-ID-ERRESS,
 18160           WS-ERRESS-KEY,
 18161           DFHEIV99,
 18162           DFHEIV11,
 18163           DFHEIV99
 18164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18165
 18166
 18167 6620-READ-NEXT-ERRESS-MASTER.
 18168
 18169
 18170* EXEC CICS HANDLE CONDITION
 18171*        NOTFND    (6630-END-OF-FILE)
 18172*        ENDFILE   (6630-END-OF-FILE)
 18173*        DISABLED  (6630-ERRESS-PROBLEM)
 18174*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18175*    END-EXEC.
 18176*    MOVE '"$I''cJ                ! % #00018126' TO DFHEIV0
 18177     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18178     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18179     MOVE X'2520233030303138313236' TO DFHEIV0(25:11)
 18180     CALL 'kxdfhei1' USING DFHEIV0
 18181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18182
 18183
 18184
 18185* EXEC CICS READNEXT
 18186*        DATASET (FILE-ID-ERRESS)
 18187*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18188*        RIDFLD  (WS-ERRESS-KEY)
 18189*    END-EXEC.
 18190     MOVE LENGTH OF
 18191      RESIDENT-STATE-TAX-MASTER
 18192       TO DFHEIV12
 18193     MOVE 0
 18194       TO DFHEIV11
 18195*    MOVE '&.IL                  )   #00018133' TO DFHEIV0
 18196     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18197     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18198     MOVE X'2020233030303138313333' TO DFHEIV0(25:11)
 18199     CALL 'kxdfhei1' USING DFHEIV0,
 18200           FILE-ID-ERRESS,
 18201           RESIDENT-STATE-TAX-MASTER,
 18202           DFHEIV12,
 18203           WS-ERRESS-KEY,
 18204           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 333
* EL050.cbl
 18205           DFHEIV11,
 18206           DFHEIV99,
 18207           DFHEIV99
 18208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18209
 18210
 18211     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18212
 18213* EXEC CICS ENDBR
 18214*            DATASET (FILE-ID-ERRESS)
 18215*       END-EXEC
 18216     MOVE 0
 18217       TO DFHEIV11
 18218*    MOVE '&2                    $   #00018140' TO DFHEIV0
 18219     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18221     MOVE X'2020233030303138313430' TO DFHEIV0(25:11)
 18222     CALL 'kxdfhei1' USING DFHEIV0,
 18223           FILE-ID-ERRESS,
 18224           DFHEIV11,
 18225           DFHEIV99
 18226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18227        GO TO 6630-END-OF-FILE.
 18228
 18229     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18230        NEXT SENTENCE
 18231      ELSE
 18232        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18233
 18234*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18235*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18236*
 18237     MOVE +2                     TO WS-SUB1.
 18238
 18239     IF PB-ISSUE
 18240     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18241        MOVE +1                  TO WS-SUB1.
 18242
 18243     IF PB-CANCELLATION
 18244     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18245        MOVE +1                  TO WS-SUB1.
 18246*
 18247*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18248*
 18249***  Y2K PROJ 7744
 18250     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18251***  Y2K PROJ 7744
 18252
 18253*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18254* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18255* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18256
 18257     ADD 1                    TO WS-YEAR-YY.
 18258
 18259     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18260         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18261                              TO WS-RES-STATE-TAX
 18262         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 334
* EL050.cbl
 18263                              TO WS-RES-MUNI-TAX
 18264     ELSE
 18265         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18266                              TO WS-RES-STATE-TAX
 18267         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18268                              TO WS-RES-MUNI-TAX.
 18269
 18270*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18271
 18272     IF PB-CANCELLATION
 18273         GO TO 6640-CANCEL-TAX.
 18274
 18275     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18276         COMPUTE PB-I-STATE-TAX ROUNDED =
 18277                                   PB-I-LF-PREMIUM-AMT
 18278                                 * WS-RES-STATE-TAX
 18279         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18280                                   PB-I-LF-PREMIUM-AMT
 18281                                 * WS-RES-MUNI-TAX
 18282     ELSE
 18283     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18284         COMPUTE PB-I-STATE-TAX ROUNDED =
 18285                                   PB-I-AH-PREMIUM-AMT
 18286                                 * WS-RES-STATE-TAX
 18287         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18288                                   PB-I-AH-PREMIUM-AMT
 18289                                 * WS-RES-MUNI-TAX.
 18290
 18291
 18292* EXEC CICS ENDBR
 18293*         DATASET (FILE-ID-ERRESS)
 18294*    END-EXEC.
 18295     MOVE 0
 18296       TO DFHEIV11
 18297*    MOVE '&2                    $   #00018207' TO DFHEIV0
 18298     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18300     MOVE X'2020233030303138323037' TO DFHEIV0(25:11)
 18301     CALL 'kxdfhei1' USING DFHEIV0,
 18302           FILE-ID-ERRESS,
 18303           DFHEIV11,
 18304           DFHEIV99
 18305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18306
 18307
 18308     GO TO 6640-EXIT.
 18309
 18310 6640-CANCEL-TAX.
 18311     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18312
 18313     IF PB-C-LF-CANCEL-AMT > ZEROS
 18314         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18315                                   PB-C-LF-CANCEL-AMT
 18316                                 * WS-RES-STATE-TAX
 18317         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18318                                   PB-C-LF-CANCEL-AMT
 18319                                *  WS-RES-MUNI-TAX
 18320     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 335
* EL050.cbl
 18321     IF PB-C-AH-CANCEL-AMT > ZEROS
 18322         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18323                                   PB-C-AH-CANCEL-AMT
 18324                                 * WS-RES-STATE-TAX
 18325         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18326                                   PB-C-AH-CANCEL-AMT
 18327                                *  WS-RES-MUNI-TAX.
 18328
 18329
 18330* EXEC CICS ENDBR
 18331*         DATASET (FILE-ID-ERRESS)
 18332*    END-EXEC.
 18333     MOVE 0
 18334       TO DFHEIV11
 18335*    MOVE '&2                    $   #00018232' TO DFHEIV0
 18336     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18337     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18338     MOVE X'2020233030303138323332' TO DFHEIV0(25:11)
 18339     CALL 'kxdfhei1' USING DFHEIV0,
 18340           FILE-ID-ERRESS,
 18341           DFHEIV11,
 18342           DFHEIV99
 18343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18344
 18345
 18346     GO TO 6640-EXIT.
 18347
 18348 6630-END-OF-FILE.
 18349     MOVE ER-8002              TO WS-ERROR.
 18350     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18351
 18352     GO TO 6640-EXIT.
 18353
 18354 6630-ERRESS-PROBLEM.
 18355     MOVE ER-8044              TO WS-ERROR.
 18356     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18357
 18358 6640-EXIT.
 18359     EXIT.
 18360
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 336
* EL050.cbl
 18362 6650-GET-RES-STATE-COMM.
 18363
 18364     IF PB-COMPANY-ID NOT = 'DMD'
 18365         GO TO 6700-COMM-EXIT.
 18366
 18367     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18368     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18369     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18370     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18371     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18372     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18373     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18374
 18375*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18376*
 18377***  Y2K PROJ 7744
 18378     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18379     SET BIN-TO-GREG          TO TRUE.
 18380     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18381
 18382     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18383***  Y2K PROJ 7744
 18384
 18385     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18386
 18387
 18388* EXEC CICS HANDLE CONDITION
 18389*        INVREQ    (6660-START-BROWSE)
 18390*        DISABLED  (6690-ERRESC-PROBLEM)
 18391*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18392*        NOTFND    (6690-END-OF-FILE)
 18393*    END-EXEC.
 18394*    MOVE '"$8cJI                ! & #00018277' TO DFHEIV0
 18395     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18397     MOVE X'2620233030303138323737' TO DFHEIV0(25:11)
 18398     CALL 'kxdfhei1' USING DFHEIV0
 18399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18400
 18401
 18402
 18403* EXEC CICS RESETBR
 18404*        DATASET (FILE-ID-ERRESC)
 18405*        RIDFLD  (WS-ERRESC-KEY)
 18406*    END-EXEC.
 18407     MOVE 0
 18408       TO DFHEIV11
 18409*    MOVE '&4         G          &   #00018284' TO DFHEIV0
 18410     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18411     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18412     MOVE X'2020233030303138323834' TO DFHEIV0(25:11)
 18413     CALL 'kxdfhei1' USING DFHEIV0,
 18414           FILE-ID-ERRESC,
 18415           WS-ERRESC-KEY,
 18416           DFHEIV99,
 18417           DFHEIV11,
 18418           DFHEIV99
 18419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 337
* EL050.cbl
 18420
 18421
 18422 6660-START-BROWSE.
 18423
 18424
 18425* EXEC CICS HANDLE CONDITION
 18426*        NOTFND    (6690-END-OF-FILE)
 18427*        DISABLED  (6690-ERRESC-PROBLEM)
 18428*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18429*        ENDFILE   (6690-END-OF-FILE)
 18430*    END-EXEC.
 18431*    MOVE '"$IcJ''                ! '' #00018291' TO DFHEIV0
 18432     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18434     MOVE X'2720233030303138323931' TO DFHEIV0(25:11)
 18435     CALL 'kxdfhei1' USING DFHEIV0
 18436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18437
 18438
 18439
 18440* EXEC CICS STARTBR
 18441*        DATASET (FILE-ID-ERRESC)
 18442*        RIDFLD  (WS-ERRESC-KEY)
 18443*        GTEQ
 18444*    END-EXEC.
 18445     MOVE 0
 18446       TO DFHEIV11
 18447*    MOVE '&,         G          &   #00018298' TO DFHEIV0
 18448     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18449     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18450     MOVE X'2020233030303138323938' TO DFHEIV0(25:11)
 18451     CALL 'kxdfhei1' USING DFHEIV0,
 18452           FILE-ID-ERRESC,
 18453           WS-ERRESC-KEY,
 18454           DFHEIV99,
 18455           DFHEIV11,
 18456           DFHEIV99
 18457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18458
 18459
 18460     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18461
 18462 6670-READ-NEXT-ERRESC-MASTER.
 18463
 18464
 18465* EXEC CICS HANDLE CONDITION
 18466*        NOTFND    (6690-END-OF-FILE)
 18467*        DISABLED  (6690-ERRESC-PROBLEM)
 18468*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18469*        ENDFILE   (6690-END-OF-FILE)
 18470*    END-EXEC.
 18471*    MOVE '"$IcJ''                ! ( #00018308' TO DFHEIV0
 18472     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18474     MOVE X'2820233030303138333038' TO DFHEIV0(25:11)
 18475     CALL 'kxdfhei1' USING DFHEIV0
 18476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18477
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 338
* EL050.cbl
 18478
 18479
 18480* EXEC CICS READNEXT
 18481*        DATASET (FILE-ID-ERRESC)
 18482*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18483*        RIDFLD  (ERRESC-RECORD-KEY)
 18484*    END-EXEC.
 18485     MOVE LENGTH OF
 18486      ACCOUNT-RESIDENT-ST-COMMISSION
 18487       TO DFHEIV12
 18488     MOVE 0
 18489       TO DFHEIV11
 18490*    MOVE '&.IL                  )   #00018315' TO DFHEIV0
 18491     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18492     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18493     MOVE X'2020233030303138333135' TO DFHEIV0(25:11)
 18494     CALL 'kxdfhei1' USING DFHEIV0,
 18495           FILE-ID-ERRESC,
 18496           ACCOUNT-RESIDENT-ST-COMMISSION,
 18497           DFHEIV12,
 18498           ERRESC-RECORD-KEY,
 18499           DFHEIV99,
 18500           DFHEIV11,
 18501           DFHEIV99,
 18502           DFHEIV99
 18503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18504
 18505
 18506     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18507        NEXT SENTENCE
 18508     ELSE
 18509
 18510* EXEC CICS ENDBR
 18511*            DATASET (FILE-ID-ERRESC)
 18512*       END-EXEC
 18513     MOVE 0
 18514       TO DFHEIV11
 18515*    MOVE '&2                    $   #00018324' TO DFHEIV0
 18516     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18517     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18518     MOVE X'2020233030303138333234' TO DFHEIV0(25:11)
 18519     CALL 'kxdfhei1' USING DFHEIV0,
 18520           FILE-ID-ERRESC,
 18521           DFHEIV11,
 18522           DFHEIV99
 18523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18524        GO TO 6690-END-OF-FILE.
 18525
 18526     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18527
 18528* EXEC CICS ENDBR
 18529*            DATASET (FILE-ID-ERRESC)
 18530*       END-EXEC
 18531     MOVE 0
 18532       TO DFHEIV11
 18533*    MOVE '&2                    $   #00018330' TO DFHEIV0
 18534     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18535     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 339
* EL050.cbl
 18536     MOVE X'2020233030303138333330' TO DFHEIV0(25:11)
 18537     CALL 'kxdfhei1' USING DFHEIV0,
 18538           FILE-ID-ERRESC,
 18539           DFHEIV11,
 18540           DFHEIV99
 18541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18542        GO TO 6690-END-OF-FILE.
 18543
 18544     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18545        NEXT SENTENCE
 18546      ELSE
 18547        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18548
 18549* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18550*
 18551     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18552
 18553     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18554
 18555     IF WS-SUB1 > ZERO
 18556         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18557             PERFORM 6680-SET-COMMISSION
 18558         ELSE
 18559             PERFORM 6680-SET-TABLE-CODE.
 18560
 18561
 18562* EXEC CICS ENDBR
 18563*         DATASET (FILE-ID-ERRESC)
 18564*    END-EXEC.
 18565     MOVE 0
 18566       TO DFHEIV11
 18567*    MOVE '&2                    $   #00018352' TO DFHEIV0
 18568     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18569     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18570     MOVE X'2020233030303138333532' TO DFHEIV0(25:11)
 18571     CALL 'kxdfhei1' USING DFHEIV0,
 18572           FILE-ID-ERRESC,
 18573           DFHEIV11,
 18574           DFHEIV99
 18575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18576
 18577
 18578     GO TO 6700-COMM-EXIT.
 18579
 18580 6680-SET-TABLE-CODE.
 18581     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18582        MOVE ZEROS             TO WS-SUB1
 18583     ELSE
 18584* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18585* TO COMPUTE AH COMMISSION.
 18586        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18587        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18588        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18589        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18590        PERFORM 6680-READ-CTBL-TABLE
 18591        IF WS-CTBL-READ-SW NOT = 'Y'
 18592           MOVE ZEROS          TO WS-SUB1.
 18593
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 340
* EL050.cbl
 18594 6680-READ-CTBL-TABLE.
 18595*
 18596* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18597* TO COMPUTE LIFE COMMISSION
 18598
 18599     IF CTBL-SW = '0540'
 18600        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18601        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18602        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18603
 18604     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18605
 18606     IF CTBL-TABLE-FOUND
 18607        IF CTBL-SW = '0530'
 18608             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18609                                    * PB-I-AH-TERM
 18610             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18611             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18612        ELSE
 18613             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18614             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18615             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18616     ELSE
 18617        IF FIRST-TIME-THROUGH
 18618            GO TO 6680-READ-CTBL-TABLE
 18619        ELSE
 18620            MOVE ZEROS         TO WS-SUB1.
 18621
 18622 6680-SET-COMMISSION.
 18623     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18624           MOVE ZEROS          TO WS-SUB1
 18625       ELSE
 18626           MOVE RESC-COMMISSION-PER (WS-SUB)
 18627                               TO WS-COMMISSION
 18628           IF CTBL-SW = '0530'
 18629               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18630           ELSE
 18631               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18632
 18633 6680-SEARCH-CATEGORY.
 18634     ADD +1                   TO WS-SUB.
 18635     IF WS-SUB > +12
 18636         GO TO 6680-EXIT.
 18637
 18638     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18639          MOVE WS-SUB         TO WS-SUB1
 18640          GO TO 6680-EXIT.
 18641
 18642     GO TO 6680-SEARCH-CATEGORY.
 18643
 18644 6680-EXIT.
 18645     EXIT.
 18646
 18647 6690-END-OF-FILE.
 18648     GO TO 6700-COMM-EXIT.
 18649
 18650 6690-ERRESC-PROBLEM.
 18651      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 341
* EL050.cbl
 18652      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18653
 18654      GO TO 6700-COMM-EXIT.
 18655
 18656 6700-COMM-EXIT.
 18657     EXIT.
 18658
 18659 7000-GET-RATE.
 18660
 18661* EXEC CICS LINK
 18662*        PROGRAM    ('ELRATE')
 18663*        COMMAREA   (CALCULATION-PASS-AREA)
 18664*        LENGTH     (CP-COMM-LENGTH)
 18665*    END-EXEC.
 18666     MOVE 'ELRATE' TO DFHEIV1
 18667*    MOVE '."C                   (   #00018438' TO DFHEIV0
 18668     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18669     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18670     MOVE X'2020233030303138343338' TO DFHEIV0(25:11)
 18671     CALL 'kxdfhei1' USING DFHEIV0,
 18672           DFHEIV1,
 18673           CALCULATION-PASS-AREA,
 18674           CP-COMM-LENGTH,
 18675           DFHEIV99,
 18676           DFHEIV99,
 18677           DFHEIV99,
 18678           DFHEIV99
 18679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18680
 18681
 18682 7000-EXIT.
 18683     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 342
* EL050.cbl
 18685 7100-FIND-BENEFIT-IN-STATE.
 18686     MOVE 'N'                    TO BEN-SEARCH-SW.
 18687
 18688     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18689         VARYING SUB3 FROM 1 BY 1 UNTIL
 18690            ((SUB3 GREATER 50) OR
 18691              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18692               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18693
 18694     IF SUB3 NOT = 51
 18695         MOVE 'Y'                TO BEN-SEARCH-SW.
 18696
 18697     GO TO 7199-EXIT.
 18698
 18699 7100-BENEFIT-DUMMY.
 18700
 18701 7100-DUMMY-EXIT.
 18702     EXIT.
 18703
 18704 7199-EXIT.
 18705     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 343
* EL050.cbl
 18707 7200-FIND-BENEFIT.
 18708     MOVE 'N'                    TO BEN-SEARCH-SW.
 18709
 18710     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18711         VARYING SUB3 FROM 1 BY 1 UNTIL
 18712            ((SUB3 GREATER 8) OR
 18713            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18714
 18715     IF SUB3 NOT = 9
 18716         MOVE 'Y'                TO BEN-SEARCH-SW.
 18717
 18718     GO TO 7200-EXIT.
 18719
 18720 7200-BENEFIT-DUMMY.
 18721
 18722 7200-DUMMY-EXIT.
 18723     EXIT.
 18724
 18725 7200-EXIT.
 18726     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 344
* EL050.cbl
 18728 7250-LOOK-FOR-RESCINDED-CLAIM.
 18729     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18730                                    W-CL-COMP-CD.
 18731     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18732                                    W-CL-CERT-NO.
 18733
 18734
 18735* EXEC CICS HANDLE CONDITION
 18736*        NOTFND  (7250-CONTINUE)
 18737*        ENDFILE (7250-CONTINUE)
 18738*    END-EXEC.
 18739*    MOVE '"$I''                  ! ) #00018496' TO DFHEIV0
 18740     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18742     MOVE X'2920233030303138343936' TO DFHEIV0(25:11)
 18743     CALL 'kxdfhei1' USING DFHEIV0
 18744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18745
 18746
 18747
 18748* EXEC CICS IGNORE CONDITION
 18749*        DUPKEY
 18750*    END-EXEC.
 18751*    MOVE '"*$                   !   #00018501' TO DFHEIV0
 18752     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18754     MOVE X'2020233030303138353031' TO DFHEIV0(25:11)
 18755     CALL 'kxdfhei1' USING DFHEIV0
 18756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18757
 18758
 18759
 18760* EXEC CICS STARTBR
 18761*        DATASET   (CLMS-ID)
 18762*        RIDFLD    (ELMSTR-KEY)
 18763*        GENERIC   EQUAL
 18764*        KEYLENGTH (ELMSTR-LENGTH)
 18765*    END-EXEC.
 18766     MOVE 0
 18767       TO DFHEIV11
 18768*    MOVE '&,   KG    E          &   #00018505' TO DFHEIV0
 18769     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18770     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18771     MOVE X'2020233030303138353035' TO DFHEIV0(25:11)
 18772     CALL 'kxdfhei1' USING DFHEIV0,
 18773           CLMS-ID,
 18774           ELMSTR-KEY,
 18775           ELMSTR-LENGTH,
 18776           DFHEIV11,
 18777           DFHEIV99
 18778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18779
 18780
 18781     MOVE 'Y'                    TO W-BROWSE-SW.
 18782
 18783 7250-NEXT-CLAIM.
 18784
 18785
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 345
* EL050.cbl
 18786* EXEC CICS READNEXT
 18787*        DATASET   (CLMS-ID)
 18788*        RIDFLD    (ELMSTR-KEY)
 18789*        SET       (ADDRESS OF CLAIM-MASTER)
 18790*    END-EXEC.
 18791     MOVE 0
 18792       TO DFHEIV11
 18793*    MOVE '&.S                   )   #00018516' TO DFHEIV0
 18794     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18795     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18796     MOVE X'2020233030303138353136' TO DFHEIV0(25:11)
 18797     CALL 'kxdfhei1' USING DFHEIV0,
 18798           CLMS-ID,
 18799           DFHEIV20,
 18800           DFHEIV99,
 18801           ELMSTR-KEY,
 18802           DFHEIV99,
 18803           DFHEIV11,
 18804           DFHEIV99,
 18805           DFHEIV99
 18806     SET ADDRESS OF CLAIM-MASTER TO
 18807         DFHEIV20
 18808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18809
 18810
 18811     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18812        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18813         GO TO 7250-CONTINUE
 18814     END-IF.
 18815
 18816     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18817        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18818        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18819        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18820        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18821         GO TO 7250-NEXT-CLAIM
 18822     END-IF.
 18823
 18824     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18825        OR (CL-CLAIM-TYPE = 'I')
 18826        OR (CL-CLAIM-TYPE = 'G')
 18827        OR (CL-CLAIM-TYPE = 'F')
 18828          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18829              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18830              GO TO 7250-CONTINUE
 18831          END-IF
 18832     END-IF.
 18833
 18834     GO TO 7250-NEXT-CLAIM.
 18835
 18836 7250-CONTINUE.
 18837
 18838     IF W-BROWSE-SW = 'Y'
 18839
 18840* EXEC CICS ENDBR
 18841*            DATASET   (CLMS-ID)
 18842*        END-EXEC
 18843     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 346
* EL050.cbl
 18844       TO DFHEIV11
 18845*    MOVE '&2                    $   #00018550' TO DFHEIV0
 18846     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18847     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18848     MOVE X'2020233030303138353530' TO DFHEIV0(25:11)
 18849     CALL 'kxdfhei1' USING DFHEIV0,
 18850           CLMS-ID,
 18851           DFHEIV11,
 18852           DFHEIV99
 18853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18854         MOVE 'N' TO W-BROWSE-SW
 18855     END-IF.
 18856
 18857 7250-EXIT.
 18858     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 347
* EL050.cbl
 18860 7300-CHECK-FOR-OPEN-CLMS.
 18861
 18862*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18863*    MOVE SPACES                 TO CNTL-ACCESS.
 18864*    MOVE '1'                    TO CNTL-REC-TYPE.
 18865*    MOVE +0                     TO CNTL-SEQ-NO.
 18866
 18867*    MOVE '3'                    TO RC-SW-1.
 18868*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18869
 18870*    IF NOT CF-COMPANY-MASTER
 18871*         PERFORM 0099-COMPANY-NOT-FOUND
 18872*         GO TO 7300-EXIT.
 18873
 18874     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18875                                    W-CL-COMP-CD.
 18876     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18877                                    W-CL-CERT-NO.
 18878
 18879
 18880* EXEC CICS HANDLE CONDITION
 18881*        NOTFND  (7300-CONTINUE)
 18882*        ENDFILE (7300-CONTINUE)
 18883*    END-EXEC.
 18884*    MOVE '"$I''                  ! * #00018578' TO DFHEIV0
 18885     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18887     MOVE X'2A20233030303138353738' TO DFHEIV0(25:11)
 18888     CALL 'kxdfhei1' USING DFHEIV0
 18889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18890
 18891
 18892
 18893* EXEC CICS IGNORE CONDITION
 18894*        DUPKEY
 18895*    END-EXEC.
 18896*    MOVE '"*$                   !   #00018583' TO DFHEIV0
 18897     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18899     MOVE X'2020233030303138353833' TO DFHEIV0(25:11)
 18900     CALL 'kxdfhei1' USING DFHEIV0
 18901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18902
 18903
 18904
 18905* EXEC CICS STARTBR
 18906*        DATASET   (CLMS-ID)
 18907*        RIDFLD    (ELMSTR-KEY)
 18908*        GENERIC   EQUAL
 18909*        KEYLENGTH (ELMSTR-LENGTH)
 18910*    END-EXEC.
 18911     MOVE 0
 18912       TO DFHEIV11
 18913*    MOVE '&,   KG    E          &   #00018587' TO DFHEIV0
 18914     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18915     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18916     MOVE X'2020233030303138353837' TO DFHEIV0(25:11)
 18917     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 348
* EL050.cbl
 18918           CLMS-ID,
 18919           ELMSTR-KEY,
 18920           ELMSTR-LENGTH,
 18921           DFHEIV11,
 18922           DFHEIV99
 18923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18924
 18925
 18926     MOVE 'Y'                    TO W-BROWSE-SW.
 18927
 18928 7300-NEXT-CLAIM.
 18929
 18930
 18931* EXEC CICS READNEXT
 18932*        DATASET   (CLMS-ID)
 18933*        RIDFLD    (ELMSTR-KEY)
 18934*        SET       (ADDRESS OF CLAIM-MASTER)
 18935*    END-EXEC.
 18936     MOVE 0
 18937       TO DFHEIV11
 18938*    MOVE '&.S                   )   #00018598' TO DFHEIV0
 18939     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18940     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18941     MOVE X'2020233030303138353938' TO DFHEIV0(25:11)
 18942     CALL 'kxdfhei1' USING DFHEIV0,
 18943           CLMS-ID,
 18944           DFHEIV20,
 18945           DFHEIV99,
 18946           ELMSTR-KEY,
 18947           DFHEIV99,
 18948           DFHEIV11,
 18949           DFHEIV99,
 18950           DFHEIV99
 18951     SET ADDRESS OF CLAIM-MASTER TO
 18952         DFHEIV20
 18953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18954
 18955
 18956     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18957        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18958         GO TO 7300-CONTINUE.
 18959
 18960     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18961        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18962        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18963        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18964        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18965         GO TO 7300-NEXT-CLAIM.
 18966
 18967*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18968     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18969        OR (CL-CLAIM-TYPE = 'I')
 18970        OR (CL-CLAIM-TYPE = 'G')
 18971        OR (CL-CLAIM-TYPE = 'F')
 18972        IF CLAIM-IS-OPEN
 18973           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18974             AND PB-C-AH-CANCEL-DT > SPACES
 18975              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 349
* EL050.cbl
 18976              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18977           END-IF
 18978           EVALUATE TRUE
 18979             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18980                 MOVE ER-2884      TO WS-ERROR
 18981             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 18982                 MOVE ER-2887      TO WS-ERROR
 18983             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18984                 MOVE ER-2886      TO WS-ERROR
 18985             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18986                 MOVE ER-2888      TO WS-ERROR
 18987             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18988                 MOVE ER-2885      TO WS-ERROR
 18989             WHEN OTHER
 18990                 MOVE ER-2768      TO WS-ERROR
 18991           END-EVALUATE
 18992           IF PB-C-AH-CANCEL-VOIDED OR
 18993              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18994                NOT AH-COVERAGE-CANCELLED)
 18995               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18996               MOVE ER-2768      TO WS-ERROR
 18997           END-IF
 18998           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18999           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19000              PB-FORCE-CODE NOT EQUAL '8'
 19001               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19002           END-IF
 19003           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19004           GO TO 7300-NEXT-CLAIM
 19005        ELSE
 19006           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19007*****THIS IS A RESCISSION OR REFORMATION
 19008              IF AH-COVERAGE-CANCELLED
 19009                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19010                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19011                    MOVE 1                   TO DC-ELAPSED-DAYS
 19012                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19013                    SET BIN-PLUS-ELAPSED     TO TRUE
 19014                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19015                    IF NO-CONVERSION-ERROR
 19016                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19017                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19018                          MOVE ER-2897 TO WS-ERROR
 19019                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19020                          GO TO 7300-NEXT-CLAIM
 19021                       END-IF
 19022                    END-IF
 19023                 ELSE
 19024                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19025                     MOVE ER-2890 TO WS-ERROR
 19026                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19027                     GO TO 7300-NEXT-CLAIM
 19028                   END-IF
 19029                 END-IF
 19030              END-IF
 19031           ELSE
 19032              IF CL-DENIAL-TYPE = '1'  AND
 19033                 CL-TOTAL-PAID-AMT = 0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 350
* EL050.cbl
 19034                    GO TO 7300-NEXT-CLAIM
 19035              END-IF
 19036              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19037               AND PB-C-AH-CANCEL-DT > SPACES
 19038                 MOVE ER-2756        TO WS-ERROR
 19039                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19040                 GO TO 7300-NEXT-CLAIM
 19041              END-IF
 19042           END-IF
 19043        END-IF
 19044     ELSE
 19045*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19046        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19047           IF CLAIM-IS-OPEN
 19048              MOVE ER-2889      TO WS-ERROR
 19049              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19050              GO TO 7300-NEXT-CLAIM
 19051           ELSE
 19052              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19053*****THIS IS A RESCISSION OR REFORMATION
 19054                 IF (LF-COVERAGE-CANCELLED AND
 19055                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19056                       MOVE ER-2890 TO WS-ERROR
 19057                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19058                       GO TO 7300-NEXT-CLAIM
 19059                 END-IF
 19060              ELSE
 19061                 IF CL-DENIAL-TYPE = '1'  AND
 19062                    CL-TOTAL-PAID-AMT = 0
 19063                       GO TO 7300-NEXT-CLAIM
 19064                 END-IF
 19065                 IF (AH-COVERAGE-CANCELLED AND
 19066                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 19067                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 19068                    (LF-COVERAGE-CANCELLED AND
 19069                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 19070                     WS-ST-REFUND-CLAIM-FLAG = '4')
 19071                       MOVE ER-2965 TO WS-ERROR
 19072                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19073                       GO TO 7300-NEXT-CLAIM
 19074                 END-IF
 19075                 IF LF-COVERAGE-CANCELLED
 19076                  IF CL-TOTAL-PAID-AMT > 0
 19077                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19078                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19079                        MOVE ER-2891 TO WS-ERROR
 19080                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19081                        GO TO 7300-NEXT-CLAIM
 19082                      END-IF
 19083                    ELSE
 19084****only show this error if cert num matches exactly
 19085                      IF PB-CERT-NO = CL-CERT-NO
 19086                         MOVE ER-2892 TO WS-ERROR
 19087                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19088                         GO TO 7300-NEXT-CLAIM
 19089                      END-IF
 19090                    END-IF
 19091                  END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 351
* EL050.cbl
 19092                 END-IF
 19093              END-IF
 19094           END-IF
 19095        END-IF
 19096     END-IF
 19097
 19098     GO TO 7300-NEXT-CLAIM.
 19099
 19100 7300-CONTINUE.
 19101
 19102     IF W-BROWSE-SW = 'Y'
 19103
 19104* EXEC CICS ENDBR
 19105*            DATASET   (CLMS-ID)
 19106*        END-EXEC.
 19107     MOVE 0
 19108       TO DFHEIV11
 19109*    MOVE '&2                    $   #00018751' TO DFHEIV0
 19110     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19111     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19112     MOVE X'2020233030303138373531' TO DFHEIV0(25:11)
 19113     CALL 'kxdfhei1' USING DFHEIV0,
 19114           CLMS-ID,
 19115           DFHEIV11,
 19116           DFHEIV99
 19117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19118
 19119
 19120 7300-EXIT.
 19121     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 352
* EL050.cbl
 19123
 19124 7400-GET-REMAIN-TERM.
 19125
 19126* EXEC CICS LINK
 19127*        PROGRAM    ('ELRTRM')
 19128*        COMMAREA   (CALCULATION-PASS-AREA)
 19129*        LENGTH     (CP-COMM-LENGTH)
 19130*    END-EXEC.
 19131     MOVE 'ELRTRM' TO DFHEIV1
 19132*    MOVE '."C                   (   #00018760' TO DFHEIV0
 19133     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19135     MOVE X'2020233030303138373630' TO DFHEIV0(25:11)
 19136     CALL 'kxdfhei1' USING DFHEIV0,
 19137           DFHEIV1,
 19138           CALCULATION-PASS-AREA,
 19139           CP-COMM-LENGTH,
 19140           DFHEIV99,
 19141           DFHEIV99,
 19142           DFHEIV99,
 19143           DFHEIV99
 19144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19145
 19146
 19147 7400-EXIT.
 19148     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 353
* EL050.cbl
 19150
 19151 7500-GET-REMAIN-AMOUNT.
 19152
 19153* EXEC CICS LINK
 19154*        PROGRAM    ('ELRAMT')
 19155*        COMMAREA   (CALCULATION-PASS-AREA)
 19156*        LENGTH     (CP-COMM-LENGTH)
 19157*    END-EXEC.
 19158     MOVE 'ELRAMT' TO DFHEIV1
 19159*    MOVE '."C                   (   #00018771' TO DFHEIV0
 19160     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19162     MOVE X'2020233030303138373731' TO DFHEIV0(25:11)
 19163     CALL 'kxdfhei1' USING DFHEIV0,
 19164           DFHEIV1,
 19165           CALCULATION-PASS-AREA,
 19166           CP-COMM-LENGTH,
 19167           DFHEIV99,
 19168           DFHEIV99,
 19169           DFHEIV99,
 19170           DFHEIV99
 19171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19172
 19173
 19174 7500-EXIT.
 19175     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 354
* EL050.cbl
 19177
 19178 7600-GET-REFUND.
 19179
 19180* EXEC CICS LINK
 19181*        PROGRAM    ('ELRFND')
 19182*        COMMAREA   (CALCULATION-PASS-AREA)
 19183*        LENGTH     (CP-COMM-LENGTH)
 19184*    END-EXEC.
 19185     MOVE 'ELRFND' TO DFHEIV1
 19186*    MOVE '."C                   (   #00018782' TO DFHEIV0
 19187     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19188     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19189     MOVE X'2020233030303138373832' TO DFHEIV0(25:11)
 19190     CALL 'kxdfhei1' USING DFHEIV0,
 19191           DFHEIV1,
 19192           CALCULATION-PASS-AREA,
 19193           CP-COMM-LENGTH,
 19194           DFHEIV99,
 19195           DFHEIV99,
 19196           DFHEIV99,
 19197           DFHEIV99
 19198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19199
 19200
 19201 7600-EXIT.
 19202     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 355
* EL050.cbl
 19204 7700-CALL-DL1.
 19205
 19206* EXEC CICS LINK
 19207*        PROGRAM    ('DLO001')
 19208*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19209*        LENGTH     (DLO001-COMM-LENGTH)
 19210*    END-EXEC.
 19211     MOVE 'DLO001' TO DFHEIV1
 19212*    MOVE '."C                   (   #00018792' TO DFHEIV0
 19213     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19215     MOVE X'2020233030303138373932' TO DFHEIV0(25:11)
 19216     CALL 'kxdfhei1' USING DFHEIV0,
 19217           DFHEIV1,
 19218           WS-DLO-MASTER-POLICY-FORM,
 19219           DLO001-COMM-LENGTH,
 19220           DFHEIV99,
 19221           DFHEIV99,
 19222           DFHEIV99,
 19223           DFHEIV99
 19224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19225
 19226
 19227 7700-EXIT.
 19228     EXIT.
 19229
 19230 7710-CALL-DL2.
 19231
 19232* EXEC CICS LINK
 19233*        PROGRAM    ('DLO002')
 19234*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19235*        LENGTH     (DLO002-COMM-LENGTH)
 19236*    END-EXEC.
 19237     MOVE 'DLO002' TO DFHEIV1
 19238*    MOVE '."C                   (   #00018802' TO DFHEIV0
 19239     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19240     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19241     MOVE X'2020233030303138383032' TO DFHEIV0(25:11)
 19242     CALL 'kxdfhei1' USING DFHEIV0,
 19243           DFHEIV1,
 19244           WS-DLO-INTERNAL-POLICY-FORM,
 19245           DLO002-COMM-LENGTH,
 19246           DFHEIV99,
 19247           DFHEIV99,
 19248           DFHEIV99,
 19249           DFHEIV99
 19250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19251
 19252
 19253 7710-EXIT.
 19254     EXIT.
 19255
 19256 7720-CALL-DL3.
 19257
 19258* EXEC CICS LINK
 19259*        PROGRAM    ('DLO003')
 19260*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19261*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 356
* EL050.cbl
 19262*    END-EXEC.
 19263     MOVE 'DLO003' TO DFHEIV1
 19264*    MOVE '."C                   (   #00018812' TO DFHEIV0
 19265     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19267     MOVE X'2020233030303138383132' TO DFHEIV0(25:11)
 19268     CALL 'kxdfhei1' USING DFHEIV0,
 19269           DFHEIV1,
 19270           WS-DLO-VALID-BANK-ID,
 19271           DLO003-COMM-LENGTH,
 19272           DFHEIV99,
 19273           DFHEIV99,
 19274           DFHEIV99,
 19275           DFHEIV99
 19276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19277
 19278
 19279 7720-EXIT.
 19280     EXIT.
 19281
 19282 7730-CALL-DL7.
 19283
 19284* EXEC CICS LINK
 19285*        PROGRAM    ('DLO007')
 19286*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19287*        LENGTH     (DLO007-COMM-LENGTH)
 19288*    END-EXEC.
 19289     MOVE 'DLO007' TO DFHEIV1
 19290*    MOVE '."C                   (   #00018822' TO DFHEIV0
 19291     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19293     MOVE X'2020233030303138383232' TO DFHEIV0(25:11)
 19294     CALL 'kxdfhei1' USING DFHEIV0,
 19295           DFHEIV1,
 19296           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19297           DLO007-COMM-LENGTH,
 19298           DFHEIV99,
 19299           DFHEIV99,
 19300           DFHEIV99,
 19301           DFHEIV99
 19302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19303
 19304
 19305 7730-EXIT.
 19306     EXIT.
 19307
 19308 7740-CALL-DL11.
 19309
 19310* EXEC CICS LINK
 19311*        PROGRAM    ('DLO011')
 19312*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19313*        LENGTH     (DLO011-COMM-LENGTH)
 19314*    END-EXEC.
 19315     MOVE 'DLO011' TO DFHEIV1
 19316*    MOVE '."C                   (   #00018832' TO DFHEIV0
 19317     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19318     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19319     MOVE X'2020233030303138383332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 357
* EL050.cbl
 19320     CALL 'kxdfhei1' USING DFHEIV0,
 19321           DFHEIV1,
 19322           WS-DLO-PREM-RATES-BEN-TYPE,
 19323           DLO011-COMM-LENGTH,
 19324           DFHEIV99,
 19325           DFHEIV99,
 19326           DFHEIV99,
 19327           DFHEIV99
 19328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19329
 19330
 19331 7740-EXIT.
 19332     EXIT.
 19333
 19334 7750-CALL-DL17.
 19335
 19336* EXEC CICS LINK
 19337*        PROGRAM    ('DLO017')
 19338*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19339*        LENGTH     (DLO017-COMM-LENGTH)
 19340*    END-EXEC.
 19341     MOVE 'DLO017' TO DFHEIV1
 19342*    MOVE '."C                   (   #00018842' TO DFHEIV0
 19343     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19345     MOVE X'2020233030303138383432' TO DFHEIV0(25:11)
 19346     CALL 'kxdfhei1' USING DFHEIV0,
 19347           DFHEIV1,
 19348           WS-DLO-VALID-RATE-CODE,
 19349           DLO017-COMM-LENGTH,
 19350           DFHEIV99,
 19351           DFHEIV99,
 19352           DFHEIV99,
 19353           DFHEIV99
 19354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19355
 19356
 19357 7750-EXIT.
 19358     EXIT.
 19359
 19360 7755-CALL-DL19.
 19361
 19362* EXEC CICS LINK
 19363*        PROGRAM    ('DLO019')
 19364*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19365*        LENGTH     (DLO019-COMM-LENGTH)
 19366*    END-EXEC.
 19367     MOVE 'DLO019' TO DFHEIV1
 19368*    MOVE '."C                   (   #00018852' TO DFHEIV0
 19369     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19371     MOVE X'2020233030303138383532' TO DFHEIV0(25:11)
 19372     CALL 'kxdfhei1' USING DFHEIV0,
 19373           DFHEIV1,
 19374           WS-DLO-ORIG-COV-CAT,
 19375           DLO019-COMM-LENGTH,
 19376           DFHEIV99,
 19377           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 358
* EL050.cbl
 19378           DFHEIV99,
 19379           DFHEIV99
 19380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19381
 19382
 19383 7755-EXIT.
 19384     EXIT.
 19385
 19386 7760-CALL-DL21.
 19387
 19388* EXEC CICS LINK
 19389*        PROGRAM    ('DLO021')
 19390*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19391*        LENGTH     (DLO021-COMM-LENGTH)
 19392*    END-EXEC.
 19393     MOVE 'DLO021' TO DFHEIV1
 19394*    MOVE '."C                   (   #00018862' TO DFHEIV0
 19395     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19396     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19397     MOVE X'2020233030303138383632' TO DFHEIV0(25:11)
 19398     CALL 'kxdfhei1' USING DFHEIV0,
 19399           DFHEIV1,
 19400           WS-DLO-VALID-LOAN-OFFICER,
 19401           DLO021-COMM-LENGTH,
 19402           DFHEIV99,
 19403           DFHEIV99,
 19404           DFHEIV99,
 19405           DFHEIV99
 19406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19407
 19408
 19409 7760-EXIT.
 19410     EXIT.
 19411
 19412 7770-CALL-DL22.
 19413
 19414* EXEC CICS LINK
 19415*        PROGRAM    ('DLO022')
 19416*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19417*        LENGTH     (DLO022-COMM-LENGTH)
 19418*    END-EXEC.
 19419     MOVE 'DLO022' TO DFHEIV1
 19420*    MOVE '."C                   (   #00018872' TO DFHEIV0
 19421     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19422     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19423     MOVE X'2020233030303138383732' TO DFHEIV0(25:11)
 19424     CALL 'kxdfhei1' USING DFHEIV0,
 19425           DFHEIV1,
 19426           WS-DLO-VALID-STATE-CODE,
 19427           DLO022-COMM-LENGTH,
 19428           DFHEIV99,
 19429           DFHEIV99,
 19430           DFHEIV99,
 19431           DFHEIV99
 19432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19433
 19434
 19435 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 359
* EL050.cbl
 19436     EXIT.
 19437
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 360
* EL050.cbl
 19439
 19440 7800-REWRITE-CERT.
 19441******************************************************************
 19442*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19443*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19444******************************************************************
 19445
 19446     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19447        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19448        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19449        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19450
 19451* EXEC CICS REWRITE
 19452*                  DATASET (CERT-ID)
 19453*                  FROM    (CERTIFICATE-MASTER)
 19454*              END-EXEC
 19455     MOVE LENGTH OF
 19456      CERTIFICATE-MASTER
 19457       TO DFHEIV11
 19458*    MOVE '&& L                  %   #00018893' TO DFHEIV0
 19459     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19460     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19461     MOVE X'2020233030303138383933' TO DFHEIV0(25:11)
 19462     CALL 'kxdfhei1' USING DFHEIV0,
 19463           CERT-ID,
 19464           CERTIFICATE-MASTER,
 19465           DFHEIV11,
 19466           DFHEIV99
 19467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19468        GO TO 7800-EXIT.
 19469
 19470       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19471       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19472
 19473 7800-EXIT.
 19474      EXIT.
 19475
 19476 7900-DELETE-CERT.
 19477
 19478* EXEC CICS DELETE
 19479*        DATASET (CERT-ID)
 19480*    END-EXEC.
 19481*    MOVE '&(                    &   #00018906' TO DFHEIV0
 19482     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19483     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19484     MOVE X'2020233030303138393036' TO DFHEIV0(25:11)
 19485     CALL 'kxdfhei1' USING DFHEIV0,
 19486           CERT-ID,
 19487           DFHEIV99,
 19488           DFHEIV99,
 19489           DFHEIV99,
 19490           DFHEIV99
 19491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19492
 19493
 19494 7900-EXIT.
 19495     EXIT.
 19496
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 361
* EL050.cbl
 19497 8000-WRITE-CERT.
 19498
 19499* EXEC CICS HANDLE CONDITION
 19500*        DUPKEY    (8000-FREE-MAIN)
 19501*    END-EXEC.
 19502*    MOVE '"$$                   ! + #00018914' TO DFHEIV0
 19503     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19505     MOVE X'2B20233030303138393134' TO DFHEIV0(25:11)
 19506     CALL 'kxdfhei1' USING DFHEIV0
 19507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19508
 19509
 19510
 19511* EXEC CICS WRITE
 19512*        DATASET     (CERT-ID)
 19513*        FROM        (CERTIFICATE-MASTER)
 19514*        RIDFLD      (ELCERT-KEY)
 19515*    END-EXEC.
 19516     MOVE LENGTH OF
 19517      CERTIFICATE-MASTER
 19518       TO DFHEIV11
 19519*    MOVE '&$ L                  ''   #00018918' TO DFHEIV0
 19520     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19521     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19522     MOVE X'2020233030303138393138' TO DFHEIV0(25:11)
 19523     CALL 'kxdfhei1' USING DFHEIV0,
 19524           CERT-ID,
 19525           CERTIFICATE-MASTER,
 19526           DFHEIV11,
 19527           ELCERT-KEY,
 19528           DFHEIV99,
 19529           DFHEIV99
 19530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19531
 19532
 19533 8000-FREE-MAIN.
 19534
 19535 8000-EXIT.
 19536      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 362
* EL050.cbl
 19538
 19539 8100-READ-ERPNDM.
 19540
 19541* EXEC CICS HANDLE CONDITION
 19542*         NOTFND     (8100-NOTFND)
 19543*         ENDFILE    (8100-NOTFND)
 19544*    END-EXEC.
 19545*    MOVE '"$I''                  ! , #00018931' TO DFHEIV0
 19546     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19548     MOVE X'2C20233030303138393331' TO DFHEIV0(25:11)
 19549     CALL 'kxdfhei1' USING DFHEIV0
 19550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19551
 19552
 19553     MOVE SPACES                 TO ERPNDM-FOUND.
 19554     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19555
 19556
 19557* EXEC CICS READ
 19558*         DATASET   (FILE-ERPNDM)
 19559*         RIDFLD    (PM-CONTROL-PRIMARY)
 19560*         INTO      (PENDING-MAILING-DATA)
 19561*    END-EXEC.
 19562     MOVE LENGTH OF
 19563      PENDING-MAILING-DATA
 19564       TO DFHEIV11
 19565*    MOVE '&"IL       E          (   #00018939' TO DFHEIV0
 19566     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19567     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19568     MOVE X'2020233030303138393339' TO DFHEIV0(25:11)
 19569     CALL 'kxdfhei1' USING DFHEIV0,
 19570           FILE-ERPNDM,
 19571           PENDING-MAILING-DATA,
 19572           DFHEIV11,
 19573           PM-CONTROL-PRIMARY,
 19574           DFHEIV99,
 19575           DFHEIV99,
 19576           DFHEIV99
 19577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19578
 19579
 19580     GO TO 8100-EXIT.
 19581
 19582 8100-NOTFND.
 19583
 19584     MOVE 'X'                    TO ERPNDM-FOUND.
 19585     MOVE ER-2694                TO WS-ERROR.
 19586     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19587     MOVE ER-2883                TO WS-ERROR
 19588     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19589     .
 19590 8100-EXIT.
 19591     EXIT.
 19592
 19593 8110-READ-ERMAIL.
 19594
 19595* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 363
* EL050.cbl
 19596*         NOTFND     (8110-NOTFND)
 19597*         ENDFILE    (8110-NOTFND)
 19598*    END-EXEC.
 19599*    MOVE '"$I''                  ! - #00018959' TO DFHEIV0
 19600     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19602     MOVE X'2D20233030303138393539' TO DFHEIV0(25:11)
 19603     CALL 'kxdfhei1' USING DFHEIV0
 19604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19605
 19606
 19607     MOVE SPACES                 TO ERMAIL-FOUND.
 19608     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19609     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19610     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19611     MOVE PB-SV-STATE            TO MA-STATE.
 19612
 19613
 19614* EXEC CICS READ
 19615*         UPDATE
 19616*         DATASET   (FILE-ERMAIL)
 19617*         RIDFLD    (MA-CONTROL-PRIMARY)
 19618*         INTO      (MAILING-DATA)
 19619*    END-EXEC.
 19620     MOVE LENGTH OF
 19621      MAILING-DATA
 19622       TO DFHEIV11
 19623*    MOVE '&"IL       EU         (   #00018970' TO DFHEIV0
 19624     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19625     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19626     MOVE X'2020233030303138393730' TO DFHEIV0(25:11)
 19627     CALL 'kxdfhei1' USING DFHEIV0,
 19628           FILE-ERMAIL,
 19629           MAILING-DATA,
 19630           DFHEIV11,
 19631           MA-CONTROL-PRIMARY,
 19632           DFHEIV99,
 19633           DFHEIV99,
 19634           DFHEIV99
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19636
 19637
 19638     GO TO 8110-EXIT.
 19639
 19640 8110-NOTFND.
 19641     MOVE 'X'                    TO ERMAIL-FOUND.
 19642
 19643 8110-EXIT.
 19644     EXIT.
 19645
 19646 8120-REWRITE-ERMAIL.
 19647
 19648* EXEC CICS REWRITE
 19649*         DATASET    (FILE-ERMAIL)
 19650*         FROM       (MAILING-DATA)
 19651*    END-EXEC.
 19652     MOVE LENGTH OF
 19653      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 364
* EL050.cbl
 19654       TO DFHEIV11
 19655*    MOVE '&& L                  %   #00018986' TO DFHEIV0
 19656     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19657     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19658     MOVE X'2020233030303138393836' TO DFHEIV0(25:11)
 19659     CALL 'kxdfhei1' USING DFHEIV0,
 19660           FILE-ERMAIL,
 19661           MAILING-DATA,
 19662           DFHEIV11,
 19663           DFHEIV99
 19664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19665
 19666
 19667 8120-EXIT.
 19668     EXIT.
 19669
 19670 8130-WRITE-ERMAIL.
 19671
 19672* EXEC CICS HANDLE CONDITION
 19673*         DUPKEY   (8130-EXIT)
 19674*    END-EXEC.
 19675*    MOVE '"$$                   ! . #00018995' TO DFHEIV0
 19676     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19677     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19678     MOVE X'2E20233030303138393935' TO DFHEIV0(25:11)
 19679     CALL 'kxdfhei1' USING DFHEIV0
 19680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19681
 19682
 19683
 19684* EXEC CICS WRITE
 19685*         DATASET     (FILE-ERMAIL)
 19686*         RIDFLD      (MA-CONTROL-PRIMARY)
 19687*         FROM        (MAILING-DATA)
 19688*    END-EXEC.
 19689     MOVE LENGTH OF
 19690      MAILING-DATA
 19691       TO DFHEIV11
 19692*    MOVE '&$ L                  ''   #00018999' TO DFHEIV0
 19693     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19694     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19695     MOVE X'2020233030303138393939' TO DFHEIV0(25:11)
 19696     CALL 'kxdfhei1' USING DFHEIV0,
 19697           FILE-ERMAIL,
 19698           MAILING-DATA,
 19699           DFHEIV11,
 19700           MA-CONTROL-PRIMARY,
 19701           DFHEIV99,
 19702           DFHEIV99
 19703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19704
 19705
 19706 8130-EXIT.
 19707     EXIT.
 19708
 19709 8140-UNLOCK-ERMAIL.
 19710
 19711* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 365
* EL050.cbl
 19712*         DATASET   (FILE-ERMAIL)
 19713*    END-EXEC.
 19714*    MOVE '&*                    #   #00019009' TO DFHEIV0
 19715     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19716     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19717     MOVE X'2020233030303139303039' TO DFHEIV0(25:11)
 19718     CALL 'kxdfhei1' USING DFHEIV0,
 19719           FILE-ERMAIL,
 19720           DFHEIV99
 19721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19722
 19723
 19724 8140-EXIT.
 19725     EXIT.
 19726
 19727 8150-read-elcrtt.
 19728
 19729
 19730* EXEC CICS HANDLE CONDITION
 19731*        NOTFND   (8150-exit)
 19732*    END-EXEC
 19733*    MOVE '"$I                   ! / #00019018' TO DFHEIV0
 19734     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19736     MOVE X'2F20233030303139303138' TO DFHEIV0(25:11)
 19737     CALL 'kxdfhei1' USING DFHEIV0
 19738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19739
 19740     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19741     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19742
 19743
 19744* EXEC CICS READ
 19745*        DATASET  (CRTT-ID)
 19746*        RIDFLD   (WS-ELCRTT-KEY)
 19747*        INTO     (CERTIFICATE-TRAILERS)
 19748*    END-EXEC
 19749     MOVE LENGTH OF
 19750      CERTIFICATE-TRAILERS
 19751       TO DFHEIV11
 19752*    MOVE '&"IL       E          (   #00019025' TO DFHEIV0
 19753     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19754     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19755     MOVE X'2020233030303139303235' TO DFHEIV0(25:11)
 19756     CALL 'kxdfhei1' USING DFHEIV0,
 19757           CRTT-ID,
 19758           CERTIFICATE-TRAILERS,
 19759           DFHEIV11,
 19760           WS-ELCRTT-KEY,
 19761           DFHEIV99,
 19762           DFHEIV99,
 19763           DFHEIV99
 19764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19765
 19766     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19767     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19768
 19769     .
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 366
* EL050.cbl
 19770 8150-exit.
 19771     exit.
 19772 8180-UPDATE-VIN-NUMBER.
 19773
 19774* EXEC CICS HANDLE CONDITION
 19775*        NOTFND   (8180-NOTFND)
 19776*    END-EXEC.
 19777*    MOVE '"$I                   ! 0 #00019038' TO DFHEIV0
 19778     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19780     MOVE X'3020233030303139303338' TO DFHEIV0(25:11)
 19781     CALL 'kxdfhei1' USING DFHEIV0
 19782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19783
 19784
 19785     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19786     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19787
 19788
 19789* EXEC CICS READ
 19790*        UPDATE
 19791*        DATASET  (CRTT-ID)
 19792*        RIDFLD   (WS-ELCRTT-KEY)
 19793*        INTO     (CERTIFICATE-TRAILERS)
 19794*    END-EXEC.
 19795     MOVE LENGTH OF
 19796      CERTIFICATE-TRAILERS
 19797       TO DFHEIV11
 19798*    MOVE '&"IL       EU         (   #00019045' TO DFHEIV0
 19799     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19800     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19801     MOVE X'2020233030303139303435' TO DFHEIV0(25:11)
 19802     CALL 'kxdfhei1' USING DFHEIV0,
 19803           CRTT-ID,
 19804           CERTIFICATE-TRAILERS,
 19805           DFHEIV11,
 19806           WS-ELCRTT-KEY,
 19807           DFHEIV99,
 19808           DFHEIV99,
 19809           DFHEIV99
 19810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19811
 19812
 19813     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19814         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19815
 19816* EXEC CICS REWRITE
 19817*           DATASET  (CRTT-ID)
 19818*           FROM     (CERTIFICATE-TRAILERS)
 19819*        END-EXEC
 19820     MOVE LENGTH OF
 19821      CERTIFICATE-TRAILERS
 19822       TO DFHEIV11
 19823*    MOVE '&& L                  %   #00019054' TO DFHEIV0
 19824     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19825     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19826     MOVE X'2020233030303139303534' TO DFHEIV0(25:11)
 19827     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 367
* EL050.cbl
 19828           CRTT-ID,
 19829           CERTIFICATE-TRAILERS,
 19830           DFHEIV11,
 19831           DFHEIV99
 19832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19833     ELSE
 19834
 19835* EXEC CICS UNLOCK
 19836*          DATASET  (CRTT-ID)
 19837*       END-EXEC
 19838*    MOVE '&*                    #   #00019059' TO DFHEIV0
 19839     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19840     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19841     MOVE X'2020233030303139303539' TO DFHEIV0(25:11)
 19842     CALL 'kxdfhei1' USING DFHEIV0,
 19843           CRTT-ID,
 19844           DFHEIV99
 19845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19846     END-IF.
 19847
 19848     GO TO 8180-EXIT.
 19849
 19850 8180-NOTFND.
 19851
 19852     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19853     MOVE 'CS'         TO CS-RECORD-ID.
 19854     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19855     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19856     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19857     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19858
 19859* EXEC CICS WRITE
 19860*       DATASET  (CRTT-ID)
 19861*       RIDFLD   (WS-ELCRTT-KEY)
 19862*       FROM     (CERTIFICATE-TRAILERS)
 19863*    END-EXEC.
 19864     MOVE LENGTH OF
 19865      CERTIFICATE-TRAILERS
 19866       TO DFHEIV11
 19867*    MOVE '&$ L                  ''   #00019074' TO DFHEIV0
 19868     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19869     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19870     MOVE X'2020233030303139303734' TO DFHEIV0(25:11)
 19871     CALL 'kxdfhei1' USING DFHEIV0,
 19872           CRTT-ID,
 19873           CERTIFICATE-TRAILERS,
 19874           DFHEIV11,
 19875           WS-ELCRTT-KEY,
 19876           DFHEIV99,
 19877           DFHEIV99
 19878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19879
 19880
 19881 8180-EXIT.
 19882     EXIT.
 19883
 19884 8190-UPDATE-REFUND-CLAIM-FLAG.
 19885
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 368
* EL050.cbl
 19886* EXEC CICS HANDLE CONDITION
 19887*        NOTFND   (8190-NOTFND)
 19888*    END-EXEC.
 19889*    MOVE '"$I                   ! 1 #00019084' TO DFHEIV0
 19890     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19892     MOVE X'3120233030303139303834' TO DFHEIV0(25:11)
 19893     CALL 'kxdfhei1' USING DFHEIV0
 19894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19895
 19896
 19897     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19898     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19899
 19900
 19901* EXEC CICS READ
 19902*        UPDATE
 19903*        DATASET  (CRTT-ID)
 19904*        RIDFLD   (WS-ELCRTT-KEY)
 19905*        INTO     (CERTIFICATE-TRAILERS)
 19906*    END-EXEC.
 19907     MOVE LENGTH OF
 19908      CERTIFICATE-TRAILERS
 19909       TO DFHEIV11
 19910*    MOVE '&"IL       EU         (   #00019091' TO DFHEIV0
 19911     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19912     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19913     MOVE X'2020233030303139303931' TO DFHEIV0(25:11)
 19914     CALL 'kxdfhei1' USING DFHEIV0,
 19915           CRTT-ID,
 19916           CERTIFICATE-TRAILERS,
 19917           DFHEIV11,
 19918           WS-ELCRTT-KEY,
 19919           DFHEIV99,
 19920           DFHEIV99,
 19921           DFHEIV99
 19922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19923
 19924
 19925     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19926
 19927* EXEC CICS REWRITE
 19928*       DATASET  (CRTT-ID)
 19929*       FROM     (CERTIFICATE-TRAILERS)
 19930*    END-EXEC.
 19931     MOVE LENGTH OF
 19932      CERTIFICATE-TRAILERS
 19933       TO DFHEIV11
 19934*    MOVE '&& L                  %   #00019099' TO DFHEIV0
 19935     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19936     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19937     MOVE X'2020233030303139303939' TO DFHEIV0(25:11)
 19938     CALL 'kxdfhei1' USING DFHEIV0,
 19939           CRTT-ID,
 19940           CERTIFICATE-TRAILERS,
 19941           DFHEIV11,
 19942           DFHEIV99
 19943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 369
* EL050.cbl
 19944
 19945
 19946     GO TO 8190-EXIT.
 19947
 19948 8190-NOTFND.
 19949
 19950     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19951     MOVE 'CS'         TO CS-RECORD-ID.
 19952     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19953     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19954     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19955     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19956
 19957* EXEC CICS WRITE
 19958*       DATASET  (CRTT-ID)
 19959*       RIDFLD   (WS-ELCRTT-KEY)
 19960*       FROM     (CERTIFICATE-TRAILERS)
 19961*    END-EXEC.
 19962     MOVE LENGTH OF
 19963      CERTIFICATE-TRAILERS
 19964       TO DFHEIV11
 19965*    MOVE '&$ L                  ''   #00019114' TO DFHEIV0
 19966     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19967     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19968     MOVE X'2020233030303139313134' TO DFHEIV0(25:11)
 19969     CALL 'kxdfhei1' USING DFHEIV0,
 19970           CRTT-ID,
 19971           CERTIFICATE-TRAILERS,
 19972           DFHEIV11,
 19973           WS-ELCRTT-KEY,
 19974           DFHEIV99,
 19975           DFHEIV99
 19976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19977
 19978
 19979 8190-EXIT.
 19980     EXIT.
 19981
 19982 8195-UPDATE-AGE-FLAGS.
 19983
 19984* EXEC CICS HANDLE CONDITION
 19985*        NOTFND   (8195-NOTFND)
 19986*    END-EXEC.
 19987*    MOVE '"$I                   ! 2 #00019124' TO DFHEIV0
 19988     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19990     MOVE X'3220233030303139313234' TO DFHEIV0(25:11)
 19991     CALL 'kxdfhei1' USING DFHEIV0
 19992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19993
 19994
 19995     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19996     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19997
 19998
 19999* EXEC CICS READ
 20000*        UPDATE
 20001*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 370
* EL050.cbl
 20002*        RIDFLD   (WS-ELCRTT-KEY)
 20003*        INTO     (CERTIFICATE-TRAILERS)
 20004*    END-EXEC.
 20005     MOVE LENGTH OF
 20006      CERTIFICATE-TRAILERS
 20007       TO DFHEIV11
 20008*    MOVE '&"IL       EU         (   #00019131' TO DFHEIV0
 20009     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20010     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20011     MOVE X'2020233030303139313331' TO DFHEIV0(25:11)
 20012     CALL 'kxdfhei1' USING DFHEIV0,
 20013           CRTT-ID,
 20014           CERTIFICATE-TRAILERS,
 20015           DFHEIV11,
 20016           WS-ELCRTT-KEY,
 20017           DFHEIV99,
 20018           DFHEIV99,
 20019           DFHEIV99
 20020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20021
 20022
 20023     IF WS-INS-AGE-SET = 'Y'
 20024        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20025     END-IF
 20026     IF WS-JNT-AGE-SET = 'Y'
 20027        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20028     END-IF
 20029
 20030
 20031* EXEC CICS REWRITE
 20032*       DATASET  (CRTT-ID)
 20033*       FROM     (CERTIFICATE-TRAILERS)
 20034*    END-EXEC.
 20035     MOVE LENGTH OF
 20036      CERTIFICATE-TRAILERS
 20037       TO DFHEIV11
 20038*    MOVE '&& L                  %   #00019145' TO DFHEIV0
 20039     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20040     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20041     MOVE X'2020233030303139313435' TO DFHEIV0(25:11)
 20042     CALL 'kxdfhei1' USING DFHEIV0,
 20043           CRTT-ID,
 20044           CERTIFICATE-TRAILERS,
 20045           DFHEIV11,
 20046           DFHEIV99
 20047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20048
 20049
 20050     GO TO 8195-EXIT.
 20051
 20052 8195-NOTFND.
 20053
 20054     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20055     MOVE 'CS'         TO CS-RECORD-ID.
 20056     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20057     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20058     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20059     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 371
* EL050.cbl
 20060     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20061
 20062* EXEC CICS WRITE
 20063*       DATASET  (CRTT-ID)
 20064*       RIDFLD   (WS-ELCRTT-KEY)
 20065*       FROM     (CERTIFICATE-TRAILERS)
 20066*    END-EXEC.
 20067     MOVE LENGTH OF
 20068      CERTIFICATE-TRAILERS
 20069       TO DFHEIV11
 20070*    MOVE '&$ L                  ''   #00019161' TO DFHEIV0
 20071     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20072     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20073     MOVE X'2020233030303139313631' TO DFHEIV0(25:11)
 20074     CALL 'kxdfhei1' USING DFHEIV0,
 20075           CRTT-ID,
 20076           CERTIFICATE-TRAILERS,
 20077           DFHEIV11,
 20078           WS-ELCRTT-KEY,
 20079           DFHEIV99,
 20080           DFHEIV99
 20081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20082
 20083
 20084 8195-EXIT.
 20085     EXIT.
 20086
 20087 8200-READ-REIN-TABLE.
 20088
 20089* EXEC CICS HANDLE CONDITION
 20090*         NOTFND   (8200-NOTFND)
 20091*    END-EXEC.
 20092*    MOVE '"$I                   ! 3 #00019171' TO DFHEIV0
 20093     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20095     MOVE X'3320233030303139313731' TO DFHEIV0(25:11)
 20096     CALL 'kxdfhei1' USING DFHEIV0
 20097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20098
 20099
 20100
 20101* EXEC CICS READ
 20102*        DATASET     (REIN-ID)
 20103*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20104*        RIDFLD      (ERREIN-KEY)
 20105*    END-EXEC.
 20106*    MOVE '&"S        E          (   #00019175' TO DFHEIV0
 20107     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20109     MOVE X'2020233030303139313735' TO DFHEIV0(25:11)
 20110     CALL 'kxdfhei1' USING DFHEIV0,
 20111           REIN-ID,
 20112           DFHEIV20,
 20113           DFHEIV99,
 20114           ERREIN-KEY,
 20115           DFHEIV99,
 20116           DFHEIV99,
 20117           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 372
* EL050.cbl
 20118     SET ADDRESS OF REINSURANCE-RECORD TO
 20119         DFHEIV20
 20120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20121
 20122
 20123     GO TO 8200-EXIT.
 20124
 20125 8200-NOTFND.
 20126     MOVE 'N'             TO WS-REIN-READ-SW.
 20127
 20128 8200-EXIT.
 20129      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 373
* EL050.cbl
 20131
 20132 8300-READ-CTBL-TABLE.
 20133
 20134* EXEC CICS HANDLE CONDITION
 20135*        NOTFND    (8300-NOTFND)
 20136*        DISABLED  (8300-ERRESS-PROBLEM)
 20137*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20138*        ENDFILE   (8300-NOTFND)
 20139*    END-EXEC.
 20140*    MOVE '"$IcJ''                ! 4 #00019191' TO DFHEIV0
 20141     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20143     MOVE X'3420233030303139313931' TO DFHEIV0(25:11)
 20144     CALL 'kxdfhei1' USING DFHEIV0
 20145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20146
 20147
 20148
 20149* EXEC CICS READ
 20150*        DATASET     (CTBL-ID)
 20151*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20152*        RIDFLD      (ERCTBL-KEY)
 20153*    END-EXEC.
 20154*    MOVE '&"S        E          (   #00019198' TO DFHEIV0
 20155     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20156     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20157     MOVE X'2020233030303139313938' TO DFHEIV0(25:11)
 20158     CALL 'kxdfhei1' USING DFHEIV0,
 20159           CTBL-ID,
 20160           DFHEIV20,
 20161           DFHEIV99,
 20162           ERCTBL-KEY,
 20163           DFHEIV99,
 20164           DFHEIV99,
 20165           DFHEIV99
 20166     SET ADDRESS OF COMM-TABLE-RECORD TO
 20167         DFHEIV20
 20168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20169
 20170
 20171     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20172
 20173     GO TO 8300-EXIT.
 20174
 20175 8300-NOTFND.
 20176
 20177     IF CTBL-SW = '0530'
 20178         MOVE 'AA'                     TO WS-AH-COMP-CD
 20179         MOVE '0550'                   TO CTBL-SW
 20180         MOVE '1'                      TO WS-CTBL-READ-SW
 20181         GO TO 8300-EXIT.
 20182
 20183     IF CTBL-SW = '0540'
 20184         MOVE 'AA'                     TO WS-LF-COMP-CD
 20185         MOVE '0550'                   TO CTBL-SW
 20186         MOVE '1'                      TO WS-CTBL-READ-SW
 20187         GO TO 8300-EXIT.
 20188
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 374
* EL050.cbl
 20189     IF CTBL-SW = '0550'
 20190         MOVE '2'                      TO WS-CTBL-READ-SW
 20191         GO TO 8300-EXIT.
 20192
 20193     GO TO 8300-EXIT.
 20194
 20195 8300-ERRESS-PROBLEM.
 20196
 20197      MOVE ER-8050              TO WS-ERROR.
 20198      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20199
 20200     GO TO 8300-EXIT.
 20201
 20202 8300-EXIT.
 20203      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 375
* EL050.cbl
 20205
 20206
 20207 8400-GETMAIN-ERFORM.
 20208
 20209
 20210* EXEC CICS   GETMAIN
 20211*        LENGTH  (500)
 20212*        SET     (ADDRESS OF FORM-MASTER)
 20213*    END-EXEC.
 20214     MOVE 500
 20215       TO DFHEIV11
 20216*    MOVE '," L                  $   #00019242' TO DFHEIV0
 20217     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20218     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20219     MOVE X'2020233030303139323432' TO DFHEIV0(25:11)
 20220     CALL 'kxdfhei1' USING DFHEIV0,
 20221           DFHEIV20,
 20222           DFHEIV11,
 20223           DFHEIV99
 20224     SET ADDRESS OF FORM-MASTER TO
 20225         DFHEIV20
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228
 20229     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20230
 20231 8400-EXIT.
 20232      EXIT.
 20233
 20234 8450-READ-FORM-MASTER.
 20235
 20236
 20237* EXEC CICS  HANDLE CONDITION
 20238*        NOTFND   (8450-FORM-NOT-FOUND)
 20239*        ENDFILE  (8450-FORM-NOT-FOUND)
 20240*    END-EXEC.
 20241*    MOVE '"$I''                  ! 5 #00019254' TO DFHEIV0
 20242     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20244     MOVE X'3520233030303139323534' TO DFHEIV0(25:11)
 20245     CALL 'kxdfhei1' USING DFHEIV0
 20246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20247
 20248
 20249
 20250* EXEC CICS   READ
 20251*        DATASET   (FORM-ID)
 20252*        RIDFLD    (ERFORM-KEY)
 20253*        INTO      (FORM-MASTER)
 20254*        GTEQ
 20255*    END-EXEC.
 20256     MOVE LENGTH OF
 20257      FORM-MASTER
 20258       TO DFHEIV11
 20259*    MOVE '&"IL       G          (   #00019259' TO DFHEIV0
 20260     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20261     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20262     MOVE X'2020233030303139323539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 376
* EL050.cbl
 20263     CALL 'kxdfhei1' USING DFHEIV0,
 20264           FORM-ID,
 20265           FORM-MASTER,
 20266           DFHEIV11,
 20267           ERFORM-KEY,
 20268           DFHEIV99,
 20269           DFHEIV99,
 20270           DFHEIV99
 20271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20272
 20273
 20274     MOVE  'Y'           TO  FORM-MASTER-SW.
 20275
 20276     GO TO  8450-EXIT.
 20277
 20278 8450-FORM-NOT-FOUND.
 20279
 20280     MOVE  'N'           TO  FORM-MASTER-SW.
 20281
 20282 8450-EXIT.
 20283      EXIT.
 20284
 20285 8500-DATE-CONVERT.
 20286
 20287* EXEC CICS LINK
 20288*        PROGRAM    ('ELDATCV')
 20289*        COMMAREA   (DATE-CONVERSION-DATA)
 20290*        LENGTH     (DC-COMM-LENGTH)
 20291*    END-EXEC.
 20292     MOVE 'ELDATCV' TO DFHEIV1
 20293*    MOVE '."C                   (   #00019278' TO DFHEIV0
 20294     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20296     MOVE X'2020233030303139323738' TO DFHEIV0(25:11)
 20297     CALL 'kxdfhei1' USING DFHEIV0,
 20298           DFHEIV1,
 20299           DATE-CONVERSION-DATA,
 20300           DC-COMM-LENGTH,
 20301           DFHEIV99,
 20302           DFHEIV99,
 20303           DFHEIV99,
 20304           DFHEIV99
 20305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20306
 20307
 20308 8500-EXIT.
 20309     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 377
* EL050.cbl
 20311
 20312 8555-RELOAD-CONTROL-FILE.
 20313     CONTINUE.
 20314
 20315 8555-EXIT.
 20316     EXIT.
 20317
 20318 8557-GETMAIN-ERPLAN.
 20319
 20320
 20321* EXEC CICS GETMAIN
 20322*        LENGTH    (840)
 20323*        SET       (ADDRESS OF PLAN-RECORDS)
 20324*    END-EXEC.
 20325     MOVE 840
 20326       TO DFHEIV11
 20327*    MOVE '," L                  $   #00019296' TO DFHEIV0
 20328     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20329     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20330     MOVE X'2020233030303139323936' TO DFHEIV0(25:11)
 20331     CALL 'kxdfhei1' USING DFHEIV0,
 20332           DFHEIV20,
 20333           DFHEIV11,
 20334           DFHEIV99
 20335     SET ADDRESS OF PLAN-RECORDS TO
 20336         DFHEIV20
 20337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20338
 20339
 20340     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20341
 20342 8557-EXIT.
 20343     EXIT.
 20344
 20345 8560-GETMAIN.
 20346
 20347* EXEC CICS GETMAIN
 20348*        LENGTH    (2000)
 20349*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20350*    END-EXEC.
 20351     MOVE 2000
 20352       TO DFHEIV11
 20353*    MOVE '," L                  $   #00019307' TO DFHEIV0
 20354     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20355     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20356     MOVE X'2020233030303139333037' TO DFHEIV0(25:11)
 20357     CALL 'kxdfhei1' USING DFHEIV0,
 20358           DFHEIV20,
 20359           DFHEIV11,
 20360           DFHEIV99
 20361     SET ADDRESS OF ACCOUNT-MASTER TO
 20362         DFHEIV20
 20363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20364
 20365
 20366     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20367
 20368 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 378
* EL050.cbl
 20369     EXIT.
 20370
 20371 8570-START-ACCOUNT-MASTER.
 20372
 20373* EXEC CICS HANDLE CONDITION
 20374*        NOTFND    (0199-ACCT-NOT-FOUND)
 20375*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20376*    END-EXEC.
 20377*    MOVE '"$I''                  ! 6 #00019318' TO DFHEIV0
 20378     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20380     MOVE X'3620233030303139333138' TO DFHEIV0(25:11)
 20381     CALL 'kxdfhei1' USING DFHEIV0
 20382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20383
 20384
 20385
 20386* EXEC CICS STARTBR
 20387*        DATASET    (ACCT-ID)
 20388*        RIDFLD     (ERACCT-KEY)
 20389*        GTEQ
 20390*    END-EXEC.
 20391     MOVE 0
 20392       TO DFHEIV11
 20393*    MOVE '&,         G          &   #00019323' TO DFHEIV0
 20394     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20395     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20396     MOVE X'2020233030303139333233' TO DFHEIV0(25:11)
 20397     CALL 'kxdfhei1' USING DFHEIV0,
 20398           ACCT-ID,
 20399           ERACCT-KEY,
 20400           DFHEIV99,
 20401           DFHEIV11,
 20402           DFHEIV99
 20403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20404
 20405
 20406 8570-EXIT.
 20407     EXIT.
 20408
 20409 8580-READ-ACCOUNT-MASTER.
 20410
 20411* EXEC CICS HANDLE CONDITION
 20412*        NOTFND    (0199-ACCT-NOT-FOUND)
 20413*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20414*    END-EXEC.
 20415*    MOVE '"$I''                  ! 7 #00019333' TO DFHEIV0
 20416     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20418     MOVE X'3720233030303139333333' TO DFHEIV0(25:11)
 20419     CALL 'kxdfhei1' USING DFHEIV0
 20420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20421
 20422
 20423
 20424* EXEC CICS READNEXT
 20425*        DATASET     (ACCT-ID)
 20426*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 379
* EL050.cbl
 20427*        RIDFLD      (ERACCT-KEY)
 20428*    END-EXEC.
 20429     MOVE LENGTH OF
 20430      ACCOUNT-MASTER
 20431       TO DFHEIV12
 20432     MOVE 0
 20433       TO DFHEIV11
 20434*    MOVE '&.IL                  )   #00019338' TO DFHEIV0
 20435     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20436     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20437     MOVE X'2020233030303139333338' TO DFHEIV0(25:11)
 20438     CALL 'kxdfhei1' USING DFHEIV0,
 20439           ACCT-ID,
 20440           ACCOUNT-MASTER,
 20441           DFHEIV12,
 20442           ERACCT-KEY,
 20443           DFHEIV99,
 20444           DFHEIV11,
 20445           DFHEIV99,
 20446           DFHEIV99
 20447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20448
 20449
 20450 8580-EXIT.
 20451     EXIT.
 20452
 20453 8582-READ-COMPENSATION-MASTER.
 20454
 20455* EXEC CICS HANDLE CONDITION
 20456*        NOTFND    (8582-COMP-NOT-FOUND)
 20457*        ENDFILE   (8582-COMP-NOT-FOUND)
 20458*    END-EXEC.
 20459*    MOVE '"$I''                  ! 8 #00019348' TO DFHEIV0
 20460     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20462     MOVE X'3820233030303139333438' TO DFHEIV0(25:11)
 20463     CALL 'kxdfhei1' USING DFHEIV0
 20464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20465
 20466
 20467
 20468* EXEC CICS READ
 20469*        DATASET     (COMP-ID)
 20470*        INTO        (COMPENSATION-MASTER)
 20471*        RIDFLD      (ERCOMP-KEY)
 20472*    END-EXEC.
 20473     MOVE LENGTH OF
 20474      COMPENSATION-MASTER
 20475       TO DFHEIV11
 20476*    MOVE '&"IL       E          (   #00019353' TO DFHEIV0
 20477     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20479     MOVE X'2020233030303139333533' TO DFHEIV0(25:11)
 20480     CALL 'kxdfhei1' USING DFHEIV0,
 20481           COMP-ID,
 20482           COMPENSATION-MASTER,
 20483           DFHEIV11,
 20484           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 380
* EL050.cbl
 20485           DFHEIV99,
 20486           DFHEIV99,
 20487           DFHEIV99
 20488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20489
 20490
 20491     MOVE 'Y'                    TO COMP-MASTER-SW
 20492
 20493     GO TO 8582-EXIT
 20494     .
 20495 8582-COMP-NOT-FOUND.
 20496
 20497     MOVE 'N'                    TO COMP-MASTER-SW.
 20498
 20499 8582-EXIT.
 20500     EXIT.
 20501
 20502 8583-READ-ERAGTC.
 20503
 20504* EXEC CICS HANDLE CONDITION
 20505*        NOTFND    (8583-AGTC-NOT-FOUND)
 20506*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20507*    END-EXEC.
 20508*    MOVE '"$I''                  ! 9 #00019371' TO DFHEIV0
 20509     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20511     MOVE X'3920233030303139333731' TO DFHEIV0(25:11)
 20512     CALL 'kxdfhei1' USING DFHEIV0
 20513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20514
 20515
 20516
 20517* EXEC CICS STARTBR
 20518*        DATASET    (AGTC-ID)
 20519*        RIDFLD     (ERAGTC-KEY)
 20520*        GTEQ
 20521*    END-EXEC.
 20522     MOVE 0
 20523       TO DFHEIV11
 20524*    MOVE '&,         G          &   #00019376' TO DFHEIV0
 20525     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20526     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20527     MOVE X'2020233030303139333736' TO DFHEIV0(25:11)
 20528     CALL 'kxdfhei1' USING DFHEIV0,
 20529           AGTC-ID,
 20530           ERAGTC-KEY,
 20531           DFHEIV99,
 20532           DFHEIV11,
 20533           DFHEIV99
 20534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20535
 20536
 20537 8583-READ-ERAGTC-NEXT.
 20538
 20539* EXEC CICS READNEXT
 20540*        DATASET     (AGTC-ID)
 20541*        INTO        (AGENT-COMMISSIONS)
 20542*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 381
* EL050.cbl
 20543*    END-EXEC.
 20544     MOVE LENGTH OF
 20545      AGENT-COMMISSIONS
 20546       TO DFHEIV12
 20547     MOVE 0
 20548       TO DFHEIV11
 20549*    MOVE '&.IL                  )   #00019383' TO DFHEIV0
 20550     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20551     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20552     MOVE X'2020233030303139333833' TO DFHEIV0(25:11)
 20553     CALL 'kxdfhei1' USING DFHEIV0,
 20554           AGTC-ID,
 20555           AGENT-COMMISSIONS,
 20556           DFHEIV12,
 20557           ERAGTC-KEY,
 20558           DFHEIV99,
 20559           DFHEIV11,
 20560           DFHEIV99,
 20561           DFHEIV99
 20562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20563
 20564
 20565*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20566
 20567     GO TO 8583-EXIT
 20568     .
 20569 8583-AGTC-NOT-FOUND.
 20570
 20571     MOVE 'N'                    TO AGTC-MASTER-SW.
 20572
 20573 8583-EXIT.
 20574     EXIT.
 20575
 20576 8584-READ-BANK-CROSS-REF.
 20577
 20578* EXEC CICS HANDLE CONDITION
 20579*        NOTFND    (8584-BXRF-NOT-FOUND)
 20580*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20581*    END-EXEC.
 20582*    MOVE '"$I''                  ! : #00019401' TO DFHEIV0
 20583     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20585     MOVE X'3A20233030303139343031' TO DFHEIV0(25:11)
 20586     CALL 'kxdfhei1' USING DFHEIV0
 20587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20588
 20589
 20590
 20591* EXEC CICS READ
 20592*        DATASET     (BXRF-ID)
 20593*        INTO        (BANK-CROSS-REFERENCE)
 20594*        RIDFLD      (ERBXRF-KEY)
 20595*        LENGTH      (BXRF-REC-LENGTH)
 20596*    END-EXEC.
 20597*    MOVE '&"IL       E          (   #00019406' TO DFHEIV0
 20598     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20600     MOVE X'2020233030303139343036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 382
* EL050.cbl
 20601     CALL 'kxdfhei1' USING DFHEIV0,
 20602           BXRF-ID,
 20603           BANK-CROSS-REFERENCE,
 20604           BXRF-REC-LENGTH,
 20605           ERBXRF-KEY,
 20606           DFHEIV99,
 20607           DFHEIV99,
 20608           DFHEIV99
 20609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20610
 20611
 20612     MOVE 'Y'                    TO BXRF-MASTER-SW
 20613
 20614     GO TO 8584-EXIT
 20615     .
 20616 8584-BXRF-NOT-FOUND.
 20617
 20618     MOVE 'N'                    TO BXRF-MASTER-SW.
 20619
 20620 8584-EXIT.
 20621     EXIT.
 20622
 20623 8585-READ-PLAN-MASTER.
 20624
 20625
 20626* EXEC CICS HANDLE CONDITION
 20627*        NOTFND    (8585-PLAN-NOT-FOUND)
 20628*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20629*    END-EXEC.
 20630*    MOVE '"$I''                  ! ; #00019426' TO DFHEIV0
 20631     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20633     MOVE X'3B20233030303139343236' TO DFHEIV0(25:11)
 20634     CALL 'kxdfhei1' USING DFHEIV0
 20635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20636
 20637
 20638
 20639* EXEC CICS READ
 20640*        DATASET     (PLAN-ID)
 20641*        INTO        (PLAN-MASTER)
 20642*        RIDFLD      (ERPLAN-KEY)
 20643*    END-EXEC.
 20644     MOVE LENGTH OF
 20645      PLAN-MASTER
 20646       TO DFHEIV11
 20647*    MOVE '&"IL       E          (   #00019431' TO DFHEIV0
 20648     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20649     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20650     MOVE X'2020233030303139343331' TO DFHEIV0(25:11)
 20651     CALL 'kxdfhei1' USING DFHEIV0,
 20652           PLAN-ID,
 20653           PLAN-MASTER,
 20654           DFHEIV11,
 20655           ERPLAN-KEY,
 20656           DFHEIV99,
 20657           DFHEIV99,
 20658           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 383
* EL050.cbl
 20659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20660
 20661
 20662     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20663
 20664     GO TO 8585-EXIT.
 20665
 20666 8585-PLAN-NOT-FOUND.
 20667
 20668     MOVE 'N'                    TO PLAN-MASTER-SW.
 20669
 20670 8585-EXIT.
 20671     EXIT.
 20672
 20673 8586-READ-LOAN-OFFICER.
 20674
 20675* EXEC CICS READ
 20676*        DATASET     (LOFC-ID)
 20677*        INTO        (LOAN-OFFICER-MASTER)
 20678*        RIDFLD      (ERLOFC-KEY)
 20679*        RESP        (WS-RESPONSE)
 20680*    END-EXEC
 20681     MOVE LENGTH OF
 20682      LOAN-OFFICER-MASTER
 20683       TO DFHEIV11
 20684*    MOVE '&"IL       E          (  N#00019449' TO DFHEIV0
 20685     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20686     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20687     MOVE X'204E233030303139343439' TO DFHEIV0(25:11)
 20688     CALL 'kxdfhei1' USING DFHEIV0,
 20689           LOFC-ID,
 20690           LOAN-OFFICER-MASTER,
 20691           DFHEIV11,
 20692           ERLOFC-KEY,
 20693           DFHEIV99,
 20694           DFHEIV99,
 20695           DFHEIV99
 20696     MOVE EIBRESP  TO WS-RESPONSE
 20697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20698
 20699     IF WS-RESP-NORMAL
 20700        MOVE 'Y'                 TO LOFC-MASTER-SW
 20701     ELSE
 20702        MOVE 'N'                 TO LOFC-MASTER-SW
 20703     END-IF
 20704     .
 20705 8586-EXIT.
 20706     EXIT.
 20707 8587-START-ERPDEF.
 20708
 20709* EXEC CICS STARTBR
 20710*       DATASET   (PDEF-ID)
 20711*       RIDFLD    (ERPDEF-KEY)
 20712*       GTEQ
 20713*       RESP      (WS-RESPONSE)
 20714*    END-EXEC
 20715     MOVE 0
 20716       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 384
* EL050.cbl
 20717*    MOVE '&,         G          &  N#00019465' TO DFHEIV0
 20718     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20719     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20720     MOVE X'204E233030303139343635' TO DFHEIV0(25:11)
 20721     CALL 'kxdfhei1' USING DFHEIV0,
 20722           PDEF-ID,
 20723           ERPDEF-KEY,
 20724           DFHEIV99,
 20725           DFHEIV11,
 20726           DFHEIV99
 20727     MOVE EIBRESP  TO WS-RESPONSE
 20728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20729     IF WS-RESP-NORMAL
 20730        MOVE 'Y'                 TO PDEF-MASTER-SW
 20731     ELSE
 20732        MOVE 'N'                 TO PDEF-MASTER-SW
 20733     END-IF
 20734     .
 20735 8587-EXIT.
 20736     EXIT.
 20737 8588-READ-ERPDEF.
 20738
 20739* EXEC CICS READNEXT
 20740*       DATASET   (PDEF-ID)
 20741*       RIDFLD    (ERPDEF-KEY)
 20742*       INTO      (PRODUCT-MASTER)
 20743*       RESP      (WS-RESPONSE)
 20744*    END-EXEC
 20745     MOVE LENGTH OF
 20746      PRODUCT-MASTER
 20747       TO DFHEIV12
 20748     MOVE 0
 20749       TO DFHEIV11
 20750*    MOVE '&.IL                  )  N#00019480' TO DFHEIV0
 20751     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20752     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20753     MOVE X'204E233030303139343830' TO DFHEIV0(25:11)
 20754     CALL 'kxdfhei1' USING DFHEIV0,
 20755           PDEF-ID,
 20756           PRODUCT-MASTER,
 20757           DFHEIV12,
 20758           ERPDEF-KEY,
 20759           DFHEIV99,
 20760           DFHEIV11,
 20761           DFHEIV99,
 20762           DFHEIV99
 20763     MOVE EIBRESP  TO WS-RESPONSE
 20764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20765     IF WS-RESP-NORMAL
 20766        MOVE 'Y'                 TO PDEF-MASTER-SW
 20767     ELSE
 20768        MOVE 'N'                 TO PDEF-MASTER-SW
 20769     END-IF
 20770     .
 20771 8588-EXIT.
 20772     EXIT.
 20773 8589-ENDBR-ERPDEF.
 20774
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 385
* EL050.cbl
 20775* EXEC CICS ENDBR
 20776*       DATASET   (PDEF-ID)
 20777*    END-EXEC
 20778     MOVE 0
 20779       TO DFHEIV11
 20780*    MOVE '&2                    $   #00019495' TO DFHEIV0
 20781     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20782     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20783     MOVE X'2020233030303139343935' TO DFHEIV0(25:11)
 20784     CALL 'kxdfhei1' USING DFHEIV0,
 20785           PDEF-ID,
 20786           DFHEIV11,
 20787           DFHEIV99
 20788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20789     .
 20790 8589-EXIT.
 20791     EXIT.
 20792 8590-READ-CERT-MASTER.
 20793     IF PB-COMPANY-ID = 'UCL'
 20794         GO TO 8690-READ-CERT-MASTER-UCL.
 20795
 20796
 20797* EXEC CICS HANDLE CONDITION
 20798*         NOTFND    (0299-CERT-NOT-FOUND)
 20799*    END-EXEC.
 20800*    MOVE '"$I                   ! < #00019505' TO DFHEIV0
 20801     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20803     MOVE X'3C20233030303139353035' TO DFHEIV0(25:11)
 20804     CALL 'kxdfhei1' USING DFHEIV0
 20805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20806
 20807
 20808
 20809* EXEC CICS READ
 20810*        DATASET     (CERT-ID)
 20811*        INTO        (CERTIFICATE-MASTER)
 20812*        RIDFLD      (ELCERT-KEY)
 20813*        UPDATE
 20814*    END-EXEC.
 20815     MOVE LENGTH OF
 20816      CERTIFICATE-MASTER
 20817       TO DFHEIV11
 20818*    MOVE '&"IL       EU         (   #00019509' TO DFHEIV0
 20819     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20820     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20821     MOVE X'2020233030303139353039' TO DFHEIV0(25:11)
 20822     CALL 'kxdfhei1' USING DFHEIV0,
 20823           CERT-ID,
 20824           CERTIFICATE-MASTER,
 20825           DFHEIV11,
 20826           ELCERT-KEY,
 20827           DFHEIV99,
 20828           DFHEIV99,
 20829           DFHEIV99
 20830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20831
 20832
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 386
* EL050.cbl
 20833 8590-EXIT.
 20834     EXIT.
 20835
 20836 8690-READ-CERT-MASTER-UCL.
 20837
 20838* EXEC CICS HANDLE CONDITION
 20839*         NOTFND    (8700-READ-CERT-MASTER)
 20840*    END-EXEC.
 20841*    MOVE '"$I                   ! = #00019520' TO DFHEIV0
 20842     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20844     MOVE X'3D20233030303139353230' TO DFHEIV0(25:11)
 20845     CALL 'kxdfhei1' USING DFHEIV0
 20846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20847
 20848
 20849 8690-READ-CERT-CONT.
 20850
 20851* EXEC CICS READ
 20852*        DATASET     (CERT-ID)
 20853*        INTO        (CERTIFICATE-MASTER)
 20854*        RIDFLD      (ELCERT-KEY)
 20855*        UPDATE
 20856*    END-EXEC.
 20857     MOVE LENGTH OF
 20858      CERTIFICATE-MASTER
 20859       TO DFHEIV11
 20860*    MOVE '&"IL       EU         (   #00019525' TO DFHEIV0
 20861     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20862     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20863     MOVE X'2020233030303139353235' TO DFHEIV0(25:11)
 20864     CALL 'kxdfhei1' USING DFHEIV0,
 20865           CERT-ID,
 20866           CERTIFICATE-MASTER,
 20867           DFHEIV11,
 20868           ELCERT-KEY,
 20869           DFHEIV99,
 20870           DFHEIV99,
 20871           DFHEIV99
 20872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20873
 20874
 20875     GO TO 8590-EXIT.
 20876
 20877 8700-READ-CERT-MASTER.
 20878     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20879     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20880
 20881* EXEC CICS HANDLE CONDITION
 20882*         DUPKEY    (8720-COMP-ACCOUNTS)
 20883*         ENDFILE   (8730-END-BROWSE)
 20884*         NOTFND    (8740-NOT-FOUND)
 20885*    END-EXEC.
 20886*    MOVE '"$$''I                 ! > #00019537' TO DFHEIV0
 20887     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20889     MOVE X'3E20233030303139353337' TO DFHEIV0(25:11)
 20890     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 387
* EL050.cbl
 20891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20892
 20893
 20894
 20895* EXEC CICS STARTBR
 20896*        DATASET     ('ELCERT5')
 20897*        RIDFLD      (ELCERT2-KEY)
 20898*        EQUAL
 20899*    END-EXEC.
 20900     MOVE 'ELCERT5' TO DFHEIV1
 20901     MOVE 0
 20902       TO DFHEIV11
 20903*    MOVE '&,         E          &   #00019543' TO DFHEIV0
 20904     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20905     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20906     MOVE X'2020233030303139353433' TO DFHEIV0(25:11)
 20907     CALL 'kxdfhei1' USING DFHEIV0,
 20908           DFHEIV1,
 20909           ELCERT2-KEY,
 20910           DFHEIV99,
 20911           DFHEIV11,
 20912           DFHEIV99
 20913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20914
 20915
 20916 8710-READ-NEXT.
 20917
 20918* EXEC CICS READNEXT
 20919*        DATASET     ('ELCERT5')
 20920*        INTO        (CERTIFICATE-MASTER)
 20921*        RIDFLD      (ELCERT2-KEY)
 20922*    END-EXEC.
 20923     MOVE LENGTH OF
 20924      CERTIFICATE-MASTER
 20925       TO DFHEIV12
 20926     MOVE 'ELCERT5' TO DFHEIV1
 20927     MOVE 0
 20928       TO DFHEIV11
 20929*    MOVE '&.IL                  )   #00019550' TO DFHEIV0
 20930     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20931     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20932     MOVE X'2020233030303139353530' TO DFHEIV0(25:11)
 20933     CALL 'kxdfhei1' USING DFHEIV0,
 20934           DFHEIV1,
 20935           CERTIFICATE-MASTER,
 20936           DFHEIV12,
 20937           ELCERT2-KEY,
 20938           DFHEIV99,
 20939           DFHEIV11,
 20940           DFHEIV99,
 20941           DFHEIV99
 20942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20943
 20944
 20945 8720-COMP-ACCOUNTS.
 20946
 20947* EXEC CICS ENTER
 20948*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 388
* EL050.cbl
 20949*         FROM (PB-C-LAST-NAME)
 20950*    END-EXEC.
 20951     MOVE 001
 20952       TO DFHEIV11
 20953*    MOVE ':$F                   %   #00019557' TO DFHEIV0
 20954     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20955     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20956     MOVE X'2020233030303139353537' TO DFHEIV0(25:11)
 20957     CALL 'kxdfhei1' USING DFHEIV0,
 20958           DFHEIV11,
 20959           PB-C-LAST-NAME,
 20960           DFHEIV99,
 20961           DFHEIV99
 20962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20963
 20964
 20965
 20966* EXEC CICS ENTER
 20967*         TRACEID (002)
 20968*         FROM (CM-INSURED-LAST-NAME)
 20969*    END-EXEC.
 20970     MOVE 002
 20971       TO DFHEIV11
 20972*    MOVE ':$F                   %   #00019562' TO DFHEIV0
 20973     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20974     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20975     MOVE X'2020233030303139353632' TO DFHEIV0(25:11)
 20976     CALL 'kxdfhei1' USING DFHEIV0,
 20977           DFHEIV11,
 20978           CM-INSURED-LAST-NAME,
 20979           DFHEIV99,
 20980           DFHEIV99
 20981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20982
 20983
 20984     IF PB-CERT-NO NOT = CM-CERT-NO
 20985         GO TO 8730-END-BROWSE.
 20986
 20987     IF PB-ACCOUNT = CM-ACCOUNT
 20988         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20989             MOVE ER-2799        TO WS-ERROR
 20990             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20991             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20992             GO TO 8730-END-BROWSE.
 20993
 20994     GO TO 8710-READ-NEXT.
 20995
 20996 8730-END-BROWSE.
 20997
 20998* EXEC CICS ENDBR
 20999*         DATASET    ('ELCERT5')
 21000*    END-EXEC.
 21001     MOVE 'ELCERT5' TO DFHEIV1
 21002     MOVE 0
 21003       TO DFHEIV11
 21004*    MOVE '&2                    $   #00019580' TO DFHEIV0
 21005     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21006     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 389
* EL050.cbl
 21007     MOVE X'2020233030303139353830' TO DFHEIV0(25:11)
 21008     CALL 'kxdfhei1' USING DFHEIV0,
 21009           DFHEIV1,
 21010           DFHEIV11,
 21011           DFHEIV99
 21012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21013
 21014
 21015 8740-NOT-FOUND.
 21016     GO TO 0299-CERT-NOT-FOUND.
 21017
 21018 8750-START-ELSTAT.
 21019
 21020* EXEC CICS STARTBR
 21021*       DATASET   (STAT-ID)
 21022*       RIDFLD    (ELSTAT-KEY)
 21023*       GTEQ
 21024*       RESP      (WS-RESPONSE)
 21025*    END-EXEC
 21026     MOVE 0
 21027       TO DFHEIV11
 21028*    MOVE '&,         G          &  N#00019588' TO DFHEIV0
 21029     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21030     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21031     MOVE X'204E233030303139353838' TO DFHEIV0(25:11)
 21032     CALL 'kxdfhei1' USING DFHEIV0,
 21033           STAT-ID,
 21034           ELSTAT-KEY,
 21035           DFHEIV99,
 21036           DFHEIV11,
 21037           DFHEIV99
 21038     MOVE EIBRESP  TO WS-RESPONSE
 21039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21040     IF WS-RESP-NORMAL
 21041        MOVE 'Y'                 TO STAT-MASTER-SW
 21042     ELSE
 21043        MOVE 'N'                 TO STAT-MASTER-SW
 21044     END-IF
 21045     .
 21046 8750-EXIT.
 21047     EXIT.
 21048 8752-READ-ELSTAT.
 21049
 21050* EXEC CICS READNEXT
 21051*       DATASET   (STAT-ID)
 21052*       RIDFLD    (ELSTAT-KEY)
 21053*       INTO      (STATE-FILE)
 21054*       RESP      (WS-RESPONSE)
 21055*    END-EXEC
 21056     MOVE LENGTH OF
 21057      STATE-FILE
 21058       TO DFHEIV12
 21059     MOVE 0
 21060       TO DFHEIV11
 21061*    MOVE '&.IL                  )  N#00019603' TO DFHEIV0
 21062     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21063     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21064     MOVE X'204E233030303139363033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 390
* EL050.cbl
 21065     CALL 'kxdfhei1' USING DFHEIV0,
 21066           STAT-ID,
 21067           STATE-FILE,
 21068           DFHEIV12,
 21069           ELSTAT-KEY,
 21070           DFHEIV99,
 21071           DFHEIV11,
 21072           DFHEIV99,
 21073           DFHEIV99
 21074     MOVE EIBRESP  TO WS-RESPONSE
 21075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21076     IF WS-RESP-NORMAL
 21077        MOVE 'Y'                 TO STAT-MASTER-SW
 21078     ELSE
 21079        MOVE 'N'                 TO STAT-MASTER-SW
 21080     END-IF
 21081     .
 21082 8752-EXIT.
 21083     EXIT.
 21084 8800-GET-COMP-RATE.
 21085     MOVE +1 TO IB.
 21086     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21087         ADD +9 TO IB
 21088         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21089             ADD +9 TO IB
 21090             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21091                MOVE ZEROS       TO WS-WK-RATE
 21092                GO TO 8800-EXIT.
 21093
 21094     IF PB-I-AGE GREATER CT-AGE (1)
 21095         ADD +3 TO IB
 21096         IF PB-I-AGE GREATER CT-AGE (2)
 21097             ADD +3 TO IB
 21098             IF PB-I-AGE GREATER CT-AGE (3)
 21099                MOVE ZEROS       TO WS-WK-RATE
 21100                GO TO 8800-EXIT.
 21101
 21102     IF WS-WORK-TERM GREATER CT-TRM (1)
 21103         ADD +1 TO IB
 21104         IF WS-WORK-TERM GREATER CT-TRM (2)
 21105             ADD +1 TO IB
 21106             IF WS-WORK-TERM GREATER CT-TRM (3)
 21107                MOVE ZEROS       TO WS-WK-RATE
 21108                GO TO 8800-EXIT.
 21109
 21110     IF CT-RT (IB) NOT NUMERIC
 21111         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21112         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21113         GO TO 8800-GET-COMP-RATE.
 21114
 21115     MOVE CT-RT (IB) TO WS-WK-RATE.
 21116
 21117 8800-EXIT.
 21118     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 391
* EL050.cbl
 21120 8900-ADDRESS-FILE.
 21121     IF ERACCT-FILE-ADDRESSED
 21122         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21123         GO TO 8900-ADDRESS-EXIT.
 21124
 21125     IF ELCNTL-FILE-ADDRESSED
 21126         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21127         GO TO 8900-ADDRESS-EXIT.
 21128
 21129     IF ERPLAN-FILE-ADDRESSED
 21130         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21131         GO TO 8900-ADDRESS-EXIT.
 21132
 21133     IF ERFORM-FILE-ADDRESSED
 21134         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21135         GO TO 8900-ADDRESS-EXIT.
 21136
 21137 8900-ADDRESS-EXIT.
 21138     EXIT.
 21139
 21140 9000-READ-CONTROL.
 21141
 21142* EXEC CICS HANDLE CONDITION
 21143*        NOTFND    (9000-NOTFND)
 21144*    END-EXEC.
 21145*    MOVE '"$I                   ! ? #00019674' TO DFHEIV0
 21146     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21148     MOVE X'3F20233030303139363734' TO DFHEIV0(25:11)
 21149     CALL 'kxdfhei1' USING DFHEIV0
 21150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21151
 21152
 21153
 21154* EXEC CICS READ
 21155*        DATASET     (CNTL-ID)
 21156*        SET         (ADDRESS OF CONTROL-FILE)
 21157*        RIDFLD      (ELCNTL-KEY)
 21158*        GTEQ
 21159*    END-EXEC.
 21160*    MOVE '&"S        G          (   #00019678' TO DFHEIV0
 21161     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21163     MOVE X'2020233030303139363738' TO DFHEIV0(25:11)
 21164     CALL 'kxdfhei1' USING DFHEIV0,
 21165           CNTL-ID,
 21166           DFHEIV20,
 21167           DFHEIV99,
 21168           ELCNTL-KEY,
 21169           DFHEIV99,
 21170           DFHEIV99,
 21171           DFHEIV99
 21172     SET ADDRESS OF CONTROL-FILE TO
 21173         DFHEIV20
 21174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21175
 21176
 21177     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 392
* EL050.cbl
 21178
 21179 9000-NOTFND.
 21180     IF RC-SW-1 = '1'
 21181        MOVE ER-2616              TO WS-ERROR
 21182        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21183        GO TO 9000-EXIT.
 21184
 21185     IF RC-SW-1 = '2'
 21186        MOVE ER-2602              TO WS-ERROR
 21187        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21188
 21189 9000-EXIT.
 21190      EXIT.
 21191
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 393
* EL050.cbl
 21193 9100-READ-CONTROL.
 21194
 21195* EXEC CICS HANDLE CONDITION
 21196*        NOTFND  (9100-NOTFND)
 21197*        ENDFILE (9100-NOTFND)
 21198*    END-EXEC.
 21199*    MOVE '"$I''                  ! @ #00019702' TO DFHEIV0
 21200     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21202     MOVE X'4020233030303139373032' TO DFHEIV0(25:11)
 21203     CALL 'kxdfhei1' USING DFHEIV0
 21204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21205
 21206
 21207
 21208* EXEC CICS READ
 21209*        DATASET     (CNTL-ID)
 21210*        INTO        (CONTROL-FILE)
 21211*        RIDFLD      (ELCNTL-KEY)
 21212*        GTEQ
 21213*    END-EXEC.
 21214     MOVE LENGTH OF
 21215      CONTROL-FILE
 21216       TO DFHEIV11
 21217*    MOVE '&"IL       G          (   #00019707' TO DFHEIV0
 21218     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21220     MOVE X'2020233030303139373037' TO DFHEIV0(25:11)
 21221     CALL 'kxdfhei1' USING DFHEIV0,
 21222           CNTL-ID,
 21223           CONTROL-FILE,
 21224           DFHEIV11,
 21225           ELCNTL-KEY,
 21226           DFHEIV99,
 21227           DFHEIV99,
 21228           DFHEIV99
 21229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21230
 21231
 21232     GO TO 9100-EXIT.
 21233
 21234 9100-NOTFND.
 21235     IF RC-SW-2 = '0'
 21236        MOVE '1'                  TO STATE-RECORD-ERROR
 21237        GO TO 9100-EXIT
 21238     END-IF
 21239     IF RC-SW-2 = '1'
 21240        MOVE '1'                  TO LF-BENEFIT-ERROR
 21241        MOVE ER-2604              TO WS-ERROR
 21242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21243        GO TO 9100-EXIT.
 21244
 21245     IF RC-SW-2 = '2'
 21246        MOVE '1'                  TO AH-BENEFIT-ERROR
 21247        MOVE ER-2605              TO WS-ERROR
 21248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21249        GO TO 9100-EXIT.
 21250
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 394
* EL050.cbl
 21251     IF RC-SW-2 = '3'
 21252         MOVE ER-2603           TO WS-ERROR
 21253         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21254         GO TO 9100-EXIT.
 21255
 21256     IF RC-SW-2 = '4'
 21257         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21258         GO TO 9100-EXIT.
 21259
 21260     IF RC-SW-2 = '5'
 21261         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21262         IF WS-AH-INPUT-CD-1 = SPACE
 21263             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21264         ELSE
 21265             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21266
 21267 9100-EXIT.
 21268      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 395
* EL050.cbl
 21270 9200-CONTROL-GETMAIN.
 21271
 21272* EXEC CICS GETMAIN
 21273*         LENGTH   (750)
 21274*         SET      (ADDRESS OF CONTROL-FILE)
 21275*    END-EXEC.
 21276     MOVE 750
 21277       TO DFHEIV11
 21278*    MOVE '," L                  $   #00019753' TO DFHEIV0
 21279     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21280     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21281     MOVE X'2020233030303139373533' TO DFHEIV0(25:11)
 21282     CALL 'kxdfhei1' USING DFHEIV0,
 21283           DFHEIV20,
 21284           DFHEIV11,
 21285           DFHEIV99
 21286     SET ADDRESS OF CONTROL-FILE TO
 21287         DFHEIV20
 21288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21289
 21290
 21291     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21292
 21293 9200-EXIT.
 21294     EXIT.
 21295
 21296 9250-UNLOCK-RETURN.
 21297
 21298* EXEC CICS UNLOCK
 21299*        DATASET   (CERT-ID)
 21300*    END-EXEC.
 21301*    MOVE '&*                    #   #00019764' TO DFHEIV0
 21302     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21303     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21304     MOVE X'2020233030303139373634' TO DFHEIV0(25:11)
 21305     CALL 'kxdfhei1' USING DFHEIV0,
 21306           CERT-ID,
 21307           DFHEIV99
 21308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21309
 21310
 21311 9300-ABEND.
 21312     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21313
 21314
 21315* EXEC CICS LINK
 21316*        PROGRAM   ('EL004')
 21317*        COMMAREA  (WS-ERROR-LINE)
 21318*        LENGTH    (72)
 21319*    END-EXEC.
 21320     MOVE 'EL004' TO DFHEIV1
 21321     MOVE 72
 21322       TO DFHEIV11
 21323*    MOVE '."C                   (   #00019771' TO DFHEIV0
 21324     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21326     MOVE X'2020233030303139373731' TO DFHEIV0(25:11)
 21327     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 396
* EL050.cbl
 21328           DFHEIV1,
 21329           WS-ERROR-LINE,
 21330           DFHEIV11,
 21331           DFHEIV99,
 21332           DFHEIV99,
 21333           DFHEIV99,
 21334           DFHEIV99
 21335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21336
 21337
 21338     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21339
 21340
 21341* EXEC CICS ABEND
 21342*        ABCODE ('EL50')
 21343*    END-EXEC.
 21344     MOVE 'EL50' TO DFHEIV5
 21345*    MOVE '.,A                   "   #00019779' TO DFHEIV0
 21346     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21347     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21348     MOVE X'2020233030303139373739' TO DFHEIV0(25:11)
 21349     CALL 'kxdfhei1' USING DFHEIV0,
 21350           DFHEIV5
 21351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21352
 21353
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 397
* EL050.cbl
 21355
 21356******************************************************************
 21357*                                                                *
 21358*            E R R O R   F O R M A T   R O U T I N E             *
 21359*                                                                *
 21360******************************************************************
 21361
 21362 9900-ERROR-FORMAT.
 21363
 21364     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21365                    PB-COMMON-ERROR (2) OR
 21366                    PB-COMMON-ERROR (3) OR
 21367                    PB-COMMON-ERROR (4) OR
 21368                    PB-COMMON-ERROR (5) OR
 21369                    PB-COMMON-ERROR (6) OR
 21370                    PB-COMMON-ERROR (7) OR
 21371                    PB-COMMON-ERROR (8) OR
 21372                    PB-COMMON-ERROR (9) OR
 21373                    PB-COMMON-ERROR (10)
 21374        GO TO 9900-EXIT.
 21375
 21376     IF PB-NO-OF-ERRORS = +10
 21377        GO TO 9900-EXIT.
 21378
 21379     ADD +1  TO PB-NO-OF-ERRORS.
 21380     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21381                                       (PB-NO-OF-ERRORS).
 21382 9900-EXIT.
 21383     EXIT.
 21384
 21385 9990-RETURN.
 21386     IF BROWSE-STARTED
 21387
 21388* EXEC CICS ENDBR
 21389*            DATASET  (ACCT-ID)
 21390*       END-EXEC.
 21391     MOVE 0
 21392       TO DFHEIV11
 21393*    MOVE '&2                    $   #00019816' TO DFHEIV0
 21394     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21395     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21396     MOVE X'2020233030303139383136' TO DFHEIV0(25:11)
 21397     CALL 'kxdfhei1' USING DFHEIV0,
 21398           ACCT-ID,
 21399           DFHEIV11,
 21400           DFHEIV99
 21401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21402
 21403
 21404 9990-EXIT.
 21405     EXIT.
 21406
 21407
 21408****Check for CRTO record, add one if not found.
 21409 9991-CHECK-FOR-ELCRTO.
 21410
 21411* EXEC CICS HANDLE CONDITION
 21412*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 398
* EL050.cbl
 21413*         ENDFILE (9991-CRTO-NOT-FOUND)
 21414*     END-EXEC.
 21415*    MOVE '"$I''                  ! A #00019826' TO DFHEIV0
 21416     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21418     MOVE X'4120233030303139383236' TO DFHEIV0(25:11)
 21419     CALL 'kxdfhei1' USING DFHEIV0
 21420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21421
 21422     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21423     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21424     MOVE +0                     TO ELCRTO-SEQ-NO
 21425
 21426
 21427* EXEC CICS READ
 21428*       DATASET   ('ELCRTO')
 21429*       INTO      (ORIGINAL-CERTIFICATE)
 21430*       RIDFLD    (ELCRTO-KEY)
 21431*       GTEQ
 21432*       RESP      (WS-RESPONSE)
 21433*    END-EXEC
 21434     MOVE LENGTH OF
 21435      ORIGINAL-CERTIFICATE
 21436       TO DFHEIV11
 21437     MOVE 'ELCRTO' TO DFHEIV1
 21438*    MOVE '&"IL       G          (  N#00019834' TO DFHEIV0
 21439     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21440     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21441     MOVE X'204E233030303139383334' TO DFHEIV0(25:11)
 21442     CALL 'kxdfhei1' USING DFHEIV0,
 21443           DFHEIV1,
 21444           ORIGINAL-CERTIFICATE,
 21445           DFHEIV11,
 21446           ELCRTO-KEY,
 21447           DFHEIV99,
 21448           DFHEIV99,
 21449           DFHEIV99
 21450     MOVE EIBRESP  TO WS-RESPONSE
 21451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21452
 21453     IF WS-RESP-NORMAL
 21454        AND (OC-CONTROL-PRIMARY (1:33) =
 21455                 PB-CONTROL-BY-ACCOUNT (1:33))
 21456        AND (OC-RECORD-TYPE =  'I')
 21457           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21458               GO TO 9991-CHECK-INDICATORS
 21459           ELSE
 21460               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21461               GO TO 9991-CRTO-ADD-REC
 21462           END-IF
 21463     END-IF.
 21464
 21465 9991-CRTO-NOT-FOUND.
 21466
 21467     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21468     MOVE 'OC'                TO OC-RECORD-ID
 21469     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21470                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 399
* EL050.cbl
 21471     MOVE +4096               TO OC-KEY-SEQ-NO.
 21472
 21473 9991-CRTO-ADD-REC.
 21474
 21475     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21476     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21477     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21478     MOVE 'I'                 TO OC-RECORD-TYPE
 21479     IF PB-ISSUE
 21480         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21481         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21482         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21483         MOVE PB-I-AGE               TO OC-INS-AGE
 21484         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21485         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21486         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21487         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21488         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21489         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21490         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21491         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21492         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21493         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21494         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21495         IF PB-I-JOINT-COMMISSION > +0
 21496             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21497         ELSE
 21498             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21499         END-IF
 21500         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21501         MOVE +0                     TO OC-LF-CANCEL-AMT
 21502                                        OC-LF-ITD-CANCEL-AMT
 21503         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21504         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21505         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21506         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21507         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21508         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21509         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21510         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21511         MOVE +0                     TO OC-AH-CANCEL-AMT
 21512                                        OC-AH-ITD-CANCEL-AMT
 21513         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21514         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21515         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21516     ELSE
 21517         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21518         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21519         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21520         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21521         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21522         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21523         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21524         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21525         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21526          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21527             MOVE SPACES             TO OC-LF-BENCD
 21528             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 400
* EL050.cbl
 21529                                        OC-LF-BEN-AMT
 21530                                        OC-LF-PRM-AMT
 21531                                        OC-LF-ALT-BEN-AMT
 21532                                        OC-LF-ALT-PRM-AMT
 21533                                        OC-LF-COMM-PCT
 21534                                        OC-LF-CANCEL-AMT
 21535             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21536             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21537         ELSE
 21538             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21539             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21540             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21541             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21542             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21543             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21544             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21545             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21546             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21547             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21548         END-IF
 21549         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21550         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21551          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21552             MOVE SPACES             TO OC-AH-BENCD
 21553             MOVE ZEROS              TO OC-AH-TERM
 21554                                        OC-AH-BEN-AMT
 21555                                        OC-AH-PRM-AMT
 21556                                        OC-AH-COMM-PCT
 21557                                        OC-AH-CANCEL-AMT
 21558                                        OC-AH-CP
 21559             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21560             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21561         ELSE
 21562             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21563             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21564             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21565             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21566             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21567             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21568             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21569             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21570             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21571         END-IF
 21572         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21573         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21574         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21575         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21576     END-IF
 21577     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21578
 21579     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21580
 21581
 21582* EXEC CICS READ
 21583*         DATASET   (FILE-ERMAIL)
 21584*         RIDFLD    (MA-CONTROL-PRIMARY)
 21585*         INTO      (MAILING-DATA)
 21586*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 401
* EL050.cbl
 21587*    END-EXEC
 21588     MOVE LENGTH OF
 21589      MAILING-DATA
 21590       TO DFHEIV11
 21591*    MOVE '&"IL       E          (  N#00019970' TO DFHEIV0
 21592     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21593     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21594     MOVE X'204E233030303139393730' TO DFHEIV0(25:11)
 21595     CALL 'kxdfhei1' USING DFHEIV0,
 21596           FILE-ERMAIL,
 21597           MAILING-DATA,
 21598           DFHEIV11,
 21599           MA-CONTROL-PRIMARY,
 21600           DFHEIV99,
 21601           DFHEIV99,
 21602           DFHEIV99
 21603     MOVE EIBRESP  TO WS-RESPONSE
 21604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21605
 21606     IF WS-RESP-NORMAL
 21607         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21608     END-IF.
 21609
 21610     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21611     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21612
 21613
 21614* EXEC CICS READ
 21615*         DATASET  (CRTT-ID)
 21616*         RIDFLD   (WS-ELCRTT-KEY)
 21617*         INTO     (CERTIFICATE-TRAILERS)
 21618*         RESP     (WS-RESPONSE)
 21619*    END-EXEC
 21620     MOVE LENGTH OF
 21621      CERTIFICATE-TRAILERS
 21622       TO DFHEIV11
 21623*    MOVE '&"IL       E          (  N#00019984' TO DFHEIV0
 21624     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21626     MOVE X'204E233030303139393834' TO DFHEIV0(25:11)
 21627     CALL 'kxdfhei1' USING DFHEIV0,
 21628           CRTT-ID,
 21629           CERTIFICATE-TRAILERS,
 21630           DFHEIV11,
 21631           WS-ELCRTT-KEY,
 21632           DFHEIV99,
 21633           DFHEIV99,
 21634           DFHEIV99
 21635     MOVE EIBRESP  TO WS-RESPONSE
 21636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21637
 21638     IF WS-RESP-NORMAL
 21639         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21640         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21641     END-IF.
 21642
 21643
 21644* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 402
* EL050.cbl
 21645*       DATASET   ('ELCRTO')
 21646*       FROM      (ORIGINAL-CERTIFICATE)
 21647*       RIDFLD    (OC-CONTROL-PRIMARY)
 21648*       RESP      (WS-RESPONSE)
 21649*    END-EXEC.
 21650     MOVE LENGTH OF
 21651      ORIGINAL-CERTIFICATE
 21652       TO DFHEIV11
 21653     MOVE 'ELCRTO' TO DFHEIV1
 21654*    MOVE '&$ L                  ''  N#00019996' TO DFHEIV0
 21655     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21656     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21657     MOVE X'204E233030303139393936' TO DFHEIV0(25:11)
 21658     CALL 'kxdfhei1' USING DFHEIV0,
 21659           DFHEIV1,
 21660           ORIGINAL-CERTIFICATE,
 21661           DFHEIV11,
 21662           OC-CONTROL-PRIMARY,
 21663           DFHEIV99,
 21664           DFHEIV99
 21665     MOVE EIBRESP  TO WS-RESPONSE
 21666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21667
 21668
 21669     GO TO 9991-EXIT.
 21670
 21671 9991-CHECK-INDICATORS.
 21672
 21673     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21674         GO TO 9991-EXIT
 21675     END-IF.
 21676
 21677     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21678         GO TO 9991-EXIT
 21679     END-IF.
 21680
 21681
 21682* EXEC CICS READ
 21683*       DATASET   ('ELCRTO')
 21684*       INTO      (ORIGINAL-CERTIFICATE)
 21685*       RIDFLD    (OC-CONTROL-PRIMARY)
 21686*       UPDATE
 21687*       RESP      (WS-RESPONSE)
 21688*    END-EXEC
 21689     MOVE LENGTH OF
 21690      ORIGINAL-CERTIFICATE
 21691       TO DFHEIV11
 21692     MOVE 'ELCRTO' TO DFHEIV1
 21693*    MOVE '&"IL       EU         (  N#00020015' TO DFHEIV0
 21694     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21695     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21696     MOVE X'204E233030303230303135' TO DFHEIV0(25:11)
 21697     CALL 'kxdfhei1' USING DFHEIV0,
 21698           DFHEIV1,
 21699           ORIGINAL-CERTIFICATE,
 21700           DFHEIV11,
 21701           OC-CONTROL-PRIMARY,
 21702           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 403
* EL050.cbl
 21703           DFHEIV99,
 21704           DFHEIV99
 21705     MOVE EIBRESP  TO WS-RESPONSE
 21706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21707     IF WS-RESP-NORMAL
 21708        IF PB-ISSUE
 21709          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21710          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21711          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21712          MOVE PB-I-AGE               TO OC-INS-AGE
 21713          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21714          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21715          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21716          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21717          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21718          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21719          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21720          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21721          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21722          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21723          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21724          IF PB-I-JOINT-COMMISSION > +0
 21725              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21726          ELSE
 21727              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21728          END-IF
 21729          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21730          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21731          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21732          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21733          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21734          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21735          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21736          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21737          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21738
 21739          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21740
 21741* EXEC CICS READ
 21742*             DATASET   (FILE-ERMAIL)
 21743*             RIDFLD    (MA-CONTROL-PRIMARY)
 21744*             INTO      (MAILING-DATA)
 21745*             RESP      (WS-RESPONSE)
 21746*         END-EXEC
 21747     MOVE LENGTH OF
 21748      MAILING-DATA
 21749       TO DFHEIV11
 21750*    MOVE '&"IL       E          (  N#00020055' TO DFHEIV0
 21751     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21753     MOVE X'204E233030303230303535' TO DFHEIV0(25:11)
 21754     CALL 'kxdfhei1' USING DFHEIV0,
 21755           FILE-ERMAIL,
 21756           MAILING-DATA,
 21757           DFHEIV11,
 21758           MA-CONTROL-PRIMARY,
 21759           DFHEIV99,
 21760           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 404
* EL050.cbl
 21761           DFHEIV99
 21762     MOVE EIBRESP  TO WS-RESPONSE
 21763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21764          IF WS-RESP-NORMAL
 21765             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21766          END-IF
 21767
 21768          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21769          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21770
 21771* EXEC CICS READ
 21772*             DATASET  (CRTT-ID)
 21773*             RIDFLD   (WS-ELCRTT-KEY)
 21774*             INTO     (CERTIFICATE-TRAILERS)
 21775*             RESP     (WS-RESPONSE)
 21776*         END-EXEC
 21777     MOVE LENGTH OF
 21778      CERTIFICATE-TRAILERS
 21779       TO DFHEIV11
 21780*    MOVE '&"IL       E          (  N#00020067' TO DFHEIV0
 21781     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21783     MOVE X'204E233030303230303637' TO DFHEIV0(25:11)
 21784     CALL 'kxdfhei1' USING DFHEIV0,
 21785           CRTT-ID,
 21786           CERTIFICATE-TRAILERS,
 21787           DFHEIV11,
 21788           WS-ELCRTT-KEY,
 21789           DFHEIV99,
 21790           DFHEIV99,
 21791           DFHEIV99
 21792     MOVE EIBRESP  TO WS-RESPONSE
 21793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21794          IF WS-RESP-NORMAL
 21795             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21796                               OC-INS-AGE-DEFAULT-FLAG
 21797             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21798                               OC-JNT-AGE-DEFAULT-FLAG
 21799          END-IF
 21800
 21801        ELSE
 21802          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21803             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21804             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21805             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21806          END-IF
 21807          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21808             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21809             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21810             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21811          END-IF
 21812          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21813        END-IF
 21814
 21815* EXEC CICS REWRITE
 21816*          DATASET   ('ELCRTO')
 21817*          FROM      (ORIGINAL-CERTIFICATE)
 21818*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 405
* EL050.cbl
 21819*       END-EXEC
 21820     MOVE LENGTH OF
 21821      ORIGINAL-CERTIFICATE
 21822       TO DFHEIV11
 21823     MOVE 'ELCRTO' TO DFHEIV1
 21824*    MOVE '&& L                  %  N#00020093' TO DFHEIV0
 21825     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21826     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21827     MOVE X'204E233030303230303933' TO DFHEIV0(25:11)
 21828     CALL 'kxdfhei1' USING DFHEIV0,
 21829           DFHEIV1,
 21830           ORIGINAL-CERTIFICATE,
 21831           DFHEIV11,
 21832           DFHEIV99
 21833     MOVE EIBRESP  TO WS-RESPONSE
 21834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21835     END-IF.
 21836
 21837 9991-EXIT.
 21838     EXIT.
 21839
 21840
 21841 9999-RETURN.
 21842     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21843
 21844
 21845* EXEC CICS RETURN
 21846*    END-EXEC.
 21847*    MOVE '.(                    ''   #00020107' TO DFHEIV0
 21848     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21850     MOVE X'2020233030303230313037' TO DFHEIV0(25:11)
 21851     CALL 'kxdfhei1' USING DFHEIV0,
 21852           DFHEIV99,
 21853           DFHEIV99,
 21854           DFHEIV99,
 21855           DFHEIV99,
 21856           DFHEIV99,
 21857           DFHEIV99
 21858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21859
 21860
 21861
 21862* GOBACK.
 21863     MOVE '9%                    "   ' TO DFHEIV0
 21864     MOVE 'EL050' TO DFHEIV1
 21865     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21866     GOBACK.
 21867
 21868 9999-DFHBACK SECTION.
 21869     MOVE '9%                    "   ' TO DFHEIV0
 21870     MOVE 'EL050' TO DFHEIV1
 21871     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21872     GOBACK.
 21873 9999-DFHEXIT.
 21874     IF DFHEIGDJ EQUAL 0001
 21875         NEXT SENTENCE
 21876     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 406
* EL050.cbl
 21877         GO TO 9300-ABEND,
 21878               3990-FILES-NOT-OPEN
 21879         DEPENDING ON DFHEIGDI
 21880     ELSE IF DFHEIGDJ EQUAL 3
 21881         GO TO 6610-START-BROWSE,
 21882               6630-ERRESS-PROBLEM,
 21883               6630-END-OF-FILE
 21884         DEPENDING ON DFHEIGDI
 21885     ELSE IF DFHEIGDJ EQUAL 4
 21886         GO TO 6630-END-OF-FILE,
 21887               6630-ERRESS-PROBLEM,
 21888               6630-ERRESS-PROBLEM,
 21889               6630-END-OF-FILE
 21890         DEPENDING ON DFHEIGDI
 21891     ELSE IF DFHEIGDJ EQUAL 5
 21892         GO TO 6630-END-OF-FILE,
 21893               6630-END-OF-FILE,
 21894               6630-ERRESS-PROBLEM,
 21895               6630-ERRESS-PROBLEM
 21896         DEPENDING ON DFHEIGDI
 21897     ELSE IF DFHEIGDJ EQUAL 6
 21898         GO TO 6660-START-BROWSE,
 21899               6690-ERRESC-PROBLEM,
 21900               6690-ERRESC-PROBLEM,
 21901               6690-END-OF-FILE
 21902         DEPENDING ON DFHEIGDI
 21903     ELSE IF DFHEIGDJ EQUAL 7
 21904         GO TO 6690-END-OF-FILE,
 21905               6690-ERRESC-PROBLEM,
 21906               6690-ERRESC-PROBLEM,
 21907               6690-END-OF-FILE
 21908         DEPENDING ON DFHEIGDI
 21909     ELSE IF DFHEIGDJ EQUAL 8
 21910         GO TO 6690-END-OF-FILE,
 21911               6690-ERRESC-PROBLEM,
 21912               6690-ERRESC-PROBLEM,
 21913               6690-END-OF-FILE
 21914         DEPENDING ON DFHEIGDI
 21915     ELSE IF DFHEIGDJ EQUAL 9
 21916         GO TO 7250-CONTINUE,
 21917               7250-CONTINUE
 21918         DEPENDING ON DFHEIGDI
 21919     ELSE IF DFHEIGDJ EQUAL 10
 21920         GO TO 7300-CONTINUE,
 21921               7300-CONTINUE
 21922         DEPENDING ON DFHEIGDI
 21923     ELSE IF DFHEIGDJ EQUAL 11
 21924         GO TO 8000-FREE-MAIN
 21925         DEPENDING ON DFHEIGDI
 21926     ELSE IF DFHEIGDJ EQUAL 12
 21927         GO TO 8100-NOTFND,
 21928               8100-NOTFND
 21929         DEPENDING ON DFHEIGDI
 21930     ELSE IF DFHEIGDJ EQUAL 13
 21931         GO TO 8110-NOTFND,
 21932               8110-NOTFND
 21933         DEPENDING ON DFHEIGDI
 21934     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 407
* EL050.cbl
 21935         GO TO 8130-EXIT
 21936         DEPENDING ON DFHEIGDI
 21937     ELSE IF DFHEIGDJ EQUAL 15
 21938         GO TO 8150-exit
 21939         DEPENDING ON DFHEIGDI
 21940     ELSE IF DFHEIGDJ EQUAL 16
 21941         GO TO 8180-NOTFND
 21942         DEPENDING ON DFHEIGDI
 21943     ELSE IF DFHEIGDJ EQUAL 17
 21944         GO TO 8190-NOTFND
 21945         DEPENDING ON DFHEIGDI
 21946     ELSE IF DFHEIGDJ EQUAL 18
 21947         GO TO 8195-NOTFND
 21948         DEPENDING ON DFHEIGDI
 21949     ELSE IF DFHEIGDJ EQUAL 19
 21950         GO TO 8200-NOTFND
 21951         DEPENDING ON DFHEIGDI
 21952     ELSE IF DFHEIGDJ EQUAL 20
 21953         GO TO 8300-NOTFND,
 21954               8300-ERRESS-PROBLEM,
 21955               8300-ERRESS-PROBLEM,
 21956               8300-NOTFND
 21957         DEPENDING ON DFHEIGDI
 21958     ELSE IF DFHEIGDJ EQUAL 21
 21959         GO TO 8450-FORM-NOT-FOUND,
 21960               8450-FORM-NOT-FOUND
 21961         DEPENDING ON DFHEIGDI
 21962     ELSE IF DFHEIGDJ EQUAL 22
 21963         GO TO 0199-ACCT-NOT-FOUND,
 21964               0199-ACCT-NOT-FOUND
 21965         DEPENDING ON DFHEIGDI
 21966     ELSE IF DFHEIGDJ EQUAL 23
 21967         GO TO 0199-ACCT-NOT-FOUND,
 21968               0199-ACCT-NOT-FOUND
 21969         DEPENDING ON DFHEIGDI
 21970     ELSE IF DFHEIGDJ EQUAL 24
 21971         GO TO 8582-COMP-NOT-FOUND,
 21972               8582-COMP-NOT-FOUND
 21973         DEPENDING ON DFHEIGDI
 21974     ELSE IF DFHEIGDJ EQUAL 25
 21975         GO TO 8583-AGTC-NOT-FOUND,
 21976               8583-AGTC-NOT-FOUND
 21977         DEPENDING ON DFHEIGDI
 21978     ELSE IF DFHEIGDJ EQUAL 26
 21979         GO TO 8584-BXRF-NOT-FOUND,
 21980               8584-BXRF-NOT-FOUND
 21981         DEPENDING ON DFHEIGDI
 21982     ELSE IF DFHEIGDJ EQUAL 27
 21983         GO TO 8585-PLAN-NOT-FOUND,
 21984               8585-PLAN-NOT-FOUND
 21985         DEPENDING ON DFHEIGDI
 21986     ELSE IF DFHEIGDJ EQUAL 28
 21987         GO TO 0299-CERT-NOT-FOUND
 21988         DEPENDING ON DFHEIGDI
 21989     ELSE IF DFHEIGDJ EQUAL 29
 21990         GO TO 8700-READ-CERT-MASTER
 21991         DEPENDING ON DFHEIGDI
 21992     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 17-Jul-14 14:29 Page 408
* EL050.cbl
 21993         GO TO 8720-COMP-ACCOUNTS,
 21994               8730-END-BROWSE,
 21995               8740-NOT-FOUND
 21996         DEPENDING ON DFHEIGDI
 21997     ELSE IF DFHEIGDJ EQUAL 31
 21998         GO TO 9000-NOTFND
 21999         DEPENDING ON DFHEIGDI
 22000     ELSE IF DFHEIGDJ EQUAL 32
 22001         GO TO 9100-NOTFND,
 22002               9100-NOTFND
 22003         DEPENDING ON DFHEIGDI
 22004     ELSE IF DFHEIGDJ EQUAL 33
 22005         GO TO 9991-CRTO-NOT-FOUND,
 22006               9991-CRTO-NOT-FOUND
 22007         DEPENDING ON DFHEIGDI.
 22008     MOVE '9%                    "   ' TO DFHEIV0
 22009     MOVE 'EL050' TO DFHEIV1
 22010     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22011     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40032     Code:       88618
