* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.   NSRASBL.
     4*AUTHOR.     PABLO
     5*            COLLEYVILLE, TEXAS.
     6*REMARKS.    EXECUTED FROM NSRASLTR
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page   2
* NSRASBL.cbl
    14*-----------------------------------------------------------------
    15* 060611    2011022800001  PEMA  NEW PROGRAM
    16* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    17* 071212    2011022800001  AJRA  ADD UNDW ID
    18* 072312    2011022800001  AJRA    ADD NEW FIELDS
    19* 090612  IR2012090600001  AJRA  NAPERSOFT
    20* 091112  IR2012091100002  AJRA  FIX AKA
    21* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    22* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    23* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    24* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    25* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    26* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    27* 110612    2012101700002  AJRA  ADD NEW FIELDS
    28* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    29* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    30* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    31* 091213    2013090300001  AJRA  NAPERSOFT PHASE 2
    32* 123113    2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    33* 011314  IR2014011300001  AJRA  FIX NEXT BUS DT AND ENDORSEMENT A
    34* 011514    2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    35* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    36* 121015  CR2015100900001  TANA  ADD VIN NUMBER
    37* 020916  CR2016010700001  TANA  CALL SQL LOOKUP NAPERSOFT TABLE
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40 DATA DIVISION.
    41 working-storage section.
    42 01  DFH-START PIC X(04).
    43 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    44 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    45 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    46 77  SAVE-BIN-NEXT-BUS-DT        PIC XX      VALUE SPACES.
    47 77  SAVE-NEXT-BUS-DT-EDIT-A     PIC X(10)   VALUE SPACES.
    48 77  SAVE-CYCLE-DAY-OF-WEEK      PIC S9   COMP-3 VALUE +0.
    49 77  S1                          PIC S999 COMP-3 VALUE +0.
    50 77  E1                          PIC S999 COMP-3 VALUE +0.
    51 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    52 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    53 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    54 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    55 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    56 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    57 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    58 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    59 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    60 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    61 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    62 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    63     88  FOUND-BENE                  VALUE 'Y'.
    64 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    65 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    66 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    67 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    68     88  END-OF-ERPNDB              VALUE 'Y'.
    69 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    70     88  ACCT-FOUND                 VALUE 'Y'.
    71 77  WS-ELCERT-SW                PIC X  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page   3
* NSRASBL.cbl
    72     88  CERT-FOUND                 VALUE 'Y'.
    73     88  CERT-NOT-FOUND             VALUE 'N'.
    74 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    75     88  ENDT-FOUND                 VALUE 'Y'.
    76     88  ENDT-NOT-FOUND             VALUE 'N'.
    77 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    78     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    79 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    80 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    81 77  WS-LF-EARN                  PIC X     VALUE ' '.
    82 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    83 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    84 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    85 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    86 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    87 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    88 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    89 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    90 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    91 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    92 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    93 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    94 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    95 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    96 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    97 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    98 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    99 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
   100     88  PROCESS-ISSUE               VALUE 'I'.
   101     88  PROCESS-CANCEL              VALUE 'C'.
   102 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
   103 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
   104 77  WS-DIFF                     PIC 999 VALUE ZEROS.
   105 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
   106 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
   107 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
   108 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
   109 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
*  110 EXEC SQL
*  111    INCLUDE SQLDA
*  112 END-EXEC
   113 01 SQLDA sync.
   114    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   115    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   116    05 SQLN                  PIC S9(4) COMP-5 value 0.
   117    05 SQLD                  PIC S9(4) COMP-5 value 0.
   118    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   119       10 SQLTYPE            PIC S9(4) COMP-5.
   120       10 SQLLEN             PIC S9(4) COMP-5.
   121$IF P64 SET
   122X      *> For 64-bit environments, ensure that SQLDATA is
   123X      *> aligned on an 8-byte boundary.
   124X      10 FILLER             PIC S9(9) COMP-5.
   125$END
   126       10 SQLDATA            USAGE POINTER.
   127       10 SQLIND             USAGE POINTER.
   128       10 SQLNAME.
   129          15 SQLNAMEL        PIC S9(4) COMP-5.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page   4
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130          15 SQLNAMEC        PIC X(30).
   131
   132* Values for SQLTYPE
   133
   134 78  ESQL-DATE-CHAR              VALUE 384.
   135 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   136 78  ESQL-DATE-REC               VALUE 386.
   137 78  ESQL-DATE-REC-NULL          VALUE 387.
   138 78  ESQL-TIME-CHAR              VALUE 388.
   139 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   140 78  ESQL-TIME-REC               VALUE 390.
   141 78  ESQL-TIME-REC-NULL          VALUE 391.
   142 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   143 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   144 78  ESQL-TIMESTAMP-REC          VALUE 394.
   145 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   146 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   147 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   148 78  ESQL-TS-OFFSET-REC          VALUE 398.
   149 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   150 78  ESQL-LONGVARBINARY          VALUE 404.
   151 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   152 78  ESQL-LONGVARCHAR            VALUE 408.
   153 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   154 78  ESQL-BINARY                 VALUE 444.
   155 78  ESQL-BINARY-NULL            VALUE 445.
   156 78  ESQL-VARBINARY              VALUE 446.
   157 78  ESQL-VARBINARY-NULL         VALUE 447.
   158 78  ESQL-VARCHAR                VALUE 448.
   159 78  ESQL-VARCHAR-NULL           VALUE 449.
   160
   161 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   162 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   163
   164 78  ESQL-CHAR                   VALUE 452.
   165 78  ESQL-CHAR-NULL              VALUE 453.
   166
   167 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   168 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   169
   170 78  ESQL-DOUBLE                 VALUE 480.
   171 78  ESQL-DOUBLE-NULL            VALUE 481.
   172 78  ESQL-REAL                   VALUE 482.
   173 78  ESQL-REAL-NULL              VALUE 483.
   174 78  ESQL-DECIMAL                VALUE 484.
   175 78  ESQL-DECIMAL-NULL           VALUE 485.
   176 78  ESQL-INTEGER                VALUE 496.
   177 78  ESQL-INTEGER-NULL           VALUE 497.
   178 78  ESQL-SMALLINT               VALUE 500.
   179 78  ESQL-SMALLINT-NULL          VALUE 501.
   180 78  ESQL-TINYINT                VALUE 502.
   181 78  ESQL-TINYINT-NULL           VALUE 503.
   182
*  183 EXEC SQL
*  184    INCLUDE SQLCA
*  185 END-EXEC
   186 01 SQLCA.
   187     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page   5
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   189     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   190     05  SQLERRM.
   191         49  SQLERRML    PIC S9(4) COMP-5.
   192         49  SQLERRMC    PIC X(70).
   193     05  SQLERRP         PIC X(8).
   194     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   195     05  SQLWARN.
   196         10  SQLWARN0    PIC X.
   197         10  SQLWARN1    PIC X.
   198         10  SQLWARN2    PIC X.
   199         10  SQLWARN3    PIC X.
   200         10  SQLWARN4    PIC X.
   201         10  SQLWARN5    PIC X.
   202         10  SQLWARN6    PIC X.
   203         10  SQLWARN7    PIC X.
   204     05  SQLEXT.
   205         10  SQLWARN8    PIC X.
   206         10  SQLWARN9    PIC X.
   207         10  SQLWARN10   PIC X.
   208         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   209     05  SQLSTATE    PIC X(5).
   210
   211 EXEC SQL
   212    BEGIN DECLARE SECTION
   213 END-EXEC
   214
   215 01  SQLCMD                      PIC X(1024).
   216 01  SVR                         PIC X(32).
   217 01  USR                         PIC X(32).
   218 01  PASS                        PIC X(32).
   219 01  USR-PASS                    PIC X(64).
   220
   221 01  WS-SQL-DATA.
   222     05  WS-CYCLE-DATE           PIC X(10).
   223     05  WS-NEXT-BUS-DT          PIC X(10).
   224     05  WS-LOOKUPID             PIC X(4).
   225     05  WS-LOOKUPKEY            PIC X(4).
   226     05  WS-LOOKUP-VALUE         PIC X(100).
   227
   228 EXEC SQL
   229    END DECLARE SECTION
   230 END-EXEC
   231
   232
   233 01  P pointer.
   234 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   235 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   236 01  var-ptr pointer.
   237 01  env-var-len                 pic 9(4)  binary.
   238 01  rc                          pic 9(9)  binary.
   239
   240 01  WS-KIXHOST                  PIC X(10).
   241 01  WS-KIXSYS.
   242     05  WS-KIX-FIL1             PIC X(10).
   243     05  WS-KIX-APPS             PIC X(10).
   244     05  WS-KIX-ENV              PIC X(10).
   245     05  WS-KIX-MYENV            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page   6
* NSRASBL.cbl
   246     05  WS-KIX-SYS              PIC X(10).
   247
   248 01  WS-CALC-FIELDS.
   249     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   250     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   251     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   252     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   253     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   254     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   255     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   256     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   257     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   258     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   259     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   260     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   261     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   262     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   263     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   264     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   265     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   266     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   267     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   268     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   269     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   270     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   271     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   272     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   273     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   274     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   275     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   276     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   277     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   278     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   279     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   280     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   281     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   282     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   283     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   284     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   285     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   286     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   287     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   288     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   289     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   290     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   291 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   292 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   293 01 response-code         pic s9(8) comp.
   294 01 display-response      pic 9(8).
   295 01 bl-index              pic 9(8) comp.
   296 01 max-last-name         pic x(18).
   297 01 first-initial         pic x.
   298 01 name-in-range-flag    pic 9.
   299 01 max-entries           pic s9(8) comp value 100.
   300 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   301 01 lower-case    pic x(26) value
   302            "abcdefghijklmnopqrstuvwxyz".
   303 01 upper-case    pic x(26) value
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page   7
* NSRASBL.cbl
   304            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   305
   306*                                COPY ELCVADS.
   307******************************************************************
   308*                                                                *
   309*                                                                *
   310*                            ELCVADS.                            *
   311*                                                                *
   312*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   313*   ELVADS                  LENGTH = 350                         *
   314******************************************************************
   315******************************************************************
   316*                   C H A N G E   L O G
   317*
   318* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   319*-----------------------------------------------------------------
   320*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   321* EFFECTIVE    NUMBER
   322*-----------------------------------------------------------------
   323* 100111    2011022800001  AJRA  NAPERSOFT
   324******************************************************************
   325
   326 01  VIRGINIA-DISCLOSURE.
   327     12  VD-COMPANY-CD              PIC X.
   328     12  VD-CARRIER                 PIC X.
   329     12  VD-GROUPING.
   330         20  VD-GROUPING-PREFIX     PIC XXX.
   331         20  VD-GROUPING-PRIME      PIC XXX.
   332     12  VD-STATE                   PIC XX.
   333     12  VD-ACCOUNT.
   334         20  VD-ACCOUNT-PREFIX      PIC X(4).
   335         20  VD-ACCOUNT-PRIME       PIC X(6).
   336     12  VD-CERT-EFF-DT             PIC XX.
   337     12  VD-CERT-NO.
   338         20  VD-CERT-PRIME          PIC X(10).
   339         20  VD-CERT-SFX            PIC X.
   340     12  VD-ENTRY-BATCH             PIC X(6).
   341     12  VD-CSR-ID                  PIC X(4).
   342     12  VD-NAME.
   343         20  VD-INSURED-LAST-NAME   PIC X(15).
   344         20  VD-INSURED-FIRST-NAME.
   345             24  VD-INSURED-1ST-INIT PIC X.
   346             24  FILLER             PIC X(9).
   347         20  VD-INSURED-MIDDLE-INIT PIC X.
   348     12  VD-JOINT-INSURED.
   349         20 VD-JOINT-LAST-NAME      PIC X(15).
   350         20 VD-JOINT-FIRST-NAME.
   351            24  VD-JOINT-FIRST-INIT PIC X.
   352            24  FILLER              PIC X(9).
   353         20 VD-JOINT-MIDDLE-INIT    PIC X.
   354     12  VD-INSURED-ADDRESS-1       PIC X(30).
   355     12  VD-INSURED-ADDRESS-2       PIC X(30).
   356     12  VD-INSURED-CITY-STATE.
   357         20  VD-INSURED-CITY        PIC X(28).
   358         20  VD-INSURED-STATE       PIC XX.
   359     12  VD-INSURED-ZIP-CODE.
   360         20  VD-INSURED-ZIP-PRIME.
   361             24  VD-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page   8
* NSRASBL.cbl
   362                 88  VD-CANADIAN-POST-CODE
   363                                       VALUE 'A' THRU 'Z'.
   364             24  FILLER             PIC X(4).
   365         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   366     12  VD-BENEFICIARY-NAME        PIC X(30).
   367     12  VD-ACCOUNT-NAME            PIC X(30).
   368     12  VD-LOAN-TERM               PIC S999   COMP-3.
   369     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   370     12  VD-1ST-PMT-DT              PIC XX.
   371     12  VD-LIFE-BENEFIT-CD         PIC XX.
   372         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   373         88  VD-INVALID-LIFE           VALUE '  ' '00'
   374                                             '90' THRU '99'.
   375     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   376                                    PIC XX.
   377     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   378     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   379     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   380     12  VD-LF-TERM                 PIC S999   COMP-3.
   381     12  VD-AH-BENEFIT-CD           PIC XX.
   382         88  VD-VALID-AH               VALUE '01' THRU '89'.
   383         88  VD-INVALID-AH             VALUE '  ' '00'
   384                                             '90' THRU '99'.
   385     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   386     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   387     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   388     12  VD-AH-TERM                 PIC S999   COMP-3.
   389     12  VD-LETTER-ID               PIC X(4).
   390     12  VD-PROC-ID                 PIC X(4).
   391     12  VD-COMP-ID                 PIC X(3).
   392     12  VD-CURRENT-DATE            PIC XX.
   393     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   394     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   395     12  FILLER                     PIC X(32).
   396 01  WS-PASS-AREA.
   397     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   398     05  WS-PASS-VADS-REC    PIC X(350).
   399
   400*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   401*                         COPY ELCZREC.
   402******************************************************************
   403*                                                                *
   404*                                                                *
   405*                            ELCZREC.                            *
   406*                                                                *
   407*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   408*                                                                *
   409******************************************************************
   410*-----------------------------------------------------------------
   411*                   C H A N G E   L O G
   412*
   413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   414*-----------------------------------------------------------------
   415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   416* EFFECTIVE    NUMBER
   417*-----------------------------------------------------------------
   418* 122011    2011022800001  AJRA  NEW FILE
   419* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page   9
* NSRASBL.cbl
   420* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   421* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   422* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   423*-----------------------------------------------------------------
   424 01  W-Z-CONTROL-DATA.
   425     05  W-NUMBER-OF-COPIES      PIC  9.
   426     05  FILLER                  PIC  X.
   427     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   428     05  FILLER                  PIC  X.
   429     05  W-DAYS-TO-RESEND        PIC  999.
   430     05  FILLER                  PIC  X.
   431     05  W-FORM-TO-RESEND        PIC  X(4).
   432     05  W-ADD-BAR-CODE          PIC  X.
   433     05  W-PROMPT-LETTER         PIC  X.
   434     05  W-HAS-RETURN-ENV        PIC  X.
   435     05  W-ENCLOSURE-CD          PIC  XXX.
   436     05  W-SIG-FLAG-DEFAULT      PIC  X.
   437     05  W-AUTO-CLOSE-IND        PIC  X.
   438     05  FILLER                  PIC  X.
   439     05  W-LETTER-TO-BENE        PIC  X.
   440     05  FILLER                  PIC  X.
   441     05  W-LETTER-TO-ACCT        PIC  X.
   442     05  FILLER                  PIC  X.
   443     05  W-LETTER-TYPE           PIC  X.
   444     05  FILLER                  PIC  X.
   445     05  W-PRINT-CERTIFICATE     PIC  X.
   446     05  FILLER                  PIC  X.
   447     05  W-REFUND-REQUIRED       PIC  X.
   448     05  FILLER                  PIC  X.
   449     05  W-ONBASE-CODE           PIC  XX.
   450     05  FILLER                  PIC  X.
   451     05  W-ACCT-SUMM             PIC  X.
   452     05  FILLER                  PIC  X.
   453     05  W-CSO-SUMM              PIC  X.
   454     05  FILLER                  PIC  X.
   455     05  W-REASONS-REQUIRED      PIC  X.
   456     05  FILLER                  PIC  X(29).
   457 01  MISC.
   458     12  WS-RESPONSE             PIC S9(8)   COMP.
   459         88  RESP-NORMAL                  VALUE +00.
   460         88  RESP-NOTFND                  VALUE +13.
   461         88  RESP-DUPREC                  VALUE +14.
   462         88  RESP-DUPKEY                  VALUE +15.
   463         88  RESP-NOTOPEN                 VALUE +19.
   464         88  RESP-ENDFILE                 VALUE +20.
   465
   466     12  WS-EDIT-A-DATE.
   467         16  WS-EDIT-A-MM                 PIC X(2).
   468         16  FILLER                       PIC X(1).
   469         16  WS-EDIT-A-DD                 PIC X(2).
   470         16  FILLER                       PIC X(1).
   471         16  WS-EDIT-A-CCYY.
   472             20  WS-EDIT-A-CC             PIC X(2).
   473             20  WS-EDIT-A-YY             PIC X(2).
   474 01  srch-commarea.
   475*                                copy ELCADLTRSPI.
   476******************************************************************
   477*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  10
* NSRASBL.cbl
   478*
   479* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   480*-----------------------------------------------------------------
   481*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   482* EFFECTIVE    NUMBER
   483*-----------------------------------------------------------------
   484* 060611    2011022800001  PEMA  NEW COPYBOOK
   485* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   486* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   487******************************************************************
   488****************************************
   489*  commarea for NaperSoft On Demand Admin services letters
   490*  (business logic input & output)
   491****************************************
   492     03  BL-INPUT.
   493         05  BL-DATA-SRCE        PIC X.
   494         05  BL-LETTER-ID        PIC XXXX.
   495         05  BL-CARRIER          PIC X.
   496         05  BL-GROUP            PIC X(6).
   497         05  BL-STATE            PIC XX.
   498         05  BL-ACCOUNT          PIC X(10).
   499         05  BL-EFF-DT           PIC X(10).
   500         05  BL-CERT-NO          PIC X(11).
   501         05  BL-BATCH-NO         PIC X(6).
   502         05  BL-BATCH-SEQ        PIC 9(8).
   503         05  BL-RESP-NO          PIC X(10).
   504         05  BL-NO-OF-COPIES     PIC 99.
   505         05  BL-PROC-ID          PIC XXXX.
   506         05  BL-COMP-ID          PIC XXX.
   507         05  BL-PRINT-NOW-SW     PIC X.
   508         05  BL-ENC-CD           PIC XXX.
   509         05  BL-RESEND-DT        PIC X(10).
   510         05  BL-FOLLOW-UP-DT     PIC X(10).
   511         05  BL-ARCHIVE-NO       PIC 9(8).
   512         05  BL-FUNC             PIC X(8).
   513         05  BL-COMMENTS         PIC X(100).
   514         05  FILLER REDEFINES BL-COMMENTS.
   515             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   516             10  BL-LETTER-TO-ACCT PIC X.
   517             10  BL-LETTER-TO-BENE PIC X.
   518             10  BL-WRITE-ERARCH   PIC X.
   519                 88  ERARCH-QWS      VALUE 'Q'.
   520                 88  ERARCH-BATCH    VALUE 'B'.
   521                 88  ERARCH-TEMP     VALUE 'T'.
   522             10  BL-PROCESS-TYPE PIC X(07).
   523             10  BL-CERT-FORM-ID PIC X(05).
   524             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   525             10  BL-SOURCE-SCREEN PIC X(8).
   526             10  FILLER          PIC X(25).
   527     03  BL-OUTPUT.
   528         05  BL-STATUS                   PIC X.
   529             88  BL-OK                      VALUE "P".
   530             88  BL-FAIL                  VALUE "F".
   531         05  BL-MESSAGE          PIC X(50).
   532     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   533     03  FILLER                  PIC X(31).
   534 01  filler                      pic x(500).
   535 01  WS-SAVE-CARRIER-INFO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  11
* NSRASBL.cbl
   536     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   537     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   538     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   539     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   540     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   541     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   542     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   543     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   544 01  WS-SAVE-STATE-INFO.
   545     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   546     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   547 01  WS-SAVE-LFBEN-INFO.
   548     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   549     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   550     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   551 01  WS-SAVE-AHBEN-INFO.
   552     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   553     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   554     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   555     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   556 01  WS-ERPNDB-KEY.
   557     05  WS-ERPNDB-COMPANY-CD    PIC X.
   558     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   559     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   560     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   561 01  WS-ELENCC-KEY.
   562     05  WS-ELENCC-COMPANY-CD    PIC X.
   563     05  WS-ELENCC-REC-TYPE      PIC X.
   564     05  WS-ELENCC-ENC-CODE      PIC X(5).
   565     05  F                       PIC X(9).
   566 01  WS-ELCERT-KEY.
   567     05  WS-ELCERT-COMPANY-CD    PIC X.
   568     05  WS-ELCERT-CARRIER       PIC X.
   569     05  WS-ELCERT-GROUP         PIC X(6).
   570     05  WS-ELCERT-STATE         PIC XX.
   571     05  WS-ELCERT-ACCOUNT       PIC X(10).
   572     05  WS-ELCERT-EFF-DT        PIC XX.
   573     05  WS-ELCERT-CERT-NO       PIC X(11).
   574 01  WS-ELCRTT-KEY.
   575     05  WS-ELCRTT-PRIMARY       PIC X(33).
   576     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   577
   578 01  WS-ERENDT-KEY.
   579     05  WS-ERENDT-COMPANY-CD    PIC X.
   580     05  WS-ERENDT-CARRIER       PIC X.
   581     05  WS-ERENDT-GROUP         PIC X(6).
   582     05  WS-ERENDT-STATE         PIC XX.
   583     05  WS-ERENDT-ACCOUNT       PIC X(10).
   584     05  WS-ERENDT-EFF-DT        PIC XX.
   585     05  WS-ERENDT-CERT-NO       PIC X(11).
   586     05  WS-ERENDT-REC-TYPE      PIC X.
   587     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   588
   589 01  WS-ERENDT-KEY-BY-ARCH.
   590     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   591     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   592 01  WS-ERCOMP-KEY.
   593     05  WS-ERCOMP-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  12
* NSRASBL.cbl
   594     05  WS-ERCOMP-CARRIER       PIC X.
   595     05  WS-ERCOMP-GROUP         PIC X(6).
   596     05  WS-ERCOMP-RESP-NO       PIC X(10).
   597     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   598     05  WS-ERCOMP-REC-TYPE      PIC X.
   599 01  WS-ERMAIL-KEY.
   600     05  WS-ERMAIL-COMPANY-CD    PIC X.
   601     05  WS-ERMAIL-CARRIER       PIC X.
   602     05  WS-ERMAIL-GROUP         PIC X(6).
   603     05  WS-ERMAIL-STATE         PIC XX.
   604     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   605     05  WS-ERMAIL-EFF-DT        PIC XX.
   606     05  WS-ERMAIL-CERT-NO       PIC X(11).
   607 01  WS-ERACCT-KEY.
   608     05  WS-ERACCT-COMPANY-CD    PIC X.
   609     05  WS-ERACCT-CARRIER       PIC X.
   610     05  WS-ERACCT-GROUP         PIC X(6).
   611     05  WS-ERACCT-STATE         PIC XX.
   612     05  WS-ERACCT-ACCOUNT       PIC X(10).
   613     05  WS-ERACCT-EXP-DT        PIC XX.
   614     05  FILLER                  PIC XXXX.
   615 01  WS-ELLETR-KEY.
   616     05  WS-ELLETR-COMPANY-CD    PIC X.
   617     05  WS-ELLETR-LETTER-ID     PIC X(12).
   618     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   619 01  WS-ELCNTL-KEY.
   620     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   621     05  WS-ELCNTL-REC-TYPE      PIC X.
   622     05  WS-ELCNTL-GENL.
   623         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   624         10  WS-ELCNTL-BEN-CD.
   625             15  F               PIC X.
   626             15  WS-ELCNTL-CARR  PIC X.
   627     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   628*                                COPY ELCDATE.
   629******************************************************************
   630*                                                                *
   631*                                                                *
   632*                            ELCDATE.                            *
   633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   634*                            VMOD=2.003
   635*                                                                *
   636*                                                                *
   637*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   638*                 LENGTH = 200                                   *
   639******************************************************************
   640
   641 01  DATE-CONVERSION-DATA.
   642     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   643     12  DC-OPTION-CODE                PIC X.
   644         88  BIN-TO-GREG                VALUE ' '.
   645         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   646         88  EDIT-GREG-TO-BIN           VALUE '2'.
   647         88  YMD-GREG-TO-BIN            VALUE '3'.
   648         88  MDY-GREG-TO-BIN            VALUE '4'.
   649         88  JULIAN-TO-BIN              VALUE '5'.
   650         88  BIN-PLUS-ELAPSED           VALUE '6'.
   651         88  FIND-CENTURY               VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  13
* NSRASBL.cbl
   652         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   653         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   654         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   655         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   656         88  JULIAN-TO-BIN-3            VALUE 'C'.
   657         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   658         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   659         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   660         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   661         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   662         88  CHECK-LEAP-YEAR            VALUE 'H'.
   663         88  BIN-3-TO-GREG              VALUE 'I'.
   664         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   665         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   666         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   667         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   668         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   669         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   670         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   671         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   672         88  THREE-CHARACTER-BIN
   673                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   674         88  GREGORIAN-TO-BIN
   675                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   676         88  BIN-TO-GREGORIAN
   677                  VALUES ' ' '1' 'I' '8' 'G'.
   678         88  JULIAN-TO-BINARY
   679                  VALUES '5' 'C' 'E' 'F'.
   680     12  DC-ERROR-CODE                 PIC X.
   681         88  NO-CONVERSION-ERROR        VALUE ' '.
   682         88  DATE-CONVERSION-ERROR
   683                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   684         88  DATE-IS-ZERO               VALUE '1'.
   685         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   686         88  DATE-IS-INVALID            VALUE '3'.
   687         88  DATE1-GREATER-DATE2        VALUE '4'.
   688         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   689         88  DATE-INVALID-OPTION        VALUE '9'.
   690         88  INVALID-CENTURY            VALUE 'A'.
   691         88  ONLY-CENTURY               VALUE 'B'.
   692         88  ONLY-LEAP-YEAR             VALUE 'C'.
   693         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   694     12  DC-END-OF-MONTH               PIC X.
   695         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   696     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   697         88  USE-NORMAL-PROCESS         VALUE ' '.
   698         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   699         88  ADJUST-UP-100-YRS          VALUE '2'.
   700     12  FILLER                        PIC X.
   701     12  DC-CONVERSION-DATES.
   702         16  DC-BIN-DATE-1             PIC XX.
   703         16  DC-BIN-DATE-2             PIC XX.
   704         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   705         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   706                       DC-GREG-DATE-1-EDIT.
   707             20  DC-EDIT1-MONTH        PIC 99.
   708             20  SLASH1-1              PIC X.
   709             20  DC-EDIT1-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  14
* NSRASBL.cbl
   710             20  SLASH1-2              PIC X.
   711             20  DC-EDIT1-YEAR         PIC 99.
   712         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   713         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   714                     DC-GREG-DATE-2-EDIT.
   715             20  DC-EDIT2-MONTH        PIC 99.
   716             20  SLASH2-1              PIC X.
   717             20  DC-EDIT2-DAY          PIC 99.
   718             20  SLASH2-2              PIC X.
   719             20  DC-EDIT2-YEAR         PIC 99.
   720         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   721         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   722                     DC-GREG-DATE-1-YMD.
   723             20  DC-YMD-YEAR           PIC 99.
   724             20  DC-YMD-MONTH          PIC 99.
   725             20  DC-YMD-DAY            PIC 99.
   726         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   727         16  DC-GREG-DATE-1-MDY-R REDEFINES
   728                      DC-GREG-DATE-1-MDY.
   729             20  DC-MDY-MONTH          PIC 99.
   730             20  DC-MDY-DAY            PIC 99.
   731             20  DC-MDY-YEAR           PIC 99.
   732         16  DC-GREG-DATE-1-ALPHA.
   733             20  DC-ALPHA-MONTH        PIC X(10).
   734             20  DC-ALPHA-DAY          PIC 99.
   735             20  FILLER                PIC XX.
   736             20  DC-ALPHA-CENTURY.
   737                 24 DC-ALPHA-CEN-N     PIC 99.
   738             20  DC-ALPHA-YEAR         PIC 99.
   739         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   740         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   741         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   742         16  DC-JULIAN-DATE            PIC 9(05).
   743         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   744                                       PIC 9(05).
   745         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   746             20  DC-JULIAN-YEAR        PIC 99.
   747             20  DC-JULIAN-DAYS        PIC 999.
   748         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   749         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   750         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   751     12  DATE-CONVERSION-VARIBLES.
   752         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   753         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   754             20  FILLER                PIC 9(3).
   755             20  HOLD-CEN-1-CCYY.
   756                 24  HOLD-CEN-1-CC     PIC 99.
   757                 24  HOLD-CEN-1-YY     PIC 99.
   758             20  HOLD-CEN-1-MO         PIC 99.
   759             20  HOLD-CEN-1-DA         PIC 99.
   760         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   761             20  HOLD-CEN-1-R-MO       PIC 99.
   762             20  HOLD-CEN-1-R-DA       PIC 99.
   763             20  HOLD-CEN-1-R-CCYY.
   764                 24  HOLD-CEN-1-R-CC   PIC 99.
   765                 24  HOLD-CEN-1-R-YY   PIC 99.
   766             20  FILLER                PIC 9(3).
   767         16  HOLD-CENTURY-1-X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  15
* NSRASBL.cbl
   768             20  FILLER                PIC X(3)  VALUE SPACES.
   769             20  HOLD-CEN-1-X-CCYY.
   770                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   771                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   772             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   773             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   774         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   775             20  HOLD-CEN-1-R-X-MO     PIC XX.
   776             20  HOLD-CEN-1-R-X-DA     PIC XX.
   777             20  HOLD-CEN-1-R-X-CCYY.
   778                 24  HOLD-CEN-1-R-X-CC PIC XX.
   779                 24  HOLD-CEN-1-R-X-YY PIC XX.
   780             20  FILLER                PIC XXX.
   781         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   782         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   783         16  DC-JULIAN-DATE-1          PIC 9(07).
   784         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   785             20  DC-JULIAN-1-CCYY.
   786                 24  DC-JULIAN-1-CC    PIC 99.
   787                 24  DC-JULIAN-1-YR    PIC 99.
   788             20  DC-JULIAN-DA-1        PIC 999.
   789         16  DC-JULIAN-DATE-2          PIC 9(07).
   790         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   791             20  DC-JULIAN-2-CCYY.
   792                 24  DC-JULIAN-2-CC    PIC 99.
   793                 24  DC-JULIAN-2-YR    PIC 99.
   794             20  DC-JULIAN-DA-2        PIC 999.
   795         16  DC-GREG-DATE-A-EDIT.
   796             20  DC-EDITA-MONTH        PIC 99.
   797             20  SLASHA-1              PIC X VALUE '/'.
   798             20  DC-EDITA-DAY          PIC 99.
   799             20  SLASHA-2              PIC X VALUE '/'.
   800             20  DC-EDITA-CCYY.
   801                 24  DC-EDITA-CENT     PIC 99.
   802                 24  DC-EDITA-YEAR     PIC 99.
   803         16  DC-GREG-DATE-B-EDIT.
   804             20  DC-EDITB-MONTH        PIC 99.
   805             20  SLASHB-1              PIC X VALUE '/'.
   806             20  DC-EDITB-DAY          PIC 99.
   807             20  SLASHB-2              PIC X VALUE '/'.
   808             20  DC-EDITB-CCYY.
   809                 24  DC-EDITB-CENT     PIC 99.
   810                 24  DC-EDITB-YEAR     PIC 99.
   811         16  DC-GREG-DATE-CYMD         PIC 9(08).
   812         16  DC-GREG-DATE-CYMD-R REDEFINES
   813                              DC-GREG-DATE-CYMD.
   814             20  DC-CYMD-CEN           PIC 99.
   815             20  DC-CYMD-YEAR          PIC 99.
   816             20  DC-CYMD-MONTH         PIC 99.
   817             20  DC-CYMD-DAY           PIC 99.
   818         16  DC-GREG-DATE-MDCY         PIC 9(08).
   819         16  DC-GREG-DATE-MDCY-R REDEFINES
   820                              DC-GREG-DATE-MDCY.
   821             20  DC-MDCY-MONTH         PIC 99.
   822             20  DC-MDCY-DAY           PIC 99.
   823             20  DC-MDCY-CEN           PIC 99.
   824             20  DC-MDCY-YEAR          PIC 99.
   825    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  16
* NSRASBL.cbl
   826        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   827    12  DC-EL310-DATE                  PIC X(21).
   828    12  FILLER                         PIC X(28).
   829*                                COPY NSCASEXTR.
   830******************************************************************
   831*                                                                *
   832*                                                                *
   833*                            NSCASEXTR.                          *
   834*                            VMOD=2.001                          *
   835*                                                                *
   836*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   837*                                                                *
   838*   FILE TYPE = VSAM,KSDS                                        *
   839*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   840*                                                                *
   841*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   842*                                                                *
   843*   LOG = NO                                                     *
   844*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   845******************************************************************
   846*-----------------------------------------------------------------
   847*                   C H A N G E   L O G
   848*
   849* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   850*-----------------------------------------------------------------
   851*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   852* EFFECTIVE    NUMBER
   853*-----------------------------------------------------------------
   854* 072211    2011022800001  PEMA  NEW FILE
   855*-----------------------------------------------------------------
   856 01 NSAS-EXTRACT-RECORD.
   857    05  NSAS-CONTROL-PRIMARY.
   858        10  NSAS-COMPANY-CD      PIC X.
   859        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   860        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   861    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   862    05  FILLER                   PIC X(143).
   863*                                COPY ERCPNDB.
   864******************************************************************
   865*                                                                *
   866*                                                                *
   867*                            ERCPNDB.                            *
   868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   869*                            VMOD=2.025                          *
   870*                                                                *
   871*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   872*                                                                *
   873******************************************************************
   874*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   875*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   876******************************************************************
   877*                                                                *
   878*                                                                *
   879*   FILE TYPE = VSAM,KSDS                                        *
   880*   RECORD SIZE = 585  RECFORM = FIXED                           *
   881*                                                                *
   882*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   883*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  17
* NSRASBL.cbl
   884*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   885*                                                 RKP=13,LEN=36  *
   886*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   887*                                      AND CHG-SEQ.)             *
   888*                                                RKP=49,LEN=11   *
   889*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   890*                                      AND CHG-SEQ.)             *
   891*                                                RKP=60,LEN=15   *
   892*                                                                *
   893*   LOG = NO                                                     *
   894*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   895******************************************************************
   896******************************************************************
   897*                   C H A N G E   L O G
   898*
   899* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   900*-----------------------------------------------------------------
   901*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   902* EFFECTIVE    NUMBER
   903*-----------------------------------------------------------------
   904* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   905* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   906* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   907* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   908* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   909* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   910* 032306                   PEMA  ADD BOW LOAN NUMBER
   911* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   912* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   913* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   914* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   915* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   916* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   917* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   918* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   919* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   920* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   921* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
   922******************************************************************
   923
   924 01  PENDING-BUSINESS.
   925     12  PB-RECORD-ID                     PIC XX.
   926         88  VALID-PB-ID                        VALUE 'PB'.
   927
   928     12  PB-CONTROL-PRIMARY.
   929         16  PB-COMPANY-CD                PIC X.
   930         16  PB-ENTRY-BATCH               PIC X(6).
   931         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   932         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   933
   934     12  PB-CONTROL-BY-ACCOUNT.
   935         16  PB-COMPANY-CD-A1             PIC X.
   936         16  PB-CARRIER                   PIC X.
   937         16  PB-GROUPING.
   938             20  PB-GROUPING-PREFIX       PIC XXX.
   939             20  PB-GROUPING-PRIME        PIC XXX.
   940         16  PB-STATE                     PIC XX.
   941         16  PB-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  18
* NSRASBL.cbl
   942             20  PB-ACCOUNT-PREFIX        PIC X(4).
   943             20  PB-ACCOUNT-PRIME         PIC X(6).
   944         16  PB-CERT-EFF-DT               PIC XX.
   945         16  PB-CERT-NO.
   946             20  PB-CERT-PRIME            PIC X(10).
   947             20  PB-CERT-SFX              PIC X.
   948         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   949
   950         16  PB-RECORD-TYPE               PIC X.
   951             88  PB-MAILING-DATA                VALUE '0'.
   952             88  PB-ISSUE                       VALUE '1'.
   953             88  PB-CANCELLATION                VALUE '2'.
   954             88  PB-BATCH-TRAILER               VALUE '9'.
   955
   956     12  PB-CONTROL-BY-ORIG-BATCH.
   957         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   958         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   959         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   960         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   961
   962     12  PB-CONTROL-BY-CSR.
   963         16  PB-CSR-COMPANY-CD            PIC X.
   964         16  PB-CSR-ID                    PIC X(4).
   965         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   966         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   967         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   968******************************************************************
   969*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   970******************************************************************
   971
   972     12  PB-LAST-MAINT-DT                 PIC XX.
   973     12  PB-LAST-MAINT-BY                 PIC X(4).
   974     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   975
   976     12  PB-RECORD-BODY                   PIC X(375).
   977
   978     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   979         16  PB-CERT-ORIGIN               PIC X.
   980             88  CLASIC-CREATED-CERT         VALUE '1'.
   981         16  PB-I-NAME.
   982             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   983             20  PB-I-INSURED-FIRST-NAME.
   984                 24  PB-I-INSURED-1ST-INIT PIC X.
   985                 24  FILLER                PIC X(9).
   986             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   987         16  PB-I-AGE                     PIC S99   COMP-3.
   988         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   989         16  PB-I-BIRTHDAY                PIC XX.
   990         16  PB-I-INSURED-SEX             PIC X.
   991             88  PB-SEX-MALE     VALUE 'M'.
   992             88  PB-SEX-FEMALE   VALUE 'F'.
   993
   994         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   995         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   996         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   997         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   998         16  PB-I-SKIP-CODE               PIC X.
   999             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  19
* NSRASBL.cbl
  1000             88  PB-SKIP-JULY              VALUE '1'.
  1001             88  PB-SKIP-AUGUST            VALUE '2'.
  1002             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1003             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1004             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1005             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1006             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1007             88  PB-SKIP-JUNE              VALUE '8'.
  1008             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1009             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1010             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1011         16  PB-I-TERM-TYPE               PIC X.
  1012             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1013             88  PB-PAID-WEEKLY            VALUE 'W'.
  1014             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1015             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1016             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1017         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1018         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1019         16  PB-I-DATA-ENTRY-SW           PIC X.
  1020             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1021             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1022             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1023             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1024         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1025         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1026*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1027         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1028         16  FILLER                       PIC X.
  1029
  1030         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1031             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1032             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1033                                                   '90' THRU '99'.
  1034         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1035                                          PIC XX.
  1036         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1037         16  PB-I-AMOUNT-FINANCED REDEFINES
  1038                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  1039         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1040         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1041                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1042         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1043         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1044         16  PB-I-CLP-AMOUNT REDEFINES
  1045                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1046         16  PB-I-LF-CALC-FLAG            PIC X.
  1047             88 PB-COMP-LF-PREM               VALUE '?'.
  1048         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1049         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1050         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1051         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1052         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1053         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1054         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1055         16  PB-I-LF-ABBR                 PIC XXX.
  1056         16  PB-I-LF-INPUT-CD             PIC XX.
  1057
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  20
* NSRASBL.cbl
  1058         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1059             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1060             88  PB-INVALID-AH               VALUE '  ' '00'
  1061                                                   '90' THRU '99'.
  1062         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1063         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1064         16  PB-I-AH-CALC-FLAG            PIC X.
  1065             88 PB-COMP-AH-PREM                  VALUE '?'.
  1066         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  1067         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1068         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  1069         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1070         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1071         16  PB-I-AH-ABBR                 PIC XXX.
  1072         16  PB-I-AH-INPUT-CD             PIC XXX.
  1073
  1074         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1075         16  PB-I-REIN-TABLE              PIC XXX.
  1076         16  PB-I-BUSINESS-TYPE           PIC 99.
  1077         16  PB-I-INDV-GRP-CD             PIC X.
  1078         16  PB-I-MORT-CODE.
  1079             20  PB-I-TABLE               PIC X.
  1080             20  PB-I-INTEREST            PIC XX.
  1081             20  PB-I-MORT-TYP            PIC X.
  1082         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1083         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1084         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1085         16  PB-I-INDV-GRP-OVRD           PIC X.
  1086         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1087         16  PB-I-SIG-SW                  PIC X.
  1088             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1089         16  PB-I-RATE-CLASS              PIC XX.
  1090         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1091         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1092         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1093         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1094         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1095         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  1096         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  1097         16  PB-I-BENEFIT-TYPE            PIC XXX.
  1098         16  PB-I-OB-FLAG                 PIC X.
  1099             88  PB-I-OB                      VALUE 'B'.
  1100             88  PB-I-SUMMARY                 VALUE 'Z'.
  1101         16  PB-I-ENTRY-STATUS            PIC X.
  1102             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1103                                              'M' '5' '9' '2'.
  1104             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1105             88  PB-I-POLICY-PENDING          VALUE '2'.
  1106             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1107             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1108             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  1109             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1110             88  PB-I-REIN-ONLY               VALUE '9'.
  1111             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  1112             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  1113             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1114             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1115         16  PB-I-INT-CODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  21
* NSRASBL.cbl
  1116             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1117             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  1118         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1119         16  PB-I-SOC-SEC-NO              PIC X(11).
  1120         16  PB-I-MEMBER-NO               PIC X(12).
  1121         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  1122*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1123         16  PB-I-OLD-LOF                 PIC XXX.
  1124         16  PB-I-LF-EXPIRE-DT            PIC XX.
  1125         16  PB-I-AH-EXPIRE-DT            PIC XX.
  1126         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1127         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1128         16  PB-I-LIFE-INDICATOR          PIC X.
  1129             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1130         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1131         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1132                                          PIC S9(5)V99    COMP-3.
  1133         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1134             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1135             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1136         16  PB-I-1ST-PMT-DT              PIC XX.
  1137         16  PB-I-JOINT-INSURED.
  1138             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1139             20 PB-I-JOINT-FIRST-NAME.
  1140                24  PB-I-JOINT-FIRST-INIT PIC X.
  1141                24  FILLER                PIC X(9).
  1142             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1143*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1144         16  PB-I-BENEFICIARY-NAME.
  1145             20  PB-I-BANK-NUMBER         PIC X(10).
  1146             20  FILLER                   PIC X(15).
  1147         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1148         16  PB-I-REFERENCE               PIC X(12).
  1149         16  FILLER REDEFINES PB-I-REFERENCE.
  1150             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1151             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1152             20  PB-I-CLP-STATE           PIC XX.
  1153         16  PB-I-UNDERWRITING-STATUS     PIC X.
  1154             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  1155             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1156             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  1157         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1158         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1159         16  PB-I-RESIDENT-STATE          PIC XX.
  1160         16  PB-I-RATE-CODE               PIC X(4).
  1161         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1162         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1163         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1164         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1165         16  PB-I-BANK-NOCHRGB            PIC 99.
  1166         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1167         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1168
  1169     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1170         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1171             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1172         16  PB-C-CANCEL-ORIGIN           PIC X.
  1173             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  22
* NSRASBL.cbl
  1174         16  PB-C-LF-CANCEL-DT            PIC XX.
  1175         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1176         16  PB-C-LF-CALC-REQ             PIC X.
  1177             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1178         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1179         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1180         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1181             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1182         16  PB-C-AH-CANCEL-DT            PIC XX.
  1183         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1184         16  PB-C-AH-CALC-REQ             PIC X.
  1185             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1186         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1187         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1188         16  PB-C-LAST-NAME               PIC X(15).
  1189         16  PB-C-REFUND-SW               PIC X.
  1190             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1191             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1192         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1193         16  PB-C-PAYEE-CODE              PIC X(6).
  1194         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1195         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1196         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1197         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1198         16  PB-C-REFERENCE               PIC X(12).
  1199         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1200         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1201         16  PB-C-POST-CARD-IND           PIC X.
  1202         16  PB-C-CANCEL-REASON           PIC X.
  1203         16  PB-C-REF-INTERFACE-SW        PIC X.
  1204         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1205         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1206         16  FILLER                       PIC X(01).
  1207*        16  FILLER                       PIC X(18).
  1208         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1209*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1210         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1211         16  PB-CANCELED-CERT-DATA.
  1212             20  PB-CI-INSURED-NAME.
  1213                 24  PB-CI-LAST-NAME      PIC X(15).
  1214                 24  PB-CI-INITIALS       PIC XX.
  1215             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1216             20  PB-CI-INSURED-SEX        PIC X.
  1217             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1218             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1219             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1220             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1221             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1222             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1223             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1224             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1225             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1226             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1227             20  PB-CI-RATE-CLASS         PIC XX.
  1228             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1229             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1230             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1231             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  23
* NSRASBL.cbl
  1232             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1233             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1234             20  PB-CI-LF-ABBR            PIC X(3).
  1235             20  PB-CI-AH-ABBR            PIC X(3).
  1236             20  PB-CI-OB-FLAG            PIC X.
  1237                 88  PB-CI-OB                VALUE 'B'.
  1238             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1239                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1240                                           'M' '4' '5' '9' '2'.
  1241                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1242                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1243                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1244                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1245                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1246                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  1247                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1248                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1249                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1250                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1251                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1252                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1253                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1254             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1255                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1256                                           'M' '4' '5' '9' '2'.
  1257                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1258                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1259                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1260                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1261                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1262                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  1263                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1264                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1265                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1266                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1267                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1268                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1269                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1270             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1271             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1272             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1273             20  PB-CI-MEMBER-NO          PIC X(12).
  1274             20  PB-CI-INT-CODE           PIC X.
  1275                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1276                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1277             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1278             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1279             20  PB-CI-COMP-EXCP-SW       PIC X.
  1280                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1281                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1282             20  PB-CI-ENTRY-STATUS       PIC X.
  1283             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1284             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1285             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1286             20  PB-CI-DEATH-DT           PIC XX.
  1287             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1288             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1289             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  24
* NSRASBL.cbl
  1290             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1291             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1292             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1293             20  PB-CI-ENTRY-DT              PIC XX.
  1294             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1295             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1296             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1297             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1298             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1299             20  PB-CI-OLD-LOF               PIC XXX.
  1300*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1301             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1302             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1303             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1304             20  PB-CI-INDV-GRP-CD           PIC X.
  1305             20  PB-CI-BENEFICIARY-NAME.
  1306                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1307                 24  FILLER                  PIC X(15).
  1308             20  PB-CI-NOTE-SW               PIC X.
  1309             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1310             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1311             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1312             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1313             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1314             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1315             20  PB-CI-FIRST-NAME            PIC X(10).
  1316             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1317
  1318         16  FILLER                       PIC X(13).
  1319*032306  16  FILLER                       PIC X(27).
  1320*        16  FILLER                       PIC X(46).
  1321
  1322     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1323         16  FILLER                       PIC X(10).
  1324         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1325         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1326         16  PB-M-INSURED-MID-INIT        PIC X.
  1327         16  PB-M-INSURED-AGE             PIC 99.
  1328         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1329         16  PB-M-INSURED-SEX             PIC X.
  1330         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1331         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1332         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1333         16  PB-M-INSURED-CITY-STATE.
  1334             20  PB-M-INSURED-CITY        PIC X(28).
  1335             20  PB-M-INSURED-STATE       PIC XX.
  1336         16  PB-M-INSURED-ZIP-CODE.
  1337             20  PB-M-INSURED-ZIP-PRIME.
  1338                 24  PB-M-INSURED-ZIP-1   PIC X.
  1339                     88  PB-M-CANADIAN-POST-CODE
  1340                                             VALUE 'A' THRU 'Z'.
  1341                 24  FILLER               PIC X(4).
  1342             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1343         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1344                                        PB-M-INSURED-ZIP-CODE.
  1345             20  PM-M-INS-CAN-POST1       PIC XXX.
  1346             20  PM-M-INS-CAN-POST2       PIC XXX.
  1347             20  FILLER                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  25
* NSRASBL.cbl
  1348         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1349         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1350         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1351         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1352         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1353         16  PB-M-CRED-BENE-CITYST.
  1354             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1355             20  PB-M-CRED-BENE-STATE     PIC XX.
  1356         16  FILLER                       PIC X(92).
  1357
  1358     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1359         16  FILLER                       PIC X(10).
  1360         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1361         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1362         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1363         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1364         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1365         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1366         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1367         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1368         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1369         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1370         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1371         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1372         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1373         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1374         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1375         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1376         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1377         16  PB-ACCOUNT-NAME              PIC X(30).
  1378         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1379         16  PB-REFERENCE                 PIC X(12).
  1380         16  PB-B-RECEIVED-DT             PIC XX.
  1381         16  FILLER                       PIC X(234).
  1382
  1383     12  PB-RECORD-STATUS.
  1384         16  PB-CREDIT-SELECT-DT          PIC XX.
  1385         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1386         16  PB-BILLED-DT                 PIC XX.
  1387         16  PB-BILLING-STATUS            PIC X.
  1388             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1389             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1390             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1391         16  PB-RECORD-BILL               PIC X.
  1392             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1393             88  PB-RECORD-RETURNED           VALUE 'R'.
  1394             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1395             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1396             88  PB-OVERRIDE-AH               VALUE 'A'.
  1397             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1398         16  PB-BATCH-ENTRY               PIC X.
  1399             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1400             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1401             88  PB-REISSUED-CERT             VALUE 'E'.
  1402             88  PB-CASH-CERT                 VALUE 'C'.
  1403             88  PB-MONTHLY-CERT              VALUE 'M'.
  1404             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1405             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  26
* NSRASBL.cbl
  1406             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1407         16  PB-FORCE-CODE                PIC X.
  1408             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1409             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1410             88  PB-CANCEL-FORCE              VALUE '8'.
  1411             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1412             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1413             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1414             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1415             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1416             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1417             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  1418             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1419         16  PB-FATAL-FLAG                PIC X.
  1420             88  PB-FATAL-ERRORS              VALUE 'X'.
  1421         16  PB-FORCE-ER-CD               PIC X.
  1422             88  PB-FORCE-ERRORS              VALUE 'F'.
  1423             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1424         16  PB-WARN-ER-CD                PIC X.
  1425             88  PB-WARNING-ERRORS            VALUE 'W'.
  1426         16  FILLER                       PIC X.
  1427         16  PB-OUT-BAL-CD                PIC X.
  1428             88  PB-OUT-OF-BAL                VALUE 'O'.
  1429         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1430         16  PB-AH-OVERRIDE-L1            PIC X.
  1431         16  PB-INPUT-DT                  PIC XX.
  1432         16  PB-INPUT-BY                  PIC X(4).
  1433         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1434         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1435         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1436         16  PB-LF-EARNING-METHOD         PIC X.
  1437         16  PB-AH-EARNING-METHOD         PIC X.
  1438         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1439         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1440         16  PB-REIN-CD                   PIC XXX.
  1441         16  PB-LF-REFUND-TYPE            PIC X.
  1442         16  PB-AH-REFUND-TYPE            PIC X.
  1443         16  PB-ACCT-EFF-DT               PIC XX.
  1444         16  PB-ACCT-EXP-DT               PIC XX.
  1445         16  PB-COMPANY-ID                PIC X(3).
  1446         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1447         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1448         16  PB-SV-CARRIER                PIC X.
  1449         16  PB-SV-GROUPING               PIC X(6).
  1450         16  PB-SV-STATE                  PIC XX.
  1451         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1452         16  PB-GA-BILLING-INFO.
  1453             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1454                                          PIC XX.
  1455         16  PB-SV-REMIT-TO  REDEFINES
  1456             PB-GA-BILLING-INFO           PIC X(10).
  1457         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1458         16  PB-I-LOAN-OFFICER            PIC X(5).
  1459         16  PB-I-VIN                     PIC X(17).
  1460
  1461         16  FILLER                       PIC X(04).
  1462         16  IMNET-BYPASS-SW              PIC X.
  1463
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  27
* NSRASBL.cbl
  1464******************************************************************
  1465*                COMMON EDIT ERRORS                              *
  1466******************************************************************
  1467
  1468     12  PB-COMMON-ERRORS.
  1469         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1470                                           PIC S9(4)     COMP.
  1471
  1472******************************************************************
  1473*                                COPY ERCENDT.
  1474******************************************************************
  1475*                                                                *
  1476*                                                                *
  1477*                            ERCENDT.                            *
  1478*                            VMOD=2.001                          *
  1479*                                                                *
  1480*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1481*                                                                *
  1482*   FILE TYPE = VSAM,KSDS                                        *
  1483*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1484*                                                                *
  1485*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1486*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1487*                                                                *
  1488*   LOG = NO                                                     *
  1489*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1490******************************************************************
  1491*-----------------------------------------------------------------
  1492*                   C H A N G E   L O G
  1493*
  1494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1495*-----------------------------------------------------------------
  1496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1497* EFFECTIVE    NUMBER
  1498*-----------------------------------------------------------------
  1499* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1500*                                WITH OPEN CLAIMS
  1501* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1502* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1503* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1504* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  1505*-----------------------------------------------------------------
  1506 01  ENDORSEMENT-RECORD.
  1507     12  EN-RECORD-ID                PIC XX.
  1508         88  VALID-EN-ID                VALUE 'EN'.
  1509     12  EN-CONTROL-PRIMARY.
  1510         16  EN-COMPANY-CD           PIC X.
  1511         16  EN-CARRIER              PIC X.
  1512         16  EN-GROUPING             PIC X(6).
  1513         16  EN-STATE                PIC XX.
  1514         16  EN-ACCOUNT              PIC X(10).
  1515         16  EN-CERT-EFF-DT          PIC XX.
  1516         16  EN-CERT-NO.
  1517             20  EN-CERT-PRIME       PIC X(10).
  1518             20  EN-CERT-SFX         PIC X.
  1519         16  EN-REC-TYPE             PIC X.
  1520             88  EN-ISSUE               VALUE 'I'.
  1521             88  EN-CANCELLATION        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  28
* NSRASBL.cbl
  1522         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1523     12  EN-CONTROL-BY-ARCH-NO.
  1524         16  EN-COMPANY-CD-A1              PIC X.
  1525         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1526     12  EN-LAST-MAINT-DT            PIC XX.
  1527     12  EN-LAST-MAINT-BY            PIC X(4).
  1528     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1529     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1530     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1531         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1532         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1533         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1534         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1535         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1536         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1537         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1538         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1539         16  EN-LF-ORIG-BENCD        PIC XX.
  1540         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1541         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1542         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1543         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1544         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1545         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1546*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1547         16  EN-ORIG-CRED-BENE       PIC X(25).
  1548         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1549         16  FILLER                  PIC X.
  1550         16  EN-AH-ORIG-BENCD        PIC XX.
  1551         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1552         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1553         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1554         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1555*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1556*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1557         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1558         16  F                       PIC X(09).
  1559         16  EN-AH-ORIG-CP           PIC 99.
  1560         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1561         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1562         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1563         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1564         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1565         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1566         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1567         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1568         16  EN-LF-NEW-BENCD         PIC XX.
  1569         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1570         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1571         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1572         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1573         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1574         16  EN-LF-NEW-EXP-DT        PIC XX.
  1575         16  EN-NEW-CRED-BENE        PIC X(25).
  1576         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1577         16  FILLER                  PIC X.
  1578         16  EN-AH-NEW-BENCD         PIC XX.
  1579         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  29
* NSRASBL.cbl
  1580         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1581         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1582         16  EN-AH-NEW-EXP-DT        PIC XX.
  1583*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1584*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1585*        16  F                       PIC X(12).
  1586         16  EN-AH-NEW-CP            PIC 99.
  1587         16  EN-SIG-SW               PIC X.
  1588         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1589         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1590         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1591         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1592         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1593         16  FILLER                  PIC X(33).
  1594     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1595         16  EN-LF-ORIG-REF-DT       PIC XX.
  1596         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1597         16  EN-AH-ORIG-REF-DT       PIC XX.
  1598         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1599         16  EN-LF-NEW-REF-DT        PIC XX.
  1600         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1601         16  EN-AH-NEW-REF-DT        PIC XX.
  1602         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1603         16  EN-FLAG-CERT            PIC X.
  1604         16  EN-INS-LAST-NAME        PIC X(15).
  1605         16  EN-INS-FIRST-NAME       PIC X(10).
  1606         16  EN-INS-MIDDLE-INIT      PIC X.
  1607         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1608         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1609         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1610         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1611         16  FILLER                  PIC X(262).
  1612     12  EN-MONEY-SW             PIC X.
  1613     12  EN-HEALTH-APP           PIC X.
  1614     12  EN-VOUCHER-SW           PIC X.
  1615     12  EN-PAYEE                PIC X(14).
  1616     12  EN-INPUT-DT             PIC XX.
  1617     12  EN-PROCESS-DT           PIC XX.
  1618     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1619     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1620     12  EN-REASON-CODES.
  1621         16  F OCCURS 12.
  1622             20  EN-REASON-CODE  PIC X(4).
  1623     12  EN-TEMPLATE-USED        PIC X(8).
  1624     12  EN-DOCU-TYPE            PIC X.
  1625         88  EN-VERI-DOCU          VALUE 'V'.
  1626         88  EN-GCE-DOCU           VALUE 'G'.
  1627         88  EN-CANC-DOCU          VALUE 'C'.
  1628     12  EN-COMMENTS1            PIC X(13).
  1629     12  EN-COMMENTS2            PIC X(70).
  1630     12  EN-COMM-CHGBK           PIC X.
  1631         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1632         88  EN-CHG-ACCT           VALUE 'Y'.
  1633     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1634     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1635     12  EN-BATCH-NUMBER         PIC X(6).
  1636     12  EN-ACCT-SUMM            PIC X.
  1637     12  EN-CSO-SUMM             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  30
* NSRASBL.cbl
  1638     12  en-check-type           pic x.
  1639     12  FILLER                  PIC X(12).
  1640******************************************************************
  1641*                                COPY ERCMAIL.
  1642******************************************************************
  1643*                                                                *
  1644*                                                                *
  1645*                            ERCMAIL                             *
  1646*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1647*                            VMOD=2.003                          *
  1648*                                                                *
  1649*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1650*                                                                *
  1651*   FILE TYPE = VSAM,KSDS                                        *
  1652*   RECORD SIZE = 374   RECFORM = FIX                            *
  1653*                                                                *
  1654*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1655*   ALTERNATE PATH    = NOT USED                                 *
  1656*                                                                *
  1657*   LOG = YES                                                    *
  1658*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1659******************************************************************
  1660*                   C H A N G E   L O G
  1661*
  1662* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1663*-----------------------------------------------------------------
  1664*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1665* EFFECTIVE    NUMBER
  1666*-----------------------------------------------------------------
  1667* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1668* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1669* 111108                   PEMA  ADD CRED BENE ADDR2
  1670******************************************************************
  1671
  1672 01  MAILING-DATA.
  1673     12  MA-RECORD-ID                      PIC XX.
  1674         88  VALID-MA-ID                       VALUE 'MA'.
  1675
  1676     12  MA-CONTROL-PRIMARY.
  1677         16  MA-COMPANY-CD                 PIC X.
  1678         16  MA-CARRIER                    PIC X.
  1679         16  MA-GROUPING.
  1680             20  MA-GROUPING-PREFIX        PIC XXX.
  1681             20  MA-GROUPING-PRIME         PIC XXX.
  1682         16  MA-STATE                      PIC XX.
  1683         16  MA-ACCOUNT.
  1684             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1685             20  MA-ACCOUNT-PRIME          PIC X(6).
  1686         16  MA-CERT-EFF-DT                PIC XX.
  1687         16  MA-CERT-NO.
  1688             20  MA-CERT-PRIME             PIC X(10).
  1689             20  MA-CERT-SFX               PIC X.
  1690
  1691     12  FILLER                            PIC XX.
  1692
  1693     12  MA-ACCESS-CONTROL.
  1694         16  MA-SOURCE-SYSTEM              PIC XX.
  1695             88  MA-FROM-CREDIT                VALUE 'CR'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  31
* NSRASBL.cbl
  1696             88  MA-FROM-VSI                   VALUE 'VS'.
  1697             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1698             88  MA-FROM-OTHER                 VALUE 'OT'.
  1699         16  MA-RECORD-ADD-DT              PIC XX.
  1700         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1701         16  MA-LAST-MAINT-DT              PIC XX.
  1702         16  MA-LAST-MAINT-BY              PIC XXXX.
  1703         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1704
  1705     12  MA-PROFILE-INFO.
  1706         16  MA-QUALIFY-CODE-1             PIC XX.
  1707         16  MA-QUALIFY-CODE-2             PIC XX.
  1708         16  MA-QUALIFY-CODE-3             PIC XX.
  1709         16  MA-QUALIFY-CODE-4             PIC XX.
  1710         16  MA-QUALIFY-CODE-5             PIC XX.
  1711
  1712         16  MA-INSURED-LAST-NAME          PIC X(15).
  1713         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1714         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1715         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1716         16  MA-INSURED-BIRTH-DT           PIC XX.
  1717         16  MA-INSURED-SEX                PIC X.
  1718             88  MA-SEX-MALE                   VALUE 'M'.
  1719             88  MA-SEX-FEMALE                 VALUE 'F'.
  1720         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1721
  1722         16  MA-ADDRESS-CORRECTED          PIC X.
  1723         16  MA-JOINT-BIRTH-DT             PIC XX.
  1724*        16  FILLER                        PIC X(12).
  1725
  1726         16  MA-ADDRESS-LINE-1             PIC X(30).
  1727         16  MA-ADDRESS-LINE-2             PIC X(30).
  1728         16  MA-CITY-STATE.
  1729             20  MA-CITY                   PIC X(28).
  1730             20  MA-ADDR-STATE             PIC XX.
  1731         16  MA-ZIP.
  1732             20  MA-ZIP-CODE.
  1733                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1734                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1735                 24  FILLER                PIC X(4).
  1736             20  MA-ZIP-PLUS4              PIC X(4).
  1737         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1738             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1739             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1740             20  FILLER                    PIC X(3).
  1741
  1742         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1743
  1744         16  FILLER                        PIC XXX.
  1745*        16  FILLER                        PIC X(10).
  1746
  1747     12  MA-CRED-BENE-INFO.
  1748         16  MA-CRED-BENE-NAME                 PIC X(25).
  1749         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1750         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1751         16  MA-CRED-BENE-CTYST.
  1752             20  MA-CRED-BENE-CITY             PIC X(28).
  1753             20  MA-CRED-BENE-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  32
* NSRASBL.cbl
  1754         16  MA-CRED-BENE-ZIP.
  1755             20  MA-CB-ZIP-CODE.
  1756                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1757                     88  MA-CB-CANADIAN-POST-CODE
  1758                                           VALUE 'A' THRU 'Z'.
  1759                 24  FILLER                    PIC X(4).
  1760             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1761         16  MA-CB-CANADIAN-POSTAL-CODE
  1762                            REDEFINES MA-CRED-BENE-ZIP.
  1763             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1764             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1765             20  FILLER                        PIC X(3).
  1766     12  MA-POST-CARD-MAIL-DATA.
  1767         16  MA-MAIL-DATA OCCURS 7.
  1768             20  MA-MAIL-TYPE              PIC X.
  1769                 88  MA-12MO-MAILING           VALUE '1'.
  1770                 88  MA-EXP-MAILING            VALUE '2'.
  1771             20  MA-MAIL-STATUS            PIC X.
  1772                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1773                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1774                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1775             20  MA-MAIL-DATE              PIC XX.
  1776     12  FILLER                            PIC XX.
  1777     12  FILLER                            PIC XX.
  1778*    12  FILLER                            PIC X(30).
  1779******************************************************************
  1780*                                COPY ERCCOMP.
  1781******************************************************************
  1782*                                                                *
  1783*                                                                *
  1784*                            ERCCOMP                             *
  1785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1786*                            VMOD=2.019                          *
  1787*                                                                *
  1788*   ONLINE CREDIT SYSTEM                                         *
  1789*                                                                *
  1790*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1791*                                                                *
  1792*   FILE TYPE = VSAM,KSDS                                        *
  1793*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1794*                                                                *
  1795*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1796*       ALTERNATE PATH = NONE                                    *
  1797*                                                                *
  1798*   LOG = NO                                                     *
  1799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1800*                                                                *
  1801******************************************************************
  1802*                   C H A N G E   L O G
  1803*
  1804* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1805*-----------------------------------------------------------------
  1806*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1807* EFFECTIVE    NUMBER
  1808*-----------------------------------------------------------------
  1809* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1810* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1811* 092205    2005050300006  PEMA  ADD LEASE FEE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  33
* NSRASBL.cbl
  1812* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1813* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1814* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1815* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1816* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1817* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1818******************************************************************
  1819
  1820 01  COMPENSATION-MASTER.
  1821     12  CO-RECORD-ID                          PIC XX.
  1822         88  VALID-CO-ID                          VALUE 'CO'.
  1823
  1824     12  CO-CONTROL-PRIMARY.
  1825         16  CO-COMPANY-CD                     PIC X.
  1826         16  CO-CONTROL.
  1827             20  CO-CTL-1.
  1828                 24  CO-CARR-GROUP.
  1829                     28  CO-CARRIER            PIC X.
  1830                     28  CO-GROUPING.
  1831                         32  CO-GROUP-PREFIX   PIC XXX.
  1832                         32  CO-GROUP-PRIME    PIC XXX.
  1833                 24  CO-RESP-NO.
  1834                     28  CO-RESP-PREFIX        PIC X(4).
  1835                     28  CO-RESP-PRIME         PIC X(6).
  1836             20  CO-CTL-2.
  1837                 24  CO-ACCOUNT.
  1838                     28  CO-ACCT-PREFIX        PIC X(4).
  1839                     28  CO-ACCT-PRIME         PIC X(6).
  1840         16  CO-TYPE                           PIC X.
  1841             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1842             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1843             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1844
  1845     12  CO-MAINT-INFORMATION.
  1846         16  CO-LAST-MAINT-DT                  PIC XX.
  1847         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1848         16  CO-LAST-MAINT-USER                PIC X(4).
  1849     12  FILLER                                PIC XX.
  1850     12  CO-STMT-TYPE                          PIC XXX.
  1851     12  CO-COMP-TYPE                          PIC X.
  1852         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1853     12  CO-STMT-OWNER                         PIC X(4).
  1854     12  CO-BALANCE-CONTROL                    PIC X.
  1855         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1856         88  CO-NO-BALANCE                        VALUE 'N'.
  1857
  1858     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1859         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1860         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1861         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1862
  1863     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1864         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1865         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1866
  1867     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1868     12  CO-GA-DIRECT-DEP                      PIC X.
  1869     12  CO-FUTURE-SPACE                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  34
* NSRASBL.cbl
  1870         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1871
  1872     12  CO-ACCT-NAME                          PIC X(30).
  1873     12  CO-MAIL-NAME                          PIC X(30).
  1874     12  CO-ADDR-1                             PIC X(30).
  1875     12  CO-ADDR-2                             PIC X(30).
  1876     12  CO-ADDR-3.
  1877         16  CO-ADDR-CITY                      PIC X(27).
  1878         16  CO-ADDR-STATE                     PIC XX.
  1879     12  CO-CSO-1099                           PIC X.
  1880     12  CO-ZIP.
  1881         16  CO-ZIP-PRIME.
  1882             20  CO-ZIP-PRI-1ST                PIC X.
  1883                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1884             20  FILLER                        PIC X(4).
  1885         16  CO-ZIP-PLUS4                      PIC X(4).
  1886     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1887         16  CO-CAN-POSTAL-1                   PIC XXX.
  1888         16  CO-CAN-POSTAL-2                   PIC XXX.
  1889         16  FILLER                            PIC XXX.
  1890     12  CO-SOC-SEC                            PIC X(13).
  1891     12  CO-TELEPHONE.
  1892         16  CO-AREA-CODE                      PIC XXX.
  1893         16  CO-PREFIX                         PIC XXX.
  1894         16  CO-PHONE                          PIC X(4).
  1895
  1896     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1897
  1898     12  CO-AR-BAL-LEVEL                       PIC X.
  1899         88  CO-AR-REF-LVL                        VALUE '1'.
  1900         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1901         88  CO-AR-BILL-LVL                       VALUE '2'.
  1902         88  CO-AR-AGT-LVL                        VALUE '3'.
  1903         88  CO-AR-FR-LVL                         VALUE '4'.
  1904
  1905     12  CO-AR-NORMAL-PRINT                    PIC X.
  1906         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1907         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1908
  1909     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1910
  1911     12  CO-AR-REPORTING                       PIC X.
  1912         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1913         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1914
  1915     12  CO-AR-PULL-CHECK                      PIC X.
  1916         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1917         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1918
  1919     12  CO-AR-BALANCE-PRINT                   PIC X.
  1920         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1921
  1922     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1923         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1924         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1925         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1926
  1927     12  CO-LAST-EOM-STMT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  35
* NSRASBL.cbl
  1928
  1929     12  CO-USER-CODE                          PIC X.
  1930     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1931
  1932******************************************************************
  1933*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1934*    THE LAST MONTH END RUN.
  1935******************************************************************
  1936
  1937     12  CO-LAST-ACTIVITY-DATE.
  1938         16  CO-ACT-YEAR                       PIC 99.
  1939         16  CO-ACT-MONTH                      PIC 99.
  1940         16  CO-ACT-DAY                        PIC 99.
  1941
  1942     12  CO-LAST-STMT-DT.
  1943         16  CO-LAST-STMT-YEAR                 PIC 99.
  1944         16  CO-LAST-STMT-MONTH                PIC 99.
  1945         16  CO-LAST-STMT-DAY                  PIC 99.
  1946
  1947     12  CO-MO-END-TOTALS.
  1948         16  CO-MONTHLY-TOTALS.
  1949             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1950             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1951             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1952             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1953             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1954
  1955         16  CO-AGING-TOTALS.
  1956             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1957             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1958             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1959             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1960
  1961         16  CO-YTD-TOTALS.
  1962             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1963             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1964
  1965         16  CO-OVER-UNDER-TOTALS.
  1966             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1967             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1968
  1969     12  CO-MISCELLANEOUS-TOTALS.
  1970         16  CO-FICA-TOTALS.
  1971             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1972             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1973
  1974         16  CO-CLAIM-TOTALS.
  1975             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1976             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1977
  1978******************************************************************
  1979*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1980*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1981******************************************************************
  1982
  1983     12  CO-CURRENT-TOTALS.
  1984         16  CO-CURRENT-LAST-STMT-DT.
  1985             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  36
* NSRASBL.cbl
  1986             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1987             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1988
  1989         16  CO-CURRENT-MONTHLY-TOTALS.
  1990             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1991             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1992             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1993             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1994             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1995
  1996         16  CO-CURRENT-AGING-TOTALS.
  1997             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1998             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1999             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2000             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2001
  2002         16  CO-CURRENT-YTD-TOTALS.
  2003             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2004             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2005
  2006     12  CO-PAID-COMM-TOTALS.
  2007         16  CO-YTD-PAID-COMMS.
  2008             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2009             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2010
  2011     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2012         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2013         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2014
  2015     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2016         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2017         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2018         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2019         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2020         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2021         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2022         88  CO-FINAL-LETTER                  VALUE 'F'.
  2023         88  CO-RECONCILING                   VALUE 'R'.
  2024         88  CO-PHONE-CALL                    VALUE 'P'.
  2025         88  CO-LEGAL                         VALUE 'L'.
  2026         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2027         88  CO-WRITE-OFF                     VALUE 'W'.
  2028         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2029
  2030     12  CO-CSR-CODE                       PIC X(4).
  2031
  2032     12  CO-GA-STATUS-INFO.
  2033         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2034         16  CO-GA-TERMINATION-DT          PIC XX.
  2035         16  CO-GA-STATUS-CODE             PIC X.
  2036             88  CO-GA-ACTIVE                 VALUE 'A'.
  2037             88  CO-GA-INACTIVE               VALUE 'I'.
  2038             88  CO-GA-PENDING                VALUE 'P'.
  2039         16  CO-GA-COMMENTS.
  2040             20  CO-GA-COMMENT-1           PIC X(40).
  2041             20  CO-GA-COMMENT-2           PIC X(40).
  2042             20  CO-GA-COMMENT-3           PIC X(40).
  2043             20  CO-GA-COMMENT-4           PIC X(40).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  37
* NSRASBL.cbl
  2044
  2045     12  CO-RPTCD2                         PIC X(10).
  2046     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2047         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2048         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2049
  2050     12  CO-TYPE-AGENT                     PIC X(01).
  2051         88  CO-CORPORATION                   VALUE 'C'.
  2052         88  CO-PARTNERSHIP                   VALUE 'P'.
  2053         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2054         88  CO-TRUST                         VALUE 'T'.
  2055         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2056
  2057     12  CO-FAXNO.
  2058         16  CO-FAX-AREA-CODE                  PIC XXX.
  2059         16  CO-FAX-PREFIX                     PIC XXX.
  2060         16  CO-FAX-PHONE                      PIC X(4).
  2061
  2062     12  CO-BANK-INFORMATION.
  2063         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2064         16  CO-BANK-TRANSIT-NON REDEFINES
  2065             CO-BANK-TRANSIT-NO                PIC 9(8).
  2066
  2067         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2068     12  CO-MISC-DEDUCT-INFO REDEFINES
  2069                  CO-BANK-INFORMATION.
  2070         16  CO-MD-GL-ACCT                     PIC X(10).
  2071         16  CO-MD-DIV                         PIC XX.
  2072         16  CO-MD-CENTER                      PIC X(4).
  2073         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2074         16  CO-CREATE-AP-CHECK                PIC X.
  2075         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2076         16  FILLER                            PIC XXX.
  2077     12  CO-ACH-STATUS                         PIC X.
  2078         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2079         88  CO-ACH-PENDING                        VALUE 'P'.
  2080
  2081     12  CO-BILL-SW                            PIC X.
  2082     12  CO-CONTROL-NAME                       PIC X(30).
  2083     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2084     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2085     12  CO-CLP-STATE                          PIC XX.
  2086     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2087     12  CO-SPP-REFUND-EDIT                    PIC X.
  2088
  2089******************************************************************
  2090*                                COPY ELCCERT.
  2091******************************************************************
  2092*                                                                *
  2093*                            ELCCERT.                            *
  2094*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2095*                            VMOD=2.013                          *
  2096*                                                                *
  2097*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2098*                                                                *
  2099*   FILE TYPE = VSAM,KSDS                                        *
  2100*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2101*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  38
* NSRASBL.cbl
  2102*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2103*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2104*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2105*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2106*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2107*                                                                *
  2108*   LOG = YES                                                    *
  2109*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2110******************************************************************
  2111*                   C H A N G E   L O G
  2112*
  2113* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2114*-----------------------------------------------------------------
  2115*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2116* EFFECTIVE    NUMBER
  2117*-----------------------------------------------------------------
  2118* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2119* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2120* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2121* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2122* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2123* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2124* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2125* 032612  CR2011110200001  PEMA  AHL CHANGES
  2126* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2127* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2128******************************************************************
  2129
  2130 01  CERTIFICATE-MASTER.
  2131     12  CM-RECORD-ID                      PIC XX.
  2132         88  VALID-CM-ID                      VALUE 'CM'.
  2133
  2134     12  CM-CONTROL-PRIMARY.
  2135         16  CM-COMPANY-CD                 PIC X.
  2136         16  CM-CARRIER                    PIC X.
  2137         16  CM-GROUPING.
  2138             20  CM-GROUPING-PREFIX        PIC X(3).
  2139             20  CM-GROUPING-PRIME         PIC X(3).
  2140         16  CM-STATE                      PIC XX.
  2141         16  CM-ACCOUNT.
  2142             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2143             20  CM-ACCOUNT-PRIME          PIC X(6).
  2144         16  CM-CERT-EFF-DT                PIC XX.
  2145         16  CM-CERT-NO.
  2146             20  CM-CERT-PRIME             PIC X(10).
  2147             20  CM-CERT-SFX               PIC X.
  2148
  2149     12  CM-CONTROL-BY-NAME.
  2150         16  CM-COMPANY-CD-A1              PIC X.
  2151         16  CM-INSURED-LAST-NAME          PIC X(15).
  2152         16  CM-INSURED-INITIALS.
  2153             20  CM-INSURED-INITIAL1       PIC X.
  2154             20  CM-INSURED-INITIAL2       PIC X.
  2155
  2156     12  CM-CONTROL-BY-SSN.
  2157         16  CM-COMPANY-CD-A2              PIC X.
  2158         16  CM-SOC-SEC-NO.
  2159             20  CM-SSN-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  39
* NSRASBL.cbl
  2160             20  CM-SSN-ACCOUNT            PIC X(6).
  2161             20  CM-SSN-LN3.
  2162                 25  CM-INSURED-INITIALS-A2.
  2163                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2164                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2165                 25 CM-PART-LAST-NAME-A2         PIC X.
  2166
  2167     12  CM-CONTROL-BY-CERT-NO.
  2168         16  CM-COMPANY-CD-A4              PIC X.
  2169         16  CM-CERT-NO-A4                 PIC X(11).
  2170
  2171     12  CM-CONTROL-BY-MEMB.
  2172         16  CM-COMPANY-CD-A5              PIC X.
  2173         16  CM-MEMBER-NO.
  2174             20  CM-MEMB-STATE             PIC XX.
  2175             20  CM-MEMB-ACCOUNT           PIC X(6).
  2176             20  CM-MEMB-LN4.
  2177                 25  CM-INSURED-INITIALS-A5.
  2178                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2179                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2180                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2181
  2182     12  CM-INSURED-PROFILE-DATA.
  2183         16  CM-INSURED-FIRST-NAME.
  2184             20  CM-INSURED-1ST-INIT       PIC X.
  2185             20  FILLER                    PIC X(9).
  2186         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2187         16  CM-INSURED-SEX                PIC X.
  2188             88  CM-SEX-MALE                  VALUE 'M'.
  2189             88  CM-SEX-FEMAL                 VALUE 'F'.
  2190         16  CM-INSURED-JOINT-AGE          PIC 99.
  2191         16  CM-JOINT-INSURED-NAME.
  2192             20  CM-JT-LAST-NAME           PIC X(15).
  2193             20  CM-JT-FIRST-NAME.
  2194                 24  CM-JT-1ST-INIT        PIC X.
  2195                 24  FILLER                PIC X(9).
  2196             20  CM-JT-INITIAL             PIC X.
  2197
  2198     12  CM-LIFE-DATA.
  2199         16  CM-LF-BENEFIT-CD              PIC XX.
  2200         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2201         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2202         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2203         16  CM-LF-DEV-CODE                PIC XXX.
  2204         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2205         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2206         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2207         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2208         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2209         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2210         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2211         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2212         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2213         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2214         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2215         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2216         16  cm-temp-epiq                  pic xx.
  2217             88  EPIQ-CLASS                  value 'EQ'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  40
* NSRASBL.cbl
  2218*        16  FILLER                        PIC XX.
  2219
  2220     12  CM-AH-DATA.
  2221         16  CM-AH-BENEFIT-CD              PIC XX.
  2222         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2223         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2224         16  CM-AH-DEV-CODE                PIC XXX.
  2225         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2226         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2227         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2228         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2229         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2230         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2231         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2232         16  CM-AH-PAID-THRU-DT            PIC XX.
  2233             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2234         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2235         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2236         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2237         16  FILLER                        PIC X.
  2238
  2239     12  CM-LOAN-INFORMATION.
  2240         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2241         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2242                                           PIC S9(5)V99  COMP-3.
  2243         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2244         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2245         16  CM-PAY-FREQUENCY              PIC S99.
  2246         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2247         16  CM-RATE-CLASS                 PIC XX.
  2248         16  CM-BENEFICIARY                PIC X(25).
  2249         16  CM-POLICY-FORM-NO             PIC X(12).
  2250         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2251         16  CM-LAST-ADD-ON-DT             PIC XX.
  2252         16  CM-DEDUCTIBLE-AMOUNTS.
  2253             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2254             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2255         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2256             20  CM-RESIDENT-STATE         PIC XX.
  2257             20  CM-RATE-CODE              PIC X(4).
  2258             20  FILLER                    PIC XX.
  2259         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2260             20  CM-LOAN-OFFICER           PIC X(5).
  2261             20  FILLER                    PIC XXX.
  2262         16  CM-CSR-CODE                   PIC XXX.
  2263         16  CM-UNDERWRITING-CODE          PIC X.
  2264             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2265         16  CM-POST-CARD-IND              PIC X.
  2266         16  CM-NH-INTERFACE-SW            PIC X.
  2267         16  CM-PREMIUM-TYPE               PIC X.
  2268             88  CM-SING-PRM                  VALUE '1'.
  2269             88  CM-O-B-COVERAGE              VALUE '2'.
  2270             88  CM-OPEN-END                  VALUE '3'.
  2271         16  CM-IND-GRP-TYPE               PIC X.
  2272             88  CM-INDIVIDUAL                VALUE 'I'.
  2273             88  CM-GROUP                     VALUE 'G'.
  2274         16  CM-SKIP-CODE                  PIC X.
  2275             88  NO-MONTHS-SKIPPED            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  41
* NSRASBL.cbl
  2276             88  SKIP-JULY                    VALUE '1'.
  2277             88  SKIP-AUGUST                  VALUE '2'.
  2278             88  SKIP-SEPTEMBER               VALUE '3'.
  2279             88  SKIP-JULY-AUG                VALUE '4'.
  2280             88  SKIP-AUG-SEPT                VALUE '5'.
  2281             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2282             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2283             88  SKIP-JUNE                    VALUE '8'.
  2284             88  SKIP-JUNE-JULY               VALUE '9'.
  2285             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2286             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2287         16  CM-PAYMENT-MODE               PIC X.
  2288             88  PAY-MONTHLY                  VALUE SPACE.
  2289             88  PAY-WEEKLY                   VALUE '1'.
  2290             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2291             88  PAY-BI-WEEKLY                VALUE '3'.
  2292             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2293         16  CM-LOAN-NUMBER                PIC X(8).
  2294         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2295         16  CM-OLD-LOF                    PIC XXX.
  2296*        16  CM-LOAN-OFFICER               PIC XXX.
  2297         16  CM-REIN-TABLE                 PIC XXX.
  2298         16  CM-SPECIAL-REIN-CODE          PIC X.
  2299         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2300         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2301         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2302
  2303     12  CM-STATUS-DATA.
  2304         16  CM-ENTRY-STATUS               PIC X.
  2305         16  CM-ENTRY-DT                   PIC XX.
  2306
  2307         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2308         16  CM-LF-CANCEL-DT               PIC XX.
  2309         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2310
  2311         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2312         16  CM-LF-DEATH-DT                PIC XX.
  2313         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2314
  2315         16  CM-LF-CURRENT-STATUS          PIC X.
  2316             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2317                                                'M' '4' '5' '9'.
  2318             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2319             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2320             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2321             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2322             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2323             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2324             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2325             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2326             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2327             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2328             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2329             88  CM-LF-DECLINED               VALUE 'D'.
  2330             88  CM-LF-VOIDED                 VALUE 'V'.
  2331
  2332         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2333         16  CM-AH-CANCEL-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  42
* NSRASBL.cbl
  2334         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2335
  2336         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2337         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2338         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2339
  2340         16  CM-AH-CURRENT-STATUS          PIC X.
  2341             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2342                                                'M' '4' '5' '9'.
  2343             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2344             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2345             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2346             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2347             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2348             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2349             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2350             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2351             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2352             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2353             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2354             88  CM-AH-DECLINED               VALUE 'D'.
  2355             88  CM-AH-VOIDED                 VALUE 'V'.
  2356
  2357         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2358             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2359             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2360             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2361         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2362
  2363         16  CM-ENTRY-BATCH                PIC X(6).
  2364         16  CM-LF-EXIT-BATCH              PIC X(6).
  2365         16  CM-AH-EXIT-BATCH              PIC X(6).
  2366         16  CM-LAST-MONTH-END             PIC XX.
  2367
  2368     12  CM-NOTE-SW                        PIC X.
  2369         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2370         88  CERT-NOTES-PRESENT               VALUE '1'.
  2371         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2372         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2373         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2374         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2375         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2376         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2377     12  CM-COMP-EXCP-SW                   PIC X.
  2378         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2379         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2380     12  CM-INSURED-ADDRESS-SW             PIC X.
  2381         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2382         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2383
  2384*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2385     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2386     12  FILLER                            PIC X.
  2387
  2388*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2389     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2390     12  FILLER                            PIC X.
  2391*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  43
* NSRASBL.cbl
  2392     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2393
  2394     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2395         88  CERT-ADDED-BATCH                 VALUE ' '.
  2396         88  CERT-ADDED-ONLINE                VALUE '1'.
  2397         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2398         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2399         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2400     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2401         88  CERT-AS-LOADED                   VALUE ' '.
  2402         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2403         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2404         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2405         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2406         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2407         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2408         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2409
  2410     12  CM-ACCOUNT-COMM-PCTS.
  2411         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2412         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2413
  2414     12  CM-USER-FIELD                     PIC X.
  2415     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2416     12  CM-CLP-STATE                      PIC XX.
  2417     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2418     12  CM-USER-RESERVED                  PIC XXX.
  2419     12  FILLER REDEFINES CM-USER-RESERVED.
  2420         16  CM-AH-CLASS-CD                PIC XX.
  2421         16  F                             PIC X.
  2422******************************************************************
  2423*                                COPY ELCCRTO.
  2424******************************************************************
  2425*                                                                *
  2426*                            ELCCRTO.                            *
  2427*                                                                *
  2428*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2429*                                                                *
  2430*   FILE TYPE = VSAM,KSDS                                        *
  2431*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2432*                                                                *
  2433*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2434*                                                                *
  2435*   LOG = YES                                                    *
  2436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2437******************************************************************
  2438*                   C H A N G E   L O G
  2439*
  2440* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2441*-----------------------------------------------------------------
  2442*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2443* EFFECTIVE    NUMBER
  2444*-----------------------------------------------------------------
  2445* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2446* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2447* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2448* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2449* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  44
* NSRASBL.cbl
  2450******************************************************************
  2451 01  ORIGINAL-CERTIFICATE.
  2452     12  OC-RECORD-ID                      PIC XX.
  2453         88  VALID-OC-ID                      VALUE 'OC'.
  2454     12  OC-CONTROL-PRIMARY.
  2455         16  OC-COMPANY-CD                 PIC X.
  2456         16  OC-CARRIER                    PIC X.
  2457         16  OC-GROUPING                   PIC X(6).
  2458         16  OC-STATE                      PIC XX.
  2459         16  OC-ACCOUNT                    PIC X(10).
  2460         16  OC-CERT-EFF-DT                PIC XX.
  2461         16  OC-CERT-NO.
  2462             20  OC-CERT-PRIME             PIC X(10).
  2463             20  OC-CERT-SFX               PIC X.
  2464         16  OC-RECORD-TYPE                PIC X.
  2465         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2466     12  OC-LAST-MAINT-DT                  PIC XX.
  2467     12  OC-LAST-MAINT-BY                  PIC X(4).
  2468     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2469     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2470     12  FILLER                            PIC X(49).
  2471     12  OC-ORIG-REC.
  2472         16  OC-INS-LAST-NAME              PIC X(15).
  2473         16  OC-INS-FIRST-NAME             PIC X(10).
  2474         16  OC-INS-MIDDLE-INIT            PIC X.
  2475         16  OC-INS-AGE                    PIC S999     COMP-3.
  2476         16  OC-JNT-LAST-NAME              PIC X(15).
  2477         16  OC-JNT-FIRST-NAME             PIC X(10).
  2478         16  OC-JNT-MIDDLE-INIT            PIC X.
  2479         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2480         16  OC-LF-BENCD                   PIC XX.
  2481         16  OC-LF-TERM                    PIC S999      COMP-3.
  2482         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2483         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2484         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2485         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2486         16  OC-LF-EXP-DT                  PIC XX.
  2487         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2488         16  OC-LF-CANCEL-DT               PIC XX.
  2489         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2490         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2491         16  OC-AH-BENCD                   PIC XX.
  2492         16  OC-AH-TERM                    PIC S999      COMP-3.
  2493         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2494         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2495         16  OC-AH-EXP-DT                  PIC XX.
  2496         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2497         16  OC-AH-CP                      PIC 99.
  2498         16  OC-AH-CANCEL-DT               PIC XX.
  2499         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2500         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2501         16  OC-CRED-BENE-NAME             PIC X(25).
  2502         16  OC-1ST-PMT-DT                 PIC XX.
  2503         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  2504         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2505         16  OC-ISSUE-TRAN-IND             PIC X.
  2506         16  OC-CANCEL-TRAN-IND            PIC X.
  2507         16  FILLER                        PIC X(211).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  45
* NSRASBL.cbl
  2508
  2509     12  FILLER                            PIC X(50).
  2510******************************************************************
  2511*                                COPY ERCACCT.
  2512******************************************************************
  2513*                                                                *
  2514*                                                                *
  2515*                            ERCACCT                             *
  2516*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2517*                            VMOD=2.031                          *
  2518*                                                                *
  2519*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2520*                                                                *
  2521*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2522*   VSAM ACCOUNT MASTER FILES.                                   *
  2523*                                                                *
  2524*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2525*                                                                *
  2526*   FILE TYPE = VSAM,KSDS                                        *
  2527*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2528*                                                                *
  2529*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2530*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2531*                                                                *
  2532*   LOG = NO                                                     *
  2533*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2534*                                                                *
  2535*                                                                *
  2536******************************************************************
  2537*                   C H A N G E   L O G
  2538*
  2539* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2540*-----------------------------------------------------------------
  2541*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2542* EFFECTIVE    NUMBER
  2543*-----------------------------------------------------------------
  2544* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2545* 092705    2005050300006  PEMA  ADD SPP LEASES
  2546* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2547* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2548* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2549* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2550* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2551* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2552******************************************************************
  2553
  2554 01  ACCOUNT-MASTER.
  2555     12  AM-RECORD-ID                      PIC XX.
  2556         88  VALID-AM-ID                      VALUE 'AM'.
  2557
  2558     12  AM-CONTROL-PRIMARY.
  2559         16  AM-COMPANY-CD                 PIC X.
  2560         16  AM-MSTR-CNTRL.
  2561             20  AM-CONTROL-A.
  2562                 24  AM-CARRIER            PIC X.
  2563                 24  AM-GROUPING.
  2564                     28 AM-GROUPING-PREFIX PIC XXX.
  2565                     28 AM-GROUPING-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  46
* NSRASBL.cbl
  2566                 24  AM-STATE              PIC XX.
  2567                 24  AM-ACCOUNT.
  2568                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2569                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2570             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2571                                           PIC X(19).
  2572             20  AM-CNTRL-B.
  2573                 24  AM-EXPIRATION-DT      PIC XX.
  2574                 24  FILLER                PIC X(4).
  2575             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2576                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2577
  2578     12  AM-CONTROL-BY-VAR-GRP.
  2579         16  AM-COMPANY-CD-A1              PIC X.
  2580         16  AM-VG-CARRIER                 PIC X.
  2581         16  AM-VG-GROUPING                PIC X(6).
  2582         16  AM-VG-STATE                   PIC XX.
  2583         16  AM-VG-ACCOUNT                 PIC X(10).
  2584         16  AM-VG-DATE.
  2585             20  AM-VG-EXPIRATION-DT       PIC XX.
  2586             20  FILLER                    PIC X(4).
  2587         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2588                                           PIC 9(11)      COMP-3.
  2589     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2590         16  FILLER                        PIC X(10).
  2591         16  AM-VG-KEY3.
  2592             20  AM-VG3-ACCOUNT            PIC X(10).
  2593             20  AM-VG3-EXP-DT             PIC XX.
  2594         16  FILLER                        PIC X(4).
  2595     12  AM-MAINT-INFORMATION.
  2596         16  AM-LAST-MAINT-DT              PIC XX.
  2597         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2598         16  AM-LAST-MAINT-USER            PIC X(4).
  2599         16  FILLER                        PIC XX.
  2600
  2601     12  AM-EFFECTIVE-DT                   PIC XX.
  2602     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2603
  2604     12  AM-PREV-DATES  COMP-3.
  2605         16  AM-PREV-EXP-DT                PIC 9(11).
  2606         16  AM-PREV-EFF-DT                PIC 9(11).
  2607
  2608     12  AM-REPORT-CODE-1                  PIC X(10).
  2609     12  AM-REPORT-CODE-2                  PIC X(10).
  2610
  2611     12  AM-CITY-CODE                      PIC X(4).
  2612     12  AM-COUNTY-PARISH                  PIC X(6).
  2613
  2614     12  AM-NAME                           PIC X(30).
  2615     12  AM-PERSON                         PIC X(30).
  2616     12  AM-ADDRS                          PIC X(30).
  2617     12  AM-CITY.
  2618         16  AM-ADDR-CITY                  PIC X(28).
  2619         16  AM-ADDR-STATE                 PIC XX.
  2620     12  AM-ZIP.
  2621         16  AM-ZIP-PRIME.
  2622             20  AM-ZIP-PRI-1ST            PIC X.
  2623                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  47
* NSRASBL.cbl
  2624             20  FILLER                    PIC X(4).
  2625         16  AM-ZIP-PLUS4                  PIC X(4).
  2626     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2627         16  AM-CAN-POSTAL-1               PIC XXX.
  2628         16  AM-CAN-POSTAL-2               PIC XXX.
  2629         16  FILLER                        PIC XXX.
  2630     12  AM-TEL-NO.
  2631         16  AM-AREA-CODE                  PIC 999.
  2632         16  AM-TEL-PRE                    PIC 999.
  2633         16  AM-TEL-NBR                    PIC 9(4).
  2634     12  AM-TEL-LOC                        PIC X.
  2635         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2636         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2637
  2638     12  AM-COMM-STRUCTURE.
  2639         16  AM-DEFN-1.
  2640             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2641                 24  AM-AGT.
  2642                     28  AM-AGT-PREFIX     PIC X(4).
  2643                     28  AM-AGT-PRIME      PIC X(6).
  2644                 24  AM-COM-TYP            PIC X.
  2645                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2646                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2647                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2648                 24  AM-RECALC-LV-INDIC    PIC X.
  2649                 24  AM-RETRO-LV-INDIC     PIC X.
  2650                 24  AM-GL-CODES           PIC X.
  2651                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2652                 24  FILLER                PIC X(01).
  2653         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2654             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2655                 24  FILLER                PIC X(11).
  2656                 24  AM-L-COMA             PIC XXX.
  2657                 24  AM-J-COMA             PIC XXX.
  2658                 24  AM-A-COMA             PIC XXX.
  2659                 24  FILLER                PIC X(6).
  2660
  2661     12  AM-COMM-CHANGE-STATUS             PIC X.
  2662         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2663
  2664     12  AM-CSR-CODE                       PIC X(4).
  2665
  2666     12  AM-BILLING-STATUS                 PIC X.
  2667         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2668         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2669     12  AM-AUTO-REFUND-SW                 PIC X.
  2670         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2671         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2672     12  AM-GPCD                           PIC 99.
  2673     12  AM-IG                             PIC X.
  2674         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2675         88  AM-HAS-GROUP                     VALUE '2'.
  2676     12  AM-STATUS                         PIC X.
  2677         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2678         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2679         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2680         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2681         88  AM-ACCOUNT-FROZEN                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  48
* NSRASBL.cbl
  2682         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2683         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2684         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2685         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2686         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2687     12  AM-REMIT-TO                       PIC 99.
  2688     12  AM-ID-NO                          PIC X(11).
  2689
  2690     12  AM-CAL-TABLE                      PIC XX.
  2691     12  AM-LF-DEVIATION                   PIC XXX.
  2692     12  AM-AH-DEVIATION                   PIC XXX.
  2693     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2694     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2695     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2696     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2697     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2698     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2699
  2700     12  AM-USER-FIELDS.
  2701         16  AM-FLD-1                      PIC XX.
  2702         16  AM-FLD-2                      PIC XX.
  2703         16  AM-FLD-3                      PIC XX.
  2704         16  AM-FLD-4                      PIC XX.
  2705         16  AM-FLD-5                      PIC XX.
  2706
  2707     12  AM-1ST-PROD-DATE.
  2708         16  AM-1ST-PROD-YR                PIC XX.
  2709         16  AM-1ST-PROD-MO                PIC XX.
  2710         16  AM-1ST-PROD-DA                PIC XX.
  2711     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2712     12  AM-CERTS-PURGED-DATE.
  2713         16  AM-PUR-YR                     PIC XX.
  2714         16  AM-PUR-MO                     PIC XX.
  2715         16  AM-PUR-DA                     PIC XX.
  2716     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2717     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2718     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2719     12  AM-INACTIVE-DATE.
  2720         16  AM-INA-MO                     PIC 99.
  2721         16  AM-INA-DA                     PIC 99.
  2722         16  AM-INA-YR                     PIC 99.
  2723     12  AM-AR-HI-CERT-DATE                PIC XX.
  2724
  2725     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2726     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2727
  2728     12  AM-OB-PAYMENT-MODE                PIC X.
  2729         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2730         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2731         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2732         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2733
  2734     12  AM-AH-ONLY-INDICATOR              PIC X.
  2735         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2736         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2737
  2738     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2739
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  49
* NSRASBL.cbl
  2740     12  AM-OVER-SHORT.
  2741         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2742         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2743
  2744     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2745     12  AM-DCC-CLP-STATE                  PIC XX.
  2746
  2747     12  AM-RECALC-COMM                    PIC X.
  2748     12  AM-RECALC-REIN                    PIC X.
  2749
  2750     12  AM-REI-TABLE                      PIC XXX.
  2751     12  AM-REI-ET-LF                      PIC X.
  2752     12  AM-REI-ET-AH                      PIC X.
  2753     12  AM-REI-PE-LF                      PIC X.
  2754     12  AM-REI-PE-AH                      PIC X.
  2755     12  AM-REI-PRT-ST                     PIC X.
  2756     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2757     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2758     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2759     12  AM-REI-GROUP-A                    PIC X(6).
  2760     12  AM-REI-MORT                       PIC X(4).
  2761     12  AM-REI-PRT-OW                     PIC X.
  2762     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2763     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2764     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2765     12  AM-REI-GROUP-B                    PIC X(6).
  2766
  2767     12  AM-TRUST-TYPE                     PIC X(2).
  2768
  2769     12  AM-EMPLOYER-STMT-USED             PIC X.
  2770     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2771
  2772     12  AM-STD-AH-TYPE                    PIC XX.
  2773     12  AM-EARN-METHODS.
  2774         16  AM-EARN-METHOD-R              PIC X.
  2775             88 AM-REF-RL-R78                 VALUE 'R'.
  2776             88 AM-REF-RL-PR                  VALUE 'P'.
  2777             88 AM-REF-RL-MEAN                VALUE 'M'.
  2778             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2779         16  AM-EARN-METHOD-L              PIC X.
  2780             88 AM-REF-LL-R78                 VALUE 'R'.
  2781             88 AM-REF-LL-PR                  VALUE 'P'.
  2782             88 AM-REF-LL-MEAN                VALUE 'M'.
  2783             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2784         16  AM-EARN-METHOD-A              PIC X.
  2785             88 AM-REF-AH-R78                 VALUE 'R'.
  2786             88 AM-REF-AH-PR                  VALUE 'P'.
  2787             88 AM-REF-AH-MEAN                VALUE 'M'.
  2788             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2789             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2790             88 AM-REF-AH-NET                 VALUE 'N'.
  2791
  2792     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2793     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2794     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2795
  2796     12  AM-RET-Y-N                        PIC X.
  2797     12  AM-RET-P-E                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  50
* NSRASBL.cbl
  2798     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2799     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2800     12  AM-RET-GRP                        PIC X(6).
  2801     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2802         16  AM-POOL-PRIME                 PIC XXX.
  2803         16  AM-POOL-SUB                   PIC XXX.
  2804     12  AM-RETRO-EARNINGS.
  2805         16  AM-RET-EARN-R                 PIC X.
  2806         16  AM-RET-EARN-L                 PIC X.
  2807         16  AM-RET-EARN-A                 PIC X.
  2808     12  AM-RET-ST-TAX-USE                 PIC X.
  2809         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2810         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2811     12  AM-RETRO-BEG-EARNINGS.
  2812         16  AM-RET-BEG-EARN-R             PIC X.
  2813         16  AM-RET-BEG-EARN-L             PIC X.
  2814         16  AM-RET-BEG-EARN-A             PIC X.
  2815     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2816     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2817
  2818     12  AM-USER-SELECT-OPTIONS.
  2819         16  AM-USER-SELECT-1              PIC X(10).
  2820         16  AM-USER-SELECT-2              PIC X(10).
  2821         16  AM-USER-SELECT-3              PIC X(10).
  2822         16  AM-USER-SELECT-4              PIC X(10).
  2823         16  AM-USER-SELECT-5              PIC X(10).
  2824
  2825     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2826
  2827     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2828
  2829     12  AM-RPT045A-SWITCH                 PIC X.
  2830         88  RPT045A-OFF                   VALUE 'N'.
  2831
  2832     12  AM-INSURANCE-LIMITS.
  2833         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2834         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2835
  2836     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2837         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2838
  2839     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2840         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2841         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2842
  2843     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2844
  2845     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2846     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2847     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2848     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2849     12  AM-DCC-UEF-STATE                  PIC XX.
  2850     12  FILLER                            PIC XXX.
  2851     12  AM-REPORT-CODE-3                  PIC X(10).
  2852*    12  FILLER                            PIC X(22).
  2853
  2854     12  AM-RESERVE-DATE.
  2855         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  51
* NSRASBL.cbl
  2856         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2857         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2858
  2859     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2860     12  AM-NOTIFICATION-TYPES.
  2861         16  AM-NOTIF-OF-LETTERS           PIC X.
  2862         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2863         16  AM-NOTIF-OF-REPORTS           PIC X.
  2864         16  AM-NOTIF-OF-STATUS            PIC X.
  2865
  2866     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2867         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2868         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2869         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2870         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2871
  2872     12  AM-BENEFIT-CONTROLS.
  2873         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2874             20  AM-BENEFIT-CODE           PIC XX.
  2875             20  AM-BENEFIT-TYPE           PIC X.
  2876             20  AM-BENEFIT-REVISION       PIC XXX.
  2877             20  AM-BENEFIT-REM-TERM       PIC X.
  2878             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2879             20  FILLER                    PIC XX.
  2880         16  FILLER                        PIC X(80).
  2881
  2882     12  AM-TRANSFER-DATA.
  2883         16  AM-TRANSFERRED-FROM.
  2884             20  AM-TRNFROM-CARRIER        PIC X.
  2885             20  AM-TRNFROM-GROUPING.
  2886                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2887                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2888             20  AM-TRNFROM-STATE          PIC XX.
  2889             20  AM-TRNFROM-ACCOUNT.
  2890                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2891                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2892             20  AM-TRNFROM-DTE            PIC XX.
  2893         16  AM-TRANSFERRED-TO.
  2894             20  AM-TRNTO-CARRIER          PIC X.
  2895             20  AM-TRNTO-GROUPING.
  2896                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2897                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2898             20  AM-TRNTO-STATE            PIC XX.
  2899             20  AM-TRNTO-ACCOUNT.
  2900                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2901                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2902             20  AM-TRNTO-DTE              PIC XX.
  2903         16  FILLER                        PIC X(10).
  2904
  2905     12  AM-SAVED-REMIT-TO                 PIC 99.
  2906
  2907     12  AM-COMM-STRUCTURE-SAVED.
  2908         16  AM-DEFN-1-SAVED.
  2909             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2910                 24  AM-AGT-SV             PIC X(10).
  2911                 24  AM-COM-TYP-SV         PIC X.
  2912                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2913                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  52
* NSRASBL.cbl
  2914                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2915                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2916                 24  FILLER                PIC X.
  2917                 24  AM-GL-CODES-SV        PIC X.
  2918                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2919                 24  FILLER                PIC X.
  2920         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2921             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2922                 24  FILLER                PIC X(11).
  2923                 24  AM-L-COMA-SV          PIC XXX.
  2924                 24  AM-J-COMA-SV          PIC XXX.
  2925                 24  AM-A-COMA-SV          PIC XXX.
  2926                 24  FILLER                PIC X(6).
  2927
  2928     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2929         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2930            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2931            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2932            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2933
  2934     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2935     12  FILLER                            PIC X(120).
  2936
  2937     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2938         16  AM-CONTROL-NAME               PIC X(30).
  2939         16  AM-EXECUTIVE-ONE.
  2940             20  AM-EXEC1-NAME             PIC X(15).
  2941             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2942                                                          COMP-3.
  2943             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2944                                                          COMP-3.
  2945         16  AM-EXECUTIVE-TWO.
  2946             20  AM-EXEC2-NAME             PIC X(15).
  2947             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2948                                                          COMP-3.
  2949             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2950                                                          COMP-3.
  2951
  2952     12  AM-RETRO-ADDITIONAL-DATA.
  2953         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2954         16  AM-RETRO-PREM-P-E             PIC X.
  2955         16  AM-RETRO-CLMS-P-I             PIC X.
  2956         16  AM-RETRO-RET-BRACKET-LF.
  2957             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2958                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2959                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2960             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2961                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2962                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2963             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2964                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2965                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2966         16  AM-RETRO-RET-BRACKET-AH.
  2967             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2968                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2969                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2970                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2971             20  AM-RETRO-RET-BASIS-AH     PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  53
* NSRASBL.cbl
  2972                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2973                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2974             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2975                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2976                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2977
  2978     12  AM-COMMENTS.
  2979         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2980
  2981     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2982         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2983         16  AM-FLI-BILLING-CODE           PIC X.
  2984         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2985         16  AM-FLI-UNITED-IDENT           PIC X.
  2986         16  AM-FLI-INTEREST-LOST-DATA.
  2987             20  AM-FLI-BANK-NO            PIC X(5).
  2988             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2989             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2990             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2991         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2992             20  AM-FLI-AGT                PIC X(9).
  2993             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2994             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2995         16  FILLER                        PIC X(102).
  2996
  2997     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2998         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2999             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3000             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3001             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3002             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3003             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3004         16  FILLER                          PIC X(10).
  3005******************************************************************
  3006*                                COPY ELCTEXT.
  3007******************************************************************
  3008*                                                                *
  3009*                                                                *
  3010*                            ELCTEXT.                            *
  3011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3012*                            VMOD=2.008                          *
  3013*                                                                *
  3014*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3015*                                     FORM LETTERS,              *
  3016*                                     CERT FORM DISPLAY.
  3017*                                                                *
  3018*   FILE TYPE = VSAM,KSDS                                        *
  3019*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3020*                                                                *
  3021*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3022*       ALTERNATE INDEX = NONE                                   *
  3023*                                                                *
  3024*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  3025*       ALTERNATE INDEX = NONE                                   *
  3026*                                                                *
  3027*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3028*       ALTERNATE INDEX = NONE                                   *
  3029*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  54
* NSRASBL.cbl
  3030*   LOG = NO                                                     *
  3031*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3032******************************************************************
  3033 01  TEXT-FILES.
  3034     12  TEXT-FILE-ID                PIC XX.
  3035         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3036         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3037         88  HELP-FILE-TEXT             VALUE 'TH'.
  3038
  3039     12  TX-CONTROL-PRIMARY.
  3040         16  TX-COMPANY-CD           PIC X.
  3041             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3042         16  TX-ACCESS-CD-GENL       PIC X(12).
  3043
  3044         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3045             20  TX-LETTER-NO        PIC X(4).
  3046             20  FILLER              PIC X(8).
  3047
  3048         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3049             20  TX-FORM-NO          PIC X(12).
  3050
  3051         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3052             20  TX-HELP-TYPE        PIC X.
  3053                 88  HELP-FOR-GENERAL   VALUE ' '.
  3054                 88  HELP-BY-SCREEN     VALUE 'S'.
  3055                 88  HELP-BY-ERROR      VALUE 'E'.
  3056             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3057                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3058             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3059                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3060             20  FILLER              PIC X(4).
  3061
  3062         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3063
  3064     12  TX-PROCESS-CONTROL          PIC XX.
  3065         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3066
  3067     12  TX-TEXT-LINE                PIC X(70).
  3068
  3069     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3070         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3071         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3072         88  TX-VALID-FORM-SQUEEZE-VALUE
  3073                                        VALUE 'Y' ' '.
  3074
  3075     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3076         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3077         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3078         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3079         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3080         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3081         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3082         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3083                                              'K' 'N' ' '
  3084                                              'Z'.
  3085
  3086     12  TX-ARCHIVE-SW               PIC X.
  3087         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  55
* NSRASBL.cbl
  3088         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3089         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3090
  3091     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3092     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3093
  3094     12  TX-BSR-CODE                 PIC X.
  3095         88  TX-BSR-LETTER              VALUE 'B'.
  3096         88  TX-NON-BSR-LETTER          VALUE ' '.
  3097
  3098     12  FILLER                      PIC X.
  3099*****************************************************************
  3100*                                COPY ELCCNTL.
  3101******************************************************************
  3102*                                                                *
  3103*                                                                *
  3104*                            ELCCNTL.                            *
  3105*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3106*                            VMOD=2.059                          *
  3107*                                                                *
  3108*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3109*                                                                *
  3110*   FILE TYPE = VSAM,KSDS                                        *
  3111*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3112*                                                                *
  3113*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3114*       ALTERNATE INDEX = NONE                                   *
  3115*                                                                *
  3116*   LOG = YES                                                    *
  3117*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3118******************************************************************
  3119*                   C H A N G E   L O G
  3120*
  3121* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3122*-----------------------------------------------------------------
  3123*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3124* EFFECTIVE    NUMBER
  3125*-----------------------------------------------------------------
  3126* 082503                   PEMA  ADD BENEFIT GROUP
  3127* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3128* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3129* 092705    2005050300006  PEMA  ADD SPP LEASES
  3130* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3131* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3132* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3133* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3134* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3135* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3136* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3137* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3138* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3139* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3140******************************************************************
  3141*
  3142 01  CONTROL-FILE.
  3143     12  CF-RECORD-ID                       PIC XX.
  3144         88  VALID-CF-ID                        VALUE 'CF'.
  3145
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  56
* NSRASBL.cbl
  3146     12  CF-CONTROL-PRIMARY.
  3147         16  CF-COMPANY-ID                  PIC XXX.
  3148         16  CF-RECORD-TYPE                 PIC X.
  3149             88  CF-COMPANY-MASTER              VALUE '1'.
  3150             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3151             88  CF-STATE-MASTER                VALUE '3'.
  3152             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3153             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3154             88  CF-CARRIER-MASTER              VALUE '6'.
  3155             88  CF-MORTALITY-MASTER            VALUE '7'.
  3156             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3157             88  CF-TERMINAL-MASTER             VALUE '9'.
  3158             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3159             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3160             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3161             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3162             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3163             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3164             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3165             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3166             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3167         16  CF-ACCESS-CD-GENL              PIC X(4).
  3168         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3169             20  CF-PROCESSOR               PIC X(4).
  3170         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3171             20  CF-STATE-CODE              PIC XX.
  3172             20  FILLER                     PIC XX.
  3173         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3174             20  FILLER                     PIC XX.
  3175             20  CF-HI-BEN-IN-REC           PIC XX.
  3176         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3177             20  FILLER                     PIC XXX.
  3178             20  CF-CARRIER-CNTL            PIC X.
  3179         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3180             20  FILLER                     PIC XX.
  3181             20  CF-HI-TYPE-IN-REC          PIC 99.
  3182         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3183             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3184                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3185             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3186             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3187         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3188             20  FILLER                     PIC X.
  3189             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3190         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3191             20  FILLER                     PIC XX.
  3192             20  CF-MORTGAGE-PLAN           PIC XX.
  3193         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3194
  3195     12  CF-LAST-MAINT-DT                   PIC XX.
  3196     12  CF-LAST-MAINT-BY                   PIC X(4).
  3197     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3198
  3199     12  CF-RECORD-BODY                     PIC X(728).
  3200
  3201
  3202****************************************************************
  3203*             COMPANY MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  57
* NSRASBL.cbl
  3204****************************************************************
  3205
  3206     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3207         16  CF-COMPANY-ADDRESS.
  3208             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3209             20  CF-CL-IN-CARE-OF           PIC X(30).
  3210             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3211             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3212             20  CF-CL-CITY-STATE           PIC X(30).
  3213             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3214             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3215         16  CF-COMPANY-CD                  PIC X.
  3216         16  CF-COMPANY-PASSWORD            PIC X(8).
  3217         16  CF-SECURITY-OPTION             PIC X.
  3218             88  ALL-SECURITY                   VALUE '1'.
  3219             88  COMPANY-VERIFY                 VALUE '2'.
  3220             88  PROCESSOR-VERIFY               VALUE '3'.
  3221             88  NO-SECURITY                    VALUE '4'.
  3222             88  ALL-BUT-TERM                   VALUE '5'.
  3223         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3224             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3225         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3226             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3227         16  CF-INFORCE-LOCATION            PIC X.
  3228             88  CERTS-ARE-ONLINE               VALUE '1'.
  3229             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3230             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3231         16  CF-LOWER-CASE-LETTERS          PIC X.
  3232         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3233             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3234             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3235             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3236             88  CF-ACCNT-CNTL                  VALUE '3'.
  3237             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3238
  3239         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3240         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3241
  3242         16  CF-LGX-CREDIT-USER             PIC X.
  3243             88  CO-IS-NOT-USER                 VALUE 'N'.
  3244             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3245
  3246         16 CF-CREDIT-CALC-CODES.
  3247             20  CF-CR-REM-TERM-CALC PIC X.
  3248               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3249               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3250               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3251               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3252               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3253               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3254               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3255             20  CF-CR-R78-METHOD           PIC X.
  3256               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3257               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3258
  3259         16  CF-CLAIM-CONTROL-COUNTS.
  3260             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3261                 88  CO-CLM-COUNT-RESET         VALUE +99999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  58
* NSRASBL.cbl
  3262
  3263             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3264                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3265
  3266             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3267                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3268
  3269             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3270                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3271
  3272         16  CF-CURRENT-MONTH-END           PIC XX.
  3273
  3274         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3275             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3276             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3277             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3278             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3279                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3280                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3281             20  CF-CO-PREM-REJECT-SW       PIC X.
  3282                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3283                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3284             20  CF-CO-REF-REJECT-SW        PIC X.
  3285                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3286                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3287
  3288         16  CF-CO-REPORTING-DT             PIC XX.
  3289         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3290         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3291           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3292           88  CF-CO-MONTH-END                  VALUE '1'.
  3293
  3294         16  CF-LGX-CLAIM-USER              PIC X.
  3295             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3296             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3297
  3298         16  CF-CREDIT-EDIT-CONTROLS.
  3299             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3300             20  CF-MIN-AGE                 PIC 99.
  3301             20  CF-DEFAULT-AGE             PIC 99.
  3302             20  CF-MIN-TERM                PIC S999      COMP-3.
  3303             20  CF-MAX-TERM                PIC S999      COMP-3.
  3304             20  CF-DEFAULT-SEX             PIC X.
  3305             20  CF-JOINT-AGE-INPUT         PIC X.
  3306                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3307             20  CF-BIRTH-DATE-INPUT        PIC X.
  3308                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3309             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3310                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3311                 88  CF-ZERO-CARRIER            VALUE '1'.
  3312                 88  CF-ZERO-GROUPING           VALUE '2'.
  3313                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3314             20  CF-EDIT-SW                 PIC X.
  3315                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3316             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3317             20  CF-CR-PR-METHOD            PIC X.
  3318               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3319               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  59
* NSRASBL.cbl
  3320             20  FILLER                     PIC X.
  3321
  3322         16  CF-CREDIT-MISC-CONTROLS.
  3323             20  CF-REIN-TABLE-SW           PIC X.
  3324                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3325             20  CF-COMP-TABLE-SW           PIC X.
  3326                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3327             20  CF-EXPERIENCE-RETENTION-AGE
  3328                                            PIC S9        COMP-3.
  3329             20  CF-CONVERSION-DT           PIC XX.
  3330             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3331             20  CF-RUN-FREQUENCY-SW        PIC X.
  3332                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3333                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3334
  3335             20  CF-CR-CHECK-NO-CONTROL.
  3336                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3337                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3338                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3339                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3340                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3341                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3342
  3343                 24  CF-CR-CHECK-COUNT       REDEFINES
  3344                     CF-CR-CHECK-COUNTER      PIC X(4).
  3345
  3346                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3347                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3348
  3349                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3350                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3351                 24  CF-MAIL-PROCESSING       PIC X.
  3352                     88  MAIL-PROCESSING          VALUE 'Y'.
  3353
  3354         16  CF-MISC-SYSTEM-CONTROL.
  3355             20  CF-SYSTEM-C                 PIC X.
  3356                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3357             20  CF-SYSTEM-D                 PIC X.
  3358                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3359             20  CF-SOC-SEC-NO-SW            PIC X.
  3360                 88  SOC-SEC-NO-USED             VALUE '1'.
  3361             20  CF-MEMBER-NO-SW             PIC X.
  3362                 88  MEMBER-NO-USED              VALUE '1'.
  3363             20  CF-TAX-ID-NUMBER            PIC X(11).
  3364             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3365             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3366                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3367                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3368                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3369                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3370             20  CF-SYSTEM-E                 PIC X.
  3371                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3372
  3373         16  CF-LGX-LIFE-USER               PIC X.
  3374             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3375             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3376
  3377         16  CF-CR-MONTH-END-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  60
* NSRASBL.cbl
  3378
  3379         16  CF-FILE-MAINT-DATES.
  3380             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3381                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3382             20  CF-LAST-BATCH       REDEFINES
  3383                 CF-LAST-BATCH-NO               PIC X(4).
  3384             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3385             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3386             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3387             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3388             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3389             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3390             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3391             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3392             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3393             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3394
  3395         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3396         16  FILLER                         PIC X.
  3397
  3398         16  CF-ALT-MORT-CODE               PIC X(4).
  3399         16  CF-MEMBER-CAPTION              PIC X(10).
  3400
  3401         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3402             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3403             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3404             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3405             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3406             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3407
  3408         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3409
  3410         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3411         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3412         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3413         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3414
  3415         16  CF-AH-OVERRIDE-L1              PIC X.
  3416         16  CF-AH-OVERRIDE-L2              PIC XX.
  3417         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3418         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3419
  3420         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3421         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3422
  3423         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3424         16  CF-AR-LAST-EL860-DT            PIC XX.
  3425         16  CF-MP-MONTH-END-DT             PIC XX.
  3426
  3427         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3428         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3429             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3430
  3431         16  CF-AR-MONTH-END-DT             PIC XX.
  3432
  3433         16  CF-CRDTCRD-USER                PIC X.
  3434             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3435             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  61
* NSRASBL.cbl
  3436
  3437         16  CF-CC-MONTH-END-DT             PIC XX.
  3438
  3439         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3440
  3441         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3442             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3443             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3444             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3445         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3446         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3447         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3448         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3449             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3450             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3451         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3452         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3453         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3454             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3455         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3456
  3457         16  CF-CL-ZIP-CODE.
  3458             20  CF-CL-ZIP-PRIME.
  3459                 24  CF-CL-ZIP-1ST          PIC X.
  3460                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3461                 24  FILLER                 PIC X(4).
  3462             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3463         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3464             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3465             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3466             20  FILLER                     PIC XXX.
  3467
  3468         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3469         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3470         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3471         16  CF-CO-OPTION-START-DATE        PIC XX.
  3472         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3473           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3474                                                      '3' '4'.
  3475           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3476           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3477           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3478           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3479           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3480           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3481
  3482         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3483
  3484         16  CF-PAYMENT-APPROVAL-LEVELS.
  3485             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3486             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3487             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3488             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3489             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3490             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3491
  3492         16  CF-END-USER-REPORTING-USER     PIC X.
  3493             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  62
* NSRASBL.cbl
  3494             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3495
  3496         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3497             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3498             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3499
  3500         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3501
  3502         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3503         16  FILLER                         PIC X.
  3504
  3505         16  CF-CREDIT-ARCHIVE-CNTL.
  3506             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3507             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3508             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3509
  3510         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3511
  3512         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3513             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3514             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3515
  3516         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3517             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3518             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3519
  3520         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3521
  3522         16  CF-CO-ACH-ID-CODE              PIC  X.
  3523             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3524             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3525             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3526         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3527         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3528         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3529         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3530         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3531         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3532         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3533         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3534         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3535                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3536         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3537                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3538
  3539         16  CF-CO-OVER-SHORT.
  3540             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3541             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3542
  3543*         16  FILLER                         PIC X(102).
  3544         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3545             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3546             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3547
  3548         16  CF-AH-APPROVAL-DAYS.
  3549             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3550             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3551             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  63
* NSRASBL.cbl
  3552             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3553
  3554         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3555
  3556         16  CF-APPROV-LEV-5.
  3557             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3558             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3559             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3560
  3561         16  FILLER                         PIC X(68).
  3562****************************************************************
  3563*             PROCESSOR/USER RECORD                            *
  3564****************************************************************
  3565
  3566     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3567         16  CF-PROCESSOR-NAME              PIC X(30).
  3568         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3569         16  CF-PROCESSOR-TITLE             PIC X(26).
  3570         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3571                 88  MESSAGE-YES                VALUE 'Y'.
  3572                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3573
  3574*****************************************************
  3575****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3576****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3577****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3578****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3579*****************************************************
  3580
  3581         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3582             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3583             20  CF-APPLICATION-FORCE       PIC X.
  3584             20  CF-INDIVIDUAL-APP.
  3585                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3586                     28  CF-BROWSE-APP      PIC X.
  3587                     28  CF-UPDATE-APP      PIC X.
  3588
  3589         16  CF-CURRENT-TERM-ON             PIC X(4).
  3590         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3591             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3592             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3593             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3594             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3595             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3596             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3597             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3598         16  CF-PROCESSOR-CARRIER           PIC X.
  3599             88  NO-CARRIER-SECURITY            VALUE ' '.
  3600         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3601             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3602         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3603             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3604         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3605             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3606
  3607         16  CF-PROC-SYS-ACCESS-SW.
  3608             20  CF-PROC-CREDIT-CLAIMS-SW.
  3609                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  64
* NSRASBL.cbl
  3610                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3611                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3612                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3613             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3614                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3615                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3616             20  CF-PROC-LIFE-GNRLDGR-SW.
  3617                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3618                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3619                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3620                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3621             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3622                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3623                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3624         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3625             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3626             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3627         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3628
  3629         16  CF-APPROVAL-LEVEL                  PIC X.
  3630             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3631             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3632             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3633             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3634             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3635
  3636         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3637
  3638         16  CF-LANGUAGE-TYPE                   PIC X.
  3639             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3640             88  CF-LANG-IS-FR                      VALUE 'F'.
  3641
  3642         16  CF-CSR-IND                         PIC X.
  3643         16  FILLER                             PIC X(239).
  3644
  3645****************************************************************
  3646*             PROCESSOR/REMINDERS RECORD                       *
  3647****************************************************************
  3648
  3649     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3650         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3651             20  CF-START-REMIND-DT         PIC XX.
  3652             20  CF-END-REMIND-DT           PIC XX.
  3653             20  CF-REMINDER-TEXT           PIC X(50).
  3654         16  FILLER                         PIC X(296).
  3655
  3656
  3657****************************************************************
  3658*             STATE MASTER RECORD                              *
  3659****************************************************************
  3660
  3661     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3662         16  CF-STATE-ABBREVIATION          PIC XX.
  3663         16  CF-STATE-NAME                  PIC X(25).
  3664         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3665         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3666             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3667             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  65
* NSRASBL.cbl
  3668             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3669             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3670                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3671                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3672             20  CF-ST-PREM-REJECT-SW       PIC X.
  3673                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3674                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3675             20  CF-ST-REF-REJECT-SW        PIC X.
  3676                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3677                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3678         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3679         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3680         16  CF-ST-REFUND-RULES.
  3681             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3682             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3683             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3684         16  CF-ST-FST-PMT-EXTENSION.
  3685             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3686             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3687                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3688                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3689                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3690                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3691         16  CF-ST-STATE-CALL.
  3692             20  CF-ST-CALL-UNEARNED        PIC X.
  3693             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3694             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3695         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3696             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3697             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3698         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3699         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3700         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3701         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3702         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3703         16  FILLER                         PIC X.
  3704         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3705             20  CF-ST-BENEFIT-CD           PIC XX.
  3706             20  CF-ST-BENEFIT-KIND         PIC X.
  3707                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3708                 88  CF-ST-AH-KIND              VALUE 'A'.
  3709             20  CF-ST-REM-TERM-CALC        PIC X.
  3710                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3711                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3712                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3713                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3714                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3715                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3716                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3717                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3718
  3719             20  CF-ST-REFUND-CALC          PIC X.
  3720                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3721                 88  ST-REFD-BY-R78             VALUE '1'.
  3722                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3723                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3724                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3725                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  66
* NSRASBL.cbl
  3726                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3727                 88  ST-REFD-UTAH               VALUE '7'.
  3728                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3729                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3730                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3731
  3732             20  CF-ST-EARNING-CALC         PIC X.
  3733                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3734                 88  ST-EARN-BY-R78             VALUE '1'.
  3735                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3736                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3737                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3738                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3739                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3740                 88  ST-EARN-MEAN               VALUE '8'.
  3741                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3742
  3743             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3744                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3745                 88  ST-OVRD-BY-R78             VALUE '1'.
  3746                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3747                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3748                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3749                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3750                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3751                 88  ST-OVRD-MEAN               VALUE '8'.
  3752                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3753             20  cf-st-extra-periods        pic 9.
  3754*            20  FILLER                     PIC X.
  3755
  3756         16  CF-ST-COMMISSION-CAPS.
  3757             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3758             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3759             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3760             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3761         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3762                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3763
  3764         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3765
  3766         16  CF-ST-STATUTORY-INTEREST.
  3767             20  CF-ST-STAT-DATE-FROM       PIC X.
  3768                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3769                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3770             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3771             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3772             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3773             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3774             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3775
  3776         16  CF-ST-OVER-SHORT.
  3777             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3778             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3779
  3780         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3781
  3782         16  CF-ST-RT-CALC                  PIC X.
  3783
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  67
* NSRASBL.cbl
  3784         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3785         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3786         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3787         16  CF-ST-RF-LR-CALC               PIC X.
  3788         16  CF-ST-RF-LL-CALC               PIC X.
  3789         16  CF-ST-RF-LN-CALC               PIC X.
  3790         16  CF-ST-RF-AH-CALC               PIC X.
  3791         16  CF-ST-RF-CP-CALC               PIC X.
  3792*        16  FILLER                         PIC X(206).
  3793*CIDMOD         16  FILLER                         PIC X(192).
  3794         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3795             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3796         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3797         16  CF-ST-VFY-2ND-BENE             PIC X.
  3798         16  CF-ST-CAUSAL-STATE             PIC X.
  3799         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3800         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3801         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3802             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3803         16  CF-ST-NET-ONLY-STATE           PIC X.
  3804             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3805         16  FILLER                         PIC X(181).
  3806
  3807****************************************************************
  3808*             BENEFIT MASTER RECORD                            *
  3809****************************************************************
  3810
  3811     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3812         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3813             20  CF-BENEFIT-CODE            PIC XX.
  3814             20  CF-BENEFIT-NUMERIC  REDEFINES
  3815                 CF-BENEFIT-CODE            PIC XX.
  3816             20  CF-BENEFIT-ALPHA           PIC XXX.
  3817             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3818             20  CF-BENEFIT-COMMENT         PIC X(10).
  3819
  3820             20  CF-LF-COVERAGE-TYPE        PIC X.
  3821                 88  CF-REDUCING                VALUE 'R'.
  3822                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3823
  3824             20  CF-SPECIAL-CALC-CD         PIC X.
  3825                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3826                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3827                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3828                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3829                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3830                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3831                 88  CF-FARM-PLAN               VALUE 'F'.
  3832                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3833                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3834                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3835                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3836                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3837                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3838                 88  CF-PRUDENTIAL              VALUE 'P'.
  3839                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3840                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3841                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  68
* NSRASBL.cbl
  3842                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3843                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3844                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3845
  3846             20  CF-JOINT-INDICATOR         PIC X.
  3847                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3848
  3849*            20  FILLER                     PIC X(12).
  3850             20  cf-maximum-benefits        pic s999 comp-3.
  3851             20  FILLER                     PIC X(09).
  3852             20  CF-BENEFIT-CATEGORY        PIC X.
  3853             20  CF-LOAN-TYPE               PIC X(8).
  3854
  3855             20  CF-CO-REM-TERM-CALC        PIC X.
  3856                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3857                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3858                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3859                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3860                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3861
  3862             20  CF-CO-EARNINGS-CALC        PIC X.
  3863                 88  CO-EARN-BY-R78             VALUE '1'.
  3864                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3865                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3866                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3867                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3868                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3869                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3870                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3871
  3872             20  CF-CO-REFUND-CALC          PIC X.
  3873                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3874                 88  CO-REFD-BY-R78             VALUE '1'.
  3875                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3876                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3877                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3878                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3879                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3880                 88  CO-REFD-MEAN               VALUE '8'.
  3881                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3882                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3883                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3884
  3885             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3886                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3887                 88  CO-OVRD-BY-R78             VALUE '1'.
  3888                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3889                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3890                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3891                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3892                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3893                 88  CO-OVRD-MEAN               VALUE '8'.
  3894                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3895
  3896             20  CF-CO-BEN-I-G-CD           PIC X.
  3897                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3898                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3899                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  69
* NSRASBL.cbl
  3900
  3901         16  FILLER                         PIC X(304).
  3902
  3903
  3904****************************************************************
  3905*             CARRIER MASTER RECORD                            *
  3906****************************************************************
  3907
  3908     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3909         16  CF-ADDRESS-DATA.
  3910             20  CF-MAIL-TO-NAME            PIC X(30).
  3911             20  CF-IN-CARE-OF              PIC X(30).
  3912             20  CF-ADDRESS-LINE-1          PIC X(30).
  3913             20  CF-ADDRESS-LINE-2          PIC X(30).
  3914             20  CF-CITY-STATE              PIC X(30).
  3915             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3916             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3917
  3918         16  CF-CLAIM-NO-CONTROL.
  3919             20  CF-CLAIM-NO-METHOD         PIC X.
  3920                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3921                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3922                 88  CLAIM-NO-SEQ               VALUE '3'.
  3923                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3924             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3925                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3926                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3927                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3928
  3929         16  CF-CHECK-NO-CONTROL.
  3930             20  CF-CHECK-NO-METHOD         PIC X.
  3931                 88  CHECK-NO-MANUAL            VALUE '1'.
  3932                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3933                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3934                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3935             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3936                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3937
  3938         16  CF-DOMICILE-STATE              PIC XX.
  3939
  3940         16  CF-EXPENSE-CONTROLS.
  3941             20  CF-EXPENSE-METHOD          PIC X.
  3942                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3943                 88  DOLLARS-PER-PMT            VALUE '2'.
  3944                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3945                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3946             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3947             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3948
  3949         16  CF-CORRESPONDENCE-CONTROL.
  3950             20  CF-LETTER-RESEND-OPT       PIC X.
  3951                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3952                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3953             20  FILLER                     PIC X(4).
  3954
  3955         16  CF-RESERVE-CONTROLS.
  3956             20  CF-MANUAL-SW               PIC X.
  3957                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  70
* NSRASBL.cbl
  3958             20  CF-FUTURE-SW               PIC X.
  3959                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3960             20  CF-PTC-SW                  PIC X.
  3961                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3962             20  CF-IBNR-SW                 PIC X.
  3963                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3964             20  CF-PTC-LF-SW               PIC X.
  3965                 88  CF-LF-PTC-USED             VALUE '1'.
  3966             20  CF-CDT-ACCESS-METHOD       PIC X.
  3967                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3968                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3969                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3970             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3971
  3972         16  CF-CLAIM-CALC-METHOD           PIC X.
  3973             88  360-PLUS-MONTHS                VALUE '1'.
  3974             88  365-PLUS-MONTHS                VALUE '2'.
  3975             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3976             88  360-DAILY                      VALUE '4'.
  3977             88  365-DAILY                      VALUE '5'.
  3978
  3979         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3980         16  FILLER                         PIC X(11).
  3981
  3982         16  CF-LIMIT-AMOUNTS.
  3983             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3984             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3985             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3986             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3987             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3988             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3989             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3990             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3991             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3992             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3993
  3994         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3995         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3996         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3997
  3998         16  CF-ZIP-CODE.
  3999             20  CF-ZIP-PRIME.
  4000                 24  CF-ZIP-1ST             PIC X.
  4001                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4002                 24  FILLER                 PIC X(4).
  4003             20  CF-ZIP-PLUS4               PIC X(4).
  4004         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4005             20  CF-CAN-POSTAL-1            PIC XXX.
  4006             20  CF-CAN-POSTAL-2            PIC XXX.
  4007             20  FILLER                     PIC XXX.
  4008
  4009         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4010         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4011         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4012
  4013         16  CF-RATING-SWITCH               PIC X.
  4014             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4015             88  CF-NO-RATING                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  71
* NSRASBL.cbl
  4016
  4017         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4018
  4019         16  CF-CARRIER-OVER-SHORT.
  4020             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4021             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4022
  4023         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4024         16  CF-SECPAY-SWITCH               PIC X.
  4025             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4026             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4027         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4028         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4029         16  FILLER                         PIC X(444).
  4030*        16  FILLER                         PIC X(452).
  4031
  4032
  4033****************************************************************
  4034*             MORTALITY MASTER RECORD                          *
  4035****************************************************************
  4036
  4037     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4038         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4039                                INDEXED BY CF-MORT-NDX.
  4040             20  CF-MORT-TABLE              PIC X(5).
  4041             20  CF-MORT-TABLE-TYPE         PIC X.
  4042                 88  CF-MORT-JOINT              VALUE 'J'.
  4043                 88  CF-MORT-SINGLE             VALUE 'S'.
  4044                 88  CF-MORT-COMBINED           VALUE 'C'.
  4045                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4046                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4047             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4048             20  CF-MORT-AGE-METHOD         PIC XX.
  4049                 88  CF-AGE-LAST                VALUE 'AL'.
  4050                 88  CF-AGE-NEAR                VALUE 'AN'.
  4051             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4052             20  CF-MORT-ADJUSTMENT-DIRECTION
  4053                                            PIC X.
  4054                 88  CF-MINUS                   VALUE '-'.
  4055                 88  CF-PLUS                    VALUE '+'.
  4056             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4057             20  CF-MORT-JOINT-CODE         PIC X.
  4058                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4059             20  CF-MORT-PC-Q               PIC X.
  4060                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4061             20  CF-MORT-TABLE-CODE         PIC X(4).
  4062             20  CF-MORT-COMMENTS           PIC X(15).
  4063             20  FILLER                     PIC X(14).
  4064
  4065         16  FILLER                         PIC X(251).
  4066
  4067
  4068****************************************************************
  4069*             BUSSINESS TYPE MASTER RECORD                     *
  4070****************************************************************
  4071
  4072     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4073* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  72
* NSRASBL.cbl
  4074* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4075* AND RECORD 05 IS TYPES 81-99
  4076         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4077             20  CF-BUSINESS-TITLE          PIC  X(19).
  4078             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4079                                            PIC S9V9(4) COMP-3.
  4080             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4081             20  FILLER                     PIC  X.
  4082         16  FILLER                         PIC  X(248).
  4083
  4084
  4085****************************************************************
  4086*             TERMINAL MASTER RECORD                           *
  4087****************************************************************
  4088
  4089     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4090
  4091         16  CF-COMPANY-TERMINALS.
  4092             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4093                                  PIC X(4).
  4094         16  FILLER               PIC X(248).
  4095
  4096
  4097****************************************************************
  4098*             LIFE EDIT MASTER RECORD                          *
  4099****************************************************************
  4100
  4101     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4102         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4103             20  CF-LIFE-CODE-IN            PIC XX.
  4104             20  CF-LIFE-CODE-OUT           PIC XX.
  4105         16  FILLER                         PIC X(248).
  4106
  4107
  4108****************************************************************
  4109*             AH EDIT MASTER RECORD                            *
  4110****************************************************************
  4111
  4112     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4113         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4114             20  CF-AH-CODE-IN              PIC XXX.
  4115             20  CF-AH-CODE-OUT             PIC XX.
  4116         16  FILLER                         PIC X(248).
  4117
  4118
  4119****************************************************************
  4120*             CREDIBILITY TABLES                               *
  4121****************************************************************
  4122
  4123     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4124         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4125                             INDEXED BY CF-CRDB-NDX.
  4126             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4127             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4128             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4129         16  FILLER                         PIC  X(332).
  4130
  4131
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  73
* NSRASBL.cbl
  4132****************************************************************
  4133*             REPORT CUSTOMIZATION RECORD                      *
  4134****************************************************************
  4135
  4136     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4137         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4138             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4139             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4140             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4141**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4142****       A T-TRANSFER.                                   ****
  4143             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4144
  4145         16  FILLER                         PIC XX.
  4146
  4147         16  CF-CARRIER-CNTL-OPT.
  4148             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4149                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4150                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4151             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4152                                            PIC X.
  4153         16  CF-GROUP-CNTL-OPT.
  4154             20  CF-GROUP-OPT-SEQ           PIC 9.
  4155                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4156                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4157             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4158                                            PIC X(6).
  4159         16  CF-STATE-CNTL-OPT.
  4160             20  CF-STATE-OPT-SEQ           PIC 9.
  4161                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4162                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4163             20  CF-STATE-SELECT OCCURS 3 TIMES
  4164                                            PIC XX.
  4165         16  CF-ACCOUNT-CNTL-OPT.
  4166             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4167                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4168                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4169             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4170                                            PIC X(10).
  4171         16  CF-BUS-TYP-CNTL-OPT.
  4172             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4173                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4174                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4175             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4176                                            PIC XX.
  4177         16  CF-LF-TYP-CNTL-OPT.
  4178             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4179                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4180                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4181             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4182                                            PIC XX.
  4183         16  CF-AH-TYP-CNTL-OPT.
  4184             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4185                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4186                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4187             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4188                                            PIC XX.
  4189         16  CF-REPTCD1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  74
* NSRASBL.cbl
  4190             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4191                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4192                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4193             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4194                                            PIC X(10).
  4195         16  CF-REPTCD2-CNTL-OPT.
  4196             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4197                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4198                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4199             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4200                                            PIC X(10).
  4201         16  CF-USER1-CNTL-OPT.
  4202             20  CF-USER1-OPT-SEQ           PIC 9.
  4203                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4204                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4205             20  CF-USER1-SELECT OCCURS 3 TIMES
  4206                                            PIC X(10).
  4207         16  CF-USER2-CNTL-OPT.
  4208             20  CF-USER2-OPT-SEQ           PIC 9.
  4209                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4210                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4211             20  CF-USER2-SELECT OCCURS 3 TIMES
  4212                                            PIC X(10).
  4213         16  CF-USER3-CNTL-OPT.
  4214             20  CF-USER3-OPT-SEQ           PIC 9.
  4215                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4216                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4217             20  CF-USER3-SELECT OCCURS 3 TIMES
  4218                                            PIC X(10).
  4219         16  CF-USER4-CNTL-OPT.
  4220             20  CF-USER4-OPT-SEQ           PIC 9.
  4221                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4222                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4223             20  CF-USER4-SELECT OCCURS 3 TIMES
  4224                                            PIC X(10).
  4225         16  CF-USER5-CNTL-OPT.
  4226             20  CF-USER5-OPT-SEQ           PIC 9.
  4227                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4228                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4229             20  CF-USER5-SELECT OCCURS 3 TIMES
  4230                                            PIC X(10).
  4231         16  CF-REINS-CNTL-OPT.
  4232             20  CF-REINS-OPT-SEQ           PIC 9.
  4233                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4234                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4235             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4236                 24  CF-REINS-PRIME         PIC XXX.
  4237                 24  CF-REINS-SUB           PIC XXX.
  4238
  4239         16  CF-AGENT-CNTL-OPT.
  4240             20  CF-AGENT-OPT-SEQ           PIC 9.
  4241                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4242                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4243             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4244                                            PIC X(10).
  4245
  4246         16  FILLER                         PIC X(43).
  4247
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  75
* NSRASBL.cbl
  4248         16  CF-LOSS-RATIO-SELECT.
  4249             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4250             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4251         16  CF-ENTRY-DATE-SELECT.
  4252             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4253             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4254         16  CF-EFFECTIVE-DATE-SELECT.
  4255             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4256             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4257
  4258         16  CF-EXCEPTION-LIST-IND          PIC X.
  4259             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4260
  4261         16  FILLER                         PIC X(318).
  4262
  4263****************************************************************
  4264*                  EXCEPTION REPORTING RECORD                  *
  4265****************************************************************
  4266
  4267     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4268         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4269             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4270
  4271         16  CF-COMBINED-LIFE-AH-OPT.
  4272             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4273             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4274             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4275             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4276
  4277         16  CF-LIFE-OPT.
  4278             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4279             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4280             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4281             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4282             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4283             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4284             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4285             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4286             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4287             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4288
  4289         16  CF-AH-OPT.
  4290             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4291             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4292             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4293             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4294             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4295             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4296             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4297             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4298             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4299             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4300
  4301         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4302             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4303             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4304             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4305
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  76
* NSRASBL.cbl
  4306         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4307
  4308         16  FILLER                         PIC X(673).
  4309
  4310
  4311****************************************************************
  4312*             MORTGAGE SYSTEM PLAN RECORD                      *
  4313****************************************************************
  4314
  4315     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4316         16  CF-PLAN-TYPE                   PIC X.
  4317             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4318             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4319             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4320         16  CF-PLAN-ABBREV                 PIC XXX.
  4321         16  CF-PLAN-DESCRIPT               PIC X(10).
  4322         16  CF-PLAN-NOTES                  PIC X(20).
  4323         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4324         16  CF-PLAN-UNDERWRITING.
  4325             20  CF-PLAN-TERM-DATA.
  4326                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4327                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4328             20  CF-PLAN-AGE-DATA.
  4329                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4330                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4331                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4332             20  CF-PLAN-BENEFIT-DATA.
  4333                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4334                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4335                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4336                                            PIC S9(7)V99  COMP-3.
  4337         16  CF-PLAN-POLICY-FORMS.
  4338             20  CF-POLICY-FORM             PIC X(12).
  4339             20  CF-MASTER-APPLICATION      PIC X(12).
  4340             20  CF-MASTER-POLICY           PIC X(12).
  4341         16  CF-PLAN-RATING.
  4342             20  CF-RATE-CODE               PIC X(5).
  4343             20  CF-SEX-RATING              PIC X.
  4344                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4345                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4346             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4347             20  CF-SUB-STD-TYPE            PIC X.
  4348                 88  CF-PCT-OF-PREM            VALUE '1'.
  4349                 88  CF-PCT-OF-BENE            VALUE '2'.
  4350         16  CF-PLAN-PREM-TOLERANCES.
  4351             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4352             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4353         16  CF-PLAN-PYMT-TOLERANCES.
  4354             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4355             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4356         16  CF-PLAN-MISC-DATA.
  4357             20  FILLER                     PIC X.
  4358             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4359             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4360         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4361         16  CF-PLAN-IND-GRP                PIC X.
  4362             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4363                                                     '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  77
* NSRASBL.cbl
  4364             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4365                                                     '2'.
  4366         16  CF-MIB-SEARCH-SW               PIC X.
  4367             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4368             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4369             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4370             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4371         16  CF-ALPHA-SEARCH-SW             PIC X.
  4372             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4373             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4374             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4375             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4376             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4377             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4378             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4379             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4380             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4381             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4382                                                     'A' 'B' 'C'
  4383                                                     'X' 'Y' 'Z'.
  4384         16  CF-EFF-DT-RULE-SW              PIC X.
  4385             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4386             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4387             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4388             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4389             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4390         16  FILLER                         PIC X(4).
  4391         16  CF-HEALTH-QUESTIONS            PIC X.
  4392             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4393         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4394         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4395         16  CF-PLAN-SNGL-JNT               PIC X.
  4396             88  CF-COMBINED-PLAN              VALUE 'C'.
  4397             88  CF-JNT-PLAN                   VALUE 'J'.
  4398             88  CF-SNGL-PLAN                  VALUE 'S'.
  4399         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4400         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4401         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4402         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4403         16  CF-RERATE-CNTL                 PIC  X.
  4404             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4405             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4406             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4407             88  CF-AUTO-RECALC                 VALUE '4'.
  4408         16  CF-BENEFIT-TYPE                PIC  X.
  4409             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4410             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4411         16  CF-POLICY-FEE                  PIC S999V99
  4412                                                    COMP-3.
  4413         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4414         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4415         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4416         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4417         16  FILLER                         PIC  X(32).
  4418         16  CF-TERMINATION-FORM            PIC  X(04).
  4419         16  FILLER                         PIC  X(08).
  4420         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4421                                                       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  78
* NSRASBL.cbl
  4422         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4423         16  CF-ISSUE-LETTER                PIC  X(4).
  4424         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4425         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4426             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4427             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4428         16  CF-MP-REFUND-CALC              PIC X.
  4429             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4430             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4431             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4432             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4433             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4434             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4435             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4436             88  CF-MP-REFD-MEAN                VALUE '8'.
  4437         16  CF-ALT-RATE-CODE               PIC  X(5).
  4438
  4439
  4440         16  FILLER                         PIC X(498).
  4441****************************************************************
  4442*             MORTGAGE COMPANY MASTER RECORD                   *
  4443****************************************************************
  4444
  4445     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4446         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4447         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4448             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4449             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4450             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4451             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4452             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4453
  4454         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4455         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4456         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4457         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4458         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4459
  4460         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4461             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4462         16  CF-MP-RECON-USE-IND            PIC X(1).
  4463             88  CF-MP-USE-RECON             VALUE 'Y'.
  4464         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4465             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4466         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4467             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4468             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4469         16  FILLER                         PIC X(1).
  4470         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4471             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4472         16  CF-MORTG-MIB-VERSION           PIC X.
  4473             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4474             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4475             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4476         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4477             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4478                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4479             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  79
* NSRASBL.cbl
  4480                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4481             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4482                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4483             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4484                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4485             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4486                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4487             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4488                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4489         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4490         16  FILLER                         PIC X(7).
  4491         16  CF-MORTG-DESTINATION-SYMBOL.
  4492             20  CF-MORTG-MIB-COMM          PIC X(5).
  4493             20  CF-MORTG-MIB-TERM          PIC X(5).
  4494         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4495             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4496         16  FILLER                         PIC X(03).
  4497         16  CF-MP-CHECK-NO-CONTROL.
  4498             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4499                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4500                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4501                                                ' ' LOW-VALUES.
  4502                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4503                                               VALUE '3'.
  4504         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4505         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4506         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4507             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4508                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4509             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4510                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4511             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4512                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4513             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4514                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4515             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4516                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4517             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4518                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4519         16  CF-MORTG-BILLING-AREA.
  4520             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4521                                            PIC X.
  4522         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4523         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4524         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4525         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4526             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4527             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4528         16  FILLER                         PIC X.
  4529         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4530             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4531             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4532         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4533         16  FILLER                         PIC X(8).
  4534         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4535         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4536         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4537         16  CF-ACH-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  80
* NSRASBL.cbl
  4538             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4539                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4540                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4541                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4542             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4543         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4544             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4545         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4546             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4547             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4548         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4549         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4550         16  FILLER                         PIC X(536).
  4551
  4552****************************************************************
  4553*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4554****************************************************************
  4555
  4556     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4557         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4558             20  CF-FEMALE-HEIGHT.
  4559                 24  CF-FEMALE-FT           PIC 99.
  4560                 24  CF-FEMALE-IN           PIC 99.
  4561             20  CF-FEMALE-MIN-WT           PIC 999.
  4562             20  CF-FEMALE-MAX-WT           PIC 999.
  4563         16  FILLER                         PIC X(428).
  4564
  4565     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4566         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4567             20  CF-MALE-HEIGHT.
  4568                 24  CF-MALE-FT             PIC 99.
  4569                 24  CF-MALE-IN             PIC 99.
  4570             20  CF-MALE-MIN-WT             PIC 999.
  4571             20  CF-MALE-MAX-WT             PIC 999.
  4572         16  FILLER                         PIC X(428).
  4573******************************************************************
  4574*             AUTOMATIC ACTIVITY RECORD                          *
  4575******************************************************************
  4576     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4577         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4578             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4579             20  CF-SYS-LETTER-ID           PIC X(04).
  4580             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4581             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4582             20  CF-SYS-RESET-SW            PIC X(01).
  4583             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4584             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4585
  4586         16  FILLER                         PIC X(50).
  4587
  4588         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4589             20  CF-USER-ACTIVE-SW          PIC X(01).
  4590             20  CF-USER-LETTER-ID          PIC X(04).
  4591             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4592             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4593             20  CF-USER-RESET-SW           PIC X(01).
  4594             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4595             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  81
* NSRASBL.cbl
  4596             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4597
  4598         16  FILLER                         PIC X(246).
  4599*                                COPY NSCASVARS.
  4600******************************************************************
  4601*                   C H A N G E   L O G
  4602*
  4603*        CURRENT SIZE - 6180
  4604*
  4605* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4606*-----------------------------------------------------------------
  4607*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4608* EFFECTIVE    NUMBER
  4609*-----------------------------------------------------------------
  4610* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4611* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4612* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
  4613* 121015  CR2015100900001  TANA  ADD VIN NUMBER
  4614******************************************************************
  4615 01 NAPER-OUTPUT-DATA.
  4616    05  F                       PIC X(07) VALUE "LETTER=".
  4617    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4618    05  F                       PIC X(08) VALUE "~PROCID=".
  4619    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4620    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4621    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4622    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4623    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4624    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4625    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4626    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4627    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4628    05  F                       PIC X(06) VALUE "~CARR=".
  4629    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4630    05  F                       PIC X(10) VALUE "~GROUPING=".
  4631    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4632    05  F                       PIC X(08) VALUE "~CERTST=".
  4633    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4634    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4635    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4636    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4637    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4638    05  F                       PIC X(07) VALUE "~CRTNO=".
  4639    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4640    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4641    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4642    05  F                       PIC X(08) VALUE "~ILNAME=".
  4643    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4644    05  F                       PIC X(08) VALUE "~IFNAME=".
  4645    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4646    05  F                       PIC X(08) VALUE "~IFINIT=".
  4647    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4648    05  F                       PIC X(08) VALUE "~IMINIT=".
  4649    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4650    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4651    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4652    05  F                       PIC X(06) VALUE "~ISEX=".
  4653    05  OUT-ISEX                PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  82
* NSRASBL.cbl
  4654    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4655    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4656    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4657    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4658    05  F                       PIC X(09) VALUE "~INSCITY=".
  4659    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4660    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4661    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4662    05  F                       PIC X(08) VALUE "~INSZIP=".
  4663    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4664    05  F                       PIC X(05) VALUE "~SSN=".
  4665    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4666    05  F                       PIC X(07) VALUE "~MEMNO=".
  4667    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4668    05  F                       PIC X(08) VALUE "~JLNAME=".
  4669    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4670    05  F                       PIC X(08) VALUE "~JFNAME=".
  4671    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4672    05  F                       PIC X(08) VALUE "~JMINIT=".
  4673    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4674    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4675    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4676    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4677    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4678    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4679    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4680    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4681    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4682    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4683    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4684    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4685    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4686    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4687    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4688    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4689    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4690    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4691    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4692    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4693    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4694    05  F                       PIC X(10) VALUE "~BENENAME=".
  4695    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4696    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4697    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4698    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4699    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4700    05  F                       PIC X(10) VALUE "~BENECITY=".
  4701    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4702    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4703    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4704    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4705    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4706    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4707    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4708    05  F                       PIC X(08) VALUE "~RESPNO=".
  4709    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4710    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4711    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  83
* NSRASBL.cbl
  4712    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4713    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4714    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4715    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4716    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4717    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4718    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4719    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4720    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4721    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4722    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4723    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4724    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4725    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4726    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4727    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4728    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4729    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4730    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4731    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4732    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4733    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4734    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4735    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4736    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4737    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4738    05  F                       PIC X(07) VALUE "~BATCH=".
  4739    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4740    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4741    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4742    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4743    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4744    05  F                       PIC X(05) VALUE "~APR=".
  4745    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4746    05  F                       PIC X(08) VALUE "~LNTERM=".
  4747    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4748    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4749    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4750    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4751    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4752    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4753    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4754    05  F                       PIC X(07) VALUE "~UCODE=".
  4755    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4756    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4757    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4758    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4759    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4760    05  F                       PIC X(06) VALUE "~SKIP=".
  4761    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4762    05  F                       PIC X(06) VALUE "~MODE=".
  4763    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4764    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4765    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4766    05  F                       PIC X(06) VALUE "~RTBL=".
  4767    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4768    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4769    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  84
* NSRASBL.cbl
  4770    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4771    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4772    05  F                       PIC X(08) VALUE "~LFTERM=".
  4773    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4774    05  F                       PIC X(07) VALUE "~LFDEV=".
  4775    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4776    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4777    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4778    05  F                       PIC X(07) VALUE "~LFBEN=".
  4779    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4780    05  F                       PIC X(08) VALUE "~LFPREM=".
  4781    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4782    05  F                       PIC X(08) VALUE "~LFABEN=".
  4783    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4784    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4785    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4786    05  F                       PIC X(07) VALUE "~LFNSP=".
  4787    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4788    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4789    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4790    05  F                       PIC X(07) VALUE "~LFCAN=".
  4791    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4792    05  F                       PIC X(07) VALUE "~LFDTH=".
  4793    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4794    05  F                       PIC X(08) VALUE "~LFRATE=".
  4795    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4796    05  F                       PIC X(09) VALUE "~LFARATE=".
  4797    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4798    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4799    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4800    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4801    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4802    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4803    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4804    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4805    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4806    05  F                       PIC X(07) VALUE "~DTHDT=".
  4807    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4808    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4809    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4810    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4811    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4812    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4813    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4814    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4815    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4816    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4817    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4818    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4819    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4820    05  F                       PIC X(08) VALUE "~AHTERM=".
  4821    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4822    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4823    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4824    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4825    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4826    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4827    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  85
* NSRASBL.cbl
  4828    05  F                       PIC X(07) VALUE "~AHBEN=".
  4829    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4830    05  F                       PIC X(08) VALUE "~AHPREM=".
  4831    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4832    05  F                       PIC X(07) VALUE "~AHNSP=".
  4833    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4834    05  F                       PIC X(07) VALUE "~AHCAN=".
  4835    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4836    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4837    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4838    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4839    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4840    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4841    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4842    05  F                       PIC X(08) VALUE "~AHRATE=".
  4843    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4844    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4845    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4846    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4847    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4848    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4849    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4850    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4851    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4852    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4853    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4854    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4855    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4856    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4857    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4858    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4859    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4860    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4861    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4862    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4863    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4864    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4865    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4866    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4867                                PIC X(2).
  4868    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4869    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4870    05  F                       PIC X(08) VALUE "~TOTREF=".
  4871    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4872    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4873    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4874    05  F                       PIC X(07) VALUE "~STERM=".
  4875    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4876    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4877    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4878    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4879    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4880    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4881    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4882    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4883    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4884    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4885    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  86
* NSRASBL.cbl
  4886    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4887    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4888    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4889    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4890    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4891    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4892    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4893    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4894    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4895    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4896    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4897    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4898    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4899                                PIC X(12).
  4900    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4901    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4902    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4903                                PIC X(12).
  4904    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4905    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4906    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4907    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4908    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4909    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4910    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4911    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4912    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4913                                PIC X(12).
  4914    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4915    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4916    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4917                                PIC X(10).
  4918    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4919    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4920    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4921    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4922    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4923    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4924    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4925    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4926    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4927    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4928    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4929    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4930    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4931                                PIC X(10).
  4932    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4933    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4934    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4935                                PIC X(10).
  4936    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4937    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4938    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4939    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4940    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4941    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4942    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4943    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  87
* NSRASBL.cbl
  4944    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4945    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4946    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4947    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4948    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4949    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4950    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4951    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4952    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4953    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4954    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4955                                PIC X(2).
  4956    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4957    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4958    05  F                       PIC X(08) VALUE "~OSTERM=".
  4959    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4960    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4961    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4962    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4963    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4964    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4965    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4966    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4967    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4968    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4969                                PIC X(09).
  4970    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4971    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4972    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4973    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4974    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4975    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4976    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4977    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4978    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4979                                PIC X(09).
  4980    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4981    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4982    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4983    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4984    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4985                                PIC X(09).
  4986    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4987    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4988    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4989                                PIC X(12).
  4990    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4991    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4992    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4993                                PIC X(10).
  4994    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4995    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4996    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4997    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4998    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4999                                PIC X(12).
  5000    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  5001    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  88
* NSRASBL.cbl
  5002    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  5003                                PIC X(10).
  5004    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  5005    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  5006    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  5007    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  5008    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  5009    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  5010    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  5011    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  5012    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  5013                                PIC X(09).
  5014    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  5015    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  5016    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  5017                                PIC X(09).
  5018    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  5019    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  5020    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  5021                                PIC X(10).
  5022    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  5023    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  5024    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  5025                                PIC X(10).
  5026    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  5027    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  5028    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  5029    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  5030    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  5031    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  5032    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  5033    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  5034    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  5035    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  5036    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  5037    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  5038    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  5039    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  5040    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  5041                                PIC X(09).
  5042    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  5043    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  5044    05  F                       PIC X(08) VALUE "~NSTERM=".
  5045    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  5046    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  5047                                PIC X(09).
  5048    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  5049    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  5050    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  5051    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  5052    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  5053    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  5054    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  5055    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  5056    05  F                       PIC X(09) VALUE "~BALLOON=".
  5057    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  5058    05  F                       PIC X(10) VALUE "~LEASEIND=".
  5059    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  89
* NSRASBL.cbl
  5060    05  F                       PIC X(09) VALUE "~RESCIND=".
  5061    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  5062    05  F                       PIC X(07) VALUE "~RCD01=".
  5063    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  5064    05  F                       PIC X(07) VALUE "~RCD02=".
  5065    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  5066    05  F                       PIC X(07) VALUE "~RCD03=".
  5067    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  5068    05  F                       PIC X(07) VALUE "~RCD04=".
  5069    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  5070    05  F                       PIC X(07) VALUE "~RCD05=".
  5071    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  5072    05  F                       PIC X(07) VALUE "~RCD06=".
  5073    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  5074    05  F                       PIC X(07) VALUE "~RCD07=".
  5075    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  5076    05  F                       PIC X(07) VALUE "~RCD08=".
  5077    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  5078    05  F                       PIC X(07) VALUE "~RCD09=".
  5079    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  5080    05  F                       PIC X(07) VALUE "~RCD10=".
  5081    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  5082    05  F                       PIC X(07) VALUE "~RCD11=".
  5083    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  5084    05  F                       PIC X(07) VALUE "~RCD12=".
  5085    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  5086    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  5087    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  5088    05  F                       PIC X(08) VALUE "~ARCHNO=".
  5089    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  5090    05  F                       PIC X(06) VALUE "~FORM=".
  5091    05  OUT-FORM                PIC X(03) VALUE SPACES.
  5092    05  F                       PIC X(09) VALUE "~ENCLINE=".
  5093    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  5094    05  F                       PIC X(08) VALUE "~ATTACH=".
  5095    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  5096    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  5097    05  OUT-STACK               PIC X(10) VALUE SPACES.
  5098    05  F                       PIC X(11) VALUE "~STATENAME=".
  5099    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  5100    05  F                       PIC X(08) VALUE "~PRTNOW=".
  5101    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  5102    05  F                       PIC X(05) VALUE "~NCB=".
  5103    05  OUT-CHGBACK             PIC X     VALUE ' '.
  5104    05  F                       PIC X(8) VALUE "~CSOAMT=".
  5105    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  5106    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  5107    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  5108    05  F                       PIC X(09) VALUE "~LETRTYP=".
  5109    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  5110    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  5111    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  5112    05  F                       PIC X(08) VALUE "~INSBDT=".
  5113    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  5114    05  F                       PIC X(08) VALUE "~JNTBDT=".
  5115    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  5116    05  F                       PIC X(08) VALUE "~TOTINT=".
  5117    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  90
* NSRASBL.cbl
  5118    05  F                       PIC X(8) VALUE "~TOPREM=".
  5119    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  5120    05  F                       PIC X(7) VALUE "~TOREF=".
  5121    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  5122    05  F                       PIC X(7) VALUE "~CANDT=".
  5123    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  5124    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  5125    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  5126    05  F                       PIC X(08) VALUE "~CERTID=".
  5127    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  5128    05  F                       PIC X(08) VALUE "~UNDWID=".
  5129    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  5130    05  F                       PIC X(8) VALUE "~TNPREM=".
  5131    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  5132    05  F                       PIC X(7) VALUE "~TNREF=".
  5133    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  5134    05  F                       PIC X(8)  VALUE "~COVIND=".
  5135    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  5136    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  5137    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  5138    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  5139    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  5140    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  5141    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  5142    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  5143    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  5144    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  5145    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  5146    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  5147                                PIC X(10).
  5148    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  5149    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5150    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  5151    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5152    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  5153    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5154    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  5155    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5156    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  5157    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5158    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  5159    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5160    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  5161    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  5162    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  5163    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5164    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  5165    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5166    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  5167    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  5168    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  5169    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  5170    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  5171    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5172    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  5173    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5174    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  5175    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  91
* NSRASBL.cbl
  5176    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  5177    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  5178    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  5179    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5180    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  5181    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5182    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  5183    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  5184    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  5185    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  5186    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  5187    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5188    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  5189    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5190    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  5191    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5192    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  5193    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5194    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  5195    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  5196    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  5197    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5198    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  5199    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5200    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5201    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5202    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  5203    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5204    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5205    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5206    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5207    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5208    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5209    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5210    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5211    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5212    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  5213    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5214    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5215    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5216    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5217    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5218    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5219    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5220    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5221    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5222    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5223    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5224    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5225    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5226    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5227    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5228    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5229    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5230    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5231    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5232    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5233    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  92
* NSRASBL.cbl
  5234    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5235    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5236    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5237    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5238    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5239    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5240    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5241    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5242    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5243    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5244    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5245    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5246    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5247    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5248    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5249    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5250    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  5251    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  5252    05  F                       PIC X(7)  VALUE "~VINNO=".
  5253    05  OUT-VIN-NUMBER          PIC X(17) VALUE SPACES.
  5254    05  F                       PIC X(11) VALUE 'EndOfString'.
  5255    05  f                       pic x(2) value spaces.
  5256*                                COPY ERCARCH.
  5257******************************************************************
  5258*                                                                *
  5259*                            ERCARCH.                            *
  5260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5261*                            VMOD=2.002                          *
  5262*                                                                *
  5263*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5264*                                                                *
  5265*   FILE TYPE = VSAM,KSDS                                        *
  5266*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5267*                                                                *
  5268*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5269*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5270*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5271*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5272*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5273*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5274*                                                                *
  5275*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5276******************************************************************
  5277*                   C H A N G E   L O G
  5278*
  5279* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5280*-----------------------------------------------------------------
  5281*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5282* EFFECTIVE    NUMBER
  5283*-----------------------------------------------------------------
  5284* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5285* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5286* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5287******************************************************************
  5288 01  LETTER-ARCHIVE.
  5289     12  LA-RECORD-ID                PIC  X(02).
  5290         88  LA-VALID-ID                VALUE 'LA'.
  5291
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  93
* NSRASBL.cbl
  5292     12  LA-CONTROL-PRIMARY.
  5293         16  LA-COMPANY-CD           PIC  X(01).
  5294         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5295
  5296     12  LA-CONTROL-BY-CERT-RESP.
  5297         16  LA-COMPANY-CD-A2        PIC  X(01).
  5298         16  LA-CERT-NO-A2.
  5299             20  LA-CERT-PRIME-A2    PIC  X(10).
  5300             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5301         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5302             20  LA-RESP-PERSON-A2   PIC  X(10).
  5303             20  LA-TYPE-A2          PIC  X(01).
  5304         16  LA-CARRIER-A2           PIC  X(01).
  5305         16  LA-GROUPING-A2          PIC  X(06).
  5306         16  LA-STATE-A2             PIC  X(02).
  5307         16  LA-ACCOUNT-A2           PIC  X(10).
  5308         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5309         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5310
  5311     12  LA-CONTROL-BY-FORM.
  5312         16  LA-COMPANY-CD-A3        PIC  X(01).
  5313         16  LA-FORM-A3              PIC  X(04).
  5314         16  LA-CARRIER-A3           PIC  X(01).
  5315         16  LA-GROUPING-A3          PIC  X(06).
  5316         16  LA-STATE-A3             PIC  X(02).
  5317         16  LA-ACCOUNT-A3           PIC  X(10).
  5318         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5319
  5320     12  LA-CONTROL-BY-PROCESSOR.
  5321         16  LA-COMPANY-CD-A4        PIC  X(01).
  5322         16  LA-PROCESSOR-CD         PIC  X(04).
  5323         16  LA-CARRIER-A4           PIC  X(01).
  5324         16  LA-GROUPING-A4          PIC  X(06).
  5325         16  LA-STATE-A4             PIC  X(02).
  5326         16  LA-ACCOUNT-A4           PIC  X(10).
  5327         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5328
  5329     12  LA-CONTROL-BY-KEY-FIELDS.
  5330         16  LA-COMPANY-CD-A5        PIC  X(01).
  5331         16  LA-CARRIER-A5           PIC  X(01).
  5332         16  LA-GROUPING-A5          PIC  X(06).
  5333         16  LA-STATE-A5             PIC  X(02).
  5334         16  LA-ACCOUNT-A5           PIC  X(10).
  5335         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5336
  5337     12  LA-CONTROL-BY-GROUP-CODE.
  5338         16  LA-COMPANY-CD-A6        PIC  X(01).
  5339         16  LA-ENTRY-A6.
  5340             20  LA-FILLER           PIC  X(02).
  5341             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5342         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5343
  5344     12  FILLER                      PIC  X(09).
  5345
  5346     12  LA-HEADER-RECORD.
  5347         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5348         16  LA-CREATION-DATE        PIC  X(02).
  5349         16  LA-FOLLOW-UP-DATE       PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  94
* NSRASBL.cbl
  5350         16  LA-FINAL-ACT-DATE       REDEFINES
  5351               LA-FOLLOW-UP-DATE     PIC  X(02).
  5352         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5353         16  LA-NO-OF-COPIES         PIC S9(01).
  5354         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5355         16  LA-REPLY-DATE           PIC  X(02).
  5356         16  LA-RESEND-DATES.
  5357             20  LA-RESEND-DATE      PIC  X(02).
  5358             20  LA-SENT-DATE        PIC  X(02).
  5359             20  FILLER              PIC  X(08).
  5360         16  LA-SOURCE-INFORMATION.
  5361             20  LA-DATA-SOURCE      PIC  X(01).
  5362             20  LA-ADDR-SOURCE      PIC  X(01).
  5363         16  LA-STATUS               PIC  X(01).
  5364             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5365             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5366             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5367             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5368             88  LA-STATUS-PURGED         VALUE 'P'.
  5369             88  LA-STATUS-VOIDED         VALUE 'V'.
  5370         16  LA-LAST-RESENT-PRINT-DATE
  5371                                     PIC  X(02).
  5372         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5373             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5374                                          VALUE 'C'.
  5375             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5376                                          VALUE 'F'.
  5377             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5378                                          VALUE 'P'.
  5379         16  LA-PURGED-DATE          PIC  X(02).
  5380         16  LA-VOIDED-DATE          PIC  X(02).
  5381         16  LA-RESEND-LETR          PIC  X(4).
  5382         16  FILLER                  PIC  X(08).
  5383*        16  LA-RESEND-LETR-2        PIC  X(4).
  5384*        16  LA-RESEND-LETR-3        PIC  X(4).
  5385*        16  FILLER                  PIC  X(59).
  5386         16  LA-ARCHIVE-STATUS       PIC  X.
  5387             88  LA-TEMP                VALUE 'T'.
  5388             88  LA-QWS                 VALUE 'Q'.
  5389             88  LA-BATCH               VALUE 'B'.
  5390         16  LA-FINAL-ACT-IND        PIC  X(1).
  5391         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5392         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5393         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5394                                     PIC X(4).
  5395         16  FILLER                  PIC  X(42).
  5396*        16  FILLER                  PIC  X(71).
  5397         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5398         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5399         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5400                                     PIC  X(4).
  5401         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5402
  5403******************************************************************
  5404*                                COPY ELCCRTT.
  5405******************************************************************
  5406*                                                                *
  5407*                            ELCCRTT.                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  95
* NSRASBL.cbl
  5408*                                                                *
  5409*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5410*                                                                *
  5411*   FILE TYPE = VSAM,KSDS                                        *
  5412*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5413*                                                                *
  5414*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5415*                                                                *
  5416*   LOG = YES                                                    *
  5417*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5418******************************************************************
  5419*                   C H A N G E   L O G
  5420*
  5421* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5422*-----------------------------------------------------------------
  5423*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5424* EFFECTIVE    NUMBER
  5425*-----------------------------------------------------------------
  5426* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5427* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5428* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5429* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5430* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5431* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5432* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5433* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5434* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5435******************************************************************
  5436
  5437 01  CERTIFICATE-TRAILERS.
  5438     12  CS-RECORD-ID                      PIC XX.
  5439         88  VALID-CS-ID                      VALUE 'CS'.
  5440
  5441     12  CS-CONTROL-PRIMARY.
  5442         16  CS-COMPANY-CD                 PIC X.
  5443         16  CS-CARRIER                    PIC X.
  5444         16  CS-GROUPING                   PIC X(6).
  5445         16  CS-STATE                      PIC XX.
  5446         16  CS-ACCOUNT                    PIC X(10).
  5447         16  CS-CERT-EFF-DT                PIC XX.
  5448         16  CS-CERT-NO.
  5449             20  CS-CERT-PRIME             PIC X(10).
  5450             20  CS-CERT-SFX               PIC X.
  5451         16  CS-TRAILER-TYPE               PIC X.
  5452             88  COMM-TRLR           VALUE 'A'.
  5453             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5454             88  CERT-DATA-TRLR      VALUE 'C'.
  5455
  5456     12  CS-DATA-AREA                      PIC X(516).
  5457
  5458     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5459         16  CS-BANK-COMMISSION-AREA.
  5460             20  CS-BANK-COMMS       OCCURS 10.
  5461                 24  CS-AGT                PIC X(10).
  5462                 24  CS-COM-TYP            PIC X.
  5463                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5464                 24  CS-RECALC-LV-INDIC    PIC X.
  5465                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  96
* NSRASBL.cbl
  5466         16  FILLER                        PIC X(256).
  5467
  5468     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5469****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5470         16  CS-MB-CLAIM-DATA OCCURS 24.
  5471             20  CS-CLAIM-NO               PIC X(7).
  5472             20  CS-CLAIM-TYPE             PIC X.
  5473                 88  CS-AH-CLM               VALUE 'A'.
  5474                 88  CS-IU-CLM               VALUE 'I'.
  5475                 88  CS-GP-CLM               VALUE 'G'.
  5476                 88  CS-LF-CLM               VALUE 'L'.
  5477                 88  CS-PR-CLM               VALUE 'P'.
  5478                 88  CS-FL-CLM               VALUE 'F'.
  5479             20  CS-INSURED-TYPE           PIC X.
  5480                 88  CS-PRIM-INSURED          VALUE 'P'.
  5481                 88  CS-CO-BORROWER           VALUE 'C'.
  5482             20  CS-BENEFIT-PERIOD         PIC 99.
  5483             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5484             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5485             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5486         16  FILLER                        PIC X(12).
  5487     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5488         16  CS-VIN-NUMBER                 PIC X(17).
  5489         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5490         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5491         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5492         16  cs-agent-name.
  5493             20  cs-agent-fname            pic x(20).
  5494             20  cs-agent-mi               pic x.
  5495             20  cs-agent-lname            pic x(25).
  5496         16  cs-license-no                 pic x(15).
  5497         16  cs-npn-number                 pic x(10).
  5498         16  cs-agent-edit-status          pic x.
  5499             88  cs-ae-refer-to-manager      value 'M'.
  5500             88  cs-ae-cover-sheet           value 'C'.
  5501             88  cs-ae-sig-form              value 'S'.
  5502             88  cs-ae-verified              value 'V'.
  5503             88  cs-unidentified-signature   value 'U'.
  5504             88  cs-cert-returned            value 'R'.
  5505             88  cs-accept-no-commission     value 'N'.
  5506         16  cs-year                       pic 9999.
  5507         16  cs-make                       pic x(20).
  5508         16  cs-model                      pic x(20).
  5509         16  cs-future                     pic x(20).
  5510         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5511         16  FILLER                        PIC X(356). *> was 420
  5512*        16  FILLER                        PIC X(496).
  5513 01  FILLER                      PIC X(500)  VALUE SPACES.
  5514*                                COPY ELCENCC.
  5515******************************************************************
  5516*                                                                *
  5517*                                                                *
  5518*                            ELCENCC                             *
  5519*                            VMOD=2.001                          *
  5520*                                                                *
  5521*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5522*                                                                *
  5523*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  97
* NSRASBL.cbl
  5524*   A NAPERSOFT DOCUMENT                                         *
  5525*                                                                *
  5526*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5527*                                                                *
  5528*   FILE TYPE = VSAM,KSDS                                        *
  5529*   RECORD SIZE = 400   RECFORM = FIX                            *
  5530*                                                                *
  5531*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5532*                                                                *
  5533*   LOG = NO                                                     *
  5534*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5535*                                                                *
  5536*                                                                *
  5537******************************************************************
  5538*                   C H A N G E   L O G
  5539*
  5540* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5541*-----------------------------------------------------------------
  5542*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5543* EFFECTIVE    NUMBER
  5544*-----------------------------------------------------------------
  5545* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5546* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5547******************************************************************
  5548 01  ENCLOSURE-CODES.
  5549     12  NC-RECORD-ID                      PIC XX.
  5550         88  VALID-NC-ID                      VALUE 'NC'.
  5551     12  NC-CONTROL-PRIMARY.
  5552         16  NC-COMPANY-CD                 PIC X.
  5553         16  NC-REC-TYPE                   PIC X.
  5554             88  NC-CLAIMS                   VALUE '1'.
  5555             88  NC-ADMIN                    VALUE '2'.
  5556         16  NC-ENC-CODE                   PIC X(5).
  5557         16  FILLER                        PIC X(09).
  5558     12  NC-MAINT-INFORMATION.
  5559         16  NC-LAST-MAINT-DT              PIC XX.
  5560         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5561         16  NC-LAST-MAINT-USER            PIC X(4).
  5562         16  FILLER                        PIC XX.
  5563     12  NC-OUTPUT-STACK                   PIC XXX.
  5564     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5565     12  NC-ATTACHMENTS                    PIC X(255).
  5566     12  NC-FUTURE                         PIC X(12).
  5567******************************************************************
  5568****************************************************************
  5569*
  5570* Copyright (c) 2007-2013 Dell Inc.
  5571* All rights reserved.
  5572*
  5573****************************************************************
  5574 01  DFHEIV.
  5575   02  DFHEIV0               PIC X(35).
  5576   02  DFHEIV1               PIC X(08).
  5577   02  DFHEIV2               PIC X(08).
  5578   02  DFHEIV3               PIC X(08).
  5579   02  DFHEIV4               PIC X(06).
  5580   02  DFHEIV5               PIC X(04).
  5581   02  DFHEIV6               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  98
* NSRASBL.cbl
  5582   02  DFHEIV7               PIC X(02).
  5583   02  DFHEIV8               PIC X(02).
  5584   02  DFHEIV9               PIC X(01).
  5585   02  DFHEIV10              PIC S9(7) COMP-3.
  5586   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5587   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5588   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5589   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5590   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5591   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5592   02  DFHEIV17              PIC X(04).
  5593   02  DFHEIV18              PIC X(04).
  5594   02  DFHEIV19              PIC X(04).
  5595   02  DFHEIV20              USAGE IS POINTER.
  5596   02  DFHEIV21              USAGE IS POINTER.
  5597   02  DFHEIV22              USAGE IS POINTER.
  5598   02  DFHEIV23              USAGE IS POINTER.
  5599   02  DFHEIV24              USAGE IS POINTER.
  5600   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5601   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5602   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5603   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5604   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5605   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5606   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5607   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5608   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5609   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5610   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5611   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5612   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5613   02  FILLER                PIC X(02).
  5614   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5615   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5616   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5617   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5618   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5619   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5620   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5621 LINKAGE  SECTION.
  5622*****************************************************************
  5623*                                                               *
  5624* Copyright (c) 2007-2013 Dell Inc.                             *
  5625* All rights reserved.                                          *
  5626*                                                               *
  5627*****************************************************************
  5628 01  dfheiblk.
  5629     02  eibtime          pic s9(7) comp-3.
  5630     02  eibdate          pic s9(7) comp-3.
  5631     02  eibtrnid         pic x(4).
  5632     02  eibtaskn         pic s9(7) comp-3.
  5633     02  eibtrmid         pic x(4).
  5634     02  dfheigdi         pic s9(4) comp.
  5635     02  eibcposn         pic s9(4) comp.
  5636     02  eibcalen         pic s9(4) comp.
  5637     02  eibaid           pic x(1).
  5638     02  eibfiller1       pic x(1).
  5639     02  eibfn            pic x(2).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page  99
* NSRASBL.cbl
  5640     02  eibfiller2       pic x(2).
  5641     02  eibrcode         pic x(6).
  5642     02  eibfiller3       pic x(2).
  5643     02  eibds            pic x(8).
  5644     02  eibreqid         pic x(8).
  5645     02  eibrsrce         pic x(8).
  5646     02  eibsync          pic x(1).
  5647     02  eibfree          pic x(1).
  5648     02  eibrecv          pic x(1).
  5649     02  eibsend          pic x(1).
  5650     02  eibatt           pic x(1).
  5651     02  eibeoc           pic x(1).
  5652     02  eibfmh           pic x(1).
  5653     02  eibcompl         pic x(1).
  5654     02  eibsig           pic x(1).
  5655     02  eibconf          pic x(1).
  5656     02  eiberr           pic x(1).
  5657     02  eibrldbk         pic x(1).
  5658     02  eiberrcd         pic x(4).
  5659     02  eibsynrb         pic x(1).
  5660     02  eibnodat         pic x(1).
  5661     02  eibfiller5       pic x(2).
  5662     02  eibresp          pic s9(8) comp.
  5663     02  eibresp2         pic s9(8) comp.
  5664     02  dfheigdj         pic s9(4) comp.
  5665     02  dfheigdk         pic s9(4) comp.
  5666 01 dfhcommarea                  PIC X(6500).
  5667
  5668 01  var  pic x(30).
  5669 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  5670 0000-DFHEXIT SECTION.
  5671     MOVE '9#                    $   ' TO DFHEIV0.
  5672     MOVE 'NSRASBL' TO DFHEIV1.
  5673     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5674     display ' entering pgm nsrasbl '
  5675     display ' commarea ' dfhcommarea
  5676     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5677     MOVE '5'                    TO DC-OPTION-CODE
  5678     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5679     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5680     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5681     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5682     MOVE DC-DAY-OF-WEEK         TO SAVE-CYCLE-DAY-OF-WEEK
  5683     move dfhcommarea            to srch-commarea
  5684*****************************************************
  5685* The full       key has been established and passed
  5686* to this program via NSRASLTR
  5687*****************************************************
  5688     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5689     display ' input data ' bl-carrier ' ' bl-group ' '
  5690        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5691     MOVE BL-LETTER-ID           TO OUT-LETTER
  5692     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5693     MOVE BL-CARRIER             TO OUT-CARRIER
  5694     MOVE BL-GROUP               TO OUT-GROUPING
  5695     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5696     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5697     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 100
* NSRASBL.cbl
  5698     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5699     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5700        DC-EDITA-DAY  DELIMITED BY SIZE
  5701        INTO OUT-CYCLE-DT
  5702     END-STRING
  5703
  5704     set P to address of KIXSYS
  5705     CALL "getenv" using by value P returning var-ptr
  5706     if var-ptr = null then
  5707        display ' kixsys not set '
  5708     else
  5709        set address of var to var-ptr
  5710        move 0 to env-var-len
  5711        inspect var tallying env-var-len
  5712          for characters before X'00'
  5713        unstring var (1:env-var-len) delimited by '/'
  5714        into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5715              WS-KIX-SYS
  5716        end-unstring
  5717     end-if
  5718
  5719     set P to address of KIXHOST
  5720     CALL "getenv" using by value P returning var-ptr
  5721     if var-ptr = null then
  5722        display ' kixhost not set '
  5723     else
  5724        set address of var to var-ptr
  5725        move 0 to env-var-len
  5726        inspect var tallying env-var-len
  5727          for characters before X'00'
  5728        MOVE var(1:env-var-len)  to ws-kixhost
  5729        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  5730     end-if
  5731
  5732     MOVE SPACES TO SVR
  5733
  5734**** This routine will connect to the Logic Database on SQL Server
  5735**** and call a stored procedure to determine the next business da
  5736
  5737     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  5738     IF SQLCODE = 0
  5739        PERFORM 4200-GET-NEXT-BUS-DT  THRU 4200-EXIT
  5740        IF SQLCODE = 0
  5741            MOVE WS-NEXT-BUS-DT TO SAVE-NEXT-BUS-DT-EDIT-A
  5742                                   WS-EDIT-A-DATE
  5743            MOVE WS-EDIT-A-YY   TO DC-YMD-YEAR
  5744            MOVE WS-EDIT-A-MM   TO DC-YMD-MONTH
  5745            MOVE WS-EDIT-A-DD   TO DC-YMD-DAY
  5746            MOVE '3'            TO DC-OPTION-CODE
  5747            PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5748            IF NO-CONVERSION-ERROR
  5749               MOVE DC-BIN-DATE-1 TO SAVE-BIN-NEXT-BUS-DT
  5750            ELSE
  5751               MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5752               MOVE '6'         TO DC-OPTION-CODE
  5753               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5754               IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5755                  MOVE 3        TO DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 101
* NSRASBL.cbl
  5756               ELSE
  5757                 IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5758                    MOVE 2     TO DC-ELAPSED-DAYS
  5759                 ELSE
  5760                    MOVE 1     TO DC-ELAPSED-DAYS
  5761                 END-IF
  5762               END-IF
  5763               PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5764               IF NO-CONVERSION-ERROR
  5765                   MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5766                   MOVE DC-GREG-DATE-A-EDIT TO
  5767                                SAVE-NEXT-BUS-DT-EDIT-A
  5768               ELSE
  5769                   MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5770                   MOVE WS-SAVE-EDIT-A-DATE TO
  5771                                SAVE-NEXT-BUS-DT-EDIT-A
  5772               END-IF
  5773            END-IF
  5774        ELSE
  5775            MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5776            MOVE '6'         TO DC-OPTION-CODE
  5777            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5778            IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5779               MOVE 3        TO DC-ELAPSED-DAYS
  5780            ELSE
  5781              IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5782                 MOVE 2     TO DC-ELAPSED-DAYS
  5783              ELSE
  5784                 MOVE 1     TO DC-ELAPSED-DAYS
  5785              END-IF
  5786            END-IF
  5787            PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5788            IF NO-CONVERSION-ERROR
  5789                MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5790                MOVE DC-GREG-DATE-A-EDIT TO
  5791                                SAVE-NEXT-BUS-DT-EDIT-A
  5792            ELSE
  5793                MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5794                MOVE WS-SAVE-EDIT-A-DATE TO
  5795                                SAVE-NEXT-BUS-DT-EDIT-A
  5796            END-IF
  5797        END-IF
  5798     ELSE
  5799        MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5800        MOVE '6'         TO DC-OPTION-CODE
  5801        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5802        IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5803           MOVE 3        TO DC-ELAPSED-DAYS
  5804        ELSE
  5805          IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5806             MOVE 2     TO DC-ELAPSED-DAYS
  5807          ELSE
  5808             MOVE 1     TO DC-ELAPSED-DAYS
  5809          END-IF
  5810        END-IF
  5811        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5812        IF NO-CONVERSION-ERROR
  5813            MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 102
* NSRASBL.cbl
  5814            MOVE DC-GREG-DATE-A-EDIT TO
  5815                                SAVE-NEXT-BUS-DT-EDIT-A
  5816        ELSE
  5817            MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5818            MOVE WS-SAVE-EDIT-A-DATE TO
  5819                                SAVE-NEXT-BUS-DT-EDIT-A
  5820        END-IF
  5821     END-IF
  5822     PERFORM 4300-DISCONNECT THRU 4300-EXIT
  5823
  5824     MOVE SAVE-NEXT-BUS-DT-EDIT-A  TO WS-EDIT-A-DATE
  5825     STRING WS-EDIT-A-CCYY '-' WS-EDIT-A-MM '-'
  5826           WS-EDIT-A-DD ' 00:00:00.0' DELIMITED BY SIZE
  5827              INTO OUT-NEXT-BUS-DT
  5828     END-STRING
  5829     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5830        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5831     ELSE
  5832        IF BL-EFF-DT = SPACES
  5833           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5834        ELSE
  5835           IF BL-EFF-DT (9:2) = SPACES
  5836              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5837                     BL-EFF-DT (4:2)
  5838                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5839              END-STRING
  5840           ELSE
  5841              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5842                     BL-EFF-DT (4:2)
  5843                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5844              END-STRING
  5845           END-IF
  5846           MOVE '3'              TO DC-OPTION-CODE
  5847           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5848           IF NO-CONVERSION-ERROR
  5849              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5850           ELSE
  5851              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5852              SET BL-FAIL TO TRUE
  5853              GO TO 0000-RETURN
  5854           END-IF
  5855        END-IF
  5856     END-IF
  5857     perform 0800-init-out-data  thru 0800-exit
  5858     SET BL-FAIL TO TRUE
  5859******************************************************************
  5860* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5861*    1) FROM ACCT MAINT
  5862*    2) FROM CERT UPDATE
  5863*    3) FROM COMP MAINT
  5864*    4) FROM REVIEW AND CORRECTIONS
  5865******************************************************************
  5866     EVALUATE BL-DATA-SRCE
  5867        WHEN '1'
  5868           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5869        WHEN '2'
  5870           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5871        WHEN '3'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 103
* NSRASBL.cbl
  5872           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5873        WHEN '4'
  5874           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5875        WHEN OTHER
  5876           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5877     END-EVALUATE
  5878     IF BL-OK
  5879        display ' bl write erarch ' bl-write-erarch
  5880        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5881        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5882        IF BL-ARCHIVE-NO = ZEROS
  5883           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5884           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5885           display ' arch zeros, new arch ' bl-archive-no
  5886        END-IF
  5887        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5888        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5889        display ' bl write erarch ' bl-write-erarch
  5890        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5891           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5892           IF BL-FAIL
  5893              GO TO 0000-RETURN
  5894           END-IF
  5895        END-IF
  5896        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5897        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5898     END-IF
  5899     .
  5900 0000-RETURN.
  5901     move srch-commarea          to dfhcommarea
  5902
  5903* exec cics
  5904*       return
  5905*    end-exec
  5906*    MOVE '.(                    ''   #00005805' TO DFHEIV0
  5907     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5908     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5909     MOVE X'2020233030303035383035' TO DFHEIV0(25:11)
  5910     CALL 'kxdfhei1' USING DFHEIV0,
  5911           DFHEIV99,
  5912           DFHEIV99,
  5913           DFHEIV99,
  5914           DFHEIV99,
  5915           DFHEIV99,
  5916           DFHEIV99
  5917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5918     .
  5919 0100-DATA-SRCE-1.
  5920     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5921     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5922     MOVE ' '                    TO WS-ERACCT-SW
  5923     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5924     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5925     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5926     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5927     MOVE BL-STATE               TO WS-ERACCT-STATE
  5928     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5929     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 104
* NSRASBL.cbl
  5930                                    WS-CERT-EFF-DT
  5931     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5932     IF ACCT-FOUND
  5933        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5934        PERFORM 1025-GET-CSR-INFO
  5935                                 THRU 1025-EXIT
  5936        PERFORM 1300-DETERMINE-COMM
  5937                                 THRU 1300-EXIT
  5938        SET BL-OK TO TRUE
  5939     ELSE
  5940        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5941        SET BL-FAIL TO TRUE
  5942     END-IF
  5943     .
  5944 0100-EXIT.
  5945     EXIT.
  5946 0200-DATA-SRCE-2.
  5947     display ' made it to data srce 2 '
  5948     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5949     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5950     MOVE ' '                    TO WS-ELCERT-SW
  5951     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5952     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5953     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5954     MOVE BL-STATE               TO WS-ELCERT-STATE
  5955     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5956     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5957                                    WS-CERT-EFF-DT
  5958     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5959
  5960     MOVE ' '                 TO WS-ERACCT-SW
  5961     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5962     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5963     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5964     IF ACCT-FOUND
  5965        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5966        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5967     END-IF
  5968     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5969     IF CERT-FOUND
  5970        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5971        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5972        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5973        IF WS-LF-EARN = 'B'
  5974           MOVE 'B'              TO OUT-BALLOON-IND
  5975        END-IF
  5976        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5977        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5978        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5979        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5980
  5981        IF BL-ENDT-ARCH-NO > ZERO
  5982           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5983           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5984           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5985        ELSE
  5986           IF BL-ARCHIVE-NO > ZERO
  5987              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 105
* NSRASBL.cbl
  5988              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5989              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5990           END-IF
  5991        END-IF
  5992
  5993        PERFORM 4500-CHECK-BALLOON-STATE THRU 4500-EXIT
  5994*072312 IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5995        IF WS-LOOKUP-VALUE > SPACES
  5996          AND (OUT-BALLOON-IND = 'B')
  5997           MOVE 'B'              TO OUT-FORM (3:1)
  5998        END-IF
  5999        SET BL-OK TO TRUE
  6000     ELSE
  6001        display ' cert not found ' ws-elcert-cert-no
  6002        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  6003        SET BL-FAIL TO TRUE
  6004     END-IF
  6005     .
  6006 0200-EXIT.
  6007     EXIT.
  6008 0300-DATA-SRCE-3.
  6009     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  6010     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  6011     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  6012     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  6013     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  6014     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  6015     IF WS-ERCOMP-ACCOUNT = SPACES
  6016        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  6017        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  6018     ELSE
  6019        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  6020     END-IF
  6021     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  6022     IF RESP-NORMAL
  6023        MOVE CO-CSR-CODE         TO WS-CSR-ID
  6024        PERFORM 1025-GET-CSR-INFO
  6025                                 THRU 1025-EXIT
  6026        SET BL-OK TO TRUE
  6027     ELSE
  6028        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  6029        SET BL-FAIL TO TRUE
  6030     END-IF
  6031     .
  6032 0300-EXIT.
  6033     EXIT.
  6034 0400-DATA-SRCE-4.
  6035     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  6036     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  6037     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  6038     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  6039     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  6040                                    WS-ELCERT-SW WS-ERENDT-SW
  6041
  6042* EXEC CICS READ
  6043*         DATASET    ('ERPNDB')
  6044*         INTO       (PENDING-BUSINESS)
  6045*         RIDFLD     (WS-ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 106
* NSRASBL.cbl
  6046*         RESP       (WS-RESPONSE)
  6047*    END-EXEC
  6048     MOVE LENGTH OF
  6049      PENDING-BUSINESS
  6050       TO DFHEIV11
  6051     MOVE 'ERPNDB' TO DFHEIV1
  6052*    MOVE '&"IL       E          (  N#00005931' TO DFHEIV0
  6053     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6055     MOVE X'204E233030303035393331' TO DFHEIV0(25:11)
  6056     CALL 'kxdfhei1' USING DFHEIV0,
  6057           DFHEIV1,
  6058           PENDING-BUSINESS,
  6059           DFHEIV11,
  6060           WS-ERPNDB-KEY,
  6061           DFHEIV99,
  6062           DFHEIV99,
  6063           DFHEIV99
  6064     MOVE EIBRESP  TO WS-RESPONSE
  6065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6066     IF RESP-NORMAL
  6067        IF PB-RECORD-TYPE = '1' OR '2'
  6068           MOVE PB-CARRIER       TO BL-CARRIER
  6069           MOVE PB-GROUPING      TO BL-GROUP
  6070           MOVE PB-STATE         TO BL-STATE
  6071           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  6072           MOVE PB-CERT-NO       TO BL-CERT-NO
  6073           MOVE PB-CSR-ID        TO WS-CSR-ID
  6074           IF PB-ISSUE
  6075              SET PROCESS-ISSUE TO TRUE
  6076              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  6077              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  6078              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  6079              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  6080           ELSE
  6081              SET PROCESS-CANCEL TO TRUE
  6082              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  6083              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  6084              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  6085              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  6086           END-IF
  6087           PERFORM 1120-MATCH-CARRIER
  6088                                 THRU 1120-EXIT
  6089           PERFORM 1125-MATCH-STATE
  6090                                 THRU 1125-EXIT
  6091           PERFORM 1130-MATCH-BENCDS
  6092                                 THRU 1130-EXIT
  6093           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  6094           MOVE WS-LF-DESC       TO OUT-LF-DESC
  6095                                    OUT-ORIG-LF-DESC
  6096           IF WS-LF-EARN = 'B'
  6097              MOVE 'B'           TO OUT-BALLOON-IND
  6098           END-IF
  6099           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  6100                                    OUT-ORIG-WAIT-PER
  6101           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  6102                                    OUT-ORIG-RET-ELIM
  6103           MOVE WS-AH-DESC       TO OUT-AH-DESC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 107
* NSRASBL.cbl
  6104                                    OUT-ORIG-AH-DESC
  6105           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  6106                                    OUT-ORIG-BEN-DAYS
  6107           PERFORM 1025-GET-CSR-INFO
  6108                                 THRU 1025-EXIT
  6109
  6110           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  6111           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  6112                                 TO WS-ERACCT-KEY (1:22)
  6113           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  6114           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  6115           IF ACCT-FOUND
  6116              MOVE AM-CSR-CODE      TO WS-CSR-ID
  6117              PERFORM 1025-GET-CSR-INFO
  6118                                    THRU 1025-EXIT
  6119              PERFORM 1300-DETERMINE-COMM
  6120                                    THRU 1300-EXIT
  6121           END-IF
  6122
  6123           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  6124                                 TO WS-ELCERT-KEY
  6125           PERFORM 1100-GET-ELCERT
  6126                                 THRU 1100-EXIT
  6127
  6128           IF BL-ENDT-ARCH-NO > ZERO
  6129              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  6130              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  6131              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6132           ELSE
  6133              IF BL-ARCHIVE-NO > ZERO
  6134                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  6135                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  6136                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6137              END-IF
  6138           END-IF
  6139
  6140           SET BL-OK TO TRUE
  6141           PERFORM 4500-CHECK-BALLOON-STATE THRU 4500-EXIT
  6142*072312     IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  6143           IF WS-LOOKUP-VALUE > SPACES
  6144             AND (OUT-BALLOON-IND = 'B')
  6145              MOVE 'B'           TO OUT-FORM (3:1)
  6146           END-IF
  6147        END-IF
  6148     END-IF
  6149     .
  6150 0400-EXIT.
  6151     EXIT.
  6152 0500-SCRUB-DATA.
  6153*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  6154*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  6155*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  6156*   TO A HEX 26 TO GET BY THE DECODER
  6157     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  6158                                 TO M1
  6159     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  6160     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6161        (A1 > M1)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 108
* NSRASBL.cbl
  6162        OR (WS-WORK-FIELD (A1:1) = '*')
  6163        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6164        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6165     END-PERFORM
  6166     IF A1 > M1
  6167        CONTINUE
  6168     ELSE
  6169        MOVE WS-WORK-FIELD (1:A1 - 1)
  6170                                 TO OUT-ACCT-NAME
  6171     END-IF
  6172     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  6173                                 TO M1
  6174     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  6175     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6176        (A1 > M1)
  6177        OR (WS-WORK-FIELD (A1:1) = '*')
  6178        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6179        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6180     END-PERFORM
  6181     IF A1 > M1
  6182        CONTINUE
  6183     ELSE
  6184        MOVE WS-WORK-FIELD (1:A1 - 1)
  6185                                 TO OUT-BENE-NAME
  6186     END-IF
  6187     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  6188         MOVE '0000000000 '  TO OUT-CERT-NO
  6189     END-IF
  6190     MOVE +1 TO M1
  6191     MOVE SPACES TO BL-RECORD-PASSED-DATA
  6192     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  6193                                 TO NS-LEN
  6194     display ' naper output data length ' ns-len
  6195     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6196        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  6197        OR (A1 > NS-LEN)
  6198        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  6199           CONTINUE
  6200        ELSE
  6201           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  6202              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  6203              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  6204              ADD +1 TO M1
  6205           ELSE
  6206              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  6207                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  6208                 ADD +3 TO M1
  6209              ELSE
  6210                 MOVE NAPER-OUTPUT-DATA (A1:1)
  6211                                 TO BL-RECORD-PASSED-DATA (M1:1)
  6212                 ADD +1 TO M1
  6213              END-IF
  6214           END-IF
  6215        END-IF
  6216     END-PERFORM
  6217     .
  6218 0500-EXIT.
  6219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 109
* NSRASBL.cbl
  6220 0600-GET-ERENDT.
  6221
  6222* EXEC CICS READ
  6223*         DATASET    ('ERENDT2')
  6224*         INTO       (ENDORSEMENT-RECORD)
  6225*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  6226*         RESP       (WS-RESPONSE)
  6227*    END-EXEC
  6228     MOVE LENGTH OF
  6229      ENDORSEMENT-RECORD
  6230       TO DFHEIV11
  6231     MOVE 'ERENDT2' TO DFHEIV1
  6232*    MOVE '&"IL       E          (  N#00006092' TO DFHEIV0
  6233     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6234     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6235     MOVE X'204E233030303036303932' TO DFHEIV0(25:11)
  6236     CALL 'kxdfhei1' USING DFHEIV0,
  6237           DFHEIV1,
  6238           ENDORSEMENT-RECORD,
  6239           DFHEIV11,
  6240           WS-ERENDT-KEY-BY-ARCH,
  6241           DFHEIV99,
  6242           DFHEIV99,
  6243           DFHEIV99
  6244     MOVE EIBRESP  TO WS-RESPONSE
  6245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6246     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  6247         WS-ERENDT-ARCHIVE
  6248     IF (RESP-NORMAL)
  6249        SET ENDT-FOUND TO TRUE
  6250        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  6251        PERFORM 0650-PROCESS-NO-Change
  6252                                 THRU 0650-EXIT
  6253     END-IF
  6254     .
  6255 0600-EXIT.
  6256     EXIT.
  6257 0620-BUILD-ENDT.
  6258     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  6259                                    OUT-NEW-LF-CAN-DT
  6260                                    OUT-ORIG-AH-CAN-DT
  6261                                    OUT-NEW-AH-CAN-DT
  6262                                    OUT-ORIG-CAN-DT
  6263                                    OUT-NEW-CAN-DT
  6264     IF EN-REC-TYPE = 'C'
  6265        GO TO 0620-PROCESS-CANCEL
  6266     END-IF
  6267     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  6268     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  6269     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6270     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  6271     IF WS-LF-EARN = 'B'
  6272        MOVE 'B'                 TO OUT-BALLOON-IND
  6273     END-IF
  6274     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  6275     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  6276     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  6277     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 110
* NSRASBL.cbl
  6278     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  6279     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  6280     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  6281     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  6282         MOVE ZERO                 TO OUT-ORIG-IAGE
  6283     ELSE
  6284         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  6285     END-IF
  6286     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  6287     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  6288     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  6289     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  6290         MOVE ZERO                 TO OUT-ORIG-JAGE
  6291     ELSE
  6292         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  6293     END-IF
  6294     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  6295     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  6296     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  6297     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  6298     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  6299     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  6300     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6301                             EN-LF-ORIG-ALT-PRM-AMT
  6302     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  6303     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  6304         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  6305                                    OUT-ORIG-LF-PRM-A
  6306                                    OUT-ORIG-LF-ALT-BEN-A
  6307                                    OUT-ORIG-LF-ALT-PRM-A
  6308                                    OUT-ORIG-COVERAGE-IND
  6309     ELSE
  6310         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  6311         IF EN-LF-ORIG-PRM-AMT = .01
  6312             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  6313         END-IF
  6314         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  6315             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  6316         END-IF
  6317         IF EN-LF-ORIG-ALT-PRM-AMT = .01
  6318             MOVE SPACES         TO OUT-ORIG-LF-ALT-PRM-A
  6319         END-IF
  6320         IF EN-LF-ORIG-ALT-BEN-AMT = 999999999.99
  6321             MOVE SPACES         TO OUT-ORIG-LF-ALT-BEN-A
  6322         END-IF
  6323     END-IF
  6324     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6325     MOVE ' '                    TO DC-OPTION-CODE
  6326     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6327     IF NO-CONVERSION-ERROR
  6328        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6329           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6330              INTO OUT-ORIG-LF-EXP-DT
  6331        END-STRING
  6332     END-IF
  6333     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  6334     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  6335     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 111
* NSRASBL.cbl
  6336     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  6337     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6338         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  6339                                    OUT-ORIG-AH-PRM-A
  6340     ELSE
  6341        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  6342            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  6343        ELSE
  6344            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  6345        END-IF
  6346        IF EN-AH-ORIG-PRM-AMT = .01
  6347            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  6348        END-IF
  6349        IF EN-AH-ORIG-BEN-AMT = 9999999.99
  6350            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  6351        END-IF
  6352     END-IF
  6353     COMPUTE WS-WORK-PREM =
  6354        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  6355           + EN-AH-ORIG-PRM-AMT
  6356     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  6357     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6358     MOVE ' '                    TO DC-OPTION-CODE
  6359     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6360     IF NO-CONVERSION-ERROR
  6361        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6362           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6363              INTO OUT-ORIG-AH-EXP-DT
  6364        END-STRING
  6365     END-IF
  6366     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  6367                                    OUT-ORIG-MAX-PMTS
  6368     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6369         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  6370     END-IF
  6371     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  6372     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  6373     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  6374     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  6375         MOVE ZERO                TO OUT-NEW-IAGE
  6376     ELSE
  6377         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  6378     END-IF
  6379     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  6380     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  6381     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  6382     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  6383         MOVE ZERO                TO OUT-NEW-JAGE
  6384     ELSE
  6385         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  6386     END-IF
  6387     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  6388     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  6389     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6390     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  6391     IF WS-LF-EARN = 'B'
  6392        MOVE 'B'                 TO OUT-BALLOON-IND
  6393     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 112
* NSRASBL.cbl
  6394     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  6395     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6396     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6397     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6398     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6399     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6400     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6401     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6402     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6403     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6404     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6405                             EN-LF-NEW-ALT-PRM-AMT
  6406     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6407     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6408         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6409                                    OUT-NEW-LF-PRM-A
  6410                                    OUT-NEW-LF-ALT-BEN-A
  6411                                    OUT-NEW-LF-ALT-PRM-A
  6412                                    OUT-NEW-LF-CMB-PREM-A
  6413                                    OUT-NEW-COVERAGE-IND
  6414     ELSE
  6415         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6416     END-IF
  6417    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  6418     MOVE ' '                     TO DC-OPTION-CODE
  6419     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6420     IF NO-CONVERSION-ERROR
  6421        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6422           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6423              INTO OUT-NEW-LF-EXP-DT
  6424        END-STRING
  6425     END-IF
  6426     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6427     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6428     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6429     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6430     COMPUTE WS-WORK-PREM =
  6431        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6432           + EN-AH-NEW-PRM-AMT
  6433     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6434     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6435         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6436                                    OUT-NEW-AH-PRM-A
  6437     ELSE
  6438        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6439            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6440        ELSE
  6441            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6442        END-IF
  6443     END-IF
  6444     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6445     MOVE ' '                     TO DC-OPTION-CODE
  6446     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6447     IF NO-CONVERSION-ERROR
  6448        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6449           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6450              INTO OUT-NEW-AH-EXP-DT
  6451        END-STRING
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 113
* NSRASBL.cbl
  6452     END-IF
  6453     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6454                                     OUT-NEW-MAX-PMTS
  6455     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6456         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6457     END-IF
  6458     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6459        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6460     ELSE
  6461        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6462     END-IF
  6463     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6464        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6465     ELSE
  6466        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6467     END-IF
  6468     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6469        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6470     ELSE
  6471        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6472     END-IF
  6473     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6474        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6475     ELSE
  6476        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6477     END-IF
  6478     COMPUTE WS-WORK-PREM =
  6479        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6480        EN-AH-NEW-PRM-AMT) -
  6481        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6482        EN-AH-ORIG-PRM-AMT)
  6483     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6484     IF EN-CSO-PORTION NOT NUMERIC
  6485        MOVE ZEROS               TO EN-CSO-PORTION
  6486     END-IF
  6487     IF EN-ACCT-PORTION NOT NUMERIC
  6488        MOVE ZERO                TO EN-ACCT-PORTION
  6489     END-IF
  6490*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6491*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6492     IF WS-WORK-PREM > +0
  6493        MOVE 'CSO'               TO OUT-PAYEE
  6494     ELSE
  6495      IF WS-WORK-PREM = +0
  6496         MOVE 'ZERO'             TO OUT-PAYEE
  6497      ELSE
  6498         MOVE 'ACCT'             TO OUT-PAYEE
  6499      END-IF
  6500     END-IF
  6501     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6502        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6503     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6504     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6505        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6506     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6507     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6508        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6509        * EN-LF-ORIG-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 114
* NSRASBL.cbl
  6510     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6511     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6512        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6513     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6514     COMPUTE WS-ACCT-ORIG-PORTION =
  6515        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6516     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6517
  6518     COMPUTE WS-CSO-ORIG-LF-PORT =
  6519       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6520     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6521     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6522       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6523     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6524     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6525       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6526        WS-ACCT-ORIG-CMB-LF-PORT
  6527     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6528     COMPUTE WS-CSO-ORIG-AH-PORT =
  6529        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6530     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6531     COMPUTE WS-CSO-ORIG-PORTION =
  6532        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6533     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6534     COMPUTE WS-ACCT-NEW-LF-PORT =
  6535        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6536     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6537     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6538        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6539     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6540     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6541        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6542        * EN-LF-NEW-COMM-PCT
  6543     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6544     COMPUTE WS-ACCT-NEW-AH-PORT =
  6545        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6546     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6547     COMPUTE WS-ACCT-NEW-PORTION =
  6548        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6549     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6550
  6551     COMPUTE WS-CSO-NEW-LF-PORT =
  6552       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6553     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6554     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6555       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6556     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6557     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6558       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6559        WS-ACCT-NEW-CMB-LF-PORT
  6560     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6561     COMPUTE WS-CSO-NEW-AH-PORT =
  6562        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6563     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6564     COMPUTE WS-CSO-NEW-PORTION =
  6565        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6566     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6567
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 115
* NSRASBL.cbl
  6568     COMPUTE WS-ACCT-LF-PORT-CHG =
  6569        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6570     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6571     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6572        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6573     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6574     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6575        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6576     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6577     COMPUTE WS-ACCT-AH-PORT-CHG =
  6578        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6579     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6580     COMPUTE WS-ACCT-PORTION-CHG =
  6581        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6582     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6583
  6584     COMPUTE WS-CSO-LF-PORT-CHG =
  6585        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6586     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6587     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6588        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6589     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6590     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6591        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6592     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6593     COMPUTE WS-CSO-AH-PORT-CHG =
  6594        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6595     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6596     COMPUTE WS-CSO-PORTION-CHG =
  6597        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6598     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6599
  6600     COMPUTE WS-WORK-PREM =
  6601         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6602     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6603     COMPUTE WS-WORK-PREM =
  6604         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6605     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6606     COMPUTE WS-WORK-PREM =
  6607        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6608        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6609     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6610     COMPUTE WS-WORK-PREM =
  6611        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6612     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6613
  6614     move en-sig-sw              to out-sig-sw
  6615     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6616     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6617     GO TO 0620-CONTINUE
  6618     .
  6619 0620-PROCESS-CANCEL.
  6620     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6621        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6622        MOVE ' '                 TO DC-OPTION-CODE
  6623        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6624        IF NO-CONVERSION-ERROR
  6625           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 116
* NSRASBL.cbl
  6626              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6627                 INTO OUT-ORIG-LF-CAN-DT
  6628           END-STRING
  6629        END-IF
  6630        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6631     END-IF
  6632
  6633     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6634        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6635        MOVE ' '                 TO DC-OPTION-CODE
  6636        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6637        IF NO-CONVERSION-ERROR
  6638           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6639              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6640                 INTO OUT-NEW-LF-CAN-DT
  6641           END-STRING
  6642        END-IF
  6643        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6644     END-IF
  6645
  6646     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6647        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6648        MOVE ' '                    TO DC-OPTION-CODE
  6649        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6650        IF NO-CONVERSION-ERROR
  6651           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6652              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6653                 INTO OUT-ORIG-AH-CAN-DT
  6654           END-STRING
  6655        END-IF
  6656        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6657           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6658        END-IF
  6659     END-IF
  6660
  6661     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6662        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6663        MOVE ' '                    TO DC-OPTION-CODE
  6664        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6665        IF NO-CONVERSION-ERROR
  6666           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6667              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6668                 INTO OUT-NEW-AH-CAN-DT
  6669           END-STRING
  6670        END-IF
  6671        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6672           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6673        END-IF
  6674     END-IF
  6675     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6676     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6677     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6678     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6679     COMPUTE WS-WORK-PREM =
  6680        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6681     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6682     COMPUTE WS-WORK-PREM =
  6683        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 117
* NSRASBL.cbl
  6684     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6685     COMPUTE WS-WORK-PREM =
  6686        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6687        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6688     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6689
  6690     COMPUTE WS-WORK-PREM =
  6691        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6692     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6693     COMPUTE WS-WORK-PREM =
  6694        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6695     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6696
  6697*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6698*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6699     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6700
  6701     IF EN-COMM-CHGBK = 'N'
  6702         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6703                                   OUT-CSO-ORIG-ALT-LF-PORT
  6704         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6705         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6706         COMPUTE WS-CSO-ORIG-PORTION =
  6707             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6708         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6709         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6710                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6711                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6712                                   OUT-ACCT-ORIG-AH-PORT
  6713                                   OUT-ACCT-ORIG-PORTION
  6714
  6715         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6716                                   OUT-CSO-NEW-ALT-LF-PORT
  6717         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6718         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6719         COMPUTE WS-CSO-NEW-PORTION =
  6720             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6721         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6722         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6723                                   OUT-ACCT-NEW-ALT-LF-PORT
  6724                                   OUT-ACCT-NEW-CMB-LF-PORT
  6725                                   OUT-ACCT-NEW-AH-PORT
  6726                                   OUT-ACCT-NEW-PORTION
  6727
  6728         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6729                                   OUT-CSO-ALT-LF-PORT-CHG
  6730         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6731           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6732         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6733         COMPUTE WS-CSO-AH-PORT-CHG =
  6734           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6735         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6736         COMPUTE WS-CSO-PORTION-CHG =
  6737           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6738           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6739         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6740         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6741                                   OUT-ACCT-ALT-LF-PORT-CHG
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 118
* NSRASBL.cbl
  6742                                   OUT-ACCT-CMB-LF-PORT-CHG
  6743                                   OUT-ACCT-AH-PORT-CHG
  6744                                   OUT-ACCT-PORTION-CHG
  6745     ELSE
  6746         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6747                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6748         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6749           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6750         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6751                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6752         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6753           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6754         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6755         COMPUTE WS-ACCT-ORIG-PORTION =
  6756            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6757         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6758
  6759         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6760                                   OUT-CSO-ORIG-ALT-LF-PORT
  6761         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6762           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6763         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6764         COMPUTE WS-CSO-ORIG-AH-PORT =
  6765           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6766         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6767         COMPUTE WS-CSO-ORIG-PORTION =
  6768            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6769         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6770
  6771         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6772                                   OUT-ACCT-NEW-ALT-LF-PORT
  6773         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6774           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6775         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6776         COMPUTE WS-ACCT-NEW-AH-PORT =
  6777           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6778         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6779         COMPUTE WS-ACCT-NEW-PORTION =
  6780            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6781         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6782
  6783         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6784                                   OUT-CSO-NEW-ALT-LF-PORT
  6785         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6786           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6787         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6788         COMPUTE WS-CSO-NEW-AH-PORT =
  6789           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6790         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6791         COMPUTE WS-CSO-NEW-PORTION =
  6792            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6793         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6794
  6795         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6796                                    OUT-ACCT-ALT-LF-PORT-CHG
  6797         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6798            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6799         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 119
* NSRASBL.cbl
  6800         COMPUTE WS-ACCT-AH-PORT-CHG =
  6801            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6802         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6803         COMPUTE WS-ACCT-PORTION-CHG =
  6804            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6805         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6806
  6807         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6808                                    OUT-CSO-ALT-LF-PORT-CHG
  6809         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6810            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6811         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6812         COMPUTE WS-CSO-AH-PORT-CHG =
  6813            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6814         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6815         COMPUTE WS-CSO-PORTION-CHG =
  6816            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6817         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6818
  6819     END-IF
  6820     .
  6821 0620-CONTINUE.
  6822     display ' about to bld reason codes ' en-reason-code (1)
  6823     move en-reason-code (1)     to out-rea-cd1
  6824     move en-reason-code (2)     to out-rea-cd2
  6825     move en-reason-code (3)     to out-rea-cd3
  6826     move en-reason-code (4)     to out-rea-cd4
  6827     move en-reason-code (5)     to out-rea-cd5
  6828     move en-reason-code (6)     to out-rea-cd6
  6829     move en-reason-code (7)     to out-rea-cd7
  6830     move en-reason-code (8)     to out-rea-cd8
  6831     move en-reason-code (9)     to out-rea-cd9
  6832     move en-reason-code (10)    to out-rea-cd10
  6833     move en-reason-code (11)    to out-rea-cd11
  6834     move en-reason-code (12)    to out-rea-cd12
  6835*    PERFORM 1300-DETERMINE-COMM
  6836*                                THRU 1300-EXIT
  6837     .
  6838 0620-EXIT.
  6839     EXIT.
  6840 0650-PROCESS-NO-Change.
  6841     IF EN-REC-TYPE = 'C'
  6842        GO TO 0650-PROCESS-CANCEL
  6843     END-IF
  6844     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6845        AND (OUT-NEW-ILNAME NOT = SPACES))
  6846                      AND
  6847        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6848        AND (OUT-NEW-IFNAME NOT = SPACES))
  6849                      AND
  6850        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6851        AND (OUT-NEW-IFNAME NOT = SPACES))
  6852        move 'No Change'         to out-new-Ifname
  6853        MOVE SPACES              TO OUT-NEW-IMINIT
  6854        move spaces              to out-new-Ilname
  6855     ELSE
  6856         IF OUT-NEW-ILNAME = SPACES
  6857           AND OUT-NEW-IFNAME = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 120
* NSRASBL.cbl
  6858           AND OUT-NEW-IMINIT = SPACES
  6859           AND OUT-ORIG-ILNAME NOT = SPACES
  6860            MOVE 'None'          TO OUT-NEW-IFNAME
  6861            MOVE SPACES          TO OUT-NEW-IMINIT
  6862            MOVE SPACES          TO OUT-NEW-ILNAME
  6863         END-IF
  6864     END-IF
  6865     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6866        AND (OUT-NEW-JLNAME NOT = SPACES))
  6867                    AND
  6868        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6869        AND (OUT-NEW-JFNAME NOT = SPACES))
  6870                    AND
  6871        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6872        AND (OUT-NEW-JFNAME NOT = SPACES))
  6873        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6874        MOVE SPACES              TO OUT-NEW-JMINIT
  6875        MOVE SPACES              TO OUT-NEW-JLNAME
  6876     ELSE
  6877         IF OUT-NEW-JLNAME = SPACES
  6878           AND OUT-NEW-JFNAME = SPACES
  6879           AND OUT-NEW-JMINIT = SPACES
  6880           AND OUT-ORIG-JLNAME NOT = SPACES
  6881            MOVE 'None'          TO OUT-NEW-JFNAME
  6882            MOVE SPACES          TO OUT-NEW-JMINIT
  6883            MOVE SPACES          TO OUT-NEW-JLNAME
  6884         END-IF
  6885     END-IF
  6886     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6887        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6888        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6889     ELSE
  6890         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6891           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6892             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6893         END-IF
  6894     END-IF
  6895     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6896        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6897        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6898     ELSE
  6899         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6900           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6901             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6902         END-IF
  6903     END-IF
  6904     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6905        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6906        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6907     ELSE
  6908         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6909           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6910             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6911         END-IF
  6912     END-IF
  6913     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6914        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6915        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 121
* NSRASBL.cbl
  6916     ELSE
  6917         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6918           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6919             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6920         END-IF
  6921     END-IF
  6922
  6923     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6924                              EN-LF-ORIG-ALT-PRM-AMT
  6925     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6926                               EN-LF-NEW-ALT-PRM-AMT
  6927     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6928        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6929        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6930     ELSE
  6931         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6932           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6933            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6934         END-IF
  6935     END-IF
  6936     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6937        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6938     END-IF
  6939     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6940        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6941        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6942     END-IF
  6943     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6944        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6945        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6946     ELSE
  6947        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6948          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6949            MOVE 'None'          TO OUT-NEW-LF-DESC
  6950        END-IF
  6951     end-if
  6952     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6953       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6954        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6955     END-IF
  6956     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6957        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6958        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6959     ELSE
  6960         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6961           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6962             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6963         END-IF
  6964     END-IF
  6965     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6966        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6967        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6968     ELSE
  6969         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6970           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6971             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6972         END-IF
  6973     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 122
* NSRASBL.cbl
  6974     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6975        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6976        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6977     ELSE
  6978         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6979           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6980             MOVE 'None'         TO OUT-NEW-AH-DESC
  6981         END-IF
  6982     END-IF
  6983     IF EN-INS-ORIG-AGE-DEF-FLAG <> 'Y'
  6984         MOVE 'N' TO EN-INS-ORIG-AGE-DEF-FLAG
  6985     END-IF
  6986     IF EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6987         MOVE 'N' TO EN-INS-NEW-AGE-DEF-FLAG
  6988     END-IF
  6989     IF EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y'
  6990         MOVE 'N' TO EN-JNT-ORIG-AGE-DEF-FLAG
  6991     END-IF
  6992     IF EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6993         MOVE 'N' TO EN-JNT-NEW-AGE-DEF-FLAG
  6994     END-IF
  6995
  6996     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6997       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  6998       AND EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6999       AND EN-INS-NEW-LAST-NAME = EN-INS-ORIG-LAST-NAME
  7000       AND EN-INS-NEW-FIRST-NAME = EN-INS-ORIG-FIRST-NAME
  7001       AND EN-INS-NEW-MIDDLE-INIT = EN-INS-ORIG-MIDDLE-INIT
  7002        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  7003     END-IF
  7004     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  7005        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  7006        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  7007        AND EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  7008        AND EN-JNT-NEW-LAST-NAME = EN-JNT-ORIG-LAST-NAME
  7009        AND EN-JNT-NEW-FIRST-NAME = EN-JNT-ORIG-FIRST-NAME
  7010        AND EN-JNT-NEW-MIDDLE-INIT = EN-JNT-ORIG-MIDDLE-INIT
  7011        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  7012     ELSE
  7013         IF (EN-JNT-ORIG-AGE > ZEROS)
  7014           AND (EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y')
  7015           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  7016             MOVE 'None'         TO OUT-NEW-JAGE-A
  7017         END-IF
  7018     END-IF
  7019     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  7020        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  7021        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  7022     ELSE
  7023         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  7024           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  7025             MOVE ZEROS          TO OUT-NEW-LF-TERM
  7026         END-IF
  7027     END-IF
  7028     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  7029        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  7030        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  7031     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 123
* NSRASBL.cbl
  7032         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7033           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7034             MOVE ZEROS          TO OUT-NEW-AH-TERM
  7035         END-IF
  7036     END-IF
  7037     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  7038        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  7039        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  7040                                    OUT-NEW-MAX-PMTS-A
  7041     ELSE
  7042         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7043           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7044             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  7045                                    OUT-NEW-MAX-PMTS-A
  7046         END-IF
  7047     END-IF
  7048     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  7049        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  7050     END-IF
  7051     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  7052       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  7053         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  7054     ELSE
  7055         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7056           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7057             MOVE 'None'         TO OUT-NEW-WAIT-PER
  7058         END-IF
  7059     END-IF
  7060     .
  7061 0650-PROCESS-CANCEL.
  7062     .
  7063 0650-EXIT.
  7064     EXIT.
  7065 0700-WRITE-EXTR.
  7066     display ' made it to 0700 '
  7067     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  7068     IF BL-FAIL
  7069        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  7070        GO TO 0700-EXIT
  7071     END-IF
  7072     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  7073     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  7074     MOVE +0                     TO NSAS-SEQ-NO
  7075     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  7076     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  7077     IF BL-FAIL
  7078        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  7079        GO TO 0700-EXIT
  7080     END-IF
  7081     IF W-LETTER-TO-ACCT NOT = SPACES
  7082        display ' acct ne spaces ' bl-archive-no
  7083        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  7084        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7085        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7086        MOVE +1                  TO NSAS-SEQ-NO
  7087        PERFORM 0720-WRITE-NSASEXTR
  7088                                 THRU 0720-EXIT
  7089        IF BL-FAIL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 124
* NSRASBL.cbl
  7090           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  7091           GO TO 0700-EXIT
  7092        END-IF
  7093     END-IF
  7094     IF W-LETTER-TO-BENE NOT = SPACES
  7095        display ' bene ne spaces ' bl-archive-no
  7096        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  7097        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7098        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7099        MOVE +2                  TO NSAS-SEQ-NO
  7100        PERFORM 0720-WRITE-NSASEXTR
  7101                                 THRU 0720-EXIT
  7102        IF BL-FAIL
  7103           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  7104        END-IF
  7105     END-IF
  7106     IF W-PRINT-CERTIFICATE = 'Y' AND
  7107        BL-STATE = 'VA'
  7108           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  7109           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  7110           MOVE BL-CARRIER          TO VD-CARRIER
  7111           MOVE BL-GROUP            TO VD-GROUPING
  7112           MOVE BL-STATE            TO VD-STATE
  7113           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  7114           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  7115           MOVE BL-CERT-NO          TO VD-CERT-NO
  7116           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  7117           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  7118           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  7119           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  7120           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  7121           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  7122           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  7123           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  7124           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  7125           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  7126           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  7127           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  7128           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  7129           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  7130           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  7131           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  7132           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  7133           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  7134           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  7135           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  7136           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  7137           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  7138           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  7139           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  7140           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  7141           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  7142           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  7143           MOVE 'VADS'              TO VD-LETTER-ID
  7144           MOVE OUT-PROC-ID         TO VD-PROC-ID
  7145           MOVE BL-COMP-ID          TO VD-COMP-ID
  7146           MOVE EIBTIME             TO VD-CURRENT-TIME
  7147           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 125
* NSRASBL.cbl
  7148           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  7149           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  7150
  7151* EXEC CICS LINK
  7152*              PROGRAM    (LINK-ELVADS)
  7153*              COMMAREA   (WS-PASS-AREA)
  7154*              LENGTH     (WS-PASS-AREA-LENGTH)
  7155*          END-EXEC
  7156*    MOVE '."C                   (   #00007002' TO DFHEIV0
  7157     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7159     MOVE X'2020233030303037303032' TO DFHEIV0(25:11)
  7160     CALL 'kxdfhei1' USING DFHEIV0,
  7161           LINK-ELVADS,
  7162           WS-PASS-AREA,
  7163           WS-PASS-AREA-LENGTH,
  7164           DFHEIV99,
  7165           DFHEIV99,
  7166           DFHEIV99,
  7167           DFHEIV99
  7168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7169     END-IF
  7170     .
  7171 0700-EXIT.
  7172     EXIT.
  7173  0710-BUILD-NSASEXTR.
  7174***  i added the extra space in front of the 1st ~
  7175***  only because there may be a letter to acct or bene
  7176     STRING
  7177         OUT-LETTER             ' ~'
  7178         OUT-PROC-ID            '~'
  7179         OUT-PROC-NAME          '~'
  7180         OUT-PROC-TITLE         '~'
  7181         OUT-CSR-NAME           '~'
  7182         OUT-CSR-TITLE          '~'
  7183         OUT-CARRIER            '~'
  7184         OUT-GROUPING           '~'
  7185         OUT-STATE              '~'
  7186         OUT-ACCOUNT            '~'
  7187         OUT-CERT-EFF-DT        '~'
  7188         OUT-CERT-NO            '~'
  7189         OUT-CERT-SFX           '~'
  7190         OUT-ILNAME             '~'
  7191         OUT-IFNAME             '~'
  7192         OUT-IFINIT             '~'
  7193         OUT-IMINIT             '~'
  7194         OUT-IAGE               '~'
  7195         OUT-ISEX               '~'
  7196         OUT-INS-ADDR1          '~'
  7197         OUT-INS-ADDR2          '~'
  7198         OUT-INS-CITY           '~'
  7199         OUT-INS-STATE          '~'
  7200         OUT-INS-ZIP            '~'
  7201         OUT-SOC-SEC-NO         '~'
  7202         OUT-MEMBER-NO          '~'
  7203         OUT-JLNAME             '~'
  7204         OUT-JFNAME             '~'
  7205         OUT-JMINIT             '~'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 126
* NSRASBL.cbl
  7206         OUT-JAGE               '~'
  7207         OUT-ACCT-NAME          '~'
  7208         OUT-ACCT-ADDR1         '~'
  7209         OUT-ACCT-ADDR2         '~'
  7210         OUT-ACCT-CITY          '~'
  7211         OUT-ACCT-STATE         '~'
  7212         OUT-ACCT-ZIP           '~'
  7213         OUT-ACCT-PHONE         '~'
  7214         OUT-ACCT-CNTRL-NAME    '~'
  7215         OUT-ACCT-BUS-TYPE      '~'
  7216         OUT-BENE-NAME          '~'
  7217         OUT-BENE-ADDR1         '~'
  7218         OUT-BENE-ADDR2         '~'
  7219         OUT-BENE-CITY          '~'
  7220         OUT-BENE-STATE         '~'
  7221         OUT-BENE-ZIP           '~'
  7222         OUT-CARR-NAME          '~'
  7223         OUT-RESP-NO            '~'
  7224         OUT-COMP-NAME          '~'
  7225         OUT-COMP-MAIL-TO       '~'
  7226         OUT-COMP-ADDR1         '~'
  7227         OUT-COMP-ADDR2         '~'
  7228         OUT-COMP-CITY          '~'
  7229         OUT-COMP-STATE         '~'
  7230         OUT-COMP-ZIP           '~'
  7231         OUT-COMP-PHONE         '~'
  7232         OUT-COMP-FAX           '~'
  7233         OUT-COMP-STATUS        '~'
  7234         OUT-BILL-SW            '~'
  7235         OUT-RPT-CD1            '~'
  7236         OUT-RPT-CD2            '~'
  7237         OUT-ENTRY-DT           '~'
  7238         OUT-ENTRY-BATCH        '~'
  7239         OUT-ENTRY-STATUS       '~'
  7240         OUT-1ST-PMT-DT         '~'
  7241         OUT-LOAN-APR           '~'
  7242         OUT-LOAN-TERM          '~'
  7243         OUT-RATE-CLASS         '~'
  7244         OUT-EXT-DAYS           '~'
  7245         OUT-CSR-CODE           '~'
  7246         OUT-UCODE              '~'
  7247         OUT-PREM-TYPE          '~'
  7248         OUT-IND-GRP            '~'
  7249         OUT-SKIP-CD            '~'
  7250         OUT-PMT-MODE           '~'
  7251         OUT-LOAN-OFF           '~'
  7252         OUT-REIN-TABLE         '~'
  7253         OUT-SPEC-REIN          '~'
  7254         OUT-LF-BENCD           '~'
  7255         OUT-LF-TERM            '~'
  7256         OUT-LF-DEV-CD          '~'
  7257         OUT-LF-DEV-PCT         '~'
  7258         OUT-LF-BEN             '~'
  7259         OUT-LF-PRM             '~'
  7260         OUT-LF-ALT-BEN         '~'
  7261         OUT-LF-ALT-PRM         '~'
  7262         OUT-LF-NSP             '~'
  7263         OUT-LF-REM-BEN         '~'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 127
* NSRASBL.cbl
  7264         OUT-LF-REF             '~'
  7265         OUT-LF-DTH             '~'
  7266         OUT-LF-RATE            '~'
  7267         OUT-LF-ALT-RATE        '~'
  7268         OUT-LF-EXP-DT          '~'
  7269         OUT-LF-CUR-STATUS      '~'
  7270         OUT-LF-CAN-DT          '~'
  7271         OUT-LF-CAN-EXIT-DT     '~'
  7272         OUT-LF-DTH-DT          '~'
  7273         OUT-LF-DTH-EXIT-DT     '~'
  7274         OUT-LF-EXIT-BATCH      '~'
  7275         OUT-LF-COMM-PCT        '~'
  7276         OUT-LF-DESC            '~'
  7277         OUT-LF-ABBRV           '~'
  7278         OUT-AH-BENCD           '~'
  7279         OUT-AH-TERM            '~'
  7280         OUT-CRIT-PER           '~'
  7281         OUT-AH-DEV-CD          '~'
  7282         OUT-AH-DEV-PCT         '~'
  7283         OUT-AH-BEN             '~'
  7284         OUT-AH-PRM             '~'
  7285         OUT-AH-NSP             '~'
  7286         OUT-AH-REF             '~'
  7287         OUT-AH-CLM             '~'
  7288         OUT-AH-TOT-BEN         '~'
  7289         OUT-AH-PDTHRU-DT       '~'
  7290         OUT-AH-RATE            '~'
  7291         OUT-AH-EXP-DT          '~'
  7292         OUT-AH-CUR-STATUS      '~'
  7293         OUT-AH-CAN-DT          '~'
  7294         OUT-AH-CAN-EXIT-DT     '~'
  7295         OUT-AH-EXIT-BATCH      '~'
  7296         OUT-AH-COMM-PCT        '~'
  7297         OUT-AH-DESC            '~'
  7298         OUT-RET-ELIM           '~'
  7299         OUT-BEN-DAYS           '~'
  7300         OUT-WAIT-PER           '~'
  7301         OUT-MAX-PMTS           '~'
  7302         OUT-TOT-PRM            '~'
  7303         OUT-TOT-REF            '~'
  7304         OUT-SCHED-EXP-DT       '~'
  7305         OUT-SCHED-TERM         '~'
  7306         OUT-ORIG-ILNAME        '~'
  7307         OUT-ORIG-IFNAME        '~'
  7308         OUT-ORIG-MINIT         '~'
  7309         OUT-ORIG-IAGE          '~'
  7310         OUT-ORIG-JLNAME        '~'
  7311         OUT-ORIG-JFNAME        '~'
  7312         OUT-ORIG-JMINIT        '~'
  7313         OUT-ORIG-JAGE          '~'
  7314         OUT-ORIG-LF-BENCD      '~'
  7315         OUT-ORIG-LF-TERM       '~'
  7316         OUT-ORIG-LF-BEN        '~'
  7317         OUT-ORIG-LF-PRM        '~'
  7318         OUT-LF-CALC-PRM        '~'
  7319         OUT-ORIG-LF-REF        '~'
  7320         OUT-LF-CALC-REF        '~'
  7321         OUT-ORIG-LF-ALT-BEN    '~'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 128
* NSRASBL.cbl
  7322         OUT-ORIG-LF-ALT-PRM    '~'
  7323         OUT-ORIG-LF-EXP-DT     '~'
  7324         OUT-ORIG-LF-DESC       '~'
  7325         OUT-ORIG-AH-BENCD      '~'
  7326         OUT-ORIG-AH-TERM       '~'
  7327         OUT-ORIG-CRIT-PER      '~'
  7328         OUT-ORIG-AH-BEN        '~'
  7329         OUT-ORIG-AH-PRM        '~'
  7330         OUT-AH-CALC-PRM        '~'
  7331         OUT-ORIG-AH-REF        '~'
  7332         OUT-AH-CALC-REF        '~'
  7333         OUT-ORIG-AH-EXP-DT     '~'
  7334         OUT-ORIG-AH-DESC       '~'
  7335         OUT-ORIG-RET-ELIM      '~'
  7336         OUT-ORIG-BEN-DAYS      '~'
  7337         OUT-ORIG-WAIT-PER      '~'
  7338         OUT-ORIG-MAX-PMTS      '~'
  7339         OUT-ORIG-SCHED-EXP-DT  '~'
  7340         OUT-ORIG-SCHED-TERM    '~'
  7341         OUT-NEW-ILNAME         '~'
  7342         OUT-NEW-IFNAME         '~'
  7343         OUT-NEW-IMINIT         '~'
  7344         OUT-NEW-IAGE           '~'
  7345         OUT-NEW-JLNAME         '~'
  7346         OUT-NEW-JFNAME         '~'
  7347         OUT-NEW-JMINIT         '~'
  7348         OUT-NEW-JAGE           '~'
  7349         OUT-NEW-LF-BENCD       '~'
  7350         OUT-NEW-LF-TERM        '~'
  7351         OUT-NEW-LF-BEN         '~'
  7352         OUT-NEW-LF-PRM         '~'
  7353         OUT-NEW-LF-REF         '~'
  7354         OUT-NEW-LF-ALT-BEN     '~'
  7355         OUT-NEW-LF-ALT-PRM     '~'
  7356         OUT-NEW-LF-EXP-DT      '~'
  7357         OUT-NEW-LF-DESC        '~'
  7358         OUT-NEW-AH-BENCD       '~'
  7359         OUT-NEW-AH-TERM        '~'
  7360         OUT-NEW-CRIT-PER       '~'
  7361         OUT-NEW-AH-BEN         '~'
  7362         OUT-NEW-AH-PRM         '~'
  7363         OUT-NEW-AH-REF         '~'
  7364         OUT-NEW-AH-EXP-DT      '~'
  7365         OUT-NEW-AH-DESC        '~'
  7366         OUT-NEW-RET-ELIM       '~'
  7367         OUT-NEW-BEN-DAYS       '~'
  7368         OUT-NEW-WAIT-PER       '~'
  7369         OUT-NEW-MAX-PMTS       '~'
  7370         OUT-NEW-SCHED-EXP-DT   '~'
  7371         OUT-NEW-SCHED-TERM     '~'
  7372         OUT-TOT-PRM-CHG        '~'
  7373         OUT-TOT-REF-CHG        '~'
  7374         OUT-PAYEE              '~'
  7375         OUT-SIG-SW             '~'
  7376         OUT-BALLOON-IND        '~'
  7377         OUT-LEASE-IND          '~'
  7378         OUT-RESCIND            '~'
  7379         OUT-REA-CD1            '~'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 129
* NSRASBL.cbl
  7380         OUT-REA-CD2            '~'
  7381         OUT-REA-CD3            '~'
  7382         OUT-REA-CD4            '~'
  7383         OUT-REA-CD5            '~'
  7384         OUT-REA-CD6            '~'
  7385         OUT-REA-CD7            '~'
  7386         OUT-REA-CD8            '~'
  7387         OUT-REA-CD9            '~'
  7388         OUT-REA-CD10           '~'
  7389         OUT-REA-CD11           '~'
  7390         OUT-REA-CD12           '~'
  7391         OUT-CYCLE-DT           '~'
  7392         OUT-ARCH-NO            '~'
  7393         OUT-FORM               '~'
  7394         OUT-ENC-LINE           '~'
  7395         OUT-ATTACH             '~'
  7396         OUT-STACK              '~'
  7397         OUT-STATE-NAME         '~'
  7398         OUT-PRINT-NOW          '~'
  7399         OUT-CHGBACK            '~'
  7400         OUT-CSO-PORTION        '~'
  7401         OUT-ACCT-PORTION       '~'
  7402         OUT-LETTER-TYPE        '~'
  7403         OUT-PRINT-CERTIFICATE  '~'
  7404         OUT-INS-BIRTHDATE      '~'
  7405         OUT-JNT-BIRTHDATE      '~'
  7406         OUT-TOT-INTEREST       '~'
  7407         OUT-ORIG-TOT-PREM      '~'
  7408         OUT-ORIG-TOT-REF       '~'
  7409         OUT-CANCEL-DT          '~'
  7410         OUT-HEALTH-APP         '~'
  7411         OUT-CERTIFICATE-ID     '~'
  7412         OUT-UNDW-ID            '~'
  7413         OUT-NEW-TOT-PREM       '~'
  7414         OUT-NEW-TOT-REF        '~'
  7415         OUT-COVERAGE-IND       '~'
  7416         OUT-ORIG-COVERAGE-IND  '~'
  7417         OUT-NEW-COVERAGE-IND   '~'
  7418         OUT-LF-CMB-PREM        '~'
  7419         OUT-ORIG-LF-CMB-PREM   '~'
  7420         OUT-NEW-LF-CMB-PREM    '~'
  7421         OUT-LF-PREM-CHG        '~'
  7422         OUT-LF-ALT-PREM-CHG    '~'
  7423         OUT-LF-CMB-PREM-CHG    '~'
  7424         OUT-AH-PREM-CHG        '~'
  7425         OUT-LF-REF-CHG         '~'
  7426         OUT-AH-REF-CHG         '~'
  7427         OUT-ACCT-LF-PORTION    '~'
  7428         OUT-ACCT-ALT-LF-PORT   '~'
  7429         OUT-ACCT-CMB-LF-PORT   '~'
  7430         OUT-ACCT-AH-PORTION    '~'
  7431         OUT-CSO-LF-PORTION     '~'
  7432         OUT-CSO-ALT-LF-PORT    '~'
  7433         OUT-CSO-CMB-LF-PORT    '~'
  7434         OUT-CSO-AH-PORTION     '~'
  7435         OUT-ACCT-ORIG-LF-PORT  '~'
  7436         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7437         OUT-ACCT-ORIG-CMB-LF-PORT '~'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 130
* NSRASBL.cbl
  7438         OUT-ACCT-ORIG-AH-PORT  '~'
  7439         OUT-ACCT-ORIG-PORTION  '~'
  7440         OUT-CSO-ORIG-LF-PORT   '~'
  7441         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7442         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7443         OUT-CSO-ORIG-AH-PORT   '~'
  7444         OUT-CSO-ORIG-PORTION   '~'
  7445         OUT-ACCT-NEW-LF-PORT   '~'
  7446         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7447         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7448         OUT-ACCT-NEW-AH-PORT   '~'
  7449         OUT-ACCT-NEW-PORTION   '~'
  7450         OUT-CSO-NEW-LF-PORT    '~'
  7451         OUT-CSO-NEW-ALT-LF-PORT '~'
  7452         OUT-CSO-NEW-CMB-LF-PORT '~'
  7453         OUT-CSO-NEW-AH-PORT    '~'
  7454         OUT-CSO-NEW-PORTION    '~'
  7455         OUT-ACCT-LF-PORT-CHG   '~'
  7456         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7457         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7458         OUT-ACCT-AH-PORT-CHG   '~'
  7459         OUT-ACCT-PORTION-CHG   '~'
  7460         OUT-CSO-LF-PORT-CHG    '~'
  7461         OUT-CSO-ALT-LF-PORT-CHG '~'
  7462         OUT-CSO-CMB-LF-PORT-CHG '~'
  7463         OUT-CSO-AH-PORT-CHG    '~'
  7464         OUT-CSO-PORTION-CHG    '~'
  7465         OUT-ORIG-LF-CAN-DT     '~'
  7466         OUT-NEW-LF-CAN-DT      '~'
  7467         OUT-ORIG-AH-CAN-DT     '~'
  7468         OUT-NEW-AH-CAN-DT      '~'
  7469         OUT-ORIG-CAN-DT        '~'
  7470         OUT-NEW-CAN-DT         '~'
  7471         OUT-SCREEN-ID          '~'
  7472         OUT-NEXT-BUS-DT        '~'
  7473         OUT-VIN-NUMBER         '~'
  7474            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7475     END-STRING
  7476     .
  7477 0710-exit.
  7478     EXIT.
  7479 0720-WRITE-NSASEXTR.
  7480
  7481* EXEC CICS WRITE
  7482*       DATASET    ('NSASEXTR')
  7483*       FROM       (NSAS-EXTRACT-RECORD)
  7484*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7485*       RESP       (WS-RESPONSE)
  7486*    END-EXEC
  7487     MOVE LENGTH OF
  7488      NSAS-EXTRACT-RECORD
  7489       TO DFHEIV11
  7490     MOVE 'NSASEXTR' TO DFHEIV1
  7491*    MOVE '&$ L                  ''  N#00007318' TO DFHEIV0
  7492     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7493     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7494     MOVE X'204E233030303037333138' TO DFHEIV0(25:11)
  7495     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 131
* NSRASBL.cbl
  7496           DFHEIV1,
  7497           NSAS-EXTRACT-RECORD,
  7498           DFHEIV11,
  7499           NSAS-CONTROL-PRIMARY,
  7500           DFHEIV99,
  7501           DFHEIV99
  7502     MOVE EIBRESP  TO WS-RESPONSE
  7503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7504     IF NOT RESP-NORMAL
  7505        display ' bad write nsasextr ' ws-response
  7506        SET BL-FAIL TO TRUE
  7507     END-IF
  7508     .
  7509 0720-EXIT.
  7510     EXIT.
  7511 0800-init-out-data.
  7512     MOVE ZEROS                  TO OUT-IAGE
  7513                                    OUT-JAGE
  7514                                    OUT-LOAN-APR
  7515                                    OUT-LOAN-TERM
  7516                                    OUT-EXT-DAYS
  7517                                    OUT-LF-TERM
  7518                                    OUT-AH-TERM
  7519                                    OUT-LF-DEV-PCT
  7520                                    OUT-AH-DEV-PCT
  7521                                    OUT-LF-BEN
  7522                                    OUT-AH-BEN
  7523                                    OUT-CRIT-PER
  7524                                    OUT-MAX-PMTS
  7525                                    OUT-SCHED-TERM
  7526                                    OUT-ORIG-IAGE
  7527                                    OUT-ORIG-JAGE
  7528                                    OUT-NEW-IAGE
  7529                                    OUT-NEW-JAGE
  7530                                    OUT-ORIG-LF-TERM
  7531                                    OUT-ORIG-AH-TERM
  7532                                    OUT-NEW-LF-TERM
  7533                                    OUT-NEW-AH-TERM
  7534                                    OUT-ORIG-CRIT-PER
  7535                                    OUT-ORIG-MAX-PMTS
  7536                                    OUT-ORIG-SCHED-TERM
  7537                                    OUT-NEW-SCHED-TERM
  7538                                    OUT-NEW-CRIT-PER
  7539                                    OUT-NEW-MAX-PMTS
  7540                                    OUT-CSO-PORTION
  7541                                    OUT-CSO-LF-PORTION
  7542                                    OUT-CSO-ALT-LF-PORT
  7543                                    OUT-CSO-CMB-LF-PORT
  7544                                    OUT-CSO-AH-PORTION
  7545                                    OUT-ACCT-PORTION
  7546                                    OUT-ACCT-LF-PORTION
  7547                                    OUT-ACCT-ALT-LF-PORT
  7548                                    OUT-ACCT-CMB-LF-PORT
  7549                                    OUT-ACCT-AH-PORTION
  7550                                    OUT-LF-PREM-CHG
  7551                                    OUT-LF-ALT-PREM-CHG
  7552                                    OUT-LF-CMB-PREM-CHG
  7553                                    OUT-AH-PREM-CHG
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 132
* NSRASBL.cbl
  7554                                    OUT-LF-REF-CHG
  7555                                    OUT-AH-REF-CHG
  7556     .
  7557 0800-exit.
  7558     exit.
  7559 1000-BUILD-ERARCH.
  7560* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7561*    1) FROM ACCT MAINT
  7562*    2) FROM CERT UPDATE
  7563*    3) FROM COMP MAINT
  7564*    4) FROM REVIEW AND CORRECTIONS
  7565******************************************************************
  7566     MOVE 'LA'                   TO LETTER-ARCHIVE
  7567     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7568                                    LA-ARCHIVE-NO-A2
  7569                                    LA-ARCHIVE-NO-A3
  7570                                    LA-ARCHIVE-NO-A4
  7571                                    LA-ARCHIVE-NO-A5
  7572                                    LA-ARCHIVE-NO-A6
  7573     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7574                                    LA-COMPANY-CD-A2
  7575                                    LA-COMPANY-CD-A3
  7576                                    LA-COMPANY-CD-A4
  7577                                    LA-COMPANY-CD-A5
  7578                                    LA-COMPANY-CD-A6
  7579     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7580                                    LA-CARRIER-A3
  7581                                    LA-CARRIER-A4
  7582                                    LA-CARRIER-A5
  7583     MOVE BL-GROUP               TO LA-GROUPING-A2
  7584                                    LA-GROUPING-A3
  7585                                    LA-GROUPING-A4
  7586                                    LA-GROUPING-A5
  7587     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7588                                    LA-ACCOUNT-A3
  7589                                    LA-ACCOUNT-A4
  7590                                    LA-ACCOUNT-A5
  7591     MOVE BL-STATE               TO LA-STATE-A2
  7592                                    LA-STATE-A3
  7593                                    LA-STATE-A4
  7594                                    LA-STATE-A5
  7595     IF BL-DATA-SRCE = '2' OR '4'
  7596        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7597        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7598     ELSE
  7599        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7600     END-IF
  7601     IF BL-DATA-SRCE = '4'
  7602        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7603     END-IF
  7604     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7605                                    LA-LAST-UPDATED-BY
  7606     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7607                                    LA-INITIAL-PRINT-DATE
  7608                                    LA-SENT-DATE
  7609                                    LA-REPLY-DATE
  7610                                    LA-RESEND-DATE
  7611                                    LA-FOLLOW-UP-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 133
* NSRASBL.cbl
  7612     MOVE 'A'                    TO LA-STATUS
  7613     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7614     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7615     IF W-DAYS-TO-RESEND NOT NUMERIC
  7616        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7617     END-IF
  7618     IF W-DAYS-TO-RESEND > ZEROS
  7619        MOVE SAVE-BIN-NEXT-BUS-DT TO DC-BIN-DATE-1
  7620        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7621        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7622        MOVE '6'                 TO DC-OPTION-CODE
  7623        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7624        IF NO-CONVERSION-ERROR
  7625           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7626        END-IF
  7627     END-IF
  7628     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7629        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7630        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7631        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7632        MOVE '6'                 TO DC-OPTION-CODE
  7633        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7634        IF NO-CONVERSION-ERROR
  7635           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7636        END-IF
  7637     END-IF
  7638
  7639     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7640     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7641     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7642     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7643     IF BL-ENDT-ARCH-NO > ZEROS
  7644        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7645     ELSE
  7646        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7647     END-IF
  7648     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7649                                    LA-LAST-MAINT-DATE
  7650     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7651                                    LA-NO-OF-TEXT-RECORDS
  7652     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7653
  7654* EXEC CICS WRITE
  7655*         DATASET   ('ERARCH')
  7656*         FROM      (LETTER-ARCHIVE)
  7657*         RIDFLD    (LA-CONTROL-PRIMARY)
  7658*         RESP      (WS-RESPONSE)
  7659*    END-EXEC
  7660     MOVE LENGTH OF
  7661      LETTER-ARCHIVE
  7662       TO DFHEIV11
  7663     MOVE 'ERARCH' TO DFHEIV1
  7664*    MOVE '&$ L                  ''  N#00007473' TO DFHEIV0
  7665     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7666     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7667     MOVE X'204E233030303037343733' TO DFHEIV0(25:11)
  7668     CALL 'kxdfhei1' USING DFHEIV0,
  7669           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 134
* NSRASBL.cbl
  7670           LETTER-ARCHIVE,
  7671           DFHEIV11,
  7672           LA-CONTROL-PRIMARY,
  7673           DFHEIV99,
  7674           DFHEIV99
  7675     MOVE EIBRESP  TO WS-RESPONSE
  7676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7677     IF NOT RESP-NORMAL
  7678        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7679        la-archive-no
  7680        SET BL-FAIL TO TRUE
  7681     END-IF
  7682     .
  7683 1000-EXIT.
  7684     EXIT.
  7685 1025-GET-CSR-INFO.
  7686     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7687                                    OUT-CSR-TITLE
  7688                                    OUT-PROC-TITLE
  7689                                    OUT-UNDW-ID
  7690     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7691     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7692     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7693     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7694
  7695* EXEC CICS READ
  7696*       INTO    (CONTROL-FILE)
  7697*       DATASET ('ELCNTL')
  7698*       RIDFLD  (WS-ELCNTL-KEY)
  7699*       RESP    (WS-RESPONSE)
  7700*    END-EXEC
  7701     MOVE LENGTH OF
  7702      CONTROL-FILE
  7703       TO DFHEIV11
  7704     MOVE 'ELCNTL' TO DFHEIV1
  7705*    MOVE '&"IL       E          (  N#00007496' TO DFHEIV0
  7706     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7707     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7708     MOVE X'204E233030303037343936' TO DFHEIV0(25:11)
  7709     CALL 'kxdfhei1' USING DFHEIV0,
  7710           DFHEIV1,
  7711           CONTROL-FILE,
  7712           DFHEIV11,
  7713           WS-ELCNTL-KEY,
  7714           DFHEIV99,
  7715           DFHEIV99,
  7716           DFHEIV99
  7717     MOVE EIBRESP  TO WS-RESPONSE
  7718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7719     IF RESP-NORMAL
  7720        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7721                                    OUT-PROC-NAME
  7722*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7723*                                   OUT-PROC-TITLE
  7724     END-IF
  7725     IF BL-PROC-ID NOT = PB-CSR-ID
  7726        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7727        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 135
* NSRASBL.cbl
  7728        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7729                                    OUT-PROC-TITLE
  7730        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7731
  7732* EXEC CICS READ
  7733*          INTO    (CONTROL-FILE)
  7734*          DATASET ('ELCNTL')
  7735*          RIDFLD  (WS-ELCNTL-KEY)
  7736*          RESP    (WS-RESPONSE)
  7737*       END-EXEC
  7738     MOVE LENGTH OF
  7739      CONTROL-FILE
  7740       TO DFHEIV11
  7741     MOVE 'ELCNTL' TO DFHEIV1
  7742*    MOVE '&"IL       E          (  N#00007514' TO DFHEIV0
  7743     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7744     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7745     MOVE X'204E233030303037353134' TO DFHEIV0(25:11)
  7746     CALL 'kxdfhei1' USING DFHEIV0,
  7747           DFHEIV1,
  7748           CONTROL-FILE,
  7749           DFHEIV11,
  7750           WS-ELCNTL-KEY,
  7751           DFHEIV99,
  7752           DFHEIV99,
  7753           DFHEIV99
  7754     MOVE EIBRESP  TO WS-RESPONSE
  7755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7756        IF RESP-NORMAL
  7757           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7758*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7759        END-IF
  7760     END-IF
  7761     .
  7762 1025-EXIT.
  7763     EXIT.
  7764 1050-GET-ERMAIL.
  7765     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7766
  7767* EXEC CICS READ
  7768*         DATASET    ('ERMAIL')
  7769*         INTO       (MAILING-DATA)
  7770*         RIDFLD     (WS-ERMAIL-KEY)
  7771*         RESP       (WS-RESPONSE)
  7772*    END-EXEC
  7773     MOVE LENGTH OF
  7774      MAILING-DATA
  7775       TO DFHEIV11
  7776     MOVE 'ERMAIL' TO DFHEIV1
  7777*    MOVE '&"IL       E          (  N#00007530' TO DFHEIV0
  7778     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7780     MOVE X'204E233030303037353330' TO DFHEIV0(25:11)
  7781     CALL 'kxdfhei1' USING DFHEIV0,
  7782           DFHEIV1,
  7783           MAILING-DATA,
  7784           DFHEIV11,
  7785           WS-ERMAIL-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 136
* NSRASBL.cbl
  7786           DFHEIV99,
  7787           DFHEIV99,
  7788           DFHEIV99
  7789     MOVE EIBRESP  TO WS-RESPONSE
  7790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7791     IF RESP-NORMAL
  7792        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7793        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7794        MOVE MA-CITY             TO OUT-INS-CITY
  7795        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7796        MOVE MA-ZIP              TO OUT-INS-ZIP
  7797        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7798        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7799        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7800        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7801        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7802        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7803        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7804           MOVE MA-INSURED-BIRTH-DT
  7805                                 TO DC-BIN-DATE-1
  7806           MOVE ' '              TO DC-OPTION-CODE
  7807           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7808           IF NO-CONVERSION-ERROR
  7809              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7810                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7811                INTO OUT-INS-BIRTHDATE
  7812              END-STRING
  7813           END-IF
  7814        END-IF
  7815        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7816           MOVE MA-JOINT-BIRTH-DT
  7817                                 TO DC-BIN-DATE-1
  7818           MOVE ' '              TO DC-OPTION-CODE
  7819           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7820           IF NO-CONVERSION-ERROR
  7821              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7822                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7823                INTO OUT-JNT-BIRTHDATE
  7824              END-STRING
  7825           END-IF
  7826        END-IF
  7827     END-IF
  7828     .
  7829 1050-EXIT.
  7830     EXIT.
  7831 1100-GET-ELCERT.
  7832
  7833* EXEC CICS READ
  7834*         DATASET    ('ELCERT')
  7835*         INTO       (CERTIFICATE-MASTER)
  7836*         RIDFLD     (WS-ELCERT-KEY)
  7837*         RESP       (WS-RESPONSE)
  7838*    END-EXEC.
  7839     MOVE LENGTH OF
  7840      CERTIFICATE-MASTER
  7841       TO DFHEIV11
  7842     MOVE 'ELCERT' TO DFHEIV1
  7843*    MOVE '&"IL       E          (  N#00007577' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 137
* NSRASBL.cbl
  7844     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7846     MOVE X'204E233030303037353737' TO DFHEIV0(25:11)
  7847     CALL 'kxdfhei1' USING DFHEIV0,
  7848           DFHEIV1,
  7849           CERTIFICATE-MASTER,
  7850           DFHEIV11,
  7851           WS-ELCERT-KEY,
  7852           DFHEIV99,
  7853           DFHEIV99,
  7854           DFHEIV99
  7855     MOVE EIBRESP  TO WS-RESPONSE
  7856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7857
  7858     IF RESP-NORMAL
  7859        SET CERT-FOUND TO TRUE
  7860        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7861        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7862     END-IF
  7863     .
  7864 1100-EXIT.
  7865     EXIT.
  7866 1110-BUILD-CERT.
  7867     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7868     MOVE SPACES                 TO OUT-COVERAGE-IND
  7869     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7870     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7871     MOVE CM-CARRIER             TO OUT-CARRIER
  7872     MOVE CM-GROUPING            TO OUT-GROUPING
  7873     MOVE CM-STATE               TO OUT-STATE
  7874     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7875     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7876     MOVE ' '                    TO DC-OPTION-CODE
  7877     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7878     IF NO-CONVERSION-ERROR
  7879        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7880           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7881              INTO OUT-CERT-EFF-DT
  7882        END-STRING
  7883     END-IF
  7884     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7885     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7886                                    OUT-ORIG-ILNAME
  7887     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7888     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7889                                    OUT-ORIG-MINIT
  7890     IF (CM-SSN-STATE = CM-STATE)
  7891        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7892        MOVE SPACES              TO OUT-SOC-SEC-NO
  7893     ELSE
  7894        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7895     END-IF
  7896     IF (CM-MEMB-STATE = CM-STATE)
  7897        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7898        MOVE SPACES              TO OUT-MEMBER-NO
  7899     ELSE
  7900        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7901     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 138
* NSRASBL.cbl
  7902     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7903                                    OUT-ORIG-IFNAME
  7904     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7905                                    OUT-ORIG-IAGE
  7906     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7907     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7908                                    OUT-ORIG-JAGE
  7909     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7910                                    OUT-ORIG-JLNAME
  7911     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7912                                    OUT-ORIG-JFNAME
  7913     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7914                                    OUT-ORIG-JMINIT
  7915     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7916                                    OUT-ORIG-LF-BENCD
  7917     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7918                                    OUT-ORIG-LF-TERM
  7919     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7920     IF CM-LF-DEV-PCT NOT NUMERIC
  7921        MOVE ZEROS               TO CM-LF-DEV-PCT
  7922     END-IF
  7923     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7924     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7925     IF NOT CERT-TRL-REC-NOT-FOUND
  7926         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7927             MOVE ZERO           TO OUT-IAGE
  7928                                    OUT-ORIG-IAGE
  7929         END-IF
  7930         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7931             MOVE ZERO           TO OUT-JAGE
  7932                                    OUT-ORIG-JAGE
  7933         END-IF
  7934         MOVE CS-VIN-NUMBER      TO OUT-VIN-NUMBER
  7935     END-IF
  7936
  7937     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7938        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7939          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7940           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7941             MOVE SPACES          TO OUT-LF-BENCD
  7942                                     WS-LF-BENCD
  7943                                     OUT-LF-CAN-DT
  7944             MOVE ZEROS           TO OUT-LF-TERM
  7945                                     OUT-LF-BEN
  7946                                     OUT-LF-PRM
  7947                                     OUT-LF-ALT-BEN
  7948                                     OUT-LF-ALT-PRM
  7949                                     OUT-LF-COMM-PCT
  7950                                     OUT-LF-NSP
  7951                                     OUT-LF-REM-BEN
  7952                                     WS-WORK-LF-PREM
  7953                                     WS-WORK-ALT-LF-PREM
  7954                                     WS-WORK-CMB-LF-PREM
  7955                                     OUT-LF-REF
  7956                                     OUT-ORIG-LF-REF
  7957                                     WS-WORK-LF-REF
  7958             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7959             GO TO 1100-LF-CONT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 139
* NSRASBL.cbl
  7960        END-IF
  7961     END-IF
  7962
  7963     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7964        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7965             MOVE SPACES          TO OUT-LF-BENCD
  7966                                     WS-LF-BENCD
  7967                                     OUT-LF-CAN-DT
  7968             MOVE ZEROS           TO OUT-LF-TERM
  7969                                     OUT-LF-BEN
  7970                                     OUT-LF-PRM
  7971                                     OUT-LF-ALT-BEN
  7972                                     OUT-LF-ALT-PRM
  7973                                     OUT-LF-COMM-PCT
  7974                                     OUT-LF-NSP
  7975                                     OUT-LF-REM-BEN
  7976                                     WS-WORK-LF-PREM
  7977                                     WS-WORK-ALT-LF-PREM
  7978                                     WS-WORK-CMB-LF-PREM
  7979                                     OUT-LF-REF
  7980                                     OUT-ORIG-LF-REF
  7981                                     WS-WORK-LF-REF
  7982             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7983             GO TO 1100-LF-CONT
  7984        END-IF
  7985     END-IF
  7986     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7987         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7988                                    OUT-ORIG-COVERAGE-IND
  7989     END-IF
  7990
  7991     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7992     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7993                                    OUT-ORIG-LF-BEN
  7994     IF CM-LF-BENEFIT-AMT = 999999999.99
  7995        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  7996     END-IF
  7997     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7998                                    OUT-ORIG-LF-PRM
  7999                                    WS-WORK-LF-PREM
  8000     IF CM-LF-PREMIUM-AMT = .01
  8001         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  8002     END-IF
  8003     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  8004        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  8005     END-IF
  8006     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  8007                                    OUT-ORIG-LF-ALT-BEN
  8008     IF CM-LF-ALT-BENEFIT-AMT = 999999999.99
  8009        MOVE SPACES              TO OUT-ORIG-LF-ALT-BEN-A
  8010     END-IF
  8011     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  8012        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  8013     END-IF
  8014     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  8015                                    OUT-ORIG-LF-ALT-PRM
  8016                                    WS-WORK-ALT-LF-PREM
  8017     IF CM-LF-ALT-PREMIUM-AMT = .01
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 140
* NSRASBL.cbl
  8018         MOVE SPACES             TO OUT-ORIG-LF-ALT-PRM-A
  8019     END-IF
  8020     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  8021                             CM-LF-ALT-PREMIUM-AMT
  8022     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  8023                                 OUT-ORIG-LF-CMB-PREM
  8024                                 WS-WORK-CMB-LF-PREM
  8025     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  8026        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  8027     END-IF
  8028     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  8029     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  8030     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  8031                                    OUT-ORIG-LF-REF
  8032                                    WS-WORK-LF-REF
  8033     IF CM-LF-DEATH-CLAIM-APPLIED
  8034        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8035            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  8036                                    OUT-ORIG-LF-REF
  8037                                    WS-WORK-LF-REF
  8038     END-IF
  8039     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  8040     MOVE ' '                    TO DC-OPTION-CODE
  8041     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8042     IF NO-CONVERSION-ERROR
  8043        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8044           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8045              INTO OUT-LF-CAN-DT
  8046        END-STRING
  8047     END-IF
  8048
  8049     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8050         MOVE ZEROS          TO WS-WORK-LF-PREM
  8051                                WS-WORK-ALT-LF-PREM
  8052                                WS-WORK-CMB-LF-PREM
  8053     END-IF
  8054
  8055      .
  8056 1100-LF-CONT.
  8057
  8058     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  8059     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  8060        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  8061     END-IF
  8062     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  8063     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  8064        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  8065     END-IF
  8066     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  8067     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8068        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  8069          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8070              MOVE SPACES              TO OUT-AH-BENCD
  8071                                          WS-AH-BENCD
  8072                                          OUT-AH-CAN-DT
  8073              MOVE ZEROS               TO OUT-AH-TERM
  8074                                          OUT-AH-BEN
  8075                                          OUT-AH-PRM
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 141
* NSRASBL.cbl
  8076                                          OUT-AH-NSP
  8077                                          OUT-AH-COMM-PCT
  8078                                          OUT-CRIT-PER
  8079                                          WS-WORK-AH-PREM
  8080                                          OUT-AH-REF
  8081                                          OUT-ORIG-AH-REF
  8082                                          WS-WORK-AH-REF
  8083              MOVE SPACES              TO OUT-MAX-PMTS-A
  8084                                          OUT-WAIT-PER
  8085                                          OUT-RET-ELIM
  8086                                          OUT-AH-DESC
  8087                                          OUT-BEN-DAYS
  8088              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8089             GO TO 1100-AH-CONT
  8090        END-IF
  8091     END-IF
  8092
  8093     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  8094        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8095              MOVE SPACES              TO OUT-AH-BENCD
  8096                                          WS-AH-BENCD
  8097                                          OUT-AH-CAN-DT
  8098              MOVE ZEROS               TO OUT-AH-TERM
  8099                                          OUT-AH-BEN
  8100                                          OUT-AH-PRM
  8101                                          OUT-AH-NSP
  8102                                          OUT-AH-COMM-PCT
  8103                                          OUT-CRIT-PER
  8104                                          WS-WORK-AH-PREM
  8105                                          OUT-AH-REF
  8106                                          OUT-ORIG-AH-REF
  8107                                          WS-WORK-AH-REF
  8108              MOVE SPACES              TO OUT-MAX-PMTS-A
  8109                                          OUT-WAIT-PER
  8110                                          OUT-RET-ELIM
  8111                                          OUT-AH-DESC
  8112                                          OUT-BEN-DAYS
  8113              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8114             GO TO 1100-AH-CONT
  8115        END-IF
  8116     END-IF
  8117     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  8118     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  8119                                    OUT-ORIG-AH-BENCD
  8120     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  8121        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  8122           CM-AH-BENEFIT-AMT
  8123        IF OUT-COVERAGE-IND = 'LIFE'
  8124            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  8125                                    OUT-ORIG-COVERAGE-IND
  8126        ELSE
  8127            MOVE 'AH  '          TO OUT-COVERAGE-IND
  8128                                    OUT-ORIG-COVERAGE-IND
  8129        END-IF
  8130     ELSE
  8131        MOVE ZEROS               TO OUT-AH-TOT-BEN
  8132     END-IF
  8133     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 142
* NSRASBL.cbl
  8134                                    OUT-ORIG-AH-TERM
  8135     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  8136                                    OUT-ORIG-CRIT-PER
  8137                                    OUT-MAX-PMTS
  8138                                    OUT-ORIG-MAX-PMTS
  8139     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  8140         MOVE SPACES             TO OUT-MAX-PMTS-A
  8141     END-IF
  8142     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  8143     IF CM-AH-DEV-PCT NOT NUMERIC
  8144        MOVE ZEROS               TO CM-AH-DEV-PCT
  8145     END-IF
  8146     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  8147     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  8148                                    OUT-ORIG-AH-BEN
  8149     IF CM-AH-BENEFIT-AMT = 9999999.99
  8150        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  8151     END-IF
  8152     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  8153                                    OUT-ORIG-AH-PRM
  8154                                    WS-WORK-AH-PREM
  8155     IF CM-AH-PREMIUM-AMT = .01
  8156         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  8157     END-IF
  8158     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  8159     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  8160                                    OUT-ORIG-AH-REF
  8161                                    WS-WORK-AH-REF
  8162     IF CM-AH-DEATH-CLAIM-APPLIED
  8163        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8164            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  8165                                    OUT-ORIG-AH-REF
  8166                                    WS-WORK-AH-REF
  8167     END-IF
  8168     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8169     MOVE ' '                    TO DC-OPTION-CODE
  8170     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8171     IF NO-CONVERSION-ERROR
  8172        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8173           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8174              INTO OUT-AH-CAN-DT
  8175        END-STRING
  8176     END-IF
  8177
  8178     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8179         MOVE ZEROS          TO WS-WORK-AH-PREM
  8180     END-IF
  8181
  8182      .
  8183 1100-AH-CONT.
  8184
  8185     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  8186     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  8187     MOVE ' '                    TO DC-OPTION-CODE
  8188     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8189     IF NO-CONVERSION-ERROR
  8190        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8191           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 143
* NSRASBL.cbl
  8192              INTO OUT-AH-PDTHRU-DT
  8193        END-STRING
  8194     END-IF
  8195     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  8196        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  8197     END-IF
  8198     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  8199     IF CM-LOAN-APR NOT NUMERIC
  8200        MOVE ZEROS               TO CM-LOAN-APR
  8201     END-IF
  8202     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  8203     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  8204     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  8205     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  8206     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  8207     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  8208     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  8209     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  8210     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  8211     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  8212     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8213     MOVE ' '                    TO DC-OPTION-CODE
  8214     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8215     IF NO-CONVERSION-ERROR
  8216        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8217           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8218              INTO OUT-LF-EXP-DT
  8219        END-STRING
  8220     END-IF
  8221     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  8222     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8223     MOVE ' '                    TO DC-OPTION-CODE
  8224     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8225     IF NO-CONVERSION-ERROR
  8226        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8227           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8228              INTO OUT-AH-EXP-DT
  8229        END-STRING
  8230     END-IF
  8231     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  8232     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  8233     MOVE ' '                    TO DC-OPTION-CODE
  8234     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8235     IF NO-CONVERSION-ERROR
  8236        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8237           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8238              INTO OUT-1ST-PMT-DT
  8239        END-STRING
  8240     END-IF
  8241     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  8242     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  8243     MOVE ' '                    TO DC-OPTION-CODE
  8244     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8245     IF NO-CONVERSION-ERROR
  8246        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8247           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8248              INTO OUT-ENTRY-DT
  8249        END-STRING
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 144
* NSRASBL.cbl
  8250     END-IF
  8251     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8252     MOVE ' '                    TO DC-OPTION-CODE
  8253     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8254     IF NO-CONVERSION-ERROR
  8255        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8256           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8257              INTO OUT-LF-CAN-EXIT-DT
  8258        END-STRING
  8259     END-IF
  8260     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  8261     MOVE ' '                    TO DC-OPTION-CODE
  8262     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8263     IF NO-CONVERSION-ERROR
  8264        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8265           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8266              INTO OUT-LF-DTH-DT
  8267        END-STRING
  8268     END-IF
  8269     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  8270     MOVE ' '                    TO DC-OPTION-CODE
  8271     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8272     IF NO-CONVERSION-ERROR
  8273        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8274           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8275              INTO OUT-LF-DTH-EXIT-DT
  8276        END-STRING
  8277     END-IF
  8278     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  8279     IF OUT-AH-CAN-DT NOT = SPACES
  8280        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  8281     ELSE
  8282        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  8283     END-IF
  8284     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8285     MOVE ' '                    TO DC-OPTION-CODE
  8286     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8287     IF NO-CONVERSION-ERROR
  8288        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8289           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8290              INTO OUT-AH-CAN-EXIT-DT
  8291        END-STRING
  8292     END-IF
  8293     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  8294     IF CM-ENTRY-BATCH = LOW-VALUES
  8295        MOVE SPACES              TO CM-ENTRY-BATCH
  8296     END-IF
  8297     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  8298     IF CM-LF-EXIT-BATCH = LOW-VALUES
  8299        MOVE SPACES              TO CM-LF-EXIT-BATCH
  8300     END-IF
  8301     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  8302     IF CM-AH-EXIT-BATCH = LOW-VALUES
  8303        MOVE SPACES              TO CM-AH-EXIT-BATCH
  8304     END-IF
  8305     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  8306     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  8307     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 145
* NSRASBL.cbl
  8308     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  8309     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  8310     COMPUTE WS-WORK-PREM =
  8311        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  8312           + CM-AH-PREMIUM-AMT)
  8313     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  8314                                    OUT-ORIG-TOT-PREM
  8315     COMPUTE WS-WORK-REF =
  8316        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  8317     MOVE WS-WORK-REF            TO OUT-TOT-REF
  8318                                    OUT-ORIG-TOT-REF
  8319     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  8320        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  8321     ELSE
  8322        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  8323     END-IF
  8324     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  8325     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  8326        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  8327     ELSE
  8328        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  8329     END-IF
  8330     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  8331     IF CM-NH-INT-ON-REFS NUMERIC
  8332        IF CM-NH-INT-ON-REFS NOT = ZEROS
  8333           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  8334        END-IF
  8335     END-IF
  8336
  8337     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8338        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8339            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8340        END-IF
  8341        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8342            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8343        END-IF
  8344     END-IF
  8345*
  8346*     IF BL-DATA-SRCE = '2'
  8347*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8348*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8349*        END-IF
  8350*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8351*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8352*        END-IF
  8353*     END-IF
  8354
  8355     COMPUTE WS-ACCT-LF-PORTION =
  8356        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  8357     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  8358                                OUT-ACCT-ORIG-LF-PORT
  8359     COMPUTE WS-ACCT-ALT-LF-PORTION =
  8360        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  8361     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  8362                                OUT-ACCT-ORIG-ALT-LF-PORT
  8363     COMPUTE WS-ACCT-CMB-LF-PORTION =
  8364        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  8365     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 146
* NSRASBL.cbl
  8366                                OUT-ACCT-ORIG-CMB-LF-PORT
  8367     COMPUTE WS-ACCT-AH-PORTION =
  8368        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  8369     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  8370                                OUT-ACCT-ORIG-AH-PORT
  8371     COMPUTE WS-ACCT-PORTION =
  8372        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  8373     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  8374                                OUT-ACCT-ORIG-PORTION
  8375
  8376     COMPUTE WS-CSO-LF-PORTION =
  8377       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  8378     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  8379                               OUT-CSO-ORIG-LF-PORT
  8380     COMPUTE WS-CSO-ALT-LF-PORTION =
  8381       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  8382     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  8383                                   OUT-CSO-ORIG-ALT-LF-PORT
  8384     COMPUTE WS-CSO-CMB-LF-PORTION =
  8385       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  8386     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  8387                                   OUT-CSO-ORIG-CMB-LF-PORT
  8388     COMPUTE WS-CSO-AH-PORTION =
  8389        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  8390     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  8391                               OUT-CSO-ORIG-AH-PORT
  8392     COMPUTE WS-CSO-PORTION =
  8393        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  8394     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  8395                            OUT-CSO-ORIG-PORTION
  8396     .
  8397 1110-EXIT.
  8398     EXIT.
  8399 1115-MATCH-COMPANY.
  8400     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8401     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8402     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8403
  8404* EXEC CICS READ
  8405*       INTO    (CONTROL-FILE)
  8406*       DATASET ('ELCNTL')
  8407*       RIDFLD  (WS-ELCNTL-KEY)
  8408*       RESP    (WS-RESPONSE)
  8409*    END-EXEC
  8410     MOVE LENGTH OF
  8411      CONTROL-FILE
  8412       TO DFHEIV11
  8413     MOVE 'ELCNTL' TO DFHEIV1
  8414*    MOVE '&"IL       E          (  N#00008128' TO DFHEIV0
  8415     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8417     MOVE X'204E233030303038313238' TO DFHEIV0(25:11)
  8418     CALL 'kxdfhei1' USING DFHEIV0,
  8419           DFHEIV1,
  8420           CONTROL-FILE,
  8421           DFHEIV11,
  8422           WS-ELCNTL-KEY,
  8423           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 147
* NSRASBL.cbl
  8424           DFHEIV99,
  8425           DFHEIV99
  8426     MOVE EIBRESP  TO WS-RESPONSE
  8427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8428     IF RESP-NORMAL
  8429        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8430     END-IF
  8431     .
  8432 1115-EXIT.
  8433     EXIT.
  8434 1120-MATCH-CARRIER.
  8435     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8436     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8437     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8438     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8439
  8440* EXEC CICS READ
  8441*       INTO    (CONTROL-FILE)
  8442*       DATASET ('ELCNTL')
  8443*       RIDFLD  (WS-ELCNTL-KEY)
  8444*       RESP    (WS-RESPONSE)
  8445*    END-EXEC
  8446     MOVE LENGTH OF
  8447      CONTROL-FILE
  8448       TO DFHEIV11
  8449     MOVE 'ELCNTL' TO DFHEIV1
  8450*    MOVE '&"IL       E          (  N#00008145' TO DFHEIV0
  8451     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8453     MOVE X'204E233030303038313435' TO DFHEIV0(25:11)
  8454     CALL 'kxdfhei1' USING DFHEIV0,
  8455           DFHEIV1,
  8456           CONTROL-FILE,
  8457           DFHEIV11,
  8458           WS-ELCNTL-KEY,
  8459           DFHEIV99,
  8460           DFHEIV99,
  8461           DFHEIV99
  8462     MOVE EIBRESP  TO WS-RESPONSE
  8463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8464     IF RESP-NORMAL
  8465        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8466     ELSE
  8467        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8468     END-IF
  8469     .
  8470 1120-EXIT.
  8471     EXIT.
  8472 1125-MATCH-STATE.
  8473     MOVE BL-STATE               TO OUT-STATE
  8474     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8475     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8476     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8477     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8478
  8479* EXEC CICS READ
  8480*       INTO    (CONTROL-FILE)
  8481*       DATASET ('ELCNTL')
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 148
* NSRASBL.cbl
  8482*       RIDFLD  (WS-ELCNTL-KEY)
  8483*       RESP    (WS-RESPONSE)
  8484*    END-EXEC
  8485     MOVE LENGTH OF
  8486      CONTROL-FILE
  8487       TO DFHEIV11
  8488     MOVE 'ELCNTL' TO DFHEIV1
  8489*    MOVE '&"IL       E          (  N#00008165' TO DFHEIV0
  8490     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8491     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8492     MOVE X'204E233030303038313635' TO DFHEIV0(25:11)
  8493     CALL 'kxdfhei1' USING DFHEIV0,
  8494           DFHEIV1,
  8495           CONTROL-FILE,
  8496           DFHEIV11,
  8497           WS-ELCNTL-KEY,
  8498           DFHEIV99,
  8499           DFHEIV99,
  8500           DFHEIV99
  8501     MOVE EIBRESP  TO WS-RESPONSE
  8502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8503     IF RESP-NORMAL
  8504        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8505     ELSE
  8506        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8507     END-IF
  8508     .
  8509 1125-EXIT.
  8510     EXIT.
  8511 1130-MATCH-BENCDS.
  8512     MOVE SPACES                 TO WS-LF-ABBRV
  8513                                    WS-LF-DESC
  8514                                    WS-LF-EARN
  8515                                    WS-WAIT-PER
  8516                                    WS-RET-ELIM
  8517                                    WS-AH-DESC
  8518                                    WS-BEN-DAYS
  8519     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8520        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8521     END-IF
  8522     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8523        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8524     END-IF
  8525     .
  8526 1130-EXIT.
  8527     EXIT.
  8528 1140-MATCH-LFBEN.
  8529     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8530     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8531     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8532     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8533
  8534* EXEC CICS READ
  8535*       INTO    (CONTROL-FILE)
  8536*       DATASET ('ELCNTL')
  8537*       RIDFLD  (WS-ELCNTL-KEY)
  8538*       GTEQ
  8539*       RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 149
* NSRASBL.cbl
  8540*    END-EXEC
  8541     MOVE LENGTH OF
  8542      CONTROL-FILE
  8543       TO DFHEIV11
  8544     MOVE 'ELCNTL' TO DFHEIV1
  8545*    MOVE '&"IL       G          (  N#00008201' TO DFHEIV0
  8546     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8547     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8548     MOVE X'204E233030303038323031' TO DFHEIV0(25:11)
  8549     CALL 'kxdfhei1' USING DFHEIV0,
  8550           DFHEIV1,
  8551           CONTROL-FILE,
  8552           DFHEIV11,
  8553           WS-ELCNTL-KEY,
  8554           DFHEIV99,
  8555           DFHEIV99,
  8556           DFHEIV99
  8557     MOVE EIBRESP  TO WS-RESPONSE
  8558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8559     IF RESP-NORMAL
  8560        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8561           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8562           OR (S1 > +8)
  8563        END-PERFORM
  8564        IF S1 < + 9
  8565           MOVE CF-BENEFIT-ALPHA (S1)
  8566                                 TO WS-LF-ABBRV
  8567           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8568           MOVE CF-CO-EARNINGS-CALC (S1)
  8569                                 TO WS-LF-EARN
  8570        ELSE
  8571           MOVE 'XX'             TO WS-LF-DESC
  8572           MOVE 'XXX'            TO WS-LF-ABBRV
  8573        END-IF
  8574     ELSE
  8575        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8576     END-IF
  8577     .
  8578 1140-EXIT.
  8579     EXIT.
  8580 1150-MATCH-AHBEN.
  8581     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8582     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8583     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8584     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8585
  8586* EXEC CICS READ
  8587*       INTO    (CONTROL-FILE)
  8588*       DATASET ('ELCNTL')
  8589*       RIDFLD  (WS-ELCNTL-KEY)
  8590*       GTEQ
  8591*       RESP    (WS-RESPONSE)
  8592*    END-EXEC
  8593     MOVE LENGTH OF
  8594      CONTROL-FILE
  8595       TO DFHEIV11
  8596     MOVE 'ELCNTL' TO DFHEIV1
  8597*    MOVE '&"IL       G          (  N#00008234' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 150
* NSRASBL.cbl
  8598     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8600     MOVE X'204E233030303038323334' TO DFHEIV0(25:11)
  8601     CALL 'kxdfhei1' USING DFHEIV0,
  8602           DFHEIV1,
  8603           CONTROL-FILE,
  8604           DFHEIV11,
  8605           WS-ELCNTL-KEY,
  8606           DFHEIV99,
  8607           DFHEIV99,
  8608           DFHEIV99
  8609     MOVE EIBRESP  TO WS-RESPONSE
  8610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8611     IF RESP-NORMAL
  8612        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8613           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8614           OR (S1 > +8)
  8615        END-PERFORM
  8616        IF S1 < + 9
  8617           MOVE CF-BENEFIT-ALPHA (S1)
  8618                                 TO WS-WAIT-PER
  8619           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8620                                 TO WS-RET-ELIM
  8621           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8622                                 TO WS-BEN-DAYS
  8623           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8624              IF CF-JOINT-INDICATOR (S1) = 'J'
  8625                 MOVE 'Joint Critical Period Disability'
  8626                                 TO WS-AH-DESC
  8627              ELSE
  8628                 MOVE 'Single Critical Period-Primary Only'
  8629                                 TO WS-AH-DESC
  8630              END-IF
  8631           ELSE
  8632              IF CF-JOINT-INDICATOR (S1) = 'J'
  8633                 MOVE 'Joint Disability'
  8634                                 TO WS-AH-DESC
  8635              ELSE
  8636                 MOVE 'Single Disability (Primary Only)'
  8637                                 TO WS-AH-DESC
  8638              END-IF
  8639           END-IF
  8640        ELSE
  8641           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8642        END-IF
  8643     ELSE
  8644        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8645     END-IF
  8646     .
  8647 1150-EXIT.
  8648     EXIT.
  8649
  8650 1160-READ-CERT-TRAILER.
  8651
  8652     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8653     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8654     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8655
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 151
* NSRASBL.cbl
  8656
  8657* EXEC CICS HANDLE CONDITION
  8658*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8659*    END-EXEC.
  8660*    MOVE '"$I                   ! " #00008286' TO DFHEIV0
  8661     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8663     MOVE X'2220233030303038323836' TO DFHEIV0(25:11)
  8664     CALL 'kxdfhei1' USING DFHEIV0
  8665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8666
  8667
  8668
  8669* EXEC CICS READ
  8670*        DATASET  ('ELCRTT')
  8671*        RIDFLD   (WS-ELCRTT-KEY)
  8672*        INTO     (CERTIFICATE-TRAILERS)
  8673*    END-EXEC.
  8674     MOVE LENGTH OF
  8675      CERTIFICATE-TRAILERS
  8676       TO DFHEIV11
  8677     MOVE 'ELCRTT' TO DFHEIV1
  8678*    MOVE '&"IL       E          (   #00008290' TO DFHEIV0
  8679     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8680     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8681     MOVE X'2020233030303038323930' TO DFHEIV0(25:11)
  8682     CALL 'kxdfhei1' USING DFHEIV0,
  8683           DFHEIV1,
  8684           CERTIFICATE-TRAILERS,
  8685           DFHEIV11,
  8686           WS-ELCRTT-KEY,
  8687           DFHEIV99,
  8688           DFHEIV99,
  8689           DFHEIV99
  8690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8691
  8692
  8693     GO TO 1160-EXIT.
  8694
  8695 1160-CERT-TRL-REC-NOTFND.
  8696     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8697
  8698 1160-EXIT.
  8699     EXIT.
  8700 1200-GET-ERACCT.
  8701     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8702     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8703                                    OUT-ACCT-ADDR1
  8704                                    OUT-ACCT-ADDR2
  8705                                    OUT-ACCT-CITY
  8706     MOVE ZEROS                  TO WS-CHGBACK
  8707
  8708* EXEC CICS STARTBR
  8709*        DATASET   ('ERACCT')
  8710*        RIDFLD    (WS-ERACCT-KEY)
  8711*        GTEQ
  8712*        RESP      (WS-RESPONSE)
  8713*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 152
* NSRASBL.cbl
  8714     MOVE 'ERACCT' TO DFHEIV1
  8715     MOVE 0
  8716       TO DFHEIV11
  8717*    MOVE '&,         G          &  N#00008310' TO DFHEIV0
  8718     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8719     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8720     MOVE X'204E233030303038333130' TO DFHEIV0(25:11)
  8721     CALL 'kxdfhei1' USING DFHEIV0,
  8722           DFHEIV1,
  8723           WS-ERACCT-KEY,
  8724           DFHEIV99,
  8725           DFHEIV11,
  8726           DFHEIV99
  8727     MOVE EIBRESP  TO WS-RESPONSE
  8728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8729     IF RESP-NORMAL
  8730
  8731* EXEC CICS READNEXT
  8732*          INTO    (ACCOUNT-MASTER)
  8733*          DATASET ('ERACCT')
  8734*          RIDFLD  (WS-ERACCT-KEY)
  8735*          RESP    (WS-RESPONSE)
  8736*       END-EXEC
  8737     MOVE LENGTH OF
  8738      ACCOUNT-MASTER
  8739       TO DFHEIV12
  8740     MOVE 'ERACCT' TO DFHEIV1
  8741     MOVE 0
  8742       TO DFHEIV11
  8743*    MOVE '&.IL                  )  N#00008317' TO DFHEIV0
  8744     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8745     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8746     MOVE X'204E233030303038333137' TO DFHEIV0(25:11)
  8747     CALL 'kxdfhei1' USING DFHEIV0,
  8748           DFHEIV1,
  8749           ACCOUNT-MASTER,
  8750           DFHEIV12,
  8751           WS-ERACCT-KEY,
  8752           DFHEIV99,
  8753           DFHEIV11,
  8754           DFHEIV99,
  8755           DFHEIV99
  8756     MOVE EIBRESP  TO WS-RESPONSE
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8758     END-IF
  8759     IF RESP-NORMAL
  8760        PERFORM UNTIL
  8761           NOT (RESP-NORMAL)
  8762           OR (WS-SAVE-ERACCT-KEY NOT =
  8763                        AM-CONTROL-PRIMARY (1:20))
  8764           IF BL-DATA-SRCE = '4' OR '2'
  8765              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8766                 AND >= AM-EFFECTIVE-DT)
  8767                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8768                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8769                    OR (S1 > +10)
  8770                 END-PERFORM
  8771                 IF S1 < +11
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 153
* NSRASBL.cbl
  8772                    MOVE AM-COMM-CHARGEBACK (S1)
  8773                                 TO WS-CHGBACK
  8774                 END-IF
  8775              END-IF
  8776           END-IF
  8777           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8778
  8779* EXEC CICS READNEXT
  8780*             INTO    (ACCOUNT-MASTER)
  8781*             DATASET ('ERACCT')
  8782*             RIDFLD  (WS-ERACCT-KEY)
  8783*             RESP    (WS-RESPONSE)
  8784*          END-EXEC
  8785     MOVE LENGTH OF
  8786      ACCOUNT-MASTER
  8787       TO DFHEIV12
  8788     MOVE 'ERACCT' TO DFHEIV1
  8789     MOVE 0
  8790       TO DFHEIV11
  8791*    MOVE '&.IL                  )  N#00008343' TO DFHEIV0
  8792     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8793     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8794     MOVE X'204E233030303038333433' TO DFHEIV0(25:11)
  8795     CALL 'kxdfhei1' USING DFHEIV0,
  8796           DFHEIV1,
  8797           ACCOUNT-MASTER,
  8798           DFHEIV12,
  8799           WS-ERACCT-KEY,
  8800           DFHEIV99,
  8801           DFHEIV11,
  8802           DFHEIV99,
  8803           DFHEIV99
  8804     MOVE EIBRESP  TO WS-RESPONSE
  8805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8806        END-PERFORM
  8807        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8808        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8809           SET ACCT-FOUND TO TRUE
  8810           MOVE AM-NAME          TO OUT-ACCT-NAME
  8811           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8812           MOVE SPACES           TO OUT-ACCT-ADDR2
  8813           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8814           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8815           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8816           MOVE AM-CONTROL-NAME  TO OUT-ACCT-CNTRL-NAME
  8817           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8818           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8819           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8820              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8821                 INTO OUT-ACCT-ZIP (6:5)
  8822              END-STRING
  8823           END-IF
  8824           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8825           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8826           MOVE AM-STATE         TO OUT-FORM
  8827           IF AM-ACCOUNT (10:1) = 'L'
  8828              MOVE 'L'           TO OUT-FORM (3:1)
  8829                                    OUT-LEASE-IND
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 154
* NSRASBL.cbl
  8830           END-IF
  8831           MOVE AM-CONTROL-PRIMARY (1:8)
  8832                                 TO WS-ERCOMP-KEY
  8833           IF AM-REMIT-TO NOT NUMERIC
  8834              MOVE 01            TO AM-REMIT-TO
  8835           END-IF
  8836           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8837           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8838              (AM-COM-TYP (S1) = 'C' OR 'D')
  8839              OR (S1 > +10)
  8840           END-PERFORM
  8841           IF S1 < +11
  8842              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8843           END-IF
  8844           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8845           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8846        END-IF
  8847     END-IF
  8848
  8849* EXEC CICS ENDBR
  8850*        DATASET   ('ERACCT')
  8851*    END-EXEC
  8852     MOVE 'ERACCT' TO DFHEIV1
  8853     MOVE 0
  8854       TO DFHEIV11
  8855*    MOVE '&2                    $   #00008391' TO DFHEIV0
  8856     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8857     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8858     MOVE X'2020233030303038333931' TO DFHEIV0(25:11)
  8859     CALL 'kxdfhei1' USING DFHEIV0,
  8860           DFHEIV1,
  8861           DFHEIV11,
  8862           DFHEIV99
  8863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8864    .
  8865 1200-EXIT.
  8866     EXIT.
  8867 1225-GET-ERCOMP.
  8868
  8869* EXEC CICS READ
  8870*       INTO    (COMPENSATION-MASTER)
  8871*       DATASET ('ERCOMP')
  8872*       RIDFLD  (WS-ERCOMP-KEY)
  8873*       RESP    (WS-RESPONSE)
  8874*    END-EXEC
  8875     MOVE LENGTH OF
  8876      COMPENSATION-MASTER
  8877       TO DFHEIV11
  8878     MOVE 'ERCOMP' TO DFHEIV1
  8879*    MOVE '&"IL       E          (  N#00008398' TO DFHEIV0
  8880     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8881     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8882     MOVE X'204E233030303038333938' TO DFHEIV0(25:11)
  8883     CALL 'kxdfhei1' USING DFHEIV0,
  8884           DFHEIV1,
  8885           COMPENSATION-MASTER,
  8886           DFHEIV11,
  8887           WS-ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 155
* NSRASBL.cbl
  8888           DFHEIV99,
  8889           DFHEIV99,
  8890           DFHEIV99
  8891     MOVE EIBRESP  TO WS-RESPONSE
  8892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8893     IF RESP-NORMAL
  8894        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8895        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8896        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8897        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8898        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8899        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8900        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8901        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8902        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8903        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8904        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8905        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8906     END-IF
  8907     .
  8908 1225-EXIT.
  8909     EXIT.
  8910 1250-GET-ELLETR.
  8911     display ' made it to 1250 '
  8912     move spaces                 to W-Z-CONTROL-DATA
  8913     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8914     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8915     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8916
  8917* EXEC CICS READ
  8918*         DATASET    ('ELLETR')
  8919*         INTO       (TEXT-FILES)
  8920*         RIDFLD     (WS-ELLETR-KEY)
  8921*         RESP       (WS-RESPONSE)
  8922*         GTEQ
  8923*    END-EXEC
  8924     MOVE LENGTH OF
  8925      TEXT-FILES
  8926       TO DFHEIV11
  8927     MOVE 'ELLETR' TO DFHEIV1
  8928*    MOVE '&"IL       G          (  N#00008427' TO DFHEIV0
  8929     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8930     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8931     MOVE X'204E233030303038343237' TO DFHEIV0(25:11)
  8932     CALL 'kxdfhei1' USING DFHEIV0,
  8933           DFHEIV1,
  8934           TEXT-FILES,
  8935           DFHEIV11,
  8936           WS-ELLETR-KEY,
  8937           DFHEIV99,
  8938           DFHEIV99,
  8939           DFHEIV99
  8940     MOVE EIBRESP  TO WS-RESPONSE
  8941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8942     IF RESP-NORMAL
  8943        IF (LETTER-FILE-TEXT)
  8944           AND (BL-LETTER-ID = TX-LETTER-NO)
  8945           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 156
* NSRASBL.cbl
  8946           display ' found good z record '
  8947           PERFORM 1280-PROCESS-Z-CONTROLS
  8948                                 THRU 1280-EXIT
  8949        END-IF
  8950     END-IF
  8951     .
  8952 1250-EXIT.
  8953     EXIT.
  8954 1280-PROCESS-Z-CONTROLS.
  8955     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8956*    IF W-FORM-TO-RESEND > SPACES
  8957*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8958*    ELSE
  8959*       MOVE SPACES              TO OUT-FORM
  8960*    END-IF
  8961     IF BL-ENC-CD = SPACES OR LOW-VALUES
  8962        MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8963     END-IF
  8964     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8965     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8966     .
  8967 1280-EXIT.
  8968     EXIT.
  8969 1300-DETERMINE-COMM.
  8970******************************************************************
  8971* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8972*    1) FROM ACCT MAINT
  8973*    2) FROM CERT UPDATE
  8974*    3) FROM COMP MAINT
  8975*    4) FROM REVIEW AND CORRECTIONS
  8976******************************************************************
  8977     MOVE 'Y'                    TO OUT-CHGBACK
  8978     MOVE ZEROS                  TO WS-DIFF
  8979                                    WS-CHGBK-LIFE-PCT
  8980                                    WS-CHGBK-AH-PCT
  8981     IF BL-DATA-SRCE = '4'
  8982        IF PB-CANCELLATION
  8983           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8984           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8985           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8986           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8987           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8988              MOVE PB-C-LF-CANCEL-DT
  8989                                 TO DC-BIN-DATE-2
  8990           END-IF
  8991           MOVE '1'              TO DC-OPTION-CODE
  8992           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8993           IF NO-CONVERSION-ERROR
  8994              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8995              IF DC-ODD-DAYS-OVER > +1
  8996                 ADD +1          TO WS-DIFF
  8997              END-IF
  8998              IF (WS-CHGBACK = 99)
  8999                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  9000                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  9001                                WS-CHGBK-AH-PCT
  9002                   MOVE 'N'  TO OUT-CHGBACK
  9003              END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 157
* NSRASBL.cbl
  9004           END-IF
  9005        ELSE
  9006           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  9007           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  9008        END-IF
  9009     ELSE
  9010        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  9011        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  9012        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  9013           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  9014           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9015           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  9016           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  9017              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  9018           END-IF
  9019           MOVE '1'              TO DC-OPTION-CODE
  9020           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9021           IF NO-CONVERSION-ERROR
  9022              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  9023              IF DC-ODD-DAYS-OVER > +1
  9024                 ADD +1          TO WS-DIFF
  9025              END-IF
  9026              IF (WS-CHGBACK = 99)
  9027                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  9028                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  9029                                WS-CHGBK-AH-PCT
  9030                   MOVE 'N'  TO OUT-CHGBACK
  9031              END-IF
  9032           END-IF
  9033        END-IF
  9034     END-IF
  9035     .
  9036 1300-EXIT.
  9037     EXIT.
  9038 1500-GET-ARCH-NO.
  9039     DISPLAY ' MADE IT TO 1500 '
  9040     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  9041     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  9042     MOVE SPACES                 TO WS-ELCNTL-GENL
  9043     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  9044
  9045* EXEC CICS READ
  9046*       INTO    (CONTROL-FILE)
  9047*       DATASET ('ELCNTL')
  9048*       RIDFLD  (WS-ELCNTL-KEY)
  9049*       UPDATE
  9050*       RESP    (WS-RESPONSE)
  9051*    END-EXEC
  9052     MOVE LENGTH OF
  9053      CONTROL-FILE
  9054       TO DFHEIV11
  9055     MOVE 'ELCNTL' TO DFHEIV1
  9056*    MOVE '&"IL       EU         (  N#00008536' TO DFHEIV0
  9057     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9058     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9059     MOVE X'204E233030303038353336' TO DFHEIV0(25:11)
  9060     CALL 'kxdfhei1' USING DFHEIV0,
  9061           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 158
* NSRASBL.cbl
  9062           CONTROL-FILE,
  9063           DFHEIV11,
  9064           WS-ELCNTL-KEY,
  9065           DFHEIV99,
  9066           DFHEIV99,
  9067           DFHEIV99
  9068     MOVE EIBRESP  TO WS-RESPONSE
  9069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9070     IF RESP-NORMAL
  9071        AND (CF-COMPANY-ID  = BL-COMP-ID)
  9072        AND (CF-RECORD-TYPE = '1')
  9073        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  9074        MOVE CF-CREDIT-LAST-ARCH-NUM
  9075                                 TO WS-ARCHIVE-NO
  9076
  9077* EXEC CICS REWRITE
  9078*          FROM    (CONTROL-FILE)
  9079*          DATASET ('ELCNTL')
  9080*       END-EXEC
  9081     MOVE LENGTH OF
  9082      CONTROL-FILE
  9083       TO DFHEIV11
  9084     MOVE 'ELCNTL' TO DFHEIV1
  9085*    MOVE '&& L                  %   #00008549' TO DFHEIV0
  9086     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9087     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9088     MOVE X'2020233030303038353439' TO DFHEIV0(25:11)
  9089     CALL 'kxdfhei1' USING DFHEIV0,
  9090           DFHEIV1,
  9091           CONTROL-FILE,
  9092           DFHEIV11,
  9093           DFHEIV99
  9094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9095     ELSE
  9096        MOVE +0                  TO WS-ARCHIVE-NO
  9097     END-IF
  9098    .
  9099 1500-EXIT.
  9100     EXIT.
  9101 1700-GET-ELENCC.
  9102     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  9103     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  9104     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  9105     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  9106        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  9107        OR (E1 > +5)
  9108     END-PERFORM
  9109     IF E1 < +5
  9110        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  9111     END-IF
  9112
  9113* EXEC CICS READ
  9114*        DATASET   ('ELENCC')
  9115*        INTO      (ENCLOSURE-CODES)
  9116*        RIDFLD    (WS-ELENCC-KEY)
  9117*        RESP      (WS-RESPONSE)
  9118*    END-EXEC
  9119     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 159
* NSRASBL.cbl
  9120      ENCLOSURE-CODES
  9121       TO DFHEIV11
  9122     MOVE 'ELENCC' TO DFHEIV1
  9123*    MOVE '&"IL       E          (  N#00008570' TO DFHEIV0
  9124     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9126     MOVE X'204E233030303038353730' TO DFHEIV0(25:11)
  9127     CALL 'kxdfhei1' USING DFHEIV0,
  9128           DFHEIV1,
  9129           ENCLOSURE-CODES,
  9130           DFHEIV11,
  9131           WS-ELENCC-KEY,
  9132           DFHEIV99,
  9133           DFHEIV99,
  9134           DFHEIV99
  9135     MOVE EIBRESP  TO WS-RESPONSE
  9136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9137     IF NOT RESP-NORMAL
  9138        display ' elencc resp not normal ' ws-response
  9139        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  9140
  9141* EXEC CICS READ
  9142*           DATASET   ('ELENCC')
  9143*           INTO      (ENCLOSURE-CODES)
  9144*           RIDFLD    (WS-ELENCC-KEY)
  9145*           RESP      (WS-RESPONSE)
  9146*       END-EXEC
  9147     MOVE LENGTH OF
  9148      ENCLOSURE-CODES
  9149       TO DFHEIV11
  9150     MOVE 'ELENCC' TO DFHEIV1
  9151*    MOVE '&"IL       E          (  N#00008579' TO DFHEIV0
  9152     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9154     MOVE X'204E233030303038353739' TO DFHEIV0(25:11)
  9155     CALL 'kxdfhei1' USING DFHEIV0,
  9156           DFHEIV1,
  9157           ENCLOSURE-CODES,
  9158           DFHEIV11,
  9159           WS-ELENCC-KEY,
  9160           DFHEIV99,
  9161           DFHEIV99,
  9162           DFHEIV99
  9163     MOVE EIBRESP  TO WS-RESPONSE
  9164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9165     END-IF
  9166     IF RESP-NORMAL
  9167        display ' elencc resp normal ' ws-response
  9168        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  9169        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  9170        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  9171     END-IF
  9172     .
  9173 1700-EXIT.
  9174     EXIT.
  9175
  9176
  9177 4100-CONNECT-TO-DB.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 160
* NSRASBL.cbl
  9178
  9179     IF SVR > SPACES
  9180        CONTINUE
  9181     ELSE
  9182        MOVE 'NTCSO2_LOGIC'         TO SVR
  9183        MOVE 'sa'                   TO USR
  9184        MOVE 'ntcso2'               TO PASS
  9185     END-IF
  9186
  9187     STRING
  9188         USR DELIMITED SPACE
  9189         "." DELIMITED SIZE
  9190         PASS DELIMITED SPACE INTO USR-PASS
  9191     END-STRING
  9192
  9193     EXEC SQL
  9194        CONNECT TO :SVR USER :USR-PASS
  9195     END-EXEC
  9196
  9197     IF SQLCODE NOT = 0
  9198        DISPLAY "ERROR: CANNOT CONNECT "
  9199        DISPLAY SQLCODE
  9200        DISPLAY SQLERRMC
  9201        GO TO 4100-EXIT
  9202     END-IF
  9203
  9204     .
  9205 4100-EXIT.
  9206     EXIT.
  9207
  9208
  9209
  9210 4200-GET-NEXT-BUS-DT.
  9211
  9212     MOVE WS-SAVE-EDIT-A-DATE    TO WS-CYCLE-DATE
  9213     MOVE SPACES                 TO WS-NEXT-BUS-DT
  9214
  9215     IF WS-KIXHOST = 'logictest'
  9216        EXEC SQL
  9217          CALL NaperTestCalcNextBusDt
  9218                        @cycledate = :WS-CYCLE-DATE,
  9219                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9220        END-EXEC
  9221     ELSE
  9222        EXEC SQL
  9223          CALL NaperProdCalcNextBusDt
  9224                        @cycledate = :WS-CYCLE-DATE,
  9225                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9226        END-EXEC
  9227     END-IF
  9228
  9229     IF SQLCODE NOT = 0
  9230        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
  9231        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9232        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9233        GO TO 4200-EXIT
  9234     END-IF
  9235
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 161
* NSRASBL.cbl
  9236     .
  9237 4200-EXIT.
  9238     EXIT.
  9239
  9240
  9241
  9242 4300-DISCONNECT.
  9243
  9244     EXEC SQL
  9245        DISCONNECT
  9246     END-EXEC
  9247     .
  9248 4300-EXIT.
  9249     EXIT.
  9250
  9251
  9252 4500-CHECK-BALLOON-STATE.
  9253
  9254     IF WS-KIXHOST = 'logictest'
  9255        MOVE 'NTCSO2_NaperRepo'     TO SVR
  9256        MOVE 'sa'                   TO USR
  9257        MOVE 'ntcso2'               TO PASS
  9258        MOVE '1011'                 TO WS-LOOKUPID
  9259     ELSE
  9260        MOVE 'NTCSO3_NaperRepo'     TO SVR
  9261        MOVE 'sa'                   TO USR
  9262        MOVE 'ntcso3'               TO PASS
  9263        MOVE '1020'                 TO WS-LOOKUPID
  9264     END-IF
  9265
  9266     MOVE SPACES                 TO WS-LOOKUP-VALUE
  9267
  9268     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  9269     MOVE CM-STATE TO WS-LOOKUPKEY
  9270     MOVE 'B'      TO WS-LOOKUPKEY (3:1)
  9271
  9272     EXEC SQL
  9273           SELECT LOOKUPVALUE
  9274             INTO :WS-LOOKUP-VALUE
  9275             FROM LOOKUPVALUES
  9276               WHERE LOOKUPID = :WS-LOOKUPID
  9277                 AND LOOKUPKEY = :WS-LOOKUPKEY
  9278     END-EXEC
  9279
  9280     IF SQLCODE = 0
  9281       OR SQLCODE = 100
  9282        CONTINUE
  9283     ELSE
  9284        DISPLAY "ERROR: INVALID BALLOON STATE SELECT "
  9285        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9286        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9287     END-IF
  9288
  9289     PERFORM 4300-DISCONNECT THRU 4300-EXIT.
  9290
  9291 4500-EXIT.
  9292     EXIT.
  9293 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:35 Page 162
* NSRASBL.cbl
  9294
  9295* EXEC CICS LINK
  9296*        PROGRAM   ('ELDATCV')
  9297*        COMMAREA  (DATE-CONVERSION-DATA)
  9298*        LENGTH    (DC-COMM-LENGTH)
  9299*    END-EXEC.
  9300     MOVE 'ELDATCV' TO DFHEIV1
  9301*    MOVE '."C                   (   #00008714' TO DFHEIV0
  9302     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9304     MOVE X'2020233030303038373134' TO DFHEIV0(25:11)
  9305     CALL 'kxdfhei1' USING DFHEIV0,
  9306           DFHEIV1,
  9307           DATE-CONVERSION-DATA,
  9308           DC-COMM-LENGTH,
  9309           DFHEIV99,
  9310           DFHEIV99,
  9311           DFHEIV99,
  9312           DFHEIV99
  9313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9314
  9315 9700-EXIT.
  9316      EXIT.
  9317
  9318 9999-DFHBACK SECTION.
  9319     MOVE '9%                    "   ' TO DFHEIV0
  9320     MOVE 'NSRASBL' TO DFHEIV1
  9321     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9322     GOBACK.
  9323 9999-DFHEXIT.
  9324     IF DFHEIGDJ EQUAL 0001
  9325         NEXT SENTENCE
  9326     ELSE IF DFHEIGDJ EQUAL 2
  9327         GO TO 1160-CERT-TRL-REC-NOTFND
  9328         DEPENDING ON DFHEIGDI.
  9329     MOVE '9%                    "   ' TO DFHEIV0
  9330     MOVE 'NSRASBL' TO DFHEIV1
  9331     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9332     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      169132     Code:       58504
