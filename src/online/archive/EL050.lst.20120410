* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page   1
* EL050.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL050.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page   2
* EL050.cbl
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page   3
* EL050.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46
    47 77  FILLER   PIC X(32) VALUE '********************************'.
    48 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    49 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    50
    51 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    52 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    53                                   USAGE POINTER.
    54 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    55 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    56 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    57                                   USAGE IS POINTER.
    58 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    59 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    60                                   USAGE IS POINTER.
    61 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    63                                   USAGE IS POINTER.
    64
    65 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69*    COPY ELC50WS.
    70*****************************************************************
    71*                                                               *
    72*                            ELC50WS.                           *
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    74*                            VMOD=2.061.                        *
    75*                                                               *
    76*   THIS IS THE WORKING STORAGE FOR EL050                       *
    77*                                   EL517                       *
    78*****************************************************************
    79******************************************************************
    80*                   C H A N G E   L O G
    81*
    82* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    83*-----------------------------------------------------------------
    84*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    85* EFFECTIVE    NUMBER
    86*-----------------------------------------------------------------
    87* 123102                   PEMA  ADD DCC PROCESSING
    88* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    89* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    90* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    91* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    93* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    94* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    95* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
    96* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
    97* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    98* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
    99* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   100* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   101* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page   4
* EL050.cbl
   102* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   103* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   104* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   105* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   106* 030309  CR2009021700001  PEMA  ADD ER-2883
   107* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   109* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   110* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   111* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   112* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   113* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   114* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   115* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   117* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   118* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   119*-----------------------------------------------------------------
   120
   121 01  WORK-AREAS.
   122
   123*****************************************************************
   124*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   125*****************************************************************
   126
   127     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   128     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   129     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   130     12  WS-NAME-EDIT-WORK-AREA.
   131         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   132         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   133             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   134         16  WS-WORK-NAME.
   135             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   136             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   137             20  FILLER           PIC X(10)     VALUE SPACES.
   138         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   139             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   140
   141*****************************************************************
   142*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   143*****************************************************************
   144
   145     12  WS-ERRESC-KEY.
   146         16 WS-ERRESC-SEARCH-KEY.
   147             20  WS-ERRESC-COMPANY-CD PIC  X.
   148             20  WS-ERRESC-CARRIER    PIC  X.
   149             20  WS-ERRESC-GROUP      PIC X(6).
   150             20  WS-ERRESC-STATE      PIC XX.
   151             20  WS-ERRESC-ACCOUNT    PIC X(10).
   152         16 WS-ERRESC-RESIDUAL-KEY.
   153             20  WS-ERRESC-AGENT      PIC X(10).
   154             20  WS-ERRESC-RES-STATE  PIC XX.
   155             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   156*                                          YYYYMMDD
   157     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   158     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   159
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page   5
* EL050.cbl
   160*RESIDENT STATE TAX MASTER(ERRESS)
   161*
   162     12  WS-ERRESS-KEY.
   163         16  WS-ERRESS-COMPANY-CD      PIC  X.
   164         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   165         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   166         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   167*                                          YYYYMMDD
   168
   169     12  WS-CONTRACT-DATE              PIC 9(8).
   170*                                          YYYYMMDD
   171     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   172     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   173         16 WS-YEAR-YY                 PIC   9999.
   174         16 FILLER                     PIC 9(4).
   175*                                          YYYYMMDD
   176     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   177     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   178     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   179     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   180
   181     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   182         88  DPRB-1ST-TIME                      VALUE ' '.
   183
   184*****************************************************************
   185*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   186*****************************************************************
   187
   188     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   189     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   190     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   191     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   192     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   193     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   194     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   195     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   196     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   197     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   198         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   199         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   200     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   201         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   202         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   203     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   204
   205     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   206     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   207
   208     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   209     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   210     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   211     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   212     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   213     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   214     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   215     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page   6
* EL050.cbl
   218     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   221     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   222     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   223     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   244     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   245     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   246     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   247     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   248     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   249     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   250     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   251     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   252     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   256     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   257     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   258     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   259     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   260     12  WS-2671-SW               PIC X         VALUE SPACE.
   261     12  WS-2672-SW               PIC X         VALUE SPACE.
   262     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   263         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   264     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   265         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   266     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   267
   268     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   269         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   270         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   271         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   272         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   273
   274     12  WS-CREDIT-EDIT-CONTROLS.
   275         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page   7
* EL050.cbl
   276         16  WS-MIN-AGE           PIC 99                VALUE  0.
   277         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   278         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   279         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   280         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   281
   282     12  WS-SAVE-ALLOWABLE-BENEFIT.
   283         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   284         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   285         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   286         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   287         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   288         16  FILLER                      PIC XX.
   289
   290     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   291     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   292     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   293     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   294     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   295     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   296     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   297     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   298     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   299     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   300
   301     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   302     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   303     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   304     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   305     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   306     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   307     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   308     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   309         88  WS-REDUCING              VALUE 'R'.
   310         88  WS-LEVEL                 VALUE 'L' 'P'.
   311     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   312
   313     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   314     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   315     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   316     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   317     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   318     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   319     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   320     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   321     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   322
   323     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   324     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   325     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   326     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   327     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   328     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   329     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   330     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   331     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   332     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   333     12  WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page   8
* EL050.cbl
   334         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   335         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   336     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   337     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   338     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   341     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   342     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   343     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-INITIALS.
   345         16  WS-INIT-1            PIC X         VALUE SPACES.
   346         16  WS-INIT-2            PIC X         VALUE SPACES.
   347
   348     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   349     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   350     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   351     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   352     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   353*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   354     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   355     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   356     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   357     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   358     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   359     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   360     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   361     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   362     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   363     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   364     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   365     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   366     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   367     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   368     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   369     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   370     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   371     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   372     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   373     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   374     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   375     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   376******** FLA
   377     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   378     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   380     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   381     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   382********
   383     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   384     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   385     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   386     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   387     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   388     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   389     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   390     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   391     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page   9
* EL050.cbl
   392     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   393
   394     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   395         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   396                                         '0' THRU '9'.
   397
   398     12  NUMBER-OF-MONTHS.
   399         16  SK-MO OCCURS 12 TIMES PIC X.
   400
   401     12  WS-WORK-DATE.
   402         16  WS-YEAR            PIC 99    VALUE 00.
   403         16  WS-MONTH           PIC 99    VALUE 00.
   404         16  WS-DAY             PIC 99    VALUE 00.
   405
   406     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   407     12  WS-WORK-CRIT-DEV       REDEFINES
   408         WS-WORK-LF-CRIT-PER    PIC X(03).
   409
   410     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   411     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   412
   413     12  WS-WORK-DATE-FROM.
   414         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   415         16  FILLER             PIC X  VALUE SPACE.
   416         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   417         16  FILLER             PIC X         VALUE SPACE.
   418         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   419
   420     12  WS-WORK-DATE-THRU.
   421         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   424         16  FILLER             PIC X         VALUE SPACE.
   425         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   426
   427     12  WS-LF-INPUT-CD.
   428         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   429         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   430
   431     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   432     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   433         16  WS-AH-INPUT-CD-1   PIC X.
   434         16  WS-AH-INPUT-CD-2-3 PIC XX.
   435
   436     12  WS-SWITCHES.
   437         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   438         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   439             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   440         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   441             88  BANK-ACCT-FOUND          VALUE 'Y'.
   442         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   443             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   444         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   445             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   446         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   447             88  COMP-MASTER-FOUND        VALUE 'Y'.
   448         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   449             88  LOFC-MASTER-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  10
* EL050.cbl
   450         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   451             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   452         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   453             88  STAT-MASTER-FOUND        VALUE 'Y'.
   454         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   455             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   456         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   457             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   458         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   459             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   460         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   461             88  FORM-MASTER-FOUND        VALUE 'Y'.
   462         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   463             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   464         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   465             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   466         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   467             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   468         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   469             88  NO-BENEFIT-FOUND         VALUE 'N'.
   470         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   471             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   472         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   473             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   474         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   475             88  AH-BENEFIT-FOUND         VALUE ' '.
   476             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   477         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   478             88  LF-BENEFIT-FOUND         VALUE ' '.
   479             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   480         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   481             88  NO-STATE-RECORD          VALUE '1'.
   482         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   483             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   484         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   485             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   486         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   487             88  CERT-WAS-FOUND           VALUE ' '.
   488             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   489         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   490             88  BROWSE-STARTED           VALUE 'Y'.
   491         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   492             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   493         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   494             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   495         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   496             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   497         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   498             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   499         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   500             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   501         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   502             88  APP-CERT-USED            VALUE 'Y' 'A'.
   503         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   504             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   505             88  FIRST-TIME-THROUGH       VALUE '1'.
   506             88  CTBL-NOT-FOUND           VALUE '2'.
   507
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  11
* EL050.cbl
   508         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   509             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   510
   511         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   512             88  DLO-ERROR-FOUND          VALUE 'Y'.
   513
   514********FLA
   515     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   516     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   517********
   518     12  RC-SW-1                  PIC X           VALUE '0'.
   519     12  RC-SW-2                  PIC X           VALUE '0'.
   520     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   521     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   522     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   523     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   524     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   525     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   526     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   527     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   528     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   529     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   530     12  LIT-SPACES               PIC X           VALUE SPACES.
   531     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   532     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   533     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   534     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   535     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   536     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   537     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   538         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   539         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   540     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   541         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   542
   543 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   544     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   545     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   546 01  WS-CRI-SSN-WORK-AREA.
   547     05  WS-CRI-SOC-SEC-NO.
   548         10  WS-SS-REPT-CD       PIC X(5).
   549         10  WS-SS-LAST-NAME     PIC X(5).
   550         10  WS-SS-INITIAL       PIC X.
   551
   552     05  WS-CRI-REPORT-CODE.
   553         10  FILLER              PIC X(5).
   554         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   555
   556     05  WS-CRI-LAST-NAME.
   557         10  WS-CRI-NAME-MOVE    PIC X(5).
   558         10  FILLER              PIC X(10).
   559
   560 01  WS-NUM-TABLE                PIC X(26)  VALUE
   561     '12345678012345070923456789'.
   562 01  FILLER REDEFINES WS-NUM-TABLE.
   563     05  WS-NUM OCCURS 26        PIC 9.
   564 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   565 01  V1                          PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  12
* EL050.cbl
   566 01  V2                          PIC S999 COMP-3.
   567 01  V3                          PIC S999 COMP-3.
   568 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   569 01  FILLER REDEFINES WS-WORK-VIN.
   570     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   571 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   572 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   573 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   574 01  WS-HEX-WORK.
   575     05  FILLER                  PIC X  VALUE LOW-VALUES.
   576     05  WS-HEX-BYTE             PIC X.
   577 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   578 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   579 01  WS-WORK-HIN-ROW-B.
   580     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   581
   582 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   583 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   584     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   585 01  WS-ROW-D-TABLE.
   586     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   587
   588 01  WS-HIN-TABLE-B.
   589     05  F                       PIC XX VALUE 'A2'.
   590     05  F                       PIC XX VALUE 'B3'.
   591     05  F                       PIC XX VALUE 'C4'.
   592     05  F                       PIC XX VALUE 'D5'.
   593     05  F                       PIC XX VALUE 'E6'.
   594     05  F                       PIC XX VALUE 'F7'.
   595     05  F                       PIC XX VALUE 'G8'.
   596     05  F                       PIC XX VALUE 'H9'.
   597     05  F                       PIC XX VALUE 'I1'.
   598     05  F                       PIC XX VALUE 'J2'.
   599     05  F                       PIC XX VALUE 'K3'.
   600     05  F                       PIC XX VALUE 'L4'.
   601     05  F                       PIC XX VALUE 'M5'.
   602     05  F                       PIC XX VALUE 'N6'.
   603     05  F                       PIC XX VALUE 'O0'.
   604     05  F                       PIC XX VALUE 'P7'.
   605     05  F                       PIC XX VALUE 'Q0'.
   606     05  F                       PIC XX VALUE 'R8'.
   607     05  F                       PIC XX VALUE 'S9'.
   608     05  F                       PIC XX VALUE 'T2'.
   609     05  F                       PIC XX VALUE 'U3'.
   610     05  F                       PIC XX VALUE 'V4'.
   611     05  F                       PIC XX VALUE 'W5'.
   612     05  F                       PIC XX VALUE 'X6'.
   613     05  F                       PIC XX VALUE 'Y7'.
   614     05  F                       PIC XX VALUE 'Z8'.
   615 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   616     05  WS-VAL-IN               PIC X.
   617     05  WS-VAL-OUT              PIC 9.
   618 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   619 01  WS-COMPARE-BINARY-DATES.
   620     05  WS-971231                PIC XX VALUE X'92FF'.
   621     05  WS-931231                PIC XX VALUE X'8CFF'.
   622     05  WS-791231                PIC XX VALUE X'77FF'.
   623     05  WS-771001                PIC XX VALUE X'74A1'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  13
* EL050.cbl
   624     05  WS-820301                PIC XX VALUE X'7B41'.
   625     05  WS-831031                PIC XX VALUE X'7DBF'.
   626     05  WS-831231                PIC XX VALUE X'7DFF'.
   627     05  WS-810831                PIC XX VALUE X'7A7F'.
   628     05  WS-830901                PIC XX VALUE X'7D81'.
   629
   630 01  FILE-ACCESS-IDS.
   631     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   632     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   633     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   634     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   635     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   636     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   637     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   638     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   639     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   640     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   641     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   642     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   643     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   644     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   645     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   646     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   647     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   648 01  DD-IU-SW                    PIC X   VALUE ' '.
   649     88  DD-IU-PRESENT                 VALUE 'Y'.
   650
   651 01  ACCESS-KEYS.
   652     12  ELMSTR-KEY.
   653         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   654         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   655     12  W-CLAIM-KEY.
   656         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   657         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   658
   659     12  ELCNTL-KEY.
   660         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   661         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   662         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   663         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   664
   665     12  ELCERT-KEY.
   666         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   667         16  CERT-CARRIER         PIC X       VALUE SPACE.
   668         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   669         16  CERT-STATE           PIC XX      VALUE SPACES.
   670         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   671         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   672         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   673
   674     12  ELCERT2-KEY.
   675         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   676         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   677
   678     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   679
   680     12  ELCERT-SAVE.
   681         16  FILLER                      PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  14
* EL050.cbl
   682
   683         16  WCS-CONTROL-PRIMARY.
   684             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   685             20  WCS-CARRIER             PIC X     VALUE SPACE.
   686             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   687             20  WCS-STATE               PIC XX    VALUE SPACES.
   688             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   689             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   690             20  WCS-CERT-NO.
   691                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   692                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   693
   694         16  CS-CONTROL-BY-NAME.
   695             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   696             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   697             20  CS-INSURED-INITIALS.
   698                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   699                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   700
   701         16  CS-CONTROL-BY-SSN.
   702             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   703             20  CS-SOC-SEC-NO.
   704                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   705                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   706                 24  CS-SSN-LN3.
   707                     28 CS-INSURED-INITIALS-A2   PIC XX
   708                                     VALUE SPACES.
   709                     28 CS-PART-LAST-NAME-A2     PIC X
   710                                     VALUE SPACE.
   711
   712         16  CS-CONTROL-BY-CERT-NO.
   713             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   714             20  CS-CERT-NO-A4           PIC X(11)
   715                                     VALUE SPACES.
   716
   717         16  CS-CONTROL-BY-MEMB.
   718             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   719             20  CS-MEMBER-NO.
   720                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   721                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   722                 24  CS-MEMB-LN4.
   723                     28 CS-INSURED-INITIALS-A5   PIC XX
   724                                      VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A5     PIC XX
   726                                      VALUE SPACES.
   727
   728         16  FILLER              PIC X(360) VALUE SPACES.
   729
   730     12  ERACCT-KEY.
   731         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   732         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   733         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   734         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   735         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   736         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   737
   738     12  ERCOMP-KEY.
   739         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  15
* EL050.cbl
   740         16  COMP-CARRIER         PIC X     VALUE SPACES.
   741         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   742         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   743         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   744         16  COMP-TYPE            PIC X     VALUE SPACES.
   745
   746     12  ERLOFC-KEY.
   747         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   749         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   750         16  LOFC-STATE           PIC XX    VALUE SPACES.
   751         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   753
   754     12  WS-ELCRTT-KEY.
   755         16  WS-ELCRTT-PRIMARY       PIC X(33).
   756         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   757
   758     12  ERBXRF-KEY.
   759         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   760         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   761         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   762         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   763
   764     12  ERAGTC-KEY.
   765         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   766         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   767         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   768         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   769         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   770         16  AGTC-TYPE            PIC X     VALUE SPACES.
   771
   772     12  ERPLAN-KEY.
   773         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   774         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   775         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   776         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   777         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   778         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   779         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   780         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   781
   782     12  ERFORM-KEY.
   783         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   784         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   785         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   786         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   787
   788     12  ERREIN-KEY.
   789         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   790         16  REIN-TYPE            PIC X     VALUE SPACES.
   791         16  REIN-TABLE-CO.
   792             20  REIN-CODE-1      PIC X     VALUE SPACE.
   793             20  REIN-CODE-2      PIC X     VALUE SPACE.
   794             20  REIN-CODE-3      PIC X     VALUE SPACE.
   795         16  FILLER               PIC X(3)  VALUE SPACES.
   796
   797     12  ERCTBL-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  16
* EL050.cbl
   798         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   799         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   800         16  CTBL-CNTRL-2.
   801             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   802             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   803
   804     12  WS-ACCESS.
   805         16  FILLER               PIC XX    VALUE SPACES.
   806         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   807
   808     12  WS-CARR-ACCESS.
   809         16  FILLER               PIC X(3)  VALUE SPACES.
   810         16  WS-CARR              PIC X     VALUE SPACE.
   811*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   812*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   813     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   814         88  WS-DMD-LF-RATING   VALUE 'Y'.
   815         88  WS-DMD-AH-RATING   VALUE 'Y'.
   816         88  WS-DMD-NO-RATING   VALUE 'N'.
   817
   818     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   819         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   820                                         'NJ' 'NL'
   821                                         'PJ' 'PL'
   822                                         'SJ' 'SL'.
   823     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   824         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   825                                         'NI' 'NJ' 'NL' 'NU'
   826                                         'PJ' 'PL' 'PI' 'PU'
   827                                         'SI' 'SJ' 'SL' 'SU'
   828                                         'MX' 'MY' 'MZ'.
   829 01  ERPDEF-KEY-SAVE             PIC X(18).
   830 01  ERPDEF-KEY.
   831     12  ERPDEF-COMPANY-CD       PIC X.
   832     12  ERPDEF-STATE            PIC XX.
   833     12  ERPDEF-PROD-CD          PIC XXX.
   834     12  F                       PIC X(7).
   835     12  ERPDEF-BEN-TYPE         PIC X.
   836     12  ERPDEF-BEN-CODE         PIC XX.
   837     12  ERPDEF-EXP-DT           PIC XX.
   838
   839 01  ELSTAT-KEY-SAVE             PIC X(20).
   840 01  ELSTAT-KEY.
   841     12  ELSTAT-COMPANY-ID       PIC XXX.
   842     12  ELSTAT-CARRIER          PIC X.
   843     12  ELSTAT-GROUP            PIC X(6).
   844     12  ELSTAT-STATE            PIC XX.
   845     12  ELSTAT-EXP-DT           PIC 9(8).
   846 01  WS-ERROR-VALUES.
   847     12  ER-1570                     PIC S9(4)   VALUE +1570.
   848     12  ER-1571                     PIC S9(4)   VALUE +1571.
   849     12  ER-1575                     PIC S9(4)   VALUE +1575.
   850     12  ER-1891                     PIC S9(4)   VALUE +1891.
   851     12  ER-1892                     PIC S9(4)   VALUE +1892.
   852     12  ER-1893                     PIC S9(4)   VALUE +1893.
   853     12  ER-1894                     PIC S9(4)   VALUE +1894.
   854     12  ER-1895                     PIC S9(4)   VALUE +1895.
   855     12  ER-1896                     PIC S9(4)   VALUE +1896.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  17
* EL050.cbl
   856     12  ER-1897                     PIC S9(4)   VALUE +1897.
   857     12  ER-1898                     PIC S9(4)   VALUE +1898.
   858     12  ER-1899                     PIC S9(4)   VALUE +1899.
   859     12  ER-1900                     PIC S9(4)   VALUE +1900.
   860     12  ER-1901                     PIC S9(4)   VALUE +1901.
   861     12  ER-1902                     PIC S9(4)   VALUE +1902.
   862     12  ER-1903                     PIC S9(4)   VALUE +1903.
   863     12  ER-1904                     PIC S9(4)   VALUE +1904.
   864     12  ER-1905                     PIC S9(4)   VALUE +1905.
   865     12  ER-1906                     PIC S9(4)   VALUE +1906.
   866     12  ER-1907                     PIC S9(4)   VALUE +1907.
   867     12  ER-1909                     PIC S9(4)   VALUE +1909.
   868     12  ER-1910                     PIC S9(4)   VALUE +1910.
   869     12  ER-1911                     PIC S9(4)   VALUE +1911.
   870     12  ER-1912                     PIC S9(4)   VALUE +1912.
   871     12  ER-1913                     PIC S9(4)   VALUE +1913.
   872     12  ER-1914                     PIC S9(4)   VALUE +1914.
   873     12  ER-1915                     PIC S9(4)   VALUE +1915.
   874     12  ER-1916                     PIC S9(4)   VALUE +1916.
   875     12  ER-1917                     PIC S9(4)   VALUE +1917.
   876     12  ER-1918                     PIC S9(4)   VALUE +1918.
   877     12  ER-1919                     PIC S9(4)   VALUE +1919.
   878     12  ER-1920                     PIC S9(4)   VALUE +1920.
   879     12  ER-1921                     PIC S9(4)   VALUE +1921.
   880     12  ER-1922                     PIC S9(4)   VALUE +1922.
   881     12  ER-1923                     PIC S9(4)   VALUE +1923.
   882     12  ER-1924                     PIC S9(4)   VALUE +1924.
   883     12  ER-1925                     PIC S9(4)   VALUE +1925.
   884     12  ER-1926                     PIC S9(4)   VALUE +1926.
   885     12  ER-1927                     PIC S9(4)   VALUE +1927.
   886     12  ER-2393                     PIC S9(4)   VALUE +2393.
   887     12  ER-2600                     PIC S9(4)   VALUE +2600.
   888     12  ER-2601                     PIC S9(4)   VALUE +2601.
   889     12  ER-2602                     PIC S9(4)   VALUE +2602.
   890     12  ER-2603                     PIC S9(4)   VALUE +2603.
   891     12  ER-2604                     PIC S9(4)   VALUE +2604.
   892     12  ER-2605                     PIC S9(4)   VALUE +2605.
   893     12  ER-2606                     PIC S9(4)   VALUE +2606.
   894     12  ER-2607                     PIC S9(4)   VALUE +2607.
   895     12  ER-2608                     PIC S9(4)   VALUE +2608.
   896     12  ER-2609                     PIC S9(4)   VALUE +2609.
   897     12  ER-2610                     PIC S9(4)   VALUE +2610.
   898     12  ER-2611                     PIC S9(4)   VALUE +2611.
   899     12  ER-2612                     PIC S9(4)   VALUE +2612.
   900     12  ER-2613                     PIC S9(4)   VALUE +2613.
   901     12  ER-2614                     PIC S9(4)   VALUE +2614.
   902     12  ER-2615                     PIC S9(4)   VALUE +2615.
   903     12  ER-2616                     PIC S9(4)   VALUE +2616.
   904     12  ER-2617                     PIC S9(4)   VALUE +2617.
   905     12  ER-2618                     PIC S9(4)   VALUE +2618.
   906     12  ER-2619                     PIC S9(4)   VALUE +2619.
   907     12  ER-2620                     PIC S9(4)   VALUE +2620.
   908     12  ER-2621                     PIC S9(4)   VALUE +2621.
   909     12  ER-2622                     PIC S9(4)   VALUE +2622.
   910     12  ER-2623                     PIC S9(4)   VALUE +2623.
   911     12  ER-2624                     PIC S9(4)   VALUE +2624.
   912     12  ER-2625                     PIC S9(4)   VALUE +2625.
   913     12  ER-2626                     PIC S9(4)   VALUE +2626.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  18
* EL050.cbl
   914     12  ER-2627                     PIC S9(4)   VALUE +2627.
   915     12  ER-2628                     PIC S9(4)   VALUE +2628.
   916     12  ER-2629                     PIC S9(4)   VALUE +2629.
   917     12  ER-2630                     PIC S9(4)   VALUE +2630.
   918     12  ER-2631                     PIC S9(4)   VALUE +2631.
   919     12  ER-2632                     PIC S9(4)   VALUE +2632.
   920     12  ER-2633                     PIC S9(4)   VALUE +2633.
   921     12  ER-2634                     PIC S9(4)   VALUE +2634.
   922     12  ER-2635                     PIC S9(4)   VALUE +2635.
   923     12  ER-2636                     PIC S9(4)   VALUE +2636.
   924     12  ER-2637                     PIC S9(4)   VALUE +2637.
   925     12  ER-2638                     PIC S9(4)   VALUE +2638.
   926     12  ER-2639                     PIC S9(4)   VALUE +2639.
   927     12  ER-2640                     PIC S9(4)   VALUE +2640.
   928     12  ER-2641                     PIC S9(4)   VALUE +2641.
   929     12  ER-2642                     PIC S9(4)   VALUE +2642.
   930     12  ER-2643                     PIC S9(4)   VALUE +2643.
   931     12  ER-2644                     PIC S9(4)   VALUE +2644.
   932     12  ER-2645                     PIC S9(4)   VALUE +2645.
   933     12  ER-2646                     PIC S9(4)   VALUE +2646.
   934     12  ER-2647                     PIC S9(4)   VALUE +2647.
   935     12  ER-2648                     PIC S9(4)   VALUE +2648.
   936     12  ER-2649                     PIC S9(4)   VALUE +2649.
   937     12  ER-2650                     PIC S9(4)   VALUE +2650.
   938     12  ER-2651                     PIC S9(4)   VALUE +2651.
   939     12  ER-2652                     PIC S9(4)   VALUE +2652.
   940     12  ER-2653                     PIC S9(4)   VALUE +2653.
   941     12  ER-2654                     PIC S9(4)   VALUE +2654.
   942     12  ER-2655                     PIC S9(4)   VALUE +2655.
   943     12  ER-2656                     PIC S9(4)   VALUE +2656.
   944     12  ER-2657                     PIC S9(4)   VALUE +2657.
   945     12  ER-2658                     PIC S9(4)   VALUE +2658.
   946     12  ER-2659                     PIC S9(4)   VALUE +2659.
   947     12  ER-2660                     PIC S9(4)   VALUE +2660.
   948     12  ER-2661                     PIC S9(4)   VALUE +2661.
   949     12  ER-2662                     PIC S9(4)   VALUE +2662.
   950     12  ER-2663                     PIC S9(4)   VALUE +2663.
   951     12  ER-2664                     PIC S9(4)   VALUE +2664.
   952     12  ER-2665                     PIC S9(4)   VALUE +2665.
   953     12  ER-2666                     PIC S9(4)   VALUE +2666.
   954     12  ER-2667                     PIC S9(4)   VALUE +2667.
   955     12  ER-2668                     PIC S9(4)   VALUE +2668.
   956     12  ER-2669                     PIC S9(4)   VALUE +2669.
   957     12  ER-2670                     PIC S9(4)   VALUE +2670.
   958     12  ER-2671                     PIC S9(4)   VALUE +2671.
   959     12  ER-2672                     PIC S9(4)   VALUE +2672.
   960     12  ER-2673                     PIC S9(4)   VALUE +2673.
   961     12  ER-2674                     PIC S9(4)   VALUE +2674.
   962     12  ER-2675                     PIC S9(4)   VALUE +2675.
   963     12  ER-2676                     PIC S9(4)   VALUE +2676.
   964     12  ER-2677                     PIC S9(4)   VALUE +2677.
   965     12  ER-2678                     PIC S9(4)   VALUE +2678.
   966     12  ER-2679                     PIC S9(4)   VALUE +2679.
   967     12  ER-2680                     PIC S9(4)   VALUE +2680.
   968     12  ER-2681                     PIC S9(4)   VALUE +2681.
   969     12  ER-2682                     PIC S9(4)   VALUE +2682.
   970     12  ER-2683                     PIC S9(4)   VALUE +2683.
   971     12  ER-2684                     PIC S9(4)   VALUE +2684.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  19
* EL050.cbl
   972     12  ER-2685                     PIC S9(4)   VALUE +2685.
   973     12  ER-2686                     PIC S9(4)   VALUE +2686.
   974     12  ER-2687                     PIC S9(4)   VALUE +2687.
   975     12  ER-2688                     PIC S9(4)   VALUE +2688.
   976     12  ER-2689                     PIC S9(4)   VALUE +2689.
   977     12  ER-2690                     PIC S9(4)   VALUE +2690.
   978     12  ER-2691                     PIC S9(4)   VALUE +2691.
   979     12  ER-2692                     PIC S9(4)   VALUE +2692.
   980     12  ER-2693                     PIC S9(4)   VALUE +2693.
   981     12  ER-2694                     PIC S9(4)   VALUE +2694.
   982     12  ER-2695                     PIC S9(4)   VALUE +2695.
   983     12  ER-2696                     PIC S9(4)   VALUE +2696.
   984     12  ER-2697                     PIC S9(4)   VALUE +2697.
   985     12  ER-2698                     PIC S9(4)   VALUE +2698.
   986     12  ER-2699                     PIC S9(4)   VALUE +2699.
   987     12  ER-2700                     PIC S9(4)   VALUE +2700.
   988     12  ER-2701                     PIC S9(4)   VALUE +2701.
   989     12  ER-2702                     PIC S9(4)   VALUE +2702.
   990     12  ER-2703                     PIC S9(4)   VALUE +2703.
   991     12  ER-2704                     PIC S9(4)   VALUE +2704.
   992     12  ER-2707                     PIC S9(4)   VALUE +2707.
   993     12  ER-2720                     PIC S9(4)   VALUE +2720.
   994     12  ER-2709                     PIC S9(4)   VALUE +2709.
   995     12  ER-2717                     PIC S9(4)   VALUE +2717.
   996     12  ER-2718                     PIC S9(4)   VALUE +2718.
   997     12  ER-2719                     PIC S9(4)   VALUE +2719.
   998     12  ER-2721                     PIC S9(4)   VALUE +2721.
   999     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1000     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1001     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1002     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1003     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1004     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1005     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1006     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1007     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1008     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1009     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1010     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1011     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1012     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1013     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1014     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1015     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1016     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1017     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1018     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1019     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1020     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1021     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1022     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1023     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1024     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1025     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1026     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1027     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1028     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1029     12  ER-2752                     PIC S9(4)   VALUE +2752.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  20
* EL050.cbl
  1030     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1031     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1032     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1033     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1034     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1035     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1036     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1037     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1038     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1039     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1040     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1041     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1042     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1043     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1044     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1045     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1046     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1047     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1048     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1049     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1050     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1051     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1052     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1053     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1054     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1055     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1056     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1057     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1058     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1059     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1060     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1061     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1062     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1063     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1064     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1065     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1066     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1067     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1068     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1069     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1070     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1071     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1072     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1073     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1074     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1075     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1076     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1077     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1078     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1079     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1080     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1081     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1082     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1083     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1084     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1085     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1086     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1087     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  21
* EL050.cbl
  1088     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1089     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1090     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1091     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1092     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1093     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1094     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1095     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1096     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1097     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1098     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1099     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1100     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1101     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1102     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1103     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1104     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1105     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1106     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1107     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1108     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1109     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1110     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1111     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1112     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1113     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1114     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1115     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1116     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1117     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1118     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1119     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1120     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1121     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1122     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1123     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1124     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1125     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1126     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1127     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1128     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1129     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1130     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1131     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1132     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1133     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1134     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1135     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1136     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1137     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1138     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1139     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1140     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1141     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1142     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1143     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1144     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1145     12  ER-8085                     PIC S9(4)   VALUE +8085.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  22
* EL050.cbl
  1146     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1147     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1148     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1149     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1150     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1151     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1152     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1153     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1154     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1155     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1156     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1157     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1158     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1159     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1160     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1161     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1162     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1163     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1164     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1165     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1166     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1167     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1168     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1169     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1170     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1171     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1172     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1173     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1174     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1175     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1176     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1177     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1178     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1179     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1180     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1181     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1182     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1183     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1184     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1185     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1186     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1187******************************************************************
  1188***************   END OF ELC50WS     ****************************
  1189******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  23
* EL050.cbl
  1192 01  WORKING-STORAGE-WORK-AREAS.
  1193     12  WS-RESPONSE             PIC S9(8)  COMP.
  1194         88  WS-RESP-NORMAL           VALUE +00.
  1195         88  WS-RESP-ERROR            VALUE +01.
  1196         88  WS-RESP-NOTFND           VALUE +13.
  1197         88  WS-RESP-DUPREC           VALUE +14.
  1198         88  WS-RESP-ENDFILE          VALUE +20.
  1199     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1200     12  WORK-AREAS.
  1201         16  WK-CONV-GREG.
  1202             24  WCG-CENT             PIC XX.
  1203             24  WCG-REST             PIC X(4).
  1204         16  WORK-GREGORIAN-DATE.
  1205             24  WK-GREG-CENT         PIC XX.
  1206             24  WK-GREG-DATE-YYMMDD.
  1207                 28  WK-GREG-YYMM     PIC X(4).
  1208                 28  WK-GREG-DD       PIC XX.
  1209
  1210         16  WORK-SELECT-DATE.
  1211             24  WK-SELECT-CENT            PIC XX.
  1212             24  WK-SELECT-DATE-YYMMDD.
  1213                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1214                 28  FILLER                PIC XX.
  1215
  1216         16  WK-FORM-NO.
  1217             24  WK-FORM-BANK-ID       PIC X(5).
  1218             24  WK-FORM-UNDRWRTR      PIC X(1).
  1219             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1220
  1221         16  WK-MEMBER-NO.
  1222             24  WK-MEMBER-1-6        PIC X(6).
  1223             24  WK-MEMBER-7-12       PIC X(6).
  1224
  1225         16  WK-FULL-CERT-NO.
  1226             24  WK-CERT-POS-1-2      PIC X(2).
  1227             24  WK-CERT-POS-3        PIC X(1).
  1228             24  WK-CERT-POS-4        PIC X(1).
  1229             24  WK-CERT-POS-5-6      PIC X(2).
  1230             24  WK-CERT-POS-7        PIC X(1).
  1231             24  WK-CERT-POS-8-11     PIC X(4).
  1232
  1233         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1234             88  VALID-RATE-CODE        VALUE 'Y'.
  1235             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1236
  1237         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1238         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1239         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1240         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1241         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1242         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1243         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1244         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1245         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1246         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1247
  1248* DLO001
  1249 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  24
* EL050.cbl
  1250     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1251     12  DMPF-RETURN-CODE          PIC XX.
  1252         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1253         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1254         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1255         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1256         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1257         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1258
  1259* DLO002
  1260 01  WS-DLO-INTERNAL-POLICY-FORM.
  1261     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1262     12  DIPF-RETURN-CODE          PIC XX.
  1263         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1264         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1265         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1266         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1267         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1268         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1269
  1270* DLO003
  1271 01  WS-DLO-VALID-BANK-ID.
  1272     12  DVBI-BANK-ID              PIC X(5).
  1273     12  DVBI-BANK-ID-TYPE         PIC X.
  1274         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1275         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1276         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1277         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1278         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1279     12  DVBI-RETURN-CODE          PIC XX.
  1280         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1281         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1282         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1283         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1284         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1285         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1286         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1287         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1288         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1289
  1290* DLO007
  1291 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1292     12  DCUA-RES-STATE            PIC XX.
  1293     12  DCUA-BEN-TYPE             PIC XX.
  1294     12  DCUA-SYS-IDENT            PIC X.
  1295         88  DCUA-CLAIM                        VALUE 'C'.
  1296         88  DCUA-PREMIUM                      VALUE 'P'.
  1297     12  DCUA-COVERAGE-RULE        PIC X.
  1298     12  DCUA-CLIENT-ID            PIC X(10).
  1299     12  DCUA-EFF-DATE             PIC X(8).
  1300     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1301     12  DCUA-RETURN-CODE          PIC XX.
  1302         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1303     12  DCUA-CERT-NUMBER          PIC X(11).
  1304     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1305     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1306
  1307* DLO011
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  25
* EL050.cbl
  1308 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1309     12  DPRB-RATE-CODE            PIC X(4).
  1310     12  DPRB-COVERAGE-CATEG       PIC X.
  1311     12  DPRB-RETURN-CODE          PIC XX.
  1312         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1313         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1314         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1315         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1316         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1317         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1318         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1319         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1320         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1321     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1322     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1323     12  DPRB-BEN-TYPE             PIC XX.
  1324
  1325* DLO017
  1326 01  WS-DLO-VALID-RATE-CODE.
  1327     12  DVRC-RATE-CODE            PIC X(4).
  1328     12  DVRC-RETURN-CODE          PIC XX.
  1329         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1330         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1331         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1332         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1333         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1334         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1335
  1336* DLO019
  1337 01  WS-DLO-ORIG-COV-CAT.
  1338     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1339     12  DOCC-RETURN-CODE          PIC XX.
  1340     12  DOCC-ORIG-COV-CAT         PIC X.
  1341     12  DOCC-UNDERWITER           PIC XX.
  1342     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1343     12  DOCC-FILLER               PIC X(6).
  1344
  1345* DLO021
  1346 01  WS-DLO-VALID-LOAN-OFFICER.
  1347     12  DVLO-LOAN-OFFICER.
  1348         16  DVLO-BILL-TYPE        PIC X.
  1349         16  DVLO-BILL-SOURCE      PIC X.
  1350         16  DVLO-BATCH-TYPE       PIC X.
  1351     12  DVLO-RETURN-CODE          PIC XX.
  1352         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1353         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1354         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1355         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1356         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1357         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1358
  1359* DLO022
  1360 01  WS-DLO-VALID-STATE-CODE.
  1361     12  DVSC-STATE-CODE           PIC XX.
  1362     12  DVSC-RETURN-CODE          PIC XX.
  1363         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1364
  1365* DLO023
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  26
* EL050.cbl
  1366 01  WS-DLO-VALID-CODE-VALUES.
  1367     12  DVCV-SYSTEM-ID            PIC XX.
  1368         88  DVCV-CLAIMS                       VALUE 'CL'.
  1369         88  DVCV-CREDIT                       VALUE 'CR'.
  1370     12  DVCV-RECORD-TYPE          PIC XX.
  1371         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1372         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1373         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1374         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1375         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1376         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1377         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1378         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1379     12  DVCV-RECORD-KEY           PIC X(6).
  1380     12  DVCV-RETURN-CODE          PIC XX.
  1381         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1382         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1383         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1384         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1385         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1386         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1387         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1388     12  DVCV-CODE-DESC            PIC X(60).
  1389     12  DVCV-GEN-DESC-1           PIC X(20).
  1390     12  DVCV-GEN-DESC-2           PIC X(20).
  1391     12  DVCV-GEN-DESC-3           PIC X(20).
  1392
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  27
* EL050.cbl
  1394*    COPY ERCBXRF.
  1395******************************************************************
  1396*                                                                *
  1397*                                                                *
  1398*                            ERCBXRF                             *
  1399*                                                                *
  1400*   ONLINE CREDIT SYSTEM                                         *
  1401*                                                                *
  1402*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1403*                                                                *
  1404*   FILE TYPE = VSAM,KSDS                                        *
  1405*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1406*                                                                *
  1407*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1408*       ALTERNATE PATH = NONE                                    *
  1409*                                                                *
  1410*   LOG = NO                                                     *
  1411*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1412*                                                                *
  1413******************************************************************
  1414
  1415 01  BANK-CROSS-REFERENCE.
  1416     12  BK-RECORD-ID                PIC XX.
  1417         88  VALID-BK-ID             VALUE 'BK'.
  1418
  1419     12  BK-CONTROL-PRIMARY.
  1420         16  BK-COMPANY-CD           PIC X.
  1421         16  BK-CARRIER              PIC X.
  1422         16  BK-GROUPING             PIC X(6).
  1423         16  BK-BANK-NO              PIC X(10).
  1424
  1425     12  BK-MAINT-INFORMATION.
  1426         16  BK-LAST-MAINT-DT        PIC XX.
  1427         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1428         16  BK-LAST-MAINT-USER      PIC X(4).
  1429         16  FILLER                  PIC X(9).
  1430
  1431     12  FILLER                      PIC X(37).
  1432
  1433     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1434
  1435     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1436                            DEPENDING ON BK-BANK-POINTER-CNT.
  1437         16  BK-AM-ACCOUNT           PIC X(10).
  1438         16  BK-AM-EXP-DT            PIC XX.
  1439         16  BK-AM-EFF-DT            PIC XX.
  1440         16  BK-AM-STATE             PIC XX.
  1441         16  FILLER                  PIC X(20).
  1442
  1443******************************************************************
  1444
  1445*    COPY ERCCOMP.
  1446******************************************************************
  1447*                                                                *
  1448*                                                                *
  1449*                            ERCCOMP                             *
  1450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1451*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  28
* EL050.cbl
  1452*                                                                *
  1453*   ONLINE CREDIT SYSTEM                                         *
  1454*                                                                *
  1455*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1456*                                                                *
  1457*   FILE TYPE = VSAM,KSDS                                        *
  1458*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1459*                                                                *
  1460*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1461*       ALTERNATE PATH = NONE                                    *
  1462*                                                                *
  1463*   LOG = NO                                                     *
  1464*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1465*                                                                *
  1466******************************************************************
  1467*                   C H A N G E   L O G
  1468*
  1469* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1470*-----------------------------------------------------------------
  1471*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1472* EFFECTIVE    NUMBER
  1473*-----------------------------------------------------------------
  1474* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1475* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1476* 092205    2005050300006  PEMA  ADD LEASE FEE
  1477* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1478* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1479* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1480* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1481* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1482******************************************************************
  1483
  1484 01  COMPENSATION-MASTER.
  1485     12  CO-RECORD-ID                          PIC XX.
  1486         88  VALID-CO-ID                          VALUE 'CO'.
  1487
  1488     12  CO-CONTROL-PRIMARY.
  1489         16  CO-COMPANY-CD                     PIC X.
  1490         16  CO-CONTROL.
  1491             20  CO-CTL-1.
  1492                 24  CO-CARR-GROUP.
  1493                     28  CO-CARRIER            PIC X.
  1494                     28  CO-GROUPING.
  1495                         32  CO-GROUP-PREFIX   PIC XXX.
  1496                         32  CO-GROUP-PRIME    PIC XXX.
  1497                 24  CO-RESP-NO.
  1498                     28  CO-RESP-PREFIX        PIC X(4).
  1499                     28  CO-RESP-PRIME         PIC X(6).
  1500             20  CO-CTL-2.
  1501                 24  CO-ACCOUNT.
  1502                     28  CO-ACCT-PREFIX        PIC X(4).
  1503                     28  CO-ACCT-PRIME         PIC X(6).
  1504         16  CO-TYPE                           PIC X.
  1505             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1506             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1507             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1508
  1509     12  CO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  29
* EL050.cbl
  1510         16  CO-LAST-MAINT-DT                  PIC XX.
  1511         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1512         16  CO-LAST-MAINT-USER                PIC X(4).
  1513     12  FILLER                                PIC XX.
  1514     12  CO-STMT-TYPE                          PIC XXX.
  1515     12  CO-COMP-TYPE                          PIC X.
  1516         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1517     12  CO-STMT-OWNER                         PIC X(4).
  1518     12  CO-BALANCE-CONTROL                    PIC X.
  1519         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1520         88  CO-NO-BALANCE                        VALUE 'N'.
  1521
  1522     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1523         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1524         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1525         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1526
  1527     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1528         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1529         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1530
  1531     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1532     12  CO-GA-DIRECT-DEP                      PIC X.
  1533     12  CO-FUTURE-SPACE                       PIC X.
  1534         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1535
  1536     12  CO-ACCT-NAME                          PIC X(30).
  1537     12  CO-MAIL-NAME                          PIC X(30).
  1538     12  CO-ADDR-1                             PIC X(30).
  1539     12  CO-ADDR-2                             PIC X(30).
  1540     12  CO-ADDR-3.
  1541         16  CO-ADDR-CITY                      PIC X(27).
  1542         16  CO-ADDR-STATE                     PIC XX.
  1543     12  CO-CSO-1099                           PIC X.
  1544     12  CO-ZIP.
  1545         16  CO-ZIP-PRIME.
  1546             20  CO-ZIP-PRI-1ST                PIC X.
  1547                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1548             20  FILLER                        PIC X(4).
  1549         16  CO-ZIP-PLUS4                      PIC X(4).
  1550     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1551         16  CO-CAN-POSTAL-1                   PIC XXX.
  1552         16  CO-CAN-POSTAL-2                   PIC XXX.
  1553         16  FILLER                            PIC XXX.
  1554     12  CO-SOC-SEC                            PIC X(13).
  1555     12  CO-TELEPHONE.
  1556         16  CO-AREA-CODE                      PIC XXX.
  1557         16  CO-PREFIX                         PIC XXX.
  1558         16  CO-PHONE                          PIC X(4).
  1559
  1560     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1561
  1562     12  CO-AR-BAL-LEVEL                       PIC X.
  1563         88  CO-AR-REF-LVL                        VALUE '1'.
  1564         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1565         88  CO-AR-BILL-LVL                       VALUE '2'.
  1566         88  CO-AR-AGT-LVL                        VALUE '3'.
  1567         88  CO-AR-FR-LVL                         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  30
* EL050.cbl
  1568
  1569     12  CO-AR-NORMAL-PRINT                    PIC X.
  1570         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1571         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1572
  1573     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1574
  1575     12  CO-AR-REPORTING                       PIC X.
  1576         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1577         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1578
  1579     12  CO-AR-PULL-CHECK                      PIC X.
  1580         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1581         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1582
  1583     12  CO-AR-BALANCE-PRINT                   PIC X.
  1584         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1585
  1586     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1587         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1588         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1589         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1590
  1591     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1592
  1593     12  CO-USER-CODE                          PIC X.
  1594     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1595
  1596******************************************************************
  1597*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1598*    THE LAST MONTH END RUN.
  1599******************************************************************
  1600
  1601     12  CO-LAST-ACTIVITY-DATE.
  1602         16  CO-ACT-YEAR                       PIC 99.
  1603         16  CO-ACT-MONTH                      PIC 99.
  1604         16  CO-ACT-DAY                        PIC 99.
  1605
  1606     12  CO-LAST-STMT-DT.
  1607         16  CO-LAST-STMT-YEAR                 PIC 99.
  1608         16  CO-LAST-STMT-MONTH                PIC 99.
  1609         16  CO-LAST-STMT-DAY                  PIC 99.
  1610
  1611     12  CO-MO-END-TOTALS.
  1612         16  CO-MONTHLY-TOTALS.
  1613             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1614             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1615             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1616             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1617             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1618
  1619         16  CO-AGING-TOTALS.
  1620             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1621             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1622             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1623             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1624
  1625         16  CO-YTD-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  31
* EL050.cbl
  1626             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1627             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1628
  1629         16  CO-OVER-UNDER-TOTALS.
  1630             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1631             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1632
  1633     12  CO-MISCELLANEOUS-TOTALS.
  1634         16  CO-FICA-TOTALS.
  1635             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1636             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1637
  1638         16  CO-CLAIM-TOTALS.
  1639             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1640             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1641
  1642******************************************************************
  1643*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1644*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1645******************************************************************
  1646
  1647     12  CO-CURRENT-TOTALS.
  1648         16  CO-CURRENT-LAST-STMT-DT.
  1649             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1650             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1651             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1652
  1653         16  CO-CURRENT-MONTHLY-TOTALS.
  1654             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1655             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1656             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1657             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1658             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1659
  1660         16  CO-CURRENT-AGING-TOTALS.
  1661             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1662             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1663             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1664             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1665
  1666         16  CO-CURRENT-YTD-TOTALS.
  1667             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1668             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1669
  1670     12  CO-PAID-COMM-TOTALS.
  1671         16  CO-YTD-PAID-COMMS.
  1672             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1673             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1674
  1675     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1676         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1677         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1678
  1679     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1680         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1681         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1682         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1683         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  32
* EL050.cbl
  1684         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1685         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1686         88  CO-FINAL-LETTER                  VALUE 'F'.
  1687         88  CO-RECONCILING                   VALUE 'R'.
  1688         88  CO-PHONE-CALL                    VALUE 'P'.
  1689         88  CO-LEGAL                         VALUE 'L'.
  1690         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1691         88  CO-WRITE-OFF                     VALUE 'W'.
  1692         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1693
  1694     12  CO-CSR-CODE                       PIC X(4).
  1695
  1696     12  CO-GA-STATUS-INFO.
  1697         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1698         16  CO-GA-TERMINATION-DT          PIC XX.
  1699         16  CO-GA-STATUS-CODE             PIC X.
  1700             88  CO-GA-ACTIVE                 VALUE 'A'.
  1701             88  CO-GA-INACTIVE               VALUE 'I'.
  1702             88  CO-GA-PENDING                VALUE 'P'.
  1703         16  CO-GA-COMMENTS.
  1704             20  CO-GA-COMMENT-1           PIC X(40).
  1705             20  CO-GA-COMMENT-2           PIC X(40).
  1706             20  CO-GA-COMMENT-3           PIC X(40).
  1707             20  CO-GA-COMMENT-4           PIC X(40).
  1708
  1709     12  CO-RPTCD2                         PIC X(10).
  1710
  1711     12  CO-TYPE-AGENT                     PIC X(01).
  1712         88  CO-CORPORATION                   VALUE 'C'.
  1713         88  CO-PARTNERSHIP                   VALUE 'P'.
  1714         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1715         88  CO-TRUST                         VALUE 'T'.
  1716         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1717
  1718     12  CO-FAXNO.
  1719         16  CO-FAX-AREA-CODE                  PIC XXX.
  1720         16  CO-FAX-PREFIX                     PIC XXX.
  1721         16  CO-FAX-PHONE                      PIC X(4).
  1722
  1723     12  CO-BANK-INFORMATION.
  1724         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1725         16  CO-BANK-TRANSIT-NON REDEFINES
  1726             CO-BANK-TRANSIT-NO                PIC 9(8).
  1727
  1728         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1729     12  CO-MISC-DEDUCT-INFO REDEFINES
  1730                  CO-BANK-INFORMATION.
  1731         16  CO-MD-GL-ACCT                     PIC X(10).
  1732         16  CO-MD-DIV                         PIC XX.
  1733         16  CO-MD-CENTER                      PIC X(4).
  1734         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1735         16  CO-CREATE-AP-CHECK                PIC X.
  1736         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1737         16  FILLER                            PIC XXX.
  1738     12  CO-ACH-STATUS                         PIC X.
  1739         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1740         88  CO-ACH-PENDING                        VALUE 'P'.
  1741
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  33
* EL050.cbl
  1742     12  CO-BILL-SW                            PIC X.
  1743     12  CO-CONTROL-NAME                       PIC X(30).
  1744     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1745     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1746     12  CO-CLP-STATE                          PIC XX.
  1747     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1748     12  CO-SPP-REFUND-EDIT                    PIC X.
  1749
  1750******************************************************************
  1751
  1752*    COPY ERCAGTC.
  1753******************************************************************
  1754*                                                                *
  1755*                                                                *
  1756*                            ERCAGTC                             *
  1757*                            VMOD=2.001                          *
  1758*                                                                *
  1759*   ONLINE CREDIT SYSTEM                                         *
  1760*                                                                *
  1761*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1762*                                                                *
  1763*   FILE TYPE = VSAM,KSDS                                        *
  1764*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1765*                                                                *
  1766*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1767*       ALTERNATE PATH = NONE                                    *
  1768*                                                                *
  1769*   LOG = NO                                                     *
  1770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1771*                                                                *
  1772******************************************************************
  1773*                   C H A N G E   L O G
  1774*
  1775* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1776*-----------------------------------------------------------------
  1777*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1778* EFFECTIVE    NUMBER
  1779*-----------------------------------------------------------------
  1780* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1781* 111004                         NEW FILE AND COPYBOOK
  1782* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1783******************************************************************
  1784 01  AGENT-COMMISSIONS.
  1785     12  AG-RECORD-ID                          PIC XX.
  1786         88  VALID-CO-ID                          VALUE 'AG'.
  1787     12  AG-CONTROL-PRIMARY.
  1788         16  AG-COMPANY-CD                     PIC X.
  1789         16  AG-CONTROL.
  1790             20  AG-CTL-1.
  1791                 24  AG-CARR-GROUP.
  1792                     28  AG-CARRIER            PIC X.
  1793                     28  AG-GROUPING           PIC X(6).
  1794                 24  AG-BANK                   PIC X(10).
  1795             20  AG-CTL-2.
  1796                 24  AG-EXP-DT                 PIC XX.
  1797         16  AG-TYPE                           PIC X.
  1798             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1799             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  34
* EL050.cbl
  1800     12  AG-MAINT-INFORMATION.
  1801         16  AG-LAST-MAINT-DT                  PIC XX.
  1802         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1803         16  AG-LAST-MAINT-USER                PIC X(4).
  1804         16  FILLER                            PIC X(10).
  1805     12  AG-EFF-DT                             PIC XX.
  1806     12  AG-COMM-STRUCTURE.
  1807         16  AG-AGT-COMMS OCCURS 10.
  1808             20  AG-AGT                PIC X(10).
  1809             20  AG-COM-TYP            PIC X.
  1810             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1811             20  AG-RECALC-LV-INDIC    PIC X.
  1812             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1813             20  AG-LRCALC-LV-INDIC    PIC X.
  1814             20  FILLER                PIC X(05).
  1815     12  FILLER                  PIC X(145).
  1816******************************************************************
  1817*    COPY ERCRESS.
  1818******************************************************************
  1819*                                                                *
  1820*                            ERCRESS                             *
  1821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1822*                            VMOD=2.002                          *
  1823*                                                                *
  1824*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1825*                                                                *
  1826*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1827*   VSAM RESIDENT STATE TAX MASTER                              *
  1828*                                                                *
  1829*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1830*                                                                *
  1831*   FILE TYPE = VSAM,KSDS                                        *
  1832*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1833*                                                                *
  1834*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1835*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1836*                                                                *
  1837*   LOG = NO                                                     *
  1838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1839*                                                                *
  1840*                                                                *
  1841******************************************************************
  1842
  1843 01  RESIDENT-STATE-TAX-MASTER.
  1844
  1845     10  ERRESS-PRIMARY-KEY.
  1846         15  RES-COMPANY-CD        PIC X.
  1847         15  RES-RESIDENT-STATE    PIC XX.
  1848         15  RES-COVERAGE-CATEGORY PIC X.
  1849         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1850*                                      YYYYMMDD
  1851*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1852
  1853     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
  1854
  1855         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1856         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1857         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  35
* EL050.cbl
  1858         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1859
  1860     10 RES-RECALC-SW              PIC   X.
  1861         88 RECALC                VALUE 'Y'.
  1862         88 NO-RECALC             VALUE 'N'.
  1863     10  RES-MAINT-BY              PIC X(4).
  1864     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1865     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1866*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  36
* EL050.cbl
  1868*    COPY ERCRESC.
  1869******************************************************************
  1870*                                                                *
  1871*                            ERCRESC                             *
  1872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1873*                            VMOD=2.003                          *
  1874*                                                                *
  1875*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1876*                                                                *
  1877*   FILE TYPE = VSAM,KSDS                                        *
  1878*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1879*                                                                *
  1880*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1881*       ALTERNATE PATH1 = NONE                                   *
  1882*                                                                *
  1883*   LOG = NO                                                     *
  1884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1885*                                                                *
  1886******************************************************************
  1887
  1888 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1889
  1890     10  ERRESC-RECORD-KEY.
  1891         15  RESC-COMPANY-CD           PIC   X.
  1892         15  RESC-CARRIER              PIC   X.
  1893         15  RESC-GROUP                PIC   X(6).
  1894         15  RESC-STATE                PIC   XX.
  1895         15  RESC-ACCOUNT              PIC   X(10).
  1896         15  RESC-AGENT                PIC   X(10).
  1897         15  RESC-RESIDENT-STATE       PIC   XX.
  1898         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1899*                                           YYYYMMDD
  1900     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1901
  1902     10  RESC-COMM-RECORD-DATA.
  1903         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1904             20 RESC-COVERAGE-CAT      PIC    X.
  1905             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1906             20 RESC-COMMISSION-TAB REDEFINES
  1907                RESC-COMMISSION-PER    PIC  XXX.
  1908
  1909     10  RESC-MAINT-BY                 PIC X(4).
  1910     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1911     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1912*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  37
* EL050.cbl
  1914*    COPY ERCPLAN.
  1915******************************************************************
  1916*                                                                *
  1917*                                                                *
  1918*                            ERCPLAN                             *
  1919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1920*                            VMOD=2.003                          *
  1921*                                                                *
  1922*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1923*                                                                *
  1924*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1925*   PLAN MASTER                                                  *
  1926*                                                                *
  1927*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1928*                                                                *
  1929*   FILE TYPE = VSAM,KSDS                                        *
  1930*   RECORD SIZE = 420   RECFORM = FIX                            *
  1931*                                                                *
  1932*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1933*       ALTERNATE PATH1 = N/A                                    *
  1934*                                                                *
  1935*   LOG = NO                                                     *
  1936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1937*                                                                *
  1938*                                                                *
  1939******************************************************************
  1940
  1941 01  PLAN-MASTER.
  1942     12  PL-RECORD-ID                      PIC XX.
  1943         88  VALID-PL-ID                      VALUE 'PL'.
  1944
  1945     12  PL-CONTROL-PRIMARY.
  1946         16  PL-COMPANY-CD                 PIC X.
  1947         16  PL-MSTR-CNTRL.
  1948             20  PL-CONTROL-A.
  1949                 24  PL-CARRIER            PIC X.
  1950                 24  PL-GROUPING           PIC X(6).
  1951                 24  PL-STATE              PIC XX.
  1952                 24  PL-ACCOUNT            PIC X(10).
  1953             20  PL-BENEFIT-TYPE           PIC X.
  1954             20  PL-BENEFIT-CODE           PIC XX.
  1955             20  PL-REVISION-NO            PIC X(3).
  1956
  1957     12  PL-CONTROL-BY-VAR-GRP.
  1958         16  PL-COMPANY-CD-A1              PIC X.
  1959         16  PL-VG-CARRIER                 PIC X.
  1960         16  PL-VG-GROUPING                PIC X(6).
  1961         16  PL-VG-STATE                   PIC XX.
  1962         16  PL-VG-ACCOUNT                 PIC X(10).
  1963         16  PL-BENEFIT-TYPE-A1            PIC X.
  1964         16  PL-BENEFIT-CODE-A1            PIC XX.
  1965         16  PL-REVISION-NO-A1             PIC 999.
  1966
  1967     12  PL-MAINT-INFORMATION.
  1968         16  PL-LAST-MAINT-DT              PIC XX.
  1969         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1970         16  PL-LAST-MAINT-USER            PIC X(4).
  1971         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  38
* EL050.cbl
  1972
  1973     12  PL-LIABILITY-LIMITS.
  1974         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1975         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1976             20  PL-LM-AGE                 PIC S99        COMP-3.
  1977             20  PL-LM-DUR                 PIC S999       COMP-3.
  1978             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  1979             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  1980
  1981     12  FILLER                            PIC X(30).
  1982
  1983     12  PL-GL-ACCOUNT-NOS.
  1984         16  PL-PREMIUM-GL                 PIC X(8).
  1985         16  PL-COMM-GL                    PIC X(8).
  1986         16  PL-CLAIM-GL                   PIC X(8).
  1987     12  FILLER                            PIC X(24).
  1988     12  PL-TOLERANCES.
  1989         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  1990         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  1991         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  1992         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  1993         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  1994         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  1995     12  PL-OVER-SHORT.
  1996         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  1997         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  1998     12  FILLER                            PIC X(24).
  1999     12  PLAN-MISC.
  2000         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2001         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2002         16  PL-IG                         PIC X.
  2003         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2004         16  PL-POLICY-FORM                PIC X(12).
  2005         16  PL-EDIT-FOR-FORM              PIC X(01).
  2006         16  PL-DEV-CODE                   PIC XXX.
  2007         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2008         16  PL-CALC-METHOD                PIC X.
  2009         16  PL-BENEFIT-GROUP              PIC X(05).
  2010         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2011
  2012         16  FILLER                        PIC X(99).
  2013******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  39
* EL050.cbl
  2015*    COPY ELCCERT.
  2016******************************************************************
  2017*                                                                *
  2018*                            ELCCERT.                            *
  2019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2020*                            VMOD=2.013                          *
  2021*                                                                *
  2022*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2023*                                                                *
  2024*   FILE TYPE = VSAM,KSDS                                        *
  2025*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2026*                                                                *
  2027*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2028*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2029*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2030*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2031*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2032*                                                                *
  2033*   LOG = YES                                                    *
  2034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2035******************************************************************
  2036*                   C H A N G E   L O G
  2037*
  2038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2039*-----------------------------------------------------------------
  2040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2041* EFFECTIVE    NUMBER
  2042*-----------------------------------------------------------------
  2043* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2044* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2045* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2046* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2047* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2048* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2049* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2050* 032612  CR2011110200001  PEMA  AHL CHANGES
  2051******************************************************************
  2052
  2053 01  CERTIFICATE-MASTER.
  2054     12  CM-RECORD-ID                      PIC XX.
  2055         88  VALID-CM-ID                      VALUE 'CM'.
  2056
  2057     12  CM-CONTROL-PRIMARY.
  2058         16  CM-COMPANY-CD                 PIC X.
  2059         16  CM-CARRIER                    PIC X.
  2060         16  CM-GROUPING.
  2061             20  CM-GROUPING-PREFIX        PIC X(3).
  2062             20  CM-GROUPING-PRIME         PIC X(3).
  2063         16  CM-STATE                      PIC XX.
  2064         16  CM-ACCOUNT.
  2065             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2066             20  CM-ACCOUNT-PRIME          PIC X(6).
  2067         16  CM-CERT-EFF-DT                PIC XX.
  2068         16  CM-CERT-NO.
  2069             20  CM-CERT-PRIME             PIC X(10).
  2070             20  CM-CERT-SFX               PIC X.
  2071
  2072     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  40
* EL050.cbl
  2073         16  CM-COMPANY-CD-A1              PIC X.
  2074         16  CM-INSURED-LAST-NAME          PIC X(15).
  2075         16  CM-INSURED-INITIALS.
  2076             20  CM-INSURED-INITIAL1       PIC X.
  2077             20  CM-INSURED-INITIAL2       PIC X.
  2078
  2079     12  CM-CONTROL-BY-SSN.
  2080         16  CM-COMPANY-CD-A2              PIC X.
  2081         16  CM-SOC-SEC-NO.
  2082             20  CM-SSN-STATE              PIC XX.
  2083             20  CM-SSN-ACCOUNT            PIC X(6).
  2084             20  CM-SSN-LN3.
  2085                 25  CM-INSURED-INITIALS-A2.
  2086                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2087                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2088                 25 CM-PART-LAST-NAME-A2         PIC X.
  2089
  2090     12  CM-CONTROL-BY-CERT-NO.
  2091         16  CM-COMPANY-CD-A4              PIC X.
  2092         16  CM-CERT-NO-A4                 PIC X(11).
  2093
  2094     12  CM-CONTROL-BY-MEMB.
  2095         16  CM-COMPANY-CD-A5              PIC X.
  2096         16  CM-MEMBER-NO.
  2097             20  CM-MEMB-STATE             PIC XX.
  2098             20  CM-MEMB-ACCOUNT           PIC X(6).
  2099             20  CM-MEMB-LN4.
  2100                 25  CM-INSURED-INITIALS-A5.
  2101                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2102                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2103                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2104
  2105     12  CM-INSURED-PROFILE-DATA.
  2106         16  CM-INSURED-FIRST-NAME.
  2107             20  CM-INSURED-1ST-INIT       PIC X.
  2108             20  FILLER                    PIC X(9).
  2109         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2110         16  CM-INSURED-SEX                PIC X.
  2111             88  CM-SEX-MALE                  VALUE 'M'.
  2112             88  CM-SEX-FEMAL                 VALUE 'F'.
  2113         16  CM-INSURED-JOINT-AGE          PIC 99.
  2114         16  CM-JOINT-INSURED-NAME.
  2115             20  CM-JT-LAST-NAME           PIC X(15).
  2116             20  CM-JT-FIRST-NAME.
  2117                 24  CM-JT-1ST-INIT        PIC X.
  2118                 24  FILLER                PIC X(9).
  2119             20  CM-JT-INITIAL             PIC X.
  2120
  2121     12  CM-LIFE-DATA.
  2122         16  CM-LF-BENEFIT-CD              PIC XX.
  2123         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2124         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2125         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2126         16  CM-LF-DEV-CODE                PIC XXX.
  2127         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2128         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2129         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2130         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  41
* EL050.cbl
  2131         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2132         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2133         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2134         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2135         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2136         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2137         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2138         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2139         16  FILLER                        PIC XX.
  2140
  2141     12  CM-AH-DATA.
  2142         16  CM-AH-BENEFIT-CD              PIC XX.
  2143         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2144         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2145         16  CM-AH-DEV-CODE                PIC XXX.
  2146         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2147         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2148         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2149         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2150         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2151         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2152         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2153         16  CM-AH-PAID-THRU-DT            PIC XX.
  2154             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2155         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2156         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2157         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2158         16  FILLER                        PIC X.
  2159
  2160     12  CM-LOAN-INFORMATION.
  2161         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2162         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2163                                           PIC S9(5)V99  COMP-3.
  2164         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2165         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2166         16  CM-PAY-FREQUENCY              PIC S99.
  2167         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2168         16  CM-RATE-CLASS                 PIC XX.
  2169         16  CM-BENEFICIARY                PIC X(25).
  2170         16  CM-POLICY-FORM-NO             PIC X(12).
  2171         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2172         16  CM-LAST-ADD-ON-DT             PIC XX.
  2173         16  CM-DEDUCTIBLE-AMOUNTS.
  2174             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2175             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2176         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2177             20  CM-RESIDENT-STATE         PIC XX.
  2178             20  CM-RATE-CODE              PIC X(4).
  2179             20  FILLER                    PIC XX.
  2180         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2181             20  CM-LOAN-OFFICER           PIC X(5).
  2182             20  FILLER                    PIC XXX.
  2183         16  CM-CSR-CODE                   PIC XXX.
  2184         16  CM-UNDERWRITING-CODE          PIC X.
  2185             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2186         16  CM-POST-CARD-IND              PIC X.
  2187         16  CM-NH-INTERFACE-SW            PIC X.
  2188         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  42
* EL050.cbl
  2189             88  CM-SING-PRM                  VALUE '1'.
  2190             88  CM-O-B-COVERAGE              VALUE '2'.
  2191             88  CM-OPEN-END                  VALUE '3'.
  2192         16  CM-IND-GRP-TYPE               PIC X.
  2193             88  CM-INDIVIDUAL                VALUE 'I'.
  2194             88  CM-GROUP                     VALUE 'G'.
  2195         16  CM-SKIP-CODE                  PIC X.
  2196             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2197             88  SKIP-JULY                    VALUE '1'.
  2198             88  SKIP-AUGUST                  VALUE '2'.
  2199             88  SKIP-SEPTEMBER               VALUE '3'.
  2200             88  SKIP-JULY-AUG                VALUE '4'.
  2201             88  SKIP-AUG-SEPT                VALUE '5'.
  2202             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2203             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2204             88  SKIP-JUNE                    VALUE '8'.
  2205             88  SKIP-JUNE-JULY               VALUE '9'.
  2206             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2207             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2208         16  CM-PAYMENT-MODE               PIC X.
  2209             88  PAY-MONTHLY                  VALUE SPACE.
  2210             88  PAY-WEEKLY                   VALUE '1'.
  2211             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2212             88  PAY-BI-WEEKLY                VALUE '3'.
  2213             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2214         16  CM-LOAN-NUMBER                PIC X(8).
  2215         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2216         16  CM-OLD-LOF                    PIC XXX.
  2217*        16  CM-LOAN-OFFICER               PIC XXX.
  2218         16  CM-REIN-TABLE                 PIC XXX.
  2219         16  CM-SPECIAL-REIN-CODE          PIC X.
  2220         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2221         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2222         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2223
  2224     12  CM-STATUS-DATA.
  2225         16  CM-ENTRY-STATUS               PIC X.
  2226         16  CM-ENTRY-DT                   PIC XX.
  2227
  2228         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2229         16  CM-LF-CANCEL-DT               PIC XX.
  2230         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2231
  2232         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2233         16  CM-LF-DEATH-DT                PIC XX.
  2234         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2235
  2236         16  CM-LF-CURRENT-STATUS          PIC X.
  2237             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2238                                                'M' '4' '5' '9'.
  2239             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2240             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2241             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2242             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2243             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2244             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2245             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2246             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  43
* EL050.cbl
  2247             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2248             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2249             88  CM-LF-DECLINED               VALUE 'D'.
  2250             88  CM-LF-VOIDED                 VALUE 'V'.
  2251
  2252         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2253         16  CM-AH-CANCEL-DT               PIC XX.
  2254         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2255
  2256         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2257         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2258         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2259
  2260         16  CM-AH-CURRENT-STATUS          PIC X.
  2261             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2262                                                'M' '4' '5' '9'.
  2263             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2264             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2265             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2266             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2267             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2268             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2269             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2270             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2271             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2272             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2273             88  CM-AH-DECLINED               VALUE 'D'.
  2274             88  CM-AH-VOIDED                 VALUE 'V'.
  2275
  2276         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2277             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2278             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2279             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2280         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2281
  2282         16  CM-ENTRY-BATCH                PIC X(6).
  2283         16  CM-LF-EXIT-BATCH              PIC X(6).
  2284         16  CM-AH-EXIT-BATCH              PIC X(6).
  2285         16  CM-LAST-MONTH-END             PIC XX.
  2286
  2287     12  CM-NOTE-SW                        PIC X.
  2288         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2289         88  CERT-NOTES-PRESENT               VALUE '1'.
  2290         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2291         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2292         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2293         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2294         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2295         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2296     12  CM-COMP-EXCP-SW                   PIC X.
  2297         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2298         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2299     12  CM-INSURED-ADDRESS-SW             PIC X.
  2300         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2301         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2302
  2303*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2304     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  44
* EL050.cbl
  2305     12  FILLER                            PIC X.
  2306
  2307*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2308     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2309     12  FILLER                            PIC X.
  2310*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2311     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2312
  2313     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2314         88  CERT-ADDED-BATCH                 VALUE ' '.
  2315         88  CERT-ADDED-ONLINE                VALUE '1'.
  2316         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2317         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2318         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2319     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2320         88  CERT-AS-LOADED                   VALUE ' '.
  2321         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2322         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2323         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2324         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2325         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2326         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2327         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2328
  2329     12  CM-ACCOUNT-COMM-PCTS.
  2330         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2331         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2332
  2333     12  CM-USER-FIELD                     PIC X.
  2334     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2335     12  CM-CLP-STATE                      PIC XX.
  2336     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2337     12  CM-USER-RESERVED                  PIC XXX.
  2338     12  FILLER REDEFINES CM-USER-RESERVED.
  2339         16  CM-AH-CLASS-CD                PIC XX.
  2340         16  F                             PIC X.
  2341******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  45
* EL050.cbl
  2343*    COPY ERCMAIL.
  2344******************************************************************
  2345*                                                                *
  2346*                                                                *
  2347*                            ERCMAIL                             *
  2348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2349*                            VMOD=2.003                          *
  2350*                                                                *
  2351*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2352*                                                                *
  2353*   FILE TYPE = VSAM,KSDS                                        *
  2354*   RECORD SIZE = 374   RECFORM = FIX                            *
  2355*                                                                *
  2356*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2357*   ALTERNATE PATH    = NOT USED                                 *
  2358*                                                                *
  2359*   LOG = YES                                                    *
  2360*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2361******************************************************************
  2362*                   C H A N G E   L O G
  2363*
  2364* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2365*-----------------------------------------------------------------
  2366*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2367* EFFECTIVE    NUMBER
  2368*-----------------------------------------------------------------
  2369* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2370* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2371* 111108                   PEMA  ADD CRED BENE ADDR2
  2372******************************************************************
  2373
  2374 01  MAILING-DATA.
  2375     12  MA-RECORD-ID                      PIC XX.
  2376         88  VALID-MA-ID                       VALUE 'MA'.
  2377
  2378     12  MA-CONTROL-PRIMARY.
  2379         16  MA-COMPANY-CD                 PIC X.
  2380         16  MA-CARRIER                    PIC X.
  2381         16  MA-GROUPING.
  2382             20  MA-GROUPING-PREFIX        PIC XXX.
  2383             20  MA-GROUPING-PRIME         PIC XXX.
  2384         16  MA-STATE                      PIC XX.
  2385         16  MA-ACCOUNT.
  2386             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2387             20  MA-ACCOUNT-PRIME          PIC X(6).
  2388         16  MA-CERT-EFF-DT                PIC XX.
  2389         16  MA-CERT-NO.
  2390             20  MA-CERT-PRIME             PIC X(10).
  2391             20  MA-CERT-SFX               PIC X.
  2392
  2393     12  FILLER                            PIC XX.
  2394
  2395     12  MA-ACCESS-CONTROL.
  2396         16  MA-SOURCE-SYSTEM              PIC XX.
  2397             88  MA-FROM-CREDIT                VALUE 'CR'.
  2398             88  MA-FROM-VSI                   VALUE 'VS'.
  2399             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2400             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  46
* EL050.cbl
  2401         16  MA-RECORD-ADD-DT              PIC XX.
  2402         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2403         16  MA-LAST-MAINT-DT              PIC XX.
  2404         16  MA-LAST-MAINT-BY              PIC XXXX.
  2405         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2406
  2407     12  MA-PROFILE-INFO.
  2408         16  MA-QUALIFY-CODE-1             PIC XX.
  2409         16  MA-QUALIFY-CODE-2             PIC XX.
  2410         16  MA-QUALIFY-CODE-3             PIC XX.
  2411         16  MA-QUALIFY-CODE-4             PIC XX.
  2412         16  MA-QUALIFY-CODE-5             PIC XX.
  2413
  2414         16  MA-INSURED-LAST-NAME          PIC X(15).
  2415         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2416         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2417         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2418         16  MA-INSURED-BIRTH-DT           PIC XX.
  2419         16  MA-INSURED-SEX                PIC X.
  2420             88  MA-SEX-MALE                   VALUE 'M'.
  2421             88  MA-SEX-FEMALE                 VALUE 'F'.
  2422         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2423
  2424         16  MA-ADDRESS-CORRECTED          PIC X.
  2425         16  MA-JOINT-BIRTH-DT             PIC XX.
  2426*        16  FILLER                        PIC X(12).
  2427
  2428         16  MA-ADDRESS-LINE-1             PIC X(30).
  2429         16  MA-ADDRESS-LINE-2             PIC X(30).
  2430         16  MA-CITY-STATE.
  2431             20  MA-CITY                   PIC X(28).
  2432             20  MA-ADDR-STATE             PIC XX.
  2433         16  MA-ZIP.
  2434             20  MA-ZIP-CODE.
  2435                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2436                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2437                 24  FILLER                PIC X(4).
  2438             20  MA-ZIP-PLUS4              PIC X(4).
  2439         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2440             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2441             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2442             20  FILLER                    PIC X(3).
  2443
  2444         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2445
  2446         16  FILLER                        PIC XXX.
  2447*        16  FILLER                        PIC X(10).
  2448
  2449     12  MA-CRED-BENE-INFO.
  2450         16  MA-CRED-BENE-NAME                 PIC X(25).
  2451         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2452         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2453         16  MA-CRED-BENE-CTYST.
  2454             20  MA-CRED-BENE-CITY             PIC X(28).
  2455             20  MA-CRED-BENE-STATE            PIC XX.
  2456         16  MA-CRED-BENE-ZIP.
  2457             20  MA-CB-ZIP-CODE.
  2458                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  47
* EL050.cbl
  2459                     88  MA-CB-CANADIAN-POST-CODE
  2460                                           VALUE 'A' THRU 'Z'.
  2461                 24  FILLER                    PIC X(4).
  2462             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2463         16  MA-CB-CANADIAN-POSTAL-CODE
  2464                            REDEFINES MA-CRED-BENE-ZIP.
  2465             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2466             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2467             20  FILLER                        PIC X(3).
  2468     12  MA-POST-CARD-MAIL-DATA.
  2469         16  MA-MAIL-DATA OCCURS 7.
  2470             20  MA-MAIL-TYPE              PIC X.
  2471                 88  MA-12MO-MAILING           VALUE '1'.
  2472                 88  MA-EXP-MAILING            VALUE '2'.
  2473             20  MA-MAIL-STATUS            PIC X.
  2474                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2475                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2476                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2477             20  MA-MAIL-DATE              PIC XX.
  2478     12  FILLER                            PIC XX.
  2479     12  FILLER                            PIC XX.
  2480*    12  FILLER                            PIC X(30).
  2481******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  48
* EL050.cbl
  2483*    COPY ERCPNDM.
  2484******************************************************************
  2485*                                                                *
  2486*                                                                *
  2487*                            ERCPNDM                             *
  2488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2489*                            VMOD=2.003                          *
  2490*                                                                *
  2491*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2492*                                                                *
  2493*   FILE TYPE = VSAM,KSDS                                        *
  2494*   RECORD SIZE = 374   RECFORM = FIX                            *
  2495*                                                                *
  2496*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2497*   ALTERNATE PATH    = NOT USED                                 *
  2498*                                                                *
  2499*   LOG = YES                                                    *
  2500*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2501******************************************************************
  2502*                   C H A N G E   L O G
  2503*
  2504* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2505*-----------------------------------------------------------------
  2506*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2507* EFFECTIVE    NUMBER
  2508*-----------------------------------------------------------------
  2509* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2510* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2511* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2512******************************************************************
  2513
  2514 01  PENDING-MAILING-DATA.
  2515     12  PM-RECORD-ID                      PIC XX.
  2516         88  VALID-MA-ID                       VALUE 'PM'.
  2517
  2518     12  PM-CONTROL-PRIMARY.
  2519         16  PM-COMPANY-CD                 PIC X.
  2520         16  PM-ENTRY-BATCH                PIC X(6).
  2521         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2522         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2523
  2524     12  FILLER                            PIC X(14).
  2525
  2526     12  PM-ACCESS-CONTROL.
  2527         16  PM-SOURCE-SYSTEM              PIC XX.
  2528             88  PM-FROM-CREDIT                VALUE 'CR'.
  2529             88  PM-FROM-VSI                   VALUE 'VS'.
  2530             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2531             88  PM-FROM-OTHER                 VALUE 'OT'.
  2532         16  PM-RECORD-ADD-DT              PIC XX.
  2533         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2534         16  PM-LAST-MAINT-DT              PIC XX.
  2535         16  PM-LAST-MAINT-BY              PIC XXXX.
  2536         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2537
  2538     12  PM-PROFILE-INFO.
  2539         16  PM-QUALIFY-CODE-1             PIC XX.
  2540         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  49
* EL050.cbl
  2541         16  PM-QUALIFY-CODE-3             PIC XX.
  2542         16  PM-QUALIFY-CODE-4             PIC XX.
  2543         16  PM-QUALIFY-CODE-5             PIC XX.
  2544
  2545         16  PM-INSURED-LAST-NAME          PIC X(15).
  2546         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2547         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2548         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2549         16  PM-INSURED-BIRTH-DT           PIC XX.
  2550         16  PM-INSURED-SEX                PIC X.
  2551             88  PM-SEX-MALE                   VALUE 'M'.
  2552             88  PM-SEX-FEMALE                 VALUE 'F'.
  2553         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2554
  2555         16  PM-ADDRESS-CORRECTED          PIC X.
  2556         16  PM-JOINT-BIRTH-DT             PIC XX.
  2557*        16  FILLER                        PIC X(12).
  2558
  2559         16  PM-ADDRESS-LINE-1             PIC X(30).
  2560         16  PM-ADDRESS-LINE-2             PIC X(30).
  2561         16  PM-CITY-STATE.
  2562             20  PM-CITY                   PIC X(28).
  2563             20  PM-STATE                  PIC XX.
  2564         16  PM-ZIP.
  2565             20  PM-ZIP-CODE.
  2566                 24  PM-ZIP-1              PIC X.
  2567                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2568                 24  FILLER                PIC X(4).
  2569             20  PM-ZIP-PLUS4              PIC X(4).
  2570         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2571             20  PM-CAN-POST1              PIC XXX.
  2572             20  PM-CAN-POST2              PIC XXX.
  2573             20  FILLER                    PIC XXX.
  2574
  2575         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2576
  2577         16  FILLER                        PIC X(03).
  2578
  2579     12  PM-CRED-BENE-INFO.
  2580         16  PM-CRED-BENE-NAME             PIC X(25).
  2581         16  PM-CRED-BENE-ADDR             PIC X(30).
  2582         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2583         16  PM-CRED-BENE-CTYST.
  2584             20  PM-CRED-BENE-CITY         PIC X(28).
  2585             20  PM-CRED-BENE-STATE        PIC XX.
  2586         16  PM-CRED-BENE-ZIP.
  2587             20  PM-CB-ZIP-CODE.
  2588                 24  PM-CB-ZIP-1           PIC X.
  2589                     88  PM-CB-CANADIAN-POST-CODE
  2590                                  VALUE 'A' THRU 'Z'.
  2591                 24  FILLER                PIC X(4).
  2592             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2593         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2594             20  PM-CB-CAN-POST1           PIC XXX.
  2595             20  PM-CB-CAN-POST2           PIC XXX.
  2596             20  FILLER                    PIC XXX.
  2597     12  PM-POST-CARD-MAIL-DATA.
  2598         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  50
* EL050.cbl
  2599             20  PM-MAIL-TYPE              PIC X.
  2600                 88  PM-12MO-MAILING           VALUE '1'.
  2601                 88  PM-EXP-MAILING            VALUE '2'.
  2602             20  PM-MAIL-STATUS            PIC X.
  2603                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2604                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2605                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2606             20  PM-MAIL-DATE              PIC XX.
  2607     12  FILLER                            PIC XX.
  2608     12  FILLER                            PIC X(12).
  2609*    12  FILLER                            PIC X(30).
  2610
  2611******************************************************************
  2612*                                COPY ERCLOFC.
  2613******************************************************************
  2614*                                                                *
  2615*                                                                *
  2616*                            ERCLOFC                             *
  2617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2618*                            VMOD=2.003                          *
  2619*                                                                *
  2620*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2621*                                                                *
  2622*   FILE TYPE = VSAM,KSDS                                        *
  2623*   RECORD SIZE = 670   RECFORM = FIX                            *
  2624*                                                                *
  2625*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2626*                                                                *
  2627*   LOG = YES                                                    *
  2628*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2629*                                                                *
  2630******************************************************************
  2631
  2632 01  LOAN-OFFICER-MASTER.
  2633     12  LO-RECORD-ID                PIC XX.
  2634         88  VALID-LO-ID                VALUE 'LO'.
  2635
  2636     12  LO-CONTROL-PRIMARY.
  2637         16  LO-COMPANY-CD           PIC X.
  2638         16  LO-CARRIER              PIC X.
  2639         16  LO-GROUPING.
  2640             20  LO-GROUPING-PREFIX  PIC XXX.
  2641             20  LO-GROUPING-PRIME   PIC XXX.
  2642         16  LO-STATE                PIC XX.
  2643         16  LO-ACCOUNT.
  2644             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2645             20  LO-ACCOUNT-PRIME    PIC X(6).
  2646         16  LO-OFFICER-CODE         PIC X(5).
  2647
  2648     12  LO-OFFICER-NAME             PIC X(30).
  2649
  2650     12  LO-LAST-MAINT-DT            PIC XX.
  2651     12  LO-LAST-USER                PIC X(4).
  2652     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2653
  2654     12  LO-COMP-CONTROL             PIC X.
  2655             88  LO-SHOW-COMP           VALUE 'Y'.
  2656             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  51
* EL050.cbl
  2657     12  LO-DETAIL-CONTROL           PIC X.
  2658             88  LO-PRINT-DETAIL        VALUE 'D'.
  2659             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2660
  2661     12  LO-SV-CARRIER               PIC X.
  2662     12  LO-SV-GROUPING              PIC X(6).
  2663     12  LO-SV-STATE                 PIC XX.
  2664
  2665     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2666     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2667
  2668     12  LO-OFFICER-INFO.
  2669         16  FILLER OCCURS 12 TIMES.
  2670             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2671             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2672             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2673             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2674             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2675             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2676             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2677             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2678     12  FILLER                      PIC X(198).
  2679******************************************************************
  2680*                                COPY ERCPDEF.
  2681******************************************************************
  2682*                                                                *
  2683*                                                                *
  2684*                            ERCPDEF.                            *
  2685*                                                                *
  2686*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2687*                                                                *
  2688*    FILE TYPE = VSAM,KSDS                                       *
  2689*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2690*                                                                *
  2691*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2692*                                                                *
  2693*    LOG = YES                                                   *
  2694*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2695******************************************************************
  2696 01  PRODUCT-MASTER.
  2697    12  PD-RECORD-ID                 PIC X(02).
  2698        88  VALID-PD-ID                  VALUE 'PD'.
  2699    12  PD-CONTROL-PRIMARY.
  2700        16  PD-COMPANY-CD            PIC X.
  2701        16  PD-STATE                 PIC XX.
  2702        16  PD-PRODUCT-CD            PIC XXX.
  2703        16  PD-FILLER                PIC X(7).
  2704        16  PD-BEN-TYPE              PIC X.
  2705        16  PD-BEN-CODE              PIC XX.
  2706        16  PD-PROD-EXP-DT           PIC XX.
  2707    12  FILLER                       PIC X(50).
  2708    12  PD-PRODUCT-DATA OCCURS 8.
  2709        16  PD-PROD-CODE             PIC X.
  2710            88  PD-PROD-LIFE           VALUE 'L'.
  2711            88  PD-PROD-PROP           VALUE 'P'.
  2712            88  PD-PROD-AH             VALUE 'A'.
  2713            88  PD-PROD-IU             VALUE 'I'.
  2714            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  52
* EL050.cbl
  2715        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2716        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2717        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2718        16  PD-MAX-TERM              PIC S999        COMP-3.
  2719        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2720        16  FILLER                   PIC X.
  2721        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2722        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2723        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2724        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2725        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2726        16  PD-REC-CRIT-PERIOD       PIC X.
  2727        16  PD-RTW-MOS               PIC 99.
  2728        16  FILLER                   PIC X(5).
  2729    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2730    12  PD-TERM-LIMITS OCCURS 15.
  2731        16  PD-LOW-TERM              PIC S999        COMP-3.
  2732        16  PD-HI-TERM               PIC S999        COMP-3.
  2733*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2734    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2735        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2736        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2737    12  PD-EARN-FACTORS.
  2738        16  FILLER OCCURS 15.
  2739            20  FILLER OCCURS 15.
  2740                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2741    12  PD-PRODUCT-DESC              PIC X(80).
  2742    12  PD-TRUNCATED                 PIC X.
  2743    12  FILLER                       PIC X(59).
  2744    12  PD-MAINT-INFORMATION.
  2745        16  PD-LAST-MAINT-DT         PIC X(02).
  2746        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2747        16  PD-LAST-MAINT-BY         PIC X(04).
  2748*                                COPY ELCSTATE.
  2749******************************************************************
  2750*                                                                *
  2751*                                                                *
  2752*                            ELCSTATE.                           *
  2753*                                                                *
  2754*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2755*                                                                *
  2756*   FILE TYPE = VSAM,KSDS                                        *
  2757*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2758*                                                                *
  2759*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2760*       ALTERNATE INDEX = NONE                                   *
  2761*                                                                *
  2762*   LOG = YES                                                    *
  2763*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2764******************************************************************
  2765*                   C H A N G E   L O G
  2766*
  2767* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2768*-----------------------------------------------------------------
  2769*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2770* EFFECTIVE    NUMBER
  2771*-----------------------------------------------------------------
  2772* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  53
* EL050.cbl
  2773******************************************************************
  2774*
  2775 01  STATE-FILE.
  2776     12  SF-RECORD-ID                       PIC XX.
  2777         88  VALID-CF-ID                        VALUE 'SF'.
  2778     12  SF-CONTROL-PRIMARY.
  2779         16  SF-COMPANY-ID                  PIC XXX.
  2780         16  SF-CARRIER-CODE                PIC X.
  2781         16  SF-GROUPING                    PIC X(6).
  2782         16  SF-STATE-CODE                  PIC XX.
  2783         16  SF-EXPIRE-DATE                 PIC 9(8).
  2784****************************************************************
  2785*             STATE CONTROLS
  2786****************************************************************
  2787     12  SF-LAST-MAINT-DT                   PIC XX.
  2788     12  SF-LAST-MAINT-BY                   PIC X(4).
  2789     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2790     12  SF-STATE-RT-CONTROLS.
  2791         16  SF-ST-RT-CALC                  PIC X.
  2792     12  SF-ST-TAX-CONTROLS.
  2793         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2794         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2795         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2796     12  SF-ST-REFUND-OPTIONS.
  2797         16  SF-ST-RF-LR-CALC               PIC X.
  2798         16  SF-ST-RF-LL-CALC               PIC X.
  2799         16  SF-ST-RF-LN-CALC               PIC X.
  2800         16  SF-ST-RF-AH-CALC               PIC X.
  2801         16  SF-ST-RF-CP-CALC               PIC X.
  2802     12  SF-ST-UNEARN-PREM-OPTIONS.
  2803         16  SF-ST-LUEP-R78                 PIC X.
  2804         16  SF-ST-LUEP-PRO                 PIC X.
  2805         16  SF-ST-LUEP-ST                  PIC X.
  2806         16  SF-ST-LUEP-DOM                 PIC X.
  2807         16  SF-ST-AUEP-R78                 PIC X.
  2808         16  SF-ST-AUEP-PRO                 PIC X.
  2809         16  SF-ST-AUEP-ST                  PIC X.
  2810         16  SF-ST-AUEP-DOM                 PIC X.
  2811         16  SF-ST-CUEP-R78                 PIC X.
  2812         16  SF-ST-CUEP-PRO                 PIC X.
  2813         16  SF-ST-CUEP-ST                  PIC X.
  2814         16  SF-ST-CUEP-DOM                 PIC X.
  2815     12  SF-ST-EARN-PREM-OPTIONS.
  2816         16  SF-ST-LEP-R78                  PIC X.
  2817         16  SF-ST-LEP-PRO                  PIC X.
  2818         16  SF-ST-LEP-ST                   PIC X.
  2819         16  SF-ST-LEP-DOM                  PIC X.
  2820         16  SF-ST-AEP-R78                  PIC X.
  2821         16  SF-ST-AEP-PRO                  PIC X.
  2822         16  SF-ST-AEP-ST                   PIC X.
  2823         16  SF-ST-AEP-DOM                  PIC X.
  2824         16  SF-ST-CEP-R78                  PIC X.
  2825         16  SF-ST-CEP-PRO                  PIC X.
  2826         16  SF-ST-CEP-ST                   PIC X.
  2827         16  SF-ST-CEP-DOM                  PIC X.
  2828     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  54
* EL050.cbl
  2830*    COPY ELCCRTT.
  2831******************************************************************
  2832*                                                                *
  2833*                            ELCCRTT.                            *
  2834*                                                                *
  2835*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2836*                                                                *
  2837*   FILE TYPE = VSAM,KSDS                                        *
  2838*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2839*                                                                *
  2840*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2841*                                                                *
  2842*   LOG = YES                                                    *
  2843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2844******************************************************************
  2845*                   C H A N G E   L O G
  2846*
  2847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2848*-----------------------------------------------------------------
  2849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2850* EFFECTIVE    NUMBER
  2851*-----------------------------------------------------------------
  2852* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2853* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2854* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2855******************************************************************
  2856
  2857 01  CERTIFICATE-TRAILERS.
  2858     12  CS-RECORD-ID                      PIC XX.
  2859         88  VALID-CS-ID                      VALUE 'CS'.
  2860
  2861     12  CS-CONTROL-PRIMARY.
  2862         16  CS-COMPANY-CD                 PIC X.
  2863         16  CS-CARRIER                    PIC X.
  2864         16  CS-GROUPING                   PIC X(6).
  2865         16  CS-STATE                      PIC XX.
  2866         16  CS-ACCOUNT                    PIC X(10).
  2867         16  CS-CERT-EFF-DT                PIC XX.
  2868         16  CS-CERT-NO.
  2869             20  CS-CERT-PRIME             PIC X(10).
  2870             20  CS-CERT-SFX               PIC X.
  2871         16  CS-TRAILER-TYPE               PIC X.
  2872             88  COMM-TRLR           VALUE 'A'.
  2873             88  FUTURE-TRLR         VALUE 'B'.
  2874             88  CERT-DATA-TRLR      VALUE 'C'.
  2875
  2876     12  CS-DATA-AREA                      PIC X(516).
  2877
  2878     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2879         16  CS-BANK-COMMISSION-AREA.
  2880             20  CS-BANK-COMMS       OCCURS 10.
  2881                 24  CS-AGT                PIC X(10).
  2882                 24  CS-COM-TYP            PIC X.
  2883                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2884                 24  CS-RECALC-LV-INDIC    PIC X.
  2885                 24  FILLER                PIC X(10).
  2886         16  FILLER                        PIC X(256).
  2887
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  55
* EL050.cbl
  2888     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2889         16  CS-VIN-NUMBER                 PIC X(17).
  2890         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2891         16  FILLER                        PIC X(498).
  2892******************************************************************
  2893
  2894*    COPY ELCDATE.
  2895******************************************************************
  2896*                                                                *
  2897*                                                                *
  2898*                            ELCDATE.                            *
  2899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2900*                            VMOD=2.003
  2901*                                                                *
  2902*                                                                *
  2903*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2904*                 LENGTH = 200                                   *
  2905******************************************************************
  2906
  2907 01  DATE-CONVERSION-DATA.
  2908     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2909     12  DC-OPTION-CODE                PIC X.
  2910         88  BIN-TO-GREG                VALUE ' '.
  2911         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2912         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2913         88  YMD-GREG-TO-BIN            VALUE '3'.
  2914         88  MDY-GREG-TO-BIN            VALUE '4'.
  2915         88  JULIAN-TO-BIN              VALUE '5'.
  2916         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2917         88  FIND-CENTURY               VALUE '7'.
  2918         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2919         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2920         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2921         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2922         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2923         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2924         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2925         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2926         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2927         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2928         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2929         88  BIN-3-TO-GREG              VALUE 'I'.
  2930         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2931         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2932         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2933         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2934         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2935         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2936         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2937         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2938         88  THREE-CHARACTER-BIN
  2939                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2940         88  GREGORIAN-TO-BIN
  2941                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2942         88  BIN-TO-GREGORIAN
  2943                  VALUES ' ' '1' 'I' '8' 'G'.
  2944         88  JULIAN-TO-BINARY
  2945                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  56
* EL050.cbl
  2946     12  DC-ERROR-CODE                 PIC X.
  2947         88  NO-CONVERSION-ERROR        VALUE ' '.
  2948         88  DATE-CONVERSION-ERROR
  2949                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2950         88  DATE-IS-ZERO               VALUE '1'.
  2951         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2952         88  DATE-IS-INVALID            VALUE '3'.
  2953         88  DATE1-GREATER-DATE2        VALUE '4'.
  2954         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2955         88  DATE-INVALID-OPTION        VALUE '9'.
  2956         88  INVALID-CENTURY            VALUE 'A'.
  2957         88  ONLY-CENTURY               VALUE 'B'.
  2958         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2959         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2960     12  DC-END-OF-MONTH               PIC X.
  2961         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2962     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2963         88  USE-NORMAL-PROCESS         VALUE ' '.
  2964         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2965         88  ADJUST-UP-100-YRS          VALUE '2'.
  2966     12  FILLER                        PIC X.
  2967     12  DC-CONVERSION-DATES.
  2968         16  DC-BIN-DATE-1             PIC XX.
  2969         16  DC-BIN-DATE-2             PIC XX.
  2970         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2971         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2972                       DC-GREG-DATE-1-EDIT.
  2973             20  DC-EDIT1-MONTH        PIC 99.
  2974             20  SLASH1-1              PIC X.
  2975             20  DC-EDIT1-DAY          PIC 99.
  2976             20  SLASH1-2              PIC X.
  2977             20  DC-EDIT1-YEAR         PIC 99.
  2978         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2979         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2980                     DC-GREG-DATE-2-EDIT.
  2981             20  DC-EDIT2-MONTH        PIC 99.
  2982             20  SLASH2-1              PIC X.
  2983             20  DC-EDIT2-DAY          PIC 99.
  2984             20  SLASH2-2              PIC X.
  2985             20  DC-EDIT2-YEAR         PIC 99.
  2986         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2987         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2988                     DC-GREG-DATE-1-YMD.
  2989             20  DC-YMD-YEAR           PIC 99.
  2990             20  DC-YMD-MONTH          PIC 99.
  2991             20  DC-YMD-DAY            PIC 99.
  2992         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2993         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2994                      DC-GREG-DATE-1-MDY.
  2995             20  DC-MDY-MONTH          PIC 99.
  2996             20  DC-MDY-DAY            PIC 99.
  2997             20  DC-MDY-YEAR           PIC 99.
  2998         16  DC-GREG-DATE-1-ALPHA.
  2999             20  DC-ALPHA-MONTH        PIC X(10).
  3000             20  DC-ALPHA-DAY          PIC 99.
  3001             20  FILLER                PIC XX.
  3002             20  DC-ALPHA-CENTURY.
  3003                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  57
* EL050.cbl
  3004             20  DC-ALPHA-YEAR         PIC 99.
  3005         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3006         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3007         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3008         16  DC-JULIAN-DATE            PIC 9(05).
  3009         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3010                                       PIC 9(05).
  3011         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3012             20  DC-JULIAN-YEAR        PIC 99.
  3013             20  DC-JULIAN-DAYS        PIC 999.
  3014         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3015         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3016         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3017     12  DATE-CONVERSION-VARIBLES.
  3018         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3019         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3020             20  FILLER                PIC 9(3).
  3021             20  HOLD-CEN-1-CCYY.
  3022                 24  HOLD-CEN-1-CC     PIC 99.
  3023                 24  HOLD-CEN-1-YY     PIC 99.
  3024             20  HOLD-CEN-1-MO         PIC 99.
  3025             20  HOLD-CEN-1-DA         PIC 99.
  3026         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3027             20  HOLD-CEN-1-R-MO       PIC 99.
  3028             20  HOLD-CEN-1-R-DA       PIC 99.
  3029             20  HOLD-CEN-1-R-CCYY.
  3030                 24  HOLD-CEN-1-R-CC   PIC 99.
  3031                 24  HOLD-CEN-1-R-YY   PIC 99.
  3032             20  FILLER                PIC 9(3).
  3033         16  HOLD-CENTURY-1-X.
  3034             20  FILLER                PIC X(3)  VALUE SPACES.
  3035             20  HOLD-CEN-1-X-CCYY.
  3036                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3037                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3038             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3039             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3040         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3041             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3042             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3043             20  HOLD-CEN-1-R-X-CCYY.
  3044                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3045                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3046             20  FILLER                PIC XXX.
  3047         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3048         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3049         16  DC-JULIAN-DATE-1          PIC 9(07).
  3050         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3051             20  DC-JULIAN-1-CCYY.
  3052                 24  DC-JULIAN-1-CC    PIC 99.
  3053                 24  DC-JULIAN-1-YR    PIC 99.
  3054             20  DC-JULIAN-DA-1        PIC 999.
  3055         16  DC-JULIAN-DATE-2          PIC 9(07).
  3056         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3057             20  DC-JULIAN-2-CCYY.
  3058                 24  DC-JULIAN-2-CC    PIC 99.
  3059                 24  DC-JULIAN-2-YR    PIC 99.
  3060             20  DC-JULIAN-DA-2        PIC 999.
  3061         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  58
* EL050.cbl
  3062             20  DC-EDITA-MONTH        PIC 99.
  3063             20  SLASHA-1              PIC X VALUE '/'.
  3064             20  DC-EDITA-DAY          PIC 99.
  3065             20  SLASHA-2              PIC X VALUE '/'.
  3066             20  DC-EDITA-CCYY.
  3067                 24  DC-EDITA-CENT     PIC 99.
  3068                 24  DC-EDITA-YEAR     PIC 99.
  3069         16  DC-GREG-DATE-B-EDIT.
  3070             20  DC-EDITB-MONTH        PIC 99.
  3071             20  SLASHB-1              PIC X VALUE '/'.
  3072             20  DC-EDITB-DAY          PIC 99.
  3073             20  SLASHB-2              PIC X VALUE '/'.
  3074             20  DC-EDITB-CCYY.
  3075                 24  DC-EDITB-CENT     PIC 99.
  3076                 24  DC-EDITB-YEAR     PIC 99.
  3077         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3078         16  DC-GREG-DATE-CYMD-R REDEFINES
  3079                              DC-GREG-DATE-CYMD.
  3080             20  DC-CYMD-CEN           PIC 99.
  3081             20  DC-CYMD-YEAR          PIC 99.
  3082             20  DC-CYMD-MONTH         PIC 99.
  3083             20  DC-CYMD-DAY           PIC 99.
  3084         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3085         16  DC-GREG-DATE-MDCY-R REDEFINES
  3086                              DC-GREG-DATE-MDCY.
  3087             20  DC-MDCY-MONTH         PIC 99.
  3088             20  DC-MDCY-DAY           PIC 99.
  3089             20  DC-MDCY-CEN           PIC 99.
  3090             20  DC-MDCY-YEAR          PIC 99.
  3091    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3092        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3093    12  DC-EL310-DATE                  PIC X(21).
  3094    12  FILLER                         PIC X(28).
  3095
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  59
* EL050.cbl
  3097*    COPY ELCCALC.
  3098******************************************************************
  3099*                                                                *
  3100*                           ELCCALC.                            *
  3101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3102*                            VMOD=2.025                          *
  3103*                                                                *
  3104*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3105*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3106*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3107*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3108*                                                                *
  3109*  PASSED TO ELRTRM                                              *
  3110*  -----------------                                             *
  3111*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3112*  ORIGINAL TERM                                                 *
  3113*  BEGINNING DATE                                                *
  3114*  ENDING DATE                                                   *
  3115*  COMPANY I.D.                                                  *
  3116*  ACCOUNT MASTER USER FIELD                                     *
  3117*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3118*  FREE LOOK DAYS                                                *
  3119*                                                                *
  3120*  RETURNED FROM ELRTRM                                          *
  3121*  ---------------------                                         *
  3122*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3123*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3124*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3125*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3126*----------------------------------------------------------------*
  3127*  PASSED TO ELRAMT                                              *
  3128*  ----------------                                              *
  3129*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3130*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3131*  ORIGINAL AMOUNT                                               *
  3132*  ALTERNATE BENEFIT (BALLON)                                    *
  3133*  A.P.R. - NET PAY ONLY                                         *
  3134*  METHOD
  3135*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3136*  COMPANY I.D.                                                  *
  3137*  BENEFIT TYPE                                                  *
  3138*                                                                *
  3139*  RETURNED FROM ELRAMT                                          *
  3140*  --------------------                                          *
  3141*  REMAINING AMOUNT 1 - CURRENT                                  *
  3142*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3143*  REMAINING AMOUNT FACTOR
  3144*----------------------------------------------------------------*
  3145*  PASSED TO ELRESV                                              *
  3146*  -----------------                                             *
  3147*  CERTIFICATE EFFECTIVE DATE                                    *
  3148*  VALUATION DATE                                                *
  3149*  PAID THRU DATE                                                *
  3150*  BENEFIT                                                       *
  3151*  INCURRED DATE                                                 *
  3152*  REPORTED DATE                                                 *
  3153*  ISSUE AGE                                                     *
  3154*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  60
* EL050.cbl
  3155*  CDT PERCENT                                                   *
  3156*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3157* *CLAIM TYPE (LIFE, A/H)                                        *
  3158* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3159* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3160*                                                                *
  3161*  RETURNED FROM ELRESV                                          *
  3162*  --------------------                                          *
  3163*  CDT TABLE USED                                                *
  3164*  CDT FACTOR USED                                               *
  3165*  PAY TO CURRENT RESERVE                                        *
  3166*  I.B.N.R. - A/H ONLY                                           *
  3167*  FUTURE (ACCRUED) AH ONLY                                      *
  3168*----------------------------------------------------------------*
  3169*  PASSED TO ELRATE                                              *
  3170*  ----------------                                              *
  3171*  CERT ISSUE DATE                                               *
  3172*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3173*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3174*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3175*  STATE CODE (CLIENT DEFINED)                                   *
  3176*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3177*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3178*  DEVIATION CODE                                                *
  3179*  ISSUE AGE                                                     *
  3180*  ORIGINAL BENEFIT AMOUNT                                       *
  3181*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3182*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3183*  BENEFIT KIND (LIFE OR A/H)                                    *
  3184*  A.P.R.                                                        *
  3185*  METHOD
  3186*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3187*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3188*  COMPANY I.D. (3 CHARACTER)                                    *
  3189*  BENEFIT CODE                                                  *
  3190*  BENEFIT OVERRIDE CODE                                         *
  3191*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3192*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3193*  JOINT INDICATOR (CSL ONLY)                                    *
  3194*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3195*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3196*                                                                *
  3197*  RETURNED FROM ELRATE                                          *
  3198*  --------------------                                          *
  3199*  CALCULATED PREMIUM                                            *
  3200*  PREMIUM RATE                                                  *
  3201*  MORTALITY CODE                                                *
  3202*  MAX ATTAINED AGE                                              *
  3203*  MAX AGE                                                       *
  3204*  MAX TERM                                                      *
  3205*  MAX MONTHLY BENEFIT                                           *
  3206*  MAX TOTAL BENIFIT                                             *
  3207*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3208*----------------------------------------------------------------*
  3209*  PASSED TO ELRFND                                              *
  3210*  ----------------                                              *
  3211*  CERT ISSUE DATE                                               *
  3212*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  61
* EL050.cbl
  3213*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3214*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3215*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3216*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3217*  STATE CODE (CLIENT DEFINED)                                   *
  3218*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3219*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3220*  DEVIATION CODE                                                *
  3221*  ISSUE AGE                                                     *
  3222*  ORIGINAL BENEFIT AMOUNT                                       *
  3223*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3224*  PROCESS TYPE (CANCEL)                                         *
  3225*  BENEFIT KIND (LIFE OR A/H)                                    *
  3226*  A.P.R.                                                        *
  3227*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3228*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3229*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3230*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3231*  COMPANY I.D. (3 CHARACTER)                                    *
  3232*  BENEFIT CODE                                                  *
  3233*  BENEFIT OVERRIDE CODE                                         *
  3234*                                                                *
  3235*  RETURNED FROM ELRFND                                          *
  3236*  --------------------                                          *
  3237*  CALCULATED REFUND                                             *
  3238*----------------------------------------------------------------*
  3239*  PASSED TO ELEARN                                              *
  3240*  ----------------                                              *
  3241*  CERT ISSUE DATE                                               *
  3242*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3243*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3244*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3245*  STATE CODE (CLIENT DEFINED)                                   *
  3246*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3247*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3248*  DEVIATION CODE                                                *
  3249*  ISSUE AGE                                                     *
  3250*  ORIGINAL BENEFIT AMOUNT                                       *
  3251*  BENEFIT KIND (LIFE OR A/H)                                    *
  3252*  A.P.R.                                                        *
  3253*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3254*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3255*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3256*  COMPANY I.D. (3 CHARACTER)                                    *
  3257*  BENEFIT CODE                                                  *
  3258*  BENEFIT OVERRIDE CODE                                         *
  3259*                                                                *
  3260*  RETURNED FROM ELEARN                                          *
  3261*  --------------------                                          *
  3262*  INDICATED  EARNINGS                                           *
  3263*----------------------------------------------------------------*
  3264*                 LENGTH = 450                                   *
  3265*                                                                *
  3266******************************************************************
  3267******************************************************************
  3268*                   C H A N G E   L O G
  3269*
  3270* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  62
* EL050.cbl
  3271*-----------------------------------------------------------------
  3272*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3273* EFFECTIVE    NUMBER
  3274*-----------------------------------------------------------------
  3275* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3276* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3277* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3278* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3279* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3280* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3281* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3282* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3283* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3284******************************************************************
  3285
  3286 01  CALCULATION-PASS-AREA.
  3287     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3288                                     COMP.
  3289
  3290     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3291       88  NO-CP-ERROR                             VALUE ZERO.
  3292       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3293                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3294       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3295       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3296       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3297       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3298       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3299       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3300       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3301       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3302       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3303       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3304       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3305       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3306       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3307       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3308       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3309       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3310       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3311
  3312     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3313       88  NO-CP-ERROR-2                           VALUE ZERO.
  3314***********************  INPUT AREAS ****************************
  3315
  3316     12  CP-CALCULATION-AREA.
  3317         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3318         16  CP-CERT-EFF-DT        PIC XX.
  3319         16  CP-VALUATION-DT       PIC XX.
  3320         16  CP-PAID-THRU-DT       PIC XX.
  3321         16  CP-BENEFIT-TYPE       PIC X.
  3322           88  CP-AH                               VALUE 'A' 'D'
  3323                                                   'I' 'U'.
  3324           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3325           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3326         16  CP-INCURRED-DT        PIC XX.
  3327         16  CP-REPORTED-DT        PIC XX.
  3328         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  63
* EL050.cbl
  3329         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3330         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3331                                     COMP-3.
  3332         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3333                                     COMP-3.
  3334         16  CP-CDT-METHOD         PIC X.
  3335           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3336           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3337           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3338         16  CP-CLAIM-TYPE         PIC X.
  3339           88  CP-AH-CLAIM                         VALUE 'A'.
  3340           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3341         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3342                                     COMP-3.
  3343         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3344                                     COMP-3.
  3345         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3346                                     COMP-3.
  3347         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3348                                     COMP-3.
  3349         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3350                                     COMP-3.
  3351         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3352                                     COMP-3.
  3353         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3354                                     COMP-3.
  3355         16  CP-REM-TERM-METHOD    PIC X.
  3356           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3357           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3358           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3359           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3360           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3361           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3362           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3363         16  CP-EARNING-METHOD     PIC X.
  3364           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3365           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3366           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3367           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3368           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3369           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3370           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3371           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3372           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3373           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3374           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3375           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3376           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3377           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3378         16  CP-PROCESS-TYPE       PIC X.
  3379           88  CP-CLAIM                            VALUE '1'.
  3380           88  CP-CANCEL                           VALUE '2'.
  3381           88  CP-ISSUE                            VALUE '3'.
  3382         16  CP-SPECIAL-CALC-CD    PIC X.
  3383           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3384           88  CP-1-MTH-INTEREST               VALUE ' '.
  3385           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3386           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  64
* EL050.cbl
  3387           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3388           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3389           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3390           88  CP-FARM-PLAN                    VALUE 'F'.
  3391           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3392           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3393           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3394           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3395           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3396           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3397           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3398           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3399           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3400           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3401                                                     'W' 'X'.
  3402           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3403           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3404           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3405           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3406           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3407           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3408           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3409           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3410           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3411           88  CP-CSL-METH-1                   VALUE '5'.
  3412           88  CP-CSL-METH-2                   VALUE '6'.
  3413           88  CP-CSL-METH-3                   VALUE '7'.
  3414           88  CP-CSL-METH-4                   VALUE '8'.
  3415
  3416         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3417                                     COMP-3.
  3418         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3419         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3420         16  CP-STATE              PIC XX          VALUE SPACE.
  3421         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3422         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3423           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3424               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3425         16  CP-R78-OPTION         PIC X.
  3426           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3427           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3428
  3429         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3430         16  CP-IBNR-RESERVE-SW    PIC X.
  3431         16  CP-CLAIM-STATUS       PIC X.
  3432         16  CP-RATE-FILE          PIC X.
  3433         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3434                                     COMP-3.
  3435
  3436         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3437         16  CP-AH-OVERRIDE-CODE   PIC X.
  3438
  3439         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3440                                     COMP-3.
  3441         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3442                                   PIC S9(5)V99 COMP-3.
  3443         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3444                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  65
* EL050.cbl
  3445         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3446                                     COMP-3.
  3447         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3448                                     COMP-3.
  3449         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3450                                  PIC S9(7)V99 COMP-3.
  3451
  3452         16  CP-PAID-FROM-DATE     PIC X(02).
  3453         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3454         16  CP-EXT-DAYS-CALC      PIC X.
  3455           88  CP-EXT-NO-CHG                   VALUE ' '.
  3456           88  CP-EXT-CHG-LF                   VALUE '1'.
  3457           88  CP-EXT-CHG-AH                   VALUE '2'.
  3458           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3459         16  CP-DOMICILE-STATE     PIC XX.
  3460         16  CP-CARRIER            PIC X.
  3461         16  CP-REIN-FLAG          PIC X.
  3462         16  CP-REM-TRM-CALC-OPTION PIC X.
  3463           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3464                      '2' '3' '4' '5'.
  3465           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3466           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3467           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3468           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3469           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3470           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3471           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3472           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3473         16  CP-SIG-SWITCH         PIC X.
  3474         16  CP-RATING-METHOD      PIC X.
  3475           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3476           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3477           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3478           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3479           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3480           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3481           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3482           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3483           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3484         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3485                                     COMP-3.
  3486         16  CP-BEN-CATEGORY       PIC X.
  3487         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3488         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3489                                   PIC S99V9(5) COMP-3.
  3490         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3491         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3492                                   PIC S99V9(5) COMP-3.
  3493         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3494         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3495         16  CP-EXPIRE-DT          PIC XX.
  3496         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3497         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3498         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3499         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3500         16  CP-DDF-SPEC-CALC      PIC X.
  3501             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3502             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  66
* EL050.cbl
  3503         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3504         16  CP-CANCEL-REASON      PIC X.
  3505         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3506         16  CP-PMT-MODE           PIC X.
  3507         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3508         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3509         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3510         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3511         16  FILLER                PIC X.
  3512
  3513***************    OUTPUT FROM ELRESV   ************************
  3514
  3515         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3516
  3517         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3518                                     COMP-3.
  3519         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3520                                     COMP-3.
  3521         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3522                                     COMP-3.
  3523         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3524                                     COMP-3.
  3525         16  FILLER                PIC X(09).
  3526***************    OUTPUT FROM ELRTRM   *************************
  3527
  3528         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3529                                     COMP-3.
  3530         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3531                                     COMP-3.
  3532         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3533                                     COMP-3.
  3534         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3535                                     COMP-3.
  3536         16  FILLER                PIC X(12).
  3537
  3538***************    OUTPUT FROM ELRAMT   *************************
  3539
  3540         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3541                                     COMP-3.
  3542         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3543                                     COMP-3.
  3544         16  FILLER                PIC X(12).
  3545
  3546***************    OUTPUT FROM ELRATE   *************************
  3547
  3548         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3549                                     COMP-3.
  3550         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-MORTALITY-CODE     PIC X(4).
  3553         16  CP-RATE-EDIT-FLAG     PIC X.
  3554             88  CP-RATES-NEED-APR                  VALUE '1'.
  3555         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3556                                     COMP-3.
  3557         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3558         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3559         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3560                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  67
* EL050.cbl
  3561         16  FILLER                PIC X(07).
  3562
  3563***************    OUTPUT FROM ELRFND   *************************
  3564
  3565         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3566                                     COMP-3.
  3567         16  CP-REFUND-TYPE-USED   PIC X.
  3568           88  CP-R-AS-R78                         VALUE '1'.
  3569           88  CP-R-AS-PRORATA                     VALUE '2'.
  3570           88  CP-R-AS-CALIF                       VALUE '3'.
  3571           88  CP-R-AS-TEXAS                       VALUE '4'.
  3572           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3573           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3574           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3575           88  CP-R-AS-MEAN                        VALUE '8'.
  3576           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3577           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3578           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3579           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3580           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3581           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3582         16  FILLER                PIC X(12).
  3583
  3584***************    OUTPUT FROM ELEARN   *************************
  3585
  3586         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3587                                     COMP-3.
  3588         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3589                                     COMP-3.
  3590         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3591                                     COMP-3.
  3592         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3595                                     COMP-3.
  3596         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3597                                     COMP-3.
  3598         16  CP-EARNING-TYPE-USED  PIC X.
  3599           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3600           88  CP-E-AS-R78                         VALUE '1'.
  3601           88  CP-E-AS-PRORATA                     VALUE '2'.
  3602           88  CP-E-AS-TEXAS                       VALUE '4'.
  3603           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3604           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3605           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3606           88  CP-E-AS-MEAN                        VALUE '8'.
  3607           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3608         16  FILLER                PIC X(12).
  3609
  3610***************    OUTPUT FROM ELPMNT   *************************
  3611
  3612         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3613                                     COMP-3.
  3614         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3615                                     COMP-3.
  3616         16  FILLER                PIC X(12).
  3617
  3618***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  68
* EL050.cbl
  3619         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3620                                     COMP-3.
  3621         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3622                                     COMP-3.
  3623         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3624                                     COMP-3.
  3625         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3626                                     COMP-3.
  3627         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3628                                     COMP-3.
  3629         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3630                                     COMP-3.
  3631         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3632             88  OPEN-RATE-FILE                   VALUE 'O'.
  3633             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3634             88  IO-ERROR                         VALUE 'E'.
  3635
  3636         16  CP-FIRST-PAY-DATE     PIC XX.
  3637
  3638         16  CP-JOINT-INDICATOR    PIC X.
  3639
  3640         16  CP-RESERVE-REMAINING-TERM
  3641                                   PIC S9(4)V9    VALUE ZERO
  3642                                     COMP-3.
  3643
  3644         16  CP-INSURED-BIRTH-DT   PIC XX.
  3645
  3646         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3647                                     COMP-3.
  3648
  3649         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3650                                     COMP-3.
  3651
  3652         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3653                                     COMP-3.
  3654
  3655         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3656                                     COMP-3.
  3657
  3658         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3659                                     COMP-3.
  3660
  3661         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3662                                     COMP-3.
  3663
  3664         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3665                                     COMP-3.
  3666
  3667         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3668             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3669
  3670         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3671                                     COMP-3.
  3672         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3673                                     COMP-3.
  3674         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3675         16  FILLER                PIC X(15).
  3676******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  69
* EL050.cbl
  3678******************************************************************
  3679*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3680*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3681*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3682*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3683*** MODIFICATION.                                              ***
  3684*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3685*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3686******************************************************************
  3687*    COPY ERCPNDB.
  3688******************************************************************
  3689*                                                                *
  3690*                                                                *
  3691*                            ERCPNDB.                            *
  3692*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3693*                            VMOD=2.025                          *
  3694*                                                                *
  3695*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3696*                                                                *
  3697******************************************************************
  3698*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3699*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3700******************************************************************
  3701*                                                                *
  3702*                                                                *
  3703*   FILE TYPE = VSAM,KSDS                                        *
  3704*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3705*                                                                *
  3706*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3707*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3708*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3709*                                                 RKP=13,LEN=36  *
  3710*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3711*                                      AND CHG-SEQ.)             *
  3712*                                                RKP=49,LEN=11   *
  3713*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3714*                                      AND CHG-SEQ.)             *
  3715*                                                RKP=60,LEN=15   *
  3716*                                                                *
  3717*   LOG = NO                                                     *
  3718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3719******************************************************************
  3720******************************************************************
  3721*                   C H A N G E   L O G
  3722*
  3723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3724*-----------------------------------------------------------------
  3725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3726* EFFECTIVE    NUMBER
  3727*-----------------------------------------------------------------
  3728* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3729* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3730* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3731* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3732* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3733* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3734* 032306                   PEMA  ADD BOW LOAN NUMBER
  3735* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  70
* EL050.cbl
  3736* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3737* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3738* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3739* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3740* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3741* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3742* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3743******************************************************************
  3744
  3745 01  PENDING-BUSINESS.
  3746     12  PB-RECORD-ID                     PIC XX.
  3747         88  VALID-PB-ID                        VALUE 'PB'.
  3748
  3749     12  PB-CONTROL-PRIMARY.
  3750         16  PB-COMPANY-CD                PIC X.
  3751         16  PB-ENTRY-BATCH               PIC X(6).
  3752         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3753         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3754
  3755     12  PB-CONTROL-BY-ACCOUNT.
  3756         16  PB-COMPANY-CD-A1             PIC X.
  3757         16  PB-CARRIER                   PIC X.
  3758         16  PB-GROUPING.
  3759             20  PB-GROUPING-PREFIX       PIC XXX.
  3760             20  PB-GROUPING-PRIME        PIC XXX.
  3761         16  PB-STATE                     PIC XX.
  3762         16  PB-ACCOUNT.
  3763             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3764             20  PB-ACCOUNT-PRIME         PIC X(6).
  3765         16  PB-CERT-EFF-DT               PIC XX.
  3766         16  PB-CERT-NO.
  3767             20  PB-CERT-PRIME            PIC X(10).
  3768             20  PB-CERT-SFX              PIC X.
  3769         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3770
  3771         16  PB-RECORD-TYPE               PIC X.
  3772             88  PB-MAILING-DATA                VALUE '0'.
  3773             88  PB-ISSUE                       VALUE '1'.
  3774             88  PB-CANCELLATION                VALUE '2'.
  3775             88  PB-BATCH-TRAILER               VALUE '9'.
  3776
  3777     12  PB-CONTROL-BY-ORIG-BATCH.
  3778         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3779         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3780         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3781         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3782
  3783     12  PB-CONTROL-BY-CSR.
  3784         16  PB-CSR-COMPANY-CD            PIC X.
  3785         16  PB-CSR-ID                    PIC X(4).
  3786         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3787         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3788         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3789******************************************************************
  3790*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3791******************************************************************
  3792
  3793     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  71
* EL050.cbl
  3794     12  PB-LAST-MAINT-BY                 PIC X(4).
  3795     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3796
  3797     12  PB-RECORD-BODY                   PIC X(375).
  3798
  3799     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3800         16  PB-CERT-ORIGIN               PIC X.
  3801             88  CLASIC-CREATED-CERT         VALUE '1'.
  3802         16  PB-I-NAME.
  3803             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3804             20  PB-I-INSURED-FIRST-NAME.
  3805                 24  PB-I-INSURED-1ST-INIT PIC X.
  3806                 24  FILLER                PIC X(9).
  3807             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3808         16  PB-I-AGE                     PIC S99   COMP-3.
  3809         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3810         16  PB-I-BIRTHDAY                PIC XX.
  3811         16  PB-I-INSURED-SEX             PIC X.
  3812             88  PB-SEX-MALE     VALUE 'M'.
  3813             88  PB-SEX-FEMALE   VALUE 'F'.
  3814
  3815         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3816         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3817         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3818         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3819         16  PB-I-SKIP-CODE               PIC X.
  3820             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3821             88  PB-SKIP-JULY              VALUE '1'.
  3822             88  PB-SKIP-AUGUST            VALUE '2'.
  3823             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3824             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3825             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3826             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3827             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3828             88  PB-SKIP-JUNE              VALUE '8'.
  3829             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3830             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3831             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3832         16  PB-I-TERM-TYPE               PIC X.
  3833             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3834             88  PB-PAID-WEEKLY            VALUE 'W'.
  3835             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3836             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3837             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3838         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3839         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3840         16  PB-I-DATA-ENTRY-SW           PIC X.
  3841             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3842             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3843             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3844             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3845         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3846         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3847*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3848         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3849         16  FILLER                       PIC X.
  3850
  3851         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  72
* EL050.cbl
  3852             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3853             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3854                                                   '90' THRU '99'.
  3855         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3856                                          PIC XX.
  3857         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3858         16  PB-I-AMOUNT-FINANCED REDEFINES
  3859                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3860         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3861         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3862                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3863         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3864         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3865         16  PB-I-CLP-AMOUNT REDEFINES
  3866                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3867         16  PB-I-LF-CALC-FLAG            PIC X.
  3868             88 PB-COMP-LF-PREM               VALUE '?'.
  3869         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3870         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3871         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3872         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3873         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3874         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3875         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3876         16  PB-I-LF-ABBR                 PIC XXX.
  3877         16  PB-I-LF-INPUT-CD             PIC XX.
  3878
  3879         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3880             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3881             88  PB-INVALID-AH               VALUE '  ' '00'
  3882                                                   '90' THRU '99'.
  3883         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3884         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3885         16  PB-I-AH-CALC-FLAG            PIC X.
  3886             88 PB-COMP-AH-PREM                  VALUE '?'.
  3887         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3888         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3889         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3890         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3891         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3892         16  PB-I-AH-ABBR                 PIC XXX.
  3893         16  PB-I-AH-INPUT-CD             PIC XXX.
  3894
  3895         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3896         16  PB-I-REIN-TABLE              PIC XXX.
  3897         16  PB-I-BUSINESS-TYPE           PIC 99.
  3898         16  PB-I-INDV-GRP-CD             PIC X.
  3899         16  PB-I-MORT-CODE.
  3900             20  PB-I-TABLE               PIC X.
  3901             20  PB-I-INTEREST            PIC XX.
  3902             20  PB-I-MORT-TYP            PIC X.
  3903         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3904         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3905         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3906         16  PB-I-INDV-GRP-OVRD           PIC X.
  3907         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3908         16  PB-I-SIG-SW                  PIC X.
  3909             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  73
* EL050.cbl
  3910         16  PB-I-RATE-CLASS              PIC XX.
  3911         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3912         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3913         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3914         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3915         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3916         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3917         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3918         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3919         16  PB-I-OB-FLAG                 PIC X.
  3920             88  PB-I-OB                      VALUE 'B'.
  3921             88  PB-I-SUMMARY                 VALUE 'Z'.
  3922         16  PB-I-ENTRY-STATUS            PIC X.
  3923             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3924                                              'M' '5' '9' '2'.
  3925             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3926             88  PB-I-POLICY-PENDING          VALUE '2'.
  3927             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3928             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3929             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3930             88  PB-I-REIN-ONLY               VALUE '9'.
  3931             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3932             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3933             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3934             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3935         16  PB-I-INT-CODE                PIC X.
  3936             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3937             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3938         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3939         16  PB-I-SOC-SEC-NO              PIC X(11).
  3940         16  PB-I-MEMBER-NO               PIC X(12).
  3941         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3942*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3943         16  PB-I-OLD-LOF                 PIC XXX.
  3944         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3945         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3946         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3947         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3948         16  PB-I-LIFE-INDICATOR          PIC X.
  3949             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3950         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3951         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3952                                          PIC S9(5)V99    COMP-3.
  3953         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3954             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3955             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3956         16  PB-I-1ST-PMT-DT              PIC XX.
  3957         16  PB-I-JOINT-INSURED.
  3958             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3959             20 PB-I-JOINT-FIRST-NAME.
  3960                24  PB-I-JOINT-FIRST-INIT PIC X.
  3961                24  FILLER                PIC X(9).
  3962             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3963*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3964         16  PB-I-BENEFICIARY-NAME.
  3965             20  PB-I-BANK-NUMBER         PIC X(10).
  3966             20  FILLER                   PIC X(15).
  3967         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  74
* EL050.cbl
  3968         16  PB-I-REFERENCE               PIC X(12).
  3969         16  FILLER REDEFINES PB-I-REFERENCE.
  3970             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3971             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3972             20  PB-I-CLP-STATE           PIC XX.
  3973         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3974             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3975             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3976             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3977         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3978         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3979         16  PB-I-RESIDENT-STATE          PIC XX.
  3980         16  PB-I-RATE-CODE               PIC X(4).
  3981         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3982         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3983         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3984         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3985         16  PB-I-BANK-NOCHRGB            PIC 99.
  3986         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3987         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3988
  3989     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3990         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3991             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3992         16  PB-C-CANCEL-ORIGIN           PIC X.
  3993             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3994         16  PB-C-LF-CANCEL-DT            PIC XX.
  3995         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3996         16  PB-C-LF-CALC-REQ             PIC X.
  3997             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3998         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3999         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4000         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4001             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4002         16  PB-C-AH-CANCEL-DT            PIC XX.
  4003         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4004         16  PB-C-AH-CALC-REQ             PIC X.
  4005             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4006         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4007         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4008         16  PB-C-LAST-NAME               PIC X(15).
  4009         16  PB-C-REFUND-SW               PIC X.
  4010             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4011             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4012         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4013         16  PB-C-PAYEE-CODE              PIC X(6).
  4014         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4015         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4016         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4017         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4018         16  PB-C-REFERENCE               PIC X(12).
  4019         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4020         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4021         16  PB-C-POST-CARD-IND           PIC X.
  4022         16  PB-C-CANCEL-REASON           PIC X.
  4023         16  PB-C-REF-INTERFACE-SW        PIC X.
  4024         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4025         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  75
* EL050.cbl
  4026         16  FILLER                       PIC X(01).
  4027*        16  FILLER                       PIC X(18).
  4028         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4029*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4030         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4031         16  PB-CANCELED-CERT-DATA.
  4032             20  PB-CI-INSURED-NAME.
  4033                 24  PB-CI-LAST-NAME      PIC X(15).
  4034                 24  PB-CI-INITIALS       PIC XX.
  4035             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4036             20  PB-CI-INSURED-SEX        PIC X.
  4037             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4038             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4039             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4040             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4041             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4042             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4043             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4044             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4045             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4046             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4047             20  PB-CI-RATE-CLASS         PIC XX.
  4048             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4049             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4050             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4051             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4052             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4053             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4054             20  PB-CI-LF-ABBR            PIC X(3).
  4055             20  PB-CI-AH-ABBR            PIC X(3).
  4056             20  PB-CI-OB-FLAG            PIC X.
  4057                 88  PB-CI-OB                VALUE 'B'.
  4058             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4059                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4060                                           'M' '4' '5' '9' '2'.
  4061                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4062                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4063                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4064                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4065                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4066                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4067                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4068                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4069                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4070                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4071                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4072                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4073             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4074                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4075                                           'M' '4' '5' '9' '2'.
  4076                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4077                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4078                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4079                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4080                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4081                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4082                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4083                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  76
* EL050.cbl
  4084                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4085                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4086                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4087                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4088             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4089             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4090             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4091             20  PB-CI-MEMBER-NO          PIC X(12).
  4092             20  PB-CI-INT-CODE           PIC X.
  4093                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4094                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4095             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4096             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4097             20  PB-CI-COMP-EXCP-SW       PIC X.
  4098                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4099                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4100             20  PB-CI-ENTRY-STATUS       PIC X.
  4101             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4102             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4103             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4104             20  PB-CI-DEATH-DT           PIC XX.
  4105             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4106             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4107             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4108             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4109             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4110             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4111             20  PB-CI-ENTRY-DT              PIC XX.
  4112             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4113             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4114             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4115             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4116             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4117             20  PB-CI-OLD-LOF               PIC XXX.
  4118*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4119             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4120             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4121             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4122             20  PB-CI-INDV-GRP-CD           PIC X.
  4123             20  PB-CI-BENEFICIARY-NAME.
  4124                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4125                 24  FILLER                  PIC X(15).
  4126             20  PB-CI-NOTE-SW               PIC X.
  4127             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4128             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4129             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4130             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4131             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4132             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4133             20  PB-CI-FIRST-NAME            PIC X(10).
  4134             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4135
  4136         16  FILLER                       PIC X(13).
  4137*032306  16  FILLER                       PIC X(27).
  4138*        16  FILLER                       PIC X(46).
  4139
  4140     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4141         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  77
* EL050.cbl
  4142         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4143         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4144         16  PB-M-INSURED-MID-INIT        PIC X.
  4145         16  PB-M-INSURED-AGE             PIC 99.
  4146         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4147         16  PB-M-INSURED-SEX             PIC X.
  4148         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4149         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4150         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4151         16  PB-M-INSURED-CITY-STATE.
  4152             20  PB-M-INSURED-CITY        PIC X(28).
  4153             20  PB-M-INSURED-STATE       PIC XX.
  4154         16  PB-M-INSURED-ZIP-CODE.
  4155             20  PB-M-INSURED-ZIP-PRIME.
  4156                 24  PB-M-INSURED-ZIP-1   PIC X.
  4157                     88  PB-M-CANADIAN-POST-CODE
  4158                                             VALUE 'A' THRU 'Z'.
  4159                 24  FILLER               PIC X(4).
  4160             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4161         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4162                                        PB-M-INSURED-ZIP-CODE.
  4163             20  PM-M-INS-CAN-POST1       PIC XXX.
  4164             20  PM-M-INS-CAN-POST2       PIC XXX.
  4165             20  FILLER                   PIC XXX.
  4166         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4167         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4168         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4169         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4170         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4171         16  PB-M-CRED-BENE-CITYST.
  4172             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4173             20  PB-M-CRED-BENE-STATE     PIC XX.
  4174         16  FILLER                       PIC X(92).
  4175
  4176     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4177         16  FILLER                       PIC X(10).
  4178         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4179         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4180         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4181         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4182         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4183         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4184         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4185         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4186         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4187         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4188         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4189         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4190         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4191         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4192         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4193         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4194         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4195         16  PB-ACCOUNT-NAME              PIC X(30).
  4196         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4197         16  PB-REFERENCE                 PIC X(12).
  4198         16  PB-B-RECEIVED-DT             PIC XX.
  4199         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  78
* EL050.cbl
  4200
  4201     12  PB-RECORD-STATUS.
  4202         16  PB-CREDIT-SELECT-DT          PIC XX.
  4203         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4204         16  PB-BILLED-DT                 PIC XX.
  4205         16  PB-BILLING-STATUS            PIC X.
  4206             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4207             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4208             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4209         16  PB-RECORD-BILL               PIC X.
  4210             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4211             88  PB-RECORD-RETURNED           VALUE 'R'.
  4212             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4213             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4214             88  PB-OVERRIDE-AH               VALUE 'A'.
  4215             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4216         16  PB-BATCH-ENTRY               PIC X.
  4217             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4218             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4219             88  PB-REISSUED-CERT             VALUE 'E'.
  4220             88  PB-MONTHLY-CERT              VALUE 'M'.
  4221             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4222             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4223             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4224         16  PB-FORCE-CODE                PIC X.
  4225             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4226             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4227             88  PB-CANCEL-FORCE              VALUE '8'.
  4228             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4229             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4230             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4231             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4232             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4233             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4234             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4235         16  PB-FATAL-FLAG                PIC X.
  4236             88  PB-FATAL-ERRORS              VALUE 'X'.
  4237         16  PB-FORCE-ER-CD               PIC X.
  4238             88  PB-FORCE-ERRORS              VALUE 'F'.
  4239             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4240         16  PB-WARN-ER-CD                PIC X.
  4241             88  PB-WARNING-ERRORS            VALUE 'W'.
  4242         16  FILLER                       PIC X.
  4243         16  PB-OUT-BAL-CD                PIC X.
  4244             88  PB-OUT-OF-BAL                VALUE 'O'.
  4245         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4246         16  PB-AH-OVERRIDE-L1            PIC X.
  4247         16  PB-INPUT-DT                  PIC XX.
  4248         16  PB-INPUT-BY                  PIC X(4).
  4249         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4250         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4251         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4252         16  PB-LF-EARNING-METHOD         PIC X.
  4253         16  PB-AH-EARNING-METHOD         PIC X.
  4254         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4255         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4256         16  PB-REIN-CD                   PIC XXX.
  4257         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  79
* EL050.cbl
  4258         16  PB-AH-REFUND-TYPE            PIC X.
  4259         16  PB-ACCT-EFF-DT               PIC XX.
  4260         16  PB-ACCT-EXP-DT               PIC XX.
  4261         16  PB-COMPANY-ID                PIC X(3).
  4262         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4263         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4264         16  PB-SV-CARRIER                PIC X.
  4265         16  PB-SV-GROUPING               PIC X(6).
  4266         16  PB-SV-STATE                  PIC XX.
  4267         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4268         16  PB-GA-BILLING-INFO.
  4269             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4270                                          PIC XX.
  4271         16  PB-SV-REMIT-TO  REDEFINES
  4272             PB-GA-BILLING-INFO           PIC X(10).
  4273         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4274         16  PB-I-LOAN-OFFICER            PIC X(5).
  4275         16  PB-I-VIN                     PIC X(17).
  4276
  4277         16  FILLER                       PIC X(04).
  4278         16  IMNET-BYPASS-SW              PIC X.
  4279
  4280******************************************************************
  4281*                COMMON EDIT ERRORS                              *
  4282******************************************************************
  4283
  4284     12  PB-COMMON-ERRORS.
  4285         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4286                                           PIC S9(4)     COMP.
  4287
  4288******************************************************************
  4289
  4290* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4291*    COPY ELC50W1.
  4292******************************************************************
  4293*                                                                *
  4294*                                                                *
  4295*                             ELC50W1                            *
  4296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4297*                            VMOD=2.004                          *
  4298*                                                                *
  4299*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4300*                                                                *
  4301*                                                                *
  4302******************************************************************
  4303
  4304     12  WK-WORK-AREA.
  4305         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4306         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4307         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4308         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4309         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4310         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4311         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4312         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4313         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4314         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4315         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  80
* EL050.cbl
  4316         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4317         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4318         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4319         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4320         16  WK-CREDIT-EDIT-CONTROLS.
  4321             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4322             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4323             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4324             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4325             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4326             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4327         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4328         16  WK-SAVE-REIN-DATA.
  4329             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4330             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4331             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4332         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4333             88  ENTRY-FROM-EL6311       VALUE '6'.
  4334         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4335         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4336     12  WK-RECORD-ADDRESSES.
  4337         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4338         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4339         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4340         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4341         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4342         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4343         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4344         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4345     12  WK-OVER-SHORT-AREA.
  4346         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4347         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4348         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4349             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4350         16  FILLER                   PIC X(5) VALUE SPACES.
  4351
  4352*    COPY ELCEDITC.
  4353******************************************************************
  4354*                                                                *
  4355*                                                                *
  4356*                            ELCEDITC                            *
  4357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4358*                            VMOD=2.012                          *
  4359*                                                                *
  4360*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4361*                     EL6313, EL050 AND EL517.                   *
  4362*                                                                *
  4363******************************************************************
  4364******************************************************************
  4365*                   C H A N G E   L O G
  4366*
  4367* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4368*-----------------------------------------------------------------
  4369*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4370* EFFECTIVE    NUMBER
  4371*-----------------------------------------------------------------
  4372* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4373******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  81
* EL050.cbl
  4374
  4375     12  EDIT-CRITERIA-DATA.
  4376         16  EC-CO-MONTH-END-DT       PIC XX.
  4377         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4378         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4379         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4380         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4381         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4382         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4383         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4384         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4385         16  EC-CO-REM-TERM-CALC      PIC X.
  4386               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4387               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4388               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4389               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4390
  4391         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4392               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4393               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4394               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4395               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4396               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4397               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4398               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4399               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4400               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4401               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4402
  4403         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4404               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4405               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4406               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4407               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4408               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4409               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4410               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4411               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4412
  4413         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4414                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4415                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4416
  4417         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4418                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4419                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4420                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4421                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4422                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4423                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4424                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4425                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4426
  4427         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4428               88  EC-BR-REDUCING                   VALUE 'R'.
  4429               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4430
  4431         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  82
* EL050.cbl
  4432         16  EC-BR-LF-DESC             PIC X(10).
  4433         16  EC-BR-AH-DESC             PIC X(10).
  4434         16  EC-BR-LF-COMMENT          PIC X(10).
  4435         16  EC-BR-AH-COMMENT          PIC X(10).
  4436
  4437         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4438               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4439               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4440               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4441               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4442
  4443         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4444               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4445               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4446               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4447               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4448
  4449         16  EC-BR-LF-REFUND-CALC      PIC X.
  4450                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4451                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4452                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4453                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4454                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4455                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4456                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4457
  4458         16  EC-BR-AH-REFUND-CALC      PIC X.
  4459                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4460                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4461                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4462                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4463                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4464                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4465                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4466                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4467
  4468         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4469                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4470                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4471                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4472
  4473         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4474                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4475                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4476                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4477
  4478         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4479         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4480         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4481         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4482
  4483         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4484         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4485                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4486                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4487                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4488                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4489
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  83
* EL050.cbl
  4490         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4491               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4492               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4493               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4494               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4495               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4496
  4497         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4498               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4499               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4500               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4501               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4502               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4503
  4504         16  EC-ST-LF-REFUND-CALC      PIC X.
  4505                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4506                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4507                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4508                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4509                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4510                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4511                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4512                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4513
  4514         16  EC-ST-AH-REFUND-CALC      PIC X.
  4515                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4516                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4517                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4518                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4519                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4520                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4521                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4522                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4523
  4524         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4525         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4526         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4527         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4528         16  EC-AM-EXPIRATION-DT       PIC XX.
  4529         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4530         16  EC-AM-CLASS-CD            PIC XX.
  4531         16  EC-AM-LF-DEVIATION        PIC XXX.
  4532         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4533         16  EC-AM-AH-DEVIATION        PIC XXX.
  4534         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4535         16  EC-AM-PHONE-NO            PIC X(10).
  4536
  4537         16  EC-AM-LF-REFUND-CALC      PIC X.
  4538                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4539                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4540                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4541                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4542                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4543                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4544                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4545
  4546         16  EC-AM-AH-REFUND-CALC      PIC X.
  4547                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  84
* EL050.cbl
  4548                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4549                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4550                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4551                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4552                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4553                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4554
  4555         16  EC-AM-BEN-I-G-CD          PIC X.
  4556                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4557                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4558                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4559
  4560         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4561         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4562         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4563         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4564         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4565         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4566         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4567         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4568         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4569
  4570         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4571         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4572         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4573         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4574         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4575         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4576         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4577         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4578         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4579         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4580         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4581         16  EC-RT-LF-NSP-ST           PIC XX.
  4582         16  EC-RT-AH-NSP-ST           PIC XX.
  4583         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4584         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4585
  4586         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4587             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4588                                             'M' '5' '9' '2'.
  4589             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4590             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4591             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4592             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4593             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4594             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4595             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4596             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4597             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4598             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4599
  4600         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4601             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4602                                             'M' '5' '9' '2'.
  4603             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4604             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4605             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  85
* EL050.cbl
  4606             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4607             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4608             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4609             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4610             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4611             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4612             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4613
  4614         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4615         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4616         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4617         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4618         16  EC-CM-DEATH-DT            PIC XX.
  4619
  4620*DMD CUSTOM CODING FIELDS BELOW
  4621*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4622         16  EC-BR-DMD-RATING-SW       PIC X.
  4623                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4624                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4625                 88  NO-DMD-RATING               VALUE 'N'.
  4626
  4627         16  EC-NEW-CERT               PIC X(11).
  4628         16  EC-NEW-STATE              PIC XX.
  4629         16  FILLER                    PIC X.
  4630*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4631         16  OVER-SHORT-EDIT-FIELDS.
  4632             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4633             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4634             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4635             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4636             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4637             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4638             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4639             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4640             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4641         16  FILLER                    PIC X(71).
  4642******************************************************************
  4643
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  86
* EL050.cbl
  4645*    COPY ELCDIFRD.
  4646******************************************************************
  4647*                                                                *
  4648*                                                                *
  4649*                            ELCDIFRD.                           *
  4650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4651*                            VMOD=2.004                          *
  4652*                                                                *
  4653*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4654*                                                                *
  4655******************************************************************
  4656*
  4657  01  WS-DIFFERENCE-CALCULATION.
  4658        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4659        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4660        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4661        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4662        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4663        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4664        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4665        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4666        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4667        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4668        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4669
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  87
* EL050.cbl
  4671****************************************************************
  4672*
  4673* Copyright (c) 2007 by Clerity Solutions, Inc.
  4674* All rights reserved.
  4675*
  4676****************************************************************
  4677 01  DFHEIV.
  4678   02  DFHEIV0               PIC X(35).
  4679   02  DFHEIV1               PIC X(08).
  4680   02  DFHEIV2               PIC X(08).
  4681   02  DFHEIV3               PIC X(08).
  4682   02  DFHEIV4               PIC X(06).
  4683   02  DFHEIV5               PIC X(04).
  4684   02  DFHEIV6               PIC X(04).
  4685   02  DFHEIV7               PIC X(02).
  4686   02  DFHEIV8               PIC X(02).
  4687   02  DFHEIV9               PIC X(01).
  4688   02  DFHEIV10              PIC S9(7) COMP-3.
  4689   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4690   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4691   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4692   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4693   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4694   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4695   02  DFHEIV17              PIC X(04).
  4696   02  DFHEIV18              PIC X(04).
  4697   02  DFHEIV19              PIC X(04).
  4698   02  DFHEIV20              USAGE IS POINTER.
  4699   02  DFHEIV21              USAGE IS POINTER.
  4700   02  DFHEIV22              USAGE IS POINTER.
  4701   02  DFHEIV23              USAGE IS POINTER.
  4702   02  DFHEIV24              USAGE IS POINTER.
  4703   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4704   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4705   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4706   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4707   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4708   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4709   02  FILLER                PIC X(02).
  4710   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4711   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4712   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4713   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4714   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4715 LINKAGE  SECTION.
  4716*****************************************************************
  4717*                                                               *
  4718* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4719* All rights reserved.                                          *
  4720*                                                               *
  4721*****************************************************************
  4722 01  dfheiblk.
  4723     02  eibtime          pic s9(7) comp-3.
  4724     02  eibdate          pic s9(7) comp-3.
  4725     02  eibtrnid         pic x(4).
  4726     02  eibtaskn         pic s9(7) comp-3.
  4727     02  eibtrmid         pic x(4).
  4728     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  88
* EL050.cbl
  4729     02  eibcposn         pic s9(4) comp.
  4730     02  eibcalen         pic s9(4) comp.
  4731     02  eibaid           pic x(1).
  4732     02  eibfiller1       pic x(1).
  4733     02  eibfn            pic x(2).
  4734     02  eibfiller2       pic x(2).
  4735     02  eibrcode         pic x(6).
  4736     02  eibfiller3       pic x(2).
  4737     02  eibds            pic x(8).
  4738     02  eibreqid         pic x(8).
  4739     02  eibrsrce         pic x(8).
  4740     02  eibsync          pic x(1).
  4741     02  eibfree          pic x(1).
  4742     02  eibrecv          pic x(1).
  4743     02  eibsend          pic x(1).
  4744     02  eibatt           pic x(1).
  4745     02  eibeoc           pic x(1).
  4746     02  eibfmh           pic x(1).
  4747     02  eibcompl         pic x(1).
  4748     02  eibsig           pic x(1).
  4749     02  eibconf          pic x(1).
  4750     02  eiberr           pic x(1).
  4751     02  eibrldbk         pic x(1).
  4752     02  eiberrcd         pic x(4).
  4753     02  eibsynrb         pic x(1).
  4754     02  eibnodat         pic x(1).
  4755     02  eibfiller5       pic x(2).
  4756     02  eibresp          pic 9(09) comp.
  4757     02  eibresp2         pic 9(09) comp.
  4758     02  dfheigdj         pic s9(4) comp.
  4759     02  dfheigdk         pic s9(4) comp.
  4760
  4761 01  DFHCOMMAREA                   PIC X(1036).
  4762
  4763*01 PARMLIST .
  4764*    02  FILLER                    PIC S9(8)   COMP.
  4765*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4766*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4767*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4768*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4769*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4770*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4771*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4772
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  89
* EL050.cbl
  4774*    COPY ELCCNTL.
  4775******************************************************************
  4776*                                                                *
  4777*                                                                *
  4778*                            ELCCNTL.                            *
  4779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4780*                            VMOD=2.059                          *
  4781*                                                                *
  4782*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4783*                                                                *
  4784*   FILE TYPE = VSAM,KSDS                                        *
  4785*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4786*                                                                *
  4787*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4788*       ALTERNATE INDEX = NONE                                   *
  4789*                                                                *
  4790*   LOG = YES                                                    *
  4791*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4792******************************************************************
  4793*                   C H A N G E   L O G
  4794*
  4795* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4796*-----------------------------------------------------------------
  4797*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4798* EFFECTIVE    NUMBER
  4799*-----------------------------------------------------------------
  4800* 082503                   PEMA  ADD BENEFIT GROUP
  4801* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4802* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4803* 092705    2005050300006  PEMA  ADD SPP LEASES
  4804* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4805* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4806* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4807* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4808* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4809******************************************************************
  4810*
  4811 01  CONTROL-FILE.
  4812     12  CF-RECORD-ID                       PIC XX.
  4813         88  VALID-CF-ID                        VALUE 'CF'.
  4814
  4815     12  CF-CONTROL-PRIMARY.
  4816         16  CF-COMPANY-ID                  PIC XXX.
  4817         16  CF-RECORD-TYPE                 PIC X.
  4818             88  CF-COMPANY-MASTER              VALUE '1'.
  4819             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4820             88  CF-STATE-MASTER                VALUE '3'.
  4821             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4822             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4823             88  CF-CARRIER-MASTER              VALUE '6'.
  4824             88  CF-MORTALITY-MASTER            VALUE '7'.
  4825             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4826             88  CF-TERMINAL-MASTER             VALUE '9'.
  4827             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4828             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4829             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4830             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4831             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  90
* EL050.cbl
  4832             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4833             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4834             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4835             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4836         16  CF-ACCESS-CD-GENL              PIC X(4).
  4837         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4838             20  CF-PROCESSOR               PIC X(4).
  4839         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4840             20  CF-STATE-CODE              PIC XX.
  4841             20  FILLER                     PIC XX.
  4842         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4843             20  FILLER                     PIC XX.
  4844             20  CF-HI-BEN-IN-REC           PIC XX.
  4845         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4846             20  FILLER                     PIC XXX.
  4847             20  CF-CARRIER-CNTL            PIC X.
  4848         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4849             20  FILLER                     PIC XX.
  4850             20  CF-HI-TYPE-IN-REC          PIC 99.
  4851         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4852             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4853                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4854             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4855             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4856         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4857             20  FILLER                     PIC X.
  4858             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4859         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4860             20  FILLER                     PIC XX.
  4861             20  CF-MORTGAGE-PLAN           PIC XX.
  4862         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4863
  4864     12  CF-LAST-MAINT-DT                   PIC XX.
  4865     12  CF-LAST-MAINT-BY                   PIC X(4).
  4866     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4867
  4868     12  CF-RECORD-BODY                     PIC X(728).
  4869
  4870
  4871****************************************************************
  4872*             COMPANY MASTER RECORD                            *
  4873****************************************************************
  4874
  4875     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4876         16  CF-COMPANY-ADDRESS.
  4877             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4878             20  CF-CL-IN-CARE-OF           PIC X(30).
  4879             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4880             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4881             20  CF-CL-CITY-STATE           PIC X(30).
  4882             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4883             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4884         16  CF-COMPANY-CD                  PIC X.
  4885         16  CF-COMPANY-PASSWORD            PIC X(8).
  4886         16  CF-SECURITY-OPTION             PIC X.
  4887             88  ALL-SECURITY                   VALUE '1'.
  4888             88  COMPANY-VERIFY                 VALUE '2'.
  4889             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  91
* EL050.cbl
  4890             88  NO-SECURITY                    VALUE '4'.
  4891             88  ALL-BUT-TERM                   VALUE '5'.
  4892         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4893             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4894         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4895             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4896         16  CF-INFORCE-LOCATION            PIC X.
  4897             88  CERTS-ARE-ONLINE               VALUE '1'.
  4898             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4899             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4900         16  CF-LOWER-CASE-LETTERS          PIC X.
  4901         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4902             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4903             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4904             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4905             88  CF-ACCNT-CNTL                  VALUE '3'.
  4906             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4907
  4908         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4909         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4910
  4911         16  CF-LGX-CREDIT-USER             PIC X.
  4912             88  CO-IS-NOT-USER                 VALUE 'N'.
  4913             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4914
  4915         16 CF-CREDIT-CALC-CODES.
  4916             20  CF-CR-REM-TERM-CALC PIC X.
  4917               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4918               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4919               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4920               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4921               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4922               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4923               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4924             20  CF-CR-R78-METHOD           PIC X.
  4925               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4926               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4927
  4928         16  CF-CLAIM-CONTROL-COUNTS.
  4929             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4930                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4931
  4932             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4933                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4934
  4935             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4936                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4937
  4938             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4939                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4940
  4941         16  CF-CURRENT-MONTH-END           PIC XX.
  4942
  4943         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4944             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4945             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4946             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4947             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  92
* EL050.cbl
  4948                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4949                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4950             20  CF-CO-PREM-REJECT-SW       PIC X.
  4951                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4952                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4953             20  CF-CO-REF-REJECT-SW        PIC X.
  4954                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4955                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4956
  4957         16  CF-CO-REPORTING-DT             PIC XX.
  4958         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4959         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4960           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4961           88  CF-CO-MONTH-END                  VALUE '1'.
  4962
  4963         16  CF-LGX-CLAIM-USER              PIC X.
  4964             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4965             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4966
  4967         16  CF-CREDIT-EDIT-CONTROLS.
  4968             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4969             20  CF-MIN-AGE                 PIC 99.
  4970             20  CF-DEFAULT-AGE             PIC 99.
  4971             20  CF-MIN-TERM                PIC S999      COMP-3.
  4972             20  CF-MAX-TERM                PIC S999      COMP-3.
  4973             20  CF-DEFAULT-SEX             PIC X.
  4974             20  CF-JOINT-AGE-INPUT         PIC X.
  4975                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4976             20  CF-BIRTH-DATE-INPUT        PIC X.
  4977                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4978             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4979                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4980                 88  CF-ZERO-CARRIER            VALUE '1'.
  4981                 88  CF-ZERO-GROUPING           VALUE '2'.
  4982                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4983             20  CF-EDIT-SW                 PIC X.
  4984                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4985             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4986             20  CF-CR-PR-METHOD            PIC X.
  4987               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4988               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4989             20  FILLER                     PIC X.
  4990
  4991         16  CF-CREDIT-MISC-CONTROLS.
  4992             20  CF-REIN-TABLE-SW           PIC X.
  4993                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4994             20  CF-COMP-TABLE-SW           PIC X.
  4995                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4996             20  CF-EXPERIENCE-RETENTION-AGE
  4997                                            PIC S9        COMP-3.
  4998             20  CF-CONVERSION-DT           PIC XX.
  4999             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5000             20  CF-RUN-FREQUENCY-SW        PIC X.
  5001                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5002                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5003
  5004             20  CF-CR-CHECK-NO-CONTROL.
  5005                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  93
* EL050.cbl
  5006                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5007                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5008                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5009                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5010                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5011
  5012                 24  CF-CR-CHECK-COUNT       REDEFINES
  5013                     CF-CR-CHECK-COUNTER      PIC X(4).
  5014
  5015                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5016                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5017
  5018                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5019                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5020                 24  CF-MAIL-PROCESSING       PIC X.
  5021                     88  MAIL-PROCESSING          VALUE 'Y'.
  5022
  5023         16  CF-MISC-SYSTEM-CONTROL.
  5024             20  CF-SYSTEM-C                 PIC X.
  5025                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5026             20  CF-SYSTEM-D                 PIC X.
  5027                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5028             20  CF-SOC-SEC-NO-SW            PIC X.
  5029                 88  SOC-SEC-NO-USED             VALUE '1'.
  5030             20  CF-MEMBER-NO-SW             PIC X.
  5031                 88  MEMBER-NO-USED              VALUE '1'.
  5032             20  CF-TAX-ID-NUMBER            PIC X(11).
  5033             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5034             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5035                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5036                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5037                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5038                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5039             20  CF-SYSTEM-E                 PIC X.
  5040                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5041
  5042         16  CF-LGX-LIFE-USER               PIC X.
  5043             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5044             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5045
  5046         16  CF-CR-MONTH-END-DT             PIC XX.
  5047
  5048         16  CF-FILE-MAINT-DATES.
  5049             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5050                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5051             20  CF-LAST-BATCH       REDEFINES
  5052                 CF-LAST-BATCH-NO               PIC X(4).
  5053             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5054             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5055             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5056             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5057             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5058             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5059             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5060             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5061             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5062             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5063
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  94
* EL050.cbl
  5064         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5065         16  FILLER                         PIC X.
  5066
  5067         16  CF-ALT-MORT-CODE               PIC X(4).
  5068         16  CF-MEMBER-CAPTION              PIC X(10).
  5069
  5070         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5071             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5072             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5073             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5074             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5075             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5076
  5077         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5078
  5079         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5080         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5081         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5082         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5083
  5084         16  CF-AH-OVERRIDE-L1              PIC X.
  5085         16  CF-AH-OVERRIDE-L2              PIC XX.
  5086         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5087         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5088
  5089         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5090         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5091
  5092         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5093         16  CF-AR-LAST-EL860-DT            PIC XX.
  5094         16  CF-MP-MONTH-END-DT             PIC XX.
  5095
  5096         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5097         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5098             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5099
  5100         16  CF-AR-MONTH-END-DT             PIC XX.
  5101
  5102         16  CF-CRDTCRD-USER                PIC X.
  5103             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5104             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5105
  5106         16  CF-CC-MONTH-END-DT             PIC XX.
  5107
  5108         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5109
  5110         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5111             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5112             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5113             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5114         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5115         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5116         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5117         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5118             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5119             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5120         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5121         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  95
* EL050.cbl
  5122         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5123             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5124         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5125
  5126         16  CF-CL-ZIP-CODE.
  5127             20  CF-CL-ZIP-PRIME.
  5128                 24  CF-CL-ZIP-1ST          PIC X.
  5129                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5130                 24  FILLER                 PIC X(4).
  5131             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5132         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5133             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5134             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5135             20  FILLER                     PIC XXX.
  5136
  5137         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5138         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5139         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5140         16  CF-CO-OPTION-START-DATE        PIC XX.
  5141         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5142           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5143                                                      '3' '4'.
  5144           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5145           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5146           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5147           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5148           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5149           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5150
  5151         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5152
  5153         16  CF-PAYMENT-APPROVAL-LEVELS.
  5154             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5155             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5156             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5157             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5158             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5159             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5160
  5161         16  CF-END-USER-REPORTING-USER     PIC X.
  5162             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5163             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5164
  5165         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5166             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5167             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5168
  5169         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5170
  5171         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5172         16  FILLER                         PIC X.
  5173
  5174         16  CF-CREDIT-ARCHIVE-CNTL.
  5175             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5176             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5177             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5178
  5179         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  96
* EL050.cbl
  5180
  5181         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5182             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5183             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5184
  5185         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5186             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5187             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5188
  5189         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5190
  5191         16  CF-CO-ACH-ID-CODE              PIC  X.
  5192             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5193             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5194             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5195         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5196         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5197         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5198         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5199         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5200         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5201         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5202         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5203         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5204                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5205         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5206                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5207
  5208         16  CF-CO-OVER-SHORT.
  5209             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5210             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5211
  5212*         16  FILLER                         PIC X(102).
  5213         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5214             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5215             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5216
  5217         16  CF-AH-APPROVAL-DAYS.
  5218             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5219             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5220             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5221             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5222
  5223         16  FILLER                         PIC X(82).
  5224****************************************************************
  5225*             PROCESSOR/USER RECORD                            *
  5226****************************************************************
  5227
  5228     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5229         16  CF-PROCESSOR-NAME              PIC X(30).
  5230         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5231         16  CF-PROCESSOR-TITLE             PIC X(26).
  5232         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5233                 88  MESSAGE-YES                VALUE 'Y'.
  5234                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5235
  5236*****************************************************
  5237****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  97
* EL050.cbl
  5238****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5239****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5240****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5241*****************************************************
  5242
  5243         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5244             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5245             20  CF-APPLICATION-FORCE       PIC X.
  5246             20  CF-INDIVIDUAL-APP.
  5247                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5248                     28  CF-BROWSE-APP      PIC X.
  5249                     28  CF-UPDATE-APP      PIC X.
  5250
  5251         16  CF-CURRENT-TERM-ON             PIC X(4).
  5252         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5253             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5254             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5255             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5256             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5257             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5258             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5259             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5260         16  CF-PROCESSOR-CARRIER           PIC X.
  5261             88  NO-CARRIER-SECURITY            VALUE ' '.
  5262         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5263             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5264         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5265             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5266         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5267             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5268
  5269         16  CF-PROC-SYS-ACCESS-SW.
  5270             20  CF-PROC-CREDIT-CLAIMS-SW.
  5271                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5272                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5273                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5274                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5275             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5276                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5277                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5278             20  CF-PROC-LIFE-GNRLDGR-SW.
  5279                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5280                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5281                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5282                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5283             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5284                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5285                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5286         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5287             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5288             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5289         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5290
  5291         16  CF-APPROVAL-LEVEL                  PIC X.
  5292             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5293             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5294             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5295             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  98
* EL050.cbl
  5296
  5297         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5298
  5299         16  CF-LANGUAGE-TYPE                   PIC X.
  5300             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5301             88  CF-LANG-IS-FR                      VALUE 'F'.
  5302         16  FILLER                             PIC  X(240).
  5303
  5304****************************************************************
  5305*             PROCESSOR/REMINDERS RECORD                       *
  5306****************************************************************
  5307
  5308     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5309         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5310             20  CF-START-REMIND-DT         PIC XX.
  5311             20  CF-END-REMIND-DT           PIC XX.
  5312             20  CF-REMINDER-TEXT           PIC X(50).
  5313         16  FILLER                         PIC X(296).
  5314
  5315
  5316****************************************************************
  5317*             STATE MASTER RECORD                              *
  5318****************************************************************
  5319
  5320     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5321         16  CF-STATE-ABBREVIATION          PIC XX.
  5322         16  CF-STATE-NAME                  PIC X(25).
  5323         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5324         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5325             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5326             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5327             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5328             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5329                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5330                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5331             20  CF-ST-PREM-REJECT-SW       PIC X.
  5332                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5333                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5334             20  CF-ST-REF-REJECT-SW        PIC X.
  5335                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5336                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5337         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5338         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5339         16  CF-ST-REFUND-RULES.
  5340             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5341             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5342             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5343         16  CF-ST-FST-PMT-EXTENSION.
  5344             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5345             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5346                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5347                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5348                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5349                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5350         16  CF-ST-STATE-CALL.
  5351             20  CF-ST-CALL-UNEARNED        PIC X.
  5352             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5353             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page  99
* EL050.cbl
  5354         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5355             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5356             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5357         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5358         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5359         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5360         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5361         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5362         16  FILLER                         PIC X.
  5363         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5364             20  CF-ST-BENEFIT-CD           PIC XX.
  5365             20  CF-ST-BENEFIT-KIND         PIC X.
  5366                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5367                 88  CF-ST-AH-KIND              VALUE 'A'.
  5368             20  CF-ST-REM-TERM-CALC        PIC X.
  5369                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5370                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5371                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5372                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5373                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5374                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5375                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5376                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5377
  5378             20  CF-ST-REFUND-CALC          PIC X.
  5379                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5380                 88  ST-REFD-BY-R78             VALUE '1'.
  5381                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5382                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5383                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5384                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5385                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5386                 88  ST-REFD-UTAH               VALUE '7'.
  5387                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5388                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5389                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5390
  5391             20  CF-ST-EARNING-CALC         PIC X.
  5392                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5393                 88  ST-EARN-BY-R78             VALUE '1'.
  5394                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5395                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5396                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5397                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5398                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5399                 88  ST-EARN-MEAN               VALUE '8'.
  5400                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5401
  5402             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5403                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5404                 88  ST-OVRD-BY-R78             VALUE '1'.
  5405                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5406                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5407                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5408                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5409                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5410                 88  ST-OVRD-MEAN               VALUE '8'.
  5411                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 100
* EL050.cbl
  5412             20  FILLER                     PIC X.
  5413
  5414         16  CF-ST-COMMISSION-CAPS.
  5415             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5416             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5417             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5418             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5419         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5420                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5421
  5422         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5423
  5424         16  CF-ST-STATUTORY-INTEREST.
  5425             20  CF-ST-STAT-DATE-FROM       PIC X.
  5426                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5427                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5428             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5429             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5430             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5431             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5432             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5433
  5434         16  CF-ST-OVER-SHORT.
  5435             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5436             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5437
  5438         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5439
  5440         16  CF-ST-RT-CALC                  PIC X.
  5441
  5442         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5443         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5444         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5445         16  CF-ST-RF-LR-CALC               PIC X.
  5446         16  CF-ST-RF-LL-CALC               PIC X.
  5447         16  CF-ST-RF-LN-CALC               PIC X.
  5448         16  CF-ST-RF-AH-CALC               PIC X.
  5449         16  CF-ST-RF-CP-CALC               PIC X.
  5450*        16  FILLER                         PIC X(206).
  5451*CIDMOD         16  FILLER                         PIC X(192).
  5452         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5453             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5454         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5455         16  CF-ST-VFY-2ND-BENE             PIC X.
  5456         16  FILLER                         PIC X(186).
  5457
  5458****************************************************************
  5459*             BENEFIT MASTER RECORD                            *
  5460****************************************************************
  5461
  5462     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5463         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5464             20  CF-BENEFIT-CODE            PIC XX.
  5465             20  CF-BENEFIT-NUMERIC  REDEFINES
  5466                 CF-BENEFIT-CODE            PIC XX.
  5467             20  CF-BENEFIT-ALPHA           PIC XXX.
  5468             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5469             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 101
* EL050.cbl
  5470
  5471             20  CF-LF-COVERAGE-TYPE        PIC X.
  5472                 88  CF-REDUCING                VALUE 'R'.
  5473                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5474
  5475             20  CF-SPECIAL-CALC-CD         PIC X.
  5476                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5477                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5478                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5479                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5480                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5481                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5482                 88  CF-FARM-PLAN               VALUE 'F'.
  5483                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5484                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5485                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5486                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5487                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5488                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5489                 88  CF-PRUDENTIAL              VALUE 'P'.
  5490                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5491                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5492                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5493                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5494                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5495                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5496
  5497             20  CF-JOINT-INDICATOR         PIC X.
  5498                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5499
  5500*            20  FILLER                     PIC X(12).
  5501             20  FILLER                     PIC X(11).
  5502             20  CF-BENEFIT-CATEGORY        PIC X.
  5503             20  CF-LOAN-TYPE               PIC X(8).
  5504
  5505             20  CF-CO-REM-TERM-CALC        PIC X.
  5506                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5507                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5508                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5509                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5510                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5511
  5512             20  CF-CO-EARNINGS-CALC        PIC X.
  5513                 88  CO-EARN-BY-R78             VALUE '1'.
  5514                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5515                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5516                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5517                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5518                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5519                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5520                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5521
  5522             20  CF-CO-REFUND-CALC          PIC X.
  5523                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5524                 88  CO-REFD-BY-R78             VALUE '1'.
  5525                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5526                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5527                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 102
* EL050.cbl
  5528                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5529                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5530                 88  CO-REFD-MEAN               VALUE '8'.
  5531                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5532                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5533                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5534
  5535             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5536                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5537                 88  CO-OVRD-BY-R78             VALUE '1'.
  5538                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5539                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5540                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5541                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5542                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5543                 88  CO-OVRD-MEAN               VALUE '8'.
  5544                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5545
  5546             20  CF-CO-BEN-I-G-CD           PIC X.
  5547                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5548                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5549                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5550
  5551         16  FILLER                         PIC X(304).
  5552
  5553
  5554****************************************************************
  5555*             CARRIER MASTER RECORD                            *
  5556****************************************************************
  5557
  5558     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5559         16  CF-ADDRESS-DATA.
  5560             20  CF-MAIL-TO-NAME            PIC X(30).
  5561             20  CF-IN-CARE-OF              PIC X(30).
  5562             20  CF-ADDRESS-LINE-1          PIC X(30).
  5563             20  CF-ADDRESS-LINE-2          PIC X(30).
  5564             20  CF-CITY-STATE              PIC X(30).
  5565             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5566             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5567
  5568         16  CF-CLAIM-NO-CONTROL.
  5569             20  CF-CLAIM-NO-METHOD         PIC X.
  5570                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5571                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5572                 88  CLAIM-NO-SEQ               VALUE '3'.
  5573                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5574             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5575                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5576                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5577                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5578
  5579         16  CF-CHECK-NO-CONTROL.
  5580             20  CF-CHECK-NO-METHOD         PIC X.
  5581                 88  CHECK-NO-MANUAL            VALUE '1'.
  5582                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5583                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5584                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5585             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 103
* EL050.cbl
  5586                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5587
  5588         16  CF-DOMICILE-STATE              PIC XX.
  5589
  5590         16  CF-EXPENSE-CONTROLS.
  5591             20  CF-EXPENSE-METHOD          PIC X.
  5592                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5593                 88  DOLLARS-PER-PMT            VALUE '2'.
  5594                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5595                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5596             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5597             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5598
  5599         16  CF-CORRESPONDENCE-CONTROL.
  5600             20  CF-LETTER-RESEND-OPT       PIC X.
  5601                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5602                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5603             20  FILLER                     PIC X(4).
  5604
  5605         16  CF-RESERVE-CONTROLS.
  5606             20  CF-MANUAL-SW               PIC X.
  5607                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5608             20  CF-FUTURE-SW               PIC X.
  5609                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5610             20  CF-PTC-SW                  PIC X.
  5611                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5612             20  CF-IBNR-SW                 PIC X.
  5613                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5614             20  CF-PTC-LF-SW               PIC X.
  5615                 88  CF-LF-PTC-USED             VALUE '1'.
  5616             20  CF-CDT-ACCESS-METHOD       PIC X.
  5617                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5618                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5619                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5620             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5621
  5622         16  CF-CLAIM-CALC-METHOD           PIC X.
  5623             88  360-PLUS-MONTHS                VALUE '1'.
  5624             88  365-PLUS-MONTHS                VALUE '2'.
  5625             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5626             88  360-DAILY                      VALUE '4'.
  5627             88  365-DAILY                      VALUE '5'.
  5628
  5629         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5630         16  FILLER                         PIC X(11).
  5631
  5632         16  CF-LIMIT-AMOUNTS.
  5633             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5634             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5635             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5636             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5637             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5638             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5639             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5640             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5641             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5642             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5643
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 104
* EL050.cbl
  5644         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5645         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5646         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5647
  5648         16  CF-ZIP-CODE.
  5649             20  CF-ZIP-PRIME.
  5650                 24  CF-ZIP-1ST             PIC X.
  5651                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5652                 24  FILLER                 PIC X(4).
  5653             20  CF-ZIP-PLUS4               PIC X(4).
  5654         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5655             20  CF-CAN-POSTAL-1            PIC XXX.
  5656             20  CF-CAN-POSTAL-2            PIC XXX.
  5657             20  FILLER                     PIC XXX.
  5658
  5659         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5660         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5661         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5662
  5663         16  CF-RATING-SWITCH               PIC X.
  5664             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5665             88  CF-NO-RATING                   VALUE 'N'.
  5666
  5667         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5668
  5669         16  CF-CARRIER-OVER-SHORT.
  5670             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5671             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5672
  5673         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5674         16  CF-SECPAY-SWITCH               PIC X.
  5675             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5676             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5677         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5678         16  FILLER                         PIC X(448).
  5679*        16  FILLER                         PIC X(452).
  5680
  5681
  5682****************************************************************
  5683*             MORTALITY MASTER RECORD                          *
  5684****************************************************************
  5685
  5686     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5687         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5688                                INDEXED BY CF-MORT-NDX.
  5689             20  CF-MORT-TABLE              PIC X(5).
  5690             20  CF-MORT-TABLE-TYPE         PIC X.
  5691                 88  CF-MORT-JOINT              VALUE 'J'.
  5692                 88  CF-MORT-SINGLE             VALUE 'S'.
  5693                 88  CF-MORT-COMBINED           VALUE 'C'.
  5694                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5695                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5696             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5697             20  CF-MORT-AGE-METHOD         PIC XX.
  5698                 88  CF-AGE-LAST                VALUE 'AL'.
  5699                 88  CF-AGE-NEAR                VALUE 'AN'.
  5700             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5701             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 105
* EL050.cbl
  5702                                            PIC X.
  5703                 88  CF-MINUS                   VALUE '-'.
  5704                 88  CF-PLUS                    VALUE '+'.
  5705             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5706             20  CF-MORT-JOINT-CODE         PIC X.
  5707                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5708             20  CF-MORT-PC-Q               PIC X.
  5709                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5710             20  CF-MORT-TABLE-CODE         PIC X(4).
  5711             20  CF-MORT-COMMENTS           PIC X(15).
  5712             20  FILLER                     PIC X(14).
  5713
  5714         16  FILLER                         PIC X(251).
  5715
  5716
  5717****************************************************************
  5718*             BUSSINESS TYPE MASTER RECORD                     *
  5719****************************************************************
  5720
  5721     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5722* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5723* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5724* AND RECORD 05 IS TYPES 81-99
  5725         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5726             20  CF-BUSINESS-TITLE          PIC  X(19).
  5727             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5728                                            PIC S9V9(4) COMP-3.
  5729             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5730             20  FILLER                     PIC  X.
  5731         16  FILLER                         PIC  X(248).
  5732
  5733
  5734****************************************************************
  5735*             TERMINAL MASTER RECORD                           *
  5736****************************************************************
  5737
  5738     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5739
  5740         16  CF-COMPANY-TERMINALS.
  5741             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5742                                  PIC X(4).
  5743         16  FILLER               PIC X(248).
  5744
  5745
  5746****************************************************************
  5747*             LIFE EDIT MASTER RECORD                          *
  5748****************************************************************
  5749
  5750     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5751         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5752             20  CF-LIFE-CODE-IN            PIC XX.
  5753             20  CF-LIFE-CODE-OUT           PIC XX.
  5754         16  FILLER                         PIC X(248).
  5755
  5756
  5757****************************************************************
  5758*             AH EDIT MASTER RECORD                            *
  5759****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 106
* EL050.cbl
  5760
  5761     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5762         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5763             20  CF-AH-CODE-IN              PIC XXX.
  5764             20  CF-AH-CODE-OUT             PIC XX.
  5765         16  FILLER                         PIC X(248).
  5766
  5767
  5768****************************************************************
  5769*             CREDIBILITY TABLES                               *
  5770****************************************************************
  5771
  5772     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5773         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5774                             INDEXED BY CF-CRDB-NDX.
  5775             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5776             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5777             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5778         16  FILLER                         PIC  X(332).
  5779
  5780
  5781****************************************************************
  5782*             REPORT CUSTOMIZATION RECORD                      *
  5783****************************************************************
  5784
  5785     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5786         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5787             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5788             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5789             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5790**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5791****       A T-TRANSFER.                                   ****
  5792             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5793
  5794         16  FILLER                         PIC XX.
  5795
  5796         16  CF-CARRIER-CNTL-OPT.
  5797             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5798                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5799                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5800             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5801                                            PIC X.
  5802         16  CF-GROUP-CNTL-OPT.
  5803             20  CF-GROUP-OPT-SEQ           PIC 9.
  5804                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5805                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5806             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5807                                            PIC X(6).
  5808         16  CF-STATE-CNTL-OPT.
  5809             20  CF-STATE-OPT-SEQ           PIC 9.
  5810                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5811                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5812             20  CF-STATE-SELECT OCCURS 3 TIMES
  5813                                            PIC XX.
  5814         16  CF-ACCOUNT-CNTL-OPT.
  5815             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5816                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5817                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 107
* EL050.cbl
  5818             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5819                                            PIC X(10).
  5820         16  CF-BUS-TYP-CNTL-OPT.
  5821             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5822                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5823                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5824             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5825                                            PIC XX.
  5826         16  CF-LF-TYP-CNTL-OPT.
  5827             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5828                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5829                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5830             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5831                                            PIC XX.
  5832         16  CF-AH-TYP-CNTL-OPT.
  5833             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5834                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5835                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5836             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5837                                            PIC XX.
  5838         16  CF-REPTCD1-CNTL-OPT.
  5839             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5840                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5841                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5842             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5843                                            PIC X(10).
  5844         16  CF-REPTCD2-CNTL-OPT.
  5845             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5846                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5847                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5848             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5849                                            PIC X(10).
  5850         16  CF-USER1-CNTL-OPT.
  5851             20  CF-USER1-OPT-SEQ           PIC 9.
  5852                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5853                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5854             20  CF-USER1-SELECT OCCURS 3 TIMES
  5855                                            PIC X(10).
  5856         16  CF-USER2-CNTL-OPT.
  5857             20  CF-USER2-OPT-SEQ           PIC 9.
  5858                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5859                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5860             20  CF-USER2-SELECT OCCURS 3 TIMES
  5861                                            PIC X(10).
  5862         16  CF-USER3-CNTL-OPT.
  5863             20  CF-USER3-OPT-SEQ           PIC 9.
  5864                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5865                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5866             20  CF-USER3-SELECT OCCURS 3 TIMES
  5867                                            PIC X(10).
  5868         16  CF-USER4-CNTL-OPT.
  5869             20  CF-USER4-OPT-SEQ           PIC 9.
  5870                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5871                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5872             20  CF-USER4-SELECT OCCURS 3 TIMES
  5873                                            PIC X(10).
  5874         16  CF-USER5-CNTL-OPT.
  5875             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 108
* EL050.cbl
  5876                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5877                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5878             20  CF-USER5-SELECT OCCURS 3 TIMES
  5879                                            PIC X(10).
  5880         16  CF-REINS-CNTL-OPT.
  5881             20  CF-REINS-OPT-SEQ           PIC 9.
  5882                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5883                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5884             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5885                 24  CF-REINS-PRIME         PIC XXX.
  5886                 24  CF-REINS-SUB           PIC XXX.
  5887
  5888         16  CF-AGENT-CNTL-OPT.
  5889             20  CF-AGENT-OPT-SEQ           PIC 9.
  5890                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5891                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5892             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5893                                            PIC X(10).
  5894
  5895         16  FILLER                         PIC X(43).
  5896
  5897         16  CF-LOSS-RATIO-SELECT.
  5898             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5899             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5900         16  CF-ENTRY-DATE-SELECT.
  5901             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5902             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5903         16  CF-EFFECTIVE-DATE-SELECT.
  5904             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5905             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5906
  5907         16  CF-EXCEPTION-LIST-IND          PIC X.
  5908             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5909
  5910         16  FILLER                         PIC X(318).
  5911
  5912****************************************************************
  5913*                  EXCEPTION REPORTING RECORD                  *
  5914****************************************************************
  5915
  5916     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5917         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5918             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5919
  5920         16  CF-COMBINED-LIFE-AH-OPT.
  5921             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5922             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5923             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5924             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5925
  5926         16  CF-LIFE-OPT.
  5927             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5928             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5929             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5930             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5931             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5932             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5933             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 109
* EL050.cbl
  5934             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5935             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5936             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5937
  5938         16  CF-AH-OPT.
  5939             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5940             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5941             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5942             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5943             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5944             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5945             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5946             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5947             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5948             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5949
  5950         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5951             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5952             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5953             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5954
  5955         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5956
  5957         16  FILLER                         PIC X(673).
  5958
  5959
  5960****************************************************************
  5961*             MORTGAGE SYSTEM PLAN RECORD                      *
  5962****************************************************************
  5963
  5964     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5965         16  CF-PLAN-TYPE                   PIC X.
  5966             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5967             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5968             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5969         16  CF-PLAN-ABBREV                 PIC XXX.
  5970         16  CF-PLAN-DESCRIPT               PIC X(10).
  5971         16  CF-PLAN-NOTES                  PIC X(20).
  5972         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5973         16  CF-PLAN-UNDERWRITING.
  5974             20  CF-PLAN-TERM-DATA.
  5975                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5976                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5977             20  CF-PLAN-AGE-DATA.
  5978                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5979                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5980                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5981             20  CF-PLAN-BENEFIT-DATA.
  5982                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5983                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5984                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5985                                            PIC S9(7)V99  COMP-3.
  5986         16  CF-PLAN-POLICY-FORMS.
  5987             20  CF-POLICY-FORM             PIC X(12).
  5988             20  CF-MASTER-APPLICATION      PIC X(12).
  5989             20  CF-MASTER-POLICY           PIC X(12).
  5990         16  CF-PLAN-RATING.
  5991             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 110
* EL050.cbl
  5992             20  CF-SEX-RATING              PIC X.
  5993                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5994                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5995             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5996             20  CF-SUB-STD-TYPE            PIC X.
  5997                 88  CF-PCT-OF-PREM            VALUE '1'.
  5998                 88  CF-PCT-OF-BENE            VALUE '2'.
  5999         16  CF-PLAN-PREM-TOLERANCES.
  6000             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6001             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6002         16  CF-PLAN-PYMT-TOLERANCES.
  6003             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6004             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6005         16  CF-PLAN-MISC-DATA.
  6006             20  FILLER                     PIC X.
  6007             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6008             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6009         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6010         16  CF-PLAN-IND-GRP                PIC X.
  6011             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6012                                                     '1'.
  6013             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6014                                                     '2'.
  6015         16  CF-MIB-SEARCH-SW               PIC X.
  6016             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6017             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6018             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6019             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6020         16  CF-ALPHA-SEARCH-SW             PIC X.
  6021             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6022             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6023             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6024             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6025             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6026             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6027             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6028             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6029             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6030             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6031                                                     'A' 'B' 'C'
  6032                                                     'X' 'Y' 'Z'.
  6033         16  CF-EFF-DT-RULE-SW              PIC X.
  6034             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6035             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6036             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6037             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6038             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6039         16  FILLER                         PIC X(4).
  6040         16  CF-HEALTH-QUESTIONS            PIC X.
  6041             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6042         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6043         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6044         16  CF-PLAN-SNGL-JNT               PIC X.
  6045             88  CF-COMBINED-PLAN              VALUE 'C'.
  6046             88  CF-JNT-PLAN                   VALUE 'J'.
  6047             88  CF-SNGL-PLAN                  VALUE 'S'.
  6048         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6049         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 111
* EL050.cbl
  6050         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6051         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6052         16  CF-RERATE-CNTL                 PIC  X.
  6053             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6054             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6055             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6056             88  CF-AUTO-RECALC                 VALUE '4'.
  6057         16  CF-BENEFIT-TYPE                PIC  X.
  6058             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6059             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6060         16  CF-POLICY-FEE                  PIC S999V99
  6061                                                    COMP-3.
  6062         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6063         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6064         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6065         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6066         16  FILLER                         PIC  X(32).
  6067         16  CF-TERMINATION-FORM            PIC  X(04).
  6068         16  FILLER                         PIC  X(08).
  6069         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6070                                                       COMP-3.
  6071         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6072         16  CF-ISSUE-LETTER                PIC  X(4).
  6073         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6074         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6075             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6076             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6077         16  CF-MP-REFUND-CALC              PIC X.
  6078             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6079             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6080             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6081             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6082             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6083             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6084             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6085             88  CF-MP-REFD-MEAN                VALUE '8'.
  6086         16  CF-ALT-RATE-CODE               PIC  X(5).
  6087
  6088
  6089         16  FILLER                         PIC X(498).
  6090****************************************************************
  6091*             MORTGAGE COMPANY MASTER RECORD                   *
  6092****************************************************************
  6093
  6094     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6095         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6096         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6097             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6098             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6099             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6100             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6101             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6102
  6103         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6104         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6105         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6106         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6107         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 112
* EL050.cbl
  6108
  6109         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6110             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6111         16  CF-MP-RECON-USE-IND            PIC X(1).
  6112             88  CF-MP-USE-RECON             VALUE 'Y'.
  6113         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6114             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6115         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6116             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6117             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6118         16  FILLER                         PIC X(1).
  6119         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6120             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6121         16  CF-MORTG-MIB-VERSION           PIC X.
  6122             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6123             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6124             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6125         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6126             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6127                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6128             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6129                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6130             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6131                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6132             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6133                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6134             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6135                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6136             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6137                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6138         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6139         16  FILLER                         PIC X(7).
  6140         16  CF-MORTG-DESTINATION-SYMBOL.
  6141             20  CF-MORTG-MIB-COMM          PIC X(5).
  6142             20  CF-MORTG-MIB-TERM          PIC X(5).
  6143         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6144             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6145         16  FILLER                         PIC X(03).
  6146         16  CF-MP-CHECK-NO-CONTROL.
  6147             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6148                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6149                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6150                                                ' ' LOW-VALUES.
  6151                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6152                                               VALUE '3'.
  6153         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6154         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6155         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6156             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6157                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6158             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6159                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6160             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6161                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6162             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6163                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6164             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6165                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 113
* EL050.cbl
  6166             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6167                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6168         16  CF-MORTG-BILLING-AREA.
  6169             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6170                                            PIC X.
  6171         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6172         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6173         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6174         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6175             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6176             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6177         16  FILLER                         PIC X.
  6178         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6179             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6180             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6181         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6182         16  FILLER                         PIC X(8).
  6183         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6184         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6185         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6186         16  CF-ACH-COMPANY-ID.
  6187             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6188                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6189                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6190                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6191             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6192         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6193             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6194         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6195             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6196             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6197         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6198         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6199         16  FILLER                         PIC X(536).
  6200
  6201****************************************************************
  6202*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6203****************************************************************
  6204
  6205     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6206         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6207             20  CF-FEMALE-HEIGHT.
  6208                 24  CF-FEMALE-FT           PIC 99.
  6209                 24  CF-FEMALE-IN           PIC 99.
  6210             20  CF-FEMALE-MIN-WT           PIC 999.
  6211             20  CF-FEMALE-MAX-WT           PIC 999.
  6212         16  FILLER                         PIC X(428).
  6213
  6214     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6215         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6216             20  CF-MALE-HEIGHT.
  6217                 24  CF-MALE-FT             PIC 99.
  6218                 24  CF-MALE-IN             PIC 99.
  6219             20  CF-MALE-MIN-WT             PIC 999.
  6220             20  CF-MALE-MAX-WT             PIC 999.
  6221         16  FILLER                         PIC X(428).
  6222******************************************************************
  6223*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 114
* EL050.cbl
  6224******************************************************************
  6225     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6226         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6227             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6228             20  CF-SYS-LETTER-ID           PIC X(04).
  6229             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6230             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6231             20  CF-SYS-RESET-SW            PIC X(01).
  6232             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6233             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6234
  6235         16  FILLER                         PIC X(50).
  6236
  6237         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6238             20  CF-USER-ACTIVE-SW          PIC X(01).
  6239             20  CF-USER-LETTER-ID          PIC X(04).
  6240             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6241             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6242             20  CF-USER-RESET-SW           PIC X(01).
  6243             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6244             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6245             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6246
  6247         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 115
* EL050.cbl
  6249*    COPY ERCACCT.
  6250******************************************************************
  6251*                                                                *
  6252*                                                                *
  6253*                            ERCACCT                             *
  6254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6255*                            VMOD=2.031                          *
  6256*                                                                *
  6257*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6258*                                                                *
  6259*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6260*   VSAM ACCOUNT MASTER FILES.                                   *
  6261*                                                                *
  6262*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6263*                                                                *
  6264*   FILE TYPE = VSAM,KSDS                                        *
  6265*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6266*                                                                *
  6267*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6268*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6269*                                                                *
  6270*   LOG = NO                                                     *
  6271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6272*                                                                *
  6273*                                                                *
  6274******************************************************************
  6275*                   C H A N G E   L O G
  6276*
  6277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6278*-----------------------------------------------------------------
  6279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6280* EFFECTIVE    NUMBER
  6281*-----------------------------------------------------------------
  6282* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6283* 092705    2005050300006  PEMA  ADD SPP LEASES
  6284* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6285* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6286* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6287* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6288* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6289******************************************************************
  6290
  6291 01  ACCOUNT-MASTER.
  6292     12  AM-RECORD-ID                      PIC XX.
  6293         88  VALID-AM-ID                      VALUE 'AM'.
  6294
  6295     12  AM-CONTROL-PRIMARY.
  6296         16  AM-COMPANY-CD                 PIC X.
  6297         16  AM-MSTR-CNTRL.
  6298             20  AM-CONTROL-A.
  6299                 24  AM-CARRIER            PIC X.
  6300                 24  AM-GROUPING.
  6301                     28 AM-GROUPING-PREFIX PIC XXX.
  6302                     28 AM-GROUPING-PRIME  PIC XXX.
  6303                 24  AM-STATE              PIC XX.
  6304                 24  AM-ACCOUNT.
  6305                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6306                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 116
* EL050.cbl
  6307             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6308                                           PIC X(19).
  6309             20  AM-CNTRL-B.
  6310                 24  AM-EXPIRATION-DT      PIC XX.
  6311                 24  FILLER                PIC X(4).
  6312             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6313                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6314
  6315     12  AM-CONTROL-BY-VAR-GRP.
  6316         16  AM-COMPANY-CD-A1              PIC X.
  6317         16  AM-VG-CARRIER                 PIC X.
  6318         16  AM-VG-GROUPING                PIC X(6).
  6319         16  AM-VG-STATE                   PIC XX.
  6320         16  AM-VG-ACCOUNT                 PIC X(10).
  6321         16  AM-VG-DATE.
  6322             20  AM-VG-EXPIRATION-DT       PIC XX.
  6323             20  FILLER                    PIC X(4).
  6324         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6325                                           PIC 9(11)      COMP-3.
  6326     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6327         16  FILLER                        PIC X(10).
  6328         16  AM-VG-KEY3.
  6329             20  AM-VG3-ACCOUNT            PIC X(10).
  6330             20  AM-VG3-EXP-DT             PIC XX.
  6331         16  FILLER                        PIC X(4).
  6332     12  AM-MAINT-INFORMATION.
  6333         16  AM-LAST-MAINT-DT              PIC XX.
  6334         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6335         16  AM-LAST-MAINT-USER            PIC X(4).
  6336         16  FILLER                        PIC XX.
  6337
  6338     12  AM-EFFECTIVE-DT                   PIC XX.
  6339     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6340
  6341     12  AM-PREV-DATES  COMP-3.
  6342         16  AM-PREV-EXP-DT                PIC 9(11).
  6343         16  AM-PREV-EFF-DT                PIC 9(11).
  6344
  6345     12  AM-REPORT-CODE-1                  PIC X(10).
  6346     12  AM-REPORT-CODE-2                  PIC X(10).
  6347
  6348     12  AM-CITY-CODE                      PIC X(4).
  6349     12  AM-COUNTY-PARISH                  PIC X(6).
  6350
  6351     12  AM-NAME                           PIC X(30).
  6352     12  AM-PERSON                         PIC X(30).
  6353     12  AM-ADDRS                          PIC X(30).
  6354     12  AM-CITY.
  6355         16  AM-ADDR-CITY                  PIC X(28).
  6356         16  AM-ADDR-STATE                 PIC XX.
  6357     12  AM-ZIP.
  6358         16  AM-ZIP-PRIME.
  6359             20  AM-ZIP-PRI-1ST            PIC X.
  6360                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6361             20  FILLER                    PIC X(4).
  6362         16  AM-ZIP-PLUS4                  PIC X(4).
  6363     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6364         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 117
* EL050.cbl
  6365         16  AM-CAN-POSTAL-2               PIC XXX.
  6366         16  FILLER                        PIC XXX.
  6367     12  AM-TEL-NO.
  6368         16  AM-AREA-CODE                  PIC 999.
  6369         16  AM-TEL-PRE                    PIC 999.
  6370         16  AM-TEL-NBR                    PIC 9(4).
  6371     12  AM-TEL-LOC                        PIC X.
  6372         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6373         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6374
  6375     12  AM-COMM-STRUCTURE.
  6376         16  AM-DEFN-1.
  6377             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6378                 24  AM-AGT.
  6379                     28  AM-AGT-PREFIX     PIC X(4).
  6380                     28  AM-AGT-PRIME      PIC X(6).
  6381                 24  AM-COM-TYP            PIC X.
  6382                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6383                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6384                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6385                 24  AM-RECALC-LV-INDIC    PIC X.
  6386                 24  AM-RETRO-LV-INDIC     PIC X.
  6387                 24  AM-GL-CODES           PIC X.
  6388                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6389                 24  FILLER                PIC X(01).
  6390         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6391             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6392                 24  FILLER                PIC X(11).
  6393                 24  AM-L-COMA             PIC XXX.
  6394                 24  AM-J-COMA             PIC XXX.
  6395                 24  AM-A-COMA             PIC XXX.
  6396                 24  FILLER                PIC X(6).
  6397
  6398     12  AM-COMM-CHANGE-STATUS             PIC X.
  6399         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6400
  6401     12  AM-CSR-CODE                       PIC X(4).
  6402
  6403     12  AM-BILLING-STATUS                 PIC X.
  6404         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6405         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6406     12  AM-AUTO-REFUND-SW                 PIC X.
  6407         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6408         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6409     12  AM-GPCD                           PIC 99.
  6410     12  AM-IG                             PIC X.
  6411         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6412         88  AM-HAS-GROUP                     VALUE '2'.
  6413     12  AM-STATUS                         PIC X.
  6414         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6415         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6416         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6417         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6418         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6419         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6420     12  AM-REMIT-TO                       PIC 99.
  6421     12  AM-ID-NO                          PIC X(11).
  6422
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 118
* EL050.cbl
  6423     12  AM-CAL-TABLE                      PIC XX.
  6424     12  AM-LF-DEVIATION                   PIC XXX.
  6425     12  AM-AH-DEVIATION                   PIC XXX.
  6426     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6427     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6428     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6429     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6430     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6431     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6432
  6433     12  AM-USER-FIELDS.
  6434         16  AM-FLD-1                      PIC XX.
  6435         16  AM-FLD-2                      PIC XX.
  6436         16  AM-FLD-3                      PIC XX.
  6437         16  AM-FLD-4                      PIC XX.
  6438         16  AM-FLD-5                      PIC XX.
  6439
  6440     12  AM-1ST-PROD-DATE.
  6441         16  AM-1ST-PROD-YR                PIC XX.
  6442         16  AM-1ST-PROD-MO                PIC XX.
  6443         16  AM-1ST-PROD-DA                PIC XX.
  6444     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6445     12  AM-CERTS-PURGED-DATE.
  6446         16  AM-PUR-YR                     PIC XX.
  6447         16  AM-PUR-MO                     PIC XX.
  6448         16  AM-PUR-DA                     PIC XX.
  6449     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6450     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6451     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6452     12  AM-INACTIVE-DATE.
  6453         16  AM-INA-MO                     PIC 99.
  6454         16  AM-INA-DA                     PIC 99.
  6455         16  AM-INA-YR                     PIC 99.
  6456     12  AM-AR-HI-CERT-DATE                PIC XX.
  6457
  6458     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6459     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6460
  6461     12  AM-OB-PAYMENT-MODE                PIC X.
  6462         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6463         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6464         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6465         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6466
  6467     12  AM-AH-ONLY-INDICATOR              PIC X.
  6468         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6469         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6470
  6471     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6472
  6473     12  AM-OVER-SHORT.
  6474         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6475         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6476
  6477     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6478     12  AM-DCC-CLP-STATE                  PIC XX.
  6479
  6480     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 119
* EL050.cbl
  6481     12  AM-RECALC-REIN                    PIC X.
  6482
  6483     12  AM-REI-TABLE                      PIC XXX.
  6484     12  AM-REI-ET-LF                      PIC X.
  6485     12  AM-REI-ET-AH                      PIC X.
  6486     12  AM-REI-PE-LF                      PIC X.
  6487     12  AM-REI-PE-AH                      PIC X.
  6488     12  AM-REI-PRT-ST                     PIC X.
  6489     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6490     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6491     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6492     12  AM-REI-GROUP-A                    PIC X(6).
  6493     12  AM-REI-MORT                       PIC X(4).
  6494     12  AM-REI-PRT-OW                     PIC X.
  6495     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6496     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6497     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6498     12  AM-REI-GROUP-B                    PIC X(6).
  6499
  6500     12  AM-TRUST-TYPE                     PIC X(2).
  6501
  6502     12  AM-EMPLOYER-STMT-USED             PIC X.
  6503     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6504
  6505     12  AM-STD-AH-TYPE                    PIC XX.
  6506     12  AM-EARN-METHODS.
  6507         16  AM-EARN-METHOD-R              PIC X.
  6508             88 AM-REF-RL-R78                 VALUE 'R'.
  6509             88 AM-REF-RL-PR                  VALUE 'P'.
  6510             88 AM-REF-RL-MEAN                VALUE 'M'.
  6511             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6512         16  AM-EARN-METHOD-L              PIC X.
  6513             88 AM-REF-LL-R78                 VALUE 'R'.
  6514             88 AM-REF-LL-PR                  VALUE 'P'.
  6515             88 AM-REF-LL-MEAN                VALUE 'M'.
  6516             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6517         16  AM-EARN-METHOD-A              PIC X.
  6518             88 AM-REF-AH-R78                 VALUE 'R'.
  6519             88 AM-REF-AH-PR                  VALUE 'P'.
  6520             88 AM-REF-AH-MEAN                VALUE 'M'.
  6521             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6522             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6523             88 AM-REF-AH-NET                 VALUE 'N'.
  6524
  6525     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6526     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6527     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6528
  6529     12  AM-RET-Y-N                        PIC X.
  6530     12  AM-RET-P-E                        PIC X.
  6531     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6532     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6533     12  AM-RET-GRP                        PIC X(6).
  6534     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6535         16  AM-POOL-PRIME                 PIC XXX.
  6536         16  AM-POOL-SUB                   PIC XXX.
  6537     12  AM-RETRO-EARNINGS.
  6538         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 120
* EL050.cbl
  6539         16  AM-RET-EARN-L                 PIC X.
  6540         16  AM-RET-EARN-A                 PIC X.
  6541     12  AM-RET-ST-TAX-USE                 PIC X.
  6542         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6543         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6544     12  AM-RETRO-BEG-EARNINGS.
  6545         16  AM-RET-BEG-EARN-R             PIC X.
  6546         16  AM-RET-BEG-EARN-L             PIC X.
  6547         16  AM-RET-BEG-EARN-A             PIC X.
  6548     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6549     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6550
  6551     12  AM-USER-SELECT-OPTIONS.
  6552         16  AM-USER-SELECT-1              PIC X(10).
  6553         16  AM-USER-SELECT-2              PIC X(10).
  6554         16  AM-USER-SELECT-3              PIC X(10).
  6555         16  AM-USER-SELECT-4              PIC X(10).
  6556         16  AM-USER-SELECT-5              PIC X(10).
  6557
  6558     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6559
  6560     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6561
  6562     12  AM-RPT045A-SWITCH                 PIC X.
  6563         88  RPT045A-OFF                   VALUE 'N'.
  6564
  6565     12  AM-INSURANCE-LIMITS.
  6566         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6567         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6568
  6569     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6570         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6571
  6572     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6573         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6574         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6575
  6576     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6577
  6578     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6579     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6580     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6581     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6582     12  AM-DCC-UEF-STATE                  PIC XX.
  6583     12  FILLER                            PIC XXX.
  6584     12  AM-REPORT-CODE-3                  PIC X(10).
  6585*    12  FILLER                            PIC X(22).
  6586
  6587     12  AM-RESERVE-DATE.
  6588         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6589         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6590         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6591
  6592     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6593     12  AM-NOTIFICATION-TYPES.
  6594         16  AM-NOTIF-OF-LETTERS           PIC X.
  6595         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6596         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 121
* EL050.cbl
  6597         16  AM-NOTIF-OF-STATUS            PIC X.
  6598
  6599     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6600         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6601         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6602         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6603         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6604
  6605     12  AM-BENEFIT-CONTROLS.
  6606         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6607             20  AM-BENEFIT-CODE           PIC XX.
  6608             20  AM-BENEFIT-TYPE           PIC X.
  6609             20  AM-BENEFIT-REVISION       PIC XXX.
  6610             20  AM-BENEFIT-REM-TERM       PIC X.
  6611             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6612             20  FILLER                    PIC XX.
  6613         16  FILLER                        PIC X(80).
  6614
  6615     12  AM-TRANSFER-DATA.
  6616         16  AM-TRANSFERRED-FROM.
  6617             20  AM-TRNFROM-CARRIER        PIC X.
  6618             20  AM-TRNFROM-GROUPING.
  6619                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6620                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6621             20  AM-TRNFROM-STATE          PIC XX.
  6622             20  AM-TRNFROM-ACCOUNT.
  6623                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6624                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6625             20  AM-TRNFROM-DTE            PIC XX.
  6626         16  AM-TRANSFERRED-TO.
  6627             20  AM-TRNTO-CARRIER          PIC X.
  6628             20  AM-TRNTO-GROUPING.
  6629                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6630                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6631             20  AM-TRNTO-STATE            PIC XX.
  6632             20  AM-TRNTO-ACCOUNT.
  6633                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6634                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6635             20  AM-TRNTO-DTE              PIC XX.
  6636         16  FILLER                        PIC X(10).
  6637
  6638     12  AM-SAVED-REMIT-TO                 PIC 99.
  6639
  6640     12  AM-COMM-STRUCTURE-SAVED.
  6641         16  AM-DEFN-1-SAVED.
  6642             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6643                 24  AM-AGT-SV             PIC X(10).
  6644                 24  AM-COM-TYP-SV         PIC X.
  6645                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6646                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6647                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6648                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6649                 24  FILLER                PIC X.
  6650                 24  AM-GL-CODES-SV        PIC X.
  6651                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6652                 24  FILLER                PIC X.
  6653         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6654             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 122
* EL050.cbl
  6655                 24  FILLER                PIC X(11).
  6656                 24  AM-L-COMA-SV          PIC XXX.
  6657                 24  AM-J-COMA-SV          PIC XXX.
  6658                 24  AM-A-COMA-SV          PIC XXX.
  6659                 24  FILLER                PIC X(6).
  6660
  6661     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6662         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6663            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6664            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6665            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6666
  6667     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6668     12  FILLER                            PIC X(120).
  6669
  6670     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6671         16  AM-CONTROL-NAME               PIC X(30).
  6672         16  AM-EXECUTIVE-ONE.
  6673             20  AM-EXEC1-NAME             PIC X(15).
  6674             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6675                                                          COMP-3.
  6676             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6677                                                          COMP-3.
  6678         16  AM-EXECUTIVE-TWO.
  6679             20  AM-EXEC2-NAME             PIC X(15).
  6680             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6681                                                          COMP-3.
  6682             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6683                                                          COMP-3.
  6684
  6685     12  AM-RETRO-ADDITIONAL-DATA.
  6686         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6687         16  AM-RETRO-PREM-P-E             PIC X.
  6688         16  AM-RETRO-CLMS-P-I             PIC X.
  6689         16  AM-RETRO-RET-BRACKET-LF.
  6690             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6691                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6692                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6693             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6694                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6695                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6696             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6697                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6698                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6699         16  AM-RETRO-RET-BRACKET-AH.
  6700             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6701                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6702                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6703                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6704             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6705                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6706                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6707             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6708                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6709                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6710
  6711     12  AM-COMMENTS.
  6712         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 123
* EL050.cbl
  6713
  6714     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6715         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6716         16  AM-FLI-BILLING-CODE           PIC X.
  6717         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6718         16  AM-FLI-UNITED-IDENT           PIC X.
  6719         16  AM-FLI-INTEREST-LOST-DATA.
  6720             20  AM-FLI-BANK-NO            PIC X(5).
  6721             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6722             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6723             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6724         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6725             20  AM-FLI-AGT                PIC X(9).
  6726             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6727             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6728         16  FILLER                        PIC X(102).
  6729
  6730     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6731         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6732             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6733             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6734             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6735             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6736             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6737         16  FILLER                          PIC X(10).
  6738******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 124
* EL050.cbl
  6740*    COPY ERCREIN.
  6741******************************************************************
  6742*                                                                *
  6743*                            ERCREIN                             *
  6744*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6745*                            VMOD=2.010                          *
  6746*                                                                *
  6747*   ONLINE CREDIT SYSTEM                                         *
  6748*                                                                *
  6749*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6750*                                                                *
  6751*   FILE TYPE = VSAM,KSDS                                        *
  6752*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6753*                                                                *
  6754*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6755*       ALTERNATE PATH = NONE                                    *
  6756*                                                                *
  6757*   LOG = NO                                                     *
  6758*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6759*                                                                *
  6760******************************************************************
  6761*                   C H A N G E   L O G
  6762*
  6763* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6764*-----------------------------------------------------------------
  6765*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6766* EFFECTIVE    NUMBER
  6767*-----------------------------------------------------------------
  6768* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6769* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6770******************************************************************
  6771 01  REINSURANCE-RECORD.
  6772     12  RE-RECORD-ID                      PIC XX.
  6773         88  VALID-RE-ID                      VALUE 'RE'.
  6774
  6775     12  RE-CONTROL-PRIMARY.
  6776         16  RE-COMPANY-CD                 PIC X.
  6777         16  RE-KEY.
  6778             20  RE-CODE                   PIC X.
  6779                 88  RE-TABLE-RECORD          VALUE 'A'.
  6780                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6781             20  RE-TABLE                  PIC XXX.
  6782             20  FILLER                    PIC XXX.
  6783         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6784             20  FILLER                    PIC X.
  6785             20  RE-COMPANY.
  6786                 24  RE-COMP-PRIME         PIC XXX.
  6787                 24  RE-COMP-SUB           PIC XXX.
  6788
  6789     12  RE-MAINT-INFORMATION.
  6790         16  RE-LAST-MAINT-DT              PIC XX.
  6791         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6792         16  RE-LAST-MAINT-USER            PIC X(4).
  6793         16  FILLER                        PIC X(10).
  6794
  6795     12  RE-TABLE-DATA.
  6796         16  RE-100-COMP                   PIC 99.
  6797
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 125
* EL050.cbl
  6798         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6799             20  RE-REI-COMP-NO.
  6800                 24  RE-REI-COMP           PIC XXX.
  6801                 24  RE-REI-COMP-SUB       PIC XXX.
  6802             20  RE-LF-QC                  PIC X.
  6803             20  RE-AH-QC                  PIC X.
  6804             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6805             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6806             20  RE-LFAGE-LO               PIC 99.
  6807             20  RE-LFAGE-HI               PIC 99.
  6808             20  RE-AHAGE-LO               PIC 99.
  6809             20  RE-AHAGE-HI               PIC 99.
  6810             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6811             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6812             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6813             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6814             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6815             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6816             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6817             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6818             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6819             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6820             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6821             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6822             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6823             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6824             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6825             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6826             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6827             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6828             20  RE-LF-BEN-CODE            PIC X.
  6829             20  RE-AH-BEN-CODE            PIC X.
  6830             20  RE-INTERACTIVE            PIC X.
  6831             20  RE-REMAINING              PIC X.
  6832             20  RE-LF-RUNOFF-SW           PIC X.
  6833             20  RE-AH-RUNOFF-SW           PIC X.
  6834             20  FILLER                    PIC X(19).
  6835
  6836         16  RE-COMP-INFO-END              PIC X(6).
  6837         16  RE-NSP-ST-CD-LF               PIC XX.
  6838         16  RE-NSP-ST-CD-AH               PIC XX.
  6839         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6840             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6841
  6842         16  FILLER                        PIC X(27).
  6843
  6844     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6845         16  RE-NAME                       PIC X(30).
  6846         16  RE-LF-PE                      PIC X.
  6847         16  RE-AH-PE                      PIC X.
  6848         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6849         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6850         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6851         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6852         16  RE-PRT-ST                     PIC X.
  6853         16  RE-PRT-OW                     PIC X.
  6854         16  RE-MORT-CODE                  PIC X(4).
  6855         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 126
* EL050.cbl
  6856         16  RE-ZERO-LF-FEE                PIC X.
  6857         16  RE-ZERO-AH-FEE                PIC X.
  6858         16  RE-CEDE-NAME                  PIC X(30).
  6859         16  RE-LF-COMM                    PIC X.
  6860         16  RE-AH-COMM                    PIC X.
  6861         16  RE-LF-TAX                     PIC X.
  6862         16  RE-AH-TAX                     PIC X.
  6863         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6864         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6865         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6866
  6867         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6868             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6869
  6870         16  RE-LF-CEDING-FEE-BRACKETS.
  6871             20  RE-LF-FEE-METHOD          PIC X.
  6872                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6873                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6874                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6875                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6876             20  RE-LF-FEE-BASIS           PIC X.
  6877                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6878                 88  RE-LF-NET-CEDED               VALUE '2'.
  6879                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6880                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6881                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6882                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6883                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6884                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6885             20  FILLER                    PIC XXX.
  6886             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6887                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6888                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6889
  6890         16  RE-AH-CEDING-FEE-BRACKETS.
  6891             20  RE-AH-FEE-METHOD          PIC X.
  6892                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6893                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6894                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6895                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6896             20  RE-AH-FEE-BASIS           PIC X.
  6897                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6898                 88  RE-AH-NET-CEDED               VALUE '2'.
  6899                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6900                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6901                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6902                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6903                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6904                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6905             20  FILLER                    PIC XXX.
  6906             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6907                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6908                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6909
  6910         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6911
  6912         16  RE-OLD-CEDING-STMT            PIC X.
  6913
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 127
* EL050.cbl
  6914         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6915         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6916         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6917         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6918         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6919         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6920         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6921         16  RE-MORT-SW                    PIC X.
  6922         16  RE-CEDING-TYPE-FLAG           PIC X.
  6923             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6924             88  RE-CEDED                          VALUE 'C'.
  6925             88  RE-ASSUMED                        VALUE 'A'.
  6926             88  RE-PHANTOM                        VALUE 'P'.
  6927
  6928         16  RE-CEDING-STMT-OPT-A          PIC X.
  6929             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6930         16  RE-CEDING-STMT-OPT-B          PIC X.
  6931             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6932         16  RE-CEDING-STMT-OPT-C          PIC X.
  6933             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6934         16  RE-CEDING-STMT-OPT-D          PIC X.
  6935             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6936         16  RE-CEDING-STMT-OPT-E          PIC X.
  6937             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6938
  6939         16  RE-PRT-CRSV                   PIC X.
  6940
  6941         16  RE-GL-CENTER                  PIC X(4).
  6942
  6943         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6944
  6945         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6946
  6947         16  RE-EARN-STOP-CODE             PIC X.
  6948             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6949             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6950
  6951         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6952             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6953
  6954         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6955         16  FILLER                        PIC X(2281).
  6956
  6957         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6958
  6959******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 128
* EL050.cbl
  6961*    COPY ERCCTBL.
  6962******************************************************************
  6963*                                                                *
  6964*                                                                *
  6965*                            ERCCTBL                             *
  6966*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6967*                            VMOD=2.003
  6968*                                                                *
  6969*   ONLINE CREDIT SYSTEM                                         *
  6970*                                                                *
  6971*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  6972*                                                                *
  6973*   FILE TYPE = VSAM,KSDS                                        *
  6974*   RECORD SIZE = 200   RECFORM = FIXED                          *
  6975*                                                                *
  6976*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  6977*       ALTERNATE PATH = NONE                                    *
  6978*                                                                *
  6979*   LOG = NO                                                     *
  6980*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6981*                                                                *
  6982*                                                                *
  6983******************************************************************
  6984
  6985 01  COMM-TABLE-RECORD.
  6986     12  CT-RECORD-ID                      PIC XX.
  6987         88  VALID-CT-ID                      VALUE 'CT'.
  6988
  6989     12  CT-CONTROL-PRIMARY.
  6990         16  CT-COMPANY-CD                 PIC X.
  6991         16  CT-TABLE                      PIC XXX.
  6992         16  CT-CNTRL-2.
  6993             20  CT-BEN-TYPE               PIC X.
  6994             20  CT-BEN-CODE               PIC XX.
  6995
  6996     12  CT-MAINT-INFORMATION.
  6997         16  CT-LAST-MAINT-DT              PIC XX.
  6998         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6999         16  CT-LAST-MAINT-USER            PIC X(4).
  7000         16  FILLER                        PIC X(31).
  7001
  7002     12  CT-LIMITS.
  7003         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7004
  7005         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7006
  7007         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7008
  7009     12  CT-RATES.
  7010         16  CT-RTX          OCCURS 27 TIMES.
  7011             20  CT-RT                     PIC SV9(5)     COMP-3.
  7012             20  CT-RT-R   REDEFINES
  7013                 CT-RT                     PIC XXX.
  7014
  7015     12  FILLER                            PIC  X(42).
  7016
  7017******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 129
* EL050.cbl
  7019*    COPY ERCFORM.
  7020******************************************************************
  7021*                                                                *
  7022*                                                                *
  7023*                            ERCFORM.                            *
  7024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7025*                            VMOD=2.003                          *
  7026*                                                                *
  7027*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7028*                                                                *
  7029*    FILE TYPE = VSAM,KSDS                                       *
  7030*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7031*                                                                *
  7032*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7033*                                                                *
  7034*    LOG = YES                                                   *
  7035*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7036******************************************************************
  7037 01  FORM-MASTER.
  7038    12  FO-RECORD-ID                 PIC X(02).
  7039        88  VALID-FO-ID                  VALUE 'FO'.
  7040
  7041    12  FO-CONTROL-PRIMARY.
  7042        16  FO-COMPANY-CD            PIC X(01).
  7043        16  FO-STATE                 PIC X(02).
  7044        16  FO-FORM-ID               PIC X(12).
  7045        16  FO-FORM-EXP-DT           PIC X(02).
  7046
  7047    12  FO-POLICY-FORM-DATA.
  7048        16  FO-IND-GRP-CD            PIC X(01).
  7049        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7050        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7051        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7052        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7053        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7054        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7055        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7056        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7057        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7058        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7059        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7060        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7061        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7062        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7063        16  FO-APP-CERT-USE-CD       PIC X(01).
  7064
  7065    12  FILLER                       PIC X(29).
  7066
  7067    12  FO-FORM-PLAN-TABLE.
  7068        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7069            20  FO-PLAN-TYPE         PIC X(01).
  7070            20  FO-PLAN-ID           PIC X(02).
  7071            20  FO-PLAN-TERM         PIC 9(03).
  7072            20  FO-PLAN-REFUND-METHOD
  7073                                     PIC X.
  7074
  7075    12  FILLER                       PIC X(30).
  7076
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 130
* EL050.cbl
  7077    12  FO-COMMENTS-AREA.
  7078        16  FO-COMMENT-LINE-1        PIC X(78).
  7079
  7080    12  FILLER                       PIC X(20).
  7081
  7082    12  FO-MAINT-INFORMATION.
  7083        16  FO-LAST-MAINT-DT         PIC X(02).
  7084        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7085        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 131
* EL050.cbl
  7087*    COPY ELCMSTR.
  7088******************************************************************
  7089*                                                                *
  7090*                            ELCMSTR.                            *
  7091*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7092*                            VMOD=2.012                          *
  7093*                                                                *
  7094*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7095*                                                                *
  7096*   FILE TYPE = VSAM,KSDS                                        *
  7097*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7098*                                                                *
  7099*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7100*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7101*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7102*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7103*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7104*                                                 RKP=75,LEN=21  *
  7105*                                                                *
  7106*   **** NOTE ****                                               *
  7107*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7108*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7109*                                                                *
  7110*   LOG = YES                                                    *
  7111*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7112******************************************************************
  7113*                   C H A N G E   L O G
  7114*
  7115* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7116*-----------------------------------------------------------------
  7117*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7118* EFFECTIVE    NUMBER
  7119*-----------------------------------------------------------------
  7120* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7121* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7122******************************************************************
  7123 01  CLAIM-MASTER.
  7124     12  CL-RECORD-ID                PIC XX.
  7125         88  VALID-CL-ID         VALUE 'CL'.
  7126
  7127     12  CL-CONTROL-PRIMARY.
  7128         16  CL-COMPANY-CD           PIC X.
  7129         16  CL-CARRIER              PIC X.
  7130         16  CL-CLAIM-NO             PIC X(7).
  7131         16  CL-CERT-NO.
  7132             20  CL-CERT-PRIME       PIC X(10).
  7133             20  CL-CERT-SFX         PIC X.
  7134
  7135     12  CL-CONTROL-BY-NAME.
  7136         16  CL-COMPANY-CD-A1        PIC X.
  7137         16  CL-INSURED-LAST-NAME    PIC X(15).
  7138         16  CL-INSURED-NAME.
  7139             20  CL-INSURED-1ST-NAME PIC X(12).
  7140             20  CL-INSURED-MID-INIT PIC X.
  7141
  7142     12  CL-CONTROL-BY-SSN.
  7143         16  CL-COMPANY-CD-A2        PIC X.
  7144         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 132
* EL050.cbl
  7145             20  CL-SSN-STATE        PIC XX.
  7146             20  CL-SSN-ACCOUNT      PIC X(6).
  7147             20  CL-SSN-LN3          PIC X(3).
  7148
  7149     12  CL-CONTROL-BY-CERT-NO.
  7150         16  CL-COMPANY-CD-A4        PIC X.
  7151         16  CL-CERT-NO-A4.
  7152             20  CL-CERT-A4-PRIME    PIC X(10).
  7153             20  CL-CERT-A4-SFX      PIC X.
  7154
  7155     12  CL-CONTROL-BY-CCN.
  7156         16  CL-COMPANY-CD-A5        PIC X.
  7157         16  CL-CCN-A5.
  7158             20  CL-CCN.
  7159                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7160                 24  CL-CCN-PRIME-A5 PIC X(12).
  7161             20  CL-CCN-FILLER-A5    PIC X(4).
  7162
  7163     12  CL-INSURED-PROFILE-DATA.
  7164         16  CL-INSURED-BIRTH-DT     PIC XX.
  7165         16  CL-INSURED-SEX-CD       PIC X.
  7166             88  INSURED-IS-MALE        VALUE 'M'.
  7167             88  INSURED-IS-FEMALE      VALUE 'F'.
  7168             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7169         16  CL-INSURED-OCC-CD       PIC X(6).
  7170         16  FILLER                  PIC X(5).
  7171
  7172     12  CL-PROCESSING-INFO.
  7173         16  CL-PROCESSOR-ID         PIC X(4).
  7174         16  CL-CLAIM-STATUS         PIC X.
  7175             88  CLAIM-IS-OPEN          VALUE 'O'.
  7176             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7177         16  CL-CLAIM-TYPE           PIC X.
  7178*            88  AH-CLAIM               VALUE 'A'.
  7179*            88  LIFE-CLAIM             VALUE 'L'.
  7180*            88  PROPERTY-CLAIM         VALUE 'P'.
  7181*            88  IUI-CLAIM              VALUE 'I'.
  7182*            88  GAP-CLAIM              VALUE 'G'.
  7183         16  CL-CLAIM-PREM-TYPE      PIC X.
  7184             88  SINGLE-PREMIUM         VALUE '1'.
  7185             88  O-B-COVERAGE           VALUE '2'.
  7186             88  OPEN-END-COVERAGE      VALUE '3'.
  7187         16  CL-INCURRED-DT          PIC XX.
  7188         16  CL-REPORTED-DT          PIC XX.
  7189         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7190         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7191         16  CL-LAST-PMT-DT          PIC XX.
  7192         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7193         16  CL-PAID-THRU-DT         PIC XX.
  7194         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7195         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7196         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7197         16  CL-PMT-CALC-METHOD      PIC X.
  7198             88  CL-360-DAY-YR          VALUE '1'.
  7199             88  CL-365-DAY-YR          VALUE '2'.
  7200             88  CL-FULL-MONTHS         VALUE '3'.
  7201         16  CL-CAUSE-CD             PIC X(6).
  7202
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 133
* EL050.cbl
  7203         16  CL-PRIME-CERT-NO.
  7204             20  CL-PRIME-CERT-PRIME PIC X(10).
  7205             20  CL-PRIME-CERT-SFX   PIC X.
  7206
  7207         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7208             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7209             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7210
  7211         16  CL-MICROFILM-NO         PIC X(10).
  7212         16  CL-PROG-FORM-TYPE       PIC X.
  7213         16  CL-LAST-ADD-ON-DT       PIC XX.
  7214
  7215         16  CL-LAST-REOPEN-DT       PIC XX.
  7216         16  CL-LAST-CLOSE-DT        PIC XX.
  7217         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7218             88  FINAL-PAID             VALUE '1'.
  7219             88  CLAIM-DENIED           VALUE '2'.
  7220             88  AUTO-CLOSE             VALUE '3'.
  7221             88  MANUAL-CLOSE           VALUE '4'.
  7222             88  BENEFITS-CHANGED       VALUE 'C'.
  7223             88  SETUP-ERRORS           VALUE 'E'.
  7224         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7225         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7226         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7227             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7228         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7229         16  FILLER                  PIC X.
  7230
  7231     12  CL-CERTIFICATE-DATA.
  7232         16  CL-CERT-ORIGIN          PIC X.
  7233             88  CERT-WAS-ONLINE        VALUE '1'.
  7234             88  CERT-WAS-CREATED       VALUE '2'.
  7235             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7236         16  CL-CERT-KEY-DATA.
  7237             20  CL-CERT-CARRIER     PIC X.
  7238             20  CL-CERT-GROUPING    PIC X(6).
  7239             20  CL-CERT-STATE       PIC XX.
  7240             20  CL-CERT-ACCOUNT.
  7241                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7242                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7243             20  CL-CERT-EFF-DT      PIC XX.
  7244
  7245     12  CL-STATUS-CONTROLS.
  7246         16  CL-PRIORITY-CD          PIC X.
  7247             88  CONFIDENTIAL-DATA      VALUE '8'.
  7248             88  HIGHEST-PRIORITY       VALUE '9'.
  7249         16  CL-SUPV-ATTN-CD         PIC X.
  7250             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7251             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7252         16  CL-PURGED-DT            PIC XX.
  7253         16  CL-RESTORED-DT          PIC XX.
  7254         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7255         16  CL-NEXT-RESEND-DT       PIC XX.
  7256         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7257         16  FILLER                  PIC XX.
  7258         16  CL-LAST-MAINT-DT        PIC XX.
  7259         16  CL-LAST-MAINT-USER      PIC X(4).
  7260         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 134
* EL050.cbl
  7261         16  CL-LAST-MAINT-TYPE      PIC X.
  7262             88  CLAIM-SET-UP           VALUE ' '.
  7263             88  PAYMENT-MADE           VALUE '1'.
  7264             88  LETTER-SENT            VALUE '2'.
  7265             88  MASTER-WAS-ALTERED     VALUE '3'.
  7266             88  MASTER-WAS-RESTORED    VALUE '4'.
  7267             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7268             88  FILE-CONVERTED         VALUE '6'.
  7269             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7270             88  ERROR-CORRECTION       VALUE 'E'.
  7271         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7272         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7273         16  CL-BENEFICIARY          PIC X(10).
  7274         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7275         16  CL-DENIAL-TYPE          PIC X.
  7276             88  CL-TYPE-DENIAL          VALUE '1'.
  7277             88  CL-TYPE-RESCISSION      VALUE '2'.
  7278             88  CL-TYPE-REFORMATION     VALUE '3'.
  7279             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7280             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7281         16  FILLER                  PIC X(5).
  7282
  7283     12  CL-TRAILER-CONTROLS.
  7284         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7285             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7286             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7287             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7288         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7289         16  FILLER                  PIC XX.
  7290         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7291         16  CL-ADDRESS-TRAILER-CNT.
  7292             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7293                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7294             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7295                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7296             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7297                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7298             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7299                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7300             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7301                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7302             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7303                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7304             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7305                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7306
  7307     12  CL-CV-REFERENCE-NO.
  7308         16  CL-CV-REFNO-PRIME       PIC X(18).
  7309         16  CL-CV-REFNO-SFX         PIC XX.
  7310
  7311     12  CL-FILE-LOCATION            PIC X(4).
  7312
  7313     12  CL-PROCESS-ERRORS.
  7314         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7315             88  NO-FATAL-ERRORS        VALUE ZERO.
  7316         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7317             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7318
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 135
* EL050.cbl
  7319     12  CL-PRODUCT-CD               PIC X.
  7320
  7321     12  CL-CURRENT-KEY-DATA.
  7322         16  CL-CURRENT-CARRIER      PIC X.
  7323         16  CL-CURRENT-GROUPING     PIC X(6).
  7324         16  CL-CURRENT-STATE        PIC XX.
  7325         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7326
  7327     12  CL-ASSOCIATES               PIC X.
  7328         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7329         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7330         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7331         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7332
  7333     12  CL-ACTIVITY-CODE            PIC 99.
  7334     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7335     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7336
  7337     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7338     12  CL-LAG-REPORT-CODE          PIC 9.
  7339     12  CL-LOAN-TYPE                PIC XX.
  7340     12  CL-LEGAL-STATE              PIC XX.
  7341
  7342*    12  FILLER                      PIC X(5).
  7343     12  CL-YESNOSW                  PIC X.
  7344     12  FILLER                      PIC X(4).
  7345
  7346 01  PLAN-RECORDS.
  7347     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7348     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7349
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 136
* EL050.cbl
  7351 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7352                          ACCOUNT-MASTER REINSURANCE-RECORD
  7353                          COMM-TABLE-RECORD FORM-MASTER
  7354                          CLAIM-MASTER PLAN-RECORDS.
  7355 0000-DFHEXIT SECTION.
  7356     MOVE '9#                    $   ' TO DFHEIV0.
  7357     MOVE 'EL050' TO DFHEIV1.
  7358     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7359
  7360     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7361
  7362
  7363* EXEC CICS  HANDLE CONDITION
  7364*           ERROR    (9300-ABEND)
  7365*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7366*    END-EXEC.
  7367*    MOVE '"$.J                  ! " #00007358' TO DFHEIV0
  7368     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7370     MOVE X'2220233030303037333538' TO DFHEIV0(25:11)
  7371     CALL 'kxdfhei1' USING DFHEIV0
  7372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7373
  7374
  7375 0000-COPY-PROCEDURE-DIV.
  7376*                          COPY ELC50PD.
  7377******************************************************************
  7378*                                                                *
  7379*                            ELC50PD                             *
  7380*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7381*                            VMOD=2.188                          *
  7382*                                                                *
  7383******************************************************************
  7384*                   C H A N G E   L O G
  7385*
  7386* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7387*-----------------------------------------------------------------
  7388*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7389* EFFECTIVE    NUMBER
  7390*-----------------------------------------------------------------
  7391* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7392* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7393* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7394*                             2709 AND 2718
  7395* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7396* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7397* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7398* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7399* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7400*                                IS OPEN OR CNC DT < PD THRU
  7401* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7402* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7403* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7404* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7405* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7406* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7407* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7408* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 137
* EL050.cbl
  7409* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7410* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7411* 020906                   PEMA  EXPAND LOAN OFFICER
  7412* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7413* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7414* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7415* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7416* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7417* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7418* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7419* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7420* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7421* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7422* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7423* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7424* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7425* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7426* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7427* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7428* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7429* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7430* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7431* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7432* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7433* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7434* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7435* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7436* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7437*                                UPDATE VIN ON CERT TRAILER
  7438* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7439* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7440* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7441* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7442* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7443* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7444* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7445* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7446* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7447* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7448* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7449* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7450* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7451* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7452* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7453* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7454* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7455* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7456* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7457* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7458* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7459* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7460* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7461* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7462* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7463* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7464* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7465* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7466* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 138
* EL050.cbl
  7467* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7468* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7469* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7470* 032912  CR2011110200001  PEMA  AHL CHANGES
  7471* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7472******************************************************************
  7473************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7474******************************************************************
  7475
  7476     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7477
  7478     MOVE SPACES                 TO PB-FATAL-FLAG
  7479                                    PB-FORCE-ER-CD
  7480                                    PB-WARN-ER-CD
  7481                                    PB-OUT-BAL-CD.
  7482
  7483     MOVE SPACE                  TO WS-IG-OVRD-AH
  7484                                    WS-IG-OVRD-LF
  7485                                    WS-IG-OVRD-AM
  7486                                    WS-IG-OVRD
  7487                                    WS-IG-OVRD-AH-PL
  7488                                    WS-IG-OVRD-LF-PL
  7489                                    WS-IG-OVRD-AH-BEN
  7490                                    WS-IG-OVRD-LF-BEN.
  7491
  7492******************************************************************
  7493*************       INITIALIZE COMMON ERRORS       ***************
  7494******************************************************************
  7495
  7496     MOVE +0                     TO PB-NO-OF-ERRORS.
  7497     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7498
  7499******************************************************************
  7500
  7501     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7502     SET JULIAN-TO-BIN           TO TRUE.
  7503*    MOVE 5                      TO DC-OPTION-CODE.
  7504     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7505     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7506
  7507     MOVE ZERO                   TO  SUB4.
  7508
  7509 0040-INITIALIZE-GA-BILL-DT.
  7510
  7511     ADD +1                      TO  SUB4.
  7512
  7513     IF  SUB4 GREATER THAN +5
  7514         GO TO 0050-CHECK-CNTL-FOUND.
  7515
  7516     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7517         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7518
  7519     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7520
  7521 0050-CHECK-CNTL-FOUND.
  7522
  7523     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7524        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 139
* EL050.cbl
  7525                                         WS-AH-REM-TERM-CALC
  7526                                         EC-CO-REM-TERM-CALC
  7527        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7528        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7529        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7530                                         WS-TOL-AH-CLAIM
  7531        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7532                                         WS-TOL-AH-PREM
  7533                                         EC-CO-TOL-PREM
  7534        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7535                                         WS-TOL-AH-REFUND
  7536                                         EC-CO-TOL-REFUND
  7537        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7538                                         WS-AH-REFUND-OVS-AMT
  7539                                         EC-CO-OVR-SHT-AMT
  7540        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7541                                         WS-TOL-AH-PREM-PCT
  7542                                         EC-CO-TOL-PREM-PCT
  7543        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7544                                         WS-TOL-AH-REFUND-PCT
  7545                                         EC-CO-TOL-REFUND-PCT
  7546        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7547                                         WS-AH-REFUND-OVS-PCT
  7548                                         EC-CO-OVR-SHT-PCT
  7549        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7550        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7551        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7552        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7553        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7554        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7555        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7556        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7557        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7558        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7559        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7560        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7561                                         EC-CO-MONTH-END-DT
  7562        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7563          GO TO 0100-READ-ACCT.
  7564
  7565     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7566     MOVE SPACES                 TO CNTL-ACCESS.
  7567     MOVE '1'                    TO CNTL-REC-TYPE.
  7568     MOVE +0                     TO CNTL-SEQ-NO.
  7569
  7570     MOVE '1' TO RC-SW-1.
  7571     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7572     IF NOT CF-COMPANY-MASTER
  7573         MOVE ZEROS             TO WK-CO-TOL-PREM
  7574                                   WK-CO-TOL-CLAIM
  7575                                   WK-CO-TOL-REFUND
  7576                                   WK-REFUND-OVS-AMT
  7577                                   WK-REFUND-OVS-PCT
  7578                                   WK-CO-TOL-PREM-PCT
  7579                                   WK-CO-TOL-REFUND-PCT
  7580                                   WK-DEFAULT-APR
  7581                                   WK-CO-MAX-CAP
  7582        MOVE SPACES             TO WK-CR-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 140
* EL050.cbl
  7583                                   WK-CR-R78-METHOD
  7584                                   WK-CO-REF-REJECT-SW
  7585                                   WK-CO-PREM-REJECT-SW
  7586                                   WK-REM-TRM-CALC-OPTION
  7587                                   WK-BIRTH-DATE-INPUT
  7588                                   WK-JOINT-AGE-INPUT
  7589        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7590        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7591        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7592        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7593          GO TO 0099-COMPANY-NOT-FOUND.
  7594
  7595     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7596        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7597     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7598        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7599     IF CF-CO-TOL-CAP NOT NUMERIC
  7600        MOVE +0                    TO CF-CO-TOL-CAP.
  7601     IF CF-DEFAULT-APR NOT NUMERIC
  7602        MOVE +0                    TO CF-DEFAULT-APR.
  7603
  7604     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7605     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7606     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7607     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7608     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7609     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7610     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7611     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7612     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7613     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7614     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7615     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7616
  7617     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7618          CF-CO-OVR-SHT-AMT > +0
  7619        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7620
  7621     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7622          CF-CO-OVR-SHT-PCT > +0
  7623        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7624
  7625     IF CF-VALID-REM-TRM-OPTION
  7626         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7627     ELSE
  7628         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7629
  7630     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7631     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7632     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7633     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7634
  7635     GO TO 0050-CHECK-CNTL-FOUND.
  7636
  7637 0099-COMPANY-NOT-FOUND.
  7638
  7639     MOVE ER-2616                TO WS-ERROR.
  7640     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 141
* EL050.cbl
  7641
  7642 0100-READ-ACCT.
  7643
  7644     MOVE SPACES                 TO DATE-RANGE-SW.
  7645
  7646     IF WK-ACCT-ADDR = ZEROS
  7647        GO TO 0102-ACCT-GETMAIN.
  7648
  7649     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7650     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7651     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7652
  7653     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7654        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7655        GO TO 0105-READ-ACCT
  7656     END-IF
  7657
  7658     IF PB-CARRIER NOT = SPACES
  7659        IF PB-CARRIER NOT = AM-VG-CARRIER
  7660           GO TO 0105-READ-ACCT.
  7661
  7662     IF PB-STATE NOT = SPACES
  7663        IF PB-STATE NOT = AM-VG-STATE
  7664           GO TO 0105-READ-ACCT.
  7665
  7666     IF PB-GROUPING NOT = SPACES
  7667        IF PB-GROUPING NOT = AM-VG-GROUPING
  7668           GO TO 0105-READ-ACCT.
  7669
  7670     MOVE 'X'                 TO DATE-RANGE-SW.
  7671
  7672     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7673        MOVE 'X'                 TO DATE-RANGE-SW
  7674        GO TO 0105-READ-ACCT.
  7675
  7676     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7677        GO TO 0105-READ-ACCT.
  7678
  7679     GO TO 0180-ACCOUNT-FOUND.
  7680
  7681 0102-ACCT-GETMAIN.
  7682     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7683     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7684
  7685 0105-READ-ACCT.
  7686     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7687     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7688     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7689     MOVE PB-STATE               TO ACCT-STATE.
  7690     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7691     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7692
  7693     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7694
  7695     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7696
  7697 0110-FIND-ACCT-TOLERANCES-LOOP.
  7698     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 142
* EL050.cbl
  7699
  7700     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7701        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7702        GO TO 0199-ACCT-NOT-FOUND
  7703     END-IF
  7704     IF PB-CARRIER NOT = SPACES
  7705        IF PB-CARRIER NOT = AM-VG-CARRIER
  7706           GO TO 0199-ACCT-NOT-FOUND.
  7707
  7708     IF PB-STATE NOT = SPACES
  7709        IF PB-STATE NOT = AM-VG-STATE
  7710           GO TO 0199-ACCT-NOT-FOUND.
  7711
  7712     IF PB-GROUPING NOT = SPACES
  7713        IF PB-GROUPING NOT = AM-VG-GROUPING
  7714           GO TO 0199-ACCT-NOT-FOUND.
  7715
  7716     MOVE 'X'                    TO DATE-RANGE-SW.
  7717
  7718     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7719        MOVE 'X'                 TO DATE-RANGE-SW
  7720        GO TO 0199-ACCT-NOT-FOUND.
  7721
  7722     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7723        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7724
  7725 0180-ACCOUNT-FOUND.
  7726     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7727     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7728     MOVE AM-STATE               TO PB-SV-STATE.
  7729     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7730
  7731     IF AM-CANCEL-FEE  NOT NUMERIC
  7732        MOVE ZEROS TO AM-CANCEL-FEE.
  7733
  7734     IF AM-MAX-MON-BEN NOT NUMERIC
  7735        MOVE ZEROS TO AM-MAX-MON-BEN.
  7736
  7737     IF AM-MAX-TOT-BEN NOT NUMERIC
  7738        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7739
  7740     IF AM-CLP-TOL-PCT NOT NUMERIC
  7741        MOVE +0                  TO AM-CLP-TOL-PCT
  7742     END-IF
  7743     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7744        MOVE +0                  TO AM-SPP-LEASE-COMM
  7745     END-IF
  7746     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7747        MOVE ER-2611             TO   WS-ERROR
  7748        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7749
  7750     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7751        MOVE ER-2621             TO   WS-ERROR
  7752        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7753
  7754     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7755        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7756        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 143
* EL050.cbl
  7757        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7758         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7759
  7760     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7761     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7762     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7763     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7764     IF AM-CLP-TOL-PCT NOT = ZEROS
  7765        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7766     END-IF
  7767     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7768        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7769     END-IF
  7770*    IF PB-COMPANY-ID = 'DCC'
  7771*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7772*                                   WS-ADMIN-FEES
  7773*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7774*          (SUB5 > +10)
  7775*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7776*             AND (AM-A-COM (SUB5) NUMERIC)
  7777*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7778*                + (AM-A-COM (SUB5) * 1000)
  7779*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7780*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7781*                + (AM-A-COM (SUB5) * 1000)
  7782*             END-IF
  7783*             IF AM-COM-TYP (SUB5) = 'N'
  7784*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7785*                + (AM-A-COM (SUB5) * 1000)
  7786*             END-IF
  7787*          END-IF
  7788*       END-PERFORM
  7789*    END-IF
  7790     IF (PB-COMPANY-ID = 'DCC')
  7791        AND (PB-ISSUE)
  7792        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7793        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7794           (SUB5 > +10)
  7795           MOVE +0 TO WS-WK-RATE
  7796           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7797              IF (AM-A-COM (SUB5) NUMERIC)
  7798                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7799                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7800              ELSE
  7801                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7802                 IF PB-ISSUE
  7803                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7804                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7805                 ELSE
  7806                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7807                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7808                 END-IF
  7809                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7810                 MOVE ZEROS             TO WS-SUB1
  7811                                           WS-COMMISSION
  7812                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7813                 MOVE '0530'               TO CTBL-SW
  7814                 MOVE ' '                  TO WS-CTBL-READ-SW
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 144
* EL050.cbl
  7815                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7816                 IF FIRST-TIME-THROUGH
  7817                    MOVE 'AA'              TO CTBL-BEN-CODE
  7818                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7819                 END-IF
  7820                 IF CTBL-TABLE-FOUND
  7821                    IF PB-ISSUE
  7822                       COMPUTE WS-COMM-CK-AMT =
  7823                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7824                    ELSE
  7825                       COMPUTE WS-COMM-CK-AMT =
  7826                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7827                    END-IF
  7828                    PERFORM 8800-GET-COMP-RATE
  7829                              THRU 8800-EXIT
  7830                 END-IF
  7831              END-IF
  7832              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7833                + (WS-WK-RATE * 1000)
  7834           END-IF
  7835        END-PERFORM
  7836     END-IF
  7837     IF PB-COMPANY-ID EQUAL 'CRI'
  7838         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7839
  7840     IF PB-COMPANY-ID EQUAL 'NCL'
  7841         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7842     END-IF
  7843
  7844     GO TO 0200-READ-CERT.
  7845
  7846 0199-ACCT-NOT-FOUND.
  7847
  7848     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7849
  7850     IF DATE-RANGE-SW NOT = SPACES
  7851        MOVE ER-2601             TO WS-ERROR
  7852        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7853     ELSE
  7854        MOVE ER-2619             TO WS-ERROR
  7855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7856
  7857     GO TO 9990-RETURN.
  7858
  7859 0200-READ-CERT.
  7860
  7861     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7862     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7863     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7864     MOVE PB-SV-STATE            TO CERT-STATE.
  7865     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7866     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7867     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7868
  7869     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7870
  7871     IF CERT-WAS-NOT-FOUND
  7872        GO TO 0299-CERT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 145
* EL050.cbl
  7873
  7874     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7875        MOVE ER-2759             TO WS-ERROR
  7876        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7877        GO TO 0298-UNLOCK-RETURN.
  7878
  7879     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7880         MOVE ER-2758            TO WS-ERROR
  7881         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7882         GO TO 0298-UNLOCK-RETURN.
  7883
  7884     IF PB-ISSUE
  7885        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7886           IF CERT-WAS-CREATED-FOR-CLAIM
  7887              NEXT SENTENCE
  7888            ELSE
  7889              MOVE ER-2626       TO WS-ERROR
  7890              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7891              GO TO 0298-UNLOCK-RETURN.
  7892
  7893     IF NOT PB-CANCELLATION
  7894        GO TO 0300-CONTINUE-EDIT.
  7895
  7896     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  7897     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  7898     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  7899     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  7900     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  7901     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  7902
  7903     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  7904     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  7905     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  7906     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  7907     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  7908     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  7909     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  7910     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  7911     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  7912
  7913     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  7914     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  7915     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  7916     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  7917     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  7918     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  7919     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  7920
  7921     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  7922     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  7923
  7924     MOVE CM-CREDIT-INTERFACE-SW-1
  7925                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  7926     MOVE CM-CREDIT-INTERFACE-SW-2
  7927                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  7928
  7929     IF CM-O-B-COVERAGE
  7930         MOVE 'B'                 TO PB-CI-OB-FLAG.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 146
* EL050.cbl
  7931
  7932     IF CM-LIVES NOT NUMERIC
  7933         MOVE ZERO                TO CM-LIVES.
  7934
  7935     IF CM-BILLED NOT NUMERIC
  7936         MOVE ZERO                TO CM-BILLED.
  7937
  7938     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  7939         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  7940         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  7941         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  7942         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  7943         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  7944         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  7945         MOVE CM-LIVES             TO PB-CI-LIVES
  7946*The next line causes a problem with my change  I dont think it is
  7947*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  7948
  7949     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  7950     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  7951     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  7952     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  7953     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  7954     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  7955
  7956     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  7957     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  7958     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  7959     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  7960
  7961     IF CM-LIFE-COMM-PCT NUMERIC
  7962         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  7963     ELSE
  7964         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  7965
  7966     IF CM-AH-COMM-PCT NUMERIC
  7967         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  7968     ELSE
  7969         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  7970
  7971     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  7972
  7973     IF CM-LOAN-APR       NOT NUMERIC
  7974           MOVE ZERO               TO CM-LOAN-APR.
  7975
  7976     IF CM-PAY-FREQUENCY  NOT NUMERIC
  7977           MOVE ZERO               TO CM-PAY-FREQUENCY.
  7978
  7979     IF CM-LOAN-TERM      NOT NUMERIC
  7980           MOVE ZERO               TO CM-LOAN-TERM.
  7981
  7982     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  7983           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  7984
  7985     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  7986           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  7987
  7988     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 147
* EL050.cbl
  7989     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  7990     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  7991     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  7992     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  7993     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  7994     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  7995     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  7996     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  7997     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  7998     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  7999     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8000
  8001     IF CM-STATE = CM-SSN-STATE
  8002         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8003
  8004     IF CM-STATE NOT = CM-MEMB-STATE
  8005         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8006
  8007     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8008
  8009     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8010        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8011        IF CM-ADDL-CLP NOT NUMERIC
  8012           MOVE +0               TO CM-ADDL-CLP
  8013        END-IF
  8014        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8015        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8016           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8017        END-IF
  8018     END-IF
  8019     IF PB-COMPANY-ID = 'DCC'
  8020        MOVE +0                  TO WS-ADMIN-FEES
  8021                                    WS-CSO-ADMIN-FEE
  8022                                    WS-COMM-AND-MFEE
  8023                                    WS-1ST-YR-ALLOW
  8024        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8025           (SUB5 > +10)
  8026           MOVE +0 TO WS-WK-RATE
  8027           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8028              IF (AM-A-COM (SUB5) NUMERIC)
  8029                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8030                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8031              ELSE
  8032                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8033                 IF PB-ISSUE
  8034                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8035                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8036                 ELSE
  8037                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8038                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8039                 END-IF
  8040                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8041                 MOVE ZEROS             TO WS-SUB1
  8042                                           WS-COMMISSION
  8043                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8044                 MOVE '0530'               TO CTBL-SW
  8045                 MOVE ' '                  TO WS-CTBL-READ-SW
  8046                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 148
* EL050.cbl
  8047                 IF FIRST-TIME-THROUGH
  8048                    MOVE 'AA'              TO CTBL-BEN-CODE
  8049                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8050                 END-IF
  8051                 IF CTBL-TABLE-FOUND
  8052                    IF PB-ISSUE
  8053                       COMPUTE WS-COMM-CK-AMT =
  8054                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8055                    ELSE
  8056                       COMPUTE WS-COMM-CK-AMT =
  8057                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8058                    END-IF
  8059                    PERFORM 8800-GET-COMP-RATE
  8060                              THRU 8800-EXIT
  8061                 END-IF
  8062              END-IF
  8063              IF AM-COM-TYP (SUB5) = 'I'
  8064                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8065                   + (WS-WK-RATE * 1000)
  8066              END-IF
  8067              IF AM-COM-TYP (SUB5) = 'N'
  8068                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8069                   + (WS-WK-RATE * 1000)
  8070              END-IF
  8071              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8072                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8073                   + (WS-WK-RATE * 1000)
  8074              END-IF
  8075              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8076                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8077                   + (WS-WK-RATE * 1000)
  8078              END-IF
  8079           END-IF
  8080        END-PERFORM
  8081     END-IF
  8082     GO TO 0300-CONTINUE-EDIT.
  8083
  8084 0298-UNLOCK-RETURN.
  8085      PERFORM 9250-UNLOCK-RETURN
  8086      GO TO 9990-RETURN.
  8087
  8088 0299-CERT-NOT-FOUND.
  8089
  8090     MOVE '1'                     TO CERT-STATUS-SW.
  8091
  8092     IF PB-COMPANY-ID = 'UCL'
  8093         IF WS-ERROR = ER-2799
  8094             GO TO 3000-CONTINUE-EDIT.
  8095
  8096     IF NOT PB-CANCELLATION
  8097         GO TO 0300-CONTINUE-EDIT.
  8098
  8099     MOVE ER-2726                  TO  WS-ERROR.
  8100     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8101     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8102     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8103                                    PB-CI-LF-TERM
  8104                                    PB-C-LF-REM-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 149
* EL050.cbl
  8105                                    PB-CI-AH-TERM
  8106                                    PB-C-AH-REM-TERM
  8107                                    PB-CI-LF-BENEFIT-CD
  8108                                    PB-CI-LF-BENEFIT-AMT
  8109                                    PB-CI-LF-ALT-BENEFIT-AMT
  8110                                    PB-CI-LF-PREMIUM-AMT
  8111                                    PB-CI-LF-ALT-PREMIUM-AMT
  8112                                    PB-CI-AH-BENEFIT-CD
  8113                                    PB-CI-AH-BENEFIT-AMT
  8114                                    PB-CI-AH-PREMIUM-AMT
  8115                                    PB-CI-PAY-FREQUENCY
  8116                                    PB-CI-LOAN-APR
  8117                                    PB-CI-LOAN-TERM
  8118                                    PB-CI-LIFE-COMMISSION
  8119                                    PB-CI-AH-COMMISSION
  8120                                    PB-CI-CURR-SEQ
  8121                                    PB-CI-AH-CANCEL-AMT
  8122                                    PB-CI-LF-CANCEL-AMT
  8123                                    PB-CI-RATE-DEV-PCT-LF
  8124                                    PB-CI-RATE-DEV-PCT-AH
  8125                                    PB-CI-EXTENTION-DAYS
  8126                                    PB-CI-TERM-IN-DAYS
  8127                                    PB-CI-LIVES
  8128                                    PB-CI-LF-CRIT-PER
  8129                                    PB-CI-AH-CRIT-PER
  8130                                    PB-CI-ADDL-CLP
  8131                                    PB-CI-DDF-IU-RATE-UP.
  8132
  8133     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8134                                    PB-CI-AH-SETTLEMENT-DT
  8135                                    PB-CI-DEATH-DT
  8136                                    PB-CI-LF-PRIOR-CANCEL-DT
  8137                                    PB-CI-AH-PRIOR-CANCEL-DT
  8138                                    PB-CI-ENTRY-DT
  8139                                    PB-CI-LF-EXPIRE-DT
  8140                                    PB-CI-AH-EXPIRE-DT
  8141                                    PB-CI-LOAN-1ST-PMT-DT.
  8142
  8143     IF ACCOUNT-MAST-FOUND
  8144        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8145        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8146
  8147     GO TO 3000-CONTINUE-EDIT.
  8148
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 150
* EL050.cbl
  8150
  8151 0300-CONTINUE-EDIT.
  8152
  8153     IF PB-ISSUE
  8154        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8155            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8156
  8157     IF PB-ISSUE
  8158        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8159            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8160
  8161     IF PB-ISSUE
  8162       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8163          (AM-NO-AH-ONLY)
  8164           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8165               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8166                   MOVE ER-2679 TO WS-ERROR
  8167                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8168
  8169     IF PB-ISSUE
  8170        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8171        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8172        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8173     ELSE
  8174        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8175        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8176        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8177
  8178     MOVE 'N'                    TO PLAN-MASTER-SW
  8179                                    PLAN-MASTER-LIFE-SW
  8180                                    FORM-MASTER-SW
  8181                                    WS-APP-CERT-SW.
  8182
  8183     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8184                                    WS-PL-TOL-LF-REFUND
  8185                                    WS-PL-REF-OVS-AMT
  8186                                    WS-PL-TOL-LF-PREM-PCT
  8187                                    WS-PL-TOL-LF-REFUND-PCT
  8188                                    WS-PL-REF-OVS-PCT
  8189                                    WS-PL-TOL-LF-CLAIM.
  8190
  8191     IF PB-COMPANY-ID = 'NCL'
  8192       IF PB-ISSUE
  8193         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8194             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8195             IF FORM-MASTER-FOUND
  8196                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8197
  8198     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8199        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8200
  8201********************** MON CODE **********************
  8202     IF PB-COMPANY-ID = 'MON'
  8203     IF PB-ISSUE
  8204     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8205        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8206             PB-I-LOAN-APR = ZERO)
  8207               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 151
* EL050.cbl
  8208******************************************************
  8209
  8210     IF PB-COMPANY-ID = 'NCL'
  8211       IF PB-ISSUE
  8212           IF FORM-MASTER-FOUND
  8213             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8214                AM-DISMBR-COVERAGE
  8215                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8216                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8217                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8218                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8219                                           PB-I-LIFE-BENEFIT-CD.
  8220
  8221     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8222
  8223     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8224         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8225         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8226         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8227         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8228         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8229           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8230             GO TO 0301-LIFE-BENEFIT-SEARCH
  8231         ELSE
  8232             NEXT SENTENCE
  8233     ELSE
  8234         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8235
  8236     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8237     MOVE '4'                    TO CNTL-REC-TYPE.
  8238     MOVE +0                     TO CNTL-SEQ-NO.
  8239     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8240
  8241     MOVE '1' TO RC-SW-2.
  8242     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8243
  8244     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8245        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8246         GO TO 0305-BENEFIT-NOT-FOUND.
  8247
  8248     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8249
  8250 0301-LIFE-BENEFIT-SEARCH.
  8251
  8252     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8253
  8254     IF NO-BENEFIT-FOUND
  8255        GO TO 0305-BENEFIT-NOT-FOUND.
  8256
  8257     IF WS-BEN-CD = '99'
  8258        GO TO 0305-BENEFIT-NOT-FOUND.
  8259
  8260     IF PB-COMPANY-ID = 'NCL'
  8261         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8262             GO TO 0304-LIFE-BENEFIT-FOUND.
  8263
  8264     MOVE +1                     TO SUB5.
  8265     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 152
* EL050.cbl
  8266
  8267* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8268* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8269     IF PB-COMPANY-ID = 'DMD'
  8270         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8271
  8272 0302-EDIT-ACCT-LF-BENEFITS.
  8273
  8274     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8275        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8276           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8277                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8278           GO TO 03XX-GET-LIFE-ERPLAN.
  8279
  8280     IF SUB5 LESS THAN +20
  8281        ADD +1                   TO SUB5
  8282        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8283
  8284     MOVE +1                     TO SUB5.
  8285
  8286     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8287        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8288
  8289 0303-EDIT-DMD-EXTRA-BENEFITS.
  8290
  8291     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8292        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8293           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8294                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8295           GO TO 03XX-GET-LIFE-ERPLAN.
  8296
  8297     IF SUB5 LESS THAN +30
  8298        ADD +1                   TO SUB5
  8299        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8300
  8301     MOVE +1                     TO SUB5.
  8302
  8303 03XX-EDIT-FOR-NINETY-LF.
  8304
  8305***************************************************************
  8306*                                                             *
  8307*    NINETY BENEFIT PLAN TYPES:                               *
  8308*                                                             *
  8309*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8310*      92 = ALL GROUP REDUCING BENEFITS                       *
  8311*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8312*      94 = ALL GROUP LEVEL BENEFITS                          *
  8313*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8314*           BENEFIT CONTROLS.                                 *
  8315*      99 = ALL BENEFITS                                      *
  8316*                                                             *
  8317***************************************************************
  8318
  8319     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8320                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8321
  8322     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8323       AND
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 153
* EL050.cbl
  8324        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8325        GO TO 03XX-GET-LIFE-ERPLAN.
  8326
  8327     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8328       AND
  8329        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8330        IF CF-REDUCING (SUB3)
  8331           IF (PB-I-INDV-GRP-OVRD = 'I')
  8332              OR
  8333           ((AM-IG = '1') AND
  8334           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8335              OR
  8336           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8337           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8338           (AM-IG NOT = '2'))
  8339              GO TO 03XX-GET-LIFE-ERPLAN.
  8340
  8341     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8342       AND
  8343        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8344        IF CF-REDUCING (SUB3)
  8345           IF (PB-I-INDV-GRP-OVRD = 'G')
  8346              OR
  8347           ((AM-IG = '2') AND
  8348           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8349              OR
  8350           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8351           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8352           (AM-IG NOT = '1'))
  8353              GO TO 03XX-GET-LIFE-ERPLAN.
  8354
  8355     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8356       AND
  8357        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8358        IF CF-LEVEL    (SUB3)
  8359           IF (PB-I-INDV-GRP-OVRD = 'I')
  8360              OR
  8361           ((AM-IG = '1') AND
  8362           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8363              OR
  8364           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8365           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8366            (AM-IG NOT = '2'))
  8367              GO TO 03XX-GET-LIFE-ERPLAN.
  8368
  8369     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8370       AND
  8371        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8372        IF CF-LEVEL    (SUB3)
  8373           IF (PB-I-INDV-GRP-OVRD = 'G')
  8374              OR
  8375           ((AM-IG = '2') AND
  8376           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8377              OR
  8378           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8379           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8380           (AM-IG NOT = '1'))
  8381              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 154
* EL050.cbl
  8382
  8383     IF SUB5 LESS THAN +20
  8384        ADD +1                   TO SUB5
  8385        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8386
  8387     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8388
  8389     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8390        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8391
  8392     MOVE +1                     TO SUB5.
  8393
  8394 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8395
  8396     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8397                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8398
  8399     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8400       AND
  8401        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8402        GO TO 03XX-GET-LIFE-ERPLAN.
  8403
  8404     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8405       AND
  8406        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8407        IF CF-REDUCING (SUB3)
  8408           IF (PB-I-INDV-GRP-OVRD = 'I')
  8409              OR
  8410           ((AM-IG = '1') AND
  8411           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8412              OR
  8413           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8414           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8415           (AM-IG NOT = '2'))
  8416              GO TO 03XX-GET-LIFE-ERPLAN.
  8417
  8418     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8419       AND
  8420        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8421        IF CF-REDUCING (SUB3)
  8422           IF (PB-I-INDV-GRP-OVRD = 'G')
  8423              OR
  8424           ((AM-IG = '2') AND
  8425           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8426              OR
  8427           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8428           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8429           (AM-IG NOT = '1'))
  8430              GO TO 03XX-GET-LIFE-ERPLAN.
  8431
  8432     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8433       AND
  8434        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8435        IF CF-LEVEL    (SUB3)
  8436           IF (PB-I-INDV-GRP-OVRD = 'I')
  8437              OR
  8438           ((AM-IG = '1') AND
  8439           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 155
* EL050.cbl
  8440              OR
  8441           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8442           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8443            (AM-IG NOT = '2'))
  8444              GO TO 03XX-GET-LIFE-ERPLAN.
  8445
  8446     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8447       AND
  8448        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8449        IF CF-LEVEL    (SUB3)
  8450           IF (PB-I-INDV-GRP-OVRD = 'G')
  8451              OR
  8452           ((AM-IG = '2') AND
  8453           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8454              OR
  8455           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8456           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8457           (AM-IG NOT = '1'))
  8458              GO TO 03XX-GET-LIFE-ERPLAN.
  8459
  8460     IF SUB5 LESS THAN +30
  8461        ADD +1                   TO SUB5
  8462        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8463
  8464     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8465
  8466 03XX-EDIT-FOR-NINETY-LF-CONT.
  8467
  8468     MOVE +99                    TO SUB5.
  8469
  8470     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8471        IF PB-ISSUE
  8472           MOVE ER-1924          TO  WS-ERROR
  8473           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8474
  8475     GO TO 0304-LIFE-BENEFIT-FOUND.
  8476
  8477 03XX-GET-LIFE-ERPLAN.
  8478
  8479     IF WK-PLAN-ADDR EQUAL +0
  8480        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8481
  8482     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8483     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8484     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8485     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8486     MOVE 'Y'                    TO PLAN-MASTER-SW
  8487                                    PLAN-MASTER-LIFE-SW.
  8488     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8489
  8490 03XX-ERPLAN-LIFE-GETMAIN.
  8491
  8492     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8493     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8494
  8495 03XX-ERPLAN-LIFE-READ.
  8496
  8497     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 156
* EL050.cbl
  8498     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8499     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8500     MOVE PB-SV-STATE            TO PLAN-STATE.
  8501     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8502     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8503     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8504     MOVE WS-SAVE-BENEFIT-REVISION
  8505                                 TO PLAN-REVISION-NO.
  8506
  8507     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8508     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8509
  8510     IF PB-COMPANY-ID = 'NCL'
  8511       IF NOT LF-PLAN-MASTER-FOUND
  8512         IF NOT PB-POLICY-IS-DECLINED  AND
  8513            NOT PB-POLICY-IS-VOIDED
  8514             MOVE  ER-1921         TO  WS-ERROR
  8515             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8516             GO TO 0304-LIFE-BENEFIT-FOUND.
  8517
  8518     IF NOT LF-PLAN-MASTER-FOUND
  8519        GO TO 0304-LIFE-BENEFIT-FOUND.
  8520
  8521 XXXX-CHECK-LF-PLAN-KEY.
  8522
  8523     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8524        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8525        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8526        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8527        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8528        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8529        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8530        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8531        MOVE 'N'                 TO PLAN-MASTER-SW
  8532          GO TO 03XX-ERPLAN-LIFE-READ.
  8533
  8534     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8535
  8536     IF  PB-CANCELLATION
  8537         GO TO  0303-LF-ACCT-BEN-FOUND.
  8538
  8539     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8540        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8541           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8542           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8543              MOVE ER-2644             TO WS-ERROR
  8544              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8545           ELSE
  8546              NEXT SENTENCE
  8547        ELSE
  8548           IF PB-COMPANY-ID NOT = 'NCL'
  8549              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8550                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8551
  8552 0303-LF-ACCT-BEN-FOUND.
  8553
  8554     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8555
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 157
* EL050.cbl
  8556     IF PL-DEV-CODE NOT = SPACES
  8557        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8558
  8559     IF PL-DEV-PCT NUMERIC AND
  8560        PL-DEV-PCT NOT = ZEROS
  8561        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8562
  8563     IF PL-TOL-PREM-AMT GREATER THAN +0
  8564        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8565
  8566     IF PL-TOL-REF-AMT GREATER THAN +0
  8567        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8568
  8569     IF PL-TOL-PREM-PCT GREATER THAN +0
  8570        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8571
  8572     IF PL-TOL-REF-PCT GREATER THAN +0
  8573        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8574
  8575     IF PL-TOL-CLM-AMT GREATER THAN +0
  8576        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8577
  8578     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8579                          PL-OVER-SHORT-AMT > +0
  8580        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8581
  8582     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8583                          PL-OVER-SHORT-PCT > +0
  8584        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8585
  8586     IF PL-SALES-TAX NUMERIC AND
  8587                          PL-SALES-TAX > +0
  8588         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8589
  8590     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8591        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8592                                    WS-IG-OVRD-AM.
  8593
  8594 0304-LIFE-BENEFIT-FOUND.
  8595
  8596     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8597
  8598     IF PB-ISSUE
  8599        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8600     ELSE
  8601        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8602
  8603     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8604     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8605     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8606     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8607     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8608                                         WS-LF-REFUND-CALC.
  8609
  8610     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8611        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8612
  8613     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 158
* EL050.cbl
  8614        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8615     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8616
  8617     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8618     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8619     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8620     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8621     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8622     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8623
  8624     IF PB-COMPANY-ID = 'NCL'  AND
  8625        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8626         NEXT SENTENCE
  8627     ELSE
  8628         IF SUB5 NOT GREATER THAN +20
  8629            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8630               MOVE WS-SAVE-BENEFIT-REM-TERM
  8631                                      TO WS-AM-LF-BENE-REM-TERM
  8632                                         EC-BR-LF-REM-TERM-CALC.
  8633
  8634     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8635     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8636
  8637     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8638
  8639 0305-BENEFIT-NOT-FOUND.
  8640
  8641     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8642     MOVE ER-2604                TO WS-ERROR.
  8643     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8644
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 159
* EL050.cbl
  8646
  8647 0310-FIND-AH-BENEFIT-RECORD.
  8648
  8649     MOVE 'N'                    TO PLAN-MASTER-SW
  8650                                    PLAN-MASTER-AH-SW.
  8651
  8652     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8653                                    WS-PL-TOL-AH-REFUND
  8654                                    WS-AH-PL-REF-OVS-AMT
  8655                                    WS-PL-TOL-AH-PREM-PCT
  8656                                    WS-PL-TOL-AH-REFUND-PCT
  8657                                    WS-AH-PL-REF-OVS-PCT
  8658                                    WS-PL-TOL-AH-CLAIM.
  8659     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8660
  8661
  8662     if pb-issue
  8663        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8664           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8665        end-if
  8666        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8667           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8668           GO TO 0399-BENEFIT-NOT-FOUND
  8669        end-if
  8670     end-if
  8671
  8672     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8673        GO TO 0400-FIND-CARRIER.
  8674
  8675     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8676
  8677     IF WK-AH-BEN-ADDR NOT = ZEROS
  8678         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8679         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8680         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8681         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8682           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8683             GO TO 0311-AH-BENEFIT-SEARCH
  8684         ELSE
  8685             NEXT SENTENCE
  8686     ELSE
  8687         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8688
  8689     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8690     MOVE '5'                    TO CNTL-REC-TYPE.
  8691     MOVE +0                     TO CNTL-SEQ-NO.
  8692     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8693
  8694     MOVE '2' TO RC-SW-2.
  8695     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8696
  8697     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8698        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8699          GO TO 0399-BENEFIT-NOT-FOUND.
  8700
  8701     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8702
  8703 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 160
* EL050.cbl
  8704
  8705     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8706
  8707     IF NO-BENEFIT-FOUND
  8708         GO TO 0399-BENEFIT-NOT-FOUND.
  8709
  8710     IF WS-BEN-CD = '99'
  8711        GO TO 0399-BENEFIT-NOT-FOUND.
  8712
  8713     IF PB-COMPANY-ID  =  'NCL'
  8714         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8715             GO TO 0314-A-H-BENEFIT-FOUND.
  8716
  8717     MOVE +1                     TO SUB5.
  8718     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8719
  8720* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8721* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8722     IF PB-COMPANY-ID = 'DMD'
  8723         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8724
  8725 0312-EDIT-ACCT-AH-BENEFITS.
  8726
  8727     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8728        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8729           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8730                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8731           GO TO 03XX-GET-AH-ERPLAN.
  8732
  8733     IF SUB5 LESS THAN +20
  8734        ADD +1                   TO SUB5
  8735        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8736
  8737     MOVE +1                     TO SUB5.
  8738
  8739     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8740        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8741
  8742 0313-EDIT-DMD-EXTRA-BENEFITS.
  8743
  8744     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8745        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8746           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8747                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8748           GO TO 03XX-GET-AH-ERPLAN.
  8749
  8750     IF SUB5 LESS THAN +30
  8751        ADD +1                   TO SUB5
  8752        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8753
  8754     MOVE +1                     TO SUB5.
  8755
  8756 03XX-EDIT-FOR-NINETY-AH.
  8757
  8758***************************************************************
  8759*                                                             *
  8760*    NINETY BENEFIT PLAN TYPES:                               *
  8761*                                                             *
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 161
* EL050.cbl
  8762*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8763*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8764*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8765*           BENEFIT CONTROLS.                                 *
  8766*      99 = ALL BENEFITS.                                     *
  8767*                                                             *
  8768***************************************************************
  8769
  8770     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8771                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8772
  8773     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8774       AND
  8775        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8776        GO TO 03XX-GET-AH-ERPLAN.
  8777
  8778     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8779       AND
  8780        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8781           IF (PB-I-INDV-GRP-OVRD = 'I')
  8782              OR
  8783           ((AM-IG = '1') AND
  8784           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8785              OR
  8786           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8787           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8788           (AM-IG NOT = '2'))
  8789              GO TO 03XX-GET-AH-ERPLAN.
  8790
  8791     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8792       AND
  8793        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8794           IF (PB-I-INDV-GRP-OVRD = 'G')
  8795              OR
  8796           ((AM-IG = '2') AND
  8797           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8798              OR
  8799           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8800           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8801           (AM-IG NOT = '1'))
  8802              GO TO 03XX-GET-AH-ERPLAN.
  8803
  8804     IF SUB5 LESS THAN +20
  8805        ADD +1                   TO SUB5
  8806        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8807
  8808     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8809        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8810
  8811     MOVE +1                    TO SUB5.
  8812
  8813 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8814
  8815     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8816                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8817
  8818     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8819       AND
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 162
* EL050.cbl
  8820        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8821        GO TO 03XX-GET-AH-ERPLAN.
  8822
  8823     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8824       AND
  8825        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8826           IF (PB-I-INDV-GRP-OVRD = 'I')
  8827              OR
  8828           ((AM-IG = '1') AND
  8829           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8830              OR
  8831           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8832           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8833           (AM-IG NOT = '2'))
  8834              GO TO 03XX-GET-AH-ERPLAN.
  8835
  8836     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8837       AND
  8838        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8839           IF (PB-I-INDV-GRP-OVRD = 'G')
  8840              OR
  8841           ((AM-IG = '2') AND
  8842           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8843              OR
  8844           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8845           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8846           (AM-IG NOT = '1'))
  8847              GO TO 03XX-GET-AH-ERPLAN.
  8848
  8849     IF SUB5 LESS THAN +30
  8850        ADD +1                   TO SUB5
  8851        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8852
  8853 03XX-EDIT-FOR-NINETY-AH-CONT.
  8854
  8855     MOVE +99                    TO SUB5.
  8856
  8857     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8858
  8859     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8860        IF PB-ISSUE
  8861           MOVE ER-1925          TO  WS-ERROR
  8862           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8863
  8864     GO TO 0314-A-H-BENEFIT-FOUND.
  8865
  8866 03XX-GET-AH-ERPLAN.
  8867
  8868     IF WK-PLAN-ADDR EQUAL +0
  8869         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8870
  8871     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8872     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8873     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8874     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8875     MOVE 'Y'                    TO PLAN-MASTER-SW
  8876                                    PLAN-MASTER-AH-SW.
  8877*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 163
* EL050.cbl
  8878     GO TO 03XX-ERPLAN-AH-READ.
  8879
  8880 03XX-ERPLAN-AH-GETMAIN.
  8881
  8882     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8883     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8884
  8885 03XX-ERPLAN-AH-READ.
  8886
  8887     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8888     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8889     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8890     MOVE PB-SV-STATE            TO PLAN-STATE.
  8891     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8892     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  8893     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8894     MOVE WS-SAVE-BENEFIT-REVISION
  8895                                 TO PLAN-REVISION-NO.
  8896
  8897     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8898     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  8899
  8900     IF PB-COMPANY-ID = 'NCL'
  8901       IF NOT AH-PLAN-MASTER-FOUND
  8902         IF NOT PB-POLICY-IS-DECLINED  AND
  8903            NOT PB-POLICY-IS-VOIDED
  8904             MOVE  ER-1922         TO  WS-ERROR
  8905             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8906             GO TO 0314-A-H-BENEFIT-FOUND.
  8907
  8908     IF NOT AH-PLAN-MASTER-FOUND
  8909        GO TO 0314-A-H-BENEFIT-FOUND.
  8910
  8911 XXXX-CHECK-AH-PLAN-KEY.
  8912
  8913     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8914        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8915        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8916        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8917        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8918        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8919        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8920        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8921        MOVE 'N'                 TO PLAN-MASTER-SW
  8922          GO TO 03XX-ERPLAN-AH-READ.
  8923
  8924     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  8925
  8926     IF  PB-CANCELLATION
  8927         GO TO  0313-AH-ACCT-BEN-FOUND.
  8928
  8929     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8930       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8931          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8932          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8933             MOVE ER-2644             TO WS-ERROR
  8934             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8935          ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 164
* EL050.cbl
  8936             NEXT SENTENCE
  8937       ELSE
  8938          IF PB-COMPANY-ID NOT = 'NCL'
  8939             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8940                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8941
  8942 0313-AH-ACCT-BEN-FOUND.
  8943
  8944     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  8945
  8946     IF PL-DEV-CODE NOT = SPACES
  8947        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  8948
  8949     IF PL-DEV-PCT NUMERIC AND
  8950        PL-DEV-PCT NOT = ZEROS
  8951        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  8952
  8953     IF PL-TOL-PREM-AMT NOT EQUAL +0
  8954        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  8955
  8956     IF PL-TOL-REF-AMT NOT EQUAL +0
  8957        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  8958
  8959     IF PL-TOL-PREM-PCT GREATER THAN +0
  8960        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  8961
  8962     IF PL-TOL-REF-PCT GREATER THAN +0
  8963        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  8964
  8965     IF PL-TOL-CLM-AMT NOT EQUAL +0
  8966        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  8967
  8968     IF PL-OVER-SHORT-AMT NUMERIC AND
  8969                          PL-OVER-SHORT-AMT > +0
  8970        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  8971
  8972     IF PL-OVER-SHORT-PCT NUMERIC AND
  8973                          PL-OVER-SHORT-PCT > +0
  8974        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  8975
  8976     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8977        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  8978        IF WS-IG-OVRD-AM EQUAL SPACES
  8979            MOVE PL-IG           TO WS-IG-OVRD-AM.
  8980
  8981 0314-A-H-BENEFIT-FOUND.
  8982
  8983     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  8984
  8985     IF PB-ISSUE
  8986        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  8987       ELSE
  8988        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  8989
  8990     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  8991     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  8992     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  8993     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 165
* EL050.cbl
  8994                                         WS-AH-REFUND-CALC.
  8995
  8996     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8997        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  8998
  8999     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9000        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9001     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9002
  9003     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9004     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9005     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9006     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9007     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9008     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9009
  9010     IF PB-COMPANY-ID = 'NCL'  AND
  9011        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9012         NEXT SENTENCE
  9013     ELSE
  9014         IF SUB5 NOT GREATER THAN +20
  9015            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9016                MOVE WS-SAVE-BENEFIT-REM-TERM
  9017                                      TO WS-AM-AH-BENE-REM-TERM
  9018                                         EC-BR-AH-REM-TERM-CALC.
  9019
  9020     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9021     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9022
  9023     GO TO 0400-FIND-CARRIER.
  9024
  9025 0399-BENEFIT-NOT-FOUND.
  9026
  9027     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9028     MOVE ER-2605                TO WS-ERROR.
  9029     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9030
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 166
* EL050.cbl
  9032
  9033 0400-FIND-CARRIER.
  9034
  9035     MOVE PB-SV-CARRIER          TO WS-CARR.
  9036
  9037     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9038     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9039     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9040     MOVE '6'                    TO CNTL-REC-TYPE.
  9041
  9042*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9043     MOVE SPACE                  TO WS-DMD-RATING-SW
  9044                                    EC-BR-DMD-RATING-SW.
  9045
  9046     MOVE '2'                    TO RC-SW-1.
  9047     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9048
  9049     IF NOT CF-CARRIER-MASTER
  9050        GO TO 0400-CARRIER-NOT-FOUND.
  9051
  9052 0400-BUILD-CARR-TOL.
  9053
  9054     IF CF-CR-TOL-PREM NUMERIC AND
  9055        CF-CR-TOL-PREM GREATER THAN +0
  9056        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9057                                    WS-TOL-AH-PREM.
  9058
  9059     IF CF-CR-TOL-REFUND NUMERIC AND
  9060        CF-CR-TOL-REFUND GREATER THAN +0
  9061        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9062                                    WS-TOL-AH-REFUND.
  9063
  9064     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9065        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9066        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9067                                    WS-AH-REFUND-OVS-AMT.
  9068
  9069     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9070        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9071        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9072                                    WS-AH-REFUND-OVS-PCT.
  9073
  9074     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9075        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9076        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9077                                    WS-TOL-AH-PREM-PCT.
  9078
  9079     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9080        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9081        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9082                                     WS-TOL-AH-REFUND-PCT.
  9083
  9084     IF CF-COMPANY-ID EQUAL 'DMD'
  9085         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9086                                    EC-BR-DMD-RATING-SW.
  9087
  9088     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9089     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 167
* EL050.cbl
  9090        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9091     END-IF
  9092     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9093        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9094     END-IF
  9095     IF WS-TOL-CLP-PCT = ZEROS
  9096        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9097     END-IF
  9098
  9099     IF WS-SPP-LEASE-COMM = ZEROS
  9100        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9101     END-IF
  9102     GO TO 0400-FIND-ERPDEF.
  9103
  9104 0400-CARRIER-NOT-FOUND.
  9105
  9106     MOVE ER-2602                TO WS-ERROR.
  9107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9108
  9109 0400-FIND-ERPDEF.
  9110     IF PB-COMPANY-ID = 'DCC'
  9111        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9112        CONTINUE
  9113     ELSE
  9114        GO TO 0400-FIND-ERCOMP
  9115     END-IF
  9116     MOVE ' '                    TO PDEF-MASTER-SW
  9117     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9118     MOVE PB-STATE               TO ERPDEF-STATE
  9119     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9120     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9121     IF PB-ISSUE
  9122        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9123     ELSE
  9124        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9125     END-IF
  9126     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9127     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9128     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9129     IF PDEF-MASTER-FOUND
  9130        MOVE 'N'                 TO PDEF-MASTER-SW
  9131        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9132        IF PDEF-MASTER-FOUND
  9133           IF (ERPDEF-KEY-SAVE (1:16) =
  9134                        PD-CONTROL-PRIMARY (1:16))
  9135              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9136              CONTINUE
  9137           ELSE
  9138              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9139              IF (ERPDEF-KEY-SAVE (1:16) =
  9140                        PD-CONTROL-PRIMARY (1:16))
  9141                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9142                 CONTINUE
  9143              ELSE
  9144                 MOVE 'N'        TO PDEF-MASTER-SW
  9145              END-IF
  9146           END-IF
  9147        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 168
* EL050.cbl
  9148        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9149     END-IF
  9150     IF PDEF-MASTER-FOUND
  9151        IF PD-TRUNCATED = 'Y'
  9152           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9153        END-IF
  9154     END-IF
  9155     .
  9156 0400-FIND-ERCOMP.
  9157     IF PB-COMPANY-ID = 'DCC'
  9158        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9159           (WS-SUB1 > +10)
  9160           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9161                 OR 'A' OR 'N'
  9162              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9163              MOVE PB-CARRIER    TO COMP-CARRIER
  9164              MOVE PB-GROUPING   TO COMP-GROUPING
  9165              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9166              MOVE AM-AGT (WS-SUB1)
  9167                                 TO COMP-FIN-RESP
  9168              MOVE 'G'           TO COMP-TYPE
  9169              PERFORM 8582-READ-COMPENSATION-MASTER
  9170                                 THRU 8582-EXIT
  9171              IF COMP-MASTER-FOUND
  9172                 IF CO-GA-INACTIVE
  9173                    MOVE ER-2763 TO WS-ERROR
  9174                    PERFORM 9900-ERROR-FORMAT
  9175                                 THRU 9900-EXIT
  9176                    MOVE +11     TO WS-SUB1
  9177                 END-IF
  9178                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9179                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9180                    MOVE ER-2788 TO WS-ERROR
  9181                    PERFORM 9900-ERROR-FORMAT
  9182                                 THRU 9900-EXIT
  9183                    MOVE +11     TO WS-SUB1
  9184                 END-IF
  9185              END-IF
  9186           END-IF
  9187        END-PERFORM
  9188     END-IF
  9189     IF (PB-COMPANY-ID = 'DCC')
  9190               AND
  9191        ((WS-LF-BEN-CATEGORY = 'D')
  9192        OR (WS-AH-BEN-CATEGORY = 'D')
  9193        OR (AM-DCC-PRODUCT-CODE = 'DDF'))
  9194        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9195           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9196                                    WS-CLP-STATE
  9197        ELSE
  9198           MOVE SPACES           TO PB-I-CLP-STATE
  9199                                    WS-CLP-STATE
  9200        END-IF
  9201     END-IF
  9202
  9203     IF (PB-COMPANY-ID = 'DCC')
  9204        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9205        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 169
* EL050.cbl
  9206        CONTINUE
  9207     ELSE
  9208        GO TO 0400-FIND-STATE-RECORD
  9209     END-IF
  9210     MOVE SPACES                 TO WS-CLP-STATE
  9211     MOVE +0                     TO WS-BANK-FEE
  9212                                    WS-BANK-LFEE
  9213                                    WS-BANK-NOCHRGB
  9214
  9215     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9216     IF (PB-ISSUE)
  9217        AND (PB-I-BANK-NUMBER NOT =
  9218            SPACES AND ZEROS AND LOW-VALUES)
  9219        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9220     ELSE
  9221        IF (PB-CANCELLATION)
  9222           AND (PB-CI-BANK-NUMBER NOT =
  9223                SPACES AND ZEROS AND LOW-VALUES)
  9224           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9225        END-IF
  9226     END-IF
  9227     IF COMP-FIN-RESP NOT = LOW-VALUES
  9228        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9229        MOVE PB-CARRIER          TO COMP-CARRIER
  9230        MOVE PB-GROUPING         TO COMP-GROUPING
  9231        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9232        MOVE 'B'                 TO COMP-TYPE
  9233        PERFORM 8582-READ-COMPENSATION-MASTER
  9234                                 THRU 8582-EXIT
  9235        IF COMP-MASTER-FOUND
  9236           IF CO-MAX-BANK-FEE NOT NUMERIC
  9237              MOVE +0            TO CO-MAX-BANK-FEE
  9238           END-IF
  9239           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9240              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9241           END-IF
  9242           IF CO-GA-INACTIVE
  9243              MOVE ER-2763       TO WS-ERROR
  9244              PERFORM 9900-ERROR-FORMAT
  9245                                 THRU 9900-EXIT
  9246           END-IF
  9247           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9248              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9249              MOVE ER-2788 TO WS-ERROR
  9250              PERFORM 9900-ERROR-FORMAT
  9251                                 THRU 9900-EXIT
  9252              MOVE +11     TO WS-SUB1
  9253           END-IF
  9254           IF WS-AH-BEN-CATEGORY = 'G'
  9255              MOVE CO-MAX-BANK-FEE
  9256                                 TO WS-BANK-FEE
  9257                                    PB-I-BANK-FEE
  9258           ELSE
  9259              MOVE CO-MAX-BANK-FEE-LEASE
  9260                                 TO WS-BANK-LFEE
  9261                                    PB-I-BANK-FEE
  9262           END-IF
  9263           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 170
* EL050.cbl
  9264              AND (WS-AH-REFUND-CALC = 'G'))
  9265                        OR
  9266              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9267              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9268              CONTINUE
  9269           ELSE
  9270              MOVE ER-2789 TO WS-ERROR
  9271              PERFORM 9900-ERROR-FORMAT
  9272                                 THRU 9900-EXIT
  9273           END-IF
  9274           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9275                                    PB-I-CLP-STATE
  9276           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9277           MOVE CO-CARRIER       TO BXRF-CARRIER
  9278           MOVE CO-GROUPING      TO BXRF-GROUPING
  9279           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9280           MOVE BXRF-MAX-REC-LENGTH
  9281                                 TO BXRF-REC-LENGTH
  9282           PERFORM 8584-READ-BANK-CROSS-REF
  9283                                 THRU 8584-EXIT
  9284           IF BXRF-MASTER-FOUND
  9285              MOVE ' '           TO BANK-ACCT-SW
  9286              MOVE BK-BANK-POINTER-CNT
  9287                                 TO BK-BANK-POINTER-CNT
  9288              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9289                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9290                 OR (BANK-ACCT-FOUND)
  9291                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9292                    AND (BK-AM-EXP-DT (WS-SUB1)
  9293                                 > PB-CERT-EFF-DT)
  9294                    AND (BK-AM-EFF-DT (WS-SUB1)
  9295                                 NOT > PB-CERT-EFF-DT)
  9296                    SET BANK-ACCT-FOUND TO TRUE
  9297                 END-IF
  9298              END-PERFORM
  9299              IF NOT BANK-ACCT-FOUND
  9300                 MOVE ZEROS      TO WS-BANK-FEE
  9301                                    WS-BANK-LFEE
  9302                 MOVE ER-2869    TO WS-ERROR
  9303                 PERFORM 9900-ERROR-FORMAT
  9304                                 THRU 9900-EXIT
  9305              ELSE
  9306                 PERFORM 5000-PROCESS-REPS
  9307                                 THRU 5000-EXIT
  9308                 IF AGENT-MASTER-FOUND
  9309                    MOVE +0      TO WS-BANK-FEE
  9310                                    WS-BANK-LFEE
  9311*                   MOVE AG-SPP-FEES (1)
  9312*                                TO PB-I-BANK-FEE
  9313*                                   WS-BANK-FEE
  9314                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9315                       (WS-SUB1 > +10)
  9316                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9317                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9318                       END-IF
  9319                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9320                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9321                       END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 171
* EL050.cbl
  9322                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9323                          AG-SPP-FEES (WS-SUB1)
  9324                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9325                          AG-SPP-LFEES (WS-SUB1)
  9326                    END-PERFORM
  9327                    IF WS-AH-BEN-CATEGORY = 'G'
  9328                       MOVE WS-BANK-FEE
  9329                                 TO PB-I-BANK-FEE
  9330                    ELSE
  9331                       MOVE WS-BANK-LFEE
  9332                                 TO PB-I-BANK-FEE
  9333                    END-IF
  9334                 END-IF
  9335              END-IF
  9336           END-IF
  9337        ELSE
  9338           MOVE ER-2879          TO WS-ERROR
  9339           PERFORM 9900-ERROR-FORMAT
  9340                                 THRU 9900-EXIT
  9341        END-IF
  9342     ELSE
  9343        MOVE ER-2879             TO WS-ERROR
  9344        PERFORM 9900-ERROR-FORMAT
  9345                                 THRU 9900-EXIT
  9346     END-IF
  9347     IF WS-AH-BEN-CATEGORY = 'G'
  9348        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9349        + WS-BANK-FEE
  9350     ELSE
  9351        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9352        + WS-BANK-LFEE
  9353     END-IF
  9354     .
  9355 0400-FIND-STATE-RECORD.
  9356
  9357     IF WK-STATE-ADDR NOT = ZEROS
  9358         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9359         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9360         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9361         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9362         IF PB-SV-STATE = CF-STATE-CODE
  9363             GO TO 0405-CONTINUE-EDIT
  9364         ELSE
  9365             NEXT SENTENCE
  9366     ELSE
  9367         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9368
  9369     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9370     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9371     MOVE '3'                    TO CNTL-REC-TYPE.
  9372     MOVE +0                     TO CNTL-SEQ-NO.
  9373
  9374     MOVE '3'                    TO RC-SW-2.
  9375     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9376
  9377     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9378        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9379        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 172
* EL050.cbl
  9380        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9381                                    WS-TOL-AH-CLAIM
  9382                                    WS-MINIMUM-REFUND
  9383                                    WS-TOL-LF-PREM
  9384                                    WS-TOL-AH-PREM
  9385                                    WS-TOL-LF-REFUND
  9386                                    WS-TOL-AH-REFUND
  9387                                    EC-ST-TOL-PREM-PCT
  9388                                    WS-TOL-LF-PREM-PCT
  9389                                    WS-TOL-AH-PREM-PCT
  9390                                    EC-ST-TOL-REFUND-PCT
  9391                                    WS-TOL-LF-REFUND-PCT
  9392                                    WS-TOL-AH-REFUND-PCT
  9393                                    EC-ST-TOL-PREM
  9394                                    EC-ST-TOL-REFUND
  9395                                    EC-ST-FST-PMT-DAYS-MAX
  9396                                    WS-FREE-LOOK-PERIOD
  9397                                    WS-ST-LF-PREM-TAX
  9398                                    WS-ST-AH-PREM-TAX-I
  9399                                    WS-ST-AH-PREM-TAX-G
  9400                                    WS-BANK-FEE
  9401                                    WS-BANK-LFEE
  9402                                    WS-TOL-CLP-PCT
  9403                                    WS-SPP-LEASE-COMM
  9404        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9405                                    EC-ST-FST-PMT-DAYS-CHG
  9406                                    WS-LF-REM-TERM-CALC
  9407                                    WS-LF-REFUND-CALC
  9408                                    EC-ST-LF-REM-TERM-CALC
  9409                                    EC-ST-LF-REFUND-CALC
  9410                                    WS-AH-REM-TERM-CALC
  9411                                    WS-AH-REFUND-CALC
  9412                                    WS-LF-BEN-CATEGORY
  9413                                    WS-AH-BEN-CATEGORY
  9414                                    WS-CLP-STATE
  9415                                    WS-ST-REFUND-CLAIM-FLAG
  9416                                    EC-ST-AH-REM-TERM-CALC
  9417                                    EC-ST-AH-REFUND-CALC
  9418          GO TO 0499-STATE-NOT-FOUND.
  9419
  9420     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9421
  9422 0405-CONTINUE-EDIT.
  9423
  9424     if pb-company-id = 'AHL'
  9425        continue
  9426     else
  9427        IF PB-CERT-PRIME NOT NUMERIC
  9428           MOVE ER-2722          TO WS-ERROR
  9429           PERFORM 9900-ERROR-FORMAT
  9430                                 THRU 9900-EXIT
  9431        end-if
  9432     END-IF
  9433*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9434*       MOVE +0                  TO SUB3
  9435*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9436*       IF SUB3 > +0
  9437*          MOVE ER-2722          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 173
* EL050.cbl
  9438*          PERFORM 9900-ERROR-FORMAT
  9439*                                THRU 9900-EXIT
  9440*       END-IF
  9441*    END-IF
  9442*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9443*       IF PB-CERT-PRIME NOT NUMERIC
  9444*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9445*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9446*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9447*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9448*
  9449*          MOVE ER-2722          TO WS-ERROR
  9450*          PERFORM 9900-ERROR-FORMAT
  9451*                                THRU 9900-EXIT
  9452*       END-IF
  9453*    END-IF
  9454
  9455     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9456
  9457     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9458        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9459                                    WS-TOL-AH-CLAIM.
  9460
  9461     IF CF-ST-REFUND-MIN NOT NUMERIC
  9462        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9463
  9464     IF CF-ST-REFUND-MIN NOT = ZEROS
  9465        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9466
  9467     IF CF-ST-TOL-PREM  NOT = ZEROS
  9468        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9469                                    WS-TOL-AH-PREM
  9470        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9471
  9472     IF CF-ST-TOL-REFUND NOT = ZEROS
  9473        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9474                                    WS-TOL-AH-REFUND
  9475        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9476
  9477     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9478        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9479        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9480                                    WS-AH-REFUND-OVS-AMT
  9481                                    EC-ST-OVR-SHT-AMT.
  9482
  9483     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9484        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9485        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9486                                    WS-TOL-LF-PREM-PCT
  9487                                    WS-TOL-AH-PREM-PCT.
  9488
  9489     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9490        CF-ST-TOL-REF-PCT GREATER THAN +0
  9491        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9492                                    WS-TOL-LF-REFUND-PCT
  9493                                    WS-TOL-AH-REFUND-PCT.
  9494
  9495     IF CF-ST-OVR-SHT-PCT NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 174
* EL050.cbl
  9496        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9497        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9498                                    WS-AH-REFUND-OVS-PCT
  9499                                    EC-ST-OVR-SHT-PCT.
  9500
  9501     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9502     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9503
  9504     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9505          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9506
  9507     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9508     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9509     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9510
  9511     IF CF-ST-LF-PREM-TAX NUMERIC
  9512        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9513     END-IF
  9514     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9515        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9516     END-IF
  9517     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9518        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9519     END-IF
  9520
  9521     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9522         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9523     END-IF.
  9524
  9525     IF WS-LF-BENEFIT-CD = ZEROS
  9526        GO TO 0410-CHECK-AH.
  9527
  9528     IF CF-ST-RT-CALC NOT = SPACES
  9529        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9530                                    EC-ST-LF-REM-TERM-CALC
  9531     END-IF
  9532
  9533     IF WS-LF-COVERAGE-TYPE = 'R'
  9534        IF WS-LF-EARNINGS-CALC = '5'
  9535           IF CF-ST-RF-LN-CALC > '0'
  9536              MOVE CF-ST-RF-LN-CALC
  9537                                 TO WS-LF-REFUND-CALC
  9538                                    EC-ST-LF-REFUND-CALC
  9539           END-IF
  9540        ELSE
  9541           IF CF-ST-RF-LR-CALC > '0'
  9542              MOVE CF-ST-RF-LR-CALC
  9543                                 TO WS-LF-REFUND-CALC
  9544                                    EC-ST-LF-REFUND-CALC
  9545           END-IF
  9546        END-IF
  9547     ELSE
  9548        IF CF-ST-RF-LL-CALC > '0'
  9549           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9550                                    EC-ST-LF-REFUND-CALC
  9551        END-IF
  9552     END-IF
  9553
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 175
* EL050.cbl
  9554     IF CF-ST-RT-CALC NOT = SPACES
  9555        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9556                                    EC-ST-LF-REM-TERM-CALC
  9557     END-IF
  9558
  9559     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9560     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9561
  9562     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9563
  9564     IF NO-BENEFIT-FOUND
  9565        GO TO 0410-CHECK-AH.
  9566
  9567     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9568        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9569                                 TO EC-ST-LF-REM-TERM-CALC
  9570                                    WS-LF-REM-TERM-CALC
  9571     END-IF
  9572
  9573     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9574        MOVE CF-ST-REFUND-CALC (SUB3)
  9575                                 TO WS-LF-REFUND-CALC
  9576                                    EC-ST-LF-REFUND-CALC
  9577     END-IF
  9578*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9579
  9580     .
  9581 0410-CHECK-AH.
  9582
  9583     IF WS-AH-BENEFIT-CD = ZEROS
  9584        GO TO 0500-SET-ACCOUNT.
  9585
  9586     IF CF-ST-RT-CALC NOT = SPACES
  9587        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9588                                    EC-ST-AH-REM-TERM-CALC
  9589     END-IF
  9590
  9591     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9592        IF CF-ST-RF-CP-CALC > '0'
  9593           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9594                                    EC-ST-AH-REFUND-CALC
  9595        END-IF
  9596     ELSE
  9597        IF CF-ST-RF-AH-CALC > '0'
  9598           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9599                                    EC-ST-AH-REFUND-CALC
  9600        END-IF
  9601     END-IF
  9602     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9603     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9604
  9605     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9606
  9607     IF NO-BENEFIT-FOUND
  9608        GO TO 0500-SET-ACCOUNT.
  9609
  9610     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9611        MOVE CF-ST-REM-TERM-CALC (SUB3)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 176
* EL050.cbl
  9612                                 TO WS-AH-REM-TERM-CALC
  9613                                    EC-ST-AH-REM-TERM-CALC
  9614     END-IF
  9615
  9616     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9617        MOVE CF-ST-REFUND-CALC (SUB3)
  9618                                 TO WS-AH-REFUND-CALC
  9619                                    EC-ST-AH-REFUND-CALC
  9620     END-IF
  9621
  9622*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9623
  9624     GO TO 0500-SET-ACCOUNT.
  9625
  9626 0499-STATE-NOT-FOUND.
  9627
  9628     MOVE ER-2603                TO WS-ERROR.
  9629     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9630
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 177
* EL050.cbl
  9632
  9633 0500-SET-ACCOUNT.
  9634*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9635     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9636        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9637        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9638        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9639        MOVE '3'                 TO CNTL-REC-TYPE
  9640        MOVE +0                  TO CNTL-SEQ-NO
  9641
  9642        MOVE '3'                 TO RC-SW-2
  9643        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9644
  9645        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9646           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9647           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9648           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9649                                    WS-ST-AH-PREM-TAX-I
  9650                                    WS-ST-AH-PREM-TAX-G
  9651        ELSE
  9652           IF CF-ST-LF-PREM-TAX NUMERIC
  9653              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9654           END-IF
  9655           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9656              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9657           END-IF
  9658           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9659              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9660           END-IF
  9661        END-IF
  9662        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9663     END-IF
  9664*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9665*  FOR DCC ONLY
  9666     IF PB-COMPANY-ID = 'DCC'
  9667
  9668     MOVE ' '                    TO STAT-MASTER-SW
  9669     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9670     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9671     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9672     MOVE PB-STATE               TO ELSTAT-STATE
  9673     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9674        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9675     END-IF
  9676
  9677     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9678     SET BIN-TO-GREG             TO TRUE
  9679     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9680     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9681     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9682
  9683     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9684     IF STAT-MASTER-FOUND
  9685        MOVE 'N'                 TO STAT-MASTER-SW
  9686        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9687        IF STAT-MASTER-FOUND
  9688           IF (ELSTAT-KEY-SAVE (1:12) =
  9689                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 178
* EL050.cbl
  9690              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9691                 MOVE 'F'        TO STAT-MASTER-SW
  9692              ELSE
  9693                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9694                 IF (STAT-MASTER-FOUND)
  9695                    AND (ELSTAT-KEY-SAVE (1:12) =
  9696                        SF-CONTROL-PRIMARY (1:12))
  9697                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9698                    MOVE 'F'     TO STAT-MASTER-SW
  9699                 END-IF
  9700              END-IF
  9701           END-IF
  9702        END-IF
  9703     END-IF
  9704
  9705     IF STAT-MASTER-SW = 'F'
  9706        IF SF-ST-LF-PREM-TAX NUMERIC
  9707           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9708        END-IF
  9709        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9710           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9711        END-IF
  9712        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9713           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9714        END-IF
  9715     END-IF
  9716
  9717     END-IF
  9718     IF (PB-COMPANY-ID = 'DCC')
  9719        AND (PB-ISSUE)
  9720        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9721        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9722        AND (AM-GPCD = 06)
  9723        MOVE 'Y'                 TO WS-GOOD-HIN
  9724        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9725           MOVE PB-I-VIN         TO WS-WORK-VIN
  9726           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9727              (V1 > 16)
  9728              IF WS-WORK-VIN (V1:1) NUMERIC
  9729                 MOVE WS-WORK-VIN-N (V1)
  9730                                 TO WS-ROW-B-VAL (V1)
  9731              ELSE
  9732                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9733                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9734                    OR (V2 > 26)
  9735                 END-PERFORM
  9736                 IF V2 < 27
  9737                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9738                 ELSE
  9739                    MOVE 'N'     TO WS-GOOD-HIN
  9740                 END-IF
  9741              END-IF
  9742              COMPUTE WS-ROW-D-VAL (V1) =
  9743                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9744              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9745                 WS-ROW-D-VAL (V1)
  9746           END-PERFORM
  9747           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 179
* EL050.cbl
  9748           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9749             REMAINDER WS-VIN-REMAINDER
  9750           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9751              CONTINUE
  9752           ELSE
  9753              MOVE 'N'           TO WS-GOOD-HIN
  9754           END-IF
  9755        ELSE
  9756           MOVE 'N'              TO WS-GOOD-HIN
  9757        END-IF
  9758        IF WS-GOOD-HIN NOT = 'Y'
  9759           MOVE ER-3826           TO WS-ERROR
  9760           PERFORM 9900-ERROR-FORMAT
  9761                                 THRU 9900-EXIT
  9762        END-IF
  9763     END-IF
  9764     IF (PB-COMPANY-ID = 'DCC')
  9765        AND (PB-ISSUE)
  9766        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9767        AND (AM-GPCD NOT = 06)
  9768        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9769          MOVE PB-I-VIN          TO WS-WORK-VIN
  9770          MOVE +8                TO V2
  9771          MOVE ZEROS             TO WS-VIN-TOTAL
  9772          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9773           (V1 > 17)
  9774             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9775                MOVE ER-3825     TO WS-ERROR
  9776                PERFORM 9900-ERROR-FORMAT
  9777                                 THRU 9900-EXIT
  9778             ELSE
  9779                IF V1 = 8
  9780                   MOVE 10       TO V2
  9781                END-IF
  9782                IF V1 = 9
  9783                   MOVE 0        TO V2
  9784                END-IF
  9785                IF V1 = 10
  9786                   MOVE 9        TO V2
  9787                END-IF
  9788                IF WS-WORK-VIN (V1:1) NUMERIC
  9789                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9790                    + (WS-WORK-VIN-N (V1) * V2)
  9791                ELSE
  9792                   MOVE WS-WORK-VIN (V1:1)
  9793                                 TO WS-HEX-BYTE
  9794                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9795                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9796                    + (WS-NUM (V3) * V2)
  9797                END-IF
  9798                COMPUTE V2 = V2 - 1
  9799             END-IF
  9800          END-PERFORM
  9801          MOVE ZEROS TO WS-VIN-REMAINDER
  9802          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9803             REMAINDER WS-VIN-REMAINDER
  9804          IF ((WS-WORK-VIN (9:1) = 'X')
  9805             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 180
* EL050.cbl
  9806                     OR
  9807             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9808             CONTINUE
  9809          ELSE
  9810             MOVE ER-3826        TO WS-ERROR
  9811             PERFORM 9900-ERROR-FORMAT
  9812                                 THRU 9900-EXIT
  9813          END-IF
  9814        ELSE
  9815          MOVE ER-3826           TO WS-ERROR
  9816          PERFORM 9900-ERROR-FORMAT
  9817                                 THRU 9900-EXIT
  9818        END-IF
  9819     END-IF
  9820******************************************************************
  9821******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9822******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9823******* METHODS.
  9824******************************************************************
  9825     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9826        IF PB-CANCELLATION
  9827           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9828              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9829                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9830                IF FORM-MASTER-FOUND
  9831                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9832******************************************************************
  9833
  9834     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9835     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9836
  9837     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9838     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9839     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9840     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9841
  9842
  9843     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9844     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9845     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9846
  9847     IF AM-LF-OB-RATE NOT NUMERIC
  9848         MOVE ZERO               TO AM-LF-OB-RATE.
  9849
  9850     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9851         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9852
  9853     IF AM-AH-OB-RATE NOT NUMERIC
  9854         MOVE ZERO               TO AM-AH-OB-RATE.
  9855
  9856     IF WS-LF-JOINT-INDICATOR = 'J'
  9857         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9858     ELSE
  9859         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9860
  9861     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9862
  9863     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 181
* EL050.cbl
  9864         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9865
  9866     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9867         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9868                                       WS-IG-OVRD
  9869     ELSE
  9870         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9871             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9872                                       WS-IG-OVRD
  9873         ELSE
  9874             MOVE AM-IG             TO WS-IG-OVRD-AH
  9875                                       WS-IG-OVRD.
  9876
  9877     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9878         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9879                                       WS-IG-OVRD
  9880     ELSE
  9881         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9882             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9883                                       WS-IG-OVRD
  9884         ELSE
  9885             MOVE AM-IG             TO WS-IG-OVRD-LF
  9886                                       WS-IG-OVRD.
  9887
  9888     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9889     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9890     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9891     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
  9892     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
  9893
  9894     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
  9895     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
  9896     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
  9897     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
  9898
  9899     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
  9900     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
  9901     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
  9902     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
  9903     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
  9904     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
  9905     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
  9906
  9907     IF WS-ACCT-AH-DEV-PCT > +0
  9908        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
  9909     ELSE
  9910        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
  9911
  9912     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
  9913        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
  9914     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
  9915        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
  9916
  9917        IF AM-EARN-METHOD-L = 'S'
  9918            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9919                                        WS-LF-REFUND-CALC.
  9920
  9921        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 182
* EL050.cbl
  9922            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9923                                        WS-LF-REFUND-CALC.
  9924
  9925     IF WS-LF-COVERAGE-TYPE = 'R'
  9926         IF AM-EARN-METHOD-R = 'R'
  9927            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9928                                    WS-LF-REFUND-CALC.
  9929     IF WS-LF-COVERAGE-TYPE = 'R'
  9930         IF AM-EARN-METHOD-R = 'P'
  9931            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9932                                    WS-LF-REFUND-CALC.
  9933     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9934         IF AM-EARN-METHOD-L = 'R'
  9935            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9936                                    WS-LF-REFUND-CALC.
  9937     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9938         IF AM-EARN-METHOD-L = 'P'
  9939            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9940                                    WS-LF-REFUND-CALC.
  9941     IF WS-LF-COVERAGE-TYPE = 'R'
  9942         IF AM-EARN-METHOD-R = 'A'
  9943            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9944                                    WS-LF-REFUND-CALC.
  9945     IF WS-LF-COVERAGE-TYPE = 'R'
  9946         IF AM-EARN-METHOD-R = 'M'
  9947            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9948                                    WS-LF-REFUND-CALC.
  9949     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9950         IF AM-EARN-METHOD-L = 'A'
  9951            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9952                                    WS-LF-REFUND-CALC.
  9953     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9954         IF AM-EARN-METHOD-L = 'M'
  9955            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9956                                    WS-LF-REFUND-CALC.
  9957
  9958     IF AM-EARN-METHOD-A = 'R'
  9959        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
  9960                                    WS-AH-REFUND-CALC.
  9961     IF AM-EARN-METHOD-A = 'P'
  9962        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
  9963                                    WS-AH-REFUND-CALC.
  9964     IF AM-EARN-METHOD-A = 'C'
  9965        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
  9966                                    WS-AH-REFUND-CALC.
  9967     IF AM-EARN-METHOD-A = 'A'
  9968        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
  9969                                    WS-AH-REFUND-CALC.
  9970     IF AM-EARN-METHOD-A = 'M'
  9971        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
  9972                                    WS-AH-REFUND-CALC.
  9973     IF AM-EARN-METHOD-A = 'N'
  9974        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
  9975                                    WS-AH-REFUND-CALC.
  9976     IF AM-EARN-METHOD-A = 'S'
  9977        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
  9978                                    WS-AH-REFUND-CALC.
  9979
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 183
* EL050.cbl
  9980     IF AM-TOL-PREM NOT = ZEROS
  9981        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
  9982                                    WS-TOL-AH-PREM.
  9983
  9984     IF AM-OVR-SHT-AMT NUMERIC AND
  9985                  AM-OVR-SHT-AMT > 0
  9986        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
  9987                                    EC-AM-LF-OVR-SHT-AMT
  9988                                    WS-AH-REFUND-OVS-AMT
  9989                                    EC-AM-AH-OVR-SHT-AMT.
  9990
  9991     IF AM-OVR-SHT-PCT NUMERIC AND
  9992                    AM-OVR-SHT-PCT > 0
  9993        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
  9994                                    EC-AM-LF-OVR-SHT-PCT
  9995                                    WS-AH-REFUND-OVS-PCT
  9996                                    EC-AM-AH-OVR-SHT-PCT.
  9997
  9998     IF AM-TOL-REF-PCT NUMERIC AND
  9999                  AM-TOL-REF-PCT > 0
 10000        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10001                                    WS-TOL-AH-REFUND-PCT.
 10002
 10003     IF AM-TOL-REF  NOT = ZEROS  AND
 10004                  AM-TOL-REF NUMERIC
 10005        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10006                                    EC-AM-LF-TOL-REFUND
 10007                                    WS-TOL-AH-REFUND
 10008                                    EC-AM-AH-TOL-REFUND.
 10009
 10010     IF AM-TOL-CLM  NOT = ZEROS
 10011        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10012                                    WS-TOL-AH-CLAIM.
 10013
 10014     IF AM-CLP-TOL-PCT NOT NUMERIC
 10015        MOVE +0                  TO AM-CLP-TOL-PCT
 10016     END-IF
 10017
 10018     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10019        MOVE +0                  TO AM-SPP-LEASE-COMM
 10020     END-IF
 10021     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10022        MOVE WS-PL-TOL-LF-PREM-PCT
 10023                                 TO WS-TOL-LF-PREM-PCT.
 10024
 10025     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10026        MOVE WS-PL-TOL-AH-PREM-PCT
 10027                                 TO WS-TOL-AH-PREM-PCT.
 10028
 10029     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10030        MOVE WS-PL-TOL-LF-REFUND-PCT
 10031                                 TO WS-TOL-LF-REFUND-PCT.
 10032
 10033     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10034        MOVE WS-PL-TOL-AH-REFUND-PCT
 10035                                 TO WS-TOL-AH-REFUND-PCT.
 10036
 10037     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 184
* EL050.cbl
 10038        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10039
 10040     IF WS-PL-REF-OVS-PCT > +0
 10041        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10042
 10043     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10044        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10045     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10046        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10047     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10048        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10049     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10050        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10051     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10052        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10053     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10054        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10055
 10056     IF WS-AH-PL-REF-OVS-AMT > +0
 10057        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10058
 10059     IF WS-AH-PL-REF-OVS-PCT > +0
 10060        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10061
 10062     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10063     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10064
 10065     IF PB-CANCELLATION
 10066        GO TO 3000-CONTINUE-EDIT.
 10067
 10068     MOVE +1 TO SUB1.
 10069     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10070     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10071
 10072     IF CF-COMPANY-ID = 'DMD'
 10073       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10074         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10075        ELSE
 10076         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10077
 10078  0525-FIND-ACCT-COMM.
 10079     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10080        NEXT SENTENCE
 10081      ELSE
 10082         ADD +1 TO SUB1
 10083         IF SUB1 LESS +11
 10084            GO TO 0525-FIND-ACCT-COMM
 10085          ELSE
 10086             GO TO 0560-EDIT-CONTINUE.
 10087
 10088     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10089     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10090                                    PB-I-LIFE-COMMISSION.
 10091***  IF PB-COMPANY-ID = 'CRI'
 10092     IF PB-PREM-ACCTNG-ONLY
 10093         GO TO 0560-EDIT-CONTINUE.
 10094
 10095     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 185
* EL050.cbl
 10096     MOVE ' '    TO WS-CTBL-READ-SW.
 10097
 10098
 10099 0530-GET-AH-COMP.
 10100     IF NO-AH-COVERAGE  OR
 10101        NO-AH-BENEFIT-MATCH
 10102           GO TO 0540-NEXT-READ-STEP.
 10103
 10104     IF AM-A-COM (SUB1) NUMERIC
 10105        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10106         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10107         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10108         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10109         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10110     ELSE
 10111          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10112          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10113          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10114          MOVE ZEROS             TO WS-SUB1
 10115                                    WS-COMMISSION
 10116          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10117          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10118          IF WS-COMMISSION > ZEROS
 10119             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10120             GO TO 0540-NEXT-READ-STEP
 10121          END-IF
 10122          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10123          IF CTBL-TABLE-FOUND
 10124             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10125                                        PB-I-AH-TERM
 10126             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10127             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10128             GO TO 0540-NEXT-READ-STEP
 10129          ELSE
 10130             IF FIRST-TIME-THROUGH
 10131                 GO TO 0530-GET-AH-COMP
 10132             ELSE
 10133                 MOVE ER-2609                TO WS-ERROR
 10134                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10135
 10136 0540-NEXT-READ-STEP.
 10137     MOVE '0540' TO CTBL-SW.
 10138     MOVE ' '    TO WS-CTBL-READ-SW.
 10139
 10140 0540-GET-LF-COMP.
 10141     IF NO-LIFE-COVERAGE  OR
 10142        NO-LF-BENEFIT-MATCH
 10143           GO TO 0560-EDIT-CONTINUE.
 10144
 10145     IF WS-LF-JOINT-INDICATOR = 'J'
 10146        IF AM-J-COM (SUB1) NUMERIC
 10147           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10148           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10149           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10150           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10151           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10152        ELSE
 10153           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 186
* EL050.cbl
 10154           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10155           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10156           MOVE ZEROS                TO WS-SUB1
 10157                                        WS-COMMISSION
 10158           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10159           IF WS-COMMISSION > ZEROS
 10160              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10161              GO TO 0560-EDIT-CONTINUE
 10162           END-IF
 10163           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10164           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10165           IF CTBL-TABLE-FOUND
 10166              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10167              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10168              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10169              GO TO 0560-EDIT-CONTINUE
 10170           ELSE
 10171              IF FIRST-TIME-THROUGH
 10172                  GO TO 0540-GET-LF-COMP
 10173              ELSE
 10174                  MOVE ER-2609                TO WS-ERROR
 10175                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10176                  GO TO 0560-EDIT-CONTINUE.
 10177
 10178     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10179        IF AM-L-COM (SUB1) NUMERIC
 10180           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10181           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10182           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10183           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10184           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10185        ELSE
 10186           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10187           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10188           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10189           MOVE ZEROS                TO WS-SUB1
 10190                                        WS-COMMISSION
 10191           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10192           IF WS-COMMISSION IS GREATER THAN ZEROS
 10193              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10194              GO TO 0560-EDIT-CONTINUE
 10195           END-IF
 10196           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10197           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10198           IF CTBL-TABLE-FOUND
 10199              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10200              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10201              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10202              GO TO 0560-EDIT-CONTINUE
 10203           ELSE
 10204              IF FIRST-TIME-THROUGH
 10205                  GO TO 0540-GET-LF-COMP
 10206              ELSE
 10207                  MOVE ER-2609                TO WS-ERROR
 10208                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10209
 10210*    GO TO 0560-EDIT-CONTINUE.
 10211
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 187
* EL050.cbl
 10212 0560-EDIT-CONTINUE.
 10213     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10214                                    WS-AH-PMF-COMM
 10215*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10216*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10217     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10218        (SUB1 > +10)
 10219        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10220           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10221           MOVE '0530'           TO CTBL-SW
 10222           MOVE ' '              TO WS-CTBL-READ-SW
 10223           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10224           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10225           MOVE '0540'           TO CTBL-SW
 10226           MOVE ' '              TO WS-CTBL-READ-SW
 10227           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10228        END-IF
 10229     END-PERFORM
 10230     GO TO 0564-EDIT-CONTINUE
 10231     .
 10232 0561-CHECK-AH.
 10233     IF (NO-AH-COVERAGE)
 10234        OR (NO-AH-BENEFIT-MATCH)
 10235        CONTINUE
 10236     ELSE
 10237        IF (AM-A-COM (SUB1) NUMERIC)
 10238           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10239           IF (AM-COM-TYP (SUB1) = 'A')
 10240              AND (WS-AH-PMF-COMM = ZEROS)
 10241              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10242           END-IF
 10243           CONTINUE
 10244        ELSE
 10245           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10246           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10247           MOVE PB-AH-OVERRIDE-L1
 10248                                 TO CTBL-BEN-TYPE
 10249           MOVE ZEROS            TO WS-SUB1
 10250                                    WS-COMMISSION
 10251           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10252           PERFORM 8300-READ-CTBL-TABLE
 10253                                 THRU 8300-EXIT
 10254           IF CTBL-TABLE-FOUND
 10255              IF (AM-COM-TYP (SUB1) = 'A')
 10256                 AND (WS-AH-PMF-COMM = ZEROS)
 10257                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10258                                        PB-I-AH-TERM
 10259                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10260                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10261              END-IF
 10262              CONTINUE
 10263           ELSE
 10264              IF FIRST-TIME-THROUGH
 10265                 GO TO 0561-CHECK-AH
 10266              ELSE
 10267                 MOVE ER-2609    TO WS-ERROR
 10268                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10269              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 188
* EL050.cbl
 10270           END-IF
 10271        END-IF
 10272     END-IF
 10273     .
 10274 0561-EXIT.
 10275     EXIT.
 10276 0563-CHECK-LF.
 10277     IF (NO-LIFE-COVERAGE)
 10278        OR (NO-LF-BENEFIT-MATCH)
 10279        CONTINUE
 10280     ELSE
 10281        IF WS-LF-JOINT-INDICATOR = 'J'
 10282           IF AM-J-COM (SUB1) NUMERIC
 10283              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10284              IF (AM-COM-TYP (SUB1) = 'A')
 10285                 AND (WS-LF-PMF-COMM = ZEROS)
 10286                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10287              END-IF
 10288              CONTINUE
 10289           ELSE
 10290              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10291              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10292              MOVE PB-LIFE-OVERRIDE-L1
 10293                                 TO CTBL-BEN-TYPE
 10294              MOVE ZEROS         TO WS-SUB1
 10295                                    WS-COMMISSION
 10296              MOVE AM-J-COMA (SUB1)
 10297                                 TO CTBL-TABLE
 10298              PERFORM 8300-READ-CTBL-TABLE
 10299                                 THRU 8300-EXIT
 10300              IF CTBL-TABLE-FOUND
 10301                 IF (AM-COM-TYP (SUB1) = 'A')
 10302                    AND (WS-LF-PMF-COMM = ZEROS)
 10303                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10304                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10305                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10306                 END-IF
 10307                 CONTINUE
 10308              ELSE
 10309                 IF FIRST-TIME-THROUGH
 10310                    GO TO 0563-CHECK-LF
 10311                 ELSE
 10312                    MOVE ER-2609 TO WS-ERROR
 10313                    PERFORM 9900-ERROR-FORMAT
 10314                                 THRU 9900-EXIT
 10315*                   GO TO 0560-EDIT-CONTINUE
 10316                 END-IF
 10317              END-IF
 10318           END-IF
 10319        ELSE
 10320           IF AM-L-COM (SUB1) NUMERIC
 10321              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10322              IF (AM-COM-TYP (SUB1) = 'A')
 10323                 AND (WS-LF-PMF-COMM = ZEROS)
 10324                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10325              END-IF
 10326              CONTINUE
 10327           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 189
* EL050.cbl
 10328              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10329              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10330              MOVE PB-LIFE-OVERRIDE-L1
 10331                                 TO CTBL-BEN-TYPE
 10332              MOVE ZEROS         TO WS-SUB1
 10333                                    WS-COMMISSION
 10334              MOVE AM-L-COMA (SUB1)
 10335                                 TO CTBL-TABLE
 10336              PERFORM 8300-READ-CTBL-TABLE
 10337                                 THRU 8300-EXIT
 10338              IF CTBL-TABLE-FOUND
 10339                 CONTINUE
 10340              ELSE
 10341                 IF FIRST-TIME-THROUGH
 10342                    GO TO 0563-CHECK-LF
 10343                 ELSE
 10344                    MOVE ER-2609 TO WS-ERROR
 10345                    PERFORM 9900-ERROR-FORMAT
 10346                                 THRU 9900-EXIT
 10347                 END-IF
 10348              END-IF
 10349           END-IF
 10350        END-IF
 10351     END-IF
 10352     .
 10353 0563-EXIT.
 10354     EXIT.
 10355 0564-EDIT-CONTINUE.
 10356
 10357     IF  PB-COMPANY-ID EQUAL 'DMD'
 10358         IF PB-I-NUM-BILLED EQUAL ZEROS
 10359            MOVE ER-8148       TO WS-ERROR
 10360            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10361
 10362*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10363*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10364*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10365*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10366*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10367*         IF NO-CONVERSION-ERROR
 10368*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10369*         ELSE
 10370*             IF PB-COMPANY-ID EQUAL 'HAN'
 10371*                 MOVE ZEROS     TO PB-I-AGE.
 10372     IF PB-I-BIRTHDAY > LOW-VALUES
 10373        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10374        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10375        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10376        PERFORM 8500-DATE-CONVERT
 10377                                 THRU 8500-EXIT
 10378        IF NO-CONVERSION-ERROR
 10379           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10380           IF PB-I-AGE > ZEROS
 10381              IF WS-WORK-AGE NOT = PB-I-AGE
 10382                 MOVE ER-9501    TO WS-ERROR
 10383                 PERFORM 9900-ERROR-FORMAT
 10384                                 THRU 9900-EXIT
 10385              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 190
* EL050.cbl
 10386           ELSE
 10387              MOVE WS-WORK-AGE   TO PB-I-AGE
 10388           END-IF
 10389        END-IF
 10390     END-IF
 10391     IF PB-I-AGE = ZEROS
 10392        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10393           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10394
 10395     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10396                                   WS-AH-EDIT-AGE.
 10397
 10398     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10399        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10400        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10401        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10402        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10403        IF NO-CONVERSION-ERROR
 10404           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10405           IF PB-I-JOINT-AGE > 0
 10406              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10407                 MOVE ER-9503    TO WS-ERROR
 10408                 PERFORM 9900-ERROR-FORMAT
 10409                                 THRU 9900-EXIT
 10410              END-IF
 10411           ELSE
 10412              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10413           END-IF
 10414        ELSE
 10415           MOVE ZEROS            TO PB-I-JOINT-AGE
 10416        END-IF
 10417     END-IF
 10418     IF PB-I-JOINT-AGE NOT NUMERIC
 10419        MOVE ZERO               TO PB-I-JOINT-AGE.
 10420
 10421     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10422        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10423           (WS-AH-JOINT-INDICATOR = 'J')
 10424           IF PB-I-JOINT-AGE = ZEROS
 10425               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10426           END-IF
 10427        END-IF
 10428     END-IF
 10429
 10430     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10431     IF WS-LF-JOINT-INDICATOR = 'J'
 10432        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10433        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10434            IF  PB-I-JOINT-AGE = ZERO
 10435                MOVE ER-2686       TO WS-ERROR
 10436                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10437            ELSE
 10438                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10439                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10440                    IF PB-COMPANY-ID NOT = 'LBL'
 10441                        MOVE ER-2685    TO WS-ERROR
 10442                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10443
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 191
* EL050.cbl
 10444     IF WS-AH-JOINT-INDICATOR = 'J'
 10445        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10446            IF  PB-I-JOINT-AGE = ZERO
 10447                MOVE ER-2686       TO WS-ERROR
 10448                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10449            ELSE
 10450                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10451                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10452                                           WS-EDIT-AGE
 10453                    IF PB-COMPANY-ID NOT = 'LBL'
 10454                        MOVE ER-2685    TO WS-ERROR
 10455                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10456
 10457******************************************************************
 10458*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10459******************************************************************
 10460
 10461     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10462        (WS-AH-SPECIAL-CALC-CD = 'O')
 10463        NEXT SENTENCE
 10464     ELSE
 10465        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10466          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10467           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10468            WS-AH-JOINT-INDICATOR = 'J')  AND
 10469           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10470            MOVE ER-2627             TO WS-ERROR
 10471            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10472
 10473     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10474        (WS-AH-SPECIAL-CALC-CD = 'O')
 10475         NEXT SENTENCE
 10476     ELSE
 10477         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10478            WS-AH-JOINT-INDICATOR = 'J'
 10479             IF PB-I-JOINT-INSURED = SPACES
 10480                 IF PB-COMPANY-ID NOT = 'JAL'
 10481                     MOVE ER-2696    TO WS-ERROR
 10482                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10483
 10484     IF PB-COMPANY-ID NOT = 'BOA'
 10485        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10486           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10487           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10488               PB-I-JOINT-INSURED NOT = SPACES)
 10489                MOVE ER-2691         TO WS-ERROR
 10490                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10491
 10492     IF PB-COMPANY-ID = 'BOA'
 10493        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10494           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10495            IF PB-I-JOINT-AGE NOT = ZEROS
 10496                MOVE ER-2691         TO WS-ERROR
 10497                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10498
 10499     IF PB-COMPANY-ID = 'CRI'
 10500        IF PB-I-SIG-SW = 'J'
 10501           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 192
* EL050.cbl
 10502              WS-AH-JOINT-INDICATOR NOT = 'J'
 10503              MOVE ER-2675       TO WS-ERROR
 10504              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10505
 10506     IF PB-COMPANY-ID = 'CRI'
 10507        IF PB-I-SIG-SW = 'S'
 10508           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10509              WS-AH-JOINT-INDICATOR = 'J'
 10510              MOVE ER-2676       TO WS-ERROR
 10511              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10512
 10513     IF PB-COMPANY-ID = 'CVL'
 10514         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10515            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10516              MOVE ER-2783           TO WS-ERROR
 10517              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10518     IF (WS-LF-JOINT-INDICATOR = 'J')
 10519        AND (WS-AH-JOINT-INDICATOR = 'J')
 10520        AND (PB-I-LF-TERM > 120)
 10521        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10522        MOVE ER-2783             TO WS-ERROR
 10523        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10524     END-IF
 10525     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10526
 10527     IF PB-I-INDV-GRP-OVRD = 'I'
 10528        MOVE ER-2666             TO WS-ERROR
 10529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10530        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10531
 10532     IF PB-I-INDV-GRP-OVRD = 'G'
 10533        MOVE ER-2666             TO WS-ERROR
 10534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10535        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10536
 10537     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10538        NEXT SENTENCE
 10539     ELSE
 10540        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10541
 10542     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10543        IF WS-ERROR = ER-2666
 10544           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10545           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10546
 10547     IF PB-COMPANY-ID = 'CID'
 10548        IF PB-STATE = 'UT' OR 'MO'
 10549           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10550                 OR '76' OR '77')
 10551                      OR
 10552               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10553                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10554                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10555                   OR '2K' OR '2L'))
 10556              AND PB-I-INDV-GRP-CD = 'I'
 10557              MOVE ER-2721             TO WS-ERROR
 10558              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10559           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 193
* EL050.cbl
 10560        END-IF
 10561     END-IF
 10562
 10563     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10564     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10565        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10566     ELSE
 10567        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10568     END-IF
 10569
 10570*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10571*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10572     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10573                                    ACCOUNT-AH-CK-SW.
 10574
 10575     IF PB-REISSUED-CERT       OR
 10576        PB-REIN-ONLY-CERT      OR
 10577        PB-POLICY-IS-DECLINED  OR
 10578        PB-POLICY-IS-VOIDED
 10579*       OR PB-MONTHLY-CERT
 10580         GO TO 3000-CONTINUE-EDIT.
 10581
 10582     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10583        IF WS-EDIT-AGE           > +65
 10584           MOVE ER-2709          TO WS-ERROR
 10585           PERFORM 9900-ERROR-FORMAT
 10586                                 THRU 9900-EXIT
 10587        ELSE
 10588           IF WS-EDIT-AGE        > +55
 10589              MOVE ER-2718       TO WS-ERROR
 10590              PERFORM 9900-ERROR-FORMAT
 10591                                 THRU 9900-EXIT
 10592           END-IF
 10593        END-IF
 10594     IF PB-COMPANY-ID = 'DCC'
 10595        IF WS-EDIT-AGE           > +65
 10596           MOVE ER-2709          TO WS-ERROR
 10597           PERFORM 9900-ERROR-FORMAT
 10598                                 THRU 9900-EXIT
 10599        END-IF
 10600     END-IF
 10601     .
 10602
 10603 0565-LIFE-PLAN-LIMIT-EDITS.
 10604
 10605     IF NOT LF-PLAN-MASTER-FOUND
 10606        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10607                                    EC-AM-LF-MAX-TOT-BEN
 10608        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10609
 10610     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10611
 10612     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10613         IF PL-LM-AGE (1) = ZEROS
 10614             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10615
 10616     IF NO-LF-BENEFIT-MATCH          OR
 10617        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 194
* EL050.cbl
 10618        WS-LF-SPECIAL-CALC-CD = 'M'
 10619        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10620
 10621     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10622     MOVE +1                     TO SUB2.
 10623
 10624     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10625        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10626           MOVE +5   TO SUB2
 10627           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10628              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10629              (PL-LM-AGE (SUB2) EQUAL +0)
 10630              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10631              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10632
 10633     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10634
 10635     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10636                               + PB-I-LF-ALT-BENEFIT-AMT.
 10637
 10638 0568-CHECK-LIFE-ATT-AGE.
 10639
 10640     IF PL-ATT-AGE NUMERIC AND
 10641        PL-ATT-AGE > +0
 10642        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10643     END-IF
 10644*    IF PL-ATT-AGE NUMERIC AND
 10645*       PL-ATT-AGE > +0
 10646*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10647*       IF PB-I-BIRTHDAY > LOW-VALUES
 10648*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10649*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10650*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10651*          SET BIN-PLUS-ELAPSED  TO TRUE
 10652*          PERFORM 8500-DATE-CONVERT
 10653*                                THRU 8500-EXIT
 10654*          IF NO-CONVERSION-ERROR
 10655*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10656*             MOVE ER-2669       TO WS-ERROR
 10657*             PERFORM 9900-ERROR-FORMAT
 10658*                                THRU 9900-EXIT
 10659*          END-IF
 10660*       ELSE
 10661*          IF WS-ATT-AGE >= PL-ATT-AGE
 10662*             MOVE ER-2669       TO WS-ERROR
 10663*             PERFORM 9900-ERROR-FORMAT
 10664*                                THRU 9900-EXIT
 10665*          END-IF
 10666*       END-IF
 10667*    END-IF
 10668     .
 10669 0570-CHECK-LIFE-LIMITS.
 10670
 10671     IF PB-COMPANY-ID EQUAL 'CRI'
 10672        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10673           IF SUB2 GREATER THAN +4
 10674              MOVE ER-2637 TO WS-ERROR
 10675              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 195
* EL050.cbl
 10676              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10677
 10678     IF PB-COMPANY-ID  =  'NCL'
 10679        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10680            SUB2 GREATER THAN +8
 10681             MOVE 'U'         TO PB-BATCH-ENTRY
 10682             MOVE ER-2637     TO WS-ERROR
 10683             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10684             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10685
 10686     IF SUB2 > +8
 10687        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10688           AND (PB-I-SIG-SW = 'Y')
 10689           CONTINUE
 10690        ELSE
 10691           MOVE ER-2637          TO WS-ERROR
 10692           PERFORM 9900-ERROR-FORMAT
 10693                                 THRU 9900-EXIT
 10694        END-IF
 10695        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10696     END-IF
 10697     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10698     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10699     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10700
 10701     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10702        ADD +1  TO SUB2
 10703        GO TO 0570-CHECK-LIFE-LIMITS.
 10704
 10705     IF PB-COMPANY-ID = 'NCL'
 10706         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10707
 10708     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10709        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10710        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10711           AND (PB-I-SIG-SW = 'Y')
 10712           CONTINUE
 10713        ELSE
 10714           MOVE ER-2637          TO WS-ERROR
 10715           PERFORM 9900-ERROR-FORMAT
 10716                                 THRU 9900-EXIT
 10717        END-IF
 10718     END-IF
 10719     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10720
 10721
 10722 0570-CHECK-NCL-LIFE-LIMITS.
 10723
 10724     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10725        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10726         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10727
 10728     IF APP-CERT-USED
 10729         IF SUB2  LESS THAN  +5
 10730             MOVE +5          TO SUB2
 10731             GO TO 0570-CHECK-LIFE-LIMITS.
 10732
 10733     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 196
* EL050.cbl
 10734     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10735
 10736     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10737
 10738 0575-CHECK-NCL-SIG-SWITCH.
 10739
 10740     IF NOT APP-CERT-USED
 10741         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10742
 10743     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10744        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10745        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10746        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10747         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10748
 10749     IF SUB2 GREATER THAN +4
 10750         IF PL-LM-AGE (5) = ZEROS  AND
 10751            PL-LM-AGE (6) = ZEROS  AND
 10752            PL-LM-AGE (7) = ZEROS  AND
 10753            PL-LM-AGE (8) = ZEROS
 10754             MOVE  ER-1927        TO WS-ERROR
 10755             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10756             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10757         ELSE
 10758             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10759                 MOVE  ER-1920    TO WS-ERROR
 10760                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10761
 10762     IF PB-I-SIG-SW  = 'Y'
 10763       IF NOT PB-I-POLICY-ACCEPTED  AND
 10764          NOT PB-I-POLICY-DECLINED
 10765           MOVE 'U'               TO PB-BATCH-ENTRY
 10766           MOVE  ER-1926          TO WS-ERROR
 10767           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10768
 10769
 10770 0580-AH-PLAN-LIMIT-EDITS.
 10771
 10772     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10773        IF PB-I-AH-BENEFIT-AMT > +1250
 10774           MOVE ER-2702          TO WS-ERROR
 10775           PERFORM 9900-ERROR-FORMAT
 10776                                 THRU 9900-EXIT
 10777        END-IF
 10778     END-IF
 10779
 10780     IF (PB-COMPANY-ID = 'DCC')
 10781        AND (PB-MONTHLY-CERT)
 10782        IF PB-I-AH-BENEFIT-AMT > +1000
 10783           MOVE ER-2881          TO WS-ERROR
 10784           PERFORM 9900-ERROR-FORMAT
 10785                                 THRU 9900-EXIT
 10786        END-IF
 10787     END-IF
 10788     IF NOT AH-PLAN-MASTER-FOUND
 10789        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10790        GO TO 3000-CONTINUE-EDIT.
 10791
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 197
* EL050.cbl
 10792     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10793
 10794     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10795         IF PL-LM-AGE (1) = ZEROS
 10796             GO TO 3000-CONTINUE-EDIT.
 10797
 10798     IF NO-AH-BENEFIT-MATCH          OR
 10799        WS-AH-BENEFIT-CD = ZEROS     OR
 10800        WS-AH-SPECIAL-CALC-CD = 'M'
 10801        GO TO 3000-CONTINUE-EDIT.
 10802
 10803     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10804     MOVE +1                     TO SUB2.
 10805
 10806     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10807        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10808           MOVE +5 TO SUB2
 10809           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10810              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10811              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10812              (PL-LM-AGE (SUB2) EQUAL +0)
 10813              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10814              GO TO 3000-CONTINUE-EDIT.
 10815
 10816     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10817
 10818 0590-CHECK-AH-ATT-AGE.
 10819
 10820     IF PL-ATT-AGE NUMERIC AND
 10821        PL-ATT-AGE GREATER THAN +0
 10822        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10823     END-IF
 10824*       IF WS-ATT-AGE >= PL-ATT-AGE
 10825*          MOVE ER-3054          TO WS-ERROR
 10826*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10827     .
 10828 0597-CHECK-AH-LIMITS.
 10829
 10830     IF PB-COMPANY-ID EQUAL 'CRI'
 10831        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10832           IF SUB2 GREATER THAN +4
 10833              MOVE ER-2638       TO WS-ERROR
 10834              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10835              GO TO 3000-CONTINUE-EDIT.
 10836
 10837     IF PB-COMPANY-ID  =  'NCL'
 10838        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10839            SUB2 GREATER THAN +8
 10840             MOVE 'U'            TO PB-BATCH-ENTRY
 10841             MOVE ER-2638        TO WS-ERROR
 10842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10843             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10844
 10845     IF SUB2 > +8
 10846        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10847           AND (PB-I-SIG-SW = 'Y')
 10848           CONTINUE
 10849        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 198
* EL050.cbl
 10850           MOVE ER-2638          TO WS-ERROR
 10851           PERFORM 9900-ERROR-FORMAT
 10852                                 THRU 9900-EXIT
 10853        END-IF
 10854        GO TO 3000-CONTINUE-EDIT
 10855     END-IF
 10856
 10857     IF PB-COMPANY-ID = 'CRI'
 10858        IF WS-ERROR = ER-2638
 10859           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10860
 10861     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10862     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10863     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10864     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10865
 10866     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10867        ADD +1                   TO SUB2
 10868        GO TO 0597-CHECK-AH-LIMITS.
 10869
 10870     IF PB-COMPANY-ID = 'NCL'
 10871         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10872
 10873     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10874        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10875        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10876                                 > PL-LM-AMT (SUB2))
 10877        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10878           AND (PB-I-SIG-SW = 'Y')
 10879           CONTINUE
 10880        ELSE
 10881           MOVE ER-2638          TO WS-ERROR
 10882           PERFORM 9900-ERROR-FORMAT
 10883                                 THRU 9900-EXIT
 10884        END-IF
 10885     END-IF
 10886
 10887     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10888         IF  WS-ERROR    EQUAL    ER-2638
 10889             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10890                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10891                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10892                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10893                MOVE  ER-1910    TO  WS-ERROR
 10894                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 10895
 10896     IF PB-COMPANY-ID = 'CRI'
 10897        IF WS-ERROR = ER-2638
 10898            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10899            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10900            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 10901
 10902     GO TO 3000-CONTINUE-EDIT.
 10903
 10904 0597-CHECK-NCL-AH-LIMITS.
 10905
 10906     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 10907        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 199
* EL050.cbl
 10908        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10909                            NOT GREATER THAN PL-LM-AMT (SUB2))
 10910         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10911
 10912     IF APP-CERT-USED
 10913         IF SUB2  LESS THAN  +5
 10914             MOVE +5             TO SUB2
 10915             GO TO 0597-CHECK-AH-LIMITS.
 10916
 10917     MOVE ER-2638                TO WS-ERROR.
 10918     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10919
 10920     MOVE 'U'                    TO PB-BATCH-ENTRY.
 10921
 10922 0599-CHECK-NCL-SIG-SWITCH.
 10923
 10924     IF NOT APP-CERT-USED
 10925         GO TO 3000-CONTINUE-EDIT.
 10926
 10927     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10928        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10929        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10930        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10931         GO TO 3000-CONTINUE-EDIT.
 10932
 10933     IF SUB2 GREATER THAN +4
 10934         IF PL-LM-AGE (5) = ZEROS  AND
 10935            PL-LM-AGE (6) = ZEROS  AND
 10936            PL-LM-AGE (7) = ZEROS  AND
 10937            PL-LM-AGE (8) = ZEROS
 10938             MOVE  ER-1927        TO WS-ERROR
 10939             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10940             GO TO 3000-CONTINUE-EDIT
 10941         ELSE
 10942             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10943                 MOVE  ER-1920    TO WS-ERROR
 10944                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10945
 10946     IF PB-I-SIG-SW  = 'Y'
 10947       IF NOT PB-I-POLICY-ACCEPTED  AND
 10948          NOT PB-I-POLICY-DECLINED
 10949           MOVE 'U'               TO PB-BATCH-ENTRY
 10950           MOVE  ER-1926          TO WS-ERROR
 10951           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10952
 10953******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 200
* EL050.cbl
 10955
 10956 3000-CONTINUE-EDIT.
 10957
 10958     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10959     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 10960     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10961     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10962     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10963
 10964     IF BROWSE-STARTED
 10965        PERFORM 9990-RETURN THRU 9990-EXIT
 10966        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 10967
 10968     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 10969        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10970        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10971        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10972*       MOVE 1                   TO DC-OPTION-CODE
 10973        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10974        IF DATE-CONVERSION-ERROR
 10975           MOVE ER-2622          TO WS-ERROR
 10976           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10977        ELSE
 10978           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 10979              MOVE ER-2623       TO WS-ERROR
 10980              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10981           ELSE
 10982              MOVE ER-2622       TO WS-ERROR
 10983              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10984
 10985     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 10986     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 10987     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 10988*    MOVE 1                      TO DC-OPTION-CODE.
 10989     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10990     IF DATE-CONVERSION-ERROR
 10991        GO TO 3005-EDIT-CONTINUE
 10992     ELSE
 10993        IF DC-ELAPSED-DAYS GREATER +180
 10994           MOVE ER-2613          TO WS-ERROR
 10995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10996        ELSE
 10997           IF DC-ELAPSED-DAYS GREATER +90
 10998              MOVE ER-2612       TO WS-ERROR
 10999              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11000           ELSE
 11001             IF DC-ELAPSED-DAYS GREATER +60
 11002                MOVE ER-2614     TO WS-ERROR
 11003                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11004
 11005 3005-EDIT-CONTINUE.
 11006
 11007     IF PB-CANCELLATION
 11008         GO TO 3700-EDIT-CANCEL.
 11009
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 201
* EL050.cbl
 11011******************************************************************
 11012*                  E D I T   I S S U E                           *
 11013******************************************************************
 11014
 11015 3020-EDIT-ISSUE.
 11016
 11017      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11018      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11019      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11020      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11021      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11022
 11023     IF PB-ISSUE-FORCE
 11024        OR PB-ISSUE-DATE-FORCED
 11025        OR PB-FORCE-OFF
 11026        OR PB-OVERCHARGE-FORCE
 11027        CONTINUE
 11028     ELSE
 11029        MOVE ER-2670             TO WS-ERROR
 11030        PERFORM 9900-ERROR-FORMAT
 11031                                 THRU 9900-EXIT
 11032     END-IF
 11033     .
 11034 3022-SET-POLICY-STATUS.
 11035
 11036     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11037
 11038     IF (PB-REISSUED-CERT)
 11039             OR
 11040        ((PB-COMPANY-ID NOT = 'DCC')
 11041         AND (PB-MONTHLY-CERT))
 11042         MOVE '5'                TO PB-I-ENTRY-STATUS
 11043         MOVE 'E'                TO PB-BATCH-ENTRY
 11044     END-IF
 11045
 11046     IF PB-COMPANY-ID = 'DCC'
 11047        IF PB-MONTHLY-CERT
 11048           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11049        END-IF
 11050     END-IF
 11051     IF PB-POLICY-IS-DECLINED
 11052         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11053     IF PB-POLICY-IS-VOIDED
 11054         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11055     IF PB-NEEDS-UNDERWRITING
 11056         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11057     IF PB-REIN-ONLY-CERT
 11058         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11059     IF PB-PREM-ACCTNG-ONLY
 11060         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11061
 11062     MOVE SPACE                  TO PB-I-OB-FLAG.
 11063
 11064     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11065         MOVE ER-2665            TO WS-ERROR
 11066         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11067         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11068
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 202
* EL050.cbl
 11069     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11070        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11071           MOVE 'Z'             TO PB-I-OB-FLAG.
 11072
 11073     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11074        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11075           MOVE 'Z'             TO PB-I-OB-FLAG.
 11076
 11077     IF ACCOUNT-MAST-FOUND
 11078         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11079         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11080         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11081         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11082         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11083         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11084         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11085     END-IF
 11086
 11087     IF ACCOUNT-MAST-FOUND
 11088        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11089         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11090
 11091     IF (ACCOUNT-MAST-FOUND)
 11092        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11093        IF PB-REISSUED-CERT
 11094           CONTINUE
 11095        ELSE
 11096           MOVE ER-2608          TO WS-ERROR
 11097           PERFORM 9900-ERROR-FORMAT
 11098                                 THRU 9900-EXIT
 11099         END-IF
 11100     END-IF
 11101
 11102     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11103        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11104        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11105
 11106**********   DMD CUSTOM CODE FOLLOWS  **********
 11107 3024-EDIT-DMD-FIELDS.
 11108     IF PB-COMPANY-ID NOT = 'DMD'
 11109        GO TO 3025-EDIT-REINSURANCE.
 11110
 11111*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11112*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11113*** ERROR IF THEY ARE NOT EQUAL.
 11114
 11115     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11116     SET BIN-TO-GREG               TO TRUE.
 11117     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11118     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11119**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11120
 11121     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11122     SET BIN-TO-GREG               TO TRUE.
 11123     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11124     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11125**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11126
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 203
* EL050.cbl
 11127     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11128        MOVE ER-8116               TO WS-ERROR
 11129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11130
 11131     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11132
 11133     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11134                                      WK-FULL-CERT-NO.
 11135     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11136
 11137     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11138
 11139     IF PB-VALID-LIFE
 11140        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11141     ELSE
 11142        IF PB-VALID-AH
 11143          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11144
 11145
 11146     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11147     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11148     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11149                                      DCUA-UNDRWRTR-CODE
 11150                                      DCUA-UNDRWRTR-GROUP-CODE
 11151                                      DCUA-RETURN-CODE.
 11152
 11153****************************************************************
 11154*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11155***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11156***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11157***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11158***   TO THIS RECORD.                                        ***
 11159****************************************************************
 11160     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11161     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11162     IF DCUA-SUCCESSFUL-PROCESS
 11163        GO TO 3024-EDIT-DL7-CONT.
 11164
 11165     IF DCUA-RETURN-CODE EQUAL '01'
 11166        MOVE ER-8110               TO WS-ERROR
 11167        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11168        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11169        GO TO 3024-EDIT-DL7-CONT.
 11170
 11171     IF DCUA-RETURN-CODE EQUAL '02'
 11172        MOVE ER-8111               TO WS-ERROR
 11173        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11174        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11175        GO TO 3024-EDIT-DL7-CONT.
 11176
 11177     IF DCUA-RETURN-CODE EQUAL '03'
 11178        MOVE ER-8074               TO WS-ERROR
 11179        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11181        GO TO 3024-EDIT-DL7-CONT.
 11182
 11183     IF DCUA-RETURN-CODE EQUAL '04'
 11184        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 204
* EL050.cbl
 11185        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11187        GO TO 3024-EDIT-DL7-CONT.
 11188
 11189     IF DCUA-RETURN-CODE EQUAL '05'
 11190        MOVE ER-8076               TO WS-ERROR
 11191        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11193        GO TO 3024-EDIT-DL7-CONT.
 11194
 11195     IF DCUA-RETURN-CODE EQUAL '06'
 11196        MOVE ER-8077               TO WS-ERROR
 11197        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11198        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11199        GO TO 3024-EDIT-DL7-CONT.
 11200
 11201     IF DCUA-RETURN-CODE EQUAL '07'
 11202        MOVE ER-8078               TO WS-ERROR
 11203        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11205        GO TO 3024-EDIT-DL7-CONT.
 11206
 11207     IF DCUA-RETURN-CODE EQUAL 'E1'
 11208        MOVE ER-8079               TO WS-ERROR
 11209        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11211        GO TO 3024-EDIT-DL7-CONT.
 11212
 11213     IF DCUA-RETURN-CODE EQUAL 'E2'
 11214        MOVE ER-8080               TO WS-ERROR
 11215        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11217        GO TO 3024-EDIT-DL7-CONT.
 11218
 11219     IF DCUA-RETURN-CODE EQUAL 'E3'
 11220        MOVE ER-8098               TO WS-ERROR
 11221        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11223        GO TO 3024-EDIT-DL7-CONT.
 11224
 11225     IF DCUA-RETURN-CODE EQUAL 'C1'
 11226        MOVE ER-8099               TO WS-ERROR
 11227        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11229        GO TO 3024-EDIT-DL7-CONT.
 11230
 11231     IF DCUA-RETURN-CODE EQUAL 'U1'
 11232        MOVE ER-8109               TO WS-ERROR
 11233        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11235        GO TO 3024-EDIT-DL7-CONT.
 11236
 11237     IF DCUA-RETURN-CODE EQUAL 'N1'
 11238        MOVE ER-8112               TO WS-ERROR
 11239        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11241        GO TO 3024-EDIT-DL7-CONT.
 11242
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 205
* EL050.cbl
 11243     IF DCUA-RETURN-CODE EQUAL 'N2'
 11244        MOVE ER-8113               TO WS-ERROR
 11245        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11246        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11247        GO TO 3024-EDIT-DL7-CONT.
 11248
 11249     IF DCUA-RETURN-CODE EQUAL 'N3'
 11250        MOVE ER-8114               TO WS-ERROR
 11251        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11253        GO TO 3024-EDIT-DL7-CONT.
 11254
 11255     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11256     MOVE ER-8097                  TO WS-ERROR.
 11257     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11258     GO TO 3024-EDIT-DL7-CONT.
 11259
 11260 3024-EDIT-DL7-CONT.
 11261
 11262     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11263     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11264     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11265        NEXT SENTENCE
 11266     ELSE
 11267        MOVE ER-9263               TO WS-ERROR
 11268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11269
 11270******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11271******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11272     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11273        NEXT SENTENCE
 11274     ELSE
 11275        MOVE ER-8039               TO WS-ERROR
 11276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11277
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 206
* EL050.cbl
 11279****************************************************************
 11280*** VALIDATE STATE  : DLO022                                 ***
 11281****************************************************************
 11282     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11283     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11284
 11285     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11286     IF DVSC-SUCCESSFUL-EDIT
 11287        GO TO 3024-EDIT-DL22-CONT.
 11288
 11289     IF DVSC-RETURN-CODE EQUAL '01'
 11290        MOVE ER-8300               TO WS-ERROR
 11291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11292        GO TO 3024-EDIT-DL22-CONT.
 11293
 11294     IF DVSC-RETURN-CODE EQUAL '02'
 11295        MOVE ER-8301               TO WS-ERROR
 11296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11297        GO TO 3024-EDIT-DL22-CONT.
 11298
 11299     IF DVSC-RETURN-CODE EQUAL '03'
 11300        MOVE ER-8302               TO WS-ERROR
 11301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11302        GO TO 3024-EDIT-DL22-CONT.
 11303
 11304     IF DVSC-RETURN-CODE EQUAL 'N1'
 11305        MOVE ER-8304               TO WS-ERROR
 11306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11307        GO TO 3024-EDIT-DL22-CONT.
 11308
 11309     MOVE ER-8303                  TO WS-ERROR
 11310     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11311
 11312 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 207
* EL050.cbl
 11314****************************************************************
 11315*** VALIDATE LOAN OFFICER : DLO021                           ***
 11316****************************************************************
 11317
 11318     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11319     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11320     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11321     IF DVLO-SUCCESSFUL-EDIT
 11322        GO TO 3024-EDIT-DL21-CONT.
 11323
 11324     IF DVLO-RETURN-CODE EQUAL '01'
 11325        MOVE ER-8081               TO WS-ERROR
 11326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11327        GO TO 3024-EDIT-DL21-CONT.
 11328
 11329     IF DVLO-RETURN-CODE EQUAL '02'
 11330        MOVE ER-8082               TO WS-ERROR
 11331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11332        GO TO 3024-EDIT-DL21-CONT.
 11333
 11334     IF DVLO-RETURN-CODE EQUAL '03'
 11335        MOVE ER-8083               TO WS-ERROR
 11336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11337        GO TO 3024-EDIT-DL21-CONT.
 11338
 11339     IF DVLO-RETURN-CODE EQUAL '04'
 11340        MOVE ER-8084               TO WS-ERROR
 11341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11342        GO TO 3024-EDIT-DL21-CONT.
 11343
 11344     IF DVLO-RETURN-CODE EQUAL '05'
 11345        MOVE ER-8085               TO WS-ERROR
 11346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11347        GO TO 3024-EDIT-DL21-CONT.
 11348
 11349     MOVE ER-7825                  TO WS-ERROR
 11350     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11351     GO TO 3024-EDIT-DL21-CONT.
 11352
 11353 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 208
* EL050.cbl
 11355
 11356****************************************************************
 11357*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11358****************************************************************
 11359
 11360     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11361     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11362     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11363     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11364     IF DIPF-SUCCESSFUL-EDIT
 11365        GO TO 3024-EDIT-DL02-CONT.
 11366
 11367     IF DIPF-RETURN-CODE EQUAL '01'
 11368        MOVE ER-8086               TO WS-ERROR
 11369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11370        GO TO 3024-EDIT-DL02-CONT.
 11371
 11372     IF DIPF-RETURN-CODE EQUAL '02'
 11373        MOVE ER-8087               TO WS-ERROR
 11374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11375        GO TO 3024-EDIT-DL02-CONT.
 11376
 11377     IF DIPF-RETURN-CODE EQUAL '03'
 11378        MOVE ER-8088               TO WS-ERROR
 11379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11380        GO TO 3024-EDIT-DL02-CONT.
 11381
 11382     MOVE ER-8095                  TO WS-ERROR
 11383     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11384     GO TO 3024-EDIT-DL02-CONT.
 11385
 11386 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 209
* EL050.cbl
 11388
 11389****************************************************************
 11390*** VALIDATE BANK ID : DLO003                                ***
 11391****************************************************************
 11392
 11393     MOVE WK-GREG-CENT           TO WCG-CENT.
 11394     MOVE WK-GREG-YYMM           TO WCG-REST.
 11395     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11396        MOVE ER-8040               TO WS-ERROR
 11397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11398
 11399     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11400     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11401     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11402     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11403     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11404     IF DVBI-SUCCESSFUL-EDIT
 11405        GO TO 3024-EDIT-DL03-CONT.
 11406
 11407     IF DVBI-RETURN-CODE EQUAL '01'
 11408        MOVE ER-8089               TO WS-ERROR
 11409        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11410        GO TO 3024-EDIT-DL03-CONT.
 11411
 11412     IF DVBI-RETURN-CODE EQUAL '02'
 11413        MOVE ER-8090               TO WS-ERROR
 11414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11415        GO TO 3024-EDIT-DL03-CONT.
 11416
 11417     IF DVBI-RETURN-CODE EQUAL '03'
 11418        MOVE ER-8091               TO WS-ERROR
 11419        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11420        GO TO 3024-EDIT-DL03-CONT.
 11421
 11422     IF DVBI-RETURN-CODE EQUAL '04'
 11423        MOVE ER-8092               TO WS-ERROR
 11424        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11425        GO TO 3024-EDIT-DL03-CONT.
 11426
 11427     IF DVBI-RETURN-CODE EQUAL '05'
 11428        MOVE ER-8093               TO WS-ERROR
 11429        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11430        GO TO 3024-EDIT-DL03-CONT.
 11431
 11432     IF DVBI-RETURN-CODE EQUAL '06'
 11433        MOVE ER-8094               TO WS-ERROR
 11434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11435        GO TO 3024-EDIT-DL03-CONT.
 11436
 11437     MOVE ER-8096                  TO WS-ERROR
 11438     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11439     GO TO 3024-EDIT-DL03-CONT.
 11440
 11441 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 210
* EL050.cbl
 11443
 11444     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11445        NEXT SENTENCE
 11446     ELSE
 11447        MOVE ER-8042               TO WS-ERROR
 11448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11449
 11450     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11451     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11452     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11453
 11454     IF DMPF-RETURN-CODE = '01'
 11455        MOVE ER-8067               TO WS-ERROR
 11456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11457        GO TO 3024-EDIT-DL01-CONT.
 11458
 11459     IF DMPF-RETURN-CODE = '02'
 11460        MOVE ER-8068               TO WS-ERROR
 11461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11462        GO TO 3024-EDIT-DL01-CONT.
 11463
 11464     IF DMPF-RETURN-CODE = '03'
 11465        MOVE ER-8069               TO WS-ERROR
 11466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11467        GO TO 3024-EDIT-DL01-CONT.
 11468
 11469     IF DMPF-RETURN-CODE = 'E1'
 11470        MOVE ER-8070               TO WS-ERROR
 11471        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11472        GO TO 3024-EDIT-DL01-CONT.
 11473
 11474     IF DMPF-RETURN-CODE = 'N1'
 11475        MOVE ER-8071               TO WS-ERROR
 11476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11477        GO TO 3024-EDIT-DL01-CONT.
 11478
 11479     IF DMPF-RETURN-CODE NOT = 'OK'
 11480        MOVE ER-8072               TO WS-ERROR
 11481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11482
 11483 3024-EDIT-DL01-CONT.
 11484******************************************************************
 11485***  VALIDATES RATE CODES : DLO017                             ***
 11486******************************************************************
 11487
 11488      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11489      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11490      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11491      IF DVRC-SUCCESSFUL-EDIT
 11492        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11493        GO TO 3024-CHECK-VALID-RATE.
 11494
 11495      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11496
 11497      IF DVRC-RETURN-CODE EQUAL '01'
 11498         MOVE ER-7817                   TO WS-ERROR
 11499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11500         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 211
* EL050.cbl
 11501
 11502      IF DVRC-RETURN-CODE EQUAL '02'
 11503         MOVE ER-7818                   TO WS-ERROR
 11504         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11505         GO TO 3025-EDIT-REINSURANCE.
 11506
 11507      IF DVRC-RETURN-CODE EQUAL '03'
 11508         MOVE ER-7819                   TO WS-ERROR
 11509         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11510         GO TO 3025-EDIT-REINSURANCE.
 11511
 11512       MOVE ER-7820                     TO WS-ERROR.
 11513       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11514       GO TO 3025-EDIT-REINSURANCE.
 11515
 11516******************************************************************
 11517***  GET PREMIUM RATES : DLO011                                ***
 11518******************************************************************
 11519
 11520 3024-CHECK-VALID-RATE.
 11521
 11522     IF VALID-RATE-CODE
 11523        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11524        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11525        MOVE SPACES                TO DPRB-RETURN-CODE
 11526        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11527     ELSE
 11528         GO TO 3025-EDIT-REINSURANCE.
 11529
 11530      IF DPRB-SUCCESSFUL-PROCESS
 11531         IF PB-VALID-LIFE
 11532             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11533             GO TO 3025-EDIT-REINSURANCE
 11534         ELSE
 11535             IF PB-VALID-AH
 11536                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11537                 GO TO 3025-EDIT-REINSURANCE.
 11538
 11539      IF DPRB-RETURN-CODE EQUAL '01'
 11540         MOVE ER-7812                   TO WS-ERROR
 11541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542         GO TO 3025-EDIT-REINSURANCE.
 11543
 11544      IF DPRB-RETURN-CODE EQUAL '02'
 11545         MOVE ER-7813                   TO WS-ERROR
 11546         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11547         GO TO 3025-EDIT-REINSURANCE.
 11548
 11549      IF DPRB-RETURN-CODE EQUAL '03'
 11550         MOVE ER-7814                   TO WS-ERROR
 11551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11552         GO TO 3025-EDIT-REINSURANCE.
 11553
 11554      IF DPRB-RETURN-CODE EQUAL '04'
 11555         IF NOT DPRB-1ST-TIME
 11556            MOVE ER-7815                   TO WS-ERROR
 11557            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11558            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 212
* EL050.cbl
 11559          ELSE
 11560         IF PB-VALID-LIFE
 11561            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11562          ELSE
 11563            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11564         END-IF
 11565         MOVE SPACES                TO DOCC-RETURN-CODE
 11566         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11567         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11568         IF DOCC-RETURN-CODE = 'OK'
 11569             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11570             GO TO 3024-CHECK-VALID-RATE
 11571           ELSE
 11572             MOVE ER-7823               TO WS-ERROR
 11573             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11574             GO TO 3025-EDIT-REINSURANCE.
 11575
 11576       MOVE ER-7816                     TO WS-ERROR.
 11577       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11578       GO TO 3025-EDIT-REINSURANCE.
 11579
 11580**********   DMD CUSTOM CODE ABOVE    **********
 11581
 11582 3025-EDIT-REINSURANCE.
 11583     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11584         GO TO 3027-EDIT-CONTINUE.
 11585
 11586     MOVE LOW-VALUES               TO ERREIN-KEY.
 11587     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11588     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11589                                      REIN-CODE-2
 11590                                      REIN-CODE-3.
 11591     MOVE 'A'                      TO REIN-TYPE.
 11592
 11593     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11594
 11595     MOVE '3026' TO REIN-SW.
 11596     MOVE ' '                   TO WS-REIN-READ-SW.
 11597
 11598     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11599     IF REIN-TABLE-NOT-FOUND
 11600         GO TO 3026-NO-SPEC-TABLE.
 11601
 11602     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11603     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11604                                   WS-NSP-ST-CD-LF.
 11605     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11606                                   WS-NSP-ST-CD-AH.
 11607
 11608     GO TO 3040-EDIT-CONTINUE.
 11609
 11610 3026-NO-SPEC-TABLE.
 11611
 11612     MOVE ER-2664                TO WS-ERROR.
 11613     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11614     GO TO 3040-EDIT-CONTINUE.
 11615
 11616 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 213
* EL050.cbl
 11617
 11618     IF PB-I-REIN-TABLE = SPACES
 11619       GO TO 3040-EDIT-CONTINUE.
 11620
 11621     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11622          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11623          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11624           GO TO 3040-EDIT-CONTINUE.
 11625
 11626     MOVE LOW-VALUES            TO ERREIN-KEY.
 11627     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11628     MOVE 'A'                   TO REIN-TYPE.
 11629     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11630
 11631     MOVE '3028'                TO REIN-SW.
 11632     MOVE ' '                   TO WS-REIN-READ-SW.
 11633
 11634     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11635     IF REIN-TABLE-NOT-FOUND
 11636         GO TO 3028-NO-REIN-TABLE.
 11637
 11638     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11639     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11640                                   WS-NSP-ST-CD-LF.
 11641     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11642                                   WS-NSP-ST-CD-AH.
 11643
 11644     GO TO 3040-EDIT-CONTINUE.
 11645
 11646 3028-NO-REIN-TABLE.
 11647
 11648     MOVE ER-2615                TO WS-ERROR.
 11649     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11650     GO TO 3040-EDIT-CONTINUE.
 11651
 11652 3040-EDIT-CONTINUE.
 11653
 11654     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11655         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11656
 11657     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11658         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11659
 11660     IF (NOT PB-REISSUED-CERT)
 11661        AND (NOT PB-MONTHLY-CERT)
 11662        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11663            MOVE '001'           TO PB-I-LF-TERM
 11664            MOVE 'M'             TO PB-I-INSURED-SEX.
 11665
 11666     IF (NOT PB-REISSUED-CERT)
 11667        AND (NOT PB-MONTHLY-CERT)
 11668        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11669            MOVE '001'           TO PB-I-AH-TERM
 11670            MOVE 'M'             TO PB-I-INSURED-SEX.
 11671
 11672 3040-EDIT-1ST-PMT-DT.
 11673     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11674     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 214
* EL050.cbl
 11675         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11676
 11677******************************************************************
 11678*                                                                *
 11679*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11680*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11681*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11682*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11683*                                                                *
 11684******************************************************************
 11685
 11686     IF PB-EFF-DT-PROCESSING
 11687        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11688                                    PB-I-LF-EXPIRE-DT
 11689                                    PB-I-AH-EXPIRE-DT
 11690        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11691        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11692        MOVE ZERO                TO DC-ELAPSED-DAYS
 11693        MOVE +1                  TO DC-ELAPSED-MONTHS
 11694        SET BIN-PLUS-ELAPSED     TO TRUE
 11695*       MOVE 6                   TO DC-OPTION-CODE
 11696        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11697        IF NO-CONVERSION-ERROR
 11698           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11699
 11700******************************************************************
 11701*                                                                *
 11702*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11703*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11704*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11705*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11706*                                                                *
 11707******************************************************************
 11708
 11709     IF PB-EXT-DAYS-PROCESSING
 11710          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11711                                         PB-I-LF-EXPIRE-DT
 11712                                         PB-I-AH-EXPIRE-DT
 11713          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11714          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11715          MOVE +1                     TO DC-ELAPSED-MONTHS
 11716          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11717          SET BIN-PLUS-ELAPSED        TO TRUE
 11718*         MOVE 6                      TO DC-OPTION-CODE
 11719          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11720          IF NO-CONVERSION-ERROR
 11721             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11722
 11723******************************************************************
 11724*                                                                *
 11725*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11726*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11727*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11728*        (EXPIRE DATE - (TERM -1))  *  -1.
 11729*                                                                *
 11730******************************************************************
 11731
 11732     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 215
* EL050.cbl
 11733        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11734           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11735              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11736              MOVE PB-I-AH-TERM      TO WS-TERM
 11737           ELSE
 11738              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11739              MOVE PB-I-LF-TERM      TO WS-TERM
 11740        ELSE
 11741           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11742              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11743              MOVE PB-I-LF-TERM      TO WS-TERM
 11744           ELSE
 11745              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11746              MOVE PB-I-AH-TERM      TO WS-TERM.
 11747
 11748     IF PB-EXPIRE-DT-PROCESSING
 11749        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11750        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11751        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11752        MOVE ZERO                TO DC-ELAPSED-DAYS
 11753                                    DC-ODD-DAYS-OVER
 11754          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11755          SET BIN-PLUS-ELAPSED    TO TRUE
 11756*         MOVE 6                  TO DC-OPTION-CODE
 11757          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11758          IF NO-CONVERSION-ERROR
 11759             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11760
 11761******************************************************************
 11762*                                                                *
 11763*            1ST PAYMENT DATE PROCESSING                         *
 11764*                                                                *
 11765******************************************************************
 11766
 11767     IF PB-1ST-PMT-DT-PROCESSING
 11768        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11769                                    PB-I-AH-EXPIRE-DT
 11770        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11771
 11772     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11773         NEXT SENTENCE
 11774     ELSE
 11775         MOVE ER-2680                 TO WS-ERROR
 11776         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11777         GO TO 3060-ORIG-TERM-CHECK.
 11778
 11779     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11780     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11781     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11782*    MOVE 1                      TO DC-OPTION-CODE.
 11783     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11784                                    DC-ELAPSED-DAYS
 11785                                    DC-ODD-DAYS-OVER.
 11786
 11787     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11788
 11789     IF DATE-CONVERSION-ERROR
 11790        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 216
* EL050.cbl
 11791
 11792     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11793     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11794        AND (WS-LF-COVERAGE-TYPE = 'L')
 11795        IF (DC-ELAPSED-MONTHS > 1)
 11796                      OR
 11797           ((DC-ELAPSED-MONTHS = 1)
 11798           AND (DC-ODD-DAYS-OVER > 0))
 11799           MOVE ER-2882          TO WS-ERROR
 11800           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11801        END-IF
 11802     END-IF
 11803     IF PB-EXT-DAYS-PROCESSING
 11804        CONTINUE
 11805     ELSE
 11806        IF DC-ELAPSED-MONTHS = +0
 11807           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11808        ELSE
 11809           IF (WS-LF-EARNINGS-CALC = '4')
 11810              AND (DC-ELAPSED-MONTHS > ZERO)
 11811              AND (DC-ELAPSED-DAYS > ZERO)
 11812              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11813           ELSE
 11814              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11815                                 THRU 6499-EXIT
 11816              MOVE WS-ODD-DAYS-OVER
 11817                                 TO PB-I-EXTENTION-DAYS
 11818           END-IF
 11819        END-IF
 11820     END-IF
 11821******************************************************************
 11822*                                                                *
 11823*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11824*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11825*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11826*            AND ANY ODD DAYS.                                   *
 11827*                                                                *
 11828******************************************************************
 11829
 11830     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11831                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11832     IF WS-LF-EARNINGS-CALC NOT = '4'
 11833        IF DC-ELAPSED-DAYS > ZEROS
 11834           MOVE ER-2681          TO WS-ERROR
 11835           PERFORM 9900-ERROR-FORMAT
 11836                                 THRU 9900-EXIT
 11837        END-IF
 11838     END-IF
 11839
 11840     IF WS-LF-EARNINGS-CALC NOT = '4'
 11841        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11842           MOVE ER-2681          TO WS-ERROR
 11843           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11844
 11845     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11846        (PB-I-LF-TERM NOT = ZERO) AND
 11847         NOT NO-LIFE-COVERAGE
 11848          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 217
* EL050.cbl
 11849          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11850          IF WS-LF-EARNINGS-CALC = '4'
 11851             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11852             PB-I-PAY-FREQUENCY
 11853          END-IF
 11854          MOVE ZERO              TO DC-ELAPSED-DAYS
 11855                                    DC-ODD-DAYS-OVER
 11856          MOVE 1                 TO DC-END-OF-MONTH
 11857          SET BIN-PLUS-ELAPSED        TO TRUE
 11858*         MOVE 6                 TO DC-OPTION-CODE
 11859          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11860          IF NO-CONVERSION-ERROR
 11861             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11862             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11863                (WS-LF-SPECIAL-CALC-CD = 'L')
 11864                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11865                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11866                  MOVE +1             TO DC-ELAPSED-MONTHS
 11867                  SET BIN-PLUS-ELAPSED  TO TRUE
 11868*                 MOVE 6              TO DC-OPTION-CODE
 11869                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11870                  IF NO-CONVERSION-ERROR
 11871                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11872
 11873* okay, i had to move the new att age edit down here because the
 11874* expiration date could get recalculated and i need the exp date
 11875     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11876        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11877        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11878        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11879           AND ZEROS
 11880           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11881           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11882           SET ELAPSED-BETWEEN-BIN TO TRUE
 11883           PERFORM 8500-DATE-CONVERT
 11884                                 THRU 8500-EXIT
 11885           IF NO-CONVERSION-ERROR
 11886              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11887                 MOVE ER-2669       TO WS-ERROR
 11888*                PERFORM 9900-ERROR-FORMAT
 11889*                                THRU 9900-EXIT
 11890              END-IF
 11891           END-IF
 11892        ELSE
 11893           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 11894           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11895              MOVE ER-2669       TO WS-ERROR
 11896*             PERFORM 9900-ERROR-FORMAT
 11897*                                THRU 9900-EXIT
 11898           ELSE
 11899              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11900                 MOVE ER-1570    TO WS-ERROR
 11901                 PERFORM 9900-ERROR-FORMAT
 11902                                 THRU 9900-EXIT
 11903              END-IF
 11904           END-IF
 11905        END-IF
 11906        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 218
* EL050.cbl
 11907           AND ZEROS
 11908           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11909           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11910           SET ELAPSED-BETWEEN-BIN TO TRUE
 11911           PERFORM 8500-DATE-CONVERT
 11912                                 THRU 8500-EXIT
 11913           IF NO-CONVERSION-ERROR
 11914              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11915                 MOVE ER-2669       TO WS-ERROR
 11916*                PERFORM 9900-ERROR-FORMAT
 11917*                                THRU 9900-EXIT
 11918              END-IF
 11919           END-IF
 11920        ELSE
 11921           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11922             (PB-I-LF-TERM / 12)
 11923           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11924              MOVE ER-2669       TO WS-ERROR
 11925*             PERFORM 9900-ERROR-FORMAT
 11926*                                THRU 9900-EXIT
 11927           ELSE
 11928              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11929                 MOVE ER-1571    TO WS-ERROR
 11930                 PERFORM 9900-ERROR-FORMAT
 11931                                 THRU 9900-EXIT
 11932              END-IF
 11933           END-IF
 11934        END-IF
 11935        IF WS-ERROR = ER-2669
 11936           PERFORM 9900-ERROR-FORMAT
 11937                                 THRU 9900-EXIT
 11938        END-IF
 11939     END-IF
 11940     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 11941        (PB-I-AH-TERM NOT = ZERO) AND
 11942         NOT NO-AH-COVERAGE
 11943          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 11944             AND (PB-COMPANY-ID = 'DCC')
 11945             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11946             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 11947          ELSE
 11948             IF WS-LF-EARNINGS-CALC = '4'
 11949                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 11950                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 11951                PB-I-PAY-FREQUENCY
 11952             ELSE
 11953                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 11954                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 11955             END-IF
 11956          END-IF
 11957          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11958                                         DC-ODD-DAYS-OVER
 11959          MOVE 1                      TO DC-END-OF-MONTH
 11960          SET BIN-PLUS-ELAPSED        TO TRUE
 11961*         MOVE 6                      TO DC-OPTION-CODE
 11962          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11963          IF NO-CONVERSION-ERROR
 11964             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 219
* EL050.cbl
 11965     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 11966        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 11967        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 11968        IF PB-I-BIRTHDAY > LOW-VALUES
 11969           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11970           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11971           SET ELAPSED-BETWEEN-BIN TO TRUE
 11972           PERFORM 8500-DATE-CONVERT
 11973                                 THRU 8500-EXIT
 11974           IF NO-CONVERSION-ERROR
 11975              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11976                 MOVE ER-3054       TO WS-ERROR
 11977*                PERFORM 9900-ERROR-FORMAT
 11978*                                THRU 9900-EXIT
 11979              END-IF
 11980           END-IF
 11981        ELSE
 11982           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 11983           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11984              MOVE ER-3054       TO WS-ERROR
 11985*             PERFORM 9900-ERROR-FORMAT
 11986*                                THRU 9900-EXIT
 11987           END-IF
 11988        END-IF
 11989        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11990           AND ZEROS
 11991           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11992           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11993           SET ELAPSED-BETWEEN-BIN TO TRUE
 11994           PERFORM 8500-DATE-CONVERT
 11995                                 THRU 8500-EXIT
 11996           IF NO-CONVERSION-ERROR
 11997              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11998                 MOVE ER-3054       TO WS-ERROR
 11999*                PERFORM 9900-ERROR-FORMAT
 12000*                                THRU 9900-EXIT
 12001              END-IF
 12002           END-IF
 12003        ELSE
 12004           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12005             (PB-I-AH-TERM / 12)
 12006           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12007              MOVE ER-3054       TO WS-ERROR
 12008*             PERFORM 9900-ERROR-FORMAT
 12009*                                THRU 9900-EXIT
 12010           END-IF
 12011        END-IF
 12012        IF WS-ERROR = ER-3054
 12013           PERFORM 9900-ERROR-FORMAT
 12014                                 THRU 9900-EXIT
 12015        END-IF
 12016     END-IF
 12017     MOVE SPACE                       TO DC-END-OF-MONTH.
 12018
 12019     IF PB-COMPANY-ID = 'NCB'
 12020        GO TO 3040-EDIT-EXTENSION-DAYS.
 12021
 12022     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 220
* EL050.cbl
 12023       AND
 12024        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12025        NEXT SENTENCE
 12026     ELSE
 12027        GO TO 3040-EDIT-EXTENSION-DAYS.
 12028
 12029     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12030        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12031        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12032     ELSE
 12033        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12034        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12035
 12036     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12037*    MOVE '1'      TO DC-OPTION-CODE
 12038     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12039     IF (NO-CONVERSION-ERROR)
 12040        AND (DC-ELAPSED-MONTHS > +1)
 12041        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12042        MOVE ER-2668   TO WS-ERROR
 12043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12044
 12045 3040-EDIT-EXTENSION-DAYS.
 12046
 12047     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12048        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12049         GO TO 3050-EDIT-TERM-IN-DAYS
 12050     ELSE
 12051         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12052
 12053     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12054         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12055     ELSE
 12056        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12057           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12058           MOVE ER-2681         TO WS-ERROR
 12059           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12060
 12061     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12062        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12063        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12064         GO TO 3060-ORIG-TERM-CHECK.
 12065
 12066     GO TO 3060-ORIG-TERM-CHECK.
 12067
 12068 3050-EDIT-TERM-IN-DAYS.
 12069
 12070     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12071
 12072     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12073         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12074     ELSE
 12075         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12076            MOVE ER-2682         TO WS-ERROR
 12077            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12078
 12079     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12080                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 221
* EL050.cbl
 12081     IF WS-WORK-TERM GREATER THAN ZERO
 12082         ADD +1 TO PB-I-LF-TERM.
 12083
 12084     IF NOT NO-AH-COVERAGE
 12085         MOVE ER-2684            TO WS-ERROR
 12086         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12087
 12088
 12089 3060-ORIG-TERM-CHECK.
 12090
 12091******************************************************************
 12092*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12093******************************************************************
 12094
 12095     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12096        NEXT SENTENCE
 12097     ELSE
 12098        IF NOT NO-LIFE-COVERAGE
 12099           IF PB-I-LF-TERM NUMERIC
 12100              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12101              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12102              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12103                  NEXT SENTENCE
 12104           ELSE
 12105              MOVE ER-2647       TO WS-ERROR
 12106              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12107
 12108     IF NOT NO-AH-COVERAGE
 12109         IF PB-I-AH-TERM NUMERIC
 12110            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12111            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12112            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12113             NEXT SENTENCE
 12114          ELSE
 12115              MOVE ER-2658       TO WS-ERROR
 12116              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12117
 12118     IF PB-COMPANY-ID = 'NCB'
 12119        GO TO 3070-LOAN-TERM-CHECK.
 12120
 12121     IF POLICY-HAS-AH
 12122       AND
 12123        POLICY-HAS-LIFE
 12124       AND
 12125        PB-I-LF-TERM NUMERIC
 12126       AND
 12127        PB-I-AH-TERM NUMERIC
 12128        NEXT SENTENCE
 12129     ELSE
 12130        GO TO 3070-LOAN-TERM-CHECK.
 12131
 12132     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12133     IF WS-TEX-FACT-2 LESS THAN +0
 12134        MULTIPLY +1 BY WS-TEX-FACT-2.
 12135
 12136     IF WS-TEX-FACT-2 GREATER THAN +1
 12137        MOVE ER-2668             TO WS-ERROR
 12138        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 222
* EL050.cbl
 12139
 12140 3070-LOAN-TERM-CHECK.
 12141
 12142     IF (WS-LF-BENEFIT-CD = ZERO)
 12143         OR (NO-LF-BENEFIT-MATCH)
 12144            GO TO 3125-EDIT-PMT-FREQ.
 12145*    IF PB-COMPANY-ID NOT = 'DCC'
 12146*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12147*          AND 'V' AND 'W' AND 'X'
 12148*          GO TO 3125-EDIT-PMT-FREQ
 12149*       END-IF
 12150*    ELSE
 12151*       IF WS-AH-DCC-TRUNC = 'T'
 12152*          CONTINUE
 12153*       ELSE
 12154*          GO TO 3125-EDIT-PMT-FREQ
 12155*       END-IF
 12156*    END-IF
 12157     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12158                    OR
 12159        ((PB-COMPANY-ID = 'DCC')
 12160        AND (WS-AH-DCC-TRUNC = 'T'))
 12161        CONTINUE
 12162     ELSE
 12163        GO TO 3125-EDIT-PMT-FREQ
 12164     END-IF
 12165     IF PB-I-LOAN-TERM NOT NUMERIC
 12166         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12167
 12168     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12169        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12170        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12171        PB-I-LOAN-TERM NOT GREATER THAN +360
 12172         NEXT SENTENCE
 12173     ELSE
 12174         MOVE ER-2648            TO WS-ERROR
 12175         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12176
 12177     IF WS-STATE-ABBREVIATION = 'NC'
 12178        IF PB-I-LOAN-TERM > +59
 12179           CONTINUE
 12180        ELSE
 12181           MOVE ER-2792          TO WS-ERROR
 12182           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12183        END-IF
 12184     END-IF
 12185
 12186     .
 12187 3125-EDIT-PMT-FREQ.
 12188     IF (WS-LF-BENEFIT-CD = ZERO)
 12189         OR (NO-LF-BENEFIT-MATCH)
 12190            GO TO 3127-EDIT-LOAN-OFFICER.
 12191     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12192                    OR
 12193        ((PB-COMPANY-ID = 'DCC')
 12194        AND (WS-AH-DCC-TRUNC = 'T'))
 12195                    OR
 12196         (PB-COMPANY-ID = 'AHL')
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 223
* EL050.cbl
 12197        CONTINUE
 12198     ELSE
 12199        IF (PB-I-LOAN-TERM > ZEROS)
 12200           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12201           MOVE ER-1575          TO WS-ERROR
 12202           PERFORM 9900-ERROR-FORMAT
 12203                                 THRU 9900-EXIT
 12204        END-IF
 12205     END-IF
 12206     IF WS-LF-EARNINGS-CALC NOT = '4'
 12207         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12208            MOVE ER-2653         TO WS-ERROR
 12209            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12210            GO TO 3127-EDIT-LOAN-OFFICER
 12211         ELSE
 12212            GO TO 3127-EDIT-LOAN-OFFICER.
 12213
 12214     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12215         MOVE ER-2655            TO WS-ERROR
 12216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12217         GO TO 3127-EDIT-LOAN-OFFICER.
 12218
 12219     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12220         MOVE ER-2654            TO WS-ERROR
 12221         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12222         GO TO 3127-EDIT-LOAN-OFFICER.
 12223
 12224     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12225         GIVING WS-TEX-FACT-2
 12226             REMAINDER WS-TEX-FACT-3.
 12227
 12228*    IF WS-TEX-FACT-3 NOT = ZERO
 12229*       MOVE ER-2654             TO WS-ERROR
 12230*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12231
 12232
 12233 3127-EDIT-LOAN-OFFICER.
 12234
 12235     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12236        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12237           MOVE ER-2690          TO WS-ERROR
 12238           PERFORM 9900-ERROR-FORMAT
 12239                                 THRU 9900-EXIT
 12240        ELSE
 12241           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12242           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12243           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12244           MOVE PB-SV-STATE      TO LOFC-STATE
 12245           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12246           MOVE PB-I-LOAN-OFFICER
 12247                                 TO LOFC-CODE
 12248           PERFORM 8586-READ-LOAN-OFFICER
 12249                                 THRU 8586-EXIT
 12250           IF (NOT LOFC-MASTER-FOUND)
 12251              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12252              MOVE ER-3006       TO WS-ERROR
 12253              PERFORM 9900-ERROR-FORMAT
 12254                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 224
* EL050.cbl
 12255           END-IF
 12256        END-IF
 12257     END-IF
 12258     .
 12259 3129-EDIT-APR.
 12260
 12261     IF (WS-LF-BENEFIT-CD = ZERO)
 12262        OR (NO-LF-BENEFIT-MATCH)
 12263        IF PB-COMPANY-ID NOT = 'DCC'
 12264           GO TO 3130-EDIT-AGE
 12265*       ELSE
 12266*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12267*             GO TO 3130-EDIT-AGE
 12268*          END-IF
 12269        END-IF
 12270     END-IF
 12271
 12272     IF (WS-STATE-ABBREVIATION = 'OH')
 12273         AND (PB-I-RATE-CLASS NOT = 'L ')
 12274         AND (PB-I-LF-TERM GREATER THAN 60)
 12275         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12276         GO TO 3129-APR-CONT.
 12277
 12278     IF (WS-STATE-ABBREVIATION = 'RI')
 12279         AND (PB-I-LF-TERM GREATER THAN 60)
 12280         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12281         GO TO 3129-APR-CONT.
 12282
 12283     IF (WS-STATE-ABBREVIATION = 'UT')
 12284         AND (PB-I-LF-TERM GREATER THAN 62)
 12285         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12286         AND (PB-CERT-EFF-DT LESS WS-830901)
 12287         GO TO 3129-APR-CONT.
 12288
 12289     IF PB-COMPANY-ID = 'LAP'
 12290        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12291           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12292              MOVE ER-2656         TO WS-ERROR
 12293              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12294              GO TO 3130-EDIT-AGE.
 12295
 12296     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12297        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12298        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12299        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12300         GO TO 3130-EDIT-AGE.
 12301
 12302 3129-APR-CONT.
 12303     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12304         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12305         GO TO 3130-EDIT-AGE.
 12306
 12307     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12308        AND (PB-COMPANY-ID = 'DCC')
 12309        AND (PB-I-LOAN-APR = ZERO)
 12310        MOVE ER-2657             TO WS-ERROR
 12311        PERFORM 9900-ERROR-FORMAT
 12312                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 225
* EL050.cbl
 12313        GO TO 3130-EDIT-AGE
 12314     END-IF
 12315     IF PB-I-LOAN-APR = ZERO
 12316        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12317     END-IF
 12318
 12319     IF PB-I-LOAN-APR = ZERO
 12320        MOVE ER-2656             TO WS-ERROR
 12321        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12322        GO TO 3130-EDIT-AGE.
 12323
 12324*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12325     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12326        MOVE ER-2657             TO WS-ERROR
 12327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12328
 12329 3130-EDIT-AGE.
 12330
 12331******************************************************************
 12332*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12333******************************************************************
 12334
 12335     IF NOT NO-LIFE-COVERAGE
 12336        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12337           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12338               MOVE ER-2628             TO WS-ERROR
 12339               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12340
 12341     IF NOT NO-AH-COVERAGE
 12342        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12343           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12344               MOVE ER-2628         TO WS-ERROR
 12345               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12346
 12347 3133-SEX-CODE.
 12348     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12349         IF WS-DEFAULT-SEX = 'M'
 12350             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12351          ELSE
 12352             IF WS-DEFAULT-SEX = 'F'
 12353             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12354
 12355     IF PB-I-INSURED-SEX = '1'
 12356         MOVE 'M' TO PB-I-INSURED-SEX.
 12357
 12358     IF PB-I-INSURED-SEX = '2'
 12359         MOVE 'F' TO PB-I-INSURED-SEX.
 12360
 12361 3134-SIG-SW-EDIT.
 12362     IF PB-I-SIG-SW = SPACE
 12363         MOVE 'N'                TO  PB-I-SIG-SW.
 12364
 12365     IF PB-COMPANY-ID = 'NCL'
 12366         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12367             NEXT SENTENCE
 12368         ELSE
 12369             MOVE ER-1923        TO  WS-ERROR
 12370             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 226
* EL050.cbl
 12371     ELSE
 12372     IF PB-COMPANY-ID = 'CRI'
 12373         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12374             NEXT SENTENCE
 12375         ELSE
 12376             MOVE ER-2606        TO  WS-ERROR
 12377             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12378     ELSE
 12379     IF PB-COMPANY-ID = 'TMS'
 12380         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12381             NEXT SENTENCE
 12382         ELSE
 12383             MOVE ER-2689        TO  WS-ERROR
 12384             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12385     ELSE
 12386         IF PB-I-SIG-SW = 'Y' OR 'N'
 12387             NEXT SENTENCE
 12388         ELSE
 12389             MOVE ER-2651        TO  WS-ERROR
 12390             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12391
 12392     IF PB-COMPANY-ID = 'FLA'
 12393         IF (WS-EDIT-AGE GREATER 54  OR
 12394             WS-AH-EDIT-AGE GREATER 54)  AND
 12395            PB-I-SIG-SW = 'N'
 12396            MOVE ER-2651         TO  WS-ERROR
 12397            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12398
 12399 3135-NAME-EDIT.
 12400
 12401     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12402        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12403        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12404           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12405                                 TO PB-I-JOINT-FIRST-NAME
 12406        END-PERFORM
 12407     END-IF
 12408     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12409        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12410        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12411           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12412                                 TO PB-I-JOINT-LAST-NAME
 12413        END-PERFORM
 12414     END-IF
 12415     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12416        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12417        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12418           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12419                                 TO PB-I-INSURED-FIRST-NAME
 12420        END-PERFORM
 12421     END-IF
 12422     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12423        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12424        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12425           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12426                                 TO PB-I-INSURED-LAST-NAME
 12427        END-PERFORM
 12428     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 227
* EL050.cbl
 12429     IF PB-I-INSURED-LAST-NAME = SPACES
 12430       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12431       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12432           MOVE ER-2660    TO WS-ERROR
 12433           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12434
 12435 3136-EDIT-SEX.
 12436
 12437******************************************************************
 12438*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12439******************************************************************
 12440
 12441     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12442        (WS-AH-SPECIAL-CALC-CD = 'O')
 12443        NEXT SENTENCE
 12444     ELSE
 12445        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12446           NEXT SENTENCE
 12447        ELSE
 12448           MOVE ER-2629            TO WS-ERROR
 12449           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12450
 12451 3137-EDIT-EFF-DATE.
 12452
 12453     IF PB-REISSUED-CERT       OR
 12454        PB-POLICY-IS-DECLINED  OR
 12455        PB-POLICY-IS-VOIDED
 12456         GO TO 3139-EDIT-COVERAGE-CODES.
 12457
 12458     MOVE SPACE                  TO WS-2671-SW
 12459                                    WS-2672-SW.
 12460
 12461     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12462         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12463             MOVE ER-2703        TO WS-ERROR
 12464             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12465             GO TO 3139-EDIT-COVERAGE-CODES.
 12466
 12467     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12468         GO TO 3139-EDIT-COVERAGE-CODES.
 12469
 12470     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12471     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12472*    MOVE '1'                    TO DC-OPTION-CODE.
 12473     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12474     MOVE +0                     TO DC-ELAPSED-MONTHS
 12475                                    DC-ELAPSED-DAYS.
 12476     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12477
 12478     IF DATE-CONVERSION-ERROR
 12479         GO TO 3139-EDIT-COVERAGE-CODES.
 12480
 12481     IF DC-ELAPSED-DAYS GREATER +180
 12482         MOVE ER-2672            TO WS-ERROR
 12483         MOVE 'Y'                TO WS-2672-SW
 12484         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12485     END-IF
 12486
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 228
* EL050.cbl
 12487     IF WS-ERROR = ER-2671  AND
 12488        PB-COMPANY-ID  = 'LBL'
 12489        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12490        MOVE SPACE               TO WS-2671-SW
 12491        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12492
 12493     IF PB-ISSUE-DATE-FORCED  AND
 12494      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12495         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12496         MOVE ER-2673            TO WS-ERROR
 12497         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12498         MOVE SPACE              TO WS-2671-SW
 12499                                    WS-2672-SW.
 12500
 12501     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12502         IF PB-ISSUE-DATE-FORCED
 12503             MOVE ER-2600          TO  WS-ERROR
 12504             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12505         ELSE
 12506             MOVE ER-2692          TO  WS-ERROR
 12507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12508
 12509
 12510 3139-EDIT-COVERAGE-CODES.
 12511
 12512     IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12513        PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12514        MOVE ER-2787             TO WS-ERROR
 12515        PERFORM 9900-ERROR-FORMAT
 12516                                 THRU 9900-EXIT
 12517     END-IF
 12518     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12519        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12520                                 > 250000.00
 12521           MOVE ER-2719          TO WS-ERROR
 12522           PERFORM 9900-ERROR-FORMAT
 12523                                 THRU 9900-EXIT
 12524        END-IF
 12525     END-IF
 12526
 12527     IF PB-POLICY-IS-DECLINED  OR
 12528        PB-POLICY-IS-VOIDED
 12529         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12530
 12531     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12532        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12533         MOVE ER-2630                TO WS-ERROR
 12534         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12535
 12536     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12537        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12538        PB-I-LF-PREMIUM-AMT = ZERO
 12539         GO TO 3140-CHECK-AH-FOR-ZERO.
 12540
 12541     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12542        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12543        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12544         GO TO 3140-CHECK-AH-FOR-ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 229
* EL050.cbl
 12545
 12546     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12547        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12548        MOVE ER-2631             TO WS-ERROR
 12549        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12550     END-IF
 12551
 12552
 12553******************************************************************
 12554*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12555******************************************************************
 12556
 12557     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12558        NEXT SENTENCE
 12559     ELSE
 12560        IF PB-I-LF-BENEFIT-AMT = ZERO
 12561           MOVE ER-2632             TO WS-ERROR
 12562           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12563
 12564
 12565******************************************************************
 12566*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12567******************************************************************
 12568
 12569     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12570        CONTINUE
 12571     ELSE
 12572        IF PB-I-LF-PREMIUM-AMT = ZERO
 12573           IF (NOT PB-COMP-LF-PREM)
 12574              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12575              MOVE ER-2633       TO WS-ERROR
 12576              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12577           END-IF
 12578        END-IF
 12579     END-IF
 12580     .
 12581 3140-CHECK-AH-FOR-ZERO.
 12582
 12583     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12584        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12585        PB-I-AH-PREMIUM-AMT = ZERO
 12586         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12587
 12588     IF PB-COMPANY-ID = 'CSL'  AND
 12589        PB-I-AH-BENEFIT-CD = ZERO  AND
 12590        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12591        PB-I-AH-PREMIUM-AMT = ZERO
 12592         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12593
 12594     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12595        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12596        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12597         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12598
 12599     IF PB-I-AH-BENEFIT-CD = ZERO
 12600         MOVE ER-2634            TO WS-ERROR
 12601         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12602
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 230
* EL050.cbl
 12603******************************************************************
 12604*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12605******************************************************************
 12606
 12607     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12608        NEXT SENTENCE
 12609     ELSE
 12610        IF PB-I-AH-BENEFIT-AMT = ZERO
 12611           MOVE ER-2635             TO WS-ERROR
 12612           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12613
 12614******************************************************************
 12615*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12616******************************************************************
 12617
 12618     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12619        NEXT SENTENCE
 12620     ELSE
 12621        IF PB-I-AH-PREMIUM-AMT = ZERO
 12622            IF NOT PB-COMP-AH-PREM
 12623                MOVE ER-2636    TO WS-ERROR
 12624                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12625
 12626
 12627 3140-EDIT-MAX-AMT-SIZES.
 12628* CUSTOM CODE FOR CLIENT    'DMD'
 12629     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12630                                     WS-RES-MUNI-TAX
 12631                                     PB-I-STATE-TAX
 12632                                     PB-I-MUNI-TAX.
 12633
 12634     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12635
 12636     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12637        GO TO 3150-RATE-OUTSTAND-BAL.
 12638
 12639     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12640        GO TO 3150-RATE-OUTSTAND-BAL.
 12641
 12642     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12643        GO TO 3150-RATE-OUTSTAND-BAL.
 12644
 12645     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12646                             OR 'RIC')
 12647        GO TO 3150-RATE-OUTSTAND-BAL.
 12648
 12649     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12650        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12651            GO TO 3150-RATE-OUTSTAND-BAL
 12652        ELSE
 12653           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12654               GO TO 3150-RATE-OUTSTAND-BAL.
 12655
 12656     IF NOT PB-NO-MONTHS-SKIPPED
 12657        GO TO 3150-RATE-OUTSTAND-BAL.
 12658
 12659     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12660        GO TO 3150-RATE-OUTSTAND-BAL.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 231
* EL050.cbl
 12661
 12662     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12663        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12664           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12665             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12666           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12667           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12668              MOVE ER-2693     TO WS-ERROR
 12669              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12670              GO TO 3150-RATE-OUTSTAND-BAL
 12671           ELSE
 12672              GO TO 3150-RATE-OUTSTAND-BAL.
 12673
 12674 3150-RATE-OUTSTAND-BAL.
 12675
 12676* DMD RATING TEST
 12677     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12678         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12679         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12680         MOVE ER-2687                 TO WS-ERROR
 12681         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12682         MOVE 'B'                     TO PB-I-OB-FLAG
 12683         GO TO 3260-EDIT-CONTINUE.
 12684
 12685     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12686         IF  WS-ERROR    EQUAL    ER-2693
 12687             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12688                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12689                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12690                 MOVE  +0            TO  WS-ERROR.
 12691
 12692     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12693         IF  WS-ERROR    EQUAL    ER-2693
 12694             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12695                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12696                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12697                 MOVE  +0            TO  WS-ERROR.
 12698
 12699     IF PLAN-MASTER-AH-SW = 'Y'
 12700        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12701            IF  WS-ERROR    EQUAL    ER-2693
 12702              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12703                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12704                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12705                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12706                 MOVE  ER-1910           TO  WS-ERROR
 12707                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12708
 12709     IF PLAN-MASTER-AH-SW = 'Y'
 12710        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12711            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12712               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12713               MOVE  ER-1910           TO  WS-ERROR
 12714               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12715
 12716     IF PLAN-MASTER-AH-SW = 'Y'
 12717        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12718            IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 232
* EL050.cbl
 12719                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12720                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12721                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12722                 MOVE  +0       TO  WS-ERROR.
 12723
 12724     IF WS-ERROR = ER-2693
 12725        IF PB-COMPANY-ID = 'JAL' AND
 12726           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12727           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12728           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12729
 12730     IF WS-ERROR = ER-2693
 12731        IF PB-COMPANY-ID = 'NCL'  AND
 12732           PB-I-AH-BENEFIT-CD = 'OA'
 12733           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12734           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12735
 12736     IF WS-ERROR = ER-2693
 12737        IF PB-COMPANY-ID = 'CNL' AND
 12738           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12739           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12740           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12741
 12742     IF WS-ERROR = ER-2693
 12743        IF PB-COMPANY-ID = 'HER'
 12744           IF WS-LEVEL
 12745              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12746              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12747
 12748     IF ((LF-BENEFIT-FOUND) AND
 12749         (NOT NO-LIFE-COVERAGE)  AND
 12750         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12751       OR   ((AH-BENEFIT-FOUND) AND
 12752             (NOT NO-AH-COVERAGE)    AND
 12753             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12754         NEXT SENTENCE
 12755     ELSE
 12756         GO TO 3215-EDIT-RATES.
 12757
 12758     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12759        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12760           MOVE ER-2674          TO WS-ERROR
 12761           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12762           GO TO 3215-EDIT-RATES.
 12763
 12764     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12765        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12766           MOVE ER-2674          TO WS-ERROR
 12767           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12768           GO TO 3215-EDIT-RATES.
 12769
 12770     MOVE 'B'                    TO PB-I-OB-FLAG.
 12771
 12772     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12773         NEXT SENTENCE
 12774     ELSE
 12775         IF NOT NO-LIFE-COVERAGE
 12776             IF WS-ACCT-LF-OB-RT = ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 233
* EL050.cbl
 12777                MOVE ER-2641    TO WS-ERROR
 12778                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12779
 12780     IF PB-COMPANY-ID = 'CRI'
 12781       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12782         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12783         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12784         IF WS-ERROR = ER-2675
 12785            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12786            MOVE ER-2687              TO WS-ERROR
 12787            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12788         ELSE
 12789            MOVE ER-2687              TO WS-ERROR
 12790            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12791
 12792
 12793     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12794         NEXT SENTENCE
 12795     ELSE
 12796         IF NOT NO-AH-COVERAGE
 12797             IF WS-ACCT-AH-OB-RT = ZERO
 12798                MOVE ER-2642    TO WS-ERROR
 12799                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12800
 12801     IF PB-COMPANY-ID = 'CRI'
 12802       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12803         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12804         IF WS-ERROR = ER-2676
 12805            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12806            MOVE ER-2687              TO WS-ERROR
 12807            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12808         ELSE
 12809            MOVE ER-2687              TO WS-ERROR
 12810            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12811
 12812     IF PB-COMPANY-ID NOT = 'GIC'
 12813         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12814            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12815     ELSE
 12816         IF PB-I-LF-PREM-CALC = ZEROS
 12817             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12818                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12819
 12820     IF PB-COMPANY-ID NOT = 'GIC'
 12821         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12822            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12823     ELSE
 12824         IF PB-I-AH-PREM-CALC = ZEROS
 12825             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12826                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12827
 12828     MOVE ZEROS TO PB-I-MORT-CODE.
 12829
 12830     GO TO 3260-EDIT-CONTINUE.
 12831
 12832
 12833 3215-EDIT-RATES.
 12834     IF ACCOUNT-MAST-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 234
* EL050.cbl
 12835         NEXT SENTENCE
 12836     ELSE
 12837         GO TO 3999-END-EDIT.
 12838
 12839 3220-CHECK-LF-RATES.
 12840
 12841     IF PB-COMPANY-ID = 'DCC'
 12842        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12843        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12844        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12845           AND (NOT WS-LF-CASH))
 12846                           OR
 12847           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12848           AND (NOT WS-AH-CASH)))
 12849                       AND
 12850           (PB-I-ENTRY-STATUS NOT = '5')
 12851           MOVE 'M'              TO PB-BATCH-ENTRY
 12852                                    PB-I-ENTRY-STATUS
 12853        END-IF
 12854     END-IF
 12855     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12856                                    PB-I-AH-PREM-CALC
 12857                                    PB-I-LF-ALT-PREM-CALC
 12858                                    PB-I-LF-ALT-RATE
 12859                                    PB-I-LF-REI-RATE
 12860                                    PB-I-LF-ALT-REI-RATE
 12861                                    PB-I-AH-REI-RATE
 12862                                    PB-I-TOT-FEES-CALC.
 12863
 12864     IF PB-COMPANY-ID EQUAL 'DMD'
 12865        NEXT SENTENCE
 12866     ELSE
 12867        MOVE ZEROS               TO PB-I-LF-RATE
 12868                                    PB-I-AH-RATE.
 12869
 12870     IF PB-I-TOT-FEES NOT NUMERIC
 12871        MOVE ZEROS               TO PB-I-TOT-FEES
 12872     END-IF
 12873     IF PB-I-LIVES NOT NUMERIC
 12874         MOVE ZERO               TO PB-I-LIVES.
 12875
 12876     IF PB-I-NUM-BILLED NOT NUMERIC
 12877         MOVE ZERO               TO PB-I-NUM-BILLED.
 12878
 12879     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12880        MOVE +0                  TO PB-I-LF-PREM-TAX
 12881     END-IF
 12882
 12883     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12884        MOVE +0                  TO PB-I-AH-PREM-TAX
 12885     END-IF
 12886
 12887     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 12888        PB-I-PAY-FREQUENCY = ZEROS
 12889            MOVE 12 TO CP-PAY-FREQUENCY
 12890     ELSE
 12891            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 12892
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 235
* EL050.cbl
 12893     IF PB-I-STATE-TAX NOT NUMERIC
 12894         MOVE ZEROS               TO PB-I-STATE-TAX.
 12895
 12896     IF PB-I-MUNI-TAX NOT NUMERIC
 12897         MOVE ZEROS               TO PB-I-MUNI-TAX.
 12898
 12899     MOVE SPACES                 TO CP-BEN-CATEGORY
 12900     IF PB-COMPANY-ID  = 'CSL'  AND
 12901        PB-I-LF-TERM NOT = ZERO
 12902        COMPUTE WS-PAYMENT-AMT =
 12903             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 12904        COMPUTE WS-CSL-AMT1 =
 12905             PB-I-LF-TERM * AM-MAX-MON-BEN
 12906        COMPUTE WS-CSL-AMT2 =
 12907             WS-PAYMENT-AMT * PB-I-LF-TERM
 12908        IF CP-PAY-FREQUENCY NOT = 12
 12909           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 12910           MOVE '8' TO WS-CSL-CALC-CD
 12911        ELSE
 12912           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 12913              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 12914               AM-MAX-TOT-BEN
 12915               MOVE '6' TO WS-CSL-CALC-CD
 12916           ELSE
 12917              IF (WS-CSL-AMT1  GREATER THAN
 12918                 AM-MAX-TOT-BEN) AND
 12919                 (WS-CSL-AMT2  GREATER THAN
 12920                 AM-MAX-TOT-BEN)
 12921                 MOVE '7' TO WS-CSL-CALC-CD
 12922              ELSE
 12923                 MOVE '5' TO WS-CSL-CALC-CD.
 12924
 12925     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 12926         NEXT SENTENCE
 12927     ELSE
 12928         GO TO 3300-CHECK-AH-RATES.
 12929
 12930*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 12931
 12932     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12933        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 12934              OR
 12935           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 12936           MOVE ER-2618          TO WS-ERROR
 12937           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12938           GO TO 3300-CHECK-AH-RATES.
 12939
 12940     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12941           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 12942                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 12943
 12944     IF WS-LF-SPECIAL-CALC-CD = 'M'
 12945         MOVE ER-2687             TO WS-ERROR
 12946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12947         MOVE 'Z000'              TO PB-I-MORT-CODE
 12948         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 12949         GO TO 3300-CHECK-AH-RATES.
 12950
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 236
* EL050.cbl
 12951     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 12952        IF PB-I-LIVES = ZERO
 12953           MOVE ER-2688          TO WS-ERROR
 12954           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12955
 12956     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 12957
 12958     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 12959     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 12960     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 12961     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 12962     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 12963     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 12964     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12965     MOVE '3'                    TO CP-PROCESS-TYPE.
 12966     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 12967     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 12968
 12969******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12970     IF PB-COMPANY-ID EQUAL 'CDL'
 12971         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12972            CP-EARN-AS-NET-PAY)
 12973             IF PB-CERT-EFF-DT GREATER  WS-931231
 12974                 MOVE '1'        TO CP-EARNING-METHOD.
 12975*******
 12976
 12977     MOVE PB-SV-STATE            TO CP-STATE.
 12978     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 12979     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 12980     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 12981     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12982     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 12983                                    CP-RATING-BENEFIT-AMT.
 12984     IF CP-STATE-STD-ABBRV = 'OR'
 12985         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12986                                         PB-I-LF-ALT-BENEFIT-AMT.
 12987     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 12988     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 12989     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 12990     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12991     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 12992     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 12993     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 12994     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 12995     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 12996                                    CP-REMAINING-TERM
 12997                                    CP-LOAN-TERM.
 12998
 12999     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13000         NEXT SENTENCE
 13001     ELSE
 13002         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13003             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13004                                           PB-I-LF-PREMIUM-AMT.
 13005
 13006     IF PB-COMPANY-ID EQUAL 'CSL'
 13007        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13008           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 237
* EL050.cbl
 13009                                         PB-I-LF-PREMIUM-AMT.
 13010
 13011     IF PB-COMPANY-ID EQUAL 'NCB'
 13012         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13013            CP-EARN-AS-NET-PAY
 13014             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13015                 PB-I-LF-PREMIUM-AMT.
 13016
 13017     IF (CP-TRUNCATED-LIFE)
 13018        or ((pb-company-id = 'AHL')
 13019           and (pb-i-loan-term > pb-i-lf-term))
 13020        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13021
 13022     IF PB-COMPANY-ID EQUAL 'CRI'
 13023        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13024
 13025     IF CP-TERM-IS-DAYS
 13026         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13027     ELSE
 13028         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13029     IF PB-COMPANY-ID = 'DCC'
 13030        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13031        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13032        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13033        IF WS-LF-BEN-CATEGORY = 'D'
 13034           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13035           MOVE PB-I-LIFE-COMMISSION
 13036                                 TO CP-DCC-ACT-COMM
 13037           MOVE WS-LF-BEN-CATEGORY
 13038                                 TO CP-BEN-CATEGORY
 13039        END-IF
 13040        IF (CP-BENEFIT-CD (1:1) = 'P')
 13041           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13042           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13043        END-IF
 13044     END-IF
 13045     IF PB-COMPANY-ID = 'CSL'
 13046         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13047         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13048         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13049
 13050     IF PB-COMPANY-ID = 'CSL'
 13051        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13052
 13053     IF (CP-SPECIAL-CALC-CD = 'H')
 13054        OR (PB-COMPANY-ID = 'DCC')
 13055         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13056                                    TO CP-ALTERNATE-BENEFIT
 13057         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13058
 13059     IF (PB-COMPANY-ID = 'CID')
 13060        AND (WS-LF-EARNINGS-CALC = 'B')
 13061        AND (CP-STATE-STD-ABBRV = 'MN')
 13062        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13063                                 TO CP-ALTERNATE-BENEFIT
 13064        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13065     END-IF
 13066     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 238
* EL050.cbl
 13067     MOVE 'R'                   TO CP-RATE-FILE.
 13068     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13069
 13070     IF CP-ERROR-RATE-NOT-FOUND
 13071        MOVE ER-2641            TO WS-ERROR
 13072        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13073        GO TO 3300-CHECK-AH-RATES.
 13074
 13075     IF PB-COMPANY-ID EQUAL 'CRI'
 13076        IF CP-ERROR-NO-LIMITS-CRI
 13077           IF NOT ACCOUNT-LIFE-CHECKED
 13078              MOVE ER-2607      TO WS-ERROR
 13079              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13080
 13081******************************************************************
 13082*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13083*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13084******************************************************************
 13085
 13086* CALC LIFE AGE AT EXPIRATION.
 13087
 13088     COMPUTE WS-AGE-AT-EXPIRE =
 13089          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13090
 13091*    IF PB-STATE = 'CO' OR 'UT'
 13092*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13093*        MOVE 'F'            TO PB-FATAL-FLAG
 13094*        MOVE ER-2709        TO WS-ERROR
 13095*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13096*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13097
 13098*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13099*        MOVE 'X'            TO PB-FATAL-FLAG
 13100*        MOVE ER-2718        TO WS-ERROR
 13101*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13102*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13103
 13104* CALC A & H AGE AT EXPIRATION.
 13105
 13106     COMPUTE WS-AGE-AT-EXPIRE =
 13107          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13108
 13109*    IF PB-STATE = 'CO' OR 'UT'
 13110*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13111*        MOVE 'F'            TO PB-FATAL-FLAG
 13112*        MOVE ER-2709        TO WS-ERROR
 13113*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13114*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13115
 13116*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13117*        MOVE 'X'            TO PB-FATAL-FLAG
 13118*        MOVE ER-2718        TO WS-ERROR
 13119*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13120*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13121
 13122     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13123        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13124
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 239
* EL050.cbl
 13125     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13126        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13127
 13128     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13129        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13130
 13131     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13132         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13133         MOVE ER-2639        TO WS-ERROR
 13134         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13135
 13136
 13137******************************************************************
 13138*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13139******************************************************************
 13140
 13141 PREMIUM-EDITING-IS-BYPASSED.
 13142     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13143        AND (CP-R-MAX-ATT-AGE > +0)
 13144        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13145        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13146           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13147           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13148           MOVE '1'              TO DC-OPTION-CODE
 13149           PERFORM 8500-DATE-CONVERT
 13150                                 THRU 8500-EXIT
 13151           IF NO-CONVERSION-ERROR
 13152              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13153                 MOVE ER-2661       TO WS-ERROR
 13154*                PERFORM 9900-ERROR-FORMAT
 13155*                                THRU 9900-EXIT
 13156              END-IF
 13157           END-IF
 13158        ELSE
 13159           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13160           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13161              MOVE ER-2661       TO WS-ERROR
 13162*             PERFORM 9900-ERROR-FORMAT
 13163*                                THRU 9900-EXIT
 13164           ELSE
 13165              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13166                 MOVE ER-1570    TO WS-ERROR
 13167                 PERFORM 9900-ERROR-FORMAT
 13168                                 THRU 9900-EXIT
 13169              END-IF
 13170           END-IF
 13171        END-IF
 13172        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13173           MOVE PB-I-JOINT-BIRTHDAY
 13174                                 TO DC-BIN-DATE-1
 13175           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13176           MOVE '1'              TO DC-OPTION-CODE
 13177           PERFORM 8500-DATE-CONVERT
 13178                                 THRU 8500-EXIT
 13179           IF NO-CONVERSION-ERROR
 13180              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13181                 MOVE ER-2661       TO WS-ERROR
 13182*                PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 240
* EL050.cbl
 13183*                                THRU 9900-EXIT
 13184              END-IF
 13185           ELSE
 13186              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13187           END-IF
 13188        ELSE
 13189           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13190             (PB-I-LF-TERM / 12)
 13191           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13192              MOVE ER-2661       TO WS-ERROR
 13193*             PERFORM 9900-ERROR-FORMAT
 13194*                                THRU 9900-EXIT
 13195           ELSE
 13196              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13197                 MOVE ER-1571    TO WS-ERROR
 13198                 PERFORM 9900-ERROR-FORMAT
 13199                                 THRU 9900-EXIT
 13200              END-IF
 13201           END-IF
 13202        END-IF
 13203        IF WS-ERROR = ER-2661
 13204           PERFORM 9900-ERROR-FORMAT
 13205                                 THRU 9900-EXIT
 13206        END-IF
 13207     END-IF
 13208*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13209*       MOVE ER-2661             TO WS-ERROR
 13210*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13211
 13212     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13213        MOVE ER-2662             TO WS-ERROR
 13214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13215
 13216     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13217        MOVE ER-2677             TO WS-ERROR
 13218        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13219
 13220     IF CP-ERROR-LOAN-TERM
 13221        MOVE ER-2648             TO WS-ERROR
 13222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13223
 13224 3221-CHECK-ERROR-RATE-OPEN.
 13225
 13226     IF CP-ERROR-RATE-FILE-NOTOPEN
 13227         GO TO 3990-FILES-NOT-OPEN.
 13228
 13229     IF PB-COMPANY-ID NOT = 'DMD'
 13230        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13231     END-IF
 13232     .
 13233 3221-CONTINUE.
 13234     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13235                                    WS-DCC-AH-RATE
 13236     IF PB-COMPANY-ID = 'DCC'
 13237        IF WS-LF-BEN-CATEGORY = 'D'
 13238           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13239              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13240        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 241
* EL050.cbl
 13241     END-IF
 13242     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13243*   X'A4FF' = 12/31/2009
 13244     IF (PB-COMPANY-ID = 'CID')
 13245        AND (WS-LF-EARNINGS-CALC = 'B')
 13246        AND (CP-STATE-STD-ABBRV = 'MN')
 13247        AND (PB-CERT-EFF-DT > X'A4FF')
 13248        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13249     END-IF
 13250     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13251
 13252     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13253     IF (PB-COMPANY-ID = 'DCC')
 13254        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13255        AND (PB-I-POLICY-IS-MONTHLY)
 13256        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13257        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13258     END-IF
 13259     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13260     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13261     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13262     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13263     IF (PB-COMPANY-ID = 'DCC')
 13264        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13265        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13266        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13267        MOVE ER-2786             TO WS-ERROR
 13268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13269     END-IF
 13270
 13271     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13272
 13273******************************************************************
 13274*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13275******************************************************************
 13276     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13277        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13278
 13279     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13280        GO TO 3225-CHECK-ALT-LIFE-RATE
 13281     ELSE
 13282       IF PB-I-LF-RATE = ZERO
 13283          MOVE ER-2641          TO WS-ERROR
 13284          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13285
 13286 3225-CHECK-ALT-LIFE-RATE.
 13287
 13288     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13289        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13290        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13291         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13292
 13293     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13294         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13295             AND PB-COMPANY-ID NOT = 'DCC')
 13296                   OR
 13297              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13298              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 242
* EL050.cbl
 13299              AND PB-COMPANY-ID NOT = 'DCC')
 13300             MOVE ER-2720        TO  WS-ERROR
 13301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13302             GO TO 3225-RATING-CONT
 13303         ELSE
 13304             GO TO 3225-RATING-CONT.
 13305     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13306        AND (AM-GPCD = 01 OR 06 OR 15)
 13307        MOVE ER-2798             TO WS-ERROR
 13308        PERFORM 9900-ERROR-FORMAT
 13309                                 THRU 9900-EXIT
 13310*       GO TO 3225-RATING-CONT
 13311     END-IF
 13312     IF (PB-COMPANY-ID = 'CID')
 13313        AND (WS-LF-EARNINGS-CALC = 'B')
 13314        AND (CP-STATE-STD-ABBRV = 'MN')
 13315        AND (PB-CERT-EFF-DT > X'A4FF')
 13316        GO TO 3225-RATING-CONT
 13317     END-IF
 13318     IF PB-COMPANY-ID = 'DCC'
 13319        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13320           AND (PB-I-POLICY-IS-MONTHLY)
 13321           GO TO 3225-RATING-CONT
 13322        END-IF
 13323     END-IF
 13324
 13325     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13326        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13327        CP-EARN-AS-REG-BALLOON
 13328        NEXT SENTENCE
 13329     ELSE
 13330        MOVE '2'                 TO CP-EARNING-METHOD.
 13331
 13332 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13333
 13334     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13335
 13336     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13337        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13338        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13339         NEXT SENTENCE
 13340     ELSE
 13341         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13342
 13343     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13344     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13345     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13346                                     CP-RATING-BENEFIT-AMT.
 13347     IF CP-STATE-STD-ABBRV = 'OR'
 13348         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13349                                         PB-I-LF-ALT-BENEFIT-AMT.
 13350     IF PB-COMPANY-ID = 'DCC'
 13351        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13352     END-IF
 13353     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13354     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13355     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13356                                    CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 243
* EL050.cbl
 13357                                    CP-LOAN-TERM.
 13358     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13359        ADD +1                   TO CP-ORIGINAL-TERM
 13360                                    CP-REMAINING-TERM
 13361                                    CP-LOAN-TERM.
 13362
 13363     MOVE 'R'                   TO CP-RATE-FILE.
 13364     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13365
 13366     IF CP-ERROR-RATE-NOT-FOUND
 13367         MOVE ER-2641            TO WS-ERROR
 13368         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13369         GO TO 3300-CHECK-AH-RATES.
 13370
 13371     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13372     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13373
 13374     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13375         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13376
 13377     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13378                               + PB-I-LF-ALT-BENEFIT-AMT.
 13379
 13380     IF ACCOUNT-LIFE-CHECKED  OR
 13381        PB-POLICY-IS-VOIDED   OR
 13382        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13383        GO TO 3225-CONTINUE.
 13384
 13385     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13386        GO TO 3225-CONTINUE.
 13387
 13388     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13389                             EC-RT-LF-MAX-TOT-BEN
 13390        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13391        MOVE ER-2639       TO WS-ERROR
 13392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13393
 13394 3225-CONTINUE.
 13395     IF PB-I-LF-ALT-RATE = ZERO
 13396         MOVE ER-2659            TO WS-ERROR
 13397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13398
 13399     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13400        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13401        MOVE ER-2698             TO WS-ERROR
 13402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13403
 13404 3225-RATING-CONT.
 13405
 13406     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13407         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13408         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13409         MOVE ER-2687             TO WS-ERROR
 13410         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13411         GO TO 3290-EDIT-LF-REIN-RATE.
 13412
 13413* DMD RATING TEST
 13414     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 244
* EL050.cbl
 13415         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13416         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13417         MOVE ER-2687                 TO WS-ERROR
 13418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13419         GO TO 3290-EDIT-LF-REIN-RATE.
 13420
 13421 3230-CLIENT-MORT-CD-SPECIALS.
 13422
 13423     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13424     SET BIN-TO-GREG          TO TRUE.
 13425*    MOVE ' '                 TO DC-OPTION-CODE.
 13426     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13427     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13428
 13429 C-POS-3230-MORT-CD.
 13430     IF PB-COMPANY-ID = 'POS' AND
 13431        PB-SV-CARRIER = '2'
 13432         NEXT SENTENCE
 13433     ELSE
 13434         GO TO C-POS-3240-MORT-CD.
 13435
 13436     IF PB-SV-GROUPING = '030'
 13437        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13438         MOVE '2350' TO PB-I-MORT-CODE
 13439      ELSE
 13440         MOVE '3300' TO PB-I-MORT-CODE.
 13441
 13442
 13443 C-POS-3240-MORT-CD.
 13444     IF PB-COMPANY-ID = 'POS' AND
 13445        PB-SV-CARRIER = '1'
 13446         NEXT SENTENCE
 13447     ELSE
 13448         GO TO 3230-CONTINUE.
 13449
 13450     IF PB-SV-STATE = '45' OR '47'
 13451        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13452         MOVE '5200' TO PB-I-MORT-CODE
 13453     ELSE
 13454         MOVE '8300' TO PB-I-MORT-CODE.
 13455
 13456 3230-CONTINUE.
 13457
 13458     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13459        GO TO 3240-CONTINUE
 13460     END-IF
 13461
 13462     IF PB-CERT-EFF-DT > WS-971231
 13463        GO TO 3240-CONTINUE
 13464     END-IF
 13465
 13466     IF LF-BENEFIT-FOUND AND
 13467        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13468         MOVE 'F250'       TO PB-I-MORT-CODE
 13469     ELSE
 13470         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13471             MOVE '7250'   TO PB-I-MORT-CODE
 13472         ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 245
* EL050.cbl
 13473             MOVE '4251'   TO PB-I-MORT-CODE
 13474         END-IF
 13475     END-IF
 13476
 13477     .
 13478 3240-CONTINUE.
 13479
 13480     IF PB-COMPANY-ID NOT = 'GNL'
 13481         GO TO 3256-CONTINUE.
 13482
 13483     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13484         MOVE 'A300' TO PB-I-MORT-CODE
 13485     ELSE
 13486         MOVE '8350' TO PB-I-MORT-CODE.
 13487
 13488 3256-CONTINUE.
 13489     IF PB-COMPANY-ID NOT = 'ABL'
 13490         GO TO 3260-EDIT-CONTINUE.
 13491
 13492     IF PB-I-LF-TERM GREATER THAN 59
 13493         MOVE 'F550' TO PB-I-MORT-CODE
 13494     ELSE
 13495         MOVE 'E550' TO PB-I-MORT-CODE.
 13496
 13497 3260-EDIT-CONTINUE.
 13498     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13499
 13500 3290-EDIT-LF-REIN-RATE.
 13501     IF LF-REIN-NSP-NOT-USED
 13502         GO TO 3290-RATING-CONT.
 13503
 13504     IF PB-COMPANY-ID = 'DCC'
 13505        GO TO 3290-RATING-CONT.
 13506     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13507     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13508     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13509     MOVE '3'                   TO CP-PROCESS-TYPE.
 13510     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13511
 13512******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13513     IF PB-COMPANY-ID EQUAL 'CDL'
 13514         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13515            CP-EARN-AS-NET-PAY)
 13516             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13517*            MOVE SPACE          TO DC-OPTION-CODE
 13518             SET BIN-TO-GREG     TO TRUE
 13519             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13520***  Y2K PROJ 7744
 13521             IF DC-GREG-DATE-CYMD GREATER 19931231
 13522                 MOVE '1'        TO CP-EARNING-METHOD.
 13523***  Y2K PROJ 7744
 13524*******
 13525
 13526     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13527     MOVE PB-SV-STATE           TO CP-STATE.
 13528     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13529     MOVE ZERO                  TO CP-DEVIATION-CODE
 13530                                   CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 246
* EL050.cbl
 13531     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13532     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13533                                   CP-RATING-BENEFIT-AMT.
 13534
 13535************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13536     IF PB-COMPANY-ID EQUAL 'NCB'
 13537         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13538            CP-EARN-AS-NET-PAY
 13539             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13540                 PB-I-LF-PREMIUM-AMT.
 13541************
 13542
 13543     IF CP-STATE-STD-ABBRV = 'OR'
 13544         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13545                                         PB-I-LF-ALT-BENEFIT-AMT.
 13546     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13547     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13548     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13549     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13550     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13551     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13552     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13553     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13554                                   CP-REMAINING-TERM
 13555                                   CP-LOAN-TERM.
 13556     IF CP-TRUNCATED-LIFE
 13557        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13558
 13559     IF CP-TERM-IS-DAYS
 13560         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13561     ELSE
 13562         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13563
 13564     IF PB-COMPANY-ID = 'DCC'
 13565        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13566     END-IF
 13567     IF PB-COMPANY-ID NOT = 'TIC'
 13568          MOVE ZERO          TO CP-CLASS-CODE.
 13569
 13570     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13571
 13572     MOVE 'R'                   TO CP-RATE-FILE.
 13573     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13574
 13575     IF CP-ERROR-RATE-NOT-FOUND
 13576        IF PB-I-OB
 13577           MOVE ER-2625      TO WS-ERROR
 13578           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13579           GO TO 3299-EDIT-CONTINUE
 13580        ELSE
 13581           MOVE ER-2643      TO WS-ERROR
 13582           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13583           GO TO 3299-EDIT-CONTINUE.
 13584
 13585     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13586
 13587     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13588     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 247
* EL050.cbl
 13589
 13590     IF PB-I-LF-REI-RATE = ZERO
 13591         MOVE ER-2643        TO WS-ERROR
 13592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13593
 13594 3290-CHECK-ALT-REIN-RATE.
 13595
 13596     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13597        GO TO 3290-RATING-CONT.
 13598
 13599     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13600     MOVE '2'                    TO CP-EARNING-METHOD.
 13601     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13602     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13603     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13604     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13605                                     CP-RATING-BENEFIT-AMT.
 13606     IF CP-STATE-STD-ABBRV = 'OR'
 13607         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13608                                         PB-I-LF-ALT-BENEFIT-AMT.
 13609     IF PB-COMPANY-ID = 'DCC'
 13610        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13611     END-IF
 13612     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13613     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13614     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13615                                    CP-REMAINING-TERM
 13616                                    CP-LOAN-TERM.
 13617     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13618        ADD +1                   TO CP-ORIGINAL-TERM
 13619                                    CP-REMAINING-TERM
 13620                                    CP-LOAN-TERM.
 13621
 13622     MOVE 'R'                   TO CP-RATE-FILE.
 13623     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13624
 13625     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13626
 13627     IF PB-I-LF-ALT-REI-RATE = ZERO
 13628         MOVE ER-2643            TO WS-ERROR
 13629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13630
 13631 3290-RATING-CONT.
 13632
 13633     IF PB-I-OB
 13634*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13635        GO TO 3300-CHECK-AH-RATES.
 13636
 13637 3299-EDIT-CONTINUE.
 13638
 13639     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13640         NEXT SENTENCE
 13641     ELSE
 13642         MOVE ER-2620           TO WS-ERROR
 13643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13644
 13645 3300-CHECK-AH-RATES.
 13646     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 248
* EL050.cbl
 13647         NEXT SENTENCE
 13648     ELSE
 13649         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13650
 13651     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13652        ((CF-COMPANY-ID = 'DMD') AND
 13653                (NO-DMD-RATING))
 13654         MOVE ER-2687             TO WS-ERROR
 13655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13656         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13657         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13658
 13659     IF PB-I-OB
 13660        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13661
 13662     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13663         MOVE ER-2687             TO WS-ERROR
 13664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13665         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13666         GO TO 3999-END-EDIT.
 13667
 13668*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13669
 13670     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13671        IF PB-I-AH-CRIT-PER = ZERO
 13672           IF PB-COMPANY-ID = 'DCC'
 13673              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13674              CONTINUE
 13675           ELSE
 13676              MOVE ER-2618       TO WS-ERROR
 13677              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13678              GO TO 3999-END-EDIT
 13679           END-IF
 13680        END-IF
 13681     END-IF
 13682     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13683     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13684     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13685     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13686     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13687     MOVE PB-SV-STATE            TO CP-STATE.
 13688     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13689     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13690     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13691*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13692     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13693     MOVE '3'                    TO CP-PROCESS-TYPE.
 13694     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13695     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13696                                    CP-RATING-BENEFIT-AMT.
 13697     IF PB-COMPANY-ID = 'CID'
 13698               OR
 13699        CP-STATE-STD-ABBRV = 'OR'
 13700         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13701                                         PB-I-AH-TERM.
 13702     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13703        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13704           AND (PB-I-POLICY-IS-MONTHLY)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 249
* EL050.cbl
 13705           MOVE PB-I-LF-BENEFIT-AMT
 13706                                 TO CP-NET-BENEFIT-AMT
 13707           move pb-i-ah-premium-amt to cp-original-premium
 13708        END-IF
 13709     END-IF
 13710     MOVE SPACES                 TO CP-BEN-CATEGORY
 13711     IF PB-COMPANY-ID = 'DCC'
 13712        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13713        EVALUATE TRUE
 13714           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13715              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13716              MOVE PB-I-LF-BENEFIT-AMT
 13717                                 TO CP-RATING-BENEFIT-AMT
 13718              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13719           WHEN WS-AH-BEN-CATEGORY = 'G'
 13720              MOVE PB-I-UNPAID-CASH-PRICE
 13721                                 TO CP-RATING-BENEFIT-AMT
 13722           WHEN WS-AH-BEN-CATEGORY = 'D'
 13723              MOVE WS-AH-PMF-COMM
 13724                                 TO CP-DCC-PMF-COMM
 13725              MOVE PB-I-AH-COMMISSION
 13726                                 TO CP-DCC-ACT-COMM
 13727        END-EVALUATE
 13728     END-IF
 13729     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13730     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13731     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13732     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13733     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13734     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13735     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13736                                    CP-REMAINING-TERM
 13737                                    WS-WORK-TERM.
 13738     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13739
 13740     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13741     SET BIN-TO-GREG             TO TRUE.
 13742*    MOVE ' '                    TO DC-OPTION-CODE.
 13743     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13744     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13745
 13746     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13747     IF NOT VALID-SKIP-CODE
 13748         MOVE ER-2683            TO WS-ERROR
 13749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13750         GO TO 3320-RATE-CONTINUE.
 13751
 13752     IF PB-NO-MONTHS-SKIPPED
 13753         GO TO 3320-RATE-CONTINUE.
 13754
 13755     MOVE SPACE TO NUMBER-OF-MONTHS.
 13756
 13757     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13758         MOVE 'S'                TO SK-MO (6).
 13759     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13760         MOVE 'S'                TO SK-MO (7).
 13761     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13762         MOVE 'S'                TO SK-MO (8).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 250
* EL050.cbl
 13763     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13764         MOVE 'S'                TO SK-MO (9).
 13765     IF PB-I-SKIP-CODE = 'A'
 13766         MOVE 'S'                TO SK-MO (10).
 13767
 13768     MOVE 1                      TO SUB2.
 13769     MOVE PB-I-AH-TERM           TO SUB3.
 13770     MOVE WS-MONTH               TO SUB1.
 13771     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13772     GO TO 3320-RATE-CONTINUE.
 13773
 13774 3310-GET-SKIP-MO.
 13775     IF SUB1 = 13
 13776         MOVE 1                  TO SUB1.
 13777
 13778     IF SK-MO (SUB1) = 'S'
 13779         SUBTRACT 1 FROM WS-WORK-TERM.
 13780
 13781     ADD 1 TO SUB2
 13782              SUB1.
 13783
 13784 3320-RATE-CONTINUE.
 13785
 13786     IF WS-WORK-TERM = ZERO
 13787         MOVE 1                  TO WS-WORK-TERM.
 13788
 13789     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13790                                    CP-LOAN-TERM.
 13791
 13792     IF PB-COMPANY-ID EQUAL 'DMD'
 13793         NEXT SENTENCE
 13794     ELSE
 13795         MOVE ZERO               TO PB-I-AH-RATE
 13796                                    PB-I-AH-REI-RATE.
 13797
 13798
 13799     IF PB-COMPANY-ID EQUAL 'CRI'
 13800        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13801
 13802     IF PB-COMPANY-ID = 'CSL'
 13803         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13804         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13805         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13806         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13807
 13808     IF PB-COMPANY-ID = 'DCC'
 13809        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13810           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13811              PB-I-RATE-DEV-PCT-LF
 13812        END-IF
 13813        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13814                                 TO CP-ALTERNATE-BENEFIT
 13815        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13816        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13817        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13818     END-IF
 13819     IF (PB-COMPANY-ID = 'CID')
 13820        AND (WS-LF-EARNINGS-CALC = 'B')
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 251
* EL050.cbl
 13821        AND (CP-STATE-STD-ABBRV = 'MN')
 13822        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13823     ELSE
 13824        MOVE ' '                 TO CP-AH-BALLOON-SW
 13825     END-IF
 13826     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13827     MOVE 'R'                   TO CP-RATE-FILE.
 13828     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13829
 13830     IF CP-ERROR-RATE-NOT-FOUND
 13831        IF PB-I-OB
 13832           MOVE ER-2624          TO WS-ERROR
 13833           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13834           GO TO 3340-CALCULATE-PREMIUM-AMT
 13835        ELSE
 13836           MOVE ER-2642          TO WS-ERROR
 13837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13838           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13839
 13840     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13841        CP-ERROR-DIV-BY-ZERO
 13842           MOVE ER-3782          TO WS-ERROR
 13843           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13844
 13845     IF PB-COMPANY-ID EQUAL 'CRI'
 13846        IF CP-ERROR-NO-LIMITS-CRI
 13847           IF NOT ACCOUNT-AH-CHECKED
 13848              MOVE ER-2607          TO WS-ERROR
 13849              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13850
 13851     IF ACCOUNT-AH-CHECKED
 13852        NEXT SENTENCE
 13853     ELSE
 13854       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13855          MOVE ER-2640           TO WS-ERROR
 13856          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13857
 13858     IF PB-COMPANY-ID = 'CRI'
 13859         IF WS-ERROR = ER-2640
 13860             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13861     IF ACCOUNT-AH-CHECKED
 13862        CONTINUE
 13863     ELSE
 13864        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13865           AND (CP-R-MAX-ATT-AGE > +0)
 13866           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13867           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13868              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13869              MOVE PB-I-AH-EXPIRE-DT
 13870                                 TO DC-BIN-DATE-2
 13871              MOVE '1'           TO DC-OPTION-CODE
 13872              PERFORM 8500-DATE-CONVERT
 13873                                 THRU 8500-EXIT
 13874              IF NO-CONVERSION-ERROR
 13875                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13876                    MOVE ER-2661       TO WS-ERROR
 13877*                   PERFORM 9900-ERROR-FORMAT
 13878*                                THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 252
* EL050.cbl
 13879                 END-IF
 13880              END-IF
 13881           ELSE
 13882              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13883              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13884                 MOVE ER-2661    TO WS-ERROR
 13885*                PERFORM 9900-ERROR-FORMAT
 13886*                                THRU 9900-EXIT
 13887              ELSE
 13888                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13889                    MOVE ER-1570 TO WS-ERROR
 13890                    PERFORM 9900-ERROR-FORMAT
 13891                                 THRU 9900-EXIT
 13892                 END-IF
 13893              END-IF
 13894           END-IF
 13895           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13896              MOVE PB-I-JOINT-BIRTHDAY
 13897                                    TO DC-BIN-DATE-1
 13898              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13899              MOVE '1'              TO DC-OPTION-CODE
 13900              PERFORM 8500-DATE-CONVERT
 13901                                    THRU 8500-EXIT
 13902              IF NO-CONVERSION-ERROR
 13903                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13904                    MOVE ER-2661       TO WS-ERROR
 13905*                   PERFORM 9900-ERROR-FORMAT
 13906*                                   THRU 9900-EXIT
 13907                 END-IF
 13908              END-IF
 13909           ELSE
 13910              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13911                (PB-I-AH-TERM / 12)
 13912              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13913                 MOVE ER-2661       TO WS-ERROR
 13914*                PERFORM 9900-ERROR-FORMAT
 13915*                                   THRU 9900-EXIT
 13916              ELSE
 13917                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13918                    MOVE ER-1571 TO WS-ERROR
 13919                    PERFORM 9900-ERROR-FORMAT
 13920                                 THRU 9900-EXIT
 13921                 END-IF
 13922              END-IF
 13923           END-IF
 13924           IF WS-ERROR = ER-2661
 13925              PERFORM 9900-ERROR-FORMAT
 13926                                    THRU 9900-EXIT
 13927           END-IF
 13928        END-IF
 13929     END-IF
 13930*    IF ACCOUNT-AH-CHECKED
 13931*       NEXT SENTENCE
 13932*    ELSE
 13933*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13934*          MOVE ER-2661          TO WS-ERROR
 13935*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13936
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 253
* EL050.cbl
 13937     IF ACCOUNT-AH-CHECKED
 13938        NEXT SENTENCE
 13939     ELSE
 13940        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13941           MOVE ER-2663          TO WS-ERROR
 13942           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13943
 13944     IF ACCOUNT-AH-CHECKED OR
 13945        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 13946         PB-POLICY-IS-VOIDED
 13947        NEXT SENTENCE
 13948     ELSE
 13949        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 13950           MOVE ER-2667            TO WS-ERROR
 13951           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13952
 13953     IF PB-COMPANY-ID = 'CRI'
 13954         IF WS-ERROR = ER-2667
 13955             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13956
 13957     IF ACCOUNT-AH-CHECKED
 13958        NEXT SENTENCE
 13959     ELSE
 13960        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13961           MOVE ER-2678            TO WS-ERROR
 13962           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13963
 13964     IF CP-ERROR-RATE-FILE-NOTOPEN
 13965         GO TO 3990-FILES-NOT-OPEN.
 13966
 13967 3321-CONTINUE.
 13968     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 13969     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 13970     IF (PB-COMPANY-ID = 'DCC')
 13971        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 13972        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 13973                                    PB-I-LF-ALT-PREM-CALC
 13974        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13975        IF WS-AH-BEN-CATEGORY = 'G'
 13976           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13977           + PB-I-ADDL-CLP)
 13978           * (1 + WS-TOL-CLP-PCT)
 13979*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 13980        ELSE
 13981           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13982           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 13983*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 13984        END-IF
 13985        MOVE WS-TOL-LF-HIGH-PREM-AMT
 13986                                 TO PB-I-AH-PREM-CALC
 13987        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 13988           MOVE ER-8152          TO WS-ERROR
 13989           PERFORM 9900-ERROR-FORMAT
 13990                                 THRU 9900-EXIT
 13991        ELSE
 13992           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 13993                 PB-I-ADDL-CLP)
 13994              MOVE ER-8148       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 254
* EL050.cbl
 13995              PERFORM 9900-ERROR-FORMAT
 13996                                 THRU 9900-EXIT
 13997           END-IF
 13998        END-IF
 13999     END-IF
 14000     IF (PB-COMPANY-ID = 'DCC')
 14001        AND (PB-I-POLICY-IS-MONTHLY)
 14002        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14003        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14004        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14005           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14006        END-IF
 14007     END-IF
 14008     IF (PB-COMPANY-ID = 'DCC')
 14009        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14010        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14011        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14012        MOVE ER-2786             TO WS-ERROR
 14013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14014     END-IF
 14015     MOVE +0                     TO PB-I-AH-CLP
 14016     IF PB-COMPANY-ID = 'DCC'
 14017        IF WS-AH-BEN-CATEGORY = 'D'
 14018           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14019              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14020        ELSE
 14021           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14022              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14023           END-IF
 14024        END-IF
 14025     END-IF
 14026     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14027
 14028     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14029         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14030
 14031     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14032         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14033
 14034     IF PB-COMPANY-ID = 'CRI'
 14035         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14036            PB-I-PAYMENT-AMOUNT = ZERO
 14037             NEXT SENTENCE
 14038         ELSE
 14039             COMPUTE PB-I-AH-PREM-CALC =
 14040                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14041                 (CP-PREMIUM-RATE / 100)
 14042             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14043                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14044                                             PB-I-RATE-DEV-PCT-AH.
 14045
 14046     IF PB-I-AH-RATE  = ZERO
 14047         MOVE ER-2642            TO WS-ERROR
 14048         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14049
 14050     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14051     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14052     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 255
* EL050.cbl
 14053     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14054     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14055     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14056
 14057     IF (PB-COMPANY-ID = 'DCC')
 14058        AND (WS-AH-BEN-CATEGORY = 'G')
 14059        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14060        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14061        IF CP-DEVIATION-CODE NOT = '000'
 14062           MOVE '000'            TO CP-DEVIATION-CODE
 14063           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14064           IF NO-CP-ERROR
 14065              COMPUTE PB-I-DDF-IU-RATE-UP =
 14066              PB-I-AH-CLP - CP-CALC-PREMIUM
 14067           ELSE
 14068              MOVE ER-3057        TO WS-ERROR
 14069              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14070           END-IF
 14071        END-IF
 14072     END-IF
 14073     .
 14074 3335-EDIT-AH-REIN-NSP-RATE.
 14075     IF AH-REIN-NSP-NOT-USED
 14076         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14077
 14078     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14079     IF PB-COMPANY-ID = 'DCC'
 14080         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14081     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14082     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14083     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14084     MOVE PB-SV-STATE            TO CP-STATE.
 14085     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14086     MOVE ZERO                   TO CP-DEVIATION-CODE
 14087                                    CP-RATE-DEV-PCT.
 14088*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14089     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14090     MOVE '3'                    TO CP-PROCESS-TYPE.
 14091     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14092     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14093                                    CP-RATING-BENEFIT-AMT.
 14094     IF CP-STATE-STD-ABBRV = 'OR'
 14095         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14096                                         PB-I-AH-TERM.
 14097     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14098     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14099     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14100     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14101     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14102     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14103                                    CP-REMAINING-TERM
 14104                                    WS-WORK-TERM.
 14105     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14106     IF PB-COMPANY-ID = 'DCC'
 14107        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14108     END-IF
 14109     IF  PB-COMPANY-ID = 'TIC'
 14110         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 256
* EL050.cbl
 14111            MOVE ZERO TO CP-CLASS-CODE.
 14112
 14113     IF PB-COMPANY-ID NOT = 'TIC'
 14114          MOVE ZERO          TO CP-CLASS-CODE.
 14115
 14116     MOVE ZERO               TO CP-DEVIATION-CODE.
 14117
 14118     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14119
 14120     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14121
 14122     MOVE 'R'                   TO CP-RATE-FILE.
 14123     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14124
 14125     IF CP-ERROR-RATE-NOT-FOUND
 14126         MOVE ER-2645        TO WS-ERROR
 14127         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14128         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14129
 14130     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14131
 14132     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14133     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14134
 14135     IF PB-I-AH-REI-RATE = ZERO
 14136         MOVE ER-2645        TO WS-ERROR
 14137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14138
 14139
 14140 3340-CALCULATE-PREMIUM-AMT.
 14141
 14142     IF PB-COMPANY-ID = 'NCL'
 14143         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14144             WS-AH-SPECIAL-CALC-CD = 'O')
 14145             GO TO 3999-END-EDIT.
 14146
 14147     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14148                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14149                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14150                         OR 'AHL'
 14151         NEXT SENTENCE
 14152     ELSE
 14153         IF WS-STATE-ABBREVIATION = 'CT'
 14154             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14155                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14156                 COMPUTE PB-I-LF-PREM-CALC =
 14157                                     PB-I-LF-PREM-CALC * .90
 14158                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14159                                     PB-I-LF-ALT-PREM-CALC * .90
 14160                 COMPUTE PB-I-AH-PREM-CALC =
 14161                                     PB-I-AH-PREM-CALC * .90.
 14162
 14163     IF PB-COMP-LF-PREM
 14164        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14165        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14166
 14167     IF PB-COMP-AH-PREM
 14168        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 257
* EL050.cbl
 14169
 14170 3340-CHECK-DCC-TOT-FEES.
 14171     IF (PB-COMPANY-ID = 'DCC')
 14172        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14173        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14174        AND (PB-I-POLICY-IS-MONTHLY)
 14175        CONTINUE
 14176     ELSE
 14177        GO TO 3340-EDIT-LF-AH-TOL
 14178     END-IF
 14179     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14180     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14181     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14182        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14183           PB-I-RATE-DEV-PCT-LF
 14184     END-IF
 14185     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14186        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14187           PB-I-RATE-DEV-PCT-AH
 14188     END-IF
 14189     MOVE 'N'                    TO CP-BEN-CATEGORY
 14190     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14191
 14192     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14193     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14194     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14195     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14196     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14197     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14198     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14199     MOVE '3'                    TO CP-PROCESS-TYPE.
 14200     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14201     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14202
 14203     MOVE PB-SV-STATE            TO CP-STATE.
 14204     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14205     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14206     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14207     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14208     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14209                                    CP-RATING-BENEFIT-AMT.
 14210     IF CP-STATE-STD-ABBRV = 'OR'
 14211         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14212                                         PB-I-LF-ALT-BENEFIT-AMT.
 14213     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14214     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14215     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14216     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14217     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14218     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14219     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14220     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14221     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14222                                    CP-REMAINING-TERM
 14223                                    CP-LOAN-TERM.
 14224
 14225     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14226         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 258
* EL050.cbl
 14227     ELSE
 14228         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14229             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14230                                           PB-I-LF-PREMIUM-AMT.
 14231
 14232     IF CP-TRUNCATED-LIFE
 14233        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14234
 14235     IF CP-TERM-IS-DAYS
 14236         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14237     ELSE
 14238         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14239
 14240     IF PB-COMPANY-ID = 'DCC'
 14241        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14242     END-IF
 14243     IF CP-SPECIAL-CALC-CD = 'H'
 14244         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14245                                    TO CP-ALTERNATE-BENEFIT
 14246         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14247     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14248     MOVE 'R'                    TO CP-RATE-FILE
 14249     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14250     IF NOT CP-ERROR-RATE-NOT-FOUND
 14251        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14252        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14253           AND (CP-BENEFIT-CD (1:1) = 'S')
 14254           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14255                                    PB-I-LF-PREMIUM-AMT
 14256        END-IF
 14257     ELSE
 14258        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14259     END-IF
 14260     .
 14261 3340-EDIT-LF-AH-TOL.
 14262
 14263***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14264***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14265***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14266***
 14267     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14268         PB-I-AH-PREMIUM-AMT
 14269          GIVING WS-CALC-WORK.
 14270
 14271     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14272        AND WS-CALC-WORK NOT = ZERO
 14273         MOVE ER-2649            TO WS-ERROR
 14274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14275
 14276     SUBTRACT PB-I-LF-PREM-CALC
 14277             FROM PB-I-LF-PREMIUM-AMT
 14278                 GIVING WS-UNSIGN-WRK1.
 14279
 14280     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14281             FROM PB-I-LF-ALT-PREMIUM-AMT
 14282                 GIVING WS-UNSIGN-WRK4.
 14283
 14284     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 259
* EL050.cbl
 14285                                + WS-UNSIGN-WRK4.
 14286
 14287     SUBTRACT PB-I-AH-PREM-CALC
 14288             FROM PB-I-AH-PREMIUM-AMT
 14289                 GIVING WS-UNSIGN-WRK2.
 14290
 14291******************************************************************
 14292*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14293******************************************************************
 14294
 14295     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14296         MOVE ZERO TO WS-UNSIGN-WRK1.
 14297
 14298     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14299         MOVE ZERO TO WS-UNSIGN-WRK2.
 14300
 14301     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14302             GIVING WS-UNSIGN-WRK3.
 14303
 14304 3342-CONTINUE.
 14305
 14306     IF (PB-I-LF-RATE = ZERO  AND
 14307         PB-I-AH-RATE = ZERO)
 14308         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14309            WS-AH-SPECIAL-CALC-CD = 'O'
 14310              NEXT SENTENCE
 14311         ELSE
 14312             GO TO 3345-EDIT-CONTINUE.
 14313
 14314     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14315         NEXT SENTENCE
 14316     ELSE
 14317     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14318        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14319           IF (PB-REISSUED-CERT         OR
 14320               PB-POLICY-IS-DECLINED    OR
 14321               PB-POLICY-IS-VOIDED)
 14322              NEXT SENTENCE
 14323           ELSE
 14324              IF WS-PREM-REJECT-SW = SPACE
 14325                 MOVE ER-2652    TO WS-ERROR
 14326                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14327                 GO TO 3344-CHECK-AH
 14328              ELSE
 14329                 MOVE ER-2650    TO WS-ERROR
 14330                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14331                 GO TO 3344-CHECK-AH.
 14332
 14333***
 14334***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14335***
 14336
 14337     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14338         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14339            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14340             (1 + WS-TOL-LF-PREM-PCT)
 14341         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14342            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 260
* EL050.cbl
 14343             (1 - WS-TOL-LF-PREM-PCT)
 14344     ELSE
 14345         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14346         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14347
 14348***
 14349***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14350***
 14351
 14352     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14353         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14354          WS-TOL-LF-PREM.
 14355
 14356     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14357         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14358          WS-TOL-LF-PREM.
 14359
 14360     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14361        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14362
 14363     IF (PB-REISSUED-CERT        OR
 14364         PB-POLICY-IS-DECLINED   OR
 14365         PB-POLICY-IS-VOIDED)
 14366        NEXT SENTENCE
 14367     ELSE
 14368     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14369           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14370       OR
 14371        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14372           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14373       AND
 14374        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14375           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14376         OR
 14377          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14378           LESS WS-TOL-LF-LOW-PREM-PCT))
 14379              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14380                  MOVE ER-2652   TO  WS-ERROR
 14381                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14382              ELSE
 14383                  MOVE ER-2650   TO  WS-ERROR
 14384                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14385
 14386*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14387*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14388*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14389*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14390
 14391     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14392        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14393                      OR
 14394           ((PB-COMPANY-ID = 'DCC')
 14395           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14396           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14397           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14398        END-IF
 14399     END-IF
 14400
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 261
* EL050.cbl
 14401     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14402        IF WS-COMP-MAX-CAP GREATER THAN +0
 14403           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14404              IF (PB-REISSUED-CERT         OR
 14405                  PB-POLICY-IS-DECLINED    OR
 14406                  PB-POLICY-IS-VOIDED)
 14407                 NEXT SENTENCE
 14408              ELSE
 14409                  MOVE ER-2646   TO  WS-ERROR
 14410                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14411
 14412 3344-CVL-TOLERANCE-CHECK.
 14413
 14414      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14415          GO TO 3344-CHECK-AH.
 14416
 14417      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14418          GO TO 3344-CHECK-AH.
 14419
 14420      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14421                                     WS-UNSIGN-WRK6.
 14422
 14423      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14424          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14425                                 + PB-I-LF-PREMIUM-AMT
 14426                                 - PB-I-LF-PREM-CALC.
 14427
 14428      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14429          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14430                                 + PB-I-LF-ALT-PREMIUM-AMT
 14431                                 - PB-I-LF-ALT-PREM-CALC.
 14432
 14433      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14434          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14435              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14436                 MOVE ER-2652    TO  WS-ERROR
 14437                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14438              ELSE
 14439                 MOVE ER-2650    TO  WS-ERROR
 14440                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14441
 14442      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14443          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14444              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14445                 MOVE ER-2652    TO  WS-ERROR
 14446                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14447              ELSE
 14448                 MOVE ER-2650    TO  WS-ERROR
 14449                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14450
 14451 3344-CHECK-AH.
 14452
 14453****************************************************************
 14454***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14455***
 14456
 14457     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14458         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 262
* EL050.cbl
 14459             (1 + WS-TOL-AH-PREM-PCT)
 14460         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14461             (1 - WS-TOL-AH-PREM-PCT)
 14462     ELSE
 14463         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14464         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14465
 14466***
 14467***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14468***
 14469
 14470     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14471         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14472
 14473     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14474         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14475
 14476     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14477        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14478
 14479     IF (PB-REISSUED-CERT)
 14480        OR (PB-POLICY-IS-DECLINED)
 14481        OR (PB-POLICY-IS-VOIDED)
 14482        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14483        CONTINUE
 14484     ELSE
 14485        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14486            OR
 14487           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14488           AND
 14489           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14490           OR
 14491           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14492           IF WS-PREM-REJECT-SW = SPACE
 14493              MOVE ER-3052       TO WS-ERROR
 14494              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14495           ELSE
 14496              MOVE ER-3050       TO WS-ERROR
 14497              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14498           END-IF
 14499        END-IF
 14500     END-IF
 14501
 14502     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14503         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14504             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14505             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14506
 14507     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14508        IF WS-COMP-MAX-CAP GREATER THAN +0
 14509           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14510              IF (PB-REISSUED-CERT         OR
 14511                  PB-POLICY-IS-DECLINED    OR
 14512                  PB-POLICY-IS-VOIDED)
 14513                 NEXT SENTENCE
 14514              ELSE
 14515                  MOVE ER-2646   TO  WS-ERROR
 14516                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 263
* EL050.cbl
 14517
 14518     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14519        (WS-COMP-MAX-CAP EQUAL +0)
 14520           GO TO 3345-EDIT-CONTINUE.
 14521
 14522     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14523        GREATER THAN WS-COMP-MAX-CAP
 14524           MOVE ER-2646          TO  WS-ERROR
 14525           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14526
 14527 3345-EDIT-CONTINUE.
 14528
 14529*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14530*       IF PB-ENTRY-BATCH   NUMERIC
 14531*          IF PB-ISSUE
 14532*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14533*          ELSE
 14534*              IF PB-CANCELLATION
 14535*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14536
 14537*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14538*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14539*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14540*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14541*        ELSE
 14542*            MOVE  ER-1909            TO  WS-ERROR
 14543*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14544
 14545     IF PB-I-POLICY-ACCEPTED
 14546        IF PB-POLICY-IS-DECLINED  OR
 14547           PB-REISSUED-CERT  OR
 14548           PB-REIN-ONLY-CERT  OR
 14549           PB-POLICY-IS-VOIDED
 14550            MOVE  ER-1891         TO  WS-ERROR
 14551            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14552        ELSE
 14553            MOVE SPACE            TO  PB-BATCH-ENTRY
 14554            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14555
 14556     IF PB-I-POLICY-DECLINED
 14557        IF PB-REISSUED-CERT  OR
 14558           PB-REIN-ONLY-CERT  OR
 14559           PB-POLICY-IS-VOIDED
 14560            MOVE  ER-1906         TO  WS-ERROR
 14561            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14562        ELSE
 14563            MOVE  'D'             TO  PB-BATCH-ENTRY
 14564                                      PB-I-ENTRY-STATUS.
 14565
 14566     IF PB-I-NEEDS-UNDERWRITING
 14567        IF PB-POLICY-IS-DECLINED OR
 14568           PB-REISSUED-CERT  OR
 14569           PB-REIN-ONLY-CERT  OR
 14570           PB-POLICY-IS-VOIDED
 14571            MOVE  ER-1907         TO  WS-ERROR
 14572            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14573        ELSE
 14574            MOVE 'U'              TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 264
* EL050.cbl
 14575                                      PB-I-ENTRY-STATUS.
 14576
 14577     IF PB-NEEDS-UNDERWRITING
 14578        MOVE  ER-1901             TO  WS-ERROR
 14579        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14580     IF PB-COMPANY-ID = 'DCC'
 14581        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14582        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14583        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14584           AND (NOT WS-LF-CASH))
 14585                           OR
 14586           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14587           AND (NOT WS-AH-CASH)))
 14588                       AND
 14589           (PB-I-ENTRY-STATUS NOT = '5')
 14590           MOVE 'M'              TO PB-BATCH-ENTRY
 14591                                    PB-I-ENTRY-STATUS
 14592        END-IF
 14593     END-IF
 14594     IF  PB-COMPANY-ID NOT = 'NCL'
 14595         GO TO 3999-END-EDIT.
 14596
 14597     IF PB-REISSUED-CERT  OR
 14598        PB-POLICY-IS-DECLINED  OR
 14599        PB-POLICY-IS-VOIDED  OR
 14600        PB-I-OB
 14601         GO TO 3999-END-EDIT.
 14602
 14603     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14604         MOVE  ER-2644            TO  WS-ERROR
 14605         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14606         GO TO 3999-END-EDIT.
 14607
 14608     MOVE 'N'                     TO  FORM-MASTER-SW.
 14609     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14610
 14611     IF NOT FORM-MASTER-FOUND
 14612         GO TO 3999-END-EDIT.
 14613
 14614     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14615                                      FORM-MASTER-AH-SW.
 14616
 14617     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14618         MOVE  +1                 TO SUB6
 14619         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14620
 14621     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14622         MOVE  +1                 TO SUB6
 14623         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14624
 14625     IF LF-FORM-MASTER-FOUND  OR
 14626        AH-FORM-MASTER-FOUND
 14627         GO TO 3360-CHECK-FORM-LIMITS
 14628     ELSE
 14629         GO TO 3999-END-EDIT.
 14630
 14631******************************************************************
 14632*                  3350-GET-ERFORM                               *
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 265
* EL050.cbl
 14633*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14634*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14635******************************************************************
 14636
 14637 3350-GET-ERFORM.
 14638
 14639     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14640         GO TO  3350-ERFORM-GETMAIN.
 14641
 14642     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14643     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14644     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14645     MOVE 'Y'                     TO FORM-MASTER-SW.
 14646
 14647     IF PB-CANCELLATION
 14648         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14649            PB-SV-STATE          EQUAL   FO-STATE       AND
 14650            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14651              GO TO 3350-EXIT
 14652         ELSE
 14653             NEXT SENTENCE
 14654     ELSE
 14655         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14656            PB-SV-STATE          EQUAL   FO-STATE       AND
 14657            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14658              GO TO 3350-EXIT.
 14659
 14660 3350-ERFORM-GETMAIN.
 14661
 14662     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14663     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14664
 14665 3350-ERFORM-READ.
 14666
 14667     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14668     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14669     IF PB-CANCELLATION
 14670         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14671     ELSE
 14672         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14673     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14674
 14675     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14676
 14677     IF FORM-MASTER-FOUND
 14678       IF PB-CANCELLATION
 14679          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14680             PB-SV-STATE          EQUAL   FO-STATE       AND
 14681             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14682              GO  TO 3350-EXIT
 14683          ELSE
 14684              NEXT SENTENCE
 14685       ELSE
 14686          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14687             PB-SV-STATE          EQUAL   FO-STATE       AND
 14688             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14689              GO  TO 3350-EXIT.
 14690
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 266
* EL050.cbl
 14691     MOVE  'N'                    TO  FORM-MASTER-SW.
 14692     MOVE  ER-1895                TO  WS-ERROR.
 14693     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14694
 14695 3350-EXIT.
 14696      EXIT.
 14697
 14698******************************************************************
 14699*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14700*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14701*   VALID FOR THE POLICY FORM USED.                              *
 14702******************************************************************
 14703
 14704 3355-EDIT-FORM-LF-BENEFITS.
 14705
 14706     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14707        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14708         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14709         GO TO   3355-EXIT.
 14710
 14711     IF  SUB6    LESS THAN   +40
 14712         ADD  +1      TO  SUB6
 14713         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14714
 14715     MOVE  ER-1896         TO  WS-ERROR.
 14716     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14717
 14718 3355-EXIT.
 14719      EXIT.
 14720
 14721******************************************************************
 14722*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14723*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14724*   VALID FOR THE POLICY FORM USED.                              *
 14725******************************************************************
 14726
 14727 3356-EDIT-FORM-AH-BENEFITS.
 14728
 14729     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14730        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14731         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14732         GO TO  3356-EXIT.
 14733
 14734      IF  SUB6    LESS THAN     +40
 14735          ADD  +1      TO  SUB6
 14736          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14737
 14738     MOVE  ER-1897         TO  WS-ERROR.
 14739     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14740
 14741 3356-EXIT.
 14742      EXIT.
 14743
 14744******************************************************************
 14745*                  3357-BENEFIT-SEARCH                           *
 14746*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14747*   CANCELLATIONS ONLY.                                          *
 14748******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 267
* EL050.cbl
 14749 3357-BENEFIT-SEARCH.
 14750     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14751         MOVE +1                          TO SUB6
 14752         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14753
 14754     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14755         MOVE +1                          TO SUB6
 14756         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14757
 14758 3357-EXIT.
 14759     EXIT.
 14760
 14761******************************************************************
 14762*                  3358-BENEFIT-LIFE-SEARCH                      *
 14763*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14764*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14765*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14766******************************************************************
 14767 3358-BENEFIT-LIFE-SEARCH.
 14768     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14769       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14770         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14771           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14772              IF FO-PLAN-REFUND-METHOD (SUB6)
 14773                     IS GREATER THAN SPACES
 14774                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14775                                          WS-LF-REFUND-CALC
 14776                 GO TO 3358-EXIT.
 14777
 14778     IF SUB6 LESS THAN +40
 14779         ADD +1                 TO SUB6
 14780         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14781
 14782 3358-EXIT.
 14783     EXIT.
 14784******************************************************************
 14785*                  3359-BENEFIT-AH-SEARCH                        *
 14786*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14787*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14788*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14789******************************************************************
 14790 3359-BENEFIT-AH-SEARCH.
 14791     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14792       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14793         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14794           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14795              IF FO-PLAN-REFUND-METHOD (SUB6)
 14796                      IS GREATER THAN SPACES
 14797                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14798                                          WS-AH-REFUND-CALC
 14799                 GO TO 3359-EXIT.
 14800
 14801     IF SUB6 LESS THAN +40
 14802         ADD +1                 TO SUB6
 14803         GO TO 3359-BENEFIT-AH-SEARCH.
 14804
 14805 3359-EXIT.
 14806     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 268
* EL050.cbl
 14807
 14808******************************************************************
 14809*                  3360-CHECK-FORM-LIMITS                        *
 14810*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14811*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14812******************************************************************
 14813
 14814 3360-CHECK-FORM-LIMITS.
 14815
 14816     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14817         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14818
 14819     IF NOT LF-FORM-MASTER-FOUND
 14820         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14821
 14822 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14823
 14824     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14825       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14826        WS-LF-JOINT-INDICATOR = 'J'  AND
 14827        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14828         IF PB-COMPANY-ID = 'NCL'
 14829            MOVE  ER-1911          TO  WS-ERROR
 14830            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14831         ELSE
 14832            MOVE  ER-1892          TO  WS-ERROR
 14833            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14834
 14835 3360-CHECK-FORM-LF-ATT-AGE.
 14836
 14837     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14838
 14839     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14840         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14841         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14842            IF PB-COMPANY-ID = 'NCL'
 14843                MOVE  ER-1913      TO  WS-ERROR
 14844                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14845            ELSE
 14846                MOVE  ER-1894      TO  WS-ERROR
 14847                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14848
 14849 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14850
 14851     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14852         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14853         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14854            IF PB-COMPANY-ID = 'NCL'
 14855                MOVE  ER-1914      TO  WS-ERROR
 14856                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14857            ELSE
 14858                MOVE  ER-1899      TO  WS-ERROR
 14859                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14860
 14861 3360-CHECK-FORM-LF-TERM-BAMT.
 14862
 14863     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14864         FO-LF-MAX-TERM   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 269
* EL050.cbl
 14865         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14866           IF  PB-COMPANY-ID = 'NCL'
 14867               MOVE  ER-1916       TO  WS-ERROR
 14868               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14869           ELSE
 14870               MOVE  ER-1902       TO  WS-ERROR
 14871               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14872
 14873     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14874                                    PB-I-LF-ALT-BENEFIT-AMT.
 14875
 14876     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14877         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14878         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14879             IF  PB-COMPANY-ID = 'NCL'
 14880                 MOVE  ER-1918     TO  WS-ERROR
 14881                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14882             ELSE
 14883                 MOVE  ER-1904     TO  WS-ERROR
 14884                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14885
 14886******************************************************************
 14887*                  3360-CHECK-FORM-AH-LIMITS                     *
 14888*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14889*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14890******************************************************************
 14891
 14892 3360-CHECK-FORM-AH-LIMITS.
 14893
 14894     IF NOT AH-FORM-MASTER-FOUND
 14895         GO TO 3999-END-EDIT.
 14896
 14897 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 14898
 14899     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 14900       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 14901        WS-AH-JOINT-INDICATOR = 'J'  AND
 14902        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14903         IF PB-COMPANY-ID = 'NCL'
 14904            MOVE  ER-1912          TO  WS-ERROR
 14905            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14906         ELSE
 14907            MOVE  ER-1893          TO  WS-ERROR
 14908            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14909
 14910 3360-CHECK-FORM-AH-ATT-AGE.
 14911
 14912     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 14913
 14914     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 14915         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14916         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 14917            IF PB-COMPANY-ID = 'NCL'
 14918                MOVE  ER-1913      TO  WS-ERROR
 14919                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14920            ELSE
 14921                MOVE  ER-1894      TO  WS-ERROR
 14922                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 270
* EL050.cbl
 14923
 14924 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 14925
 14926     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 14927         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 14928         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 14929            IF PB-COMPANY-ID = 'NCL'
 14930                MOVE  ER-1915      TO  WS-ERROR
 14931                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14932            ELSE
 14933                MOVE  ER-1900      TO  WS-ERROR
 14934                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14935
 14936 3360-CHECK-FORM-AH-TERM-BAMT.
 14937
 14938     IF  FO-AH-MAX-TERM    NUMERIC   AND
 14939         FO-AH-MAX-TERM    GREATER THAN  +0
 14940         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 14941             IF  PB-COMPANY-ID = 'NCL'
 14942                 MOVE  ER-1917     TO  WS-ERROR
 14943                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14944             ELSE
 14945                  MOVE  ER-1903    TO  WS-ERROR
 14946                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14947
 14948     IF  FO-MAX-AH-AMT    NUMERIC   AND
 14949         FO-MAX-AH-AMT    GREATER THAN  +0
 14950         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 14951             IF  PB-COMPANY-ID = 'NCL'
 14952                 MOVE  ER-1919     TO  WS-ERROR
 14953                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14954             ELSE
 14955                 MOVE  ER-1905     TO  WS-ERROR
 14956                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14957
 14958     GO TO 3999-END-EDIT.
 14959
 14960******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 271
* EL050.cbl
 14962******************************************************************
 14963*                  E D I T   C A N C E L                         *
 14964******************************************************************
 14965
 14966 3700-EDIT-CANCEL.
 14967     IF PB-COMPANY-ID = 'DMD'
 14968         MOVE ZEROS                   TO WS-RES-STATE-TAX
 14969                                         WS-RES-MUNI-TAX
 14970                                         PB-CI-STATE-TAX
 14971                                         PB-CI-MUNI-TAX
 14972         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 14973
 14974*    IF PB-COMPANY-ID  EQUAL  'NCL'
 14975*       IF PB-ENTRY-BATCH  NUMERIC
 14976*          IF PB-CANCELLATION
 14977*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 14978*          ELSE
 14979*             IF PB-ISSUE
 14980*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 14981
 14982     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 14983        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 14984     END-IF
 14985*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 14986*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 14987
 14988     IF CM-ENTRY-STATUS = 'V'
 14989        MOVE ER-2780             TO WS-ERROR
 14990        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14991        GO TO 3999-END-EDIT.
 14992
 14993     IF CM-ENTRY-STATUS = 'D'
 14994        MOVE ER-2781             TO WS-ERROR
 14995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14996        GO TO 3999-END-EDIT.
 14997
 14998     IF CM-ENTRY-STATUS = 'U'
 14999        MOVE ER-2782             TO WS-ERROR
 15000        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15001
 15002***************************************************************
 15003*                                                             *
 15004*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15005*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15006*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15007*   OF ANOTHER COVERAGE.                                      *
 15008*                                                             *
 15009***************************************************************
 15010
 15011     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15012                                    PB-C-AH-CANCEL-VOID-SW.
 15013
 15014     IF PB-C-LF-CANCEL-AMT = ZERO
 15015        NEXT SENTENCE
 15016     ELSE
 15017        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15018           AND
 15019           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 272
* EL050.cbl
 15020               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15021               MOVE ER-2745           TO WS-ERROR
 15022               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15023
 15024     IF PB-C-AH-CANCEL-AMT = ZERO
 15025        NEXT SENTENCE
 15026     ELSE
 15027        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15028           AND
 15029           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15030               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15031               MOVE ER-2745           TO WS-ERROR
 15032               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15033
 15034     IF WS-LF-EARNINGS-CALC = '4'
 15035        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15036
 15037     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15038     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15039     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15040     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15041     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15042     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15043
 15044     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15045                                      PB-C-AH-REF-CALC.
 15046     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15047
 15048******************************************************************
 15049*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15050*             TO VALIDATE COVERAGE.                              *
 15051******************************************************************
 15052
 15053     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15054        PB-C-LF-CANCEL-AMT = ZEROS
 15055          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15056      ELSE
 15057          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15058
 15059     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15060        PB-C-AH-CANCEL-AMT = ZEROS
 15061          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15062      ELSE
 15063          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15064
 15065     EVALUATE TRUE
 15066         WHEN PB-CANCEL-FORCE             OR
 15067              PB-CANCEL-DATE-FORCED       OR
 15068              PB-FORCE-OFF
 15069                  IF PB-COMPANY-ID = 'ACE'
 15070                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15071                  END-IF
 15072         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15073               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15074              (PB-COMPANY-ID = 'ACE' )
 15075                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15076         WHEN OTHER
 15077              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 273
* EL050.cbl
 15078                 MOVE ER-2794              TO WS-ERROR
 15079              ELSE
 15080                 MOVE ER-2749              TO WS-ERROR
 15081              END-IF
 15082              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15083     END-EVALUATE.
 15084
 15085
 15086*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15087*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15088*            MOVE  ER-1909            TO  WS-ERROR
 15089*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15090*        ELSE
 15091*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15092
 15093     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15094     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15095        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15096     ELSE
 15097        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15098     END-IF
 15099     .
 15100 3705-EDIT-CANCEL-DT.
 15101
 15102     IF LF-COVERAGE-CANCELLED
 15103        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15104         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15105         MOVE WS-CURRENT-MONTH-END
 15106                                 TO DC-BIN-DATE-2
 15107         SET ELAPSED-BETWEEN-BIN TO TRUE
 15108*        MOVE 1                  TO DC-OPTION-CODE
 15109         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15110         IF DATE-CONVERSION-ERROR
 15111            NEXT SENTENCE
 15112          ELSE
 15113             IF DC-ELAPSED-DAYS GREATER +180
 15114                IF PB-CANCEL-DATE-FORCED  OR
 15115                   PB-CANCEL-DATE-FORCED-NO-FEE
 15116                      MOVE ER-2751  TO WS-ERROR
 15117                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15118                 ELSE
 15119                   MOVE ER-2752  TO WS-ERROR
 15120                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15121
 15122     IF AH-COVERAGE-CANCELLED
 15123        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15124         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15125         MOVE WS-CURRENT-MONTH-END
 15126                                 TO DC-BIN-DATE-2
 15127         SET ELAPSED-BETWEEN-BIN TO TRUE
 15128*        MOVE 1                  TO DC-OPTION-CODE
 15129         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15130         IF DATE-CONVERSION-ERROR
 15131            NEXT SENTENCE
 15132          ELSE
 15133             IF DC-ELAPSED-DAYS GREATER +180
 15134                IF PB-CANCEL-DATE-FORCED OR
 15135                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 274
* EL050.cbl
 15136                      MOVE ER-2751  TO WS-ERROR
 15137                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15138                 ELSE
 15139                   MOVE ER-2752  TO WS-ERROR
 15140                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15141
 15142     IF WS-ERROR = ER-2752
 15143        AND (PB-COMPANY-ID = 'ABL'
 15144         OR  PB-COMPANY-ID = 'FGL'
 15145         OR  PB-COMPANY-ID = 'IST'
 15146         OR  PB-COMPANY-ID = 'JHL'
 15147         OR  PB-COMPANY-ID = 'LAP'
 15148         OR  PB-COMPANY-ID = 'LBL'
 15149         OR  PB-COMPANY-ID = 'NCB'
 15150         OR  PB-COMPANY-ID = 'NLI'
 15151         OR  PB-COMPANY-ID = 'OFI'
 15152         OR  PB-COMPANY-ID = 'PLI'
 15153         OR  PB-COMPANY-ID = 'TAO'
 15154         OR  PB-COMPANY-ID = 'TIC'
 15155         OR  PB-COMPANY-ID = 'HER'
 15156         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15157         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15158            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15159            MOVE ER-2762     TO WS-ERROR
 15160            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15161
 15162     IF LF-COVERAGE-CANCELLED
 15163        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15164        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15165             MOVE ER-2733         TO WS-ERROR
 15166             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15167
 15168     IF AH-COVERAGE-CANCELLED
 15169        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15170        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15171              MOVE ER-2733        TO WS-ERROR
 15172              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15173
 15174     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15175        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15176        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15177           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15178            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15179              IF PB-COMPANY-ID NOT = 'LAP'
 15180               MOVE ER-2704            TO WS-ERROR
 15181               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15182
 15183     IF CERT-WAS-NOT-FOUND
 15184         GO TO 3999-END-EDIT.
 15185
 15186     IF PB-COMPANY-ID EQUAL 'CDC'
 15187        IF LF-COVERAGE-CANCELLED
 15188           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15189            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15190            MOVE PB-C-LF-CANCEL-DT
 15191                                 TO DC-BIN-DATE-2
 15192            SET ELAPSED-BETWEEN-BIN TO TRUE
 15193*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 275
* EL050.cbl
 15194            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15195            IF DATE-CONVERSION-ERROR
 15196               NEXT SENTENCE
 15197             ELSE
 15198                IF DC-ELAPSED-DAYS GREATER +60
 15199                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15200
 15201     IF PB-COMPANY-ID EQUAL 'CDC'
 15202        IF AH-COVERAGE-CANCELLED
 15203           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15204            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15205            MOVE PB-C-AH-CANCEL-DT
 15206                                 TO DC-BIN-DATE-2
 15207            MOVE +0              TO DC-ELAPSED-DAYS
 15208                                    DC-ELAPSED-MONTHS
 15209            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15210*           MOVE 1               TO DC-OPTION-CODE
 15211            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15212            IF DATE-CONVERSION-ERROR
 15213               NEXT SENTENCE
 15214             ELSE
 15215                IF DC-ELAPSED-DAYS GREATER +60
 15216                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15217
 15218     MOVE +0                     TO DC-ELAPSED-DAYS
 15219                                    DC-ELAPSED-MONTHS.
 15220
 15221     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15222        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15223          MOVE 'Z'                TO PB-CI-OB-FLAG
 15224          MOVE ER-2767            TO WS-ERROR
 15225          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15226          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15227          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15228          GO TO 3775-OVER-REF-CHK
 15229        ELSE
 15230          MOVE ZEROS              TO PB-CI-LIVES
 15231                                     PB-C-LIVES
 15232          IF PB-CI-OB-FLAG NOT = 'B'
 15233             MOVE SPACE           TO PB-CI-OB-FLAG.
 15234
 15235     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15236         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15237     ELSE
 15238         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15239
 15240     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15241        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15242            MOVE ER-2760         TO WS-ERROR
 15243            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15244
 15245     IF LF-COVERAGE-CANCELLED
 15246        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15247         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15248            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15249               MOVE ER-2774       TO WS-ERROR
 15250               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15251
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 276
* EL050.cbl
 15252     IF AH-COVERAGE-CANCELLED
 15253        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15254         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15255            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15256               MOVE ER-2775       TO WS-ERROR
 15257               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15258
 15259     IF LF-COVERAGE-CANCELLED
 15260        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15261         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15262            MOVE ER-2776         TO WS-ERROR
 15263            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15264
 15265     IF AH-COVERAGE-CANCELLED
 15266        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15267         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15268            MOVE ER-2777         TO WS-ERROR
 15269            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15270
 15271     IF LF-COVERAGE-CANCELLED
 15272        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15273         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15274         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15275         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15276*        MOVE 6                    TO DC-OPTION-CODE
 15277         SET BIN-PLUS-ELAPSED      TO TRUE
 15278         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15279         IF DATE-CONVERSION-ERROR
 15280            NEXT SENTENCE
 15281          ELSE
 15282            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15283              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15284                             OR  'FIA'
 15285                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15286               ELSE
 15287                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15288                MOVE ER-2731       TO WS-ERROR
 15289                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15290
 15291 3705-EDIT-AH-CANCEL-DT.
 15292
 15293     IF AH-COVERAGE-CANCELLED
 15294        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15295         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15296         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15297         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15298*        MOVE 6                    TO DC-OPTION-CODE
 15299         SET BIN-PLUS-ELAPSED      TO TRUE
 15300         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15301         IF DATE-CONVERSION-ERROR
 15302            NEXT SENTENCE
 15303          ELSE
 15304            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15305              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15306                              OR 'FIA'
 15307                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15308              ELSE
 15309               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 277
* EL050.cbl
 15310               MOVE ER-2771       TO WS-ERROR
 15311               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15312
 15313 3705-EDIT-CONTINUED.
 15314
 15315*    IF LF-COVERAGE-CANCELLED
 15316*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15317*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15318*            MOVE ER-2727         TO WS-ERROR
 15319*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15320*
 15321*    IF AH-COVERAGE-CANCELLED
 15322*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15323*        IF PB-COMPANY-ID = 'ACE'
 15324*           MOVE ER-2727        TO WS-ERROR
 15325*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15326*        ELSE
 15327*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15328*              MOVE ER-2727     TO WS-ERROR
 15329*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15330
 15331     IF PB-COMPANY-ID = 'ACE'
 15332       IF AH-COVERAGE-CANCELLED
 15333         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15334           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15335              MOVE ER-2732      TO WS-ERROR
 15336              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15337
 15338     IF PB-COMPANY-ID      EQUAL   'HER'
 15339        IF WS-ERROR        EQUAL   ER-2727
 15340            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15341            MOVE  ER-2725          TO  WS-ERROR
 15342            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15343
 15344     IF PB-C-CLAIM-CREATED-CANCEL
 15345            MOVE ER-2748         TO WS-ERROR
 15346            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15347
 15348     IF PB-C-LAST-NAME NOT = SPACES
 15349         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15350            MOVE ER-2747         TO WS-ERROR
 15351            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15352
 15353 3710-EDIT-LUMP-SUM-PRIOR.
 15354
 15355     IF AH-COVERAGE-CANCELLED
 15356         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15357             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15358                MOVE ER-2735    TO WS-ERROR
 15359                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15360
 15361     IF LF-COVERAGE-CANCELLED
 15362         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15363             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15364                MOVE ER-2735    TO WS-ERROR
 15365                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15366
 15367 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 278
* EL050.cbl
 15368
 15369*    IF LF-COVERAGE-CANCELLED
 15370*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15371*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15372*           (NOT PB-CI-OB)
 15373*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15374*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15375*                   MOVE ER-2732  TO WS-ERROR
 15376*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15377*
 15378*    IF AH-COVERAGE-CANCELLED
 15379*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15380*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15381*           (NOT PB-CI-OB)
 15382*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15383*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15384*                   MOVE ER-2732  TO WS-ERROR
 15385*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15386
 15387     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15388         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15389            (NOT PB-COMP-LF-CANCEL)
 15390             NEXT SENTENCE
 15391         ELSE
 15392           IF PB-C-LF-CANCEL-VOIDED
 15393              NEXT SENTENCE
 15394           ELSE
 15395              MOVE ER-2753      TO WS-ERROR
 15396              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15397
 15398     IF CANCEL-FUTURE-DT
 15399         GO TO 3999-END-EDIT.
 15400
 15401 3715-GET-REMAIN-TERM-LF.
 15402
 15403     IF NO-LF-BENEFIT-MATCH  OR
 15404        WS-LF-BENEFIT-CD = ZEROS
 15405        GO TO 3730-GET-AH-REMAIN-TERM.
 15406
 15407     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15408     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15409     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15410     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15411     MOVE PB-SV-STATE            TO CP-STATE.
 15412     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15413     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15414     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15415     MOVE '2'                    TO CP-PROCESS-TYPE.
 15416     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15417     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15418     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15419     IF (PB-COMPANY-ID = 'CID')
 15420        AND (CP-STATE-STD-ABBRV = 'WI')
 15421        MOVE '7'                 TO CP-REM-TERM-METHOD
 15422        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15423     ELSE
 15424        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15425        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 279
* EL050.cbl
 15426                                 TO CP-REM-TRM-CALC-OPTION
 15427     END-IF
 15428**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15429     IF (PB-COMPANY-ID = 'CID')
 15430        AND (CP-STATE-STD-ABBRV = 'MO')
 15431        AND (PB-CERT-EFF-DT >= X'9B41')
 15432        AND (PB-CERT-EFF-DT <= X'A2FB')
 15433        MOVE '7'                 TO CP-REM-TERM-METHOD
 15434        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15435     END-IF
 15436     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15437                                    CP-LOAN-TERM.
 15438     IF CP-TRUNCATED-LIFE
 15439        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15440
 15441     IF CP-TERM-IS-DAYS
 15442         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15443     ELSE
 15444         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15445
 15446     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15447
 15448     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15449
 15450     IF LF-COVERAGE-CANCELLED
 15451        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15452        NEXT SENTENCE
 15453      ELSE
 15454          GO TO 3730-GET-AH-REMAIN-TERM.
 15455
 15456 3720-GET-LF-REFUND.
 15457
 15458     IF PB-C-LF-CANCEL-VOIDED OR
 15459        PB-C-AH-CANCEL-VOIDED
 15460        GO TO 3780-UPDATE-CANCEL-CERT.
 15461
 15462     IF PB-COMPANY-ID EQUAL 'BOA'
 15463         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15464         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15465         GO TO 3730-GET-AH-REMAIN-TERM.
 15466
 15467     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15468        (WS-AH-SPECIAL-CALC-CD = 'M')
 15469         MOVE ER-2767            TO WS-ERROR
 15470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15471         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15472         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15473         GO TO 3780-UPDATE-CANCEL-CERT.
 15474
 15475     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15476
 15477     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15478     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15479     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15480     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15481     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15482     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15483     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 280
* EL050.cbl
 15484        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15485        IF PDEF-MASTER-FOUND
 15486           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15487              (V1 > +8)
 15488              OR (PD-PROD-CODE (V1) = 'L')
 15489           END-PERFORM
 15490           IF V1 < +9
 15491              MOVE PD-MAX-AMT (V1)
 15492                           TO CP-R-MAX-TOT-BEN
 15493                              EC-AM-LF-MAX-TOT-BEN
 15494           END-IF
 15495        ELSE
 15496        MOVE ' '                 TO PDEF-MASTER-SW
 15497        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15498        MOVE PB-STATE            TO ERPDEF-STATE
 15499        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15500        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15501        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15502        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15503        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15504        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15505        IF PDEF-MASTER-FOUND
 15506           MOVE 'N'              TO PDEF-MASTER-SW
 15507           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15508           IF PDEF-MASTER-FOUND
 15509              IF (ERPDEF-KEY-SAVE (1:16) =
 15510                           PD-CONTROL-PRIMARY (1:16))
 15511                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15512                 CONTINUE
 15513              ELSE
 15514                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15515                 IF (ERPDEF-KEY-SAVE (1:16) =
 15516                           PD-CONTROL-PRIMARY (1:16))
 15517                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15518                    CONTINUE
 15519                 ELSE
 15520                    MOVE 'N'     TO PDEF-MASTER-SW
 15521                 END-IF
 15522              END-IF
 15523              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15524
 15525              IF PDEF-MASTER-FOUND
 15526                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15527                    (V1 > +8)
 15528                    OR (PD-PROD-CODE (V1) = 'L')
 15529                 END-PERFORM
 15530                 IF V1 < +9
 15531                    MOVE PD-MAX-AMT (V1)
 15532                                 TO CP-R-MAX-TOT-BEN
 15533                                    EC-AM-LF-MAX-TOT-BEN
 15534                 END-IF
 15535              END-IF
 15536           END-IF
 15537           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15538        END-IF
 15539        END-IF
 15540     END-IF
 15541     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 281
* EL050.cbl
 15542
 15543     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15544
 15545     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15546                                    PB-C-LF-REM-TERM.
 15547
 15548     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15549     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15550
 15551     IF PB-COMPANY-ID EQUAL 'FLC'
 15552        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15553           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15554           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15555                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15556                    - CM-LF-ITD-DEATH-AMT
 15557           IF PB-C-LF-REF-CALC LESS THAN +0
 15558              MOVE +0            TO PB-C-LF-REF-CALC
 15559              GO TO 3730-GET-AH-REMAIN-TERM
 15560           ELSE
 15561              GO TO 3730-GET-AH-REMAIN-TERM.
 15562
 15563     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15564                            OR '4' OR '5' OR '6' OR '8'
 15565                            OR '9' OR 'G'
 15566        MOVE PB-C-LF-REFUND-OVERRIDE
 15567                                 TO CP-EARNING-METHOD.
 15568
 15569     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15570     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15571     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15572                                    CP-RATING-BENEFIT-AMT.
 15573     IF CP-STATE-STD-ABBRV = 'OR'
 15574         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15575                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15576     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15577     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15578     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15579     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15580     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15581     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15582     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15583     IF WS-DEFAULT-APR NOT NUMERIC
 15584         MOVE ZEROS TO WS-DEFAULT-APR.
 15585****   N O T E   ****
 15586*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15587*      THE OH HARD CODING IN ELCRFNDP
 15588
 15589     IF PB-COMPANY-ID = 'CID'
 15590        IF CP-STATE-STD-ABBRV = 'OH'
 15591           MOVE WS-LF-EARNINGS-CALC
 15592                                 TO CP-EARNING-METHOD
 15593        END-IF
 15594     END-IF
 15595
 15596****   N O T E   ****
 15597
 15598     IF CP-EARN-AS-NET-PAY
 15599         IF CP-LOAN-APR NOT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 282
* EL050.cbl
 15600            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15601                MOVE WS-DEFAULT-APR
 15602                                 TO  CP-LOAN-APR
 15603                MOVE ER-3780     TO  WS-ERROR
 15604                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15605            ELSE
 15606                MOVE ER-3781     TO  WS-ERROR
 15607                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15608     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15609     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15610
 15611     IF CP-REFUND-TYPE-USED NOT = SPACE
 15612         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15613
 15614     IF CP-ERROR-RATE-IS-ZERO OR
 15615        CP-ERROR-RATE-NOT-FOUND
 15616        MOVE ER-2740             TO WS-ERROR
 15617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15618
 15619     IF CP-ERROR-RATE-FILE-NOTOPEN
 15620        MOVE ER-2617             TO WS-ERROR
 15621        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15622
 15623     IF PB-COMPANY-ID = 'DCC'
 15624        AND PB-CI-ENTRY-STATUS = 'M'
 15625        MOVE +0                  TO PB-C-LF-REF-CALC
 15626     ELSE
 15627        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15628     END-IF
 15629
 15630     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15631         GO TO 3730-GET-AH-REMAIN-TERM.
 15632
 15633*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15634*       ADD +1                   TO PB-C-LF-REM-TERM
 15635*                                   CP-REMAINING-TERM
 15636*                                   CP-ORIGINAL-TERM.
 15637
 15638     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15639     MOVE '2'                    TO CP-EARNING-METHOD
 15640                                    CP-RATING-METHOD.
 15641     IF PB-COMPANY-ID = 'CID'
 15642        IF (CP-STATE-STD-ABBRV = 'MN')
 15643           AND (PB-CERT-EFF-DT > X'A4FF')
 15644           AND (WS-LF-EARNINGS-CALC = 'B')
 15645           MOVE '5'              TO CP-EARNING-METHOD
 15646           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15647        END-IF
 15648     END-IF
 15649     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15650                                        CP-REMAINING-BENEFIT
 15651                                        CP-RATING-BENEFIT-AMT.
 15652     IF CP-STATE-STD-ABBRV = 'OR'
 15653         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15654                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15655     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15656     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15657
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 283
* EL050.cbl
 15658     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15659
 15660     IF CP-ERROR-RATE-IS-ZERO OR
 15661        CP-ERROR-RATE-NOT-FOUND
 15662        MOVE ER-2740             TO WS-ERROR
 15663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15664
 15665     IF CP-ERROR-RATE-FILE-NOTOPEN
 15666        MOVE ER-2617             TO WS-ERROR
 15667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15668
 15669     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15670
 15671******************************************************************
 15672
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 284
* EL050.cbl
 15674 3730-GET-AH-REMAIN-TERM.
 15675     IF NO-AH-BENEFIT-MATCH  OR
 15676        WS-AH-BENEFIT-CD = ZEROS
 15677         GO TO 3770-CHECK-REFUNDS.
 15678
 15679     IF PB-CI-AH-LUMP-SUM-DISAB
 15680         IF  PB-C-AH-CANCEL-AMT = ZERO
 15681            IF NOT PB-COMP-AH-CANCEL
 15682             GO TO 3770-CHECK-REFUNDS.
 15683
 15684     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15685     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15686     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15687     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15688     MOVE PB-SV-STATE            TO CP-STATE.
 15689     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15690     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15691     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15692     MOVE '2'                    TO CP-PROCESS-TYPE.
 15693     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15694     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15695     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15696     IF (PB-COMPANY-ID = 'CID')
 15697        AND (CP-STATE-STD-ABBRV = 'WI')
 15698        MOVE '7'                 TO CP-REM-TERM-METHOD
 15699        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15700     ELSE
 15701        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15702        MOVE WS-REM-TRM-CALC-OPTION
 15703                                 TO CP-REM-TRM-CALC-OPTION
 15704     END-IF
 15705     IF (PB-COMPANY-ID = 'CID')
 15706        AND (CP-STATE-STD-ABBRV = 'MO')
 15707        AND (PB-CERT-EFF-DT >= X'9B41')
 15708        AND (PB-CERT-EFF-DT <= X'A2FB')
 15709        MOVE '7'                 TO CP-REM-TERM-METHOD
 15710        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15711     END-IF
 15712     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15713                                    CP-LOAN-TERM.
 15714     IF NOT CP-TERM-IS-DAYS
 15715         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15716
 15717     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15718
 15719     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15720
 15721     IF AH-COVERAGE-CANCELLED
 15722        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15723        NEXT SENTENCE
 15724      ELSE
 15725         GO TO 3770-CHECK-REFUNDS.
 15726
 15727 3740-GET-AH-REFUND.
 15728
 15729     IF PB-C-LF-CANCEL-VOIDED OR
 15730        PB-C-AH-CANCEL-VOIDED
 15731        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 285
* EL050.cbl
 15732
 15733     IF PB-COMPANY-ID = 'BOA'
 15734         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15735         GO TO 3770-CHECK-REFUNDS.
 15736
 15737     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15738*    MOVE ' '                    TO DC-OPTION-CODE
 15739     SET BIN-TO-GREG             TO TRUE
 15740     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15741     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15742                                    PB-C-AH-REM-TERM.
 15743     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15744     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15745
 15746     IF PB-COMPANY-ID EQUAL 'FLC'
 15747        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15748           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15749           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15750                    - CM-AH-ITD-AH-PMT)
 15751           IF PB-C-AH-REF-CALC LESS THAN +0
 15752              MOVE +0            TO PB-C-AH-REF-CALC
 15753              GO TO 3770-CHECK-REFUNDS
 15754           ELSE
 15755              GO TO 3770-CHECK-REFUNDS.
 15756
 15757     IF PB-COMPANY-ID = 'DCC'
 15758        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15759            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15760           MOVE 'S'              TO CP-EARNING-METHOD
 15761        END-IF
 15762     END-IF
 15763     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15764                            OR '4' OR '5' OR '6' OR '8'
 15765                            OR '9' OR 'G' OR 'S'
 15766        MOVE PB-C-AH-REFUND-OVERRIDE
 15767                                 TO CP-EARNING-METHOD.
 15768
 15769     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15770     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15771     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15772                                    CP-RATING-BENEFIT-AMT.
 15773     IF CP-STATE-STD-ABBRV = 'OR'
 15774         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15775                                         PB-CI-AH-TERM.
 15776     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15777     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15778     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15779     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15780     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15781     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15782
 15783     IF CP-STATE-STD-ABBRV = 'OH'
 15784        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15785                                AND 'CID' AND 'DCC' AND 'AHL')
 15786           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15787              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15788              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15789              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 286
* EL050.cbl
 15790           END-IF
 15791        END-IF
 15792        IF PB-COMPANY-ID = 'CID'
 15793           IF NO-LIFE-COVERAGE
 15794              IF CP-CRITICAL-PERIOD
 15795                 MOVE '2'       TO CP-EARNING-METHOD
 15796              ELSE
 15797                 MOVE '6'       TO CP-EARNING-METHOD
 15798              END-IF
 15799           ELSE
 15800              IF WS-LF-COVERAGE-TYPE = 'L'
 15801                 MOVE '2'       TO CP-EARNING-METHOD
 15802              ELSE
 15803                 IF (PB-CI-LF-TERM > +60) OR
 15804                    (WS-LF-EARNINGS-CALC = '5')
 15805                    IF CP-CRITICAL-PERIOD
 15806                       MOVE '2'  TO CP-EARNING-METHOD
 15807                    ELSE
 15808                       MOVE '6'  TO CP-EARNING-METHOD
 15809                    END-IF
 15810                 ELSE
 15811                    MOVE '1'     TO CP-EARNING-METHOD
 15812                 END-IF
 15813              END-IF
 15814           END-IF
 15815        END-IF
 15816     END-IF
 15817
 15818*    IF CP-STATE-STD-ABBRV = 'VA'
 15819*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15820*          IF CP-ORIGINAL-TERM GREATER 61
 15821*             MOVE '6' TO CP-EARNING-METHOD
 15822*          ELSE
 15823*             MOVE '1' TO CP-EARNING-METHOD.
 15824
 15825     IF WS-DEFAULT-APR NOT NUMERIC
 15826         MOVE ZEROS TO WS-DEFAULT-APR.
 15827     IF CP-EARN-AS-NET-PAY
 15828         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15829            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15830                MOVE WS-DEFAULT-APR
 15831                                 TO  CP-LOAN-APR
 15832                MOVE ER-3780     TO  WS-ERROR
 15833                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15834            ELSE
 15835                MOVE ER-3781     TO  WS-ERROR
 15836                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15837     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15838     IF PB-COMPANY-ID = 'DCC'
 15839        AND CP-CANCEL-REASON = 'R'
 15840        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15841        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15842     END-IF
 15843     IF PB-COMPANY-ID = 'DCC'
 15844        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15845        AND (CP-EARNING-METHOD = 'D')
 15846        AND (CP-CANCEL-REASON NOT = 'R')
 15847        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 287
* EL050.cbl
 15848     ELSE
 15849        GO TO 3750-CONTINUE
 15850     END-IF
 15851     MOVE ' '                    TO DD-IU-SW
 15852     IF NOT PDEF-MASTER-FOUND
 15853        MOVE ' '                 TO PDEF-MASTER-SW
 15854        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15855        MOVE PB-STATE            TO ERPDEF-STATE
 15856        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15857        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15858        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15859        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15860        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15861        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15862        IF PDEF-MASTER-FOUND
 15863           MOVE 'N'              TO PDEF-MASTER-SW
 15864           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15865           IF PDEF-MASTER-FOUND
 15866              IF (ERPDEF-KEY-SAVE (1:16) =
 15867                           PD-CONTROL-PRIMARY (1:16))
 15868                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15869                 CONTINUE
 15870              ELSE
 15871                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15872                 IF (ERPDEF-KEY-SAVE (1:16) =
 15873                           PD-CONTROL-PRIMARY (1:16))
 15874                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15875                    CONTINUE
 15876                 ELSE
 15877                    MOVE ER-2740 TO WS-ERROR
 15878                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15879                    GO TO 3770-CHECK-REFUNDS
 15880                 END-IF
 15881              END-IF
 15882           END-IF
 15883           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15884        END-IF
 15885     END-IF
 15886     IF PDEF-MASTER-FOUND
 15887        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15888           (V1 > +8)
 15889           OR (PD-PROD-CODE (V1) = 'I')
 15890        END-PERFORM
 15891        IF V1 < +9
 15892           SET DD-IU-PRESENT        TO TRUE
 15893        END-IF
 15894        IF WS-AH-DCC-TRUNC = 'T'
 15895           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 15896        ELSE
 15897           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 15898        END-IF
 15899        EVALUATE TRUE
 15900           WHEN WS-TERM > +168
 15901              MOVE 15               TO V1
 15902           WHEN WS-TERM > +156
 15903              MOVE 14               TO V1
 15904           WHEN WS-TERM > +144
 15905              MOVE 13               TO V1
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 288
* EL050.cbl
 15906           WHEN WS-TERM > +132
 15907              MOVE 12               TO V1
 15908           WHEN WS-TERM > +120
 15909              MOVE 11               TO V1
 15910           WHEN WS-TERM > +108
 15911              MOVE 10               TO V1
 15912           WHEN WS-TERM > +96
 15913              MOVE 9                TO V1
 15914           WHEN WS-TERM > +84
 15915              MOVE 8                TO V1
 15916           WHEN WS-TERM > +72
 15917              MOVE 7                TO V1
 15918           WHEN WS-TERM > +60
 15919              MOVE 6                TO V1
 15920           WHEN WS-TERM > +48
 15921              MOVE 5                TO V1
 15922           WHEN WS-TERM > +36
 15923              MOVE 4                TO V1
 15924           WHEN WS-TERM > +24
 15925              MOVE 3                TO V1
 15926           WHEN WS-TERM > +12
 15927              MOVE 2                TO V1
 15928           WHEN OTHER
 15929              MOVE 1                TO V1
 15930        END-EVALUATE
 15931
 15932        EVALUATE TRUE
 15933*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 15934*             < +13)
 15935*             AND (DD-IU-PRESENT)
 15936*             MOVE 2                TO V2
 15937*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15938*             MOVE 1                TO V2
 15939           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 15940              MOVE 2                TO V2
 15941           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 15942              MOVE 3                TO V2
 15943           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 15944              MOVE 4                TO V2
 15945           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 15946              MOVE 5                TO V2
 15947           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 15948              MOVE 6                TO V2
 15949           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 15950              MOVE 7                TO V2
 15951           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 15952              MOVE 8                TO V2
 15953           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 15954              MOVE 9                TO V2
 15955           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 15956              MOVE 10               TO V2
 15957           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 15958              MOVE 11               TO V2
 15959           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 15960              MOVE 12               TO V2
 15961           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 15962              MOVE 13               TO V2
 15963           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 289
* EL050.cbl
 15964              MOVE 14               TO V2
 15965           WHEN OTHER
 15966              MOVE 15               TO V2
 15967        END-EVALUATE
 15968
 15969        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 15970                                 TO CP-DDF-LO-FACT
 15971        MOVE PD-UEP-FACTOR (V1 V2)
 15972                                 TO CP-DDF-HI-FACT
 15973
 15974        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 15975        MOVE CM-AH-CLP     TO CP-DDF-CLP
 15976        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 15977           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 15978        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 15979        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 15980        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 15981           + PD-1ST-YR-ADMIN-ALLOW
 15982
 15983        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15984*       IF PI-CLP-YN = 'Y'
 15985*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 15986*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 15987*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 15988*       END-IF
 15989
 15990        IF DD-IU-PRESENT
 15991           MOVE 'I'              TO CP-EARNING-METHOD
 15992        END-IF
 15993        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15994                                     CP-CLP-RATE-UP
 15995        IF CP-IU-RATE-UP NOT = ZEROS
 15996           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 15997              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 15998           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 15999              / (1 - WS-WORK-FACT)
 16000        END-IF
 16001     END-IF
 16002     .
 16003 3750-CONTINUE.
 16004     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16005
 16006     IF CP-REFUND-TYPE-USED NOT = SPACE
 16007         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16008
 16009     IF CP-ERROR-RATE-IS-ZERO OR
 16010        CP-ERROR-RATE-NOT-FOUND
 16011        MOVE ER-2740             TO WS-ERROR
 16012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16013
 16014     IF CP-ERROR-RATE-FILE-NOTOPEN
 16015        MOVE ER-2617             TO WS-ERROR
 16016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16017     IF PB-COMPANY-ID = 'DCC'
 16018        AND PB-CI-ENTRY-STATUS = 'M'
 16019        MOVE +0                  TO PB-C-AH-REF-CALC
 16020     ELSE
 16021        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 290
* EL050.cbl
 16022     END-IF
 16023     IF PB-COMPANY-ID = 'DCC'
 16024        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16025        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16026        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16027        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16028        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16029        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16030        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16031        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16032        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16033     END-IF
 16034     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 291
* EL050.cbl
 16036
 16037 3770-CHECK-REFUNDS.
 16038
 16039     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16040        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16041           MOVE ER-2766          TO WS-ERROR
 16042           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16043           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16044           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16045              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16046
 16047     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16048        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16049           MOVE ER-2766          TO WS-ERROR
 16050           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16051           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16052           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16053              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16054
 16055     IF PB-COMP-LF-CANCEL
 16056        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16057        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16058           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16059              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16060
 16061     IF PB-COMP-AH-CANCEL
 16062        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16063        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16064           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16065              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16066
 16067     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16068             GIVING WS-UNSIGN-WRK1
 16069     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16070             GIVING WS-UNSIGN-WRK2.
 16071
 16072     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16073         MOVE ZERO TO WS-UNSIGN-WRK1.
 16074
 16075     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16076         MOVE ZERO TO WS-UNSIGN-WRK2.
 16077
 16078     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16079
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 292
* EL050.cbl
 16081
 16082 3772-CONTINUE.
 16083
 16084**********************************
 16085*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16086*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16087*** DOUBLES THE TOLERANCE AMOUNT.
 16088***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16089**********************************
 16090     IF PB-COMPANY-ID = 'MON'
 16091     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16092         IF WS-REF-REJECT-SW = SPACE
 16093             MOVE ER-2754        TO WS-ERROR
 16094             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16095           ELSE
 16096             MOVE ER-2736        TO WS-ERROR
 16097             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16098**********************************
 16099
 16100 3773-CONTINUE.
 16101
 16102     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16103        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16104           MOVE ER-2723          TO WS-ERROR
 16105           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16106
 16107     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16108        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16109           MOVE ER-2724          TO WS-ERROR
 16110           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16111
 16112     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16113         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16114             (1 + WS-LF-REFUND-OVS-PCT)
 16115     ELSE
 16116         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16117
 16118     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16119         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16120             (1 - WS-TOL-LF-REFUND-PCT)
 16121     ELSE
 16122         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16123
 16124     IF (PB-COMPANY-ID = 'DCC')
 16125        AND (PB-CI-ENTRY-STATUS = 'M')
 16126        AND (PB-C-LF-CANCEL-AMT > +0)
 16127        MOVE ER-3843             TO WS-ERROR
 16128        PERFORM 9900-ERROR-FORMAT
 16129                                 THRU 9900-EXIT
 16130     END-IF
 16131     EVALUATE TRUE
 16132        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16133           CONTINUE
 16134        WHEN PB-C-LF-CANCEL-AMT = +0
 16135                 AND PB-C-LF-REF-CALC > +0
 16136           CONTINUE
 16137        WHEN WS-LF-REFUND-OVS-AMT = 0
 16138                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 293
* EL050.cbl
 16139           CONTINUE
 16140        WHEN OTHER
 16141           IF WS-TOL-LF-REFUND  = +0
 16142              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16143           END-IF
 16144           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16145                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16146                          (PB-C-LF-CANCEL-AMT))
 16147              CONTINUE
 16148           ELSE
 16149              IF WS-LF-REFUND-OVS-AMT = +0
 16150                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16151              END-IF
 16152              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16153                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16154                                       PB-C-LF-CANCEL-AMT)
 16155                 CONTINUE
 16156              ELSE
 16157                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16158                   MOVE ER-2754   TO  WS-ERROR
 16159                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16160                 ELSE
 16161                    MOVE ER-2736   TO  WS-ERROR
 16162                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16163                 END-IF
 16164              END-IF
 16165           END-IF
 16166     END-EVALUATE.
 16167
 16168     EVALUATE TRUE
 16169        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16170           CONTINUE
 16171        WHEN PB-C-LF-CANCEL-AMT = +0
 16172                 AND PB-C-LF-REF-CALC > +0
 16173           CONTINUE
 16174        WHEN OTHER
 16175           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16176               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16177              CONTINUE
 16178           ELSE
 16179              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16180               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16181                CONTINUE
 16182              ELSE
 16183                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16184                     MOVE ER-2754   TO  WS-ERROR
 16185                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16186                 ELSE
 16187                     MOVE ER-2736   TO  WS-ERROR
 16188                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16189                 END-IF
 16190              END-IF
 16191           END-IF
 16192     END-EVALUATE.
 16193
 16194     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16195         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16196             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 294
* EL050.cbl
 16197     ELSE
 16198         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16199
 16200     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16201         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16202             (1 - WS-TOL-AH-REFUND-PCT)
 16203     ELSE
 16204         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16205
 16206     IF (PB-COMPANY-ID = 'DCC')
 16207        AND (PB-CI-ENTRY-STATUS = 'M')
 16208        AND (PB-C-AH-CANCEL-AMT > +0)
 16209        MOVE ER-3843             TO WS-ERROR
 16210        PERFORM 9900-ERROR-FORMAT
 16211                                 THRU 9900-EXIT
 16212     END-IF
 16213     EVALUATE TRUE
 16214        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16215           CONTINUE
 16216*       WHEN PB-C-AH-REF-CALC = +0 AND
 16217*                  PB-C-AH-CANCEL-AMT > +0
 16218        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16219                   PB-C-AH-REF-CALC > +0
 16220           CONTINUE
 16221        WHEN WS-AH-REFUND-OVS-AMT = +0
 16222                AND WS-TOL-AH-REFUND = +0
 16223           CONTINUE
 16224        WHEN OTHER
 16225           IF WS-TOL-AH-REFUND = +0
 16226              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16227           END-IF
 16228           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16229               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16230                                         PB-C-AH-CANCEL-AMT)
 16231              CONTINUE
 16232           ELSE
 16233              IF WS-AH-REFUND-OVS-AMT = +0
 16234                 MOVE +9999999.99 TO
 16235                         WS-AH-REFUND-OVS-AMT
 16236              END-IF
 16237              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16238                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16239                                         PB-C-AH-CANCEL-AMT)
 16240                 CONTINUE
 16241              ELSE
 16242                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16243                    MOVE ER-2754   TO  WS-ERROR
 16244                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16245                 ELSE
 16246                    MOVE ER-2736   TO  WS-ERROR
 16247                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16248                 END-IF
 16249              END-IF
 16250           END-IF
 16251     END-EVALUATE.
 16252
 16253     EVALUATE TRUE
 16254        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 295
* EL050.cbl
 16255           CONTINUE
 16256*       WHEN PB-C-AH-REF-CALC > +0 AND
 16257*                  PB-C-AH-CANCEL-AMT = +0
 16258        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16259                   PB-C-AH-REF-CALC = +0
 16260           CONTINUE
 16261        WHEN OTHER
 16262           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16263               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16264              CONTINUE
 16265           ELSE
 16266              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16267                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16268                 CONTINUE
 16269              ELSE
 16270                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16271                     MOVE ER-2754   TO  WS-ERROR
 16272                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16273                 ELSE
 16274                     MOVE ER-2736   TO  WS-ERROR
 16275                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16276                 END-IF
 16277              END-IF
 16278           END-IF
 16279     END-EVALUATE.
 16280
 16281     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16282        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16283        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16284           AND  PB-C-LF-REF-CALC < +1.00
 16285           AND  PB-C-AH-REF-CALC < +1.00
 16286           CONTINUE
 16287        ELSE
 16288           IF (PB-COMPANY-ID = 'DCC')
 16289              AND (PB-CI-ENTRY-STATUS = 'M')
 16290              CONTINUE
 16291           ELSE
 16292              MOVE ER-2741       TO WS-ERROR
 16293              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16294           END-IF
 16295        END-IF
 16296     END-IF
 16297
 16298     IF (PB-C-LF-CANCEL-AMT = ZERO
 16299        AND WS-LF-BENEFIT-CD NOT = ZERO
 16300        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16301        AND PB-C-LF-REF-CALC NOT = ZERO)
 16302        OR
 16303        (PB-C-LF-CANCEL-AMT = ZERO
 16304        AND WS-LF-BENEFIT-CD NOT = ZERO
 16305        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16306             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16307                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16308                NEXT SENTENCE
 16309             ELSE
 16310                MOVE ER-2739        TO WS-ERROR
 16311                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16312
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 296
* EL050.cbl
 16313     IF (PB-C-AH-CANCEL-AMT = ZERO
 16314        AND WS-AH-BENEFIT-CD NOT = ZERO
 16315        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16316        AND PB-C-AH-REF-CALC NOT = ZERO)
 16317        OR
 16318        (PB-C-AH-CANCEL-AMT = ZERO
 16319        AND WS-AH-BENEFIT-CD NOT = ZERO
 16320        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16321             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16322                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16323                NEXT SENTENCE
 16324             ELSE
 16325                MOVE ER-2738        TO WS-ERROR
 16326                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16327
 16328 3775-OVER-REF-CHK.
 16329
 16330     IF PB-CI-ENTRY-STATUS = '5'
 16331        GO TO 3780-UPDATE-CANCEL-CERT.
 16332
 16333     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16334                              PB-CI-LF-ALT-PREMIUM-AMT.
 16335
 16336     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16337        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16338                                 PB-C-LF-REF-CALC
 16339      ELSE
 16340        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16341                                 PB-C-LF-CANCEL-AMT.
 16342
 16343     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16344        MOVE ER-2755             TO WS-ERROR
 16345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16346
 16347     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16348
 16349     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16350        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16351                                 PB-C-AH-REF-CALC
 16352      ELSE
 16353        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16354                                 PB-C-AH-CANCEL-AMT.
 16355
 16356     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16357        MOVE ER-2778             TO WS-ERROR
 16358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16359
 16360     IF PB-CI-OB-FLAG NOT = 'Z'
 16361        NEXT SENTENCE
 16362       ELSE
 16363         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16364            MOVE ER-2757           TO WS-ERROR
 16365            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16366
 16367 3780-UPDATE-CANCEL-CERT.
 16368
 16369     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16370        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 297
* EL050.cbl
 16371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16372
 16373     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16374         MOVE ER-2729              TO WS-ERROR
 16375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16376
 16377     IF PB-CI-LF-BENEFIT-CD = ZERO
 16378         GO TO 3780-UPDATE-CONT-1.
 16379
 16380     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16381         GO TO 3780-UPDATE-CONT-1.
 16382
 16383     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16384       AND
 16385        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16386       AND
 16387        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16388       AND
 16389        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16390            NEXT SENTENCE
 16391       ELSE
 16392        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16393          AND
 16394***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16395***       AND
 16396           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16397            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16398               MOVE ER-2730      TO WS-ERROR
 16399               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16400               GO TO 3999-END-EDIT
 16401            ELSE
 16402               GO TO 3999-END-EDIT
 16403        ELSE
 16404            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16405               MOVE ER-2765           TO WS-ERROR
 16406               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16407               GO TO 3785-CHECK-NH.
 16408*              GO TO 3999-END-EDIT.
 16409
 16410 3780-UPDATE-CONT-1.
 16411     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16412
 16413     IF PB-CI-AH-BENEFIT-CD = ZERO
 16414         GO TO 3780-UPDATE-CONT-2.
 16415
 16416     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16417         GO TO 3780-UPDATE-CONT-2.
 16418
 16419     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16420
 16421     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16422       AND
 16423        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16424       AND
 16425        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16426       AND
 16427        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16428            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 298
* EL050.cbl
 16429       ELSE
 16430        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16431          AND
 16432***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16433***       AND
 16434           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16435           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16436            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16437               MOVE ER-2773      TO WS-ERROR
 16438               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16439               GO TO 3999-END-EDIT
 16440            ELSE
 16441               GO TO 3999-END-EDIT
 16442            END-IF
 16443           ELSE
 16444             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16445                MOVE ER-2890 TO WS-ERROR
 16446                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16447                GO TO 3999-END-EDIT
 16448             ELSE
 16449                GO TO 3785-CHECK-NH
 16450             END-IF
 16451           END-IF
 16452          ELSE
 16453            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16454              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16455                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16456                   MOVE ER-2890 TO WS-ERROR
 16457                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16458                   GO TO 3999-END-EDIT
 16459                ELSE
 16460                   MOVE ER-2765 TO WS-ERROR
 16461                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16462                   GO TO 3785-CHECK-NH
 16463                END-IF
 16464              ELSE
 16465               MOVE ER-2765      TO WS-ERROR
 16466               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16467               GO TO 3785-CHECK-NH.
 16468*              GO TO 3999-END-EDIT.
 16469
 16470 3780-UPDATE-CONT-2.
 16471
 16472     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16473        AND WS-LF-BENEFIT-CD = ZERO
 16474           MOVE ER-2743           TO WS-ERROR
 16475           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16476
 16477     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16478        AND WS-AH-BENEFIT-CD = ZERO
 16479           MOVE ER-2744           TO WS-ERROR
 16480           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16481
 16482     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16483        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16484        AND
 16485        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16486         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 299
* EL050.cbl
 16487           MOVE ER-2746           TO WS-ERROR
 16488           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16489
 16490     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16491       AND
 16492        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16493             MOVE ER-2737        TO WS-ERROR
 16494             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16495
 16496     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16497       AND
 16498        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16499             MOVE ER-2737        TO WS-ERROR
 16500             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16501
 16502     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16503         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16504             OR 'CID' OR 'DCC' OR 'AHL'
 16505             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16506         ELSE
 16507             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16508                 MOVE ER-2768    TO WS-ERROR
 16509                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16510             ELSE
 16511                 MOVE ER-2756    TO WS-ERROR
 16512                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16513
 16514     IF CERT-PEND-ISSUE-RETURNED
 16515        MOVE ER-2772             TO WS-ERROR
 16516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16517 3785-CHECK-NH.
 16518     IF PB-STATE NOT = 'NH'
 16519        GO TO 3999-END-EDIT
 16520     END-IF
 16521
 16522     MOVE ER-2796                TO WS-ERROR
 16523     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16524     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16525        OR (CM-NH-INTERFACE-SW = 'Y')
 16526        MOVE ER-2793             TO WS-ERROR
 16527        PERFORM 9900-ERROR-FORMAT
 16528                                 THRU 9900-EXIT
 16529     END-IF
 16530     MOVE +0                     TO WS-PAYMENT-AMT
 16531     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16532        GO TO 3999-END-EDIT
 16533     END-IF
 16534     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16535        GO TO 3999-END-EDIT
 16536     END-IF
 16537     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16538     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16539     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16540        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16541     END-IF
 16542     MOVE '1'                    TO DC-OPTION-CODE
 16543     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16544     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 300
* EL050.cbl
 16545        IF DC-ELAPSED-DAYS < +16
 16546           GO TO 3999-END-EDIT
 16547        END-IF
 16548     END-IF
 16549     MOVE +0                     TO DC-ELAPSED-DAYS
 16550     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16551     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16552     MOVE '1'                    TO DC-OPTION-CODE
 16553     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16554     IF NO-CONVERSION-ERROR
 16555        IF DC-ELAPSED-DAYS > +30
 16556           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16557        ELSE
 16558           GO TO 3999-END-EDIT
 16559        END-IF
 16560     ELSE
 16561        GO TO 3999-END-EDIT
 16562     END-IF
 16563     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16564        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16565           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16566     IF WS-PAYMENT-AMT < 600.00
 16567        GO TO 3999-END-EDIT
 16568     END-IF
 16569     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16570
 16571     IF (ERMAIL-FOUND = ' ')
 16572         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16573         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16574        GO TO 3999-END-EDIT
 16575     END-IF
 16576     MOVE ER-2795                TO WS-ERROR
 16577     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16578
 16579     GO TO 3999-END-EDIT.
 16580******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 301
* EL050.cbl
 16582 3990-FILES-NOT-OPEN.
 16583
 16584     MOVE ER-2617                TO WS-ERROR.
 16585     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16586     GO TO 9990-RETURN.
 16587
 16588 3999-END-EDIT.
 16589
 16590     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16591
 16592     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16593         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16594         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16595             PERFORM 9250-UNLOCK-RETURN
 16596             GO TO 9990-RETURN
 16597          ELSE
 16598             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16599             GO TO 9990-RETURN.
 16600
 16601     IF PB-CANCELLATION
 16602          GO TO 9990-RETURN.
 16603
 16604     IF CERT-WAS-NOT-FOUND
 16605        MOVE SPACES              TO CERTIFICATE-MASTER.
 16606
 16607     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16608
 16609     IF CERT-WAS-FOUND
 16610         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16611             PERFORM 9250-UNLOCK-RETURN
 16612          ELSE
 16613            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16614      ELSE
 16615         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16616
 16617     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16618        IF PB-COMPANY-ID = 'DCC' AND
 16619           (PB-CARRIER = '2' OR '4' OR '6')
 16620              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16621        END-IF
 16622     END-IF.
 16623
 16624     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16625     IF ((PB-COMPANY-ID = 'DCC')
 16626        AND (WS-NO-SECURE-PAY))
 16627                  OR
 16628        (WS-LF-SPECIAL-CALC-CD = 'O'
 16629        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16630        SET SKIP-ADDR-EDIT       TO TRUE
 16631     END-IF
 16632     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16633        AND (NOT SKIP-ADDR-EDIT)
 16634        MOVE ER-2963             TO WS-ERROR
 16635        PERFORM 9900-ERROR-FORMAT
 16636                                 THRU 9900-EXIT
 16637        GO TO 9990-RETURN
 16638     END-IF
 16639     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 302
* EL050.cbl
 16640     IF ERPNDM-FOUND NOT = 'X'
 16641        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16642           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16643           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16644           AND (NOT SKIP-ADDR-EDIT)
 16645           MOVE ER-2694          TO WS-ERROR
 16646           PERFORM 9900-ERROR-FORMAT
 16647                                 THRU 9900-EXIT
 16648        END-IF
 16649        MOVE ' '                 TO STATE-RECORD-ERROR
 16650        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16651        MOVE PM-STATE            TO CNTL-ACCESS
 16652        MOVE '3'                 TO CNTL-REC-TYPE
 16653        MOVE +0                  TO CNTL-SEQ-NO
 16654        MOVE '0'                 TO RC-SW-2
 16655        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16656        IF (NO-STATE-RECORD)
 16657           OR (CF-RECORD-TYPE NOT = '3')
 16658           OR (PM-STATE NOT = CF-STATE-CODE)
 16659           IF (PM-STATE = SPACES)
 16660              AND (SKIP-ADDR-EDIT)
 16661              CONTINUE
 16662           ELSE
 16663              MOVE ER-2963       TO WS-ERROR
 16664              PERFORM 9900-ERROR-FORMAT
 16665                                 THRU 9900-EXIT
 16666           END-IF
 16667        END-IF
 16668        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16669           MOVE ER-2883          TO WS-ERROR
 16670           PERFORM 9900-ERROR-FORMAT
 16671                                 THRU 9900-EXIT
 16672        END-IF
 16673        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16674           MOVE ' '                 TO STATE-RECORD-ERROR
 16675           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16676           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16677           MOVE '3'                 TO CNTL-REC-TYPE
 16678           MOVE +0                  TO CNTL-SEQ-NO
 16679           MOVE '0'                 TO RC-SW-2
 16680           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16681           IF NO-STATE-RECORD
 16682              OR (CF-RECORD-TYPE NOT = '3')
 16683              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16684              MOVE ER-2964          TO WS-ERROR
 16685              PERFORM 9900-ERROR-FORMAT
 16686                                    THRU 9900-EXIT
 16687           END-IF
 16688        END-IF
 16689     ELSE
 16690        IF NOT SKIP-ADDR-EDIT
 16691           MOVE ER-2393          TO WS-ERROR
 16692           PERFORM 9900-ERROR-FORMAT
 16693                                 THRU 9900-EXIT
 16694        END-IF
 16695     END-IF
 16696
 16697     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 303
* EL050.cbl
 16698
 16699     IF (ERMAIL-FOUND = ' ' AND
 16700        ERPNDM-FOUND = ' ')
 16701        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16702           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16703           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16704          OR
 16705           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16706          OR
 16707           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16708           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16709           GO TO 3999-UNLOCK-ERMAIL.
 16710
 16711     IF ERPNDM-FOUND = 'X'
 16712        GO TO 3999-UNLOCK-ERMAIL.
 16713
 16714     IF PM-INSURED-LAST-NAME      = SPACES
 16715        AND PM-INSURED-FIRST-NAME = SPACES
 16716        AND PM-ADDRESS-LINE-1     = SPACES
 16717        AND PM-ADDRESS-LINE-2     = SPACES
 16718        AND PM-CITY-STATE         = SPACES
 16719        AND PM-CRED-BENE-NAME     = SPACES
 16720        AND PM-CRED-BENE-ADDR     = SPACES
 16721        AND PM-CRED-BENE-CTYST    = SPACES
 16722        GO TO 3999-UNLOCK-ERMAIL
 16723     END-IF
 16724
 16725     MOVE SPACES                 TO MAILING-DATA.
 16726
 16727     MOVE 'MA'                   TO MA-RECORD-ID.
 16728     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16729     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16730     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16731     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16732     MOVE PB-SV-STATE            TO MA-STATE.
 16733     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16734     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16735
 16736     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16737     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16738
 16739     IF ERMAIL-FOUND = ' '
 16740        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16741     ELSE
 16742        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16743        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16744        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16745
 16746     GO TO 9990-RETURN.
 16747
 16748 3999-UNLOCK-ERMAIL.
 16749     IF ERMAIL-FOUND = ' '
 16750        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16751
 16752     GO TO 9990-RETURN.
 16753******************************************************************
 16754
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 304
* EL050.cbl
 16756 4000-UPDATE-CANCELLED-CERT.
 16757     IF CERT-WAS-NOT-FOUND
 16758        GO TO 4299-EXIT.
 16759
 16760*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16761     IF PB-C-NH-INT-ON-REFS > ZEROS
 16762        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16763     END-IF
 16764     IF PB-C-REF-INTERFACE-SW = 'Y'
 16765        MOVE PB-C-REF-INTERFACE-SW
 16766                                 TO CM-NH-INTERFACE-SW
 16767     END-IF
 16768     IF PB-C-POST-CARD-IND = 'Y'
 16769        MOVE +8                  TO SUB
 16770        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16771        IF ERMAIL-FOUND = ' '
 16772           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16773              (SUB > +7)
 16774              OR (MA-MAIL-STATUS (SUB) = '1')
 16775           END-PERFORM
 16776        END-IF
 16777        IF (SUB > +7)
 16778           OR (ERMAIL-FOUND = 'X')
 16779           MOVE ER-3789          TO WS-ERROR
 16780           PERFORM 9900-ERROR-FORMAT
 16781                                 THRU 9900-EXIT
 16782        END-IF
 16783     ELSE
 16784        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16785     END-IF
 16786     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16787
 16788     IF PB-CI-OB-FLAG = 'Z'
 16789        GO TO 4150-SUMMARY-CERT-CANCEL.
 16790
 16791     IF PB-C-LF-CANCEL-VOIDED
 16792         PERFORM 4200-REVERSE-LF-CANCEL.
 16793     IF PB-C-AH-CANCEL-VOIDED
 16794         PERFORM 4200-REVERSE-AH-CANCEL.
 16795
 16796 4100-APPLY-LF-CANCEL.
 16797
 16798     MOVE +0                     TO WS-SUB.
 16799
 16800 4100-CHECK-LF-ERRORS.
 16801
 16802     ADD +1                       TO WS-SUB.
 16803
 16804     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16805        IF LF-COVERAGE-CANCELLED
 16806           GO TO 4100-LF-CANCEL-CONT
 16807        ELSE
 16808           GO TO 4100-UPDATE-LF-COVERAGE.
 16809
 16810     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16811                                   ER-2729 OR
 16812                                   ER-2730 OR
 16813                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 305
* EL050.cbl
 16814                                   ER-2732 OR
 16815                                   ER-2737 OR
 16816                                   ER-2740 OR
 16817                                   ER-2743 OR
 16818                                   ER-2749 OR
 16819                                   ER-2750 OR
 16820                                   ER-2755 OR
 16821                                   ER-2757 OR
 16822                                   ER-2760 OR
 16823                                   ER-2772 OR
 16824                                   ER-2774 OR
 16825                                   ER-2776 OR
 16826                                   ER-2794
 16827        GO TO 4100-UPDATE-LF-COVERAGE.
 16828
 16829     GO TO 4100-CHECK-LF-ERRORS.
 16830
 16831 4100-UPDATE-LF-COVERAGE.
 16832
 16833     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16834     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16835     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16836        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16837     END-IF
 16838     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16839                                      TO CM-CREDIT-INTERFACE-SW-2.
 16840     IF CM-LF-CANCEL-DT = LOW-VALUE
 16841         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16842
 16843     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16844         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16845                                         CM-LF-STATUS-AT-CANCEL.
 16846
 16847     GO TO 4100-APPLY-AH-CANCEL.
 16848
 16849 4100-LF-CANCEL-CONT.
 16850     IF PB-C-LF-CANCEL-VOIDED
 16851         GO TO 4100-APPLY-AH-CANCEL.
 16852
 16853     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16854         GO TO 4100-APPLY-AH-CANCEL.
 16855
 16856     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16857        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16858           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16859        ELSE
 16860           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16861
 16862     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16863     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16864
 16865     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16866         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16867
 16868     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 16869        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 16870         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16871         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 306
* EL050.cbl
 16872
 16873     IF PB-RECORD-RETURNED
 16874        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16875      ELSE
 16876        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16877
 16878 4100-APPLY-AH-CANCEL.
 16879
 16880     MOVE +0                      TO WS-SUB.
 16881
 16882 4100-CHECK-AH-ERRORS.
 16883
 16884     ADD +1                       TO WS-SUB.
 16885
 16886     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16887        IF AH-COVERAGE-CANCELLED
 16888           GO TO 4100-AH-CANCEL-CONT
 16889        ELSE
 16890           GO TO 4100-UPDATE-AH-COVERAGE.
 16891
 16892     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16893                                   ER-2729 OR
 16894                                   ER-2732 OR
 16895                                   ER-2737 OR
 16896                                   ER-2740 OR
 16897                                   ER-2744 OR
 16898                                   ER-2749 OR
 16899                                   ER-2750 OR
 16900                                   ER-2755 OR
 16901                                   ER-2757 OR
 16902                                   ER-2760 OR
 16903                                   ER-2771 OR
 16904                                   ER-2772 OR
 16905                                   ER-2773 OR
 16906                                   ER-2775 OR
 16907                                   ER-2777 OR
 16908                                   ER-2794
 16909        GO TO 4100-UPDATE-AH-COVERAGE.
 16910
 16911     GO TO 4100-CHECK-AH-ERRORS.
 16912
 16913 4100-UPDATE-AH-COVERAGE.
 16914
 16915     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 16916     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 16917     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 16918     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16919                                      TO CM-CREDIT-INTERFACE-SW-2.
 16920     IF CM-AH-CANCEL-DT = LOW-VALUE
 16921         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 16922
 16923     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 16924         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 16925                                         CM-AH-STATUS-AT-CANCEL.
 16926
 16927     IF LF-COVERAGE-CANCELLED
 16928         IF PB-RECORD-RETURNED
 16929              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 307
* EL050.cbl
 16930          ELSE
 16931              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 16932
 16933     GO TO 4299-EXIT.
 16934
 16935 4100-AH-CANCEL-CONT.
 16936     IF PB-C-AH-CANCEL-VOIDED
 16937         GO TO 4299-EXIT.
 16938
 16939     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16940         GO TO 4299-EXIT.
 16941
 16942     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 16943        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16944           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 16945        ELSE
 16946           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 16947
 16948     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 16949     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 16950
 16951     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 16952         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 16953
 16954     IF CM-AH-STATUS-AT-CANCEL = SPACE
 16955         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 16956         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 16957
 16958     IF PB-RECORD-RETURNED
 16959        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 16960      ELSE
 16961        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 16962
 16963     GO TO 4299-EXIT.
 16964
 16965 4150-SUMMARY-CERT-CANCEL.
 16966     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 16967
 16968     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16969        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16970                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 16971     ELSE
 16972        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16973                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 16974
 16975     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16976        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16977                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 16978     ELSE
 16979        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16980                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 16981
 16982     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16983        NEXT SENTENCE
 16984     ELSE
 16985        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 16986
 16987     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 308
* EL050.cbl
 16988
 16989 4200-REVERSE-LF-CANCEL.
 16990     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 16991
 16992     IF CM-LF-CANCEL-APPLIED
 16993        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 16994        MOVE SPACES                TO CM-LF-EXIT-BATCH
 16995        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 16996
 16997     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 16998
 16999     IF PB-RECORD-RETURNED
 17000        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17001       ELSE
 17002        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17003
 17004 4200-REVERSE-LF-EXIT.
 17005       EXIT.
 17006
 17007 4200-REVERSE-AH-CANCEL.
 17008     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17009
 17010     IF CM-AH-CANCEL-APPLIED
 17011        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17012        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17013        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17014
 17015     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17016
 17017     IF PB-RECORD-RETURNED
 17018        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17019       ELSE
 17020        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17021
 17022 4200-REVERSE-AH-EXIT.
 17023       EXIT.
 17024
 17025 4299-EXIT.
 17026       EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 309
* EL050.cbl
 17028
 17029 4500-UPDATE-NEW-CERT.
 17030     IF CERT-WAS-FOUND
 17031         NEXT SENTENCE
 17032       ELSE
 17033         GO TO 4520-BUILD-NEW-KEY.
 17034
 17035     IF  CLASIC-CREATED-CERT
 17036         GO TO 4999-EXIT.
 17037
 17038     IF  CERT-WAS-CREATED-FOR-CLAIM
 17039         GO TO 4520-BUILD-NEW-KEY.
 17040
 17041     IF CERT-ADDED-BATCH
 17042        IF CM-RECORD-ID = 'CM'
 17043            GO TO 4999-EXIT.
 17044
 17045 4520-BUILD-NEW-KEY.
 17046* BUILD CONTROL PRIMARY
 17047
 17048     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17049                                       CM-COMPANY-CD-A1
 17050                                       CM-COMPANY-CD-A2
 17051                                       CM-COMPANY-CD-A4
 17052                                       CM-COMPANY-CD-A5.
 17053
 17054     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17055     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17056     MOVE PB-SV-STATE               TO CM-STATE.
 17057     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17058     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17059     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17060     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17061
 17062     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17063
 17064     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17065     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17066     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17067     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17068
 17069     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17070        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17071
 17072     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17073         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17074         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17075         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17076         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17077     ELSE
 17078         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17079
 17080     IF PB-COMPANY-ID   EQUAL  'CRI'
 17081         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17082         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17083         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17084         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17085         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 310
* EL050.cbl
 17086
 17087     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17088        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17089         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17090
 17091     IF PB-COMPANY-ID  = 'LBL'
 17092        IF PB-I-JOINT-COVERAGE
 17093            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17094                                           PB-I-MEMBER-NO
 17095            GO TO 4550-CONT-CERT-PROCESS.
 17096
 17097     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17098        NEXT SENTENCE
 17099     ELSE
 17100        GO TO 4540-BUILD-MEMBER-NO.
 17101
 17102******************************************************************
 17103*                                                                *
 17104*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17105*    FOR 'MON'.                                                  *
 17106*                                                                *
 17107******************************************************************
 17108
 17109     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17110     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17111     MOVE +1                     TO WS-SUB1
 17112                                    WS-SUB2.
 17113
 17114 4530-EDIT-MEMB-NAME.
 17115
 17116     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17117        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17118        ADD +1                       TO WS-SUB2.
 17119
 17120     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17121        ADD +1                       TO WS-SUB1
 17122        GO TO 4530-EDIT-MEMB-NAME.
 17123
 17124     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17125     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17126     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17127*    MOVE SPACE                      TO DC-OPTION-CODE.
 17128     SET  BIN-TO-GREG                TO TRUE.
 17129     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17130     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17131
 17132     GO TO 4550-CONT-CERT-PROCESS.
 17133
 17134******************************************************************
 17135*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17136******************************************************************
 17137
 17138 4540-BUILD-MEMBER-NO.
 17139
 17140     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17141         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17142         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17143         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 311
* EL050.cbl
 17144         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17145     ELSE
 17146         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17147
 17148     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17149        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17150         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17151
 17152 4550-CONT-CERT-PROCESS.
 17153
 17154*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17155*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17156*    ELSE
 17157*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17158
 17159     IF CERT-WAS-CREATED-FOR-CLAIM
 17160        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17161        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17162
 17163     IF CERT-AND-CLAIM-ONLINE
 17164        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17165        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17166
 17167     MOVE 'CM'                     TO CM-RECORD-ID.
 17168     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17169
 17170     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17171        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17172        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17173     ELSE
 17174        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17175        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17176
 17177     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17178     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17179     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17180     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17181     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17182     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17183     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17184                                      CM-LF-ITD-CANCEL-AMT
 17185                                      CM-LF-ITD-DEATH-AMT
 17186                                      CM-AH-ITD-AH-PMT
 17187                                      CM-AH-ITD-LUMP-PMT
 17188                                      CM-AH-ITD-CANCEL-AMT
 17189                                      CM-LF-NSP-PREMIUM-AMT
 17190                                      CM-AH-NSP-PREMIUM-AMT.
 17191*                                     CM-CLAIM-DEDUCT-WITHHELD
 17192*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17193     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17194     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17195     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17196     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17197     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17198     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17199     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17200     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17201     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 312
* EL050.cbl
 17202     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17203     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17204     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17205
 17206     IF PB-I-LIVES NOT NUMERIC
 17207         MOVE ZERO                 TO PB-I-LIVES.
 17208
 17209     IF PB-I-NUM-BILLED NOT NUMERIC
 17210         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17211
 17212     MOVE PB-I-LIVES               TO CM-LIVES.
 17213     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17214
 17215     IF PB-COMPANY-ID EQUAL  'DMD'
 17216         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17217         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17218
 17219     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17220     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17221     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17222     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17223     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17224     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17225
 17226     IF PB-I-LF-POLICY-FEE NUMERIC
 17227        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17228     ELSE
 17229        MOVE +0                    TO CM-LF-POLICY-FEE.
 17230
 17231     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17232        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17233        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17234     ELSE
 17235        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17236
 17237     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17238     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17239     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17240     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17241     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17242     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17243     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17244     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17245     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17246
 17247     IF PB-I-AH-POLICY-FEE NUMERIC
 17248        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17249     ELSE
 17250        MOVE +0                    TO CM-AH-POLICY-FEE.
 17251
 17252     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17253        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17254     ELSE
 17255        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17256
 17257     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17258     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17259
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 313
* EL050.cbl
 17260     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17261                                      CM-LF-DEATH-EXIT-DT
 17262                                      CM-AH-SETTLEMENT-EXIT-DT.
 17263
 17264*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17265*                       'TIH' OR 'OFL' OR 'FLA' OR
 17266*                       'TII' OR 'TMS' OR 'CRI' OR
 17267*                       'NCL'
 17268     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17269
 17270     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17271         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17272            MOVE '2'                TO CM-PREMIUM-TYPE.
 17273
 17274     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17275         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17276            MOVE '2'                TO CM-PREMIUM-TYPE.
 17277
 17278     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17279         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17280     ELSE
 17281         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17282         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17283
 17284     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17285     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17286     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17287     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17288     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17289     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17290     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17291     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17292
 17293     IF PB-NO-MONTHS-SKIPPED
 17294         MOVE SPACE                 TO CM-SKIP-CODE
 17295     ELSE
 17296         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17297
 17298     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17299     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17300                                       CM-LF-STATUS-AT-CANCEL.
 17301
 17302     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17303     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17304                                       CM-AH-STATUS-AT-CANCEL.
 17305
 17306     MOVE '1'                       TO CM-ENTRY-STATUS.
 17307
 17308     IF PB-REISSUED-CERT
 17309        MOVE '5'                    TO CM-ENTRY-STATUS.
 17310
 17311     IF PB-MONTHLY-CERT
 17312        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17313
 17314     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17315     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17316     IF PB-POLICY-IS-DECLINED
 17317        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 314
* EL050.cbl
 17318
 17319     IF PB-POLICY-IS-VOIDED
 17320        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17321
 17322     IF PB-NEEDS-UNDERWRITING
 17323        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17324
 17325     IF PB-REIN-ONLY-CERT
 17326        MOVE '9'                    TO CM-ENTRY-STATUS.
 17327
 17328     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17329         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17330     ELSE
 17331         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17332
 17333     IF PB-RECORD-RETURNED
 17334        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17335      ELSE
 17336        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17337
 17338     IF PB-I-MAIL-ADDRS-PRESENT
 17339        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17340
 17341     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17342                                       CM-ENTRY-DT.
 17343
 17344 4999-EXIT.
 17345     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 315
* EL050.cbl
 17347
 17348 5000-PROCESS-REPS.
 17349     MOVE ' '                    TO AGTC-MASTER-SW
 17350     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17351     MOVE CO-TYPE                TO AGTC-TYPE
 17352     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17353     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17354     IF (AGTC-MASTER-SW NOT = 'N')
 17355        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17356        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17357        PERFORM 8583-READ-ERAGTC-NEXT
 17358                                 THRU 8583-EXIT
 17359     END-IF
 17360     IF AGTC-MASTER-SW = 'N'
 17361        CONTINUE
 17362     ELSE
 17363        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17364           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17365              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17366              MOVE 'Y'           TO AGTC-MASTER-SW
 17367           END-IF
 17368        END-IF
 17369     END-IF
 17370     .
 17371 5000-EXIT.
 17372     EXIT.
 17373 6370-EDIT-INPUT-LF-CODE.
 17374     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17375        MOVE +1                  TO SUB
 17376        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17377        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17378        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17379        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17380        GO TO 6370-SEARCH-LOOP.
 17381
 17382     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17383
 17384     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17385     MOVE SPACES                 TO CNTL-ACCESS.
 17386*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17387     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17388     MOVE +0                     TO CNTL-SEQ-NO.
 17389     MOVE '4' TO RC-SW-2.
 17390     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17391
 17392     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17393        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17394        GO TO 6370-NO-LF-FOUND.
 17395
 17396     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17397     MOVE +1                     TO SUB.
 17398
 17399 6370-SEARCH-LOOP.
 17400     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17401         GO TO 6370-NO-LF-FOUND.
 17402
 17403     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17404         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 316
* EL050.cbl
 17405         GO TO 6370-HER-NET-PAY-CHECK.
 17406
 17407     ADD 1   TO SUB.
 17408*    IF SUB GREATER 120
 17409     IF SUB GREATER 200
 17410         GO TO 6370-NO-LF-FOUND.
 17411
 17412     GO TO 6370-SEARCH-LOOP.
 17413
 17414 6370-NO-LF-FOUND.
 17415
 17416     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17417
 17418 6370-HER-NET-PAY-CHECK.
 17419
 17420     IF PB-COMPANY-ID = 'CID'
 17421        IF PB-SV-STATE = 'CA' OR 'MN'
 17422           IF PB-I-LF-BENEFIT-CD = '02'
 17423              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17424           ELSE
 17425              IF PB-I-LF-BENEFIT-CD = '04'
 17426                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17427              END-IF
 17428           END-IF
 17429        END-IF
 17430     END-IF
 17431
 17432     IF PB-COMPANY-ID NOT = 'HER'
 17433         GO TO 6370-EXIT.
 17434
 17435     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17436         GO TO 6370-EXIT.
 17437
 17438     IF PB-I-LF-TERM NOT NUMERIC
 17439         MOVE ZEROS              TO PB-I-LF-TERM.
 17440
 17441     IF PB-I-LOAN-TERM NOT NUMERIC
 17442         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17443
 17444     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17445         GO TO 6370-EXIT.
 17446
 17447     IF PB-I-LF-BENEFIT-CD = '33'
 17448         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17449
 17450     IF PB-I-LF-BENEFIT-CD = '34'
 17451         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17452
 17453 6370-EXIT.
 17454     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 317
* EL050.cbl
 17456
 17457 6380-EDIT-INPUT-AH-CODE.
 17458     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17459        MOVE +1                  TO SUB
 17460        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17461        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17462        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17463        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17464        GO TO 6380-SEARCH-LOOP.
 17465
 17466     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17467
 17468     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17469     MOVE SPACES                 TO CNTL-ACCESS.
 17470     MOVE 'A'                    TO CNTL-REC-TYPE.
 17471*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17472     MOVE +0                     TO CNTL-SEQ-NO.
 17473     MOVE '5' TO RC-SW-2.
 17474     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17475
 17476     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17477        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17478        GO TO 6380-NO-AH-FOUND.
 17479
 17480     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17481     MOVE +1 TO SUB.
 17482
 17483 6380-SEARCH-LOOP.
 17484     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17485         GO TO 6380-NO-AH-FOUND.
 17486
 17487     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17488         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17489         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17490
 17491     ADD 1   TO SUB.
 17492     IF SUB GREATER THAN 96
 17493*    IF SUB GREATER THAN 300
 17494         GO TO 6380-NO-AH-FOUND.
 17495
 17496     GO TO 6380-SEARCH-LOOP.
 17497
 17498 6380-NO-AH-FOUND.
 17499
 17500     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17501
 17502     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17503         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17504     ELSE
 17505         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17506
 17507 6380-CSO-AH-ONLY-CHECKS.
 17508
 17509     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17510        NEXT SENTENCE
 17511      ELSE
 17512        GO TO 6380-EXIT.
 17513
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 318
* EL050.cbl
 17514     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17515         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17516
 17517
 17518     GO TO 6380-EXIT
 17519     .
 17520 6380-CSO-LIFE-WITH-AH-CHECKS.
 17521
 17522
 17523     .
 17524 6380-EXIT.
 17525     EXIT.
 17526
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 319
* EL050.cbl
 17528
 17529 6400-COMPUTE-EXTENSION-DAYS.
 17530
 17531******************************************************************
 17532*                                                                *
 17533*                   COMPUTE EXTENSION DAYS                       *
 17534*                                                                *
 17535*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17536*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17537*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17538*    THE EXTENSION DAYS.                                         *
 17539*                                                                *
 17540******************************************************************
 17541
 17542     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17543     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17544
 17545******************************************************************
 17546*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17547*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17548******************************************************************
 17549
 17550     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17551        COMPUTE WS-ODD-DAYS-OVER =
 17552               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17553     ELSE
 17554        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17555
 17556     IF WS-ODD-DAYS-OVER = ZEROS
 17557           GO TO 6499-EXIT
 17558     ELSE
 17559        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17560           IF WS-WDF-MONTH = 02
 17561              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17562              ADD 2       TO  WS-ODD-DAYS-OVER
 17563              GO TO 6499-EXIT
 17564           ELSE
 17565              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17566                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17567                 GO TO 6499-EXIT
 17568               ELSE
 17569                 GO TO 6499-EXIT
 17570        ELSE
 17571           GO TO 6499-EXIT.
 17572
 17573 6412-CHECK-TO-DAY.
 17574
 17575        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17576           IF WS-WDT-DAY = 28
 17577              ADD 2              TO WS-ODD-DAYS-OVER
 17578           ELSE
 17579              IF WS-WDT-DAY = 29
 17580                 ADD 1           TO WS-ODD-DAYS-OVER
 17581              ELSE
 17582                 NEXT SENTENCE
 17583        ELSE
 17584           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17585              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 320
* EL050.cbl
 17586
 17587     GO TO 6499-EXIT.
 17588
 17589
 17590 6415-CHECK-LEAP-YEAR.
 17591
 17592     IF DC-DAYS-IN-MONTH = 29
 17593        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17594
 17595 6415-EXIT.
 17596     EXIT.
 17597
 17598 6499-EXIT.
 17599      EXIT.
 17600
 17601 6500-END.
 17602     EXIT.
 17603
 17604
 17605******************************************************************
 17606************* PROCEDURE DIVISION FOR EL050 ***********************
 17607********************** ELC50PD END *******************************
 17608
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 321
* EL050.cbl
 17610
 17611**START***********************************************************
 17612*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17613*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17614******************************************************************
 17615*
 17616 6600-GET-STATE-MUNICIPAL-TAX.
 17617
 17618     IF PB-COMPANY-ID NOT = 'DMD'
 17619         GO TO 6640-EXIT.
 17620
 17621     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17622     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17623     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17624*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17625*
 17626***  Y2K PROJ 7744
 17627     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17628     SET BIN-TO-GREG          TO TRUE.
 17629     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17630
 17631     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17632
 17633     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17634     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17635
 17636
 17637* EXEC CICS HANDLE CONDITION
 17638*        INVREQ    (6610-START-BROWSE)
 17639*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17640*        NOTFND    (6630-END-OF-FILE)
 17641*    END-EXEC.
 17642*    MOVE '"$8JI                 ! # #00017624' TO DFHEIV0
 17643     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17645     MOVE X'2320233030303137363234' TO DFHEIV0(25:11)
 17646     CALL 'kxdfhei1' USING DFHEIV0
 17647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17648
 17649
 17650 6610-START-BROWSE.
 17651
 17652
 17653* EXEC CICS HANDLE CONDITION
 17654*        NOTFND    (6630-END-OF-FILE)
 17655*        DISABLED  (6630-ERRESS-PROBLEM)
 17656*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17657*        ENDFILE   (6630-END-OF-FILE)
 17658*    END-EXEC.
 17659*    MOVE '"$IcJ''                ! $ #00017632' TO DFHEIV0
 17660     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17662     MOVE X'2420233030303137363332' TO DFHEIV0(25:11)
 17663     CALL 'kxdfhei1' USING DFHEIV0
 17664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17665
 17666
 17667
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 322
* EL050.cbl
 17668* EXEC CICS STARTBR
 17669*        DATASET (FILE-ID-ERRESS)
 17670*        RIDFLD  (WS-ERRESS-KEY)
 17671*        GTEQ
 17672*    END-EXEC.
 17673     MOVE 0
 17674       TO DFHEIV11
 17675*    MOVE '&,         G          &   #00017639' TO DFHEIV0
 17676     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17677     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17678     MOVE X'2020233030303137363339' TO DFHEIV0(25:11)
 17679     CALL 'kxdfhei1' USING DFHEIV0,
 17680           FILE-ID-ERRESS,
 17681           WS-ERRESS-KEY,
 17682           DFHEIV99,
 17683           DFHEIV11,
 17684           DFHEIV99
 17685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17686
 17687
 17688 6620-READ-NEXT-ERRESS-MASTER.
 17689
 17690
 17691* EXEC CICS HANDLE CONDITION
 17692*        NOTFND    (6630-END-OF-FILE)
 17693*        ENDFILE   (6630-END-OF-FILE)
 17694*        DISABLED  (6630-ERRESS-PROBLEM)
 17695*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17696*    END-EXEC.
 17697*    MOVE '"$I''cJ                ! % #00017647' TO DFHEIV0
 17698     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17700     MOVE X'2520233030303137363437' TO DFHEIV0(25:11)
 17701     CALL 'kxdfhei1' USING DFHEIV0
 17702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17703
 17704
 17705
 17706* EXEC CICS READNEXT
 17707*        DATASET (FILE-ID-ERRESS)
 17708*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17709*        RIDFLD  (WS-ERRESS-KEY)
 17710*    END-EXEC.
 17711     MOVE LENGTH OF
 17712      RESIDENT-STATE-TAX-MASTER
 17713       TO DFHEIV12
 17714     MOVE 0
 17715       TO DFHEIV11
 17716*    MOVE '&.IL                  )   #00017654' TO DFHEIV0
 17717     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17718     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17719     MOVE X'2020233030303137363534' TO DFHEIV0(25:11)
 17720     CALL 'kxdfhei1' USING DFHEIV0,
 17721           FILE-ID-ERRESS,
 17722           RESIDENT-STATE-TAX-MASTER,
 17723           DFHEIV12,
 17724           WS-ERRESS-KEY,
 17725           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 323
* EL050.cbl
 17726           DFHEIV11,
 17727           DFHEIV99,
 17728           DFHEIV99
 17729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17730
 17731
 17732     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17733
 17734* EXEC CICS ENDBR
 17735*            DATASET (FILE-ID-ERRESS)
 17736*       END-EXEC
 17737     MOVE 0
 17738       TO DFHEIV11
 17739*    MOVE '&2                    $   #00017661' TO DFHEIV0
 17740     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17741     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17742     MOVE X'2020233030303137363631' TO DFHEIV0(25:11)
 17743     CALL 'kxdfhei1' USING DFHEIV0,
 17744           FILE-ID-ERRESS,
 17745           DFHEIV11,
 17746           DFHEIV99
 17747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17748        GO TO 6630-END-OF-FILE.
 17749
 17750     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17751        NEXT SENTENCE
 17752      ELSE
 17753        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17754
 17755*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17756*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17757*
 17758     MOVE +2                     TO WS-SUB1.
 17759
 17760     IF PB-ISSUE
 17761     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17762        MOVE +1                  TO WS-SUB1.
 17763
 17764     IF PB-CANCELLATION
 17765     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17766        MOVE +1                  TO WS-SUB1.
 17767*
 17768*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17769*
 17770***  Y2K PROJ 7744
 17771     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17772***  Y2K PROJ 7744
 17773
 17774*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17775* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17776* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17777
 17778     ADD 1                    TO WS-YEAR-YY.
 17779
 17780     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17781         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17782                              TO WS-RES-STATE-TAX
 17783         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 324
* EL050.cbl
 17784                              TO WS-RES-MUNI-TAX
 17785     ELSE
 17786         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17787                              TO WS-RES-STATE-TAX
 17788         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17789                              TO WS-RES-MUNI-TAX.
 17790
 17791*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17792
 17793     IF PB-CANCELLATION
 17794         GO TO 6640-CANCEL-TAX.
 17795
 17796     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17797         COMPUTE PB-I-STATE-TAX ROUNDED =
 17798                                   PB-I-LF-PREMIUM-AMT
 17799                                 * WS-RES-STATE-TAX
 17800         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17801                                   PB-I-LF-PREMIUM-AMT
 17802                                 * WS-RES-MUNI-TAX
 17803     ELSE
 17804     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17805         COMPUTE PB-I-STATE-TAX ROUNDED =
 17806                                   PB-I-AH-PREMIUM-AMT
 17807                                 * WS-RES-STATE-TAX
 17808         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17809                                   PB-I-AH-PREMIUM-AMT
 17810                                 * WS-RES-MUNI-TAX.
 17811
 17812
 17813* EXEC CICS ENDBR
 17814*         DATASET (FILE-ID-ERRESS)
 17815*    END-EXEC.
 17816     MOVE 0
 17817       TO DFHEIV11
 17818*    MOVE '&2                    $   #00017728' TO DFHEIV0
 17819     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17820     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17821     MOVE X'2020233030303137373238' TO DFHEIV0(25:11)
 17822     CALL 'kxdfhei1' USING DFHEIV0,
 17823           FILE-ID-ERRESS,
 17824           DFHEIV11,
 17825           DFHEIV99
 17826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17827
 17828
 17829     GO TO 6640-EXIT.
 17830
 17831 6640-CANCEL-TAX.
 17832     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17833
 17834     IF PB-C-LF-CANCEL-AMT > ZEROS
 17835         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17836                                   PB-C-LF-CANCEL-AMT
 17837                                 * WS-RES-STATE-TAX
 17838         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17839                                   PB-C-LF-CANCEL-AMT
 17840                                *  WS-RES-MUNI-TAX
 17841     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 325
* EL050.cbl
 17842     IF PB-C-AH-CANCEL-AMT > ZEROS
 17843         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17844                                   PB-C-AH-CANCEL-AMT
 17845                                 * WS-RES-STATE-TAX
 17846         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17847                                   PB-C-AH-CANCEL-AMT
 17848                                *  WS-RES-MUNI-TAX.
 17849
 17850
 17851* EXEC CICS ENDBR
 17852*         DATASET (FILE-ID-ERRESS)
 17853*    END-EXEC.
 17854     MOVE 0
 17855       TO DFHEIV11
 17856*    MOVE '&2                    $   #00017753' TO DFHEIV0
 17857     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17858     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17859     MOVE X'2020233030303137373533' TO DFHEIV0(25:11)
 17860     CALL 'kxdfhei1' USING DFHEIV0,
 17861           FILE-ID-ERRESS,
 17862           DFHEIV11,
 17863           DFHEIV99
 17864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17865
 17866
 17867     GO TO 6640-EXIT.
 17868
 17869 6630-END-OF-FILE.
 17870     MOVE ER-8002              TO WS-ERROR.
 17871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17872
 17873     GO TO 6640-EXIT.
 17874
 17875 6630-ERRESS-PROBLEM.
 17876     MOVE ER-8044              TO WS-ERROR.
 17877     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17878
 17879 6640-EXIT.
 17880     EXIT.
 17881
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 326
* EL050.cbl
 17883 6650-GET-RES-STATE-COMM.
 17884
 17885     IF PB-COMPANY-ID NOT = 'DMD'
 17886         GO TO 6700-COMM-EXIT.
 17887
 17888     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 17889     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 17890     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 17891     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 17892     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 17893     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 17894     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 17895
 17896*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 17897*
 17898***  Y2K PROJ 7744
 17899     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17900     SET BIN-TO-GREG          TO TRUE.
 17901     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17902
 17903     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17904***  Y2K PROJ 7744
 17905
 17906     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 17907
 17908
 17909* EXEC CICS HANDLE CONDITION
 17910*        INVREQ    (6660-START-BROWSE)
 17911*        DISABLED  (6690-ERRESC-PROBLEM)
 17912*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17913*        NOTFND    (6690-END-OF-FILE)
 17914*    END-EXEC.
 17915*    MOVE '"$8cJI                ! & #00017798' TO DFHEIV0
 17916     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 17917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17918     MOVE X'2620233030303137373938' TO DFHEIV0(25:11)
 17919     CALL 'kxdfhei1' USING DFHEIV0
 17920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17921
 17922
 17923
 17924* EXEC CICS RESETBR
 17925*        DATASET (FILE-ID-ERRESC)
 17926*        RIDFLD  (WS-ERRESC-KEY)
 17927*    END-EXEC.
 17928     MOVE 0
 17929       TO DFHEIV11
 17930*    MOVE '&4         G          &   #00017805' TO DFHEIV0
 17931     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17932     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17933     MOVE X'2020233030303137383035' TO DFHEIV0(25:11)
 17934     CALL 'kxdfhei1' USING DFHEIV0,
 17935           FILE-ID-ERRESC,
 17936           WS-ERRESC-KEY,
 17937           DFHEIV99,
 17938           DFHEIV11,
 17939           DFHEIV99
 17940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 327
* EL050.cbl
 17941
 17942
 17943 6660-START-BROWSE.
 17944
 17945
 17946* EXEC CICS HANDLE CONDITION
 17947*        NOTFND    (6690-END-OF-FILE)
 17948*        DISABLED  (6690-ERRESC-PROBLEM)
 17949*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17950*        ENDFILE   (6690-END-OF-FILE)
 17951*    END-EXEC.
 17952*    MOVE '"$IcJ''                ! '' #00017812' TO DFHEIV0
 17953     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17954     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17955     MOVE X'2720233030303137383132' TO DFHEIV0(25:11)
 17956     CALL 'kxdfhei1' USING DFHEIV0
 17957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17958
 17959
 17960
 17961* EXEC CICS STARTBR
 17962*        DATASET (FILE-ID-ERRESC)
 17963*        RIDFLD  (WS-ERRESC-KEY)
 17964*        GTEQ
 17965*    END-EXEC.
 17966     MOVE 0
 17967       TO DFHEIV11
 17968*    MOVE '&,         G          &   #00017819' TO DFHEIV0
 17969     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17971     MOVE X'2020233030303137383139' TO DFHEIV0(25:11)
 17972     CALL 'kxdfhei1' USING DFHEIV0,
 17973           FILE-ID-ERRESC,
 17974           WS-ERRESC-KEY,
 17975           DFHEIV99,
 17976           DFHEIV11,
 17977           DFHEIV99
 17978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17979
 17980
 17981     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 17982
 17983 6670-READ-NEXT-ERRESC-MASTER.
 17984
 17985
 17986* EXEC CICS HANDLE CONDITION
 17987*        NOTFND    (6690-END-OF-FILE)
 17988*        DISABLED  (6690-ERRESC-PROBLEM)
 17989*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17990*        ENDFILE   (6690-END-OF-FILE)
 17991*    END-EXEC.
 17992*    MOVE '"$IcJ''                ! ( #00017829' TO DFHEIV0
 17993     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17995     MOVE X'2820233030303137383239' TO DFHEIV0(25:11)
 17996     CALL 'kxdfhei1' USING DFHEIV0
 17997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17998
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 328
* EL050.cbl
 17999
 18000
 18001* EXEC CICS READNEXT
 18002*        DATASET (FILE-ID-ERRESC)
 18003*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18004*        RIDFLD  (ERRESC-RECORD-KEY)
 18005*    END-EXEC.
 18006     MOVE LENGTH OF
 18007      ACCOUNT-RESIDENT-ST-COMMISSION
 18008       TO DFHEIV12
 18009     MOVE 0
 18010       TO DFHEIV11
 18011*    MOVE '&.IL                  )   #00017836' TO DFHEIV0
 18012     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18013     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18014     MOVE X'2020233030303137383336' TO DFHEIV0(25:11)
 18015     CALL 'kxdfhei1' USING DFHEIV0,
 18016           FILE-ID-ERRESC,
 18017           ACCOUNT-RESIDENT-ST-COMMISSION,
 18018           DFHEIV12,
 18019           ERRESC-RECORD-KEY,
 18020           DFHEIV99,
 18021           DFHEIV11,
 18022           DFHEIV99,
 18023           DFHEIV99
 18024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18025
 18026
 18027     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18028        NEXT SENTENCE
 18029     ELSE
 18030
 18031* EXEC CICS ENDBR
 18032*            DATASET (FILE-ID-ERRESC)
 18033*       END-EXEC
 18034     MOVE 0
 18035       TO DFHEIV11
 18036*    MOVE '&2                    $   #00017845' TO DFHEIV0
 18037     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18038     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18039     MOVE X'2020233030303137383435' TO DFHEIV0(25:11)
 18040     CALL 'kxdfhei1' USING DFHEIV0,
 18041           FILE-ID-ERRESC,
 18042           DFHEIV11,
 18043           DFHEIV99
 18044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18045        GO TO 6690-END-OF-FILE.
 18046
 18047     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18048
 18049* EXEC CICS ENDBR
 18050*            DATASET (FILE-ID-ERRESC)
 18051*       END-EXEC
 18052     MOVE 0
 18053       TO DFHEIV11
 18054*    MOVE '&2                    $   #00017851' TO DFHEIV0
 18055     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18056     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 329
* EL050.cbl
 18057     MOVE X'2020233030303137383531' TO DFHEIV0(25:11)
 18058     CALL 'kxdfhei1' USING DFHEIV0,
 18059           FILE-ID-ERRESC,
 18060           DFHEIV11,
 18061           DFHEIV99
 18062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18063        GO TO 6690-END-OF-FILE.
 18064
 18065     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18066        NEXT SENTENCE
 18067      ELSE
 18068        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18069
 18070* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18071*
 18072     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18073
 18074     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18075
 18076     IF WS-SUB1 > ZERO
 18077         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18078             PERFORM 6680-SET-COMMISSION
 18079         ELSE
 18080             PERFORM 6680-SET-TABLE-CODE.
 18081
 18082
 18083* EXEC CICS ENDBR
 18084*         DATASET (FILE-ID-ERRESC)
 18085*    END-EXEC.
 18086     MOVE 0
 18087       TO DFHEIV11
 18088*    MOVE '&2                    $   #00017873' TO DFHEIV0
 18089     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18090     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18091     MOVE X'2020233030303137383733' TO DFHEIV0(25:11)
 18092     CALL 'kxdfhei1' USING DFHEIV0,
 18093           FILE-ID-ERRESC,
 18094           DFHEIV11,
 18095           DFHEIV99
 18096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18097
 18098
 18099     GO TO 6700-COMM-EXIT.
 18100
 18101 6680-SET-TABLE-CODE.
 18102     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18103        MOVE ZEROS             TO WS-SUB1
 18104     ELSE
 18105* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18106* TO COMPUTE AH COMMISSION.
 18107        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18108        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18109        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18110        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18111        PERFORM 6680-READ-CTBL-TABLE
 18112        IF WS-CTBL-READ-SW NOT = 'Y'
 18113           MOVE ZEROS          TO WS-SUB1.
 18114
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 330
* EL050.cbl
 18115 6680-READ-CTBL-TABLE.
 18116*
 18117* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18118* TO COMPUTE LIFE COMMISSION
 18119
 18120     IF CTBL-SW = '0540'
 18121        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18122        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18123        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18124
 18125     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18126
 18127     IF CTBL-TABLE-FOUND
 18128        IF CTBL-SW = '0530'
 18129             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18130                                    * PB-I-AH-TERM
 18131             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18132             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18133        ELSE
 18134             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18135             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18136             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18137     ELSE
 18138        IF FIRST-TIME-THROUGH
 18139            GO TO 6680-READ-CTBL-TABLE
 18140        ELSE
 18141            MOVE ZEROS         TO WS-SUB1.
 18142
 18143 6680-SET-COMMISSION.
 18144     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18145           MOVE ZEROS          TO WS-SUB1
 18146       ELSE
 18147           MOVE RESC-COMMISSION-PER (WS-SUB)
 18148                               TO WS-COMMISSION
 18149           IF CTBL-SW = '0530'
 18150               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18151           ELSE
 18152               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18153
 18154 6680-SEARCH-CATEGORY.
 18155     ADD +1                   TO WS-SUB.
 18156     IF WS-SUB > +12
 18157         GO TO 6680-EXIT.
 18158
 18159     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18160          MOVE WS-SUB         TO WS-SUB1
 18161          GO TO 6680-EXIT.
 18162
 18163     GO TO 6680-SEARCH-CATEGORY.
 18164
 18165 6680-EXIT.
 18166     EXIT.
 18167
 18168 6690-END-OF-FILE.
 18169     GO TO 6700-COMM-EXIT.
 18170
 18171 6690-ERRESC-PROBLEM.
 18172      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 331
* EL050.cbl
 18173      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18174
 18175      GO TO 6700-COMM-EXIT.
 18176
 18177 6700-COMM-EXIT.
 18178     EXIT.
 18179
 18180 7000-GET-RATE.
 18181
 18182* EXEC CICS LINK
 18183*        PROGRAM    ('ELRATE')
 18184*        COMMAREA   (CALCULATION-PASS-AREA)
 18185*        LENGTH     (CP-COMM-LENGTH)
 18186*    END-EXEC.
 18187     MOVE 'ELRATE' TO DFHEIV1
 18188*    MOVE '."C                   ''   #00017959' TO DFHEIV0
 18189     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18190     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18191     MOVE X'2020233030303137393539' TO DFHEIV0(25:11)
 18192     CALL 'kxdfhei1' USING DFHEIV0,
 18193           DFHEIV1,
 18194           CALCULATION-PASS-AREA,
 18195           CP-COMM-LENGTH,
 18196           DFHEIV99,
 18197           DFHEIV99,
 18198           DFHEIV99
 18199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18200
 18201
 18202 7000-EXIT.
 18203     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 332
* EL050.cbl
 18205 7100-FIND-BENEFIT-IN-STATE.
 18206     MOVE 'N'                    TO BEN-SEARCH-SW.
 18207
 18208     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18209         VARYING SUB3 FROM 1 BY 1 UNTIL
 18210            ((SUB3 GREATER 50) OR
 18211              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18212               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18213
 18214     IF SUB3 NOT = 51
 18215         MOVE 'Y'                TO BEN-SEARCH-SW.
 18216
 18217     GO TO 7199-EXIT.
 18218
 18219 7100-BENEFIT-DUMMY.
 18220
 18221 7100-DUMMY-EXIT.
 18222     EXIT.
 18223
 18224 7199-EXIT.
 18225     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 333
* EL050.cbl
 18227 7200-FIND-BENEFIT.
 18228     MOVE 'N'                    TO BEN-SEARCH-SW.
 18229
 18230     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18231         VARYING SUB3 FROM 1 BY 1 UNTIL
 18232            ((SUB3 GREATER 8) OR
 18233            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18234
 18235     IF SUB3 NOT = 9
 18236         MOVE 'Y'                TO BEN-SEARCH-SW.
 18237
 18238     GO TO 7200-EXIT.
 18239
 18240 7200-BENEFIT-DUMMY.
 18241
 18242 7200-DUMMY-EXIT.
 18243     EXIT.
 18244
 18245 7200-EXIT.
 18246     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 334
* EL050.cbl
 18248 7250-LOOK-FOR-RESCINDED-CLAIM.
 18249     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18250                                    W-CL-COMP-CD.
 18251     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18252                                    W-CL-CERT-NO.
 18253
 18254
 18255* EXEC CICS HANDLE CONDITION
 18256*        NOTFND  (7250-CONTINUE)
 18257*        ENDFILE (7250-CONTINUE)
 18258*    END-EXEC.
 18259*    MOVE '"$I''                  ! ) #00018017' TO DFHEIV0
 18260     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18262     MOVE X'2920233030303138303137' TO DFHEIV0(25:11)
 18263     CALL 'kxdfhei1' USING DFHEIV0
 18264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18265
 18266
 18267
 18268* EXEC CICS IGNORE CONDITION
 18269*        DUPKEY
 18270*    END-EXEC.
 18271*    MOVE '"*$                   !   #00018022' TO DFHEIV0
 18272     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18273     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18274     MOVE X'2020233030303138303232' TO DFHEIV0(25:11)
 18275     CALL 'kxdfhei1' USING DFHEIV0
 18276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18277
 18278
 18279
 18280* EXEC CICS STARTBR
 18281*        DATASET   (CLMS-ID)
 18282*        RIDFLD    (ELMSTR-KEY)
 18283*        GENERIC   EQUAL
 18284*        KEYLENGTH (ELMSTR-LENGTH)
 18285*    END-EXEC.
 18286     MOVE 0
 18287       TO DFHEIV11
 18288*    MOVE '&,   KG    E          &   #00018026' TO DFHEIV0
 18289     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18290     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18291     MOVE X'2020233030303138303236' TO DFHEIV0(25:11)
 18292     CALL 'kxdfhei1' USING DFHEIV0,
 18293           CLMS-ID,
 18294           ELMSTR-KEY,
 18295           ELMSTR-LENGTH,
 18296           DFHEIV11,
 18297           DFHEIV99
 18298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18299
 18300
 18301     MOVE 'Y'                    TO W-BROWSE-SW.
 18302
 18303 7250-NEXT-CLAIM.
 18304
 18305
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 335
* EL050.cbl
 18306* EXEC CICS READNEXT
 18307*        DATASET   (CLMS-ID)
 18308*        RIDFLD    (ELMSTR-KEY)
 18309*        SET       (ADDRESS OF CLAIM-MASTER)
 18310*    END-EXEC.
 18311     MOVE 0
 18312       TO DFHEIV11
 18313*    MOVE '&.S                   )   #00018037' TO DFHEIV0
 18314     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18315     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18316     MOVE X'2020233030303138303337' TO DFHEIV0(25:11)
 18317     CALL 'kxdfhei1' USING DFHEIV0,
 18318           CLMS-ID,
 18319           DFHEIV20,
 18320           DFHEIV99,
 18321           ELMSTR-KEY,
 18322           DFHEIV99,
 18323           DFHEIV11,
 18324           DFHEIV99,
 18325           DFHEIV99
 18326     SET ADDRESS OF CLAIM-MASTER TO
 18327         DFHEIV20
 18328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18329
 18330
 18331     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18332        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18333         GO TO 7250-CONTINUE
 18334     END-IF.
 18335
 18336     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18337        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18338        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18339        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18340        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18341         GO TO 7250-NEXT-CLAIM
 18342     END-IF.
 18343
 18344     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18345        OR (CL-CLAIM-TYPE = 'I')
 18346        OR (CL-CLAIM-TYPE = 'G')
 18347          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18348              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18349              GO TO 7250-CONTINUE
 18350          END-IF
 18351     END-IF.
 18352
 18353     GO TO 7250-NEXT-CLAIM.
 18354
 18355 7250-CONTINUE.
 18356
 18357     IF W-BROWSE-SW = 'Y'
 18358
 18359* EXEC CICS ENDBR
 18360*            DATASET   (CLMS-ID)
 18361*        END-EXEC
 18362     MOVE 0
 18363       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 336
* EL050.cbl
 18364*    MOVE '&2                    $   #00018070' TO DFHEIV0
 18365     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18366     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18367     MOVE X'2020233030303138303730' TO DFHEIV0(25:11)
 18368     CALL 'kxdfhei1' USING DFHEIV0,
 18369           CLMS-ID,
 18370           DFHEIV11,
 18371           DFHEIV99
 18372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18373         MOVE 'N' TO W-BROWSE-SW
 18374     END-IF.
 18375
 18376 7250-EXIT.
 18377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 337
* EL050.cbl
 18379 7300-CHECK-FOR-OPEN-CLMS.
 18380
 18381*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18382*    MOVE SPACES                 TO CNTL-ACCESS.
 18383*    MOVE '1'                    TO CNTL-REC-TYPE.
 18384*    MOVE +0                     TO CNTL-SEQ-NO.
 18385
 18386*    MOVE '3'                    TO RC-SW-1.
 18387*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18388
 18389*    IF NOT CF-COMPANY-MASTER
 18390*         PERFORM 0099-COMPANY-NOT-FOUND
 18391*         GO TO 7300-EXIT.
 18392
 18393     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18394                                    W-CL-COMP-CD.
 18395     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18396                                    W-CL-CERT-NO.
 18397
 18398
 18399* EXEC CICS HANDLE CONDITION
 18400*        NOTFND  (7300-CONTINUE)
 18401*        ENDFILE (7300-CONTINUE)
 18402*    END-EXEC.
 18403*    MOVE '"$I''                  ! * #00018098' TO DFHEIV0
 18404     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18406     MOVE X'2A20233030303138303938' TO DFHEIV0(25:11)
 18407     CALL 'kxdfhei1' USING DFHEIV0
 18408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18409
 18410
 18411
 18412* EXEC CICS IGNORE CONDITION
 18413*        DUPKEY
 18414*    END-EXEC.
 18415*    MOVE '"*$                   !   #00018103' TO DFHEIV0
 18416     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18418     MOVE X'2020233030303138313033' TO DFHEIV0(25:11)
 18419     CALL 'kxdfhei1' USING DFHEIV0
 18420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18421
 18422
 18423
 18424* EXEC CICS STARTBR
 18425*        DATASET   (CLMS-ID)
 18426*        RIDFLD    (ELMSTR-KEY)
 18427*        GENERIC   EQUAL
 18428*        KEYLENGTH (ELMSTR-LENGTH)
 18429*    END-EXEC.
 18430     MOVE 0
 18431       TO DFHEIV11
 18432*    MOVE '&,   KG    E          &   #00018107' TO DFHEIV0
 18433     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18434     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18435     MOVE X'2020233030303138313037' TO DFHEIV0(25:11)
 18436     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 338
* EL050.cbl
 18437           CLMS-ID,
 18438           ELMSTR-KEY,
 18439           ELMSTR-LENGTH,
 18440           DFHEIV11,
 18441           DFHEIV99
 18442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18443
 18444
 18445     MOVE 'Y'                    TO W-BROWSE-SW.
 18446
 18447 7300-NEXT-CLAIM.
 18448
 18449
 18450* EXEC CICS READNEXT
 18451*        DATASET   (CLMS-ID)
 18452*        RIDFLD    (ELMSTR-KEY)
 18453*        SET       (ADDRESS OF CLAIM-MASTER)
 18454*    END-EXEC.
 18455     MOVE 0
 18456       TO DFHEIV11
 18457*    MOVE '&.S                   )   #00018118' TO DFHEIV0
 18458     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18459     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18460     MOVE X'2020233030303138313138' TO DFHEIV0(25:11)
 18461     CALL 'kxdfhei1' USING DFHEIV0,
 18462           CLMS-ID,
 18463           DFHEIV20,
 18464           DFHEIV99,
 18465           ELMSTR-KEY,
 18466           DFHEIV99,
 18467           DFHEIV11,
 18468           DFHEIV99,
 18469           DFHEIV99
 18470     SET ADDRESS OF CLAIM-MASTER TO
 18471         DFHEIV20
 18472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18473
 18474
 18475     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18476        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18477         GO TO 7300-CONTINUE.
 18478
 18479     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18480        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18481        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18482        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18483        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18484         GO TO 7300-NEXT-CLAIM.
 18485
 18486*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18487     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18488        OR (CL-CLAIM-TYPE = 'I')
 18489        OR (CL-CLAIM-TYPE = 'G')
 18490        IF CLAIM-IS-OPEN
 18491           EVALUATE TRUE
 18492             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18493                 MOVE ER-2884      TO WS-ERROR
 18494             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 339
* EL050.cbl
 18495                 MOVE ER-2887      TO WS-ERROR
 18496             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18497                 MOVE ER-2886      TO WS-ERROR
 18498             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18499                 MOVE ER-2888      TO WS-ERROR
 18500             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18501                 MOVE ER-2885      TO WS-ERROR
 18502             WHEN OTHER
 18503                 MOVE ER-2768      TO WS-ERROR
 18504           END-EVALUATE
 18505           IF PB-C-AH-CANCEL-VOIDED OR
 18506              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18507                NOT AH-COVERAGE-CANCELLED)
 18508               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18509               MOVE ER-2768      TO WS-ERROR
 18510           END-IF
 18511           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18512           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18513              PB-FORCE-CODE NOT EQUAL '8'
 18514               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18515           END-IF
 18516           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18517           GO TO 7300-CONTINUE
 18518        ELSE
 18519           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18520*****THIS IS A RESCISSION OR REFORMATION
 18521              IF (AH-COVERAGE-CANCELLED AND
 18522                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18523                    MOVE ER-2890 TO WS-ERROR
 18524                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18525                    GO TO 7300-CONTINUE
 18526              END-IF
 18527           ELSE
 18528              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18529                 MOVE ER-2756        TO WS-ERROR
 18530                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18531                 GO TO 7300-CONTINUE
 18532              END-IF
 18533           END-IF
 18534        END-IF
 18535     ELSE
 18536*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18537        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18538           IF CLAIM-IS-OPEN
 18539              MOVE ER-2889      TO WS-ERROR
 18540              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18541              GO TO 7300-CONTINUE
 18542           ELSE
 18543              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18544*****THIS IS A RESCISSION OR REFORMATION
 18545                 IF (LF-COVERAGE-CANCELLED AND
 18546                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18547                       MOVE ER-2890 TO WS-ERROR
 18548                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18549                       GO TO 7300-CONTINUE
 18550                 END-IF
 18551              ELSE
 18552                 IF (AH-COVERAGE-CANCELLED AND
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 340
* EL050.cbl
 18553                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18554                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18555                    (LF-COVERAGE-CANCELLED AND
 18556                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18557                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18558                       MOVE ER-2965 TO WS-ERROR
 18559                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18560                       GO TO 7300-CONTINUE
 18561                 END-IF
 18562                 IF LF-COVERAGE-CANCELLED
 18563                  IF CL-TOTAL-PAID-AMT > 0
 18564                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18565                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18566                        MOVE ER-2891 TO WS-ERROR
 18567                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18568                        GO TO 7300-CONTINUE
 18569                      END-IF
 18570                    ELSE
 18571                      MOVE ER-2892 TO WS-ERROR
 18572                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18573                      GO TO 7300-CONTINUE
 18574                    END-IF
 18575                  END-IF
 18576                 END-IF
 18577              END-IF
 18578           END-IF
 18579        END-IF
 18580     END-IF
 18581
 18582     GO TO 7300-NEXT-CLAIM.
 18583
 18584 7300-CONTINUE.
 18585
 18586     IF W-BROWSE-SW = 'Y'
 18587
 18588* EXEC CICS ENDBR
 18589*            DATASET   (CLMS-ID)
 18590*        END-EXEC.
 18591     MOVE 0
 18592       TO DFHEIV11
 18593*    MOVE '&2                    $   #00018236' TO DFHEIV0
 18594     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18595     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18596     MOVE X'2020233030303138323336' TO DFHEIV0(25:11)
 18597     CALL 'kxdfhei1' USING DFHEIV0,
 18598           CLMS-ID,
 18599           DFHEIV11,
 18600           DFHEIV99
 18601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18602
 18603
 18604 7300-EXIT.
 18605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 341
* EL050.cbl
 18607
 18608 7400-GET-REMAIN-TERM.
 18609
 18610* EXEC CICS LINK
 18611*        PROGRAM    ('ELRTRM')
 18612*        COMMAREA   (CALCULATION-PASS-AREA)
 18613*        LENGTH     (CP-COMM-LENGTH)
 18614*    END-EXEC.
 18615     MOVE 'ELRTRM' TO DFHEIV1
 18616*    MOVE '."C                   ''   #00018245' TO DFHEIV0
 18617     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18618     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18619     MOVE X'2020233030303138323435' TO DFHEIV0(25:11)
 18620     CALL 'kxdfhei1' USING DFHEIV0,
 18621           DFHEIV1,
 18622           CALCULATION-PASS-AREA,
 18623           CP-COMM-LENGTH,
 18624           DFHEIV99,
 18625           DFHEIV99,
 18626           DFHEIV99
 18627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18628
 18629
 18630 7400-EXIT.
 18631     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 342
* EL050.cbl
 18633
 18634 7500-GET-REMAIN-AMOUNT.
 18635
 18636* EXEC CICS LINK
 18637*        PROGRAM    ('ELRAMT')
 18638*        COMMAREA   (CALCULATION-PASS-AREA)
 18639*        LENGTH     (CP-COMM-LENGTH)
 18640*    END-EXEC.
 18641     MOVE 'ELRAMT' TO DFHEIV1
 18642*    MOVE '."C                   ''   #00018256' TO DFHEIV0
 18643     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18644     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18645     MOVE X'2020233030303138323536' TO DFHEIV0(25:11)
 18646     CALL 'kxdfhei1' USING DFHEIV0,
 18647           DFHEIV1,
 18648           CALCULATION-PASS-AREA,
 18649           CP-COMM-LENGTH,
 18650           DFHEIV99,
 18651           DFHEIV99,
 18652           DFHEIV99
 18653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18654
 18655
 18656 7500-EXIT.
 18657     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 343
* EL050.cbl
 18659
 18660 7600-GET-REFUND.
 18661
 18662* EXEC CICS LINK
 18663*        PROGRAM    ('ELRFND')
 18664*        COMMAREA   (CALCULATION-PASS-AREA)
 18665*        LENGTH     (CP-COMM-LENGTH)
 18666*    END-EXEC.
 18667     MOVE 'ELRFND' TO DFHEIV1
 18668*    MOVE '."C                   ''   #00018267' TO DFHEIV0
 18669     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18670     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18671     MOVE X'2020233030303138323637' TO DFHEIV0(25:11)
 18672     CALL 'kxdfhei1' USING DFHEIV0,
 18673           DFHEIV1,
 18674           CALCULATION-PASS-AREA,
 18675           CP-COMM-LENGTH,
 18676           DFHEIV99,
 18677           DFHEIV99,
 18678           DFHEIV99
 18679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18680
 18681
 18682 7600-EXIT.
 18683     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 344
* EL050.cbl
 18685 7700-CALL-DL1.
 18686
 18687* EXEC CICS LINK
 18688*        PROGRAM    ('DLO001')
 18689*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18690*        LENGTH     (DLO001-COMM-LENGTH)
 18691*    END-EXEC.
 18692     MOVE 'DLO001' TO DFHEIV1
 18693*    MOVE '."C                   ''   #00018277' TO DFHEIV0
 18694     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18695     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18696     MOVE X'2020233030303138323737' TO DFHEIV0(25:11)
 18697     CALL 'kxdfhei1' USING DFHEIV0,
 18698           DFHEIV1,
 18699           WS-DLO-MASTER-POLICY-FORM,
 18700           DLO001-COMM-LENGTH,
 18701           DFHEIV99,
 18702           DFHEIV99,
 18703           DFHEIV99
 18704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18705
 18706
 18707 7700-EXIT.
 18708     EXIT.
 18709
 18710 7710-CALL-DL2.
 18711
 18712* EXEC CICS LINK
 18713*        PROGRAM    ('DLO002')
 18714*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18715*        LENGTH     (DLO002-COMM-LENGTH)
 18716*    END-EXEC.
 18717     MOVE 'DLO002' TO DFHEIV1
 18718*    MOVE '."C                   ''   #00018287' TO DFHEIV0
 18719     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18720     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18721     MOVE X'2020233030303138323837' TO DFHEIV0(25:11)
 18722     CALL 'kxdfhei1' USING DFHEIV0,
 18723           DFHEIV1,
 18724           WS-DLO-INTERNAL-POLICY-FORM,
 18725           DLO002-COMM-LENGTH,
 18726           DFHEIV99,
 18727           DFHEIV99,
 18728           DFHEIV99
 18729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18730
 18731
 18732 7710-EXIT.
 18733     EXIT.
 18734
 18735 7720-CALL-DL3.
 18736
 18737* EXEC CICS LINK
 18738*        PROGRAM    ('DLO003')
 18739*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18740*        LENGTH     (DLO003-COMM-LENGTH)
 18741*    END-EXEC.
 18742     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 345
* EL050.cbl
 18743*    MOVE '."C                   ''   #00018297' TO DFHEIV0
 18744     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18745     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18746     MOVE X'2020233030303138323937' TO DFHEIV0(25:11)
 18747     CALL 'kxdfhei1' USING DFHEIV0,
 18748           DFHEIV1,
 18749           WS-DLO-VALID-BANK-ID,
 18750           DLO003-COMM-LENGTH,
 18751           DFHEIV99,
 18752           DFHEIV99,
 18753           DFHEIV99
 18754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18755
 18756
 18757 7720-EXIT.
 18758     EXIT.
 18759
 18760 7730-CALL-DL7.
 18761
 18762* EXEC CICS LINK
 18763*        PROGRAM    ('DLO007')
 18764*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18765*        LENGTH     (DLO007-COMM-LENGTH)
 18766*    END-EXEC.
 18767     MOVE 'DLO007' TO DFHEIV1
 18768*    MOVE '."C                   ''   #00018307' TO DFHEIV0
 18769     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18771     MOVE X'2020233030303138333037' TO DFHEIV0(25:11)
 18772     CALL 'kxdfhei1' USING DFHEIV0,
 18773           DFHEIV1,
 18774           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18775           DLO007-COMM-LENGTH,
 18776           DFHEIV99,
 18777           DFHEIV99,
 18778           DFHEIV99
 18779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18780
 18781
 18782 7730-EXIT.
 18783     EXIT.
 18784
 18785 7740-CALL-DL11.
 18786
 18787* EXEC CICS LINK
 18788*        PROGRAM    ('DLO011')
 18789*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18790*        LENGTH     (DLO011-COMM-LENGTH)
 18791*    END-EXEC.
 18792     MOVE 'DLO011' TO DFHEIV1
 18793*    MOVE '."C                   ''   #00018317' TO DFHEIV0
 18794     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18795     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18796     MOVE X'2020233030303138333137' TO DFHEIV0(25:11)
 18797     CALL 'kxdfhei1' USING DFHEIV0,
 18798           DFHEIV1,
 18799           WS-DLO-PREM-RATES-BEN-TYPE,
 18800           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 346
* EL050.cbl
 18801           DFHEIV99,
 18802           DFHEIV99,
 18803           DFHEIV99
 18804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18805
 18806
 18807 7740-EXIT.
 18808     EXIT.
 18809
 18810 7750-CALL-DL17.
 18811
 18812* EXEC CICS LINK
 18813*        PROGRAM    ('DLO017')
 18814*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18815*        LENGTH     (DLO017-COMM-LENGTH)
 18816*    END-EXEC.
 18817     MOVE 'DLO017' TO DFHEIV1
 18818*    MOVE '."C                   ''   #00018327' TO DFHEIV0
 18819     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18821     MOVE X'2020233030303138333237' TO DFHEIV0(25:11)
 18822     CALL 'kxdfhei1' USING DFHEIV0,
 18823           DFHEIV1,
 18824           WS-DLO-VALID-RATE-CODE,
 18825           DLO017-COMM-LENGTH,
 18826           DFHEIV99,
 18827           DFHEIV99,
 18828           DFHEIV99
 18829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18830
 18831
 18832 7750-EXIT.
 18833     EXIT.
 18834
 18835 7755-CALL-DL19.
 18836
 18837* EXEC CICS LINK
 18838*        PROGRAM    ('DLO019')
 18839*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18840*        LENGTH     (DLO019-COMM-LENGTH)
 18841*    END-EXEC.
 18842     MOVE 'DLO019' TO DFHEIV1
 18843*    MOVE '."C                   ''   #00018337' TO DFHEIV0
 18844     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18845     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18846     MOVE X'2020233030303138333337' TO DFHEIV0(25:11)
 18847     CALL 'kxdfhei1' USING DFHEIV0,
 18848           DFHEIV1,
 18849           WS-DLO-ORIG-COV-CAT,
 18850           DLO019-COMM-LENGTH,
 18851           DFHEIV99,
 18852           DFHEIV99,
 18853           DFHEIV99
 18854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18855
 18856
 18857 7755-EXIT.
 18858     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 347
* EL050.cbl
 18859
 18860 7760-CALL-DL21.
 18861
 18862* EXEC CICS LINK
 18863*        PROGRAM    ('DLO021')
 18864*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 18865*        LENGTH     (DLO021-COMM-LENGTH)
 18866*    END-EXEC.
 18867     MOVE 'DLO021' TO DFHEIV1
 18868*    MOVE '."C                   ''   #00018347' TO DFHEIV0
 18869     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18870     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18871     MOVE X'2020233030303138333437' TO DFHEIV0(25:11)
 18872     CALL 'kxdfhei1' USING DFHEIV0,
 18873           DFHEIV1,
 18874           WS-DLO-VALID-LOAN-OFFICER,
 18875           DLO021-COMM-LENGTH,
 18876           DFHEIV99,
 18877           DFHEIV99,
 18878           DFHEIV99
 18879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18880
 18881
 18882 7760-EXIT.
 18883     EXIT.
 18884
 18885 7770-CALL-DL22.
 18886
 18887* EXEC CICS LINK
 18888*        PROGRAM    ('DLO022')
 18889*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 18890*        LENGTH     (DLO022-COMM-LENGTH)
 18891*    END-EXEC.
 18892     MOVE 'DLO022' TO DFHEIV1
 18893*    MOVE '."C                   ''   #00018357' TO DFHEIV0
 18894     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18895     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18896     MOVE X'2020233030303138333537' TO DFHEIV0(25:11)
 18897     CALL 'kxdfhei1' USING DFHEIV0,
 18898           DFHEIV1,
 18899           WS-DLO-VALID-STATE-CODE,
 18900           DLO022-COMM-LENGTH,
 18901           DFHEIV99,
 18902           DFHEIV99,
 18903           DFHEIV99
 18904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18905
 18906
 18907 7770-EXIT.
 18908     EXIT.
 18909
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 348
* EL050.cbl
 18911
 18912 7800-REWRITE-CERT.
 18913******************************************************************
 18914*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 18915*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 18916******************************************************************
 18917
 18918     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 18919        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 18920        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 18921        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 18922
 18923* EXEC CICS REWRITE
 18924*                  DATASET (CERT-ID)
 18925*                  FROM    (CERTIFICATE-MASTER)
 18926*              END-EXEC
 18927     MOVE LENGTH OF
 18928      CERTIFICATE-MASTER
 18929       TO DFHEIV11
 18930*    MOVE '&& L                  %   #00018378' TO DFHEIV0
 18931     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18932     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18933     MOVE X'2020233030303138333738' TO DFHEIV0(25:11)
 18934     CALL 'kxdfhei1' USING DFHEIV0,
 18935           CERT-ID,
 18936           CERTIFICATE-MASTER,
 18937           DFHEIV11,
 18938           DFHEIV99
 18939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18940        GO TO 7800-EXIT.
 18941
 18942       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 18943       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 18944
 18945 7800-EXIT.
 18946      EXIT.
 18947
 18948 7900-DELETE-CERT.
 18949
 18950* EXEC CICS DELETE
 18951*        DATASET (CERT-ID)
 18952*    END-EXEC.
 18953*    MOVE '&(                    &   #00018391' TO DFHEIV0
 18954     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 18955     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18956     MOVE X'2020233030303138333931' TO DFHEIV0(25:11)
 18957     CALL 'kxdfhei1' USING DFHEIV0,
 18958           CERT-ID,
 18959           DFHEIV99,
 18960           DFHEIV99,
 18961           DFHEIV99,
 18962           DFHEIV99
 18963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18964
 18965
 18966 7900-EXIT.
 18967     EXIT.
 18968
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 349
* EL050.cbl
 18969 8000-WRITE-CERT.
 18970
 18971* EXEC CICS HANDLE CONDITION
 18972*        DUPKEY    (8000-FREE-MAIN)
 18973*    END-EXEC.
 18974*    MOVE '"$$                   ! + #00018399' TO DFHEIV0
 18975     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 18976     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18977     MOVE X'2B20233030303138333939' TO DFHEIV0(25:11)
 18978     CALL 'kxdfhei1' USING DFHEIV0
 18979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18980
 18981
 18982
 18983* EXEC CICS WRITE
 18984*        DATASET     (CERT-ID)
 18985*        FROM        (CERTIFICATE-MASTER)
 18986*        RIDFLD      (ELCERT-KEY)
 18987*    END-EXEC.
 18988     MOVE LENGTH OF
 18989      CERTIFICATE-MASTER
 18990       TO DFHEIV11
 18991*    MOVE '&$ L                  ''   #00018403' TO DFHEIV0
 18992     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18993     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18994     MOVE X'2020233030303138343033' TO DFHEIV0(25:11)
 18995     CALL 'kxdfhei1' USING DFHEIV0,
 18996           CERT-ID,
 18997           CERTIFICATE-MASTER,
 18998           DFHEIV11,
 18999           ELCERT-KEY,
 19000           DFHEIV99,
 19001           DFHEIV99
 19002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19003
 19004
 19005 8000-FREE-MAIN.
 19006
 19007 8000-EXIT.
 19008      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 350
* EL050.cbl
 19010
 19011 8100-READ-ERPNDM.
 19012
 19013* EXEC CICS HANDLE CONDITION
 19014*         NOTFND     (8100-NOTFND)
 19015*         ENDFILE    (8100-NOTFND)
 19016*    END-EXEC.
 19017*    MOVE '"$I''                  ! , #00018416' TO DFHEIV0
 19018     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19019     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19020     MOVE X'2C20233030303138343136' TO DFHEIV0(25:11)
 19021     CALL 'kxdfhei1' USING DFHEIV0
 19022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19023
 19024
 19025     MOVE SPACES                 TO ERPNDM-FOUND.
 19026     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19027
 19028
 19029* EXEC CICS READ
 19030*         DATASET   (FILE-ERPNDM)
 19031*         RIDFLD    (PM-CONTROL-PRIMARY)
 19032*         INTO      (PENDING-MAILING-DATA)
 19033*    END-EXEC.
 19034     MOVE LENGTH OF
 19035      PENDING-MAILING-DATA
 19036       TO DFHEIV11
 19037*    MOVE '&"IL       E          (   #00018424' TO DFHEIV0
 19038     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19039     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19040     MOVE X'2020233030303138343234' TO DFHEIV0(25:11)
 19041     CALL 'kxdfhei1' USING DFHEIV0,
 19042           FILE-ERPNDM,
 19043           PENDING-MAILING-DATA,
 19044           DFHEIV11,
 19045           PM-CONTROL-PRIMARY,
 19046           DFHEIV99,
 19047           DFHEIV99,
 19048           DFHEIV99
 19049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19050
 19051
 19052     GO TO 8100-EXIT.
 19053
 19054 8100-NOTFND.
 19055
 19056     MOVE 'X'                    TO ERPNDM-FOUND.
 19057     MOVE ER-2694                TO WS-ERROR.
 19058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19059     MOVE ER-2883                TO WS-ERROR
 19060     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19061     .
 19062 8100-EXIT.
 19063     EXIT.
 19064
 19065 8110-READ-ERMAIL.
 19066
 19067* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 351
* EL050.cbl
 19068*         NOTFND     (8110-NOTFND)
 19069*         ENDFILE    (8110-NOTFND)
 19070*    END-EXEC.
 19071*    MOVE '"$I''                  ! - #00018444' TO DFHEIV0
 19072     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19074     MOVE X'2D20233030303138343434' TO DFHEIV0(25:11)
 19075     CALL 'kxdfhei1' USING DFHEIV0
 19076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19077
 19078
 19079     MOVE SPACES                 TO ERMAIL-FOUND.
 19080     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19081     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19082     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19083     MOVE PB-SV-STATE            TO MA-STATE.
 19084
 19085
 19086* EXEC CICS READ
 19087*         UPDATE
 19088*         DATASET   (FILE-ERMAIL)
 19089*         RIDFLD    (MA-CONTROL-PRIMARY)
 19090*         INTO      (MAILING-DATA)
 19091*    END-EXEC.
 19092     MOVE LENGTH OF
 19093      MAILING-DATA
 19094       TO DFHEIV11
 19095*    MOVE '&"IL       EU         (   #00018455' TO DFHEIV0
 19096     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19097     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19098     MOVE X'2020233030303138343535' TO DFHEIV0(25:11)
 19099     CALL 'kxdfhei1' USING DFHEIV0,
 19100           FILE-ERMAIL,
 19101           MAILING-DATA,
 19102           DFHEIV11,
 19103           MA-CONTROL-PRIMARY,
 19104           DFHEIV99,
 19105           DFHEIV99,
 19106           DFHEIV99
 19107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19108
 19109
 19110     GO TO 8110-EXIT.
 19111
 19112 8110-NOTFND.
 19113     MOVE 'X'                    TO ERMAIL-FOUND.
 19114
 19115 8110-EXIT.
 19116     EXIT.
 19117
 19118 8120-REWRITE-ERMAIL.
 19119
 19120* EXEC CICS REWRITE
 19121*         DATASET    (FILE-ERMAIL)
 19122*         FROM       (MAILING-DATA)
 19123*    END-EXEC.
 19124     MOVE LENGTH OF
 19125      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 352
* EL050.cbl
 19126       TO DFHEIV11
 19127*    MOVE '&& L                  %   #00018471' TO DFHEIV0
 19128     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19129     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19130     MOVE X'2020233030303138343731' TO DFHEIV0(25:11)
 19131     CALL 'kxdfhei1' USING DFHEIV0,
 19132           FILE-ERMAIL,
 19133           MAILING-DATA,
 19134           DFHEIV11,
 19135           DFHEIV99
 19136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19137
 19138
 19139 8120-EXIT.
 19140     EXIT.
 19141
 19142 8130-WRITE-ERMAIL.
 19143
 19144* EXEC CICS HANDLE CONDITION
 19145*         DUPKEY   (8130-EXIT)
 19146*    END-EXEC.
 19147*    MOVE '"$$                   ! . #00018480' TO DFHEIV0
 19148     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19150     MOVE X'2E20233030303138343830' TO DFHEIV0(25:11)
 19151     CALL 'kxdfhei1' USING DFHEIV0
 19152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19153
 19154
 19155
 19156* EXEC CICS WRITE
 19157*         DATASET     (FILE-ERMAIL)
 19158*         RIDFLD      (MA-CONTROL-PRIMARY)
 19159*         FROM        (MAILING-DATA)
 19160*    END-EXEC.
 19161     MOVE LENGTH OF
 19162      MAILING-DATA
 19163       TO DFHEIV11
 19164*    MOVE '&$ L                  ''   #00018484' TO DFHEIV0
 19165     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19166     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19167     MOVE X'2020233030303138343834' TO DFHEIV0(25:11)
 19168     CALL 'kxdfhei1' USING DFHEIV0,
 19169           FILE-ERMAIL,
 19170           MAILING-DATA,
 19171           DFHEIV11,
 19172           MA-CONTROL-PRIMARY,
 19173           DFHEIV99,
 19174           DFHEIV99
 19175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19176
 19177
 19178 8130-EXIT.
 19179     EXIT.
 19180
 19181 8140-UNLOCK-ERMAIL.
 19182
 19183* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 353
* EL050.cbl
 19184*         DATASET   (FILE-ERMAIL)
 19185*    END-EXEC.
 19186*    MOVE '&*                    #   #00018494' TO DFHEIV0
 19187     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19188     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19189     MOVE X'2020233030303138343934' TO DFHEIV0(25:11)
 19190     CALL 'kxdfhei1' USING DFHEIV0,
 19191           FILE-ERMAIL,
 19192           DFHEIV99
 19193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19194
 19195
 19196 8140-EXIT.
 19197     EXIT.
 19198
 19199 8180-UPDATE-VIN-NUMBER.
 19200
 19201* EXEC CICS HANDLE CONDITION
 19202*        NOTFND   (8180-NOTFND)
 19203*    END-EXEC.
 19204*    MOVE '"$I                   ! / #00018502' TO DFHEIV0
 19205     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19207     MOVE X'2F20233030303138353032' TO DFHEIV0(25:11)
 19208     CALL 'kxdfhei1' USING DFHEIV0
 19209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19210
 19211
 19212     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19213     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19214
 19215
 19216* EXEC CICS READ
 19217*        UPDATE
 19218*        DATASET  (CRTT-ID)
 19219*        RIDFLD   (WS-ELCRTT-KEY)
 19220*        INTO     (CERTIFICATE-TRAILERS)
 19221*    END-EXEC.
 19222     MOVE LENGTH OF
 19223      CERTIFICATE-TRAILERS
 19224       TO DFHEIV11
 19225*    MOVE '&"IL       EU         (   #00018509' TO DFHEIV0
 19226     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19227     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19228     MOVE X'2020233030303138353039' TO DFHEIV0(25:11)
 19229     CALL 'kxdfhei1' USING DFHEIV0,
 19230           CRTT-ID,
 19231           CERTIFICATE-TRAILERS,
 19232           DFHEIV11,
 19233           WS-ELCRTT-KEY,
 19234           DFHEIV99,
 19235           DFHEIV99,
 19236           DFHEIV99
 19237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19238
 19239
 19240     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19241         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 354
* EL050.cbl
 19242
 19243* EXEC CICS REWRITE
 19244*           DATASET  (CRTT-ID)
 19245*           FROM     (CERTIFICATE-TRAILERS)
 19246*        END-EXEC
 19247     MOVE LENGTH OF
 19248      CERTIFICATE-TRAILERS
 19249       TO DFHEIV11
 19250*    MOVE '&& L                  %   #00018518' TO DFHEIV0
 19251     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19252     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19253     MOVE X'2020233030303138353138' TO DFHEIV0(25:11)
 19254     CALL 'kxdfhei1' USING DFHEIV0,
 19255           CRTT-ID,
 19256           CERTIFICATE-TRAILERS,
 19257           DFHEIV11,
 19258           DFHEIV99
 19259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19260     ELSE
 19261
 19262* EXEC CICS UNLOCK
 19263*          DATASET  (CRTT-ID)
 19264*       END-EXEC
 19265*    MOVE '&*                    #   #00018523' TO DFHEIV0
 19266     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19267     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19268     MOVE X'2020233030303138353233' TO DFHEIV0(25:11)
 19269     CALL 'kxdfhei1' USING DFHEIV0,
 19270           CRTT-ID,
 19271           DFHEIV99
 19272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19273     END-IF.
 19274
 19275     GO TO 8180-EXIT.
 19276
 19277 8180-NOTFND.
 19278
 19279     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19280     MOVE 'CS'         TO CS-RECORD-ID.
 19281     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19282     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19283     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19284     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19285
 19286* EXEC CICS WRITE
 19287*       DATASET  (CRTT-ID)
 19288*       RIDFLD   (WS-ELCRTT-KEY)
 19289*       FROM     (CERTIFICATE-TRAILERS)
 19290*    END-EXEC.
 19291     MOVE LENGTH OF
 19292      CERTIFICATE-TRAILERS
 19293       TO DFHEIV11
 19294*    MOVE '&$ L                  ''   #00018538' TO DFHEIV0
 19295     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19296     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19297     MOVE X'2020233030303138353338' TO DFHEIV0(25:11)
 19298     CALL 'kxdfhei1' USING DFHEIV0,
 19299           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 355
* EL050.cbl
 19300           CERTIFICATE-TRAILERS,
 19301           DFHEIV11,
 19302           WS-ELCRTT-KEY,
 19303           DFHEIV99,
 19304           DFHEIV99
 19305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19306
 19307
 19308 8180-EXIT.
 19309     EXIT.
 19310
 19311 8190-UPDATE-REFUND-CLAIM-FLAG.
 19312
 19313* EXEC CICS HANDLE CONDITION
 19314*        NOTFND   (8190-NOTFND)
 19315*    END-EXEC.
 19316*    MOVE '"$I                   ! 0 #00018548' TO DFHEIV0
 19317     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19319     MOVE X'3020233030303138353438' TO DFHEIV0(25:11)
 19320     CALL 'kxdfhei1' USING DFHEIV0
 19321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19322
 19323
 19324     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19325     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19326
 19327
 19328* EXEC CICS READ
 19329*        UPDATE
 19330*        DATASET  (CRTT-ID)
 19331*        RIDFLD   (WS-ELCRTT-KEY)
 19332*        INTO     (CERTIFICATE-TRAILERS)
 19333*    END-EXEC.
 19334     MOVE LENGTH OF
 19335      CERTIFICATE-TRAILERS
 19336       TO DFHEIV11
 19337*    MOVE '&"IL       EU         (   #00018555' TO DFHEIV0
 19338     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19339     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19340     MOVE X'2020233030303138353535' TO DFHEIV0(25:11)
 19341     CALL 'kxdfhei1' USING DFHEIV0,
 19342           CRTT-ID,
 19343           CERTIFICATE-TRAILERS,
 19344           DFHEIV11,
 19345           WS-ELCRTT-KEY,
 19346           DFHEIV99,
 19347           DFHEIV99,
 19348           DFHEIV99
 19349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19350
 19351
 19352     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19353
 19354* EXEC CICS REWRITE
 19355*       DATASET  (CRTT-ID)
 19356*       FROM     (CERTIFICATE-TRAILERS)
 19357*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 356
* EL050.cbl
 19358     MOVE LENGTH OF
 19359      CERTIFICATE-TRAILERS
 19360       TO DFHEIV11
 19361*    MOVE '&& L                  %   #00018563' TO DFHEIV0
 19362     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19363     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19364     MOVE X'2020233030303138353633' TO DFHEIV0(25:11)
 19365     CALL 'kxdfhei1' USING DFHEIV0,
 19366           CRTT-ID,
 19367           CERTIFICATE-TRAILERS,
 19368           DFHEIV11,
 19369           DFHEIV99
 19370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19371
 19372
 19373     GO TO 8190-EXIT.
 19374
 19375 8190-NOTFND.
 19376
 19377     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19378     MOVE 'CS'         TO CS-RECORD-ID.
 19379     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19380     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19381     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19382     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19383
 19384* EXEC CICS WRITE
 19385*       DATASET  (CRTT-ID)
 19386*       RIDFLD   (WS-ELCRTT-KEY)
 19387*       FROM     (CERTIFICATE-TRAILERS)
 19388*    END-EXEC.
 19389     MOVE LENGTH OF
 19390      CERTIFICATE-TRAILERS
 19391       TO DFHEIV11
 19392*    MOVE '&$ L                  ''   #00018578' TO DFHEIV0
 19393     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19394     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19395     MOVE X'2020233030303138353738' TO DFHEIV0(25:11)
 19396     CALL 'kxdfhei1' USING DFHEIV0,
 19397           CRTT-ID,
 19398           CERTIFICATE-TRAILERS,
 19399           DFHEIV11,
 19400           WS-ELCRTT-KEY,
 19401           DFHEIV99,
 19402           DFHEIV99
 19403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19404
 19405
 19406 8190-EXIT.
 19407     EXIT.
 19408
 19409 8200-READ-REIN-TABLE.
 19410
 19411* EXEC CICS HANDLE CONDITION
 19412*         NOTFND   (8200-NOTFND)
 19413*    END-EXEC.
 19414*    MOVE '"$I                   ! 1 #00018588' TO DFHEIV0
 19415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 357
* EL050.cbl
 19416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19417     MOVE X'3120233030303138353838' TO DFHEIV0(25:11)
 19418     CALL 'kxdfhei1' USING DFHEIV0
 19419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19420
 19421
 19422
 19423* EXEC CICS READ
 19424*        DATASET     (REIN-ID)
 19425*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19426*        RIDFLD      (ERREIN-KEY)
 19427*    END-EXEC.
 19428*    MOVE '&"S        E          (   #00018592' TO DFHEIV0
 19429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19431     MOVE X'2020233030303138353932' TO DFHEIV0(25:11)
 19432     CALL 'kxdfhei1' USING DFHEIV0,
 19433           REIN-ID,
 19434           DFHEIV20,
 19435           DFHEIV99,
 19436           ERREIN-KEY,
 19437           DFHEIV99,
 19438           DFHEIV99,
 19439           DFHEIV99
 19440     SET ADDRESS OF REINSURANCE-RECORD TO
 19441         DFHEIV20
 19442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19443
 19444
 19445     GO TO 8200-EXIT.
 19446
 19447 8200-NOTFND.
 19448     MOVE 'N'             TO WS-REIN-READ-SW.
 19449
 19450 8200-EXIT.
 19451      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 358
* EL050.cbl
 19453
 19454 8300-READ-CTBL-TABLE.
 19455
 19456* EXEC CICS HANDLE CONDITION
 19457*        NOTFND    (8300-NOTFND)
 19458*        DISABLED  (8300-ERRESS-PROBLEM)
 19459*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19460*        ENDFILE   (8300-NOTFND)
 19461*    END-EXEC.
 19462*    MOVE '"$IcJ''                ! 2 #00018608' TO DFHEIV0
 19463     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19465     MOVE X'3220233030303138363038' TO DFHEIV0(25:11)
 19466     CALL 'kxdfhei1' USING DFHEIV0
 19467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19468
 19469
 19470
 19471* EXEC CICS READ
 19472*        DATASET     (CTBL-ID)
 19473*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19474*        RIDFLD      (ERCTBL-KEY)
 19475*    END-EXEC.
 19476*    MOVE '&"S        E          (   #00018615' TO DFHEIV0
 19477     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19479     MOVE X'2020233030303138363135' TO DFHEIV0(25:11)
 19480     CALL 'kxdfhei1' USING DFHEIV0,
 19481           CTBL-ID,
 19482           DFHEIV20,
 19483           DFHEIV99,
 19484           ERCTBL-KEY,
 19485           DFHEIV99,
 19486           DFHEIV99,
 19487           DFHEIV99
 19488     SET ADDRESS OF COMM-TABLE-RECORD TO
 19489         DFHEIV20
 19490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19491
 19492
 19493     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19494
 19495     GO TO 8300-EXIT.
 19496
 19497 8300-NOTFND.
 19498
 19499     IF CTBL-SW = '0530'
 19500         MOVE 'AA'                     TO WS-AH-COMP-CD
 19501         MOVE '0550'                   TO CTBL-SW
 19502         MOVE '1'                      TO WS-CTBL-READ-SW
 19503         GO TO 8300-EXIT.
 19504
 19505     IF CTBL-SW = '0540'
 19506         MOVE 'AA'                     TO WS-LF-COMP-CD
 19507         MOVE '0550'                   TO CTBL-SW
 19508         MOVE '1'                      TO WS-CTBL-READ-SW
 19509         GO TO 8300-EXIT.
 19510
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 359
* EL050.cbl
 19511     IF CTBL-SW = '0550'
 19512         MOVE '2'                      TO WS-CTBL-READ-SW
 19513         GO TO 8300-EXIT.
 19514
 19515     GO TO 8300-EXIT.
 19516
 19517 8300-ERRESS-PROBLEM.
 19518
 19519      MOVE ER-8050              TO WS-ERROR.
 19520      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19521
 19522     GO TO 8300-EXIT.
 19523
 19524 8300-EXIT.
 19525      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 360
* EL050.cbl
 19527
 19528
 19529 8400-GETMAIN-ERFORM.
 19530
 19531
 19532* EXEC CICS   GETMAIN
 19533*        LENGTH  (500)
 19534*        SET     (ADDRESS OF FORM-MASTER)
 19535*    END-EXEC.
 19536     MOVE 500
 19537       TO DFHEIV11
 19538*    MOVE '," L                  $   #00018659' TO DFHEIV0
 19539     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19540     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19541     MOVE X'2020233030303138363539' TO DFHEIV0(25:11)
 19542     CALL 'kxdfhei1' USING DFHEIV0,
 19543           DFHEIV20,
 19544           DFHEIV11,
 19545           DFHEIV99
 19546     SET ADDRESS OF FORM-MASTER TO
 19547         DFHEIV20
 19548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19549
 19550
 19551     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19552
 19553 8400-EXIT.
 19554      EXIT.
 19555
 19556 8450-READ-FORM-MASTER.
 19557
 19558
 19559* EXEC CICS  HANDLE CONDITION
 19560*        NOTFND   (8450-FORM-NOT-FOUND)
 19561*        ENDFILE  (8450-FORM-NOT-FOUND)
 19562*    END-EXEC.
 19563*    MOVE '"$I''                  ! 3 #00018671' TO DFHEIV0
 19564     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19566     MOVE X'3320233030303138363731' TO DFHEIV0(25:11)
 19567     CALL 'kxdfhei1' USING DFHEIV0
 19568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19569
 19570
 19571
 19572* EXEC CICS   READ
 19573*        DATASET   (FORM-ID)
 19574*        RIDFLD    (ERFORM-KEY)
 19575*        INTO      (FORM-MASTER)
 19576*        GTEQ
 19577*    END-EXEC.
 19578     MOVE LENGTH OF
 19579      FORM-MASTER
 19580       TO DFHEIV11
 19581*    MOVE '&"IL       G          (   #00018676' TO DFHEIV0
 19582     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19583     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19584     MOVE X'2020233030303138363736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 361
* EL050.cbl
 19585     CALL 'kxdfhei1' USING DFHEIV0,
 19586           FORM-ID,
 19587           FORM-MASTER,
 19588           DFHEIV11,
 19589           ERFORM-KEY,
 19590           DFHEIV99,
 19591           DFHEIV99,
 19592           DFHEIV99
 19593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19594
 19595
 19596     MOVE  'Y'           TO  FORM-MASTER-SW.
 19597
 19598     GO TO  8450-EXIT.
 19599
 19600 8450-FORM-NOT-FOUND.
 19601
 19602     MOVE  'N'           TO  FORM-MASTER-SW.
 19603
 19604 8450-EXIT.
 19605      EXIT.
 19606
 19607 8500-DATE-CONVERT.
 19608
 19609* EXEC CICS LINK
 19610*        PROGRAM    ('ELDATCV')
 19611*        COMMAREA   (DATE-CONVERSION-DATA)
 19612*        LENGTH     (DC-COMM-LENGTH)
 19613*    END-EXEC.
 19614     MOVE 'ELDATCV' TO DFHEIV1
 19615*    MOVE '."C                   ''   #00018695' TO DFHEIV0
 19616     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19617     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19618     MOVE X'2020233030303138363935' TO DFHEIV0(25:11)
 19619     CALL 'kxdfhei1' USING DFHEIV0,
 19620           DFHEIV1,
 19621           DATE-CONVERSION-DATA,
 19622           DC-COMM-LENGTH,
 19623           DFHEIV99,
 19624           DFHEIV99,
 19625           DFHEIV99
 19626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19627
 19628
 19629 8500-EXIT.
 19630     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 362
* EL050.cbl
 19632
 19633 8555-RELOAD-CONTROL-FILE.
 19634     CONTINUE.
 19635
 19636 8555-EXIT.
 19637     EXIT.
 19638
 19639 8557-GETMAIN-ERPLAN.
 19640
 19641
 19642* EXEC CICS GETMAIN
 19643*        LENGTH    (840)
 19644*        SET       (ADDRESS OF PLAN-RECORDS)
 19645*    END-EXEC.
 19646     MOVE 840
 19647       TO DFHEIV11
 19648*    MOVE '," L                  $   #00018713' TO DFHEIV0
 19649     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19650     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19651     MOVE X'2020233030303138373133' TO DFHEIV0(25:11)
 19652     CALL 'kxdfhei1' USING DFHEIV0,
 19653           DFHEIV20,
 19654           DFHEIV11,
 19655           DFHEIV99
 19656     SET ADDRESS OF PLAN-RECORDS TO
 19657         DFHEIV20
 19658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19659
 19660
 19661     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19662
 19663 8557-EXIT.
 19664     EXIT.
 19665
 19666 8560-GETMAIN.
 19667
 19668* EXEC CICS GETMAIN
 19669*        LENGTH    (2000)
 19670*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19671*    END-EXEC.
 19672     MOVE 2000
 19673       TO DFHEIV11
 19674*    MOVE '," L                  $   #00018724' TO DFHEIV0
 19675     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19676     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19677     MOVE X'2020233030303138373234' TO DFHEIV0(25:11)
 19678     CALL 'kxdfhei1' USING DFHEIV0,
 19679           DFHEIV20,
 19680           DFHEIV11,
 19681           DFHEIV99
 19682     SET ADDRESS OF ACCOUNT-MASTER TO
 19683         DFHEIV20
 19684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19685
 19686
 19687     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19688
 19689 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 363
* EL050.cbl
 19690     EXIT.
 19691
 19692 8570-START-ACCOUNT-MASTER.
 19693
 19694* EXEC CICS HANDLE CONDITION
 19695*        NOTFND    (0199-ACCT-NOT-FOUND)
 19696*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19697*    END-EXEC.
 19698*    MOVE '"$I''                  ! 4 #00018735' TO DFHEIV0
 19699     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19701     MOVE X'3420233030303138373335' TO DFHEIV0(25:11)
 19702     CALL 'kxdfhei1' USING DFHEIV0
 19703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19704
 19705
 19706
 19707* EXEC CICS STARTBR
 19708*        DATASET    (ACCT-ID)
 19709*        RIDFLD     (ERACCT-KEY)
 19710*        GTEQ
 19711*    END-EXEC.
 19712     MOVE 0
 19713       TO DFHEIV11
 19714*    MOVE '&,         G          &   #00018740' TO DFHEIV0
 19715     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19716     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19717     MOVE X'2020233030303138373430' TO DFHEIV0(25:11)
 19718     CALL 'kxdfhei1' USING DFHEIV0,
 19719           ACCT-ID,
 19720           ERACCT-KEY,
 19721           DFHEIV99,
 19722           DFHEIV11,
 19723           DFHEIV99
 19724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19725
 19726
 19727 8570-EXIT.
 19728     EXIT.
 19729
 19730 8580-READ-ACCOUNT-MASTER.
 19731
 19732* EXEC CICS HANDLE CONDITION
 19733*        NOTFND    (0199-ACCT-NOT-FOUND)
 19734*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19735*    END-EXEC.
 19736*    MOVE '"$I''                  ! 5 #00018750' TO DFHEIV0
 19737     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19738     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19739     MOVE X'3520233030303138373530' TO DFHEIV0(25:11)
 19740     CALL 'kxdfhei1' USING DFHEIV0
 19741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19742
 19743
 19744
 19745* EXEC CICS READNEXT
 19746*        DATASET     (ACCT-ID)
 19747*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 364
* EL050.cbl
 19748*        RIDFLD      (ERACCT-KEY)
 19749*    END-EXEC.
 19750     MOVE LENGTH OF
 19751      ACCOUNT-MASTER
 19752       TO DFHEIV12
 19753     MOVE 0
 19754       TO DFHEIV11
 19755*    MOVE '&.IL                  )   #00018755' TO DFHEIV0
 19756     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19757     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19758     MOVE X'2020233030303138373535' TO DFHEIV0(25:11)
 19759     CALL 'kxdfhei1' USING DFHEIV0,
 19760           ACCT-ID,
 19761           ACCOUNT-MASTER,
 19762           DFHEIV12,
 19763           ERACCT-KEY,
 19764           DFHEIV99,
 19765           DFHEIV11,
 19766           DFHEIV99,
 19767           DFHEIV99
 19768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19769
 19770
 19771 8580-EXIT.
 19772     EXIT.
 19773
 19774 8582-READ-COMPENSATION-MASTER.
 19775
 19776* EXEC CICS HANDLE CONDITION
 19777*        NOTFND    (8582-COMP-NOT-FOUND)
 19778*        ENDFILE   (8582-COMP-NOT-FOUND)
 19779*    END-EXEC.
 19780*    MOVE '"$I''                  ! 6 #00018765' TO DFHEIV0
 19781     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19783     MOVE X'3620233030303138373635' TO DFHEIV0(25:11)
 19784     CALL 'kxdfhei1' USING DFHEIV0
 19785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19786
 19787
 19788
 19789* EXEC CICS READ
 19790*        DATASET     (COMP-ID)
 19791*        INTO        (COMPENSATION-MASTER)
 19792*        RIDFLD      (ERCOMP-KEY)
 19793*    END-EXEC.
 19794     MOVE LENGTH OF
 19795      COMPENSATION-MASTER
 19796       TO DFHEIV11
 19797*    MOVE '&"IL       E          (   #00018770' TO DFHEIV0
 19798     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19800     MOVE X'2020233030303138373730' TO DFHEIV0(25:11)
 19801     CALL 'kxdfhei1' USING DFHEIV0,
 19802           COMP-ID,
 19803           COMPENSATION-MASTER,
 19804           DFHEIV11,
 19805           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 365
* EL050.cbl
 19806           DFHEIV99,
 19807           DFHEIV99,
 19808           DFHEIV99
 19809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19810
 19811
 19812     MOVE 'Y'                    TO COMP-MASTER-SW
 19813
 19814     GO TO 8582-EXIT
 19815     .
 19816 8582-COMP-NOT-FOUND.
 19817
 19818     MOVE 'N'                    TO COMP-MASTER-SW.
 19819
 19820 8582-EXIT.
 19821     EXIT.
 19822
 19823 8583-READ-ERAGTC.
 19824
 19825* EXEC CICS HANDLE CONDITION
 19826*        NOTFND    (8583-AGTC-NOT-FOUND)
 19827*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19828*    END-EXEC.
 19829*    MOVE '"$I''                  ! 7 #00018788' TO DFHEIV0
 19830     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19832     MOVE X'3720233030303138373838' TO DFHEIV0(25:11)
 19833     CALL 'kxdfhei1' USING DFHEIV0
 19834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19835
 19836
 19837
 19838* EXEC CICS STARTBR
 19839*        DATASET    (AGTC-ID)
 19840*        RIDFLD     (ERAGTC-KEY)
 19841*        GTEQ
 19842*    END-EXEC.
 19843     MOVE 0
 19844       TO DFHEIV11
 19845*    MOVE '&,         G          &   #00018793' TO DFHEIV0
 19846     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19847     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19848     MOVE X'2020233030303138373933' TO DFHEIV0(25:11)
 19849     CALL 'kxdfhei1' USING DFHEIV0,
 19850           AGTC-ID,
 19851           ERAGTC-KEY,
 19852           DFHEIV99,
 19853           DFHEIV11,
 19854           DFHEIV99
 19855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19856
 19857
 19858 8583-READ-ERAGTC-NEXT.
 19859
 19860* EXEC CICS READNEXT
 19861*        DATASET     (AGTC-ID)
 19862*        INTO        (AGENT-COMMISSIONS)
 19863*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 366
* EL050.cbl
 19864*    END-EXEC.
 19865     MOVE LENGTH OF
 19866      AGENT-COMMISSIONS
 19867       TO DFHEIV12
 19868     MOVE 0
 19869       TO DFHEIV11
 19870*    MOVE '&.IL                  )   #00018800' TO DFHEIV0
 19871     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19872     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19873     MOVE X'2020233030303138383030' TO DFHEIV0(25:11)
 19874     CALL 'kxdfhei1' USING DFHEIV0,
 19875           AGTC-ID,
 19876           AGENT-COMMISSIONS,
 19877           DFHEIV12,
 19878           ERAGTC-KEY,
 19879           DFHEIV99,
 19880           DFHEIV11,
 19881           DFHEIV99,
 19882           DFHEIV99
 19883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19884
 19885
 19886*    MOVE 'Y'                    TO AGTC-MASTER-SW
 19887
 19888     GO TO 8583-EXIT
 19889     .
 19890 8583-AGTC-NOT-FOUND.
 19891
 19892     MOVE 'N'                    TO AGTC-MASTER-SW.
 19893
 19894 8583-EXIT.
 19895     EXIT.
 19896
 19897 8584-READ-BANK-CROSS-REF.
 19898
 19899* EXEC CICS HANDLE CONDITION
 19900*        NOTFND    (8584-BXRF-NOT-FOUND)
 19901*        ENDFILE   (8584-BXRF-NOT-FOUND)
 19902*    END-EXEC.
 19903*    MOVE '"$I''                  ! 8 #00018818' TO DFHEIV0
 19904     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19906     MOVE X'3820233030303138383138' TO DFHEIV0(25:11)
 19907     CALL 'kxdfhei1' USING DFHEIV0
 19908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19909
 19910
 19911
 19912* EXEC CICS READ
 19913*        DATASET     (BXRF-ID)
 19914*        INTO        (BANK-CROSS-REFERENCE)
 19915*        RIDFLD      (ERBXRF-KEY)
 19916*        LENGTH      (BXRF-REC-LENGTH)
 19917*    END-EXEC.
 19918*    MOVE '&"IL       E          (   #00018823' TO DFHEIV0
 19919     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19920     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19921     MOVE X'2020233030303138383233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 367
* EL050.cbl
 19922     CALL 'kxdfhei1' USING DFHEIV0,
 19923           BXRF-ID,
 19924           BANK-CROSS-REFERENCE,
 19925           BXRF-REC-LENGTH,
 19926           ERBXRF-KEY,
 19927           DFHEIV99,
 19928           DFHEIV99,
 19929           DFHEIV99
 19930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19931
 19932
 19933     MOVE 'Y'                    TO BXRF-MASTER-SW
 19934
 19935     GO TO 8584-EXIT
 19936     .
 19937 8584-BXRF-NOT-FOUND.
 19938
 19939     MOVE 'N'                    TO BXRF-MASTER-SW.
 19940
 19941 8584-EXIT.
 19942     EXIT.
 19943
 19944 8585-READ-PLAN-MASTER.
 19945
 19946
 19947* EXEC CICS HANDLE CONDITION
 19948*        NOTFND    (8585-PLAN-NOT-FOUND)
 19949*        ENDFILE   (8585-PLAN-NOT-FOUND)
 19950*    END-EXEC.
 19951*    MOVE '"$I''                  ! 9 #00018843' TO DFHEIV0
 19952     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19954     MOVE X'3920233030303138383433' TO DFHEIV0(25:11)
 19955     CALL 'kxdfhei1' USING DFHEIV0
 19956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19957
 19958
 19959
 19960* EXEC CICS READ
 19961*        DATASET     (PLAN-ID)
 19962*        INTO        (PLAN-MASTER)
 19963*        RIDFLD      (ERPLAN-KEY)
 19964*    END-EXEC.
 19965     MOVE LENGTH OF
 19966      PLAN-MASTER
 19967       TO DFHEIV11
 19968*    MOVE '&"IL       E          (   #00018848' TO DFHEIV0
 19969     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19970     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19971     MOVE X'2020233030303138383438' TO DFHEIV0(25:11)
 19972     CALL 'kxdfhei1' USING DFHEIV0,
 19973           PLAN-ID,
 19974           PLAN-MASTER,
 19975           DFHEIV11,
 19976           ERPLAN-KEY,
 19977           DFHEIV99,
 19978           DFHEIV99,
 19979           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 368
* EL050.cbl
 19980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19981
 19982
 19983     MOVE 'Y'                    TO PLAN-MASTER-SW.
 19984
 19985     GO TO 8585-EXIT.
 19986
 19987 8585-PLAN-NOT-FOUND.
 19988
 19989     MOVE 'N'                    TO PLAN-MASTER-SW.
 19990
 19991 8585-EXIT.
 19992     EXIT.
 19993
 19994 8586-READ-LOAN-OFFICER.
 19995
 19996* EXEC CICS READ
 19997*        DATASET     (LOFC-ID)
 19998*        INTO        (LOAN-OFFICER-MASTER)
 19999*        RIDFLD      (ERLOFC-KEY)
 20000*        RESP        (WS-RESPONSE)
 20001*    END-EXEC
 20002     MOVE LENGTH OF
 20003      LOAN-OFFICER-MASTER
 20004       TO DFHEIV11
 20005*    MOVE '&"IL       E          (  N#00018866' TO DFHEIV0
 20006     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20008     MOVE X'204E233030303138383636' TO DFHEIV0(25:11)
 20009     CALL 'kxdfhei1' USING DFHEIV0,
 20010           LOFC-ID,
 20011           LOAN-OFFICER-MASTER,
 20012           DFHEIV11,
 20013           ERLOFC-KEY,
 20014           DFHEIV99,
 20015           DFHEIV99,
 20016           DFHEIV99
 20017     MOVE EIBRESP  TO WS-RESPONSE
 20018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20019
 20020     IF WS-RESP-NORMAL
 20021        MOVE 'Y'                 TO LOFC-MASTER-SW
 20022     ELSE
 20023        MOVE 'N'                 TO LOFC-MASTER-SW
 20024     END-IF
 20025     .
 20026 8586-EXIT.
 20027     EXIT.
 20028 8587-START-ERPDEF.
 20029
 20030* EXEC CICS STARTBR
 20031*       DATASET   (PDEF-ID)
 20032*       RIDFLD    (ERPDEF-KEY)
 20033*       GTEQ
 20034*       RESP      (WS-RESPONSE)
 20035*    END-EXEC
 20036     MOVE 0
 20037       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 369
* EL050.cbl
 20038*    MOVE '&,         G          &  N#00018882' TO DFHEIV0
 20039     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20040     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20041     MOVE X'204E233030303138383832' TO DFHEIV0(25:11)
 20042     CALL 'kxdfhei1' USING DFHEIV0,
 20043           PDEF-ID,
 20044           ERPDEF-KEY,
 20045           DFHEIV99,
 20046           DFHEIV11,
 20047           DFHEIV99
 20048     MOVE EIBRESP  TO WS-RESPONSE
 20049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20050     IF WS-RESP-NORMAL
 20051        MOVE 'Y'                 TO PDEF-MASTER-SW
 20052     ELSE
 20053        MOVE 'N'                 TO PDEF-MASTER-SW
 20054     END-IF
 20055     .
 20056 8587-EXIT.
 20057     EXIT.
 20058 8588-READ-ERPDEF.
 20059
 20060* EXEC CICS READNEXT
 20061*       DATASET   (PDEF-ID)
 20062*       RIDFLD    (ERPDEF-KEY)
 20063*       INTO      (PRODUCT-MASTER)
 20064*       RESP      (WS-RESPONSE)
 20065*    END-EXEC
 20066     MOVE LENGTH OF
 20067      PRODUCT-MASTER
 20068       TO DFHEIV12
 20069     MOVE 0
 20070       TO DFHEIV11
 20071*    MOVE '&.IL                  )  N#00018897' TO DFHEIV0
 20072     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20073     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20074     MOVE X'204E233030303138383937' TO DFHEIV0(25:11)
 20075     CALL 'kxdfhei1' USING DFHEIV0,
 20076           PDEF-ID,
 20077           PRODUCT-MASTER,
 20078           DFHEIV12,
 20079           ERPDEF-KEY,
 20080           DFHEIV99,
 20081           DFHEIV11,
 20082           DFHEIV99,
 20083           DFHEIV99
 20084     MOVE EIBRESP  TO WS-RESPONSE
 20085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20086     IF WS-RESP-NORMAL
 20087        MOVE 'Y'                 TO PDEF-MASTER-SW
 20088     ELSE
 20089        MOVE 'N'                 TO PDEF-MASTER-SW
 20090     END-IF
 20091     .
 20092 8588-EXIT.
 20093     EXIT.
 20094 8589-ENDBR-ERPDEF.
 20095
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 370
* EL050.cbl
 20096* EXEC CICS ENDBR
 20097*       DATASET   (PDEF-ID)
 20098*    END-EXEC
 20099     MOVE 0
 20100       TO DFHEIV11
 20101*    MOVE '&2                    $   #00018912' TO DFHEIV0
 20102     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20103     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20104     MOVE X'2020233030303138393132' TO DFHEIV0(25:11)
 20105     CALL 'kxdfhei1' USING DFHEIV0,
 20106           PDEF-ID,
 20107           DFHEIV11,
 20108           DFHEIV99
 20109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20110     .
 20111 8589-EXIT.
 20112     EXIT.
 20113 8590-READ-CERT-MASTER.
 20114     IF PB-COMPANY-ID = 'UCL'
 20115         GO TO 8690-READ-CERT-MASTER-UCL.
 20116
 20117
 20118* EXEC CICS HANDLE CONDITION
 20119*         NOTFND    (0299-CERT-NOT-FOUND)
 20120*    END-EXEC.
 20121*    MOVE '"$I                   ! : #00018922' TO DFHEIV0
 20122     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20124     MOVE X'3A20233030303138393232' TO DFHEIV0(25:11)
 20125     CALL 'kxdfhei1' USING DFHEIV0
 20126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20127
 20128
 20129
 20130* EXEC CICS READ
 20131*        DATASET     (CERT-ID)
 20132*        INTO        (CERTIFICATE-MASTER)
 20133*        RIDFLD      (ELCERT-KEY)
 20134*        UPDATE
 20135*    END-EXEC.
 20136     MOVE LENGTH OF
 20137      CERTIFICATE-MASTER
 20138       TO DFHEIV11
 20139*    MOVE '&"IL       EU         (   #00018926' TO DFHEIV0
 20140     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20141     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20142     MOVE X'2020233030303138393236' TO DFHEIV0(25:11)
 20143     CALL 'kxdfhei1' USING DFHEIV0,
 20144           CERT-ID,
 20145           CERTIFICATE-MASTER,
 20146           DFHEIV11,
 20147           ELCERT-KEY,
 20148           DFHEIV99,
 20149           DFHEIV99,
 20150           DFHEIV99
 20151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20152
 20153
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 371
* EL050.cbl
 20154 8590-EXIT.
 20155     EXIT.
 20156
 20157 8690-READ-CERT-MASTER-UCL.
 20158
 20159* EXEC CICS HANDLE CONDITION
 20160*         NOTFND    (8700-READ-CERT-MASTER)
 20161*    END-EXEC.
 20162*    MOVE '"$I                   ! ; #00018937' TO DFHEIV0
 20163     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20165     MOVE X'3B20233030303138393337' TO DFHEIV0(25:11)
 20166     CALL 'kxdfhei1' USING DFHEIV0
 20167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20168
 20169
 20170 8690-READ-CERT-CONT.
 20171
 20172* EXEC CICS READ
 20173*        DATASET     (CERT-ID)
 20174*        INTO        (CERTIFICATE-MASTER)
 20175*        RIDFLD      (ELCERT-KEY)
 20176*        UPDATE
 20177*    END-EXEC.
 20178     MOVE LENGTH OF
 20179      CERTIFICATE-MASTER
 20180       TO DFHEIV11
 20181*    MOVE '&"IL       EU         (   #00018942' TO DFHEIV0
 20182     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20183     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20184     MOVE X'2020233030303138393432' TO DFHEIV0(25:11)
 20185     CALL 'kxdfhei1' USING DFHEIV0,
 20186           CERT-ID,
 20187           CERTIFICATE-MASTER,
 20188           DFHEIV11,
 20189           ELCERT-KEY,
 20190           DFHEIV99,
 20191           DFHEIV99,
 20192           DFHEIV99
 20193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20194
 20195
 20196     GO TO 8590-EXIT.
 20197
 20198 8700-READ-CERT-MASTER.
 20199     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20200     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20201
 20202* EXEC CICS HANDLE CONDITION
 20203*         DUPKEY    (8720-COMP-ACCOUNTS)
 20204*         ENDFILE   (8730-END-BROWSE)
 20205*         NOTFND    (8740-NOT-FOUND)
 20206*    END-EXEC.
 20207*    MOVE '"$$''I                 ! < #00018954' TO DFHEIV0
 20208     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20209     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20210     MOVE X'3C20233030303138393534' TO DFHEIV0(25:11)
 20211     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 372
* EL050.cbl
 20212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20213
 20214
 20215
 20216* EXEC CICS STARTBR
 20217*        DATASET     ('ELCERT5')
 20218*        RIDFLD      (ELCERT2-KEY)
 20219*        EQUAL
 20220*    END-EXEC.
 20221     MOVE 'ELCERT5' TO DFHEIV1
 20222     MOVE 0
 20223       TO DFHEIV11
 20224*    MOVE '&,         E          &   #00018960' TO DFHEIV0
 20225     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20226     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20227     MOVE X'2020233030303138393630' TO DFHEIV0(25:11)
 20228     CALL 'kxdfhei1' USING DFHEIV0,
 20229           DFHEIV1,
 20230           ELCERT2-KEY,
 20231           DFHEIV99,
 20232           DFHEIV11,
 20233           DFHEIV99
 20234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20235
 20236
 20237 8710-READ-NEXT.
 20238
 20239* EXEC CICS READNEXT
 20240*        DATASET     ('ELCERT5')
 20241*        INTO        (CERTIFICATE-MASTER)
 20242*        RIDFLD      (ELCERT2-KEY)
 20243*    END-EXEC.
 20244     MOVE LENGTH OF
 20245      CERTIFICATE-MASTER
 20246       TO DFHEIV12
 20247     MOVE 'ELCERT5' TO DFHEIV1
 20248     MOVE 0
 20249       TO DFHEIV11
 20250*    MOVE '&.IL                  )   #00018967' TO DFHEIV0
 20251     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20252     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20253     MOVE X'2020233030303138393637' TO DFHEIV0(25:11)
 20254     CALL 'kxdfhei1' USING DFHEIV0,
 20255           DFHEIV1,
 20256           CERTIFICATE-MASTER,
 20257           DFHEIV12,
 20258           ELCERT2-KEY,
 20259           DFHEIV99,
 20260           DFHEIV11,
 20261           DFHEIV99,
 20262           DFHEIV99
 20263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20264
 20265
 20266 8720-COMP-ACCOUNTS.
 20267
 20268* EXEC CICS ENTER
 20269*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 373
* EL050.cbl
 20270*         FROM (PB-C-LAST-NAME)
 20271*    END-EXEC.
 20272     MOVE 001
 20273       TO DFHEIV11
 20274*    MOVE ':$F                   %   #00018974' TO DFHEIV0
 20275     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20276     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20277     MOVE X'2020233030303138393734' TO DFHEIV0(25:11)
 20278     CALL 'kxdfhei1' USING DFHEIV0,
 20279           DFHEIV11,
 20280           PB-C-LAST-NAME,
 20281           DFHEIV99,
 20282           DFHEIV99
 20283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20284
 20285
 20286
 20287* EXEC CICS ENTER
 20288*         TRACEID (002)
 20289*         FROM (CM-INSURED-LAST-NAME)
 20290*    END-EXEC.
 20291     MOVE 002
 20292       TO DFHEIV11
 20293*    MOVE ':$F                   %   #00018979' TO DFHEIV0
 20294     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20295     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20296     MOVE X'2020233030303138393739' TO DFHEIV0(25:11)
 20297     CALL 'kxdfhei1' USING DFHEIV0,
 20298           DFHEIV11,
 20299           CM-INSURED-LAST-NAME,
 20300           DFHEIV99,
 20301           DFHEIV99
 20302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20303
 20304
 20305     IF PB-CERT-NO NOT = CM-CERT-NO
 20306         GO TO 8730-END-BROWSE.
 20307
 20308     IF PB-ACCOUNT = CM-ACCOUNT
 20309         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20310             MOVE ER-2799        TO WS-ERROR
 20311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20312             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20313             GO TO 8730-END-BROWSE.
 20314
 20315     GO TO 8710-READ-NEXT.
 20316
 20317 8730-END-BROWSE.
 20318
 20319* EXEC CICS ENDBR
 20320*         DATASET    ('ELCERT5')
 20321*    END-EXEC.
 20322     MOVE 'ELCERT5' TO DFHEIV1
 20323     MOVE 0
 20324       TO DFHEIV11
 20325*    MOVE '&2                    $   #00018997' TO DFHEIV0
 20326     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 374
* EL050.cbl
 20328     MOVE X'2020233030303138393937' TO DFHEIV0(25:11)
 20329     CALL 'kxdfhei1' USING DFHEIV0,
 20330           DFHEIV1,
 20331           DFHEIV11,
 20332           DFHEIV99
 20333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20334
 20335
 20336 8740-NOT-FOUND.
 20337     GO TO 0299-CERT-NOT-FOUND.
 20338
 20339 8750-START-ELSTAT.
 20340
 20341* EXEC CICS STARTBR
 20342*       DATASET   (STAT-ID)
 20343*       RIDFLD    (ELSTAT-KEY)
 20344*       GTEQ
 20345*       RESP      (WS-RESPONSE)
 20346*    END-EXEC
 20347     MOVE 0
 20348       TO DFHEIV11
 20349*    MOVE '&,         G          &  N#00019005' TO DFHEIV0
 20350     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20351     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20352     MOVE X'204E233030303139303035' TO DFHEIV0(25:11)
 20353     CALL 'kxdfhei1' USING DFHEIV0,
 20354           STAT-ID,
 20355           ELSTAT-KEY,
 20356           DFHEIV99,
 20357           DFHEIV11,
 20358           DFHEIV99
 20359     MOVE EIBRESP  TO WS-RESPONSE
 20360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20361     IF WS-RESP-NORMAL
 20362        MOVE 'Y'                 TO STAT-MASTER-SW
 20363     ELSE
 20364        MOVE 'N'                 TO STAT-MASTER-SW
 20365     END-IF
 20366     .
 20367 8750-EXIT.
 20368     EXIT.
 20369 8752-READ-ELSTAT.
 20370
 20371* EXEC CICS READNEXT
 20372*       DATASET   (STAT-ID)
 20373*       RIDFLD    (ELSTAT-KEY)
 20374*       INTO      (STATE-FILE)
 20375*       RESP      (WS-RESPONSE)
 20376*    END-EXEC
 20377     MOVE LENGTH OF
 20378      STATE-FILE
 20379       TO DFHEIV12
 20380     MOVE 0
 20381       TO DFHEIV11
 20382*    MOVE '&.IL                  )  N#00019020' TO DFHEIV0
 20383     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20384     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20385     MOVE X'204E233030303139303230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 375
* EL050.cbl
 20386     CALL 'kxdfhei1' USING DFHEIV0,
 20387           STAT-ID,
 20388           STATE-FILE,
 20389           DFHEIV12,
 20390           ELSTAT-KEY,
 20391           DFHEIV99,
 20392           DFHEIV11,
 20393           DFHEIV99,
 20394           DFHEIV99
 20395     MOVE EIBRESP  TO WS-RESPONSE
 20396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20397     IF WS-RESP-NORMAL
 20398        MOVE 'Y'                 TO STAT-MASTER-SW
 20399     ELSE
 20400        MOVE 'N'                 TO STAT-MASTER-SW
 20401     END-IF
 20402     .
 20403 8752-EXIT.
 20404     EXIT.
 20405 8800-GET-COMP-RATE.
 20406     MOVE +1 TO IB.
 20407     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20408         ADD +9 TO IB
 20409         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20410             ADD +9 TO IB
 20411             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20412                MOVE ZEROS       TO WS-WK-RATE
 20413                GO TO 8800-EXIT.
 20414
 20415     IF PB-I-AGE GREATER CT-AGE (1)
 20416         ADD +3 TO IB
 20417         IF PB-I-AGE GREATER CT-AGE (2)
 20418             ADD +3 TO IB
 20419             IF PB-I-AGE GREATER CT-AGE (3)
 20420                MOVE ZEROS       TO WS-WK-RATE
 20421                GO TO 8800-EXIT.
 20422
 20423     IF WS-WORK-TERM GREATER CT-TRM (1)
 20424         ADD +1 TO IB
 20425         IF WS-WORK-TERM GREATER CT-TRM (2)
 20426             ADD +1 TO IB
 20427             IF WS-WORK-TERM GREATER CT-TRM (3)
 20428                MOVE ZEROS       TO WS-WK-RATE
 20429                GO TO 8800-EXIT.
 20430
 20431     IF CT-RT (IB) NOT NUMERIC
 20432         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20433         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20434         GO TO 8800-GET-COMP-RATE.
 20435
 20436     MOVE CT-RT (IB) TO WS-WK-RATE.
 20437
 20438 8800-EXIT.
 20439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 376
* EL050.cbl
 20441 8900-ADDRESS-FILE.
 20442     IF ERACCT-FILE-ADDRESSED
 20443         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20444         GO TO 8900-ADDRESS-EXIT.
 20445
 20446     IF ELCNTL-FILE-ADDRESSED
 20447         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20448         GO TO 8900-ADDRESS-EXIT.
 20449
 20450     IF ERPLAN-FILE-ADDRESSED
 20451         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20452         GO TO 8900-ADDRESS-EXIT.
 20453
 20454     IF ERFORM-FILE-ADDRESSED
 20455         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20456         GO TO 8900-ADDRESS-EXIT.
 20457
 20458 8900-ADDRESS-EXIT.
 20459     EXIT.
 20460
 20461 9000-READ-CONTROL.
 20462
 20463* EXEC CICS HANDLE CONDITION
 20464*        NOTFND    (9000-NOTFND)
 20465*    END-EXEC.
 20466*    MOVE '"$I                   ! = #00019091' TO DFHEIV0
 20467     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20469     MOVE X'3D20233030303139303931' TO DFHEIV0(25:11)
 20470     CALL 'kxdfhei1' USING DFHEIV0
 20471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20472
 20473
 20474
 20475* EXEC CICS READ
 20476*        DATASET     (CNTL-ID)
 20477*        SET         (ADDRESS OF CONTROL-FILE)
 20478*        RIDFLD      (ELCNTL-KEY)
 20479*        GTEQ
 20480*    END-EXEC.
 20481*    MOVE '&"S        G          (   #00019095' TO DFHEIV0
 20482     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20484     MOVE X'2020233030303139303935' TO DFHEIV0(25:11)
 20485     CALL 'kxdfhei1' USING DFHEIV0,
 20486           CNTL-ID,
 20487           DFHEIV20,
 20488           DFHEIV99,
 20489           ELCNTL-KEY,
 20490           DFHEIV99,
 20491           DFHEIV99,
 20492           DFHEIV99
 20493     SET ADDRESS OF CONTROL-FILE TO
 20494         DFHEIV20
 20495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20496
 20497
 20498     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 377
* EL050.cbl
 20499
 20500 9000-NOTFND.
 20501     IF RC-SW-1 = '1'
 20502        MOVE ER-2616              TO WS-ERROR
 20503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20504        GO TO 9000-EXIT.
 20505
 20506     IF RC-SW-1 = '2'
 20507        MOVE ER-2602              TO WS-ERROR
 20508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20509
 20510 9000-EXIT.
 20511      EXIT.
 20512
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 378
* EL050.cbl
 20514 9100-READ-CONTROL.
 20515
 20516* EXEC CICS HANDLE CONDITION
 20517*        NOTFND  (9100-NOTFND)
 20518*        ENDFILE (9100-NOTFND)
 20519*    END-EXEC.
 20520*    MOVE '"$I''                  ! > #00019119' TO DFHEIV0
 20521     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20523     MOVE X'3E20233030303139313139' TO DFHEIV0(25:11)
 20524     CALL 'kxdfhei1' USING DFHEIV0
 20525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20526
 20527
 20528
 20529* EXEC CICS READ
 20530*        DATASET     (CNTL-ID)
 20531*        INTO        (CONTROL-FILE)
 20532*        RIDFLD      (ELCNTL-KEY)
 20533*        GTEQ
 20534*    END-EXEC.
 20535     MOVE LENGTH OF
 20536      CONTROL-FILE
 20537       TO DFHEIV11
 20538*    MOVE '&"IL       G          (   #00019124' TO DFHEIV0
 20539     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20541     MOVE X'2020233030303139313234' TO DFHEIV0(25:11)
 20542     CALL 'kxdfhei1' USING DFHEIV0,
 20543           CNTL-ID,
 20544           CONTROL-FILE,
 20545           DFHEIV11,
 20546           ELCNTL-KEY,
 20547           DFHEIV99,
 20548           DFHEIV99,
 20549           DFHEIV99
 20550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20551
 20552
 20553     GO TO 9100-EXIT.
 20554
 20555 9100-NOTFND.
 20556     IF RC-SW-2 = '0'
 20557        MOVE '1'                  TO STATE-RECORD-ERROR
 20558        GO TO 9100-EXIT
 20559     END-IF
 20560     IF RC-SW-2 = '1'
 20561        MOVE '1'                  TO LF-BENEFIT-ERROR
 20562        MOVE ER-2604              TO WS-ERROR
 20563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20564        GO TO 9100-EXIT.
 20565
 20566     IF RC-SW-2 = '2'
 20567        MOVE '1'                  TO AH-BENEFIT-ERROR
 20568        MOVE ER-2605              TO WS-ERROR
 20569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20570        GO TO 9100-EXIT.
 20571
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 379
* EL050.cbl
 20572     IF RC-SW-2 = '3'
 20573         MOVE ER-2603           TO WS-ERROR
 20574         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20575         GO TO 9100-EXIT.
 20576
 20577     IF RC-SW-2 = '4'
 20578         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20579         GO TO 9100-EXIT.
 20580
 20581     IF RC-SW-2 = '5'
 20582         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20583         IF WS-AH-INPUT-CD-1 = SPACE
 20584             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20585         ELSE
 20586             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20587
 20588 9100-EXIT.
 20589      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 380
* EL050.cbl
 20591 9200-CONTROL-GETMAIN.
 20592
 20593* EXEC CICS GETMAIN
 20594*         LENGTH   (750)
 20595*         SET      (ADDRESS OF CONTROL-FILE)
 20596*    END-EXEC.
 20597     MOVE 750
 20598       TO DFHEIV11
 20599*    MOVE '," L                  $   #00019170' TO DFHEIV0
 20600     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20601     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20602     MOVE X'2020233030303139313730' TO DFHEIV0(25:11)
 20603     CALL 'kxdfhei1' USING DFHEIV0,
 20604           DFHEIV20,
 20605           DFHEIV11,
 20606           DFHEIV99
 20607     SET ADDRESS OF CONTROL-FILE TO
 20608         DFHEIV20
 20609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20610
 20611
 20612     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20613
 20614 9200-EXIT.
 20615     EXIT.
 20616
 20617 9250-UNLOCK-RETURN.
 20618
 20619* EXEC CICS UNLOCK
 20620*        DATASET   (CERT-ID)
 20621*    END-EXEC.
 20622*    MOVE '&*                    #   #00019181' TO DFHEIV0
 20623     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20624     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20625     MOVE X'2020233030303139313831' TO DFHEIV0(25:11)
 20626     CALL 'kxdfhei1' USING DFHEIV0,
 20627           CERT-ID,
 20628           DFHEIV99
 20629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20630
 20631
 20632 9300-ABEND.
 20633     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20634
 20635
 20636* EXEC CICS LINK
 20637*        PROGRAM   ('EL004')
 20638*        COMMAREA  (WS-ERROR-LINE)
 20639*        LENGTH    (72)
 20640*    END-EXEC.
 20641     MOVE 'EL004' TO DFHEIV1
 20642     MOVE 72
 20643       TO DFHEIV11
 20644*    MOVE '."C                   ''   #00019188' TO DFHEIV0
 20645     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20646     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20647     MOVE X'2020233030303139313838' TO DFHEIV0(25:11)
 20648     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 381
* EL050.cbl
 20649           DFHEIV1,
 20650           WS-ERROR-LINE,
 20651           DFHEIV11,
 20652           DFHEIV99,
 20653           DFHEIV99,
 20654           DFHEIV99
 20655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20656
 20657
 20658     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20659
 20660
 20661* EXEC CICS ABEND
 20662*        ABCODE ('EL50')
 20663*    END-EXEC.
 20664     MOVE 'EL50' TO DFHEIV5
 20665*    MOVE '.,A                   "   #00019196' TO DFHEIV0
 20666     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20667     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20668     MOVE X'2020233030303139313936' TO DFHEIV0(25:11)
 20669     CALL 'kxdfhei1' USING DFHEIV0,
 20670           DFHEIV5
 20671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20672
 20673
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 382
* EL050.cbl
 20675
 20676******************************************************************
 20677*                                                                *
 20678*            E R R O R   F O R M A T   R O U T I N E             *
 20679*                                                                *
 20680******************************************************************
 20681
 20682 9900-ERROR-FORMAT.
 20683
 20684     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20685                    PB-COMMON-ERROR (2) OR
 20686                    PB-COMMON-ERROR (3) OR
 20687                    PB-COMMON-ERROR (4) OR
 20688                    PB-COMMON-ERROR (5) OR
 20689                    PB-COMMON-ERROR (6) OR
 20690                    PB-COMMON-ERROR (7) OR
 20691                    PB-COMMON-ERROR (8) OR
 20692                    PB-COMMON-ERROR (9) OR
 20693                    PB-COMMON-ERROR (10)
 20694        GO TO 9900-EXIT.
 20695
 20696     IF PB-NO-OF-ERRORS = +10
 20697        GO TO 9900-EXIT.
 20698
 20699     ADD +1  TO PB-NO-OF-ERRORS.
 20700     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20701                                       (PB-NO-OF-ERRORS).
 20702 9900-EXIT.
 20703     EXIT.
 20704
 20705 9990-RETURN.
 20706     IF BROWSE-STARTED
 20707
 20708* EXEC CICS ENDBR
 20709*            DATASET  (ACCT-ID)
 20710*       END-EXEC.
 20711     MOVE 0
 20712       TO DFHEIV11
 20713*    MOVE '&2                    $   #00019233' TO DFHEIV0
 20714     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20715     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20716     MOVE X'2020233030303139323333' TO DFHEIV0(25:11)
 20717     CALL 'kxdfhei1' USING DFHEIV0,
 20718           ACCT-ID,
 20719           DFHEIV11,
 20720           DFHEIV99
 20721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20722
 20723
 20724 9990-EXIT.
 20725     EXIT.
 20726
 20727 9999-RETURN.
 20728     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 20729
 20730
 20731* EXEC CICS RETURN
 20732*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 383
* EL050.cbl
 20733*    MOVE '.(                    &   #00019243' TO DFHEIV0
 20734     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20735     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20736     MOVE X'2020233030303139323433' TO DFHEIV0(25:11)
 20737     CALL 'kxdfhei1' USING DFHEIV0,
 20738           DFHEIV99,
 20739           DFHEIV99,
 20740           DFHEIV99,
 20741           DFHEIV99,
 20742           DFHEIV99
 20743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20744
 20745
 20746
 20747* GOBACK.
 20748     MOVE '9%                    "   ' TO DFHEIV0
 20749     MOVE 'EL050' TO DFHEIV1
 20750     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20751     GOBACK.
 20752
 20753 9999-DFHBACK SECTION.
 20754     MOVE '9%                    "   ' TO DFHEIV0
 20755     MOVE 'EL050' TO DFHEIV1
 20756     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20757     GOBACK.
 20758 9999-DFHEXIT.
 20759     IF DFHEIGDJ EQUAL 0001
 20760         NEXT SENTENCE
 20761     ELSE IF DFHEIGDJ EQUAL 2
 20762         GO TO 9300-ABEND,
 20763               3990-FILES-NOT-OPEN
 20764         DEPENDING ON DFHEIGDI
 20765     ELSE IF DFHEIGDJ EQUAL 3
 20766         GO TO 6610-START-BROWSE,
 20767               6630-ERRESS-PROBLEM,
 20768               6630-END-OF-FILE
 20769         DEPENDING ON DFHEIGDI
 20770     ELSE IF DFHEIGDJ EQUAL 4
 20771         GO TO 6630-END-OF-FILE,
 20772               6630-ERRESS-PROBLEM,
 20773               6630-ERRESS-PROBLEM,
 20774               6630-END-OF-FILE
 20775         DEPENDING ON DFHEIGDI
 20776     ELSE IF DFHEIGDJ EQUAL 5
 20777         GO TO 6630-END-OF-FILE,
 20778               6630-END-OF-FILE,
 20779               6630-ERRESS-PROBLEM,
 20780               6630-ERRESS-PROBLEM
 20781         DEPENDING ON DFHEIGDI
 20782     ELSE IF DFHEIGDJ EQUAL 6
 20783         GO TO 6660-START-BROWSE,
 20784               6690-ERRESC-PROBLEM,
 20785               6690-ERRESC-PROBLEM,
 20786               6690-END-OF-FILE
 20787         DEPENDING ON DFHEIGDI
 20788     ELSE IF DFHEIGDJ EQUAL 7
 20789         GO TO 6690-END-OF-FILE,
 20790               6690-ERRESC-PROBLEM,
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 384
* EL050.cbl
 20791               6690-ERRESC-PROBLEM,
 20792               6690-END-OF-FILE
 20793         DEPENDING ON DFHEIGDI
 20794     ELSE IF DFHEIGDJ EQUAL 8
 20795         GO TO 6690-END-OF-FILE,
 20796               6690-ERRESC-PROBLEM,
 20797               6690-ERRESC-PROBLEM,
 20798               6690-END-OF-FILE
 20799         DEPENDING ON DFHEIGDI
 20800     ELSE IF DFHEIGDJ EQUAL 9
 20801         GO TO 7250-CONTINUE,
 20802               7250-CONTINUE
 20803         DEPENDING ON DFHEIGDI
 20804     ELSE IF DFHEIGDJ EQUAL 10
 20805         GO TO 7300-CONTINUE,
 20806               7300-CONTINUE
 20807         DEPENDING ON DFHEIGDI
 20808     ELSE IF DFHEIGDJ EQUAL 11
 20809         GO TO 8000-FREE-MAIN
 20810         DEPENDING ON DFHEIGDI
 20811     ELSE IF DFHEIGDJ EQUAL 12
 20812         GO TO 8100-NOTFND,
 20813               8100-NOTFND
 20814         DEPENDING ON DFHEIGDI
 20815     ELSE IF DFHEIGDJ EQUAL 13
 20816         GO TO 8110-NOTFND,
 20817               8110-NOTFND
 20818         DEPENDING ON DFHEIGDI
 20819     ELSE IF DFHEIGDJ EQUAL 14
 20820         GO TO 8130-EXIT
 20821         DEPENDING ON DFHEIGDI
 20822     ELSE IF DFHEIGDJ EQUAL 15
 20823         GO TO 8180-NOTFND
 20824         DEPENDING ON DFHEIGDI
 20825     ELSE IF DFHEIGDJ EQUAL 16
 20826         GO TO 8190-NOTFND
 20827         DEPENDING ON DFHEIGDI
 20828     ELSE IF DFHEIGDJ EQUAL 17
 20829         GO TO 8200-NOTFND
 20830         DEPENDING ON DFHEIGDI
 20831     ELSE IF DFHEIGDJ EQUAL 18
 20832         GO TO 8300-NOTFND,
 20833               8300-ERRESS-PROBLEM,
 20834               8300-ERRESS-PROBLEM,
 20835               8300-NOTFND
 20836         DEPENDING ON DFHEIGDI
 20837     ELSE IF DFHEIGDJ EQUAL 19
 20838         GO TO 8450-FORM-NOT-FOUND,
 20839               8450-FORM-NOT-FOUND
 20840         DEPENDING ON DFHEIGDI
 20841     ELSE IF DFHEIGDJ EQUAL 20
 20842         GO TO 0199-ACCT-NOT-FOUND,
 20843               0199-ACCT-NOT-FOUND
 20844         DEPENDING ON DFHEIGDI
 20845     ELSE IF DFHEIGDJ EQUAL 21
 20846         GO TO 0199-ACCT-NOT-FOUND,
 20847               0199-ACCT-NOT-FOUND
 20848         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 05-Apr-12 11:34 Page 385
* EL050.cbl
 20849     ELSE IF DFHEIGDJ EQUAL 22
 20850         GO TO 8582-COMP-NOT-FOUND,
 20851               8582-COMP-NOT-FOUND
 20852         DEPENDING ON DFHEIGDI
 20853     ELSE IF DFHEIGDJ EQUAL 23
 20854         GO TO 8583-AGTC-NOT-FOUND,
 20855               8583-AGTC-NOT-FOUND
 20856         DEPENDING ON DFHEIGDI
 20857     ELSE IF DFHEIGDJ EQUAL 24
 20858         GO TO 8584-BXRF-NOT-FOUND,
 20859               8584-BXRF-NOT-FOUND
 20860         DEPENDING ON DFHEIGDI
 20861     ELSE IF DFHEIGDJ EQUAL 25
 20862         GO TO 8585-PLAN-NOT-FOUND,
 20863               8585-PLAN-NOT-FOUND
 20864         DEPENDING ON DFHEIGDI
 20865     ELSE IF DFHEIGDJ EQUAL 26
 20866         GO TO 0299-CERT-NOT-FOUND
 20867         DEPENDING ON DFHEIGDI
 20868     ELSE IF DFHEIGDJ EQUAL 27
 20869         GO TO 8700-READ-CERT-MASTER
 20870         DEPENDING ON DFHEIGDI
 20871     ELSE IF DFHEIGDJ EQUAL 28
 20872         GO TO 8720-COMP-ACCOUNTS,
 20873               8730-END-BROWSE,
 20874               8740-NOT-FOUND
 20875         DEPENDING ON DFHEIGDI
 20876     ELSE IF DFHEIGDJ EQUAL 29
 20877         GO TO 9000-NOTFND
 20878         DEPENDING ON DFHEIGDI
 20879     ELSE IF DFHEIGDJ EQUAL 30
 20880         GO TO 9100-NOTFND,
 20881               9100-NOTFND
 20882         DEPENDING ON DFHEIGDI.
 20883     MOVE '9%                    "   ' TO DFHEIV0
 20884     MOVE 'EL050' TO DFHEIV1
 20885     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20886     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39416     Code:       84480
