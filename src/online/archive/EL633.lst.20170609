* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54* 100713  CR2013100700001  AJRA ADD 1825091000 FOR CID
    55* 081414    2014012300001  PEMA  ADD PROCESSING FOR CARRIER 7 DCC
    56* 110315  CR2015101400001  PEMA ADD NEW DCC G/L #'S FOR ACH
    57* 111715  IR2015111600001  PEMA  CHG G/L ACCTNO ON CID ACH
    58* 021716  CR2016021000003  PEMA  ADD NEW G/L FOR MACHENS ACCTS
    59* 111016  CR2016110900002  TANA  REPLACE GL NUMBERS FOR CCC
    60******************************************************************
    61
    62 ENVIRONMENT DIVISION.
    63 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page   3
* EL633.cbl
    65 WORKING-STORAGE SECTION.
    66 01  DFH-START PIC X(04).
    67 77  FILLER  PIC X(32)  VALUE '********************************'.
    68 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    69 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    70
    71*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    72*77  SV-COFA PIC X(42)  VALUE SPACES.
    73*77  K-SPACE PIC X(11)  VALUE SPACES.
    74
    75 01  DATE-WORK-AREAS.
    76     05  WS-GREG-STORE.
    77         10  WS-GS-MM  PIC XX.
    78         10  FILLER    PIC X.
    79         10  WS-GS-DD  PIC XX.
    80         10  FILLER    PIC X.
    81         10  WS-GS-YY  PIC XX.
    82     05  WS-SDTE-STORE.
    83         10  WS-SS-MM  PIC XX.
    84         10  WS-SS-DD  PIC XX.
    85         10  WS-SS-YY  PIC XX.
    86*                            COPY ELCSCTM.
    87******************************************************************
    88*                                                                *
    89*                                                                *
    90*                            ELCSCTM                             *
    91*                            VMOD=2.001                          *
    92*                                                                *
    93*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-MESSAGE.
    97     12  FILLER                          PIC X(30)
    98            VALUE '** LOGIC SECURITY VIOLATION -'.
    99     12  SM-READ                         PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' PGM='.
   102     12  SM-PGM                          PIC X(6).
   103     12  FILLER                          PIC X(5)
   104            VALUE ' OPR='.
   105     12  SM-PROCESSOR-ID                 PIC X(4).
   106     12  FILLER                          PIC X(6)
   107            VALUE ' TERM='.
   108     12  SM-TERMID                       PIC X(4).
   109     12  FILLER                          PIC XX   VALUE SPACE.
   110     12  SM-JUL-DATE                     PIC 9(5).
   111     12  FILLER                          PIC X    VALUE SPACE.
   112     12  SM-TIME                         PIC 99.99.
   113
   114*                            COPY ELCSCRTY.
   115******************************************************************
   116*                                                                *
   117*                                                                *
   118*                            ELCSCRTY                            *
   119*                            VMOD=2.001                          *
   120*                                                                *
   121*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   122*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page   4
* EL633.cbl
   123*        SAVED IN PI-SECURITY-ADDRESS.                           *
   124*                                                                *
   125******************************************************************
   126 01  SECURITY-CONTROL.
   127     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   128     12  FILLER                       PIC XX    VALUE 'SC'.
   129     12  SC-CREDIT-CODES.
   130         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   131             20  SC-CREDIT-DISPLAY    PIC X.
   132             20  SC-CREDIT-UPDATE     PIC X.
   133     12  SC-CLAIMS-CODES.
   134         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   135             20  SC-CLAIMS-DISPLAY    PIC X.
   136             20  SC-CLAIMS-UPDATE     PIC X.
   137
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page   5
* EL633.cbl
   139
   140 01  STANDARD-AREAS.
   141     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   142     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   143     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   144     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   145     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   146     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   147     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   148     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   149     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   150     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   151     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   152     12  PGM-NAME            PIC  X(8).
   153     12  TIME-IN             PIC S9(7).
   154     12  TIME-OUT-R  REDEFINES  TIME-IN.
   155         16  FILLER          PIC  X.
   156         16  TIME-OUT        PIC  99V99.
   157         16  FILLER          PIC  X(2).
   158     12  EL640               PIC  X(8)       VALUE 'EL640'.
   159     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   160     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   161     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   162     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   163     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   164     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   165     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   166     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   167     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   168     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   169     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   170     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   171     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   172     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   173     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   174     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   175     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   176         88  PYAJ-1ST-READ                   VALUE 'Y'.
   177     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   178         88  FIRST-ADD                       VALUE 'Y'.
   179     12  ZERO-NDX            PIC  9          VALUE ZERO.
   180     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   181     12  WORK-SEQ-TIME       PIC  9(6).
   182     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   183         16  WORK-SEQ-HHMMS  PIC  9(5).
   184         16  FILLER          PIC  9.
   185     12  WORK-DATE-JULIAN.
   186         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   187         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   188     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   189     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   190         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   191                                                    'S' 'T' 'U'
   192                                                    'X' 'Y' 'Z'
   193                                                    'F'.
   194     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   195         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   196     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page   6
* EL633.cbl
   197         88  FORCE-SHOW                      VALUE  'Y'.
   198
   199     12  WS-EOM-DTS OCCURS 13  TIMES
   200                              INDEXED BY PINDEX.
   201         16  WS-EOM-DT               PIC XX.
   202*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   203
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page   7
* EL633.cbl
   205     12  WS-ERROR-CODES.
   206         16  ER-0000         PIC  X(4)       VALUE '0000'.
   207         16  ER-0008         PIC  X(4)       VALUE '0008'.
   208         16  ER-0023         PIC  X(4)       VALUE '0023'.
   209         16  ER-0029         PIC  X(4)       VALUE '0029'.
   210         16  ER-0070         PIC  X(4)       VALUE '0070'.
   211         16  ER-0587         PIC  X(4)       VALUE '0587'.
   212         16  ER-2056         PIC  X(4)       VALUE '2056'.
   213         16  ER-2230         PIC  X(4)       VALUE '2230'.
   214         16  ER-2231         PIC  X(4)       VALUE '2231'.
   215         16  ER-2232         PIC  X(4)       VALUE '2232'.
   216         16  ER-2233         PIC  X(4)       VALUE '2233'.
   217         16  ER-2234         PIC  X(4)       VALUE '2234'.
   218         16  ER-2235         PIC  X(4)       VALUE '2235'.
   219         16  ER-2236         PIC  X(4)       VALUE '2236'.
   220         16  ER-2237         PIC  X(4)       VALUE '2237'.
   221         16  ER-2238         PIC  X(4)       VALUE '2238'.
   222         16  ER-2239         PIC  X(4)       VALUE '2239'.
   223         16  ER-2244         PIC  X(4)       VALUE '2244'.
   224         16  ER-2245         PIC  X(4)       VALUE '2245'.
   225         16  ER-2246         PIC  X(4)       VALUE '2246'.
   226         16  ER-2370         PIC  X(4)       VALUE '2370'.
   227         16  ER-2432         PIC  X(4)       VALUE '2432'.
   228         16  ER-2449         PIC  X(4)       VALUE '2449'.
   229         16  ER-2587         PIC  X(4)       VALUE '2587'.
   230         16  ER-2588         PIC  X(4)       VALUE '2588'.
   231         16  ER-2595         PIC  X(4)       VALUE '2595'.
   232         16  ER-2596         PIC  X(4)       VALUE '2596'.
   233         16  ER-2763         PIC  X(4)       VALUE '2763'.
   234         16  ER-2929         PIC  X(4)       VALUE '2929'.
   235         16  ER-2957         PIC  X(4)       VALUE '2957'.
   236         16  ER-2958         PIC  X(4)       VALUE '2958'.
   237*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   238         16  ER-2960         PIC  X(4)       VALUE '2960'.
   239         16  ER-3020         PIC  X(4)       VALUE '3020'.
   240
   241*************************************************************
   242*                      TABLE OF STATE NAMES
   243*************************************************************
   244
   245 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   246     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   247                                   'CD' 'CO' 'CT' 'DC' 'DE'
   248                                   'FL' 'GA' 'GM' 'HI' 'IA'
   249                                   'ID' 'IL' 'IN' 'KS' 'KY'
   250                                   'LA' 'MA' 'MD' 'ME' 'MI'
   251                                   'MN' 'MO' 'MS' 'MT' 'MX'
   252                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   253                                   'NM' 'NV' 'NY' 'OF' 'OH'
   254                                   'OK' 'OR' 'PA' 'PI' 'PR'
   255                                   'RI' 'SC' 'SD' 'TN' 'TX'
   256                                   'UT' 'VA' 'VI' 'VT' 'WA'
   257                                   'WI' 'WV' 'WY'.
   258
   259 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   260     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   261                                 '1108124700'
   262                                 '1108125100'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page   8
* EL633.cbl
   263                                 '1721211400'
   264                                 '1825011200'
   265                                 '1825011300'
   266                                 '1825091000'
   267                                 '1825099050'
   268                                 '8505700033'
   269                                 '8506400030'
   270                                 '8507200020'
   271                                 '8507200010'
   272                                 '2725010160'.
   273     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   274                                     '2725040320'
   275                                     '2725040330'
   276                                     '2725040310'
   277                                     '8506400030'
   278                                     '8507200010'
   279                                     '1108121250'.
   280*    88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   281*                                    '2725040110'
   282*                                    '2725040120'
   283*                                    '2725040130'
   284*                                    '2725020400'.
   285     88  VALID-CSI-GL-ACCOUNT  VALUE '1108121010'
   286                                     '1825013200'
   287                                     '1825013300'
   288                                     '1825013400'.
   289
   290     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   291                                     '1825013200'
   292                                     '1825013300'
   293                                     '1825013400'
   294                                     '8506400030'
   295                                     '8507200010'
   296                                     '8507200020'
   297                                     '1108121010'.
   298     88  VALID-VPP-GL-ACCOUNT  VALUE '2725040510'
   299                                     '2725040520'.
   300
   301*01  WS-ACCT-BREAK.
   302*    05  WS-ACCT-1               PIC X.
   303*    05  FILLER                  PIC X(6).
   304*
   305 01  WORK-AREA.
   306     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   307     12  QID.
   308         16  QID-TERM        PIC X(04).
   309         16  FILLER          PIC X(04)       VALUE '633A'.
   310     12  DEEDIT-FIELD        PIC X(11).
   311     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   312     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   313     12  DATE-TEST-AREA      PIC  9(6).
   314     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   315         16  DATE-TEST-MM    PIC  99.
   316         16  DATE-TEST-DD    PIC  99.
   317         16  DATE-TEST-YY    PIC  99.
   318     12  DIVIDE-RESULT       PIC  99.
   319     12  DIVIDE-REMAINDER    PIC  9.
   320     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page   9
* EL633.cbl
   321     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   322     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   323     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   324     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   325     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   326     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   327     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   328
   329 01  ACCESS-KEYS.
   330     12  ERPYAJ-KEY.
   331         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   332         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   333         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   334         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   335         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   336         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   337         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   338
   339     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   340     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   341
   342     12  ERCHKQ-KEY.
   343         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   344         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   345         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   346     12  ERCOMP-KEY.
   347         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   348         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   349         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   350         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   351         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   352         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   353*    12  COFA-KEY-X.
   354*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   355*        16  COFA-ACCOUNT.
   356*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   357*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   358*
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  10
* EL633.cbl
   360*                                    COPY ELCDATE.
   361******************************************************************
   362*                                                                *
   363*                                                                *
   364*                            ELCDATE.                            *
   365*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   366*                            VMOD=2.003
   367*                                                                *
   368*                                                                *
   369*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   370*                 LENGTH = 200                                   *
   371******************************************************************
   372
   373 01  DATE-CONVERSION-DATA.
   374     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   375     12  DC-OPTION-CODE                PIC X.
   376         88  BIN-TO-GREG                VALUE ' '.
   377         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   378         88  EDIT-GREG-TO-BIN           VALUE '2'.
   379         88  YMD-GREG-TO-BIN            VALUE '3'.
   380         88  MDY-GREG-TO-BIN            VALUE '4'.
   381         88  JULIAN-TO-BIN              VALUE '5'.
   382         88  BIN-PLUS-ELAPSED           VALUE '6'.
   383         88  FIND-CENTURY               VALUE '7'.
   384         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   385         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   386         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   387         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   388         88  JULIAN-TO-BIN-3            VALUE 'C'.
   389         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   390         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   391         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   392         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   393         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   394         88  CHECK-LEAP-YEAR            VALUE 'H'.
   395         88  BIN-3-TO-GREG              VALUE 'I'.
   396         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   397         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   398         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   399         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   400         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   401         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   402         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   403         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   404         88  THREE-CHARACTER-BIN
   405                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   406         88  GREGORIAN-TO-BIN
   407                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   408         88  BIN-TO-GREGORIAN
   409                  VALUES ' ' '1' 'I' '8' 'G'.
   410         88  JULIAN-TO-BINARY
   411                  VALUES '5' 'C' 'E' 'F'.
   412     12  DC-ERROR-CODE                 PIC X.
   413         88  NO-CONVERSION-ERROR        VALUE ' '.
   414         88  DATE-CONVERSION-ERROR
   415                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   416         88  DATE-IS-ZERO               VALUE '1'.
   417         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  11
* EL633.cbl
   418         88  DATE-IS-INVALID            VALUE '3'.
   419         88  DATE1-GREATER-DATE2        VALUE '4'.
   420         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   421         88  DATE-INVALID-OPTION        VALUE '9'.
   422         88  INVALID-CENTURY            VALUE 'A'.
   423         88  ONLY-CENTURY               VALUE 'B'.
   424         88  ONLY-LEAP-YEAR             VALUE 'C'.
   425         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   426     12  DC-END-OF-MONTH               PIC X.
   427         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   428     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   429         88  USE-NORMAL-PROCESS         VALUE ' '.
   430         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   431         88  ADJUST-UP-100-YRS          VALUE '2'.
   432     12  FILLER                        PIC X.
   433     12  DC-CONVERSION-DATES.
   434         16  DC-BIN-DATE-1             PIC XX.
   435         16  DC-BIN-DATE-2             PIC XX.
   436         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   437         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   438                       DC-GREG-DATE-1-EDIT.
   439             20  DC-EDIT1-MONTH        PIC 99.
   440             20  SLASH1-1              PIC X.
   441             20  DC-EDIT1-DAY          PIC 99.
   442             20  SLASH1-2              PIC X.
   443             20  DC-EDIT1-YEAR         PIC 99.
   444         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   445         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   446                     DC-GREG-DATE-2-EDIT.
   447             20  DC-EDIT2-MONTH        PIC 99.
   448             20  SLASH2-1              PIC X.
   449             20  DC-EDIT2-DAY          PIC 99.
   450             20  SLASH2-2              PIC X.
   451             20  DC-EDIT2-YEAR         PIC 99.
   452         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   453         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   454                     DC-GREG-DATE-1-YMD.
   455             20  DC-YMD-YEAR           PIC 99.
   456             20  DC-YMD-MONTH          PIC 99.
   457             20  DC-YMD-DAY            PIC 99.
   458         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   459         16  DC-GREG-DATE-1-MDY-R REDEFINES
   460                      DC-GREG-DATE-1-MDY.
   461             20  DC-MDY-MONTH          PIC 99.
   462             20  DC-MDY-DAY            PIC 99.
   463             20  DC-MDY-YEAR           PIC 99.
   464         16  DC-GREG-DATE-1-ALPHA.
   465             20  DC-ALPHA-MONTH        PIC X(10).
   466             20  DC-ALPHA-DAY          PIC 99.
   467             20  FILLER                PIC XX.
   468             20  DC-ALPHA-CENTURY.
   469                 24 DC-ALPHA-CEN-N     PIC 99.
   470             20  DC-ALPHA-YEAR         PIC 99.
   471         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   472         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   473         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   474         16  DC-JULIAN-DATE            PIC 9(05).
   475         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  12
* EL633.cbl
   476                                       PIC 9(05).
   477         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   478             20  DC-JULIAN-YEAR        PIC 99.
   479             20  DC-JULIAN-DAYS        PIC 999.
   480         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   481         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   482         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   483     12  DATE-CONVERSION-VARIBLES.
   484         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   485         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   486             20  FILLER                PIC 9(3).
   487             20  HOLD-CEN-1-CCYY.
   488                 24  HOLD-CEN-1-CC     PIC 99.
   489                 24  HOLD-CEN-1-YY     PIC 99.
   490             20  HOLD-CEN-1-MO         PIC 99.
   491             20  HOLD-CEN-1-DA         PIC 99.
   492         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   493             20  HOLD-CEN-1-R-MO       PIC 99.
   494             20  HOLD-CEN-1-R-DA       PIC 99.
   495             20  HOLD-CEN-1-R-CCYY.
   496                 24  HOLD-CEN-1-R-CC   PIC 99.
   497                 24  HOLD-CEN-1-R-YY   PIC 99.
   498             20  FILLER                PIC 9(3).
   499         16  HOLD-CENTURY-1-X.
   500             20  FILLER                PIC X(3)  VALUE SPACES.
   501             20  HOLD-CEN-1-X-CCYY.
   502                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   503                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   504             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   505             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   506         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   507             20  HOLD-CEN-1-R-X-MO     PIC XX.
   508             20  HOLD-CEN-1-R-X-DA     PIC XX.
   509             20  HOLD-CEN-1-R-X-CCYY.
   510                 24  HOLD-CEN-1-R-X-CC PIC XX.
   511                 24  HOLD-CEN-1-R-X-YY PIC XX.
   512             20  FILLER                PIC XXX.
   513         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   514         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   515         16  DC-JULIAN-DATE-1          PIC 9(07).
   516         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   517             20  DC-JULIAN-1-CCYY.
   518                 24  DC-JULIAN-1-CC    PIC 99.
   519                 24  DC-JULIAN-1-YR    PIC 99.
   520             20  DC-JULIAN-DA-1        PIC 999.
   521         16  DC-JULIAN-DATE-2          PIC 9(07).
   522         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   523             20  DC-JULIAN-2-CCYY.
   524                 24  DC-JULIAN-2-CC    PIC 99.
   525                 24  DC-JULIAN-2-YR    PIC 99.
   526             20  DC-JULIAN-DA-2        PIC 999.
   527         16  DC-GREG-DATE-A-EDIT.
   528             20  DC-EDITA-MONTH        PIC 99.
   529             20  SLASHA-1              PIC X VALUE '/'.
   530             20  DC-EDITA-DAY          PIC 99.
   531             20  SLASHA-2              PIC X VALUE '/'.
   532             20  DC-EDITA-CCYY.
   533                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  13
* EL633.cbl
   534                 24  DC-EDITA-YEAR     PIC 99.
   535         16  DC-GREG-DATE-B-EDIT.
   536             20  DC-EDITB-MONTH        PIC 99.
   537             20  SLASHB-1              PIC X VALUE '/'.
   538             20  DC-EDITB-DAY          PIC 99.
   539             20  SLASHB-2              PIC X VALUE '/'.
   540             20  DC-EDITB-CCYY.
   541                 24  DC-EDITB-CENT     PIC 99.
   542                 24  DC-EDITB-YEAR     PIC 99.
   543         16  DC-GREG-DATE-CYMD         PIC 9(08).
   544         16  DC-GREG-DATE-CYMD-R REDEFINES
   545                              DC-GREG-DATE-CYMD.
   546             20  DC-CYMD-CEN           PIC 99.
   547             20  DC-CYMD-YEAR          PIC 99.
   548             20  DC-CYMD-MONTH         PIC 99.
   549             20  DC-CYMD-DAY           PIC 99.
   550         16  DC-GREG-DATE-MDCY         PIC 9(08).
   551         16  DC-GREG-DATE-MDCY-R REDEFINES
   552                              DC-GREG-DATE-MDCY.
   553             20  DC-MDCY-MONTH         PIC 99.
   554             20  DC-MDCY-DAY           PIC 99.
   555             20  DC-MDCY-CEN           PIC 99.
   556             20  DC-MDCY-YEAR          PIC 99.
   557    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   558        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   559    12  DC-EL310-DATE                  PIC X(21).
   560    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  14
* EL633.cbl
   562*                                    COPY ELCLOGOF.
   563******************************************************************
   564*                                                                *
   565*                                                                *
   566*                            ELCLOGOF.                           *
   567*                            VMOD=2.001                          *
   568*                                                                *
   569*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   570*                                                                *
   571******************************************************************
   572 01  CLASIC-LOGOFF.
   573     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   574     12  LOGOFF-TEXT.
   575         16  FILLER          PIC X(5)    VALUE SPACES.
   576         16  LOGOFF-MSG.
   577             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   578             20  FILLER      PIC X       VALUE SPACES.
   579             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   580         16  FILLER          PIC X(80)
   581           VALUE '* YOU ARE NOW LOGGED OFF'.
   582         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   583         16  FILLER          PIC X       VALUE QUOTE.
   584         16  LOGOFF-SYS-MSG  PIC X(17)
   585           VALUE 'S CLAS-IC SYSTEM '.
   586     12  TEXT-MESSAGES.
   587         16  UNACCESS-MSG    PIC X(29)
   588             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   589         16  PGMIDERR-MSG    PIC X(17)
   590             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  15
* EL633.cbl
   592*                                    COPY ELCATTR.
   593******************************************************************
   594*                                                                *
   595*                            ELCATTR.                            *
   596*                            VMOD=2.001                          *
   597*                                                                *
   598*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   599*                                                                *
   600*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   601*                                                                *
   602*                   POS 1   P=PROTECTED                          *
   603*                           U=UNPROTECTED                        *
   604*                           S=ASKIP                              *
   605*                   POS 2   A=ALPHA/NUMERIC                      *
   606*                           N=NUMERIC                            *
   607*                   POS 3   N=NORMAL                             *
   608*                           B=BRIGHT                             *
   609*                           D=DARK                               *
   610*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   611*                           OF=MODIFIED DATA TAG OFF             *
   612*                                                                *
   613*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   614******************************************************************
   615 01  ATTRIBUTE-LIST.
   616     12  AL-PABOF            PIC X       VALUE 'Y'.
   617     12  AL-PABON            PIC X       VALUE 'Z'.
   618     12  AL-PADOF            PIC X       VALUE '%'.
   619     12  AL-PADON            PIC X       VALUE '_'.
   620     12  AL-PANOF            PIC X       VALUE '-'.
   621     12  AL-PANON            PIC X       VALUE '/'.
   622     12  AL-SABOF            PIC X       VALUE '8'.
   623     12  AL-SABON            PIC X       VALUE '9'.
   624     12  AL-SADOF            PIC X       VALUE '@'.
   625     12  AL-SADON            PIC X       VALUE QUOTE.
   626     12  AL-SANOF            PIC X       VALUE '0'.
   627     12  AL-SANON            PIC X       VALUE '1'.
   628     12  AL-UABOF            PIC X       VALUE 'H'.
   629     12  AL-UABON            PIC X       VALUE 'I'.
   630     12  AL-UADOF            PIC X       VALUE '<'.
   631     12  AL-UADON            PIC X       VALUE '('.
   632     12  AL-UANOF            PIC X       VALUE ' '.
   633     12  AL-UANON            PIC X       VALUE 'A'.
   634     12  AL-UNBOF            PIC X       VALUE 'Q'.
   635     12  AL-UNBON            PIC X       VALUE 'R'.
   636     12  AL-UNDOF            PIC X       VALUE '*'.
   637     12  AL-UNDON            PIC X       VALUE ')'.
   638     12  AL-UNNOF            PIC X       VALUE '&'.
   639     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  16
* EL633.cbl
   641*                                    COPY ELCEMIB.
   642******************************************************************
   643*                                                                *
   644*                                                                *
   645*                            ELCEMIB.                            *
   646*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   647*                            VMOD=2.005                          *
   648*                                                                *
   649*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   650*                                                                *
   651******************************************************************
   652 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   653     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   654     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   655     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   656     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   657     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   658     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   659     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   660     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   661     12  EMI-SWITCH1             PIC X        VALUE '1'.
   662         88  EMI-NO-ERRORS                    VALUE '1'.
   663         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   664         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   665     12  EMI-SWITCH2             PIC X        VALUE '1'.
   666         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   667     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   668         88  EMI-AREA1-EMPTY                  VALUE '1'.
   669         88  EMI-AREA1-FULL                   VALUE '2'.
   670     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   671         88  EMI-AREA2-EMPTY                  VALUE '1'.
   672         88  EMI-AREA2-FULL                   VALUE '2'.
   673     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   674         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   675         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   676         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   677         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   678         88  EMI-BYPASS-FATALS                VALUE 'X'.
   679     12  EMI-ERROR-LINES.
   680         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   681         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   682         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   683         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   684             20  EMI-ERR-CODES OCCURS 10 TIMES.
   685                 24  EMI-ERR-NUM         PIC X(4).
   686                 24  EMI-FILLER          PIC X.
   687                 24  EMI-SEV             PIC X.
   688                 24  FILLER              PIC X.
   689             20  FILLER                  PIC X(02).
   690     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   691         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   692             20  EMI-ERROR-NUMBER    PIC X(4).
   693             20  EMI-FILL            PIC X.
   694             20  EMI-SEVERITY        PIC X.
   695             20  FILLER              PIC X.
   696             20  EMI-ERROR-TEXT.
   697                 24  EMI-TEXT-VARIABLE   PIC X(10).
   698                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  17
* EL633.cbl
   699     12  EMI-SEVERITY-SAVE           PIC X.
   700         88  EMI-NOTE                    VALUE 'N'.
   701         88  EMI-WARNING                 VALUE 'W'.
   702         88  EMI-FORCABLE                VALUE 'F'.
   703         88  EMI-FATAL                   VALUE 'X'.
   704     12  EMI-MESSAGE-FLAG            PIC X.
   705         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   706         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   707     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   708     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   709         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   710         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   711         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   712     12  emi-claim-no                pic x(7).
   713     12  emi-claim-type              pic x(6).
   714     12  FILLER                      PIC X(124)  VALUE SPACES.
   715     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   716     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   717     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   718     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  18
* EL633.cbl
   720*                                    COPY ELCINTF.
   721******************************************************************
   722*                                                                *
   723*                                                                *
   724*                            ELCINTF.                            *
   725*                            VMOD=2.017                          *
   726*                                                                *
   727*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   728*                                                                *
   729*       LENGTH = 1024                                            *
   730*                                                                *
   731******************************************************************
   732*                   C H A N G E   L O G
   733*
   734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   735*-----------------------------------------------------------------
   736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   737* EFFECTIVE    NUMBER
   738*-----------------------------------------------------------------
   739* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   740******************************************************************
   741 01  PROGRAM-INTERFACE-BLOCK.
   742     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   743     12  PI-CALLING-PROGRAM              PIC X(8).
   744     12  PI-SAVED-PROGRAM-1              PIC X(8).
   745     12  PI-SAVED-PROGRAM-2              PIC X(8).
   746     12  PI-SAVED-PROGRAM-3              PIC X(8).
   747     12  PI-SAVED-PROGRAM-4              PIC X(8).
   748     12  PI-SAVED-PROGRAM-5              PIC X(8).
   749     12  PI-SAVED-PROGRAM-6              PIC X(8).
   750     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   751     12  PI-COMPANY-ID                   PIC XXX.
   752     12  PI-COMPANY-CD                   PIC X.
   753
   754     12  PI-COMPANY-PASSWORD             PIC X(8).
   755
   756     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   757
   758     12  PI-CONTROL-IN-PROGRESS.
   759         16  PI-CARRIER                  PIC X.
   760         16  PI-GROUPING                 PIC X(6).
   761         16  PI-STATE                    PIC XX.
   762         16  PI-ACCOUNT                  PIC X(10).
   763         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   764                                         PIC X(10).
   765         16  PI-CLAIM-CERT-GRP.
   766             20  PI-CLAIM-NO             PIC X(7).
   767             20  PI-CERT-NO.
   768                 25  PI-CERT-PRIME       PIC X(10).
   769                 25  PI-CERT-SFX         PIC X.
   770             20  PI-CERT-EFF-DT          PIC XX.
   771         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   772             20  PI-PLAN-CODE            PIC X(2).
   773             20  PI-REVISION-NUMBER      PIC X(3).
   774             20  PI-PLAN-EFF-DT          PIC X(2).
   775             20  PI-PLAN-EXP-DT          PIC X(2).
   776             20  FILLER                  PIC X(11).
   777         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  19
* EL633.cbl
   778             20  PI-OE-REFERENCE-1.
   779                 25  PI-OE-REF-1-PRIME   PIC X(18).
   780                 25  PI-OE-REF-1-SUFF    PIC XX.
   781
   782     12  PI-SESSION-IN-PROGRESS          PIC X.
   783         88  CLAIM-SESSION                   VALUE '1'.
   784         88  CREDIT-SESSION                  VALUE '2'.
   785         88  WARRANTY-SESSION                VALUE '3'.
   786         88  MORTGAGE-SESSION                VALUE '4'.
   787         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   788
   789
   790*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   791
   792     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   793     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   794
   795     12  PI-CREDIT-USER                  PIC X.
   796         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   797         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   798
   799     12  PI-CLAIM-USER                   PIC X.
   800         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   801         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   802
   803     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   804         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   805         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   806         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   807         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   808         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   809
   810     12  PI-PROCESSOR-ID                 PIC X(4).
   811
   812     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   813
   814     12  PI-MEMBER-CAPTION               PIC X(10).
   815
   816     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   817         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   818
   819     12  PI-LIFE-OVERRIDE-L1             PIC X.
   820     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   821     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   822     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   823
   824     12  PI-AH-OVERRIDE-L1               PIC X.
   825     12  PI-AH-OVERRIDE-L2               PIC XX.
   826     12  PI-AH-OVERRIDE-L6               PIC X(6).
   827     12  PI-AH-OVERRIDE-L12              PIC X(12).
   828
   829     12  PI-NEW-SYSTEM                   PIC X(2).
   830
   831     12  PI-PRIMARY-CERT-NO              PIC X(11).
   832     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   833         88  PI-USES-PAID-TO                 VALUE '1'.
   834     12  PI-CRDTCRD-SYSTEM.
   835         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  20
* EL633.cbl
   836             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   837             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   838         16  PI-CC-MONTH-END-DT          PIC XX.
   839     12  PI-PROCESSOR-PRINTER            PIC X(4).
   840
   841     12  PI-OE-REFERENCE-2.
   842         16  PI-OE-REF-2-PRIME           PIC X(10).
   843         16  PI-OE-REF-2-SUFF            PIC X.
   844
   845     12  PI-REM-TRM-CALC-OPTION          PIC X.
   846
   847     12  PI-LANGUAGE-TYPE                PIC X.
   848             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   849             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   850             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   851
   852     12  PI-POLICY-LINKAGE-IND           PIC X.
   853         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   854         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   855                                                   LOW-VALUES.
   856
   857     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   858     12  PI-CLAIM-PW-SESSION             PIC X(1).
   859         88  PI-CLAIM-CREDIT                 VALUE '1'.
   860         88  PI-CLAIM-CONVEN                 VALUE '2'.
   861
   862     12  PI-PROCESSOR-CSR-IND            PIC X.
   863         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   864         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   865
   866     12  FILLER                          PIC X(3).
   867
   868     12  PI-SYSTEM-LEVEL                 PIC X(145).
   869
   870     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   871         PI-SYSTEM-LEVEL.
   872
   873         16  PI-ENTRY-CODES.
   874             20  PI-ENTRY-CD-1           PIC X.
   875             20  PI-ENTRY-CD-2           PIC X.
   876
   877         16  PI-RETURN-CODES.
   878             20  PI-RETURN-CD-1          PIC X.
   879             20  PI-RETURN-CD-2          PIC X.
   880
   881         16  PI-UPDATE-STATUS-SAVE.
   882             20  PI-UPDATE-BY            PIC X(4).
   883             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   884
   885         16  PI-LOWER-CASE-LETTERS       PIC X.
   886             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   887
   888*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   889*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   890*            88  CARRIER-CLM-CNTL            VALUE '2'.
   891
   892         16  PI-CERT-ACCESS-CONTROL      PIC X.
   893             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  21
* EL633.cbl
   894             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   895             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   896             88  ACCNT-CNTL                  VALUE '3'.
   897             88  CARR-ACCNT-CNTL             VALUE '4'.
   898
   899         16  PI-PROCESSOR-CAP-LIST.
   900             20  PI-SYSTEM-CONTROLS.
   901                24 PI-SYSTEM-DISPLAY     PIC X.
   902                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   903                24 PI-SYSTEM-MODIFY      PIC X.
   904                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   905             20  FILLER                  PIC XX.
   906             20  PI-DISPLAY-CAP          PIC X.
   907                 88  DISPLAY-CAP             VALUE 'Y'.
   908             20  PI-MODIFY-CAP           PIC X.
   909                 88  MODIFY-CAP              VALUE 'Y'.
   910             20  PI-MSG-AT-LOGON-CAP     PIC X.
   911                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   912             20  PI-FORCE-CAP            PIC X.
   913                 88  FORCE-CAP               VALUE 'Y'.
   914
   915         16  PI-PROGRAM-CONTROLS.
   916             20  PI-PGM-PRINT-OPT        PIC X.
   917             20  PI-PGM-FORMAT-OPT       PIC X.
   918             20  PI-PGM-PROCESS-OPT      PIC X.
   919             20  PI-PGM-TOTALS-OPT       PIC X.
   920
   921         16  PI-HELP-INTERFACE.
   922             20  PI-LAST-ERROR-NO        PIC X(4).
   923             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   924
   925         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   926             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   927
   928         16  PI-CR-CONTROL-IN-PROGRESS.
   929             20  PI-CR-CARRIER           PIC X.
   930             20  PI-CR-GROUPING          PIC X(6).
   931             20  PI-CR-STATE             PIC XX.
   932             20  PI-CR-ACCOUNT           PIC X(10).
   933             20  PI-CR-FIN-RESP          PIC X(10).
   934             20  PI-CR-TYPE              PIC X.
   935
   936         16  PI-CR-BATCH-NUMBER          PIC X(6).
   937
   938         16  PI-CR-MONTH-END-DT          PIC XX.
   939
   940         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   941             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   942             88  PI-ZERO-CARRIER             VALUE '1'.
   943             88  PI-ZERO-GROUPING            VALUE '2'.
   944             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   945
   946         16  PI-CARRIER-SECURITY         PIC X.
   947             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   948
   949         16  PI-ACCOUNT-SECURITY         PIC X(10).
   950             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   951             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  22
* EL633.cbl
   952
   953         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   954             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   955                                         INDEXED BY PI-ACCESS-NDX
   956                                         PIC X.
   957
   958         16  PI-GA-BILLING-CONTROL       PIC X.
   959             88  PI-GA-BILLING               VALUE '1'.
   960
   961         16  PI-MAIL-PROCESSING          PIC X.
   962             88  PI-MAIL-YES                 VALUE 'Y'.
   963
   964         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   965
   966         16  PI-AR-SYSTEM.
   967             20  PI-AR-PROCESSING-CNTL   PIC X.
   968                 88  PI-AR-PROCESSING        VALUE 'Y'.
   969             20  PI-AR-SUMMARY-CODE      PIC X(6).
   970             20  PI-AR-MONTH-END-DT      PIC XX.
   971
   972         16  PI-MP-SYSTEM.
   973             20  PI-MORTGAGE-USER            PIC X.
   974                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   975                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   976             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   977                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   978                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   979                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   980                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   981                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   982             20  PI-MP-MONTH-END-DT          PIC XX.
   983             20  PI-MP-REFERENCE-NO.
   984                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   985                 24  PI-MP-REFERENCE-SFX     PIC XX.
   986
   987         16  PI-LABEL-CONTROL            PIC X(01).
   988             88  PI-CREATE-LABELS                    VALUE 'Y'.
   989             88  PI-BYPASS-LABELS                    VALUE 'N'.
   990
   991         16  PI-BILL-GROUPING-CODE       PIC X(01).
   992             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   993
   994         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   995             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   996             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   997
   998         16  FILLER                      PIC X(14).
   999
  1000     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1001******************************************************************
  1002     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1003         16  PI-PYAJ-FILE-SW             PIC  X.
  1004             88  END-OF-ACCT                 VALUE 'A'.
  1005             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
  1006             88  END-OF-FILE                 VALUE 'X'.
  1007             88  TOP-OF-FILE                 VALUE 'T'.
  1008             88  PAGE-FULL                   VALUE 'F'.
  1009             88  NO-RECORDS                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  23
* EL633.cbl
  1010             88  NOT-OPEN                    VALUE 'Z'.
  1011         16  PI-PREV-FUNCTION            PIC  X.
  1012         16  PI-SAV-FUNCTION             PIC  X.
  1013         16  PI-PREV-PFKEY               PIC  X.
  1014         16  PI-SEQ-NOS.
  1015             20  FILLER  OCCURS 13 TIMES
  1016                             INDEXED BY NDX.
  1017                 24  PI-REC-TYPE         PIC  X.
  1018                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
  1019         16  PI-SAV-ENDING-PYAJ-KEY.
  1020             20  PI-SAV-COMP-CD          PIC  X.
  1021             20  PI-SAV-COMP-CONTROL.
  1022                 24  PI-SAV-CARRIER      PIC  X.
  1023                 24  PI-SAV-GROUPING     PIC  X(6).
  1024                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1025                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1026                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
  1027                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1028         16  PI-START-PYAJ-KEY           PIC  X(33).
  1029         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
  1030         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1031         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1032         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1033         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1034             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1035         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1036         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1037         16  PI-FRST-RECORD-TYPE         PIC  X.
  1038         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1039         16  PI-PREV-RECORD-TYPE         PIC  X.
  1040         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1041         16  PI-LAST-RECORD-TYPE         PIC  X.
  1042         16  PI-PAGE-SW                  PIC  X.
  1043             88  FIRST-PAGE                          VALUE 'Y'.
  1044         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  24
* EL633.cbl
  1046*                            COPY ELCJPFX.
  1047******************************************************************
  1048*                                                                *
  1049*                                                                *
  1050*                            ELCJPFX.                            *
  1051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1052*                            VMOD=2.002                          *
  1053*                                                                *
  1054*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1055*                                                                *
  1056*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1057*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1058*        ELCNTL - CONTROL FILE                                   *
  1059*        ELMSTR - CLAIM MASTERS                                  *
  1060*        ELTRLR - ACTIVITY TRAILERS                              *
  1061*        ELCHKQ - CHECK QUE                                      *
  1062******************************************************************
  1063 01  JOURNAL-RECORD.
  1064     12  jp-date                     pic s9(5) comp-3.
  1065     12  jp-time                     pic s9(7) comp-3.
  1066     12  JP-USER-ID                  PIC X(4).
  1067     12  JP-FILE-ID                  PIC X(8).
  1068     12  JP-PROGRAM-ID               PIC X(8).
  1069     12  JP-RECORD-TYPE              PIC X.
  1070         88 JP-ADD              VALUE 'A'.
  1071         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1072         88 JP-AFTER-CHANGE     VALUE 'C'.
  1073         88 JP-DELETE           VALUE 'D'.
  1074         88 JP-GENERIC-DELETE   VALUE 'G'.
  1075         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1076         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1077     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1078     12  JP-RECORD-AREA
  1079
  1080
  1081                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  25
* EL633.cbl
  1083*                            COPY ELCAID.
  1084******************************************************************
  1085*                                                                *
  1086*                            ELCAID.                             *
  1087*                            VMOD=2.001                          *
  1088*                                                                *
  1089*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1090*                                                                *
  1091*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1092*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1093******************************************************************
  1094
  1095 01  DFHAID.
  1096   02  DFHNULL   PIC  X  VALUE  ' '.
  1097   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1098   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1099   02  DFHPEN    PIC  X  VALUE  '='.
  1100   02  DFHOPID   PIC  X  VALUE  'W'.
  1101   02  DFHPA1    PIC  X  VALUE  '%'.
  1102   02  DFHPA2    PIC  X  VALUE  '>'.
  1103   02  DFHPA3    PIC  X  VALUE  ','.
  1104   02  DFHPF1    PIC  X  VALUE  '1'.
  1105   02  DFHPF2    PIC  X  VALUE  '2'.
  1106   02  DFHPF3    PIC  X  VALUE  '3'.
  1107   02  DFHPF4    PIC  X  VALUE  '4'.
  1108   02  DFHPF5    PIC  X  VALUE  '5'.
  1109   02  DFHPF6    PIC  X  VALUE  '6'.
  1110   02  DFHPF7    PIC  X  VALUE  '7'.
  1111   02  DFHPF8    PIC  X  VALUE  '8'.
  1112   02  DFHPF9    PIC  X  VALUE  '9'.
  1113   02  DFHPF10   PIC  X  VALUE  ':'.
  1114   02  DFHPF11   PIC  X  VALUE  '#'.
  1115   02  DFHPF12   PIC  X  VALUE  '@'.
  1116   02  DFHPF13   PIC  X  VALUE  'A'.
  1117   02  DFHPF14   PIC  X  VALUE  'B'.
  1118   02  DFHPF15   PIC  X  VALUE  'C'.
  1119   02  DFHPF16   PIC  X  VALUE  'D'.
  1120   02  DFHPF17   PIC  X  VALUE  'E'.
  1121   02  DFHPF18   PIC  X  VALUE  'F'.
  1122   02  DFHPF19   PIC  X  VALUE  'G'.
  1123   02  DFHPF20   PIC  X  VALUE  'H'.
  1124   02  DFHPF21   PIC  X  VALUE  'I'.
  1125*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1126   02  DFHPF22   PIC  X  VALUE  '['.
  1127   02  DFHPF23   PIC  X  VALUE  '.'.
  1128   02  DFHPF24   PIC  X  VALUE  '<'.
  1129   02  DFHMSRE   PIC  X  VALUE  'X'.
  1130   02  DFHSTRF   PIC  X  VALUE  'h'.
  1131   02  DFHTRIG   PIC  X  VALUE  '"'.
  1132
  1133 01  FILLER  REDEFINES  DFHAID.
  1134     12  FILLER              PIC  X(8).
  1135     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  26
* EL633.cbl
  1137*                            COPY EL633S.
  1138 01  EL633AI.
  1139     05  FILLER            PIC  X(0012).
  1140*    -------------------------------
  1141     05  DATEL PIC S9(0004) COMP.
  1142     05  DATEF PIC  X(0001).
  1143     05  FILLER REDEFINES DATEF.
  1144         10  DATEA PIC  X(0001).
  1145     05  DATEI PIC  X(0008).
  1146*    -------------------------------
  1147     05  TIMEL PIC S9(0004) COMP.
  1148     05  TIMEF PIC  X(0001).
  1149     05  FILLER REDEFINES TIMEF.
  1150         10  TIMEA PIC  X(0001).
  1151     05  TIMEI PIC  X(0005).
  1152*    -------------------------------
  1153     05  CMPNYIDL PIC S9(0004) COMP.
  1154     05  CMPNYIDF PIC  X(0001).
  1155     05  FILLER REDEFINES CMPNYIDF.
  1156         10  CMPNYIDA PIC  X(0001).
  1157     05  CMPNYIDI PIC  X(0003).
  1158*    -------------------------------
  1159     05  USERIDL PIC S9(0004) COMP.
  1160     05  USERIDF PIC  X(0001).
  1161     05  FILLER REDEFINES USERIDF.
  1162         10  USERIDA PIC  X(0001).
  1163     05  USERIDI PIC  X(0004).
  1164*    -------------------------------
  1165     05  MAINTL PIC S9(0004) COMP.
  1166     05  MAINTF PIC  X(0001).
  1167     05  FILLER REDEFINES MAINTF.
  1168         10  MAINTA PIC  X(0001).
  1169     05  MAINTI PIC  X(0001).
  1170*    -------------------------------
  1171     05  CARRIERL PIC S9(0004) COMP.
  1172     05  CARRIERF PIC  X(0001).
  1173     05  FILLER REDEFINES CARRIERF.
  1174         10  CARRIERA PIC  X(0001).
  1175     05  CARRIERI PIC  X(0001).
  1176*    -------------------------------
  1177     05  GROUPL PIC S9(0004) COMP.
  1178     05  GROUPF PIC  X(0001).
  1179     05  FILLER REDEFINES GROUPF.
  1180         10  GROUPA PIC  X(0001).
  1181     05  GROUPI PIC  X(0006).
  1182*    -------------------------------
  1183     05  FINRESPL PIC S9(0004) COMP.
  1184     05  FINRESPF PIC  X(0001).
  1185     05  FILLER REDEFINES FINRESPF.
  1186         10  FINRESPA PIC  X(0001).
  1187     05  FINRESPI PIC  X(0010).
  1188*    -------------------------------
  1189     05  ACCTL PIC S9(0004) COMP.
  1190     05  ACCTF PIC  X(0001).
  1191     05  FILLER REDEFINES ACCTF.
  1192         10  ACCTA PIC  X(0001).
  1193     05  ACCTI PIC  X(0010).
  1194*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  27
* EL633.cbl
  1195     05  MSAAC1L PIC S9(0004) COMP.
  1196     05  MSAAC1F PIC  X(0001).
  1197     05  FILLER REDEFINES MSAAC1F.
  1198         10  MSAAC1A PIC  X(0001).
  1199     05  MSAAC1I PIC  X(0010).
  1200*    -------------------------------
  1201     05  MSAST1L PIC S9(0004) COMP.
  1202     05  MSAST1F PIC  X(0001).
  1203     05  FILLER REDEFINES MSAST1F.
  1204         10  MSAST1A PIC  X(0001).
  1205     05  MSAST1I PIC  X(0002).
  1206*    -------------------------------
  1207     05  MSACN1L PIC S9(0004) COMP.
  1208     05  MSACN1F PIC  X(0001).
  1209     05  FILLER REDEFINES MSACN1F.
  1210         10  MSACN1A PIC  X(0001).
  1211     05  MSACN1I PIC  X(0001).
  1212*    -------------------------------
  1213     05  MSACM1L PIC S9(0004) COMP.
  1214     05  MSACM1F PIC  X(0001).
  1215     05  FILLER REDEFINES MSACM1F.
  1216         10  MSACM1A PIC  X(0001).
  1217     05  MSACM1I PIC  X(0010).
  1218*    -------------------------------
  1219     05  TYPE1L PIC S9(0004) COMP.
  1220     05  TYPE1F PIC  X(0001).
  1221     05  FILLER REDEFINES TYPE1F.
  1222         10  TYPE1A PIC  X(0001).
  1223     05  TYPE1I PIC  X(0001).
  1224*    -------------------------------
  1225     05  AMT1L PIC S9(0004) COMP.
  1226     05  AMT1F PIC  X(0001).
  1227     05  FILLER REDEFINES AMT1F.
  1228         10  AMT1A PIC  X(0001).
  1229     05  AMT1I PIC  X(0011).
  1230*    -------------------------------
  1231     05  VOID1L PIC S9(0004) COMP.
  1232     05  VOID1F PIC  X(0001).
  1233     05  FILLER REDEFINES VOID1F.
  1234         10  VOID1A PIC  X(0001).
  1235     05  VOID1I PIC  X(0001).
  1236*    -------------------------------
  1237     05  MDT1L PIC S9(0004) COMP.
  1238     05  MDT1F PIC  X(0001).
  1239     05  FILLER REDEFINES MDT1F.
  1240         10  MDT1A PIC  X(0001).
  1241     05  MDT1I PIC  X(0006).
  1242*    -------------------------------
  1243     05  BDT1L PIC S9(0004) COMP.
  1244     05  BDT1F PIC  X(0001).
  1245     05  FILLER REDEFINES BDT1F.
  1246         10  BDT1A PIC  X(0001).
  1247     05  BDT1I PIC  X(0006).
  1248*    -------------------------------
  1249     05  SDT1L PIC S9(0004) COMP.
  1250     05  SDT1F PIC  X(0001).
  1251     05  FILLER REDEFINES SDT1F.
  1252         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  28
* EL633.cbl
  1253     05  SDT1I PIC  X(0006).
  1254*    -------------------------------
  1255     05  MSAAC2L PIC S9(0004) COMP.
  1256     05  MSAAC2F PIC  X(0001).
  1257     05  FILLER REDEFINES MSAAC2F.
  1258         10  MSAAC2A PIC  X(0001).
  1259     05  MSAAC2I PIC  X(0010).
  1260*    -------------------------------
  1261     05  MSAST2L PIC S9(0004) COMP.
  1262     05  MSAST2F PIC  X(0001).
  1263     05  FILLER REDEFINES MSAST2F.
  1264         10  MSAST2A PIC  X(0001).
  1265     05  MSAST2I PIC  X(0002).
  1266*    -------------------------------
  1267     05  MSACN2L PIC S9(0004) COMP.
  1268     05  MSACN2F PIC  X(0001).
  1269     05  FILLER REDEFINES MSACN2F.
  1270         10  MSACN2A PIC  X(0001).
  1271     05  MSACN2I PIC  X(0001).
  1272*    -------------------------------
  1273     05  MSACM2L PIC S9(0004) COMP.
  1274     05  MSACM2F PIC  X(0001).
  1275     05  FILLER REDEFINES MSACM2F.
  1276         10  MSACM2A PIC  X(0001).
  1277     05  MSACM2I PIC  X(0010).
  1278*    -------------------------------
  1279     05  TYPE2L PIC S9(0004) COMP.
  1280     05  TYPE2F PIC  X(0001).
  1281     05  FILLER REDEFINES TYPE2F.
  1282         10  TYPE2A PIC  X(0001).
  1283     05  TYPE2I PIC  X(0001).
  1284*    -------------------------------
  1285     05  AMT2L PIC S9(0004) COMP.
  1286     05  AMT2F PIC  X(0001).
  1287     05  FILLER REDEFINES AMT2F.
  1288         10  AMT2A PIC  X(0001).
  1289     05  AMT2I PIC  X(0011).
  1290*    -------------------------------
  1291     05  VOID2L PIC S9(0004) COMP.
  1292     05  VOID2F PIC  X(0001).
  1293     05  FILLER REDEFINES VOID2F.
  1294         10  VOID2A PIC  X(0001).
  1295     05  VOID2I PIC  X(0001).
  1296*    -------------------------------
  1297     05  MDT2L PIC S9(0004) COMP.
  1298     05  MDT2F PIC  X(0001).
  1299     05  FILLER REDEFINES MDT2F.
  1300         10  MDT2A PIC  X(0001).
  1301     05  MDT2I PIC  X(0006).
  1302*    -------------------------------
  1303     05  BDT2L PIC S9(0004) COMP.
  1304     05  BDT2F PIC  X(0001).
  1305     05  FILLER REDEFINES BDT2F.
  1306         10  BDT2A PIC  X(0001).
  1307     05  BDT2I PIC  X(0006).
  1308*    -------------------------------
  1309     05  SDT2L PIC S9(0004) COMP.
  1310     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  29
* EL633.cbl
  1311     05  FILLER REDEFINES SDT2F.
  1312         10  SDT2A PIC  X(0001).
  1313     05  SDT2I PIC  X(0006).
  1314*    -------------------------------
  1315     05  MSAAC3L PIC S9(0004) COMP.
  1316     05  MSAAC3F PIC  X(0001).
  1317     05  FILLER REDEFINES MSAAC3F.
  1318         10  MSAAC3A PIC  X(0001).
  1319     05  MSAAC3I PIC  X(0010).
  1320*    -------------------------------
  1321     05  MSAST3L PIC S9(0004) COMP.
  1322     05  MSAST3F PIC  X(0001).
  1323     05  FILLER REDEFINES MSAST3F.
  1324         10  MSAST3A PIC  X(0001).
  1325     05  MSAST3I PIC  X(0002).
  1326*    -------------------------------
  1327     05  MSACN3L PIC S9(0004) COMP.
  1328     05  MSACN3F PIC  X(0001).
  1329     05  FILLER REDEFINES MSACN3F.
  1330         10  MSACN3A PIC  X(0001).
  1331     05  MSACN3I PIC  X(0001).
  1332*    -------------------------------
  1333     05  MSACM3L PIC S9(0004) COMP.
  1334     05  MSACM3F PIC  X(0001).
  1335     05  FILLER REDEFINES MSACM3F.
  1336         10  MSACM3A PIC  X(0001).
  1337     05  MSACM3I PIC  X(0010).
  1338*    -------------------------------
  1339     05  TYPE3L PIC S9(0004) COMP.
  1340     05  TYPE3F PIC  X(0001).
  1341     05  FILLER REDEFINES TYPE3F.
  1342         10  TYPE3A PIC  X(0001).
  1343     05  TYPE3I PIC  X(0001).
  1344*    -------------------------------
  1345     05  AMT3L PIC S9(0004) COMP.
  1346     05  AMT3F PIC  X(0001).
  1347     05  FILLER REDEFINES AMT3F.
  1348         10  AMT3A PIC  X(0001).
  1349     05  AMT3I PIC  X(0011).
  1350*    -------------------------------
  1351     05  VOID3L PIC S9(0004) COMP.
  1352     05  VOID3F PIC  X(0001).
  1353     05  FILLER REDEFINES VOID3F.
  1354         10  VOID3A PIC  X(0001).
  1355     05  VOID3I PIC  X(0001).
  1356*    -------------------------------
  1357     05  MDT3L PIC S9(0004) COMP.
  1358     05  MDT3F PIC  X(0001).
  1359     05  FILLER REDEFINES MDT3F.
  1360         10  MDT3A PIC  X(0001).
  1361     05  MDT3I PIC  X(0006).
  1362*    -------------------------------
  1363     05  BDT3L PIC S9(0004) COMP.
  1364     05  BDT3F PIC  X(0001).
  1365     05  FILLER REDEFINES BDT3F.
  1366         10  BDT3A PIC  X(0001).
  1367     05  BDT3I PIC  X(0006).
  1368*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  30
* EL633.cbl
  1369     05  SDT3L PIC S9(0004) COMP.
  1370     05  SDT3F PIC  X(0001).
  1371     05  FILLER REDEFINES SDT3F.
  1372         10  SDT3A PIC  X(0001).
  1373     05  SDT3I PIC  X(0006).
  1374*    -------------------------------
  1375     05  MSAAC4L PIC S9(0004) COMP.
  1376     05  MSAAC4F PIC  X(0001).
  1377     05  FILLER REDEFINES MSAAC4F.
  1378         10  MSAAC4A PIC  X(0001).
  1379     05  MSAAC4I PIC  X(0010).
  1380*    -------------------------------
  1381     05  MSAST4L PIC S9(0004) COMP.
  1382     05  MSAST4F PIC  X(0001).
  1383     05  FILLER REDEFINES MSAST4F.
  1384         10  MSAST4A PIC  X(0001).
  1385     05  MSAST4I PIC  X(0002).
  1386*    -------------------------------
  1387     05  MSACN4L PIC S9(0004) COMP.
  1388     05  MSACN4F PIC  X(0001).
  1389     05  FILLER REDEFINES MSACN4F.
  1390         10  MSACN4A PIC  X(0001).
  1391     05  MSACN4I PIC  X(0001).
  1392*    -------------------------------
  1393     05  MSACM4L PIC S9(0004) COMP.
  1394     05  MSACM4F PIC  X(0001).
  1395     05  FILLER REDEFINES MSACM4F.
  1396         10  MSACM4A PIC  X(0001).
  1397     05  MSACM4I PIC  X(0010).
  1398*    -------------------------------
  1399     05  TYPE4L PIC S9(0004) COMP.
  1400     05  TYPE4F PIC  X(0001).
  1401     05  FILLER REDEFINES TYPE4F.
  1402         10  TYPE4A PIC  X(0001).
  1403     05  TYPE4I PIC  X(0001).
  1404*    -------------------------------
  1405     05  AMT4L PIC S9(0004) COMP.
  1406     05  AMT4F PIC  X(0001).
  1407     05  FILLER REDEFINES AMT4F.
  1408         10  AMT4A PIC  X(0001).
  1409     05  AMT4I PIC  X(0011).
  1410*    -------------------------------
  1411     05  VOID4L PIC S9(0004) COMP.
  1412     05  VOID4F PIC  X(0001).
  1413     05  FILLER REDEFINES VOID4F.
  1414         10  VOID4A PIC  X(0001).
  1415     05  VOID4I PIC  X(0001).
  1416*    -------------------------------
  1417     05  MDT4L PIC S9(0004) COMP.
  1418     05  MDT4F PIC  X(0001).
  1419     05  FILLER REDEFINES MDT4F.
  1420         10  MDT4A PIC  X(0001).
  1421     05  MDT4I PIC  X(0006).
  1422*    -------------------------------
  1423     05  BDT4L PIC S9(0004) COMP.
  1424     05  BDT4F PIC  X(0001).
  1425     05  FILLER REDEFINES BDT4F.
  1426         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  31
* EL633.cbl
  1427     05  BDT4I PIC  X(0006).
  1428*    -------------------------------
  1429     05  SDT4L PIC S9(0004) COMP.
  1430     05  SDT4F PIC  X(0001).
  1431     05  FILLER REDEFINES SDT4F.
  1432         10  SDT4A PIC  X(0001).
  1433     05  SDT4I PIC  X(0006).
  1434*    -------------------------------
  1435     05  MSAAC5L PIC S9(0004) COMP.
  1436     05  MSAAC5F PIC  X(0001).
  1437     05  FILLER REDEFINES MSAAC5F.
  1438         10  MSAAC5A PIC  X(0001).
  1439     05  MSAAC5I PIC  X(0010).
  1440*    -------------------------------
  1441     05  MSAST5L PIC S9(0004) COMP.
  1442     05  MSAST5F PIC  X(0001).
  1443     05  FILLER REDEFINES MSAST5F.
  1444         10  MSAST5A PIC  X(0001).
  1445     05  MSAST5I PIC  X(0002).
  1446*    -------------------------------
  1447     05  MSACN5L PIC S9(0004) COMP.
  1448     05  MSACN5F PIC  X(0001).
  1449     05  FILLER REDEFINES MSACN5F.
  1450         10  MSACN5A PIC  X(0001).
  1451     05  MSACN5I PIC  X(0001).
  1452*    -------------------------------
  1453     05  MSACM5L PIC S9(0004) COMP.
  1454     05  MSACM5F PIC  X(0001).
  1455     05  FILLER REDEFINES MSACM5F.
  1456         10  MSACM5A PIC  X(0001).
  1457     05  MSACM5I PIC  X(0010).
  1458*    -------------------------------
  1459     05  TYPE5L PIC S9(0004) COMP.
  1460     05  TYPE5F PIC  X(0001).
  1461     05  FILLER REDEFINES TYPE5F.
  1462         10  TYPE5A PIC  X(0001).
  1463     05  TYPE5I PIC  X(0001).
  1464*    -------------------------------
  1465     05  AMT5L PIC S9(0004) COMP.
  1466     05  AMT5F PIC  X(0001).
  1467     05  FILLER REDEFINES AMT5F.
  1468         10  AMT5A PIC  X(0001).
  1469     05  AMT5I PIC  X(0011).
  1470*    -------------------------------
  1471     05  VOID5L PIC S9(0004) COMP.
  1472     05  VOID5F PIC  X(0001).
  1473     05  FILLER REDEFINES VOID5F.
  1474         10  VOID5A PIC  X(0001).
  1475     05  VOID5I PIC  X(0001).
  1476*    -------------------------------
  1477     05  MDT5L PIC S9(0004) COMP.
  1478     05  MDT5F PIC  X(0001).
  1479     05  FILLER REDEFINES MDT5F.
  1480         10  MDT5A PIC  X(0001).
  1481     05  MDT5I PIC  X(0006).
  1482*    -------------------------------
  1483     05  BDT5L PIC S9(0004) COMP.
  1484     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  32
* EL633.cbl
  1485     05  FILLER REDEFINES BDT5F.
  1486         10  BDT5A PIC  X(0001).
  1487     05  BDT5I PIC  X(0006).
  1488*    -------------------------------
  1489     05  SDT5L PIC S9(0004) COMP.
  1490     05  SDT5F PIC  X(0001).
  1491     05  FILLER REDEFINES SDT5F.
  1492         10  SDT5A PIC  X(0001).
  1493     05  SDT5I PIC  X(0006).
  1494*    -------------------------------
  1495     05  MSAAC6L PIC S9(0004) COMP.
  1496     05  MSAAC6F PIC  X(0001).
  1497     05  FILLER REDEFINES MSAAC6F.
  1498         10  MSAAC6A PIC  X(0001).
  1499     05  MSAAC6I PIC  X(0010).
  1500*    -------------------------------
  1501     05  MSAST6L PIC S9(0004) COMP.
  1502     05  MSAST6F PIC  X(0001).
  1503     05  FILLER REDEFINES MSAST6F.
  1504         10  MSAST6A PIC  X(0001).
  1505     05  MSAST6I PIC  X(0002).
  1506*    -------------------------------
  1507     05  MSACN6L PIC S9(0004) COMP.
  1508     05  MSACN6F PIC  X(0001).
  1509     05  FILLER REDEFINES MSACN6F.
  1510         10  MSACN6A PIC  X(0001).
  1511     05  MSACN6I PIC  X(0001).
  1512*    -------------------------------
  1513     05  MSACM6L PIC S9(0004) COMP.
  1514     05  MSACM6F PIC  X(0001).
  1515     05  FILLER REDEFINES MSACM6F.
  1516         10  MSACM6A PIC  X(0001).
  1517     05  MSACM6I PIC  X(0010).
  1518*    -------------------------------
  1519     05  TYPE6L PIC S9(0004) COMP.
  1520     05  TYPE6F PIC  X(0001).
  1521     05  FILLER REDEFINES TYPE6F.
  1522         10  TYPE6A PIC  X(0001).
  1523     05  TYPE6I PIC  X(0001).
  1524*    -------------------------------
  1525     05  AMT6L PIC S9(0004) COMP.
  1526     05  AMT6F PIC  X(0001).
  1527     05  FILLER REDEFINES AMT6F.
  1528         10  AMT6A PIC  X(0001).
  1529     05  AMT6I PIC  X(0011).
  1530*    -------------------------------
  1531     05  VOID6L PIC S9(0004) COMP.
  1532     05  VOID6F PIC  X(0001).
  1533     05  FILLER REDEFINES VOID6F.
  1534         10  VOID6A PIC  X(0001).
  1535     05  VOID6I PIC  X(0001).
  1536*    -------------------------------
  1537     05  MDT6L PIC S9(0004) COMP.
  1538     05  MDT6F PIC  X(0001).
  1539     05  FILLER REDEFINES MDT6F.
  1540         10  MDT6A PIC  X(0001).
  1541     05  MDT6I PIC  X(0006).
  1542*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  33
* EL633.cbl
  1543     05  BDT6L PIC S9(0004) COMP.
  1544     05  BDT6F PIC  X(0001).
  1545     05  FILLER REDEFINES BDT6F.
  1546         10  BDT6A PIC  X(0001).
  1547     05  BDT6I PIC  X(0006).
  1548*    -------------------------------
  1549     05  SDT6L PIC S9(0004) COMP.
  1550     05  SDT6F PIC  X(0001).
  1551     05  FILLER REDEFINES SDT6F.
  1552         10  SDT6A PIC  X(0001).
  1553     05  SDT6I PIC  X(0006).
  1554*    -------------------------------
  1555     05  MSAAC7L PIC S9(0004) COMP.
  1556     05  MSAAC7F PIC  X(0001).
  1557     05  FILLER REDEFINES MSAAC7F.
  1558         10  MSAAC7A PIC  X(0001).
  1559     05  MSAAC7I PIC  X(0010).
  1560*    -------------------------------
  1561     05  MSAST7L PIC S9(0004) COMP.
  1562     05  MSAST7F PIC  X(0001).
  1563     05  FILLER REDEFINES MSAST7F.
  1564         10  MSAST7A PIC  X(0001).
  1565     05  MSAST7I PIC  X(0002).
  1566*    -------------------------------
  1567     05  MSACN7L PIC S9(0004) COMP.
  1568     05  MSACN7F PIC  X(0001).
  1569     05  FILLER REDEFINES MSACN7F.
  1570         10  MSACN7A PIC  X(0001).
  1571     05  MSACN7I PIC  X(0001).
  1572*    -------------------------------
  1573     05  MSACM7L PIC S9(0004) COMP.
  1574     05  MSACM7F PIC  X(0001).
  1575     05  FILLER REDEFINES MSACM7F.
  1576         10  MSACM7A PIC  X(0001).
  1577     05  MSACM7I PIC  X(0010).
  1578*    -------------------------------
  1579     05  TYPE7L PIC S9(0004) COMP.
  1580     05  TYPE7F PIC  X(0001).
  1581     05  FILLER REDEFINES TYPE7F.
  1582         10  TYPE7A PIC  X(0001).
  1583     05  TYPE7I PIC  X(0001).
  1584*    -------------------------------
  1585     05  AMT7L PIC S9(0004) COMP.
  1586     05  AMT7F PIC  X(0001).
  1587     05  FILLER REDEFINES AMT7F.
  1588         10  AMT7A PIC  X(0001).
  1589     05  AMT7I PIC  X(0011).
  1590*    -------------------------------
  1591     05  VOID7L PIC S9(0004) COMP.
  1592     05  VOID7F PIC  X(0001).
  1593     05  FILLER REDEFINES VOID7F.
  1594         10  VOID7A PIC  X(0001).
  1595     05  VOID7I PIC  X(0001).
  1596*    -------------------------------
  1597     05  MDT7L PIC S9(0004) COMP.
  1598     05  MDT7F PIC  X(0001).
  1599     05  FILLER REDEFINES MDT7F.
  1600         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  34
* EL633.cbl
  1601     05  MDT7I PIC  X(0006).
  1602*    -------------------------------
  1603     05  BDT7L PIC S9(0004) COMP.
  1604     05  BDT7F PIC  X(0001).
  1605     05  FILLER REDEFINES BDT7F.
  1606         10  BDT7A PIC  X(0001).
  1607     05  BDT7I PIC  X(0006).
  1608*    -------------------------------
  1609     05  SDT7L PIC S9(0004) COMP.
  1610     05  SDT7F PIC  X(0001).
  1611     05  FILLER REDEFINES SDT7F.
  1612         10  SDT7A PIC  X(0001).
  1613     05  SDT7I PIC  X(0006).
  1614*    -------------------------------
  1615     05  MSAAC8L PIC S9(0004) COMP.
  1616     05  MSAAC8F PIC  X(0001).
  1617     05  FILLER REDEFINES MSAAC8F.
  1618         10  MSAAC8A PIC  X(0001).
  1619     05  MSAAC8I PIC  X(0010).
  1620*    -------------------------------
  1621     05  MSAST8L PIC S9(0004) COMP.
  1622     05  MSAST8F PIC  X(0001).
  1623     05  FILLER REDEFINES MSAST8F.
  1624         10  MSAST8A PIC  X(0001).
  1625     05  MSAST8I PIC  X(0002).
  1626*    -------------------------------
  1627     05  MSACN8L PIC S9(0004) COMP.
  1628     05  MSACN8F PIC  X(0001).
  1629     05  FILLER REDEFINES MSACN8F.
  1630         10  MSACN8A PIC  X(0001).
  1631     05  MSACN8I PIC  X(0001).
  1632*    -------------------------------
  1633     05  MSACM8L PIC S9(0004) COMP.
  1634     05  MSACM8F PIC  X(0001).
  1635     05  FILLER REDEFINES MSACM8F.
  1636         10  MSACM8A PIC  X(0001).
  1637     05  MSACM8I PIC  X(0010).
  1638*    -------------------------------
  1639     05  TYPE8L PIC S9(0004) COMP.
  1640     05  TYPE8F PIC  X(0001).
  1641     05  FILLER REDEFINES TYPE8F.
  1642         10  TYPE8A PIC  X(0001).
  1643     05  TYPE8I PIC  X(0001).
  1644*    -------------------------------
  1645     05  AMT8L PIC S9(0004) COMP.
  1646     05  AMT8F PIC  X(0001).
  1647     05  FILLER REDEFINES AMT8F.
  1648         10  AMT8A PIC  X(0001).
  1649     05  AMT8I PIC  X(0011).
  1650*    -------------------------------
  1651     05  VOID8L PIC S9(0004) COMP.
  1652     05  VOID8F PIC  X(0001).
  1653     05  FILLER REDEFINES VOID8F.
  1654         10  VOID8A PIC  X(0001).
  1655     05  VOID8I PIC  X(0001).
  1656*    -------------------------------
  1657     05  MDT8L PIC S9(0004) COMP.
  1658     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  35
* EL633.cbl
  1659     05  FILLER REDEFINES MDT8F.
  1660         10  MDT8A PIC  X(0001).
  1661     05  MDT8I PIC  X(0006).
  1662*    -------------------------------
  1663     05  BDT8L PIC S9(0004) COMP.
  1664     05  BDT8F PIC  X(0001).
  1665     05  FILLER REDEFINES BDT8F.
  1666         10  BDT8A PIC  X(0001).
  1667     05  BDT8I PIC  X(0006).
  1668*    -------------------------------
  1669     05  SDT8L PIC S9(0004) COMP.
  1670     05  SDT8F PIC  X(0001).
  1671     05  FILLER REDEFINES SDT8F.
  1672         10  SDT8A PIC  X(0001).
  1673     05  SDT8I PIC  X(0006).
  1674*    -------------------------------
  1675     05  MSAAC9L PIC S9(0004) COMP.
  1676     05  MSAAC9F PIC  X(0001).
  1677     05  FILLER REDEFINES MSAAC9F.
  1678         10  MSAAC9A PIC  X(0001).
  1679     05  MSAAC9I PIC  X(0010).
  1680*    -------------------------------
  1681     05  MSAST9L PIC S9(0004) COMP.
  1682     05  MSAST9F PIC  X(0001).
  1683     05  FILLER REDEFINES MSAST9F.
  1684         10  MSAST9A PIC  X(0001).
  1685     05  MSAST9I PIC  X(0002).
  1686*    -------------------------------
  1687     05  MSACN9L PIC S9(0004) COMP.
  1688     05  MSACN9F PIC  X(0001).
  1689     05  FILLER REDEFINES MSACN9F.
  1690         10  MSACN9A PIC  X(0001).
  1691     05  MSACN9I PIC  X(0001).
  1692*    -------------------------------
  1693     05  MSACM9L PIC S9(0004) COMP.
  1694     05  MSACM9F PIC  X(0001).
  1695     05  FILLER REDEFINES MSACM9F.
  1696         10  MSACM9A PIC  X(0001).
  1697     05  MSACM9I PIC  X(0010).
  1698*    -------------------------------
  1699     05  TYPE9L PIC S9(0004) COMP.
  1700     05  TYPE9F PIC  X(0001).
  1701     05  FILLER REDEFINES TYPE9F.
  1702         10  TYPE9A PIC  X(0001).
  1703     05  TYPE9I PIC  X(0001).
  1704*    -------------------------------
  1705     05  AMT9L PIC S9(0004) COMP.
  1706     05  AMT9F PIC  X(0001).
  1707     05  FILLER REDEFINES AMT9F.
  1708         10  AMT9A PIC  X(0001).
  1709     05  AMT9I PIC  X(0011).
  1710*    -------------------------------
  1711     05  VOID9L PIC S9(0004) COMP.
  1712     05  VOID9F PIC  X(0001).
  1713     05  FILLER REDEFINES VOID9F.
  1714         10  VOID9A PIC  X(0001).
  1715     05  VOID9I PIC  X(0001).
  1716*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  36
* EL633.cbl
  1717     05  MDT9L PIC S9(0004) COMP.
  1718     05  MDT9F PIC  X(0001).
  1719     05  FILLER REDEFINES MDT9F.
  1720         10  MDT9A PIC  X(0001).
  1721     05  MDT9I PIC  X(0006).
  1722*    -------------------------------
  1723     05  BDT9L PIC S9(0004) COMP.
  1724     05  BDT9F PIC  X(0001).
  1725     05  FILLER REDEFINES BDT9F.
  1726         10  BDT9A PIC  X(0001).
  1727     05  BDT9I PIC  X(0006).
  1728*    -------------------------------
  1729     05  SDT9L PIC S9(0004) COMP.
  1730     05  SDT9F PIC  X(0001).
  1731     05  FILLER REDEFINES SDT9F.
  1732         10  SDT9A PIC  X(0001).
  1733     05  SDT9I PIC  X(0006).
  1734*    -------------------------------
  1735     05  MSAAC10L PIC S9(0004) COMP.
  1736     05  MSAAC10F PIC  X(0001).
  1737     05  FILLER REDEFINES MSAAC10F.
  1738         10  MSAAC10A PIC  X(0001).
  1739     05  MSAAC10I PIC  X(0010).
  1740*    -------------------------------
  1741     05  MSAST10L PIC S9(0004) COMP.
  1742     05  MSAST10F PIC  X(0001).
  1743     05  FILLER REDEFINES MSAST10F.
  1744         10  MSAST10A PIC  X(0001).
  1745     05  MSAST10I PIC  X(0002).
  1746*    -------------------------------
  1747     05  MSACN10L PIC S9(0004) COMP.
  1748     05  MSACN10F PIC  X(0001).
  1749     05  FILLER REDEFINES MSACN10F.
  1750         10  MSACN10A PIC  X(0001).
  1751     05  MSACN10I PIC  X(0001).
  1752*    -------------------------------
  1753     05  MSACM10L PIC S9(0004) COMP.
  1754     05  MSACM10F PIC  X(0001).
  1755     05  FILLER REDEFINES MSACM10F.
  1756         10  MSACM10A PIC  X(0001).
  1757     05  MSACM10I PIC  X(0010).
  1758*    -------------------------------
  1759     05  TYPE10L PIC S9(0004) COMP.
  1760     05  TYPE10F PIC  X(0001).
  1761     05  FILLER REDEFINES TYPE10F.
  1762         10  TYPE10A PIC  X(0001).
  1763     05  TYPE10I PIC  X(0001).
  1764*    -------------------------------
  1765     05  AMT10L PIC S9(0004) COMP.
  1766     05  AMT10F PIC  X(0001).
  1767     05  FILLER REDEFINES AMT10F.
  1768         10  AMT10A PIC  X(0001).
  1769     05  AMT10I PIC  X(0011).
  1770*    -------------------------------
  1771     05  VOID10L PIC S9(0004) COMP.
  1772     05  VOID10F PIC  X(0001).
  1773     05  FILLER REDEFINES VOID10F.
  1774         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  37
* EL633.cbl
  1775     05  VOID10I PIC  X(0001).
  1776*    -------------------------------
  1777     05  MDT10L PIC S9(0004) COMP.
  1778     05  MDT10F PIC  X(0001).
  1779     05  FILLER REDEFINES MDT10F.
  1780         10  MDT10A PIC  X(0001).
  1781     05  MDT10I PIC  X(0006).
  1782*    -------------------------------
  1783     05  BDT10L PIC S9(0004) COMP.
  1784     05  BDT10F PIC  X(0001).
  1785     05  FILLER REDEFINES BDT10F.
  1786         10  BDT10A PIC  X(0001).
  1787     05  BDT10I PIC  X(0006).
  1788*    -------------------------------
  1789     05  SDT10L PIC S9(0004) COMP.
  1790     05  SDT10F PIC  X(0001).
  1791     05  FILLER REDEFINES SDT10F.
  1792         10  SDT10A PIC  X(0001).
  1793     05  SDT10I PIC  X(0006).
  1794*    -------------------------------
  1795     05  MSAAC11L PIC S9(0004) COMP.
  1796     05  MSAAC11F PIC  X(0001).
  1797     05  FILLER REDEFINES MSAAC11F.
  1798         10  MSAAC11A PIC  X(0001).
  1799     05  MSAAC11I PIC  X(0010).
  1800*    -------------------------------
  1801     05  MSAST11L PIC S9(0004) COMP.
  1802     05  MSAST11F PIC  X(0001).
  1803     05  FILLER REDEFINES MSAST11F.
  1804         10  MSAST11A PIC  X(0001).
  1805     05  MSAST11I PIC  X(0002).
  1806*    -------------------------------
  1807     05  MSACN11L PIC S9(0004) COMP.
  1808     05  MSACN11F PIC  X(0001).
  1809     05  FILLER REDEFINES MSACN11F.
  1810         10  MSACN11A PIC  X(0001).
  1811     05  MSACN11I PIC  X(0001).
  1812*    -------------------------------
  1813     05  MSACM11L PIC S9(0004) COMP.
  1814     05  MSACM11F PIC  X(0001).
  1815     05  FILLER REDEFINES MSACM11F.
  1816         10  MSACM11A PIC  X(0001).
  1817     05  MSACM11I PIC  X(0010).
  1818*    -------------------------------
  1819     05  TYPE11L PIC S9(0004) COMP.
  1820     05  TYPE11F PIC  X(0001).
  1821     05  FILLER REDEFINES TYPE11F.
  1822         10  TYPE11A PIC  X(0001).
  1823     05  TYPE11I PIC  X(0001).
  1824*    -------------------------------
  1825     05  AMT11L PIC S9(0004) COMP.
  1826     05  AMT11F PIC  X(0001).
  1827     05  FILLER REDEFINES AMT11F.
  1828         10  AMT11A PIC  X(0001).
  1829     05  AMT11I PIC  X(0011).
  1830*    -------------------------------
  1831     05  VOID11L PIC S9(0004) COMP.
  1832     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  38
* EL633.cbl
  1833     05  FILLER REDEFINES VOID11F.
  1834         10  VOID11A PIC  X(0001).
  1835     05  VOID11I PIC  X(0001).
  1836*    -------------------------------
  1837     05  MDT11L PIC S9(0004) COMP.
  1838     05  MDT11F PIC  X(0001).
  1839     05  FILLER REDEFINES MDT11F.
  1840         10  MDT11A PIC  X(0001).
  1841     05  MDT11I PIC  X(0006).
  1842*    -------------------------------
  1843     05  BDT11L PIC S9(0004) COMP.
  1844     05  BDT11F PIC  X(0001).
  1845     05  FILLER REDEFINES BDT11F.
  1846         10  BDT11A PIC  X(0001).
  1847     05  BDT11I PIC  X(0006).
  1848*    -------------------------------
  1849     05  SDT11L PIC S9(0004) COMP.
  1850     05  SDT11F PIC  X(0001).
  1851     05  FILLER REDEFINES SDT11F.
  1852         10  SDT11A PIC  X(0001).
  1853     05  SDT11I PIC  X(0006).
  1854*    -------------------------------
  1855     05  MSAAC12L PIC S9(0004) COMP.
  1856     05  MSAAC12F PIC  X(0001).
  1857     05  FILLER REDEFINES MSAAC12F.
  1858         10  MSAAC12A PIC  X(0001).
  1859     05  MSAAC12I PIC  X(0010).
  1860*    -------------------------------
  1861     05  MSAST12L PIC S9(0004) COMP.
  1862     05  MSAST12F PIC  X(0001).
  1863     05  FILLER REDEFINES MSAST12F.
  1864         10  MSAST12A PIC  X(0001).
  1865     05  MSAST12I PIC  X(0002).
  1866*    -------------------------------
  1867     05  MSACN12L PIC S9(0004) COMP.
  1868     05  MSACN12F PIC  X(0001).
  1869     05  FILLER REDEFINES MSACN12F.
  1870         10  MSACN12A PIC  X(0001).
  1871     05  MSACN12I PIC  X(0001).
  1872*    -------------------------------
  1873     05  MSACM12L PIC S9(0004) COMP.
  1874     05  MSACM12F PIC  X(0001).
  1875     05  FILLER REDEFINES MSACM12F.
  1876         10  MSACM12A PIC  X(0001).
  1877     05  MSACM12I PIC  X(0010).
  1878*    -------------------------------
  1879     05  TYPE12L PIC S9(0004) COMP.
  1880     05  TYPE12F PIC  X(0001).
  1881     05  FILLER REDEFINES TYPE12F.
  1882         10  TYPE12A PIC  X(0001).
  1883     05  TYPE12I PIC  X(0001).
  1884*    -------------------------------
  1885     05  AMT12L PIC S9(0004) COMP.
  1886     05  AMT12F PIC  X(0001).
  1887     05  FILLER REDEFINES AMT12F.
  1888         10  AMT12A PIC  X(0001).
  1889     05  AMT12I PIC  X(0011).
  1890*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  39
* EL633.cbl
  1891     05  VOID12L PIC S9(0004) COMP.
  1892     05  VOID12F PIC  X(0001).
  1893     05  FILLER REDEFINES VOID12F.
  1894         10  VOID12A PIC  X(0001).
  1895     05  VOID12I PIC  X(0001).
  1896*    -------------------------------
  1897     05  MDT12L PIC S9(0004) COMP.
  1898     05  MDT12F PIC  X(0001).
  1899     05  FILLER REDEFINES MDT12F.
  1900         10  MDT12A PIC  X(0001).
  1901     05  MDT12I PIC  X(0006).
  1902*    -------------------------------
  1903     05  BDT12L PIC S9(0004) COMP.
  1904     05  BDT12F PIC  X(0001).
  1905     05  FILLER REDEFINES BDT12F.
  1906         10  BDT12A PIC  X(0001).
  1907     05  BDT12I PIC  X(0006).
  1908*    -------------------------------
  1909     05  SDT12L PIC S9(0004) COMP.
  1910     05  SDT12F PIC  X(0001).
  1911     05  FILLER REDEFINES SDT12F.
  1912         10  SDT12A PIC  X(0001).
  1913     05  SDT12I PIC  X(0006).
  1914*    -------------------------------
  1915     05  MSAAC13L PIC S9(0004) COMP.
  1916     05  MSAAC13F PIC  X(0001).
  1917     05  FILLER REDEFINES MSAAC13F.
  1918         10  MSAAC13A PIC  X(0001).
  1919     05  MSAAC13I PIC  X(0010).
  1920*    -------------------------------
  1921     05  MSAST13L PIC S9(0004) COMP.
  1922     05  MSAST13F PIC  X(0001).
  1923     05  FILLER REDEFINES MSAST13F.
  1924         10  MSAST13A PIC  X(0001).
  1925     05  MSAST13I PIC  X(0002).
  1926*    -------------------------------
  1927     05  MSACN13L PIC S9(0004) COMP.
  1928     05  MSACN13F PIC  X(0001).
  1929     05  FILLER REDEFINES MSACN13F.
  1930         10  MSACN13A PIC  X(0001).
  1931     05  MSACN13I PIC  X(0001).
  1932*    -------------------------------
  1933     05  MSACM13L PIC S9(0004) COMP.
  1934     05  MSACM13F PIC  X(0001).
  1935     05  FILLER REDEFINES MSACM13F.
  1936         10  MSACM13A PIC  X(0001).
  1937     05  MSACM13I PIC  X(0010).
  1938*    -------------------------------
  1939     05  TYPE13L PIC S9(0004) COMP.
  1940     05  TYPE13F PIC  X(0001).
  1941     05  FILLER REDEFINES TYPE13F.
  1942         10  TYPE13A PIC  X(0001).
  1943     05  TYPE13I PIC  X(0001).
  1944*    -------------------------------
  1945     05  AMT13L PIC S9(0004) COMP.
  1946     05  AMT13F PIC  X(0001).
  1947     05  FILLER REDEFINES AMT13F.
  1948         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  40
* EL633.cbl
  1949     05  AMT13I PIC  X(0011).
  1950*    -------------------------------
  1951     05  VOID13L PIC S9(0004) COMP.
  1952     05  VOID13F PIC  X(0001).
  1953     05  FILLER REDEFINES VOID13F.
  1954         10  VOID13A PIC  X(0001).
  1955     05  VOID13I PIC  X(0001).
  1956*    -------------------------------
  1957     05  MDT13L PIC S9(0004) COMP.
  1958     05  MDT13F PIC  X(0001).
  1959     05  FILLER REDEFINES MDT13F.
  1960         10  MDT13A PIC  X(0001).
  1961     05  MDT13I PIC  X(0006).
  1962*    -------------------------------
  1963     05  BDT13L PIC S9(0004) COMP.
  1964     05  BDT13F PIC  X(0001).
  1965     05  FILLER REDEFINES BDT13F.
  1966         10  BDT13A PIC  X(0001).
  1967     05  BDT13I PIC  X(0006).
  1968*    -------------------------------
  1969     05  SDT13L PIC S9(0004) COMP.
  1970     05  SDT13F PIC  X(0001).
  1971     05  FILLER REDEFINES SDT13F.
  1972         10  SDT13A PIC  X(0001).
  1973     05  SDT13I PIC  X(0006).
  1974*    -------------------------------
  1975     05  ERRMSG1L PIC S9(0004) COMP.
  1976     05  ERRMSG1F PIC  X(0001).
  1977     05  FILLER REDEFINES ERRMSG1F.
  1978         10  ERRMSG1A PIC  X(0001).
  1979     05  ERRMSG1I PIC  X(0079).
  1980*    -------------------------------
  1981     05  ERRMSG2L PIC S9(0004) COMP.
  1982     05  ERRMSG2F PIC  X(0001).
  1983     05  FILLER REDEFINES ERRMSG2F.
  1984         10  ERRMSG2A PIC  X(0001).
  1985     05  ERRMSG2I PIC  X(0079).
  1986*    -------------------------------
  1987     05  PFENTERL PIC S9(0004) COMP.
  1988     05  PFENTERF PIC  X(0001).
  1989     05  FILLER REDEFINES PFENTERF.
  1990         10  PFENTERA PIC  X(0001).
  1991     05  PFENTERI PIC  9(2).
  1992 01  EL633AO REDEFINES EL633AI.
  1993     05  FILLER            PIC  X(0012).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  DATEO PIC  X(0008).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  TIMEO PIC  99.99.
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  CMPNYIDO PIC  X(0003).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  USERIDO PIC  X(0004).
  2006*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  41
* EL633.cbl
  2007     05  FILLER            PIC  X(0003).
  2008     05  MAINTO PIC  X(0001).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  CARRIERO PIC  X(0001).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  GROUPO PIC  X(0006).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  FINRESPO PIC  X(0010).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  ACCTO PIC  X(0010).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  MSAAC1O PIC  X(0010).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  MSAST1O PIC  X(0002).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  MSACN1O PIC  X(0001).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  MSACM1O PIC  X(0010).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  TYPE1O PIC  X(0001).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  AMT1O PIC  X(0011).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  VOID1O PIC  X(0001).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  MDT1O PIC  X(0006).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  BDT1O PIC  X(0006).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  SDT1O PIC  X(0006).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  MSAAC2O PIC  X(0010).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  MSAST2O PIC  X(0002).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  MSACN2O PIC  X(0001).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  MSACM2O PIC  X(0010).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  42
* EL633.cbl
  2065     05  TYPE2O PIC  X(0001).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  AMT2O PIC  X(0011).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  VOID2O PIC  X(0001).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  MDT2O PIC  X(0006).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  BDT2O PIC  X(0006).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  SDT2O PIC  X(0006).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  MSAAC3O PIC  X(0010).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  MSAST3O PIC  X(0002).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  MSACN3O PIC  X(0001).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  MSACM3O PIC  X(0010).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  TYPE3O PIC  X(0001).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  AMT3O PIC  X(0011).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  VOID3O PIC  X(0001).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  MDT3O PIC  X(0006).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  BDT3O PIC  X(0006).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  SDT3O PIC  X(0006).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  MSAAC4O PIC  X(0010).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  MSAST4O PIC  X(0002).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  MSACN4O PIC  X(0001).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  43
* EL633.cbl
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  TYPE4O PIC  X(0001).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  AMT4O PIC  X(0011).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  VOID4O PIC  X(0001).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  MDT4O PIC  X(0006).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  BDT4O PIC  X(0006).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  SDT4O PIC  X(0006).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  MSAAC5O PIC  X(0010).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  MSAST5O PIC  X(0002).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  MSACN5O PIC  X(0001).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  MSACM5O PIC  X(0010).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  TYPE5O PIC  X(0001).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  AMT5O PIC  X(0011).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  VOID5O PIC  X(0001).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  MDT5O PIC  X(0006).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  BDT5O PIC  X(0006).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  SDT5O PIC  X(0006).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  MSAAC6O PIC  X(0010).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  MSAST6O PIC  X(0002).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  MSACN6O PIC  X(0001).
  2180*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  44
* EL633.cbl
  2181     05  FILLER            PIC  X(0003).
  2182     05  MSACM6O PIC  X(0010).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  TYPE6O PIC  X(0001).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  AMT6O PIC  X(0011).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  VOID6O PIC  X(0001).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  MDT6O PIC  X(0006).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  BDT6O PIC  X(0006).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  SDT6O PIC  X(0006).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  MSAAC7O PIC  X(0010).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  MSAST7O PIC  X(0002).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  MSACN7O PIC  X(0001).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  MSACM7O PIC  X(0010).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  TYPE7O PIC  X(0001).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  AMT7O PIC  X(0011).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  VOID7O PIC  X(0001).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  MDT7O PIC  X(0006).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  BDT7O PIC  X(0006).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  SDT7O PIC  X(0006).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  MSAAC8O PIC  X(0010).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  MSAST8O PIC  X(0002).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  45
* EL633.cbl
  2239     05  MSACN8O PIC  X(0001).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  MSACM8O PIC  X(0010).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  TYPE8O PIC  X(0001).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  AMT8O PIC  X(0011).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  VOID8O PIC  X(0001).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  MDT8O PIC  X(0006).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  BDT8O PIC  X(0006).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  SDT8O PIC  X(0006).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  MSAAC9O PIC  X(0010).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  MSAST9O PIC  X(0002).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  MSACN9O PIC  X(0001).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  MSACM9O PIC  X(0010).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  TYPE9O PIC  X(0001).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  AMT9O PIC  X(0011).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  VOID9O PIC  X(0001).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  MDT9O PIC  X(0006).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  BDT9O PIC  X(0006).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  SDT9O PIC  X(0006).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  MSAAC10O PIC  X(0010).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  46
* EL633.cbl
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  MSACN10O PIC  X(0001).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  MSACM10O PIC  X(0010).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  TYPE10O PIC  X(0001).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  AMT10O PIC  X(0011).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  VOID10O PIC  X(0001).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  MDT10O PIC  X(0006).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  BDT10O PIC  X(0006).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  SDT10O PIC  X(0006).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  MSAAC11O PIC  X(0010).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  MSAST11O PIC  X(0002).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  MSACN11O PIC  X(0001).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  MSACM11O PIC  X(0010).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  TYPE11O PIC  X(0001).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  AMT11O PIC  X(0011).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  VOID11O PIC  X(0001).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  MDT11O PIC  X(0006).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  BDT11O PIC  X(0006).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  SDT11O PIC  X(0006).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  MSAAC12O PIC  X(0010).
  2354*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  47
* EL633.cbl
  2355     05  FILLER            PIC  X(0003).
  2356     05  MSAST12O PIC  X(0002).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  MSACN12O PIC  X(0001).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  MSACM12O PIC  X(0010).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  TYPE12O PIC  X(0001).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  AMT12O PIC  X(0011).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  VOID12O PIC  X(0001).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  MDT12O PIC  X(0006).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  BDT12O PIC  X(0006).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  SDT12O PIC  X(0006).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  MSAAC13O PIC  X(0010).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  MSAST13O PIC  X(0002).
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  MSACN13O PIC  X(0001).
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  MSACM13O PIC  X(0010).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  TYPE13O PIC  X(0001).
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
  2398     05  AMT13O PIC  X(0011).
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
  2401     05  VOID13O PIC  X(0001).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
  2404     05  MDT13O PIC  X(0006).
  2405*    -------------------------------
  2406     05  FILLER            PIC  X(0003).
  2407     05  BDT13O PIC  X(0006).
  2408*    -------------------------------
  2409     05  FILLER            PIC  X(0003).
  2410     05  SDT13O PIC  X(0006).
  2411*    -------------------------------
  2412     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  48
* EL633.cbl
  2413     05  ERRMSG1O PIC  X(0079).
  2414*    -------------------------------
  2415     05  FILLER            PIC  X(0003).
  2416     05  ERRMSG2O PIC  X(0079).
  2417*    -------------------------------
  2418     05  FILLER            PIC  X(0003).
  2419     05  PFENTERO PIC  X(0002).
  2420*    -------------------------------
  2421
  2422 01  MAP-EL633A  REDEFINES  EL633AI.
  2423     12  FILLER                  PIC  X(87).
  2424     12  DATA-AREA       OCCURS 13 TIMES
  2425                             INDEXED BY PINDX.
  2426         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2427         16  GL-ACCT-ATTRB       PIC  X.
  2428         16  GL-ACCT             PIC  X(10).
  2429         16  WSL-COMM  REDEFINES GL-ACCT.
  2430             20  WSL-COMM-DTE.
  2431                 24  WSL-MO      PIC  X(2).
  2432                 24  WSL-DA      PIC  X(2).
  2433                 24  WSL-YR      PIC  X(2).
  2434             20  WSL-COMM-REST   PIC  X(4).
  2435         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2436         16  GL-STATE-ATTRB      PIC  X.
  2437         16  GL-STATE            PIC  X(02).
  2438         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2439         16  GL-CANC-ATTRB       PIC  X.
  2440         16  GL-CANC             PIC  X.
  2441         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2442         16  GL-COMM-ATTRB       PIC  X.
  2443         16  GL-COMM             PIC  X(10).
  2444         16  RTYPE-LEN           PIC S9(4)              COMP.
  2445         16  RTYPE-ATTRB         PIC  X.
  2446         16  RTYPE               PIC  X.
  2447         16  AMT-LEN             PIC S9(4)              COMP.
  2448         16  AMT-ATTRB           PIC  X.
  2449         16  AMT                 PIC S9(9)V9(2).
  2450         16  AMTO  REDEFINES
  2451             AMT                 PIC Z(7).9(2)-.
  2452         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2453         16  VOID-SW-ATTRB       PIC  X.
  2454         16  VOID-SW             PIC  X.
  2455         16  MDTE-LEN            PIC S9(4)              COMP.
  2456         16  MDTE-ATTRB          PIC  X.
  2457         16  MDTE                PIC  X(6).
  2458         16  BDTE-LEN            PIC S9(4)              COMP.
  2459         16  BDTE-ATTRB          PIC  X.
  2460         16  BDTE                PIC  X(6).
  2461         16  SDTE-LEN            PIC S9(4)              COMP.
  2462         16  SDTE-ATTRB          PIC  X.
  2463         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  49
* EL633.cbl
  2465****************************************************************
  2466*
  2467* Copyright (c) 2007-2013 Dell Inc.
  2468* All rights reserved.
  2469*
  2470****************************************************************
  2471 01  DFHEIV.
  2472   02  DFHEIV0               PIC X(35).
  2473   02  DFHEIV1               PIC X(08).
  2474   02  DFHEIV2               PIC X(08).
  2475   02  DFHEIV3               PIC X(08).
  2476   02  DFHEIV4               PIC X(06).
  2477   02  DFHEIV5               PIC X(04).
  2478   02  DFHEIV6               PIC X(04).
  2479   02  DFHEIV7               PIC X(02).
  2480   02  DFHEIV8               PIC X(02).
  2481   02  DFHEIV9               PIC X(01).
  2482   02  DFHEIV10              PIC S9(7) COMP-3.
  2483   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2484   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2485   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2486   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2487   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2488   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2489   02  DFHEIV17              PIC X(04).
  2490   02  DFHEIV18              PIC X(04).
  2491   02  DFHEIV19              PIC X(04).
  2492   02  DFHEIV20              USAGE IS POINTER.
  2493   02  DFHEIV21              USAGE IS POINTER.
  2494   02  DFHEIV22              USAGE IS POINTER.
  2495   02  DFHEIV23              USAGE IS POINTER.
  2496   02  DFHEIV24              USAGE IS POINTER.
  2497   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2498   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2499   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2500   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2501   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2502   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2503   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2504   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2505   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2506   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2507   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2508   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2509   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2510   02  FILLER                PIC X(02).
  2511   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2512   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2513   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2514   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2515   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2516   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2517   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2518 LINKAGE  SECTION.
  2519*****************************************************************
  2520*                                                               *
  2521* Copyright (c) 2007-2013 Dell Inc.                             *
  2522* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  50
* EL633.cbl
  2523*                                                               *
  2524*****************************************************************
  2525 01  dfheiblk.
  2526     02  eibtime          pic s9(7) comp-3.
  2527     02  eibdate          pic s9(7) comp-3.
  2528     02  eibtrnid         pic x(4).
  2529     02  eibtaskn         pic s9(7) comp-3.
  2530     02  eibtrmid         pic x(4).
  2531     02  dfheigdi         pic s9(4) comp.
  2532     02  eibcposn         pic s9(4) comp.
  2533     02  eibcalen         pic s9(4) comp.
  2534     02  eibaid           pic x(1).
  2535     02  eibfiller1       pic x(1).
  2536     02  eibfn            pic x(2).
  2537     02  eibfiller2       pic x(2).
  2538     02  eibrcode         pic x(6).
  2539     02  eibfiller3       pic x(2).
  2540     02  eibds            pic x(8).
  2541     02  eibreqid         pic x(8).
  2542     02  eibrsrce         pic x(8).
  2543     02  eibsync          pic x(1).
  2544     02  eibfree          pic x(1).
  2545     02  eibrecv          pic x(1).
  2546     02  eibsend          pic x(1).
  2547     02  eibatt           pic x(1).
  2548     02  eibeoc           pic x(1).
  2549     02  eibfmh           pic x(1).
  2550     02  eibcompl         pic x(1).
  2551     02  eibsig           pic x(1).
  2552     02  eibconf          pic x(1).
  2553     02  eiberr           pic x(1).
  2554     02  eibrldbk         pic x(1).
  2555     02  eiberrcd         pic x(4).
  2556     02  eibsynrb         pic x(1).
  2557     02  eibnodat         pic x(1).
  2558     02  eibfiller5       pic x(2).
  2559     02  eibresp          pic s9(8) comp.
  2560     02  eibresp2         pic s9(8) comp.
  2561     02  dfheigdj         pic s9(4) comp.
  2562     02  dfheigdk         pic s9(4) comp.
  2563 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  51
* EL633.cbl
  2564/
  2565*                            COPY ERCCHKQ.
  2566******************************************************************
  2567*                                                                *
  2568*                                                                *
  2569*                            ERCCHKQ                             *
  2570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2571*                            VMOD=2.005                          *
  2572*                                                                *
  2573*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2574*                                                                *
  2575*   FILE TYPE = VSAM,KSDS                                        *
  2576*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2577*                                                                *
  2578*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2579*       ALTERNATE PATH  = NONE                                   *
  2580*                                                                *
  2581*   LOG = YES                                                    *
  2582*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2583******************************************************************
  2584 01  CHECK-QUE.
  2585     12  CQ-RECORD-ID                PIC XX.
  2586         88  VALID-CQ-ID                     VALUE 'CQ'.
  2587
  2588     12  CQ-CONTROL-PRIMARY.
  2589         16  CQ-COMPANY-CD           PIC X.
  2590         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2591         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2592
  2593     12  CQ-ENTRY-TYPE               PIC X.
  2594             88  CHECK-ON-QUE           VALUE 'Q'.
  2595             88  ALIGNMENT-CHECK        VALUE 'A'.
  2596             88  MANUAL-CHECK           VALUE 'M'.
  2597             88  SPOILED-CHECK          VALUE 'S'.
  2598             88  VOIDED-CHECK           VALUE 'V'.
  2599             88  PAYMENT-ABORTED        VALUE 'X'.
  2600
  2601     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2602
  2603     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2604         CQ-CREDIT-MASTER-CNTL.
  2605         16  CQ-PYAJ-CARRIER         PIC X.
  2606         16  CQ-PYAJ-GROUPING        PIC X(6).
  2607         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2608         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2609         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2610         16  CQ-PYAJ-REC-TYPE        PIC X.
  2611         16  FILLER                  PIC X(18).
  2612
  2613     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2614         CQ-CREDIT-MASTER-CNTL.
  2615         16  CQ-CHEK-CARRIER         PIC X.
  2616         16  CQ-CHEK-GROUPING        PIC X(6).
  2617         16  CQ-CHEK-STATE           PIC XX.
  2618         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2619         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2620         16  CQ-CHEK-CERT-NO.
  2621             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  52
* EL633.cbl
  2622             20  CQ-CHEK-CERT-SFX    PIC X.
  2623         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2624         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2625         16  FILLER                  PIC X(06).
  2626
  2627     12  CQ-CHECK-NUMBER             PIC X(7).
  2628     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2629     12  CQ-PAYMENT-TYPE             PIC X.
  2630             88  CQ-BILLING-CREDIT         VALUE '1'.
  2631             88  CQ-REFUND-PMT             VALUE '2'.
  2632             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2633     12  CQ-VOID-INDICATOR           PIC X.
  2634             88  CHECK-IS-VOID             VALUE 'V'.
  2635     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2636     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2637     12  CQ-CHECK-BY-USER            PIC X(4).
  2638     12  CQ-PRE-NUMBERING-SW         PIC X.
  2639       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2640       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2641
  2642     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2643     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2644     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2645     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2646
  2647     12  CQ-LETTERS-IND              PIC X.
  2648         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2649
  2650******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  53
* EL633.cbl
  2651/
  2652*                            COPY ERCPYAJ.
  2653******************************************************************
  2654*                                                                *
  2655*                            ERCPYAJ                             *
  2656*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2657*                            VMOD=2.015                          *
  2658*                                                                *
  2659*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2660*                                                                *
  2661*                                                                *
  2662*   FILE TYPE = VSAM,KSDS                                        *
  2663*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2664*                                                                *
  2665*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2666*       ALTERNATE PATHS = NONE                                   *
  2667*                                                                *
  2668*   LOG = YES                                                    *
  2669*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2670******************************************************************
  2671******************************************************************
  2672*                   C H A N G E   L O G
  2673*
  2674* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2675*-----------------------------------------------------------------
  2676*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2677* EFFECTIVE    NUMBER
  2678*-----------------------------------------------------------------
  2679* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2680* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2681******************************************************************
  2682
  2683 01  PENDING-PAY-ADJ.
  2684     12  PY-RECORD-ID                     PIC XX.
  2685         88  VALID-PY-ID                        VALUE 'PY'.
  2686
  2687     12  PY-CONTROL-PRIMARY.
  2688         16  PY-COMPANY-CD                PIC X.
  2689         16  PY-CARRIER                   PIC X.
  2690         16  PY-GROUPING                  PIC X(6).
  2691         16  PY-FIN-RESP                  PIC X(10).
  2692         16  PY-ACCOUNT                   PIC X(10).
  2693         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2694                                          PIC X(10).
  2695         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2696         16  PY-RECORD-TYPE               PIC X.
  2697             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2698             88  PY-DEPOSIT                   VALUE 'D'.
  2699             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2700             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2701             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2702             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2703             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2704             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2705             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2706             88  PY-FICA-ENTRY                VALUE 'F'.
  2707             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2708             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  54
* EL633.cbl
  2709             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2710
  2711     12  PY-PYMT-TYPE                     PIC X.
  2712             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2713             88  PY-REINS-PYMT                VALUE 'R'.
  2714             88  PY-EXP-PYMT                  VALUE 'E'.
  2715
  2716     12  PY-BIL-INV                       PIC X(6).
  2717     12  PY-REF-NO                        PIC X(12).
  2718
  2719     12  PY-LAST-MAINT-DT                 PIC XX.
  2720     12  PY-LAST-MAINT-BY                 PIC X(4).
  2721     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2722
  2723     12  PY-PYADJ-RECORD.
  2724         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2725         16  PY-ENTRY-COMMENT             PIC X(30).
  2726         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2727             20  PY-GL-ACCOUNT            PIC X(10).
  2728             20  PY-GL-STATE              PIC X(02).
  2729             20  PY-GL-CANC-SW            PIC X(01).
  2730                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2731                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2732             20  PY-GL-COMMENT            PIC X(10).
  2733             20  FILLER      REDEFINES PY-GL-COMMENT.
  2734                 24  PY-GL-CHECK-NO       PIC 9(06).
  2735                 24  FILLER               PIC X(04).
  2736             20  FILLER                   PIC X(07).
  2737         16  PY-SAVE-ACCOUNT              PIC X(10).
  2738         16  PY-SAVE-TYPE                 PIC X(01).
  2739
  2740         16  PY-LETTERS.
  2741             20  PY-LETTER OCCURS 3 TIMES
  2742                           INDEXED BY PY-LET-NDX
  2743                                          PIC X(04).
  2744
  2745         16  PY-ERCOMP-TYPE               PIC X.
  2746             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2747             88  PY-GA-TYPE                   VALUE 'G'.
  2748             88  PY-BANK-TYPE                 VALUE 'B'.
  2749         16  FILLER                       PIC X(05).
  2750
  2751     12  PY-RECORD-STATUS.
  2752         16  PY-CREDIT-SELECT-DT          PIC XX.
  2753         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2754         16  PY-BILLED-DATE               PIC XX.
  2755         16  PY-REPORTED-DT               PIC XX.
  2756         16  PY-PMT-APPLIED               PIC X.
  2757             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2758             88  PY-GA-PMT                    VALUE 'G'.
  2759             88  PY-OVWRITE-PMT               VALUE 'O'.
  2760             88  PY-NON-AR-PMT                VALUE 'N'.
  2761         16  FILLER                       PIC X(5).
  2762         16  PY-INPUT-DT                  PIC XX.
  2763         16  PY-CHECK-NUMBER              PIC X(6).
  2764         16  PY-VOID-SW                   PIC X.
  2765             88  PY-CHECK-VOIDED              VALUE 'V'.
  2766         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  55
* EL633.cbl
  2767             88  PY-BILLING-CHECK             VALUE 'B'.
  2768             88  PY-REFUND-CHECK              VALUE 'R'.
  2769             88  PY-GA-CHECK                  VALUE 'G'.
  2770             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2771             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2772         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2773         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2774         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2775         16  PY-BILL-FLAG                 PIC X.
  2776             88  PY-BILLED                    VALUE 'B'.
  2777         16  PY-AR-FLAG                   PIC X.
  2778             88  PY-AR-CYCLE                  VALUE 'C'.
  2779             88  PY-AR-MONTH-END              VALUE 'M'.
  2780         16  PY-AR-DATE                   PIC XX.
  2781
  2782     12  PY-GL-CODES.
  2783         16  PY-GL-DB                     PIC X(14).
  2784         16  PY-GL-CR                     PIC X(14).
  2785         16  PY-GL-FLAG                   PIC X.
  2786         16  PY-GL-DATE                   PIC XX.
  2787
  2788     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2789     12  FILLER                           PIC X(3).
  2790******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  56
* EL633.cbl
  2791/
  2792*                            COPY ERCCOMP.
  2793******************************************************************
  2794*                                                                *
  2795*                                                                *
  2796*                            ERCCOMP                             *
  2797*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2798*                            VMOD=2.019                          *
  2799*                                                                *
  2800*   ONLINE CREDIT SYSTEM                                         *
  2801*                                                                *
  2802*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2803*                                                                *
  2804*   FILE TYPE = VSAM,KSDS                                        *
  2805*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2806*                                                                *
  2807*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2808*       ALTERNATE PATH = NONE                                    *
  2809*                                                                *
  2810*   LOG = NO                                                     *
  2811*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2812*                                                                *
  2813******************************************************************
  2814*                   C H A N G E   L O G
  2815*
  2816* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2817*-----------------------------------------------------------------
  2818*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2819* EFFECTIVE    NUMBER
  2820*-----------------------------------------------------------------
  2821* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2822* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2823* 092205    2005050300006  PEMA  ADD LEASE FEE
  2824* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2825* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2826* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2827* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2828* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2829* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2830******************************************************************
  2831
  2832 01  COMPENSATION-MASTER.
  2833     12  CO-RECORD-ID                          PIC XX.
  2834         88  VALID-CO-ID                          VALUE 'CO'.
  2835
  2836     12  CO-CONTROL-PRIMARY.
  2837         16  CO-COMPANY-CD                     PIC X.
  2838         16  CO-CONTROL.
  2839             20  CO-CTL-1.
  2840                 24  CO-CARR-GROUP.
  2841                     28  CO-CARRIER            PIC X.
  2842                     28  CO-GROUPING.
  2843                         32  CO-GROUP-PREFIX   PIC XXX.
  2844                         32  CO-GROUP-PRIME    PIC XXX.
  2845                 24  CO-RESP-NO.
  2846                     28  CO-RESP-PREFIX        PIC X(4).
  2847                     28  CO-RESP-PRIME         PIC X(6).
  2848             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  57
* EL633.cbl
  2849                 24  CO-ACCOUNT.
  2850                     28  CO-ACCT-PREFIX        PIC X(4).
  2851                     28  CO-ACCT-PRIME         PIC X(6).
  2852         16  CO-TYPE                           PIC X.
  2853             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2854             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2855             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2856
  2857     12  CO-MAINT-INFORMATION.
  2858         16  CO-LAST-MAINT-DT                  PIC XX.
  2859         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2860         16  CO-LAST-MAINT-USER                PIC X(4).
  2861     12  FILLER                                PIC XX.
  2862     12  CO-STMT-TYPE                          PIC XXX.
  2863     12  CO-COMP-TYPE                          PIC X.
  2864         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2865     12  CO-STMT-OWNER                         PIC X(4).
  2866     12  CO-BALANCE-CONTROL                    PIC X.
  2867         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2868         88  CO-NO-BALANCE                        VALUE 'N'.
  2869
  2870     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2871         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2872         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2873         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2874
  2875     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2876         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2877         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2878
  2879     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2880     12  CO-GA-DIRECT-DEP                      PIC X.
  2881     12  CO-FUTURE-SPACE                       PIC X.
  2882         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2883
  2884     12  CO-ACCT-NAME                          PIC X(30).
  2885     12  CO-MAIL-NAME                          PIC X(30).
  2886     12  CO-ADDR-1                             PIC X(30).
  2887     12  CO-ADDR-2                             PIC X(30).
  2888     12  CO-ADDR-3.
  2889         16  CO-ADDR-CITY                      PIC X(27).
  2890         16  CO-ADDR-STATE                     PIC XX.
  2891     12  CO-CSO-1099                           PIC X.
  2892     12  CO-ZIP.
  2893         16  CO-ZIP-PRIME.
  2894             20  CO-ZIP-PRI-1ST                PIC X.
  2895                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2896             20  FILLER                        PIC X(4).
  2897         16  CO-ZIP-PLUS4                      PIC X(4).
  2898     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2899         16  CO-CAN-POSTAL-1                   PIC XXX.
  2900         16  CO-CAN-POSTAL-2                   PIC XXX.
  2901         16  FILLER                            PIC XXX.
  2902     12  CO-SOC-SEC                            PIC X(13).
  2903     12  CO-TELEPHONE.
  2904         16  CO-AREA-CODE                      PIC XXX.
  2905         16  CO-PREFIX                         PIC XXX.
  2906         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  58
* EL633.cbl
  2907
  2908     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2909
  2910     12  CO-AR-BAL-LEVEL                       PIC X.
  2911         88  CO-AR-REF-LVL                        VALUE '1'.
  2912         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2913         88  CO-AR-BILL-LVL                       VALUE '2'.
  2914         88  CO-AR-AGT-LVL                        VALUE '3'.
  2915         88  CO-AR-FR-LVL                         VALUE '4'.
  2916
  2917     12  CO-AR-NORMAL-PRINT                    PIC X.
  2918         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2919         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2920
  2921     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2922
  2923     12  CO-AR-REPORTING                       PIC X.
  2924         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2925         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2926
  2927     12  CO-AR-PULL-CHECK                      PIC X.
  2928         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2929         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2930
  2931     12  CO-AR-BALANCE-PRINT                   PIC X.
  2932         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2933
  2934     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2935         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2936         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2937         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2938
  2939     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2940
  2941     12  CO-USER-CODE                          PIC X.
  2942     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2943
  2944******************************************************************
  2945*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2946*    THE LAST MONTH END RUN.
  2947******************************************************************
  2948
  2949     12  CO-LAST-ACTIVITY-DATE.
  2950         16  CO-ACT-YEAR                       PIC 99.
  2951         16  CO-ACT-MONTH                      PIC 99.
  2952         16  CO-ACT-DAY                        PIC 99.
  2953
  2954     12  CO-LAST-STMT-DT.
  2955         16  CO-LAST-STMT-YEAR                 PIC 99.
  2956         16  CO-LAST-STMT-MONTH                PIC 99.
  2957         16  CO-LAST-STMT-DAY                  PIC 99.
  2958
  2959     12  CO-MO-END-TOTALS.
  2960         16  CO-MONTHLY-TOTALS.
  2961             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2962             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2963             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2964             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  59
* EL633.cbl
  2965             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2966
  2967         16  CO-AGING-TOTALS.
  2968             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2969             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2970             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2971             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2972
  2973         16  CO-YTD-TOTALS.
  2974             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2975             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2976
  2977         16  CO-OVER-UNDER-TOTALS.
  2978             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2979             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2980
  2981     12  CO-MISCELLANEOUS-TOTALS.
  2982         16  CO-FICA-TOTALS.
  2983             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2984             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2985
  2986         16  CO-CLAIM-TOTALS.
  2987             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2988             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2989
  2990******************************************************************
  2991*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2992*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2993******************************************************************
  2994
  2995     12  CO-CURRENT-TOTALS.
  2996         16  CO-CURRENT-LAST-STMT-DT.
  2997             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2998             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2999             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  3000
  3001         16  CO-CURRENT-MONTHLY-TOTALS.
  3002             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  3003             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  3004             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  3005             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  3006             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  3007
  3008         16  CO-CURRENT-AGING-TOTALS.
  3009             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  3010             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  3011             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  3012             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  3013
  3014         16  CO-CURRENT-YTD-TOTALS.
  3015             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  3016             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  3017
  3018     12  CO-PAID-COMM-TOTALS.
  3019         16  CO-YTD-PAID-COMMS.
  3020             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3021             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3022
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  60
* EL633.cbl
  3023     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3024         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3025         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3026
  3027     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3028         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3029         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3030         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3031         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3032         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3033         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3034         88  CO-FINAL-LETTER                  VALUE 'F'.
  3035         88  CO-RECONCILING                   VALUE 'R'.
  3036         88  CO-PHONE-CALL                    VALUE 'P'.
  3037         88  CO-LEGAL                         VALUE 'L'.
  3038         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3039         88  CO-WRITE-OFF                     VALUE 'W'.
  3040         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3041
  3042     12  CO-CSR-CODE                       PIC X(4).
  3043
  3044     12  CO-GA-STATUS-INFO.
  3045         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3046         16  CO-GA-TERMINATION-DT          PIC XX.
  3047         16  CO-GA-STATUS-CODE             PIC X.
  3048             88  CO-GA-ACTIVE                 VALUE 'A'.
  3049             88  CO-GA-INACTIVE               VALUE 'I'.
  3050             88  CO-GA-PENDING                VALUE 'P'.
  3051         16  CO-GA-COMMENTS.
  3052             20  CO-GA-COMMENT-1           PIC X(40).
  3053             20  CO-GA-COMMENT-2           PIC X(40).
  3054             20  CO-GA-COMMENT-3           PIC X(40).
  3055             20  CO-GA-COMMENT-4           PIC X(40).
  3056
  3057     12  CO-RPTCD2                         PIC X(10).
  3058     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  3059         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  3060         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  3061
  3062     12  CO-TYPE-AGENT                     PIC X(01).
  3063         88  CO-CORPORATION                   VALUE 'C'.
  3064         88  CO-PARTNERSHIP                   VALUE 'P'.
  3065         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3066         88  CO-TRUST                         VALUE 'T'.
  3067         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3068
  3069     12  CO-FAXNO.
  3070         16  CO-FAX-AREA-CODE                  PIC XXX.
  3071         16  CO-FAX-PREFIX                     PIC XXX.
  3072         16  CO-FAX-PHONE                      PIC X(4).
  3073
  3074     12  CO-BANK-INFORMATION.
  3075         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3076         16  CO-BANK-TRANSIT-NON REDEFINES
  3077             CO-BANK-TRANSIT-NO                PIC 9(8).
  3078
  3079         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3080     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  61
* EL633.cbl
  3081                  CO-BANK-INFORMATION.
  3082         16  CO-MD-GL-ACCT                     PIC X(10).
  3083         16  CO-MD-DIV                         PIC XX.
  3084         16  CO-MD-CENTER                      PIC X(4).
  3085         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3086         16  CO-CREATE-AP-CHECK                PIC X.
  3087         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3088         16  FILLER                            PIC XXX.
  3089     12  CO-ACH-STATUS                         PIC X.
  3090         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3091         88  CO-ACH-PENDING                        VALUE 'P'.
  3092
  3093     12  CO-BILL-SW                            PIC X.
  3094     12  CO-CONTROL-NAME                       PIC X(30).
  3095     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3096     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3097     12  CO-CLP-STATE                          PIC XX.
  3098     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3099     12  CO-SPP-REFUND-EDIT                    PIC X.
  3100
  3101******************************************************************
  3102*
  3103*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  62
* EL633.cbl
  3104/
  3105 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3106                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3107 0000-DFHEXIT SECTION.
  3108     MOVE '9#                    $   ' TO DFHEIV0.
  3109     MOVE 'EL633' TO DFHEIV1.
  3110     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3111
  3112     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3113     MOVE EIBTRMID               TO  QID-TERM.
  3114     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3115
  3116     IF EIBCALEN = ZERO
  3117         GO TO 8800-UNAUTHORIZED-ACCESS.
  3118
  3119     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3120         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3121
  3122     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3123     MOVE '5'                    TO  DC-OPTION-CODE.
  3124
  3125     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3126
  3127     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3128     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3129
  3130     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3131         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3132             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3133             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3134             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3135             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3136             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3137             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3138             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3139             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3140         ELSE
  3141             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3142             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3143             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3144             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3145             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3146             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3147             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3148             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3149
  3150     MOVE LOW-VALUES             TO  EL633AI.
  3151
  3152     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3153     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3154     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3155     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3156
  3157     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3158                                     TOTAL-ACCT-NET.
  3159
  3160     IF RETURNED-FROM = XCTL-6331 OR
  3161                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  63
* EL633.cbl
  3162                        XCTL-642  OR
  3163                        XCTL-652
  3164         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3165
  3166     IF EIBTRNID NOT = TRANS-ID
  3167         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3168         MOVE 'Y'                TO  PI-PAGE-SW
  3169         MOVE ZEROS              TO  PI-SEQ-NOS
  3170         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3171                                     PI-SAV-ACCT-NET
  3172                                     PI-SAV-PREV-AMT
  3173                                     PI-SAV-PREV-NET
  3174         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3175             EIBTRNID NOT = EL642-TRANS-ID  AND
  3176             EIBTRNID NOT = EL652-TRANS-ID) OR
  3177             PI-CR-FIN-RESP = SPACES
  3178             GO TO 8100-SEND-INITIAL-MAP
  3179         ELSE
  3180             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3181                            EL640-TRANS-ID   OR
  3182                            EL642-TRANS-ID)  AND
  3183                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3184                GO TO 8100-SEND-INITIAL-MAP
  3185             ELSE
  3186                 MOVE DFHENTER   TO  EIBAID
  3187                 MOVE 'S'        TO  MAINTI
  3188                 MOVE PI-CR-CARRIER
  3189                                 TO  CARRIERI
  3190                 MOVE PI-CR-GROUPING
  3191                                 TO  GROUPI
  3192                 MOVE PI-CR-FIN-RESP
  3193                                 TO  FINRESPI
  3194                 MOVE PI-CR-ACCOUNT
  3195                                 TO  ACCTI
  3196                 MOVE 1          TO  CARRIERL  MAINTA
  3197                 MOVE 3          TO  GROUPL
  3198                 MOVE 6          TO  FINRESPL  ACCTL
  3199                 GO TO 0400-VALIDATE-KEY-DATA.
  3200
  3201
  3202* EXEC CICS HANDLE CONDITION
  3203*        PGMIDERR  (9600-PGMID-ERROR)
  3204*        ERROR     (9990-ABEND)
  3205*    END-EXEC.
  3206*    MOVE '"$L.                  ! " #00003197' TO DFHEIV0
  3207     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3209     MOVE X'2220233030303033313937' TO DFHEIV0(25:11)
  3210     CALL 'kxdfhei1' USING DFHEIV0
  3211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3212
  3213
  3214     IF EIBAID = DFHCLEAR
  3215         GO TO 9400-CLEAR.
  3216
  3217     IF PI-PROCESSOR-ID = 'LGXX'
  3218         GO TO 0200-RECEIVE.
  3219
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  64
* EL633.cbl
  3220
  3221* EXEC CICS READQ TS
  3222*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3223*        INTO   (SECURITY-CONTROL)
  3224*        LENGTH (SC-COMM-LENGTH)
  3225*        ITEM   (SC-ITEM)
  3226*    END-EXEC.
  3227*    MOVE '*$II   L              ''   #00003208' TO DFHEIV0
  3228     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3229     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3230     MOVE X'2020233030303033323038' TO DFHEIV0(25:11)
  3231     CALL 'kxdfhei1' USING DFHEIV0,
  3232           PI-SECURITY-TEMP-STORE-ID,
  3233           SECURITY-CONTROL,
  3234           SC-COMM-LENGTH,
  3235           SC-ITEM,
  3236           DFHEIV99,
  3237           DFHEIV99
  3238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3239
  3240
  3241     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3242     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3243
  3244     IF NOT DISPLAY-CAP
  3245         MOVE 'READ'          TO SM-READ
  3246         PERFORM 9995-SECURITY-VIOLATION
  3247         MOVE ER-0070         TO  EMI-ERROR
  3248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3249         GO TO 8100-SEND-INITIAL-MAP.
  3250
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  65
* EL633.cbl
  3252 0200-RECEIVE.
  3253
  3254     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3255         MOVE ER-0008            TO  EMI-ERROR
  3256         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3257         MOVE -1                 TO  MAINTL
  3258         GO TO 8200-SEND-DATAONLY.
  3259
  3260
  3261* EXEC CICS RECEIVE
  3262*        MAP     (MAP-NAME)
  3263*        MAPSET  (MAPSET-NAME)
  3264*        INTO    (EL633AI)
  3265*    END-EXEC.
  3266     MOVE LENGTH OF
  3267      EL633AI
  3268       TO DFHEIV11
  3269*    MOVE '8"T I  L              ''   #00003234' TO DFHEIV0
  3270     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3271     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3272     MOVE X'2020233030303033323334' TO DFHEIV0(25:11)
  3273     CALL 'kxdfhei1' USING DFHEIV0,
  3274           MAP-NAME,
  3275           EL633AI,
  3276           DFHEIV11,
  3277           MAPSET-NAME,
  3278           DFHEIV99,
  3279           DFHEIV99
  3280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3281
  3282
  3283     IF MAINTI = 'S' AND
  3284        EIBAID = DFHENTER
  3285         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3286                                     PI-SAV-ACCT-NET
  3287                                     PI-SAV-PREV-AMT
  3288                                     PI-SAV-PREV-NET
  3289                                     PI-FRST-FILE-SEQ-NO
  3290         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3291
  3292     IF PFENTERL = ZERO
  3293         GO TO 0300-CHECK-PFKEYS.
  3294
  3295     IF (PFENTERI  IS NUMERIC)
  3296       AND (PFENTERI GREATER 0 AND LESS 25)
  3297         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3298     ELSE
  3299         MOVE ER-0029               TO  EMI-ERROR
  3300         GO TO 0320-INPUT-ERROR.
  3301
  3302 0300-CHECK-PFKEYS.
  3303     IF EIBAID = DFHPF23
  3304         GO TO 8810-PF23.
  3305
  3306     IF EIBAID = DFHPF24
  3307         GO TO 9200-RETURN-MAIN-MENU.
  3308
  3309     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  66
* EL633.cbl
  3310         GO TO 9500-PF12.
  3311
  3312     IF EIBAID = DFHPF3
  3313         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3314             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3315             MOVE XCTL-652       TO  PGM-NAME
  3316             IF ERCOMP-KEY  NOT =      SPACES
  3317                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3318                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3319                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3320                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3321             END-IF
  3322
  3323             IF PI-CR-ACCOUNT = LOW-VALUES
  3324                 MOVE 'G'        TO  PI-CR-TYPE
  3325                 GO TO 9300-XCTL
  3326             ELSE
  3327                 MOVE 'A'        TO  PI-CR-TYPE
  3328                 GO TO 9300-XCTL
  3329         ELSE
  3330            MOVE ER-3020         TO  EMI-ERROR
  3331            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3332            GO TO 8100-SEND-INITIAL-MAP.
  3333
  3334     IF EIBAID = DFHPF4
  3335         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3336         MOVE XCTL-6331          TO  PGM-NAME
  3337         GO TO 9300-XCTL.
  3338
  3339     IF EIBAID = DFHPF5
  3340         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3341         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3342         MOVE XCTL-640           TO  PGM-NAME
  3343         IF PI-CR-ACCOUNT = LOW-VALUES
  3344             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3345             IF ACCTI = LOW-VALUES
  3346                MOVE 'G'         TO  PI-CR-TYPE
  3347             END-IF
  3348             GO TO 9300-XCTL
  3349         ELSE
  3350             MOVE 'A'        TO  PI-CR-TYPE
  3351             GO TO 9300-XCTL.
  3352
  3353     IF EIBAID = DFHPF6
  3354        IF PI-GA-BILLING
  3355            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3356            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3357            MOVE XCTL-642        TO  PGM-NAME
  3358            IF PI-CR-ACCOUNT = LOW-VALUES
  3359                 MOVE 'G'        TO  PI-CR-TYPE
  3360                 GO TO 9300-XCTL
  3361             ELSE
  3362                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3363                 GO TO 9300-XCTL
  3364        ELSE
  3365            MOVE ER-2929         TO  EMI-ERROR
  3366            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3367            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  67
* EL633.cbl
  3368            IF PFENTERL = ZERO
  3369                MOVE -1          TO  MAINTL
  3370                GO TO 8200-SEND-DATAONLY
  3371            ELSE
  3372                MOVE -1          TO  PFENTERL
  3373                GO TO 8200-SEND-DATAONLY.
  3374
  3375     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3376         GO TO 0400-VALIDATE-KEY-DATA.
  3377
  3378 0320-INPUT-ERROR.
  3379     MOVE ER-0029                TO  EMI-ERROR.
  3380
  3381     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3382
  3383     MOVE AL-UNBON               TO  PFENTERA.
  3384
  3385     IF PFENTERL = ZERO
  3386         MOVE -1                 TO  MAINTL
  3387     ELSE
  3388         MOVE -1                 TO  PFENTERL.
  3389
  3390     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  68
* EL633.cbl
  3392 0400-VALIDATE-KEY-DATA.
  3393     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3394         NEXT SENTENCE
  3395       ELSE
  3396        IF MAINTI NOT = 'S'
  3397         MOVE 'UPDATE'       TO SM-READ
  3398         PERFORM 9995-SECURITY-VIOLATION
  3399         MOVE ER-0070        TO EMI-ERROR
  3400         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3401         GO TO 8100-SEND-INITIAL-MAP.
  3402
  3403     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3404
  3405     IF EIBAID = DFHPF1
  3406         GO TO 4000-BROWSE-FRWD.
  3407
  3408     IF EIBAID   = DFHPF1   AND
  3409        CARRIERL = ZEROS    AND
  3410        GROUPL   = ZEROS    AND
  3411        FINRESPL = ZEROS    AND
  3412        ACCTL    = ZEROS
  3413         GO TO 4000-BROWSE-FRWD.
  3414
  3415     IF PI-PROCESSOR-ID = 'LGXX'
  3416         IF MAINTI = 'C'
  3417             MOVE AL-UANON       TO MAINTA
  3418             MOVE MAINTI         TO PI-SAV-FUNCTION
  3419             GO TO CSO-BRANCH
  3420         END-IF
  3421     END-IF.
  3422
  3423     IF MAINTI = 'C' OR  'S'
  3424         MOVE AL-UANON           TO  MAINTA
  3425         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3426     ELSE
  3427         MOVE -1                 TO  MAINTL
  3428         MOVE ER-0023            TO  EMI-ERROR
  3429         MOVE AL-UABON           TO  MAINTA
  3430         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3431
  3432 CSO-BRANCH.
  3433
  3434     IF MAINTI = 'C'
  3435       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3436         MOVE -1                 TO  MAINTL
  3437         MOVE ER-2056            TO  EMI-ERROR
  3438         MOVE AL-UABON           TO  MAINTA
  3439         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3440
  3441     IF CARRIERL = ZEROS  AND
  3442        GROUPL   = ZEROS  AND
  3443        FINRESPL = ZEROS  AND
  3444        ACCTL    = ZEROS
  3445         MOVE -1                 TO  CARRIERL
  3446         MOVE ER-2231            TO  EMI-ERROR
  3447         MOVE AL-UABON           TO  CARRIERA
  3448                                     GROUPA
  3449                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  69
* EL633.cbl
  3450                                     ACCTA
  3451         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3452         GO TO 8200-SEND-DATAONLY.
  3453
  3454     IF CARRIERL NOT = ZEROS
  3455         MOVE AL-UANON           TO  CARRIERA
  3456         MOVE CARRIERI           TO  COMP-CARRIER
  3457                                     PI-SAV-CARRIER
  3458                                     PI-CR-CARRIER
  3459         IF CARRIERI NOT = ZEROS
  3460           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3461             MOVE ER-2587        TO  EMI-ERROR
  3462             MOVE -1             TO  CARRIERL
  3463             MOVE AL-UABON       TO  CARRIERA
  3464             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3465         ELSE
  3466             NEXT SENTENCE
  3467     ELSE
  3468         MOVE LOW-VALUES          TO  COMP-CARRIER
  3469                                      PI-SAV-CARRIER.
  3470
  3471     IF CARRIERL NOT = ZEROS
  3472         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3473             IF PI-CARRIER-SECURITY = CARRIERI
  3474                 NEXT SENTENCE
  3475             ELSE
  3476                 MOVE -1         TO  CARRIERL
  3477                 MOVE ER-2370    TO  EMI-ERROR
  3478                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3479
  3480     IF GROUPL NOT = ZEROS
  3481         MOVE AL-UANON           TO  GROUPA
  3482         MOVE GROUPI             TO  COMP-GROUPING
  3483                                     PI-SAV-GROUPING
  3484                                     PI-CR-GROUPING
  3485         IF GROUPI NOT = ZEROS
  3486           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3487             MOVE ER-2588        TO  EMI-ERROR
  3488             MOVE -1             TO  GROUPL
  3489             MOVE AL-UABON       TO  GROUPA
  3490             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3491         ELSE
  3492             NEXT SENTENCE
  3493     ELSE
  3494         MOVE LOW-VALUES         TO  COMP-GROUPING
  3495                                     PI-SAV-GROUPING.
  3496
  3497     IF FINRESPL NOT = ZEROS
  3498         MOVE AL-UANON           TO  FINRESPA
  3499         MOVE FINRESPI           TO  COMP-FIN-RESP
  3500                                     PI-SAV-FIN-RESP
  3501                                     PI-CR-FIN-RESP
  3502     ELSE
  3503         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3504                                     PI-SAV-FIN-RESP.
  3505
  3506     IF ACCTL NOT = ZEROS
  3507         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  70
* EL633.cbl
  3508         MOVE ACCTI              TO  COMP-ACCOUNT
  3509                                     PI-SAV-ACCOUNT
  3510                                     PI-CR-ACCOUNT
  3511     ELSE
  3512         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3513                                     PI-SAV-ACCOUNT
  3514                                     PI-CR-ACCOUNT.
  3515
  3516     IF EMI-ERROR = ZEROS
  3517         NEXT SENTENCE
  3518     ELSE
  3519         IF EIBTRNID = EL640-TRANS-ID OR
  3520            EIBTRNID = EL642-TRANS-ID OR
  3521            EIBTRNID = EL6331-TRANS-ID
  3522             GO TO 8100-SEND-INITIAL-MAP
  3523         ELSE
  3524             GO TO 8200-SEND-DATAONLY.
  3525
  3526     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3527
  3528     IF MAINTI = 'S'
  3529         IF EIBAID = DFHPF1              OR  DFHENTER
  3530             GO TO 4000-BROWSE-FRWD
  3531         ELSE
  3532             GO TO 4100-BROWSE-BKWD.
  3533
  3534     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3535     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3536
  3537
  3538* EXEC CICS HANDLE CONDITION
  3539*        NOTFND   (0410-NO-COMP-MSTR)
  3540*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3541*        END-EXEC.
  3542*    MOVE '"$IJ                  ! # #00003494' TO DFHEIV0
  3543     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3545     MOVE X'2320233030303033343934' TO DFHEIV0(25:11)
  3546     CALL 'kxdfhei1' USING DFHEIV0
  3547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3548
  3549
  3550
  3551* EXEC CICS READ
  3552*        DATASET  (COMP-FILE-ID)
  3553*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3554*        RIDFLD   (ERCOMP-KEY)
  3555*        GTEQ
  3556*        END-EXEC.
  3557*    MOVE '&"S        G          (   #00003499' TO DFHEIV0
  3558     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3560     MOVE X'2020233030303033343939' TO DFHEIV0(25:11)
  3561     CALL 'kxdfhei1' USING DFHEIV0,
  3562           COMP-FILE-ID,
  3563           DFHEIV20,
  3564           DFHEIV99,
  3565           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  71
* EL633.cbl
  3566           DFHEIV99,
  3567           DFHEIV99,
  3568           DFHEIV99
  3569     SET ADDRESS OF COMPENSATION-MASTER TO
  3570         DFHEIV20
  3571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3572
  3573
  3574     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3575        COMP-CARRIER  = CO-CARRIER     AND
  3576        COMP-GROUPING = CO-GROUPING    AND
  3577        COMP-FIN-RESP = CO-RESP-NO    AND
  3578        COMP-ACCOUNT  = CO-ACCOUNT
  3579         NEXT SENTENCE
  3580     ELSE
  3581         GO TO 0410-NO-COMP-MSTR.
  3582
  3583     IF PI-COMPANY-ID = 'NCL'
  3584         IF CO-GA-INACTIVE
  3585             GO TO 0420-INACTIVE-COMP.
  3586
  3587     IF MAINTI = 'C'
  3588         GO TO 1000-EDIT-DATA.
  3589
  3590     IF EIBAID = DFHPF1
  3591       OR DFHENTER
  3592         GO TO 4000-BROWSE-FRWD.
  3593
  3594     IF EIBAID = DFHPF2
  3595         GO TO 4100-BROWSE-BKWD.
  3596
  3597 0410-NO-COMP-MSTR.
  3598     MOVE ER-2230                TO  EMI-ERROR.
  3599     MOVE -1                     TO  CARRIERL.
  3600     MOVE AL-UABON               TO  CARRIERA
  3601                                     GROUPA
  3602                                     FINRESPA
  3603                                     ACCTA.
  3604
  3605     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3606
  3607     GO TO 8200-SEND-DATAONLY.
  3608
  3609 0420-INACTIVE-COMP.
  3610     MOVE ER-2763                TO  EMI-ERROR.
  3611     MOVE -1                     TO  CARRIERL.
  3612     MOVE AL-UABON               TO  CARRIERA
  3613                                     GROUPA
  3614                                     FINRESPA
  3615                                     ACCTA.
  3616
  3617     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3618
  3619     GO TO 8200-SEND-DATAONLY.
  3620
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  72
* EL633.cbl
  3622 0500-CREATE-TEMP-STORAGE.
  3623
  3624     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3625
  3626
  3627* EXEC CICS WRITEQ TS
  3628*        QUEUE  (QID)
  3629*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3630*        LENGTH (PI-COMM-LENGTH)
  3631*    END-EXEC.
  3632*    MOVE '*"     L              ''   #00003558' TO DFHEIV0
  3633     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  3634     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3635     MOVE X'2020233030303033353538' TO DFHEIV0(25:11)
  3636     CALL 'kxdfhei1' USING DFHEIV0,
  3637           QID,
  3638           PROGRAM-INTERFACE-BLOCK,
  3639           PI-COMM-LENGTH,
  3640           DFHEIV99,
  3641           DFHEIV99,
  3642           DFHEIV99
  3643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3644
  3645
  3646 0590-EXIT.
  3647      EXIT.
  3648
  3649 0600-RECOVER-TEMP-STORAGE.
  3650
  3651* EXEC CICS READQ TS
  3652*        QUEUE  (QID)
  3653*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3654*        LENGTH (PI-COMM-LENGTH)
  3655*    END-EXEC.
  3656*    MOVE '*$I    L              ''   #00003568' TO DFHEIV0
  3657     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3658     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3659     MOVE X'2020233030303033353638' TO DFHEIV0(25:11)
  3660     CALL 'kxdfhei1' USING DFHEIV0,
  3661           QID,
  3662           PROGRAM-INTERFACE-BLOCK,
  3663           PI-COMM-LENGTH,
  3664           DFHEIV99,
  3665           DFHEIV99,
  3666           DFHEIV99
  3667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3668
  3669
  3670     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3671
  3672 0690-EXIT.
  3673      EXIT.
  3674
  3675 0800-DELETE-TS.
  3676
  3677* EXEC CICS HANDLE CONDITION
  3678*        QIDERR (0890-EXIT)
  3679*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  73
* EL633.cbl
  3680*    MOVE '"$N                   ! $ #00003580' TO DFHEIV0
  3681     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3683     MOVE X'2420233030303033353830' TO DFHEIV0(25:11)
  3684     CALL 'kxdfhei1' USING DFHEIV0
  3685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3686
  3687
  3688
  3689* EXEC CICS DELETEQ TS
  3690*        QUEUE  (QID)
  3691*    END-EXEC.
  3692*    MOVE '*&                    #   #00003584' TO DFHEIV0
  3693     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3694     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3695     MOVE X'2020233030303033353834' TO DFHEIV0(25:11)
  3696     CALL 'kxdfhei1' USING DFHEIV0,
  3697           QID,
  3698           DFHEIV99
  3699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3700
  3701
  3702
  3703* EXEC CICS SYNCPOINT
  3704*    END-EXEC.
  3705*    MOVE '6"                    !   #00003588' TO DFHEIV0
  3706     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3708     MOVE X'2020233030303033353838' TO DFHEIV0(25:11)
  3709     CALL 'kxdfhei1' USING DFHEIV0
  3710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3711
  3712
  3713 0890-EXIT.
  3714      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  74
* EL633.cbl
  3716
  3717 1000-EDIT-DATA.
  3718     SET PINDX                   TO  1.
  3719
  3720     .
  3721 1010-EDIT-LOOP.
  3722     SET NDX                     TO  PINDX.
  3723     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3724        GL-STATE-LEN (PINDX) = ZEROS   AND
  3725        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3726        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3727        RTYPE-LEN (PINDX)     = ZEROS  AND
  3728        AMT-LEN (PINDX)       = ZEROS  AND
  3729        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3730        SDTE-LEN (PINDX)      = ZEROS
  3731         GO TO 1020-INCREMENT-PINDX.
  3732
  3733     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3734         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3735         IF PI-COMPANY-ID NOT = 'WSL'
  3736             NEXT SENTENCE
  3737         ELSE
  3738             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3739             MOVE '4'                   TO  DC-OPTION-CODE
  3740             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3741             IF NO-CONVERSION-ERROR
  3742                 NEXT SENTENCE
  3743             ELSE
  3744                 MOVE ER-2595    TO  EMI-ERROR
  3745                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3746                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3747                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3748     ELSE
  3749         IF PI-COMPANY-ID = 'WSL'
  3750           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3751             MOVE ER-2596        TO  EMI-ERROR
  3752             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3753             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3754             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3755
  3756
  3757     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3758*        MOVE K-SPACE            TO COFA-FILLER
  3759*        MOVE '0001'             TO COFA-COMPANY-X
  3760*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3761         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3762     ELSE
  3763         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3764             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3765             MOVE ER-2957        TO EMI-ERROR
  3766             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3767             PERFORM 9900-ERROR-FORMAT THRU
  3768                     9900-EXIT
  3769             GO TO 1040-CONTINUE-EDIT
  3770         ELSE
  3771             GO TO 1040-CONTINUE-EDIT
  3772         END-IF
  3773     END-IF.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  75
* EL633.cbl
  3774
  3775     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3776        AND (RTYPE (PINDX) = 'P')
  3777        GO TO 1040-CONTINUE-EDIT
  3778     END-IF
  3779     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3780        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3781     ELSE
  3782        MOVE SPACES              TO CHECK-GL-ACCT
  3783     END-IF
  3784
  3785     EVALUATE TRUE
  3786        WHEN (PI-COMPANY-ID = 'DCC')
  3787           AND (CO-CARRIER = '1' OR '2' or '9')
  3788           AND (VALID-DCC-GL-ACCOUNT)
  3789           GO TO 1040-CONTINUE-EDIT
  3790        WHEN (PI-COMPANY-ID = 'DCC')
  3791           AND (CO-CARRIER = '3' OR '4')
  3792           AND VALID-CSI-GL-ACCOUNT
  3793           GO TO 1040-CONTINUE-EDIT
  3794        WHEN (PI-COMPANY-ID = 'DCC')
  3795           AND (CO-CARRIER = '5' OR '6' or '7')
  3796           AND (VALID-CCC-GL-ACCOUNT)
  3797           GO TO 1040-CONTINUE-EDIT
  3798        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3799           AND (VALID-GL-ACCOUNT)
  3800           GO TO 1040-CONTINUE-EDIT
  3801        WHEN (PI-COMPANY-ID = 'VPP')
  3802           AND (VALID-VPP-GL-ACCOUNT)
  3803           GO TO 1040-CONTINUE-EDIT
  3804     END-EVALUATE
  3805*    EXEC CICS HANDLE CONDITION
  3806*         NOTFND (1040-NO-COFA-MSTR)
  3807*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3808*    END-EXEC.
  3809*
  3810*    EXEC CICS READ
  3811*         DATASET (COFA-FILE-ID)
  3812*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3813*         RIDFLD  (COFA-KEY-X)
  3814*    END-EXEC.
  3815*
  3816*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3817*    GO TO 1040-CONTINUE-EDIT.
  3818*
  3819*1040-NO-COFA-MSTR.
  3820
  3821     MOVE ER-2960                TO EMI-ERROR.
  3822     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3823     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3824     PERFORM 9900-ERROR-FORMAT THRU
  3825             9900-EXIT.
  3826
  3827 1040-CONTINUE-EDIT.
  3828
  3829*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3830     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3831         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  76
* EL633.cbl
  3832         IF NOT VALID-STATE-CODE
  3833             MOVE -1             TO GL-STATE-LEN (PINDX)
  3834             MOVE ER-2957        TO EMI-ERROR
  3835             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3836             PERFORM 9900-ERROR-FORMAT THRU
  3837                     9900-EXIT
  3838         ELSE
  3839             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3840         END-IF
  3841     END-IF.
  3842
  3843 1040-CSO-SKIP.
  3844
  3845     IF GL-CANC (PINDX) = LOW-VALUES
  3846         MOVE SPACES             TO GL-CANC (PINDX)
  3847     END-IF.
  3848
  3849     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3850         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3851         IF NOT VALID-CANC-TYPE
  3852             MOVE -1             TO GL-CANC-LEN (PINDX)
  3853             MOVE ER-2958        TO EMI-ERROR
  3854             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3855             PERFORM 9900-ERROR-FORMAT THRU
  3856                     9900-EXIT
  3857         ELSE
  3858             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3859         END-IF
  3860     END-IF.
  3861
  3862     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3863        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3864        IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3865           AND (RTYPE (PINDX) = 'P')
  3866           SET VALID-REC-TYPE   TO TRUE
  3867        END-IF
  3868         IF NOT VALID-REC-TYPE
  3869             MOVE -1             TO  RTYPE-LEN (PINDX)
  3870             MOVE ER-2234        TO  EMI-ERROR
  3871             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3872             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3873         ELSE
  3874             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3875     ELSE
  3876         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3877             MOVE -1             TO  RTYPE-LEN (PINDX)
  3878             MOVE ER-2235        TO  EMI-ERROR
  3879             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3880             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3881
  3882     IF AMT-LEN (PINDX) NOT = ZEROS
  3883
  3884* EXEC CICS BIF DEEDIT
  3885*           FIELD (AMT (PINDX))
  3886*           LENGTH (11)
  3887*       END-EXEC
  3888     MOVE 11
  3889       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  77
* EL633.cbl
  3890*    MOVE '@"L                   #   #00003761' TO DFHEIV0
  3891     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3892     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3893     MOVE X'2020233030303033373631' TO DFHEIV0(25:11)
  3894     CALL 'kxdfhei1' USING DFHEIV0,
  3895           AMT(PINDX),
  3896           DFHEIV11
  3897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3898         IF AMT (PINDX) = ZEROS
  3899             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3900                 NEXT SENTENCE
  3901             ELSE
  3902                 MOVE ER-2245    TO  EMI-ERROR
  3903                 MOVE -1         TO  AMT-LEN(PINDX)
  3904                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3905                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3906         ELSE
  3907             IF AMT (PINDX) NUMERIC
  3908                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3909             ELSE
  3910                 MOVE ER-2245    TO  EMI-ERROR
  3911                 MOVE -1         TO  AMT-LEN(PINDX)
  3912                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3913                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3914     ELSE
  3915         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3916             MOVE -1             TO  AMT-LEN (PINDX)
  3917             MOVE ER-2236        TO  EMI-ERROR
  3918             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3919             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3920
  3921     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3922         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3923           AND (PI-REC-TYPE (NDX) = 'C')
  3924             IF VOID-SW (PINDX) = 'V'
  3925                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3926             ELSE
  3927                 MOVE ER-2246    TO  EMI-ERROR
  3928                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3929                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3930                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3931         ELSE
  3932             MOVE ER-2449        TO  EMI-ERROR
  3933             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3934             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3935             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3936
  3937     IF SDTE-LEN (PINDX) = ZEROS
  3938        GO TO 1020-INCREMENT-PINDX.
  3939
  3940     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3941
  3942     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3943     PERFORM 8600-DEEDIT.
  3944
  3945     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3946        GO TO 1015-DAY-ERROR.
  3947
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  78
* EL633.cbl
  3948     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3949     MOVE '4'                    TO  DC-OPTION-CODE.
  3950     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3951
  3952     IF NO-CONVERSION-ERROR
  3953        SET PINDEX               TO  PINDX
  3954        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3955     ELSE
  3956        GO TO 1015-DAY-ERROR.
  3957
  3958     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3959
  3960     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3961         IF DATE-TEST-DD  NOT = 30
  3962             GO TO 1015-DAY-ERROR
  3963         ELSE
  3964             GO TO 1020-INCREMENT-PINDX.
  3965
  3966     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3967                             8  OR  10  OR  12
  3968         IF DATE-TEST-DD  NOT = 31
  3969             GO TO 1015-DAY-ERROR
  3970         ELSE
  3971             GO TO 1020-INCREMENT-PINDX.
  3972
  3973     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3974         REMAINDER  DIVIDE-REMAINDER.
  3975
  3976     IF (DATE-TEST-YY = ZERO)
  3977       OR (DIVIDE-REMAINDER NOT = ZERO)
  3978         IF DATE-TEST-DD  NOT = 28
  3979             GO TO 1015-DAY-ERROR
  3980         ELSE
  3981             GO TO 1020-INCREMENT-PINDX
  3982     ELSE
  3983         IF DATE-TEST-DD = 29
  3984             GO TO 1020-INCREMENT-PINDX.
  3985
  3986 1015-DAY-ERROR.
  3987     MOVE -1                     TO  SDTE-LEN (PINDX).
  3988     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3989     MOVE ER-0587                TO  EMI-ERROR.
  3990
  3991     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3992
  3993 1020-INCREMENT-PINDX.
  3994     SET PINDX  UP  BY  1.
  3995
  3996     IF PINDX  IS NOT GREATER THAN  13
  3997         GO TO 1010-EDIT-LOOP.
  3998
  3999     IF EMI-ERROR = ZEROS
  4000         NEXT SENTENCE
  4001     ELSE
  4002         MOVE 'S'                TO  PI-PREV-FUNCTION
  4003         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  79
* EL633.cbl
  4005 2000-UPDATE-THE-FILE.
  4006     SET PINDX                   TO  ZERO-NDX.
  4007*    SET NDX                     TO  ZERO-NDX.
  4008*    SET NDX  UP  BY  1.
  4009
  4010     IF PI-PYAJ-FILE-SW = 'B'
  4011         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  4012         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  4013     ELSE
  4014         MOVE PI-LAST-FILE-SEQ-NO
  4015                                 TO  PI-SAV-FILE-SEQ-NO
  4016         MOVE PI-LAST-RECORD-TYPE
  4017                                 TO  PI-SAV-RECORD-TYPE.
  4018
  4019 2100-UPDATE-LOOP.
  4020     SET PINDX  UP  BY  1.
  4021     SET NDX                     TO  PINDX.
  4022
  4023     IF PINDX  IS GREATER THAN  13
  4024         GO TO 2200-UPDATE-COMPLETE.
  4025
  4026     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  4027        GL-STATE-LEN (PINDX) = ZEROS AND
  4028        GL-CANC-LEN (PINDX)   = ZEROS AND
  4029        GL-COMM-LEN (PINDX)   = ZEROS AND
  4030        RTYPE-LEN (PINDX)   = ZEROS  AND
  4031        AMT-LEN (PINDX)     = ZEROS  AND
  4032        VOID-SW-LEN (PINDX) = ZEROS  AND
  4033        SDTE-LEN (PINDX)    = ZEROS
  4034         GO TO 2100-UPDATE-LOOP.
  4035
  4036
  4037* EXEC CICS BIF DEEDIT
  4038*         FIELD (AMT (PINDX))
  4039*         LENGTH (11)
  4040*    END-EXEC.
  4041     MOVE 11
  4042       TO DFHEIV11
  4043*    MOVE '@"L                   #   #00003903' TO DFHEIV0
  4044     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4045     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4046     MOVE X'2020233030303033393033' TO DFHEIV0(25:11)
  4047     CALL 'kxdfhei1' USING DFHEIV0,
  4048           AMT(PINDX),
  4049           DFHEIV11
  4050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4051
  4052
  4053     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4054         NEXT SENTENCE
  4055     ELSE
  4056         GO TO 2110-ADD-RECORD.
  4057
  4058
  4059* EXEC CICS HANDLE CONDITION
  4060*        NOTFND  (2110-ADD-RECORD)
  4061*    END-EXEC.
  4062*    MOVE '"$I                   ! % #00003913' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  80
* EL633.cbl
  4063     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4064     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4065     MOVE X'2520233030303033393133' TO DFHEIV0(25:11)
  4066     CALL 'kxdfhei1' USING DFHEIV0
  4067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4068
  4069
  4070     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4071     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4072     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4073
  4074
  4075* EXEC CICS READ
  4076*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4077*        DATASET  (PYAJ-FILE-ID)
  4078*        RIDFLD   (ERPYAJ-KEY)
  4079*        UPDATE
  4080*    END-EXEC.
  4081*    MOVE '&"S        EU         (   #00003921' TO DFHEIV0
  4082     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4083     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4084     MOVE X'2020233030303033393231' TO DFHEIV0(25:11)
  4085     CALL 'kxdfhei1' USING DFHEIV0,
  4086           PYAJ-FILE-ID,
  4087           DFHEIV20,
  4088           DFHEIV99,
  4089           ERPYAJ-KEY,
  4090           DFHEIV99,
  4091           DFHEIV99,
  4092           DFHEIV99
  4093     SET ADDRESS OF PENDING-PAY-ADJ TO
  4094         DFHEIV20
  4095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4096
  4097
  4098
  4099     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4100        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4101            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4102            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4103            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4104
  4105     IF AMT-LEN (PINDX) NOT = ZEROS
  4106         IF AMT (PINDX) = ZEROS
  4107             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4108                 GO TO 2120-DELETE-RECORD
  4109             ELSE
  4110                 MOVE ER-2244       TO  EMI-ERROR
  4111                 MOVE -1            TO  AMT-LEN (PINDX)
  4112                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4113                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4114                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4115
  4116* EXEC CICS UNLOCK
  4117*                    DATASET  (PYAJ-FILE-ID)
  4118*                END-EXEC
  4119*    MOVE '&*                    #   #00003945' TO DFHEIV0
  4120     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  81
* EL633.cbl
  4121     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4122     MOVE X'2020233030303033393435' TO DFHEIV0(25:11)
  4123     CALL 'kxdfhei1' USING DFHEIV0,
  4124           PYAJ-FILE-ID,
  4125           DFHEIV99
  4126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4127                 GO TO 8200-SEND-DATAONLY.
  4128
  4129     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4130     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4131     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4132
  4133     PERFORM 8400-LOG-JOURNAL-RECORD.
  4134
  4135     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4136     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4137     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4138
  4139     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4140         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4141     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4142         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4143     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4144         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4145     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4146         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4147     IF AMT-LEN (PINDX) NOT = ZEROS
  4148         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4149
  4150     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4151         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4152
  4153     IF SDTE-LEN (PINDX) NOT = ZEROS
  4154        SET PINDEX               TO  PINDX
  4155        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4156
  4157     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4158     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4159     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4160
  4161
  4162* EXEC CICS REWRITE
  4163*        DATASET  (PYAJ-FILE-ID)
  4164*        FROM     (PENDING-PAY-ADJ)
  4165*    END-EXEC.
  4166     MOVE LENGTH OF
  4167      PENDING-PAY-ADJ
  4168       TO DFHEIV11
  4169*    MOVE '&& L                  %   #00003982' TO DFHEIV0
  4170     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4171     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4172     MOVE X'2020233030303033393832' TO DFHEIV0(25:11)
  4173     CALL 'kxdfhei1' USING DFHEIV0,
  4174           PYAJ-FILE-ID,
  4175           PENDING-PAY-ADJ,
  4176           DFHEIV11,
  4177           DFHEIV99
  4178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  82
* EL633.cbl
  4179
  4180
  4181     PERFORM 8400-LOG-JOURNAL-RECORD.
  4182
  4183     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  83
* EL633.cbl
  4185 2110-ADD-RECORD.
  4186
  4187* EXEC CICS GETMAIN
  4188*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4189*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4190*        INITIMG  (GETMAIN-SPACE)
  4191*    END-EXEC.
  4192*    MOVE ',"IL                  $   #00003992' TO DFHEIV0
  4193     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4194     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4195     MOVE X'2020233030303033393932' TO DFHEIV0(25:11)
  4196     CALL 'kxdfhei1' USING DFHEIV0,
  4197           DFHEIV20,
  4198           ERPYAJ-RECORD-LENGTH,
  4199           GETMAIN-SPACE
  4200     SET ADDRESS OF PENDING-PAY-ADJ TO
  4201         DFHEIV20
  4202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4203
  4204
  4205     MOVE 'PY'                   TO  PY-RECORD-ID.
  4206     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4207     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4208     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4209     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4210     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4211
  4212     ADD +1                      TO  WORK-SEQ-NO.
  4213     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4214
  4215     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4216     if gl-state-len (pindx) <> zeros
  4217        MOVE GL-STATE (PINDX)    TO  PY-GL-STATE
  4218     end-if
  4219     if gl-canc-len (pindx) <> zeros
  4220        MOVE GL-CANC (PINDX)     TO  PY-GL-CANC-SW
  4221     end-if
  4222     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4223
  4224     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4225     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4226     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4227        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4228     END-IF
  4229     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4230     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4231     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4232                                     PY-INPUT-DT.
  4233     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4234                                     PY-CHECK-QUE-SEQUENCE.
  4235     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4236                                     PY-BILLED-DATE
  4237                                     PY-AR-DATE
  4238                                     PY-REPORTED-DT
  4239                                     PY-CHECK-WRITTEN-DT.
  4240     IF SDTE-LEN (PINDX) = ZEROS
  4241         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4242         GO TO 2115-WRITE-REC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  84
* EL633.cbl
  4243     END-IF.
  4244
  4245     IF SDTE (PINDX) IS NUMERIC
  4246         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
  4247         MOVE '4'            TO  DC-OPTION-CODE
  4248         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4249         IF DATE-CONVERSION-ERROR
  4250             MOVE PI-CR-MONTH-END-DT
  4251                             TO  PY-CREDIT-SELECT-DT
  4252         ELSE
  4253             MOVE DC-BIN-DATE-1
  4254                             TO  PY-CREDIT-SELECT-DT
  4255         END-IF
  4256     ELSE
  4257         MOVE PI-CR-MONTH-END-DT
  4258                             TO  PY-CREDIT-SELECT-DT
  4259     END-IF
  4260
  4261     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4262         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4263         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4264
  4265     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4266         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4267         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4268
  4269     MOVE 'N'                    TO  FIRST-ADD-SW.
  4270
  4271     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4272     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4273     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4274 2115-WRITE-REC.
  4275
  4276* EXEC CICS WRITE
  4277*        DATASET  (PYAJ-FILE-ID)
  4278*        FROM     (PENDING-PAY-ADJ)
  4279*        RIDFLD   (PY-CONTROL-PRIMARY)
  4280*    END-EXEC.
  4281     MOVE LENGTH OF
  4282      PENDING-PAY-ADJ
  4283       TO DFHEIV11
  4284*    MOVE '&$ L                  ''   #00004068' TO DFHEIV0
  4285     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4286     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4287     MOVE X'2020233030303034303638' TO DFHEIV0(25:11)
  4288     CALL 'kxdfhei1' USING DFHEIV0,
  4289           PYAJ-FILE-ID,
  4290           PENDING-PAY-ADJ,
  4291           DFHEIV11,
  4292           PY-CONTROL-PRIMARY,
  4293           DFHEIV99,
  4294           DFHEIV99
  4295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4296
  4297
  4298     PERFORM 8400-LOG-JOURNAL-RECORD.
  4299
  4300     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  85
* EL633.cbl
  4301
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  86
* EL633.cbl
  4303 2120-DELETE-RECORD.
  4304     IF PY-RECORD-TYPE NOT = 'C'
  4305         GO TO 2120-DELETE-CONT.
  4306
  4307     IF PY-CHECK-QUE-CONTROL = ZEROS
  4308       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4309         GO TO 2120-DELETE-CONT.
  4310
  4311
  4312* EXEC CICS HANDLE CONDITION
  4313*        NOTFND  (2120-DELETE-CONT)
  4314*    END-EXEC.
  4315*    MOVE '"$I                   ! & #00004087' TO DFHEIV0
  4316     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4318     MOVE X'2620233030303034303837' TO DFHEIV0(25:11)
  4319     CALL 'kxdfhei1' USING DFHEIV0
  4320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4321
  4322
  4323     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4324     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4325     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4326
  4327
  4328* EXEC CICS READ
  4329*        SET      (ADDRESS OF CHECK-QUE)
  4330*        DATASET  (CHKQ-FILE-ID)
  4331*        RIDFLD   (ERCHKQ-KEY)
  4332*        UPDATE
  4333*    END-EXEC.
  4334*    MOVE '&"S        EU         (   #00004095' TO DFHEIV0
  4335     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4336     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4337     MOVE X'2020233030303034303935' TO DFHEIV0(25:11)
  4338     CALL 'kxdfhei1' USING DFHEIV0,
  4339           CHKQ-FILE-ID,
  4340           DFHEIV20,
  4341           DFHEIV99,
  4342           ERCHKQ-KEY,
  4343           DFHEIV99,
  4344           DFHEIV99,
  4345           DFHEIV99
  4346     SET ADDRESS OF CHECK-QUE TO
  4347         DFHEIV20
  4348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4349
  4350
  4351*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4352*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4353*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4354*
  4355*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4356
  4357
  4358* EXEC CICS DELETE
  4359*        DATASET  (CHKQ-FILE-ID)
  4360*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  87
* EL633.cbl
  4361*    MOVE '&(                    &   #00004108' TO DFHEIV0
  4362     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4363     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4364     MOVE X'2020233030303034313038' TO DFHEIV0(25:11)
  4365     CALL 'kxdfhei1' USING DFHEIV0,
  4366           CHKQ-FILE-ID,
  4367           DFHEIV99,
  4368           DFHEIV99,
  4369           DFHEIV99,
  4370           DFHEIV99
  4371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4372
  4373
  4374 2120-DELETE-CONT.
  4375*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4376*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4377*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4378*
  4379*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4380
  4381     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4382         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4383         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4384         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4385                                     PI-SAV-ACCT-NET
  4386                                     PI-SAV-PREV-AMT
  4387                                     PI-SAV-PREV-NET.
  4388
  4389
  4390* EXEC CICS DELETE
  4391*        DATASET(PYAJ-FILE-ID)
  4392*    END-EXEC.
  4393*    MOVE '&(                    &   #00004127' TO DFHEIV0
  4394     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4395     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4396     MOVE X'2020233030303034313237' TO DFHEIV0(25:11)
  4397     CALL 'kxdfhei1' USING DFHEIV0,
  4398           PYAJ-FILE-ID,
  4399           DFHEIV99,
  4400           DFHEIV99,
  4401           DFHEIV99,
  4402           DFHEIV99
  4403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4404
  4405
  4406     GO TO 2100-UPDATE-LOOP.
  4407
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  88
* EL633.cbl
  4409
  4410 2190-CHANGE-RECORD-TYPE.
  4411
  4412*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4413*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4414*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4415*
  4416*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4417
  4418
  4419* EXEC CICS DELETE
  4420*        DATASET(PYAJ-FILE-ID)
  4421*    END-EXEC.
  4422*    MOVE '&(                    &   #00004143' TO DFHEIV0
  4423     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4424     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4425     MOVE X'2020233030303034313433' TO DFHEIV0(25:11)
  4426     CALL 'kxdfhei1' USING DFHEIV0,
  4427           PYAJ-FILE-ID,
  4428           DFHEIV99,
  4429           DFHEIV99,
  4430           DFHEIV99,
  4431           DFHEIV99
  4432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4433
  4434
  4435
  4436* EXEC CICS GETMAIN
  4437*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4438*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4439*        INITIMG  (GETMAIN-SPACE)
  4440*    END-EXEC.
  4441*    MOVE ',"IL                  $   #00004147' TO DFHEIV0
  4442     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4443     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4444     MOVE X'2020233030303034313437' TO DFHEIV0(25:11)
  4445     CALL 'kxdfhei1' USING DFHEIV0,
  4446           DFHEIV20,
  4447           ERPYAJ-RECORD-LENGTH,
  4448           GETMAIN-SPACE
  4449     SET ADDRESS OF PENDING-PAY-ADJ TO
  4450         DFHEIV20
  4451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4452
  4453
  4454*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4455*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4456
  4457     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4458     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4459                                    PYAJ-RECORD-TYPE.
  4460
  4461
  4462* EXEC CICS HANDLE CONDITION
  4463*        DUPREC (2190-DUP-RECORD)
  4464*    END-EXEC.
  4465*    MOVE '"$%                   ! '' #00004160' TO DFHEIV0
  4466     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  89
* EL633.cbl
  4467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4468     MOVE X'2720233030303034313630' TO DFHEIV0(25:11)
  4469     CALL 'kxdfhei1' USING DFHEIV0
  4470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4471
  4472
  4473*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4474*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4475*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4476
  4477 2190-RETRY-WRITE.
  4478
  4479
  4480* EXEC CICS WRITE
  4481*        DATASET  (PYAJ-FILE-ID)
  4482*        FROM     (PENDING-PAY-ADJ)
  4483*        RIDFLD   (PY-CONTROL-PRIMARY)
  4484*    END-EXEC.
  4485     MOVE LENGTH OF
  4486      PENDING-PAY-ADJ
  4487       TO DFHEIV11
  4488*    MOVE '&$ L                  ''   #00004170' TO DFHEIV0
  4489     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4490     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4491     MOVE X'2020233030303034313730' TO DFHEIV0(25:11)
  4492     CALL 'kxdfhei1' USING DFHEIV0,
  4493           PYAJ-FILE-ID,
  4494           PENDING-PAY-ADJ,
  4495           DFHEIV11,
  4496           PY-CONTROL-PRIMARY,
  4497           DFHEIV99,
  4498           DFHEIV99
  4499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4500
  4501
  4502*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4503
  4504
  4505* EXEC CICS READ
  4506*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4507*        DATASET  (PYAJ-FILE-ID)
  4508*        RIDFLD   (ERPYAJ-KEY)
  4509*        UPDATE
  4510*    END-EXEC.
  4511*    MOVE '&"S        EU         (   #00004178' TO DFHEIV0
  4512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4513     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4514     MOVE X'2020233030303034313738' TO DFHEIV0(25:11)
  4515     CALL 'kxdfhei1' USING DFHEIV0,
  4516           PYAJ-FILE-ID,
  4517           DFHEIV20,
  4518           DFHEIV99,
  4519           ERPYAJ-KEY,
  4520           DFHEIV99,
  4521           DFHEIV99,
  4522           DFHEIV99
  4523     SET ADDRESS OF PENDING-PAY-ADJ TO
  4524         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  90
* EL633.cbl
  4525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4526
  4527
  4528     GO TO 2190-EXIT.
  4529
  4530 2190-DUP-RECORD.
  4531
  4532     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4533
  4534     GO TO 2190-RETRY-WRITE.
  4535
  4536 2190-EXIT.
  4537     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  91
* EL633.cbl
  4539
  4540 2200-UPDATE-COMPLETE.
  4541     IF EIBAID = DFHPF1
  4542         GO TO 4000-BROWSE-FRWD.
  4543
  4544     IF EIBAID = DFHPF2
  4545         GO TO 4100-BROWSE-BKWD.
  4546
  4547     MOVE LOW-VALUES             TO  EL633AI.
  4548
  4549     MOVE ER-0000                TO  EMI-ERROR.
  4550     MOVE -1                     TO  MAINTL.
  4551
  4552     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4553
  4554     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4555     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4556
  4557*    GO TO 4000-BROWSE-FRWD.
  4558
  4559*    GO TO 8100-SEND-INITIAL-MAP.
  4560
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  92
* EL633.cbl
  4562 4000-BROWSE-FRWD.
  4563     MOVE '1'                     TO  PI-PREV-PFKEY.
  4564     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4565
  4566     IF EIBAID = DFHPF1
  4567         IF PAGE-FULL
  4568             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4569                                      TO  PYAJ-FILE-SEQ-NO
  4570             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4571             MOVE 'N'                 TO  PYAJ-READ-SW
  4572             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4573             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4574             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4575             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4576         ELSE
  4577             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4578                                          PI-SAV-ACCT-NET
  4579                                          PI-SAV-PREV-AMT
  4580                                          PI-SAV-PREV-NET
  4581             MOVE 'Y'                 TO  PI-PAGE-SW
  4582             IF NOT END-OF-FILE
  4583                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4584                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4585             END-IF
  4586             IF TOP-OF-FILE
  4587                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4588                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4589                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4590             ELSE
  4591                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4592                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4593     ELSE
  4594         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4595         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4596         IF MAINTI = 'S'
  4597             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4598             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4599
  4600
  4601     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4602
  4603     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4604         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4605
  4606 4000-BROWSE-FRWD-FOR-PREV.
  4607*    IF END-OF-FILE
  4608*        IF EIBAID = DFHPF1
  4609*           IF PI-TOTAL-DISPLAYED
  4610*              NEXT SENTENCE
  4611*           ELSE
  4612*              MOVE -1                 TO  MAINTL
  4613*              MOVE ER-2237            TO  EMI-ERROR
  4614*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4615*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4616*              SET PINDX               TO  +2
  4617*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4618*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4619*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  93
* EL633.cbl
  4620*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4621*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4622*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4623*                                          PI-SAV-ACCT-NET
  4624*              GO TO 8100-SEND-INITIAL-MAP.
  4625*
  4626*     IF END-OF-FILE
  4627*        IF EIBAID = DFHPF1
  4628*           MOVE -1             TO  MAINTL
  4629*           MOVE ER-2237        TO  EMI-ERROR
  4630*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4631*           GO TO 8200-SEND-DATAONLY.
  4632*
  4633     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4634
  4635     IF NO-RECORDS
  4636        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4637        MOVE LOW-VALUES         TO  EL633AO
  4638        MOVE ER-2239            TO  EMI-ERROR
  4639        MOVE -1                 TO  MAINTL
  4640        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4641        GO TO 8100-SEND-INITIAL-MAP.
  4642
  4643     IF NOT-OPEN
  4644         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4645
  4646     MOVE LOW-VALUES             TO  EL633AO.
  4647     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4648
  4649     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4650          VARYING  PINDX  FROM  1  BY  1
  4651             UNTIL  END-OF-ACCT
  4652                 OR  END-OF-FILE
  4653                     OR  PAGE-FULL
  4654                         OR  NO-RECORDS.
  4655
  4656     IF NO-RECORDS
  4657         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4658         MOVE LOW-VALUES         TO  EL633AO
  4659         MOVE ER-2239            TO  EMI-ERROR
  4660         MOVE -1                 TO  MAINTL
  4661         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4662         GO TO 8100-SEND-INITIAL-MAP.
  4663
  4664     IF END-OF-FILE
  4665         IF EIBAID = DFHPF2
  4666             MOVE ER-2238        TO  EMI-ERROR
  4667             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4668             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4669         ELSE
  4670             MOVE ER-2237        TO  EMI-ERROR
  4671             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4672
  4673     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4674                                     PI-SAV-FUNCTION.
  4675
  4676     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  94
* EL633.cbl
  4678 4100-BROWSE-BKWD.
  4679     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4680                                      PI-TOTAL-DISPLAYED-SW.
  4681     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4682     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4683     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4684     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4685                                      PI-SAV-ACCT-NET
  4686                                      PI-SAV-PREV-AMT
  4687                                      PI-SAV-PREV-NET.
  4688
  4689     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4690
  4691     IF NO-RECORDS
  4692         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4693         MOVE LOW-VALUES         TO  EL633AO
  4694         MOVE ER-2239            TO  EMI-ERROR
  4695         MOVE -1                 TO  MAINTL
  4696         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4697         GO TO 8100-SEND-INITIAL-MAP.
  4698
  4699     IF NOT-OPEN
  4700         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4701
  4702
  4703* EXEC CICS READNEXT
  4704*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4705*        DATASET  (PYAJ-FILE-ID)
  4706*        RIDFLD   (ERPYAJ-KEY)
  4707*    END-EXEC.
  4708     MOVE 0
  4709       TO DFHEIV11
  4710*    MOVE '&.S                   )   #00004359' TO DFHEIV0
  4711     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4712     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4713     MOVE X'2020233030303034333539' TO DFHEIV0(25:11)
  4714     CALL 'kxdfhei1' USING DFHEIV0,
  4715           PYAJ-FILE-ID,
  4716           DFHEIV20,
  4717           DFHEIV99,
  4718           ERPYAJ-KEY,
  4719           DFHEIV99,
  4720           DFHEIV11,
  4721           DFHEIV99,
  4722           DFHEIV99
  4723     SET ADDRESS OF PENDING-PAY-ADJ TO
  4724         DFHEIV20
  4725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4726
  4727
  4728     IF FIRST-PAGE OR
  4729        PI-PREV-PFKEY = '2'
  4730         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4731         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4732
  4733     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4734
  4735     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  95
* EL633.cbl
  4736     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4737     MOVE '2'                     TO  PI-PREV-PFKEY.
  4738
  4739     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  96
* EL633.cbl
  4741 5000-START-BROWSE.
  4742
  4743* EXEC CICS HANDLE CONDITION
  4744*        NOTOPEN  (5010-NOT-OPEN)
  4745*        NOTFND   (5020-NO-RECORDS)
  4746*        ENDFILE  (5020-NO-RECORDS)
  4747*    END-EXEC.
  4748*    MOVE '"$JI''                 ! ( #00004379' TO DFHEIV0
  4749     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4750     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4751     MOVE X'2820233030303034333739' TO DFHEIV0(25:11)
  4752     CALL 'kxdfhei1' USING DFHEIV0
  4753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4754
  4755
  4756
  4757* EXEC CICS STARTBR
  4758*        DATASET  (PYAJ-FILE-ID)
  4759*        RIDFLD   (ERPYAJ-KEY)
  4760*    END-EXEC.
  4761     MOVE 0
  4762       TO DFHEIV11
  4763*    MOVE '&,         G          &   #00004385' TO DFHEIV0
  4764     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4765     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4766     MOVE X'2020233030303034333835' TO DFHEIV0(25:11)
  4767     CALL 'kxdfhei1' USING DFHEIV0,
  4768           PYAJ-FILE-ID,
  4769           ERPYAJ-KEY,
  4770           DFHEIV99,
  4771           DFHEIV11,
  4772           DFHEIV99
  4773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4774
  4775
  4776     GO TO 5030-EXIT.
  4777
  4778 5010-NOT-OPEN.
  4779     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4780
  4781     GO TO 5030-EXIT.
  4782
  4783 5020-NO-RECORDS.
  4784     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4785     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4786
  4787 5030-EXIT.
  4788     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  97
* EL633.cbl
  4790 5100-READ-PREVIOUS.
  4791
  4792* EXEC CICS HANDLE CONDITION
  4793*        ENDFILE  (5110-END-OF-FILE)
  4794*        NOTFND   (5110-END-OF-FILE)
  4795*    END-EXEC.
  4796*    MOVE '"$''I                  ! ) #00004405' TO DFHEIV0
  4797     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4799     MOVE X'2920233030303034343035' TO DFHEIV0(25:11)
  4800     CALL 'kxdfhei1' USING DFHEIV0
  4801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4802
  4803
  4804
  4805* EXEC CICS READPREV
  4806*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4807*        DATASET  (PYAJ-FILE-ID)
  4808*        RIDFLD   (ERPYAJ-KEY)
  4809*    END-EXEC.
  4810     MOVE 0
  4811       TO DFHEIV11
  4812*    MOVE '&0S                   )   #00004410' TO DFHEIV0
  4813     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4814     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4815     MOVE X'2020233030303034343130' TO DFHEIV0(25:11)
  4816     CALL 'kxdfhei1' USING DFHEIV0,
  4817           PYAJ-FILE-ID,
  4818           DFHEIV20,
  4819           DFHEIV99,
  4820           ERPYAJ-KEY,
  4821           DFHEIV99,
  4822           DFHEIV11,
  4823           DFHEIV99,
  4824           DFHEIV99
  4825     SET ADDRESS OF PENDING-PAY-ADJ TO
  4826         DFHEIV20
  4827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4828
  4829
  4830     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4831         IF PI-CARRIER-SECURITY = PY-CARRIER
  4832             NEXT SENTENCE
  4833         ELSE
  4834             GO TO 5110-END-OF-FILE.
  4835
  4836     GO TO 5120-EXIT.
  4837
  4838 5110-END-OF-FILE.
  4839     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4840     MOVE ER-2238                TO  EMI-ERROR.
  4841     MOVE -1                     TO  PFENTERL.
  4842
  4843     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4844
  4845     GO TO 8200-SEND-DATAONLY.
  4846
  4847 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  98
* EL633.cbl
  4848     EXIT.
  4849
  4850 5200-END-BROWSE.
  4851
  4852* EXEC CICS ENDBR
  4853*        DATASET  (PYAJ-FILE-ID)
  4854*    END-EXEC.
  4855     MOVE 0
  4856       TO DFHEIV11
  4857*    MOVE '&2                    $   #00004437' TO DFHEIV0
  4858     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4859     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4860     MOVE X'2020233030303034343337' TO DFHEIV0(25:11)
  4861     CALL 'kxdfhei1' USING DFHEIV0,
  4862           PYAJ-FILE-ID,
  4863           DFHEIV11,
  4864           DFHEIV99
  4865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4866
  4867
  4868 5200-EXIT.
  4869     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page  99
* EL633.cbl
  4871 6000-READ-AND-FORMAT-SCREEN.
  4872
  4873* EXEC CICS HANDLE CONDITION
  4874*        ENDFILE  (6100-END-OF-FILE)
  4875*        NOTFND   (6100-END-OF-FILE)
  4876*    END-EXEC.
  4877*    MOVE '"$''I                  ! * #00004445' TO DFHEIV0
  4878     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4880     MOVE X'2A20233030303034343435' TO DFHEIV0(25:11)
  4881     CALL 'kxdfhei1' USING DFHEIV0
  4882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4883
  4884
  4885*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4886*    INITIALIZE  PI-SEQ-NOS.
  4887
  4888 6010-READ-NEXT.
  4889
  4890
  4891* EXEC CICS READNEXT
  4892*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4893*        DATASET  (PYAJ-FILE-ID)
  4894*        RIDFLD   (ERPYAJ-KEY)
  4895*    END-EXEC.
  4896     MOVE 0
  4897       TO DFHEIV11
  4898*    MOVE '&.S                   )   #00004455' TO DFHEIV0
  4899     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4900     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4901     MOVE X'2020233030303034343535' TO DFHEIV0(25:11)
  4902     CALL 'kxdfhei1' USING DFHEIV0,
  4903           PYAJ-FILE-ID,
  4904           DFHEIV20,
  4905           DFHEIV99,
  4906           ERPYAJ-KEY,
  4907           DFHEIV99,
  4908           DFHEIV11,
  4909           DFHEIV99,
  4910           DFHEIV99
  4911     SET ADDRESS OF PENDING-PAY-ADJ TO
  4912         DFHEIV20
  4913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4914
  4915
  4916     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4917       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4918         GO TO 6100-END-OF-FILE.
  4919
  4920     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4921         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4922             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4923                 GO TO 6100-END-OF-FILE.
  4924
  4925     IF PYAJ-1ST-READ
  4926       AND EIBAID NOT = DFHENTER
  4927       AND NOT PAGE-FULL
  4928         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 100
* EL633.cbl
  4929         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4930         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4931         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4932         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4933
  4934     IF PYAJ-1ST-READ
  4935         MOVE PI-SAV-ENDING-PYAJ-KEY
  4936                                 TO  PI-START-PYAJ-KEY.
  4937
  4938     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4939        PI-SAV-CARRIER  = PY-CARRIER     AND
  4940        PI-SAV-GROUPING = PY-GROUPING    AND
  4941        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4942        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4943         NEXT SENTENCE
  4944     ELSE
  4945         IF PYAJ-1ST-READ
  4946             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4947             MOVE SPACE          TO  PYAJ-READ-SW
  4948             GO TO 6200-EXIT
  4949         ELSE
  4950             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4951             IF PINDX  IS LESS THAN  12
  4952                 SET PINDX  UP  BY  1
  4953                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4954                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4955                 SET PINDX  UP  BY  1
  4956                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4957                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4958                     GO TO 6200-EXIT
  4959             ELSE
  4960                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4961                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4962                 SET PINDX  UP  BY  1
  4963                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4964                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4965                 GO TO 6200-EXIT.
  4966
  4967*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4968
  4969     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4970         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4971
  4972*    SET PINDX  UP  BY +1.
  4973
  4974     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4975
  4976     IF PINDX  IS GREATER THAN  13
  4977         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4978         MOVE +13                TO  PI-FULL-INDX
  4979         MOVE PI-FRST-FILE-SEQ-NO
  4980                                 TO  PI-LAST-FILE-SEQ-NO
  4981         MOVE PI-FRST-RECORD-TYPE
  4982                                 TO  PI-LAST-RECORD-TYPE
  4983         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4984         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4985         GO TO 6200-EXIT.
  4986
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 101
* EL633.cbl
  4987     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4988     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4989
  4990     IF PYAJ-1ST-READ
  4991         MOVE SPACE              TO  PYAJ-READ-SW.
  4992
  4993     IF PINDX = 1
  4994         MOVE PI-PREV-FILE-SEQ-NO
  4995                                 TO  PI-FRST-FILE-SEQ-NO
  4996         MOVE PI-PREV-RECORD-TYPE
  4997                                 TO  PI-FRST-RECORD-TYPE
  4998         MOVE PI-PREV-FILE-SEQ-NO
  4999                                 TO  PI-LAST-FILE-SEQ-NO
  5000         MOVE PI-PREV-RECORD-TYPE
  5001                                 TO  PI-LAST-RECORD-TYPE.
  5002
  5003     SET NDX                     TO  PINDX.
  5004     SET WS-SAVE-NDX-VALUE       TO  NDX.
  5005
  5006     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  5007
  5008     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  5009     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  5010     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  5011     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  5012     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  5013
  5014     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  5015
  5016     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  5017         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  5018     ELSE
  5019         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  5020
  5021     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  5022                                     PI-REC-TYPE (NDX).
  5023
  5024     IF PY-VOID-SW NOT = SPACE
  5025         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  5026
  5027     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  5028         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  5029     ELSE
  5030         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  5031                                     PREV-BIN-MAINT-DT
  5032         MOVE SPACE              TO  DC-OPTION-CODE
  5033         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5034* DAN    MOVE DC-GREG-DATE-1-EDIT
  5035         MOVE DC-GREG-DATE-1-MDY
  5036                                 TO  MDTE (PINDX)
  5037                                     PREV-MAINT-DT.
  5038
  5039*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  5040     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  5041         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  5042         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  5043*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  5044*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 102
* EL633.cbl
  5045     END-IF.
  5046
  5047     IF PY-BILLED-DATE NOT = LOW-VALUES
  5048         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  5049                                     AMT-ATTRB (PINDX)
  5050                                     VOID-SW-ATTRB (PINDX)
  5051         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5052             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5053         ELSE
  5054             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5055                                     PREV-BIN-BL-DT
  5056             MOVE SPACE          TO  DC-OPTION-CODE
  5057             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5058* DAN        MOVE DC-GREG-DATE-1-EDIT
  5059             MOVE DC-GREG-DATE-1-MDY
  5060                                 TO  BDTE (PINDX)
  5061                                     PREV-BL-DT.
  5062
  5063     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5064         NEXT SENTENCE
  5065     ELSE
  5066         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5067                                     AMT-ATTRB     (PINDX).
  5068
  5069     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5070         MOVE PY-CREDIT-SELECT-DT
  5071                                 TO  DC-BIN-DATE-1
  5072         MOVE SPACE              TO  DC-OPTION-CODE
  5073         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5074
  5075         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5076         MOVE WS-GS-MM             TO  WS-SS-MM
  5077         MOVE WS-GS-DD             TO  WS-SS-DD
  5078         MOVE WS-GS-YY             TO  WS-SS-YY
  5079         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5080     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5081        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5082         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5083                                    AMT-ATTRB      (PINDX)
  5084                                    GL-ACCT-ATTRB  (PINDX)
  5085                                    GL-COMM-ATTRB  (PINDX)
  5086                                    VOID-SW-ATTRB  (PINDX)
  5087                                    GL-STATE-ATTRB (PINDX)
  5088                                    GL-CANC-ATTRB  (PINDX)
  5089                                    SDTE-ATTRB     (PINDX)
  5090
  5091     END-IF
  5092
  5093*    GO TO 6010-READ-NEXT.
  5094     GO TO 6200-EXIT.
  5095
  5096 6100-END-OF-FILE.
  5097     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5098
  5099     IF PINDX  IS LESS THAN  12
  5100         SET PINDX  UP  BY  1
  5101         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5102         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 103
* EL633.cbl
  5103         SET PINDX  UP  BY  1
  5104         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5105         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5106         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5107     ELSE
  5108         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5109         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5110         SET PINDX  UP  BY  1
  5111         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5112         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5113
  5114 6200-EXIT.
  5115     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 104
* EL633.cbl
  5117 7000-PYAJ-FILE-NOTOPEN.
  5118     MOVE -1                     TO  MAINTL.
  5119     MOVE ER-2232                TO  EMI-ERROR.
  5120
  5121     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5122
  5123     GO TO 8200-SEND-DATAONLY.
  5124
  5125 7100-COMP-FILE-NOTOPEN.
  5126     MOVE -1                     TO  MAINTL.
  5127     MOVE ER-2233                TO  EMI-ERROR.
  5128
  5129     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5130
  5131     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 105
* EL633.cbl
  5133*
  5134*7100-COFA-FILE-NOTOPEN.
  5135*    MOVE -1                     TO PFENTERL.
  5136*    MOVE ER-2959                TO EMI-ERROR.
  5137*    PERFORM 9900-ERROR-FORMAT THRU
  5138*            9900-EXIT.
  5139*    GO TO 8200-SEND-DATAONLY.
  5140*
  5141 8100-SEND-INITIAL-MAP.
  5142     MOVE WS-CURRENT-DT          TO  DATEO.
  5143     MOVE EIBTIME                TO  TIME-IN.
  5144     MOVE TIME-OUT               TO  TIMEO.
  5145     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5146     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5147     MOVE -1                     TO  MAINTL.
  5148     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5149     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5150
  5151     IF EIBTRNID = TRANS-ID
  5152       OR EL640-TRANS-ID
  5153       OR EL642-TRANS-ID
  5154       OR EL652-TRANS-ID
  5155       OR EL6331-TRANS-ID
  5156         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5157             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5158             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5159             MOVE PI-SAV-GROUPING  TO  GROUPO
  5160             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5161             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5162             MOVE AL-UANON         TO  MAINTA
  5163                                       CARRIERA
  5164                                       GROUPA
  5165                                       FINRESPA
  5166                                       ACCTA
  5167         ELSE
  5168             NEXT SENTENCE.
  5169
  5170
  5171* EXEC CICS SEND
  5172*        MAP     (MAP-NAME)
  5173*        MAPSET  (MAPSET-NAME)
  5174*        FROM    (EL633AO)
  5175*        ERASE
  5176*        CURSOR
  5177*        END-EXEC.
  5178     MOVE LENGTH OF
  5179      EL633AO
  5180       TO DFHEIV12
  5181     MOVE -1
  5182       TO DFHEIV11
  5183*    MOVE '8$     CT  E    H L F ,   #00004715' TO DFHEIV0
  5184     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5185     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5186     MOVE X'2020233030303034373135' TO DFHEIV0(25:11)
  5187     CALL 'kxdfhei1' USING DFHEIV0,
  5188           MAP-NAME,
  5189           EL633AO,
  5190           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 106
* EL633.cbl
  5191           MAPSET-NAME,
  5192           DFHEIV99,
  5193           DFHEIV99,
  5194           DFHEIV99,
  5195           DFHEIV11,
  5196           DFHEIV99,
  5197           DFHEIV99,
  5198           DFHEIV99
  5199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5200
  5201
  5202     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 107
* EL633.cbl
  5204 8200-SEND-DATAONLY.
  5205     MOVE WS-CURRENT-DT          TO  DATEO.
  5206     MOVE EIBTIME                TO  TIME-IN.
  5207     MOVE TIME-OUT               TO  TIMEO.
  5208     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5209     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5210     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5211     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5212
  5213
  5214* EXEC CICS SEND
  5215*        MAP     (MAP-NAME)
  5216*        MAPSET  (MAPSET-NAME)
  5217*        FROM    (EL633AO)
  5218*        DATAONLY
  5219*        CURSOR
  5220*    END-EXEC.
  5221     MOVE LENGTH OF
  5222      EL633AO
  5223       TO DFHEIV12
  5224     MOVE -1
  5225       TO DFHEIV11
  5226*    MOVE '8$D    CT       H L F ,   #00004734' TO DFHEIV0
  5227     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5228     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5229     MOVE X'2020233030303034373334' TO DFHEIV0(25:11)
  5230     CALL 'kxdfhei1' USING DFHEIV0,
  5231           MAP-NAME,
  5232           EL633AO,
  5233           DFHEIV12,
  5234           MAPSET-NAME,
  5235           DFHEIV99,
  5236           DFHEIV99,
  5237           DFHEIV99,
  5238           DFHEIV11,
  5239           DFHEIV99,
  5240           DFHEIV99,
  5241           DFHEIV99
  5242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5243
  5244
  5245     GO TO 9100-RETURN-TRAN.
  5246
  5247 8300-SEND-TEXT.
  5248
  5249* EXEC CICS SEND TEXT
  5250*        FROM    (LOGOFF-TEXT)
  5251*        LENGTH  (LOGOFF-LENGTH)
  5252*        ERASE
  5253*        FREEKB
  5254*    END-EXEC.
  5255*    MOVE '8&      T  E F  H   F -   #00004745' TO DFHEIV0
  5256     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5257     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5258     MOVE X'2020233030303034373435' TO DFHEIV0(25:11)
  5259     CALL 'kxdfhei1' USING DFHEIV0,
  5260           LOGOFF-TEXT,
  5261           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 108
* EL633.cbl
  5262           DFHEIV99,
  5263           DFHEIV99,
  5264           DFHEIV99,
  5265           DFHEIV99,
  5266           DFHEIV99,
  5267           DFHEIV99,
  5268           DFHEIV99,
  5269           DFHEIV99,
  5270           DFHEIV99,
  5271           DFHEIV99
  5272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5273
  5274
  5275
  5276* EXEC CICS RETURN
  5277*    END-EXEC.
  5278*    MOVE '.(                    ''   #00004752' TO DFHEIV0
  5279     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5280     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5281     MOVE X'2020233030303034373532' TO DFHEIV0(25:11)
  5282     CALL 'kxdfhei1' USING DFHEIV0,
  5283           DFHEIV99,
  5284           DFHEIV99,
  5285           DFHEIV99,
  5286           DFHEIV99,
  5287           DFHEIV99,
  5288           DFHEIV99
  5289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5290
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 109
* EL633.cbl
  5292 8400-LOG-JOURNAL-RECORD.
  5293*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5294*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5295
  5296*    EXEC CICS JOURNAL
  5297*        JFILEID  (PI-JOURNAL-FILE-ID)
  5298*        JTYPEID  ('EL')
  5299*        FROM     (JOURNAL-RECORD)
  5300*        LENGTH   (223)
  5301*        END-EXEC.
  5302
  5303 8500-DATE-CONVERT.
  5304
  5305* EXEC CICS LINK
  5306*        PROGRAM   (LINK-CLDATCV)
  5307*        COMMAREA  (DATE-CONVERSION-DATA)
  5308*        LENGTH    (DC-COMM-LENGTH)
  5309*    END-EXEC.
  5310*    MOVE '."C                   (   #00004767' TO DFHEIV0
  5311     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5313     MOVE X'2020233030303034373637' TO DFHEIV0(25:11)
  5314     CALL 'kxdfhei1' USING DFHEIV0,
  5315           LINK-CLDATCV,
  5316           DATE-CONVERSION-DATA,
  5317           DC-COMM-LENGTH,
  5318           DFHEIV99,
  5319           DFHEIV99,
  5320           DFHEIV99,
  5321           DFHEIV99
  5322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5323
  5324
  5325 8500-EXIT.
  5326     EXIT.
  5327
  5328 8600-DEEDIT.
  5329
  5330* EXEC CICS BIF DEEDIT
  5331*        FIELD   (DEEDIT-FIELD)
  5332*        LENGTH  (11)
  5333*    END-EXEC.
  5334     MOVE 11
  5335       TO DFHEIV11
  5336*    MOVE '@"L                   #   #00004777' TO DFHEIV0
  5337     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5338     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5339     MOVE X'2020233030303034373737' TO DFHEIV0(25:11)
  5340     CALL 'kxdfhei1' USING DFHEIV0,
  5341           DEEDIT-FIELD,
  5342           DFHEIV11
  5343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5344
  5345
  5346 8600-EXIT.
  5347     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 110
* EL633.cbl
  5349 8800-UNAUTHORIZED-ACCESS.
  5350     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5351
  5352     GO TO 8300-SEND-TEXT.
  5353
  5354 8810-PF23.
  5355     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5356     MOVE XCTL-005               TO  PGM-NAME.
  5357
  5358     GO TO 9300-XCTL.
  5359
  5360 9100-RETURN-TRAN.
  5361     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5362     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5363
  5364
  5365* EXEC CICS RETURN
  5366*        TRANSID   (TRANS-ID)
  5367*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5368*        LENGTH    (PI-COMM-LENGTH)
  5369*    END-EXEC.
  5370*    MOVE '.(CT                  ''   #00004800' TO DFHEIV0
  5371     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5372     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5373     MOVE X'2020233030303034383030' TO DFHEIV0(25:11)
  5374     CALL 'kxdfhei1' USING DFHEIV0,
  5375           TRANS-ID,
  5376           PROGRAM-INTERFACE-BLOCK,
  5377           PI-COMM-LENGTH,
  5378           DFHEIV99,
  5379           DFHEIV99,
  5380           DFHEIV99
  5381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5382
  5383
  5384 9200-RETURN-MAIN-MENU.
  5385     MOVE XCTL-626               TO  PGM-NAME.
  5386
  5387     GO TO 9300-XCTL.
  5388
  5389 9300-XCTL.
  5390
  5391* EXEC CICS XCTL
  5392*        PROGRAM   (PGM-NAME)
  5393*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5394*        LENGTH    (PI-COMM-LENGTH)
  5395*    END-EXEC.
  5396*    MOVE '.$C                   %   #00004812' TO DFHEIV0
  5397     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5398     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5399     MOVE X'2020233030303034383132' TO DFHEIV0(25:11)
  5400     CALL 'kxdfhei1' USING DFHEIV0,
  5401           PGM-NAME,
  5402           PROGRAM-INTERFACE-BLOCK,
  5403           PI-COMM-LENGTH,
  5404           DFHEIV99
  5405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5406
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 111
* EL633.cbl
  5407
  5408 9400-CLEAR.
  5409     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5410
  5411     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5412     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5413                                     PI-SAV-COMP-CONTROL.
  5414
  5415     GO TO 9300-XCTL.
  5416
  5417 9500-PF12.
  5418     MOVE XCTL-010               TO  PGM-NAME.
  5419
  5420     GO TO 9300-XCTL.
  5421
  5422 9600-PGMID-ERROR.
  5423
  5424* EXEC CICS HANDLE CONDITION
  5425*        PGMIDERR  (8300-SEND-TEXT)
  5426*    END-EXEC.
  5427*    MOVE '"$L                   ! + #00004833' TO DFHEIV0
  5428     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5430     MOVE X'2B20233030303034383333' TO DFHEIV0(25:11)
  5431     CALL 'kxdfhei1' USING DFHEIV0
  5432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5433
  5434
  5435     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5436     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5437     MOVE XCTL-005               TO  PGM-NAME.
  5438     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5439     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5440
  5441     GO TO 9300-XCTL.
  5442
  5443 9900-ERROR-FORMAT.
  5444     IF NOT EMI-ERRORS-COMPLETE
  5445         MOVE LINK-001           TO  PGM-NAME
  5446
  5447* EXEC CICS LINK
  5448*            PROGRAM   (PGM-NAME)
  5449*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5450*            LENGTH    (EMI-COMM-LENGTH)
  5451*        END-EXEC.
  5452*    MOVE '."C                   (   #00004848' TO DFHEIV0
  5453     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5455     MOVE X'2020233030303034383438' TO DFHEIV0(25:11)
  5456     CALL 'kxdfhei1' USING DFHEIV0,
  5457           PGM-NAME,
  5458           ERROR-MESSAGE-INTERFACE-BLOCK,
  5459           EMI-COMM-LENGTH,
  5460           DFHEIV99,
  5461           DFHEIV99,
  5462           DFHEIV99,
  5463           DFHEIV99
  5464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 112
* EL633.cbl
  5465
  5466
  5467 9900-EXIT.
  5468     EXIT.
  5469
  5470 9990-ABEND.
  5471     MOVE LINK-004               TO  PGM-NAME.
  5472     MOVE DFHEIBLK               TO  EMI-LINE1.
  5473
  5474
  5475* EXEC CICS LINK
  5476*        PROGRAM   (PGM-NAME)
  5477*        COMMAREA  (EMI-LINE1)
  5478*        LENGTH    (72)
  5479*    END-EXEC.
  5480     MOVE 72
  5481       TO DFHEIV11
  5482*    MOVE '."C                   (   #00004861' TO DFHEIV0
  5483     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5485     MOVE X'2020233030303034383631' TO DFHEIV0(25:11)
  5486     CALL 'kxdfhei1' USING DFHEIV0,
  5487           PGM-NAME,
  5488           EMI-LINE1,
  5489           DFHEIV11,
  5490           DFHEIV99,
  5491           DFHEIV99,
  5492           DFHEIV99,
  5493           DFHEIV99
  5494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5495
  5496
  5497     MOVE -1                     TO  PFENTERL.
  5498
  5499     GO TO 8200-SEND-DATAONLY.
  5500
  5501 9995-SECURITY-VIOLATION.
  5502*                            COPY ELCSCTP.
  5503******************************************************************
  5504*                                                                *
  5505*                            ELCSCTP                             *
  5506*                            VMOD=2.001                          *
  5507*                                                                *
  5508*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5509******************************************************************
  5510
  5511
  5512     MOVE EIBDATE          TO SM-JUL-DATE.
  5513     MOVE EIBTRMID         TO SM-TERMID.
  5514     MOVE THIS-PGM         TO SM-PGM.
  5515     MOVE EIBTIME          TO TIME-IN.
  5516     MOVE TIME-OUT         TO SM-TIME.
  5517     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5518
  5519
  5520* EXEC CICS LINK
  5521*         PROGRAM  ('EL003')
  5522*         COMMAREA (SECURITY-MESSAGE)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 113
* EL633.cbl
  5523*         LENGTH   (80)
  5524*    END-EXEC.
  5525     MOVE 'EL003' TO DFHEIV1
  5526     MOVE 80
  5527       TO DFHEIV11
  5528*    MOVE '."C                   (   #00004889' TO DFHEIV0
  5529     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5531     MOVE X'2020233030303034383839' TO DFHEIV0(25:11)
  5532     CALL 'kxdfhei1' USING DFHEIV0,
  5533           DFHEIV1,
  5534           SECURITY-MESSAGE,
  5535           DFHEIV11,
  5536           DFHEIV99,
  5537           DFHEIV99,
  5538           DFHEIV99,
  5539           DFHEIV99
  5540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5541
  5542
  5543******************************************************************
  5544
  5545
  5546 9995-EXIT.
  5547     EXIT.
  5548
  5549
  5550 9999-DFHBACK SECTION.
  5551     MOVE '9%                    "   ' TO DFHEIV0
  5552     MOVE 'EL633' TO DFHEIV1
  5553     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5554     GOBACK.
  5555 9999-DFHEXIT.
  5556     IF DFHEIGDJ EQUAL 0001
  5557         NEXT SENTENCE
  5558     ELSE IF DFHEIGDJ EQUAL 2
  5559         GO TO 9600-PGMID-ERROR,
  5560               9990-ABEND
  5561         DEPENDING ON DFHEIGDI
  5562     ELSE IF DFHEIGDJ EQUAL 3
  5563         GO TO 0410-NO-COMP-MSTR,
  5564               7100-COMP-FILE-NOTOPEN
  5565         DEPENDING ON DFHEIGDI
  5566     ELSE IF DFHEIGDJ EQUAL 4
  5567         GO TO 0890-EXIT
  5568         DEPENDING ON DFHEIGDI
  5569     ELSE IF DFHEIGDJ EQUAL 5
  5570         GO TO 2110-ADD-RECORD
  5571         DEPENDING ON DFHEIGDI
  5572     ELSE IF DFHEIGDJ EQUAL 6
  5573         GO TO 2120-DELETE-CONT
  5574         DEPENDING ON DFHEIGDI
  5575     ELSE IF DFHEIGDJ EQUAL 7
  5576         GO TO 2190-DUP-RECORD
  5577         DEPENDING ON DFHEIGDI
  5578     ELSE IF DFHEIGDJ EQUAL 8
  5579         GO TO 5010-NOT-OPEN,
  5580               5020-NO-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:00 Page 114
* EL633.cbl
  5581               5020-NO-RECORDS
  5582         DEPENDING ON DFHEIGDI
  5583     ELSE IF DFHEIGDJ EQUAL 9
  5584         GO TO 5110-END-OF-FILE,
  5585               5110-END-OF-FILE
  5586         DEPENDING ON DFHEIGDI
  5587     ELSE IF DFHEIGDJ EQUAL 10
  5588         GO TO 6100-END-OF-FILE,
  5589               6100-END-OF-FILE
  5590         DEPENDING ON DFHEIGDI
  5591     ELSE IF DFHEIGDJ EQUAL 11
  5592         GO TO 8300-SEND-TEXT
  5593         DEPENDING ON DFHEIGDI.
  5594     MOVE '9%                    "   ' TO DFHEIV0
  5595     MOVE 'EL633' TO DFHEIV1
  5596     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5597     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6176     Code:       16886
