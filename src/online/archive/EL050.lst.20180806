* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57******************************************************************
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page   3
* EL050.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64
    65 77  FILLER   PIC X(32) VALUE '********************************'.
    66 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    67 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    68
    69 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    70 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    71                                   USAGE POINTER.
    72 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    78                                   USAGE IS POINTER.
    79 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87*    COPY ELC50WS.
    88*****************************************************************
    89*                                                               *
    90*                            ELC50WS.                           *
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    92*                            VMOD=2.061.                        *
    93*                                                               *
    94*   THIS IS THE WORKING STORAGE FOR EL050                       *
    95*                                   EL517                       *
    96*****************************************************************
    97******************************************************************
    98*                   C H A N G E   L O G
    99*
   100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   101*-----------------------------------------------------------------
   102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   103* EFFECTIVE    NUMBER
   104*-----------------------------------------------------------------
   105* 123102                   PEMA  ADD DCC PROCESSING
   106* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   107* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   108* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   109* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   110* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   111* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   112* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   113* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   114* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   115* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   116* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   117* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   118* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   119* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page   4
* EL050.cbl
   120* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   121* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   122* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   123* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   124* 030309  CR2009021700001  PEMA  ADD ER-2883
   125* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   126* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   127* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   128* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   129* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   130* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   131* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   132* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   133* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   134* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   135* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   136* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   137* 061412  CR2011022800001  AJRA  NAPERSOFT
   138* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   139* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   140* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   141* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   142* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   143* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   144* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   145* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   146* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   147* 091114  IR2014091000001  TANA  ADD ERROR 2898
   148* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   149* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   150* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   151* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   152* 100617  CR2017062000003  PEMA  Inforce state comm cap
   153* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   154* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   155* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   156* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   157*-----------------------------------------------------------------
   158
   159 01  WORK-AREAS.
   160
   161*****************************************************************
   162*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   163*****************************************************************
   164
   165     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   166     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   167     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   168     12  WS-NAME-EDIT-WORK-AREA.
   169         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   170         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   171             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   172         16  WS-WORK-NAME.
   173             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   174             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   175             20  FILLER           PIC X(10)     VALUE SPACES.
   176         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   177             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page   5
* EL050.cbl
   178
   179*****************************************************************
   180*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   181*****************************************************************
   182
   183     12  WS-ERRESC-KEY.
   184         16 WS-ERRESC-SEARCH-KEY.
   185             20  WS-ERRESC-COMPANY-CD PIC  X.
   186             20  WS-ERRESC-CARRIER    PIC  X.
   187             20  WS-ERRESC-GROUP      PIC X(6).
   188             20  WS-ERRESC-STATE      PIC XX.
   189             20  WS-ERRESC-ACCOUNT    PIC X(10).
   190         16 WS-ERRESC-RESIDUAL-KEY.
   191             20  WS-ERRESC-AGENT      PIC X(10).
   192             20  WS-ERRESC-RES-STATE  PIC XX.
   193             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   194*                                          YYYYMMDD
   195     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   196     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   197
   198*RESIDENT STATE TAX MASTER(ERRESS)
   199*
   200     12  WS-ERRESS-KEY.
   201         16  WS-ERRESS-COMPANY-CD      PIC  X.
   202         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   203         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   204         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   205*                                          YYYYMMDD
   206
   207     12  WS-CONTRACT-DATE              PIC 9(8).
   208*                                          YYYYMMDD
   209     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   210     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   211         16 WS-YEAR-YY                 PIC   9999.
   212         16 FILLER                     PIC 9(4).
   213*                                          YYYYMMDD
   214     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   215     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   216     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   217     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   218
   219     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   220         88  DPRB-1ST-TIME                      VALUE ' '.
   221
   222*****************************************************************
   223*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   224*****************************************************************
   225
   226     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   227     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   228     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   229     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   230     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   231     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   232     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   233     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   234     12  ws-st-agent-sig-edit    pic x          value spaces.
   235     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page   6
* EL050.cbl
   236     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   239         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   240         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   241     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   242         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   243         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   244     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   245
   246     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   247     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   248
   249     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   250     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   255     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   260     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   261     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   262     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   263     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   264     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   280     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   281     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   282     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   283     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   284     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   285     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   286     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   287     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   288     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   289     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   291     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   292     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   293     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page   7
* EL050.cbl
   294     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   295     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   296     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   297     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   298     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   299     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   300     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   301     12  WS-2671-SW               PIC X         VALUE SPACE.
   302     12  WS-2672-SW               PIC X         VALUE SPACE.
   303     12  ws-9813-sw               pic x         value spaces.
   304     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   305         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   306     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   307         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   308     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   309
   310     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   311         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   312         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   313         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   314         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   315
   316     12  WS-CREDIT-EDIT-CONTROLS.
   317         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   318         16  WS-MIN-AGE           PIC 99                VALUE  0.
   319         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   320         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   321         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   322         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   323
   324     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   325     12  WS-AGE-FIELDS.
   326         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   327         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   328         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   329         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   330
   331     12  WS-SAVE-ALLOWABLE-BENEFIT.
   332         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   333         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   334         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   335         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   336         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   337         16  FILLER                      PIC XX.
   338
   339     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   340     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   341     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   342     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   343     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   345     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   346     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   347     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   348     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   349
   350     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   351     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page   8
* EL050.cbl
   352     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   353     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   354     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   355     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   356     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   357     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   358         88  WS-REDUCING              VALUE 'R'.
   359         88  WS-LEVEL                 VALUE 'L' 'P'.
   360     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   361
   362     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   363     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   364     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   365     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   366     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   367     12  ws-ah-max-bens           pic 99        value zeros.
   368     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   369     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   370     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   371     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   372
   373     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   374     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   375     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   376     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   377     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   378     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   379     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   380     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   381     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   382     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   383     12  WS-ACCT-SIG-SW.
   384         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   385         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   386     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   387     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   388     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   389     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   390     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   391     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   392     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   393     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   394     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   395     12  WS-INITIALS.
   396         16  WS-INIT-1            PIC X         VALUE SPACES.
   397         16  WS-INIT-2            PIC X         VALUE SPACES.
   398
   399     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   400     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   401     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   402     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   403     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   404*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   405     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   406     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   407     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   408     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   409     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page   9
* EL050.cbl
   410     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   411     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   412     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   413     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   415     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   416     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   417     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   418     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   419     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   420     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   421     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   422     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   423     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   424     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   425     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   426     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   427******** FLA
   428     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   429     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   430     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   431     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   432     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   433********
   434     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   435     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   436     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   437     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   438     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   439     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   440     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   441     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   442     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   443     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   444
   445     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   446         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   447                                         '0' THRU '9'.
   448
   449     12  NUMBER-OF-MONTHS.
   450         16  SK-MO OCCURS 12 TIMES PIC X.
   451
   452     12  WS-WORK-DATE.
   453         16  WS-YEAR            PIC 99    VALUE 00.
   454         16  WS-MONTH           PIC 99    VALUE 00.
   455         16  WS-DAY             PIC 99    VALUE 00.
   456
   457     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   458     12  WS-WORK-CRIT-DEV       REDEFINES
   459         WS-WORK-LF-CRIT-PER    PIC X(03).
   460
   461     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   462     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   463
   464     12  WS-WORK-DATE-FROM.
   465         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   466         16  FILLER             PIC X  VALUE SPACE.
   467         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  10
* EL050.cbl
   468         16  FILLER             PIC X         VALUE SPACE.
   469         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   470
   471     12  WS-WORK-DATE-THRU.
   472         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   473         16  FILLER             PIC X         VALUE SPACE.
   474         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   475         16  FILLER             PIC X         VALUE SPACE.
   476         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   477
   478     12  WS-LF-INPUT-CD.
   479         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   480         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   481
   482     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   483     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   484         16  WS-AH-INPUT-CD-1   PIC X.
   485         16  WS-AH-INPUT-CD-2-3 PIC XX.
   486
   487     12  WS-SWITCHES.
   488         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   489         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   490             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   491         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   492             88  BANK-ACCT-FOUND          VALUE 'Y'.
   493         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   494             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   495         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   496             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   497         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   498             88  COMP-MASTER-FOUND        VALUE 'Y'.
   499         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   500             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   501         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   502             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   503         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   504             88  STAT-MASTER-FOUND        VALUE 'Y'.
   505         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   506             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   507         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   508             88  ELCRTT-FOUND             VALUE 'Y'.
   509         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   510             88  ELCRTT-UPDATE            VALUE 'Y'.
   511         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   512             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   513         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   514             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   515         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   516             88  FORM-MASTER-FOUND        VALUE 'Y'.
   517         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   518             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   519         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   520             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   521         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   522             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   523         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   524             88  NO-BENEFIT-FOUND         VALUE 'N'.
   525         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  11
* EL050.cbl
   526             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   527         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   528             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   529         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   530             88  AH-BENEFIT-FOUND         VALUE ' '.
   531             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   532         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   533             88  LF-BENEFIT-FOUND         VALUE ' '.
   534             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   535         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   536             88  NO-STATE-RECORD          VALUE '1'.
   537         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   538             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   539         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   540             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   541         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   542             88  CERT-WAS-FOUND           VALUE ' '.
   543             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   544         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   545             88  BROWSE-STARTED           VALUE 'Y'.
   546         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   547             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   548         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   549             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   550         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   551             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   552         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   553             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   554         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   555             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   556         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   557             88  APP-CERT-USED            VALUE 'Y' 'A'.
   558         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   559             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   560             88  FIRST-TIME-THROUGH       VALUE '1'.
   561             88  CTBL-NOT-FOUND           VALUE '2'.
   562
   563         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   564             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   565
   566         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   567             88  DLO-ERROR-FOUND          VALUE 'Y'.
   568
   569********FLA
   570     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   571     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   572********
   573     12  RC-SW-1                  PIC X           VALUE '0'.
   574     12  RC-SW-2                  PIC X           VALUE '0'.
   575     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   576     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   577     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   578     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   579     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   580     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   581     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   582     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   583     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  12
* EL050.cbl
   584     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   585     12  LIT-SPACES               PIC X           VALUE SPACES.
   586     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   587     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   588     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   589     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   590     12  erpndm-unlock-sw         pic x           value spaces.
   591         88  need-to-unlock-erpndm  value 'Y'.
   592     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   593     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   594     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   595         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   596         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   597     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   598         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   599
   600 01  WS-EXTRA-PERIODS-BY-STATE.
   601     12  WS-INT-PERIODS          PIC 9.
   602     12  WS-EXTRA-PMTS           PIC 9.
   603 01  ws-net-only-state           pic x value 'N'.
   604 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   605     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   606     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   607 01  WS-CRI-SSN-WORK-AREA.
   608     05  WS-CRI-SOC-SEC-NO.
   609         10  WS-SS-REPT-CD       PIC X(5).
   610         10  WS-SS-LAST-NAME     PIC X(5).
   611         10  WS-SS-INITIAL       PIC X.
   612
   613     05  WS-CRI-REPORT-CODE.
   614         10  FILLER              PIC X(5).
   615         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   616
   617     05  WS-CRI-LAST-NAME.
   618         10  WS-CRI-NAME-MOVE    PIC X(5).
   619         10  FILLER              PIC X(10).
   620
   621 01  ws-state-commission-caps.
   622     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   623     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   624     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   625     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   626     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   627     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   628     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   629     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   630     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   631     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   632     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   633     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   634     05  ws-st-cap-limit-to      pic x.
   635     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   636     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   637     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   638     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   639     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   640     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   641     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  13
* EL050.cbl
   642     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   643     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   644     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   645     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   646     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   647 01  WS-NUM-TABLE                PIC X(26)  VALUE
   648     '12345678012345070923456789'.
   649 01  FILLER REDEFINES WS-NUM-TABLE.
   650     05  WS-NUM OCCURS 26        PIC 9.
   651 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   652 01  V1                          PIC S999 COMP-3.
   653 01  V2                          PIC S999 COMP-3.
   654 01  V3                          PIC S999 COMP-3.
   655 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   656 01  FILLER REDEFINES WS-WORK-VIN.
   657     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   658 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   659 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   660 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   661 01  WS-HEX-WORK.
   662     05  FILLER                  PIC X  VALUE LOW-VALUES.
   663     05  WS-HEX-BYTE             PIC X.
   664 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   665 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   666 01  WS-WORK-HIN-ROW-B.
   667     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   668
   669 01  ws-benefit-cd-chg-sw      pic x value spaces.
   670     88  benefit-code-chg           value 'Y'.
   671 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   672 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   673     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   674 01  WS-ROW-D-TABLE.
   675     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   676
   677 01  WS-HIN-TABLE-B.
   678     05  F                       PIC XX VALUE 'A2'.
   679     05  F                       PIC XX VALUE 'B3'.
   680     05  F                       PIC XX VALUE 'C4'.
   681     05  F                       PIC XX VALUE 'D5'.
   682     05  F                       PIC XX VALUE 'E6'.
   683     05  F                       PIC XX VALUE 'F7'.
   684     05  F                       PIC XX VALUE 'G8'.
   685     05  F                       PIC XX VALUE 'H9'.
   686     05  F                       PIC XX VALUE 'I1'.
   687     05  F                       PIC XX VALUE 'J2'.
   688     05  F                       PIC XX VALUE 'K3'.
   689     05  F                       PIC XX VALUE 'L4'.
   690     05  F                       PIC XX VALUE 'M5'.
   691     05  F                       PIC XX VALUE 'N6'.
   692     05  F                       PIC XX VALUE 'O0'.
   693     05  F                       PIC XX VALUE 'P7'.
   694     05  F                       PIC XX VALUE 'Q0'.
   695     05  F                       PIC XX VALUE 'R8'.
   696     05  F                       PIC XX VALUE 'S9'.
   697     05  F                       PIC XX VALUE 'T2'.
   698     05  F                       PIC XX VALUE 'U3'.
   699     05  F                       PIC XX VALUE 'V4'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  14
* EL050.cbl
   700     05  F                       PIC XX VALUE 'W5'.
   701     05  F                       PIC XX VALUE 'X6'.
   702     05  F                       PIC XX VALUE 'Y7'.
   703     05  F                       PIC XX VALUE 'Z8'.
   704 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   705     05  WS-VAL-IN               PIC X.
   706     05  WS-VAL-OUT              PIC 9.
   707 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   708 01  ws-greg-eff-date            pic x(10) value ' '.
   709 01  WS-COMPARE-BINARY-DATES.
   710     05  WS-971231                PIC XX VALUE X'92FF'.
   711     05  WS-931231                PIC XX VALUE X'8CFF'.
   712     05  WS-791231                PIC XX VALUE X'77FF'.
   713     05  WS-771001                PIC XX VALUE X'74A1'.
   714     05  WS-820301                PIC XX VALUE X'7B41'.
   715     05  WS-831031                PIC XX VALUE X'7DBF'.
   716     05  WS-831231                PIC XX VALUE X'7DFF'.
   717     05  WS-810831                PIC XX VALUE X'7A7F'.
   718     05  WS-830901                PIC XX VALUE X'7D81'.
   719
   720 01  FILE-ACCESS-IDS.
   721     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   722     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   723     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   724     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   725     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   726     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   727     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   728     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   729     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   730     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   731     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   732     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   733     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   734     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   735     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   736     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   737     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   738 01  DD-IU-SW                    PIC X   VALUE ' '.
   739     88  DD-IU-PRESENT                 VALUE 'Y'.
   740
   741 01  ACCESS-KEYS.
   742     12  ELMSTR-KEY.
   743         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   744         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   745     12  W-CLAIM-KEY.
   746         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   747         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   748
   749     12  ELCNTL-KEY.
   750         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   751         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   752         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   753         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   754
   755     12  ELCERT-KEY.
   756         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   757         16  CERT-CARRIER         PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  15
* EL050.cbl
   758         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   759         16  CERT-STATE           PIC XX      VALUE SPACES.
   760         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   761         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   762         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   763
   764     12  ELCERT2-KEY.
   765         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   766         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   767
   768     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   769
   770     12  ELCERT-SAVE.
   771         16  FILLER                      PIC XX    VALUE SPACES.
   772
   773         16  WCS-CONTROL-PRIMARY.
   774             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   775             20  WCS-CARRIER             PIC X     VALUE SPACE.
   776             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   777             20  WCS-STATE               PIC XX    VALUE SPACES.
   778             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   779             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   780             20  WCS-CERT-NO.
   781                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   782                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   783
   784         16  CS-CONTROL-BY-NAME.
   785             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   786             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   787             20  CS-INSURED-INITIALS.
   788                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   789                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   790
   791         16  CS-CONTROL-BY-SSN.
   792             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   793             20  CS-SOC-SEC-NO.
   794                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   795                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   796                 24  CS-SSN-LN3.
   797                     28 CS-INSURED-INITIALS-A2   PIC XX
   798                                     VALUE SPACES.
   799                     28 CS-PART-LAST-NAME-A2     PIC X
   800                                     VALUE SPACE.
   801
   802         16  CS-CONTROL-BY-CERT-NO.
   803             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   804             20  CS-CERT-NO-A4           PIC X(11)
   805                                     VALUE SPACES.
   806
   807         16  CS-CONTROL-BY-MEMB.
   808             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   809             20  CS-MEMBER-NO.
   810                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   811                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   812                 24  CS-MEMB-LN4.
   813                     28 CS-INSURED-INITIALS-A5   PIC XX
   814                                      VALUE SPACES.
   815                     28 CS-PART-LAST-NAME-A5     PIC XX
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  16
* EL050.cbl
   816                                      VALUE SPACES.
   817
   818         16  FILLER              PIC X(360) VALUE SPACES.
   819
   820     12  ERACCT-KEY.
   821         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   822         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   823         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   824         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   825         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   826         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   827
   828     12  ERCOMP-KEY.
   829         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   830         16  COMP-CARRIER         PIC X     VALUE SPACES.
   831         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   832         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   833         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   834         16  COMP-TYPE            PIC X     VALUE SPACES.
   835
   836     12  ERLOFC-KEY.
   837         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   838         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   839         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   840         16  LOFC-STATE           PIC XX    VALUE SPACES.
   841         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   842         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   843
   844     12  WS-ELCRTT-KEY.
   845         16  WS-ELCRTT-PRIMARY       PIC X(33).
   846         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   847
   848     12  ERBXRF-KEY.
   849         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   850         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   851         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   852         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   853
   854     12  ERAGTC-KEY.
   855         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   856         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   857         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   858         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   859         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   860         16  AGTC-TYPE            PIC X     VALUE SPACES.
   861
   862     12  ERPLAN-KEY.
   863         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   864         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   865         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   866         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   867         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   868         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   869         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   870         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   871
   872     12  ERFORM-KEY.
   873         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  17
* EL050.cbl
   874         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   875         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   876         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   877
   878     12  ERREIN-KEY.
   879         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   880         16  REIN-TYPE            PIC X     VALUE SPACES.
   881         16  REIN-TABLE-CO.
   882             20  REIN-CODE-1      PIC X     VALUE SPACE.
   883             20  REIN-CODE-2      PIC X     VALUE SPACE.
   884             20  REIN-CODE-3      PIC X     VALUE SPACE.
   885         16  FILLER               PIC X(3)  VALUE SPACES.
   886
   887     12  ERCTBL-KEY.
   888         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   889         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   890         16  CTBL-CNTRL-2.
   891             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   892             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   893
   894     12  ELCRTO-KEY.
   895         16  ELCRTO-COMPANY-CD       PIC X.
   896         16  ELCRTO-CARRIER          PIC X.
   897         16  ELCRTO-GROUPING         PIC X(6).
   898         16  ELCRTO-STATE            PIC XX.
   899         16  ELCRTO-ACCOUNT          PIC X(10).
   900         16  ELCRTO-CERT-EFF-DT      PIC XX.
   901         16  ELCRTO-CERT-NO.
   902             20  ELCRTO-CERT-PRIME   PIC X(10).
   903             20  ELCRTO-CERT-SFX     PIC X.
   904         16  ELCRTO-RECORD-TYPE      PIC X.
   905         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   906
   907
   908     12  WS-ACCESS.
   909         16  FILLER               PIC XX    VALUE SPACES.
   910         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   911
   912     12  WS-CARR-ACCESS.
   913         16  FILLER               PIC X(3)  VALUE SPACES.
   914         16  WS-CARR              PIC X     VALUE SPACE.
   915*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   916*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   917     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   918         88  WS-DMD-LF-RATING   VALUE 'Y'.
   919         88  WS-DMD-AH-RATING   VALUE 'Y'.
   920         88  WS-DMD-NO-RATING   VALUE 'N'.
   921
   922     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   923         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   924                                         'NJ' 'NL'
   925                                         'PJ' 'PL'
   926                                         'SJ' 'SL'.
   927     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   928         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   929                                         'NI' 'NJ' 'NL' 'NU'
   930                                         'PJ' 'PL' 'PI' 'PU'
   931                                         'SI' 'SJ' 'SL' 'SU'
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  18
* EL050.cbl
   932                                         'MX' 'MY' 'MZ'.
   933 01  ERPDEF-KEY-SAVE             PIC X(18).
   934 01  ERPDEF-KEY.
   935     12  ERPDEF-COMPANY-CD       PIC X.
   936     12  ERPDEF-STATE            PIC XX.
   937     12  ERPDEF-PROD-CD          PIC XXX.
   938     12  F                       PIC X(7).
   939     12  ERPDEF-BEN-TYPE         PIC X.
   940     12  ERPDEF-BEN-CODE         PIC XX.
   941     12  ERPDEF-EXP-DT           PIC XX.
   942
   943 01  ELSTAT-KEY-SAVE             PIC X(20).
   944 01  ELSTAT-KEY.
   945     12  ELSTAT-COMPANY-ID       PIC XXX.
   946     12  ELSTAT-CARRIER          PIC X.
   947     12  ELSTAT-GROUP            PIC X(6).
   948     12  ELSTAT-STATE            PIC XX.
   949     12  ELSTAT-EXP-DT           PIC 9(8).
   950 01  WS-ERROR-VALUES.
   951     12  ER-1570                     PIC S9(4)   VALUE +1570.
   952     12  ER-1571                     PIC S9(4)   VALUE +1571.
   953     12  er-1572                     pic s9(4)   value +1572.
   954     12  er-1573                     pic s9(4)   value +1573.
   955     12  er-1574                     pic s9(4)   value +1574.
   956     12  ER-1575                     PIC S9(4)   VALUE +1575.
   957     12  er-1576                     pic s9(4)   value +1576.
   958     12  er-1583                     pic s9(4)   value +1583.
   959     12  er-1743                     pic s9(4)   value +1743.
   960     12  er-1744                     pic s9(4)   value +1744.
   961     12  er-1745                     pic s9(4)   value +1745.
   962     12  er-1746                     pic s9(4)   value +1746.
   963     12  er-1747                     pic s9(4)   value +1747.
   964     12  er-1748                     pic s9(4)   value +1748.
   965     12  er-1749                     pic s9(4)   value +1749.
   966     12  er-1750                     pic s9(4)   value +1750.
   967     12  er-1751                     pic s9(4)   value +1751.
   968     12  er-1752                     pic s9(4)   value +1752.
   969     12  er-1753                     pic s9(4)   value +1753.
   970     12  er-1754                     pic s9(4)   value +1754.
   971     12  er-1755                     pic s9(4)   value +1755.
   972     12  er-1756                     pic s9(4)   value +1756.
   973     12  er-1757                     pic s9(4)   value +1757.
   974     12  er-1758                     pic s9(4)   value +1758.
   975     12  er-1759                     pic s9(4)   value +1759.
   976     12  er-1760                     pic s9(4)   value +1760.
   977     12  ER-1891                     PIC S9(4)   VALUE +1891.
   978     12  ER-1892                     PIC S9(4)   VALUE +1892.
   979     12  ER-1893                     PIC S9(4)   VALUE +1893.
   980     12  ER-1894                     PIC S9(4)   VALUE +1894.
   981     12  ER-1895                     PIC S9(4)   VALUE +1895.
   982     12  ER-1896                     PIC S9(4)   VALUE +1896.
   983     12  ER-1897                     PIC S9(4)   VALUE +1897.
   984     12  ER-1898                     PIC S9(4)   VALUE +1898.
   985     12  ER-1899                     PIC S9(4)   VALUE +1899.
   986     12  ER-1900                     PIC S9(4)   VALUE +1900.
   987     12  ER-1901                     PIC S9(4)   VALUE +1901.
   988     12  ER-1902                     PIC S9(4)   VALUE +1902.
   989     12  ER-1903                     PIC S9(4)   VALUE +1903.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  19
* EL050.cbl
   990     12  ER-1904                     PIC S9(4)   VALUE +1904.
   991     12  ER-1905                     PIC S9(4)   VALUE +1905.
   992     12  ER-1906                     PIC S9(4)   VALUE +1906.
   993     12  ER-1907                     PIC S9(4)   VALUE +1907.
   994     12  ER-1909                     PIC S9(4)   VALUE +1909.
   995     12  ER-1910                     PIC S9(4)   VALUE +1910.
   996     12  ER-1911                     PIC S9(4)   VALUE +1911.
   997     12  ER-1912                     PIC S9(4)   VALUE +1912.
   998     12  ER-1913                     PIC S9(4)   VALUE +1913.
   999     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1000     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1001     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1002     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1003     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1004     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1005     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1006     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1007     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1008     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1009     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1010     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1011     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1012     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1013     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1014     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1015     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1016     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1017     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1018     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1019     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1020     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1021     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1022     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1023     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1024     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1025     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1026     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1027     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1028     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1029     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1030     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1031     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1032     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1033     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1034     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1035     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1036     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1037     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1038     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1039     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1040     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1041     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1042     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1043     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1044     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1045     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1046     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1047     12  ER-2624                     PIC S9(4)   VALUE +2624.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  20
* EL050.cbl
  1048     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1049     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1050     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1051     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1052     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1053     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1054     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1055     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1056     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1057     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1058     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1059     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1060     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1061     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1062     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1063     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1064     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1065     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1066     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1067     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1068     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1069     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1070     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1071     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1072     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1073     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1074     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1075     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1076     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1077     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1078     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1079     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1080     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1081     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1082     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1083     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1084     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1085     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1086     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1087     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1088     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1089     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1090     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1091     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1092     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1093     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1094     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1095     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1096     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1097     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1098     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1099     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1100     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1101     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1102     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1103     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1104     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1105     12  ER-2682                     PIC S9(4)   VALUE +2682.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  21
* EL050.cbl
  1106     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1107     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1108     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1109     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1110     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1111     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1112     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1113     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1114     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1115     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1116     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1117     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1118     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1119     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1120     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1121     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1122     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1123     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1124     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1125     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1126     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1127     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1128     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1129     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1130     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1131     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1132     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1133     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1134     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1135     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1136     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1137     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1138     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1139     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1140     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1141     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1142     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1143     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1144     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1145     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1146     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1147     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1148     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1149     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1150     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1151     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1152     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1153     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1154     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1155     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1156     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1157     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1158     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1159     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1160     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1161     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1162     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1163     12  ER-2750                     PIC S9(4)   VALUE +2750.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  22
* EL050.cbl
  1164     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1165     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1166     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1167     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1168     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1169     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1170     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1171     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1172     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1173     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1174     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1175     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1176     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1177     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1178     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1179     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1180     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1181     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1182     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1183     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1184     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1185     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1186     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1187     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1188     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1189     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1190     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1191     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1192     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1193     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1194     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1195     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1196     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1197     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1198     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1199     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1200     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1201     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1202     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1203     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1204     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1205     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1206     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1207     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1208     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1209     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1210     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1211     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1212     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1213     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1214     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1215     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1216     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1217     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1218     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1219     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1220     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1221     12  ER-2892                     PIC S9(4)   VALUE +2892.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  23
* EL050.cbl
  1222     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1223     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1224     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1225     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1226     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1227     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1228     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1229     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1230     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1231     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1232     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1233     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1234     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1235     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1236     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1237     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1238     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1239     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1240     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1241     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1242     12  er-3270                     pic s9(4)   value +3270.
  1243     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1244     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1245     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1246     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1247     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1248     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1249     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1250     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1251     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1252     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1253     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1254     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1255     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1256     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1257     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1258     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1259     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1260     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1261     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1262     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1263     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1264     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1265     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1266     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1267     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1268     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1269     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1270     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1271     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1272     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1273     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1274     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1275     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1276     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1277     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1278     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1279     12  ER-8069                     PIC S9(4)   VALUE +8069.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  24
* EL050.cbl
  1280     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1281     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1282     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1283     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1284     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1285     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1286     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1287     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1288     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1289     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1290     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1291     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1292     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1293     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1294     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1295     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1296     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1297     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1298     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1299     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1300     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1301     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1302     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1303     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1304     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1305     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1306     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1307     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1308     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1309     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1310     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1311     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1312     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1313     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1314     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1315     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1316     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1317     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1318     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1319     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1320     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1321     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1322     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1323     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1324     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1325     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1326     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1327     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1328     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1329     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1330     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1331     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1332     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1333     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1334     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1335     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1336     12  er-9823                     pic s9(4)   value +9823.
  1337     12  ER-9999                     PIC S9(4)   VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  25
* EL050.cbl
  1338******************************************************************
  1339***************   END OF ELC50WS     ****************************
  1340******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  26
* EL050.cbl
  1343 01  WORKING-STORAGE-WORK-AREAS.
  1344     12  WS-RESPONSE             PIC S9(8)  COMP.
  1345         88  WS-RESP-NORMAL           VALUE +00.
  1346         88  WS-RESP-ERROR            VALUE +01.
  1347         88  WS-RESP-NOTFND           VALUE +13.
  1348         88  WS-RESP-DUPREC           VALUE +14.
  1349         88  WS-RESP-ENDFILE          VALUE +20.
  1350     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1351     12  WORK-AREAS.
  1352         16  WK-CONV-GREG.
  1353             24  WCG-CENT             PIC XX.
  1354             24  WCG-REST             PIC X(4).
  1355         16  WORK-GREGORIAN-DATE.
  1356             24  WK-GREG-CENT         PIC XX.
  1357             24  WK-GREG-DATE-YYMMDD.
  1358                 28  WK-GREG-YYMM     PIC X(4).
  1359                 28  WK-GREG-DD       PIC XX.
  1360
  1361         16  WORK-SELECT-DATE.
  1362             24  WK-SELECT-CENT            PIC XX.
  1363             24  WK-SELECT-DATE-YYMMDD.
  1364                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1365                 28  FILLER                PIC XX.
  1366
  1367         16  WK-FORM-NO.
  1368             24  WK-FORM-BANK-ID       PIC X(5).
  1369             24  WK-FORM-UNDRWRTR      PIC X(1).
  1370             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1371
  1372         16  WK-MEMBER-NO.
  1373             24  WK-MEMBER-1-6        PIC X(6).
  1374             24  WK-MEMBER-7-12       PIC X(6).
  1375
  1376         16  WK-FULL-CERT-NO.
  1377             24  WK-CERT-POS-1-2      PIC X(2).
  1378             24  WK-CERT-POS-3        PIC X(1).
  1379             24  WK-CERT-POS-4        PIC X(1).
  1380             24  WK-CERT-POS-5-6      PIC X(2).
  1381             24  WK-CERT-POS-7        PIC X(1).
  1382             24  WK-CERT-POS-8-11     PIC X(4).
  1383
  1384         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1385             88  VALID-RATE-CODE        VALUE 'Y'.
  1386             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1387
  1388         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1389         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1390         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1391         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1392         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1393         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1394         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1395         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1396         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1397         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1398
  1399* DLO001
  1400 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  27
* EL050.cbl
  1401     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1402     12  DMPF-RETURN-CODE          PIC XX.
  1403         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1404         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1405         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1406         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1407         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1408         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1409
  1410* DLO002
  1411 01  WS-DLO-INTERNAL-POLICY-FORM.
  1412     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1413     12  DIPF-RETURN-CODE          PIC XX.
  1414         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1415         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1416         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1417         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1418         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1419         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1420
  1421* DLO003
  1422 01  WS-DLO-VALID-BANK-ID.
  1423     12  DVBI-BANK-ID              PIC X(5).
  1424     12  DVBI-BANK-ID-TYPE         PIC X.
  1425         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1426         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1427         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1428         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1429         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1430     12  DVBI-RETURN-CODE          PIC XX.
  1431         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1432         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1433         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1434         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1435         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1436         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1437         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1438         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1439         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1440
  1441* DLO007
  1442 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1443     12  DCUA-RES-STATE            PIC XX.
  1444     12  DCUA-BEN-TYPE             PIC XX.
  1445     12  DCUA-SYS-IDENT            PIC X.
  1446         88  DCUA-CLAIM                        VALUE 'C'.
  1447         88  DCUA-PREMIUM                      VALUE 'P'.
  1448     12  DCUA-COVERAGE-RULE        PIC X.
  1449     12  DCUA-CLIENT-ID            PIC X(10).
  1450     12  DCUA-EFF-DATE             PIC X(8).
  1451     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1452     12  DCUA-RETURN-CODE          PIC XX.
  1453         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1454     12  DCUA-CERT-NUMBER          PIC X(11).
  1455     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1456     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1457
  1458* DLO011
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  28
* EL050.cbl
  1459 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1460     12  DPRB-RATE-CODE            PIC X(4).
  1461     12  DPRB-COVERAGE-CATEG       PIC X.
  1462     12  DPRB-RETURN-CODE          PIC XX.
  1463         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1464         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1465         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1466         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1467         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1468         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1469         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1470         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1471         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1472     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1473     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1474     12  DPRB-BEN-TYPE             PIC XX.
  1475
  1476* DLO017
  1477 01  WS-DLO-VALID-RATE-CODE.
  1478     12  DVRC-RATE-CODE            PIC X(4).
  1479     12  DVRC-RETURN-CODE          PIC XX.
  1480         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1481         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1482         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1483         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1484         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1485         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1486
  1487* DLO019
  1488 01  WS-DLO-ORIG-COV-CAT.
  1489     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1490     12  DOCC-RETURN-CODE          PIC XX.
  1491     12  DOCC-ORIG-COV-CAT         PIC X.
  1492     12  DOCC-UNDERWITER           PIC XX.
  1493     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1494     12  DOCC-FILLER               PIC X(6).
  1495
  1496* DLO021
  1497 01  WS-DLO-VALID-LOAN-OFFICER.
  1498     12  DVLO-LOAN-OFFICER.
  1499         16  DVLO-BILL-TYPE        PIC X.
  1500         16  DVLO-BILL-SOURCE      PIC X.
  1501         16  DVLO-BATCH-TYPE       PIC X.
  1502     12  DVLO-RETURN-CODE          PIC XX.
  1503         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1504         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1505         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1506         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1507         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1508         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1509
  1510* DLO022
  1511 01  WS-DLO-VALID-STATE-CODE.
  1512     12  DVSC-STATE-CODE           PIC XX.
  1513     12  DVSC-RETURN-CODE          PIC XX.
  1514         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1515
  1516* DLO023
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  29
* EL050.cbl
  1517 01  WS-DLO-VALID-CODE-VALUES.
  1518     12  DVCV-SYSTEM-ID            PIC XX.
  1519         88  DVCV-CLAIMS                       VALUE 'CL'.
  1520         88  DVCV-CREDIT                       VALUE 'CR'.
  1521     12  DVCV-RECORD-TYPE          PIC XX.
  1522         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1523         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1524         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1525         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1526         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1527         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1528         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1529         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1530     12  DVCV-RECORD-KEY           PIC X(6).
  1531     12  DVCV-RETURN-CODE          PIC XX.
  1532         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1533         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1534         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1535         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1536         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1537         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1538         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1539     12  DVCV-CODE-DESC            PIC X(60).
  1540     12  DVCV-GEN-DESC-1           PIC X(20).
  1541     12  DVCV-GEN-DESC-2           PIC X(20).
  1542     12  DVCV-GEN-DESC-3           PIC X(20).
  1543
  1544 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1545 01  hldi-pass-area.
  1546     03  PA-VIN                  PIC X(17).
  1547     03  PA-ErrorCode            PIC X(10).
  1548     03  PA-ErrorDesc            PIC X(30).
  1549     03  PA-ModelYear            PIC 9(7).
  1550     03  PA-MakeName             PIC X(50).
  1551     03  PA-ModelName            PIC X(50).
  1552     03  PA-SeriesName           PIC X(50).
  1553 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1554 01  zipcd-pass-area.
  1555     03  PA-zip                  PIC X(5).
  1556     03  PA-ErrorCode-zip        PIC X(10).
  1557     03  PA-city                 PIC x(50).
  1558     03  PA-state                PIC Xx.
  1559****  this is for aggregate report.
  1560****  Length is erpndb + 100 of passed-key-area
  1561 01  ws-passed-key-length        pic s9(4) comp value +587.
  1562 01  ws-pass-to-pemaggo.
  1563     05  ws-passed-erpndb        pic x(585).
  1564     05  ws-exceed-limit-yn      pic x.
  1565     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  30
* EL050.cbl
  1567*    COPY ERCBXRF.
  1568******************************************************************
  1569*                                                                *
  1570*                                                                *
  1571*                            ERCBXRF                             *
  1572*                                                                *
  1573*   ONLINE CREDIT SYSTEM                                         *
  1574*                                                                *
  1575*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1576*                                                                *
  1577*   FILE TYPE = VSAM,KSDS                                        *
  1578*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1579*                                                                *
  1580*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1581*       ALTERNATE PATH = NONE                                    *
  1582*                                                                *
  1583*   LOG = NO                                                     *
  1584*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1585*                                                                *
  1586******************************************************************
  1587
  1588 01  BANK-CROSS-REFERENCE.
  1589     12  BK-RECORD-ID                PIC XX.
  1590         88  VALID-BK-ID             VALUE 'BK'.
  1591
  1592     12  BK-CONTROL-PRIMARY.
  1593         16  BK-COMPANY-CD           PIC X.
  1594         16  BK-CARRIER              PIC X.
  1595         16  BK-GROUPING             PIC X(6).
  1596         16  BK-BANK-NO              PIC X(10).
  1597
  1598     12  BK-MAINT-INFORMATION.
  1599         16  BK-LAST-MAINT-DT        PIC XX.
  1600         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1601         16  BK-LAST-MAINT-USER      PIC X(4).
  1602         16  FILLER                  PIC X(9).
  1603
  1604     12  FILLER                      PIC X(37).
  1605
  1606     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1607
  1608     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1609                            DEPENDING ON BK-BANK-POINTER-CNT.
  1610         16  BK-AM-ACCOUNT           PIC X(10).
  1611         16  BK-AM-EXP-DT            PIC XX.
  1612         16  BK-AM-EFF-DT            PIC XX.
  1613         16  BK-AM-STATE             PIC XX.
  1614         16  FILLER                  PIC X(20).
  1615
  1616******************************************************************
  1617
  1618*    COPY ERCCOMP.
  1619******************************************************************
  1620*                                                                *
  1621*                                                                *
  1622*                            ERCCOMP                             *
  1623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1624*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  31
* EL050.cbl
  1625*                                                                *
  1626*   ONLINE CREDIT SYSTEM                                         *
  1627*                                                                *
  1628*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1629*                                                                *
  1630*   FILE TYPE = VSAM,KSDS                                        *
  1631*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1632*                                                                *
  1633*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1634*       ALTERNATE PATH = NONE                                    *
  1635*                                                                *
  1636*   LOG = NO                                                     *
  1637*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1638*                                                                *
  1639******************************************************************
  1640*                   C H A N G E   L O G
  1641*
  1642* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1643*-----------------------------------------------------------------
  1644*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1645* EFFECTIVE    NUMBER
  1646*-----------------------------------------------------------------
  1647* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1648* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1649* 092205    2005050300006  PEMA  ADD LEASE FEE
  1650* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1651* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1652* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1653* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1654* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1655* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1656******************************************************************
  1657
  1658 01  COMPENSATION-MASTER.
  1659     12  CO-RECORD-ID                          PIC XX.
  1660         88  VALID-CO-ID                          VALUE 'CO'.
  1661
  1662     12  CO-CONTROL-PRIMARY.
  1663         16  CO-COMPANY-CD                     PIC X.
  1664         16  CO-CONTROL.
  1665             20  CO-CTL-1.
  1666                 24  CO-CARR-GROUP.
  1667                     28  CO-CARRIER            PIC X.
  1668                     28  CO-GROUPING.
  1669                         32  CO-GROUP-PREFIX   PIC XXX.
  1670                         32  CO-GROUP-PRIME    PIC XXX.
  1671                 24  CO-RESP-NO.
  1672                     28  CO-RESP-PREFIX        PIC X(4).
  1673                     28  CO-RESP-PRIME         PIC X(6).
  1674             20  CO-CTL-2.
  1675                 24  CO-ACCOUNT.
  1676                     28  CO-ACCT-PREFIX        PIC X(4).
  1677                     28  CO-ACCT-PRIME         PIC X(6).
  1678         16  CO-TYPE                           PIC X.
  1679             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1680             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1681             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1682
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  32
* EL050.cbl
  1683     12  CO-MAINT-INFORMATION.
  1684         16  CO-LAST-MAINT-DT                  PIC XX.
  1685         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1686         16  CO-LAST-MAINT-USER                PIC X(4).
  1687     12  FILLER                                PIC XX.
  1688     12  CO-STMT-TYPE                          PIC XXX.
  1689     12  CO-COMP-TYPE                          PIC X.
  1690         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1691     12  CO-STMT-OWNER                         PIC X(4).
  1692     12  CO-BALANCE-CONTROL                    PIC X.
  1693         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1694         88  CO-NO-BALANCE                        VALUE 'N'.
  1695
  1696     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1697         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1698         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1699         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1700
  1701     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1702         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1703         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1704
  1705     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1706     12  CO-GA-DIRECT-DEP                      PIC X.
  1707     12  CO-FUTURE-SPACE                       PIC X.
  1708         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1709
  1710     12  CO-ACCT-NAME                          PIC X(30).
  1711     12  CO-MAIL-NAME                          PIC X(30).
  1712     12  CO-ADDR-1                             PIC X(30).
  1713     12  CO-ADDR-2                             PIC X(30).
  1714     12  CO-ADDR-3.
  1715         16  CO-ADDR-CITY                      PIC X(27).
  1716         16  CO-ADDR-STATE                     PIC XX.
  1717     12  CO-CSO-1099                           PIC X.
  1718     12  CO-ZIP.
  1719         16  CO-ZIP-PRIME.
  1720             20  CO-ZIP-PRI-1ST                PIC X.
  1721                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1722             20  FILLER                        PIC X(4).
  1723         16  CO-ZIP-PLUS4                      PIC X(4).
  1724     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1725         16  CO-CAN-POSTAL-1                   PIC XXX.
  1726         16  CO-CAN-POSTAL-2                   PIC XXX.
  1727         16  FILLER                            PIC XXX.
  1728     12  CO-SOC-SEC                            PIC X(13).
  1729     12  CO-TELEPHONE.
  1730         16  CO-AREA-CODE                      PIC XXX.
  1731         16  CO-PREFIX                         PIC XXX.
  1732         16  CO-PHONE                          PIC X(4).
  1733
  1734     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1735
  1736     12  CO-AR-BAL-LEVEL                       PIC X.
  1737         88  CO-AR-REF-LVL                        VALUE '1'.
  1738         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1739         88  CO-AR-BILL-LVL                       VALUE '2'.
  1740         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  33
* EL050.cbl
  1741         88  CO-AR-FR-LVL                         VALUE '4'.
  1742
  1743     12  CO-AR-NORMAL-PRINT                    PIC X.
  1744         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1745         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1746
  1747     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1748
  1749     12  CO-AR-REPORTING                       PIC X.
  1750         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1751         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1752
  1753     12  CO-AR-PULL-CHECK                      PIC X.
  1754         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1755         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1756
  1757     12  CO-AR-BALANCE-PRINT                   PIC X.
  1758         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1759
  1760     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1761         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1762         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1763         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1764
  1765     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1766
  1767     12  CO-USER-CODE                          PIC X.
  1768     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1769
  1770******************************************************************
  1771*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1772*    THE LAST MONTH END RUN.
  1773******************************************************************
  1774
  1775     12  CO-LAST-ACTIVITY-DATE.
  1776         16  CO-ACT-YEAR                       PIC 99.
  1777         16  CO-ACT-MONTH                      PIC 99.
  1778         16  CO-ACT-DAY                        PIC 99.
  1779
  1780     12  CO-LAST-STMT-DT.
  1781         16  CO-LAST-STMT-YEAR                 PIC 99.
  1782         16  CO-LAST-STMT-MONTH                PIC 99.
  1783         16  CO-LAST-STMT-DAY                  PIC 99.
  1784
  1785     12  CO-MO-END-TOTALS.
  1786         16  CO-MONTHLY-TOTALS.
  1787             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1788             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1789             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1790             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1791             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1792
  1793         16  CO-AGING-TOTALS.
  1794             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1795             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1796             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1797             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1798
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  34
* EL050.cbl
  1799         16  CO-YTD-TOTALS.
  1800             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1801             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1802
  1803         16  CO-OVER-UNDER-TOTALS.
  1804             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1805             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1806
  1807     12  CO-MISCELLANEOUS-TOTALS.
  1808         16  CO-FICA-TOTALS.
  1809             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1810             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1811
  1812         16  CO-CLAIM-TOTALS.
  1813             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1814             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1815
  1816******************************************************************
  1817*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1818*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1819******************************************************************
  1820
  1821     12  CO-CURRENT-TOTALS.
  1822         16  CO-CURRENT-LAST-STMT-DT.
  1823             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1824             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1825             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1826
  1827         16  CO-CURRENT-MONTHLY-TOTALS.
  1828             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1829             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1830             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1831             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1832             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1833
  1834         16  CO-CURRENT-AGING-TOTALS.
  1835             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1836             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1837             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1838             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1839
  1840         16  CO-CURRENT-YTD-TOTALS.
  1841             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1842             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1843
  1844     12  CO-PAID-COMM-TOTALS.
  1845         16  CO-YTD-PAID-COMMS.
  1846             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1847             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1848
  1849     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1850         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1851         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1852
  1853     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1854         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1855         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1856         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  35
* EL050.cbl
  1857         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1858         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1859         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1860         88  CO-FINAL-LETTER                  VALUE 'F'.
  1861         88  CO-RECONCILING                   VALUE 'R'.
  1862         88  CO-PHONE-CALL                    VALUE 'P'.
  1863         88  CO-LEGAL                         VALUE 'L'.
  1864         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1865         88  CO-WRITE-OFF                     VALUE 'W'.
  1866         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1867
  1868     12  CO-CSR-CODE                       PIC X(4).
  1869
  1870     12  CO-GA-STATUS-INFO.
  1871         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1872         16  CO-GA-TERMINATION-DT          PIC XX.
  1873         16  CO-GA-STATUS-CODE             PIC X.
  1874             88  CO-GA-ACTIVE                 VALUE 'A'.
  1875             88  CO-GA-INACTIVE               VALUE 'I'.
  1876             88  CO-GA-PENDING                VALUE 'P'.
  1877         16  CO-GA-COMMENTS.
  1878             20  CO-GA-COMMENT-1           PIC X(40).
  1879             20  CO-GA-COMMENT-2           PIC X(40).
  1880             20  CO-GA-COMMENT-3           PIC X(40).
  1881             20  CO-GA-COMMENT-4           PIC X(40).
  1882
  1883     12  CO-RPTCD2                         PIC X(10).
  1884     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1885         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1886         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1887
  1888     12  CO-TYPE-AGENT                     PIC X(01).
  1889         88  CO-CORPORATION                   VALUE 'C'.
  1890         88  CO-PARTNERSHIP                   VALUE 'P'.
  1891         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1892         88  CO-TRUST                         VALUE 'T'.
  1893         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1894
  1895     12  CO-FAXNO.
  1896         16  CO-FAX-AREA-CODE                  PIC XXX.
  1897         16  CO-FAX-PREFIX                     PIC XXX.
  1898         16  CO-FAX-PHONE                      PIC X(4).
  1899
  1900     12  CO-BANK-INFORMATION.
  1901         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1902         16  CO-BANK-TRANSIT-NON REDEFINES
  1903             CO-BANK-TRANSIT-NO                PIC 9(8).
  1904
  1905         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1906     12  CO-MISC-DEDUCT-INFO REDEFINES
  1907                  CO-BANK-INFORMATION.
  1908         16  CO-MD-GL-ACCT                     PIC X(10).
  1909         16  CO-MD-DIV                         PIC XX.
  1910         16  CO-MD-CENTER                      PIC X(4).
  1911         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1912         16  CO-CREATE-AP-CHECK                PIC X.
  1913         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1914         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  36
* EL050.cbl
  1915     12  CO-ACH-STATUS                         PIC X.
  1916         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1917         88  CO-ACH-PENDING                        VALUE 'P'.
  1918
  1919     12  CO-BILL-SW                            PIC X.
  1920     12  CO-CONTROL-NAME                       PIC X(30).
  1921     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1922     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1923     12  CO-CLP-STATE                          PIC XX.
  1924     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1925     12  CO-SPP-REFUND-EDIT                    PIC X.
  1926
  1927******************************************************************
  1928
  1929*    COPY ERCAGTC.
  1930******************************************************************
  1931*                                                                *
  1932*                                                                *
  1933*                            ERCAGTC                             *
  1934*                            VMOD=2.001                          *
  1935*                                                                *
  1936*   ONLINE CREDIT SYSTEM                                         *
  1937*                                                                *
  1938*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1939*                                                                *
  1940*   FILE TYPE = VSAM,KSDS                                        *
  1941*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1942*                                                                *
  1943*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1944*       ALTERNATE PATH = NONE                                    *
  1945*                                                                *
  1946*   LOG = NO                                                     *
  1947*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1948*                                                                *
  1949******************************************************************
  1950*                   C H A N G E   L O G
  1951*
  1952* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1953*-----------------------------------------------------------------
  1954*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1955* EFFECTIVE    NUMBER
  1956*-----------------------------------------------------------------
  1957* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1958* 111004                         NEW FILE AND COPYBOOK
  1959* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1960******************************************************************
  1961 01  AGENT-COMMISSIONS.
  1962     12  AG-RECORD-ID                          PIC XX.
  1963         88  VALID-CO-ID                          VALUE 'AG'.
  1964     12  AG-CONTROL-PRIMARY.
  1965         16  AG-COMPANY-CD                     PIC X.
  1966         16  AG-CONTROL.
  1967             20  AG-CTL-1.
  1968                 24  AG-CARR-GROUP.
  1969                     28  AG-CARRIER            PIC X.
  1970                     28  AG-GROUPING           PIC X(6).
  1971                 24  AG-BANK                   PIC X(10).
  1972             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  37
* EL050.cbl
  1973                 24  AG-EXP-DT                 PIC XX.
  1974         16  AG-TYPE                           PIC X.
  1975             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1976             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1977     12  AG-MAINT-INFORMATION.
  1978         16  AG-LAST-MAINT-DT                  PIC XX.
  1979         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1980         16  AG-LAST-MAINT-USER                PIC X(4).
  1981         16  FILLER                            PIC X(10).
  1982     12  AG-EFF-DT                             PIC XX.
  1983     12  AG-COMM-STRUCTURE.
  1984         16  AG-AGT-COMMS OCCURS 10.
  1985             20  AG-AGT                PIC X(10).
  1986             20  AG-COM-TYP            PIC X.
  1987             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1988             20  AG-RECALC-LV-INDIC    PIC X.
  1989             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1990             20  AG-LRCALC-LV-INDIC    PIC X.
  1991             20  FILLER                PIC X(05).
  1992     12  FILLER                  PIC X(145).
  1993******************************************************************
  1994*    COPY ERCRESS.
  1995******************************************************************
  1996*                                                                *
  1997*                            ERCRESS                             *
  1998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1999*                            VMOD=2.002                          *
  2000*                                                                *
  2001*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2002*                                                                *
  2003*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2004*   VSAM RESIDENT STATE TAX MASTER                              *
  2005*                                                                *
  2006*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2007*                                                                *
  2008*   FILE TYPE = VSAM,KSDS                                        *
  2009*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2010*                                                                *
  2011*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2012*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2013*                                                                *
  2014*   LOG = NO                                                     *
  2015*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2016*                                                                *
  2017*                                                                *
  2018******************************************************************
  2019
  2020 01  RESIDENT-STATE-TAX-MASTER.
  2021
  2022     10  ERRESS-PRIMARY-KEY.
  2023         15  RES-COMPANY-CD        PIC X.
  2024         15  RES-RESIDENT-STATE    PIC XX.
  2025         15  RES-COVERAGE-CATEGORY PIC X.
  2026         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2027*                                      YYYYMMDD
  2028*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2029
  2030     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  38
* EL050.cbl
  2031
  2032         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2033         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2034         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2035         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2036
  2037     10 RES-RECALC-SW              PIC   X.
  2038         88 RECALC                VALUE 'Y'.
  2039         88 NO-RECALC             VALUE 'N'.
  2040     10  RES-MAINT-BY              PIC X(4).
  2041     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2042     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2043*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  39
* EL050.cbl
  2045*    COPY ERCRESC.
  2046******************************************************************
  2047*                                                                *
  2048*                            ERCRESC                             *
  2049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2050*                            VMOD=2.003                          *
  2051*                                                                *
  2052*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2053*                                                                *
  2054*   FILE TYPE = VSAM,KSDS                                        *
  2055*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2056*                                                                *
  2057*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2058*       ALTERNATE PATH1 = NONE                                   *
  2059*                                                                *
  2060*   LOG = NO                                                     *
  2061*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2062*                                                                *
  2063******************************************************************
  2064
  2065 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2066
  2067     10  ERRESC-RECORD-KEY.
  2068         15  RESC-COMPANY-CD           PIC   X.
  2069         15  RESC-CARRIER              PIC   X.
  2070         15  RESC-GROUP                PIC   X(6).
  2071         15  RESC-STATE                PIC   XX.
  2072         15  RESC-ACCOUNT              PIC   X(10).
  2073         15  RESC-AGENT                PIC   X(10).
  2074         15  RESC-RESIDENT-STATE       PIC   XX.
  2075         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2076*                                           YYYYMMDD
  2077     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2078
  2079     10  RESC-COMM-RECORD-DATA.
  2080         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2081             20 RESC-COVERAGE-CAT      PIC    X.
  2082             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2083             20 RESC-COMMISSION-TAB REDEFINES
  2084                RESC-COMMISSION-PER    PIC  XXX.
  2085
  2086     10  RESC-MAINT-BY                 PIC X(4).
  2087     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2088     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2089*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  40
* EL050.cbl
  2091*    COPY ERCPLAN.
  2092******************************************************************
  2093*                                                                *
  2094*                                                                *
  2095*                            ERCPLAN                             *
  2096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2097*                            VMOD=2.003                          *
  2098*                                                                *
  2099*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2100*                                                                *
  2101*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2102*   PLAN MASTER                                                  *
  2103*                                                                *
  2104*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2105*                                                                *
  2106*   FILE TYPE = VSAM,KSDS                                        *
  2107*   RECORD SIZE = 420   RECFORM = FIX                            *
  2108*                                                                *
  2109*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2110*       ALTERNATE PATH1 = N/A                                    *
  2111*                                                                *
  2112*   LOG = NO                                                     *
  2113*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2114*                                                                *
  2115*                                                                *
  2116******************************************************************
  2117
  2118 01  PLAN-MASTER.
  2119     12  PL-RECORD-ID                      PIC XX.
  2120         88  VALID-PL-ID                      VALUE 'PL'.
  2121
  2122     12  PL-CONTROL-PRIMARY.
  2123         16  PL-COMPANY-CD                 PIC X.
  2124         16  PL-MSTR-CNTRL.
  2125             20  PL-CONTROL-A.
  2126                 24  PL-CARRIER            PIC X.
  2127                 24  PL-GROUPING           PIC X(6).
  2128                 24  PL-STATE              PIC XX.
  2129                 24  PL-ACCOUNT            PIC X(10).
  2130             20  PL-BENEFIT-TYPE           PIC X.
  2131             20  PL-BENEFIT-CODE           PIC XX.
  2132             20  PL-REVISION-NO            PIC X(3).
  2133
  2134     12  PL-CONTROL-BY-VAR-GRP.
  2135         16  PL-COMPANY-CD-A1              PIC X.
  2136         16  PL-VG-CARRIER                 PIC X.
  2137         16  PL-VG-GROUPING                PIC X(6).
  2138         16  PL-VG-STATE                   PIC XX.
  2139         16  PL-VG-ACCOUNT                 PIC X(10).
  2140         16  PL-BENEFIT-TYPE-A1            PIC X.
  2141         16  PL-BENEFIT-CODE-A1            PIC XX.
  2142         16  PL-REVISION-NO-A1             PIC 999.
  2143
  2144     12  PL-MAINT-INFORMATION.
  2145         16  PL-LAST-MAINT-DT              PIC XX.
  2146         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2147         16  PL-LAST-MAINT-USER            PIC X(4).
  2148         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  41
* EL050.cbl
  2149
  2150     12  PL-LIABILITY-LIMITS.
  2151         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2152         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2153             20  PL-LM-AGE                 PIC S99        COMP-3.
  2154             20  PL-LM-DUR                 PIC S999       COMP-3.
  2155             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2156             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2157
  2158     12  FILLER                            PIC X(30).
  2159
  2160     12  PL-GL-ACCOUNT-NOS.
  2161         16  PL-PREMIUM-GL                 PIC X(8).
  2162         16  PL-COMM-GL                    PIC X(8).
  2163         16  PL-CLAIM-GL                   PIC X(8).
  2164     12  FILLER                            PIC X(24).
  2165     12  PL-TOLERANCES.
  2166         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2167         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2168         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2169         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2170         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2171         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2172     12  PL-OVER-SHORT.
  2173         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2174         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2175     12  FILLER                            PIC X(24).
  2176     12  PLAN-MISC.
  2177         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2178         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2179         16  PL-IG                         PIC X.
  2180         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2181         16  PL-POLICY-FORM                PIC X(12).
  2182         16  PL-EDIT-FOR-FORM              PIC X(01).
  2183         16  PL-DEV-CODE                   PIC XXX.
  2184         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2185         16  PL-CALC-METHOD                PIC X.
  2186         16  PL-BENEFIT-GROUP              PIC X(05).
  2187         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2188
  2189         16  FILLER                        PIC X(99).
  2190******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  42
* EL050.cbl
  2192*    COPY ELCCERT.
  2193******************************************************************
  2194*                                                                *
  2195*                            ELCCERT.                            *
  2196*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2197*                            VMOD=2.013                          *
  2198*                                                                *
  2199*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2200*                                                                *
  2201*   FILE TYPE = VSAM,KSDS                                        *
  2202*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2203*                                                                *
  2204*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2205*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2206*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2207*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2208*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2209*                                                                *
  2210*   LOG = YES                                                    *
  2211*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2212******************************************************************
  2213*                   C H A N G E   L O G
  2214*
  2215* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2216*-----------------------------------------------------------------
  2217*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2218* EFFECTIVE    NUMBER
  2219*-----------------------------------------------------------------
  2220* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2221* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2222* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2223* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2224* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2225* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2226* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2227* 032612  CR2011110200001  PEMA  AHL CHANGES
  2228* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2229* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2230* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2231******************************************************************
  2232
  2233 01  CERTIFICATE-MASTER.
  2234     12  CM-RECORD-ID                      PIC XX.
  2235         88  VALID-CM-ID                      VALUE 'CM'.
  2236
  2237     12  CM-CONTROL-PRIMARY.
  2238         16  CM-COMPANY-CD                 PIC X.
  2239         16  CM-CARRIER                    PIC X.
  2240         16  CM-GROUPING.
  2241             20  CM-GROUPING-PREFIX        PIC X(3).
  2242             20  CM-GROUPING-PRIME         PIC X(3).
  2243         16  CM-STATE                      PIC XX.
  2244         16  CM-ACCOUNT.
  2245             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2246             20  CM-ACCOUNT-PRIME          PIC X(6).
  2247         16  CM-CERT-EFF-DT                PIC XX.
  2248         16  CM-CERT-NO.
  2249             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  43
* EL050.cbl
  2250             20  CM-CERT-SFX               PIC X.
  2251
  2252     12  CM-CONTROL-BY-NAME.
  2253         16  CM-COMPANY-CD-A1              PIC X.
  2254         16  CM-INSURED-LAST-NAME          PIC X(15).
  2255         16  CM-INSURED-INITIALS.
  2256             20  CM-INSURED-INITIAL1       PIC X.
  2257             20  CM-INSURED-INITIAL2       PIC X.
  2258
  2259     12  CM-CONTROL-BY-SSN.
  2260         16  CM-COMPANY-CD-A2              PIC X.
  2261         16  CM-SOC-SEC-NO.
  2262             20  CM-SSN-STATE              PIC XX.
  2263             20  CM-SSN-ACCOUNT            PIC X(6).
  2264             20  CM-SSN-LN3.
  2265                 25  CM-INSURED-INITIALS-A2.
  2266                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2267                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2268                 25 CM-PART-LAST-NAME-A2         PIC X.
  2269
  2270     12  CM-CONTROL-BY-CERT-NO.
  2271         16  CM-COMPANY-CD-A4              PIC X.
  2272         16  CM-CERT-NO-A4                 PIC X(11).
  2273
  2274     12  CM-CONTROL-BY-MEMB.
  2275         16  CM-COMPANY-CD-A5              PIC X.
  2276         16  CM-MEMBER-NO.
  2277             20  CM-MEMB-STATE             PIC XX.
  2278             20  CM-MEMB-ACCOUNT           PIC X(6).
  2279             20  CM-MEMB-LN4.
  2280                 25  CM-INSURED-INITIALS-A5.
  2281                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2282                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2283                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2284
  2285     12  CM-INSURED-PROFILE-DATA.
  2286         16  CM-INSURED-FIRST-NAME.
  2287             20  CM-INSURED-1ST-INIT       PIC X.
  2288             20  FILLER                    PIC X(9).
  2289         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2290         16  CM-INSURED-SEX                PIC X.
  2291             88  CM-SEX-MALE                  VALUE 'M'.
  2292             88  CM-SEX-FEMAL                 VALUE 'F'.
  2293         16  CM-INSURED-JOINT-AGE          PIC 99.
  2294         16  CM-JOINT-INSURED-NAME.
  2295             20  CM-JT-LAST-NAME           PIC X(15).
  2296             20  CM-JT-FIRST-NAME.
  2297                 24  CM-JT-1ST-INIT        PIC X.
  2298                 24  FILLER                PIC X(9).
  2299             20  CM-JT-INITIAL             PIC X.
  2300
  2301     12  CM-LIFE-DATA.
  2302         16  CM-LF-BENEFIT-CD              PIC XX.
  2303         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2304         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2305         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2306         16  CM-LF-DEV-CODE                PIC XXX.
  2307         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  44
* EL050.cbl
  2308         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2309         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2310         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2311         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2312         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2313         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2314         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2315         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2316         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2317         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2318         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2319         16  cm-temp-epiq                  pic xx.
  2320             88  EPIQ-CLASS                  value 'EQ'.
  2321*        16  FILLER                        PIC XX.
  2322
  2323     12  CM-AH-DATA.
  2324         16  CM-AH-BENEFIT-CD              PIC XX.
  2325         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2326         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2327         16  CM-AH-DEV-CODE                PIC XXX.
  2328         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2329         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2330         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2331         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2332         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2333         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2334         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2335         16  CM-AH-PAID-THRU-DT            PIC XX.
  2336             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2337         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2338         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2339         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2340         16  FILLER                        PIC X.
  2341
  2342     12  CM-LOAN-INFORMATION.
  2343         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2344         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2345                                           PIC S9(5)V99  COMP-3.
  2346         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2347         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2348         16  CM-PAY-FREQUENCY              PIC S99.
  2349         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2350         16  CM-RATE-CLASS                 PIC XX.
  2351         16  CM-BENEFICIARY                PIC X(25).
  2352         16  CM-POLICY-FORM-NO             PIC X(12).
  2353         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2354         16  CM-LAST-ADD-ON-DT             PIC XX.
  2355         16  CM-DEDUCTIBLE-AMOUNTS.
  2356             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2357             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2358         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2359             20  CM-RESIDENT-STATE         PIC XX.
  2360             20  CM-RATE-CODE              PIC X(4).
  2361             20  FILLER                    PIC XX.
  2362         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2363             20  CM-LOAN-OFFICER           PIC X(5).
  2364             20  FILLER                    PIC XXX.
  2365         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  45
* EL050.cbl
  2366         16  CM-UNDERWRITING-CODE          PIC X.
  2367             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2368         16  CM-POST-CARD-IND              PIC X.
  2369         16  CM-REF-INTERFACE-SW           PIC X.
  2370         16  CM-PREMIUM-TYPE               PIC X.
  2371             88  CM-SING-PRM                  VALUE '1'.
  2372             88  CM-O-B-COVERAGE              VALUE '2'.
  2373             88  CM-OPEN-END                  VALUE '3'.
  2374         16  CM-IND-GRP-TYPE               PIC X.
  2375             88  CM-INDIVIDUAL                VALUE 'I'.
  2376             88  CM-GROUP                     VALUE 'G'.
  2377         16  CM-SKIP-CODE                  PIC X.
  2378             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2379             88  SKIP-JULY                    VALUE '1'.
  2380             88  SKIP-AUGUST                  VALUE '2'.
  2381             88  SKIP-SEPTEMBER               VALUE '3'.
  2382             88  SKIP-JULY-AUG                VALUE '4'.
  2383             88  SKIP-AUG-SEPT                VALUE '5'.
  2384             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2385             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2386             88  SKIP-JUNE                    VALUE '8'.
  2387             88  SKIP-JUNE-JULY               VALUE '9'.
  2388             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2389             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2390         16  CM-PAYMENT-MODE               PIC X.
  2391             88  PAY-MONTHLY                  VALUE SPACE.
  2392             88  PAY-WEEKLY                   VALUE '1'.
  2393             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2394             88  PAY-BI-WEEKLY                VALUE '3'.
  2395             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2396         16  CM-LOAN-NUMBER                PIC X(8).
  2397         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2398         16  CM-OLD-LOF                    PIC XXX.
  2399*        16  CM-LOAN-OFFICER               PIC XXX.
  2400         16  CM-REIN-TABLE                 PIC XXX.
  2401         16  CM-SPECIAL-REIN-CODE          PIC X.
  2402         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2403         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2404         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2405
  2406     12  CM-STATUS-DATA.
  2407         16  CM-ENTRY-STATUS               PIC X.
  2408         16  CM-ENTRY-DT                   PIC XX.
  2409
  2410         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2411         16  CM-LF-CANCEL-DT               PIC XX.
  2412         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2413
  2414         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2415         16  CM-LF-DEATH-DT                PIC XX.
  2416         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2417
  2418         16  CM-LF-CURRENT-STATUS          PIC X.
  2419             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2420                                                'M' '4' '5' '9'.
  2421             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2422             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2423             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  46
* EL050.cbl
  2424             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2425             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2426             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2427             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2428             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2429             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2430             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2431             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2432             88  CM-LF-DECLINED               VALUE 'D'.
  2433             88  CM-LF-VOIDED                 VALUE 'V'.
  2434
  2435         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2436         16  CM-AH-CANCEL-DT               PIC XX.
  2437         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2438
  2439         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2440         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2441         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2442
  2443         16  CM-AH-CURRENT-STATUS          PIC X.
  2444             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2445                                                'M' '4' '5' '9'.
  2446             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2447             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2448             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2449             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2450             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2451             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2452             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2453             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2454             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2455             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2456             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2457             88  CM-AH-DECLINED               VALUE 'D'.
  2458             88  CM-AH-VOIDED                 VALUE 'V'.
  2459
  2460         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2461             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2462             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2463             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2464         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2465
  2466         16  CM-ENTRY-BATCH                PIC X(6).
  2467         16  CM-LF-EXIT-BATCH              PIC X(6).
  2468         16  CM-AH-EXIT-BATCH              PIC X(6).
  2469         16  CM-LAST-MONTH-END             PIC XX.
  2470
  2471     12  CM-NOTE-SW                        PIC X.
  2472         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2473         88  CERT-NOTES-PRESENT               VALUE '1'.
  2474         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2475         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2476         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2477         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2478         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2479         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2480     12  CM-COMP-EXCP-SW                   PIC X.
  2481         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  47
* EL050.cbl
  2482         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2483     12  CM-INSURED-ADDRESS-SW             PIC X.
  2484         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2485         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2486
  2487*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2488     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2489     12  FILLER                            PIC X.
  2490
  2491*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2492     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2493     12  FILLER                            PIC X.
  2494*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2495     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2496
  2497     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2498         88  CERT-ADDED-BATCH                 VALUE ' '.
  2499         88  CERT-ADDED-ONLINE                VALUE '1'.
  2500         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2501         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2502         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2503     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2504         88  CERT-AS-LOADED                   VALUE ' '.
  2505         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2506         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2507         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2508         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2509         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2510         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2511         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2512
  2513     12  CM-ACCOUNT-COMM-PCTS.
  2514         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2515         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2516
  2517     12  CM-USER-FIELD                     PIC X.
  2518     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2519     12  CM-CLP-STATE                      PIC XX.
  2520     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2521     12  CM-USER-RESERVED                  PIC XXX.
  2522     12  FILLER REDEFINES CM-USER-RESERVED.
  2523         16  CM-AH-CLASS-CD                PIC XX.
  2524         16  F                             PIC X.
  2525******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  48
* EL050.cbl
  2527*    COPY ERCMAIL.
  2528******************************************************************
  2529*                                                                *
  2530*                                                                *
  2531*                            ERCMAIL                             *
  2532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2533*                            VMOD=2.003                          *
  2534*                                                                *
  2535*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2536*                                                                *
  2537*   FILE TYPE = VSAM,KSDS                                        *
  2538*   RECORD SIZE = 374   RECFORM = FIX                            *
  2539*                                                                *
  2540*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2541*   ALTERNATE PATH    = NOT USED                                 *
  2542*                                                                *
  2543*   LOG = YES                                                    *
  2544*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2545******************************************************************
  2546*                   C H A N G E   L O G
  2547*
  2548* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2549*-----------------------------------------------------------------
  2550*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2551* EFFECTIVE    NUMBER
  2552*-----------------------------------------------------------------
  2553* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2554* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2555* 111108                   PEMA  ADD CRED BENE ADDR2
  2556******************************************************************
  2557
  2558 01  MAILING-DATA.
  2559     12  MA-RECORD-ID                      PIC XX.
  2560         88  VALID-MA-ID                       VALUE 'MA'.
  2561
  2562     12  MA-CONTROL-PRIMARY.
  2563         16  MA-COMPANY-CD                 PIC X.
  2564         16  MA-CARRIER                    PIC X.
  2565         16  MA-GROUPING.
  2566             20  MA-GROUPING-PREFIX        PIC XXX.
  2567             20  MA-GROUPING-PRIME         PIC XXX.
  2568         16  MA-STATE                      PIC XX.
  2569         16  MA-ACCOUNT.
  2570             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2571             20  MA-ACCOUNT-PRIME          PIC X(6).
  2572         16  MA-CERT-EFF-DT                PIC XX.
  2573         16  MA-CERT-NO.
  2574             20  MA-CERT-PRIME             PIC X(10).
  2575             20  MA-CERT-SFX               PIC X.
  2576
  2577     12  FILLER                            PIC XX.
  2578
  2579     12  MA-ACCESS-CONTROL.
  2580         16  MA-SOURCE-SYSTEM              PIC XX.
  2581             88  MA-FROM-CREDIT                VALUE 'CR'.
  2582             88  MA-FROM-VSI                   VALUE 'VS'.
  2583             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2584             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  49
* EL050.cbl
  2585         16  MA-RECORD-ADD-DT              PIC XX.
  2586         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2587         16  MA-LAST-MAINT-DT              PIC XX.
  2588         16  MA-LAST-MAINT-BY              PIC XXXX.
  2589         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2590
  2591     12  MA-PROFILE-INFO.
  2592         16  MA-QUALIFY-CODE-1             PIC XX.
  2593         16  MA-QUALIFY-CODE-2             PIC XX.
  2594         16  MA-QUALIFY-CODE-3             PIC XX.
  2595         16  MA-QUALIFY-CODE-4             PIC XX.
  2596         16  MA-QUALIFY-CODE-5             PIC XX.
  2597
  2598         16  MA-INSURED-LAST-NAME          PIC X(15).
  2599         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2600         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2601         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2602         16  MA-INSURED-BIRTH-DT           PIC XX.
  2603         16  MA-INSURED-SEX                PIC X.
  2604             88  MA-SEX-MALE                   VALUE 'M'.
  2605             88  MA-SEX-FEMALE                 VALUE 'F'.
  2606         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2607
  2608         16  MA-ADDRESS-CORRECTED          PIC X.
  2609         16  MA-JOINT-BIRTH-DT             PIC XX.
  2610*        16  FILLER                        PIC X(12).
  2611
  2612         16  MA-ADDRESS-LINE-1             PIC X(30).
  2613         16  MA-ADDRESS-LINE-2             PIC X(30).
  2614         16  MA-CITY-STATE.
  2615             20  MA-CITY                   PIC X(28).
  2616             20  MA-ADDR-STATE             PIC XX.
  2617         16  MA-ZIP.
  2618             20  MA-ZIP-CODE.
  2619                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2620                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2621                 24  FILLER                PIC X(4).
  2622             20  MA-ZIP-PLUS4              PIC X(4).
  2623         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2624             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2625             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2626             20  FILLER                    PIC X(3).
  2627
  2628         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2629
  2630         16  FILLER                        PIC XXX.
  2631*        16  FILLER                        PIC X(10).
  2632
  2633     12  MA-CRED-BENE-INFO.
  2634         16  MA-CRED-BENE-NAME                 PIC X(25).
  2635         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2636         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2637         16  MA-CRED-BENE-CTYST.
  2638             20  MA-CRED-BENE-CITY             PIC X(28).
  2639             20  MA-CRED-BENE-STATE            PIC XX.
  2640         16  MA-CRED-BENE-ZIP.
  2641             20  MA-CB-ZIP-CODE.
  2642                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  50
* EL050.cbl
  2643                     88  MA-CB-CANADIAN-POST-CODE
  2644                                           VALUE 'A' THRU 'Z'.
  2645                 24  FILLER                    PIC X(4).
  2646             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2647         16  MA-CB-CANADIAN-POSTAL-CODE
  2648                            REDEFINES MA-CRED-BENE-ZIP.
  2649             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2650             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2651             20  FILLER                        PIC X(3).
  2652     12  MA-POST-CARD-MAIL-DATA.
  2653         16  MA-MAIL-DATA OCCURS 7.
  2654             20  MA-MAIL-TYPE              PIC X.
  2655                 88  MA-12MO-MAILING           VALUE '1'.
  2656                 88  MA-EXP-MAILING            VALUE '2'.
  2657             20  MA-MAIL-STATUS            PIC X.
  2658                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2659                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2660                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2661             20  MA-MAIL-DATE              PIC XX.
  2662     12  FILLER                            PIC XX.
  2663     12  FILLER                            PIC XX.
  2664*    12  FILLER                            PIC X(30).
  2665******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  51
* EL050.cbl
  2667*    COPY ERCPNDM.
  2668******************************************************************
  2669*                                                                *
  2670*                                                                *
  2671*                            ERCPNDM                             *
  2672*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2673*                            VMOD=2.003                          *
  2674*                                                                *
  2675*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2676*                                                                *
  2677*   FILE TYPE = VSAM,KSDS                                        *
  2678*   RECORD SIZE = 374   RECFORM = FIX                            *
  2679*                                                                *
  2680*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2681*   ALTERNATE PATH    = NOT USED                                 *
  2682*                                                                *
  2683*   LOG = YES                                                    *
  2684*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2685******************************************************************
  2686*                   C H A N G E   L O G
  2687*
  2688* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2689*-----------------------------------------------------------------
  2690*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2691* EFFECTIVE    NUMBER
  2692*-----------------------------------------------------------------
  2693* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2694* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2695* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2696* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2697******************************************************************
  2698
  2699 01  PENDING-MAILING-DATA.
  2700     12  PM-RECORD-ID                      PIC XX.
  2701         88  VALID-MA-ID                       VALUE 'PM'.
  2702
  2703     12  PM-CONTROL-PRIMARY.
  2704         16  PM-COMPANY-CD                 PIC X.
  2705         16  PM-ENTRY-BATCH                PIC X(6).
  2706         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2707         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2708
  2709     12  FILLER                            PIC X(14).
  2710
  2711     12  PM-ACCESS-CONTROL.
  2712         16  PM-SOURCE-SYSTEM              PIC XX.
  2713             88  PM-FROM-CREDIT                VALUE 'CR'.
  2714             88  PM-FROM-VSI                   VALUE 'VS'.
  2715             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2716             88  PM-FROM-OTHER                 VALUE 'OT'.
  2717         16  PM-RECORD-ADD-DT              PIC XX.
  2718         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2719         16  PM-LAST-MAINT-DT              PIC XX.
  2720         16  PM-LAST-MAINT-BY              PIC XXXX.
  2721         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2722
  2723     12  PM-PROFILE-INFO.
  2724         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  52
* EL050.cbl
  2725         16  PM-QUALIFY-CODE-2             PIC XX.
  2726         16  PM-QUALIFY-CODE-3             PIC XX.
  2727         16  PM-QUALIFY-CODE-4             PIC XX.
  2728         16  PM-QUALIFY-CODE-5             PIC XX.
  2729
  2730         16  PM-INSURED-LAST-NAME          PIC X(15).
  2731         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2732         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2733         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2734         16  PM-INSURED-BIRTH-DT           PIC XX.
  2735         16  PM-INSURED-SEX                PIC X.
  2736             88  PM-SEX-MALE                   VALUE 'M'.
  2737             88  PM-SEX-FEMALE                 VALUE 'F'.
  2738         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2739
  2740         16  PM-ADDRESS-CORRECTED          PIC X.
  2741         16  PM-JOINT-BIRTH-DT             PIC XX.
  2742*        16  FILLER                        PIC X(12).
  2743
  2744         16  PM-ADDRESS-LINE-1             PIC X(30).
  2745         16  PM-ADDRESS-LINE-2             PIC X(30).
  2746         16  PM-CITY-STATE.
  2747             20  PM-CITY                   PIC X(28).
  2748             20  PM-STATE                  PIC XX.
  2749         16  PM-ZIP.
  2750             20  PM-ZIP-CODE.
  2751                 24  PM-ZIP-1              PIC X.
  2752                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2753                 24  FILLER                PIC X(4).
  2754             20  PM-ZIP-PLUS4              PIC X(4).
  2755         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2756             20  PM-CAN-POST1              PIC XXX.
  2757             20  PM-CAN-POST2              PIC XXX.
  2758             20  FILLER                    PIC XXX.
  2759
  2760         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2761         16  pm-city-st-zip-verified       pic x.
  2762         16  FILLER                        PIC XX.
  2763
  2764     12  PM-CRED-BENE-INFO.
  2765         16  PM-CRED-BENE-NAME             PIC X(25).
  2766         16  PM-CRED-BENE-ADDR             PIC X(30).
  2767         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2768         16  PM-CRED-BENE-CTYST.
  2769             20  PM-CRED-BENE-CITY         PIC X(28).
  2770             20  PM-CRED-BENE-STATE        PIC XX.
  2771         16  PM-CRED-BENE-ZIP.
  2772             20  PM-CB-ZIP-CODE.
  2773                 24  PM-CB-ZIP-1           PIC X.
  2774                     88  PM-CB-CANADIAN-POST-CODE
  2775                                  VALUE 'A' THRU 'Z'.
  2776                 24  FILLER                PIC X(4).
  2777             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2778         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2779             20  PM-CB-CAN-POST1           PIC XXX.
  2780             20  PM-CB-CAN-POST2           PIC XXX.
  2781             20  FILLER                    PIC XXX.
  2782     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  53
* EL050.cbl
  2783         16  PM-MAIL-DATA OCCURS 7.
  2784             20  PM-MAIL-TYPE              PIC X.
  2785                 88  PM-12MO-MAILING           VALUE '1'.
  2786                 88  PM-EXP-MAILING            VALUE '2'.
  2787             20  PM-MAIL-STATUS            PIC X.
  2788                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2789                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2790                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2791             20  PM-MAIL-DATE              PIC XX.
  2792     12  FILLER                            PIC XX.
  2793     12  FILLER                            PIC X(12).
  2794*    12  FILLER                            PIC X(30).
  2795
  2796******************************************************************
  2797*                                COPY ERCLOFC.
  2798******************************************************************
  2799*                                                                *
  2800*                                                                *
  2801*                            ERCLOFC                             *
  2802*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2803*                            VMOD=2.003                          *
  2804*                                                                *
  2805*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2806*                                                                *
  2807*   FILE TYPE = VSAM,KSDS                                        *
  2808*   RECORD SIZE = 670   RECFORM = FIX                            *
  2809*                                                                *
  2810*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2811*                                                                *
  2812*   LOG = YES                                                    *
  2813*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2814*                                                                *
  2815******************************************************************
  2816
  2817 01  LOAN-OFFICER-MASTER.
  2818     12  LO-RECORD-ID                PIC XX.
  2819         88  VALID-LO-ID                VALUE 'LO'.
  2820
  2821     12  LO-CONTROL-PRIMARY.
  2822         16  LO-COMPANY-CD           PIC X.
  2823         16  LO-CARRIER              PIC X.
  2824         16  LO-GROUPING.
  2825             20  LO-GROUPING-PREFIX  PIC XXX.
  2826             20  LO-GROUPING-PRIME   PIC XXX.
  2827         16  LO-STATE                PIC XX.
  2828         16  LO-ACCOUNT.
  2829             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2830             20  LO-ACCOUNT-PRIME    PIC X(6).
  2831         16  LO-OFFICER-CODE         PIC X(5).
  2832
  2833     12  LO-OFFICER-NAME             PIC X(30).
  2834
  2835     12  LO-LAST-MAINT-DT            PIC XX.
  2836     12  LO-LAST-USER                PIC X(4).
  2837     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2838
  2839     12  LO-COMP-CONTROL             PIC X.
  2840             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  54
* EL050.cbl
  2841             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2842     12  LO-DETAIL-CONTROL           PIC X.
  2843             88  LO-PRINT-DETAIL        VALUE 'D'.
  2844             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2845
  2846     12  LO-SV-CARRIER               PIC X.
  2847     12  LO-SV-GROUPING              PIC X(6).
  2848     12  LO-SV-STATE                 PIC XX.
  2849
  2850     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2851     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2852
  2853     12  LO-OFFICER-INFO.
  2854         16  FILLER OCCURS 12 TIMES.
  2855             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2856             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2857             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2858             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2859             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2860             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2861             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2862             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2863     12  FILLER                      PIC X(198).
  2864******************************************************************
  2865*                                COPY ERCPDEF.
  2866******************************************************************
  2867*                                                                *
  2868*                                                                *
  2869*                            ERCPDEF.                            *
  2870*                                                                *
  2871*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2872*                                                                *
  2873*    FILE TYPE = VSAM,KSDS                                       *
  2874*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2875*                                                                *
  2876*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2877*                                                                *
  2878*    LOG = YES                                                   *
  2879*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2880******************************************************************
  2881*                   C H A N G E   L O G
  2882*
  2883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2884*-----------------------------------------------------------------
  2885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2886* EFFECTIVE    NUMBER
  2887*-----------------------------------------------------------------
  2888* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2889* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2890* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2891******************************************************************
  2892 01  PRODUCT-MASTER.
  2893    12  PD-RECORD-ID                 PIC X(02).
  2894        88  VALID-PD-ID                  VALUE 'PD'.
  2895    12  PD-CONTROL-PRIMARY.
  2896        16  PD-COMPANY-CD            PIC X.
  2897        16  PD-STATE                 PIC XX.
  2898        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  55
* EL050.cbl
  2899        16  PD-FILLER                PIC X(7).
  2900        16  PD-BEN-TYPE              PIC X.
  2901        16  PD-BEN-CODE              PIC XX.
  2902        16  PD-PROD-EXP-DT           PIC XX.
  2903    12  FILLER                       PIC X(50).
  2904    12  PD-PRODUCT-DATA OCCURS 8.
  2905        16  PD-PROD-CODE             PIC X.
  2906            88  PD-PROD-LIFE           VALUE 'L'.
  2907            88  PD-PROD-PROP           VALUE 'P'.
  2908            88  PD-PROD-AH             VALUE 'A'.
  2909            88  PD-PROD-IU             VALUE 'I'.
  2910            88  PD-PROD-GAP            VALUE 'G'.
  2911            88  PD-PROD-FAML           VALUE 'F'.
  2912        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2913        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2914        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2915        16  PD-MAX-TERM              PIC S999        COMP-3.
  2916        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2917        16  FILLER                   PIC X.
  2918        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2919        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2920        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2921        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2922        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2923        16  PD-REC-CRIT-PERIOD       PIC 99.
  2924        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2925            20  PD-RECURRING-YN      PIC X.
  2926            20  FILLER               PIC X.
  2927        16  PD-RTW-MOS               PIC 99.
  2928        16  PD-MAX-EXTENSION         PIC 99.
  2929        16  pd-ben-pct               pic sv999 comp-3.
  2930*       16  FILLER                   PIC XX.
  2931    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2932    12  PD-TERM-LIMITS OCCURS 15.
  2933        16  PD-LOW-TERM              PIC S999        COMP-3.
  2934        16  PD-HI-TERM               PIC S999        COMP-3.
  2935*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2936    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2937        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2938        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2939    12  PD-EARN-FACTORS.
  2940        16  FILLER OCCURS 15.
  2941            20  FILLER OCCURS 15.
  2942                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2943    12  PD-PRODUCT-DESC              PIC X(80).
  2944    12  PD-TRUNCATED                 PIC X.
  2945    12  FILLER                       PIC X(59).
  2946    12  PD-MAINT-INFORMATION.
  2947        16  PD-LAST-MAINT-DT         PIC X(02).
  2948        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2949        16  PD-LAST-MAINT-BY         PIC X(04).
  2950*                                COPY ELCSTATE.
  2951******************************************************************
  2952*                                                                *
  2953*                                                                *
  2954*                            ELCSTATE.                           *
  2955*                                                                *
  2956*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  56
* EL050.cbl
  2957*                                                                *
  2958*   FILE TYPE = VSAM,KSDS                                        *
  2959*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2960*                                                                *
  2961*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2962*       ALTERNATE INDEX = NONE                                   *
  2963*                                                                *
  2964*   LOG = YES                                                    *
  2965*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2966******************************************************************
  2967*                   C H A N G E   L O G
  2968*
  2969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2970*-----------------------------------------------------------------
  2971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2972* EFFECTIVE    NUMBER
  2973*-----------------------------------------------------------------
  2974* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2975******************************************************************
  2976*
  2977 01  STATE-FILE.
  2978     12  SF-RECORD-ID                       PIC XX.
  2979         88  VALID-CF-ID                        VALUE 'SF'.
  2980     12  SF-CONTROL-PRIMARY.
  2981         16  SF-COMPANY-ID                  PIC XXX.
  2982         16  SF-CARRIER-CODE                PIC X.
  2983         16  SF-GROUPING                    PIC X(6).
  2984         16  SF-STATE-CODE                  PIC XX.
  2985         16  SF-EXPIRE-DATE                 PIC 9(8).
  2986****************************************************************
  2987*             STATE CONTROLS
  2988****************************************************************
  2989     12  SF-LAST-MAINT-DT                   PIC XX.
  2990     12  SF-LAST-MAINT-BY                   PIC X(4).
  2991     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2992     12  SF-STATE-RT-CONTROLS.
  2993         16  SF-ST-RT-CALC                  PIC X.
  2994     12  SF-ST-TAX-CONTROLS.
  2995         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2996         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2997         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2998     12  SF-ST-REFUND-OPTIONS.
  2999         16  SF-ST-RF-LR-CALC               PIC X.
  3000         16  SF-ST-RF-LL-CALC               PIC X.
  3001         16  SF-ST-RF-LN-CALC               PIC X.
  3002         16  SF-ST-RF-AH-CALC               PIC X.
  3003         16  SF-ST-RF-CP-CALC               PIC X.
  3004     12  SF-ST-UNEARN-PREM-OPTIONS.
  3005         16  SF-ST-LUEP-R78                 PIC X.
  3006         16  SF-ST-LUEP-PRO                 PIC X.
  3007         16  SF-ST-LUEP-ST                  PIC X.
  3008         16  SF-ST-LUEP-DOM                 PIC X.
  3009         16  SF-ST-AUEP-R78                 PIC X.
  3010         16  SF-ST-AUEP-PRO                 PIC X.
  3011         16  SF-ST-AUEP-ST                  PIC X.
  3012         16  SF-ST-AUEP-DOM                 PIC X.
  3013         16  SF-ST-CUEP-R78                 PIC X.
  3014         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  57
* EL050.cbl
  3015         16  SF-ST-CUEP-ST                  PIC X.
  3016         16  SF-ST-CUEP-DOM                 PIC X.
  3017     12  SF-ST-EARN-PREM-OPTIONS.
  3018         16  SF-ST-LEP-R78                  PIC X.
  3019         16  SF-ST-LEP-PRO                  PIC X.
  3020         16  SF-ST-LEP-ST                   PIC X.
  3021         16  SF-ST-LEP-DOM                  PIC X.
  3022         16  SF-ST-AEP-R78                  PIC X.
  3023         16  SF-ST-AEP-PRO                  PIC X.
  3024         16  SF-ST-AEP-ST                   PIC X.
  3025         16  SF-ST-AEP-DOM                  PIC X.
  3026         16  SF-ST-CEP-R78                  PIC X.
  3027         16  SF-ST-CEP-PRO                  PIC X.
  3028         16  SF-ST-CEP-ST                   PIC X.
  3029         16  SF-ST-CEP-DOM                  PIC X.
  3030     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  58
* EL050.cbl
  3032*    COPY ELCCRTT.
  3033******************************************************************
  3034*                                                                *
  3035*                            ELCCRTT.                            *
  3036*                                                                *
  3037*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3038*                                                                *
  3039*   FILE TYPE = VSAM,KSDS                                        *
  3040*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3041*                                                                *
  3042*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3043*                                                                *
  3044*   LOG = YES                                                    *
  3045*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3046******************************************************************
  3047*                   C H A N G E   L O G
  3048*
  3049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3050*-----------------------------------------------------------------
  3051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3052* EFFECTIVE    NUMBER
  3053*-----------------------------------------------------------------
  3054* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3055* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3056* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3057* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3058* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3059* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3060* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3061* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3062* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3063* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3064******************************************************************
  3065
  3066 01  CERTIFICATE-TRAILERS.
  3067     12  CS-RECORD-ID                      PIC XX.
  3068         88  VALID-CS-ID                      VALUE 'CS'.
  3069
  3070     12  CS-CONTROL-PRIMARY.
  3071         16  CS-COMPANY-CD                 PIC X.
  3072         16  CS-CARRIER                    PIC X.
  3073         16  CS-GROUPING                   PIC X(6).
  3074         16  CS-STATE                      PIC XX.
  3075         16  CS-ACCOUNT                    PIC X(10).
  3076         16  CS-CERT-EFF-DT                PIC XX.
  3077         16  CS-CERT-NO.
  3078             20  CS-CERT-PRIME             PIC X(10).
  3079             20  CS-CERT-SFX               PIC X.
  3080         16  CS-TRAILER-TYPE               PIC X.
  3081             88  COMM-TRLR           VALUE 'A'.
  3082             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3083             88  CERT-DATA-TRLR      VALUE 'C'.
  3084
  3085     12  CS-DATA-AREA                      PIC X(516).
  3086
  3087     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3088         16  CS-BANK-COMMISSION-AREA.
  3089             20  CS-BANK-COMMS       OCCURS 10.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  59
* EL050.cbl
  3090                 24  CS-AGT                PIC X(10).
  3091                 24  CS-COM-TYP            PIC X.
  3092                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3093                 24  CS-RECALC-LV-INDIC    PIC X.
  3094                 24  FILLER                PIC X(10).
  3095         16  FILLER                        PIC X(256).
  3096
  3097     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3098****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3099         16  CS-MB-CLAIM-DATA OCCURS 24.
  3100             20  CS-CLAIM-NO               PIC X(7).
  3101             20  CS-CLAIM-TYPE             PIC X.
  3102                 88  CS-AH-CLM               VALUE 'A'.
  3103                 88  CS-IU-CLM               VALUE 'I'.
  3104                 88  CS-GP-CLM               VALUE 'G'.
  3105                 88  CS-LF-CLM               VALUE 'L'.
  3106                 88  CS-PR-CLM               VALUE 'P'.
  3107                 88  CS-FL-CLM               VALUE 'F'.
  3108             20  CS-INSURED-TYPE           PIC X.
  3109                 88  CS-PRIM-INSURED          VALUE 'P'.
  3110                 88  CS-CO-BORROWER           VALUE 'C'.
  3111             20  CS-BENEFIT-PERIOD         PIC 99.
  3112             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3113             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3114             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3115         16  FILLER                        PIC X(12).
  3116     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3117         16  CS-VIN-NUMBER                 PIC X(17).
  3118         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3119         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3120         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3121         16  cs-agent-name.
  3122             20  cs-agent-fname            pic x(20).
  3123             20  cs-agent-mi               pic x.
  3124             20  cs-agent-lname            pic x(25).
  3125         16  cs-license-no                 pic x(15).
  3126         16  cs-npn-number                 pic x(10).
  3127         16  cs-agent-edit-status          pic x.
  3128             88  cs-ae-refer-to-manager      value 'M'.
  3129             88  cs-ae-cover-sheet           value 'C'.
  3130             88  cs-ae-sig-form              value 'S'.
  3131             88  cs-ae-verified              value 'V'.
  3132             88  cs-unidentified-signature   value 'U'.
  3133             88  cs-cert-returned            value 'R'.
  3134             88  cs-accept-no-commission     value 'N'.
  3135         16  cs-year                       pic 9999.
  3136         16  cs-make                       pic x(20).
  3137         16  cs-model                      pic x(20).
  3138         16  cs-future                     pic x(20).
  3139         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3140         16  cs-claim-verification-status  pic x.
  3141             88  cs-clm-ver-eligible         value 'A'.
  3142             88  cs-clm-ver-partial-elig     value 'B'.
  3143             88  cs-clm-ver-not-eligible     value 'C'.
  3144             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3145             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3146             88  cs-clm-ver-ND-CERT          value 'F'.
  3147             88  cs-clm-ver-spec-other       value 'G'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  60
* EL050.cbl
  3148             88  cs-clam-ver-pratial-corrected
  3149                                             value 'H'.
  3150             88  cs-clm-ver-no-matches       value 'I'.
  3151             88  cs-clm-ver-not-elig-corrected
  3152                                             value 'J'.
  3153             88  cs-clm-ver-needs-review     value 'R'.
  3154             88  cs-clm-ver-sent-to-claims   value 'W'.
  3155         16  FILLER                        PIC X(355). *> was 420
  3156*        16  FILLER                        PIC X(496).
  3157*    COPY ELCCRTO.
  3158******************************************************************
  3159*                                                                *
  3160*                            ELCCRTO.                            *
  3161*                                                                *
  3162*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3163*                                                                *
  3164*   FILE TYPE = VSAM,KSDS                                        *
  3165*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3166*                                                                *
  3167*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3168*                                                                *
  3169*   LOG = YES                                                    *
  3170*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3171******************************************************************
  3172*                   C H A N G E   L O G
  3173*
  3174* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3175*-----------------------------------------------------------------
  3176*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3177* EFFECTIVE    NUMBER
  3178*-----------------------------------------------------------------
  3179* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3180* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3181* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3182* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3183* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3184******************************************************************
  3185 01  ORIGINAL-CERTIFICATE.
  3186     12  OC-RECORD-ID                      PIC XX.
  3187         88  VALID-OC-ID                      VALUE 'OC'.
  3188     12  OC-CONTROL-PRIMARY.
  3189         16  OC-COMPANY-CD                 PIC X.
  3190         16  OC-CARRIER                    PIC X.
  3191         16  OC-GROUPING                   PIC X(6).
  3192         16  OC-STATE                      PIC XX.
  3193         16  OC-ACCOUNT                    PIC X(10).
  3194         16  OC-CERT-EFF-DT                PIC XX.
  3195         16  OC-CERT-NO.
  3196             20  OC-CERT-PRIME             PIC X(10).
  3197             20  OC-CERT-SFX               PIC X.
  3198         16  OC-RECORD-TYPE                PIC X.
  3199         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3200     12  OC-LAST-MAINT-DT                  PIC XX.
  3201     12  OC-LAST-MAINT-BY                  PIC X(4).
  3202     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3203     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3204     12  FILLER                            PIC X(49).
  3205     12  OC-ORIG-REC.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  61
* EL050.cbl
  3206         16  OC-INS-LAST-NAME              PIC X(15).
  3207         16  OC-INS-FIRST-NAME             PIC X(10).
  3208         16  OC-INS-MIDDLE-INIT            PIC X.
  3209         16  OC-INS-AGE                    PIC S999     COMP-3.
  3210         16  OC-JNT-LAST-NAME              PIC X(15).
  3211         16  OC-JNT-FIRST-NAME             PIC X(10).
  3212         16  OC-JNT-MIDDLE-INIT            PIC X.
  3213         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3214         16  OC-LF-BENCD                   PIC XX.
  3215         16  OC-LF-TERM                    PIC S999      COMP-3.
  3216         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3217         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3218         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3219         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3220         16  OC-LF-EXP-DT                  PIC XX.
  3221         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3222         16  OC-LF-CANCEL-DT               PIC XX.
  3223         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3224         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3225         16  OC-AH-BENCD                   PIC XX.
  3226         16  OC-AH-TERM                    PIC S999      COMP-3.
  3227         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3228         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3229         16  OC-AH-EXP-DT                  PIC XX.
  3230         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3231         16  OC-AH-CP                      PIC 99.
  3232         16  OC-AH-CANCEL-DT               PIC XX.
  3233         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3234         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3235         16  OC-CRED-BENE-NAME             PIC X(25).
  3236         16  OC-1ST-PMT-DT                 PIC XX.
  3237         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3238         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3239         16  OC-ISSUE-TRAN-IND             PIC X.
  3240         16  OC-CANCEL-TRAN-IND            PIC X.
  3241         16  FILLER                        PIC X(211).
  3242
  3243     12  FILLER                            PIC X(50).
  3244******************************************************************
  3245
  3246*    COPY ELCDATE.
  3247******************************************************************
  3248*                                                                *
  3249*                                                                *
  3250*                            ELCDATE.                            *
  3251*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3252*                            VMOD=2.003
  3253*                                                                *
  3254*                                                                *
  3255*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3256*                 LENGTH = 200                                   *
  3257******************************************************************
  3258
  3259 01  DATE-CONVERSION-DATA.
  3260     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3261     12  DC-OPTION-CODE                PIC X.
  3262         88  BIN-TO-GREG                VALUE ' '.
  3263         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  62
* EL050.cbl
  3264         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3265         88  YMD-GREG-TO-BIN            VALUE '3'.
  3266         88  MDY-GREG-TO-BIN            VALUE '4'.
  3267         88  JULIAN-TO-BIN              VALUE '5'.
  3268         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3269         88  FIND-CENTURY               VALUE '7'.
  3270         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3271         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3272         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3273         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3274         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3275         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3276         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3277         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3278         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3279         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3280         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3281         88  BIN-3-TO-GREG              VALUE 'I'.
  3282         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3283         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3284         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3285         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3286         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3287         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3288         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3289         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3290         88  THREE-CHARACTER-BIN
  3291                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3292         88  GREGORIAN-TO-BIN
  3293                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3294         88  BIN-TO-GREGORIAN
  3295                  VALUES ' ' '1' 'I' '8' 'G'.
  3296         88  JULIAN-TO-BINARY
  3297                  VALUES '5' 'C' 'E' 'F'.
  3298     12  DC-ERROR-CODE                 PIC X.
  3299         88  NO-CONVERSION-ERROR        VALUE ' '.
  3300         88  DATE-CONVERSION-ERROR
  3301                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3302         88  DATE-IS-ZERO               VALUE '1'.
  3303         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3304         88  DATE-IS-INVALID            VALUE '3'.
  3305         88  DATE1-GREATER-DATE2        VALUE '4'.
  3306         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3307         88  DATE-INVALID-OPTION        VALUE '9'.
  3308         88  INVALID-CENTURY            VALUE 'A'.
  3309         88  ONLY-CENTURY               VALUE 'B'.
  3310         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3311         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3312     12  DC-END-OF-MONTH               PIC X.
  3313         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3314     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3315         88  USE-NORMAL-PROCESS         VALUE ' '.
  3316         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3317         88  ADJUST-UP-100-YRS          VALUE '2'.
  3318     12  FILLER                        PIC X.
  3319     12  DC-CONVERSION-DATES.
  3320         16  DC-BIN-DATE-1             PIC XX.
  3321         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  63
* EL050.cbl
  3322         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3323         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3324                       DC-GREG-DATE-1-EDIT.
  3325             20  DC-EDIT1-MONTH        PIC 99.
  3326             20  SLASH1-1              PIC X.
  3327             20  DC-EDIT1-DAY          PIC 99.
  3328             20  SLASH1-2              PIC X.
  3329             20  DC-EDIT1-YEAR         PIC 99.
  3330         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3331         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3332                     DC-GREG-DATE-2-EDIT.
  3333             20  DC-EDIT2-MONTH        PIC 99.
  3334             20  SLASH2-1              PIC X.
  3335             20  DC-EDIT2-DAY          PIC 99.
  3336             20  SLASH2-2              PIC X.
  3337             20  DC-EDIT2-YEAR         PIC 99.
  3338         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3339         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3340                     DC-GREG-DATE-1-YMD.
  3341             20  DC-YMD-YEAR           PIC 99.
  3342             20  DC-YMD-MONTH          PIC 99.
  3343             20  DC-YMD-DAY            PIC 99.
  3344         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3345         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3346                      DC-GREG-DATE-1-MDY.
  3347             20  DC-MDY-MONTH          PIC 99.
  3348             20  DC-MDY-DAY            PIC 99.
  3349             20  DC-MDY-YEAR           PIC 99.
  3350         16  DC-GREG-DATE-1-ALPHA.
  3351             20  DC-ALPHA-MONTH        PIC X(10).
  3352             20  DC-ALPHA-DAY          PIC 99.
  3353             20  FILLER                PIC XX.
  3354             20  DC-ALPHA-CENTURY.
  3355                 24 DC-ALPHA-CEN-N     PIC 99.
  3356             20  DC-ALPHA-YEAR         PIC 99.
  3357         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3358         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3359         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3360         16  DC-JULIAN-DATE            PIC 9(05).
  3361         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3362                                       PIC 9(05).
  3363         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3364             20  DC-JULIAN-YEAR        PIC 99.
  3365             20  DC-JULIAN-DAYS        PIC 999.
  3366         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3367         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3368         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3369     12  DATE-CONVERSION-VARIBLES.
  3370         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3371         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3372             20  FILLER                PIC 9(3).
  3373             20  HOLD-CEN-1-CCYY.
  3374                 24  HOLD-CEN-1-CC     PIC 99.
  3375                 24  HOLD-CEN-1-YY     PIC 99.
  3376             20  HOLD-CEN-1-MO         PIC 99.
  3377             20  HOLD-CEN-1-DA         PIC 99.
  3378         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3379             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  64
* EL050.cbl
  3380             20  HOLD-CEN-1-R-DA       PIC 99.
  3381             20  HOLD-CEN-1-R-CCYY.
  3382                 24  HOLD-CEN-1-R-CC   PIC 99.
  3383                 24  HOLD-CEN-1-R-YY   PIC 99.
  3384             20  FILLER                PIC 9(3).
  3385         16  HOLD-CENTURY-1-X.
  3386             20  FILLER                PIC X(3)  VALUE SPACES.
  3387             20  HOLD-CEN-1-X-CCYY.
  3388                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3389                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3390             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3391             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3392         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3393             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3394             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3395             20  HOLD-CEN-1-R-X-CCYY.
  3396                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3397                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3398             20  FILLER                PIC XXX.
  3399         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3400         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3401         16  DC-JULIAN-DATE-1          PIC 9(07).
  3402         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3403             20  DC-JULIAN-1-CCYY.
  3404                 24  DC-JULIAN-1-CC    PIC 99.
  3405                 24  DC-JULIAN-1-YR    PIC 99.
  3406             20  DC-JULIAN-DA-1        PIC 999.
  3407         16  DC-JULIAN-DATE-2          PIC 9(07).
  3408         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3409             20  DC-JULIAN-2-CCYY.
  3410                 24  DC-JULIAN-2-CC    PIC 99.
  3411                 24  DC-JULIAN-2-YR    PIC 99.
  3412             20  DC-JULIAN-DA-2        PIC 999.
  3413         16  DC-GREG-DATE-A-EDIT.
  3414             20  DC-EDITA-MONTH        PIC 99.
  3415             20  SLASHA-1              PIC X VALUE '/'.
  3416             20  DC-EDITA-DAY          PIC 99.
  3417             20  SLASHA-2              PIC X VALUE '/'.
  3418             20  DC-EDITA-CCYY.
  3419                 24  DC-EDITA-CENT     PIC 99.
  3420                 24  DC-EDITA-YEAR     PIC 99.
  3421         16  DC-GREG-DATE-B-EDIT.
  3422             20  DC-EDITB-MONTH        PIC 99.
  3423             20  SLASHB-1              PIC X VALUE '/'.
  3424             20  DC-EDITB-DAY          PIC 99.
  3425             20  SLASHB-2              PIC X VALUE '/'.
  3426             20  DC-EDITB-CCYY.
  3427                 24  DC-EDITB-CENT     PIC 99.
  3428                 24  DC-EDITB-YEAR     PIC 99.
  3429         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3430         16  DC-GREG-DATE-CYMD-R REDEFINES
  3431                              DC-GREG-DATE-CYMD.
  3432             20  DC-CYMD-CEN           PIC 99.
  3433             20  DC-CYMD-YEAR          PIC 99.
  3434             20  DC-CYMD-MONTH         PIC 99.
  3435             20  DC-CYMD-DAY           PIC 99.
  3436         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3437         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  65
* EL050.cbl
  3438                              DC-GREG-DATE-MDCY.
  3439             20  DC-MDCY-MONTH         PIC 99.
  3440             20  DC-MDCY-DAY           PIC 99.
  3441             20  DC-MDCY-CEN           PIC 99.
  3442             20  DC-MDCY-YEAR          PIC 99.
  3443    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3444        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3445    12  DC-EL310-DATE                  PIC X(21).
  3446    12  FILLER                         PIC X(28).
  3447
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  66
* EL050.cbl
  3449*    COPY ELCCALC.
  3450******************************************************************
  3451*                                                                *
  3452*                           ELCCALC.                            *
  3453*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3454*                            VMOD=2.025                          *
  3455*                                                                *
  3456*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3457*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3458*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3459*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3460*                                                                *
  3461*  PASSED TO ELRTRM                                              *
  3462*  -----------------                                             *
  3463*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3464*  ORIGINAL TERM                                                 *
  3465*  BEGINNING DATE                                                *
  3466*  ENDING DATE                                                   *
  3467*  COMPANY I.D.                                                  *
  3468*  ACCOUNT MASTER USER FIELD                                     *
  3469*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3470*  FREE LOOK DAYS                                                *
  3471*                                                                *
  3472*  RETURNED FROM ELRTRM                                          *
  3473*  ---------------------                                         *
  3474*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3475*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3476*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3477*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3478*----------------------------------------------------------------*
  3479*  PASSED TO ELRAMT                                              *
  3480*  ----------------                                              *
  3481*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3482*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3483*  ORIGINAL AMOUNT                                               *
  3484*  ALTERNATE BENEFIT (BALLON)                                    *
  3485*  A.P.R. - NET PAY ONLY                                         *
  3486*  METHOD
  3487*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3488*  COMPANY I.D.                                                  *
  3489*  BENEFIT TYPE                                                  *
  3490*                                                                *
  3491*  RETURNED FROM ELRAMT                                          *
  3492*  --------------------                                          *
  3493*  REMAINING AMOUNT 1 - CURRENT                                  *
  3494*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3495*  REMAINING AMOUNT FACTOR
  3496*----------------------------------------------------------------*
  3497*  PASSED TO ELRESV                                              *
  3498*  -----------------                                             *
  3499*  CERTIFICATE EFFECTIVE DATE                                    *
  3500*  VALUATION DATE                                                *
  3501*  PAID THRU DATE                                                *
  3502*  BENEFIT                                                       *
  3503*  INCURRED DATE                                                 *
  3504*  REPORTED DATE                                                 *
  3505*  ISSUE AGE                                                     *
  3506*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  67
* EL050.cbl
  3507*  CDT PERCENT                                                   *
  3508*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3509* *CLAIM TYPE (LIFE, A/H)                                        *
  3510* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3511* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3512*                                                                *
  3513*  RETURNED FROM ELRESV                                          *
  3514*  --------------------                                          *
  3515*  CDT TABLE USED                                                *
  3516*  CDT FACTOR USED                                               *
  3517*  PAY TO CURRENT RESERVE                                        *
  3518*  I.B.N.R. - A/H ONLY                                           *
  3519*  FUTURE (ACCRUED) AH ONLY                                      *
  3520*----------------------------------------------------------------*
  3521*  PASSED TO ELRATE                                              *
  3522*  ----------------                                              *
  3523*  CERT ISSUE DATE                                               *
  3524*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3525*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3526*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3527*  STATE CODE (CLIENT DEFINED)                                   *
  3528*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3529*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3530*  DEVIATION CODE                                                *
  3531*  ISSUE AGE                                                     *
  3532*  ORIGINAL BENEFIT AMOUNT                                       *
  3533*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3534*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3535*  BENEFIT KIND (LIFE OR A/H)                                    *
  3536*  A.P.R.                                                        *
  3537*  METHOD
  3538*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3539*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3540*  COMPANY I.D. (3 CHARACTER)                                    *
  3541*  BENEFIT CODE                                                  *
  3542*  BENEFIT OVERRIDE CODE                                         *
  3543*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3544*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3545*  JOINT INDICATOR (CSL ONLY)                                    *
  3546*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3547*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3548*                                                                *
  3549*  RETURNED FROM ELRATE                                          *
  3550*  --------------------                                          *
  3551*  CALCULATED PREMIUM                                            *
  3552*  PREMIUM RATE                                                  *
  3553*  MORTALITY CODE                                                *
  3554*  MAX ATTAINED AGE                                              *
  3555*  MAX AGE                                                       *
  3556*  MAX TERM                                                      *
  3557*  MAX MONTHLY BENEFIT                                           *
  3558*  MAX TOTAL BENIFIT                                             *
  3559*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3560*----------------------------------------------------------------*
  3561*  PASSED TO ELRFND                                              *
  3562*  ----------------                                              *
  3563*  CERT ISSUE DATE                                               *
  3564*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  68
* EL050.cbl
  3565*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3566*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3567*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3568*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3569*  STATE CODE (CLIENT DEFINED)                                   *
  3570*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3571*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3572*  DEVIATION CODE                                                *
  3573*  ISSUE AGE                                                     *
  3574*  ORIGINAL BENEFIT AMOUNT                                       *
  3575*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3576*  PROCESS TYPE (CANCEL)                                         *
  3577*  BENEFIT KIND (LIFE OR A/H)                                    *
  3578*  A.P.R.                                                        *
  3579*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3580*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3581*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3582*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3583*  COMPANY I.D. (3 CHARACTER)                                    *
  3584*  BENEFIT CODE                                                  *
  3585*  BENEFIT OVERRIDE CODE                                         *
  3586*                                                                *
  3587*  RETURNED FROM ELRFND                                          *
  3588*  --------------------                                          *
  3589*  CALCULATED REFUND                                             *
  3590*----------------------------------------------------------------*
  3591*  PASSED TO ELEARN                                              *
  3592*  ----------------                                              *
  3593*  CERT ISSUE DATE                                               *
  3594*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3595*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3596*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3597*  STATE CODE (CLIENT DEFINED)                                   *
  3598*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3599*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3600*  DEVIATION CODE                                                *
  3601*  ISSUE AGE                                                     *
  3602*  ORIGINAL BENEFIT AMOUNT                                       *
  3603*  BENEFIT KIND (LIFE OR A/H)                                    *
  3604*  A.P.R.                                                        *
  3605*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3606*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3607*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3608*  COMPANY I.D. (3 CHARACTER)                                    *
  3609*  BENEFIT CODE                                                  *
  3610*  BENEFIT OVERRIDE CODE                                         *
  3611*                                                                *
  3612*  RETURNED FROM ELEARN                                          *
  3613*  --------------------                                          *
  3614*  INDICATED  EARNINGS                                           *
  3615*----------------------------------------------------------------*
  3616*                 LENGTH = 450                                   *
  3617*                                                                *
  3618******************************************************************
  3619******************************************************************
  3620*                   C H A N G E   L O G
  3621*
  3622* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  69
* EL050.cbl
  3623*-----------------------------------------------------------------
  3624*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3625* EFFECTIVE    NUMBER
  3626*-----------------------------------------------------------------
  3627* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3628* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3629* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3630* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3631* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3632* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3633* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3634* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3635* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3636* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3637* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3638******************************************************************
  3639
  3640 01  CALCULATION-PASS-AREA.
  3641     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3642                                     COMP.
  3643
  3644     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3645       88  NO-CP-ERROR                             VALUE ZERO.
  3646       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3647                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3648       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3649       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3650       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3651       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3652       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3653       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3654       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3655       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3656       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3657       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3658       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3659       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3660       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3661       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3662       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3663       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3664       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3665
  3666     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3667       88  NO-CP-ERROR-2                           VALUE ZERO.
  3668***********************  INPUT AREAS ****************************
  3669
  3670     12  CP-CALCULATION-AREA.
  3671         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3672         16  CP-CERT-EFF-DT        PIC XX.
  3673         16  CP-VALUATION-DT       PIC XX.
  3674         16  CP-PAID-THRU-DT       PIC XX.
  3675         16  CP-BENEFIT-TYPE       PIC X.
  3676           88  CP-AH                               VALUE 'A' 'D'
  3677                                                   'I' 'U'.
  3678           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3679           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3680         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  70
* EL050.cbl
  3681         16  CP-REPORTED-DT        PIC XX.
  3682         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3683         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3684         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3685                                     COMP-3.
  3686         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3687                                     COMP-3.
  3688         16  CP-CDT-METHOD         PIC X.
  3689           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3690           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3691           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3692         16  CP-CLAIM-TYPE         PIC X.
  3693           88  CP-AH-CLAIM                         VALUE 'A'.
  3694           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3695         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3698                                     COMP-3.
  3699         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3702                                     COMP-3.
  3703         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3704                                     COMP-3.
  3705         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3706                                     COMP-3.
  3707         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-REM-TERM-METHOD    PIC X.
  3710           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3711           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3712           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3713           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3714           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3715           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3716           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3717         16  CP-EARNING-METHOD     PIC X.
  3718           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3719           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3720           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3721           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3722           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3723           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3724           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3725           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3726           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3727           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3728           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3729           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3730           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3731           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3732         16  CP-PROCESS-TYPE       PIC X.
  3733           88  CP-CLAIM                            VALUE '1'.
  3734           88  CP-CANCEL                           VALUE '2'.
  3735           88  CP-ISSUE                            VALUE '3'.
  3736         16  CP-SPECIAL-CALC-CD    PIC X.
  3737           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3738           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  71
* EL050.cbl
  3739           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3740           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3741           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3742           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3743           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3744           88  CP-FARM-PLAN                    VALUE 'F'.
  3745           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3746           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3747           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3748           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3749           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3750           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3751           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3752           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3753           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3754           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3755                                                     'W' 'X'.
  3756           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3757           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3758           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3759           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3760           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3761           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3762           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3763           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3764           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3765           88  CP-CSL-METH-1                   VALUE '5'.
  3766           88  CP-CSL-METH-2                   VALUE '6'.
  3767           88  CP-CSL-METH-3                   VALUE '7'.
  3768           88  CP-CSL-METH-4                   VALUE '8'.
  3769
  3770         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3771                                     COMP-3.
  3772         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3773         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3774         16  CP-STATE              PIC XX          VALUE SPACE.
  3775         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3776         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3777           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3778               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3779         16  CP-R78-OPTION         PIC X.
  3780           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3781           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3782
  3783         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3784         16  CP-IBNR-RESERVE-SW    PIC X.
  3785         16  CP-CLAIM-STATUS       PIC X.
  3786         16  CP-RATE-FILE          PIC X.
  3787         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3788                                     COMP-3.
  3789
  3790         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3791         16  CP-AH-OVERRIDE-CODE   PIC X.
  3792
  3793         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3794                                     COMP-3.
  3795         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3796                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  72
* EL050.cbl
  3797         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3798                                     COMP-3.
  3799         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3804                                  PIC S9(7)V99 COMP-3.
  3805
  3806         16  CP-PAID-FROM-DATE     PIC X(02).
  3807         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3808         16  CP-EXT-DAYS-CALC      PIC X.
  3809           88  CP-EXT-NO-CHG                   VALUE ' '.
  3810           88  CP-EXT-CHG-LF                   VALUE '1'.
  3811           88  CP-EXT-CHG-AH                   VALUE '2'.
  3812           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3813         16  CP-DOMICILE-STATE     PIC XX.
  3814         16  CP-CARRIER            PIC X.
  3815         16  CP-REIN-FLAG          PIC X.
  3816         16  CP-REM-TRM-CALC-OPTION PIC X.
  3817           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3818                      '2' '3' '4' '5'.
  3819           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3820           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3821           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3822           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3823           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3824           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3825           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3826           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3827         16  CP-SIG-SWITCH         PIC X.
  3828         16  CP-RATING-METHOD      PIC X.
  3829           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3830           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3831           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3832           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3833           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3834           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3835           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3836           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3837           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3838         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3839                                     COMP-3.
  3840         16  CP-BEN-CATEGORY       PIC X.
  3841         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3842         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3843                                   PIC S99V9(5) COMP-3.
  3844         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3845         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3846                                   PIC S99V9(5) COMP-3.
  3847         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3848         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3849         16  CP-EXPIRE-DT          PIC XX.
  3850         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3851         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3852         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3853         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3854         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  73
* EL050.cbl
  3855             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3856             88  CP-CALC-CLP              VALUE 'C'.
  3857         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3858         16  CP-CANCEL-REASON      PIC X.
  3859         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3860         16  CP-PMT-MODE           PIC X.
  3861         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3862         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3863         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3864         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3865         16  FILLER                PIC X.
  3866
  3867***************    OUTPUT FROM ELRESV   ************************
  3868
  3869         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3870
  3871         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3872                                     COMP-3.
  3873         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3876                                     COMP-3.
  3877         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3878                                     COMP-3.
  3879         16  FILLER                PIC X(09).
  3880***************    OUTPUT FROM ELRTRM   *************************
  3881
  3882         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3883                                     COMP-3.
  3884         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3885                                     COMP-3.
  3886         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3887                                     COMP-3.
  3888         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3889                                     COMP-3.
  3890         16  FILLER                PIC X(12).
  3891
  3892***************    OUTPUT FROM ELRAMT   *************************
  3893
  3894         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3895                                     COMP-3.
  3896         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3897                                     COMP-3.
  3898         16  FILLER                PIC X(12).
  3899
  3900***************    OUTPUT FROM ELRATE   *************************
  3901
  3902         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3903                                     COMP-3.
  3904         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3905                                     COMP-3.
  3906         16  CP-MORTALITY-CODE     PIC X(4).
  3907         16  CP-RATE-EDIT-FLAG     PIC X.
  3908             88  CP-RATES-NEED-APR                  VALUE '1'.
  3909         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3912         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  74
* EL050.cbl
  3913         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3914                                   PIC S9(7)V99 COMP-3.
  3915         16  FILLER                PIC X(07).
  3916
  3917***************    OUTPUT FROM ELRFND   *************************
  3918
  3919         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3920                                     COMP-3.
  3921         16  CP-REFUND-TYPE-USED   PIC X.
  3922           88  CP-R-AS-R78                         VALUE '1'.
  3923           88  CP-R-AS-PRORATA                     VALUE '2'.
  3924           88  CP-R-AS-CALIF                       VALUE '3'.
  3925           88  CP-R-AS-TEXAS                       VALUE '4'.
  3926           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3927           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3928           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3929           88  CP-R-AS-MEAN                        VALUE '8'.
  3930           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3931           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3932           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3933           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3934           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3935           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3936         16  FILLER                PIC X(12).
  3937
  3938***************    OUTPUT FROM ELEARN   *************************
  3939
  3940         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3943                                     COMP-3.
  3944         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3945                                     COMP-3.
  3946         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3947                                     COMP-3.
  3948         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3949                                     COMP-3.
  3950         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3951                                     COMP-3.
  3952         16  CP-EARNING-TYPE-USED  PIC X.
  3953           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3954           88  CP-E-AS-R78                         VALUE '1'.
  3955           88  CP-E-AS-PRORATA                     VALUE '2'.
  3956           88  CP-E-AS-TEXAS                       VALUE '4'.
  3957           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3958           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3959           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3960           88  CP-E-AS-MEAN                        VALUE '8'.
  3961           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3962         16  FILLER                PIC X(12).
  3963
  3964***************    OUTPUT FROM ELPMNT   *************************
  3965
  3966         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3967                                     COMP-3.
  3968         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3969                                     COMP-3.
  3970         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  75
* EL050.cbl
  3971
  3972***************   MISC WORK AREAS    *****************************
  3973         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3974                                     COMP-3.
  3975         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3976                                     COMP-3.
  3977         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3978                                     COMP-3.
  3979         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3980                                     COMP-3.
  3981         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3982                                     COMP-3.
  3983         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3984                                     COMP-3.
  3985         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3986             88  OPEN-RATE-FILE                   VALUE 'O'.
  3987             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3988             88  IO-ERROR                         VALUE 'E'.
  3989
  3990         16  CP-FIRST-PAY-DATE     PIC XX.
  3991
  3992         16  CP-JOINT-INDICATOR    PIC X.
  3993
  3994         16  CP-RESERVE-REMAINING-TERM
  3995                                   PIC S9(4)V9    VALUE ZERO
  3996                                     COMP-3.
  3997
  3998         16  CP-INSURED-BIRTH-DT   PIC XX.
  3999
  4000         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4001                                     COMP-3.
  4002
  4003         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4004                                     COMP-3.
  4005
  4006         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4007                                     COMP-3.
  4008
  4009         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4010                                     COMP-3.
  4011
  4012         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4013                                     COMP-3.
  4014
  4015         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4016                                     COMP-3.
  4017
  4018         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4019                                     COMP-3.
  4020
  4021         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4022             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4023
  4024         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4025                                     COMP-3.
  4026         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4027                                     COMP-3.
  4028         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  76
* EL050.cbl
  4029         16  cp-extra-periods      pic 9 value zeros.
  4030         16  cp-net-only-state     pic x value spaces.
  4031         16  FILLER                PIC X(13).
  4032******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  77
* EL050.cbl
  4034******************************************************************
  4035*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4036*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4037*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4038*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4039*** MODIFICATION.                                              ***
  4040*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4041*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4042******************************************************************
  4043*    COPY ERCPNDB.
  4044******************************************************************
  4045*                                                                *
  4046*                                                                *
  4047*                            ERCPNDB.                            *
  4048*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4049*                            VMOD=2.025                          *
  4050*                                                                *
  4051*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4052*                                                                *
  4053******************************************************************
  4054*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4055*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4056******************************************************************
  4057*                                                                *
  4058*                                                                *
  4059*   FILE TYPE = VSAM,KSDS                                        *
  4060*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4061*                                                                *
  4062*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4063*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4064*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4065*                                                 RKP=13,LEN=36  *
  4066*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4067*                                      AND CHG-SEQ.)             *
  4068*                                                RKP=49,LEN=11   *
  4069*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4070*                                      AND CHG-SEQ.)             *
  4071*                                                RKP=60,LEN=15   *
  4072*                                                                *
  4073*   LOG = NO                                                     *
  4074*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4075******************************************************************
  4076******************************************************************
  4077*                   C H A N G E   L O G
  4078*
  4079* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4080*-----------------------------------------------------------------
  4081*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4082* EFFECTIVE    NUMBER
  4083*-----------------------------------------------------------------
  4084* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4085* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4086* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4087* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4088* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4089* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4090* 032306                   PEMA  ADD BOW LOAN NUMBER
  4091* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  78
* EL050.cbl
  4092* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4093* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4094* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4095* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4096* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4097* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4098* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4099* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4100* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4101* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4102* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4103******************************************************************
  4104
  4105 01  PENDING-BUSINESS.
  4106     12  PB-RECORD-ID                     PIC XX.
  4107         88  VALID-PB-ID                        VALUE 'PB'.
  4108
  4109     12  PB-CONTROL-PRIMARY.
  4110         16  PB-COMPANY-CD                PIC X.
  4111         16  PB-ENTRY-BATCH               PIC X(6).
  4112         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4113         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4114
  4115     12  PB-CONTROL-BY-ACCOUNT.
  4116         16  PB-COMPANY-CD-A1             PIC X.
  4117         16  PB-CARRIER                   PIC X.
  4118         16  PB-GROUPING.
  4119             20  PB-GROUPING-PREFIX       PIC XXX.
  4120             20  PB-GROUPING-PRIME        PIC XXX.
  4121         16  PB-STATE                     PIC XX.
  4122         16  PB-ACCOUNT.
  4123             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4124             20  PB-ACCOUNT-PRIME         PIC X(6).
  4125         16  PB-CERT-EFF-DT               PIC XX.
  4126         16  PB-CERT-NO.
  4127             20  PB-CERT-PRIME            PIC X(10).
  4128             20  PB-CERT-SFX              PIC X.
  4129         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4130
  4131         16  PB-RECORD-TYPE               PIC X.
  4132             88  PB-MAILING-DATA                VALUE '0'.
  4133             88  PB-ISSUE                       VALUE '1'.
  4134             88  PB-CANCELLATION                VALUE '2'.
  4135             88  PB-BATCH-TRAILER               VALUE '9'.
  4136
  4137     12  PB-CONTROL-BY-ORIG-BATCH.
  4138         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4139         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4140         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4141         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4142
  4143     12  PB-CONTROL-BY-CSR.
  4144         16  PB-CSR-COMPANY-CD            PIC X.
  4145         16  PB-CSR-ID                    PIC X(4).
  4146         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4147         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4148         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4149******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  79
* EL050.cbl
  4150*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4151******************************************************************
  4152
  4153     12  PB-LAST-MAINT-DT                 PIC XX.
  4154     12  PB-LAST-MAINT-BY                 PIC X(4).
  4155     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4156
  4157     12  PB-RECORD-BODY                   PIC X(375).
  4158
  4159     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4160         16  PB-CERT-ORIGIN               PIC X.
  4161             88  CLASIC-CREATED-CERT         VALUE '1'.
  4162         16  PB-I-NAME.
  4163             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4164             20  PB-I-INSURED-FIRST-NAME.
  4165                 24  PB-I-INSURED-1ST-INIT PIC X.
  4166                 24  FILLER                PIC X(9).
  4167             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4168         16  PB-I-AGE                     PIC S99   COMP-3.
  4169         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4170         16  PB-I-BIRTHDAY                PIC XX.
  4171         16  PB-I-INSURED-SEX             PIC X.
  4172             88  PB-SEX-MALE     VALUE 'M'.
  4173             88  PB-SEX-FEMALE   VALUE 'F'.
  4174
  4175         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4176         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4177         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4178         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4179         16  PB-I-SKIP-CODE               PIC X.
  4180             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4181             88  PB-SKIP-JULY              VALUE '1'.
  4182             88  PB-SKIP-AUGUST            VALUE '2'.
  4183             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4184             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4185             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4186             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4187             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4188             88  PB-SKIP-JUNE              VALUE '8'.
  4189             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4190             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4191             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4192         16  PB-I-TERM-TYPE               PIC X.
  4193             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4194             88  PB-PAID-WEEKLY            VALUE 'W'.
  4195             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4196             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4197             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4198         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4199         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4200         16  PB-I-DATA-ENTRY-SW           PIC X.
  4201             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4202             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4203             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4204             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4205         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4206         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4207*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  80
* EL050.cbl
  4208         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4209         16  FILLER                       PIC X.
  4210
  4211         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4212             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4213             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4214                                                   '90' THRU '99'.
  4215         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4216                                          PIC XX.
  4217         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4218         16  PB-I-AMOUNT-FINANCED REDEFINES
  4219                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4220         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4221         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4222                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4223         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4224         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4225         16  PB-I-CLP-AMOUNT REDEFINES
  4226                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4227         16  PB-I-LF-CALC-FLAG            PIC X.
  4228             88 PB-COMP-LF-PREM               VALUE '?'.
  4229         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4230         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4231         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4232         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4233         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4234         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4235         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4236         16  PB-I-LF-ABBR                 PIC XXX.
  4237         16  PB-I-LF-INPUT-CD             PIC XX.
  4238
  4239         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4240             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4241             88  PB-INVALID-AH               VALUE '  ' '00'
  4242                                                   '90' THRU '99'.
  4243         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4244         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4245         16  PB-I-AH-CALC-FLAG            PIC X.
  4246             88 PB-COMP-AH-PREM                  VALUE '?'.
  4247         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4248         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4249         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4250         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4251         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4252         16  PB-I-AH-ABBR                 PIC XXX.
  4253         16  PB-I-AH-INPUT-CD             PIC XXX.
  4254
  4255         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4256         16  PB-I-REIN-TABLE              PIC XXX.
  4257         16  PB-I-BUSINESS-TYPE           PIC 99.
  4258         16  PB-I-INDV-GRP-CD             PIC X.
  4259         16  PB-I-MORT-CODE.
  4260             20  PB-I-TABLE               PIC X.
  4261             20  PB-I-INTEREST            PIC XX.
  4262             20  PB-I-MORT-TYP            PIC X.
  4263         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4264         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4265         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  81
* EL050.cbl
  4266         16  PB-I-INDV-GRP-OVRD           PIC X.
  4267         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4268         16  PB-I-SIG-SW                  PIC X.
  4269             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4270         16  PB-I-RATE-CLASS              PIC XX.
  4271         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4272         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4273         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4274         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4275         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4276         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4277         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4278         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4279         16  PB-I-OB-FLAG                 PIC X.
  4280             88  PB-I-OB                      VALUE 'B'.
  4281             88  PB-I-SUMMARY                 VALUE 'Z'.
  4282         16  PB-I-ENTRY-STATUS            PIC X.
  4283             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4284                                              'M' '5' '9' '2'.
  4285             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4286             88  PB-I-POLICY-PENDING          VALUE '2'.
  4287             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4288             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4289             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4290             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4291             88  PB-I-REIN-ONLY               VALUE '9'.
  4292             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4293             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4294             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4295             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4296         16  PB-I-INT-CODE                PIC X.
  4297             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4298             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4299         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4300         16  PB-I-SOC-SEC-NO              PIC X(11).
  4301         16  PB-I-MEMBER-NO               PIC X(12).
  4302         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4303*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4304         16  PB-I-OLD-LOF                 PIC XXX.
  4305         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4306         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4307         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4308         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4309         16  PB-I-LIFE-INDICATOR          PIC X.
  4310             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4311         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4312         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4313                                          PIC S9(5)V99    COMP-3.
  4314         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4315             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4316             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4317         16  PB-I-1ST-PMT-DT              PIC XX.
  4318         16  PB-I-JOINT-INSURED.
  4319             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4320             20 PB-I-JOINT-FIRST-NAME.
  4321                24  PB-I-JOINT-FIRST-INIT PIC X.
  4322                24  FILLER                PIC X(9).
  4323             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  82
* EL050.cbl
  4324*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4325         16  PB-I-BENEFICIARY-NAME.
  4326             20  PB-I-BANK-NUMBER         PIC X(10).
  4327             20  FILLER                   PIC X(15).
  4328         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4329         16  PB-I-REFERENCE               PIC X(12).
  4330         16  FILLER REDEFINES PB-I-REFERENCE.
  4331             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4332             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4333             20  PB-I-CLP-STATE           PIC XX.
  4334         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4335             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4336             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4337             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4338         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4339         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4340         16  PB-I-RESIDENT-STATE          PIC XX.
  4341         16  PB-I-RATE-CODE               PIC X(4).
  4342         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4343         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4344         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4345         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4346         16  PB-I-BANK-NOCHRGB            PIC 99.
  4347         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4348         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4349
  4350     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4351         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4352             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4353         16  PB-C-CANCEL-ORIGIN           PIC X.
  4354             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4355         16  PB-C-LF-CANCEL-DT            PIC XX.
  4356         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4357         16  PB-C-LF-CALC-REQ             PIC X.
  4358             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4359         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4360         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4361         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4362             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4363         16  PB-C-AH-CANCEL-DT            PIC XX.
  4364         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4365         16  PB-C-AH-CALC-REQ             PIC X.
  4366             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4367         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4368         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4369         16  PB-C-LAST-NAME               PIC X(15).
  4370         16  PB-C-REFUND-SW               PIC X.
  4371             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4372             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4373         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4374         16  PB-C-PAYEE-CODE              PIC X(6).
  4375         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4376         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4377         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4378         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4379         16  PB-C-REFERENCE               PIC X(12).
  4380         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4381         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  83
* EL050.cbl
  4382         16  PB-C-POST-CARD-IND           PIC X.
  4383         16  PB-C-CANCEL-REASON           PIC X.
  4384         16  PB-C-REF-INTERFACE-SW        PIC X.
  4385         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4386         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4387         16  FILLER                       PIC X(01).
  4388*        16  FILLER                       PIC X(18).
  4389         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4390*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4391         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4392         16  PB-CANCELED-CERT-DATA.
  4393             20  PB-CI-INSURED-NAME.
  4394                 24  PB-CI-LAST-NAME      PIC X(15).
  4395                 24  PB-CI-INITIALS       PIC XX.
  4396             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4397             20  PB-CI-INSURED-SEX        PIC X.
  4398             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4399             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4400             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4401             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4402             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4403             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4404             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4405             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4406             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4407             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4408             20  PB-CI-RATE-CLASS         PIC XX.
  4409             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4410             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4411             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4412             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4413             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4414             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4415             20  PB-CI-LF-ABBR            PIC X(3).
  4416             20  PB-CI-AH-ABBR            PIC X(3).
  4417             20  PB-CI-OB-FLAG            PIC X.
  4418                 88  PB-CI-OB                VALUE 'B'.
  4419             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4420                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4421                                           'M' '4' '5' '9' '2'.
  4422                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4423                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4424                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4425                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4426                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4427                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4428                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4429                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4430                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4431                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4432                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4433                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4434                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4435             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4436                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4437                                           'M' '4' '5' '9' '2'.
  4438                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4439                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  84
* EL050.cbl
  4440                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4441                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4442                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4443                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4444                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4445                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4446                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4447                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4448                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4449                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4450                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4451             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4452             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4453             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4454             20  PB-CI-MEMBER-NO          PIC X(12).
  4455             20  PB-CI-INT-CODE           PIC X.
  4456                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4457                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4458             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4459             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4460             20  PB-CI-COMP-EXCP-SW       PIC X.
  4461                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4462                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4463             20  PB-CI-ENTRY-STATUS       PIC X.
  4464             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4465             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4466             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4467             20  PB-CI-DEATH-DT           PIC XX.
  4468             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4469             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4470             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4471             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4472             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4473             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4474             20  PB-CI-ENTRY-DT              PIC XX.
  4475             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4476             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4477             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4478             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4479             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4480             20  PB-CI-OLD-LOF               PIC XXX.
  4481*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4482             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4483             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4484             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4485             20  PB-CI-INDV-GRP-CD           PIC X.
  4486             20  PB-CI-BENEFICIARY-NAME.
  4487                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4488                 24  FILLER                  PIC X(15).
  4489             20  PB-CI-NOTE-SW               PIC X.
  4490             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4491             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4492             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4493             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4494             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4495             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4496             20  PB-CI-FIRST-NAME            PIC X(10).
  4497             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  85
* EL050.cbl
  4498
  4499         16  FILLER                       PIC X(13).
  4500*032306  16  FILLER                       PIC X(27).
  4501*        16  FILLER                       PIC X(46).
  4502
  4503     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4504         16  FILLER                       PIC X(10).
  4505         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4506         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4507         16  PB-M-INSURED-MID-INIT        PIC X.
  4508         16  PB-M-INSURED-AGE             PIC 99.
  4509         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4510         16  PB-M-INSURED-SEX             PIC X.
  4511         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4512         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4513         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4514         16  PB-M-INSURED-CITY-STATE.
  4515             20  PB-M-INSURED-CITY        PIC X(28).
  4516             20  PB-M-INSURED-STATE       PIC XX.
  4517         16  PB-M-INSURED-ZIP-CODE.
  4518             20  PB-M-INSURED-ZIP-PRIME.
  4519                 24  PB-M-INSURED-ZIP-1   PIC X.
  4520                     88  PB-M-CANADIAN-POST-CODE
  4521                                             VALUE 'A' THRU 'Z'.
  4522                 24  FILLER               PIC X(4).
  4523             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4524         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4525                                        PB-M-INSURED-ZIP-CODE.
  4526             20  PM-M-INS-CAN-POST1       PIC XXX.
  4527             20  PM-M-INS-CAN-POST2       PIC XXX.
  4528             20  FILLER                   PIC XXX.
  4529         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4530         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4531         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4532         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4533         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4534         16  PB-M-CRED-BENE-CITYST.
  4535             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4536             20  PB-M-CRED-BENE-STATE     PIC XX.
  4537         16  FILLER                       PIC X(92).
  4538
  4539     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4540         16  FILLER                       PIC X(10).
  4541         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4542         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4543         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4544         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4545         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4546         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4547         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4548         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4549         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4550         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4551         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4552         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4553         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4554         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4555         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  86
* EL050.cbl
  4556         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4557         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4558         16  PB-ACCOUNT-NAME              PIC X(30).
  4559         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4560         16  PB-REFERENCE                 PIC X(12).
  4561         16  PB-B-RECEIVED-DT             PIC XX.
  4562         16  FILLER                       PIC X(234).
  4563
  4564     12  PB-RECORD-STATUS.
  4565         16  PB-CREDIT-SELECT-DT          PIC XX.
  4566         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4567         16  PB-BILLED-DT                 PIC XX.
  4568         16  PB-BILLING-STATUS            PIC X.
  4569             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4570             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4571             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4572         16  PB-RECORD-BILL               PIC X.
  4573             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4574             88  PB-RECORD-RETURNED           VALUE 'R'.
  4575             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4576             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4577             88  PB-OVERRIDE-AH               VALUE 'A'.
  4578             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4579         16  PB-BATCH-ENTRY               PIC X.
  4580             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4581             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4582             88  PB-REISSUED-CERT             VALUE 'E'.
  4583             88  PB-CASH-CERT                 VALUE 'C'.
  4584             88  PB-MONTHLY-CERT              VALUE 'M'.
  4585             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4586             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4587             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4588         16  PB-FORCE-CODE                PIC X.
  4589             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4590             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4591             88  PB-CANCEL-FORCE              VALUE '8'.
  4592             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4593             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4594             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4595             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4596             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4597             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4598             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4599             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4600         16  PB-FATAL-FLAG                PIC X.
  4601             88  PB-FATAL-ERRORS              VALUE 'X'.
  4602         16  PB-FORCE-ER-CD               PIC X.
  4603             88  PB-FORCE-ERRORS              VALUE 'F'.
  4604             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4605         16  PB-WARN-ER-CD                PIC X.
  4606             88  PB-WARNING-ERRORS            VALUE 'W'.
  4607         16  FILLER                       PIC X.
  4608         16  PB-OUT-BAL-CD                PIC X.
  4609             88  PB-OUT-OF-BAL                VALUE 'O'.
  4610         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4611         16  PB-AH-OVERRIDE-L1            PIC X.
  4612         16  PB-INPUT-DT                  PIC XX.
  4613         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  87
* EL050.cbl
  4614         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4615         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4616         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4617         16  PB-LF-EARNING-METHOD         PIC X.
  4618         16  PB-AH-EARNING-METHOD         PIC X.
  4619         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4620         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4621         16  PB-REIN-CD                   PIC XXX.
  4622         16  PB-LF-REFUND-TYPE            PIC X.
  4623         16  PB-AH-REFUND-TYPE            PIC X.
  4624         16  PB-ACCT-EFF-DT               PIC XX.
  4625         16  PB-ACCT-EXP-DT               PIC XX.
  4626         16  PB-COMPANY-ID                PIC X(3).
  4627         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4628         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4629         16  PB-SV-CARRIER                PIC X.
  4630         16  PB-SV-GROUPING               PIC X(6).
  4631         16  PB-SV-STATE                  PIC XX.
  4632         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4633         16  PB-GA-BILLING-INFO.
  4634             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4635                                          PIC XX.
  4636         16  PB-SV-REMIT-TO  REDEFINES
  4637             PB-GA-BILLING-INFO           PIC X(10).
  4638         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4639         16  PB-I-LOAN-OFFICER            PIC X(5).
  4640         16  PB-I-VIN                     PIC X(17).
  4641
  4642         16  FILLER                       PIC X(04).
  4643         16  IMNET-BYPASS-SW              PIC X.
  4644
  4645******************************************************************
  4646*                COMMON EDIT ERRORS                              *
  4647******************************************************************
  4648
  4649     12  PB-COMMON-ERRORS.
  4650         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4651                                           PIC S9(4)     COMP.
  4652
  4653******************************************************************
  4654
  4655* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4656*    COPY ELC50W1.
  4657******************************************************************
  4658*                                                                *
  4659*                                                                *
  4660*                             ELC50W1                            *
  4661*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4662*                            VMOD=2.004                          *
  4663*                                                                *
  4664*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4665*                                                                *
  4666*                                                                *
  4667******************************************************************
  4668
  4669     12  WK-WORK-AREA.
  4670         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4671         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  88
* EL050.cbl
  4672         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4673         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4674         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4675         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4676         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4677         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4678         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4679         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4680         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4681         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4682         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4683         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4684         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4685         16  WK-CREDIT-EDIT-CONTROLS.
  4686             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4687             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4688             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4689             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4690             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4691             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4692         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4693         16  WK-SAVE-REIN-DATA.
  4694             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4695             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4696             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4697         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4698             88  ENTRY-FROM-EL6311       VALUE '6'.
  4699         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4700         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4701     12  WK-RECORD-ADDRESSES.
  4702         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4703         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4704         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4705         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4706         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4707         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4708         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4709         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4710     12  WK-OVER-SHORT-AREA.
  4711         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4712         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4713         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4714             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4715         16  FILLER                   PIC X(5) VALUE SPACES.
  4716
  4717*    COPY ELCEDITC.
  4718******************************************************************
  4719*                                                                *
  4720*                                                                *
  4721*                            ELCEDITC                            *
  4722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4723*                            VMOD=2.012                          *
  4724*                                                                *
  4725*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4726*                     EL6313, EL050 AND EL517.                   *
  4727*                                                                *
  4728******************************************************************
  4729******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  89
* EL050.cbl
  4730*                   C H A N G E   L O G
  4731*
  4732* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4733*-----------------------------------------------------------------
  4734*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4735* EFFECTIVE    NUMBER
  4736*-----------------------------------------------------------------
  4737* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4738******************************************************************
  4739
  4740     12  EDIT-CRITERIA-DATA.
  4741         16  EC-CO-MONTH-END-DT       PIC XX.
  4742         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4743         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4744         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4745         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4746         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4747         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4748         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4749         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4750         16  EC-CO-REM-TERM-CALC      PIC X.
  4751               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4752               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4753               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4754               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4755
  4756         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4757               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4758               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4759               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4760               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4761               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4762               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4763               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4764               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4765               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4766               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4767
  4768         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4769               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4770               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4771               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4772               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4773               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4774               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4775               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4776               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4777
  4778         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4779                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4780                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4781
  4782         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4783                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4784                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4785                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4786                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4787                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  90
* EL050.cbl
  4788                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4789                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4790                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4791
  4792         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4793               88  EC-BR-REDUCING                   VALUE 'R'.
  4794               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4795
  4796         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4797         16  EC-BR-LF-DESC             PIC X(10).
  4798         16  EC-BR-AH-DESC             PIC X(10).
  4799         16  EC-BR-LF-COMMENT          PIC X(10).
  4800         16  EC-BR-AH-COMMENT          PIC X(10).
  4801
  4802         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4803               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4804               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4805               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4806               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4807
  4808         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4809               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4810               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4811               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4812               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4813
  4814         16  EC-BR-LF-REFUND-CALC      PIC X.
  4815                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4816                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4817                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4818                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4819                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4820                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4821                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4822
  4823         16  EC-BR-AH-REFUND-CALC      PIC X.
  4824                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4825                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4826                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4827                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4828                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4829                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4830                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4831                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4832
  4833         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4834                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4835                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4836                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4837
  4838         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4839                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4840                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4841                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4842
  4843         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4844         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4845         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  91
* EL050.cbl
  4846         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4847
  4848         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4849         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4850                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4851                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4852                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4853                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4854
  4855         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4856               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4857               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4858               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4859               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4860               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4861
  4862         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4863               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4864               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4865               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4866               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4867               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4868
  4869         16  EC-ST-LF-REFUND-CALC      PIC X.
  4870                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4871                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4872                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4873                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4874                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4875                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4876                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4877                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4878
  4879         16  EC-ST-AH-REFUND-CALC      PIC X.
  4880                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4881                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4882                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4883                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4884                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4885                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4886                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4887                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4888
  4889         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4890         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4891         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4892         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4893         16  EC-AM-EXPIRATION-DT       PIC XX.
  4894         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4895         16  EC-AM-CLASS-CD            PIC XX.
  4896         16  EC-AM-LF-DEVIATION        PIC XXX.
  4897         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4898         16  EC-AM-AH-DEVIATION        PIC XXX.
  4899         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4900         16  EC-AM-PHONE-NO            PIC X(10).
  4901
  4902         16  EC-AM-LF-REFUND-CALC      PIC X.
  4903                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  92
* EL050.cbl
  4904                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4905                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4906                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4907                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4908                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4909                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4910
  4911         16  EC-AM-AH-REFUND-CALC      PIC X.
  4912                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4913                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4914                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4915                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4916                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4917                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4918                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4919
  4920         16  EC-AM-BEN-I-G-CD          PIC X.
  4921                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4922                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4923                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4924
  4925         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4926         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4927         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4928         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4929         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4930         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4931         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4932         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4933         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4934
  4935         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4936         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4937         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4938         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4939         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4940         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4941         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4942         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4943         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4944         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4945         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4946         16  EC-RT-LF-NSP-ST           PIC XX.
  4947         16  EC-RT-AH-NSP-ST           PIC XX.
  4948         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4949         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4950
  4951         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4952             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4953                                             'M' '5' '9' '2'.
  4954             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4955             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4956             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4957             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4958             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4959             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4960             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4961             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  93
* EL050.cbl
  4962             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4963             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4964
  4965         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4966             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4967                                             'M' '5' '9' '2'.
  4968             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4969             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4970             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4971             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4972             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4973             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4974             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4975             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4976             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4977             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4978
  4979         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4980         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4981         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4982         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4983         16  EC-CM-DEATH-DT            PIC XX.
  4984
  4985*DMD CUSTOM CODING FIELDS BELOW
  4986*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4987         16  EC-BR-DMD-RATING-SW       PIC X.
  4988                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4989                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4990                 88  NO-DMD-RATING               VALUE 'N'.
  4991
  4992         16  EC-NEW-CERT               PIC X(11).
  4993         16  EC-NEW-STATE              PIC XX.
  4994         16  FILLER                    PIC X.
  4995*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4996         16  OVER-SHORT-EDIT-FIELDS.
  4997             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4998             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4999             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5000             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5001             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5002             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5003             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5004             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5005             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5006         16  FILLER                    PIC X(71).
  5007******************************************************************
  5008
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  94
* EL050.cbl
  5010*    COPY ELCDIFRD.
  5011******************************************************************
  5012*                                                                *
  5013*                                                                *
  5014*                            ELCDIFRD.                           *
  5015*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5016*                            VMOD=2.004                          *
  5017*                                                                *
  5018*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5019*                                                                *
  5020******************************************************************
  5021*
  5022  01  WS-DIFFERENCE-CALCULATION.
  5023        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5024        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5025        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5026        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5027        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5028        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5029        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5030        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5031        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5032        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5033        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5034
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  95
* EL050.cbl
  5036****************************************************************
  5037*
  5038* Copyright (c) 2007-2013 Dell Inc.
  5039* All rights reserved.
  5040*
  5041****************************************************************
  5042 01  DFHEIV.
  5043   02  DFHEIV0               PIC X(35).
  5044   02  DFHEIV1               PIC X(08).
  5045   02  DFHEIV2               PIC X(08).
  5046   02  DFHEIV3               PIC X(08).
  5047   02  DFHEIV4               PIC X(06).
  5048   02  DFHEIV5               PIC X(04).
  5049   02  DFHEIV6               PIC X(04).
  5050   02  DFHEIV7               PIC X(02).
  5051   02  DFHEIV8               PIC X(02).
  5052   02  DFHEIV9               PIC X(01).
  5053   02  DFHEIV10              PIC S9(7) COMP-3.
  5054   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5055   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5056   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5057   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5058   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5059   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5060   02  DFHEIV17              PIC X(04).
  5061   02  DFHEIV18              PIC X(04).
  5062   02  DFHEIV19              PIC X(04).
  5063   02  DFHEIV20              USAGE IS POINTER.
  5064   02  DFHEIV21              USAGE IS POINTER.
  5065   02  DFHEIV22              USAGE IS POINTER.
  5066   02  DFHEIV23              USAGE IS POINTER.
  5067   02  DFHEIV24              USAGE IS POINTER.
  5068   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5069   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5070   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5071   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5072   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5073   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5074   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5075   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5076   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5077   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5078   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5079   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5080   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5081   02  FILLER                PIC X(02).
  5082   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5083   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5084   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5085   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5086   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5087   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5088   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5089 LINKAGE  SECTION.
  5090*****************************************************************
  5091*                                                               *
  5092* Copyright (c) 2007-2013 Dell Inc.                             *
  5093* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  96
* EL050.cbl
  5094*                                                               *
  5095*****************************************************************
  5096 01  dfheiblk.
  5097     02  eibtime          pic s9(7) comp-3.
  5098     02  eibdate          pic s9(7) comp-3.
  5099     02  eibtrnid         pic x(4).
  5100     02  eibtaskn         pic s9(7) comp-3.
  5101     02  eibtrmid         pic x(4).
  5102     02  dfheigdi         pic s9(4) comp.
  5103     02  eibcposn         pic s9(4) comp.
  5104     02  eibcalen         pic s9(4) comp.
  5105     02  eibaid           pic x(1).
  5106     02  eibfiller1       pic x(1).
  5107     02  eibfn            pic x(2).
  5108     02  eibfiller2       pic x(2).
  5109     02  eibrcode         pic x(6).
  5110     02  eibfiller3       pic x(2).
  5111     02  eibds            pic x(8).
  5112     02  eibreqid         pic x(8).
  5113     02  eibrsrce         pic x(8).
  5114     02  eibsync          pic x(1).
  5115     02  eibfree          pic x(1).
  5116     02  eibrecv          pic x(1).
  5117     02  eibsend          pic x(1).
  5118     02  eibatt           pic x(1).
  5119     02  eibeoc           pic x(1).
  5120     02  eibfmh           pic x(1).
  5121     02  eibcompl         pic x(1).
  5122     02  eibsig           pic x(1).
  5123     02  eibconf          pic x(1).
  5124     02  eiberr           pic x(1).
  5125     02  eibrldbk         pic x(1).
  5126     02  eiberrcd         pic x(4).
  5127     02  eibsynrb         pic x(1).
  5128     02  eibnodat         pic x(1).
  5129     02  eibfiller5       pic x(2).
  5130     02  eibresp          pic s9(8) comp.
  5131     02  eibresp2         pic s9(8) comp.
  5132     02  dfheigdj         pic s9(4) comp.
  5133     02  dfheigdk         pic s9(4) comp.
  5134
  5135 01  DFHCOMMAREA                   PIC X(1036).
  5136
  5137*01 PARMLIST .
  5138*    02  FILLER                    PIC S9(8)   COMP.
  5139*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5140*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5141*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5142*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5143*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5144*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5145*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5146
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  97
* EL050.cbl
  5148*    COPY ELCCNTL.
  5149******************************************************************
  5150*                                                                *
  5151*                                                                *
  5152*                            ELCCNTL.                            *
  5153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5154*                            VMOD=2.059                          *
  5155*                                                                *
  5156*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5157*                                                                *
  5158*   FILE TYPE = VSAM,KSDS                                        *
  5159*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5160*                                                                *
  5161*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5162*       ALTERNATE INDEX = NONE                                   *
  5163*                                                                *
  5164*   LOG = YES                                                    *
  5165*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5166******************************************************************
  5167*                   C H A N G E   L O G
  5168*
  5169* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5170*-----------------------------------------------------------------
  5171*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5172* EFFECTIVE    NUMBER
  5173*-----------------------------------------------------------------
  5174* 082503                   PEMA  ADD BENEFIT GROUP
  5175* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5176* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5177* 092705    2005050300006  PEMA  ADD SPP LEASES
  5178* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5179* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5180* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5181* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5182* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5183* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5184* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5185* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5186* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5187* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5188* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5189******************************************************************
  5190*
  5191 01  CONTROL-FILE.
  5192     12  CF-RECORD-ID                       PIC XX.
  5193         88  VALID-CF-ID                        VALUE 'CF'.
  5194
  5195     12  CF-CONTROL-PRIMARY.
  5196         16  CF-COMPANY-ID                  PIC XXX.
  5197         16  CF-RECORD-TYPE                 PIC X.
  5198             88  CF-COMPANY-MASTER              VALUE '1'.
  5199             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5200             88  CF-STATE-MASTER                VALUE '3'.
  5201             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5202             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5203             88  CF-CARRIER-MASTER              VALUE '6'.
  5204             88  CF-MORTALITY-MASTER            VALUE '7'.
  5205             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  98
* EL050.cbl
  5206             88  CF-TERMINAL-MASTER             VALUE '9'.
  5207             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5208             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5209             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5210             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5211             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5212             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5213             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5214             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5215             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5216         16  CF-ACCESS-CD-GENL              PIC X(4).
  5217         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5218             20  CF-PROCESSOR               PIC X(4).
  5219         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5220             20  CF-STATE-CODE              PIC XX.
  5221             20  FILLER                     PIC XX.
  5222         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5223             20  FILLER                     PIC XX.
  5224             20  CF-HI-BEN-IN-REC           PIC XX.
  5225         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5226             20  FILLER                     PIC XXX.
  5227             20  CF-CARRIER-CNTL            PIC X.
  5228         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5229             20  FILLER                     PIC XX.
  5230             20  CF-HI-TYPE-IN-REC          PIC 99.
  5231         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5232             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5233                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5234             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5235             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5236         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5237             20  FILLER                     PIC X.
  5238             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5239         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5240             20  FILLER                     PIC XX.
  5241             20  CF-MORTGAGE-PLAN           PIC XX.
  5242         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5243
  5244     12  CF-LAST-MAINT-DT                   PIC XX.
  5245     12  CF-LAST-MAINT-BY                   PIC X(4).
  5246     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5247
  5248     12  CF-RECORD-BODY                     PIC X(728).
  5249
  5250
  5251****************************************************************
  5252*             COMPANY MASTER RECORD                            *
  5253****************************************************************
  5254
  5255     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5256         16  CF-COMPANY-ADDRESS.
  5257             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5258             20  CF-CL-IN-CARE-OF           PIC X(30).
  5259             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5260             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5261             20  CF-CL-CITY-STATE           PIC X(30).
  5262             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5263             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page  99
* EL050.cbl
  5264         16  CF-COMPANY-CD                  PIC X.
  5265         16  CF-COMPANY-PASSWORD            PIC X(8).
  5266         16  CF-SECURITY-OPTION             PIC X.
  5267             88  ALL-SECURITY                   VALUE '1'.
  5268             88  COMPANY-VERIFY                 VALUE '2'.
  5269             88  PROCESSOR-VERIFY               VALUE '3'.
  5270             88  NO-SECURITY                    VALUE '4'.
  5271             88  ALL-BUT-TERM                   VALUE '5'.
  5272         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5273             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5274         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5275             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5276         16  CF-INFORCE-LOCATION            PIC X.
  5277             88  CERTS-ARE-ONLINE               VALUE '1'.
  5278             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5279             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5280         16  CF-LOWER-CASE-LETTERS          PIC X.
  5281         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5282             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5283             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5284             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5285             88  CF-ACCNT-CNTL                  VALUE '3'.
  5286             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5287
  5288         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5289         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5290
  5291         16  CF-LGX-CREDIT-USER             PIC X.
  5292             88  CO-IS-NOT-USER                 VALUE 'N'.
  5293             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5294
  5295         16 CF-CREDIT-CALC-CODES.
  5296             20  CF-CR-REM-TERM-CALC PIC X.
  5297               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5298               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5299               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5300               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5301               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5302               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5303               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5304             20  CF-CR-R78-METHOD           PIC X.
  5305               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5306               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5307
  5308         16  CF-CLAIM-CONTROL-COUNTS.
  5309             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5310                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5311
  5312             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5313                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5314
  5315             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5316                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5317
  5318             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5319                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5320
  5321         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 100
* EL050.cbl
  5322
  5323         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5324             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5325             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5326             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5327             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5328                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5329                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5330             20  CF-CO-PREM-REJECT-SW       PIC X.
  5331                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5332                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5333             20  CF-CO-REF-REJECT-SW        PIC X.
  5334                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5335                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5336
  5337         16  CF-CO-REPORTING-DT             PIC XX.
  5338         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5339         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5340           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5341           88  CF-CO-MONTH-END                  VALUE '1'.
  5342
  5343         16  CF-LGX-CLAIM-USER              PIC X.
  5344             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5345             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5346
  5347         16  CF-CREDIT-EDIT-CONTROLS.
  5348             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5349             20  CF-MIN-AGE                 PIC 99.
  5350             20  CF-DEFAULT-AGE             PIC 99.
  5351             20  CF-MIN-TERM                PIC S999      COMP-3.
  5352             20  CF-MAX-TERM                PIC S999      COMP-3.
  5353             20  CF-DEFAULT-SEX             PIC X.
  5354             20  CF-JOINT-AGE-INPUT         PIC X.
  5355                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5356             20  CF-BIRTH-DATE-INPUT        PIC X.
  5357                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5358             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5359                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5360                 88  CF-ZERO-CARRIER            VALUE '1'.
  5361                 88  CF-ZERO-GROUPING           VALUE '2'.
  5362                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5363             20  CF-EDIT-SW                 PIC X.
  5364                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5365             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5366             20  CF-CR-PR-METHOD            PIC X.
  5367               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5368               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5369             20  FILLER                     PIC X.
  5370
  5371         16  CF-CREDIT-MISC-CONTROLS.
  5372             20  CF-REIN-TABLE-SW           PIC X.
  5373                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5374             20  CF-COMP-TABLE-SW           PIC X.
  5375                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5376             20  CF-EXPERIENCE-RETENTION-AGE
  5377                                            PIC S9        COMP-3.
  5378             20  CF-CONVERSION-DT           PIC XX.
  5379             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 101
* EL050.cbl
  5380             20  CF-RUN-FREQUENCY-SW        PIC X.
  5381                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5382                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5383
  5384             20  CF-CR-CHECK-NO-CONTROL.
  5385                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5386                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5387                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5388                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5389                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5390                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5391
  5392                 24  CF-CR-CHECK-COUNT       REDEFINES
  5393                     CF-CR-CHECK-COUNTER      PIC X(4).
  5394
  5395                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5396                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5397
  5398                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5399                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5400                 24  CF-MAIL-PROCESSING       PIC X.
  5401                     88  MAIL-PROCESSING          VALUE 'Y'.
  5402
  5403         16  CF-MISC-SYSTEM-CONTROL.
  5404             20  CF-SYSTEM-C                 PIC X.
  5405                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5406             20  CF-SYSTEM-D                 PIC X.
  5407                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5408             20  CF-SOC-SEC-NO-SW            PIC X.
  5409                 88  SOC-SEC-NO-USED             VALUE '1'.
  5410             20  CF-MEMBER-NO-SW             PIC X.
  5411                 88  MEMBER-NO-USED              VALUE '1'.
  5412             20  CF-TAX-ID-NUMBER            PIC X(11).
  5413             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5414             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5415                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5416                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5417                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5418                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5419             20  CF-SYSTEM-E                 PIC X.
  5420                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5421
  5422         16  CF-LGX-LIFE-USER               PIC X.
  5423             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5424             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5425
  5426         16  CF-CR-MONTH-END-DT             PIC XX.
  5427
  5428         16  CF-FILE-MAINT-DATES.
  5429             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5430                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5431             20  CF-LAST-BATCH       REDEFINES
  5432                 CF-LAST-BATCH-NO               PIC X(4).
  5433             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5434             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5435             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5436             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5437             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 102
* EL050.cbl
  5438             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5439             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5440             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5441             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5442             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5443
  5444         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5445         16  FILLER                         PIC X.
  5446
  5447         16  CF-ALT-MORT-CODE               PIC X(4).
  5448         16  CF-MEMBER-CAPTION              PIC X(10).
  5449
  5450         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5451             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5452             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5453             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5454             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5455             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5456
  5457         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5458
  5459         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5460         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5461         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5462         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5463
  5464         16  CF-AH-OVERRIDE-L1              PIC X.
  5465         16  CF-AH-OVERRIDE-L2              PIC XX.
  5466         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5467         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5468
  5469         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5470         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5471
  5472         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5473         16  CF-AR-LAST-EL860-DT            PIC XX.
  5474         16  CF-MP-MONTH-END-DT             PIC XX.
  5475
  5476         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5477         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5478             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5479
  5480         16  CF-AR-MONTH-END-DT             PIC XX.
  5481
  5482         16  CF-CRDTCRD-USER                PIC X.
  5483             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5484             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5485
  5486         16  CF-CC-MONTH-END-DT             PIC XX.
  5487
  5488         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5489
  5490         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5491             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5492             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5493             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5494         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5495         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 103
* EL050.cbl
  5496         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5497         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5498             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5499             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5500         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5501         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5502         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5503             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5504         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5505
  5506         16  CF-CL-ZIP-CODE.
  5507             20  CF-CL-ZIP-PRIME.
  5508                 24  CF-CL-ZIP-1ST          PIC X.
  5509                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5510                 24  FILLER                 PIC X(4).
  5511             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5512         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5513             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5514             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5515             20  FILLER                     PIC XXX.
  5516
  5517         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5518         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5519         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5520         16  CF-CO-OPTION-START-DATE        PIC XX.
  5521         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5522           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5523                                                      '3' '4'.
  5524           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5525           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5526           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5527           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5528           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5529           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5530
  5531         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5532
  5533         16  CF-PAYMENT-APPROVAL-LEVELS.
  5534             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5535             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5536             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5537             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5538             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5539             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5540
  5541         16  CF-END-USER-REPORTING-USER     PIC X.
  5542             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5543             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5544
  5545         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5546             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5547             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5548
  5549         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5550
  5551         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5552         16  FILLER                         PIC X.
  5553
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 104
* EL050.cbl
  5554         16  CF-CREDIT-ARCHIVE-CNTL.
  5555             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5556             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5557             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5558
  5559         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5560
  5561         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5562             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5563             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5564
  5565         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5566             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5567             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5568
  5569         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5570
  5571         16  CF-CO-ACH-ID-CODE              PIC  X.
  5572             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5573             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5574             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5575         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5576         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5577         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5578         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5579         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5580         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5581         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5582         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5583         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5584                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5585         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5586                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5587
  5588         16  CF-CO-OVER-SHORT.
  5589             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5590             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5591
  5592*         16  FILLER                         PIC X(102).
  5593         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5594             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5595             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5596
  5597         16  CF-AH-APPROVAL-DAYS.
  5598             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5599             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5600             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5601             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5602
  5603         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5604
  5605         16  CF-APPROV-LEV-5.
  5606             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5607             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5608             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5609
  5610         16  FILLER                         PIC X(68).
  5611****************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 105
* EL050.cbl
  5612*             PROCESSOR/USER RECORD                            *
  5613****************************************************************
  5614
  5615     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5616         16  CF-PROCESSOR-NAME              PIC X(30).
  5617         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5618         16  CF-PROCESSOR-TITLE             PIC X(26).
  5619         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5620                 88  MESSAGE-YES                VALUE 'Y'.
  5621                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5622
  5623*****************************************************
  5624****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5625****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5626****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5627****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5628*****************************************************
  5629
  5630         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5631             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5632             20  CF-APPLICATION-FORCE       PIC X.
  5633             20  CF-INDIVIDUAL-APP.
  5634                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5635                     28  CF-BROWSE-APP      PIC X.
  5636                     28  CF-UPDATE-APP      PIC X.
  5637
  5638         16  CF-CURRENT-TERM-ON             PIC X(4).
  5639         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5640             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5641             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5642             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5643             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5644             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5645             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5646             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5647         16  CF-PROCESSOR-CARRIER           PIC X.
  5648             88  NO-CARRIER-SECURITY            VALUE ' '.
  5649         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5650             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5651         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5652             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5653         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5654             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5655
  5656         16  CF-PROC-SYS-ACCESS-SW.
  5657             20  CF-PROC-CREDIT-CLAIMS-SW.
  5658                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5659                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5660                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5661                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5662             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5663                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5664                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5665             20  CF-PROC-LIFE-GNRLDGR-SW.
  5666                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5667                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5668                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5669                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 106
* EL050.cbl
  5670             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5671                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5672                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5673         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5674             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5675             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5676         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5677
  5678         16  CF-APPROVAL-LEVEL                  PIC X.
  5679             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5680             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5681             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5682             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5683             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5684
  5685         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5686
  5687         16  CF-LANGUAGE-TYPE                   PIC X.
  5688             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5689             88  CF-LANG-IS-FR                      VALUE 'F'.
  5690
  5691         16  CF-CSR-IND                         PIC X.
  5692         16  FILLER                             PIC X(239).
  5693
  5694****************************************************************
  5695*             PROCESSOR/REMINDERS RECORD                       *
  5696****************************************************************
  5697
  5698     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5699         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5700             20  CF-START-REMIND-DT         PIC XX.
  5701             20  CF-END-REMIND-DT           PIC XX.
  5702             20  CF-REMINDER-TEXT           PIC X(50).
  5703         16  FILLER                         PIC X(296).
  5704
  5705
  5706****************************************************************
  5707*             STATE MASTER RECORD                              *
  5708****************************************************************
  5709
  5710     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5711         16  CF-STATE-ABBREVIATION          PIC XX.
  5712         16  CF-STATE-NAME                  PIC X(25).
  5713         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5714         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5715             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5716             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5717             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5718             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5719                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5720                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5721             20  CF-ST-PREM-REJECT-SW       PIC X.
  5722                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5723                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5724             20  CF-ST-REF-REJECT-SW        PIC X.
  5725                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5726                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5727         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 107
* EL050.cbl
  5728         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5729         16  CF-ST-REFUND-RULES.
  5730             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5731             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5732             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5733         16  CF-ST-FST-PMT-EXTENSION.
  5734             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5735             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5736                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5737                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5738                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5739                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5740         16  CF-ST-STATE-CALL.
  5741             20  CF-ST-CALL-UNEARNED        PIC X.
  5742             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5743             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5744         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5745             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5746             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5747         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5748         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5749         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5750         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5751         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5752         16  FILLER                         PIC X.
  5753         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5754             20  CF-ST-BENEFIT-CD           PIC XX.
  5755             20  CF-ST-BENEFIT-KIND         PIC X.
  5756                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5757                 88  CF-ST-AH-KIND              VALUE 'A'.
  5758             20  CF-ST-REM-TERM-CALC        PIC X.
  5759                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5760                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5761                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5762                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5763                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5764                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5765                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5766                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5767
  5768             20  CF-ST-REFUND-CALC          PIC X.
  5769                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5770                 88  ST-REFD-BY-R78             VALUE '1'.
  5771                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5772                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5773                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5774                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5775                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5776                 88  ST-REFD-UTAH               VALUE '7'.
  5777                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5778                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5779                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5780
  5781             20  CF-ST-EARNING-CALC         PIC X.
  5782                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5783                 88  ST-EARN-BY-R78             VALUE '1'.
  5784                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5785                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 108
* EL050.cbl
  5786                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5787                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5788                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5789                 88  ST-EARN-MEAN               VALUE '8'.
  5790                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5791
  5792             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5793                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5794                 88  ST-OVRD-BY-R78             VALUE '1'.
  5795                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5796                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5797                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5798                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5799                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5800                 88  ST-OVRD-MEAN               VALUE '8'.
  5801                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5802             20  cf-st-extra-periods        pic 9.
  5803*            20  FILLER                     PIC X.
  5804
  5805         16  CF-ST-COMMISSION-CAPS.
  5806             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5807             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5808             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5809             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5810         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5811                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5812                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5813                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5814
  5815         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5816
  5817         16  CF-ST-STATUTORY-INTEREST.
  5818             20  CF-ST-STAT-DATE-FROM       PIC X.
  5819                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5820                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5821             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5822             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5823             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5824             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5825             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5826
  5827         16  CF-ST-OVER-SHORT.
  5828             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5829             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5830
  5831         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5832
  5833         16  CF-ST-RT-CALC                  PIC X.
  5834
  5835         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5836         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5837         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5838         16  CF-ST-RF-LR-CALC               PIC X.
  5839         16  CF-ST-RF-LL-CALC               PIC X.
  5840         16  CF-ST-RF-LN-CALC               PIC X.
  5841         16  CF-ST-RF-AH-CALC               PIC X.
  5842         16  CF-ST-RF-CP-CALC               PIC X.
  5843*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 109
* EL050.cbl
  5844*CIDMOD         16  FILLER                         PIC X(192).
  5845         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5846             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5847         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5848         16  CF-ST-VFY-2ND-BENE             PIC X.
  5849         16  CF-ST-CAUSAL-STATE             PIC X.
  5850         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5851         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5852         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5853             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5854         16  CF-ST-NET-ONLY-STATE           PIC X.
  5855             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5856         16  cf-commission-cap-required     pic x.
  5857         16  CF-ST-GA-COMMISSION-CAPS.
  5858             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5859             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5860             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5861             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5862         16  CF-ST-TOT-COMMISSION-CAPS.
  5863             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5864             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5865             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5866             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5867         16  FILLER                         PIC X(156).
  5868
  5869****************************************************************
  5870*             BENEFIT MASTER RECORD                            *
  5871****************************************************************
  5872
  5873     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5874         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5875             20  CF-BENEFIT-CODE            PIC XX.
  5876             20  CF-BENEFIT-NUMERIC  REDEFINES
  5877                 CF-BENEFIT-CODE            PIC XX.
  5878             20  CF-BENEFIT-ALPHA           PIC XXX.
  5879             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5880             20  CF-BENEFIT-COMMENT         PIC X(10).
  5881
  5882             20  CF-LF-COVERAGE-TYPE        PIC X.
  5883                 88  CF-REDUCING                VALUE 'R'.
  5884                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5885
  5886             20  CF-SPECIAL-CALC-CD         PIC X.
  5887                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5888                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5889                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5890                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5891                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5892                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5893                 88  CF-FARM-PLAN               VALUE 'F'.
  5894                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5895                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5896                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5897                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5898                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5899                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5900                 88  CF-PRUDENTIAL              VALUE 'P'.
  5901                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 110
* EL050.cbl
  5902                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5903                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5904                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5905                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5906                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5907
  5908             20  CF-JOINT-INDICATOR         PIC X.
  5909                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5910
  5911*            20  FILLER                     PIC X(12).
  5912             20  cf-maximum-benefits        pic s999 comp-3.
  5913             20  FILLER                     PIC X(09).
  5914             20  CF-BENEFIT-CATEGORY        PIC X.
  5915             20  CF-LOAN-TYPE               PIC X(8).
  5916
  5917             20  CF-CO-REM-TERM-CALC        PIC X.
  5918                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5919                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5920                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5921                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5922                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5923
  5924             20  CF-CO-EARNINGS-CALC        PIC X.
  5925                 88  CO-EARN-BY-R78             VALUE '1'.
  5926                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5927                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5928                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5929                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5930                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5931                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5932                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5933
  5934             20  CF-CO-REFUND-CALC          PIC X.
  5935                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5936                 88  CO-REFD-BY-R78             VALUE '1'.
  5937                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5938                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5939                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5940                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5941                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5942                 88  CO-REFD-MEAN               VALUE '8'.
  5943                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5944                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5945                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5946
  5947             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5948                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5949                 88  CO-OVRD-BY-R78             VALUE '1'.
  5950                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5951                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5952                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5953                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5954                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5955                 88  CO-OVRD-MEAN               VALUE '8'.
  5956                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5957
  5958             20  CF-CO-BEN-I-G-CD           PIC X.
  5959                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 111
* EL050.cbl
  5960                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5961                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5962
  5963         16  FILLER                         PIC X(304).
  5964
  5965
  5966****************************************************************
  5967*             CARRIER MASTER RECORD                            *
  5968****************************************************************
  5969
  5970     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5971         16  CF-ADDRESS-DATA.
  5972             20  CF-MAIL-TO-NAME            PIC X(30).
  5973             20  CF-IN-CARE-OF              PIC X(30).
  5974             20  CF-ADDRESS-LINE-1          PIC X(30).
  5975             20  CF-ADDRESS-LINE-2          PIC X(30).
  5976             20  CF-CITY-STATE              PIC X(30).
  5977             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5978             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5979
  5980         16  CF-CLAIM-NO-CONTROL.
  5981             20  CF-CLAIM-NO-METHOD         PIC X.
  5982                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5983                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5984                 88  CLAIM-NO-SEQ               VALUE '3'.
  5985                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5986             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5987                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5988                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5989                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5990
  5991         16  CF-CHECK-NO-CONTROL.
  5992             20  CF-CHECK-NO-METHOD         PIC X.
  5993                 88  CHECK-NO-MANUAL            VALUE '1'.
  5994                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5995                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5996                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5997             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5998                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5999
  6000         16  CF-DOMICILE-STATE              PIC XX.
  6001
  6002         16  CF-EXPENSE-CONTROLS.
  6003             20  CF-EXPENSE-METHOD          PIC X.
  6004                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6005                 88  DOLLARS-PER-PMT            VALUE '2'.
  6006                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6007                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6008             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6009             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6010
  6011         16  CF-CORRESPONDENCE-CONTROL.
  6012             20  CF-LETTER-RESEND-OPT       PIC X.
  6013                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6014                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6015             20  FILLER                     PIC X(4).
  6016
  6017         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 112
* EL050.cbl
  6018             20  CF-MANUAL-SW               PIC X.
  6019                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6020             20  CF-FUTURE-SW               PIC X.
  6021                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6022             20  CF-PTC-SW                  PIC X.
  6023                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6024             20  CF-IBNR-SW                 PIC X.
  6025                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6026             20  CF-PTC-LF-SW               PIC X.
  6027                 88  CF-LF-PTC-USED             VALUE '1'.
  6028             20  CF-CDT-ACCESS-METHOD       PIC X.
  6029                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6030                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6031                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6032             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6033
  6034         16  CF-CLAIM-CALC-METHOD           PIC X.
  6035             88  360-PLUS-MONTHS                VALUE '1'.
  6036             88  365-PLUS-MONTHS                VALUE '2'.
  6037             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6038             88  360-DAILY                      VALUE '4'.
  6039             88  365-DAILY                      VALUE '5'.
  6040
  6041         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6042         16  FILLER                         PIC X(11).
  6043
  6044         16  CF-LIMIT-AMOUNTS.
  6045             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6046             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6047             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6048             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6049             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6050             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6051             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6052             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6053             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6054             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6055
  6056         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6057         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6058         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6059
  6060         16  CF-ZIP-CODE.
  6061             20  CF-ZIP-PRIME.
  6062                 24  CF-ZIP-1ST             PIC X.
  6063                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6064                 24  FILLER                 PIC X(4).
  6065             20  CF-ZIP-PLUS4               PIC X(4).
  6066         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6067             20  CF-CAN-POSTAL-1            PIC XXX.
  6068             20  CF-CAN-POSTAL-2            PIC XXX.
  6069             20  FILLER                     PIC XXX.
  6070
  6071         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6072         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6073         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6074
  6075         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 113
* EL050.cbl
  6076             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6077             88  CF-NO-RATING                   VALUE 'N'.
  6078
  6079         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6080
  6081         16  CF-CARRIER-OVER-SHORT.
  6082             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6083             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6084
  6085         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6086         16  CF-SECPAY-SWITCH               PIC X.
  6087             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6088             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6089         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6090         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6091         16  FILLER                         PIC X(444).
  6092*        16  FILLER                         PIC X(452).
  6093
  6094
  6095****************************************************************
  6096*             MORTALITY MASTER RECORD                          *
  6097****************************************************************
  6098
  6099     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6100         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6101                                INDEXED BY CF-MORT-NDX.
  6102             20  CF-MORT-TABLE              PIC X(5).
  6103             20  CF-MORT-TABLE-TYPE         PIC X.
  6104                 88  CF-MORT-JOINT              VALUE 'J'.
  6105                 88  CF-MORT-SINGLE             VALUE 'S'.
  6106                 88  CF-MORT-COMBINED           VALUE 'C'.
  6107                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6108                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6109             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6110             20  CF-MORT-AGE-METHOD         PIC XX.
  6111                 88  CF-AGE-LAST                VALUE 'AL'.
  6112                 88  CF-AGE-NEAR                VALUE 'AN'.
  6113             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6114             20  CF-MORT-ADJUSTMENT-DIRECTION
  6115                                            PIC X.
  6116                 88  CF-MINUS                   VALUE '-'.
  6117                 88  CF-PLUS                    VALUE '+'.
  6118             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6119             20  CF-MORT-JOINT-CODE         PIC X.
  6120                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6121             20  CF-MORT-PC-Q               PIC X.
  6122                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6123             20  CF-MORT-TABLE-CODE         PIC X(4).
  6124             20  CF-MORT-COMMENTS           PIC X(15).
  6125             20  FILLER                     PIC X(14).
  6126
  6127         16  FILLER                         PIC X(251).
  6128
  6129
  6130****************************************************************
  6131*             BUSSINESS TYPE MASTER RECORD                     *
  6132****************************************************************
  6133
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 114
* EL050.cbl
  6134     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6135* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6136* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6137* AND RECORD 05 IS TYPES 81-99
  6138         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6139             20  CF-BUSINESS-TITLE          PIC  X(19).
  6140             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6141                                            PIC S9V9(4) COMP-3.
  6142             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6143             20  FILLER                     PIC  X.
  6144         16  FILLER                         PIC  X(248).
  6145
  6146
  6147****************************************************************
  6148*             TERMINAL MASTER RECORD                           *
  6149****************************************************************
  6150
  6151     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6152
  6153         16  CF-COMPANY-TERMINALS.
  6154             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6155                                  PIC X(4).
  6156         16  FILLER               PIC X(248).
  6157
  6158
  6159****************************************************************
  6160*             LIFE EDIT MASTER RECORD                          *
  6161****************************************************************
  6162
  6163     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6164         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6165             20  CF-LIFE-CODE-IN            PIC XX.
  6166             20  CF-LIFE-CODE-OUT           PIC XX.
  6167         16  FILLER                         PIC X(248).
  6168
  6169
  6170****************************************************************
  6171*             AH EDIT MASTER RECORD                            *
  6172****************************************************************
  6173
  6174     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6175         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6176             20  CF-AH-CODE-IN              PIC XXX.
  6177             20  CF-AH-CODE-OUT             PIC XX.
  6178         16  FILLER                         PIC X(248).
  6179
  6180
  6181****************************************************************
  6182*             CREDIBILITY TABLES                               *
  6183****************************************************************
  6184
  6185     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6186         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6187                             INDEXED BY CF-CRDB-NDX.
  6188             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6189             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6190             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6191         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 115
* EL050.cbl
  6192
  6193
  6194****************************************************************
  6195*             REPORT CUSTOMIZATION RECORD                      *
  6196****************************************************************
  6197
  6198     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6199         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6200             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6201             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6202             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6203**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6204****       A T-TRANSFER.                                   ****
  6205             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6206
  6207         16  FILLER                         PIC XX.
  6208
  6209         16  CF-CARRIER-CNTL-OPT.
  6210             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6211                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6212                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6213             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6214                                            PIC X.
  6215         16  CF-GROUP-CNTL-OPT.
  6216             20  CF-GROUP-OPT-SEQ           PIC 9.
  6217                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6218                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6219             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6220                                            PIC X(6).
  6221         16  CF-STATE-CNTL-OPT.
  6222             20  CF-STATE-OPT-SEQ           PIC 9.
  6223                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6224                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6225             20  CF-STATE-SELECT OCCURS 3 TIMES
  6226                                            PIC XX.
  6227         16  CF-ACCOUNT-CNTL-OPT.
  6228             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6229                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6230                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6231             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6232                                            PIC X(10).
  6233         16  CF-BUS-TYP-CNTL-OPT.
  6234             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6235                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6236                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6237             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6238                                            PIC XX.
  6239         16  CF-LF-TYP-CNTL-OPT.
  6240             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6241                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6242                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6243             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6244                                            PIC XX.
  6245         16  CF-AH-TYP-CNTL-OPT.
  6246             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6247                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6248                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6249             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 116
* EL050.cbl
  6250                                            PIC XX.
  6251         16  CF-REPTCD1-CNTL-OPT.
  6252             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6253                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6254                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6255             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6256                                            PIC X(10).
  6257         16  CF-REPTCD2-CNTL-OPT.
  6258             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6259                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6260                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6261             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6262                                            PIC X(10).
  6263         16  CF-USER1-CNTL-OPT.
  6264             20  CF-USER1-OPT-SEQ           PIC 9.
  6265                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6266                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6267             20  CF-USER1-SELECT OCCURS 3 TIMES
  6268                                            PIC X(10).
  6269         16  CF-USER2-CNTL-OPT.
  6270             20  CF-USER2-OPT-SEQ           PIC 9.
  6271                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6272                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6273             20  CF-USER2-SELECT OCCURS 3 TIMES
  6274                                            PIC X(10).
  6275         16  CF-USER3-CNTL-OPT.
  6276             20  CF-USER3-OPT-SEQ           PIC 9.
  6277                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6278                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6279             20  CF-USER3-SELECT OCCURS 3 TIMES
  6280                                            PIC X(10).
  6281         16  CF-USER4-CNTL-OPT.
  6282             20  CF-USER4-OPT-SEQ           PIC 9.
  6283                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6284                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6285             20  CF-USER4-SELECT OCCURS 3 TIMES
  6286                                            PIC X(10).
  6287         16  CF-USER5-CNTL-OPT.
  6288             20  CF-USER5-OPT-SEQ           PIC 9.
  6289                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6290                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6291             20  CF-USER5-SELECT OCCURS 3 TIMES
  6292                                            PIC X(10).
  6293         16  CF-REINS-CNTL-OPT.
  6294             20  CF-REINS-OPT-SEQ           PIC 9.
  6295                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6296                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6297             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6298                 24  CF-REINS-PRIME         PIC XXX.
  6299                 24  CF-REINS-SUB           PIC XXX.
  6300
  6301         16  CF-AGENT-CNTL-OPT.
  6302             20  CF-AGENT-OPT-SEQ           PIC 9.
  6303                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6304                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6305             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6306                                            PIC X(10).
  6307
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 117
* EL050.cbl
  6308         16  FILLER                         PIC X(43).
  6309
  6310         16  CF-LOSS-RATIO-SELECT.
  6311             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6312             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6313         16  CF-ENTRY-DATE-SELECT.
  6314             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6315             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6316         16  CF-EFFECTIVE-DATE-SELECT.
  6317             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6318             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6319
  6320         16  CF-EXCEPTION-LIST-IND          PIC X.
  6321             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6322
  6323         16  FILLER                         PIC X(318).
  6324
  6325****************************************************************
  6326*                  EXCEPTION REPORTING RECORD                  *
  6327****************************************************************
  6328
  6329     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6330         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6331             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6332
  6333         16  CF-COMBINED-LIFE-AH-OPT.
  6334             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6335             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6336             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6337             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6338
  6339         16  CF-LIFE-OPT.
  6340             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6341             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6342             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6343             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6344             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6345             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6346             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6347             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6348             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6349             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6350
  6351         16  CF-AH-OPT.
  6352             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6353             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6354             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6355             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6356             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6357             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6358             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6359             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6360             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6361             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6362
  6363         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6364             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6365             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 118
* EL050.cbl
  6366             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6367
  6368         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6369
  6370         16  FILLER                         PIC X(673).
  6371
  6372
  6373****************************************************************
  6374*             MORTGAGE SYSTEM PLAN RECORD                      *
  6375****************************************************************
  6376
  6377     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6378         16  CF-PLAN-TYPE                   PIC X.
  6379             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6380             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6381             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6382         16  CF-PLAN-ABBREV                 PIC XXX.
  6383         16  CF-PLAN-DESCRIPT               PIC X(10).
  6384         16  CF-PLAN-NOTES                  PIC X(20).
  6385         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6386         16  CF-PLAN-UNDERWRITING.
  6387             20  CF-PLAN-TERM-DATA.
  6388                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6389                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6390             20  CF-PLAN-AGE-DATA.
  6391                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6392                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6393                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6394             20  CF-PLAN-BENEFIT-DATA.
  6395                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6396                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6397                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6398                                            PIC S9(7)V99  COMP-3.
  6399         16  CF-PLAN-POLICY-FORMS.
  6400             20  CF-POLICY-FORM             PIC X(12).
  6401             20  CF-MASTER-APPLICATION      PIC X(12).
  6402             20  CF-MASTER-POLICY           PIC X(12).
  6403         16  CF-PLAN-RATING.
  6404             20  CF-RATE-CODE               PIC X(5).
  6405             20  CF-SEX-RATING              PIC X.
  6406                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6407                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6408             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6409             20  CF-SUB-STD-TYPE            PIC X.
  6410                 88  CF-PCT-OF-PREM            VALUE '1'.
  6411                 88  CF-PCT-OF-BENE            VALUE '2'.
  6412         16  CF-PLAN-PREM-TOLERANCES.
  6413             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6414             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6415         16  CF-PLAN-PYMT-TOLERANCES.
  6416             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6417             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6418         16  CF-PLAN-MISC-DATA.
  6419             20  FILLER                     PIC X.
  6420             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6421             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6422         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6423         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 119
* EL050.cbl
  6424             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6425                                                     '1'.
  6426             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6427                                                     '2'.
  6428         16  CF-MIB-SEARCH-SW               PIC X.
  6429             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6430             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6431             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6432             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6433         16  CF-ALPHA-SEARCH-SW             PIC X.
  6434             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6435             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6436             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6437             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6438             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6439             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6440             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6441             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6442             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6443             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6444                                                     'A' 'B' 'C'
  6445                                                     'X' 'Y' 'Z'.
  6446         16  CF-EFF-DT-RULE-SW              PIC X.
  6447             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6448             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6449             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6450             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6451             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6452         16  FILLER                         PIC X(4).
  6453         16  CF-HEALTH-QUESTIONS            PIC X.
  6454             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6455         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6456         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6457         16  CF-PLAN-SNGL-JNT               PIC X.
  6458             88  CF-COMBINED-PLAN              VALUE 'C'.
  6459             88  CF-JNT-PLAN                   VALUE 'J'.
  6460             88  CF-SNGL-PLAN                  VALUE 'S'.
  6461         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6462         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6463         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6464         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6465         16  CF-RERATE-CNTL                 PIC  X.
  6466             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6467             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6468             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6469             88  CF-AUTO-RECALC                 VALUE '4'.
  6470         16  CF-BENEFIT-TYPE                PIC  X.
  6471             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6472             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6473         16  CF-POLICY-FEE                  PIC S999V99
  6474                                                    COMP-3.
  6475         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6476         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6477         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6478         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6479         16  FILLER                         PIC  X(32).
  6480         16  CF-TERMINATION-FORM            PIC  X(04).
  6481         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 120
* EL050.cbl
  6482         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6483                                                       COMP-3.
  6484         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6485         16  CF-ISSUE-LETTER                PIC  X(4).
  6486         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6487         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6488             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6489             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6490         16  CF-MP-REFUND-CALC              PIC X.
  6491             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6492             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6493             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6494             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6495             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6496             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6497             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6498             88  CF-MP-REFD-MEAN                VALUE '8'.
  6499         16  CF-ALT-RATE-CODE               PIC  X(5).
  6500
  6501
  6502         16  FILLER                         PIC X(498).
  6503****************************************************************
  6504*             MORTGAGE COMPANY MASTER RECORD                   *
  6505****************************************************************
  6506
  6507     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6508         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6509         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6510             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6511             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6512             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6513             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6514             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6515
  6516         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6517         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6518         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6519         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6520         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6521
  6522         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6523             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6524         16  CF-MP-RECON-USE-IND            PIC X(1).
  6525             88  CF-MP-USE-RECON             VALUE 'Y'.
  6526         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6527             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6528         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6529             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6530             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6531         16  FILLER                         PIC X(1).
  6532         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6533             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6534         16  CF-MORTG-MIB-VERSION           PIC X.
  6535             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6536             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6537             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6538         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6539             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 121
* EL050.cbl
  6540                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6541             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6542                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6543             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6544                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6545             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6546                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6547             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6548                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6549             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6550                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6551         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6552         16  FILLER                         PIC X(7).
  6553         16  CF-MORTG-DESTINATION-SYMBOL.
  6554             20  CF-MORTG-MIB-COMM          PIC X(5).
  6555             20  CF-MORTG-MIB-TERM          PIC X(5).
  6556         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6557             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6558         16  FILLER                         PIC X(03).
  6559         16  CF-MP-CHECK-NO-CONTROL.
  6560             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6561                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6562                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6563                                                ' ' LOW-VALUES.
  6564                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6565                                               VALUE '3'.
  6566         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6567         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6568         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6569             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6570                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6571             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6572                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6573             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6574                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6575             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6576                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6577             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6578                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6579             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6580                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6581         16  CF-MORTG-BILLING-AREA.
  6582             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6583                                            PIC X.
  6584         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6585         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6586         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6587         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6588             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6589             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6590         16  FILLER                         PIC X.
  6591         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6592             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6593             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6594         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6595         16  FILLER                         PIC X(8).
  6596         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6597         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 122
* EL050.cbl
  6598         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6599         16  CF-ACH-COMPANY-ID.
  6600             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6601                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6602                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6603                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6604             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6605         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6606             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6607         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6608             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6609             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6610         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6611         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6612         16  FILLER                         PIC X(536).
  6613
  6614****************************************************************
  6615*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6616****************************************************************
  6617
  6618     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6619         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6620             20  CF-FEMALE-HEIGHT.
  6621                 24  CF-FEMALE-FT           PIC 99.
  6622                 24  CF-FEMALE-IN           PIC 99.
  6623             20  CF-FEMALE-MIN-WT           PIC 999.
  6624             20  CF-FEMALE-MAX-WT           PIC 999.
  6625         16  FILLER                         PIC X(428).
  6626
  6627     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6628         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6629             20  CF-MALE-HEIGHT.
  6630                 24  CF-MALE-FT             PIC 99.
  6631                 24  CF-MALE-IN             PIC 99.
  6632             20  CF-MALE-MIN-WT             PIC 999.
  6633             20  CF-MALE-MAX-WT             PIC 999.
  6634         16  FILLER                         PIC X(428).
  6635******************************************************************
  6636*             AUTOMATIC ACTIVITY RECORD                          *
  6637******************************************************************
  6638     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6639         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6640             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6641             20  CF-SYS-LETTER-ID           PIC X(04).
  6642             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6643             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6644             20  CF-SYS-RESET-SW            PIC X(01).
  6645             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6646             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6647
  6648         16  FILLER                         PIC X(50).
  6649
  6650         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6651             20  CF-USER-ACTIVE-SW          PIC X(01).
  6652             20  CF-USER-LETTER-ID          PIC X(04).
  6653             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6654             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6655             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 123
* EL050.cbl
  6656             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6657             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6658             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6659
  6660         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 124
* EL050.cbl
  6662*    COPY ERCACCT.
  6663******************************************************************
  6664*                                                                *
  6665*                                                                *
  6666*                            ERCACCT                             *
  6667*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6668*                            VMOD=2.031                          *
  6669*                                                                *
  6670*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6671*                                                                *
  6672*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6673*   VSAM ACCOUNT MASTER FILES.                                   *
  6674*                                                                *
  6675*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6676*                                                                *
  6677*   FILE TYPE = VSAM,KSDS                                        *
  6678*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6679*                                                                *
  6680*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6681*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6682*                                                                *
  6683*   LOG = NO                                                     *
  6684*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6685*                                                                *
  6686*                                                                *
  6687******************************************************************
  6688*                   C H A N G E   L O G
  6689*
  6690* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6691*-----------------------------------------------------------------
  6692*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6693* EFFECTIVE    NUMBER
  6694*-----------------------------------------------------------------
  6695* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6696* 092705    2005050300006  PEMA  ADD SPP LEASES
  6697* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6698* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6699* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6700* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6701* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6702* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6703******************************************************************
  6704
  6705 01  ACCOUNT-MASTER.
  6706     12  AM-RECORD-ID                      PIC XX.
  6707         88  VALID-AM-ID                      VALUE 'AM'.
  6708
  6709     12  AM-CONTROL-PRIMARY.
  6710         16  AM-COMPANY-CD                 PIC X.
  6711         16  AM-MSTR-CNTRL.
  6712             20  AM-CONTROL-A.
  6713                 24  AM-CARRIER            PIC X.
  6714                 24  AM-GROUPING.
  6715                     28 AM-GROUPING-PREFIX PIC XXX.
  6716                     28 AM-GROUPING-PRIME  PIC XXX.
  6717                 24  AM-STATE              PIC XX.
  6718                 24  AM-ACCOUNT.
  6719                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 125
* EL050.cbl
  6720                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6721             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6722                                           PIC X(19).
  6723             20  AM-CNTRL-B.
  6724                 24  AM-EXPIRATION-DT      PIC XX.
  6725                 24  FILLER                PIC X(4).
  6726             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6727                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6728
  6729     12  AM-CONTROL-BY-VAR-GRP.
  6730         16  AM-COMPANY-CD-A1              PIC X.
  6731         16  AM-VG-CARRIER                 PIC X.
  6732         16  AM-VG-GROUPING                PIC X(6).
  6733         16  AM-VG-STATE                   PIC XX.
  6734         16  AM-VG-ACCOUNT                 PIC X(10).
  6735         16  AM-VG-DATE.
  6736             20  AM-VG-EXPIRATION-DT       PIC XX.
  6737             20  FILLER                    PIC X(4).
  6738         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6739                                           PIC 9(11)      COMP-3.
  6740     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6741         16  FILLER                        PIC X(10).
  6742         16  AM-VG-KEY3.
  6743             20  AM-VG3-ACCOUNT            PIC X(10).
  6744             20  AM-VG3-EXP-DT             PIC XX.
  6745         16  FILLER                        PIC X(4).
  6746     12  AM-MAINT-INFORMATION.
  6747         16  AM-LAST-MAINT-DT              PIC XX.
  6748         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6749         16  AM-LAST-MAINT-USER            PIC X(4).
  6750         16  FILLER                        PIC XX.
  6751
  6752     12  AM-EFFECTIVE-DT                   PIC XX.
  6753     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6754
  6755     12  AM-PREV-DATES  COMP-3.
  6756         16  AM-PREV-EXP-DT                PIC 9(11).
  6757         16  AM-PREV-EFF-DT                PIC 9(11).
  6758
  6759     12  AM-REPORT-CODE-1                  PIC X(10).
  6760     12  AM-REPORT-CODE-2                  PIC X(10).
  6761
  6762     12  AM-CITY-CODE                      PIC X(4).
  6763     12  AM-COUNTY-PARISH                  PIC X(6).
  6764
  6765     12  AM-NAME                           PIC X(30).
  6766     12  AM-PERSON                         PIC X(30).
  6767     12  AM-ADDRS                          PIC X(30).
  6768     12  AM-CITY.
  6769         16  AM-ADDR-CITY                  PIC X(28).
  6770         16  AM-ADDR-STATE                 PIC XX.
  6771     12  AM-ZIP.
  6772         16  AM-ZIP-PRIME.
  6773             20  AM-ZIP-PRI-1ST            PIC X.
  6774                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6775             20  FILLER                    PIC X(4).
  6776         16  AM-ZIP-PLUS4                  PIC X(4).
  6777     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 126
* EL050.cbl
  6778         16  AM-CAN-POSTAL-1               PIC XXX.
  6779         16  AM-CAN-POSTAL-2               PIC XXX.
  6780         16  FILLER                        PIC XXX.
  6781     12  AM-TEL-NO.
  6782         16  AM-AREA-CODE                  PIC 999.
  6783         16  AM-TEL-PRE                    PIC 999.
  6784         16  AM-TEL-NBR                    PIC 9(4).
  6785     12  AM-TEL-LOC                        PIC X.
  6786         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6787         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6788
  6789     12  AM-COMM-STRUCTURE.
  6790         16  AM-DEFN-1.
  6791             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6792                 24  AM-AGT.
  6793                     28  AM-AGT-PREFIX     PIC X(4).
  6794                     28  AM-AGT-PRIME      PIC X(6).
  6795                 24  AM-COM-TYP            PIC X.
  6796                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6797                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6798                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6799                 24  AM-RECALC-LV-INDIC    PIC X.
  6800                 24  AM-RETRO-LV-INDIC     PIC X.
  6801                 24  AM-GL-CODES           PIC X.
  6802                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6803                 24  FILLER                PIC X(01).
  6804         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6805             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6806                 24  FILLER                PIC X(11).
  6807                 24  AM-L-COMA             PIC XXX.
  6808                 24  AM-J-COMA             PIC XXX.
  6809                 24  AM-A-COMA             PIC XXX.
  6810                 24  FILLER                PIC X(6).
  6811
  6812     12  AM-COMM-CHANGE-STATUS             PIC X.
  6813         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6814
  6815     12  AM-CSR-CODE                       PIC X(4).
  6816
  6817     12  AM-BILLING-STATUS                 PIC X.
  6818         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6819         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6820     12  AM-AUTO-REFUND-SW                 PIC X.
  6821         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6822         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6823     12  AM-GPCD                           PIC 99.
  6824     12  AM-IG                             PIC X.
  6825         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6826         88  AM-HAS-GROUP                     VALUE '2'.
  6827     12  AM-STATUS                         PIC X.
  6828         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6829         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6830         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6831         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6832         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6833         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6834         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6835         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 127
* EL050.cbl
  6836         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6837         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6838     12  AM-REMIT-TO                       PIC 99.
  6839     12  AM-ID-NO                          PIC X(11).
  6840
  6841     12  AM-CAL-TABLE                      PIC XX.
  6842     12  AM-LF-DEVIATION                   PIC XXX.
  6843     12  AM-AH-DEVIATION                   PIC XXX.
  6844     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6845     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6846     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6847     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6848     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6849     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6850
  6851     12  AM-USER-FIELDS.
  6852         16  AM-FLD-1                      PIC XX.
  6853         16  AM-FLD-2                      PIC XX.
  6854         16  AM-FLD-3                      PIC XX.
  6855         16  AM-FLD-4                      PIC XX.
  6856         16  AM-FLD-5                      PIC XX.
  6857
  6858     12  AM-1ST-PROD-DATE.
  6859         16  AM-1ST-PROD-YR                PIC XX.
  6860         16  AM-1ST-PROD-MO                PIC XX.
  6861         16  AM-1ST-PROD-DA                PIC XX.
  6862     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6863     12  AM-CERTS-PURGED-DATE.
  6864         16  AM-PUR-YR                     PIC XX.
  6865         16  AM-PUR-MO                     PIC XX.
  6866         16  AM-PUR-DA                     PIC XX.
  6867     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6868     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6869     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6870     12  AM-INACTIVE-DATE.
  6871         16  AM-INA-MO                     PIC 99.
  6872         16  AM-INA-DA                     PIC 99.
  6873         16  AM-INA-YR                     PIC 99.
  6874     12  AM-AR-HI-CERT-DATE                PIC XX.
  6875
  6876     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6877     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6878
  6879     12  AM-OB-PAYMENT-MODE                PIC X.
  6880         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6881         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6882         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6883         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6884
  6885     12  AM-AH-ONLY-INDICATOR              PIC X.
  6886         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6887         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6888
  6889     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6890
  6891     12  AM-OVER-SHORT.
  6892         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6893         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 128
* EL050.cbl
  6894
  6895     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6896     12  AM-DCC-CLP-STATE                  PIC XX.
  6897
  6898     12  AM-RECALC-COMM                    PIC X.
  6899     12  AM-RECALC-REIN                    PIC X.
  6900
  6901     12  AM-REI-TABLE                      PIC XXX.
  6902     12  AM-REI-ET-LF                      PIC X.
  6903     12  AM-REI-ET-AH                      PIC X.
  6904     12  AM-REI-PE-LF                      PIC X.
  6905     12  AM-REI-PE-AH                      PIC X.
  6906     12  AM-REI-PRT-ST                     PIC X.
  6907     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6908     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6909     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6910     12  AM-REI-GROUP-A                    PIC X(6).
  6911     12  AM-REI-MORT                       PIC X(4).
  6912     12  AM-REI-PRT-OW                     PIC X.
  6913     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6914     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6915     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6916     12  AM-REI-GROUP-B                    PIC X(6).
  6917
  6918     12  AM-TRUST-TYPE                     PIC X(2).
  6919
  6920     12  AM-EMPLOYER-STMT-USED             PIC X.
  6921     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6922
  6923     12  AM-STD-AH-TYPE                    PIC XX.
  6924     12  AM-EARN-METHODS.
  6925         16  AM-EARN-METHOD-R              PIC X.
  6926             88 AM-REF-RL-R78                 VALUE 'R'.
  6927             88 AM-REF-RL-PR                  VALUE 'P'.
  6928             88 AM-REF-RL-MEAN                VALUE 'M'.
  6929             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6930         16  AM-EARN-METHOD-L              PIC X.
  6931             88 AM-REF-LL-R78                 VALUE 'R'.
  6932             88 AM-REF-LL-PR                  VALUE 'P'.
  6933             88 AM-REF-LL-MEAN                VALUE 'M'.
  6934             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6935         16  AM-EARN-METHOD-A              PIC X.
  6936             88 AM-REF-AH-R78                 VALUE 'R'.
  6937             88 AM-REF-AH-PR                  VALUE 'P'.
  6938             88 AM-REF-AH-MEAN                VALUE 'M'.
  6939             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6940             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6941             88 AM-REF-AH-NET                 VALUE 'N'.
  6942
  6943     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6944     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6945     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6946
  6947     12  AM-RET-Y-N                        PIC X.
  6948     12  AM-RET-P-E                        PIC X.
  6949     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6950     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6951     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 129
* EL050.cbl
  6952     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6953         16  AM-POOL-PRIME                 PIC XXX.
  6954         16  AM-POOL-SUB                   PIC XXX.
  6955     12  AM-RETRO-EARNINGS.
  6956         16  AM-RET-EARN-R                 PIC X.
  6957         16  AM-RET-EARN-L                 PIC X.
  6958         16  AM-RET-EARN-A                 PIC X.
  6959     12  AM-RET-ST-TAX-USE                 PIC X.
  6960         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6961         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6962     12  AM-RETRO-BEG-EARNINGS.
  6963         16  AM-RET-BEG-EARN-R             PIC X.
  6964         16  AM-RET-BEG-EARN-L             PIC X.
  6965         16  AM-RET-BEG-EARN-A             PIC X.
  6966     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6967     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6968
  6969     12  AM-USER-SELECT-OPTIONS.
  6970         16  AM-USER-SELECT-1              PIC X(10).
  6971         16  AM-USER-SELECT-2              PIC X(10).
  6972         16  AM-USER-SELECT-3              PIC X(10).
  6973         16  AM-USER-SELECT-4              PIC X(10).
  6974         16  AM-USER-SELECT-5              PIC X(10).
  6975
  6976     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6977
  6978     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6979
  6980     12  AM-RPT045A-SWITCH                 PIC X.
  6981         88  RPT045A-OFF                   VALUE 'N'.
  6982
  6983     12  AM-INSURANCE-LIMITS.
  6984         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6985         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6986
  6987     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6988         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6989
  6990     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6991         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6992         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6993
  6994     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6995
  6996     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6997     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6998     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6999     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7000     12  AM-DCC-UEF-STATE                  PIC XX.
  7001     12  FILLER                            PIC XXX.
  7002     12  AM-REPORT-CODE-3                  PIC X(10).
  7003*    12  FILLER                            PIC X(22).
  7004
  7005     12  AM-RESERVE-DATE.
  7006         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7007         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7008         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7009
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 130
* EL050.cbl
  7010     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7011     12  AM-NOTIFICATION-TYPES.
  7012         16  AM-NOTIF-OF-LETTERS           PIC X.
  7013         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7014         16  AM-NOTIF-OF-REPORTS           PIC X.
  7015         16  AM-NOTIF-OF-STATUS            PIC X.
  7016
  7017     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7018         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7019         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7020         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7021         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7022
  7023     12  AM-BENEFIT-CONTROLS.
  7024         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7025             20  AM-BENEFIT-CODE           PIC XX.
  7026             20  AM-BENEFIT-TYPE           PIC X.
  7027             20  AM-BENEFIT-REVISION       PIC XXX.
  7028             20  AM-BENEFIT-REM-TERM       PIC X.
  7029             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7030             20  FILLER                    PIC XX.
  7031         16  FILLER                        PIC X(80).
  7032
  7033     12  AM-TRANSFER-DATA.
  7034         16  AM-TRANSFERRED-FROM.
  7035             20  AM-TRNFROM-CARRIER        PIC X.
  7036             20  AM-TRNFROM-GROUPING.
  7037                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7038                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7039             20  AM-TRNFROM-STATE          PIC XX.
  7040             20  AM-TRNFROM-ACCOUNT.
  7041                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7042                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7043             20  AM-TRNFROM-DTE            PIC XX.
  7044         16  AM-TRANSFERRED-TO.
  7045             20  AM-TRNTO-CARRIER          PIC X.
  7046             20  AM-TRNTO-GROUPING.
  7047                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7048                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7049             20  AM-TRNTO-STATE            PIC XX.
  7050             20  AM-TRNTO-ACCOUNT.
  7051                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7052                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7053             20  AM-TRNTO-DTE              PIC XX.
  7054         16  FILLER                        PIC X(10).
  7055
  7056     12  AM-SAVED-REMIT-TO                 PIC 99.
  7057
  7058     12  AM-COMM-STRUCTURE-SAVED.
  7059         16  AM-DEFN-1-SAVED.
  7060             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7061                 24  AM-AGT-SV             PIC X(10).
  7062                 24  AM-COM-TYP-SV         PIC X.
  7063                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7064                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7065                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7066                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7067                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 131
* EL050.cbl
  7068                 24  AM-GL-CODES-SV        PIC X.
  7069                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7070                 24  FILLER                PIC X.
  7071         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7072             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7073                 24  FILLER                PIC X(11).
  7074                 24  AM-L-COMA-SV          PIC XXX.
  7075                 24  AM-J-COMA-SV          PIC XXX.
  7076                 24  AM-A-COMA-SV          PIC XXX.
  7077                 24  FILLER                PIC X(6).
  7078
  7079     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7080         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7081            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7082            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7083            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7084
  7085     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7086     12  FILLER                            PIC X(120).
  7087
  7088     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7089         16  AM-CONTROL-NAME               PIC X(30).
  7090         16  AM-EXECUTIVE-ONE.
  7091             20  AM-EXEC1-NAME             PIC X(15).
  7092             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7093                                                          COMP-3.
  7094             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7095                                                          COMP-3.
  7096         16  AM-EXECUTIVE-TWO.
  7097             20  AM-EXEC2-NAME             PIC X(15).
  7098             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7099                                                          COMP-3.
  7100             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7101                                                          COMP-3.
  7102
  7103     12  AM-RETRO-ADDITIONAL-DATA.
  7104         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7105         16  AM-RETRO-PREM-P-E             PIC X.
  7106         16  AM-RETRO-CLMS-P-I             PIC X.
  7107         16  AM-RETRO-RET-BRACKET-LF.
  7108             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7109                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7110                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7111             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7112                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7113                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7114             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7115                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7116                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7117         16  AM-RETRO-RET-BRACKET-AH.
  7118             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7119                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7120                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7121                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7122             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7123                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7124                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7125             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 132
* EL050.cbl
  7126                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7127                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7128
  7129     12  AM-COMMENTS.
  7130         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7131
  7132     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7133         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7134         16  AM-FLI-BILLING-CODE           PIC X.
  7135         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7136         16  AM-FLI-UNITED-IDENT           PIC X.
  7137         16  AM-FLI-INTEREST-LOST-DATA.
  7138             20  AM-FLI-BANK-NO            PIC X(5).
  7139             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7140             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7141             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7142         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7143             20  AM-FLI-AGT                PIC X(9).
  7144             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7145             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7146         16  FILLER                        PIC X(102).
  7147
  7148     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7149         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7150             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7151             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7152             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7153             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7154             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7155         16  FILLER                          PIC X(10).
  7156******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 133
* EL050.cbl
  7158*    COPY ERCREIN.
  7159******************************************************************
  7160*                                                                *
  7161*                            ERCREIN                             *
  7162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7163*                            VMOD=2.010                          *
  7164*                                                                *
  7165*   ONLINE CREDIT SYSTEM                                         *
  7166*                                                                *
  7167*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7168*                                                                *
  7169*   FILE TYPE = VSAM,KSDS                                        *
  7170*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7171*                                                                *
  7172*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7173*       ALTERNATE PATH = NONE                                    *
  7174*                                                                *
  7175*   LOG = NO                                                     *
  7176*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7177*                                                                *
  7178******************************************************************
  7179*                   C H A N G E   L O G
  7180*
  7181* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7182*-----------------------------------------------------------------
  7183*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7184* EFFECTIVE    NUMBER
  7185*-----------------------------------------------------------------
  7186* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7187* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7188******************************************************************
  7189 01  REINSURANCE-RECORD.
  7190     12  RE-RECORD-ID                      PIC XX.
  7191         88  VALID-RE-ID                      VALUE 'RE'.
  7192
  7193     12  RE-CONTROL-PRIMARY.
  7194         16  RE-COMPANY-CD                 PIC X.
  7195         16  RE-KEY.
  7196             20  RE-CODE                   PIC X.
  7197                 88  RE-TABLE-RECORD          VALUE 'A'.
  7198                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7199             20  RE-TABLE                  PIC XXX.
  7200             20  FILLER                    PIC XXX.
  7201         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7202             20  FILLER                    PIC X.
  7203             20  RE-COMPANY.
  7204                 24  RE-COMP-PRIME         PIC XXX.
  7205                 24  RE-COMP-SUB           PIC XXX.
  7206
  7207     12  RE-MAINT-INFORMATION.
  7208         16  RE-LAST-MAINT-DT              PIC XX.
  7209         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7210         16  RE-LAST-MAINT-USER            PIC X(4).
  7211         16  FILLER                        PIC X(10).
  7212
  7213     12  RE-TABLE-DATA.
  7214         16  RE-100-COMP                   PIC 99.
  7215
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 134
* EL050.cbl
  7216         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7217             20  RE-REI-COMP-NO.
  7218                 24  RE-REI-COMP           PIC XXX.
  7219                 24  RE-REI-COMP-SUB       PIC XXX.
  7220             20  RE-LF-QC                  PIC X.
  7221             20  RE-AH-QC                  PIC X.
  7222             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7223             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7224             20  RE-LFAGE-LO               PIC 99.
  7225             20  RE-LFAGE-HI               PIC 99.
  7226             20  RE-AHAGE-LO               PIC 99.
  7227             20  RE-AHAGE-HI               PIC 99.
  7228             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7229             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7230             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7231             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7232             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7233             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7234             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7235             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7236             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7237             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7238             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7239             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7240             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7241             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7242             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7243             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7244             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7245             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7246             20  RE-LF-BEN-CODE            PIC X.
  7247             20  RE-AH-BEN-CODE            PIC X.
  7248             20  RE-INTERACTIVE            PIC X.
  7249             20  RE-REMAINING              PIC X.
  7250             20  RE-LF-RUNOFF-SW           PIC X.
  7251             20  RE-AH-RUNOFF-SW           PIC X.
  7252             20  FILLER                    PIC X(19).
  7253
  7254         16  RE-COMP-INFO-END              PIC X(6).
  7255         16  RE-NSP-ST-CD-LF               PIC XX.
  7256         16  RE-NSP-ST-CD-AH               PIC XX.
  7257         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7258             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7259
  7260         16  FILLER                        PIC X(27).
  7261
  7262     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7263         16  RE-NAME                       PIC X(30).
  7264         16  RE-LF-PE                      PIC X.
  7265         16  RE-AH-PE                      PIC X.
  7266         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7267         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7268         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7269         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7270         16  RE-PRT-ST                     PIC X.
  7271         16  RE-PRT-OW                     PIC X.
  7272         16  RE-MORT-CODE                  PIC X(4).
  7273         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 135
* EL050.cbl
  7274         16  RE-ZERO-LF-FEE                PIC X.
  7275         16  RE-ZERO-AH-FEE                PIC X.
  7276         16  RE-CEDE-NAME                  PIC X(30).
  7277         16  RE-LF-COMM                    PIC X.
  7278         16  RE-AH-COMM                    PIC X.
  7279         16  RE-LF-TAX                     PIC X.
  7280         16  RE-AH-TAX                     PIC X.
  7281         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7282         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7283         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7284
  7285         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7286             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7287
  7288         16  RE-LF-CEDING-FEE-BRACKETS.
  7289             20  RE-LF-FEE-METHOD          PIC X.
  7290                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7291                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7292                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7293                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7294             20  RE-LF-FEE-BASIS           PIC X.
  7295                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7296                 88  RE-LF-NET-CEDED               VALUE '2'.
  7297                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7298                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7299                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7300                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7301                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7302                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7303             20  FILLER                    PIC XXX.
  7304             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7305                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7306                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7307
  7308         16  RE-AH-CEDING-FEE-BRACKETS.
  7309             20  RE-AH-FEE-METHOD          PIC X.
  7310                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7311                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7312                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7313                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7314             20  RE-AH-FEE-BASIS           PIC X.
  7315                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7316                 88  RE-AH-NET-CEDED               VALUE '2'.
  7317                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7318                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7319                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7320                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7321                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7322                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7323             20  FILLER                    PIC XXX.
  7324             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7325                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7326                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7327
  7328         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7329
  7330         16  RE-OLD-CEDING-STMT            PIC X.
  7331
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 136
* EL050.cbl
  7332         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7333         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7334         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7335         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7336         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7337         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7338         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7339         16  RE-MORT-SW                    PIC X.
  7340         16  RE-CEDING-TYPE-FLAG           PIC X.
  7341             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7342             88  RE-CEDED                          VALUE 'C'.
  7343             88  RE-ASSUMED                        VALUE 'A'.
  7344             88  RE-PHANTOM                        VALUE 'P'.
  7345
  7346         16  RE-CEDING-STMT-OPT-A          PIC X.
  7347             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7348         16  RE-CEDING-STMT-OPT-B          PIC X.
  7349             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7350         16  RE-CEDING-STMT-OPT-C          PIC X.
  7351             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7352         16  RE-CEDING-STMT-OPT-D          PIC X.
  7353             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7354         16  RE-CEDING-STMT-OPT-E          PIC X.
  7355             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7356
  7357         16  RE-PRT-CRSV                   PIC X.
  7358
  7359         16  RE-GL-CENTER                  PIC X(4).
  7360
  7361         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7362
  7363         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7364
  7365         16  RE-EARN-STOP-CODE             PIC X.
  7366             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7367             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7368
  7369         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7370             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7371
  7372         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7373         16  FILLER                        PIC X(2281).
  7374
  7375         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7376
  7377******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 137
* EL050.cbl
  7379*    COPY ERCCTBL.
  7380******************************************************************
  7381*                                                                *
  7382*                                                                *
  7383*                            ERCCTBL                             *
  7384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7385*                            VMOD=2.003
  7386*                                                                *
  7387*   ONLINE CREDIT SYSTEM                                         *
  7388*                                                                *
  7389*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7390*                                                                *
  7391*   FILE TYPE = VSAM,KSDS                                        *
  7392*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7393*                                                                *
  7394*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7395*       ALTERNATE PATH = NONE                                    *
  7396*                                                                *
  7397*   LOG = NO                                                     *
  7398*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7399*                                                                *
  7400*                                                                *
  7401******************************************************************
  7402
  7403 01  COMM-TABLE-RECORD.
  7404     12  CT-RECORD-ID                      PIC XX.
  7405         88  VALID-CT-ID                      VALUE 'CT'.
  7406
  7407     12  CT-CONTROL-PRIMARY.
  7408         16  CT-COMPANY-CD                 PIC X.
  7409         16  CT-TABLE                      PIC XXX.
  7410         16  CT-CNTRL-2.
  7411             20  CT-BEN-TYPE               PIC X.
  7412             20  CT-BEN-CODE               PIC XX.
  7413
  7414     12  CT-MAINT-INFORMATION.
  7415         16  CT-LAST-MAINT-DT              PIC XX.
  7416         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7417         16  CT-LAST-MAINT-USER            PIC X(4).
  7418         16  FILLER                        PIC X(31).
  7419
  7420     12  CT-LIMITS.
  7421         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7422
  7423         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7424
  7425         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7426
  7427     12  CT-RATES.
  7428         16  CT-RTX          OCCURS 27 TIMES.
  7429             20  CT-RT                     PIC SV9(5)     COMP-3.
  7430             20  CT-RT-R   REDEFINES
  7431                 CT-RT                     PIC XXX.
  7432
  7433     12  FILLER                            PIC  X(42).
  7434
  7435******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 138
* EL050.cbl
  7437*    COPY ERCFORM.
  7438******************************************************************
  7439*                                                                *
  7440*                                                                *
  7441*                            ERCFORM.                            *
  7442*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7443*                            VMOD=2.003                          *
  7444*                                                                *
  7445*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7446*                                                                *
  7447*    FILE TYPE = VSAM,KSDS                                       *
  7448*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7449*                                                                *
  7450*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7451*                                                                *
  7452*    LOG = YES                                                   *
  7453*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7454******************************************************************
  7455 01  FORM-MASTER.
  7456    12  FO-RECORD-ID                 PIC X(02).
  7457        88  VALID-FO-ID                  VALUE 'FO'.
  7458
  7459    12  FO-CONTROL-PRIMARY.
  7460        16  FO-COMPANY-CD            PIC X(01).
  7461        16  FO-STATE                 PIC X(02).
  7462        16  FO-FORM-ID               PIC X(12).
  7463        16  FO-FORM-EXP-DT           PIC X(02).
  7464
  7465    12  FO-POLICY-FORM-DATA.
  7466        16  FO-IND-GRP-CD            PIC X(01).
  7467        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7468        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7469        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7470        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7471        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7472        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7473        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7474        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7475        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7476        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7477        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7478        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7479        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7480        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7481        16  FO-APP-CERT-USE-CD       PIC X(01).
  7482
  7483    12  FILLER                       PIC X(29).
  7484
  7485    12  FO-FORM-PLAN-TABLE.
  7486        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7487            20  FO-PLAN-TYPE         PIC X(01).
  7488            20  FO-PLAN-ID           PIC X(02).
  7489            20  FO-PLAN-TERM         PIC 9(03).
  7490            20  FO-PLAN-REFUND-METHOD
  7491                                     PIC X.
  7492
  7493    12  FILLER                       PIC X(30).
  7494
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 139
* EL050.cbl
  7495    12  FO-COMMENTS-AREA.
  7496        16  FO-COMMENT-LINE-1        PIC X(78).
  7497
  7498    12  FILLER                       PIC X(20).
  7499
  7500    12  FO-MAINT-INFORMATION.
  7501        16  FO-LAST-MAINT-DT         PIC X(02).
  7502        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7503        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 140
* EL050.cbl
  7505*    COPY ELCMSTR.
  7506******************************************************************
  7507*                                                                *
  7508*                            ELCMSTR.                            *
  7509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7510*                            VMOD=2.012                          *
  7511*                                                                *
  7512*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7513*                                                                *
  7514*   FILE TYPE = VSAM,KSDS                                        *
  7515*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7516*                                                                *
  7517*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7518*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7519*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7520*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7521*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7522*                                                 RKP=75,LEN=21  *
  7523*                                                                *
  7524*   **** NOTE ****                                               *
  7525*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7526*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7527*                                                                *
  7528*   LOG = YES                                                    *
  7529*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7530******************************************************************
  7531*                   C H A N G E   L O G
  7532*
  7533* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7534*-----------------------------------------------------------------
  7535*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7536* EFFECTIVE    NUMBER
  7537*-----------------------------------------------------------------
  7538* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7539* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7540* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7541* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7542* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7543* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7544******************************************************************
  7545 01  CLAIM-MASTER.
  7546     12  CL-RECORD-ID                PIC XX.
  7547         88  VALID-CL-ID         VALUE 'CL'.
  7548
  7549     12  CL-CONTROL-PRIMARY.
  7550         16  CL-COMPANY-CD           PIC X.
  7551         16  CL-CARRIER              PIC X.
  7552         16  CL-CLAIM-NO             PIC X(7).
  7553         16  CL-CERT-NO.
  7554             20  CL-CERT-PRIME       PIC X(10).
  7555             20  CL-CERT-SFX         PIC X.
  7556
  7557     12  CL-CONTROL-BY-NAME.
  7558         16  CL-COMPANY-CD-A1        PIC X.
  7559         16  CL-INSURED-LAST-NAME    PIC X(15).
  7560         16  CL-INSURED-NAME.
  7561             20  CL-INSURED-1ST-NAME PIC X(12).
  7562             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 141
* EL050.cbl
  7563
  7564     12  CL-CONTROL-BY-SSN.
  7565         16  CL-COMPANY-CD-A2        PIC X.
  7566         16  CL-SOC-SEC-NO.
  7567             20  CL-SSN-STATE        PIC XX.
  7568             20  CL-SSN-ACCOUNT      PIC X(6).
  7569             20  CL-SSN-LN3          PIC X(3).
  7570
  7571     12  CL-CONTROL-BY-CERT-NO.
  7572         16  CL-COMPANY-CD-A4        PIC X.
  7573         16  CL-CERT-NO-A4.
  7574             20  CL-CERT-A4-PRIME    PIC X(10).
  7575             20  CL-CERT-A4-SFX      PIC X.
  7576
  7577     12  CL-CONTROL-BY-CCN.
  7578         16  CL-COMPANY-CD-A5        PIC X.
  7579         16  CL-CCN-A5.
  7580             20  CL-CCN.
  7581                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7582                 24  CL-CCN-PRIME-A5 PIC X(12).
  7583             20  CL-CCN-FILLER-A5    PIC X(4).
  7584
  7585     12  CL-INSURED-PROFILE-DATA.
  7586         16  CL-INSURED-BIRTH-DT     PIC XX.
  7587         16  CL-INSURED-SEX-CD       PIC X.
  7588             88  INSURED-IS-MALE        VALUE 'M'.
  7589             88  INSURED-IS-FEMALE      VALUE 'F'.
  7590             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7591         16  CL-INSURED-OCC-CD       PIC X(6).
  7592         16  FILLER                  PIC X(5).
  7593
  7594     12  CL-PROCESSING-INFO.
  7595         16  CL-PROCESSOR-ID         PIC X(4).
  7596         16  CL-CLAIM-STATUS         PIC X.
  7597             88  CLAIM-IS-OPEN          VALUE 'O'.
  7598             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7599         16  CL-CLAIM-TYPE           PIC X.
  7600*            88  AH-CLAIM               VALUE 'A'.
  7601*            88  LIFE-CLAIM             VALUE 'L'.
  7602*            88  PROPERTY-CLAIM         VALUE 'P'.
  7603*            88  IUI-CLAIM              VALUE 'I'.
  7604*            88  GAP-CLAIM              VALUE 'G'.
  7605*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7606         16  CL-CLAIM-PREM-TYPE      PIC X.
  7607             88  SINGLE-PREMIUM         VALUE '1'.
  7608             88  O-B-COVERAGE           VALUE '2'.
  7609             88  OPEN-END-COVERAGE      VALUE '3'.
  7610         16  CL-INCURRED-DT          PIC XX.
  7611         16  CL-REPORTED-DT          PIC XX.
  7612         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7613         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7614         16  CL-LAST-PMT-DT          PIC XX.
  7615         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7616         16  CL-PAID-THRU-DT         PIC XX.
  7617         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7618         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7619         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7620         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 142
* EL050.cbl
  7621             88  CL-360-DAY-YR          VALUE '1'.
  7622             88  CL-365-DAY-YR          VALUE '2'.
  7623             88  CL-FULL-MONTHS         VALUE '3'.
  7624         16  CL-CAUSE-CD             PIC X(6).
  7625
  7626         16  CL-PRIME-CERT-NO.
  7627             20  CL-PRIME-CERT-PRIME PIC X(10).
  7628             20  CL-PRIME-CERT-SFX   PIC X.
  7629
  7630         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7631             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7632             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7633
  7634         16  CL-MICROFILM-NO         PIC X(10).
  7635         16  FILLER REDEFINES CL-MICROFILM-NO.
  7636             20  CL-BENEFIT-PERIOD   PIC 99.
  7637             20  FILLER              PIC X(8).
  7638         16  CL-PROG-FORM-TYPE       PIC X.
  7639         16  CL-LAST-ADD-ON-DT       PIC XX.
  7640
  7641         16  CL-LAST-REOPEN-DT       PIC XX.
  7642         16  CL-LAST-CLOSE-DT        PIC XX.
  7643         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7644             88  FINAL-PAID             VALUE '1'.
  7645             88  CLAIM-DENIED           VALUE '2'.
  7646             88  AUTO-CLOSE             VALUE '3'.
  7647             88  MANUAL-CLOSE           VALUE '4'.
  7648             88  BENEFITS-CHANGED       VALUE 'C'.
  7649             88  SETUP-ERRORS           VALUE 'E'.
  7650         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7651         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7652         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7653             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7654         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7655         16  FILLER                  PIC X.
  7656
  7657     12  CL-CERTIFICATE-DATA.
  7658         16  CL-CERT-ORIGIN          PIC X.
  7659             88  CERT-WAS-ONLINE        VALUE '1'.
  7660             88  CERT-WAS-CREATED       VALUE '2'.
  7661             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7662         16  CL-CERT-KEY-DATA.
  7663             20  CL-CERT-CARRIER     PIC X.
  7664             20  CL-CERT-GROUPING    PIC X(6).
  7665             20  CL-CERT-STATE       PIC XX.
  7666             20  CL-CERT-ACCOUNT.
  7667                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7668                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7669             20  CL-CERT-EFF-DT      PIC XX.
  7670
  7671     12  CL-STATUS-CONTROLS.
  7672         16  CL-PRIORITY-CD          PIC X.
  7673             88  CONFIDENTIAL-DATA      VALUE '8'.
  7674             88  HIGHEST-PRIORITY       VALUE '9'.
  7675         16  CL-SUPV-ATTN-CD         PIC X.
  7676             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7677             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7678         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 143
* EL050.cbl
  7679         16  CL-RESTORED-DT          PIC XX.
  7680         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7681         16  CL-NEXT-RESEND-DT       PIC XX.
  7682         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7683         16  CL-CRITICAL-PERIOD      PIC 99.
  7684*        16  FILLER                  PIC XX.
  7685         16  CL-LAST-MAINT-DT        PIC XX.
  7686         16  CL-LAST-MAINT-USER      PIC X(4).
  7687         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7688         16  CL-LAST-MAINT-TYPE      PIC X.
  7689             88  CLAIM-SET-UP           VALUE ' '.
  7690             88  PAYMENT-MADE           VALUE '1'.
  7691             88  LETTER-SENT            VALUE '2'.
  7692             88  MASTER-WAS-ALTERED     VALUE '3'.
  7693             88  MASTER-WAS-RESTORED    VALUE '4'.
  7694             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7695             88  FILE-CONVERTED         VALUE '6'.
  7696             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7697             88  ERROR-CORRECTION       VALUE 'E'.
  7698         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7699         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7700         16  CL-BENEFICIARY          PIC X(10).
  7701         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7702         16  CL-DENIAL-TYPE          PIC X.
  7703             88  CL-TYPE-DENIAL          VALUE '1'.
  7704             88  CL-TYPE-RESCISSION      VALUE '2'.
  7705             88  CL-TYPE-REFORMATION     VALUE '3'.
  7706             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7707             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7708         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7709         16  filler                  pic x(3).
  7710*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7711*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7712*        16  CL-RTW-DT               PIC XX.
  7713
  7714     12  CL-TRAILER-CONTROLS.
  7715         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7716             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7717             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7718             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7719         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7720         16  FILLER                  PIC XX.
  7721         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7722         16  CL-ADDRESS-TRAILER-CNT.
  7723             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7724                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7725             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7726                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7727             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7728                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7729             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7730                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7731             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7732                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7733             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7734                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7735             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7736                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 144
* EL050.cbl
  7737
  7738     12  CL-CV-REFERENCE-NO.
  7739         16  CL-CV-REFNO-PRIME       PIC X(18).
  7740         16  CL-CV-REFNO-SFX         PIC XX.
  7741
  7742     12  CL-FILE-LOCATION            PIC X(4).
  7743
  7744     12  CL-PROCESS-ERRORS.
  7745         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7746             88  NO-FATAL-ERRORS        VALUE ZERO.
  7747         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7748             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7749
  7750     12  CL-PRODUCT-CD               PIC X.
  7751
  7752     12  CL-CURRENT-KEY-DATA.
  7753         16  CL-CURRENT-CARRIER      PIC X.
  7754         16  CL-CURRENT-GROUPING     PIC X(6).
  7755         16  CL-CURRENT-STATE        PIC XX.
  7756         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7757
  7758     12  CL-ASSOCIATES               PIC X.
  7759         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7760         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7761         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7762         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7763
  7764     12  CL-ACTIVITY-CODE            PIC 99.
  7765     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7766     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7767
  7768     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7769     12  CL-LAG-REPORT-CODE          PIC 9.
  7770     12  CL-LOAN-TYPE                PIC XX.
  7771     12  CL-LEGAL-STATE              PIC XX.
  7772
  7773     12  CL-YESNOSW                  PIC X.
  7774     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7775         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7776         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7777         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7778     12  cl-insured-type             pic x.
  7779         88  cl-claim-on-primary         value 'P'.
  7780         88  cl-claim-on-co-borrower     value 'C'.
  7781     12  cl-benefit-expiration-dt    PIC XX.
  7782
  7783 01  PLAN-RECORDS.
  7784     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7785     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7786
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 145
* EL050.cbl
  7788 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7789                          ACCOUNT-MASTER REINSURANCE-RECORD
  7790                          COMM-TABLE-RECORD FORM-MASTER
  7791                          CLAIM-MASTER PLAN-RECORDS.
  7792 0000-DFHEXIT SECTION.
  7793     MOVE '9#                    $   ' TO DFHEIV0.
  7794     MOVE 'EL050' TO DFHEIV1.
  7795     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7796
  7797     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7798
  7799
  7800* EXEC CICS  HANDLE CONDITION
  7801*           ERROR    (9300-ABEND)
  7802*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7803*    END-EXEC.
  7804*    MOVE '"$.J                  ! " #00007795' TO DFHEIV0
  7805     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7807     MOVE X'2220233030303037373935' TO DFHEIV0(25:11)
  7808     CALL 'kxdfhei1' USING DFHEIV0
  7809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7810
  7811
  7812 0000-COPY-PROCEDURE-DIV.
  7813*                          COPY ELC50PD.
  7814******************************************************************
  7815*                                                                *
  7816*                            ELC50PD                             *
  7817*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7818*                            VMOD=2.188                          *
  7819*                                                                *
  7820******************************************************************
  7821*                   C H A N G E   L O G
  7822*
  7823* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7824*-----------------------------------------------------------------
  7825*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7826* EFFECTIVE    NUMBER
  7827*-----------------------------------------------------------------
  7828* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7829* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7830* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7831*                             2709 AND 2718
  7832* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7833* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7834* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7835* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7836* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7837*                                IS OPEN OR CNC DT < PD THRU
  7838* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7839* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7840* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7841* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7842* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7843* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7844* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7845* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 146
* EL050.cbl
  7846* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7847* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7848* 020906                   PEMA  EXPAND LOAN OFFICER
  7849* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7850* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7851* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7852* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7853* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7854* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7855* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7856* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7857* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7858* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7859* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7860* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7861* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7862* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7863* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7864* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7865* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7866* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7867* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7868* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7869* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7870* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7871* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7872* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7873* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7874*                                UPDATE VIN ON CERT TRAILER
  7875* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7876* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7877* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7878* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7879* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7880* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7881* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7882* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7883* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7884* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7885* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7886* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7887* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7888* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7889* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7890* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7891* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7892* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7893* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7894* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7895* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7896* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7897* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7898* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7899* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7900* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7901* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7902* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7903* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 147
* EL050.cbl
  7904* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7905* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7906* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7907* 032912  CR2011110200001  PEMA  AHL CHANGES
  7908* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7909* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7910* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7911* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7912* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7913* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7914* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7915* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7916* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7917* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7918* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7919* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7920* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7921* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7922* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7923* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7924* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7925* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7926* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7927* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7928* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7929* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7930* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7931* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7932* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7933* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7934* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7935*                                CERT #, ADD 2898 FORCIBLE ERROR
  7936* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7937* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7938* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7939* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7940* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7941* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7942* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7943* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7944* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7945* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7946* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7947* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7948* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7949* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7950* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7951* 100617  CR2017062000003  PEMA  New comm cap edits
  7952* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7953* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7954* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7955* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7956* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7957* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  7958******************************************************************
  7959************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7960******************************************************************
  7961
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 148
* EL050.cbl
  7962     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7963
  7964     MOVE SPACES                 TO PB-FATAL-FLAG
  7965                                    PB-FORCE-ER-CD
  7966                                    PB-WARN-ER-CD
  7967                                    PB-OUT-BAL-CD.
  7968
  7969     MOVE SPACE                  TO WS-IG-OVRD-AH
  7970                                    WS-IG-OVRD-LF
  7971                                    WS-IG-OVRD-AM
  7972                                    WS-IG-OVRD
  7973                                    WS-IG-OVRD-AH-PL
  7974                                    WS-IG-OVRD-LF-PL
  7975                                    WS-IG-OVRD-AH-BEN
  7976                                    WS-IG-OVRD-LF-BEN.
  7977
  7978******************************************************************
  7979*************       INITIALIZE COMMON ERRORS       ***************
  7980******************************************************************
  7981
  7982     MOVE +0                     TO PB-NO-OF-ERRORS.
  7983     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7984
  7985******************************************************************
  7986
  7987     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7988     SET JULIAN-TO-BIN           TO TRUE.
  7989*    MOVE 5                      TO DC-OPTION-CODE.
  7990     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7991     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7992
  7993     MOVE ZERO                   TO  SUB4.
  7994
  7995 0040-INITIALIZE-GA-BILL-DT.
  7996
  7997     ADD +1                      TO  SUB4.
  7998
  7999     IF  SUB4 GREATER THAN +5
  8000         GO TO 0050-CHECK-CNTL-FOUND.
  8001
  8002     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8003         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8004
  8005     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8006
  8007 0050-CHECK-CNTL-FOUND.
  8008
  8009     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8010        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8011                                         WS-AH-REM-TERM-CALC
  8012                                         EC-CO-REM-TERM-CALC
  8013        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8014        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8015        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8016                                         WS-TOL-AH-CLAIM
  8017        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  8018                                         WS-TOL-AH-PREM
  8019                                         EC-CO-TOL-PREM
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 149
* EL050.cbl
  8020        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8021                                         WS-TOL-AH-REFUND
  8022                                         EC-CO-TOL-REFUND
  8023        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8024                                         WS-AH-REFUND-OVS-AMT
  8025                                         EC-CO-OVR-SHT-AMT
  8026        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8027                                         WS-TOL-AH-PREM-PCT
  8028                                         EC-CO-TOL-PREM-PCT
  8029        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8030                                         WS-TOL-AH-REFUND-PCT
  8031                                         EC-CO-TOL-REFUND-PCT
  8032        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8033                                         WS-AH-REFUND-OVS-PCT
  8034                                         EC-CO-OVR-SHT-PCT
  8035        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8036        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8037        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8038        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8039        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8040        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8041        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8042        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8043        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8044        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8045        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8046        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8047                                         EC-CO-MONTH-END-DT
  8048        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8049          GO TO 0100-READ-ACCT.
  8050
  8051     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8052     MOVE SPACES                 TO CNTL-ACCESS.
  8053     MOVE '1'                    TO CNTL-REC-TYPE.
  8054     MOVE +0                     TO CNTL-SEQ-NO.
  8055
  8056     MOVE '1' TO RC-SW-1.
  8057     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8058     IF NOT CF-COMPANY-MASTER
  8059         MOVE ZEROS             TO WK-CO-TOL-PREM
  8060                                   WK-CO-TOL-CLAIM
  8061                                   WK-CO-TOL-REFUND
  8062                                   WK-REFUND-OVS-AMT
  8063                                   WK-REFUND-OVS-PCT
  8064                                   WK-CO-TOL-PREM-PCT
  8065                                   WK-CO-TOL-REFUND-PCT
  8066                                   WK-DEFAULT-APR
  8067                                   WK-CO-MAX-CAP
  8068        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8069                                   WK-CR-R78-METHOD
  8070                                   WK-CO-REF-REJECT-SW
  8071                                   WK-CO-PREM-REJECT-SW
  8072                                   WK-REM-TRM-CALC-OPTION
  8073                                   WK-BIRTH-DATE-INPUT
  8074                                   WK-JOINT-AGE-INPUT
  8075        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8076        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8077        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 150
* EL050.cbl
  8078        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8079          GO TO 0099-COMPANY-NOT-FOUND.
  8080
  8081     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8082        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8083     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8084        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8085     IF CF-CO-TOL-CAP NOT NUMERIC
  8086        MOVE +0                    TO CF-CO-TOL-CAP.
  8087     IF CF-DEFAULT-APR NOT NUMERIC
  8088        MOVE +0                    TO CF-DEFAULT-APR.
  8089
  8090     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8091     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8092     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8093     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8094     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8095     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8096     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8097     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8098     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8099     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8100     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8101     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8102
  8103     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8104          CF-CO-OVR-SHT-AMT > +0
  8105        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8106
  8107     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8108          CF-CO-OVR-SHT-PCT > +0
  8109        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8110
  8111     IF CF-VALID-REM-TRM-OPTION
  8112         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8113     ELSE
  8114         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8115
  8116     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8117     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8118     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8119     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8120
  8121     GO TO 0050-CHECK-CNTL-FOUND.
  8122
  8123 0099-COMPANY-NOT-FOUND.
  8124
  8125     MOVE ER-2616                TO WS-ERROR.
  8126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8127
  8128 0100-READ-ACCT.
  8129
  8130     MOVE SPACES                 TO DATE-RANGE-SW.
  8131
  8132     IF WK-ACCT-ADDR = ZEROS
  8133        GO TO 0102-ACCT-GETMAIN.
  8134
  8135     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 151
* EL050.cbl
  8136     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8137     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8138
  8139     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8140        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8141        GO TO 0105-READ-ACCT
  8142     END-IF
  8143
  8144     IF PB-CARRIER NOT = SPACES
  8145        IF PB-CARRIER NOT = AM-VG-CARRIER
  8146           GO TO 0105-READ-ACCT.
  8147
  8148     IF PB-STATE NOT = SPACES
  8149        IF PB-STATE NOT = AM-VG-STATE
  8150           GO TO 0105-READ-ACCT.
  8151
  8152     IF PB-GROUPING NOT = SPACES
  8153        IF PB-GROUPING NOT = AM-VG-GROUPING
  8154           GO TO 0105-READ-ACCT.
  8155
  8156     MOVE 'X'                 TO DATE-RANGE-SW.
  8157
  8158     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8159        MOVE 'X'                 TO DATE-RANGE-SW
  8160        GO TO 0105-READ-ACCT.
  8161
  8162     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8163        GO TO 0105-READ-ACCT.
  8164
  8165     GO TO 0180-ACCOUNT-FOUND.
  8166
  8167 0102-ACCT-GETMAIN.
  8168     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8169     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8170
  8171 0105-READ-ACCT.
  8172     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8173     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8174     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8175     MOVE PB-STATE               TO ACCT-STATE.
  8176     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8177     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8178
  8179     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8180
  8181     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8182
  8183 0110-FIND-ACCT-TOLERANCES-LOOP.
  8184     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8185
  8186     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8187        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8188        GO TO 0199-ACCT-NOT-FOUND
  8189     END-IF
  8190     IF PB-CARRIER NOT = SPACES
  8191        IF PB-CARRIER NOT = AM-VG-CARRIER
  8192           GO TO 0199-ACCT-NOT-FOUND.
  8193
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 152
* EL050.cbl
  8194     IF PB-STATE NOT = SPACES
  8195        IF PB-STATE NOT = AM-VG-STATE
  8196           GO TO 0199-ACCT-NOT-FOUND.
  8197
  8198     IF PB-GROUPING NOT = SPACES
  8199        IF PB-GROUPING NOT = AM-VG-GROUPING
  8200           GO TO 0199-ACCT-NOT-FOUND.
  8201
  8202     MOVE 'X'                    TO DATE-RANGE-SW.
  8203
  8204     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8205        MOVE 'X'                 TO DATE-RANGE-SW
  8206        GO TO 0199-ACCT-NOT-FOUND.
  8207
  8208     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8209        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8210
  8211 0180-ACCOUNT-FOUND.
  8212     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8213     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8214     MOVE AM-STATE               TO PB-SV-STATE.
  8215     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8216
  8217     IF AM-CANCEL-FEE  NOT NUMERIC
  8218        MOVE ZEROS TO AM-CANCEL-FEE.
  8219
  8220     IF AM-MAX-MON-BEN NOT NUMERIC
  8221        MOVE ZEROS TO AM-MAX-MON-BEN.
  8222
  8223     IF AM-MAX-TOT-BEN NOT NUMERIC
  8224        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8225
  8226     IF AM-CLP-TOL-PCT NOT NUMERIC
  8227        MOVE +0                  TO AM-CLP-TOL-PCT
  8228     END-IF
  8229     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8230        MOVE +0                  TO AM-SPP-LEASE-COMM
  8231     END-IF
  8232     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8233        MOVE ER-2611             TO   WS-ERROR
  8234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8235
  8236     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8237        MOVE ER-2621             TO   WS-ERROR
  8238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8239
  8240     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8241        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8242        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8243        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8244         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8245
  8246     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8247     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8248     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8249     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8250     IF AM-CLP-TOL-PCT NOT = ZEROS
  8251        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 153
* EL050.cbl
  8252     END-IF
  8253     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8254        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8255     END-IF
  8256*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8257*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8258*                                   WS-ADMIN-FEES
  8259*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8260*          (SUB5 > +10)
  8261*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8262*             AND (AM-A-COM (SUB5) NUMERIC)
  8263*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8264*                + (AM-A-COM (SUB5) * 1000)
  8265*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8266*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8267*                + (AM-A-COM (SUB5) * 1000)
  8268*             END-IF
  8269*             IF AM-COM-TYP (SUB5) = 'N'
  8270*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8271*                + (AM-A-COM (SUB5) * 1000)
  8272*             END-IF
  8273*          END-IF
  8274*       END-PERFORM
  8275*    END-IF
  8276     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8277        AND (PB-ISSUE)
  8278        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8279                                    ws-cred-union-fees
  8280        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8281           (SUB5 > +10)
  8282           MOVE +0 TO WS-WK-RATE
  8283           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8284                                   'O' OR 'S')
  8285              IF (AM-A-COM (SUB5) NUMERIC)
  8286                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8287                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8288              ELSE
  8289                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8290                 IF PB-ISSUE
  8291                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8292                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8293                 ELSE
  8294                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8295                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8296                 END-IF
  8297                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8298                 MOVE ZEROS             TO WS-SUB1
  8299                                           WS-COMMISSION
  8300                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8301                 MOVE '0530'               TO CTBL-SW
  8302                 MOVE ' '                  TO WS-CTBL-READ-SW
  8303                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8304                 IF FIRST-TIME-THROUGH
  8305                    MOVE 'AA'              TO CTBL-BEN-CODE
  8306                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8307                 END-IF
  8308                 IF CTBL-TABLE-FOUND
  8309                    IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 154
* EL050.cbl
  8310                       COMPUTE WS-COMM-CK-AMT =
  8311                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8312                    ELSE
  8313                       COMPUTE WS-COMM-CK-AMT =
  8314                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8315                    END-IF
  8316                    PERFORM 8800-GET-COMP-RATE
  8317                              THRU 8800-EXIT
  8318                 END-IF
  8319              END-IF
  8320              if am-com-typ (sub5) = 'O' or 'S'
  8321                 compute ws-cred-union-fees rounded =
  8322                    ws-cred-union-fees +
  8323                    (pb-i-ah-premium-amt * ws-wk-rate)
  8324              else
  8325                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8326                + (WS-WK-RATE * 1000)
  8327              end-if
  8328           END-IF
  8329        END-PERFORM
  8330     END-IF
  8331     IF PB-COMPANY-ID EQUAL 'CRI'
  8332         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8333
  8334     IF PB-COMPANY-ID EQUAL 'NCL'
  8335         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8336     END-IF
  8337
  8338     GO TO 0200-READ-CERT.
  8339
  8340 0199-ACCT-NOT-FOUND.
  8341
  8342     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8343
  8344     IF DATE-RANGE-SW NOT = SPACES
  8345        MOVE ER-2601             TO WS-ERROR
  8346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8347     ELSE
  8348        MOVE ER-2619             TO WS-ERROR
  8349        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8350
  8351     GO TO 9990-RETURN.
  8352
  8353 0200-READ-CERT.
  8354
  8355     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8356     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8357     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8358     MOVE PB-SV-STATE            TO CERT-STATE.
  8359     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8360     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8361     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8362
  8363     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8364
  8365     IF CERT-WAS-NOT-FOUND
  8366        GO TO 0299-CERT-NOT-FOUND.
  8367
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 155
* EL050.cbl
  8368     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8369        MOVE ER-2759             TO WS-ERROR
  8370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8371        GO TO 0298-UNLOCK-RETURN.
  8372
  8373     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8374         MOVE ER-2758            TO WS-ERROR
  8375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8376         GO TO 0298-UNLOCK-RETURN.
  8377
  8378     IF PB-ISSUE
  8379        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8380           IF CERT-WAS-CREATED-FOR-CLAIM
  8381              NEXT SENTENCE
  8382            ELSE
  8383              MOVE ER-2626       TO WS-ERROR
  8384              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8385              GO TO 0298-UNLOCK-RETURN.
  8386
  8387     IF NOT PB-CANCELLATION
  8388        GO TO 0300-CONTINUE-EDIT.
  8389
  8390     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8391     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8392     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8393     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8394     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8395     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8396
  8397     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8398     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8399     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8400     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8401     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8402     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8403     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8404     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8405     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8406
  8407     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8408     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8409     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8410     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8411     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8412     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8413     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8414
  8415     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8416     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8417
  8418     MOVE CM-CREDIT-INTERFACE-SW-1
  8419                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8420     MOVE CM-CREDIT-INTERFACE-SW-2
  8421                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8422
  8423     IF CM-O-B-COVERAGE
  8424         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8425
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 156
* EL050.cbl
  8426     IF CM-LIVES NOT NUMERIC
  8427         MOVE ZERO                TO CM-LIVES.
  8428
  8429     IF CM-BILLED NOT NUMERIC
  8430         MOVE ZERO                TO CM-BILLED.
  8431
  8432     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8433         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8434         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8435         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8436         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8437         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8438         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8439         MOVE CM-LIVES             TO PB-CI-LIVES
  8440*The next line causes a problem with my change  I dont think it is
  8441*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8442
  8443     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8444     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8445     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8446     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8447     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8448     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8449
  8450     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8451     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8452     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8453     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8454
  8455     IF CM-LIFE-COMM-PCT NUMERIC
  8456         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8457     ELSE
  8458         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8459
  8460     IF CM-AH-COMM-PCT NUMERIC
  8461         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8462     ELSE
  8463         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8464
  8465     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8466
  8467     IF CM-LOAN-APR       NOT NUMERIC
  8468           MOVE ZERO               TO CM-LOAN-APR.
  8469
  8470     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8471           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8472
  8473     IF CM-LOAN-TERM      NOT NUMERIC
  8474           MOVE ZERO               TO CM-LOAN-TERM.
  8475
  8476     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8477           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8478
  8479     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8480           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8481
  8482     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8483     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 157
* EL050.cbl
  8484     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8485     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8486     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8487     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8488     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8489     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8490     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8491     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8492     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8493     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8494     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8495
  8496     IF CM-STATE = CM-SSN-STATE
  8497         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8498
  8499     IF CM-STATE NOT = CM-MEMB-STATE
  8500         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8501
  8502     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8503
  8504     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8505*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8506        IF CM-ADDL-CLP NOT NUMERIC
  8507           MOVE +0               TO CM-ADDL-CLP
  8508        END-IF
  8509        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8510        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8511           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8512        END-IF
  8513     END-IF
  8514     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8515        MOVE +0                  TO WS-ADMIN-FEES
  8516                                    WS-CSO-ADMIN-FEE
  8517                                    WS-COMM-AND-MFEE
  8518                                    WS-1ST-YR-ALLOW
  8519        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8520           (SUB5 > +10)
  8521           MOVE +0 TO WS-WK-RATE
  8522           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8523              IF (AM-A-COM (SUB5) NUMERIC)
  8524                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8525                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8526              ELSE
  8527                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8528                 IF PB-ISSUE
  8529                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8530                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8531                 ELSE
  8532                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8533                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8534                 END-IF
  8535                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8536                 MOVE ZEROS             TO WS-SUB1
  8537                                           WS-COMMISSION
  8538                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8539                 MOVE '0530'               TO CTBL-SW
  8540                 MOVE ' '                  TO WS-CTBL-READ-SW
  8541                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 158
* EL050.cbl
  8542                 IF FIRST-TIME-THROUGH
  8543                    MOVE 'AA'              TO CTBL-BEN-CODE
  8544                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8545                 END-IF
  8546                 IF CTBL-TABLE-FOUND
  8547                    IF PB-ISSUE
  8548                       COMPUTE WS-COMM-CK-AMT =
  8549                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8550                    ELSE
  8551                       COMPUTE WS-COMM-CK-AMT =
  8552                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8553                    END-IF
  8554                    PERFORM 8800-GET-COMP-RATE
  8555                              THRU 8800-EXIT
  8556                 END-IF
  8557              END-IF
  8558              IF AM-COM-TYP (SUB5) = 'I'
  8559                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8560                   + (WS-WK-RATE * 1000)
  8561              END-IF
  8562              IF AM-COM-TYP (SUB5) = 'N'
  8563                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8564                   + (WS-WK-RATE * 1000)
  8565              END-IF
  8566              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8567                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8568                   + (WS-WK-RATE * 1000)
  8569              END-IF
  8570              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8571                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8572                   + (WS-WK-RATE * 1000)
  8573              END-IF
  8574           END-IF
  8575        END-PERFORM
  8576     END-IF
  8577     GO TO 0300-CONTINUE-EDIT.
  8578
  8579 0298-UNLOCK-RETURN.
  8580      PERFORM 9250-UNLOCK-RETURN
  8581      GO TO 9990-RETURN.
  8582
  8583 0299-CERT-NOT-FOUND.
  8584
  8585     MOVE '1'                     TO CERT-STATUS-SW.
  8586
  8587     IF PB-COMPANY-ID = 'UCL'
  8588         IF WS-ERROR = ER-2799
  8589             GO TO 3000-CONTINUE-EDIT.
  8590
  8591     IF NOT PB-CANCELLATION
  8592         GO TO 0300-CONTINUE-EDIT.
  8593
  8594     MOVE ER-2726                  TO  WS-ERROR.
  8595     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8596     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8597     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8598                                    PB-CI-LF-TERM
  8599                                    PB-C-LF-REM-TERM
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 159
* EL050.cbl
  8600                                    PB-CI-AH-TERM
  8601                                    PB-C-AH-REM-TERM
  8602                                    PB-CI-LF-BENEFIT-CD
  8603                                    PB-CI-LF-BENEFIT-AMT
  8604                                    PB-CI-LF-ALT-BENEFIT-AMT
  8605                                    PB-CI-LF-PREMIUM-AMT
  8606                                    PB-CI-LF-ALT-PREMIUM-AMT
  8607                                    PB-CI-AH-BENEFIT-CD
  8608                                    PB-CI-AH-BENEFIT-AMT
  8609                                    PB-CI-AH-PREMIUM-AMT
  8610                                    PB-CI-PAY-FREQUENCY
  8611                                    PB-CI-LOAN-APR
  8612                                    PB-CI-LOAN-TERM
  8613                                    PB-CI-LIFE-COMMISSION
  8614                                    PB-CI-AH-COMMISSION
  8615                                    PB-CI-CURR-SEQ
  8616                                    PB-CI-AH-CANCEL-AMT
  8617                                    PB-CI-LF-CANCEL-AMT
  8618                                    PB-CI-RATE-DEV-PCT-LF
  8619                                    PB-CI-RATE-DEV-PCT-AH
  8620                                    PB-CI-EXTENTION-DAYS
  8621                                    PB-CI-TERM-IN-DAYS
  8622                                    PB-CI-LIVES
  8623                                    PB-CI-LF-CRIT-PER
  8624                                    PB-CI-AH-CRIT-PER
  8625                                    PB-CI-ADDL-CLP
  8626                                    PB-CI-DDF-IU-RATE-UP.
  8627
  8628     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8629                                    PB-CI-AH-SETTLEMENT-DT
  8630                                    PB-CI-DEATH-DT
  8631                                    PB-CI-LF-PRIOR-CANCEL-DT
  8632                                    PB-CI-AH-PRIOR-CANCEL-DT
  8633                                    PB-CI-ENTRY-DT
  8634                                    PB-CI-LF-EXPIRE-DT
  8635                                    PB-CI-AH-EXPIRE-DT
  8636                                    PB-CI-LOAN-1ST-PMT-DT.
  8637
  8638     IF ACCOUNT-MAST-FOUND
  8639        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8640        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8641
  8642
  8643 0300-CONTINUE-EDIT.
  8644
  8645     IF PB-ISSUE
  8646        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8647            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8648
  8649     IF PB-ISSUE
  8650        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8651            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8652
  8653     IF PB-ISSUE
  8654       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8655          (AM-NO-AH-ONLY)
  8656           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8657               IF PB-I-LIFE-BENEFIT-CD = ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 160
* EL050.cbl
  8658                   MOVE ER-2679 TO WS-ERROR
  8659                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8660
  8661     IF PB-ISSUE
  8662        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8663        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8664        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8665     ELSE
  8666        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8667        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8668        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8669
  8670     MOVE 'N'                    TO PLAN-MASTER-SW
  8671                                    PLAN-MASTER-LIFE-SW
  8672                                    FORM-MASTER-SW
  8673                                    WS-APP-CERT-SW.
  8674
  8675     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8676                                    WS-PL-TOL-LF-REFUND
  8677                                    WS-PL-REF-OVS-AMT
  8678                                    WS-PL-TOL-LF-PREM-PCT
  8679                                    WS-PL-TOL-LF-REFUND-PCT
  8680                                    WS-PL-REF-OVS-PCT
  8681                                    WS-PL-TOL-LF-CLAIM.
  8682
  8683     IF PB-COMPANY-ID = 'NCL'
  8684       IF PB-ISSUE
  8685         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8686             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8687             IF FORM-MASTER-FOUND
  8688                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8689
  8690     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8691        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8692
  8693********************** MON CODE **********************
  8694     IF PB-COMPANY-ID = 'MON'
  8695     IF PB-ISSUE
  8696     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8697        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8698             PB-I-LOAN-APR = ZERO)
  8699               MOVE 14.0         TO PB-I-LOAN-APR.
  8700******************************************************
  8701
  8702     IF PB-COMPANY-ID = 'NCL'
  8703       IF PB-ISSUE
  8704           IF FORM-MASTER-FOUND
  8705             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8706                AM-DISMBR-COVERAGE
  8707                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8708                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8709                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8710                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8711                                           PB-I-LIFE-BENEFIT-CD.
  8712
  8713     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8714
  8715     IF WK-LIFE-BEN-ADDR NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 161
* EL050.cbl
  8716         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8717         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8718         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8719         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8720         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8721           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8722             GO TO 0301-LIFE-BENEFIT-SEARCH
  8723         ELSE
  8724             NEXT SENTENCE
  8725     ELSE
  8726         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8727
  8728     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8729     MOVE '4'                    TO CNTL-REC-TYPE.
  8730     MOVE +0                     TO CNTL-SEQ-NO.
  8731     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8732
  8733     MOVE '1' TO RC-SW-2.
  8734     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8735
  8736     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8737        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8738         GO TO 0305-BENEFIT-NOT-FOUND.
  8739
  8740     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8741
  8742 0301-LIFE-BENEFIT-SEARCH.
  8743
  8744     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8745
  8746     IF NO-BENEFIT-FOUND
  8747        GO TO 0305-BENEFIT-NOT-FOUND.
  8748
  8749     IF WS-BEN-CD = '99'
  8750        GO TO 0305-BENEFIT-NOT-FOUND.
  8751
  8752     IF PB-COMPANY-ID = 'NCL'
  8753         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8754             GO TO 0304-LIFE-BENEFIT-FOUND.
  8755
  8756     MOVE +1                     TO SUB5.
  8757     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8758
  8759* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8760* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8761     IF PB-COMPANY-ID = 'DMD'
  8762         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8763
  8764 0302-EDIT-ACCT-LF-BENEFITS.
  8765
  8766     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8767        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8768           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8769                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8770           GO TO 03XX-GET-LIFE-ERPLAN.
  8771
  8772     IF SUB5 LESS THAN +20
  8773        ADD +1                   TO SUB5
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 162
* EL050.cbl
  8774        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8775
  8776     MOVE +1                     TO SUB5.
  8777
  8778     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8779        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8780
  8781 0303-EDIT-DMD-EXTRA-BENEFITS.
  8782
  8783     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8784        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8785           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8786                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8787           GO TO 03XX-GET-LIFE-ERPLAN.
  8788
  8789     IF SUB5 LESS THAN +30
  8790        ADD +1                   TO SUB5
  8791        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8792
  8793     MOVE +1                     TO SUB5.
  8794
  8795 03XX-EDIT-FOR-NINETY-LF.
  8796
  8797***************************************************************
  8798*                                                             *
  8799*    NINETY BENEFIT PLAN TYPES:                               *
  8800*                                                             *
  8801*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8802*      92 = ALL GROUP REDUCING BENEFITS                       *
  8803*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8804*      94 = ALL GROUP LEVEL BENEFITS                          *
  8805*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8806*           BENEFIT CONTROLS.                                 *
  8807*      99 = ALL BENEFITS                                      *
  8808*                                                             *
  8809***************************************************************
  8810
  8811     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8812                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8813
  8814     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8815       AND
  8816        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8817        GO TO 03XX-GET-LIFE-ERPLAN.
  8818
  8819     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8820       AND
  8821        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8822        IF CF-REDUCING (SUB3)
  8823           IF (PB-I-INDV-GRP-OVRD = 'I')
  8824              OR
  8825           ((AM-IG = '1') AND
  8826           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8827              OR
  8828           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8829           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8830           (AM-IG NOT = '2'))
  8831              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 163
* EL050.cbl
  8832
  8833     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8834       AND
  8835        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8836        IF CF-REDUCING (SUB3)
  8837           IF (PB-I-INDV-GRP-OVRD = 'G')
  8838              OR
  8839           ((AM-IG = '2') AND
  8840           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8841              OR
  8842           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8843           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8844           (AM-IG NOT = '1'))
  8845              GO TO 03XX-GET-LIFE-ERPLAN.
  8846
  8847     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8848       AND
  8849        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8850        IF CF-LEVEL    (SUB3)
  8851           IF (PB-I-INDV-GRP-OVRD = 'I')
  8852              OR
  8853           ((AM-IG = '1') AND
  8854           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8855              OR
  8856           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8857           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8858            (AM-IG NOT = '2'))
  8859              GO TO 03XX-GET-LIFE-ERPLAN.
  8860
  8861     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8862       AND
  8863        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8864        IF CF-LEVEL    (SUB3)
  8865           IF (PB-I-INDV-GRP-OVRD = 'G')
  8866              OR
  8867           ((AM-IG = '2') AND
  8868           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8869              OR
  8870           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8871           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8872           (AM-IG NOT = '1'))
  8873              GO TO 03XX-GET-LIFE-ERPLAN.
  8874
  8875     IF SUB5 LESS THAN +20
  8876        ADD +1                   TO SUB5
  8877        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8878
  8879     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8880
  8881     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8882        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8883
  8884     MOVE +1                     TO SUB5.
  8885
  8886 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8887
  8888     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8889                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 164
* EL050.cbl
  8890
  8891     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8892       AND
  8893        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8894        GO TO 03XX-GET-LIFE-ERPLAN.
  8895
  8896     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8897       AND
  8898        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8899        IF CF-REDUCING (SUB3)
  8900           IF (PB-I-INDV-GRP-OVRD = 'I')
  8901              OR
  8902           ((AM-IG = '1') AND
  8903           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8904              OR
  8905           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8906           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8907           (AM-IG NOT = '2'))
  8908              GO TO 03XX-GET-LIFE-ERPLAN.
  8909
  8910     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8911       AND
  8912        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8913        IF CF-REDUCING (SUB3)
  8914           IF (PB-I-INDV-GRP-OVRD = 'G')
  8915              OR
  8916           ((AM-IG = '2') AND
  8917           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8918              OR
  8919           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8920           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8921           (AM-IG NOT = '1'))
  8922              GO TO 03XX-GET-LIFE-ERPLAN.
  8923
  8924     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8925       AND
  8926        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8927        IF CF-LEVEL    (SUB3)
  8928           IF (PB-I-INDV-GRP-OVRD = 'I')
  8929              OR
  8930           ((AM-IG = '1') AND
  8931           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8932              OR
  8933           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8934           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8935            (AM-IG NOT = '2'))
  8936              GO TO 03XX-GET-LIFE-ERPLAN.
  8937
  8938     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8939       AND
  8940        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8941        IF CF-LEVEL    (SUB3)
  8942           IF (PB-I-INDV-GRP-OVRD = 'G')
  8943              OR
  8944           ((AM-IG = '2') AND
  8945           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8946              OR
  8947           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 165
* EL050.cbl
  8948           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8949           (AM-IG NOT = '1'))
  8950              GO TO 03XX-GET-LIFE-ERPLAN.
  8951
  8952     IF SUB5 LESS THAN +30
  8953        ADD +1                   TO SUB5
  8954        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8955
  8956     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8957
  8958 03XX-EDIT-FOR-NINETY-LF-CONT.
  8959
  8960     MOVE +99                    TO SUB5.
  8961
  8962     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8963        IF PB-ISSUE
  8964           MOVE ER-1924          TO  WS-ERROR
  8965           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8966
  8967     GO TO 0304-LIFE-BENEFIT-FOUND.
  8968
  8969 03XX-GET-LIFE-ERPLAN.
  8970
  8971     IF WK-PLAN-ADDR EQUAL +0
  8972        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8973
  8974     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8975     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8976     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8977     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8978     MOVE 'Y'                    TO PLAN-MASTER-SW
  8979                                    PLAN-MASTER-LIFE-SW.
  8980     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8981
  8982 03XX-ERPLAN-LIFE-GETMAIN.
  8983
  8984     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8985     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8986
  8987 03XX-ERPLAN-LIFE-READ.
  8988
  8989     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8990     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8991     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8992     MOVE PB-SV-STATE            TO PLAN-STATE.
  8993     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8994     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8995     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8996     MOVE WS-SAVE-BENEFIT-REVISION
  8997                                 TO PLAN-REVISION-NO.
  8998
  8999     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9000     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9001
  9002     IF PB-COMPANY-ID = 'NCL'
  9003       IF NOT LF-PLAN-MASTER-FOUND
  9004         IF NOT PB-POLICY-IS-DECLINED  AND
  9005            NOT PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 166
* EL050.cbl
  9006             MOVE  ER-1921         TO  WS-ERROR
  9007             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9008             GO TO 0304-LIFE-BENEFIT-FOUND.
  9009
  9010     IF NOT LF-PLAN-MASTER-FOUND
  9011        GO TO 0304-LIFE-BENEFIT-FOUND.
  9012
  9013 XXXX-CHECK-LF-PLAN-KEY.
  9014
  9015     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9016        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9017        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9018        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9019        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9020        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9021        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9022        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9023        MOVE 'N'                 TO PLAN-MASTER-SW
  9024          GO TO 03XX-ERPLAN-LIFE-READ.
  9025
  9026     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9027
  9028     IF  PB-CANCELLATION
  9029         GO TO  0303-LF-ACCT-BEN-FOUND.
  9030
  9031     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9032        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9033           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9034           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9035              MOVE ER-2644             TO WS-ERROR
  9036              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9037           ELSE
  9038              NEXT SENTENCE
  9039        ELSE
  9040           IF PB-COMPANY-ID NOT = 'NCL'
  9041              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9042                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9043
  9044 0303-LF-ACCT-BEN-FOUND.
  9045
  9046     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9047
  9048     IF PL-DEV-CODE NOT = SPACES
  9049        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9050
  9051     IF PL-DEV-PCT NUMERIC AND
  9052        PL-DEV-PCT NOT = ZEROS
  9053        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9054
  9055     IF PL-TOL-PREM-AMT GREATER THAN +0
  9056        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9057
  9058     IF PL-TOL-REF-AMT GREATER THAN +0
  9059        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9060
  9061     IF PL-TOL-PREM-PCT GREATER THAN +0
  9062        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9063
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 167
* EL050.cbl
  9064     IF PL-TOL-REF-PCT GREATER THAN +0
  9065        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9066
  9067     IF PL-TOL-CLM-AMT GREATER THAN +0
  9068        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9069
  9070     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9071                          PL-OVER-SHORT-AMT > +0
  9072        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9073
  9074     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9075                          PL-OVER-SHORT-PCT > +0
  9076        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9077
  9078     IF PL-SALES-TAX NUMERIC AND
  9079                          PL-SALES-TAX > +0
  9080         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9081
  9082     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9083        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9084                                    WS-IG-OVRD-AM.
  9085
  9086 0304-LIFE-BENEFIT-FOUND.
  9087
  9088     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9089
  9090     IF PB-ISSUE
  9091        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9092     ELSE
  9093        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9094
  9095     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9096     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9097     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9098     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9099     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9100                                         WS-LF-REFUND-CALC.
  9101     if (ws-lf-earnings-calc = '5')
  9102        and (pb-i-loan-apr = zeros)
  9103        and (benefit-code-chg)
  9104        move +99.9999 to pb-i-loan-apr
  9105     end-if
  9106
  9107     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9108        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9109
  9110     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9111        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9112     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9113
  9114     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9115     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9116     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9117     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9118     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9119     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9120
  9121     IF PB-COMPANY-ID = 'NCL'  AND
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 168
* EL050.cbl
  9122        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9123         NEXT SENTENCE
  9124     ELSE
  9125         IF SUB5 NOT GREATER THAN +20
  9126            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9127               MOVE WS-SAVE-BENEFIT-REM-TERM
  9128                                      TO WS-AM-LF-BENE-REM-TERM
  9129                                         EC-BR-LF-REM-TERM-CALC.
  9130
  9131     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9132     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9133
  9134     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9135
  9136 0305-BENEFIT-NOT-FOUND.
  9137
  9138     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9139     MOVE ER-2604                TO WS-ERROR.
  9140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9141
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 169
* EL050.cbl
  9143
  9144 0310-FIND-AH-BENEFIT-RECORD.
  9145
  9146     MOVE 'N'                    TO PLAN-MASTER-SW
  9147                                    PLAN-MASTER-AH-SW.
  9148
  9149     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9150                                    WS-PL-TOL-AH-REFUND
  9151                                    WS-AH-PL-REF-OVS-AMT
  9152                                    WS-PL-TOL-AH-PREM-PCT
  9153                                    WS-PL-TOL-AH-REFUND-PCT
  9154                                    WS-AH-PL-REF-OVS-PCT
  9155                                    WS-PL-TOL-AH-CLAIM.
  9156     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9157
  9158
  9159     if pb-issue
  9160        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9161           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9162        end-if
  9163        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9164           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9165           GO TO 0399-BENEFIT-NOT-FOUND
  9166        end-if
  9167     end-if
  9168
  9169     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9170        GO TO 0400-FIND-CARRIER.
  9171
  9172     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9173
  9174     IF WK-AH-BEN-ADDR NOT = ZEROS
  9175         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9176         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9177         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9178         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9179           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9180             GO TO 0311-AH-BENEFIT-SEARCH
  9181         ELSE
  9182             NEXT SENTENCE
  9183     ELSE
  9184         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9185
  9186     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9187     MOVE '5'                    TO CNTL-REC-TYPE.
  9188     MOVE +0                     TO CNTL-SEQ-NO.
  9189     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9190
  9191     MOVE '2' TO RC-SW-2.
  9192     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9193
  9194     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9195        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9196          GO TO 0399-BENEFIT-NOT-FOUND.
  9197
  9198     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9199
  9200 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 170
* EL050.cbl
  9201
  9202     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9203
  9204     IF NO-BENEFIT-FOUND
  9205         GO TO 0399-BENEFIT-NOT-FOUND.
  9206
  9207     IF WS-BEN-CD = '99'
  9208        GO TO 0399-BENEFIT-NOT-FOUND.
  9209
  9210     IF PB-COMPANY-ID  =  'NCL'
  9211         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9212             GO TO 0314-A-H-BENEFIT-FOUND.
  9213
  9214     MOVE +1                     TO SUB5.
  9215     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9216
  9217* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9218* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9219     IF PB-COMPANY-ID = 'DMD'
  9220         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9221
  9222 0312-EDIT-ACCT-AH-BENEFITS.
  9223
  9224     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9225        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9226           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9227                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9228           GO TO 03XX-GET-AH-ERPLAN.
  9229
  9230     IF SUB5 LESS THAN +20
  9231        ADD +1                   TO SUB5
  9232        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9233
  9234     MOVE +1                     TO SUB5.
  9235
  9236     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9237        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9238
  9239 0313-EDIT-DMD-EXTRA-BENEFITS.
  9240
  9241     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9242        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9243           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9244                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9245           GO TO 03XX-GET-AH-ERPLAN.
  9246
  9247     IF SUB5 LESS THAN +30
  9248        ADD +1                   TO SUB5
  9249        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9250
  9251     MOVE +1                     TO SUB5.
  9252
  9253 03XX-EDIT-FOR-NINETY-AH.
  9254
  9255***************************************************************
  9256*                                                             *
  9257*    NINETY BENEFIT PLAN TYPES:                               *
  9258*                                                             *
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 171
* EL050.cbl
  9259*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9260*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9261*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9262*           BENEFIT CONTROLS.                                 *
  9263*      99 = ALL BENEFITS.                                     *
  9264*                                                             *
  9265***************************************************************
  9266
  9267     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9268                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9269
  9270     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9271       AND
  9272        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9273        GO TO 03XX-GET-AH-ERPLAN.
  9274
  9275     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9276       AND
  9277        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9278           IF (PB-I-INDV-GRP-OVRD = 'I')
  9279              OR
  9280           ((AM-IG = '1') AND
  9281           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9282              OR
  9283           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9284           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9285           (AM-IG NOT = '2'))
  9286              GO TO 03XX-GET-AH-ERPLAN.
  9287
  9288     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9289       AND
  9290        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9291           IF (PB-I-INDV-GRP-OVRD = 'G')
  9292              OR
  9293           ((AM-IG = '2') AND
  9294           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9295              OR
  9296           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9297           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9298           (AM-IG NOT = '1'))
  9299              GO TO 03XX-GET-AH-ERPLAN.
  9300
  9301     IF SUB5 LESS THAN +20
  9302        ADD +1                   TO SUB5
  9303        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9304
  9305     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9306        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9307
  9308     MOVE +1                    TO SUB5.
  9309
  9310 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9311
  9312     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9313                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9314
  9315     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9316       AND
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 172
* EL050.cbl
  9317        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9318        GO TO 03XX-GET-AH-ERPLAN.
  9319
  9320     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9321       AND
  9322        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9323           IF (PB-I-INDV-GRP-OVRD = 'I')
  9324              OR
  9325           ((AM-IG = '1') AND
  9326           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9327              OR
  9328           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9329           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9330           (AM-IG NOT = '2'))
  9331              GO TO 03XX-GET-AH-ERPLAN.
  9332
  9333     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9334       AND
  9335        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9336           IF (PB-I-INDV-GRP-OVRD = 'G')
  9337              OR
  9338           ((AM-IG = '2') AND
  9339           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9340              OR
  9341           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9342           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9343           (AM-IG NOT = '1'))
  9344              GO TO 03XX-GET-AH-ERPLAN.
  9345
  9346     IF SUB5 LESS THAN +30
  9347        ADD +1                   TO SUB5
  9348        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9349
  9350 03XX-EDIT-FOR-NINETY-AH-CONT.
  9351
  9352     MOVE +99                    TO SUB5.
  9353
  9354     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9355
  9356     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9357        IF PB-ISSUE
  9358           MOVE ER-1925          TO  WS-ERROR
  9359           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9360
  9361     GO TO 0314-A-H-BENEFIT-FOUND.
  9362
  9363 03XX-GET-AH-ERPLAN.
  9364
  9365     IF WK-PLAN-ADDR EQUAL +0
  9366         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9367
  9368     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9369     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9370     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9371     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9372     MOVE 'Y'                    TO PLAN-MASTER-SW
  9373                                    PLAN-MASTER-AH-SW.
  9374*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 173
* EL050.cbl
  9375     GO TO 03XX-ERPLAN-AH-READ.
  9376
  9377 03XX-ERPLAN-AH-GETMAIN.
  9378
  9379     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9380     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9381
  9382 03XX-ERPLAN-AH-READ.
  9383
  9384     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9385     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9386     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9387     MOVE PB-SV-STATE            TO PLAN-STATE.
  9388     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9389     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9390     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9391     MOVE WS-SAVE-BENEFIT-REVISION
  9392                                 TO PLAN-REVISION-NO.
  9393
  9394     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9395     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9396
  9397     IF PB-COMPANY-ID = 'NCL'
  9398       IF NOT AH-PLAN-MASTER-FOUND
  9399         IF NOT PB-POLICY-IS-DECLINED  AND
  9400            NOT PB-POLICY-IS-VOIDED
  9401             MOVE  ER-1922         TO  WS-ERROR
  9402             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9403             GO TO 0314-A-H-BENEFIT-FOUND.
  9404
  9405     IF NOT AH-PLAN-MASTER-FOUND
  9406        GO TO 0314-A-H-BENEFIT-FOUND.
  9407
  9408 XXXX-CHECK-AH-PLAN-KEY.
  9409
  9410     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9411        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9412        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9413        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9414        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9415        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9416        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9417        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9418        MOVE 'N'                 TO PLAN-MASTER-SW
  9419          GO TO 03XX-ERPLAN-AH-READ.
  9420
  9421     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9422
  9423     IF  PB-CANCELLATION
  9424         GO TO  0313-AH-ACCT-BEN-FOUND.
  9425
  9426     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9427       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9428          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9429          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9430             MOVE ER-2644             TO WS-ERROR
  9431             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9432          ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 174
* EL050.cbl
  9433             NEXT SENTENCE
  9434       ELSE
  9435          IF PB-COMPANY-ID NOT = 'NCL'
  9436             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9437                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9438
  9439 0313-AH-ACCT-BEN-FOUND.
  9440
  9441     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9442
  9443     IF PL-DEV-CODE NOT = SPACES
  9444        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9445
  9446     IF PL-DEV-PCT NUMERIC AND
  9447        PL-DEV-PCT NOT = ZEROS
  9448        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9449
  9450     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9451        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9452
  9453     IF PL-TOL-REF-AMT NOT EQUAL +0
  9454        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9455
  9456     IF PL-TOL-PREM-PCT GREATER THAN +0
  9457        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9458
  9459     IF PL-TOL-REF-PCT GREATER THAN +0
  9460        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9461
  9462     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9463        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9464
  9465     IF PL-OVER-SHORT-AMT NUMERIC AND
  9466                          PL-OVER-SHORT-AMT > +0
  9467        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9468
  9469     IF PL-OVER-SHORT-PCT NUMERIC AND
  9470                          PL-OVER-SHORT-PCT > +0
  9471        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9472
  9473     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9474        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9475        IF WS-IG-OVRD-AM EQUAL SPACES
  9476            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9477
  9478 0314-A-H-BENEFIT-FOUND.
  9479
  9480     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9481
  9482     IF PB-ISSUE
  9483        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9484       ELSE
  9485        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9486
  9487     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9488     if cf-maximum-benefits (sub3) numeric
  9489        move cf-maximum-benefits (sub3)
  9490                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 175
* EL050.cbl
  9491     else
  9492        move zeros               to ws-ah-max-bens
  9493     end-if
  9494     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9495     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9496     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9497                                         WS-AH-REFUND-CALC.
  9498
  9499     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9500        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9501
  9502     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9503        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9504     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9505
  9506     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9507     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9508     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9509     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9510     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9511     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9512
  9513     IF PB-COMPANY-ID = 'NCL'  AND
  9514        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9515         NEXT SENTENCE
  9516     ELSE
  9517         IF SUB5 NOT GREATER THAN +20
  9518            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9519                MOVE WS-SAVE-BENEFIT-REM-TERM
  9520                                      TO WS-AM-AH-BENE-REM-TERM
  9521                                         EC-BR-AH-REM-TERM-CALC.
  9522
  9523     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9524     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9525
  9526     GO TO 0400-FIND-CARRIER.
  9527
  9528 0399-BENEFIT-NOT-FOUND.
  9529
  9530     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9531     MOVE ER-2605                TO WS-ERROR.
  9532     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9533
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 176
* EL050.cbl
  9535
  9536 0400-FIND-CARRIER.
  9537
  9538     MOVE PB-SV-CARRIER          TO WS-CARR.
  9539
  9540     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9541     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9542     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9543     MOVE '6'                    TO CNTL-REC-TYPE.
  9544
  9545*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9546     MOVE SPACE                  TO WS-DMD-RATING-SW
  9547                                    EC-BR-DMD-RATING-SW.
  9548
  9549     MOVE '2'                    TO RC-SW-1.
  9550     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9551
  9552     IF NOT CF-CARRIER-MASTER
  9553        GO TO 0400-CARRIER-NOT-FOUND.
  9554
  9555 0400-BUILD-CARR-TOL.
  9556
  9557     IF CF-CR-TOL-PREM NUMERIC AND
  9558        CF-CR-TOL-PREM GREATER THAN +0
  9559        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9560                                    WS-TOL-AH-PREM.
  9561
  9562     IF CF-CR-TOL-REFUND NUMERIC AND
  9563        CF-CR-TOL-REFUND GREATER THAN +0
  9564        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9565                                    WS-TOL-AH-REFUND.
  9566
  9567     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9568        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9569        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9570                                    WS-AH-REFUND-OVS-AMT.
  9571
  9572     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9573        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9574        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9575                                    WS-AH-REFUND-OVS-PCT.
  9576
  9577     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9578        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9579        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9580                                    WS-TOL-AH-PREM-PCT.
  9581
  9582     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9583        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9584        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9585                                     WS-TOL-AH-REFUND-PCT.
  9586
  9587     IF CF-COMPANY-ID EQUAL 'DMD'
  9588         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9589                                    EC-BR-DMD-RATING-SW.
  9590
  9591     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9592     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 177
* EL050.cbl
  9593        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9594     END-IF
  9595     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9596        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9597     END-IF
  9598     IF WS-TOL-CLP-PCT = ZEROS
  9599        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9600     END-IF
  9601
  9602     IF WS-SPP-LEASE-COMM = ZEROS
  9603        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9604     END-IF
  9605     GO TO 0400-FIND-ERPDEF.
  9606
  9607 0400-CARRIER-NOT-FOUND.
  9608
  9609     MOVE ER-2602                TO WS-ERROR.
  9610     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9611
  9612 0400-FIND-ERPDEF.
  9613*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9614     IF (PB-COMPANY-ID = 'DCC')
  9615        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9616        CONTINUE
  9617     ELSE
  9618        GO TO 0400-FIND-ERCOMP
  9619     END-IF
  9620     MOVE ' '                    TO PDEF-MASTER-SW
  9621     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9622     MOVE PB-STATE               TO ERPDEF-STATE
  9623     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9624        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9625     END-IF
  9626     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9627     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9628     IF PB-ISSUE
  9629        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9630     ELSE
  9631        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9632     END-IF
  9633     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9634     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9635     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9636     IF PDEF-MASTER-FOUND
  9637        MOVE 'N'                 TO PDEF-MASTER-SW
  9638        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9639        IF PDEF-MASTER-FOUND
  9640           IF (ERPDEF-KEY-SAVE (1:16) =
  9641                        PD-CONTROL-PRIMARY (1:16))
  9642              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9643              CONTINUE
  9644           ELSE
  9645              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9646              IF (ERPDEF-KEY-SAVE (1:16) =
  9647                        PD-CONTROL-PRIMARY (1:16))
  9648                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9649                 CONTINUE
  9650              ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 178
* EL050.cbl
  9651                 MOVE 'N'        TO PDEF-MASTER-SW
  9652              END-IF
  9653           END-IF
  9654        END-IF
  9655        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9656     END-IF
  9657     IF PDEF-MASTER-FOUND
  9658        IF PD-TRUNCATED = 'Y'
  9659           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9660        END-IF
  9661     END-IF
  9662     .
  9663 0400-FIND-ERCOMP.
  9664     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9665        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9666           (WS-SUB1 > +10)
  9667           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9668                 OR 'A' OR 'N'
  9669              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9670              MOVE PB-CARRIER    TO COMP-CARRIER
  9671              MOVE PB-GROUPING   TO COMP-GROUPING
  9672              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9673              MOVE AM-AGT (WS-SUB1)
  9674                                 TO COMP-FIN-RESP
  9675              MOVE 'G'           TO COMP-TYPE
  9676              PERFORM 8582-READ-COMPENSATION-MASTER
  9677                                 THRU 8582-EXIT
  9678              IF COMP-MASTER-FOUND
  9679                 IF CO-GA-INACTIVE
  9680                    MOVE ER-2763 TO WS-ERROR
  9681                    PERFORM 9900-ERROR-FORMAT
  9682                                 THRU 9900-EXIT
  9683                    MOVE +11     TO WS-SUB1
  9684                 END-IF
  9685                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9686                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9687                    MOVE ER-2788 TO WS-ERROR
  9688                    PERFORM 9900-ERROR-FORMAT
  9689                                 THRU 9900-EXIT
  9690                    MOVE +11     TO WS-SUB1
  9691                 END-IF
  9692              END-IF
  9693           END-IF
  9694        END-PERFORM
  9695     END-IF
  9696     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9697        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9698           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9699                                    WS-CLP-STATE
  9700        ELSE
  9701           MOVE SPACES           TO PB-I-CLP-STATE
  9702                                    WS-CLP-STATE
  9703        END-IF
  9704     END-IF
  9705
  9706     IF (PB-COMPANY-ID = 'DCC')
  9707        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9708        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 179
* EL050.cbl
  9709        CONTINUE
  9710     ELSE
  9711        GO TO 0400-FIND-STATE-RECORD
  9712     END-IF
  9713     MOVE SPACES                 TO WS-CLP-STATE
  9714     MOVE +0                     TO WS-BANK-FEE
  9715                                    WS-BANK-LFEE
  9716                                    WS-BANK-NOCHRGB
  9717
  9718     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9719     IF (PB-ISSUE)
  9720        AND (PB-I-BANK-NUMBER NOT =
  9721            SPACES AND ZEROS AND LOW-VALUES)
  9722        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9723     ELSE
  9724        IF (PB-CANCELLATION)
  9725           AND (PB-CI-BANK-NUMBER NOT =
  9726                SPACES AND ZEROS AND LOW-VALUES)
  9727           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9728        END-IF
  9729     END-IF
  9730     IF COMP-FIN-RESP NOT = LOW-VALUES
  9731        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9732        MOVE PB-CARRIER          TO COMP-CARRIER
  9733        MOVE PB-GROUPING         TO COMP-GROUPING
  9734        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9735        MOVE 'B'                 TO COMP-TYPE
  9736        PERFORM 8582-READ-COMPENSATION-MASTER
  9737                                 THRU 8582-EXIT
  9738        IF COMP-MASTER-FOUND
  9739           IF CO-MAX-BANK-FEE NOT NUMERIC
  9740              MOVE +0            TO CO-MAX-BANK-FEE
  9741           END-IF
  9742           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9743              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9744           END-IF
  9745           IF CO-GA-INACTIVE
  9746              MOVE ER-2763       TO WS-ERROR
  9747              PERFORM 9900-ERROR-FORMAT
  9748                                 THRU 9900-EXIT
  9749           END-IF
  9750           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9751              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9752              MOVE ER-2788 TO WS-ERROR
  9753              PERFORM 9900-ERROR-FORMAT
  9754                                 THRU 9900-EXIT
  9755              MOVE +11     TO WS-SUB1
  9756           END-IF
  9757           IF WS-AH-BEN-CATEGORY = 'G'
  9758              MOVE CO-MAX-BANK-FEE
  9759                                 TO WS-BANK-FEE
  9760                                    PB-I-BANK-FEE
  9761           ELSE
  9762              MOVE CO-MAX-BANK-FEE-LEASE
  9763                                 TO WS-BANK-LFEE
  9764                                    PB-I-BANK-FEE
  9765           END-IF
  9766           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 180
* EL050.cbl
  9767              AND (WS-AH-REFUND-CALC = 'G'))
  9768                        OR
  9769              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9770              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9771              CONTINUE
  9772           ELSE
  9773              MOVE ER-2789 TO WS-ERROR
  9774              PERFORM 9900-ERROR-FORMAT
  9775                                 THRU 9900-EXIT
  9776           END-IF
  9777           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9778                                    PB-I-CLP-STATE
  9779           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9780           MOVE CO-CARRIER       TO BXRF-CARRIER
  9781           MOVE CO-GROUPING      TO BXRF-GROUPING
  9782           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9783           MOVE BXRF-MAX-REC-LENGTH
  9784                                 TO BXRF-REC-LENGTH
  9785           PERFORM 8584-READ-BANK-CROSS-REF
  9786                                 THRU 8584-EXIT
  9787           IF BXRF-MASTER-FOUND
  9788              MOVE ' '           TO BANK-ACCT-SW
  9789              MOVE BK-BANK-POINTER-CNT
  9790                                 TO BK-BANK-POINTER-CNT
  9791              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9792                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9793                 OR (BANK-ACCT-FOUND)
  9794                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9795                    AND (BK-AM-EXP-DT (WS-SUB1)
  9796                                 > PB-CERT-EFF-DT)
  9797                    AND (BK-AM-EFF-DT (WS-SUB1)
  9798                                 NOT > PB-CERT-EFF-DT)
  9799                    SET BANK-ACCT-FOUND TO TRUE
  9800                 END-IF
  9801              END-PERFORM
  9802              IF NOT BANK-ACCT-FOUND
  9803                 MOVE ZEROS      TO WS-BANK-FEE
  9804                                    WS-BANK-LFEE
  9805                 MOVE ER-2869    TO WS-ERROR
  9806                 PERFORM 9900-ERROR-FORMAT
  9807                                 THRU 9900-EXIT
  9808              ELSE
  9809                 PERFORM 5000-PROCESS-REPS
  9810                                 THRU 5000-EXIT
  9811                 IF AGENT-MASTER-FOUND
  9812                    MOVE +0      TO WS-BANK-FEE
  9813                                    WS-BANK-LFEE
  9814*                   MOVE AG-SPP-FEES (1)
  9815*                                TO PB-I-BANK-FEE
  9816*                                   WS-BANK-FEE
  9817                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9818                       (WS-SUB1 > +10)
  9819                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9820                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9821                       END-IF
  9822                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9823                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9824                       END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 181
* EL050.cbl
  9825                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9826                          AG-SPP-FEES (WS-SUB1)
  9827                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9828                          AG-SPP-LFEES (WS-SUB1)
  9829                    END-PERFORM
  9830                    IF WS-AH-BEN-CATEGORY = 'G'
  9831                       MOVE WS-BANK-FEE
  9832                                 TO PB-I-BANK-FEE
  9833                    ELSE
  9834                       MOVE WS-BANK-LFEE
  9835                                 TO PB-I-BANK-FEE
  9836                    END-IF
  9837                 END-IF
  9838              END-IF
  9839           END-IF
  9840        ELSE
  9841           MOVE ER-2879          TO WS-ERROR
  9842           PERFORM 9900-ERROR-FORMAT
  9843                                 THRU 9900-EXIT
  9844        END-IF
  9845     ELSE
  9846        MOVE ER-2879             TO WS-ERROR
  9847        PERFORM 9900-ERROR-FORMAT
  9848                                 THRU 9900-EXIT
  9849     END-IF
  9850     IF WS-AH-BEN-CATEGORY = 'G'
  9851        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9852        + WS-BANK-FEE
  9853     ELSE
  9854        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9855        + WS-BANK-LFEE
  9856     END-IF
  9857     .
  9858 0400-FIND-STATE-RECORD.
  9859
  9860     IF WK-STATE-ADDR NOT = ZEROS
  9861         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9862         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9863         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9864         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9865         IF PB-SV-STATE = CF-STATE-CODE
  9866             GO TO 0405-CONTINUE-EDIT
  9867         ELSE
  9868             NEXT SENTENCE
  9869     ELSE
  9870         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9871
  9872     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9873     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9874     MOVE '3'                    TO CNTL-REC-TYPE.
  9875     MOVE +0                     TO CNTL-SEQ-NO.
  9876
  9877     MOVE '3'                    TO RC-SW-2.
  9878     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9879
  9880     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9881        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9882        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 182
* EL050.cbl
  9883        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9884                                    WS-TOL-AH-CLAIM
  9885                                    WS-MINIMUM-REFUND
  9886                                    WS-TOL-LF-PREM
  9887                                    WS-TOL-AH-PREM
  9888                                    WS-TOL-LF-REFUND
  9889                                    WS-TOL-AH-REFUND
  9890                                    EC-ST-TOL-PREM-PCT
  9891                                    WS-TOL-LF-PREM-PCT
  9892                                    WS-TOL-AH-PREM-PCT
  9893                                    EC-ST-TOL-REFUND-PCT
  9894                                    WS-TOL-LF-REFUND-PCT
  9895                                    WS-TOL-AH-REFUND-PCT
  9896                                    EC-ST-TOL-PREM
  9897                                    EC-ST-TOL-REFUND
  9898                                    EC-ST-FST-PMT-DAYS-MAX
  9899                                    WS-FREE-LOOK-PERIOD
  9900                                    WS-ST-LF-PREM-TAX
  9901                                    WS-ST-AH-PREM-TAX-I
  9902                                    WS-ST-AH-PREM-TAX-G
  9903                                    WS-BANK-FEE
  9904                                    WS-BANK-LFEE
  9905                                    WS-TOL-CLP-PCT
  9906                                    WS-SPP-LEASE-COMM
  9907                                    WS-INT-PERIODS
  9908                                    WS-EXTRA-PMTS
  9909        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9910                                    EC-ST-FST-PMT-DAYS-CHG
  9911                                    WS-LF-REM-TERM-CALC
  9912                                    WS-LF-REFUND-CALC
  9913                                    EC-ST-LF-REM-TERM-CALC
  9914                                    EC-ST-LF-REFUND-CALC
  9915                                    WS-AH-REM-TERM-CALC
  9916                                    WS-AH-REFUND-CALC
  9917                                    WS-LF-BEN-CATEGORY
  9918                                    WS-AH-BEN-CATEGORY
  9919                                    WS-CLP-STATE
  9920                                    WS-ST-REFUND-CLAIM-FLAG
  9921                                    WS-ST-CAUSAL-STATE
  9922                                    ws-st-agent-sig-edit
  9923                                    EC-ST-AH-REM-TERM-CALC
  9924                                    EC-ST-AH-REFUND-CALC
  9925          GO TO 0499-STATE-NOT-FOUND.
  9926
  9927     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9928
  9929 0405-CONTINUE-EDIT.
  9930     IF (PB-COMPANY-ID <> 'AHL')
  9931        and (pb-issue)
  9932        MOVE +0                  TO SUB3
  9933        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9934        IF SUB3 > +0
  9935           MOVE ER-3270          TO WS-ERROR
  9936           PERFORM 9900-ERROR-FORMAT
  9937                                 THRU 9900-EXIT
  9938        else
  9939           IF PB-CERT-PRIME NOT NUMERIC
  9940              MOVE ER-2722       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 183
* EL050.cbl
  9941              PERFORM 9900-ERROR-FORMAT
  9942                                 THRU 9900-EXIT
  9943           end-if
  9944        END-IF
  9945     END-IF
  9946     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9947
  9948     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9949        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9950                                    WS-TOL-AH-CLAIM.
  9951
  9952     IF CF-ST-REFUND-MIN NOT NUMERIC
  9953        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9954
  9955     IF CF-ST-REFUND-MIN NOT = ZEROS
  9956        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9957
  9958     IF CF-ST-TOL-PREM  NOT = ZEROS
  9959        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9960                                    WS-TOL-AH-PREM
  9961        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9962
  9963     IF CF-ST-TOL-REFUND NOT = ZEROS
  9964        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9965                                    WS-TOL-AH-REFUND
  9966        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9967
  9968     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9969        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9970        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9971                                    WS-AH-REFUND-OVS-AMT
  9972                                    EC-ST-OVR-SHT-AMT.
  9973
  9974     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9975        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9976        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9977                                    WS-TOL-LF-PREM-PCT
  9978                                    WS-TOL-AH-PREM-PCT.
  9979
  9980     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9981        CF-ST-TOL-REF-PCT GREATER THAN +0
  9982        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9983                                    WS-TOL-LF-REFUND-PCT
  9984                                    WS-TOL-AH-REFUND-PCT.
  9985
  9986     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9987        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9988        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9989                                    WS-AH-REFUND-OVS-PCT
  9990                                    EC-ST-OVR-SHT-PCT.
  9991
  9992     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9993     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9994
  9995     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9996          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9997
  9998     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 184
* EL050.cbl
  9999     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10000     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10001
 10002     IF CF-ST-LF-PREM-TAX NUMERIC
 10003        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10004     END-IF
 10005     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10006        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10007     END-IF
 10008     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10009        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10010     END-IF
 10011
 10012     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10013         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10014     END-IF.
 10015
 10016     IF CF-ST-CAUSAL-STATE > SPACES
 10017         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10018     END-IF.
 10019     if cf-st-extra-interest-periods not numeric
 10020        move zeros               to cf-st-extra-interest-periods
 10021     end-if
 10022     if cf-st-extra-payments not numeric
 10023        move zeros               to cf-st-extra-payments
 10024     end-if
 10025
 10026     move cf-st-extra-interest-periods
 10027                                 to ws-int-periods
 10028     move cf-st-extra-payments   to ws-extra-pmts
 10029     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10030     move cf-st-net-only-state   to ws-net-only-state
 10031     if cf-st-comm-cap-sl not numeric
 10032        move zeros               to cf-st-comm-cap-sl
 10033     end-if
 10034     if cf-st-comm-cap-jl not numeric
 10035        move zeros               to cf-st-comm-cap-jl
 10036     end-if
 10037     if cf-st-comm-cap-sa not numeric
 10038        move zeros               to cf-st-comm-cap-sa
 10039     end-if
 10040     if cf-st-comm-cap-ja not numeric
 10041        move zeros               to cf-st-comm-cap-ja
 10042     end-if
 10043     if cf-st-ga-comm-cap-sl not numeric
 10044        move zeros               to cf-st-ga-comm-cap-sl
 10045     end-if
 10046     if cf-st-ga-comm-cap-jl not numeric
 10047        move zeros               to cf-st-ga-comm-cap-jl
 10048     end-if
 10049     if cf-st-ga-comm-cap-sa not numeric
 10050        move zeros               to cf-st-ga-comm-cap-sa
 10051     end-if
 10052     if cf-st-ga-comm-cap-ja not numeric
 10053        move zeros               to cf-st-ga-comm-cap-ja
 10054     end-if
 10055
 10056     if cf-st-tot-comm-cap-sl not numeric
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 185
* EL050.cbl
 10057        move zeros               to cf-st-tot-comm-cap-sl
 10058     end-if
 10059     if cf-st-tot-comm-cap-jl not numeric
 10060        move zeros               to cf-st-tot-comm-cap-jl
 10061     end-if
 10062     if cf-st-tot-comm-cap-sa not numeric
 10063        move zeros               to cf-st-tot-comm-cap-sa
 10064     end-if
 10065     if cf-st-tot-comm-cap-ja not numeric
 10066        move zeros               to cf-st-tot-comm-cap-ja
 10067     end-if
 10068
 10069     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10070     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10071     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10072     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10073     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10074     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10075     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10076     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10077     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10078     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10079     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10080     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10081     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10082     IF WS-LF-BENEFIT-CD = ZEROS
 10083        GO TO 0410-CHECK-AH.
 10084
 10085     IF CF-ST-RT-CALC NOT = SPACES
 10086        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10087                                    EC-ST-LF-REM-TERM-CALC
 10088     END-IF
 10089
 10090     IF WS-LF-COVERAGE-TYPE = 'R'
 10091        IF WS-LF-EARNINGS-CALC = '5'
 10092           IF CF-ST-RF-LN-CALC > '0'
 10093              MOVE CF-ST-RF-LN-CALC
 10094                                 TO WS-LF-REFUND-CALC
 10095                                    EC-ST-LF-REFUND-CALC
 10096           END-IF
 10097        ELSE
 10098           IF CF-ST-RF-LR-CALC > '0'
 10099              MOVE CF-ST-RF-LR-CALC
 10100                                 TO WS-LF-REFUND-CALC
 10101                                    EC-ST-LF-REFUND-CALC
 10102           END-IF
 10103        END-IF
 10104     ELSE
 10105        IF CF-ST-RF-LL-CALC > '0'
 10106           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10107                                    EC-ST-LF-REFUND-CALC
 10108        END-IF
 10109     END-IF
 10110
 10111     IF CF-ST-RT-CALC NOT = SPACES
 10112        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10113                                    EC-ST-LF-REM-TERM-CALC
 10114     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 186
* EL050.cbl
 10115
 10116     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10117     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10118
 10119     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10120
 10121     IF NO-BENEFIT-FOUND
 10122        GO TO 0410-CHECK-AH.
 10123
 10124     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10125        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10126                                 TO EC-ST-LF-REM-TERM-CALC
 10127                                    WS-LF-REM-TERM-CALC
 10128     END-IF
 10129
 10130     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10131        MOVE CF-ST-REFUND-CALC (SUB3)
 10132                                 TO WS-LF-REFUND-CALC
 10133                                    EC-ST-LF-REFUND-CALC
 10134     END-IF
 10135*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10136     if cf-st-extra-periods (sub3) not numeric
 10137        move zeros               to cf-st-extra-periods (sub3)
 10138     end-if
 10139     if cf-st-extra-periods (sub3) > zeros
 10140        if ws-lf-ben-category = 'P'
 10141           move cf-st-extra-periods (sub3)
 10142                                 to ws-extra-pmts
 10143        else
 10144           if ws-lf-ben-category = 'I'
 10145              move cf-st-extra-periods (sub3)
 10146                                 to ws-int-periods
 10147           end-if
 10148        end-if
 10149     end-if
 10150     .
 10151 0410-CHECK-AH.
 10152
 10153     IF WS-AH-BENEFIT-CD = ZEROS
 10154        GO TO 0500-SET-ACCOUNT.
 10155
 10156     IF CF-ST-RT-CALC NOT = SPACES
 10157        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10158                                    EC-ST-AH-REM-TERM-CALC
 10159     END-IF
 10160
 10161     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10162        IF CF-ST-RF-CP-CALC > '0'
 10163           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10164                                    EC-ST-AH-REFUND-CALC
 10165        END-IF
 10166     ELSE
 10167        IF CF-ST-RF-AH-CALC > '0'
 10168           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10169                                    EC-ST-AH-REFUND-CALC
 10170        END-IF
 10171     END-IF
 10172     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 187
* EL050.cbl
 10173     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10174
 10175     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10176
 10177     IF NO-BENEFIT-FOUND
 10178        GO TO 0500-SET-ACCOUNT.
 10179
 10180     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10181        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10182                                 TO WS-AH-REM-TERM-CALC
 10183                                    EC-ST-AH-REM-TERM-CALC
 10184     END-IF
 10185
 10186     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10187        MOVE CF-ST-REFUND-CALC (SUB3)
 10188                                 TO WS-AH-REFUND-CALC
 10189                                    EC-ST-AH-REFUND-CALC
 10190     END-IF
 10191
 10192*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10193
 10194     GO TO 0500-SET-ACCOUNT.
 10195
 10196 0499-STATE-NOT-FOUND.
 10197
 10198     MOVE ER-2603                TO WS-ERROR.
 10199     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10200
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 188
* EL050.cbl
 10202
 10203 0500-SET-ACCOUNT.
 10204*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10205     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10206        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10207        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10208        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10209        MOVE '3'                 TO CNTL-REC-TYPE
 10210        MOVE +0                  TO CNTL-SEQ-NO
 10211
 10212        MOVE '3'                 TO RC-SW-2
 10213        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10214
 10215        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10216           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10217           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10218           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10219                                    WS-ST-AH-PREM-TAX-I
 10220                                    WS-ST-AH-PREM-TAX-G
 10221        ELSE
 10222           IF CF-ST-LF-PREM-TAX NUMERIC
 10223              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10224           END-IF
 10225           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10226              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10227           END-IF
 10228           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10229              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10230           END-IF
 10231        END-IF
 10232        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10233     END-IF
 10234*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10235*  FOR DCC ONLY
 10236     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10237
 10238        MOVE ' '                 TO STAT-MASTER-SW
 10239        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10240        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10241        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10242        MOVE PB-STATE            TO ELSTAT-STATE
 10243        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10244           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10245        END-IF
 10246
 10247        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10248        SET BIN-TO-GREG          TO TRUE
 10249        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10250        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10251        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10252
 10253        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10254        IF STAT-MASTER-FOUND
 10255           MOVE 'N'              TO STAT-MASTER-SW
 10256           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10257           IF STAT-MASTER-FOUND
 10258              IF (ELSTAT-KEY-SAVE (1:12) =
 10259                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 189
* EL050.cbl
 10260                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10261                    MOVE 'F'        TO STAT-MASTER-SW
 10262                 ELSE
 10263                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10264                    IF (STAT-MASTER-FOUND)
 10265                       AND (ELSTAT-KEY-SAVE (1:12) =
 10266                           SF-CONTROL-PRIMARY (1:12))
 10267                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10268                       MOVE 'F'     TO STAT-MASTER-SW
 10269                    END-IF
 10270                 END-IF
 10271              END-IF
 10272           END-IF
 10273        END-IF
 10274
 10275        IF STAT-MASTER-SW = 'F'
 10276           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10277              and (sf-st-lf-prem-tax > zeros)
 10278              MOVE SF-ST-LF-PREM-TAX
 10279                                 TO WS-ST-LF-PREM-TAX
 10280           END-IF
 10281           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10282              and (sf-st-ah-prem-tax-i > zeros)
 10283              MOVE SF-ST-AH-PREM-TAX-I
 10284                                 TO WS-ST-AH-PREM-TAX-I
 10285           END-IF
 10286           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10287              and (sf-st-ah-prem-tax-g > zeros)
 10288              MOVE SF-ST-AH-PREM-TAX-G
 10289                                 TO WS-ST-AH-PREM-TAX-G
 10290           END-IF
 10291        END-IF
 10292     END-IF
 10293     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10294        AND (PB-ISSUE)
 10295        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10296        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10297        AND (AM-GPCD = 06)
 10298        MOVE 'Y'                 TO WS-GOOD-HIN
 10299        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10300           MOVE PB-I-VIN         TO WS-WORK-VIN
 10301           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10302              (V1 > 16)
 10303              IF WS-WORK-VIN (V1:1) NUMERIC
 10304                 MOVE WS-WORK-VIN-N (V1)
 10305                                 TO WS-ROW-B-VAL (V1)
 10306              ELSE
 10307                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10308                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10309                    OR (V2 > 26)
 10310                 END-PERFORM
 10311                 IF V2 < 27
 10312                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10313                 ELSE
 10314                    MOVE 'N'     TO WS-GOOD-HIN
 10315                 END-IF
 10316              END-IF
 10317              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 190
* EL050.cbl
 10318                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10319              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10320                 WS-ROW-D-VAL (V1)
 10321           END-PERFORM
 10322           MOVE ZEROS            TO WS-VIN-REMAINDER
 10323           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10324             REMAINDER WS-VIN-REMAINDER
 10325           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10326              CONTINUE
 10327           ELSE
 10328              MOVE 'N'           TO WS-GOOD-HIN
 10329           END-IF
 10330        ELSE
 10331           MOVE 'N'              TO WS-GOOD-HIN
 10332        END-IF
 10333        IF WS-GOOD-HIN NOT = 'Y'
 10334           MOVE ER-3826           TO WS-ERROR
 10335           PERFORM 9900-ERROR-FORMAT
 10336                                 THRU 9900-EXIT
 10337        END-IF
 10338     END-IF
 10339     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10340        AND (PB-ISSUE)
 10341        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10342        AND (AM-GPCD NOT = 06)
 10343        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10344           perform 3400-edit-vin thru 3400-exit
 10345        ELSE
 10346          MOVE ER-3826           TO WS-ERROR
 10347          PERFORM 9900-ERROR-FORMAT
 10348                                 THRU 9900-EXIT
 10349        END-IF
 10350     END-IF
 10351     if (pb-company-id = 'CID')
 10352        and (pb-issue)
 10353        and (pb-i-vin not = spaces and low-values and zeros)
 10354        perform 3400-edit-vin    thru 3400-exit
 10355     end-if
 10356******************************************************************
 10357******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10358******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10359******* METHODS.
 10360******************************************************************
 10361     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10362        IF PB-CANCELLATION
 10363           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10364              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10365                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10366                IF FORM-MASTER-FOUND
 10367                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10368******************************************************************
 10369
 10370     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10371     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10372
 10373     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10374     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10375     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 191
* EL050.cbl
 10376     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10377
 10378
 10379     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10380     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10381     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10382
 10383     IF AM-LF-OB-RATE NOT NUMERIC
 10384         MOVE ZERO               TO AM-LF-OB-RATE.
 10385
 10386     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10387         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10388
 10389     IF AM-AH-OB-RATE NOT NUMERIC
 10390         MOVE ZERO               TO AM-AH-OB-RATE.
 10391
 10392     IF WS-LF-JOINT-INDICATOR = 'J'
 10393         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10394     ELSE
 10395         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10396
 10397     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10398
 10399     IF WS-IG-OVRD-AM  EQUAL SPACE
 10400         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10401
 10402     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10403         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10404                                       WS-IG-OVRD
 10405     ELSE
 10406         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10407             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10408                                       WS-IG-OVRD
 10409         ELSE
 10410             MOVE AM-IG             TO WS-IG-OVRD-AH
 10411                                       WS-IG-OVRD.
 10412
 10413     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10414         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10415                                       WS-IG-OVRD
 10416     ELSE
 10417         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10418             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10419                                       WS-IG-OVRD
 10420         ELSE
 10421             MOVE AM-IG             TO WS-IG-OVRD-LF
 10422                                       WS-IG-OVRD.
 10423
 10424     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10425     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10426     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10427     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10428*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10429     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10430                                              TO 'PRLDSFCTIA'.
 10431
 10432     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10433     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 192
* EL050.cbl
 10434     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10435     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10436
 10437     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10438     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10439     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10440     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10441     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10442     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10443     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10444
 10445     IF WS-ACCT-AH-DEV-PCT > +0
 10446        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10447     ELSE
 10448        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10449
 10450     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10451        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10452     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10453        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10454
 10455        IF AM-EARN-METHOD-L = 'S'
 10456            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10457                                        WS-LF-REFUND-CALC.
 10458
 10459        IF AM-EARN-METHOD-R = 'S'
 10460            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10461                                        WS-LF-REFUND-CALC.
 10462
 10463     IF WS-LF-COVERAGE-TYPE = 'R'
 10464         IF AM-EARN-METHOD-R = 'R'
 10465            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10466                                    WS-LF-REFUND-CALC.
 10467     IF WS-LF-COVERAGE-TYPE = 'R'
 10468         IF AM-EARN-METHOD-R = 'P'
 10469            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10470                                    WS-LF-REFUND-CALC.
 10471     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10472         IF AM-EARN-METHOD-L = 'R'
 10473            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10474                                    WS-LF-REFUND-CALC.
 10475     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10476         IF AM-EARN-METHOD-L = 'P'
 10477            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10478                                    WS-LF-REFUND-CALC.
 10479     IF WS-LF-COVERAGE-TYPE = 'R'
 10480         IF AM-EARN-METHOD-R = 'A'
 10481            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10482                                    WS-LF-REFUND-CALC.
 10483     IF WS-LF-COVERAGE-TYPE = 'R'
 10484         IF AM-EARN-METHOD-R = 'M'
 10485            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10486                                    WS-LF-REFUND-CALC.
 10487     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10488         IF AM-EARN-METHOD-L = 'A'
 10489            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10490                                    WS-LF-REFUND-CALC.
 10491     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 193
* EL050.cbl
 10492         IF AM-EARN-METHOD-L = 'M'
 10493            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10494                                    WS-LF-REFUND-CALC.
 10495
 10496     IF AM-EARN-METHOD-A = 'R'
 10497        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10498                                    WS-AH-REFUND-CALC.
 10499     IF AM-EARN-METHOD-A = 'P'
 10500        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10501                                    WS-AH-REFUND-CALC.
 10502     IF AM-EARN-METHOD-A = 'C'
 10503        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10504                                    WS-AH-REFUND-CALC.
 10505     IF AM-EARN-METHOD-A = 'A'
 10506        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10507                                    WS-AH-REFUND-CALC.
 10508     IF AM-EARN-METHOD-A = 'M'
 10509        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10510                                    WS-AH-REFUND-CALC.
 10511     IF AM-EARN-METHOD-A = 'N'
 10512        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10513                                    WS-AH-REFUND-CALC.
 10514     IF AM-EARN-METHOD-A = 'S'
 10515        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10516                                    WS-AH-REFUND-CALC.
 10517
 10518     IF AM-TOL-PREM NOT = ZEROS
 10519        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10520                                    WS-TOL-AH-PREM.
 10521
 10522     IF AM-OVR-SHT-AMT NUMERIC AND
 10523                  AM-OVR-SHT-AMT > 0
 10524        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10525                                    EC-AM-LF-OVR-SHT-AMT
 10526                                    WS-AH-REFUND-OVS-AMT
 10527                                    EC-AM-AH-OVR-SHT-AMT.
 10528
 10529     IF AM-OVR-SHT-PCT NUMERIC AND
 10530                    AM-OVR-SHT-PCT > 0
 10531        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10532                                    EC-AM-LF-OVR-SHT-PCT
 10533                                    WS-AH-REFUND-OVS-PCT
 10534                                    EC-AM-AH-OVR-SHT-PCT.
 10535
 10536     IF AM-TOL-REF-PCT NUMERIC AND
 10537                  AM-TOL-REF-PCT > 0
 10538        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10539                                    WS-TOL-AH-REFUND-PCT.
 10540
 10541     IF AM-TOL-REF  NOT = ZEROS  AND
 10542                  AM-TOL-REF NUMERIC
 10543        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10544                                    EC-AM-LF-TOL-REFUND
 10545                                    WS-TOL-AH-REFUND
 10546                                    EC-AM-AH-TOL-REFUND.
 10547
 10548     IF AM-TOL-CLM  NOT = ZEROS
 10549        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 194
* EL050.cbl
 10550                                    WS-TOL-AH-CLAIM.
 10551
 10552     IF AM-CLP-TOL-PCT NOT NUMERIC
 10553        MOVE +0                  TO AM-CLP-TOL-PCT
 10554     END-IF
 10555
 10556     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10557        MOVE +0                  TO AM-SPP-LEASE-COMM
 10558     END-IF
 10559     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10560        MOVE WS-PL-TOL-LF-PREM-PCT
 10561                                 TO WS-TOL-LF-PREM-PCT.
 10562
 10563     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10564        MOVE WS-PL-TOL-AH-PREM-PCT
 10565                                 TO WS-TOL-AH-PREM-PCT.
 10566
 10567     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10568        MOVE WS-PL-TOL-LF-REFUND-PCT
 10569                                 TO WS-TOL-LF-REFUND-PCT.
 10570
 10571     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10572        MOVE WS-PL-TOL-AH-REFUND-PCT
 10573                                 TO WS-TOL-AH-REFUND-PCT.
 10574
 10575     IF WS-PL-REF-OVS-AMT > +0
 10576        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10577
 10578     IF WS-PL-REF-OVS-PCT > +0
 10579        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10580
 10581     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10582        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10583     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10584        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10585     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10586        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10587     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10588        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10589     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10590        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10591     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10592        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10593
 10594     IF WS-AH-PL-REF-OVS-AMT > +0
 10595        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10596
 10597     IF WS-AH-PL-REF-OVS-PCT > +0
 10598        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10599
 10600     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10601     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10602
 10603     IF PB-CANCELLATION
 10604        GO TO 3000-CONTINUE-EDIT.
 10605
 10606     MOVE +1 TO SUB1.
 10607     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 195
* EL050.cbl
 10608     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10609
 10610     IF CF-COMPANY-ID = 'DMD'
 10611       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10612         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10613        ELSE
 10614         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10615
 10616  0525-FIND-ACCT-COMM.
 10617     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10618        NEXT SENTENCE
 10619      ELSE
 10620         ADD +1 TO SUB1
 10621         IF SUB1 LESS +11
 10622            GO TO 0525-FIND-ACCT-COMM
 10623          ELSE
 10624             GO TO 0550-st-comm-cap-check.
 10625
 10626     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10627     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10628                                    PB-I-LIFE-COMMISSION.
 10629***  IF PB-COMPANY-ID = 'CRI'
 10630     IF PB-PREM-ACCTNG-ONLY
 10631         GO TO 0550-st-comm-cap-check.
 10632
 10633     MOVE '0530' TO CTBL-SW.
 10634     MOVE ' '    TO WS-CTBL-READ-SW.
 10635
 10636
 10637 0530-GET-AH-COMP.
 10638     IF NO-AH-COVERAGE  OR
 10639        NO-AH-BENEFIT-MATCH
 10640           GO TO 0540-NEXT-READ-STEP.
 10641
 10642     IF AM-A-COM (SUB1) NUMERIC
 10643        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10644         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10645         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10646         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10647         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10648     ELSE
 10649          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10650          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10651          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10652          MOVE ZEROS             TO WS-SUB1
 10653                                    WS-COMMISSION
 10654          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10655          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10656          IF WS-COMMISSION > ZEROS
 10657             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10658             GO TO 0540-NEXT-READ-STEP
 10659          END-IF
 10660          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10661          IF CTBL-TABLE-FOUND
 10662             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10663                                        PB-I-AH-TERM
 10664             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10665             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 196
* EL050.cbl
 10666             GO TO 0540-NEXT-READ-STEP
 10667          ELSE
 10668             IF FIRST-TIME-THROUGH
 10669                 GO TO 0530-GET-AH-COMP
 10670             ELSE
 10671                 MOVE ER-2609                TO WS-ERROR
 10672                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10673
 10674 0540-NEXT-READ-STEP.
 10675     MOVE '0540' TO CTBL-SW.
 10676     MOVE ' '    TO WS-CTBL-READ-SW.
 10677
 10678 0540-GET-LF-COMP.
 10679     IF NO-LIFE-COVERAGE  OR
 10680        NO-LF-BENEFIT-MATCH
 10681           GO TO 0550-st-comm-cap-check.
 10682
 10683     IF WS-LF-JOINT-INDICATOR = 'J'
 10684        IF AM-J-COM (SUB1) NUMERIC
 10685           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10686           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10687           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10688           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10689           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10690        ELSE
 10691           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10692           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10693           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10694           MOVE ZEROS                TO WS-SUB1
 10695                                        WS-COMMISSION
 10696           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10697           IF WS-COMMISSION > ZEROS
 10698              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10699              GO TO 0550-st-comm-cap-check
 10700           END-IF
 10701           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10702           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10703           IF CTBL-TABLE-FOUND
 10704              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10705              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10706              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10707              GO TO 0550-st-comm-cap-check
 10708           ELSE
 10709              IF FIRST-TIME-THROUGH
 10710                  GO TO 0540-GET-LF-COMP
 10711              ELSE
 10712                  MOVE ER-2609                TO WS-ERROR
 10713                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10714                  GO TO 0550-st-comm-cap-check.
 10715
 10716     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10717        IF AM-L-COM (SUB1) NUMERIC
 10718           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10719           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10720           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10721           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10722           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10723        ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 197
* EL050.cbl
 10724           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10725           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10726           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10727           MOVE ZEROS                TO WS-SUB1
 10728                                        WS-COMMISSION
 10729           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10730           IF WS-COMMISSION IS GREATER THAN ZEROS
 10731              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10732              GO TO 0550-st-comm-cap-check
 10733           END-IF
 10734           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10735           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10736           IF CTBL-TABLE-FOUND
 10737              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10738              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10739              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10740              GO TO 0550-st-comm-cap-check
 10741           ELSE
 10742              IF FIRST-TIME-THROUGH
 10743                  GO TO 0540-GET-LF-COMP
 10744              ELSE
 10745                  MOVE ER-2609                TO WS-ERROR
 10746                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10747
 10748 0550-st-comm-cap-check.
 10749
 10750     move +0                     to ws-tot-sl-wk-rate
 10751                                    ws-sl-wk-rate
 10752                                    ws-ga-sl-wk-rate
 10753                                    ws-tot-jl-wk-rate
 10754                                    ws-jl-wk-rate
 10755                                    ws-ga-jl-wk-rate
 10756                                    ws-tot-sa-wk-rate
 10757                                    ws-sa-wk-rate
 10758                                    ws-ga-sa-wk-rate
 10759                                    ws-tot-ja-wk-rate
 10760                                    ws-ja-wk-rate
 10761                                    ws-ga-ja-wk-rate
 10762     perform varying sub5 from +1 by +1 until
 10763        (sub5 > +10)
 10764        move +0                  to ws-wk-rate
 10765        if (am-gl-codes (sub5) <> 'Y')
 10766           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10767           if pb-i-lf-benefit-cd <> '  ' and '00'
 10768              move zeros         to ws-wk-rate
 10769              if (am-l-com (sub5) numeric)
 10770                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10771                 move am-l-com(sub5)
 10772                                 to ws-wk-rate
 10773              else
 10774                 move pb-company-cd to ctbl-company-cd
 10775                 move pb-i-lf-benefit-cd
 10776                                 to ctbl-ben-code
 10777                 move pb-i-lf-term  to ws-work-term
 10778                 move pb-life-override-l1
 10779                                 to ctbl-ben-type
 10780                 move zeros      to ws-sub1
 10781                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 198
* EL050.cbl
 10782                 move am-l-coma (sub5)
 10783                                 to ctbl-table
 10784                 move '0540'     to ctbl-sw
 10785                 perform 0552-get-it
 10786                                 thru 0552-exit
 10787              end-if
 10788              compute ws-tot-sl-wk-rate =
 10789                 ws-tot-sl-wk-rate + ws-wk-rate
 10790              if am-com-typ(sub5) = 'C' or 'D'
 10791                 compute ws-sl-wk-rate =
 10792                    ws-sl-wk-rate + ws-wk-rate
 10793              else
 10794                 if am-com-typ(sub5) = 'O' or 'P'
 10795                    compute ws-ga-sl-wk-rate =
 10796                       ws-ga-sl-wk-rate + ws-wk-rate
 10797                 end-if
 10798              end-if
 10799
 10800              move zeros         to ws-wk-rate
 10801              if (am-j-com (sub5) numeric)
 10802                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10803                 move am-j-com(sub5)
 10804                                 to ws-wk-rate
 10805              else
 10806                 move pb-company-cd to ctbl-company-cd
 10807                 move pb-i-lf-benefit-cd
 10808                                 to ctbl-ben-code
 10809                 move pb-i-lf-term  to ws-work-term
 10810                 move pb-life-override-l1
 10811                                 to ctbl-ben-type
 10812                 move zeros      to ws-sub1
 10813                                    ws-commission
 10814                 move am-j-coma (sub5)
 10815                                 to ctbl-table
 10816                 move '0540'     to ctbl-sw
 10817                 perform 0552-get-it
 10818                                 thru 0552-exit
 10819              end-if
 10820              compute ws-tot-jl-wk-rate =
 10821                 ws-tot-jl-wk-rate + ws-wk-rate
 10822              if am-com-typ(sub5) = 'C' or 'D'
 10823                 compute ws-jl-wk-rate =
 10824                    ws-jl-wk-rate + ws-wk-rate
 10825              else
 10826                 if am-com-typ(sub5) = 'O' or 'P'
 10827                    compute ws-ga-jl-wk-rate =
 10828                       ws-ga-jl-wk-rate + ws-wk-rate
 10829                 end-if
 10830              end-if
 10831           end-if
 10832           move zeros            to ws-wk-rate
 10833
 10834           if pb-i-ah-benefit-cd <> '  ' and '00'
 10835              if (am-a-com (sub5) numeric)
 10836                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10837                 move am-a-com(sub5)
 10838                                 to ws-wk-rate
 10839              else
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 199
* EL050.cbl
 10840                 move pb-company-cd to ctbl-company-cd
 10841                 move pb-i-ah-benefit-cd
 10842                                 to ctbl-ben-code
 10843                 move pb-i-ah-term  to ws-work-term
 10844                 move pb-ah-override-l1
 10845                                 to ctbl-ben-type
 10846                 move zeros      to ws-sub1
 10847                                    ws-commission
 10848                 move am-a-coma (sub5)
 10849                                 to ctbl-table
 10850                 move '0530'     to ctbl-sw
 10851                 perform 0552-get-it
 10852                                 thru 0552-exit
 10853              end-if
 10854              compute ws-tot-sa-wk-rate =
 10855                 ws-tot-sa-wk-rate + ws-wk-rate
 10856              if am-com-typ(sub5) = 'C' or 'D'
 10857                 compute ws-sa-wk-rate =
 10858                    ws-sa-wk-rate + ws-wk-rate
 10859              else
 10860                 if am-com-typ(sub5) = 'O' or 'P'
 10861                    compute ws-ga-sa-wk-rate =
 10862                       ws-ga-sa-wk-rate + ws-wk-rate
 10863                 end-if
 10864              end-if
 10865           end-if
 10866        end-if
 10867     end-perform
 10868
 10869     go to 0550-continue
 10870
 10871     .
 10872 0552-get-it.
 10873
 10874     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10875     MOVE ZEROS                  TO WS-SUB1
 10876                                    WS-COMMISSION
 10877     MOVE ' '                    TO WS-CTBL-READ-SW
 10878     PERFORM 8300-READ-CTBL-TABLE
 10879                                 THRU 8300-EXIT
 10880     IF FIRST-TIME-THROUGH
 10881        MOVE 'AA'                TO CTBL-BEN-CODE
 10882        PERFORM 8300-READ-CTBL-TABLE
 10883                                 THRU 8300-EXIT
 10884     END-IF
 10885     IF CTBL-TABLE-FOUND
 10886        if pb-life-override-l1 = ctbl-ben-type
 10887           move pb-i-lf-benefit-amt
 10888                                 to WS-COMM-CK-AMT
 10889        else
 10890           compute ws-comm-ck-amt =
 10891              pb-I-ah-benefit-amt * pb-i-ah-term
 10892        end-if
 10893        PERFORM 8800-GET-COMP-RATE
 10894                                 THRU 8800-EXIT
 10895     else
 10896        move zeros               to ws-wk-rate
 10897     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 200
* EL050.cbl
 10898
 10899     .
 10900 0552-exit.
 10901     exit.
 10902
 10903 0550-continue.
 10904
 10905     if ws-lf-joint-indicator = 'J'
 10906        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10907           and (ws-st-comm-cap-jl <> zeros)
 10908           MOVE ER-1956          TO WS-ERROR
 10909           PERFORM 9900-ERROR-FORMAT
 10910                                 THRU 9900-EXIT
 10911        end-if
 10912        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10913           and (ws-st-ga-comm-cap-jl <> zeros)
 10914           MOVE ER-1959          TO WS-ERROR
 10915           PERFORM 9900-ERROR-FORMAT
 10916                                 THRU 9900-EXIT
 10917        end-if
 10918        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10919           and (ws-st-tot-comm-cap-jl <> zeros)
 10920           MOVE ER-1962          TO WS-ERROR
 10921           PERFORM 9900-ERROR-FORMAT
 10922                                 THRU 9900-EXIT
 10923        end-if
 10924     else
 10925        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10926           and (ws-st-comm-cap-sl <> zeros)
 10927           MOVE ER-1955          TO WS-ERROR
 10928           PERFORM 9900-ERROR-FORMAT
 10929                                 THRU 9900-EXIT
 10930        end-if
 10931        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10932           and (ws-st-ga-comm-cap-sl <> zeros)
 10933           MOVE ER-1958          TO WS-ERROR
 10934           PERFORM 9900-ERROR-FORMAT
 10935                                 THRU 9900-EXIT
 10936        end-if
 10937        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10938           and (ws-st-tot-comm-cap-sl <> zeros)
 10939           MOVE ER-1961          TO WS-ERROR
 10940           PERFORM 9900-ERROR-FORMAT
 10941                                 THRU 9900-EXIT
 10942        end-if
 10943
 10944     if ws-ah-joint-indicator = 'J'
 10945        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10946           and (ws-st-comm-cap-ja <> zeros)
 10947           MOVE ER-1957          TO WS-ERROR
 10948           PERFORM 9900-ERROR-FORMAT
 10949                                 THRU 9900-EXIT
 10950        end-if
 10951        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10952           and (ws-st-ga-comm-cap-ja <> zeros)
 10953           MOVE ER-1960          TO WS-ERROR
 10954           PERFORM 9900-ERROR-FORMAT
 10955                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 201
* EL050.cbl
 10956        end-if
 10957        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10958           and (ws-st-tot-comm-cap-ja <> zeros)
 10959           MOVE ER-1963          TO WS-ERROR
 10960           PERFORM 9900-ERROR-FORMAT
 10961                                 THRU 9900-EXIT
 10962        end-if
 10963     else
 10964        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10965           and (ws-st-comm-cap-sa <> zeros)
 10966           MOVE ER-1957          TO WS-ERROR
 10967           PERFORM 9900-ERROR-FORMAT
 10968                                 THRU 9900-EXIT
 10969        end-if
 10970        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10971           and (ws-st-ga-comm-cap-sa <> zeros)
 10972           MOVE ER-1960          TO WS-ERROR
 10973           PERFORM 9900-ERROR-FORMAT
 10974                                 THRU 9900-EXIT
 10975        end-if
 10976        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10977           and (ws-st-tot-comm-cap-sa <> zeros)
 10978           MOVE ER-1963          TO WS-ERROR
 10979           PERFORM 9900-ERROR-FORMAT
 10980                                 THRU 9900-EXIT
 10981        end-if
 10982     end-if
 10983     .
 10984 0560-EDIT-CONTINUE.
 10985     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10986                                    WS-AH-PMF-COMM
 10987*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10988*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10989     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10990        (SUB1 > +10)
 10991        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10992           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10993           MOVE '0530'           TO CTBL-SW
 10994           MOVE ' '              TO WS-CTBL-READ-SW
 10995           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10996           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10997           MOVE '0540'           TO CTBL-SW
 10998           MOVE ' '              TO WS-CTBL-READ-SW
 10999           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11000        END-IF
 11001     END-PERFORM
 11002     GO TO 0564-EDIT-CONTINUE
 11003     .
 11004 0561-CHECK-AH.
 11005     IF (NO-AH-COVERAGE)
 11006        OR (NO-AH-BENEFIT-MATCH)
 11007        CONTINUE
 11008     ELSE
 11009        IF (AM-A-COM (SUB1) NUMERIC)
 11010           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11011           IF (AM-COM-TYP (SUB1) = 'A')
 11012              AND (WS-AH-PMF-COMM = ZEROS)
 11013              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 202
* EL050.cbl
 11014           END-IF
 11015           CONTINUE
 11016        ELSE
 11017           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11018           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11019           MOVE PB-AH-OVERRIDE-L1
 11020                                 TO CTBL-BEN-TYPE
 11021           MOVE ZEROS            TO WS-SUB1
 11022                                    WS-COMMISSION
 11023           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11024           PERFORM 8300-READ-CTBL-TABLE
 11025                                 THRU 8300-EXIT
 11026           IF CTBL-TABLE-FOUND
 11027              IF (AM-COM-TYP (SUB1) = 'A')
 11028                 AND (WS-AH-PMF-COMM = ZEROS)
 11029                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11030                                        PB-I-AH-TERM
 11031                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11032                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11033              END-IF
 11034              CONTINUE
 11035           ELSE
 11036              IF FIRST-TIME-THROUGH
 11037                 GO TO 0561-CHECK-AH
 11038              ELSE
 11039                 MOVE ER-2609    TO WS-ERROR
 11040                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11041              END-IF
 11042           END-IF
 11043        END-IF
 11044     END-IF
 11045     .
 11046 0561-EXIT.
 11047     EXIT.
 11048 0563-CHECK-LF.
 11049     IF (NO-LIFE-COVERAGE)
 11050        OR (NO-LF-BENEFIT-MATCH)
 11051        CONTINUE
 11052     ELSE
 11053        IF WS-LF-JOINT-INDICATOR = 'J'
 11054           IF AM-J-COM (SUB1) NUMERIC
 11055              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11056              IF (AM-COM-TYP (SUB1) = 'A')
 11057                 AND (WS-LF-PMF-COMM = ZEROS)
 11058                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11059              END-IF
 11060              CONTINUE
 11061           ELSE
 11062              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11063              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11064              MOVE PB-LIFE-OVERRIDE-L1
 11065                                 TO CTBL-BEN-TYPE
 11066              MOVE ZEROS         TO WS-SUB1
 11067                                    WS-COMMISSION
 11068              MOVE AM-J-COMA (SUB1)
 11069                                 TO CTBL-TABLE
 11070              PERFORM 8300-READ-CTBL-TABLE
 11071                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 203
* EL050.cbl
 11072              IF CTBL-TABLE-FOUND
 11073                 IF (AM-COM-TYP (SUB1) = 'A')
 11074                    AND (WS-LF-PMF-COMM = ZEROS)
 11075                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11076                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11077                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11078                 END-IF
 11079                 CONTINUE
 11080              ELSE
 11081                 IF FIRST-TIME-THROUGH
 11082                    GO TO 0563-CHECK-LF
 11083                 ELSE
 11084                    MOVE ER-2609 TO WS-ERROR
 11085                    PERFORM 9900-ERROR-FORMAT
 11086                                 THRU 9900-EXIT
 11087*                   GO TO 0560-EDIT-CONTINUE
 11088                 END-IF
 11089              END-IF
 11090           END-IF
 11091        ELSE
 11092           IF AM-L-COM (SUB1) NUMERIC
 11093              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11094              IF (AM-COM-TYP (SUB1) = 'A')
 11095                 AND (WS-LF-PMF-COMM = ZEROS)
 11096                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11097              END-IF
 11098              CONTINUE
 11099           ELSE
 11100              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11101              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11102              MOVE PB-LIFE-OVERRIDE-L1
 11103                                 TO CTBL-BEN-TYPE
 11104              MOVE ZEROS         TO WS-SUB1
 11105                                    WS-COMMISSION
 11106              MOVE AM-L-COMA (SUB1)
 11107                                 TO CTBL-TABLE
 11108              PERFORM 8300-READ-CTBL-TABLE
 11109                                 THRU 8300-EXIT
 11110              IF CTBL-TABLE-FOUND
 11111                 CONTINUE
 11112              ELSE
 11113                 IF FIRST-TIME-THROUGH
 11114                    GO TO 0563-CHECK-LF
 11115                 ELSE
 11116                    MOVE ER-2609 TO WS-ERROR
 11117                    PERFORM 9900-ERROR-FORMAT
 11118                                 THRU 9900-EXIT
 11119                 END-IF
 11120              END-IF
 11121           END-IF
 11122        END-IF
 11123     END-IF
 11124     .
 11125 0563-EXIT.
 11126     EXIT.
 11127 0564-EDIT-CONTINUE.
 11128
 11129     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 204
* EL050.cbl
 11130         IF PB-I-NUM-BILLED EQUAL ZEROS
 11131            MOVE ER-8148       TO WS-ERROR
 11132            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11133
 11134*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11135*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11136*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11137*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11138*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11139*         IF NO-CONVERSION-ERROR
 11140*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11141*         ELSE
 11142*             IF PB-COMPANY-ID EQUAL 'HAN'
 11143*                 MOVE ZEROS     TO PB-I-AGE.
 11144     IF PB-I-BIRTHDAY > LOW-VALUES
 11145        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11146        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11147        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11148        PERFORM 8500-DATE-CONVERT
 11149                                 THRU 8500-EXIT
 11150        IF NO-CONVERSION-ERROR
 11151           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11152           IF PB-I-AGE > ZEROS
 11153              IF WS-WORK-AGE NOT = PB-I-AGE
 11154                 MOVE ER-9501    TO WS-ERROR
 11155                 PERFORM 9900-ERROR-FORMAT
 11156                                 THRU 9900-EXIT
 11157              END-IF
 11158           ELSE
 11159              MOVE WS-WORK-AGE   TO PB-I-AGE
 11160           END-IF
 11161        END-IF
 11162     END-IF
 11163     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11164                                   WS-INS-AGE-SET
 11165     IF PB-I-AGE = ZEROS
 11166        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11167           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11168                                   WS-INS-AGE-SET
 11169           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11170
 11171     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11172                                   WS-AH-EDIT-AGE.
 11173
 11174     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11175        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11176        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11177        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11178        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11179        IF NO-CONVERSION-ERROR
 11180           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11181           IF PB-I-JOINT-AGE > 0
 11182              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11183                 MOVE ER-9503    TO WS-ERROR
 11184                 PERFORM 9900-ERROR-FORMAT
 11185                                 THRU 9900-EXIT
 11186              END-IF
 11187           ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 205
* EL050.cbl
 11188              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11189           END-IF
 11190        ELSE
 11191           MOVE ZEROS            TO PB-I-JOINT-AGE
 11192        END-IF
 11193     END-IF
 11194     IF PB-I-JOINT-AGE NOT NUMERIC
 11195        MOVE ZERO               TO PB-I-JOINT-AGE.
 11196
 11197     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11198                                   WS-JNT-AGE-SET
 11199     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11200        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11201           (WS-AH-JOINT-INDICATOR = 'J')
 11202           IF PB-I-JOINT-AGE = ZEROS
 11203               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11204                                          WS-JNT-AGE-SET
 11205               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11206           END-IF
 11207        END-IF
 11208     END-IF
 11209
 11210     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11211     IF WS-LF-JOINT-INDICATOR = 'J'
 11212        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11213        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11214            IF  PB-I-JOINT-AGE = ZERO
 11215                MOVE ER-2686       TO WS-ERROR
 11216                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11217            ELSE
 11218                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11219                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11220                    IF PB-COMPANY-ID NOT = 'LBL'
 11221                        MOVE ER-2685    TO WS-ERROR
 11222                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11223
 11224     IF WS-AH-JOINT-INDICATOR = 'J'
 11225        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11226            IF  PB-I-JOINT-AGE = ZERO
 11227                MOVE ER-2686       TO WS-ERROR
 11228                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11229            ELSE
 11230                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11231                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11232                                           WS-EDIT-AGE
 11233                    IF PB-COMPANY-ID NOT = 'LBL'
 11234                        MOVE ER-2685    TO WS-ERROR
 11235                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11236
 11237******************************************************************
 11238*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11239******************************************************************
 11240
 11241     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11242        (WS-AH-SPECIAL-CALC-CD = 'O')
 11243        NEXT SENTENCE
 11244     ELSE
 11245        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 206
* EL050.cbl
 11246          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11247           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11248            WS-AH-JOINT-INDICATOR = 'J')  AND
 11249           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11250            MOVE ER-2627             TO WS-ERROR
 11251            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11252
 11253     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11254        (WS-AH-SPECIAL-CALC-CD = 'O')
 11255         NEXT SENTENCE
 11256     ELSE
 11257         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11258            WS-AH-JOINT-INDICATOR = 'J'
 11259             IF PB-I-JOINT-INSURED = SPACES
 11260                 IF PB-COMPANY-ID NOT = 'JAL'
 11261                     MOVE ER-2696    TO WS-ERROR
 11262                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11263
 11264     IF PB-COMPANY-ID NOT = 'BOA'
 11265        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11266           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11267           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11268               PB-I-JOINT-INSURED NOT = SPACES)
 11269                MOVE ER-2691         TO WS-ERROR
 11270                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11271
 11272     IF PB-COMPANY-ID = 'BOA'
 11273        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11274           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11275            IF PB-I-JOINT-AGE NOT = ZEROS
 11276                MOVE ER-2691         TO WS-ERROR
 11277                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11278
 11279     IF PB-COMPANY-ID = 'CRI'
 11280        IF PB-I-SIG-SW = 'J'
 11281           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11282              WS-AH-JOINT-INDICATOR NOT = 'J'
 11283              MOVE ER-2675       TO WS-ERROR
 11284              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11285
 11286     IF PB-COMPANY-ID = 'CRI'
 11287        IF PB-I-SIG-SW = 'S'
 11288           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11289              WS-AH-JOINT-INDICATOR = 'J'
 11290              MOVE ER-2676       TO WS-ERROR
 11291              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11292
 11293     IF PB-COMPANY-ID = 'CVL'
 11294         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11295            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11296              MOVE ER-2783           TO WS-ERROR
 11297              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11298     IF (WS-LF-JOINT-INDICATOR = 'J')
 11299        AND (WS-AH-JOINT-INDICATOR = 'J')
 11300        AND (PB-I-LF-TERM > 120)
 11301        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11302        MOVE ER-2783             TO WS-ERROR
 11303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 207
* EL050.cbl
 11304     END-IF
 11305     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11306
 11307     IF PB-I-INDV-GRP-OVRD = 'I'
 11308        MOVE ER-2666             TO WS-ERROR
 11309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11310        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11311
 11312     IF PB-I-INDV-GRP-OVRD = 'G'
 11313        MOVE ER-2666             TO WS-ERROR
 11314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11315        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11316
 11317     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11318        NEXT SENTENCE
 11319     ELSE
 11320        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11321
 11322     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11323        IF WS-ERROR = ER-2666
 11324           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11325           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11326
 11327     IF PB-COMPANY-ID = 'CID'
 11328        IF PB-STATE = 'UT' OR 'MO'
 11329           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11330                 OR '76' OR '77')
 11331                      OR
 11332               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11333                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11334                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11335                   OR '2K' OR '2L'))
 11336              AND PB-I-INDV-GRP-CD = 'I'
 11337              MOVE ER-2721             TO WS-ERROR
 11338              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11339           END-IF
 11340        END-IF
 11341     END-IF
 11342
 11343     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11344     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11345        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11346     ELSE
 11347        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11348     END-IF
 11349
 11350*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11351*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11352     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11353                                    ACCOUNT-AH-CK-SW.
 11354
 11355     IF PB-REISSUED-CERT       OR
 11356        PB-REIN-ONLY-CERT      OR
 11357        PB-POLICY-IS-DECLINED  OR
 11358        PB-POLICY-IS-VOIDED
 11359*       OR PB-MONTHLY-CERT
 11360         GO TO 3000-CONTINUE-EDIT.
 11361
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 208
* EL050.cbl
 11362     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11363        IF WS-EDIT-AGE           > +65
 11364           MOVE ER-2709          TO WS-ERROR
 11365           PERFORM 9900-ERROR-FORMAT
 11366                                 THRU 9900-EXIT
 11367        ELSE
 11368           IF WS-EDIT-AGE        > +55
 11369              MOVE ER-2718       TO WS-ERROR
 11370              PERFORM 9900-ERROR-FORMAT
 11371                                 THRU 9900-EXIT
 11372           END-IF
 11373        END-IF
 11374     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11375        IF WS-EDIT-AGE           > +65
 11376           MOVE ER-2709          TO WS-ERROR
 11377           PERFORM 9900-ERROR-FORMAT
 11378                                 THRU 9900-EXIT
 11379        END-IF
 11380     END-IF
 11381     .
 11382
 11383 0565-LIFE-PLAN-LIMIT-EDITS.
 11384
 11385     IF NOT LF-PLAN-MASTER-FOUND
 11386        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11387                                    EC-AM-LF-MAX-TOT-BEN
 11388        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11389
 11390     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11391
 11392     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11393         IF PL-LM-AGE (1) = ZEROS
 11394             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11395
 11396     IF NO-LF-BENEFIT-MATCH          OR
 11397        WS-LF-BENEFIT-CD = ZEROS     OR
 11398        WS-LF-SPECIAL-CALC-CD = 'M'
 11399        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11400
 11401     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11402     MOVE +1                     TO SUB2.
 11403
 11404     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11405        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11406           MOVE +5   TO SUB2
 11407           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11408              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11409              (PL-LM-AGE (SUB2) EQUAL +0)
 11410              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11411              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11412
 11413     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11414
 11415     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11416                               + PB-I-LF-ALT-BENEFIT-AMT.
 11417
 11418 0568-CHECK-LIFE-ATT-AGE.
 11419
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 209
* EL050.cbl
 11420     IF PL-ATT-AGE NUMERIC AND
 11421        PL-ATT-AGE > +0
 11422        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11423     END-IF
 11424*    IF PL-ATT-AGE NUMERIC AND
 11425*       PL-ATT-AGE > +0
 11426*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11427*       IF PB-I-BIRTHDAY > LOW-VALUES
 11428*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11429*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11430*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11431*          SET BIN-PLUS-ELAPSED  TO TRUE
 11432*          PERFORM 8500-DATE-CONVERT
 11433*                                THRU 8500-EXIT
 11434*          IF NO-CONVERSION-ERROR
 11435*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11436*             MOVE ER-2669       TO WS-ERROR
 11437*             PERFORM 9900-ERROR-FORMAT
 11438*                                THRU 9900-EXIT
 11439*          END-IF
 11440*       ELSE
 11441*          IF WS-ATT-AGE >= PL-ATT-AGE
 11442*             MOVE ER-2669       TO WS-ERROR
 11443*             PERFORM 9900-ERROR-FORMAT
 11444*                                THRU 9900-EXIT
 11445*          END-IF
 11446*       END-IF
 11447*    END-IF
 11448     .
 11449 0570-CHECK-LIFE-LIMITS.
 11450
 11451     IF PB-COMPANY-ID EQUAL 'CRI'
 11452        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11453           IF SUB2 GREATER THAN +4
 11454              MOVE ER-2637 TO WS-ERROR
 11455              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11456              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11457
 11458     IF PB-COMPANY-ID  =  'NCL'
 11459        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11460            SUB2 GREATER THAN +8
 11461             MOVE 'U'         TO PB-BATCH-ENTRY
 11462             MOVE ER-2637     TO WS-ERROR
 11463             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11464             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11465
 11466     IF SUB2 > +8
 11467        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11468           AND (PB-I-SIG-SW = 'Y')
 11469           CONTINUE
 11470        ELSE
 11471           MOVE ER-2637          TO WS-ERROR
 11472           PERFORM 9900-ERROR-FORMAT
 11473                                 THRU 9900-EXIT
 11474        END-IF
 11475        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11476     END-IF
 11477     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 210
* EL050.cbl
 11478     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11479     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11480
 11481     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11482        ADD +1  TO SUB2
 11483        GO TO 0570-CHECK-LIFE-LIMITS.
 11484
 11485     IF PB-COMPANY-ID = 'NCL'
 11486         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11487
 11488     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11489        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11490        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11491           AND (PB-I-SIG-SW = 'Y')
 11492           CONTINUE
 11493        ELSE
 11494           MOVE ER-2637          TO WS-ERROR
 11495           PERFORM 9900-ERROR-FORMAT
 11496                                 THRU 9900-EXIT
 11497        END-IF
 11498     END-IF
 11499     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11500
 11501
 11502 0570-CHECK-NCL-LIFE-LIMITS.
 11503
 11504     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11505        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11506         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11507
 11508     IF APP-CERT-USED
 11509         IF SUB2  LESS THAN  +5
 11510             MOVE +5          TO SUB2
 11511             GO TO 0570-CHECK-LIFE-LIMITS.
 11512
 11513     MOVE ER-2637             TO WS-ERROR.
 11514     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11515
 11516     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11517
 11518 0575-CHECK-NCL-SIG-SWITCH.
 11519
 11520     IF NOT APP-CERT-USED
 11521         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11522
 11523     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11524        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11525        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11526        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11527         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11528
 11529     IF SUB2 GREATER THAN +4
 11530         IF PL-LM-AGE (5) = ZEROS  AND
 11531            PL-LM-AGE (6) = ZEROS  AND
 11532            PL-LM-AGE (7) = ZEROS  AND
 11533            PL-LM-AGE (8) = ZEROS
 11534             MOVE  ER-1927        TO WS-ERROR
 11535             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 211
* EL050.cbl
 11536             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11537         ELSE
 11538             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11539                 MOVE  ER-1920    TO WS-ERROR
 11540                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11541
 11542     IF PB-I-SIG-SW  = 'Y'
 11543       IF NOT PB-I-POLICY-ACCEPTED  AND
 11544          NOT PB-I-POLICY-DECLINED
 11545           MOVE 'U'               TO PB-BATCH-ENTRY
 11546           MOVE  ER-1926          TO WS-ERROR
 11547           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11548
 11549
 11550 0580-AH-PLAN-LIMIT-EDITS.
 11551
 11552     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11553        IF PB-I-AH-BENEFIT-AMT > +1250
 11554           MOVE ER-2702          TO WS-ERROR
 11555           PERFORM 9900-ERROR-FORMAT
 11556                                 THRU 9900-EXIT
 11557        END-IF
 11558     END-IF
 11559
 11560     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11561        AND (PB-MONTHLY-CERT)
 11562        IF PB-I-AH-BENEFIT-AMT > +3000
 11563           MOVE ER-2881          TO WS-ERROR
 11564           PERFORM 9900-ERROR-FORMAT
 11565                                 THRU 9900-EXIT
 11566        END-IF
 11567     END-IF
 11568     IF NOT AH-PLAN-MASTER-FOUND
 11569        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11570        GO TO 3000-CONTINUE-EDIT.
 11571
 11572     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11573
 11574     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11575         IF PL-LM-AGE (1) = ZEROS
 11576             GO TO 3000-CONTINUE-EDIT.
 11577
 11578     IF NO-AH-BENEFIT-MATCH          OR
 11579        WS-AH-BENEFIT-CD = ZEROS     OR
 11580        WS-AH-SPECIAL-CALC-CD = 'M'
 11581        GO TO 3000-CONTINUE-EDIT.
 11582
 11583     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11584     MOVE +1                     TO SUB2.
 11585
 11586     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11587        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11588           MOVE +5 TO SUB2
 11589           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11590              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11591              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11592              (PL-LM-AGE (SUB2) EQUAL +0)
 11593              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 212
* EL050.cbl
 11594              GO TO 3000-CONTINUE-EDIT.
 11595
 11596     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11597
 11598 0590-CHECK-AH-ATT-AGE.
 11599
 11600     IF PL-ATT-AGE NUMERIC AND
 11601        PL-ATT-AGE GREATER THAN +0
 11602        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11603     END-IF
 11604*       IF WS-ATT-AGE >= PL-ATT-AGE
 11605*          MOVE ER-3054          TO WS-ERROR
 11606*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11607     .
 11608 0597-CHECK-AH-LIMITS.
 11609
 11610     IF PB-COMPANY-ID EQUAL 'CRI'
 11611        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11612           IF SUB2 GREATER THAN +4
 11613              MOVE ER-2638       TO WS-ERROR
 11614              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615              GO TO 3000-CONTINUE-EDIT.
 11616
 11617     IF PB-COMPANY-ID  =  'NCL'
 11618        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11619            SUB2 GREATER THAN +8
 11620             MOVE 'U'            TO PB-BATCH-ENTRY
 11621             MOVE ER-2638        TO WS-ERROR
 11622             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11623             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11624
 11625     IF SUB2 > +8
 11626        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11627           AND (PB-I-SIG-SW = 'Y')
 11628           CONTINUE
 11629        ELSE
 11630           MOVE ER-2638          TO WS-ERROR
 11631           PERFORM 9900-ERROR-FORMAT
 11632                                 THRU 9900-EXIT
 11633        END-IF
 11634        GO TO 3000-CONTINUE-EDIT
 11635     END-IF
 11636
 11637     IF PB-COMPANY-ID = 'CRI'
 11638        IF WS-ERROR = ER-2638
 11639           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11640
 11641     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11642     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11643     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11644     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11645
 11646     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11647        ADD +1                   TO SUB2
 11648        GO TO 0597-CHECK-AH-LIMITS.
 11649
 11650     IF PB-COMPANY-ID = 'NCL'
 11651         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 213
* EL050.cbl
 11652
 11653     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11654        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11655        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11656                                 > PL-LM-AMT (SUB2))
 11657        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11658           AND (PB-I-SIG-SW = 'Y')
 11659           CONTINUE
 11660        ELSE
 11661           MOVE ER-2638          TO WS-ERROR
 11662           PERFORM 9900-ERROR-FORMAT
 11663                                 THRU 9900-EXIT
 11664        END-IF
 11665     END-IF
 11666
 11667     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11668         IF  WS-ERROR    EQUAL    ER-2638
 11669             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11670                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11671                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11672                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11673                MOVE  ER-1910    TO  WS-ERROR
 11674                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11675
 11676     IF PB-COMPANY-ID = 'CRI'
 11677        IF WS-ERROR = ER-2638
 11678            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11679            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11680            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11681
 11682     GO TO 3000-CONTINUE-EDIT.
 11683
 11684 0597-CHECK-NCL-AH-LIMITS.
 11685
 11686     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11687        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11688        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11689                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11690         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11691
 11692     IF APP-CERT-USED
 11693         IF SUB2  LESS THAN  +5
 11694             MOVE +5             TO SUB2
 11695             GO TO 0597-CHECK-AH-LIMITS.
 11696
 11697     MOVE ER-2638                TO WS-ERROR.
 11698     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11699
 11700     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11701
 11702 0599-CHECK-NCL-SIG-SWITCH.
 11703
 11704     IF NOT APP-CERT-USED
 11705         GO TO 3000-CONTINUE-EDIT.
 11706
 11707     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11708        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11709        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 214
* EL050.cbl
 11710        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11711         GO TO 3000-CONTINUE-EDIT.
 11712
 11713     IF SUB2 GREATER THAN +4
 11714         IF PL-LM-AGE (5) = ZEROS  AND
 11715            PL-LM-AGE (6) = ZEROS  AND
 11716            PL-LM-AGE (7) = ZEROS  AND
 11717            PL-LM-AGE (8) = ZEROS
 11718             MOVE  ER-1927        TO WS-ERROR
 11719             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11720             GO TO 3000-CONTINUE-EDIT
 11721         ELSE
 11722             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11723                 MOVE  ER-1920    TO WS-ERROR
 11724                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11725
 11726     IF PB-I-SIG-SW  = 'Y'
 11727       IF NOT PB-I-POLICY-ACCEPTED  AND
 11728          NOT PB-I-POLICY-DECLINED
 11729           MOVE 'U'               TO PB-BATCH-ENTRY
 11730           MOVE  ER-1926          TO WS-ERROR
 11731           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11732
 11733******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 215
* EL050.cbl
 11735
 11736 3000-CONTINUE-EDIT.
 11737
 11738     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11739     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11740     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11741     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11742     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11743
 11744     IF BROWSE-STARTED
 11745        PERFORM 9990-RETURN THRU 9990-EXIT
 11746        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11747
 11748     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11749        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11750        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11751        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11752*       MOVE 1                   TO DC-OPTION-CODE
 11753        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11754        IF DATE-CONVERSION-ERROR
 11755           MOVE ER-2622          TO WS-ERROR
 11756           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11757        ELSE
 11758           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11759              MOVE ER-2623       TO WS-ERROR
 11760              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11761           ELSE
 11762              MOVE ER-2622       TO WS-ERROR
 11763              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11764
 11765     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11766     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11767     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11768*    MOVE 1                      TO DC-OPTION-CODE.
 11769     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11770     IF DATE-CONVERSION-ERROR
 11771        GO TO 3005-EDIT-CONTINUE
 11772     ELSE
 11773        IF DC-ELAPSED-DAYS GREATER +180
 11774           MOVE ER-2613          TO WS-ERROR
 11775           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11776        ELSE
 11777           IF DC-ELAPSED-DAYS GREATER +90
 11778              MOVE ER-2612       TO WS-ERROR
 11779              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11780           ELSE
 11781             IF DC-ELAPSED-DAYS GREATER +60
 11782                MOVE ER-2614     TO WS-ERROR
 11783                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11784
 11785 3005-EDIT-CONTINUE.
 11786
 11787     IF PB-CANCELLATION
 11788         GO TO 3700-EDIT-CANCEL.
 11789
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 216
* EL050.cbl
 11791******************************************************************
 11792*                  E D I T   I S S U E                           *
 11793******************************************************************
 11794
 11795 3020-EDIT-ISSUE.
 11796
 11797      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11798      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11799      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11800      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11801      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11802
 11803     IF PB-ISSUE-FORCE
 11804        OR PB-ISSUE-DATE-FORCED
 11805        OR PB-FORCE-OFF
 11806        OR PB-OVERCHARGE-FORCE
 11807        or pb-exceeded-limit-forced
 11808        CONTINUE
 11809     ELSE
 11810        MOVE ER-2670             TO WS-ERROR
 11811        PERFORM 9900-ERROR-FORMAT
 11812                                 THRU 9900-EXIT
 11813     END-IF
 11814     .
 11815 3022-SET-POLICY-STATUS.
 11816
 11817     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11818
 11819     IF (PB-REISSUED-CERT)
 11820             OR
 11821        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11822         AND (PB-MONTHLY-CERT))
 11823         MOVE '5'                TO PB-I-ENTRY-STATUS
 11824         MOVE 'E'                TO PB-BATCH-ENTRY
 11825     END-IF
 11826
 11827     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11828        IF PB-MONTHLY-CERT
 11829           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11830        END-IF
 11831        IF PB-CASH-CERT
 11832           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11833        END-IF
 11834     END-IF
 11835     IF PB-POLICY-IS-DECLINED
 11836         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11837     IF PB-POLICY-IS-VOIDED
 11838         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11839     IF PB-NEEDS-UNDERWRITING
 11840         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11841     IF PB-REIN-ONLY-CERT
 11842         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11843     IF PB-PREM-ACCTNG-ONLY
 11844         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11845
 11846     MOVE SPACE                  TO PB-I-OB-FLAG.
 11847
 11848     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 217
* EL050.cbl
 11849         MOVE ER-2665            TO WS-ERROR
 11850         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11851         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11852
 11853     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11854        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11855           MOVE 'Z'             TO PB-I-OB-FLAG.
 11856
 11857     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11858        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11859           MOVE 'Z'             TO PB-I-OB-FLAG.
 11860
 11861     IF ACCOUNT-MAST-FOUND
 11862         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11863         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11864         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11865         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11866         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11867         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11868         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11869     END-IF
 11870
 11871     IF ACCOUNT-MAST-FOUND
 11872        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11873         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11874
 11875     IF (ACCOUNT-MAST-FOUND)
 11876*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11877        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11878        IF PB-REISSUED-CERT
 11879           CONTINUE
 11880        ELSE
 11881           MOVE ER-2608          TO WS-ERROR
 11882           PERFORM 9900-ERROR-FORMAT
 11883                                 THRU 9900-EXIT
 11884         END-IF
 11885     END-IF
 11886
 11887     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11888        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11889        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11890
 11891**********   DMD CUSTOM CODE FOLLOWS  **********
 11892 3024-EDIT-DMD-FIELDS.
 11893     IF PB-COMPANY-ID NOT = 'DMD'
 11894        GO TO 3025-EDIT-REINSURANCE.
 11895
 11896*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11897*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11898*** ERROR IF THEY ARE NOT EQUAL.
 11899
 11900     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11901     SET BIN-TO-GREG               TO TRUE.
 11902     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11903     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11904**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11905
 11906     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 218
* EL050.cbl
 11907     SET BIN-TO-GREG               TO TRUE.
 11908     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11909     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11910**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11911
 11912     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11913        MOVE ER-8116               TO WS-ERROR
 11914        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11915
 11916     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11917
 11918     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11919                                      WK-FULL-CERT-NO.
 11920     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11921
 11922     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11923
 11924     IF PB-VALID-LIFE
 11925        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11926     ELSE
 11927        IF PB-VALID-AH
 11928          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11929
 11930
 11931     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11932     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11933     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11934                                      DCUA-UNDRWRTR-CODE
 11935                                      DCUA-UNDRWRTR-GROUP-CODE
 11936                                      DCUA-RETURN-CODE.
 11937
 11938****************************************************************
 11939*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11940***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11941***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11942***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11943***   TO THIS RECORD.                                        ***
 11944****************************************************************
 11945     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11946     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11947     IF DCUA-SUCCESSFUL-PROCESS
 11948        GO TO 3024-EDIT-DL7-CONT.
 11949
 11950     IF DCUA-RETURN-CODE EQUAL '01'
 11951        MOVE ER-8110               TO WS-ERROR
 11952        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11954        GO TO 3024-EDIT-DL7-CONT.
 11955
 11956     IF DCUA-RETURN-CODE EQUAL '02'
 11957        MOVE ER-8111               TO WS-ERROR
 11958        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11959        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11960        GO TO 3024-EDIT-DL7-CONT.
 11961
 11962     IF DCUA-RETURN-CODE EQUAL '03'
 11963        MOVE ER-8074               TO WS-ERROR
 11964        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 219
* EL050.cbl
 11965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11966        GO TO 3024-EDIT-DL7-CONT.
 11967
 11968     IF DCUA-RETURN-CODE EQUAL '04'
 11969        MOVE ER-8075               TO WS-ERROR
 11970        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11971        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11972        GO TO 3024-EDIT-DL7-CONT.
 11973
 11974     IF DCUA-RETURN-CODE EQUAL '05'
 11975        MOVE ER-8076               TO WS-ERROR
 11976        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11977        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11978        GO TO 3024-EDIT-DL7-CONT.
 11979
 11980     IF DCUA-RETURN-CODE EQUAL '06'
 11981        MOVE ER-8077               TO WS-ERROR
 11982        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11984        GO TO 3024-EDIT-DL7-CONT.
 11985
 11986     IF DCUA-RETURN-CODE EQUAL '07'
 11987        MOVE ER-8078               TO WS-ERROR
 11988        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11990        GO TO 3024-EDIT-DL7-CONT.
 11991
 11992     IF DCUA-RETURN-CODE EQUAL 'E1'
 11993        MOVE ER-8079               TO WS-ERROR
 11994        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11996        GO TO 3024-EDIT-DL7-CONT.
 11997
 11998     IF DCUA-RETURN-CODE EQUAL 'E2'
 11999        MOVE ER-8080               TO WS-ERROR
 12000        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12001        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12002        GO TO 3024-EDIT-DL7-CONT.
 12003
 12004     IF DCUA-RETURN-CODE EQUAL 'E3'
 12005        MOVE ER-8098               TO WS-ERROR
 12006        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12008        GO TO 3024-EDIT-DL7-CONT.
 12009
 12010     IF DCUA-RETURN-CODE EQUAL 'C1'
 12011        MOVE ER-8099               TO WS-ERROR
 12012        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12014        GO TO 3024-EDIT-DL7-CONT.
 12015
 12016     IF DCUA-RETURN-CODE EQUAL 'U1'
 12017        MOVE ER-8109               TO WS-ERROR
 12018        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12019        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12020        GO TO 3024-EDIT-DL7-CONT.
 12021
 12022     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 220
* EL050.cbl
 12023        MOVE ER-8112               TO WS-ERROR
 12024        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12026        GO TO 3024-EDIT-DL7-CONT.
 12027
 12028     IF DCUA-RETURN-CODE EQUAL 'N2'
 12029        MOVE ER-8113               TO WS-ERROR
 12030        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12032        GO TO 3024-EDIT-DL7-CONT.
 12033
 12034     IF DCUA-RETURN-CODE EQUAL 'N3'
 12035        MOVE ER-8114               TO WS-ERROR
 12036        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12037        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12038        GO TO 3024-EDIT-DL7-CONT.
 12039
 12040     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12041     MOVE ER-8097                  TO WS-ERROR.
 12042     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12043     GO TO 3024-EDIT-DL7-CONT.
 12044
 12045 3024-EDIT-DL7-CONT.
 12046
 12047     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12048     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12049     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12050        NEXT SENTENCE
 12051     ELSE
 12052        MOVE ER-9263               TO WS-ERROR
 12053        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12054
 12055******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12056******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12057     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12058        NEXT SENTENCE
 12059     ELSE
 12060        MOVE ER-8039               TO WS-ERROR
 12061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12062
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 221
* EL050.cbl
 12064****************************************************************
 12065*** VALIDATE STATE  : DLO022                                 ***
 12066****************************************************************
 12067     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12068     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12069
 12070     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12071     IF DVSC-SUCCESSFUL-EDIT
 12072        GO TO 3024-EDIT-DL22-CONT.
 12073
 12074     IF DVSC-RETURN-CODE EQUAL '01'
 12075        MOVE ER-8300               TO WS-ERROR
 12076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12077        GO TO 3024-EDIT-DL22-CONT.
 12078
 12079     IF DVSC-RETURN-CODE EQUAL '02'
 12080        MOVE ER-8301               TO WS-ERROR
 12081        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12082        GO TO 3024-EDIT-DL22-CONT.
 12083
 12084     IF DVSC-RETURN-CODE EQUAL '03'
 12085        MOVE ER-8302               TO WS-ERROR
 12086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12087        GO TO 3024-EDIT-DL22-CONT.
 12088
 12089     IF DVSC-RETURN-CODE EQUAL 'N1'
 12090        MOVE ER-8304               TO WS-ERROR
 12091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12092        GO TO 3024-EDIT-DL22-CONT.
 12093
 12094     MOVE ER-8303                  TO WS-ERROR
 12095     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12096
 12097 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 222
* EL050.cbl
 12099****************************************************************
 12100*** VALIDATE LOAN OFFICER : DLO021                           ***
 12101****************************************************************
 12102
 12103     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12104     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12105     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12106     IF DVLO-SUCCESSFUL-EDIT
 12107        GO TO 3024-EDIT-DL21-CONT.
 12108
 12109     IF DVLO-RETURN-CODE EQUAL '01'
 12110        MOVE ER-8081               TO WS-ERROR
 12111        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12112        GO TO 3024-EDIT-DL21-CONT.
 12113
 12114     IF DVLO-RETURN-CODE EQUAL '02'
 12115        MOVE ER-8082               TO WS-ERROR
 12116        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12117        GO TO 3024-EDIT-DL21-CONT.
 12118
 12119     IF DVLO-RETURN-CODE EQUAL '03'
 12120        MOVE ER-8083               TO WS-ERROR
 12121        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12122        GO TO 3024-EDIT-DL21-CONT.
 12123
 12124     IF DVLO-RETURN-CODE EQUAL '04'
 12125        MOVE ER-8084               TO WS-ERROR
 12126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12127        GO TO 3024-EDIT-DL21-CONT.
 12128
 12129     IF DVLO-RETURN-CODE EQUAL '05'
 12130        MOVE ER-8085               TO WS-ERROR
 12131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12132        GO TO 3024-EDIT-DL21-CONT.
 12133
 12134     MOVE ER-7825                  TO WS-ERROR
 12135     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12136     GO TO 3024-EDIT-DL21-CONT.
 12137
 12138 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 223
* EL050.cbl
 12140
 12141****************************************************************
 12142*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12143****************************************************************
 12144
 12145     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12146     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12147     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12148     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12149     IF DIPF-SUCCESSFUL-EDIT
 12150        GO TO 3024-EDIT-DL02-CONT.
 12151
 12152     IF DIPF-RETURN-CODE EQUAL '01'
 12153        MOVE ER-8086               TO WS-ERROR
 12154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12155        GO TO 3024-EDIT-DL02-CONT.
 12156
 12157     IF DIPF-RETURN-CODE EQUAL '02'
 12158        MOVE ER-8087               TO WS-ERROR
 12159        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12160        GO TO 3024-EDIT-DL02-CONT.
 12161
 12162     IF DIPF-RETURN-CODE EQUAL '03'
 12163        MOVE ER-8088               TO WS-ERROR
 12164        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12165        GO TO 3024-EDIT-DL02-CONT.
 12166
 12167     MOVE ER-8095                  TO WS-ERROR
 12168     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12169     GO TO 3024-EDIT-DL02-CONT.
 12170
 12171 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 224
* EL050.cbl
 12173
 12174****************************************************************
 12175*** VALIDATE BANK ID : DLO003                                ***
 12176****************************************************************
 12177
 12178     MOVE WK-GREG-CENT           TO WCG-CENT.
 12179     MOVE WK-GREG-YYMM           TO WCG-REST.
 12180     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12181        MOVE ER-8040               TO WS-ERROR
 12182        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12183
 12184     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12185     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12186     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12187     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12188     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12189     IF DVBI-SUCCESSFUL-EDIT
 12190        GO TO 3024-EDIT-DL03-CONT.
 12191
 12192     IF DVBI-RETURN-CODE EQUAL '01'
 12193        MOVE ER-8089               TO WS-ERROR
 12194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12195        GO TO 3024-EDIT-DL03-CONT.
 12196
 12197     IF DVBI-RETURN-CODE EQUAL '02'
 12198        MOVE ER-8090               TO WS-ERROR
 12199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12200        GO TO 3024-EDIT-DL03-CONT.
 12201
 12202     IF DVBI-RETURN-CODE EQUAL '03'
 12203        MOVE ER-8091               TO WS-ERROR
 12204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12205        GO TO 3024-EDIT-DL03-CONT.
 12206
 12207     IF DVBI-RETURN-CODE EQUAL '04'
 12208        MOVE ER-8092               TO WS-ERROR
 12209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12210        GO TO 3024-EDIT-DL03-CONT.
 12211
 12212     IF DVBI-RETURN-CODE EQUAL '05'
 12213        MOVE ER-8093               TO WS-ERROR
 12214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12215        GO TO 3024-EDIT-DL03-CONT.
 12216
 12217     IF DVBI-RETURN-CODE EQUAL '06'
 12218        MOVE ER-8094               TO WS-ERROR
 12219        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12220        GO TO 3024-EDIT-DL03-CONT.
 12221
 12222     MOVE ER-8096                  TO WS-ERROR
 12223     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12224     GO TO 3024-EDIT-DL03-CONT.
 12225
 12226 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 225
* EL050.cbl
 12228
 12229     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12230        NEXT SENTENCE
 12231     ELSE
 12232        MOVE ER-8042               TO WS-ERROR
 12233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12234
 12235     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12236     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12237     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12238
 12239     IF DMPF-RETURN-CODE = '01'
 12240        MOVE ER-8067               TO WS-ERROR
 12241        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12242        GO TO 3024-EDIT-DL01-CONT.
 12243
 12244     IF DMPF-RETURN-CODE = '02'
 12245        MOVE ER-8068               TO WS-ERROR
 12246        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12247        GO TO 3024-EDIT-DL01-CONT.
 12248
 12249     IF DMPF-RETURN-CODE = '03'
 12250        MOVE ER-8069               TO WS-ERROR
 12251        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12252        GO TO 3024-EDIT-DL01-CONT.
 12253
 12254     IF DMPF-RETURN-CODE = 'E1'
 12255        MOVE ER-8070               TO WS-ERROR
 12256        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12257        GO TO 3024-EDIT-DL01-CONT.
 12258
 12259     IF DMPF-RETURN-CODE = 'N1'
 12260        MOVE ER-8071               TO WS-ERROR
 12261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12262        GO TO 3024-EDIT-DL01-CONT.
 12263
 12264     IF DMPF-RETURN-CODE NOT = 'OK'
 12265        MOVE ER-8072               TO WS-ERROR
 12266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12267
 12268 3024-EDIT-DL01-CONT.
 12269******************************************************************
 12270***  VALIDATES RATE CODES : DLO017                             ***
 12271******************************************************************
 12272
 12273      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12274      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12275      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12276      IF DVRC-SUCCESSFUL-EDIT
 12277        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12278        GO TO 3024-CHECK-VALID-RATE.
 12279
 12280      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12281
 12282      IF DVRC-RETURN-CODE EQUAL '01'
 12283         MOVE ER-7817                   TO WS-ERROR
 12284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12285         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 226
* EL050.cbl
 12286
 12287      IF DVRC-RETURN-CODE EQUAL '02'
 12288         MOVE ER-7818                   TO WS-ERROR
 12289         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12290         GO TO 3025-EDIT-REINSURANCE.
 12291
 12292      IF DVRC-RETURN-CODE EQUAL '03'
 12293         MOVE ER-7819                   TO WS-ERROR
 12294         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12295         GO TO 3025-EDIT-REINSURANCE.
 12296
 12297       MOVE ER-7820                     TO WS-ERROR.
 12298       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12299       GO TO 3025-EDIT-REINSURANCE.
 12300
 12301******************************************************************
 12302***  GET PREMIUM RATES : DLO011                                ***
 12303******************************************************************
 12304
 12305 3024-CHECK-VALID-RATE.
 12306
 12307     IF VALID-RATE-CODE
 12308        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12309        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12310        MOVE SPACES                TO DPRB-RETURN-CODE
 12311        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12312     ELSE
 12313         GO TO 3025-EDIT-REINSURANCE.
 12314
 12315      IF DPRB-SUCCESSFUL-PROCESS
 12316         IF PB-VALID-LIFE
 12317             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12318             GO TO 3025-EDIT-REINSURANCE
 12319         ELSE
 12320             IF PB-VALID-AH
 12321                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12322                 GO TO 3025-EDIT-REINSURANCE.
 12323
 12324      IF DPRB-RETURN-CODE EQUAL '01'
 12325         MOVE ER-7812                   TO WS-ERROR
 12326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12327         GO TO 3025-EDIT-REINSURANCE.
 12328
 12329      IF DPRB-RETURN-CODE EQUAL '02'
 12330         MOVE ER-7813                   TO WS-ERROR
 12331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12332         GO TO 3025-EDIT-REINSURANCE.
 12333
 12334      IF DPRB-RETURN-CODE EQUAL '03'
 12335         MOVE ER-7814                   TO WS-ERROR
 12336         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12337         GO TO 3025-EDIT-REINSURANCE.
 12338
 12339      IF DPRB-RETURN-CODE EQUAL '04'
 12340         IF NOT DPRB-1ST-TIME
 12341            MOVE ER-7815                   TO WS-ERROR
 12342            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12343            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 227
* EL050.cbl
 12344          ELSE
 12345         IF PB-VALID-LIFE
 12346            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12347          ELSE
 12348            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12349         END-IF
 12350         MOVE SPACES                TO DOCC-RETURN-CODE
 12351         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12352         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12353         IF DOCC-RETURN-CODE = 'OK'
 12354             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12355             GO TO 3024-CHECK-VALID-RATE
 12356           ELSE
 12357             MOVE ER-7823               TO WS-ERROR
 12358             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12359             GO TO 3025-EDIT-REINSURANCE.
 12360
 12361       MOVE ER-7816                     TO WS-ERROR.
 12362       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12363       GO TO 3025-EDIT-REINSURANCE.
 12364
 12365**********   DMD CUSTOM CODE ABOVE    **********
 12366
 12367 3025-EDIT-REINSURANCE.
 12368     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12369         GO TO 3027-EDIT-CONTINUE.
 12370
 12371     MOVE LOW-VALUES               TO ERREIN-KEY.
 12372     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12373     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12374                                      REIN-CODE-2
 12375                                      REIN-CODE-3.
 12376     MOVE 'A'                      TO REIN-TYPE.
 12377
 12378     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12379
 12380     MOVE '3026' TO REIN-SW.
 12381     MOVE ' '                   TO WS-REIN-READ-SW.
 12382
 12383     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12384     IF REIN-TABLE-NOT-FOUND
 12385         GO TO 3026-NO-SPEC-TABLE.
 12386
 12387     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12388     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12389                                   WS-NSP-ST-CD-LF.
 12390     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12391                                   WS-NSP-ST-CD-AH.
 12392
 12393     GO TO 3040-EDIT-CONTINUE.
 12394
 12395 3026-NO-SPEC-TABLE.
 12396
 12397     MOVE ER-2664                TO WS-ERROR.
 12398     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12399     GO TO 3040-EDIT-CONTINUE.
 12400
 12401 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 228
* EL050.cbl
 12402
 12403     IF PB-I-REIN-TABLE = SPACES
 12404       GO TO 3040-EDIT-CONTINUE.
 12405
 12406     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12407          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12408          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12409           GO TO 3040-EDIT-CONTINUE.
 12410
 12411     MOVE LOW-VALUES            TO ERREIN-KEY.
 12412     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12413     MOVE 'A'                   TO REIN-TYPE.
 12414     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12415
 12416     MOVE '3028'                TO REIN-SW.
 12417     MOVE ' '                   TO WS-REIN-READ-SW.
 12418
 12419     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12420     IF REIN-TABLE-NOT-FOUND
 12421         GO TO 3028-NO-REIN-TABLE.
 12422
 12423     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12424     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12425                                   WS-NSP-ST-CD-LF.
 12426     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12427                                   WS-NSP-ST-CD-AH.
 12428
 12429     GO TO 3040-EDIT-CONTINUE.
 12430
 12431 3028-NO-REIN-TABLE.
 12432
 12433     MOVE ER-2615                TO WS-ERROR.
 12434     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12435     GO TO 3040-EDIT-CONTINUE.
 12436
 12437 3040-EDIT-CONTINUE.
 12438
 12439     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12440         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12441
 12442     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12443         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12444
 12445     IF (NOT PB-REISSUED-CERT)
 12446        AND (NOT PB-MONTHLY-CERT)
 12447        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12448            MOVE '001'           TO PB-I-LF-TERM
 12449            MOVE 'M'             TO PB-I-INSURED-SEX.
 12450
 12451     IF (NOT PB-REISSUED-CERT)
 12452        AND (NOT PB-MONTHLY-CERT)
 12453        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12454            MOVE '001'           TO PB-I-AH-TERM
 12455            MOVE 'M'             TO PB-I-INSURED-SEX.
 12456
 12457 3040-EDIT-1ST-PMT-DT.
 12458     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12459     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 229
* EL050.cbl
 12460         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12461
 12462******************************************************************
 12463*                                                                *
 12464*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12465*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12466*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12467*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12468*                                                                *
 12469******************************************************************
 12470
 12471     IF PB-EFF-DT-PROCESSING
 12472        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12473                                    PB-I-LF-EXPIRE-DT
 12474                                    PB-I-AH-EXPIRE-DT
 12475        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12476        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12477        MOVE ZERO                TO DC-ELAPSED-DAYS
 12478        MOVE +1                  TO DC-ELAPSED-MONTHS
 12479        SET BIN-PLUS-ELAPSED     TO TRUE
 12480*       MOVE 6                   TO DC-OPTION-CODE
 12481        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12482        IF NO-CONVERSION-ERROR
 12483           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12484
 12485******************************************************************
 12486*                                                                *
 12487*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12488*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12489*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12490*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12491*                                                                *
 12492******************************************************************
 12493
 12494     IF PB-EXT-DAYS-PROCESSING
 12495          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12496                                         PB-I-LF-EXPIRE-DT
 12497                                         PB-I-AH-EXPIRE-DT
 12498          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12499          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12500          MOVE +1                     TO DC-ELAPSED-MONTHS
 12501          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12502          SET BIN-PLUS-ELAPSED        TO TRUE
 12503*         MOVE 6                      TO DC-OPTION-CODE
 12504          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12505          IF NO-CONVERSION-ERROR
 12506             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12507
 12508******************************************************************
 12509*                                                                *
 12510*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12511*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12512*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12513*        (EXPIRE DATE - (TERM -1))  *  -1.
 12514*                                                                *
 12515******************************************************************
 12516
 12517     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 230
* EL050.cbl
 12518        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12519           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12520              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12521              MOVE PB-I-AH-TERM      TO WS-TERM
 12522           ELSE
 12523              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12524              MOVE PB-I-LF-TERM      TO WS-TERM
 12525        ELSE
 12526           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12527              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12528              MOVE PB-I-LF-TERM      TO WS-TERM
 12529           ELSE
 12530              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12531              MOVE PB-I-AH-TERM      TO WS-TERM.
 12532
 12533     IF PB-EXPIRE-DT-PROCESSING
 12534        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12535        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12536        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12537        MOVE ZERO                TO DC-ELAPSED-DAYS
 12538                                    DC-ODD-DAYS-OVER
 12539          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12540          SET BIN-PLUS-ELAPSED    TO TRUE
 12541*         MOVE 6                  TO DC-OPTION-CODE
 12542          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12543          IF NO-CONVERSION-ERROR
 12544             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12545
 12546******************************************************************
 12547*                                                                *
 12548*            1ST PAYMENT DATE PROCESSING                         *
 12549*                                                                *
 12550******************************************************************
 12551
 12552     IF PB-1ST-PMT-DT-PROCESSING
 12553        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12554                                    PB-I-AH-EXPIRE-DT
 12555        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12556
 12557     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12558         NEXT SENTENCE
 12559     ELSE
 12560         MOVE ER-2680                 TO WS-ERROR
 12561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12562         GO TO 3060-ORIG-TERM-CHECK.
 12563
 12564     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12565     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12566     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12567*    MOVE 1                      TO DC-OPTION-CODE.
 12568     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12569                                    DC-ELAPSED-DAYS
 12570                                    DC-ODD-DAYS-OVER.
 12571
 12572     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12573
 12574     IF DATE-CONVERSION-ERROR
 12575        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 231
* EL050.cbl
 12576
 12577     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12578     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12579        AND (WS-LF-COVERAGE-TYPE = 'L')
 12580        IF (DC-ELAPSED-MONTHS > 1)
 12581                      OR
 12582           ((DC-ELAPSED-MONTHS = 1)
 12583           AND (DC-ODD-DAYS-OVER > 0))
 12584           MOVE ER-2882          TO WS-ERROR
 12585           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12586        END-IF
 12587     END-IF
 12588     if dc-elapsed-months > 0
 12589        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12590        + dc-odd-days-over
 12591     end-if
 12592     IF PB-EXT-DAYS-PROCESSING
 12593        CONTINUE
 12594     ELSE
 12595        IF DC-ELAPSED-MONTHS = +0
 12596           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12597        ELSE
 12598           IF (WS-LF-EARNINGS-CALC = '4')
 12599              AND (DC-ELAPSED-MONTHS > ZERO)
 12600              AND (DC-ELAPSED-DAYS > ZERO)
 12601              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12602           ELSE
 12603              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12604                                 THRU 6499-EXIT
 12605              MOVE WS-ODD-DAYS-OVER
 12606                                 TO PB-I-EXTENTION-DAYS
 12607           END-IF
 12608        END-IF
 12609     END-IF
 12610******************************************************************
 12611*                                                                *
 12612*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12613*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12614*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12615*            AND ANY ODD DAYS.                                   *
 12616*                                                                *
 12617******************************************************************
 12618
 12619     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12620                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12621     IF WS-LF-EARNINGS-CALC NOT = '4'
 12622        IF DC-ELAPSED-DAYS > ZEROS
 12623           MOVE ER-2681          TO WS-ERROR
 12624           PERFORM 9900-ERROR-FORMAT
 12625                                 THRU 9900-EXIT
 12626        END-IF
 12627     END-IF
 12628
 12629     IF WS-LF-EARNINGS-CALC NOT = '4'
 12630        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12631           MOVE ER-2681          TO WS-ERROR
 12632           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12633
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 232
* EL050.cbl
 12634     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12635        (PB-I-LF-TERM NOT = ZERO) AND
 12636         NOT NO-LIFE-COVERAGE
 12637          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12638          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12639          IF WS-LF-EARNINGS-CALC = '4'
 12640             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12641             PB-I-PAY-FREQUENCY
 12642          END-IF
 12643          MOVE ZERO              TO DC-ELAPSED-DAYS
 12644                                    DC-ODD-DAYS-OVER
 12645          MOVE 1                 TO DC-END-OF-MONTH
 12646          SET BIN-PLUS-ELAPSED        TO TRUE
 12647*         MOVE 6                 TO DC-OPTION-CODE
 12648          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12649          IF NO-CONVERSION-ERROR
 12650             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12651             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12652                (WS-LF-SPECIAL-CALC-CD = 'L')
 12653                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12654                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12655                  MOVE +1             TO DC-ELAPSED-MONTHS
 12656                  SET BIN-PLUS-ELAPSED  TO TRUE
 12657*                 MOVE 6              TO DC-OPTION-CODE
 12658                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12659                  IF NO-CONVERSION-ERROR
 12660                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12661
 12662* okay, i had to move the new att age edit down here because the
 12663* expiration date could get recalculated and i need the exp date
 12664     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12665        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12666        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12667        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12668           AND ZEROS
 12669           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12670           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12671           SET ELAPSED-BETWEEN-BIN TO TRUE
 12672           PERFORM 8500-DATE-CONVERT
 12673                                 THRU 8500-EXIT
 12674           IF NO-CONVERSION-ERROR
 12675              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12676                 MOVE ER-2669       TO WS-ERROR
 12677*                PERFORM 9900-ERROR-FORMAT
 12678*                                THRU 9900-EXIT
 12679              END-IF
 12680           END-IF
 12681        ELSE
 12682           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12683           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12684              MOVE ER-2669       TO WS-ERROR
 12685*             PERFORM 9900-ERROR-FORMAT
 12686*                                THRU 9900-EXIT
 12687           ELSE
 12688              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12689                 MOVE ER-1570    TO WS-ERROR
 12690                 PERFORM 9900-ERROR-FORMAT
 12691                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 233
* EL050.cbl
 12692              END-IF
 12693           END-IF
 12694        END-IF
 12695        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12696           AND ZEROS
 12697           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12698           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12699           SET ELAPSED-BETWEEN-BIN TO TRUE
 12700           PERFORM 8500-DATE-CONVERT
 12701                                 THRU 8500-EXIT
 12702           IF NO-CONVERSION-ERROR
 12703              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12704                 MOVE ER-2669       TO WS-ERROR
 12705*                PERFORM 9900-ERROR-FORMAT
 12706*                                THRU 9900-EXIT
 12707              END-IF
 12708           END-IF
 12709        ELSE
 12710           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12711             (PB-I-LF-TERM / 12)
 12712           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12713              MOVE ER-2669       TO WS-ERROR
 12714*             PERFORM 9900-ERROR-FORMAT
 12715*                                THRU 9900-EXIT
 12716           ELSE
 12717              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12718                 MOVE ER-1571    TO WS-ERROR
 12719                 PERFORM 9900-ERROR-FORMAT
 12720                                 THRU 9900-EXIT
 12721              END-IF
 12722           END-IF
 12723        END-IF
 12724        IF WS-ERROR = ER-2669
 12725           PERFORM 9900-ERROR-FORMAT
 12726                                 THRU 9900-EXIT
 12727        END-IF
 12728     END-IF
 12729     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12730        (PB-I-AH-TERM NOT = ZERO) AND
 12731         NOT NO-AH-COVERAGE
 12732          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12733             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12734             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12735             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12736          ELSE
 12737             IF WS-LF-EARNINGS-CALC = '4'
 12738                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12739                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12740                PB-I-PAY-FREQUENCY
 12741             ELSE
 12742                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12743                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12744             END-IF
 12745          END-IF
 12746          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12747                                         DC-ODD-DAYS-OVER
 12748          MOVE 1                      TO DC-END-OF-MONTH
 12749          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 234
* EL050.cbl
 12750*         MOVE 6                      TO DC-OPTION-CODE
 12751          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12752          IF NO-CONVERSION-ERROR
 12753             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12754     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12755        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12756        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12757        IF PB-I-BIRTHDAY > LOW-VALUES
 12758           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12759           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12760           SET ELAPSED-BETWEEN-BIN TO TRUE
 12761           PERFORM 8500-DATE-CONVERT
 12762                                 THRU 8500-EXIT
 12763           IF NO-CONVERSION-ERROR
 12764              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12765                 MOVE ER-3054       TO WS-ERROR
 12766*                PERFORM 9900-ERROR-FORMAT
 12767*                                THRU 9900-EXIT
 12768              END-IF
 12769           END-IF
 12770        ELSE
 12771           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12772           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12773              MOVE ER-3054       TO WS-ERROR
 12774*             PERFORM 9900-ERROR-FORMAT
 12775*                                THRU 9900-EXIT
 12776           END-IF
 12777        END-IF
 12778        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12779           AND ZEROS
 12780           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12781           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12782           SET ELAPSED-BETWEEN-BIN TO TRUE
 12783           PERFORM 8500-DATE-CONVERT
 12784                                 THRU 8500-EXIT
 12785           IF NO-CONVERSION-ERROR
 12786              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12787                 MOVE ER-3054       TO WS-ERROR
 12788*                PERFORM 9900-ERROR-FORMAT
 12789*                                THRU 9900-EXIT
 12790              END-IF
 12791           END-IF
 12792        ELSE
 12793           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12794             (PB-I-AH-TERM / 12)
 12795           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12796              MOVE ER-3054       TO WS-ERROR
 12797*             PERFORM 9900-ERROR-FORMAT
 12798*                                THRU 9900-EXIT
 12799           END-IF
 12800        END-IF
 12801        IF WS-ERROR = ER-3054
 12802           PERFORM 9900-ERROR-FORMAT
 12803                                 THRU 9900-EXIT
 12804        END-IF
 12805     END-IF
 12806     MOVE SPACE                       TO DC-END-OF-MONTH.
 12807
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 235
* EL050.cbl
 12808     IF PB-COMPANY-ID = 'NCB'
 12809        GO TO 3040-EDIT-EXTENSION-DAYS.
 12810
 12811     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12812       AND
 12813        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12814        NEXT SENTENCE
 12815     ELSE
 12816        GO TO 3040-EDIT-EXTENSION-DAYS.
 12817
 12818     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12819        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12820        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12821     ELSE
 12822        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12823        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12824
 12825     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12826*    MOVE '1'      TO DC-OPTION-CODE
 12827     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12828     IF (NO-CONVERSION-ERROR)
 12829        AND (DC-ELAPSED-MONTHS > +1)
 12830        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12831        MOVE ER-2668   TO WS-ERROR
 12832        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12833
 12834 3040-EDIT-EXTENSION-DAYS.
 12835
 12836     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12837        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12838         GO TO 3050-EDIT-TERM-IN-DAYS
 12839     ELSE
 12840         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12841
 12842     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12843         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12844     ELSE
 12845        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12846           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12847           MOVE ER-2681         TO WS-ERROR
 12848           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12849
 12850     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12851        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12852        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12853         GO TO 3060-ORIG-TERM-CHECK.
 12854
 12855     GO TO 3060-ORIG-TERM-CHECK.
 12856
 12857 3050-EDIT-TERM-IN-DAYS.
 12858
 12859     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12860
 12861     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12862         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12863     ELSE
 12864         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12865            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 236
* EL050.cbl
 12866            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12867
 12868     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12869                                       REMAINDER WS-WORK-TERM.
 12870     IF WS-WORK-TERM GREATER THAN ZERO
 12871         ADD +1 TO PB-I-LF-TERM.
 12872
 12873     IF NOT NO-AH-COVERAGE
 12874         MOVE ER-2684            TO WS-ERROR
 12875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12876
 12877
 12878 3060-ORIG-TERM-CHECK.
 12879
 12880******************************************************************
 12881*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12882******************************************************************
 12883
 12884     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12885        NEXT SENTENCE
 12886     ELSE
 12887        IF NOT NO-LIFE-COVERAGE
 12888           IF PB-I-LF-TERM NUMERIC
 12889              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12890              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12891              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12892                  NEXT SENTENCE
 12893           ELSE
 12894              MOVE ER-2647       TO WS-ERROR
 12895              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12896
 12897     IF NOT NO-AH-COVERAGE
 12898         IF PB-I-AH-TERM NUMERIC
 12899            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12900            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12901            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12902             NEXT SENTENCE
 12903          ELSE
 12904              MOVE ER-2658       TO WS-ERROR
 12905              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12906
 12907     IF PB-COMPANY-ID = 'NCB'
 12908        GO TO 3070-LOAN-TERM-CHECK.
 12909
 12910     IF POLICY-HAS-AH
 12911       AND
 12912        POLICY-HAS-LIFE
 12913       AND
 12914        PB-I-LF-TERM NUMERIC
 12915       AND
 12916        PB-I-AH-TERM NUMERIC
 12917        NEXT SENTENCE
 12918     ELSE
 12919        GO TO 3070-LOAN-TERM-CHECK.
 12920
 12921     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12922     IF WS-TEX-FACT-2 LESS THAN +0
 12923        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 237
* EL050.cbl
 12924
 12925     IF WS-TEX-FACT-2 GREATER THAN +1
 12926        MOVE ER-2668             TO WS-ERROR
 12927        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12928
 12929 3070-LOAN-TERM-CHECK.
 12930
 12931     IF (WS-LF-BENEFIT-CD = ZERO)
 12932         OR (NO-LF-BENEFIT-MATCH)
 12933            GO TO 3125-EDIT-PMT-FREQ.
 12934*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12935*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12936*          AND 'V' AND 'W' AND 'X'
 12937*          GO TO 3125-EDIT-PMT-FREQ
 12938*       END-IF
 12939*    ELSE
 12940*       IF WS-AH-DCC-TRUNC = 'T'
 12941*          CONTINUE
 12942*       ELSE
 12943*          GO TO 3125-EDIT-PMT-FREQ
 12944*       END-IF
 12945*    END-IF
 12946     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12947                    OR
 12948        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12949        AND (WS-AH-DCC-TRUNC = 'T'))
 12950        CONTINUE
 12951     ELSE
 12952        GO TO 3125-EDIT-PMT-FREQ
 12953     END-IF
 12954     IF PB-I-LOAN-TERM NOT NUMERIC
 12955         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12956
 12957     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12958        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12959*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12960        PB-I-LOAN-TERM NOT GREATER THAN +360
 12961         NEXT SENTENCE
 12962     ELSE
 12963         MOVE ER-2648            TO WS-ERROR
 12964         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12965
 12966     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12967        MOVE ER-3058             TO WS-ERROR
 12968        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12969     end-if
 12970
 12971     IF WS-STATE-ABBREVIATION = 'NC'
 12972        IF PB-I-LOAN-TERM > +59
 12973           CONTINUE
 12974        ELSE
 12975           MOVE ER-2792          TO WS-ERROR
 12976           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12977        END-IF
 12978     END-IF
 12979
 12980     .
 12981 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 238
* EL050.cbl
 12982     IF (WS-LF-BENEFIT-CD = ZERO)
 12983         OR (NO-LF-BENEFIT-MATCH)
 12984            GO TO 3127-EDIT-LOAN-OFFICER.
 12985     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12986                    OR
 12987        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12988        AND (WS-AH-DCC-TRUNC = 'T'))
 12989                    OR
 12990         (PB-COMPANY-ID = 'AHL')
 12991        CONTINUE
 12992     ELSE
 12993        IF (PB-I-LOAN-TERM > ZEROS)
 12994           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12995           MOVE ER-1575          TO WS-ERROR
 12996           PERFORM 9900-ERROR-FORMAT
 12997                                 THRU 9900-EXIT
 12998        END-IF
 12999     END-IF
 13000     IF WS-LF-EARNINGS-CALC NOT = '4'
 13001         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13002            MOVE ER-2653         TO WS-ERROR
 13003            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13004            GO TO 3127-EDIT-LOAN-OFFICER
 13005         ELSE
 13006            GO TO 3127-EDIT-LOAN-OFFICER.
 13007
 13008     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13009         MOVE ER-2655            TO WS-ERROR
 13010         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13011         GO TO 3127-EDIT-LOAN-OFFICER.
 13012
 13013     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13014         MOVE ER-2654            TO WS-ERROR
 13015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13016         GO TO 3127-EDIT-LOAN-OFFICER.
 13017
 13018     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13019         GIVING WS-TEX-FACT-2
 13020             REMAINDER WS-TEX-FACT-3.
 13021
 13022*    IF WS-TEX-FACT-3 NOT = ZERO
 13023*       MOVE ER-2654             TO WS-ERROR
 13024*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13025
 13026
 13027 3127-EDIT-LOAN-OFFICER.
 13028
 13029     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13030        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13031           MOVE ER-2690          TO WS-ERROR
 13032           PERFORM 9900-ERROR-FORMAT
 13033                                 THRU 9900-EXIT
 13034        ELSE
 13035           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13036           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13037           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13038           MOVE PB-SV-STATE      TO LOFC-STATE
 13039           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 239
* EL050.cbl
 13040           MOVE PB-I-LOAN-OFFICER
 13041                                 TO LOFC-CODE
 13042           PERFORM 8586-READ-LOAN-OFFICER
 13043                                 THRU 8586-EXIT
 13044           IF (NOT LOFC-MASTER-FOUND)
 13045              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13046              MOVE ER-3006       TO WS-ERROR
 13047              PERFORM 9900-ERROR-FORMAT
 13048                                 THRU 9900-EXIT
 13049           END-IF
 13050        END-IF
 13051     END-IF
 13052     .
 13053 3129-EDIT-APR.
 13054
 13055     IF (WS-LF-BENEFIT-CD = ZERO)
 13056        OR (NO-LF-BENEFIT-MATCH)
 13057        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13058           GO TO 3130-EDIT-AGE
 13059*       ELSE
 13060*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13061*             GO TO 3130-EDIT-AGE
 13062*          END-IF
 13063        END-IF
 13064     END-IF
 13065
 13066     IF (WS-STATE-ABBREVIATION = 'OH')
 13067         AND (PB-I-RATE-CLASS NOT = 'L ')
 13068         AND (PB-I-LF-TERM GREATER THAN 60)
 13069         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13070         GO TO 3129-APR-CONT.
 13071
 13072     IF (WS-STATE-ABBREVIATION = 'RI')
 13073         AND (PB-I-LF-TERM GREATER THAN 60)
 13074         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13075         GO TO 3129-APR-CONT.
 13076
 13077     IF (WS-STATE-ABBREVIATION = 'UT')
 13078         AND (PB-I-LF-TERM GREATER THAN 62)
 13079         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13080         AND (PB-CERT-EFF-DT LESS WS-830901)
 13081         GO TO 3129-APR-CONT.
 13082
 13083     IF PB-COMPANY-ID = 'LAP'
 13084        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13085           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13086              MOVE ER-2656         TO WS-ERROR
 13087              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13088              GO TO 3130-EDIT-AGE.
 13089
 13090     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13091        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13092        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13093        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13094        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13095        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13096         GO TO 3130-EDIT-AGE.
 13097
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 240
* EL050.cbl
 13098 3129-APR-CONT.
 13099     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13100         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13101         GO TO 3130-EDIT-AGE.
 13102
 13103     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13104         WS-AH-BENEFIT-CD (1:1) = 'S')
 13105        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13106        AND (PB-I-LOAN-APR = ZERO)
 13107        MOVE ER-2657             TO WS-ERROR
 13108        PERFORM 9900-ERROR-FORMAT
 13109                                 THRU 9900-EXIT
 13110        GO TO 3130-EDIT-AGE
 13111     END-IF
 13112*    IF PB-I-LOAN-APR = ZERO
 13113*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13114*    END-IF
 13115
 13116     if pb-i-loan-apr = +99.9999
 13117        move er-2656             to ws-error
 13118        PERFORM 9900-ERROR-FORMAT
 13119                                 THRU 9900-EXIT
 13120        GO TO 3130-EDIT-AGE
 13121     end-if
 13122*    IF PB-I-LOAN-APR = ZERO
 13123*       MOVE ER-2656             TO WS-ERROR
 13124*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13125*       GO TO 3130-EDIT-AGE.
 13126
 13127*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13128     if pb-i-loan-apr not = +99.9999
 13129        IF PB-I-LOAN-APR > +30.000
 13130           MOVE ER-2657          TO WS-ERROR
 13131           PERFORM 9900-ERROR-FORMAT
 13132                                 THRU 9900-EXIT
 13133        end-if
 13134     end-if
 13135     .
 13136 3130-EDIT-AGE.
 13137
 13138******************************************************************
 13139*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13140******************************************************************
 13141
 13142     IF NOT NO-LIFE-COVERAGE
 13143        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13144           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13145               MOVE ER-2628             TO WS-ERROR
 13146               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13147
 13148     IF NOT NO-AH-COVERAGE
 13149        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13150           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13151               MOVE ER-2628         TO WS-ERROR
 13152               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13153
 13154 3133-SEX-CODE.
 13155     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 241
* EL050.cbl
 13156         IF WS-DEFAULT-SEX = 'M'
 13157             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13158          ELSE
 13159             IF WS-DEFAULT-SEX = 'F'
 13160             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13161
 13162     IF PB-I-INSURED-SEX = '1'
 13163         MOVE 'M' TO PB-I-INSURED-SEX.
 13164
 13165     IF PB-I-INSURED-SEX = '2'
 13166         MOVE 'F' TO PB-I-INSURED-SEX.
 13167
 13168 3134-SIG-SW-EDIT.
 13169     IF PB-I-SIG-SW = SPACE
 13170         MOVE 'N'                TO  PB-I-SIG-SW.
 13171
 13172     IF PB-COMPANY-ID = 'NCL'
 13173         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13174             NEXT SENTENCE
 13175         ELSE
 13176             MOVE ER-1923        TO  WS-ERROR
 13177             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13178     ELSE
 13179     IF PB-COMPANY-ID = 'CRI'
 13180         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13181             NEXT SENTENCE
 13182         ELSE
 13183             MOVE ER-2606        TO  WS-ERROR
 13184             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13185     ELSE
 13186     IF PB-COMPANY-ID = 'TMS'
 13187         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13188             NEXT SENTENCE
 13189         ELSE
 13190             MOVE ER-2689        TO  WS-ERROR
 13191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13192     ELSE
 13193         IF PB-I-SIG-SW = 'Y' OR 'N'
 13194             NEXT SENTENCE
 13195         ELSE
 13196             MOVE ER-2651        TO  WS-ERROR
 13197             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13198
 13199     IF PB-COMPANY-ID = 'FLA'
 13200         IF (WS-EDIT-AGE GREATER 54  OR
 13201             WS-AH-EDIT-AGE GREATER 54)  AND
 13202            PB-I-SIG-SW = 'N'
 13203            MOVE ER-2651         TO  WS-ERROR
 13204            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13205
 13206 3135-NAME-EDIT.
 13207
 13208     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13209        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13210        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13211           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13212                                 TO PB-I-JOINT-FIRST-NAME
 13213        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 242
* EL050.cbl
 13214     END-IF
 13215     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13216        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13217        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13218           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13219                                 TO PB-I-JOINT-LAST-NAME
 13220        END-PERFORM
 13221     END-IF
 13222     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13223        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13224        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13225           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13226                                 TO PB-I-INSURED-FIRST-NAME
 13227        END-PERFORM
 13228     END-IF
 13229     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13230        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13231        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13232           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13233                                 TO PB-I-INSURED-LAST-NAME
 13234        END-PERFORM
 13235     END-IF
 13236     IF PB-I-INSURED-LAST-NAME = SPACES
 13237       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13238       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13239           MOVE ER-2660    TO WS-ERROR
 13240           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13241
 13242 3136-EDIT-SEX.
 13243
 13244******************************************************************
 13245*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13246******************************************************************
 13247
 13248     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13249        (WS-AH-SPECIAL-CALC-CD = 'O')
 13250        NEXT SENTENCE
 13251     ELSE
 13252        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13253           NEXT SENTENCE
 13254        ELSE
 13255           MOVE ER-2629            TO WS-ERROR
 13256           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13257
 13258 3137-EDIT-EFF-DATE.
 13259
 13260     IF PB-REISSUED-CERT       OR
 13261        PB-POLICY-IS-DECLINED  OR
 13262        PB-POLICY-IS-VOIDED
 13263         GO TO 3139-EDIT-COVERAGE-CODES.
 13264
 13265     MOVE SPACE                  TO WS-2671-SW
 13266                                    WS-2672-SW.
 13267
 13268     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13269         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13270             MOVE ER-2703        TO WS-ERROR
 13271             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 243
* EL050.cbl
 13272             GO TO 3139-EDIT-COVERAGE-CODES.
 13273
 13274     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13275         GO TO 3139-EDIT-COVERAGE-CODES.
 13276
 13277     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13278     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13279*    MOVE '1'                    TO DC-OPTION-CODE.
 13280     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13281     MOVE +0                     TO DC-ELAPSED-MONTHS
 13282                                    DC-ELAPSED-DAYS.
 13283     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13284
 13285     IF DATE-CONVERSION-ERROR
 13286         GO TO 3139-EDIT-COVERAGE-CODES.
 13287
 13288     IF DC-ELAPSED-DAYS GREATER +180
 13289         MOVE ER-2672            TO WS-ERROR
 13290         MOVE 'Y'                TO WS-2672-SW
 13291         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13292     END-IF
 13293
 13294     IF WS-ERROR = ER-2671  AND
 13295        PB-COMPANY-ID  = 'LBL'
 13296        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13297        MOVE SPACE               TO WS-2671-SW
 13298        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13299
 13300     IF PB-ISSUE-DATE-FORCED  AND
 13301      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13302         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13303         MOVE ER-2673            TO WS-ERROR
 13304         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13305         MOVE SPACE              TO WS-2671-SW
 13306                                    WS-2672-SW.
 13307
 13308     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13309         IF PB-ISSUE-DATE-FORCED
 13310             MOVE ER-2600          TO  WS-ERROR
 13311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13312         ELSE
 13313             MOVE ER-2692          TO  WS-ERROR
 13314             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13315
 13316
 13317 3139-EDIT-COVERAGE-CODES.
 13318
 13319     if pb-company-id not = 'AHL'
 13320        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13321           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13322           MOVE ER-2787          TO WS-ERROR
 13323           PERFORM 9900-ERROR-FORMAT
 13324                                 THRU 9900-EXIT
 13325        END-IF
 13326     end-if
 13327     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13328        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13329                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 244
* EL050.cbl
 13330           MOVE ER-2719          TO WS-ERROR
 13331           PERFORM 9900-ERROR-FORMAT
 13332                                 THRU 9900-EXIT
 13333        END-IF
 13334     END-IF
 13335
 13336     IF PB-POLICY-IS-DECLINED  OR
 13337        PB-POLICY-IS-VOIDED
 13338         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13339
 13340     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13341        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13342         MOVE ER-2630                TO WS-ERROR
 13343         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13344
 13345     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13346        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13347        PB-I-LF-PREMIUM-AMT = ZERO
 13348         GO TO 3140-CHECK-AH-FOR-ZERO.
 13349
 13350     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13351        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13352        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13353         GO TO 3140-CHECK-AH-FOR-ZERO.
 13354
 13355     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13356        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13357        MOVE ER-2631             TO WS-ERROR
 13358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13359     END-IF
 13360
 13361
 13362******************************************************************
 13363*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13364******************************************************************
 13365
 13366     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13367        NEXT SENTENCE
 13368     ELSE
 13369        IF PB-I-LF-BENEFIT-AMT = ZERO
 13370           MOVE ER-2632             TO WS-ERROR
 13371           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13372
 13373
 13374******************************************************************
 13375*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13376******************************************************************
 13377
 13378     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13379        CONTINUE
 13380     ELSE
 13381        IF PB-I-LF-PREMIUM-AMT = ZERO
 13382           IF (NOT PB-COMP-LF-PREM)
 13383              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13384              and (ws-lf-ben-category not = 'C')
 13385              MOVE ER-2633       TO WS-ERROR
 13386              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13387           END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 245
* EL050.cbl
 13388        END-IF
 13389     END-IF
 13390     .
 13391 3140-CHECK-AH-FOR-ZERO.
 13392
 13393     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13394        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13395        PB-I-AH-PREMIUM-AMT = ZERO
 13396         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13397
 13398     IF PB-COMPANY-ID = 'CSL'  AND
 13399        PB-I-AH-BENEFIT-CD = ZERO  AND
 13400        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13401        PB-I-AH-PREMIUM-AMT = ZERO
 13402         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13403
 13404     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13405        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13406        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13407         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13408
 13409     IF PB-I-AH-BENEFIT-CD = ZERO
 13410         MOVE ER-2634            TO WS-ERROR
 13411         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13412
 13413******************************************************************
 13414*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13415******************************************************************
 13416
 13417     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13418        NEXT SENTENCE
 13419     ELSE
 13420        IF PB-I-AH-BENEFIT-AMT = ZERO
 13421           MOVE ER-2635             TO WS-ERROR
 13422           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13423
 13424******************************************************************
 13425*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13426******************************************************************
 13427
 13428     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13429        NEXT SENTENCE
 13430     ELSE
 13431        IF PB-I-AH-PREMIUM-AMT = ZERO
 13432            IF NOT PB-COMP-AH-PREM
 13433                MOVE ER-2636    TO WS-ERROR
 13434                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13435
 13436
 13437 3140-EDIT-MAX-AMT-SIZES.
 13438* CUSTOM CODE FOR CLIENT    'DMD'
 13439     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13440                                     WS-RES-MUNI-TAX
 13441                                     PB-I-STATE-TAX
 13442                                     PB-I-MUNI-TAX.
 13443
 13444     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13445
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 246
* EL050.cbl
 13446     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13447        GO TO 3150-RATE-OUTSTAND-BAL.
 13448
 13449     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13450        GO TO 3150-RATE-OUTSTAND-BAL.
 13451
 13452     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13453        GO TO 3150-RATE-OUTSTAND-BAL.
 13454
 13455     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13456                             OR 'RIC')
 13457        GO TO 3150-RATE-OUTSTAND-BAL.
 13458
 13459     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13460        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13461            GO TO 3150-RATE-OUTSTAND-BAL
 13462        ELSE
 13463           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13464               GO TO 3150-RATE-OUTSTAND-BAL.
 13465
 13466     IF NOT PB-NO-MONTHS-SKIPPED
 13467        GO TO 3150-RATE-OUTSTAND-BAL.
 13468
 13469     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13470        GO TO 3150-RATE-OUTSTAND-BAL.
 13471
 13472     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13473        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13474           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13475             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13476           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13477           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13478              MOVE ER-2693     TO WS-ERROR
 13479              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13480              GO TO 3150-RATE-OUTSTAND-BAL
 13481           ELSE
 13482              GO TO 3150-RATE-OUTSTAND-BAL.
 13483
 13484 3150-RATE-OUTSTAND-BAL.
 13485
 13486* DMD RATING TEST
 13487     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13488         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13489         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13490         MOVE ER-2687                 TO WS-ERROR
 13491         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13492         MOVE 'B'                     TO PB-I-OB-FLAG
 13493         GO TO 3260-EDIT-CONTINUE.
 13494
 13495     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13496         IF  WS-ERROR    EQUAL    ER-2693
 13497             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13498                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13499                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13500                 MOVE  +0            TO  WS-ERROR.
 13501
 13502     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13503         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 247
* EL050.cbl
 13504             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13505                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13506                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13507                 MOVE  +0            TO  WS-ERROR.
 13508
 13509     IF PLAN-MASTER-AH-SW = 'Y'
 13510        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13511            IF  WS-ERROR    EQUAL    ER-2693
 13512              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13513                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13514                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13515                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13516                 MOVE  ER-1910           TO  WS-ERROR
 13517                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13518
 13519     IF PLAN-MASTER-AH-SW = 'Y'
 13520        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13521            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13522               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13523               MOVE  ER-1910           TO  WS-ERROR
 13524               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13525
 13526     IF PLAN-MASTER-AH-SW = 'Y'
 13527        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13528            IF  WS-ERROR    EQUAL    ER-2693
 13529                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13530                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13531                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13532                 MOVE  +0       TO  WS-ERROR.
 13533
 13534     IF WS-ERROR = ER-2693
 13535        IF PB-COMPANY-ID = 'JAL' AND
 13536           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13537           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13538           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13539
 13540     IF WS-ERROR = ER-2693
 13541        IF PB-COMPANY-ID = 'NCL'  AND
 13542           PB-I-AH-BENEFIT-CD = 'OA'
 13543           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13544           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13545
 13546     IF WS-ERROR = ER-2693
 13547        IF PB-COMPANY-ID = 'CNL' AND
 13548           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13549           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13550           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13551
 13552     IF WS-ERROR = ER-2693
 13553        IF PB-COMPANY-ID = 'HER'
 13554           IF WS-LEVEL
 13555              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13556              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13557
 13558     IF ((LF-BENEFIT-FOUND) AND
 13559         (NOT NO-LIFE-COVERAGE)  AND
 13560         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13561       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 248
* EL050.cbl
 13562             (NOT NO-AH-COVERAGE)    AND
 13563             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13564         NEXT SENTENCE
 13565     ELSE
 13566         GO TO 3215-EDIT-RATES.
 13567
 13568     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13569        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13570           MOVE ER-2674          TO WS-ERROR
 13571           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13572           GO TO 3215-EDIT-RATES.
 13573
 13574     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13575        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13576           MOVE ER-2674          TO WS-ERROR
 13577           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13578           GO TO 3215-EDIT-RATES.
 13579
 13580     MOVE 'B'                    TO PB-I-OB-FLAG.
 13581
 13582     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13583         NEXT SENTENCE
 13584     ELSE
 13585         IF NOT NO-LIFE-COVERAGE
 13586             IF WS-ACCT-LF-OB-RT = ZERO
 13587                MOVE ER-2641    TO WS-ERROR
 13588                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13589
 13590     IF PB-COMPANY-ID = 'CRI'
 13591       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13592         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13593         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13594         IF WS-ERROR = ER-2675
 13595            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13596            MOVE ER-2687              TO WS-ERROR
 13597            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13598         ELSE
 13599            MOVE ER-2687              TO WS-ERROR
 13600            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13601
 13602
 13603     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13604         NEXT SENTENCE
 13605     ELSE
 13606       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13607            NEXT SENTENCE
 13608       ELSE
 13609         IF NOT NO-AH-COVERAGE
 13610             IF WS-ACCT-AH-OB-RT = ZERO
 13611                MOVE ER-2642    TO WS-ERROR
 13612                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13613
 13614     IF PB-COMPANY-ID = 'CRI'
 13615       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13616         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13617         IF WS-ERROR = ER-2676
 13618            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13619            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 249
* EL050.cbl
 13620            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13621         ELSE
 13622            MOVE ER-2687              TO WS-ERROR
 13623            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13624
 13625     IF PB-COMPANY-ID NOT = 'GIC'
 13626         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13627            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13628     ELSE
 13629         IF PB-I-LF-PREM-CALC = ZEROS
 13630             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13631                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13632
 13633     IF PB-COMPANY-ID NOT = 'GIC'
 13634         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13635            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13636     ELSE
 13637         IF PB-I-AH-PREM-CALC = ZEROS
 13638             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13639                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13640
 13641     MOVE ZEROS TO PB-I-MORT-CODE.
 13642
 13643     GO TO 3260-EDIT-CONTINUE.
 13644
 13645
 13646 3215-EDIT-RATES.
 13647     IF ACCOUNT-MAST-FOUND
 13648         NEXT SENTENCE
 13649     ELSE
 13650         GO TO 3999-END-EDIT.
 13651
 13652 3220-CHECK-LF-RATES.
 13653
 13654     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13655        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13656        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13657        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13658           AND (NOT WS-LF-CASH))
 13659                           OR
 13660           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13661           AND (NOT WS-AH-CASH)))
 13662                       AND
 13663           (PB-I-ENTRY-STATUS NOT = '5')
 13664           MOVE 'M'              TO PB-BATCH-ENTRY
 13665                                    PB-I-ENTRY-STATUS
 13666        END-IF
 13667     END-IF
 13668     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13669                                    PB-I-AH-PREM-CALC
 13670                                    PB-I-LF-ALT-PREM-CALC
 13671                                    PB-I-LF-ALT-RATE
 13672                                    PB-I-LF-REI-RATE
 13673                                    PB-I-LF-ALT-REI-RATE
 13674                                    PB-I-AH-REI-RATE
 13675                                    PB-I-TOT-FEES-CALC.
 13676
 13677     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 250
* EL050.cbl
 13678        NEXT SENTENCE
 13679     ELSE
 13680        MOVE ZEROS               TO PB-I-LF-RATE
 13681                                    PB-I-AH-RATE.
 13682
 13683     IF PB-I-TOT-FEES NOT NUMERIC
 13684        MOVE ZEROS               TO PB-I-TOT-FEES
 13685     END-IF
 13686     IF PB-I-LIVES NOT NUMERIC
 13687         MOVE ZERO               TO PB-I-LIVES.
 13688
 13689     IF PB-I-NUM-BILLED NOT NUMERIC
 13690         MOVE ZERO               TO PB-I-NUM-BILLED.
 13691
 13692     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13693        MOVE +0                  TO PB-I-LF-PREM-TAX
 13694     END-IF
 13695
 13696     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13697        MOVE +0                  TO PB-I-AH-PREM-TAX
 13698     END-IF
 13699
 13700     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13701        PB-I-PAY-FREQUENCY = ZEROS
 13702            MOVE 12 TO CP-PAY-FREQUENCY
 13703     ELSE
 13704            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13705
 13706     IF PB-I-STATE-TAX NOT NUMERIC
 13707         MOVE ZEROS               TO PB-I-STATE-TAX.
 13708
 13709     IF PB-I-MUNI-TAX NOT NUMERIC
 13710         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13711
 13712     MOVE SPACES                 TO CP-BEN-CATEGORY
 13713     IF PB-COMPANY-ID  = 'CSL'  AND
 13714        PB-I-LF-TERM NOT = ZERO
 13715        COMPUTE WS-PAYMENT-AMT =
 13716             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13717        COMPUTE WS-CSL-AMT1 =
 13718             PB-I-LF-TERM * AM-MAX-MON-BEN
 13719        COMPUTE WS-CSL-AMT2 =
 13720             WS-PAYMENT-AMT * PB-I-LF-TERM
 13721        IF CP-PAY-FREQUENCY NOT = 12
 13722           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13723           MOVE '8' TO WS-CSL-CALC-CD
 13724        ELSE
 13725           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13726              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13727               AM-MAX-TOT-BEN
 13728               MOVE '6' TO WS-CSL-CALC-CD
 13729           ELSE
 13730              IF (WS-CSL-AMT1  GREATER THAN
 13731                 AM-MAX-TOT-BEN) AND
 13732                 (WS-CSL-AMT2  GREATER THAN
 13733                 AM-MAX-TOT-BEN)
 13734                 MOVE '7' TO WS-CSL-CALC-CD
 13735              ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 251
* EL050.cbl
 13736                 MOVE '5' TO WS-CSL-CALC-CD.
 13737
 13738     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13739         NEXT SENTENCE
 13740     ELSE
 13741         GO TO 3300-CHECK-AH-RATES.
 13742
 13743*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13744
 13745     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13746        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13747              OR
 13748           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13749           MOVE ER-2618          TO WS-ERROR
 13750           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13751           GO TO 3300-CHECK-AH-RATES.
 13752
 13753     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13754           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13755                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13756
 13757     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13758         MOVE ER-2687             TO WS-ERROR
 13759         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13760         MOVE 'Z000'              TO PB-I-MORT-CODE
 13761         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13762         GO TO 3300-CHECK-AH-RATES.
 13763
 13764     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13765        IF PB-I-LIVES = ZERO
 13766           MOVE ER-2688          TO WS-ERROR
 13767           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13768
 13769     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13770
 13771     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13772     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13773     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13774     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13775     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13776     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13777     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13778     MOVE '3'                    TO CP-PROCESS-TYPE.
 13779     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13780     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13781
 13782******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13783     IF PB-COMPANY-ID EQUAL 'CDL'
 13784         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13785            CP-EARN-AS-NET-PAY)
 13786             IF PB-CERT-EFF-DT GREATER  WS-931231
 13787                 MOVE '1'        TO CP-EARNING-METHOD.
 13788*******
 13789
 13790     MOVE PB-SV-STATE            TO CP-STATE.
 13791     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13792     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13793     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 252
* EL050.cbl
 13794     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13795     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13796                                    CP-RATING-BENEFIT-AMT.
 13797     IF CP-STATE-STD-ABBRV = 'OR'
 13798         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13799                                         PB-I-LF-ALT-BENEFIT-AMT.
 13800     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13801     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13802     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13803     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13804     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13805     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13806     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13807     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13808     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13809                                    CP-REMAINING-TERM
 13810                                    CP-LOAN-TERM.
 13811
 13812     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13813         NEXT SENTENCE
 13814     ELSE
 13815         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13816             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13817                                           PB-I-LF-PREMIUM-AMT.
 13818
 13819     IF PB-COMPANY-ID EQUAL 'CSL'
 13820        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13821           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13822                                         PB-I-LF-PREMIUM-AMT.
 13823
 13824     IF PB-COMPANY-ID EQUAL 'NCB'
 13825         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13826            CP-EARN-AS-NET-PAY
 13827             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13828                 PB-I-LF-PREMIUM-AMT.
 13829
 13830     IF (CP-TRUNCATED-LIFE)
 13831        or ((pb-company-id = 'AHL')
 13832           and (pb-i-loan-term > pb-i-lf-term))
 13833        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13834
 13835     IF PB-COMPANY-ID EQUAL 'CRI'
 13836        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13837
 13838     IF CP-TERM-IS-DAYS
 13839         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13840     ELSE
 13841         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13842     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13843        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13844        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13845        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13846        IF WS-LF-BEN-CATEGORY = 'D'
 13847           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13848           MOVE PB-I-LIFE-COMMISSION
 13849                                 TO CP-DCC-ACT-COMM
 13850           MOVE WS-LF-BEN-CATEGORY
 13851                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 253
* EL050.cbl
 13852        END-IF
 13853        IF (CP-BENEFIT-CD (1:1) = 'P')
 13854           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13855           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13856           add pb-i-ah-premium-amt to cp-original-premium
 13857        END-IF
 13858     END-IF
 13859     IF PB-COMPANY-ID = 'CSL'
 13860         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13861         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13862         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13863
 13864     IF PB-COMPANY-ID = 'CSL'
 13865        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13866
 13867     IF (CP-SPECIAL-CALC-CD = 'H')
 13868        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13869         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13870                                    TO CP-ALTERNATE-BENEFIT
 13871         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13872     if (pb-company-id = 'CID')
 13873        and (ws-lf-earnings-calc = '4')
 13874        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13875        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13876        move pb-i-term-type      to cp-pmt-mode
 13877        move pb-i-no-of-payments to cp-no-of-pmts
 13878     end-if
 13879     move ws-net-only-state      to cp-net-only-state
 13880     IF (PB-COMPANY-ID = 'CID')
 13881        AND (WS-LF-EARNINGS-CALC = 'B')
 13882        AND (CP-STATE-STD-ABBRV = 'MN')
 13883        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13884                                 TO CP-ALTERNATE-BENEFIT
 13885        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13886     END-IF
 13887     IF (PB-COMPANY-ID = 'CID')
 13888        AND (WS-LF-EARNINGS-CALC = 'B')
 13889        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13890                                 TO CP-ALTERNATE-BENEFIT
 13891        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13892        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13893*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13894*         pb-i-lf-alt-premium-amt
 13895        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13896        IF WS-LF-BEN-CATEGORY = 'P'
 13897           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13898        ELSE
 13899           IF WS-LF-BEN-CATEGORY = 'I'
 13900              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13901           END-IF
 13902        END-IF
 13903     END-IF
 13904     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13905     MOVE 'R'                   TO CP-RATE-FILE.
 13906     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13907
 13908     IF CP-ERROR-RATE-NOT-FOUND
 13909        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 254
* EL050.cbl
 13910        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13911        GO TO 3300-CHECK-AH-RATES.
 13912
 13913     IF PB-COMPANY-ID EQUAL 'CRI'
 13914        IF CP-ERROR-NO-LIMITS-CRI
 13915           IF NOT ACCOUNT-LIFE-CHECKED
 13916              MOVE ER-2607      TO WS-ERROR
 13917              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13918
 13919******************************************************************
 13920*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13921*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13922******************************************************************
 13923
 13924* CALC LIFE AGE AT EXPIRATION.
 13925
 13926     COMPUTE WS-AGE-AT-EXPIRE =
 13927          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13928
 13929*    IF PB-STATE = 'CO' OR 'UT'
 13930*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13931*        MOVE 'F'            TO PB-FATAL-FLAG
 13932*        MOVE ER-2709        TO WS-ERROR
 13933*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13934*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13935
 13936*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13937*        MOVE 'X'            TO PB-FATAL-FLAG
 13938*        MOVE ER-2718        TO WS-ERROR
 13939*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13940*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13941
 13942* CALC A & H AGE AT EXPIRATION.
 13943
 13944     COMPUTE WS-AGE-AT-EXPIRE =
 13945          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13946
 13947*    IF PB-STATE = 'CO' OR 'UT'
 13948*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13949*        MOVE 'F'            TO PB-FATAL-FLAG
 13950*        MOVE ER-2709        TO WS-ERROR
 13951*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13952*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13953
 13954*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13955*        MOVE 'X'            TO PB-FATAL-FLAG
 13956*        MOVE ER-2718        TO WS-ERROR
 13957*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13958*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13959
 13960     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13961        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13962
 13963     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13964        and (not pb-monthly-cert)
 13965        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13966     end-if
 13967
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 255
* EL050.cbl
 13968     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13969        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13970
 13971     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13972         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13973         MOVE ER-2639        TO WS-ERROR
 13974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13975
 13976
 13977******************************************************************
 13978*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13979******************************************************************
 13980
 13981 PREMIUM-EDITING-IS-BYPASSED.
 13982     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13983        AND (CP-R-MAX-ATT-AGE > +0)
 13984        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13985        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13986           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13987           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13988           MOVE '1'              TO DC-OPTION-CODE
 13989           PERFORM 8500-DATE-CONVERT
 13990                                 THRU 8500-EXIT
 13991           IF NO-CONVERSION-ERROR
 13992              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13993                 MOVE ER-2661       TO WS-ERROR
 13994*                PERFORM 9900-ERROR-FORMAT
 13995*                                THRU 9900-EXIT
 13996              END-IF
 13997           END-IF
 13998        ELSE
 13999           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14000           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14001              MOVE ER-2661       TO WS-ERROR
 14002*             PERFORM 9900-ERROR-FORMAT
 14003*                                THRU 9900-EXIT
 14004           ELSE
 14005              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14006                 MOVE ER-1570    TO WS-ERROR
 14007                 PERFORM 9900-ERROR-FORMAT
 14008                                 THRU 9900-EXIT
 14009              END-IF
 14010           END-IF
 14011        END-IF
 14012        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14013           MOVE PB-I-JOINT-BIRTHDAY
 14014                                 TO DC-BIN-DATE-1
 14015           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14016           MOVE '1'              TO DC-OPTION-CODE
 14017           PERFORM 8500-DATE-CONVERT
 14018                                 THRU 8500-EXIT
 14019           IF NO-CONVERSION-ERROR
 14020              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14021                 MOVE ER-2661       TO WS-ERROR
 14022*                PERFORM 9900-ERROR-FORMAT
 14023*                                THRU 9900-EXIT
 14024              END-IF
 14025           ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 256
* EL050.cbl
 14026              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14027           END-IF
 14028        ELSE
 14029           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14030             (PB-I-LF-TERM / 12)
 14031           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14032              MOVE ER-2661       TO WS-ERROR
 14033*             PERFORM 9900-ERROR-FORMAT
 14034*                                THRU 9900-EXIT
 14035           ELSE
 14036              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14037                 MOVE ER-1571    TO WS-ERROR
 14038                 PERFORM 9900-ERROR-FORMAT
 14039                                 THRU 9900-EXIT
 14040              END-IF
 14041           END-IF
 14042        END-IF
 14043        IF WS-ERROR = ER-2661
 14044           PERFORM 9900-ERROR-FORMAT
 14045                                 THRU 9900-EXIT
 14046        END-IF
 14047     END-IF
 14048*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14049*       MOVE ER-2661             TO WS-ERROR
 14050*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14051
 14052     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14053        MOVE ER-2662             TO WS-ERROR
 14054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14055
 14056     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14057        MOVE ER-2677             TO WS-ERROR
 14058        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14059
 14060     IF CP-ERROR-LOAN-TERM
 14061        MOVE ER-2648             TO WS-ERROR
 14062        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14063
 14064 3221-CHECK-ERROR-RATE-OPEN.
 14065
 14066     IF CP-ERROR-RATE-FILE-NOTOPEN
 14067         GO TO 3990-FILES-NOT-OPEN.
 14068
 14069     IF PB-COMPANY-ID NOT = 'DMD'
 14070        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14071     END-IF
 14072     .
 14073 3221-CONTINUE.
 14074     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14075                                    WS-DCC-AH-RATE
 14076     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14077        IF WS-LF-BEN-CATEGORY = 'D'
 14078           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14079              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14080        END-IF
 14081     END-IF
 14082     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14083*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 257
* EL050.cbl
 14084     IF (PB-COMPANY-ID = 'CID')
 14085        AND (WS-LF-EARNINGS-CALC = 'B')
 14086        AND (CP-STATE-STD-ABBRV = 'MN')
 14087        AND (PB-CERT-EFF-DT > X'A4FF')
 14088        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14089     END-IF
 14090     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14091
 14092     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14093     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14094        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14095        AND (PB-I-POLICY-IS-MONTHLY)
 14096        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14097        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14098     END-IF
 14099     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14100     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14101     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14102     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14103     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14104        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14105        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14106        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14107        MOVE ER-2786             TO WS-ERROR
 14108        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14109     END-IF
 14110
 14111     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14112
 14113******************************************************************
 14114*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14115******************************************************************
 14116     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14117        and ((not pb-monthly-cert)
 14118        or (ws-lf-ben-category = 'C'))
 14119        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14120
 14121     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14122        GO TO 3225-CHECK-ALT-LIFE-RATE
 14123     ELSE
 14124       IF PB-I-LF-RATE = ZERO
 14125          MOVE ER-2641          TO WS-ERROR
 14126          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14127
 14128 3225-CHECK-ALT-LIFE-RATE.
 14129
 14130     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14131        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14132        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14133         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14134
 14135     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14136         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14137             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14138                   OR
 14139              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14140              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14141              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 258
* EL050.cbl
 14142             MOVE ER-2720        TO  WS-ERROR
 14143             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14144             GO TO 3225-RATING-CONT
 14145         ELSE
 14146             GO TO 3225-RATING-CONT.
 14147     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14148        AND (AM-GPCD = 01 OR 06 OR 15)
 14149        MOVE ER-2798             TO WS-ERROR
 14150        PERFORM 9900-ERROR-FORMAT
 14151                                 THRU 9900-EXIT
 14152*       GO TO 3225-RATING-CONT
 14153     END-IF
 14154     if (pb-company-id = 'CID')
 14155        and (ws-lf-earnings-calc = 'B')
 14156        and (ws-lf-ben-category = 'P' or 'I')
 14157        and (ws-net-only-state = 'Y')
 14158        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14159        display ' balloon prem ' pb-i-lf-alt-prem-calc
 14160        go to 3225-rating-cont
 14161     end-if
 14162     IF (PB-COMPANY-ID = 'CID')
 14163        AND (WS-LF-EARNINGS-CALC = 'B')
 14164        AND (CP-STATE-STD-ABBRV = 'MN')
 14165        AND (PB-CERT-EFF-DT > X'A4FF')
 14166        GO TO 3225-RATING-CONT
 14167     END-IF
 14168     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14169        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14170           AND (PB-I-POLICY-IS-MONTHLY)
 14171           GO TO 3225-RATING-CONT
 14172        END-IF
 14173     END-IF
 14174
 14175     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14176        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14177        CP-EARN-AS-REG-BALLOON
 14178        NEXT SENTENCE
 14179     ELSE
 14180        MOVE '2'                 TO CP-EARNING-METHOD.
 14181
 14182 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14183
 14184     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14185
 14186     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14187        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14188        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14189         NEXT SENTENCE
 14190     ELSE
 14191         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14192
 14193     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14194     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14195     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14196                                     CP-RATING-BENEFIT-AMT.
 14197     IF CP-STATE-STD-ABBRV = 'OR'
 14198         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14199                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 259
* EL050.cbl
 14200     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14201        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14202     END-IF
 14203     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14204     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14205     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14206                                    CP-REMAINING-TERM
 14207                                    CP-LOAN-TERM.
 14208     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14209        ADD +1                   TO CP-ORIGINAL-TERM
 14210                                    CP-REMAINING-TERM
 14211                                    CP-LOAN-TERM.
 14212
 14213     MOVE 'R'                   TO CP-RATE-FILE.
 14214     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14215
 14216     IF CP-ERROR-RATE-NOT-FOUND
 14217         MOVE ER-2641            TO WS-ERROR
 14218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14219         GO TO 3300-CHECK-AH-RATES.
 14220
 14221     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14222     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14223
 14224     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14225         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14226
 14227     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14228                               + PB-I-LF-ALT-BENEFIT-AMT.
 14229
 14230     IF ACCOUNT-LIFE-CHECKED  OR
 14231        PB-POLICY-IS-VOIDED   OR
 14232        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14233        and (not pb-monthly-cert))
 14234        GO TO 3225-CONTINUE.
 14235
 14236     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14237        GO TO 3225-CONTINUE.
 14238
 14239     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14240                             EC-RT-LF-MAX-TOT-BEN
 14241        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14242        MOVE ER-2639       TO WS-ERROR
 14243        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14244
 14245 3225-CONTINUE.
 14246     IF PB-I-LF-ALT-RATE = ZERO
 14247         MOVE ER-2659            TO WS-ERROR
 14248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14249
 14250     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14251        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14252        MOVE ER-2698             TO WS-ERROR
 14253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14254
 14255 3225-RATING-CONT.
 14256
 14257     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 260
* EL050.cbl
 14258        and (not pb-monthly-cert)
 14259         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14260         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14261         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14262            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14263            CONTINUE
 14264         ELSE
 14265            MOVE ER-2687         TO WS-ERROR
 14266            PERFORM 9900-ERROR-FORMAT
 14267                                 THRU 9900-EXIT
 14268         END-IF
 14269         GO TO 3290-EDIT-LF-REIN-RATE
 14270     END-IF
 14271
 14272* DMD RATING TEST
 14273     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14274         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14275         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14276         MOVE ER-2687                 TO WS-ERROR
 14277         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14278         GO TO 3290-EDIT-LF-REIN-RATE.
 14279
 14280 3230-CLIENT-MORT-CD-SPECIALS.
 14281
 14282     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14283     SET BIN-TO-GREG          TO TRUE.
 14284*    MOVE ' '                 TO DC-OPTION-CODE.
 14285     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14286     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14287
 14288 C-POS-3230-MORT-CD.
 14289     IF PB-COMPANY-ID = 'POS' AND
 14290        PB-SV-CARRIER = '2'
 14291         NEXT SENTENCE
 14292     ELSE
 14293         GO TO C-POS-3240-MORT-CD.
 14294
 14295     IF PB-SV-GROUPING = '030'
 14296        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14297         MOVE '2350' TO PB-I-MORT-CODE
 14298      ELSE
 14299         MOVE '3300' TO PB-I-MORT-CODE.
 14300
 14301
 14302 C-POS-3240-MORT-CD.
 14303     IF PB-COMPANY-ID = 'POS' AND
 14304        PB-SV-CARRIER = '1'
 14305         NEXT SENTENCE
 14306     ELSE
 14307         GO TO 3230-CONTINUE.
 14308
 14309     IF PB-SV-STATE = '45' OR '47'
 14310        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14311         MOVE '5200' TO PB-I-MORT-CODE
 14312     ELSE
 14313         MOVE '8300' TO PB-I-MORT-CODE.
 14314
 14315 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 261
* EL050.cbl
 14316
 14317     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14318        GO TO 3240-CONTINUE
 14319     END-IF
 14320
 14321     IF PB-CERT-EFF-DT > WS-971231
 14322        GO TO 3240-CONTINUE
 14323     END-IF
 14324
 14325     IF LF-BENEFIT-FOUND AND
 14326        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14327         MOVE 'F250'       TO PB-I-MORT-CODE
 14328     ELSE
 14329         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14330             MOVE '7250'   TO PB-I-MORT-CODE
 14331         ELSE
 14332             MOVE '4251'   TO PB-I-MORT-CODE
 14333         END-IF
 14334     END-IF
 14335
 14336     .
 14337 3240-CONTINUE.
 14338
 14339     IF PB-COMPANY-ID NOT = 'GNL'
 14340         GO TO 3256-CONTINUE.
 14341
 14342     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14343         MOVE 'A300' TO PB-I-MORT-CODE
 14344     ELSE
 14345         MOVE '8350' TO PB-I-MORT-CODE.
 14346
 14347 3256-CONTINUE.
 14348     IF PB-COMPANY-ID NOT = 'ABL'
 14349         GO TO 3260-EDIT-CONTINUE.
 14350
 14351     IF PB-I-LF-TERM GREATER THAN 59
 14352         MOVE 'F550' TO PB-I-MORT-CODE
 14353     ELSE
 14354         MOVE 'E550' TO PB-I-MORT-CODE.
 14355
 14356 3260-EDIT-CONTINUE.
 14357     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14358
 14359 3290-EDIT-LF-REIN-RATE.
 14360     IF LF-REIN-NSP-NOT-USED
 14361         GO TO 3290-RATING-CONT.
 14362
 14363     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14364        GO TO 3290-RATING-CONT.
 14365     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14366     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14367     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14368     MOVE '3'                   TO CP-PROCESS-TYPE.
 14369     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14370
 14371******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14372     IF PB-COMPANY-ID EQUAL 'CDL'
 14373         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 262
* EL050.cbl
 14374            CP-EARN-AS-NET-PAY)
 14375             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14376*            MOVE SPACE          TO DC-OPTION-CODE
 14377             SET BIN-TO-GREG     TO TRUE
 14378             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14379***  Y2K PROJ 7744
 14380             IF DC-GREG-DATE-CYMD GREATER 19931231
 14381                 MOVE '1'        TO CP-EARNING-METHOD.
 14382***  Y2K PROJ 7744
 14383*******
 14384
 14385     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14386     MOVE PB-SV-STATE           TO CP-STATE.
 14387     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14388     MOVE ZERO                  TO CP-DEVIATION-CODE
 14389                                   CP-RATE-DEV-PCT.
 14390     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14391     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14392                                   CP-RATING-BENEFIT-AMT.
 14393
 14394************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14395     IF PB-COMPANY-ID EQUAL 'NCB'
 14396         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14397            CP-EARN-AS-NET-PAY
 14398             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14399                 PB-I-LF-PREMIUM-AMT.
 14400************
 14401
 14402     IF CP-STATE-STD-ABBRV = 'OR'
 14403         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14404                                         PB-I-LF-ALT-BENEFIT-AMT.
 14405     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14406     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14407     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14408     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14409     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14410     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14411     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14412     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14413                                   CP-REMAINING-TERM
 14414                                   CP-LOAN-TERM.
 14415     IF CP-TRUNCATED-LIFE
 14416        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14417
 14418     IF CP-TERM-IS-DAYS
 14419         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14420     ELSE
 14421         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14422
 14423     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14424        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14425     END-IF
 14426     IF PB-COMPANY-ID NOT = 'TIC'
 14427          MOVE ZERO          TO CP-CLASS-CODE.
 14428
 14429     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14430
 14431     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 263
* EL050.cbl
 14432     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14433
 14434     IF CP-ERROR-RATE-NOT-FOUND
 14435        IF PB-I-OB
 14436           MOVE ER-2625      TO WS-ERROR
 14437           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14438           GO TO 3299-EDIT-CONTINUE
 14439        ELSE
 14440           MOVE ER-2643      TO WS-ERROR
 14441           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14442           GO TO 3299-EDIT-CONTINUE.
 14443
 14444     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14445
 14446     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14447     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14448
 14449     IF PB-I-LF-REI-RATE = ZERO
 14450         MOVE ER-2643        TO WS-ERROR
 14451         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14452
 14453 3290-CHECK-ALT-REIN-RATE.
 14454
 14455     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14456        GO TO 3290-RATING-CONT.
 14457
 14458     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14459     MOVE '2'                    TO CP-EARNING-METHOD.
 14460     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14461     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14462     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14463     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14464                                     CP-RATING-BENEFIT-AMT.
 14465     IF CP-STATE-STD-ABBRV = 'OR'
 14466         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14467                                         PB-I-LF-ALT-BENEFIT-AMT.
 14468     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14469        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14470     END-IF
 14471     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14472     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14473     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14474                                    CP-REMAINING-TERM
 14475                                    CP-LOAN-TERM.
 14476     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14477        ADD +1                   TO CP-ORIGINAL-TERM
 14478                                    CP-REMAINING-TERM
 14479                                    CP-LOAN-TERM.
 14480
 14481     MOVE 'R'                   TO CP-RATE-FILE.
 14482     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14483
 14484     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14485
 14486     IF PB-I-LF-ALT-REI-RATE = ZERO
 14487         MOVE ER-2643            TO WS-ERROR
 14488         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14489
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 264
* EL050.cbl
 14490 3290-RATING-CONT.
 14491
 14492     IF PB-I-OB
 14493*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14494        GO TO 3300-CHECK-AH-RATES.
 14495
 14496 3299-EDIT-CONTINUE.
 14497
 14498     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14499         NEXT SENTENCE
 14500     ELSE
 14501         MOVE ER-2620           TO WS-ERROR
 14502         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14503
 14504 3300-CHECK-AH-RATES.
 14505     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14506         NEXT SENTENCE
 14507     ELSE
 14508         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14509
 14510     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14511        and (not pb-monthly-cert))
 14512                  or
 14513        ((CF-COMPANY-ID = 'DMD') AND
 14514                (NO-DMD-RATING))
 14515         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14516            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14517            CONTINUE
 14518         ELSE
 14519            MOVE ER-2687         TO WS-ERROR
 14520            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14521         END-IF
 14522         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14523         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14524     END-IF
 14525
 14526     IF PB-I-OB
 14527        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14528
 14529     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14530         MOVE ER-2687             TO WS-ERROR
 14531         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14532         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14533         GO TO 3999-END-EDIT.
 14534
 14535*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14536     if pb-company-id = 'AHL'
 14537        go to 3300-skip-crit-per
 14538     end-if
 14539     if (pb-i-ah-crit-per not = zeros)
 14540        and (ws-ah-special-calc-cd not = 'C')
 14541        MOVE ER-1572             TO WS-ERROR
 14542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14543        go to 3300-skip-crit-per
 14544     END-IF
 14545     if (pb-company-id = 'DCC' or 'VPP')
 14546        and (am-dcc-product-code not = spaces)
 14547        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 265
* EL050.cbl
 14548     end-if
 14549     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14550        IF PB-I-AH-CRIT-PER = ZERO
 14551           move ws-ah-max-bens   to pb-i-ah-crit-per
 14552*          MOVE ER-2618       TO WS-ERROR
 14553*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14554*          GO TO 3999-END-EDIT
 14555        END-IF
 14556     END-IF
 14557     if (ws-ah-special-calc-cd = 'C')
 14558        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14559        MOVE ER-1576             TO WS-ERROR
 14560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14561     end-if
 14562
 14563     .
 14564 3300-skip-crit-per.
 14565     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14566     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14567     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14568     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14569     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14570     MOVE PB-SV-STATE            TO CP-STATE.
 14571     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14572     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14573     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14574*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14575     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14576     MOVE '3'                    TO CP-PROCESS-TYPE.
 14577     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14578     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14579                                    CP-RATING-BENEFIT-AMT.
 14580     IF PB-COMPANY-ID = 'CID'
 14581               OR
 14582        CP-STATE-STD-ABBRV = 'OR'
 14583         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14584                                         PB-I-AH-TERM.
 14585     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14586        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14587           AND (PB-I-POLICY-IS-MONTHLY)
 14588           MOVE PB-I-LF-BENEFIT-AMT
 14589                                 TO CP-NET-BENEFIT-AMT
 14590           move pb-i-ah-premium-amt to cp-original-premium
 14591           add pb-i-lf-premium-amt to cp-original-premium
 14592        END-IF
 14593     END-IF
 14594     MOVE SPACES                 TO CP-BEN-CATEGORY
 14595     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14596        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14597        EVALUATE TRUE
 14598           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14599              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14600              MOVE PB-I-LF-BENEFIT-AMT
 14601                                 TO CP-RATING-BENEFIT-AMT
 14602              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14603           WHEN WS-AH-BEN-CATEGORY = 'G'
 14604              MOVE PB-I-UNPAID-CASH-PRICE
 14605                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 266
* EL050.cbl
 14606           WHEN WS-AH-BEN-CATEGORY = 'D'
 14607              MOVE WS-AH-PMF-COMM
 14608                                 TO CP-DCC-PMF-COMM
 14609              MOVE PB-I-AH-COMMISSION
 14610                                 TO CP-DCC-ACT-COMM
 14611        END-EVALUATE
 14612     END-IF
 14613     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14614     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14615     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14616     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14617     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14618     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14619     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14620                                    CP-REMAINING-TERM
 14621                                    WS-WORK-TERM.
 14622     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14623
 14624     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14625     SET BIN-TO-GREG             TO TRUE.
 14626*    MOVE ' '                    TO DC-OPTION-CODE.
 14627     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14628     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14629
 14630     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14631     IF NOT VALID-SKIP-CODE
 14632         MOVE ER-2683            TO WS-ERROR
 14633         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14634         GO TO 3320-RATE-CONTINUE.
 14635
 14636     IF PB-NO-MONTHS-SKIPPED
 14637         GO TO 3320-RATE-CONTINUE.
 14638
 14639     MOVE SPACE TO NUMBER-OF-MONTHS.
 14640
 14641     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14642         MOVE 'S'                TO SK-MO (6).
 14643     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14644         MOVE 'S'                TO SK-MO (7).
 14645     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14646         MOVE 'S'                TO SK-MO (8).
 14647     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14648         MOVE 'S'                TO SK-MO (9).
 14649     IF PB-I-SKIP-CODE = 'A'
 14650         MOVE 'S'                TO SK-MO (10).
 14651
 14652     MOVE 1                      TO SUB2.
 14653     MOVE PB-I-AH-TERM           TO SUB3.
 14654     MOVE WS-MONTH               TO SUB1.
 14655     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14656     GO TO 3320-RATE-CONTINUE.
 14657
 14658 3310-GET-SKIP-MO.
 14659     IF SUB1 = 13
 14660         MOVE 1                  TO SUB1.
 14661
 14662     IF SK-MO (SUB1) = 'S'
 14663         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 267
* EL050.cbl
 14664
 14665     ADD 1 TO SUB2
 14666              SUB1.
 14667
 14668 3320-RATE-CONTINUE.
 14669
 14670     IF WS-WORK-TERM = ZERO
 14671         MOVE 1                  TO WS-WORK-TERM.
 14672
 14673     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14674                                    CP-LOAN-TERM.
 14675
 14676     IF PB-COMPANY-ID EQUAL 'DMD'
 14677         NEXT SENTENCE
 14678     ELSE
 14679         MOVE ZERO               TO PB-I-AH-RATE
 14680                                    PB-I-AH-REI-RATE.
 14681
 14682
 14683     IF PB-COMPANY-ID EQUAL 'CRI'
 14684        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14685
 14686     IF PB-COMPANY-ID = 'CSL'
 14687         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14688         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14689         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14690         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14691
 14692     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14693        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14694           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14695              PB-I-RATE-DEV-PCT-LF
 14696        END-IF
 14697        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14698                                 TO CP-ALTERNATE-BENEFIT
 14699        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14700        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14701        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14702     END-IF
 14703*    if ws-clp-state not = spaces
 14704*       move ws-clp-state to cp-state
 14705*    end-if
 14706     IF (PB-COMPANY-ID = 'CID')
 14707        AND (WS-LF-EARNINGS-CALC = 'B')
 14708        AND (CP-STATE-STD-ABBRV = 'MN')
 14709        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14710     ELSE
 14711        MOVE ' '                 TO CP-AH-BALLOON-SW
 14712     END-IF
 14713     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14714     MOVE 'R'                   TO CP-RATE-FILE.
 14715     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14716
 14717     IF (CP-ERROR-RATE-NOT-FOUND)
 14718        and (not pb-monthly-cert)
 14719        IF PB-I-OB
 14720           MOVE ER-2624          TO WS-ERROR
 14721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 268
* EL050.cbl
 14722           GO TO 3340-CALCULATE-PREMIUM-AMT
 14723        ELSE
 14724          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14725              NEXT SENTENCE
 14726          ELSE
 14727           MOVE ER-2642          TO WS-ERROR
 14728           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14729           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14730
 14731     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14732        CP-ERROR-DIV-BY-ZERO
 14733           MOVE ER-3782          TO WS-ERROR
 14734           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14735
 14736     IF PB-COMPANY-ID EQUAL 'CRI'
 14737        IF CP-ERROR-NO-LIMITS-CRI
 14738           IF NOT ACCOUNT-AH-CHECKED
 14739              MOVE ER-2607          TO WS-ERROR
 14740              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14741
 14742     IF ACCOUNT-AH-CHECKED
 14743        NEXT SENTENCE
 14744     ELSE
 14745       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14746          MOVE ER-2640           TO WS-ERROR
 14747          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14748
 14749     IF PB-COMPANY-ID = 'CRI'
 14750         IF WS-ERROR = ER-2640
 14751             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14752     IF ACCOUNT-AH-CHECKED
 14753        CONTINUE
 14754     ELSE
 14755        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14756           AND (CP-R-MAX-ATT-AGE > +0)
 14757           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14758           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14759              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14760              MOVE PB-I-AH-EXPIRE-DT
 14761                                 TO DC-BIN-DATE-2
 14762              MOVE '1'           TO DC-OPTION-CODE
 14763              PERFORM 8500-DATE-CONVERT
 14764                                 THRU 8500-EXIT
 14765              IF NO-CONVERSION-ERROR
 14766                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14767                    MOVE ER-2661       TO WS-ERROR
 14768*                   PERFORM 9900-ERROR-FORMAT
 14769*                                THRU 9900-EXIT
 14770                 END-IF
 14771              END-IF
 14772           ELSE
 14773              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14774              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14775                 MOVE ER-2661    TO WS-ERROR
 14776*                PERFORM 9900-ERROR-FORMAT
 14777*                                THRU 9900-EXIT
 14778              ELSE
 14779                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 269
* EL050.cbl
 14780                    MOVE ER-1570 TO WS-ERROR
 14781                    PERFORM 9900-ERROR-FORMAT
 14782                                 THRU 9900-EXIT
 14783                 END-IF
 14784              END-IF
 14785           END-IF
 14786           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14787              MOVE PB-I-JOINT-BIRTHDAY
 14788                                    TO DC-BIN-DATE-1
 14789              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14790              MOVE '1'              TO DC-OPTION-CODE
 14791              PERFORM 8500-DATE-CONVERT
 14792                                    THRU 8500-EXIT
 14793              IF NO-CONVERSION-ERROR
 14794                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14795                    MOVE ER-2661       TO WS-ERROR
 14796*                   PERFORM 9900-ERROR-FORMAT
 14797*                                   THRU 9900-EXIT
 14798                 END-IF
 14799              END-IF
 14800           ELSE
 14801              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14802                (PB-I-AH-TERM / 12)
 14803              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14804                 MOVE ER-2661       TO WS-ERROR
 14805*                PERFORM 9900-ERROR-FORMAT
 14806*                                   THRU 9900-EXIT
 14807              ELSE
 14808                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14809                    MOVE ER-1571 TO WS-ERROR
 14810                    PERFORM 9900-ERROR-FORMAT
 14811                                 THRU 9900-EXIT
 14812                 END-IF
 14813              END-IF
 14814           END-IF
 14815           IF WS-ERROR = ER-2661
 14816              PERFORM 9900-ERROR-FORMAT
 14817                                    THRU 9900-EXIT
 14818           END-IF
 14819        END-IF
 14820     END-IF
 14821*    IF ACCOUNT-AH-CHECKED
 14822*       NEXT SENTENCE
 14823*    ELSE
 14824*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14825*          MOVE ER-2661          TO WS-ERROR
 14826*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14827
 14828     IF ACCOUNT-AH-CHECKED
 14829        NEXT SENTENCE
 14830     ELSE
 14831        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14832           MOVE ER-2663          TO WS-ERROR
 14833           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14834
 14835     IF ACCOUNT-AH-CHECKED OR
 14836        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14837         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 270
* EL050.cbl
 14838        NEXT SENTENCE
 14839     ELSE
 14840        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14841           MOVE ER-2667            TO WS-ERROR
 14842           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14843
 14844     IF PB-COMPANY-ID = 'CRI'
 14845         IF WS-ERROR = ER-2667
 14846             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14847
 14848     IF ACCOUNT-AH-CHECKED
 14849        NEXT SENTENCE
 14850     ELSE
 14851        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14852           MOVE ER-2678            TO WS-ERROR
 14853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14854
 14855     IF CP-ERROR-RATE-FILE-NOTOPEN
 14856         GO TO 3990-FILES-NOT-OPEN.
 14857
 14858 3321-CONTINUE.
 14859     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14860     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14861     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14862*    IF (PB-COMPANY-ID = 'DCC')
 14863        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14864        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14865                                    PB-I-LF-ALT-PREM-CALC
 14866        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14867        IF WS-AH-BEN-CATEGORY = 'G'
 14868           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14869           + PB-I-ADDL-CLP)
 14870           * (1 + WS-TOL-CLP-PCT)
 14871*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14872        ELSE
 14873           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14874           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14875*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14876        END-IF
 14877        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14878                                 TO PB-I-AH-PREM-CALC
 14879        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14880           MOVE ER-8152          TO WS-ERROR
 14881           PERFORM 9900-ERROR-FORMAT
 14882                                 THRU 9900-EXIT
 14883        ELSE
 14884           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14885                 PB-I-ADDL-CLP)
 14886              MOVE ER-8148       TO WS-ERROR
 14887              PERFORM 9900-ERROR-FORMAT
 14888                                 THRU 9900-EXIT
 14889           END-IF
 14890        END-IF
 14891     END-IF
 14892     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14893        AND (PB-I-POLICY-IS-MONTHLY)
 14894        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14895        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 271
* EL050.cbl
 14896        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14897           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14898        END-IF
 14899     END-IF
 14900     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14901        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14902        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14903        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14904        MOVE ER-2786             TO WS-ERROR
 14905        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14906     END-IF
 14907     MOVE +0                     TO PB-I-AH-CLP
 14908     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14909        evaluate true
 14910           when WS-AH-BEN-CATEGORY = 'D'
 14911              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14912                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14913           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14914              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14915           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14916              compute ws-cred-union-fees rounded =
 14917                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14918                    pb-i-ah-commission)
 14919              COMPUTE PB-I-AH-CLP =
 14920                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14921        end-evaluate
 14922     END-IF
 14923     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14924
 14925     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14926         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14927
 14928     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14929         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14930
 14931     if (ws-ah-special-calc-cd = 'E')
 14932        and (pb-monthly-cert)
 14933        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14934     end-if
 14935     IF PB-COMPANY-ID = 'CRI'
 14936         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14937            PB-I-PAYMENT-AMOUNT = ZERO
 14938             NEXT SENTENCE
 14939         ELSE
 14940             COMPUTE PB-I-AH-PREM-CALC =
 14941                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14942                 (CP-PREMIUM-RATE / 100)
 14943             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14944                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14945                                             PB-I-RATE-DEV-PCT-AH.
 14946
 14947     IF (PB-I-AH-RATE  = ZERO)
 14948        and (not pb-monthly-cert)
 14949       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14950           NEXT SENTENCE
 14951       ELSE
 14952         MOVE ER-2642            TO WS-ERROR
 14953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 272
* EL050.cbl
 14954
 14955     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14956     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14957     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14958     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14959     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14960     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14961
 14962     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14963        AND (WS-AH-BEN-CATEGORY = 'G')
 14964        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14965        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14966        IF CP-DEVIATION-CODE NOT = '000'
 14967           MOVE '000'            TO CP-DEVIATION-CODE
 14968           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14969           IF NO-CP-ERROR
 14970              COMPUTE PB-I-DDF-IU-RATE-UP =
 14971              PB-I-AH-CLP - CP-CALC-PREMIUM
 14972           ELSE
 14973              MOVE ER-3057        TO WS-ERROR
 14974              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14975           END-IF
 14976        END-IF
 14977     END-IF
 14978     .
 14979 3335-EDIT-AH-REIN-NSP-RATE.
 14980     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14981        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14982              compute ws-cred-union-fees rounded =
 14983                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14984                    pb-i-ah-commission)
 14985              COMPUTE PB-I-AH-CLP =
 14986                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14987        end-if
 14988     END-IF
 14989     IF AH-REIN-NSP-NOT-USED
 14990         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14991
 14992     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14993     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14994         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14995     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14996     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14997     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14998     MOVE PB-SV-STATE            TO CP-STATE.
 14999     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15000     MOVE ZERO                   TO CP-DEVIATION-CODE
 15001                                    CP-RATE-DEV-PCT.
 15002*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15003     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15004     MOVE '3'                    TO CP-PROCESS-TYPE.
 15005     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15006     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15007                                    CP-RATING-BENEFIT-AMT.
 15008     IF CP-STATE-STD-ABBRV = 'OR'
 15009         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 15010                                         PB-I-AH-TERM.
 15011     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 273
* EL050.cbl
 15012     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15013     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15014     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15015     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15016     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15017                                    CP-REMAINING-TERM
 15018                                    WS-WORK-TERM.
 15019     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15020     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15021        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15022     END-IF
 15023     IF  PB-COMPANY-ID = 'TIC'
 15024         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15025            MOVE ZERO TO CP-CLASS-CODE.
 15026
 15027     IF PB-COMPANY-ID NOT = 'TIC'
 15028          MOVE ZERO          TO CP-CLASS-CODE.
 15029
 15030     MOVE ZERO               TO CP-DEVIATION-CODE.
 15031
 15032     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15033
 15034     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15035
 15036     MOVE 'R'                   TO CP-RATE-FILE.
 15037     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15038
 15039     IF CP-ERROR-RATE-NOT-FOUND
 15040         MOVE ER-2645        TO WS-ERROR
 15041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15042         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15043
 15044     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15045
 15046     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15047     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15048
 15049     IF PB-I-AH-REI-RATE = ZERO
 15050         MOVE ER-2645        TO WS-ERROR
 15051         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15052
 15053
 15054 3340-CALCULATE-PREMIUM-AMT.
 15055
 15056     IF PB-COMPANY-ID = 'NCL'
 15057         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15058             WS-AH-SPECIAL-CALC-CD = 'O')
 15059             GO TO 3999-END-EDIT.
 15060
 15061     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15062                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15063                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15064                         OR 'AHL'
 15065         NEXT SENTENCE
 15066     ELSE
 15067         IF WS-STATE-ABBREVIATION = 'CT'
 15068             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15069                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 274
* EL050.cbl
 15070                 COMPUTE PB-I-LF-PREM-CALC =
 15071                                     PB-I-LF-PREM-CALC * .90
 15072                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15073                                     PB-I-LF-ALT-PREM-CALC * .90
 15074                 COMPUTE PB-I-AH-PREM-CALC =
 15075                                     PB-I-AH-PREM-CALC * .90.
 15076
 15077     IF PB-COMP-LF-PREM
 15078        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15079        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15080
 15081     IF PB-COMP-AH-PREM
 15082        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15083
 15084 3340-CHECK-DCC-TOT-FEES.
 15085     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15086        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15087        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15088        AND (PB-I-POLICY-IS-MONTHLY)
 15089        CONTINUE
 15090     ELSE
 15091        GO TO 3340-EDIT-LF-AH-TOL
 15092     END-IF
 15093     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15094     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15095     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15096        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15097           PB-I-RATE-DEV-PCT-LF
 15098     END-IF
 15099     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15100        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15101           PB-I-RATE-DEV-PCT-AH
 15102     END-IF
 15103     MOVE 'N'                    TO CP-BEN-CATEGORY
 15104     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15105
 15106     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15107     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15108     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15109     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15110     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15111     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15112     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15113     MOVE '3'                    TO CP-PROCESS-TYPE.
 15114     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15115     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15116
 15117     MOVE PB-SV-STATE            TO CP-STATE.
 15118     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15119     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15120     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15121     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15122     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15123                                    CP-RATING-BENEFIT-AMT.
 15124     IF CP-STATE-STD-ABBRV = 'OR'
 15125         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15126                                         PB-I-LF-ALT-BENEFIT-AMT.
 15127     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 275
* EL050.cbl
 15128     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15129     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15130     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15131     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15132     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15133     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15134     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15135     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15136                                    CP-REMAINING-TERM
 15137                                    CP-LOAN-TERM.
 15138     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15139        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15140           PB-I-LF-PREMIUM-AMT
 15141     end-if
 15142
 15143     IF CP-TRUNCATED-LIFE
 15144        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15145
 15146     IF CP-TERM-IS-DAYS
 15147         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15148     ELSE
 15149         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15150
 15151     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15152     IF CP-SPECIAL-CALC-CD = 'H'
 15153         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15154                                    TO CP-ALTERNATE-BENEFIT
 15155         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15156     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15157     MOVE 'R'                    TO CP-RATE-FILE
 15158     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15159     IF NOT CP-ERROR-RATE-NOT-FOUND
 15160        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15161        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15162           AND (CP-BENEFIT-CD (1:1) = 'S')
 15163           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15164                                    PB-I-LF-PREMIUM-AMT
 15165        END-IF
 15166     ELSE
 15167        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15168     END-IF
 15169     .
 15170 3340-EDIT-LF-AH-TOL.
 15171
 15172***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15173***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15174***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15175***
 15176     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15177         PB-I-AH-PREMIUM-AMT
 15178          GIVING WS-CALC-WORK.
 15179
 15180     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15181        AND WS-CALC-WORK NOT = ZERO
 15182         MOVE ER-2649            TO WS-ERROR
 15183         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15184
 15185     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 276
* EL050.cbl
 15186             FROM PB-I-LF-PREMIUM-AMT
 15187                 GIVING WS-UNSIGN-WRK1.
 15188
 15189     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15190             FROM PB-I-LF-ALT-PREMIUM-AMT
 15191                 GIVING WS-UNSIGN-WRK4.
 15192
 15193     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15194                                + WS-UNSIGN-WRK4.
 15195
 15196     SUBTRACT PB-I-AH-PREM-CALC
 15197             FROM PB-I-AH-PREMIUM-AMT
 15198                 GIVING WS-UNSIGN-WRK2.
 15199
 15200******************************************************************
 15201*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15202******************************************************************
 15203
 15204     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15205         MOVE ZERO TO WS-UNSIGN-WRK1.
 15206
 15207     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15208         MOVE ZERO TO WS-UNSIGN-WRK2.
 15209
 15210     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15211             GIVING WS-UNSIGN-WRK3.
 15212
 15213 3342-CONTINUE.
 15214
 15215     IF (PB-I-LF-RATE = ZERO  AND
 15216         PB-I-AH-RATE = ZERO)
 15217         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15218            WS-AH-SPECIAL-CALC-CD = 'O'
 15219              NEXT SENTENCE
 15220         ELSE
 15221             GO TO 3345-EDIT-CONTINUE.
 15222
 15223     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15224         NEXT SENTENCE
 15225     ELSE
 15226     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15227        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15228           IF (PB-REISSUED-CERT         OR
 15229               PB-POLICY-IS-DECLINED    OR
 15230               PB-POLICY-IS-VOIDED)
 15231              NEXT SENTENCE
 15232           ELSE
 15233              IF WS-PREM-REJECT-SW = SPACE
 15234                 MOVE ER-2652    TO WS-ERROR
 15235                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15236                 GO TO 3344-CHECK-AH
 15237              ELSE
 15238                 MOVE ER-2650    TO WS-ERROR
 15239                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15240                 GO TO 3344-CHECK-AH.
 15241
 15242***
 15243***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 277
* EL050.cbl
 15244***
 15245
 15246     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15247         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15248            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15249             (1 + WS-TOL-LF-PREM-PCT)
 15250         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15251            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15252             (1 - WS-TOL-LF-PREM-PCT)
 15253     ELSE
 15254         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15255         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15256
 15257***
 15258***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15259***
 15260
 15261     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15262         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15263          WS-TOL-LF-PREM.
 15264
 15265     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15266         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15267          WS-TOL-LF-PREM.
 15268
 15269     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15270        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15271
 15272     IF PB-REISSUED-CERT
 15273        or PB-POLICY-IS-DECLINED
 15274        or PB-POLICY-IS-VOIDED
 15275        continue
 15276     ELSE
 15277        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15278              > WS-TOL-LF-HIGH-PREM-AMT)
 15279           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15280              < WS-TOL-LF-LOW-PREM-AMT))
 15281                      or
 15282           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15283              > WS-TOL-LF-HIGH-PREM-PCT)
 15284           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15285              < WS-TOL-LF-LOW-PREM-PCT))
 15286           IF WS-PREM-REJECT-SW = SPACE
 15287              MOVE ER-2652       TO WS-ERROR
 15288              PERFORM 9900-ERROR-FORMAT
 15289                                 THRU 9900-EXIT
 15290           ELSE
 15291              MOVE ER-2650       TO WS-ERROR
 15292              PERFORM 9900-ERROR-FORMAT
 15293                                 THRU 9900-EXIT
 15294           end-if
 15295        end-if
 15296     end-if
 15297
 15298*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15299*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15300*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15301*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 278
* EL050.cbl
 15302
 15303     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15304        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15305                      OR
 15306           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15307           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15308           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15309           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15310        END-IF
 15311     END-IF
 15312
 15313     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15314        IF WS-COMP-MAX-CAP GREATER THAN +0
 15315           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15316              IF (PB-REISSUED-CERT         OR
 15317                  PB-POLICY-IS-DECLINED    OR
 15318                  PB-POLICY-IS-VOIDED)
 15319                 NEXT SENTENCE
 15320              ELSE
 15321                  MOVE ER-2646   TO  WS-ERROR
 15322                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15323
 15324 3344-CVL-TOLERANCE-CHECK.
 15325
 15326      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15327          GO TO 3344-CHECK-AH.
 15328
 15329      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15330          GO TO 3344-CHECK-AH.
 15331
 15332      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15333                                     WS-UNSIGN-WRK6.
 15334
 15335      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15336          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15337                                 + PB-I-LF-PREMIUM-AMT
 15338                                 - PB-I-LF-PREM-CALC.
 15339
 15340      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15341          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15342                                 + PB-I-LF-ALT-PREMIUM-AMT
 15343                                 - PB-I-LF-ALT-PREM-CALC.
 15344
 15345      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15346          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15347              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15348                 MOVE ER-2652    TO  WS-ERROR
 15349                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15350              ELSE
 15351                 MOVE ER-2650    TO  WS-ERROR
 15352                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15353
 15354      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15355          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15356              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15357                 MOVE ER-2652    TO  WS-ERROR
 15358                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15359              ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 279
* EL050.cbl
 15360                 MOVE ER-2650    TO  WS-ERROR
 15361                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15362
 15363 3344-CHECK-AH.
 15364
 15365****************************************************************
 15366***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15367***
 15368
 15369     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15370         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15371             (1 + WS-TOL-AH-PREM-PCT)
 15372         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15373             (1 - WS-TOL-AH-PREM-PCT)
 15374     ELSE
 15375         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15376         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15377
 15378***
 15379***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15380***
 15381
 15382     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15383         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15384
 15385     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15386         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15387
 15388     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15389        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15390
 15391     IF (PB-REISSUED-CERT)
 15392        OR (PB-POLICY-IS-DECLINED)
 15393        OR (PB-POLICY-IS-VOIDED)
 15394        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15395        CONTINUE
 15396     ELSE
 15397        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15398              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15399                          or
 15400           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15401              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15402           IF WS-PREM-REJECT-SW = SPACE
 15403              MOVE ER-3052       TO WS-ERROR
 15404              PERFORM 9900-ERROR-FORMAT
 15405                                 THRU 9900-EXIT
 15406           ELSE
 15407              MOVE ER-3050       TO WS-ERROR
 15408              PERFORM 9900-ERROR-FORMAT
 15409                                 THRU 9900-EXIT
 15410           END-IF
 15411        END-IF
 15412     END-IF
 15413     if (pb-company-id = 'DCC' or 'VPP')
 15414        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15415        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15416        and (pb-i-policy-is-monthly)
 15417        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 280
* EL050.cbl
 15418           pb-i-tot-fees-calc + ws-tol-ah-prem
 15419        compute ws-tol-ah-low-prem-amt =
 15420           pb-i-tot-fees-calc - ws-tol-ah-prem
 15421        if ws-tol-ah-prem-pct > zeros
 15422           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15423              (1 + ws-tol-ah-prem-pct)
 15424           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15425              (1 - ws-tol-ah-prem-pct)
 15426        else
 15427           move +9999999.99      to ws-tol-ah-high-prem-pct
 15428           move +0               to ws-tol-ah-low-prem-pct
 15429        end-if
 15430        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15431            or
 15432           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15433                          or
 15434           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15435           or
 15436           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15437            move er-3049         to ws-error
 15438           perform 9900-error-format
 15439                                 thru 9900-exit
 15440
 15441        end-if
 15442     end-if
 15443     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15444         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15445             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15446             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15447
 15448     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15449        IF WS-COMP-MAX-CAP GREATER THAN +0
 15450           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15451              IF (PB-REISSUED-CERT         OR
 15452                  PB-POLICY-IS-DECLINED    OR
 15453                  PB-POLICY-IS-VOIDED)
 15454                 NEXT SENTENCE
 15455              ELSE
 15456                  MOVE ER-2646   TO  WS-ERROR
 15457                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15458
 15459     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15460        (WS-COMP-MAX-CAP EQUAL +0)
 15461           GO TO 3345-EDIT-CONTINUE.
 15462
 15463     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15464        GREATER THAN WS-COMP-MAX-CAP
 15465           MOVE ER-2646          TO  WS-ERROR
 15466           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15467
 15468 3345-EDIT-CONTINUE.
 15469
 15470*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15471*       IF PB-ENTRY-BATCH   NUMERIC
 15472*          IF PB-ISSUE
 15473*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15474*          ELSE
 15475*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 281
* EL050.cbl
 15476*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15477
 15478*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15479*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15480*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15481*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15482*        ELSE
 15483*            MOVE  ER-1909            TO  WS-ERROR
 15484*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15485
 15486     IF PB-I-POLICY-ACCEPTED
 15487        IF PB-POLICY-IS-DECLINED  OR
 15488           PB-REISSUED-CERT  OR
 15489           PB-REIN-ONLY-CERT  OR
 15490           PB-POLICY-IS-VOIDED
 15491            MOVE  ER-1891         TO  WS-ERROR
 15492            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15493        ELSE
 15494            MOVE SPACE            TO  PB-BATCH-ENTRY
 15495            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15496
 15497     IF PB-I-POLICY-DECLINED
 15498        IF PB-REISSUED-CERT  OR
 15499           PB-REIN-ONLY-CERT  OR
 15500           PB-POLICY-IS-VOIDED
 15501            MOVE  ER-1906         TO  WS-ERROR
 15502            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15503        ELSE
 15504            MOVE  'D'             TO  PB-BATCH-ENTRY
 15505                                      PB-I-ENTRY-STATUS.
 15506
 15507     IF PB-I-NEEDS-UNDERWRITING
 15508        IF PB-POLICY-IS-DECLINED OR
 15509           PB-REISSUED-CERT  OR
 15510           PB-REIN-ONLY-CERT  OR
 15511           PB-POLICY-IS-VOIDED
 15512            MOVE  ER-1907         TO  WS-ERROR
 15513            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15514        ELSE
 15515            MOVE 'U'              TO  PB-BATCH-ENTRY
 15516                                      PB-I-ENTRY-STATUS.
 15517
 15518     IF PB-NEEDS-UNDERWRITING
 15519        MOVE  ER-1901             TO  WS-ERROR
 15520        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15521     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15522        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15523        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15524        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15525           AND (NOT WS-LF-CASH))
 15526                           OR
 15527           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15528           AND (NOT WS-AH-CASH)))
 15529                       AND
 15530           (PB-I-ENTRY-STATUS NOT = '5')
 15531           MOVE 'M'              TO PB-BATCH-ENTRY
 15532                                    PB-I-ENTRY-STATUS
 15533        END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 282
* EL050.cbl
 15534     END-IF
 15535     move pending-business       to ws-passed-erpndb
 15536     move ' '                    to ws-exceed-limit-yn
 15537     perform 7780-call-agg       thru 7780-exit
 15538*    display ' el050 exceed ' ws-exceed-limit-yn
 15539     if ws-exceed-limit-yn = 'Y'
 15540        MOVE  ER-9813            TO WS-ERROR
 15541        move 'Y'                 to ws-9813-sw
 15542        PERFORM  9900-ERROR-FORMAT
 15543                                 THRU 9900-EXIT
 15544     end-if
 15545     if (PB-EXCEEDED-LIMIT-FORCED)
 15546        and (ws-9813-sw = 'Y')
 15547        subtract +1 from PB-NO-OF-ERRORS
 15548        move er-9823             to ws-error
 15549        PERFORM  9900-ERROR-FORMAT
 15550                                 THRU 9900-EXIT
 15551     end-if
 15552     IF  PB-COMPANY-ID NOT = 'NCL'
 15553         GO TO 3999-END-EDIT.
 15554
 15555     IF PB-REISSUED-CERT  OR
 15556        PB-POLICY-IS-DECLINED  OR
 15557        PB-POLICY-IS-VOIDED  OR
 15558        PB-I-OB
 15559         GO TO 3999-END-EDIT.
 15560
 15561     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15562         MOVE  ER-2644            TO  WS-ERROR
 15563         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15564         GO TO 3999-END-EDIT.
 15565
 15566     MOVE 'N'                     TO  FORM-MASTER-SW.
 15567     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15568
 15569     IF NOT FORM-MASTER-FOUND
 15570         GO TO 3999-END-EDIT.
 15571
 15572     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15573                                      FORM-MASTER-AH-SW.
 15574
 15575     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15576         MOVE  +1                 TO SUB6
 15577         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15578
 15579     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15580         MOVE  +1                 TO SUB6
 15581         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15582
 15583     IF LF-FORM-MASTER-FOUND  OR
 15584        AH-FORM-MASTER-FOUND
 15585         GO TO 3360-CHECK-FORM-LIMITS
 15586     ELSE
 15587         GO TO 3999-END-EDIT.
 15588
 15589******************************************************************
 15590*                  3350-GET-ERFORM                               *
 15591*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 283
* EL050.cbl
 15592*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15593******************************************************************
 15594
 15595 3350-GET-ERFORM.
 15596
 15597     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15598         GO TO  3350-ERFORM-GETMAIN.
 15599
 15600     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15601     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15602     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15603     MOVE 'Y'                     TO FORM-MASTER-SW.
 15604
 15605     IF PB-CANCELLATION
 15606         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15607            PB-SV-STATE          EQUAL   FO-STATE       AND
 15608            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15609              GO TO 3350-EXIT
 15610         ELSE
 15611             NEXT SENTENCE
 15612     ELSE
 15613         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15614            PB-SV-STATE          EQUAL   FO-STATE       AND
 15615            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15616              GO TO 3350-EXIT.
 15617
 15618 3350-ERFORM-GETMAIN.
 15619
 15620     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15621     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15622
 15623 3350-ERFORM-READ.
 15624
 15625     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15626     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15627     IF PB-CANCELLATION
 15628         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15629     ELSE
 15630         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15631     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15632
 15633     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15634
 15635     IF FORM-MASTER-FOUND
 15636       IF PB-CANCELLATION
 15637          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15638             PB-SV-STATE          EQUAL   FO-STATE       AND
 15639             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15640              GO  TO 3350-EXIT
 15641          ELSE
 15642              NEXT SENTENCE
 15643       ELSE
 15644          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15645             PB-SV-STATE          EQUAL   FO-STATE       AND
 15646             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15647              GO  TO 3350-EXIT.
 15648
 15649     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 284
* EL050.cbl
 15650     MOVE  ER-1895                TO  WS-ERROR.
 15651     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15652
 15653 3350-EXIT.
 15654      EXIT.
 15655
 15656******************************************************************
 15657*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15658*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15659*   VALID FOR THE POLICY FORM USED.                              *
 15660******************************************************************
 15661
 15662 3355-EDIT-FORM-LF-BENEFITS.
 15663
 15664     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15665        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15666         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15667         GO TO   3355-EXIT.
 15668
 15669     IF  SUB6    LESS THAN   +40
 15670         ADD  +1      TO  SUB6
 15671         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15672
 15673     MOVE  ER-1896         TO  WS-ERROR.
 15674     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15675
 15676 3355-EXIT.
 15677      EXIT.
 15678
 15679******************************************************************
 15680*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15681*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15682*   VALID FOR THE POLICY FORM USED.                              *
 15683******************************************************************
 15684
 15685 3356-EDIT-FORM-AH-BENEFITS.
 15686
 15687     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15688        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15689         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15690         GO TO  3356-EXIT.
 15691
 15692      IF  SUB6    LESS THAN     +40
 15693          ADD  +1      TO  SUB6
 15694          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15695
 15696     MOVE  ER-1897         TO  WS-ERROR.
 15697     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15698
 15699 3356-EXIT.
 15700      EXIT.
 15701
 15702******************************************************************
 15703*                  3357-BENEFIT-SEARCH                           *
 15704*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15705*   CANCELLATIONS ONLY.                                          *
 15706******************************************************************
 15707 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 285
* EL050.cbl
 15708     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15709         MOVE +1                          TO SUB6
 15710         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15711
 15712     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15713         MOVE +1                          TO SUB6
 15714         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15715
 15716 3357-EXIT.
 15717     EXIT.
 15718
 15719******************************************************************
 15720*                  3358-BENEFIT-LIFE-SEARCH                      *
 15721*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15722*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15723*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15724******************************************************************
 15725 3358-BENEFIT-LIFE-SEARCH.
 15726     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15727       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15728         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15729           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15730              IF FO-PLAN-REFUND-METHOD (SUB6)
 15731                     IS GREATER THAN SPACES
 15732                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15733                                          WS-LF-REFUND-CALC
 15734                 GO TO 3358-EXIT.
 15735
 15736     IF SUB6 LESS THAN +40
 15737         ADD +1                 TO SUB6
 15738         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15739
 15740 3358-EXIT.
 15741     EXIT.
 15742******************************************************************
 15743*                  3359-BENEFIT-AH-SEARCH                        *
 15744*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15745*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15746*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15747******************************************************************
 15748 3359-BENEFIT-AH-SEARCH.
 15749     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15750       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15751         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15752           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15753              IF FO-PLAN-REFUND-METHOD (SUB6)
 15754                      IS GREATER THAN SPACES
 15755                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15756                                          WS-AH-REFUND-CALC
 15757                 GO TO 3359-EXIT.
 15758
 15759     IF SUB6 LESS THAN +40
 15760         ADD +1                 TO SUB6
 15761         GO TO 3359-BENEFIT-AH-SEARCH.
 15762
 15763 3359-EXIT.
 15764     EXIT.
 15765
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 286
* EL050.cbl
 15766******************************************************************
 15767*                  3360-CHECK-FORM-LIMITS                        *
 15768*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15769*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15770******************************************************************
 15771
 15772 3360-CHECK-FORM-LIMITS.
 15773
 15774     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15775         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15776
 15777     IF NOT LF-FORM-MASTER-FOUND
 15778         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15779
 15780 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15781
 15782     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15783       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15784        WS-LF-JOINT-INDICATOR = 'J'  AND
 15785        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15786         IF PB-COMPANY-ID = 'NCL'
 15787            MOVE  ER-1911          TO  WS-ERROR
 15788            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15789         ELSE
 15790            MOVE  ER-1892          TO  WS-ERROR
 15791            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15792
 15793 3360-CHECK-FORM-LF-ATT-AGE.
 15794
 15795     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15796
 15797     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15798         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15799         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15800            IF PB-COMPANY-ID = 'NCL'
 15801                MOVE  ER-1913      TO  WS-ERROR
 15802                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15803            ELSE
 15804                MOVE  ER-1894      TO  WS-ERROR
 15805                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15806
 15807 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15808
 15809     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15810         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15811         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15812            IF PB-COMPANY-ID = 'NCL'
 15813                MOVE  ER-1914      TO  WS-ERROR
 15814                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15815            ELSE
 15816                MOVE  ER-1899      TO  WS-ERROR
 15817                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15818
 15819 3360-CHECK-FORM-LF-TERM-BAMT.
 15820
 15821     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15822         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15823         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 287
* EL050.cbl
 15824           IF  PB-COMPANY-ID = 'NCL'
 15825               MOVE  ER-1916       TO  WS-ERROR
 15826               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15827           ELSE
 15828               MOVE  ER-1902       TO  WS-ERROR
 15829               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15830
 15831     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15832                                    PB-I-LF-ALT-BENEFIT-AMT.
 15833
 15834     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15835         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15836         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15837             IF  PB-COMPANY-ID = 'NCL'
 15838                 MOVE  ER-1918     TO  WS-ERROR
 15839                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15840             ELSE
 15841                 MOVE  ER-1904     TO  WS-ERROR
 15842                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15843
 15844******************************************************************
 15845*                  3360-CHECK-FORM-AH-LIMITS                     *
 15846*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15847*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15848******************************************************************
 15849
 15850 3360-CHECK-FORM-AH-LIMITS.
 15851
 15852     IF NOT AH-FORM-MASTER-FOUND
 15853         GO TO 3999-END-EDIT.
 15854
 15855 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15856
 15857     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15858       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15859        WS-AH-JOINT-INDICATOR = 'J'  AND
 15860        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15861         IF PB-COMPANY-ID = 'NCL'
 15862            MOVE  ER-1912          TO  WS-ERROR
 15863            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15864         ELSE
 15865            MOVE  ER-1893          TO  WS-ERROR
 15866            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15867
 15868 3360-CHECK-FORM-AH-ATT-AGE.
 15869
 15870     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15871
 15872     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15873         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15874         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15875            IF PB-COMPANY-ID = 'NCL'
 15876                MOVE  ER-1913      TO  WS-ERROR
 15877                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15878            ELSE
 15879                MOVE  ER-1894      TO  WS-ERROR
 15880                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15881
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 288
* EL050.cbl
 15882 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15883
 15884     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15885         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15886         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15887            IF PB-COMPANY-ID = 'NCL'
 15888                MOVE  ER-1915      TO  WS-ERROR
 15889                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15890            ELSE
 15891                MOVE  ER-1900      TO  WS-ERROR
 15892                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15893
 15894 3360-CHECK-FORM-AH-TERM-BAMT.
 15895
 15896     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15897         FO-AH-MAX-TERM    GREATER THAN  +0
 15898         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15899             IF  PB-COMPANY-ID = 'NCL'
 15900                 MOVE  ER-1917     TO  WS-ERROR
 15901                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15902             ELSE
 15903                  MOVE  ER-1903    TO  WS-ERROR
 15904                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15905
 15906     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15907         FO-MAX-AH-AMT    GREATER THAN  +0
 15908         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15909             IF  PB-COMPANY-ID = 'NCL'
 15910                 MOVE  ER-1919     TO  WS-ERROR
 15911                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15912             ELSE
 15913                 MOVE  ER-1905     TO  WS-ERROR
 15914                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15915
 15916     GO TO 3999-END-EDIT.
 15917
 15918******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 289
* EL050.cbl
 15920 3400-edit-vin.
 15921
 15922     move spaces                 to hldi-pass-area
 15923     MOVE PB-I-VIN               TO WS-WORK-VIN
 15924     MOVE +8                     TO V2
 15925     MOVE ZEROS                  TO WS-VIN-TOTAL
 15926     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15927      (V1 > 17)
 15928        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15929           MOVE ER-3825          TO WS-ERROR
 15930           PERFORM 9900-ERROR-FORMAT
 15931                                 THRU 9900-EXIT
 15932        ELSE
 15933           IF V1 = 8
 15934              MOVE 10            TO V2
 15935           END-IF
 15936           IF V1 = 9
 15937              MOVE 0             TO V2
 15938           END-IF
 15939           IF V1 = 10
 15940              MOVE 9             TO V2
 15941           END-IF
 15942           IF WS-WORK-VIN (V1:1) NUMERIC
 15943              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15944               + (WS-WORK-VIN-N (V1) * V2)
 15945           ELSE
 15946              MOVE WS-WORK-VIN (V1:1)
 15947                            TO WS-HEX-BYTE
 15948              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15949              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15950               + (WS-NUM (V3) * V2)
 15951           END-IF
 15952           COMPUTE V2 = V2 - 1
 15953        END-IF
 15954     END-PERFORM
 15955     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15956     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15957        REMAINDER WS-VIN-REMAINDER
 15958     IF ((WS-WORK-VIN (9:1) = 'X')
 15959        AND (WS-VIN-REMAINDER = 10))
 15960                OR
 15961        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15962        if pb-company-id = 'VPP'
 15963           perform 3410-check-with-hldi
 15964                                 thru 3410-exit
 15965        end-if
 15966     ELSE
 15967        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15968           MOVE ER-3826          TO WS-ERROR
 15969           PERFORM 9900-ERROR-FORMAT
 15970                                 THRU 9900-EXIT
 15971        ELSE
 15972           MOVE ER-3827          TO WS-ERROR
 15973           PERFORM 9900-ERROR-FORMAT
 15974                                 THRU 9900-EXIT
 15975        END-IF
 15976     END-IF
 15977
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 290
* EL050.cbl
 15978     .
 15979 3400-exit.
 15980     exit.
 15981 3410-check-with-hldi.
 15982     move spaces                 to hldi-pass-area
 15983     move pb-i-vin               to pa-vin
 15984     perform 7785-call-hldi      thru 7785-exit
 15985*    display 'PA-VIN        ' PA-VIN
 15986*    display 'PA-ErrorCode  ' PA-ErrorCode
 15987*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15988*    display 'PA-ModelYear  ' PA-ModelYear
 15989*    display 'PA-MakeName   ' PA-MakeName
 15990*    display 'PA-ModelName  ' PA-ModelName
 15991*    display 'PA-SeriesName ' PA-SeriesName
 15992     if pa-errorcode (1:1) not = '0'
 15993        move spaces              to hldi-pass-area
 15994        move pb-i-vin            to pa-vin
 15995*       move pa-errordesc        to pa-seriesname
 15996*       perform 7786-call-hldim  thru 7786-exit
 15997*       display 'PA-VIN        ' PA-VIN
 15998*       display 'PA-ErrorCode  ' PA-ErrorCode
 15999*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16000*       display 'PA-ModelYear  ' PA-ModelYear
 16001*       display 'PA-MakeName   ' PA-MakeName
 16002*       display 'PA-ModelName  ' PA-ModelName
 16003*       display 'PA-SeriesName ' PA-SeriesName
 16004     end-if
 16005     .
 16006 3410-exit.
 16007     exit.
 16008******************************************************************
 16009*                  E D I T   C A N C E L                         *
 16010******************************************************************
 16011
 16012 3700-EDIT-CANCEL.
 16013     IF PB-COMPANY-ID = 'DMD'
 16014         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16015                                         WS-RES-MUNI-TAX
 16016                                         PB-CI-STATE-TAX
 16017                                         PB-CI-MUNI-TAX
 16018         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16019
 16020*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16021*       IF PB-ENTRY-BATCH  NUMERIC
 16022*          IF PB-CANCELLATION
 16023*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16024*          ELSE
 16025*             IF PB-ISSUE
 16026*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16027
 16028     IF PB-C-INT-ON-REFS NOT NUMERIC
 16029        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16030     END-IF
 16031*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16032*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16033
 16034     IF CM-ENTRY-STATUS = 'V'
 16035        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 291
* EL050.cbl
 16036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16037        GO TO 3999-END-EDIT.
 16038
 16039     IF CM-ENTRY-STATUS = 'D'
 16040        MOVE ER-2781             TO WS-ERROR
 16041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16042        GO TO 3999-END-EDIT.
 16043
 16044     IF CM-ENTRY-STATUS = 'U'
 16045        MOVE ER-2782             TO WS-ERROR
 16046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16047
 16048***************************************************************
 16049*                                                             *
 16050*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16051*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16052*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16053*   OF ANOTHER COVERAGE.                                      *
 16054*                                                             *
 16055***************************************************************
 16056
 16057     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16058                                    PB-C-AH-CANCEL-VOID-SW.
 16059
 16060     if pb-company-id = 'DCC' or 'VPP'
 16061        if ((pb-ci-lf-cancel-amt <> zeros)
 16062                       or
 16063            (pb-ci-ah-cancel-amt <> zeros))
 16064           MOVE ER-3068          TO WS-ERROR
 16065           PERFORM 9900-ERROR-FORMAT
 16066                                 THRU 9900-EXIT
 16067           GO TO 3999-END-EDIT
 16068        end-if
 16069     end-if
 16070     IF PB-C-LF-CANCEL-AMT = ZERO
 16071        NEXT SENTENCE
 16072     ELSE
 16073        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16074           AND
 16075           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16076               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16077               MOVE ER-2745           TO WS-ERROR
 16078               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16079
 16080     IF PB-C-AH-CANCEL-AMT = ZERO
 16081        NEXT SENTENCE
 16082     ELSE
 16083        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16084           AND
 16085           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16086               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16087               MOVE ER-2745           TO WS-ERROR
 16088               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16089
 16090     IF WS-LF-EARNINGS-CALC = '4'
 16091        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16092
 16093     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 292
* EL050.cbl
 16094     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16095     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16096     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16097     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16098     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16099
 16100     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16101                                      PB-C-AH-REF-CALC.
 16102     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16103
 16104******************************************************************
 16105*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16106*             TO VALIDATE COVERAGE.                              *
 16107******************************************************************
 16108
 16109     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16110        PB-C-LF-CANCEL-AMT = ZEROS
 16111          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16112      ELSE
 16113          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16114
 16115     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16116        PB-C-AH-CANCEL-AMT = ZEROS
 16117          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16118      ELSE
 16119          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16120
 16121     EVALUATE TRUE
 16122         WHEN PB-CANCEL-FORCE             OR
 16123              PB-CANCEL-DATE-FORCED       OR
 16124              PB-FORCE-OFF
 16125                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16126                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16127                  END-IF
 16128         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16129               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16130              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16131                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16132         WHEN OTHER
 16133              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16134                 MOVE ER-2794              TO WS-ERROR
 16135              ELSE
 16136                 MOVE ER-2749              TO WS-ERROR
 16137              END-IF
 16138              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16139     END-EVALUATE.
 16140
 16141
 16142*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16143*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16144*            MOVE  ER-1909            TO  WS-ERROR
 16145*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16146*        ELSE
 16147*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16148
 16149     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16150     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16151        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 293
* EL050.cbl
 16152     ELSE
 16153        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16154     END-IF
 16155     .
 16156 3705-EDIT-CANCEL-DT.
 16157
 16158     IF LF-COVERAGE-CANCELLED
 16159        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16160         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16161         MOVE WS-CURRENT-MONTH-END
 16162                                 TO DC-BIN-DATE-2
 16163         SET ELAPSED-BETWEEN-BIN TO TRUE
 16164*        MOVE 1                  TO DC-OPTION-CODE
 16165         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16166         IF DATE-CONVERSION-ERROR
 16167            NEXT SENTENCE
 16168          ELSE
 16169             IF DC-ELAPSED-DAYS GREATER +180
 16170                IF PB-CANCEL-DATE-FORCED  OR
 16171                   PB-CANCEL-DATE-FORCED-NO-FEE
 16172                      MOVE ER-2751  TO WS-ERROR
 16173                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16174                 ELSE
 16175                   MOVE ER-2752  TO WS-ERROR
 16176                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16177
 16178     IF AH-COVERAGE-CANCELLED
 16179        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16180         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16181         MOVE WS-CURRENT-MONTH-END
 16182                                 TO DC-BIN-DATE-2
 16183         SET ELAPSED-BETWEEN-BIN TO TRUE
 16184*        MOVE 1                  TO DC-OPTION-CODE
 16185         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16186         IF DATE-CONVERSION-ERROR
 16187            NEXT SENTENCE
 16188          ELSE
 16189             IF DC-ELAPSED-DAYS GREATER +180
 16190                IF PB-CANCEL-DATE-FORCED OR
 16191                   PB-CANCEL-DATE-FORCED-NO-FEE
 16192                      MOVE ER-2751  TO WS-ERROR
 16193                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16194                 ELSE
 16195                   MOVE ER-2752  TO WS-ERROR
 16196                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16197
 16198     IF WS-ERROR = ER-2752
 16199        AND (PB-COMPANY-ID = 'ABL'
 16200         OR  PB-COMPANY-ID = 'FGL'
 16201         OR  PB-COMPANY-ID = 'IST'
 16202         OR  PB-COMPANY-ID = 'JHL'
 16203         OR  PB-COMPANY-ID = 'LAP'
 16204         OR  PB-COMPANY-ID = 'LBL'
 16205         OR  PB-COMPANY-ID = 'NCB'
 16206         OR  PB-COMPANY-ID = 'NLI'
 16207         OR  PB-COMPANY-ID = 'OFI'
 16208         OR  PB-COMPANY-ID = 'PLI'
 16209         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 294
* EL050.cbl
 16210         OR  PB-COMPANY-ID = 'TIC'
 16211         OR  PB-COMPANY-ID = 'HER'
 16212         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16213         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16214            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16215            MOVE ER-2762     TO WS-ERROR
 16216            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16217
 16218     IF LF-COVERAGE-CANCELLED
 16219        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16220        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16221             MOVE ER-2733         TO WS-ERROR
 16222             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16223
 16224     IF AH-COVERAGE-CANCELLED
 16225        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16226        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16227              MOVE ER-2733        TO WS-ERROR
 16228              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16229
 16230     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16231        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16232        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16233           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16234            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16235              IF PB-COMPANY-ID NOT = 'LAP'
 16236               MOVE ER-2704            TO WS-ERROR
 16237               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16238
 16239     IF CERT-WAS-NOT-FOUND
 16240         GO TO 3999-END-EDIT.
 16241
 16242     IF PB-COMPANY-ID EQUAL 'CDC'
 16243        IF LF-COVERAGE-CANCELLED
 16244           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16245            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16246            MOVE PB-C-LF-CANCEL-DT
 16247                                 TO DC-BIN-DATE-2
 16248            SET ELAPSED-BETWEEN-BIN TO TRUE
 16249*           MOVE 1               TO DC-OPTION-CODE
 16250            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16251            IF DATE-CONVERSION-ERROR
 16252               NEXT SENTENCE
 16253             ELSE
 16254                IF DC-ELAPSED-DAYS GREATER +60
 16255                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16256
 16257     IF PB-COMPANY-ID EQUAL 'CDC'
 16258        IF AH-COVERAGE-CANCELLED
 16259           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16260            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16261            MOVE PB-C-AH-CANCEL-DT
 16262                                 TO DC-BIN-DATE-2
 16263            MOVE +0              TO DC-ELAPSED-DAYS
 16264                                    DC-ELAPSED-MONTHS
 16265            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16266*           MOVE 1               TO DC-OPTION-CODE
 16267            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 295
* EL050.cbl
 16268            IF DATE-CONVERSION-ERROR
 16269               NEXT SENTENCE
 16270             ELSE
 16271                IF DC-ELAPSED-DAYS GREATER +60
 16272                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16273
 16274     MOVE +0                     TO DC-ELAPSED-DAYS
 16275                                    DC-ELAPSED-MONTHS.
 16276
 16277     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16278        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16279          MOVE 'Z'                TO PB-CI-OB-FLAG
 16280          MOVE ER-2767            TO WS-ERROR
 16281          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16282          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16283          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16284          GO TO 3775-OVER-REF-CHK
 16285        ELSE
 16286          MOVE ZEROS              TO PB-CI-LIVES
 16287                                     PB-C-LIVES
 16288          IF PB-CI-OB-FLAG NOT = 'B'
 16289             MOVE SPACE           TO PB-CI-OB-FLAG.
 16290
 16291     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16292         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16293     ELSE
 16294         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16295
 16296     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16297        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16298            MOVE ER-2760         TO WS-ERROR
 16299            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16300
 16301     IF LF-COVERAGE-CANCELLED
 16302        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16303         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16304            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16305               MOVE ER-2774       TO WS-ERROR
 16306               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16307
 16308     IF AH-COVERAGE-CANCELLED
 16309        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16310         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16311            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16312               MOVE ER-2775       TO WS-ERROR
 16313               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16314
 16315     IF LF-COVERAGE-CANCELLED
 16316        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16317         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16318            MOVE ER-2776         TO WS-ERROR
 16319            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16320
 16321     IF AH-COVERAGE-CANCELLED
 16322        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16323         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16324            MOVE ER-2777         TO WS-ERROR
 16325            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 296
* EL050.cbl
 16326
 16327     IF LF-COVERAGE-CANCELLED
 16328        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16329        if pb-ci-lf-expire-dt = low-values or spaces
 16330           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16331           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16332           MOVE PB-CI-EXTENTION-DAYS
 16333                                 TO DC-ELAPSED-DAYS
 16334           SET BIN-PLUS-ELAPSED  TO TRUE
 16335           PERFORM 8500-DATE-CONVERT
 16336                                 THRU 8500-EXIT
 16337           IF DATE-CONVERSION-ERROR
 16338              move low-values    to dc-bin-date-2
 16339           end-if
 16340        else
 16341           move pb-ci-lf-expire-dt
 16342                                 to dc-bin-date-2
 16343        end-if
 16344        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16345           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16346                             OR  'FIA'
 16347              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16348           ELSE
 16349              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16350              MOVE ER-2731       TO WS-ERROR
 16351              PERFORM 9900-ERROR-FORMAT
 16352                                 THRU 9900-EXIT
 16353           end-if
 16354        end-if
 16355     end-if
 16356*    IF LF-COVERAGE-CANCELLED
 16357*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16358*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16359*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16360*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16361*        SET BIN-PLUS-ELAPSED      TO TRUE
 16362*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16363*        IF DATE-CONVERSION-ERROR
 16364*           NEXT SENTENCE
 16365*         ELSE
 16366*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16367*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16368*                            OR  'FIA'
 16369*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16370*              ELSE
 16371*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16372*               MOVE ER-2731       TO WS-ERROR
 16373*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16374     .
 16375 3705-EDIT-AH-CANCEL-DT.
 16376     IF AH-COVERAGE-CANCELLED
 16377        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16378        if pb-ci-AH-expire-dt = low-values or spaces
 16379           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16380           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16381           MOVE PB-CI-EXTENTION-DAYS
 16382                                 TO DC-ELAPSED-DAYS
 16383           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 297
* EL050.cbl
 16384           PERFORM 8500-DATE-CONVERT
 16385                                 THRU 8500-EXIT
 16386           IF DATE-CONVERSION-ERROR
 16387              move low-values    to dc-bin-date-2
 16388           end-if
 16389        else
 16390           move pb-ci-ah-expire-dt
 16391                                 to dc-bin-date-2
 16392        end-if
 16393        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16394           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16395                             OR  'FIA'
 16396              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16397           ELSE
 16398              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16399              MOVE ER-2771       TO WS-ERROR
 16400              PERFORM 9900-ERROR-FORMAT
 16401                                 THRU 9900-EXIT
 16402           end-if
 16403        end-if
 16404     end-if
 16405*    IF AH-COVERAGE-CANCELLED
 16406*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16407*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16408*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16409*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16410**       MOVE 6                    TO DC-OPTION-CODE
 16411*        SET BIN-PLUS-ELAPSED      TO TRUE
 16412*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16413*        IF DATE-CONVERSION-ERROR
 16414*           NEXT SENTENCE
 16415*         ELSE
 16416*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16417*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16418*                             OR 'FIA'
 16419*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16420*             ELSE
 16421*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16422*              MOVE ER-2771       TO WS-ERROR
 16423*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16424     .
 16425 3705-EDIT-CONTINUED.
 16426
 16427*    IF LF-COVERAGE-CANCELLED
 16428*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16429*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16430*            MOVE ER-2727         TO WS-ERROR
 16431*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16432*
 16433*    IF AH-COVERAGE-CANCELLED
 16434*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16435*        IF PB-COMPANY-ID = 'ACE'
 16436*           MOVE ER-2727        TO WS-ERROR
 16437*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16438*        ELSE
 16439*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16440*              MOVE ER-2727     TO WS-ERROR
 16441*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 298
* EL050.cbl
 16442
 16443     IF PB-COMPANY-ID = 'ACE'
 16444       IF AH-COVERAGE-CANCELLED
 16445         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16446           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16447              MOVE ER-2732      TO WS-ERROR
 16448              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16449
 16450     IF PB-COMPANY-ID      EQUAL   'HER'
 16451        IF WS-ERROR        EQUAL   ER-2727
 16452            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16453            MOVE  ER-2725          TO  WS-ERROR
 16454            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16455
 16456     IF PB-C-CLAIM-CREATED-CANCEL
 16457            MOVE ER-2748         TO WS-ERROR
 16458            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16459
 16460     IF PB-C-LAST-NAME NOT = SPACES
 16461         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16462            MOVE ER-2747         TO WS-ERROR
 16463            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16464
 16465 3710-EDIT-LUMP-SUM-PRIOR.
 16466
 16467     IF AH-COVERAGE-CANCELLED
 16468         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16469             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16470                MOVE ER-2735    TO WS-ERROR
 16471                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16472
 16473     IF LF-COVERAGE-CANCELLED
 16474         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16475             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16476                MOVE ER-2735    TO WS-ERROR
 16477                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16478
 16479 3710-EDIT-PRIOR-DEATH.
 16480
 16481*    IF LF-COVERAGE-CANCELLED
 16482*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16483*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16484*           (NOT PB-CI-OB)
 16485*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16486*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16487*                   MOVE ER-2732  TO WS-ERROR
 16488*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16489*
 16490*    IF AH-COVERAGE-CANCELLED
 16491*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16492*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16493*           (NOT PB-CI-OB)
 16494*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16495*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16496*                   MOVE ER-2732  TO WS-ERROR
 16497*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16498
 16499     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 299
* EL050.cbl
 16500         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16501            (NOT PB-COMP-LF-CANCEL)
 16502             NEXT SENTENCE
 16503         ELSE
 16504           IF PB-C-LF-CANCEL-VOIDED
 16505              NEXT SENTENCE
 16506           ELSE
 16507              MOVE ER-2753      TO WS-ERROR
 16508              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16509
 16510     IF CANCEL-FUTURE-DT
 16511         GO TO 3999-END-EDIT.
 16512
 16513 3715-GET-REMAIN-TERM-LF.
 16514
 16515     IF NO-LF-BENEFIT-MATCH  OR
 16516        WS-LF-BENEFIT-CD = ZEROS
 16517        GO TO 3730-GET-AH-REMAIN-TERM.
 16518
 16519     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16520     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16521     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16522     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16523     MOVE PB-SV-STATE            TO CP-STATE.
 16524     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16525     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16526     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16527     MOVE '2'                    TO CP-PROCESS-TYPE.
 16528     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16529     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16530     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16531     IF (PB-COMPANY-ID = 'CID')
 16532        AND (CP-STATE-STD-ABBRV = 'WI')
 16533        MOVE '7'                 TO CP-REM-TERM-METHOD
 16534        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16535     ELSE
 16536        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16537        MOVE WS-REM-TRM-CALC-OPTION
 16538                                 TO CP-REM-TRM-CALC-OPTION
 16539     END-IF
 16540**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16541     IF (PB-COMPANY-ID = 'CID')
 16542        AND (CP-STATE-STD-ABBRV = 'MO')
 16543        AND (PB-CERT-EFF-DT >= X'9B41')
 16544        AND (PB-CERT-EFF-DT <= X'A2FB')
 16545        MOVE '7'                 TO CP-REM-TERM-METHOD
 16546        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16547     END-IF
 16548     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16549                                    CP-LOAN-TERM.
 16550     IF CP-TRUNCATED-LIFE
 16551        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16552
 16553     IF CP-TERM-IS-DAYS
 16554         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16555     ELSE
 16556         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16557
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 300
* EL050.cbl
 16558     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16559
 16560     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16561
 16562     IF LF-COVERAGE-CANCELLED
 16563        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16564        NEXT SENTENCE
 16565      ELSE
 16566          GO TO 3730-GET-AH-REMAIN-TERM.
 16567
 16568 3720-GET-LF-REFUND.
 16569
 16570     IF PB-C-LF-CANCEL-VOIDED
 16571        GO TO 3730-GET-AH-REMAIN-TERM
 16572     end-if
 16573
 16574     IF PB-COMPANY-ID EQUAL 'BOA'
 16575         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16576         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16577         GO TO 3730-GET-AH-REMAIN-TERM.
 16578
 16579     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16580        (WS-AH-SPECIAL-CALC-CD = 'M')
 16581         MOVE ER-2767            TO WS-ERROR
 16582         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16583         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16584         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16585         GO TO 3780-UPDATE-CANCEL-CERT.
 16586
 16587*    if (ws-lf-earnings-calc = '6')
 16588*       or (pb-c-lf-refund-override = '6')
 16589*       move cp-remaining-term-1 to cp-remaining-term-2
 16590*    end-if
 16591     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16592
 16593     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16594     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16595     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16596     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16597     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16598     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16599     IF PB-COMPANY-ID = 'DCC'
 16600        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16601        IF PDEF-MASTER-FOUND
 16602           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16603              (V1 > +8)
 16604              OR (PD-PROD-CODE (V1) = 'L')
 16605           END-PERFORM
 16606           IF V1 < +9
 16607              MOVE PD-MAX-AMT (V1)
 16608                           TO CP-R-MAX-TOT-BEN
 16609                              EC-AM-LF-MAX-TOT-BEN
 16610           END-IF
 16611        ELSE
 16612        MOVE ' '                 TO PDEF-MASTER-SW
 16613        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16614        MOVE PB-STATE            TO ERPDEF-STATE
 16615        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 301
* EL050.cbl
 16616           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16617        END-IF
 16618        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16619        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16620        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16621        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16622        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16623        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16624        IF PDEF-MASTER-FOUND
 16625           MOVE 'N'              TO PDEF-MASTER-SW
 16626           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16627           IF PDEF-MASTER-FOUND
 16628              IF (ERPDEF-KEY-SAVE (1:16) =
 16629                           PD-CONTROL-PRIMARY (1:16))
 16630                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16631                 CONTINUE
 16632              ELSE
 16633                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16634                 IF (ERPDEF-KEY-SAVE (1:16) =
 16635                           PD-CONTROL-PRIMARY (1:16))
 16636                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16637                    CONTINUE
 16638                 ELSE
 16639                    MOVE 'N'     TO PDEF-MASTER-SW
 16640                 END-IF
 16641              END-IF
 16642
 16643              IF PDEF-MASTER-FOUND
 16644                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16645                    (V1 > +8)
 16646                    OR (PD-PROD-CODE (V1) = 'L')
 16647                 END-PERFORM
 16648                 IF V1 < +9
 16649                    MOVE PD-MAX-AMT (V1)
 16650                                 TO CP-R-MAX-TOT-BEN
 16651                                    EC-AM-LF-MAX-TOT-BEN
 16652                 END-IF
 16653              END-IF
 16654           END-IF
 16655           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16656        END-IF
 16657        END-IF
 16658     END-IF
 16659     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16660
 16661     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16662
 16663     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16664                                    PB-C-LF-REM-TERM.
 16665
 16666     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16667     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16668
 16669     IF PB-COMPANY-ID EQUAL 'FLC'
 16670        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16671           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16672           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16673                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 302
* EL050.cbl
 16674                    - CM-LF-ITD-DEATH-AMT
 16675           IF PB-C-LF-REF-CALC LESS THAN +0
 16676              MOVE +0            TO PB-C-LF-REF-CALC
 16677              GO TO 3730-GET-AH-REMAIN-TERM
 16678           ELSE
 16679              GO TO 3730-GET-AH-REMAIN-TERM.
 16680
 16681     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16682                            OR '4' OR '5' OR '6' OR '8'
 16683                            OR '9' OR 'G'
 16684        MOVE PB-C-LF-REFUND-OVERRIDE
 16685                                 TO CP-EARNING-METHOD.
 16686
 16687     if pb-company-id = 'AHL'
 16688        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16689        if cp-class-code = spaces
 16690           move zeros            to cp-class-code
 16691        end-if
 16692     ELSE
 16693        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16694     END-IF
 16695*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16696     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16697     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16698                                    CP-RATING-BENEFIT-AMT.
 16699     IF CP-STATE-STD-ABBRV = 'OR'
 16700         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16701                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16702     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16703     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16704     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16705     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16706     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16707     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16708     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16709     IF WS-DEFAULT-APR NOT NUMERIC
 16710         MOVE ZEROS TO WS-DEFAULT-APR.
 16711****   N O T E   ****
 16712*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16713*      THE OH HARD CODING IN ELCRFNDP
 16714
 16715     IF PB-COMPANY-ID = 'CID'
 16716        IF CP-STATE-STD-ABBRV = 'OH'
 16717           MOVE WS-LF-EARNINGS-CALC
 16718                                 TO CP-EARNING-METHOD
 16719        END-IF
 16720     END-IF
 16721
 16722****   N O T E   ****
 16723
 16724*    IF CP-EARN-AS-NET-PAY
 16725*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16726*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16727*               MOVE WS-DEFAULT-APR
 16728*                                TO  CP-LOAN-APR
 16729*               MOVE ER-3780     TO  WS-ERROR
 16730*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16731*           ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 303
* EL050.cbl
 16732*               MOVE ER-3781     TO  WS-ERROR
 16733*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16734*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16735     move ' '                    to cp-ext-days-calc
 16736     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16737
 16738     IF CP-REFUND-TYPE-USED NOT = SPACE
 16739         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16740
 16741     IF CP-ERROR-RATE-IS-ZERO OR
 16742        CP-ERROR-RATE-NOT-FOUND
 16743        MOVE ER-2740             TO WS-ERROR
 16744        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16745
 16746     IF CP-ERROR-RATE-FILE-NOTOPEN
 16747        MOVE ER-2617             TO WS-ERROR
 16748        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16749
 16750     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16751        AND PB-CI-ENTRY-STATUS = 'M'
 16752        MOVE +0                  TO PB-C-LF-REF-CALC
 16753     ELSE
 16754        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16755     END-IF
 16756
 16757     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16758         GO TO 3730-GET-AH-REMAIN-TERM.
 16759
 16760*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16761*       ADD +1                   TO PB-C-LF-REM-TERM
 16762*                                   CP-REMAINING-TERM
 16763*                                   CP-ORIGINAL-TERM.
 16764
 16765     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16766     MOVE '2'                    TO CP-EARNING-METHOD
 16767                                    CP-RATING-METHOD.
 16768     IF PB-COMPANY-ID = 'CID'
 16769        IF (CP-STATE-STD-ABBRV = 'MN')
 16770           AND (PB-CERT-EFF-DT > X'A4FF')
 16771           AND (WS-LF-EARNINGS-CALC = 'B')
 16772           MOVE '5'              TO CP-EARNING-METHOD
 16773           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16774        END-IF
 16775     END-IF
 16776     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16777                                        CP-REMAINING-BENEFIT
 16778                                        CP-RATING-BENEFIT-AMT.
 16779     IF CP-STATE-STD-ABBRV = 'OR'
 16780         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16781                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16782     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16783     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16784
 16785     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16786
 16787     IF CP-ERROR-RATE-IS-ZERO OR
 16788        CP-ERROR-RATE-NOT-FOUND
 16789        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 304
* EL050.cbl
 16790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16791
 16792     IF CP-ERROR-RATE-FILE-NOTOPEN
 16793        MOVE ER-2617             TO WS-ERROR
 16794        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16795
 16796     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16797
 16798******************************************************************
 16799
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 305
* EL050.cbl
 16801 3730-GET-AH-REMAIN-TERM.
 16802     IF NO-AH-BENEFIT-MATCH  OR
 16803        WS-AH-BENEFIT-CD = ZEROS
 16804         GO TO 3770-CHECK-REFUNDS.
 16805
 16806     IF PB-CI-AH-LUMP-SUM-DISAB
 16807         IF  PB-C-AH-CANCEL-AMT = ZERO
 16808            IF NOT PB-COMP-AH-CANCEL
 16809             GO TO 3770-CHECK-REFUNDS.
 16810
 16811     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16812     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16813     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16814     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16815     MOVE PB-SV-STATE            TO CP-STATE.
 16816     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16817     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16818     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16819     MOVE '2'                    TO CP-PROCESS-TYPE.
 16820     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16821     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16822     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16823     IF (PB-COMPANY-ID = 'CID')
 16824        AND (CP-STATE-STD-ABBRV = 'WI')
 16825        MOVE '7'                 TO CP-REM-TERM-METHOD
 16826        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16827     ELSE
 16828        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16829        MOVE WS-REM-TRM-CALC-OPTION
 16830                                 TO CP-REM-TRM-CALC-OPTION
 16831     END-IF
 16832     IF (PB-COMPANY-ID = 'CID')
 16833        AND (CP-STATE-STD-ABBRV = 'MO')
 16834        AND (PB-CERT-EFF-DT >= X'9B41')
 16835        AND (PB-CERT-EFF-DT <= X'A2FB')
 16836        MOVE '7'                 TO CP-REM-TERM-METHOD
 16837        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16838     END-IF
 16839     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16840                                    CP-LOAN-TERM.
 16841     IF NOT CP-TERM-IS-DAYS
 16842         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16843
 16844     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16845
 16846     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16847
 16848     IF AH-COVERAGE-CANCELLED
 16849        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16850        NEXT SENTENCE
 16851      ELSE
 16852         GO TO 3770-CHECK-REFUNDS.
 16853
 16854 3740-GET-AH-REFUND.
 16855
 16856     IF PB-C-AH-CANCEL-VOIDED
 16857        GO TO 3780-UPDATE-CANCEL-CERT
 16858     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 306
* EL050.cbl
 16859
 16860     IF PB-COMPANY-ID = 'BOA'
 16861         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16862         GO TO 3770-CHECK-REFUNDS.
 16863
 16864     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16865*    MOVE ' '                    TO DC-OPTION-CODE
 16866     SET BIN-TO-GREG             TO TRUE
 16867     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16868     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16869                                    PB-C-AH-REM-TERM.
 16870     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16871     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16872
 16873     IF PB-COMPANY-ID EQUAL 'FLC'
 16874        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16875           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16876           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16877                    - CM-AH-ITD-AH-PMT)
 16878           IF PB-C-AH-REF-CALC LESS THAN +0
 16879              MOVE +0            TO PB-C-AH-REF-CALC
 16880              GO TO 3770-CHECK-REFUNDS
 16881           ELSE
 16882              GO TO 3770-CHECK-REFUNDS.
 16883
 16884     IF PB-COMPANY-ID = 'DCC'
 16885        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16886            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16887           MOVE 'S'              TO CP-EARNING-METHOD
 16888        END-IF
 16889     END-IF
 16890     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16891                            OR '4' OR '5' OR '6' OR '8'
 16892                            OR '9' OR 'G' OR 'S'
 16893        MOVE PB-C-AH-REFUND-OVERRIDE
 16894                                 TO CP-EARNING-METHOD.
 16895
 16896     if pb-company-id = 'AHL'
 16897        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16898        if cp-class-code = spaces
 16899           move zeros            to cp-class-code
 16900        end-if
 16901     ELSE
 16902        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16903     END-IF
 16904*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16905     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16906     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16907                                    CP-RATING-BENEFIT-AMT.
 16908     IF CP-STATE-STD-ABBRV = 'OR'
 16909         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16910                                         PB-CI-AH-TERM.
 16911     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16912     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16913     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16914     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16915     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16916     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 307
* EL050.cbl
 16917
 16918     IF CP-STATE-STD-ABBRV = 'OH'
 16919        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16920                                AND 'CID' AND 'DCC' and 'VPP'
 16921                                AND 'AHL')
 16922           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16923              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16924              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16925              MOVE '6' TO CP-EARNING-METHOD
 16926           END-IF
 16927        END-IF
 16928        IF PB-COMPANY-ID = 'CID'
 16929           IF NO-LIFE-COVERAGE
 16930              IF CP-CRITICAL-PERIOD
 16931                 MOVE '2'       TO CP-EARNING-METHOD
 16932              ELSE
 16933                 MOVE '6'       TO CP-EARNING-METHOD
 16934              END-IF
 16935           ELSE
 16936              IF WS-LF-COVERAGE-TYPE = 'L'
 16937                 MOVE '2'       TO CP-EARNING-METHOD
 16938              ELSE
 16939                 IF (PB-CI-LF-TERM > +60) OR
 16940                    (WS-LF-EARNINGS-CALC = '5')
 16941                    IF CP-CRITICAL-PERIOD
 16942                       MOVE '2'  TO CP-EARNING-METHOD
 16943                    ELSE
 16944                       MOVE '6'  TO CP-EARNING-METHOD
 16945                    END-IF
 16946                 ELSE
 16947                    MOVE '1'     TO CP-EARNING-METHOD
 16948                 END-IF
 16949              END-IF
 16950           END-IF
 16951        END-IF
 16952     END-IF
 16953
 16954*    IF CP-STATE-STD-ABBRV = 'VA'
 16955*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16956*          IF CP-ORIGINAL-TERM GREATER 61
 16957*             MOVE '6' TO CP-EARNING-METHOD
 16958*          ELSE
 16959*             MOVE '1' TO CP-EARNING-METHOD.
 16960
 16961     IF WS-DEFAULT-APR NOT NUMERIC
 16962         MOVE ZEROS TO WS-DEFAULT-APR.
 16963     IF CP-EARN-AS-NET-PAY
 16964         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16965            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16966                MOVE WS-DEFAULT-APR
 16967                                 TO  CP-LOAN-APR
 16968                MOVE ER-3780     TO  WS-ERROR
 16969                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16970            ELSE
 16971                MOVE ER-3781     TO  WS-ERROR
 16972                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16973     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16974     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 308
* EL050.cbl
 16975        AND CP-CANCEL-REASON = 'R'
 16976        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16977        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16978     END-IF
 16979     IF PB-COMPANY-ID = 'DCC'
 16980        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16981        AND (CP-EARNING-METHOD = 'D')
 16982        AND (CP-CANCEL-REASON NOT = 'R')
 16983        CONTINUE
 16984     ELSE
 16985        GO TO 3750-CONTINUE
 16986     END-IF
 16987     MOVE ' '                    TO DD-IU-SW
 16988     IF NOT PDEF-MASTER-FOUND
 16989        MOVE ' '                 TO PDEF-MASTER-SW
 16990        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16991        MOVE PB-STATE            TO ERPDEF-STATE
 16992        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16993           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16994        END-IF
 16995        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16996        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16997        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16998        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16999        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17000        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17001        IF PDEF-MASTER-FOUND
 17002           MOVE 'N'              TO PDEF-MASTER-SW
 17003           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17004           IF PDEF-MASTER-FOUND
 17005              IF (ERPDEF-KEY-SAVE (1:16) =
 17006                           PD-CONTROL-PRIMARY (1:16))
 17007                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17008                 CONTINUE
 17009              ELSE
 17010                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17011                 IF (ERPDEF-KEY-SAVE (1:16) =
 17012                           PD-CONTROL-PRIMARY (1:16))
 17013                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17014                    CONTINUE
 17015                 ELSE
 17016                    MOVE ER-2740 TO WS-ERROR
 17017                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17018                    GO TO 3770-CHECK-REFUNDS
 17019                 END-IF
 17020              END-IF
 17021           END-IF
 17022           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17023        END-IF
 17024     END-IF
 17025     IF PDEF-MASTER-FOUND
 17026        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17027           (V1 > +8)
 17028           OR (PD-PROD-CODE (V1) = 'I')
 17029        END-PERFORM
 17030        IF V1 < +9
 17031           SET DD-IU-PRESENT        TO TRUE
 17032        END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 309
* EL050.cbl
 17033        IF WS-AH-DCC-TRUNC = 'T'
 17034           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17035        ELSE
 17036           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17037        END-IF
 17038        EVALUATE TRUE
 17039           WHEN WS-TERM > +168
 17040              MOVE 15               TO V1
 17041           WHEN WS-TERM > +156
 17042              MOVE 14               TO V1
 17043           WHEN WS-TERM > +144
 17044              MOVE 13               TO V1
 17045           WHEN WS-TERM > +132
 17046              MOVE 12               TO V1
 17047           WHEN WS-TERM > +120
 17048              MOVE 11               TO V1
 17049           WHEN WS-TERM > +108
 17050              MOVE 10               TO V1
 17051           WHEN WS-TERM > +96
 17052              MOVE 9                TO V1
 17053           WHEN WS-TERM > +84
 17054              MOVE 8                TO V1
 17055           WHEN WS-TERM > +72
 17056              MOVE 7                TO V1
 17057           WHEN WS-TERM > +60
 17058              MOVE 6                TO V1
 17059           WHEN WS-TERM > +48
 17060              MOVE 5                TO V1
 17061           WHEN WS-TERM > +36
 17062              MOVE 4                TO V1
 17063           WHEN WS-TERM > +24
 17064              MOVE 3                TO V1
 17065           WHEN WS-TERM > +12
 17066              MOVE 2                TO V1
 17067           WHEN OTHER
 17068              MOVE 1                TO V1
 17069        END-EVALUATE
 17070
 17071        EVALUATE TRUE
 17072*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17073*             < +13)
 17074*             AND (DD-IU-PRESENT)
 17075*             MOVE 2                TO V2
 17076*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17077*             MOVE 1                TO V2
 17078           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17079              MOVE 2                TO V2
 17080           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17081              MOVE 3                TO V2
 17082           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17083              MOVE 4                TO V2
 17084           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17085              MOVE 5                TO V2
 17086           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17087              MOVE 6                TO V2
 17088           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17089              MOVE 7                TO V2
 17090           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 310
* EL050.cbl
 17091              MOVE 8                TO V2
 17092           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17093              MOVE 9                TO V2
 17094           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17095              MOVE 10               TO V2
 17096           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17097              MOVE 11               TO V2
 17098           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17099              MOVE 12               TO V2
 17100           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17101              MOVE 13               TO V2
 17102           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17103              MOVE 14               TO V2
 17104           WHEN OTHER
 17105              MOVE 15               TO V2
 17106        END-EVALUATE
 17107
 17108        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17109                                 TO CP-DDF-LO-FACT
 17110        MOVE PD-UEP-FACTOR (V1 V2)
 17111                                 TO CP-DDF-HI-FACT
 17112
 17113        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17114        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17115        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17116           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17117        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17118        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17119        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17120           + PD-1ST-YR-ADMIN-ALLOW
 17121
 17122        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17123*       IF PI-CLP-YN = 'Y'
 17124*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17125*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17126*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17127*       END-IF
 17128
 17129        IF DD-IU-PRESENT
 17130           MOVE 'I'              TO CP-EARNING-METHOD
 17131        END-IF
 17132        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17133                                     CP-CLP-RATE-UP
 17134        IF CP-IU-RATE-UP NOT = ZEROS
 17135           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17136              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17137           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17138              / (1 - WS-WORK-FACT)
 17139        END-IF
 17140     END-IF
 17141     .
 17142 3750-CONTINUE.
 17143     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17144
 17145     IF CP-REFUND-TYPE-USED NOT = SPACE
 17146         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17147
 17148     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 311
* EL050.cbl
 17149        CP-ERROR-RATE-NOT-FOUND
 17150        MOVE ER-2740             TO WS-ERROR
 17151        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17152
 17153     IF CP-ERROR-RATE-FILE-NOTOPEN
 17154        MOVE ER-2617             TO WS-ERROR
 17155        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17156     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17157        AND (PB-CI-ENTRY-STATUS = 'M')
 17158        MOVE +0                  TO PB-C-AH-REF-CALC
 17159     ELSE
 17160        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17161     END-IF
 17162     if pb-company-id = 'VPP'
 17163        MOVE cm-ah-clp           to cp-original-premium
 17164        move zeros               to cp-calc-refund
 17165        perform 7600-get-refund  thru 7600-exit
 17166        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17167           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17168        else
 17169           move zeros            to pb-c-ah-rfnd-clp
 17170        end-if
 17171        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17172           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17173           pb-ci-cancel-fee
 17174     end-if
 17175     IF PB-COMPANY-ID = 'DCC'
 17176        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17177        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17178        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17179        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17180        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17181        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17182        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17183        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17184*       if pb-c-cancel-amt < +0
 17185*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17186*       end-if
 17187*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17188     END-IF
 17189     .
 17190 3770-CHECK-REFUNDS.
 17191
 17192     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17193        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17194           MOVE ER-2766          TO WS-ERROR
 17195           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17196           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17197           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17198              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17199
 17200     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17201        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17202           MOVE ER-2766          TO WS-ERROR
 17203           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17204           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17205           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17206              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 312
* EL050.cbl
 17207
 17208     IF PB-COMP-LF-CANCEL
 17209        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17210        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17211           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17212              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17213
 17214     IF PB-COMP-AH-CANCEL
 17215        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17216        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17217           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17218              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17219
 17220     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17221             GIVING WS-UNSIGN-WRK1
 17222     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17223             GIVING WS-UNSIGN-WRK2.
 17224
 17225     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17226         MOVE ZERO TO WS-UNSIGN-WRK1.
 17227
 17228     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17229         MOVE ZERO TO WS-UNSIGN-WRK2.
 17230
 17231     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17232
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 313
* EL050.cbl
 17234
 17235 3772-CONTINUE.
 17236
 17237**********************************
 17238*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17239*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17240*** DOUBLES THE TOLERANCE AMOUNT.
 17241***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17242**********************************
 17243     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17244     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17245         IF WS-REF-REJECT-SW = SPACE
 17246             MOVE ER-2754        TO WS-ERROR
 17247             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17248           ELSE
 17249             MOVE ER-2736        TO WS-ERROR
 17250             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17251**********************************
 17252
 17253 3773-CONTINUE.
 17254
 17255     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17256        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17257           MOVE ER-2723          TO WS-ERROR
 17258           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17259
 17260     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17261        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17262           MOVE ER-2724          TO WS-ERROR
 17263           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17264
 17265     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17266         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17267             (1 + WS-LF-REFUND-OVS-PCT)
 17268     ELSE
 17269         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17270
 17271     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17272         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17273             (1 - WS-TOL-LF-REFUND-PCT)
 17274     ELSE
 17275         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17276
 17277     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17278        AND (PB-CI-ENTRY-STATUS = 'M')
 17279        AND (PB-C-LF-CANCEL-AMT > +0)
 17280        MOVE ER-3843             TO WS-ERROR
 17281        PERFORM 9900-ERROR-FORMAT
 17282                                 THRU 9900-EXIT
 17283     END-IF
 17284     EVALUATE TRUE
 17285        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17286           CONTINUE
 17287        WHEN PB-C-LF-CANCEL-AMT = +0
 17288                 AND PB-C-LF-REF-CALC > +0
 17289           CONTINUE
 17290        WHEN WS-LF-REFUND-OVS-AMT = 0
 17291                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 314
* EL050.cbl
 17292           CONTINUE
 17293        WHEN OTHER
 17294           IF WS-TOL-LF-REFUND  = +0
 17295              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17296           END-IF
 17297           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17298                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17299                          (PB-C-LF-CANCEL-AMT))
 17300              CONTINUE
 17301           ELSE
 17302              IF WS-LF-REFUND-OVS-AMT = +0
 17303                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17304              END-IF
 17305              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17306                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17307                                       PB-C-LF-CANCEL-AMT)
 17308                 CONTINUE
 17309              ELSE
 17310                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17311                   MOVE ER-2754   TO  WS-ERROR
 17312                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17313                 ELSE
 17314                    MOVE ER-2736   TO  WS-ERROR
 17315                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17316                 END-IF
 17317              END-IF
 17318           END-IF
 17319     END-EVALUATE.
 17320
 17321     EVALUATE TRUE
 17322        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17323           CONTINUE
 17324        WHEN PB-C-LF-CANCEL-AMT = +0
 17325                 AND PB-C-LF-REF-CALC > +0
 17326           CONTINUE
 17327        WHEN OTHER
 17328           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17329               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17330              CONTINUE
 17331           ELSE
 17332              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17333               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17334                CONTINUE
 17335              ELSE
 17336                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17337                     MOVE ER-2754   TO  WS-ERROR
 17338                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17339                 ELSE
 17340                     MOVE ER-2736   TO  WS-ERROR
 17341                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17342                 END-IF
 17343              END-IF
 17344           END-IF
 17345     END-EVALUATE.
 17346
 17347     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17348         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17349             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 315
* EL050.cbl
 17350     ELSE
 17351         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17352
 17353     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17354         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17355             (1 - WS-TOL-AH-REFUND-PCT)
 17356     ELSE
 17357         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17358
 17359     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17360        AND (PB-CI-ENTRY-STATUS = 'M')
 17361        AND (PB-C-AH-CANCEL-AMT > +0)
 17362        MOVE ER-3843             TO WS-ERROR
 17363        PERFORM 9900-ERROR-FORMAT
 17364                                 THRU 9900-EXIT
 17365     END-IF
 17366     EVALUATE TRUE
 17367        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17368           CONTINUE
 17369*       WHEN PB-C-AH-REF-CALC = +0 AND
 17370*                  PB-C-AH-CANCEL-AMT > +0
 17371        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17372                   PB-C-AH-REF-CALC > +0
 17373           CONTINUE
 17374        WHEN WS-AH-REFUND-OVS-AMT = +0
 17375                AND WS-TOL-AH-REFUND = +0
 17376           CONTINUE
 17377        WHEN OTHER
 17378           IF WS-TOL-AH-REFUND = +0
 17379              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17380           END-IF
 17381           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17382               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17383                                         PB-C-AH-CANCEL-AMT)
 17384              CONTINUE
 17385           ELSE
 17386              IF WS-AH-REFUND-OVS-AMT = +0
 17387                 MOVE +9999999.99 TO
 17388                         WS-AH-REFUND-OVS-AMT
 17389              END-IF
 17390              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17391                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17392                                         PB-C-AH-CANCEL-AMT)
 17393                 CONTINUE
 17394              ELSE
 17395                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17396                    MOVE ER-2754   TO  WS-ERROR
 17397                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17398                 ELSE
 17399                    MOVE ER-2736   TO  WS-ERROR
 17400                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17401                 END-IF
 17402              END-IF
 17403           END-IF
 17404     END-EVALUATE.
 17405
 17406     EVALUATE TRUE
 17407        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 316
* EL050.cbl
 17408           CONTINUE
 17409*       WHEN PB-C-AH-REF-CALC > +0 AND
 17410*                  PB-C-AH-CANCEL-AMT = +0
 17411        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17412                   PB-C-AH-REF-CALC = +0
 17413           CONTINUE
 17414        WHEN OTHER
 17415           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17416               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17417              CONTINUE
 17418           ELSE
 17419              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17420                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17421                 CONTINUE
 17422              ELSE
 17423                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17424                     MOVE ER-2754   TO  WS-ERROR
 17425                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17426                 ELSE
 17427                     MOVE ER-2736   TO  WS-ERROR
 17428                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17429                 END-IF
 17430              END-IF
 17431           END-IF
 17432     END-EVALUATE.
 17433
 17434     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17435        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17436        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17437           AND  PB-C-LF-REF-CALC < +1.00
 17438           AND  PB-C-AH-REF-CALC < +1.00
 17439           CONTINUE
 17440        ELSE
 17441           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17442              AND (PB-CI-ENTRY-STATUS = 'M')
 17443              CONTINUE
 17444           ELSE
 17445              MOVE ER-2741       TO WS-ERROR
 17446              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17447           END-IF
 17448        END-IF
 17449     END-IF
 17450
 17451     IF (PB-C-LF-CANCEL-AMT = ZERO
 17452        AND WS-LF-BENEFIT-CD NOT = ZERO
 17453        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17454        AND PB-C-LF-REF-CALC NOT = ZERO)
 17455        OR
 17456        (PB-C-LF-CANCEL-AMT = ZERO
 17457        AND WS-LF-BENEFIT-CD NOT = ZERO
 17458        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17459             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17460                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17461                NEXT SENTENCE
 17462             ELSE
 17463                MOVE ER-2739        TO WS-ERROR
 17464                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17465
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 317
* EL050.cbl
 17466     IF (PB-C-AH-CANCEL-AMT = ZERO
 17467        AND WS-AH-BENEFIT-CD NOT = ZERO
 17468        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17469        AND PB-C-AH-REF-CALC NOT = ZERO)
 17470        OR
 17471        (PB-C-AH-CANCEL-AMT = ZERO
 17472        AND WS-AH-BENEFIT-CD NOT = ZERO
 17473        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17474             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17475                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17476                NEXT SENTENCE
 17477             ELSE
 17478                MOVE ER-2738        TO WS-ERROR
 17479                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17480
 17481 3775-OVER-REF-CHK.
 17482
 17483     IF PB-CI-ENTRY-STATUS = '5'
 17484        GO TO 3780-UPDATE-CANCEL-CERT.
 17485
 17486     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17487                              PB-CI-LF-ALT-PREMIUM-AMT.
 17488
 17489     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17490        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17491                                 PB-C-LF-REF-CALC
 17492      ELSE
 17493        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17494                                 PB-C-LF-CANCEL-AMT.
 17495
 17496     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17497        MOVE ER-2755             TO WS-ERROR
 17498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17499
 17500     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17501
 17502     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17503        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17504                                 PB-C-AH-REF-CALC
 17505      ELSE
 17506        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17507                                 PB-C-AH-CANCEL-AMT.
 17508
 17509     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17510        MOVE ER-2778             TO WS-ERROR
 17511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17512
 17513     IF PB-CI-OB-FLAG NOT = 'Z'
 17514        NEXT SENTENCE
 17515       ELSE
 17516         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17517            MOVE ER-2757           TO WS-ERROR
 17518            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17519
 17520 3780-UPDATE-CANCEL-CERT.
 17521
 17522     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17523        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 318
* EL050.cbl
 17524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17525
 17526     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17527         MOVE ER-2729              TO WS-ERROR
 17528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17529
 17530     IF PB-CI-LF-BENEFIT-CD = ZERO
 17531         GO TO 3780-UPDATE-CONT-1.
 17532
 17533     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17534         GO TO 3780-UPDATE-CONT-1.
 17535
 17536     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17537       AND
 17538        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17539       AND
 17540        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17541       AND
 17542        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17543            NEXT SENTENCE
 17544       ELSE
 17545        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17546          AND
 17547***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17548***       AND
 17549           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17550            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17551               MOVE ER-2730      TO WS-ERROR
 17552               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17553               GO TO 3999-END-EDIT
 17554            ELSE
 17555               GO TO 3999-END-EDIT
 17556        ELSE
 17557            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17558               MOVE ER-2765           TO WS-ERROR
 17559               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17560               GO TO 3785-CHECK-REF-INT.
 17561*              GO TO 3999-END-EDIT.
 17562
 17563 3780-UPDATE-CONT-1.
 17564     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17565
 17566     IF PB-CI-AH-BENEFIT-CD = ZERO
 17567         GO TO 3780-UPDATE-CONT-2.
 17568
 17569     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17570         GO TO 3780-UPDATE-CONT-2.
 17571
 17572     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17573
 17574     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17575       AND
 17576        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17577       AND
 17578        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17579       AND
 17580        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17581            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 319
* EL050.cbl
 17582       ELSE
 17583        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17584          AND
 17585***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17586***       AND
 17587           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17588           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17589            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17590               MOVE ER-2773      TO WS-ERROR
 17591               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17592               GO TO 3999-END-EDIT
 17593            ELSE
 17594               GO TO 3999-END-EDIT
 17595            END-IF
 17596           ELSE
 17597             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17598                IF MSTR-CERT-NO = W-CL-CERT-NO
 17599                   MOVE ER-2890 TO WS-ERROR
 17600                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17601                   GO TO 3999-END-EDIT
 17602                ELSE
 17603                   MOVE ER-2898 TO WS-ERROR
 17604                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17605                   GO TO 3999-END-EDIT
 17606                END-IF
 17607             ELSE
 17608                GO TO 3785-CHECK-REF-INT
 17609             END-IF
 17610           END-IF
 17611          ELSE
 17612            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17613              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17614                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17615                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17616                      MOVE ER-2890 TO WS-ERROR
 17617                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17618                      GO TO 3999-END-EDIT
 17619                   ELSE
 17620                      MOVE ER-2898 TO WS-ERROR
 17621                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17622                      GO TO 3999-END-EDIT
 17623                   END-IF
 17624                ELSE
 17625                   MOVE ER-2765 TO WS-ERROR
 17626                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17627                   GO TO 3785-CHECK-REF-INT
 17628                END-IF
 17629              ELSE
 17630               MOVE ER-2765      TO WS-ERROR
 17631               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17632               GO TO 3785-CHECK-REF-INT.
 17633*              GO TO 3999-END-EDIT.
 17634
 17635 3780-UPDATE-CONT-2.
 17636
 17637     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17638        AND WS-LF-BENEFIT-CD = ZERO
 17639           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 320
* EL050.cbl
 17640           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17641
 17642     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17643        AND WS-AH-BENEFIT-CD = ZERO
 17644           MOVE ER-2744           TO WS-ERROR
 17645           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17646
 17647     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17648        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17649        AND
 17650        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17651         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17652           MOVE ER-2746           TO WS-ERROR
 17653           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17654
 17655     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17656       AND
 17657        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17658             MOVE ER-2737        TO WS-ERROR
 17659             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17660
 17661     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17662       AND
 17663        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17664             MOVE ER-2737        TO WS-ERROR
 17665             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17666
 17667     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17668         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17669             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17670             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17671         ELSE
 17672             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17673                 MOVE ER-2768    TO WS-ERROR
 17674                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17675             ELSE
 17676                 MOVE ER-2756    TO WS-ERROR
 17677                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17678
 17679     IF CERT-PEND-ISSUE-RETURNED
 17680        MOVE ER-2772             TO WS-ERROR
 17681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17682 3785-CHECK-REF-INT.
 17683*    IF PB-STATE NOT = 'NH' and 'TN'
 17684     IF PB-STATE NOT = 'NH'
 17685        GO TO 3999-END-EDIT
 17686     END-IF
 17687
 17688     MOVE ER-2796                TO WS-ERROR
 17689     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17690     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17691        OR (CM-REF-INTERFACE-SW = 'Y')
 17692        MOVE ER-2793             TO WS-ERROR
 17693        PERFORM 9900-ERROR-FORMAT
 17694                                 THRU 9900-EXIT
 17695     END-IF
 17696     MOVE +0                     TO WS-PAYMENT-AMT
 17697     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 321
* EL050.cbl
 17698        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17699               PB-C-AH-CANCEL-DT
 17700           GO TO 3999-END-EDIT
 17701        END-IF
 17702     end-if
 17703***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17704***-_-
 17705***-_-   For TN it's only flat cancels
 17706***-_-
 17707***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17708     if pb-state = 'TN'
 17709        if ((pb-c-lf-cancel-dt <> low-values)
 17710           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17711                      or
 17712           ((pb-c-ah-cancel-dt <> low-values)
 17713           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17714           GO TO 3999-END-EDIT
 17715        END-IF
 17716     end-if
 17717     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17718        GO TO 3999-END-EDIT
 17719     END-IF
 17720***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17721***-_-
 17722***-_-   if cancel date within 15 days of effective date, bypass
 17723***-_-
 17724***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17725     IF PB-STATE NOT = 'NH'
 17726        GO TO 3785-CONTINUE
 17727     END-IF
 17728     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17729     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17730     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17731        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17732     END-IF
 17733     MOVE '1'                    TO DC-OPTION-CODE
 17734     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17735     IF NO-CONVERSION-ERROR
 17736        IF DC-ELAPSED-DAYS < +16
 17737           GO TO 3999-END-EDIT
 17738        END-IF
 17739     END-IF
 17740***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17741***-_-
 17742***-_-   if cancel date within 30 days of current date then
 17743***-_-   bypass else subtract 15 days from period
 17744***-_-
 17745***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17746     MOVE +0                     TO DC-ELAPSED-DAYS
 17747     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17748     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17749     MOVE '1'                    TO DC-OPTION-CODE
 17750     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17751     IF NO-CONVERSION-ERROR
 17752        IF DC-ELAPSED-DAYS > +30
 17753           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17754        ELSE
 17755           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 322
* EL050.cbl
 17756        END-IF
 17757     ELSE
 17758        GO TO 3999-END-EDIT
 17759     END-IF
 17760     .
 17761 3785-CONTINUE.
 17762     if pb-state = 'TN'
 17763        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17764        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17765        MOVE '1'                 TO DC-OPTION-CODE
 17766        PERFORM 8500-DATE-CONVERT
 17767                                 THRU 8500-EXIT
 17768        IF no-CONVERSION-ERROR
 17769           IF DC-ELAPSED-DAYS < +16
 17770              GO TO 3999-END-EDIT
 17771           END-IF
 17772        END-IF
 17773     end-if
 17774***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17775***-_-
 17776***-_-   'NH' is 10%, TN is 3.5%
 17777***-_-
 17778***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17779*    if pb-state = 'NH'
 17780*       move +1.10               to ws-work-rate
 17781*    else
 17782*       move +1.035              to ws-work-rate
 17783*    end-if
 17784     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17785     display ' cal int ' ws-st-refund-int-rate ' ' ws-work-rate
 17786       ' ' dc-elapsed-days
 17787     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17788        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17789           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17790     IF WS-PAYMENT-AMT < 10.00
 17791        GO TO 3999-END-EDIT
 17792     END-IF
 17793*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17794
 17795     if (cm-soc-sec-no(1:9) numeric)
 17796        and (cm-soc-sec-no(1:9) not = zeros)
 17797        GO TO 3999-END-EDIT
 17798     END-IF
 17799     MOVE ER-2795                TO WS-ERROR
 17800     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17801
 17802     GO TO 3999-END-EDIT.
 17803******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 323
* EL050.cbl
 17805 3990-FILES-NOT-OPEN.
 17806
 17807     MOVE ER-2617                TO WS-ERROR.
 17808     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17809     GO TO 9990-RETURN.
 17810
 17811 3999-END-EDIT.
 17812
 17813     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17814
 17815     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17816         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17817         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17818             PERFORM 9250-UNLOCK-RETURN
 17819             GO TO 9990-RETURN
 17820          ELSE
 17821             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17822             GO TO 9990-RETURN.
 17823
 17824     IF PB-CANCELLATION
 17825          GO TO 9990-RETURN.
 17826
 17827     IF CERT-WAS-NOT-FOUND
 17828        MOVE SPACES              TO CERTIFICATE-MASTER.
 17829
 17830     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17831
 17832     IF CERT-WAS-FOUND
 17833         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17834             PERFORM 9250-UNLOCK-RETURN
 17835          ELSE
 17836            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17837      ELSE
 17838         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17839
 17840*    if pb-company-id = 'VPP'
 17841*       perform 8150-read-elcrtt thru 8150-exit
 17842*       if ws-vehicle-odometer numeric
 17843*          if ws-vehicle-odometer > 6000
 17844*             move er-1583       to ws-error
 17845*             PERFORM 9900-ERROR-FORMAT
 17846*                                THRU 9900-EXIT
 17847*          end-if
 17848*       end-if
 17849*    end-if
 17850     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17851        IF ((PB-COMPANY-ID = 'DCC')
 17852           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17853                         or
 17854            (pb-company-id = 'CID' or 'VPP')
 17855            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17856        END-IF
 17857     END-IF.
 17858
 17859     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17860         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17861     END-IF.
 17862     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 324
* EL050.cbl
 17863     perform 8150-read-elcrtt    thru 8150-exit
 17864     if ws-ins-age-defaulted = 'Y'
 17865        move er-1573             to ws-error
 17866        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17867     end-if
 17868
 17869     if ws-jnt-age-defaulted = 'Y'
 17870        move er-1574             to ws-error
 17871        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17872     end-if
 17873***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17874***                                                           ****
 17875***  Set an error if the state requires verification of agent ****
 17876***  and agent hasn't verified yet and the status is not =    ****
 17877***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17878***  and the entry date > 09/01/2015.                         ****
 17879***                                                           ****
 17880***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17881     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17882        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17883        and (pb-account (9:2) not = 'OB')
 17884        if (ws-st-agent-sig-edit = 'Y')
 17885           and (am-report-code-1 not = 'CONLEY')
 17886           evaluate true
 17887              when cs-agent-edit-status = 'C'
 17888                 move er-1743    to ws-error
 17889                 perform 9900-error-format
 17890                                 thru 9900-exit
 17891              when cs-agent-edit-status = 'S'
 17892                 move er-1744    to ws-error
 17893                 perform 9900-error-format
 17894                                 thru 9900-exit
 17895              when cs-agent-edit-status = 'M'
 17896                 move er-1745    to ws-error
 17897                 perform 9900-error-format
 17898                                 thru 9900-exit
 17899              when cs-agent-edit-status = 'R'
 17900                 move er-1747    to ws-error
 17901                 perform 9900-error-format
 17902                                 thru 9900-exit
 17903              when cs-agent-edit-status = 'N'
 17904                 move er-1748    to ws-error
 17905                 perform 9900-error-format
 17906                                 thru 9900-exit
 17907              when cs-agent-edit-status <> 'V' and 'U' and
 17908                                           'R' and 'N'
 17909                 move er-1746    to ws-error
 17910                 perform 9900-error-format
 17911                                 thru 9900-exit
 17912           end-evaluate
 17913        end-if
 17914     end-if
 17915     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17916     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17917        AND (WS-NO-SECURE-PAY))
 17918                  OR
 17919        (WS-LF-SPECIAL-CALC-CD = 'O'
 17920        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 325
* EL050.cbl
 17921        SET SKIP-ADDR-EDIT       TO TRUE
 17922     END-IF
 17923     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17924        AND (NOT SKIP-ADDR-EDIT)
 17925        MOVE ER-2963             TO WS-ERROR
 17926        PERFORM 9900-ERROR-FORMAT
 17927                                 THRU 9900-EXIT
 17928        GO TO 9990-RETURN
 17929     END-IF
 17930     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17931     IF ERPNDM-FOUND NOT = 'X'
 17932        move 'Y'                 to erpndm-unlock-sw
 17933        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17934           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17935           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17936           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 17937           or (pm-zip-code    = zeros)
 17938           or (pm-zip-code not numeric))
 17939           AND (NOT SKIP-ADDR-EDIT)
 17940           MOVE ER-2694          TO WS-ERROR
 17941           PERFORM 9900-ERROR-FORMAT
 17942                                 THRU 9900-EXIT
 17943        END-IF
 17944        MOVE ' '                 TO STATE-RECORD-ERROR
 17945        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17946        MOVE PM-STATE            TO CNTL-ACCESS
 17947        MOVE '3'                 TO CNTL-REC-TYPE
 17948        MOVE +0                  TO CNTL-SEQ-NO
 17949        MOVE '0'                 TO RC-SW-2
 17950        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17951        IF (NO-STATE-RECORD)
 17952           OR (CF-RECORD-TYPE NOT = '3')
 17953           OR (PM-STATE NOT = CF-STATE-CODE)
 17954           IF (PM-STATE = SPACES)
 17955              AND (SKIP-ADDR-EDIT)
 17956              CONTINUE
 17957           ELSE
 17958              MOVE ER-2963       TO WS-ERROR
 17959              PERFORM 9900-ERROR-FORMAT
 17960                                 THRU 9900-EXIT
 17961           END-IF
 17962        END-IF
 17963        if (ws-error not = er-2963 and er-2694)
 17964           and (pm-city-st-zip-verified = ' ')
 17965           and (pb-company-id = 'CID')
 17966           move spaces           to zipcd-pass-area
 17967           move pm-zip-code      to pa-zip
 17968           move pm-city          to pa-city
 17969           move pm-state         to pa-state
 17970           perform 7790-call-zip-verify
 17971                                 thru 7790-exit
 17972           if pa-errorcode-zip (1:1) = ' '
 17973                    move 'Y'     to pm-city-st-zip-verified
 17974                    PERFORM 8102-REWRITE-ERPNDM
 17975                                 THRU 8102-EXIT
 17976                    move 'N'     to erpndm-unlock-sw
 17977           else
 17978              MOVE ER-3061       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 326
* EL050.cbl
 17979              PERFORM 9900-ERROR-FORMAT
 17980                                 THRU 9900-EXIT
 17981           end-if
 17982        end-if
 17983        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17984           MOVE ER-2883          TO WS-ERROR
 17985           PERFORM 9900-ERROR-FORMAT
 17986                                 THRU 9900-EXIT
 17987        END-IF
 17988        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17989           MOVE ' '                 TO STATE-RECORD-ERROR
 17990           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17991           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17992           MOVE '3'                 TO CNTL-REC-TYPE
 17993           MOVE +0                  TO CNTL-SEQ-NO
 17994           MOVE '0'                 TO RC-SW-2
 17995           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17996           IF NO-STATE-RECORD
 17997              OR (CF-RECORD-TYPE NOT = '3')
 17998              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17999              MOVE ER-2964          TO WS-ERROR
 18000              PERFORM 9900-ERROR-FORMAT
 18001                                    THRU 9900-EXIT
 18002           END-IF
 18003        END-IF
 18004     ELSE
 18005        IF NOT SKIP-ADDR-EDIT
 18006           MOVE ER-2393          TO WS-ERROR
 18007           PERFORM 9900-ERROR-FORMAT
 18008                                 THRU 9900-EXIT
 18009        END-IF
 18010     END-IF
 18011     if need-to-unlock-erpndm
 18012        perform 8104-unlock-erpndm
 18013                                 thru 8104-exit
 18014     end-if
 18015     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18016
 18017     IF (ERMAIL-FOUND = ' ' AND
 18018        ERPNDM-FOUND = ' ')
 18019        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18020           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18021           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18022          OR
 18023           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18024          OR
 18025           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18026           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18027           GO TO 3999-UNLOCK-ERMAIL.
 18028
 18029     IF ERPNDM-FOUND = 'X'
 18030        GO TO 3999-UNLOCK-ERMAIL.
 18031
 18032     IF PM-INSURED-LAST-NAME      = SPACES
 18033        AND PM-INSURED-FIRST-NAME = SPACES
 18034        AND PM-ADDRESS-LINE-1     = SPACES
 18035        AND PM-ADDRESS-LINE-2     = SPACES
 18036        AND PM-CITY-STATE         = SPACES
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 327
* EL050.cbl
 18037        AND PM-CRED-BENE-NAME     = SPACES
 18038        AND PM-CRED-BENE-ADDR     = SPACES
 18039        AND PM-CRED-BENE-CTYST    = SPACES
 18040        GO TO 3999-UNLOCK-ERMAIL
 18041     END-IF
 18042
 18043     MOVE SPACES                 TO MAILING-DATA.
 18044
 18045     MOVE 'MA'                   TO MA-RECORD-ID.
 18046     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18047     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18048     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18049     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18050     MOVE PB-SV-STATE            TO MA-STATE.
 18051     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18052     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18053
 18054     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18055     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18056
 18057     IF ERMAIL-FOUND = ' '
 18058        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18059     ELSE
 18060        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18061        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18062        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18063
 18064     GO TO 9990-RETURN.
 18065
 18066 3999-UNLOCK-ERMAIL.
 18067     IF ERMAIL-FOUND = ' '
 18068        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18069
 18070     GO TO 9990-RETURN.
 18071******************************************************************
 18072
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 328
* EL050.cbl
 18074 4000-UPDATE-CANCELLED-CERT.
 18075     IF CERT-WAS-NOT-FOUND
 18076        GO TO 4299-EXIT.
 18077
 18078*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18079     IF PB-C-INT-ON-REFS > ZEROS
 18080        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18081     END-IF
 18082     IF PB-C-REF-INTERFACE-SW = 'Y'
 18083        MOVE PB-C-REF-INTERFACE-SW
 18084                                 TO CM-REF-INTERFACE-SW
 18085     END-IF
 18086     IF ERMAIL-FOUND = ' '
 18087        PERFORM 8140-UNLOCK-ERMAIL
 18088                                 THRU 8140-EXIT
 18089     end-if
 18090     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18091     IF ERMAIL-FOUND = 'X'
 18092        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18093        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18094        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18095        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18096           MOVE ER-2694          TO WS-ERROR
 18097           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18098     END-IF
 18099
 18100     IF PB-C-POST-CARD-IND = 'Y'
 18101        MOVE +8                  TO SUB
 18102*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18103        IF ERMAIL-FOUND = ' '
 18104           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18105              (SUB > +7)
 18106              OR (MA-MAIL-STATUS (SUB) = '1')
 18107           END-PERFORM
 18108        END-IF
 18109        IF (SUB > +7)
 18110           OR (ERMAIL-FOUND = 'X')
 18111           MOVE ER-3789          TO WS-ERROR
 18112           PERFORM 9900-ERROR-FORMAT
 18113                                 THRU 9900-EXIT
 18114        END-IF
 18115     ELSE
 18116        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18117     END-IF
 18118
 18119     IF ERMAIL-FOUND = ' '
 18120        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18121     END-IF.
 18122
 18123     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18124
 18125     IF PB-CI-OB-FLAG = 'Z'
 18126        GO TO 4150-SUMMARY-CERT-CANCEL.
 18127
 18128     IF PB-C-LF-CANCEL-VOIDED
 18129         PERFORM 4200-REVERSE-LF-CANCEL.
 18130     IF PB-C-AH-CANCEL-VOIDED
 18131         PERFORM 4200-REVERSE-AH-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 329
* EL050.cbl
 18132
 18133 4100-APPLY-LF-CANCEL.
 18134
 18135     MOVE +0                     TO WS-SUB.
 18136
 18137 4100-CHECK-LF-ERRORS.
 18138
 18139     ADD +1                       TO WS-SUB.
 18140
 18141     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18142        IF LF-COVERAGE-CANCELLED
 18143           GO TO 4100-LF-CANCEL-CONT
 18144        ELSE
 18145           GO TO 4100-UPDATE-LF-COVERAGE.
 18146
 18147     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18148                                   ER-2729 OR
 18149                                   ER-2730 OR
 18150                                   ER-2731 OR
 18151                                   ER-2732 OR
 18152                                   ER-2737 OR
 18153                                   ER-2740 OR
 18154                                   ER-2743 OR
 18155                                   ER-2749 OR
 18156                                   ER-2750 OR
 18157                                   ER-2755 OR
 18158                                   ER-2757 OR
 18159                                   ER-2760 OR
 18160                                   ER-2772 OR
 18161                                   ER-2774 OR
 18162                                   ER-2776 OR
 18163                                   ER-2794
 18164        GO TO 4100-UPDATE-LF-COVERAGE.
 18165
 18166     GO TO 4100-CHECK-LF-ERRORS.
 18167
 18168 4100-UPDATE-LF-COVERAGE.
 18169
 18170     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18171     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18172     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18173        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18174     END-IF
 18175     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18176                                      TO CM-CREDIT-INTERFACE-SW-2.
 18177     IF CM-LF-CANCEL-DT = LOW-VALUE
 18178         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18179
 18180     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18181         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18182                                         CM-LF-STATUS-AT-CANCEL.
 18183
 18184     GO TO 4100-APPLY-AH-CANCEL.
 18185
 18186 4100-LF-CANCEL-CONT.
 18187     IF PB-C-LF-CANCEL-VOIDED
 18188         GO TO 4100-APPLY-AH-CANCEL.
 18189
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 330
* EL050.cbl
 18190     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18191         GO TO 4100-APPLY-AH-CANCEL.
 18192
 18193     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18194        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18195           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18196        ELSE
 18197           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18198
 18199     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18200     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18201
 18202     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18203         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18204
 18205     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18206        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18207         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18208         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18209
 18210     IF PB-RECORD-RETURNED
 18211        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18212      ELSE
 18213        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18214
 18215 4100-APPLY-AH-CANCEL.
 18216
 18217     MOVE +0                      TO WS-SUB.
 18218
 18219 4100-CHECK-AH-ERRORS.
 18220
 18221     ADD +1                       TO WS-SUB.
 18222
 18223     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18224        IF AH-COVERAGE-CANCELLED
 18225           GO TO 4100-AH-CANCEL-CONT
 18226        ELSE
 18227           GO TO 4100-UPDATE-AH-COVERAGE.
 18228
 18229     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18230                                   ER-2729 OR
 18231                                   ER-2732 OR
 18232                                   ER-2737 OR
 18233                                   ER-2740 OR
 18234                                   ER-2744 OR
 18235                                   ER-2749 OR
 18236                                   ER-2750 OR
 18237                                   ER-2755 OR
 18238                                   ER-2757 OR
 18239                                   ER-2760 OR
 18240                                   ER-2771 OR
 18241                                   ER-2772 OR
 18242                                   ER-2773 OR
 18243                                   ER-2775 OR
 18244                                   ER-2777 OR
 18245                                   ER-2778 OR
 18246                                   ER-2794
 18247        GO TO 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 331
* EL050.cbl
 18248
 18249     GO TO 4100-CHECK-AH-ERRORS.
 18250
 18251 4100-UPDATE-AH-COVERAGE.
 18252
 18253     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18254     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18255     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18256     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18257                                      TO CM-CREDIT-INTERFACE-SW-2.
 18258     IF CM-AH-CANCEL-DT = LOW-VALUE
 18259         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18260
 18261     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18262         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18263                                         CM-AH-STATUS-AT-CANCEL.
 18264
 18265     IF LF-COVERAGE-CANCELLED
 18266         IF PB-RECORD-RETURNED
 18267              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18268          ELSE
 18269              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18270
 18271     GO TO 4299-EXIT.
 18272
 18273 4100-AH-CANCEL-CONT.
 18274     IF PB-C-AH-CANCEL-VOIDED
 18275         GO TO 4299-EXIT.
 18276
 18277     if cm-credit-interface-sw-2 = ' '
 18278        if pb-fatal-errors or pb-unforced-errors
 18279           move '4'              to cm-credit-interface-sw-2
 18280        else
 18281           move '1'              to cm-credit-interface-sw-2
 18282        end-if
 18283     end-if
 18284     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18285         GO TO 4299-EXIT.
 18286
 18287     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18288        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18289           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18290        ELSE
 18291           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18292
 18293     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18294     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18295
 18296     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18297         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18298
 18299     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18300         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18301         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18302
 18303     IF PB-RECORD-RETURNED
 18304        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18305      ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 332
* EL050.cbl
 18306        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18307
 18308     GO TO 4299-EXIT.
 18309
 18310 4150-SUMMARY-CERT-CANCEL.
 18311     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18312
 18313     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18314        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18315                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18316     ELSE
 18317        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18318                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18319
 18320     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18321        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18322                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18323     ELSE
 18324        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18325                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18326
 18327     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18328        NEXT SENTENCE
 18329     ELSE
 18330        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18331
 18332     GO TO 4299-EXIT.
 18333
 18334 4200-REVERSE-LF-CANCEL.
 18335     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18336
 18337     IF CM-LF-CANCEL-APPLIED
 18338        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18339        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18340        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 18341
 18342     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18343
 18344     IF PB-RECORD-RETURNED
 18345        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18346       ELSE
 18347        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18348
 18349 4200-REVERSE-LF-EXIT.
 18350       EXIT.
 18351
 18352 4200-REVERSE-AH-CANCEL.
 18353     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18354
 18355     IF CM-AH-CANCEL-APPLIED
 18356        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18357        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18358        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18359
 18360     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18361
 18362     IF PB-RECORD-RETURNED
 18363        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 333
* EL050.cbl
 18364       ELSE
 18365        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18366
 18367 4200-REVERSE-AH-EXIT.
 18368       EXIT.
 18369
 18370 4299-EXIT.
 18371       EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 334
* EL050.cbl
 18373
 18374 4500-UPDATE-NEW-CERT.
 18375     IF CERT-WAS-FOUND
 18376         NEXT SENTENCE
 18377       ELSE
 18378         GO TO 4520-BUILD-NEW-KEY.
 18379
 18380     IF  CLASIC-CREATED-CERT
 18381         GO TO 4999-EXIT.
 18382
 18383     IF  CERT-WAS-CREATED-FOR-CLAIM
 18384         GO TO 4520-BUILD-NEW-KEY.
 18385
 18386     IF CERT-ADDED-BATCH
 18387        IF CM-RECORD-ID = 'CM'
 18388            GO TO 4999-EXIT.
 18389
 18390 4520-BUILD-NEW-KEY.
 18391* BUILD CONTROL PRIMARY
 18392
 18393     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18394                                       CM-COMPANY-CD-A1
 18395                                       CM-COMPANY-CD-A2
 18396                                       CM-COMPANY-CD-A4
 18397                                       CM-COMPANY-CD-A5.
 18398
 18399     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18400     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18401     MOVE PB-SV-STATE               TO CM-STATE.
 18402     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18403     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18404     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18405     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18406
 18407     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18408
 18409     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18410     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18411     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18412     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18413
 18414     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18415        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18416
 18417     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18418         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18419         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18420         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18421         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18422     ELSE
 18423         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18424
 18425     IF PB-COMPANY-ID   EQUAL  'CRI'
 18426         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18427         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18428         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18429         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18430         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 335
* EL050.cbl
 18431
 18432     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18433        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18434         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18435
 18436     IF PB-COMPANY-ID  = 'LBL'
 18437        IF PB-I-JOINT-COVERAGE
 18438            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18439                                           PB-I-MEMBER-NO
 18440            GO TO 4550-CONT-CERT-PROCESS.
 18441
 18442     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18443        NEXT SENTENCE
 18444     ELSE
 18445        GO TO 4540-BUILD-MEMBER-NO.
 18446
 18447******************************************************************
 18448*                                                                *
 18449*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18450*    FOR 'MON'.                                                  *
 18451*                                                                *
 18452******************************************************************
 18453
 18454     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18455     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18456     MOVE +1                     TO WS-SUB1
 18457                                    WS-SUB2.
 18458
 18459 4530-EDIT-MEMB-NAME.
 18460
 18461     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18462        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18463        ADD +1                       TO WS-SUB2.
 18464
 18465     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18466        ADD +1                       TO WS-SUB1
 18467        GO TO 4530-EDIT-MEMB-NAME.
 18468
 18469     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18470     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18471     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18472*    MOVE SPACE                      TO DC-OPTION-CODE.
 18473     SET  BIN-TO-GREG                TO TRUE.
 18474     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18475     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18476
 18477     GO TO 4550-CONT-CERT-PROCESS.
 18478
 18479******************************************************************
 18480*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18481******************************************************************
 18482
 18483 4540-BUILD-MEMBER-NO.
 18484
 18485     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18486         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18487         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18488         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 336
* EL050.cbl
 18489         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18490     ELSE
 18491         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18492
 18493     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18494        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18495         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18496
 18497 4550-CONT-CERT-PROCESS.
 18498
 18499*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18500*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18501*    ELSE
 18502*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18503
 18504     IF CERT-WAS-CREATED-FOR-CLAIM
 18505        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18506        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18507
 18508     IF CERT-AND-CLAIM-ONLINE
 18509        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18510        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18511
 18512     MOVE 'CM'                     TO CM-RECORD-ID.
 18513     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18514
 18515     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18516        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18517        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18518     ELSE
 18519        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18520        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18521
 18522     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18523     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18524     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18525     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18526     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18527     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18528     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18529                                      CM-LF-ITD-CANCEL-AMT
 18530                                      CM-LF-ITD-DEATH-AMT
 18531                                      CM-AH-ITD-AH-PMT
 18532                                      CM-AH-ITD-LUMP-PMT
 18533                                      CM-AH-ITD-CANCEL-AMT
 18534                                      CM-LF-NSP-PREMIUM-AMT
 18535                                      CM-AH-NSP-PREMIUM-AMT.
 18536*                                     CM-CLAIM-DEDUCT-WITHHELD
 18537*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18538     if pb-i-loan-apr = +99.9999
 18539        move zeros                 to cm-loan-apr
 18540     else
 18541        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18542     end-if
 18543     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18544     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18545     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18546     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 337
* EL050.cbl
 18547     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18548     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18549     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18550     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18551     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18552     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18553     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18554
 18555     IF PB-I-LIVES NOT NUMERIC
 18556         MOVE ZERO                 TO PB-I-LIVES.
 18557
 18558     IF PB-I-NUM-BILLED NOT NUMERIC
 18559         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18560
 18561     MOVE PB-I-LIVES               TO CM-LIVES.
 18562     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18563
 18564     IF PB-COMPANY-ID EQUAL  'DMD'
 18565         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18566         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18567
 18568     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18569     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18570     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18571     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18572     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18573     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18574
 18575     IF PB-I-LF-POLICY-FEE NUMERIC
 18576        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18577     ELSE
 18578        MOVE +0                    TO CM-LF-POLICY-FEE.
 18579
 18580     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18581        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18582        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18583     ELSE
 18584        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18585
 18586     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18587     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18588     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18589     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18590     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18591     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18592     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18593     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18594     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18595
 18596     IF PB-I-CANCEL-FEE NUMERIC
 18597        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18598     ELSE
 18599        MOVE +0                  TO CM-CANCEL-FEE
 18600     END-IF
 18601
 18602     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18603        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18604     ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 338
* EL050.cbl
 18605        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18606
 18607     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18608     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18609
 18610     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18611                                      CM-LF-DEATH-EXIT-DT
 18612                                      CM-AH-SETTLEMENT-EXIT-DT.
 18613
 18614*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18615*                       'TIH' OR 'OFL' OR 'FLA' OR
 18616*                       'TII' OR 'TMS' OR 'CRI' OR
 18617*                       'NCL'
 18618     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18619
 18620     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18621         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18622            MOVE '2'                TO CM-PREMIUM-TYPE.
 18623
 18624     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18625         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18626            MOVE '2'                TO CM-PREMIUM-TYPE.
 18627
 18628     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18629         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18630     ELSE
 18631         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18632         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18633
 18634     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18635     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18636     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18637     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18638     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18639     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18640     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18641     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18642
 18643     IF PB-NO-MONTHS-SKIPPED
 18644         MOVE SPACE                 TO CM-SKIP-CODE
 18645     ELSE
 18646         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18647
 18648     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18649     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18650                                       CM-LF-STATUS-AT-CANCEL.
 18651
 18652     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18653     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18654                                       CM-AH-STATUS-AT-CANCEL.
 18655
 18656     MOVE '1'                       TO CM-ENTRY-STATUS.
 18657
 18658     IF PB-REISSUED-CERT
 18659        MOVE '5'                    TO CM-ENTRY-STATUS.
 18660
 18661     IF PB-MONTHLY-CERT
 18662        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 339
* EL050.cbl
 18663
 18664     IF PB-CASH-CERT
 18665        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18666
 18667     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18668     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18669     IF PB-POLICY-IS-DECLINED
 18670        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18671
 18672     IF PB-POLICY-IS-VOIDED
 18673        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18674
 18675     IF PB-NEEDS-UNDERWRITING
 18676        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18677
 18678     IF PB-REIN-ONLY-CERT
 18679        MOVE '9'                    TO CM-ENTRY-STATUS.
 18680
 18681     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18682         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18683     ELSE
 18684         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18685
 18686     IF PB-RECORD-RETURNED
 18687        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18688      ELSE
 18689        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18690
 18691     IF PB-I-MAIL-ADDRS-PRESENT
 18692        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18693
 18694     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18695                                       CM-ENTRY-DT.
 18696
 18697 4999-EXIT.
 18698     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 340
* EL050.cbl
 18700
 18701 5000-PROCESS-REPS.
 18702     MOVE ' '                    TO AGTC-MASTER-SW
 18703     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18704     MOVE CO-TYPE                TO AGTC-TYPE
 18705     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18706     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18707     IF (AGTC-MASTER-SW NOT = 'N')
 18708        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18709        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18710        PERFORM 8583-READ-ERAGTC-NEXT
 18711                                 THRU 8583-EXIT
 18712     END-IF
 18713     IF AGTC-MASTER-SW = 'N'
 18714        CONTINUE
 18715     ELSE
 18716        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18717           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18718              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18719              MOVE 'Y'           TO AGTC-MASTER-SW
 18720           END-IF
 18721        END-IF
 18722     END-IF
 18723     .
 18724 5000-EXIT.
 18725     EXIT.
 18726 6370-EDIT-INPUT-LF-CODE.
 18727     move ' ' to ws-benefit-cd-chg-sw
 18728     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18729        MOVE +1                  TO SUB
 18730        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18731        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18732        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18733        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18734        GO TO 6370-SEARCH-LOOP.
 18735
 18736     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18737
 18738     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18739     MOVE SPACES                 TO CNTL-ACCESS.
 18740*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18741     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18742     MOVE +0                     TO CNTL-SEQ-NO.
 18743     MOVE '4' TO RC-SW-2.
 18744     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18745
 18746     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18747        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18748        GO TO 6370-NO-LF-FOUND.
 18749
 18750     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18751     MOVE +1                     TO SUB.
 18752
 18753 6370-SEARCH-LOOP.
 18754     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18755         GO TO 6370-NO-LF-FOUND.
 18756
 18757     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 341
* EL050.cbl
 18758        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18759           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18760           set benefit-code-chg to true
 18761        end-if
 18762        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18763        GO TO 6370-HER-NET-PAY-CHECK.
 18764
 18765     ADD 1   TO SUB.
 18766*    IF SUB GREATER 120
 18767     IF SUB GREATER 200
 18768         GO TO 6370-NO-LF-FOUND.
 18769
 18770     GO TO 6370-SEARCH-LOOP.
 18771
 18772 6370-NO-LF-FOUND.
 18773
 18774     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18775        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18776        set benefit-code-chg to true
 18777     end-if
 18778     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18779
 18780 6370-HER-NET-PAY-CHECK.
 18781
 18782     IF PB-COMPANY-ID = 'CID'
 18783        IF PB-SV-STATE = 'CA' OR 'MN'
 18784           IF PB-I-LF-BENEFIT-CD = '02'
 18785              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18786           ELSE
 18787              IF PB-I-LF-BENEFIT-CD = '04'
 18788                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18789              END-IF
 18790           END-IF
 18791        END-IF
 18792     END-IF
 18793
 18794     IF PB-COMPANY-ID NOT = 'HER'
 18795         GO TO 6370-EXIT.
 18796
 18797     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18798         GO TO 6370-EXIT.
 18799
 18800     IF PB-I-LF-TERM NOT NUMERIC
 18801         MOVE ZEROS              TO PB-I-LF-TERM.
 18802
 18803     IF PB-I-LOAN-TERM NOT NUMERIC
 18804         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18805
 18806     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18807         GO TO 6370-EXIT.
 18808
 18809     IF PB-I-LF-BENEFIT-CD = '33'
 18810         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18811
 18812     IF PB-I-LF-BENEFIT-CD = '34'
 18813         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18814
 18815 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 342
* EL050.cbl
 18816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 343
* EL050.cbl
 18818
 18819 6380-EDIT-INPUT-AH-CODE.
 18820     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18821        MOVE +1                  TO SUB
 18822        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18823        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18824        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18825        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18826        GO TO 6380-SEARCH-LOOP.
 18827
 18828     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18829
 18830     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18831     MOVE SPACES                 TO CNTL-ACCESS.
 18832     MOVE 'A'                    TO CNTL-REC-TYPE.
 18833*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18834     MOVE +0                     TO CNTL-SEQ-NO.
 18835     MOVE '5' TO RC-SW-2.
 18836     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18837
 18838     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18839        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18840        GO TO 6380-NO-AH-FOUND.
 18841
 18842     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18843     MOVE +1 TO SUB.
 18844
 18845 6380-SEARCH-LOOP.
 18846     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18847         GO TO 6380-NO-AH-FOUND.
 18848
 18849     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18850         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18851         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18852
 18853     ADD 1   TO SUB.
 18854     IF SUB GREATER THAN 96
 18855*    IF SUB GREATER THAN 300
 18856         GO TO 6380-NO-AH-FOUND.
 18857
 18858     GO TO 6380-SEARCH-LOOP.
 18859
 18860 6380-NO-AH-FOUND.
 18861
 18862     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18863
 18864     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18865         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18866     ELSE
 18867         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18868
 18869 6380-CSO-AH-ONLY-CHECKS.
 18870
 18871     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18872        NEXT SENTENCE
 18873      ELSE
 18874        GO TO 6380-EXIT.
 18875
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 344
* EL050.cbl
 18876     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18877         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18878
 18879
 18880     GO TO 6380-EXIT
 18881     .
 18882 6380-CSO-LIFE-WITH-AH-CHECKS.
 18883
 18884
 18885     .
 18886 6380-EXIT.
 18887     EXIT.
 18888
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 345
* EL050.cbl
 18890
 18891 6400-COMPUTE-EXTENSION-DAYS.
 18892
 18893******************************************************************
 18894*                                                                *
 18895*                   COMPUTE EXTENSION DAYS                       *
 18896*                                                                *
 18897*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18898*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18899*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18900*    THE EXTENSION DAYS.                                         *
 18901*                                                                *
 18902******************************************************************
 18903
 18904     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18905     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18906
 18907******************************************************************
 18908*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18909*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18910******************************************************************
 18911
 18912     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18913        COMPUTE WS-ODD-DAYS-OVER =
 18914               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18915     ELSE
 18916        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18917
 18918     IF WS-ODD-DAYS-OVER = ZEROS
 18919           GO TO 6499-EXIT
 18920     ELSE
 18921        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18922           IF WS-WDF-MONTH = 02
 18923              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18924              ADD 2       TO  WS-ODD-DAYS-OVER
 18925              GO TO 6499-EXIT
 18926           ELSE
 18927              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18928                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18929                 GO TO 6499-EXIT
 18930               ELSE
 18931                 GO TO 6499-EXIT
 18932        ELSE
 18933           GO TO 6499-EXIT.
 18934
 18935 6412-CHECK-TO-DAY.
 18936
 18937        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18938           IF WS-WDT-DAY = 28
 18939              ADD 2              TO WS-ODD-DAYS-OVER
 18940           ELSE
 18941              IF WS-WDT-DAY = 29
 18942                 ADD 1           TO WS-ODD-DAYS-OVER
 18943              ELSE
 18944                 NEXT SENTENCE
 18945        ELSE
 18946           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18947              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 346
* EL050.cbl
 18948
 18949     GO TO 6499-EXIT.
 18950
 18951
 18952 6415-CHECK-LEAP-YEAR.
 18953
 18954     IF DC-DAYS-IN-MONTH = 29
 18955        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18956
 18957 6415-EXIT.
 18958     EXIT.
 18959
 18960 6499-EXIT.
 18961      EXIT.
 18962
 18963 6500-END.
 18964     EXIT.
 18965
 18966
 18967******************************************************************
 18968************* PROCEDURE DIVISION FOR EL050 ***********************
 18969********************** ELC50PD END *******************************
 18970
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 347
* EL050.cbl
 18972
 18973**START***********************************************************
 18974*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18975*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18976******************************************************************
 18977*
 18978 6600-GET-STATE-MUNICIPAL-TAX.
 18979
 18980     IF PB-COMPANY-ID NOT = 'DMD'
 18981         GO TO 6640-EXIT.
 18982
 18983     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18984     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18985     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18986*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18987*
 18988***  Y2K PROJ 7744
 18989     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18990     SET BIN-TO-GREG          TO TRUE.
 18991     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18992
 18993     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18994
 18995     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18996     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18997
 18998
 18999* EXEC CICS HANDLE CONDITION
 19000*        INVREQ    (6610-START-BROWSE)
 19001*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19002*        NOTFND    (6630-END-OF-FILE)
 19003*    END-EXEC.
 19004*    MOVE '"$8JI                 ! # #00018988' TO DFHEIV0
 19005     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19007     MOVE X'2320233030303138393838' TO DFHEIV0(25:11)
 19008     CALL 'kxdfhei1' USING DFHEIV0
 19009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19010
 19011
 19012 6610-START-BROWSE.
 19013
 19014
 19015* EXEC CICS HANDLE CONDITION
 19016*        NOTFND    (6630-END-OF-FILE)
 19017*        DISABLED  (6630-ERRESS-PROBLEM)
 19018*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19019*        ENDFILE   (6630-END-OF-FILE)
 19020*    END-EXEC.
 19021*    MOVE '"$IcJ''                ! $ #00018996' TO DFHEIV0
 19022     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19024     MOVE X'2420233030303138393936' TO DFHEIV0(25:11)
 19025     CALL 'kxdfhei1' USING DFHEIV0
 19026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19027
 19028
 19029
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 348
* EL050.cbl
 19030* EXEC CICS STARTBR
 19031*        DATASET (FILE-ID-ERRESS)
 19032*        RIDFLD  (WS-ERRESS-KEY)
 19033*        GTEQ
 19034*    END-EXEC.
 19035     MOVE 0
 19036       TO DFHEIV11
 19037*    MOVE '&,         G          &   #00019003' TO DFHEIV0
 19038     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19039     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19040     MOVE X'2020233030303139303033' TO DFHEIV0(25:11)
 19041     CALL 'kxdfhei1' USING DFHEIV0,
 19042           FILE-ID-ERRESS,
 19043           WS-ERRESS-KEY,
 19044           DFHEIV99,
 19045           DFHEIV11,
 19046           DFHEIV99
 19047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19048
 19049
 19050 6620-READ-NEXT-ERRESS-MASTER.
 19051
 19052
 19053* EXEC CICS HANDLE CONDITION
 19054*        NOTFND    (6630-END-OF-FILE)
 19055*        ENDFILE   (6630-END-OF-FILE)
 19056*        DISABLED  (6630-ERRESS-PROBLEM)
 19057*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19058*    END-EXEC.
 19059*    MOVE '"$I''cJ                ! % #00019011' TO DFHEIV0
 19060     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19062     MOVE X'2520233030303139303131' TO DFHEIV0(25:11)
 19063     CALL 'kxdfhei1' USING DFHEIV0
 19064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19065
 19066
 19067
 19068* EXEC CICS READNEXT
 19069*        DATASET (FILE-ID-ERRESS)
 19070*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19071*        RIDFLD  (WS-ERRESS-KEY)
 19072*    END-EXEC.
 19073     MOVE LENGTH OF
 19074      RESIDENT-STATE-TAX-MASTER
 19075       TO DFHEIV12
 19076     MOVE 0
 19077       TO DFHEIV11
 19078*    MOVE '&.IL                  )   #00019018' TO DFHEIV0
 19079     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19080     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19081     MOVE X'2020233030303139303138' TO DFHEIV0(25:11)
 19082     CALL 'kxdfhei1' USING DFHEIV0,
 19083           FILE-ID-ERRESS,
 19084           RESIDENT-STATE-TAX-MASTER,
 19085           DFHEIV12,
 19086           WS-ERRESS-KEY,
 19087           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 349
* EL050.cbl
 19088           DFHEIV11,
 19089           DFHEIV99,
 19090           DFHEIV99
 19091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19092
 19093
 19094     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19095
 19096* EXEC CICS ENDBR
 19097*            DATASET (FILE-ID-ERRESS)
 19098*       END-EXEC
 19099     MOVE 0
 19100       TO DFHEIV11
 19101*    MOVE '&2                    $   #00019025' TO DFHEIV0
 19102     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19103     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19104     MOVE X'2020233030303139303235' TO DFHEIV0(25:11)
 19105     CALL 'kxdfhei1' USING DFHEIV0,
 19106           FILE-ID-ERRESS,
 19107           DFHEIV11,
 19108           DFHEIV99
 19109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19110        GO TO 6630-END-OF-FILE.
 19111
 19112     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19113        NEXT SENTENCE
 19114      ELSE
 19115        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19116
 19117*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19118*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19119*
 19120     MOVE +2                     TO WS-SUB1.
 19121
 19122     IF PB-ISSUE
 19123     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19124        MOVE +1                  TO WS-SUB1.
 19125
 19126     IF PB-CANCELLATION
 19127     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19128        MOVE +1                  TO WS-SUB1.
 19129*
 19130*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19131*
 19132***  Y2K PROJ 7744
 19133     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19134***  Y2K PROJ 7744
 19135
 19136*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19137* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19138* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19139
 19140     ADD 1                    TO WS-YEAR-YY.
 19141
 19142     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19143         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19144                              TO WS-RES-STATE-TAX
 19145         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 350
* EL050.cbl
 19146                              TO WS-RES-MUNI-TAX
 19147     ELSE
 19148         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19149                              TO WS-RES-STATE-TAX
 19150         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19151                              TO WS-RES-MUNI-TAX.
 19152
 19153*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19154
 19155     IF PB-CANCELLATION
 19156         GO TO 6640-CANCEL-TAX.
 19157
 19158     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19159         COMPUTE PB-I-STATE-TAX ROUNDED =
 19160                                   PB-I-LF-PREMIUM-AMT
 19161                                 * WS-RES-STATE-TAX
 19162         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19163                                   PB-I-LF-PREMIUM-AMT
 19164                                 * WS-RES-MUNI-TAX
 19165     ELSE
 19166     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19167         COMPUTE PB-I-STATE-TAX ROUNDED =
 19168                                   PB-I-AH-PREMIUM-AMT
 19169                                 * WS-RES-STATE-TAX
 19170         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19171                                   PB-I-AH-PREMIUM-AMT
 19172                                 * WS-RES-MUNI-TAX.
 19173
 19174
 19175* EXEC CICS ENDBR
 19176*         DATASET (FILE-ID-ERRESS)
 19177*    END-EXEC.
 19178     MOVE 0
 19179       TO DFHEIV11
 19180*    MOVE '&2                    $   #00019092' TO DFHEIV0
 19181     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19182     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19183     MOVE X'2020233030303139303932' TO DFHEIV0(25:11)
 19184     CALL 'kxdfhei1' USING DFHEIV0,
 19185           FILE-ID-ERRESS,
 19186           DFHEIV11,
 19187           DFHEIV99
 19188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19189
 19190
 19191     GO TO 6640-EXIT.
 19192
 19193 6640-CANCEL-TAX.
 19194     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19195
 19196     IF PB-C-LF-CANCEL-AMT > ZEROS
 19197         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19198                                   PB-C-LF-CANCEL-AMT
 19199                                 * WS-RES-STATE-TAX
 19200         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19201                                   PB-C-LF-CANCEL-AMT
 19202                                *  WS-RES-MUNI-TAX
 19203     ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 351
* EL050.cbl
 19204     IF PB-C-AH-CANCEL-AMT > ZEROS
 19205         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19206                                   PB-C-AH-CANCEL-AMT
 19207                                 * WS-RES-STATE-TAX
 19208         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19209                                   PB-C-AH-CANCEL-AMT
 19210                                *  WS-RES-MUNI-TAX.
 19211
 19212
 19213* EXEC CICS ENDBR
 19214*         DATASET (FILE-ID-ERRESS)
 19215*    END-EXEC.
 19216     MOVE 0
 19217       TO DFHEIV11
 19218*    MOVE '&2                    $   #00019117' TO DFHEIV0
 19219     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19221     MOVE X'2020233030303139313137' TO DFHEIV0(25:11)
 19222     CALL 'kxdfhei1' USING DFHEIV0,
 19223           FILE-ID-ERRESS,
 19224           DFHEIV11,
 19225           DFHEIV99
 19226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19227
 19228
 19229     GO TO 6640-EXIT.
 19230
 19231 6630-END-OF-FILE.
 19232     MOVE ER-8002              TO WS-ERROR.
 19233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19234
 19235     GO TO 6640-EXIT.
 19236
 19237 6630-ERRESS-PROBLEM.
 19238     MOVE ER-8044              TO WS-ERROR.
 19239     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19240
 19241 6640-EXIT.
 19242     EXIT.
 19243
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 352
* EL050.cbl
 19245 6650-GET-RES-STATE-COMM.
 19246
 19247     IF PB-COMPANY-ID NOT = 'DMD'
 19248         GO TO 6700-COMM-EXIT.
 19249
 19250     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19251     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19252     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19253     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19254     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19255     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19256     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19257
 19258*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19259*
 19260***  Y2K PROJ 7744
 19261     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19262     SET BIN-TO-GREG          TO TRUE.
 19263     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19264
 19265     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19266***  Y2K PROJ 7744
 19267
 19268     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19269
 19270
 19271* EXEC CICS HANDLE CONDITION
 19272*        INVREQ    (6660-START-BROWSE)
 19273*        DISABLED  (6690-ERRESC-PROBLEM)
 19274*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19275*        NOTFND    (6690-END-OF-FILE)
 19276*    END-EXEC.
 19277*    MOVE '"$8cJI                ! & #00019162' TO DFHEIV0
 19278     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19280     MOVE X'2620233030303139313632' TO DFHEIV0(25:11)
 19281     CALL 'kxdfhei1' USING DFHEIV0
 19282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19283
 19284
 19285
 19286* EXEC CICS RESETBR
 19287*        DATASET (FILE-ID-ERRESC)
 19288*        RIDFLD  (WS-ERRESC-KEY)
 19289*    END-EXEC.
 19290     MOVE 0
 19291       TO DFHEIV11
 19292*    MOVE '&4         G          &   #00019169' TO DFHEIV0
 19293     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19295     MOVE X'2020233030303139313639' TO DFHEIV0(25:11)
 19296     CALL 'kxdfhei1' USING DFHEIV0,
 19297           FILE-ID-ERRESC,
 19298           WS-ERRESC-KEY,
 19299           DFHEIV99,
 19300           DFHEIV11,
 19301           DFHEIV99
 19302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 353
* EL050.cbl
 19303
 19304
 19305 6660-START-BROWSE.
 19306
 19307
 19308* EXEC CICS HANDLE CONDITION
 19309*        NOTFND    (6690-END-OF-FILE)
 19310*        DISABLED  (6690-ERRESC-PROBLEM)
 19311*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19312*        ENDFILE   (6690-END-OF-FILE)
 19313*    END-EXEC.
 19314*    MOVE '"$IcJ''                ! '' #00019176' TO DFHEIV0
 19315     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19317     MOVE X'2720233030303139313736' TO DFHEIV0(25:11)
 19318     CALL 'kxdfhei1' USING DFHEIV0
 19319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19320
 19321
 19322
 19323* EXEC CICS STARTBR
 19324*        DATASET (FILE-ID-ERRESC)
 19325*        RIDFLD  (WS-ERRESC-KEY)
 19326*        GTEQ
 19327*    END-EXEC.
 19328     MOVE 0
 19329       TO DFHEIV11
 19330*    MOVE '&,         G          &   #00019183' TO DFHEIV0
 19331     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19332     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19333     MOVE X'2020233030303139313833' TO DFHEIV0(25:11)
 19334     CALL 'kxdfhei1' USING DFHEIV0,
 19335           FILE-ID-ERRESC,
 19336           WS-ERRESC-KEY,
 19337           DFHEIV99,
 19338           DFHEIV11,
 19339           DFHEIV99
 19340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19341
 19342
 19343     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19344
 19345 6670-READ-NEXT-ERRESC-MASTER.
 19346
 19347
 19348* EXEC CICS HANDLE CONDITION
 19349*        NOTFND    (6690-END-OF-FILE)
 19350*        DISABLED  (6690-ERRESC-PROBLEM)
 19351*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19352*        ENDFILE   (6690-END-OF-FILE)
 19353*    END-EXEC.
 19354*    MOVE '"$IcJ''                ! ( #00019193' TO DFHEIV0
 19355     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19356     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19357     MOVE X'2820233030303139313933' TO DFHEIV0(25:11)
 19358     CALL 'kxdfhei1' USING DFHEIV0
 19359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19360
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 354
* EL050.cbl
 19361
 19362
 19363* EXEC CICS READNEXT
 19364*        DATASET (FILE-ID-ERRESC)
 19365*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19366*        RIDFLD  (ERRESC-RECORD-KEY)
 19367*    END-EXEC.
 19368     MOVE LENGTH OF
 19369      ACCOUNT-RESIDENT-ST-COMMISSION
 19370       TO DFHEIV12
 19371     MOVE 0
 19372       TO DFHEIV11
 19373*    MOVE '&.IL                  )   #00019200' TO DFHEIV0
 19374     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19375     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19376     MOVE X'2020233030303139323030' TO DFHEIV0(25:11)
 19377     CALL 'kxdfhei1' USING DFHEIV0,
 19378           FILE-ID-ERRESC,
 19379           ACCOUNT-RESIDENT-ST-COMMISSION,
 19380           DFHEIV12,
 19381           ERRESC-RECORD-KEY,
 19382           DFHEIV99,
 19383           DFHEIV11,
 19384           DFHEIV99,
 19385           DFHEIV99
 19386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19387
 19388
 19389     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19390        NEXT SENTENCE
 19391     ELSE
 19392
 19393* EXEC CICS ENDBR
 19394*            DATASET (FILE-ID-ERRESC)
 19395*       END-EXEC
 19396     MOVE 0
 19397       TO DFHEIV11
 19398*    MOVE '&2                    $   #00019209' TO DFHEIV0
 19399     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19400     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19401     MOVE X'2020233030303139323039' TO DFHEIV0(25:11)
 19402     CALL 'kxdfhei1' USING DFHEIV0,
 19403           FILE-ID-ERRESC,
 19404           DFHEIV11,
 19405           DFHEIV99
 19406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19407        GO TO 6690-END-OF-FILE.
 19408
 19409     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19410
 19411* EXEC CICS ENDBR
 19412*            DATASET (FILE-ID-ERRESC)
 19413*       END-EXEC
 19414     MOVE 0
 19415       TO DFHEIV11
 19416*    MOVE '&2                    $   #00019215' TO DFHEIV0
 19417     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19418     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 355
* EL050.cbl
 19419     MOVE X'2020233030303139323135' TO DFHEIV0(25:11)
 19420     CALL 'kxdfhei1' USING DFHEIV0,
 19421           FILE-ID-ERRESC,
 19422           DFHEIV11,
 19423           DFHEIV99
 19424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19425        GO TO 6690-END-OF-FILE.
 19426
 19427     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19428        NEXT SENTENCE
 19429      ELSE
 19430        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19431
 19432* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19433*
 19434     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19435
 19436     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19437
 19438     IF WS-SUB1 > ZERO
 19439         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19440             PERFORM 6680-SET-COMMISSION
 19441         ELSE
 19442             PERFORM 6680-SET-TABLE-CODE.
 19443
 19444
 19445* EXEC CICS ENDBR
 19446*         DATASET (FILE-ID-ERRESC)
 19447*    END-EXEC.
 19448     MOVE 0
 19449       TO DFHEIV11
 19450*    MOVE '&2                    $   #00019237' TO DFHEIV0
 19451     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19452     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19453     MOVE X'2020233030303139323337' TO DFHEIV0(25:11)
 19454     CALL 'kxdfhei1' USING DFHEIV0,
 19455           FILE-ID-ERRESC,
 19456           DFHEIV11,
 19457           DFHEIV99
 19458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19459
 19460
 19461     GO TO 6700-COMM-EXIT.
 19462
 19463 6680-SET-TABLE-CODE.
 19464     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19465        MOVE ZEROS             TO WS-SUB1
 19466     ELSE
 19467* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19468* TO COMPUTE AH COMMISSION.
 19469        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19470        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19471        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19472        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19473        PERFORM 6680-READ-CTBL-TABLE
 19474        IF WS-CTBL-READ-SW NOT = 'Y'
 19475           MOVE ZEROS          TO WS-SUB1.
 19476
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 356
* EL050.cbl
 19477 6680-READ-CTBL-TABLE.
 19478*
 19479* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19480* TO COMPUTE LIFE COMMISSION
 19481
 19482     IF CTBL-SW = '0540'
 19483        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19484        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19485        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19486
 19487     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19488
 19489     IF CTBL-TABLE-FOUND
 19490        IF CTBL-SW = '0530'
 19491             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19492                                    * PB-I-AH-TERM
 19493             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19494             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19495        ELSE
 19496             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19497             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19498             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19499     ELSE
 19500        IF FIRST-TIME-THROUGH
 19501            GO TO 6680-READ-CTBL-TABLE
 19502        ELSE
 19503            MOVE ZEROS         TO WS-SUB1.
 19504
 19505 6680-SET-COMMISSION.
 19506     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19507           MOVE ZEROS          TO WS-SUB1
 19508       ELSE
 19509           MOVE RESC-COMMISSION-PER (WS-SUB)
 19510                               TO WS-COMMISSION
 19511           IF CTBL-SW = '0530'
 19512               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19513           ELSE
 19514               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19515
 19516 6680-SEARCH-CATEGORY.
 19517     ADD +1                   TO WS-SUB.
 19518     IF WS-SUB > +12
 19519         GO TO 6680-EXIT.
 19520
 19521     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19522          MOVE WS-SUB         TO WS-SUB1
 19523          GO TO 6680-EXIT.
 19524
 19525     GO TO 6680-SEARCH-CATEGORY.
 19526
 19527 6680-EXIT.
 19528     EXIT.
 19529
 19530 6690-END-OF-FILE.
 19531     GO TO 6700-COMM-EXIT.
 19532
 19533 6690-ERRESC-PROBLEM.
 19534      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 357
* EL050.cbl
 19535      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19536
 19537      GO TO 6700-COMM-EXIT.
 19538
 19539 6700-COMM-EXIT.
 19540     EXIT.
 19541
 19542 7000-GET-RATE.
 19543
 19544* EXEC CICS LINK
 19545*        PROGRAM    ('ELRATE')
 19546*        COMMAREA   (CALCULATION-PASS-AREA)
 19547*        LENGTH     (CP-COMM-LENGTH)
 19548*    END-EXEC.
 19549     MOVE 'ELRATE' TO DFHEIV1
 19550*    MOVE '."C                   (   #00019323' TO DFHEIV0
 19551     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19553     MOVE X'2020233030303139333233' TO DFHEIV0(25:11)
 19554     CALL 'kxdfhei1' USING DFHEIV0,
 19555           DFHEIV1,
 19556           CALCULATION-PASS-AREA,
 19557           CP-COMM-LENGTH,
 19558           DFHEIV99,
 19559           DFHEIV99,
 19560           DFHEIV99,
 19561           DFHEIV99
 19562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19563
 19564
 19565 7000-EXIT.
 19566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 358
* EL050.cbl
 19568 7100-FIND-BENEFIT-IN-STATE.
 19569     MOVE 'N'                    TO BEN-SEARCH-SW.
 19570
 19571     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19572         VARYING SUB3 FROM 1 BY 1 UNTIL
 19573            ((SUB3 GREATER 50) OR
 19574              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19575               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19576
 19577     IF SUB3 NOT = 51
 19578         MOVE 'Y'                TO BEN-SEARCH-SW.
 19579
 19580     GO TO 7199-EXIT.
 19581
 19582 7100-BENEFIT-DUMMY.
 19583
 19584 7100-DUMMY-EXIT.
 19585     EXIT.
 19586
 19587 7199-EXIT.
 19588     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 359
* EL050.cbl
 19590 7200-FIND-BENEFIT.
 19591     MOVE 'N'                    TO BEN-SEARCH-SW.
 19592
 19593     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19594         VARYING SUB3 FROM 1 BY 1 UNTIL
 19595            ((SUB3 GREATER 8) OR
 19596            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19597
 19598     IF SUB3 NOT = 9
 19599         MOVE 'Y'                TO BEN-SEARCH-SW.
 19600
 19601     GO TO 7200-EXIT.
 19602
 19603 7200-BENEFIT-DUMMY.
 19604
 19605 7200-DUMMY-EXIT.
 19606     EXIT.
 19607
 19608 7200-EXIT.
 19609     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 360
* EL050.cbl
 19611 7250-LOOK-FOR-RESCINDED-CLAIM.
 19612     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19613                                    W-CL-COMP-CD.
 19614     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19615                                    W-CL-CERT-NO.
 19616
 19617
 19618* EXEC CICS HANDLE CONDITION
 19619*        NOTFND  (7250-CONTINUE)
 19620*        ENDFILE (7250-CONTINUE)
 19621*    END-EXEC.
 19622*    MOVE '"$I''                  ! ) #00019381' TO DFHEIV0
 19623     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19624     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19625     MOVE X'2920233030303139333831' TO DFHEIV0(25:11)
 19626     CALL 'kxdfhei1' USING DFHEIV0
 19627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19628
 19629
 19630
 19631* EXEC CICS IGNORE CONDITION
 19632*        DUPKEY
 19633*    END-EXEC.
 19634*    MOVE '"*$                   !   #00019386' TO DFHEIV0
 19635     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19636     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19637     MOVE X'2020233030303139333836' TO DFHEIV0(25:11)
 19638     CALL 'kxdfhei1' USING DFHEIV0
 19639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19640
 19641
 19642
 19643* EXEC CICS STARTBR
 19644*        DATASET   (CLMS-ID)
 19645*        RIDFLD    (ELMSTR-KEY)
 19646*        GENERIC   EQUAL
 19647*        KEYLENGTH (ELMSTR-LENGTH)
 19648*    END-EXEC.
 19649     MOVE 0
 19650       TO DFHEIV11
 19651*    MOVE '&,   KG    E          &   #00019390' TO DFHEIV0
 19652     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19653     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19654     MOVE X'2020233030303139333930' TO DFHEIV0(25:11)
 19655     CALL 'kxdfhei1' USING DFHEIV0,
 19656           CLMS-ID,
 19657           ELMSTR-KEY,
 19658           ELMSTR-LENGTH,
 19659           DFHEIV11,
 19660           DFHEIV99
 19661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19662
 19663
 19664     MOVE 'Y'                    TO W-BROWSE-SW.
 19665
 19666 7250-NEXT-CLAIM.
 19667
 19668
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 361
* EL050.cbl
 19669* EXEC CICS READNEXT
 19670*        DATASET   (CLMS-ID)
 19671*        RIDFLD    (ELMSTR-KEY)
 19672*        SET       (ADDRESS OF CLAIM-MASTER)
 19673*    END-EXEC.
 19674     MOVE 0
 19675       TO DFHEIV11
 19676*    MOVE '&.S                   )   #00019401' TO DFHEIV0
 19677     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19678     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19679     MOVE X'2020233030303139343031' TO DFHEIV0(25:11)
 19680     CALL 'kxdfhei1' USING DFHEIV0,
 19681           CLMS-ID,
 19682           DFHEIV20,
 19683           DFHEIV99,
 19684           ELMSTR-KEY,
 19685           DFHEIV99,
 19686           DFHEIV11,
 19687           DFHEIV99,
 19688           DFHEIV99
 19689     SET ADDRESS OF CLAIM-MASTER TO
 19690         DFHEIV20
 19691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19692
 19693
 19694     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19695        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19696         GO TO 7250-CONTINUE
 19697     END-IF.
 19698
 19699     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19700        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19701        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19702        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19703        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19704         GO TO 7250-NEXT-CLAIM
 19705     END-IF.
 19706
 19707     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19708        OR (CL-CLAIM-TYPE = 'I')
 19709        OR (CL-CLAIM-TYPE = 'G')
 19710        OR (CL-CLAIM-TYPE = 'F')
 19711          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19712              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19713              GO TO 7250-CONTINUE
 19714          END-IF
 19715     END-IF.
 19716
 19717     GO TO 7250-NEXT-CLAIM.
 19718
 19719 7250-CONTINUE.
 19720
 19721     IF W-BROWSE-SW = 'Y'
 19722
 19723* EXEC CICS ENDBR
 19724*            DATASET   (CLMS-ID)
 19725*        END-EXEC
 19726     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 362
* EL050.cbl
 19727       TO DFHEIV11
 19728*    MOVE '&2                    $   #00019435' TO DFHEIV0
 19729     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19730     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19731     MOVE X'2020233030303139343335' TO DFHEIV0(25:11)
 19732     CALL 'kxdfhei1' USING DFHEIV0,
 19733           CLMS-ID,
 19734           DFHEIV11,
 19735           DFHEIV99
 19736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19737         MOVE 'N' TO W-BROWSE-SW
 19738     END-IF.
 19739
 19740 7250-EXIT.
 19741     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 363
* EL050.cbl
 19743 7300-CHECK-FOR-OPEN-CLMS.
 19744
 19745*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19746*    MOVE SPACES                 TO CNTL-ACCESS.
 19747*    MOVE '1'                    TO CNTL-REC-TYPE.
 19748*    MOVE +0                     TO CNTL-SEQ-NO.
 19749
 19750*    MOVE '3'                    TO RC-SW-1.
 19751*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19752
 19753*    IF NOT CF-COMPANY-MASTER
 19754*         PERFORM 0099-COMPANY-NOT-FOUND
 19755*         GO TO 7300-EXIT.
 19756
 19757     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19758                                    W-CL-COMP-CD.
 19759     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19760                                    W-CL-CERT-NO.
 19761
 19762
 19763* EXEC CICS HANDLE CONDITION
 19764*        NOTFND  (7300-CONTINUE)
 19765*        ENDFILE (7300-CONTINUE)
 19766*    END-EXEC.
 19767*    MOVE '"$I''                  ! * #00019463' TO DFHEIV0
 19768     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19770     MOVE X'2A20233030303139343633' TO DFHEIV0(25:11)
 19771     CALL 'kxdfhei1' USING DFHEIV0
 19772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19773
 19774
 19775
 19776* EXEC CICS IGNORE CONDITION
 19777*        DUPKEY
 19778*    END-EXEC.
 19779*    MOVE '"*$                   !   #00019468' TO DFHEIV0
 19780     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19782     MOVE X'2020233030303139343638' TO DFHEIV0(25:11)
 19783     CALL 'kxdfhei1' USING DFHEIV0
 19784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19785
 19786
 19787
 19788* EXEC CICS STARTBR
 19789*        DATASET   (CLMS-ID)
 19790*        RIDFLD    (ELMSTR-KEY)
 19791*        GENERIC   EQUAL
 19792*        KEYLENGTH (ELMSTR-LENGTH)
 19793*    END-EXEC.
 19794     MOVE 0
 19795       TO DFHEIV11
 19796*    MOVE '&,   KG    E          &   #00019472' TO DFHEIV0
 19797     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19798     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19799     MOVE X'2020233030303139343732' TO DFHEIV0(25:11)
 19800     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 364
* EL050.cbl
 19801           CLMS-ID,
 19802           ELMSTR-KEY,
 19803           ELMSTR-LENGTH,
 19804           DFHEIV11,
 19805           DFHEIV99
 19806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19807
 19808
 19809     MOVE 'Y'                    TO W-BROWSE-SW.
 19810
 19811 7300-NEXT-CLAIM.
 19812
 19813
 19814* EXEC CICS READNEXT
 19815*        DATASET   (CLMS-ID)
 19816*        RIDFLD    (ELMSTR-KEY)
 19817*        SET       (ADDRESS OF CLAIM-MASTER)
 19818*    END-EXEC.
 19819     MOVE 0
 19820       TO DFHEIV11
 19821*    MOVE '&.S                   )   #00019483' TO DFHEIV0
 19822     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19823     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19824     MOVE X'2020233030303139343833' TO DFHEIV0(25:11)
 19825     CALL 'kxdfhei1' USING DFHEIV0,
 19826           CLMS-ID,
 19827           DFHEIV20,
 19828           DFHEIV99,
 19829           ELMSTR-KEY,
 19830           DFHEIV99,
 19831           DFHEIV11,
 19832           DFHEIV99,
 19833           DFHEIV99
 19834     SET ADDRESS OF CLAIM-MASTER TO
 19835         DFHEIV20
 19836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19837
 19838
 19839     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19840        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19841         GO TO 7300-CONTINUE.
 19842
 19843     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19844        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19845        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19846        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19847        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19848         GO TO 7300-NEXT-CLAIM.
 19849
 19850*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19851     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19852        OR (CL-CLAIM-TYPE = 'I')
 19853        OR (CL-CLAIM-TYPE = 'G')
 19854        OR (CL-CLAIM-TYPE = 'F')
 19855        IF CLAIM-IS-OPEN
 19856           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19857             AND PB-C-AH-CANCEL-DT > SPACES
 19858              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 365
* EL050.cbl
 19859              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19860           END-IF
 19861           EVALUATE TRUE
 19862             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19863                 MOVE ER-2884      TO WS-ERROR
 19864             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19865                 MOVE ER-2887      TO WS-ERROR
 19866             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19867                 MOVE ER-2886      TO WS-ERROR
 19868             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19869                 MOVE ER-2888      TO WS-ERROR
 19870             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19871                 MOVE ER-2885      TO WS-ERROR
 19872             WHEN OTHER
 19873                 MOVE ER-2768      TO WS-ERROR
 19874           END-EVALUATE
 19875           IF PB-C-AH-CANCEL-VOIDED OR
 19876              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19877                NOT AH-COVERAGE-CANCELLED)
 19878               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19879               MOVE ER-2768      TO WS-ERROR
 19880           END-IF
 19881           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19882           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19883              PB-FORCE-CODE NOT EQUAL '8'
 19884               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19885           END-IF
 19886           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19887           GO TO 7300-NEXT-CLAIM
 19888        ELSE
 19889           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19890*****THIS IS A RESCISSION OR REFORMATION
 19891              IF AH-COVERAGE-CANCELLED
 19892                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19893                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19894                    MOVE 1                   TO DC-ELAPSED-DAYS
 19895                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19896                    SET BIN-PLUS-ELAPSED     TO TRUE
 19897                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19898                    IF NO-CONVERSION-ERROR
 19899                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19900                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19901                          MOVE ER-2897 TO WS-ERROR
 19902                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19903                          GO TO 7300-NEXT-CLAIM
 19904                       END-IF
 19905                    END-IF
 19906                 ELSE
 19907                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19908                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19909                         MOVE ER-2890 TO WS-ERROR
 19910                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19911                         GO TO 7300-NEXT-CLAIM
 19912                      ELSE
 19913                         MOVE ER-2898 TO WS-ERROR
 19914                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19915                         GO TO 7300-NEXT-CLAIM
 19916                      END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 366
* EL050.cbl
 19917                   END-IF
 19918                 END-IF
 19919              END-IF
 19920           ELSE
 19921              IF CL-DENIAL-TYPE = '1'  AND
 19922                 CL-TOTAL-PAID-AMT = 0
 19923                    GO TO 7300-NEXT-CLAIM
 19924              END-IF
 19925              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19926               AND PB-C-AH-CANCEL-DT > SPACES
 19927                 MOVE ER-2756        TO WS-ERROR
 19928                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19929                 GO TO 7300-NEXT-CLAIM
 19930              END-IF
 19931           END-IF
 19932        END-IF
 19933     ELSE
 19934*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19935        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19936           IF (CLAIM-IS-OPEN)
 19937              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19938                 <> zeros
 19939              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19940                 <> zeros)
 19941              MOVE ER-2889      TO WS-ERROR
 19942              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19943              GO TO 7300-NEXT-CLAIM
 19944           ELSE
 19945              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19946*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19947                 IF (LF-COVERAGE-CANCELLED AND
 19948                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19949                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19950                         MOVE ER-2890 TO WS-ERROR
 19951                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19952                         GO TO 7300-NEXT-CLAIM
 19953                      ELSE
 19954                         MOVE ER-2898 TO WS-ERROR
 19955                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19956                         GO TO 7300-NEXT-CLAIM
 19957                      END-IF
 19958                 END-IF
 19959              ELSE
 19960                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19961                    and (CL-TOTAL-PAID-AMT = 0)
 19962                    GO TO 7300-NEXT-CLAIM
 19963                 END-IF
 19964                 IF (
 19965                      (AH-COVERAGE-CANCELLED)
 19966                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19967                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19968                      and (pb-ci-ah-cancel-amt +
 19969                         pb-c-ah-cancel-amt) <> zeros
 19970                    )
 19971                               OR
 19972                    (
 19973                      (LF-COVERAGE-CANCELLED)
 19974                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 367
* EL050.cbl
 19975                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19976                      and (pb-ci-lf-cancel-amt +
 19977                         pb-c-lf-cancel-amt) <> zeros
 19978                    )
 19979                       MOVE ER-2965 TO WS-ERROR
 19980                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19981                       GO TO 7300-NEXT-CLAIM
 19982                 END-IF
 19983                 IF LF-COVERAGE-CANCELLED
 19984                  IF CL-TOTAL-PAID-AMT > 0
 19985                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19986                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19987                        MOVE ER-2891 TO WS-ERROR
 19988                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19989                        GO TO 7300-NEXT-CLAIM
 19990                      END-IF
 19991                    ELSE
 19992****only show this error if cert num matches exactly
 19993                      IF PB-CERT-NO = CL-CERT-NO
 19994                         MOVE ER-2892 TO WS-ERROR
 19995                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19996                         GO TO 7300-NEXT-CLAIM
 19997                      END-IF
 19998                    END-IF
 19999                  END-IF
 20000                 END-IF
 20001              END-IF
 20002           END-IF
 20003        END-IF
 20004     END-IF
 20005
 20006     GO TO 7300-NEXT-CLAIM.
 20007
 20008 7300-CONTINUE.
 20009
 20010     IF W-BROWSE-SW = 'Y'
 20011
 20012* EXEC CICS ENDBR
 20013*            DATASET   (CLMS-ID)
 20014*        END-EXEC.
 20015     MOVE 0
 20016       TO DFHEIV11
 20017*    MOVE '&2                    $   #00019661' TO DFHEIV0
 20018     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20019     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20020     MOVE X'2020233030303139363631' TO DFHEIV0(25:11)
 20021     CALL 'kxdfhei1' USING DFHEIV0,
 20022           CLMS-ID,
 20023           DFHEIV11,
 20024           DFHEIV99
 20025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20026
 20027
 20028 7300-EXIT.
 20029     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 368
* EL050.cbl
 20031
 20032 7400-GET-REMAIN-TERM.
 20033
 20034* EXEC CICS LINK
 20035*        PROGRAM    ('ELRTRM')
 20036*        COMMAREA   (CALCULATION-PASS-AREA)
 20037*        LENGTH     (CP-COMM-LENGTH)
 20038*    END-EXEC.
 20039     MOVE 'ELRTRM' TO DFHEIV1
 20040*    MOVE '."C                   (   #00019670' TO DFHEIV0
 20041     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20043     MOVE X'2020233030303139363730' TO DFHEIV0(25:11)
 20044     CALL 'kxdfhei1' USING DFHEIV0,
 20045           DFHEIV1,
 20046           CALCULATION-PASS-AREA,
 20047           CP-COMM-LENGTH,
 20048           DFHEIV99,
 20049           DFHEIV99,
 20050           DFHEIV99,
 20051           DFHEIV99
 20052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20053
 20054
 20055 7400-EXIT.
 20056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 369
* EL050.cbl
 20058
 20059 7500-GET-REMAIN-AMOUNT.
 20060
 20061* EXEC CICS LINK
 20062*        PROGRAM    ('ELRAMT')
 20063*        COMMAREA   (CALCULATION-PASS-AREA)
 20064*        LENGTH     (CP-COMM-LENGTH)
 20065*    END-EXEC.
 20066     MOVE 'ELRAMT' TO DFHEIV1
 20067*    MOVE '."C                   (   #00019681' TO DFHEIV0
 20068     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20069     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20070     MOVE X'2020233030303139363831' TO DFHEIV0(25:11)
 20071     CALL 'kxdfhei1' USING DFHEIV0,
 20072           DFHEIV1,
 20073           CALCULATION-PASS-AREA,
 20074           CP-COMM-LENGTH,
 20075           DFHEIV99,
 20076           DFHEIV99,
 20077           DFHEIV99,
 20078           DFHEIV99
 20079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20080
 20081
 20082 7500-EXIT.
 20083     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 370
* EL050.cbl
 20085
 20086 7600-GET-REFUND.
 20087
 20088* EXEC CICS LINK
 20089*        PROGRAM    ('ELRFND')
 20090*        COMMAREA   (CALCULATION-PASS-AREA)
 20091*        LENGTH     (CP-COMM-LENGTH)
 20092*    END-EXEC.
 20093     MOVE 'ELRFND' TO DFHEIV1
 20094*    MOVE '."C                   (   #00019692' TO DFHEIV0
 20095     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20097     MOVE X'2020233030303139363932' TO DFHEIV0(25:11)
 20098     CALL 'kxdfhei1' USING DFHEIV0,
 20099           DFHEIV1,
 20100           CALCULATION-PASS-AREA,
 20101           CP-COMM-LENGTH,
 20102           DFHEIV99,
 20103           DFHEIV99,
 20104           DFHEIV99,
 20105           DFHEIV99
 20106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20107
 20108
 20109 7600-EXIT.
 20110     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 371
* EL050.cbl
 20112 7700-CALL-DL1.
 20113
 20114* EXEC CICS LINK
 20115*        PROGRAM    ('DLO001')
 20116*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20117*        LENGTH     (DLO001-COMM-LENGTH)
 20118*    END-EXEC.
 20119     MOVE 'DLO001' TO DFHEIV1
 20120*    MOVE '."C                   (   #00019702' TO DFHEIV0
 20121     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20123     MOVE X'2020233030303139373032' TO DFHEIV0(25:11)
 20124     CALL 'kxdfhei1' USING DFHEIV0,
 20125           DFHEIV1,
 20126           WS-DLO-MASTER-POLICY-FORM,
 20127           DLO001-COMM-LENGTH,
 20128           DFHEIV99,
 20129           DFHEIV99,
 20130           DFHEIV99,
 20131           DFHEIV99
 20132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20133
 20134
 20135 7700-EXIT.
 20136     EXIT.
 20137
 20138 7710-CALL-DL2.
 20139
 20140* EXEC CICS LINK
 20141*        PROGRAM    ('DLO002')
 20142*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20143*        LENGTH     (DLO002-COMM-LENGTH)
 20144*    END-EXEC.
 20145     MOVE 'DLO002' TO DFHEIV1
 20146*    MOVE '."C                   (   #00019712' TO DFHEIV0
 20147     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20148     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20149     MOVE X'2020233030303139373132' TO DFHEIV0(25:11)
 20150     CALL 'kxdfhei1' USING DFHEIV0,
 20151           DFHEIV1,
 20152           WS-DLO-INTERNAL-POLICY-FORM,
 20153           DLO002-COMM-LENGTH,
 20154           DFHEIV99,
 20155           DFHEIV99,
 20156           DFHEIV99,
 20157           DFHEIV99
 20158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20159
 20160
 20161 7710-EXIT.
 20162     EXIT.
 20163
 20164 7720-CALL-DL3.
 20165
 20166* EXEC CICS LINK
 20167*        PROGRAM    ('DLO003')
 20168*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20169*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 372
* EL050.cbl
 20170*    END-EXEC.
 20171     MOVE 'DLO003' TO DFHEIV1
 20172*    MOVE '."C                   (   #00019722' TO DFHEIV0
 20173     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20175     MOVE X'2020233030303139373232' TO DFHEIV0(25:11)
 20176     CALL 'kxdfhei1' USING DFHEIV0,
 20177           DFHEIV1,
 20178           WS-DLO-VALID-BANK-ID,
 20179           DLO003-COMM-LENGTH,
 20180           DFHEIV99,
 20181           DFHEIV99,
 20182           DFHEIV99,
 20183           DFHEIV99
 20184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20185
 20186
 20187 7720-EXIT.
 20188     EXIT.
 20189
 20190 7730-CALL-DL7.
 20191
 20192* EXEC CICS LINK
 20193*        PROGRAM    ('DLO007')
 20194*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20195*        LENGTH     (DLO007-COMM-LENGTH)
 20196*    END-EXEC.
 20197     MOVE 'DLO007' TO DFHEIV1
 20198*    MOVE '."C                   (   #00019732' TO DFHEIV0
 20199     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20200     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20201     MOVE X'2020233030303139373332' TO DFHEIV0(25:11)
 20202     CALL 'kxdfhei1' USING DFHEIV0,
 20203           DFHEIV1,
 20204           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20205           DLO007-COMM-LENGTH,
 20206           DFHEIV99,
 20207           DFHEIV99,
 20208           DFHEIV99,
 20209           DFHEIV99
 20210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20211
 20212
 20213 7730-EXIT.
 20214     EXIT.
 20215
 20216 7740-CALL-DL11.
 20217
 20218* EXEC CICS LINK
 20219*        PROGRAM    ('DLO011')
 20220*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20221*        LENGTH     (DLO011-COMM-LENGTH)
 20222*    END-EXEC.
 20223     MOVE 'DLO011' TO DFHEIV1
 20224*    MOVE '."C                   (   #00019742' TO DFHEIV0
 20225     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20226     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20227     MOVE X'2020233030303139373432' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 373
* EL050.cbl
 20228     CALL 'kxdfhei1' USING DFHEIV0,
 20229           DFHEIV1,
 20230           WS-DLO-PREM-RATES-BEN-TYPE,
 20231           DLO011-COMM-LENGTH,
 20232           DFHEIV99,
 20233           DFHEIV99,
 20234           DFHEIV99,
 20235           DFHEIV99
 20236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20237
 20238
 20239 7740-EXIT.
 20240     EXIT.
 20241
 20242 7750-CALL-DL17.
 20243
 20244* EXEC CICS LINK
 20245*        PROGRAM    ('DLO017')
 20246*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20247*        LENGTH     (DLO017-COMM-LENGTH)
 20248*    END-EXEC.
 20249     MOVE 'DLO017' TO DFHEIV1
 20250*    MOVE '."C                   (   #00019752' TO DFHEIV0
 20251     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20252     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20253     MOVE X'2020233030303139373532' TO DFHEIV0(25:11)
 20254     CALL 'kxdfhei1' USING DFHEIV0,
 20255           DFHEIV1,
 20256           WS-DLO-VALID-RATE-CODE,
 20257           DLO017-COMM-LENGTH,
 20258           DFHEIV99,
 20259           DFHEIV99,
 20260           DFHEIV99,
 20261           DFHEIV99
 20262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20263
 20264
 20265 7750-EXIT.
 20266     EXIT.
 20267
 20268 7755-CALL-DL19.
 20269
 20270* EXEC CICS LINK
 20271*        PROGRAM    ('DLO019')
 20272*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20273*        LENGTH     (DLO019-COMM-LENGTH)
 20274*    END-EXEC.
 20275     MOVE 'DLO019' TO DFHEIV1
 20276*    MOVE '."C                   (   #00019762' TO DFHEIV0
 20277     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20278     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20279     MOVE X'2020233030303139373632' TO DFHEIV0(25:11)
 20280     CALL 'kxdfhei1' USING DFHEIV0,
 20281           DFHEIV1,
 20282           WS-DLO-ORIG-COV-CAT,
 20283           DLO019-COMM-LENGTH,
 20284           DFHEIV99,
 20285           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 374
* EL050.cbl
 20286           DFHEIV99,
 20287           DFHEIV99
 20288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20289
 20290
 20291 7755-EXIT.
 20292     EXIT.
 20293
 20294 7760-CALL-DL21.
 20295
 20296* EXEC CICS LINK
 20297*        PROGRAM    ('DLO021')
 20298*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20299*        LENGTH     (DLO021-COMM-LENGTH)
 20300*    END-EXEC.
 20301     MOVE 'DLO021' TO DFHEIV1
 20302*    MOVE '."C                   (   #00019772' TO DFHEIV0
 20303     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20304     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20305     MOVE X'2020233030303139373732' TO DFHEIV0(25:11)
 20306     CALL 'kxdfhei1' USING DFHEIV0,
 20307           DFHEIV1,
 20308           WS-DLO-VALID-LOAN-OFFICER,
 20309           DLO021-COMM-LENGTH,
 20310           DFHEIV99,
 20311           DFHEIV99,
 20312           DFHEIV99,
 20313           DFHEIV99
 20314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20315
 20316
 20317 7760-EXIT.
 20318     EXIT.
 20319
 20320 7770-CALL-DL22.
 20321
 20322* EXEC CICS LINK
 20323*        PROGRAM    ('DLO022')
 20324*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20325*        LENGTH     (DLO022-COMM-LENGTH)
 20326*    END-EXEC.
 20327     MOVE 'DLO022' TO DFHEIV1
 20328*    MOVE '."C                   (   #00019782' TO DFHEIV0
 20329     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20330     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20331     MOVE X'2020233030303139373832' TO DFHEIV0(25:11)
 20332     CALL 'kxdfhei1' USING DFHEIV0,
 20333           DFHEIV1,
 20334           WS-DLO-VALID-STATE-CODE,
 20335           DLO022-COMM-LENGTH,
 20336           DFHEIV99,
 20337           DFHEIV99,
 20338           DFHEIV99,
 20339           DFHEIV99
 20340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20341
 20342
 20343 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 375
* EL050.cbl
 20344     EXIT.
 20345
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 376
* EL050.cbl
 20347
 20348 7780-CALL-AGG.
 20349
 20350* EXEC CICS LINK
 20351*        PROGRAM    ('ELAGGO')
 20352*        COMMAREA   (WS-PASS-to-pemaggo)
 20353*        LENGTH     (ws-passed-key-LENGTH)
 20354*    END-EXEC.
 20355     MOVE 'ELAGGO' TO DFHEIV1
 20356*    MOVE '."C                   (   #00019794' TO DFHEIV0
 20357     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20358     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20359     MOVE X'2020233030303139373934' TO DFHEIV0(25:11)
 20360     CALL 'kxdfhei1' USING DFHEIV0,
 20361           DFHEIV1,
 20362           WS-PASS-to-pemaggo,
 20363           ws-passed-key-LENGTH,
 20364           DFHEIV99,
 20365           DFHEIV99,
 20366           DFHEIV99,
 20367           DFHEIV99
 20368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20369
 20370 7780-EXIT.
 20371     EXIT.
 20372 7785-CALL-HLDI.
 20373
 20374* EXEC CICS LINK
 20375*        PROGRAM    ('ELHLDI')
 20376*        COMMAREA   (HLDI-PASS-AREA)
 20377*        LENGTH     (HLDI-PASS-AREA-LEN)
 20378*    END-EXEC.
 20379     MOVE 'ELHLDI' TO DFHEIV1
 20380*    MOVE '."C                   (   #00019802' TO DFHEIV0
 20381     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20382     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20383     MOVE X'2020233030303139383032' TO DFHEIV0(25:11)
 20384     CALL 'kxdfhei1' USING DFHEIV0,
 20385           DFHEIV1,
 20386           HLDI-PASS-AREA,
 20387           HLDI-PASS-AREA-LEN,
 20388           DFHEIV99,
 20389           DFHEIV99,
 20390           DFHEIV99,
 20391           DFHEIV99
 20392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20393
 20394 7785-EXIT.
 20395     EXIT.
 20396 7786-CALL-HLDIM.
 20397
 20398* EXEC CICS LINK
 20399*        PROGRAM    ('ELHLDIM')
 20400*        COMMAREA   (HLDI-PASS-AREA)
 20401*        LENGTH     (HLDI-PASS-AREA-LEN)
 20402*    END-EXEC.
 20403     MOVE 'ELHLDIM' TO DFHEIV1
 20404*    MOVE '."C                   (   #00019810' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 377
* EL050.cbl
 20405     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20406     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20407     MOVE X'2020233030303139383130' TO DFHEIV0(25:11)
 20408     CALL 'kxdfhei1' USING DFHEIV0,
 20409           DFHEIV1,
 20410           HLDI-PASS-AREA,
 20411           HLDI-PASS-AREA-LEN,
 20412           DFHEIV99,
 20413           DFHEIV99,
 20414           DFHEIV99,
 20415           DFHEIV99
 20416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20417
 20418 7786-EXIT.
 20419     EXIT.
 20420 7790-CALL-ZIP-VERIFY.
 20421
 20422
 20423* EXEC CICS LINK
 20424*        PROGRAM    ('WSZIPCD')
 20425*        COMMAREA   (ZIPCD-PASS-AREA)
 20426*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20427*    END-EXEC.
 20428     MOVE 'WSZIPCD' TO DFHEIV1
 20429*    MOVE '."C                   (   #00019819' TO DFHEIV0
 20430     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20432     MOVE X'2020233030303139383139' TO DFHEIV0(25:11)
 20433     CALL 'kxdfhei1' USING DFHEIV0,
 20434           DFHEIV1,
 20435           ZIPCD-PASS-AREA,
 20436           ZIPCD-PASS-AREA-LEN,
 20437           DFHEIV99,
 20438           DFHEIV99,
 20439           DFHEIV99,
 20440           DFHEIV99
 20441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20442
 20443
 20444 7790-EXIT.
 20445     EXIT.
 20446 7800-REWRITE-CERT.
 20447******************************************************************
 20448*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20449*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20450******************************************************************
 20451
 20452     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20453        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20454        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20455        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20456
 20457* EXEC CICS REWRITE
 20458*                  DATASET (CERT-ID)
 20459*                  FROM    (CERTIFICATE-MASTER)
 20460*              END-EXEC
 20461     MOVE LENGTH OF
 20462      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 378
* EL050.cbl
 20463       TO DFHEIV11
 20464*    MOVE '&& L                  %   #00019837' TO DFHEIV0
 20465     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20466     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20467     MOVE X'2020233030303139383337' TO DFHEIV0(25:11)
 20468     CALL 'kxdfhei1' USING DFHEIV0,
 20469           CERT-ID,
 20470           CERTIFICATE-MASTER,
 20471           DFHEIV11,
 20472           DFHEIV99
 20473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20474        GO TO 7800-EXIT.
 20475
 20476       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20477       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20478
 20479 7800-EXIT.
 20480      EXIT.
 20481
 20482 7900-DELETE-CERT.
 20483
 20484* EXEC CICS DELETE
 20485*        DATASET (CERT-ID)
 20486*    END-EXEC.
 20487*    MOVE '&(                    &   #00019850' TO DFHEIV0
 20488     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20489     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20490     MOVE X'2020233030303139383530' TO DFHEIV0(25:11)
 20491     CALL 'kxdfhei1' USING DFHEIV0,
 20492           CERT-ID,
 20493           DFHEIV99,
 20494           DFHEIV99,
 20495           DFHEIV99,
 20496           DFHEIV99
 20497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20498
 20499
 20500 7900-EXIT.
 20501     EXIT.
 20502
 20503 8000-WRITE-CERT.
 20504
 20505* EXEC CICS HANDLE CONDITION
 20506*        DUPKEY    (8000-FREE-MAIN)
 20507*    END-EXEC.
 20508*    MOVE '"$$                   ! + #00019858' TO DFHEIV0
 20509     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20511     MOVE X'2B20233030303139383538' TO DFHEIV0(25:11)
 20512     CALL 'kxdfhei1' USING DFHEIV0
 20513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20514
 20515
 20516
 20517* EXEC CICS WRITE
 20518*        DATASET     (CERT-ID)
 20519*        FROM        (CERTIFICATE-MASTER)
 20520*        RIDFLD      (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 379
* EL050.cbl
 20521*    END-EXEC.
 20522     MOVE LENGTH OF
 20523      CERTIFICATE-MASTER
 20524       TO DFHEIV11
 20525*    MOVE '&$ L                  ''   #00019862' TO DFHEIV0
 20526     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20527     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20528     MOVE X'2020233030303139383632' TO DFHEIV0(25:11)
 20529     CALL 'kxdfhei1' USING DFHEIV0,
 20530           CERT-ID,
 20531           CERTIFICATE-MASTER,
 20532           DFHEIV11,
 20533           ELCERT-KEY,
 20534           DFHEIV99,
 20535           DFHEIV99
 20536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20537
 20538
 20539 8000-FREE-MAIN.
 20540
 20541 8000-EXIT.
 20542      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 380
* EL050.cbl
 20544
 20545 8100-READ-ERPNDM.
 20546
 20547* EXEC CICS HANDLE CONDITION
 20548*         NOTFND     (8100-NOTFND)
 20549*         ENDFILE    (8100-NOTFND)
 20550*    END-EXEC.
 20551*    MOVE '"$I''                  ! , #00019875' TO DFHEIV0
 20552     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20554     MOVE X'2C20233030303139383735' TO DFHEIV0(25:11)
 20555     CALL 'kxdfhei1' USING DFHEIV0
 20556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20557
 20558
 20559     MOVE SPACES                 TO ERPNDM-FOUND.
 20560     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20561
 20562
 20563* EXEC CICS READ UPDATE
 20564*         DATASET   (FILE-ERPNDM)
 20565*         RIDFLD    (PM-CONTROL-PRIMARY)
 20566*         INTO      (PENDING-MAILING-DATA)
 20567*    END-EXEC.
 20568     MOVE LENGTH OF
 20569      PENDING-MAILING-DATA
 20570       TO DFHEIV11
 20571*    MOVE '&"IL       EU         (   #00019883' TO DFHEIV0
 20572     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20573     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20574     MOVE X'2020233030303139383833' TO DFHEIV0(25:11)
 20575     CALL 'kxdfhei1' USING DFHEIV0,
 20576           FILE-ERPNDM,
 20577           PENDING-MAILING-DATA,
 20578           DFHEIV11,
 20579           PM-CONTROL-PRIMARY,
 20580           DFHEIV99,
 20581           DFHEIV99,
 20582           DFHEIV99
 20583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20584
 20585
 20586     GO TO 8100-EXIT.
 20587
 20588 8100-NOTFND.
 20589
 20590     MOVE 'X'                    TO ERPNDM-FOUND.
 20591     MOVE ER-2694                TO WS-ERROR.
 20592     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20593     MOVE ER-2883                TO WS-ERROR
 20594     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20595     .
 20596 8100-EXIT.
 20597     EXIT.
 20598 8102-REWRITE-ERPNDM.
 20599
 20600
 20601* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 381
* EL050.cbl
 20602*         DATASET    (FILE-ERPNDM)
 20603*         FROM       (PENDING-MAILING-DATA)
 20604*    END-EXEC
 20605     MOVE LENGTH OF
 20606      PENDING-MAILING-DATA
 20607       TO DFHEIV11
 20608*    MOVE '&& L                  %   #00019903' TO DFHEIV0
 20609     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20610     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20611     MOVE X'2020233030303139393033' TO DFHEIV0(25:11)
 20612     CALL 'kxdfhei1' USING DFHEIV0,
 20613           FILE-ERPNDM,
 20614           PENDING-MAILING-DATA,
 20615           DFHEIV11,
 20616           DFHEIV99
 20617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20618
 20619     .
 20620 8102-EXIT.
 20621     EXIT.
 20622 8104-UNLOCK-ERPNDM.
 20623
 20624
 20625* EXEC CICS UNLOCK
 20626*         DATASET   (FILE-ERPNDM)
 20627*    END-EXEC
 20628*    MOVE '&*                    #   #00019913' TO DFHEIV0
 20629     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20630     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20631     MOVE X'2020233030303139393133' TO DFHEIV0(25:11)
 20632     CALL 'kxdfhei1' USING DFHEIV0,
 20633           FILE-ERPNDM,
 20634           DFHEIV99
 20635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20636
 20637     .
 20638 8104-EXIT.
 20639     EXIT.
 20640 8110-READ-ERMAIL.
 20641
 20642* EXEC CICS HANDLE CONDITION
 20643*         NOTFND     (8110-NOTFND)
 20644*         ENDFILE    (8110-NOTFND)
 20645*    END-EXEC.
 20646*    MOVE '"$I''                  ! - #00019921' TO DFHEIV0
 20647     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20649     MOVE X'2D20233030303139393231' TO DFHEIV0(25:11)
 20650     CALL 'kxdfhei1' USING DFHEIV0
 20651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20652
 20653
 20654     MOVE SPACES                 TO ERMAIL-FOUND.
 20655     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20656     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20657     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20658     MOVE PB-SV-STATE            TO MA-STATE.
 20659
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 382
* EL050.cbl
 20660
 20661* EXEC CICS READ
 20662*         UPDATE
 20663*         DATASET   (FILE-ERMAIL)
 20664*         RIDFLD    (MA-CONTROL-PRIMARY)
 20665*         INTO      (MAILING-DATA)
 20666*    END-EXEC.
 20667     MOVE LENGTH OF
 20668      MAILING-DATA
 20669       TO DFHEIV11
 20670*    MOVE '&"IL       EU         (   #00019932' TO DFHEIV0
 20671     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20672     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20673     MOVE X'2020233030303139393332' TO DFHEIV0(25:11)
 20674     CALL 'kxdfhei1' USING DFHEIV0,
 20675           FILE-ERMAIL,
 20676           MAILING-DATA,
 20677           DFHEIV11,
 20678           MA-CONTROL-PRIMARY,
 20679           DFHEIV99,
 20680           DFHEIV99,
 20681           DFHEIV99
 20682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20683
 20684
 20685     GO TO 8110-EXIT.
 20686
 20687 8110-NOTFND.
 20688     MOVE 'X'                    TO ERMAIL-FOUND.
 20689
 20690 8110-EXIT.
 20691     EXIT.
 20692
 20693 8120-REWRITE-ERMAIL.
 20694
 20695* EXEC CICS REWRITE
 20696*         DATASET    (FILE-ERMAIL)
 20697*         FROM       (MAILING-DATA)
 20698*    END-EXEC.
 20699     MOVE LENGTH OF
 20700      MAILING-DATA
 20701       TO DFHEIV11
 20702*    MOVE '&& L                  %   #00019948' TO DFHEIV0
 20703     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20704     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20705     MOVE X'2020233030303139393438' TO DFHEIV0(25:11)
 20706     CALL 'kxdfhei1' USING DFHEIV0,
 20707           FILE-ERMAIL,
 20708           MAILING-DATA,
 20709           DFHEIV11,
 20710           DFHEIV99
 20711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20712
 20713
 20714 8120-EXIT.
 20715     EXIT.
 20716
 20717 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 383
* EL050.cbl
 20718
 20719* EXEC CICS HANDLE CONDITION
 20720*         DUPKEY   (8130-EXIT)
 20721*    END-EXEC.
 20722*    MOVE '"$$                   ! . #00019957' TO DFHEIV0
 20723     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20724     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20725     MOVE X'2E20233030303139393537' TO DFHEIV0(25:11)
 20726     CALL 'kxdfhei1' USING DFHEIV0
 20727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20728
 20729
 20730
 20731* EXEC CICS WRITE
 20732*         DATASET     (FILE-ERMAIL)
 20733*         RIDFLD      (MA-CONTROL-PRIMARY)
 20734*         FROM        (MAILING-DATA)
 20735*    END-EXEC.
 20736     MOVE LENGTH OF
 20737      MAILING-DATA
 20738       TO DFHEIV11
 20739*    MOVE '&$ L                  ''   #00019961' TO DFHEIV0
 20740     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20742     MOVE X'2020233030303139393631' TO DFHEIV0(25:11)
 20743     CALL 'kxdfhei1' USING DFHEIV0,
 20744           FILE-ERMAIL,
 20745           MAILING-DATA,
 20746           DFHEIV11,
 20747           MA-CONTROL-PRIMARY,
 20748           DFHEIV99,
 20749           DFHEIV99
 20750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20751
 20752
 20753 8130-EXIT.
 20754     EXIT.
 20755
 20756 8140-UNLOCK-ERMAIL.
 20757
 20758* EXEC CICS UNLOCK
 20759*         DATASET   (FILE-ERMAIL)
 20760*    END-EXEC.
 20761*    MOVE '&*                    #   #00019971' TO DFHEIV0
 20762     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20763     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20764     MOVE X'2020233030303139393731' TO DFHEIV0(25:11)
 20765     CALL 'kxdfhei1' USING DFHEIV0,
 20766           FILE-ERMAIL,
 20767           DFHEIV99
 20768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20769
 20770
 20771 8140-EXIT.
 20772     EXIT.
 20773
 20774 8150-read-elcrtt.
 20775
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 384
* EL050.cbl
 20776
 20777* EXEC CICS HANDLE CONDITION
 20778*        NOTFND   (8150-exit)
 20779*    END-EXEC
 20780*    MOVE '"$I                   ! / #00019980' TO DFHEIV0
 20781     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20783     MOVE X'2F20233030303139393830' TO DFHEIV0(25:11)
 20784     CALL 'kxdfhei1' USING DFHEIV0
 20785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20786
 20787     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20788     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20789
 20790
 20791* EXEC CICS READ
 20792*        DATASET  (CRTT-ID)
 20793*        RIDFLD   (WS-ELCRTT-KEY)
 20794*        INTO     (CERTIFICATE-TRAILERS)
 20795*    END-EXEC
 20796     MOVE LENGTH OF
 20797      CERTIFICATE-TRAILERS
 20798       TO DFHEIV11
 20799*    MOVE '&"IL       E          (   #00019987' TO DFHEIV0
 20800     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20802     MOVE X'2020233030303139393837' TO DFHEIV0(25:11)
 20803     CALL 'kxdfhei1' USING DFHEIV0,
 20804           CRTT-ID,
 20805           CERTIFICATE-TRAILERS,
 20806           DFHEIV11,
 20807           WS-ELCRTT-KEY,
 20808           DFHEIV99,
 20809           DFHEIV99,
 20810           DFHEIV99
 20811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20812
 20813     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20814     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20815     move cs-vehicle-odometer    to ws-vehicle-odometer
 20816
 20817     .
 20818 8150-exit.
 20819     exit.
 20820 8180-UPDATE-VIN-NUMBER.
 20821
 20822* EXEC CICS HANDLE CONDITION
 20823*        NOTFND   (8180-NOTFND)
 20824*    END-EXEC.
 20825*    MOVE '"$I                   ! 0 #00020001' TO DFHEIV0
 20826     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20828     MOVE X'3020233030303230303031' TO DFHEIV0(25:11)
 20829     CALL 'kxdfhei1' USING DFHEIV0
 20830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20831
 20832
 20833     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 385
* EL050.cbl
 20834     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20835
 20836
 20837* EXEC CICS READ
 20838*        UPDATE
 20839*        DATASET  (CRTT-ID)
 20840*        RIDFLD   (WS-ELCRTT-KEY)
 20841*        INTO     (CERTIFICATE-TRAILERS)
 20842*    END-EXEC.
 20843     MOVE LENGTH OF
 20844      CERTIFICATE-TRAILERS
 20845       TO DFHEIV11
 20846*    MOVE '&"IL       EU         (   #00020008' TO DFHEIV0
 20847     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20848     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20849     MOVE X'2020233030303230303038' TO DFHEIV0(25:11)
 20850     CALL 'kxdfhei1' USING DFHEIV0,
 20851           CRTT-ID,
 20852           CERTIFICATE-TRAILERS,
 20853           DFHEIV11,
 20854           WS-ELCRTT-KEY,
 20855           DFHEIV99,
 20856           DFHEIV99,
 20857           DFHEIV99
 20858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20859
 20860
 20861     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20862        or (hldi-pass-area not = spaces)
 20863        move pa-modelyear        to cs-year
 20864        move pa-makename         to cs-make
 20865        move pa-modelname        to cs-model
 20866        move pa-seriesname       to cs-future
 20867        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20868
 20869* EXEC CICS REWRITE
 20870*           DATASET  (CRTT-ID)
 20871*           FROM     (CERTIFICATE-TRAILERS)
 20872*        END-EXEC
 20873     MOVE LENGTH OF
 20874      CERTIFICATE-TRAILERS
 20875       TO DFHEIV11
 20876*    MOVE '&& L                  %   #00020022' TO DFHEIV0
 20877     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20878     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20879     MOVE X'2020233030303230303232' TO DFHEIV0(25:11)
 20880     CALL 'kxdfhei1' USING DFHEIV0,
 20881           CRTT-ID,
 20882           CERTIFICATE-TRAILERS,
 20883           DFHEIV11,
 20884           DFHEIV99
 20885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20886     ELSE
 20887
 20888* EXEC CICS UNLOCK
 20889*          DATASET  (CRTT-ID)
 20890*       END-EXEC
 20891*    MOVE '&*                    #   #00020027' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 386
* EL050.cbl
 20892     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20893     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20894     MOVE X'2020233030303230303237' TO DFHEIV0(25:11)
 20895     CALL 'kxdfhei1' USING DFHEIV0,
 20896           CRTT-ID,
 20897           DFHEIV99
 20898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20899     END-IF.
 20900
 20901     GO TO 8180-EXIT.
 20902
 20903 8180-NOTFND.
 20904
 20905     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20906     MOVE 'CS'         TO CS-RECORD-ID.
 20907     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20908     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20909     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20910     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20911
 20912* EXEC CICS WRITE
 20913*       DATASET  (CRTT-ID)
 20914*       RIDFLD   (WS-ELCRTT-KEY)
 20915*       FROM     (CERTIFICATE-TRAILERS)
 20916*    END-EXEC.
 20917     MOVE LENGTH OF
 20918      CERTIFICATE-TRAILERS
 20919       TO DFHEIV11
 20920*    MOVE '&$ L                  ''   #00020042' TO DFHEIV0
 20921     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20922     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20923     MOVE X'2020233030303230303432' TO DFHEIV0(25:11)
 20924     CALL 'kxdfhei1' USING DFHEIV0,
 20925           CRTT-ID,
 20926           CERTIFICATE-TRAILERS,
 20927           DFHEIV11,
 20928           WS-ELCRTT-KEY,
 20929           DFHEIV99,
 20930           DFHEIV99
 20931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20932
 20933
 20934 8180-EXIT.
 20935     EXIT.
 20936
 20937 8190-UPDATE-REFUND-CLAIM-FLAG.
 20938
 20939* EXEC CICS HANDLE CONDITION
 20940*        NOTFND   (8190-NOTFND)
 20941*    END-EXEC.
 20942*    MOVE '"$I                   ! 1 #00020052' TO DFHEIV0
 20943     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20945     MOVE X'3120233030303230303532' TO DFHEIV0(25:11)
 20946     CALL 'kxdfhei1' USING DFHEIV0
 20947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20948
 20949
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 387
* EL050.cbl
 20950     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20951     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20952
 20953
 20954* EXEC CICS READ
 20955*        UPDATE
 20956*        DATASET  (CRTT-ID)
 20957*        RIDFLD   (WS-ELCRTT-KEY)
 20958*        INTO     (CERTIFICATE-TRAILERS)
 20959*    END-EXEC.
 20960     MOVE LENGTH OF
 20961      CERTIFICATE-TRAILERS
 20962       TO DFHEIV11
 20963*    MOVE '&"IL       EU         (   #00020059' TO DFHEIV0
 20964     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20965     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20966     MOVE X'2020233030303230303539' TO DFHEIV0(25:11)
 20967     CALL 'kxdfhei1' USING DFHEIV0,
 20968           CRTT-ID,
 20969           CERTIFICATE-TRAILERS,
 20970           DFHEIV11,
 20971           WS-ELCRTT-KEY,
 20972           DFHEIV99,
 20973           DFHEIV99,
 20974           DFHEIV99
 20975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20976
 20977
 20978     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20979
 20980* EXEC CICS REWRITE
 20981*       DATASET  (CRTT-ID)
 20982*       FROM     (CERTIFICATE-TRAILERS)
 20983*    END-EXEC.
 20984     MOVE LENGTH OF
 20985      CERTIFICATE-TRAILERS
 20986       TO DFHEIV11
 20987*    MOVE '&& L                  %   #00020067' TO DFHEIV0
 20988     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20989     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20990     MOVE X'2020233030303230303637' TO DFHEIV0(25:11)
 20991     CALL 'kxdfhei1' USING DFHEIV0,
 20992           CRTT-ID,
 20993           CERTIFICATE-TRAILERS,
 20994           DFHEIV11,
 20995           DFHEIV99
 20996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20997
 20998
 20999     GO TO 8190-EXIT.
 21000
 21001 8190-NOTFND.
 21002
 21003     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21004     MOVE 'CS'         TO CS-RECORD-ID.
 21005     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21006     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21007     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 388
* EL050.cbl
 21008     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21009
 21010* EXEC CICS WRITE
 21011*       DATASET  (CRTT-ID)
 21012*       RIDFLD   (WS-ELCRTT-KEY)
 21013*       FROM     (CERTIFICATE-TRAILERS)
 21014*    END-EXEC.
 21015     MOVE LENGTH OF
 21016      CERTIFICATE-TRAILERS
 21017       TO DFHEIV11
 21018*    MOVE '&$ L                  ''   #00020082' TO DFHEIV0
 21019     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21020     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21021     MOVE X'2020233030303230303832' TO DFHEIV0(25:11)
 21022     CALL 'kxdfhei1' USING DFHEIV0,
 21023           CRTT-ID,
 21024           CERTIFICATE-TRAILERS,
 21025           DFHEIV11,
 21026           WS-ELCRTT-KEY,
 21027           DFHEIV99,
 21028           DFHEIV99
 21029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21030
 21031
 21032 8190-EXIT.
 21033     EXIT.
 21034
 21035 8195-UPDATE-AGE-FLAGS.
 21036
 21037* EXEC CICS HANDLE CONDITION
 21038*        NOTFND   (8195-NOTFND)
 21039*    END-EXEC.
 21040*    MOVE '"$I                   ! 2 #00020092' TO DFHEIV0
 21041     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21043     MOVE X'3220233030303230303932' TO DFHEIV0(25:11)
 21044     CALL 'kxdfhei1' USING DFHEIV0
 21045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21046
 21047
 21048     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21049     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21050
 21051
 21052* EXEC CICS READ
 21053*        UPDATE
 21054*        DATASET  (CRTT-ID)
 21055*        RIDFLD   (WS-ELCRTT-KEY)
 21056*        INTO     (CERTIFICATE-TRAILERS)
 21057*    END-EXEC.
 21058     MOVE LENGTH OF
 21059      CERTIFICATE-TRAILERS
 21060       TO DFHEIV11
 21061*    MOVE '&"IL       EU         (   #00020099' TO DFHEIV0
 21062     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21063     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21064     MOVE X'2020233030303230303939' TO DFHEIV0(25:11)
 21065     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 389
* EL050.cbl
 21066           CRTT-ID,
 21067           CERTIFICATE-TRAILERS,
 21068           DFHEIV11,
 21069           WS-ELCRTT-KEY,
 21070           DFHEIV99,
 21071           DFHEIV99,
 21072           DFHEIV99
 21073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21074
 21075
 21076     IF WS-INS-AGE-SET = 'Y'
 21077        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21078     END-IF
 21079     IF WS-JNT-AGE-SET = 'Y'
 21080        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21081     END-IF
 21082
 21083
 21084* EXEC CICS REWRITE
 21085*       DATASET  (CRTT-ID)
 21086*       FROM     (CERTIFICATE-TRAILERS)
 21087*    END-EXEC.
 21088     MOVE LENGTH OF
 21089      CERTIFICATE-TRAILERS
 21090       TO DFHEIV11
 21091*    MOVE '&& L                  %   #00020113' TO DFHEIV0
 21092     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21093     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21094     MOVE X'2020233030303230313133' TO DFHEIV0(25:11)
 21095     CALL 'kxdfhei1' USING DFHEIV0,
 21096           CRTT-ID,
 21097           CERTIFICATE-TRAILERS,
 21098           DFHEIV11,
 21099           DFHEIV99
 21100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21101
 21102
 21103     GO TO 8195-EXIT.
 21104
 21105 8195-NOTFND.
 21106
 21107     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21108     MOVE 'CS'         TO CS-RECORD-ID.
 21109     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21110     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21111     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21112     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21113     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21114
 21115* EXEC CICS WRITE
 21116*       DATASET  (CRTT-ID)
 21117*       RIDFLD   (WS-ELCRTT-KEY)
 21118*       FROM     (CERTIFICATE-TRAILERS)
 21119*    END-EXEC.
 21120     MOVE LENGTH OF
 21121      CERTIFICATE-TRAILERS
 21122       TO DFHEIV11
 21123*    MOVE '&$ L                  ''   #00020129' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 390
* EL050.cbl
 21124     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21125     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21126     MOVE X'2020233030303230313239' TO DFHEIV0(25:11)
 21127     CALL 'kxdfhei1' USING DFHEIV0,
 21128           CRTT-ID,
 21129           CERTIFICATE-TRAILERS,
 21130           DFHEIV11,
 21131           WS-ELCRTT-KEY,
 21132           DFHEIV99,
 21133           DFHEIV99
 21134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21135
 21136
 21137 8195-EXIT.
 21138     EXIT.
 21139
 21140 8200-READ-REIN-TABLE.
 21141
 21142* EXEC CICS HANDLE CONDITION
 21143*         NOTFND   (8200-NOTFND)
 21144*    END-EXEC.
 21145*    MOVE '"$I                   ! 3 #00020139' TO DFHEIV0
 21146     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21148     MOVE X'3320233030303230313339' TO DFHEIV0(25:11)
 21149     CALL 'kxdfhei1' USING DFHEIV0
 21150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21151
 21152
 21153
 21154* EXEC CICS READ
 21155*        DATASET     (REIN-ID)
 21156*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21157*        RIDFLD      (ERREIN-KEY)
 21158*    END-EXEC.
 21159*    MOVE '&"S        E          (   #00020143' TO DFHEIV0
 21160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21162     MOVE X'2020233030303230313433' TO DFHEIV0(25:11)
 21163     CALL 'kxdfhei1' USING DFHEIV0,
 21164           REIN-ID,
 21165           DFHEIV20,
 21166           DFHEIV99,
 21167           ERREIN-KEY,
 21168           DFHEIV99,
 21169           DFHEIV99,
 21170           DFHEIV99
 21171     SET ADDRESS OF REINSURANCE-RECORD TO
 21172         DFHEIV20
 21173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21174
 21175
 21176     GO TO 8200-EXIT.
 21177
 21178 8200-NOTFND.
 21179     MOVE 'N'             TO WS-REIN-READ-SW.
 21180
 21181 8200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 391
* EL050.cbl
 21182      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 392
* EL050.cbl
 21184
 21185 8300-READ-CTBL-TABLE.
 21186
 21187* EXEC CICS HANDLE CONDITION
 21188*        NOTFND    (8300-NOTFND)
 21189*        DISABLED  (8300-ERRESS-PROBLEM)
 21190*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21191*        ENDFILE   (8300-NOTFND)
 21192*    END-EXEC.
 21193*    MOVE '"$IcJ''                ! 4 #00020159' TO DFHEIV0
 21194     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21196     MOVE X'3420233030303230313539' TO DFHEIV0(25:11)
 21197     CALL 'kxdfhei1' USING DFHEIV0
 21198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21199
 21200
 21201
 21202* EXEC CICS READ
 21203*        DATASET     (CTBL-ID)
 21204*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21205*        RIDFLD      (ERCTBL-KEY)
 21206*    END-EXEC.
 21207*    MOVE '&"S        E          (   #00020166' TO DFHEIV0
 21208     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21209     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21210     MOVE X'2020233030303230313636' TO DFHEIV0(25:11)
 21211     CALL 'kxdfhei1' USING DFHEIV0,
 21212           CTBL-ID,
 21213           DFHEIV20,
 21214           DFHEIV99,
 21215           ERCTBL-KEY,
 21216           DFHEIV99,
 21217           DFHEIV99,
 21218           DFHEIV99
 21219     SET ADDRESS OF COMM-TABLE-RECORD TO
 21220         DFHEIV20
 21221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21222
 21223
 21224     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21225
 21226     GO TO 8300-EXIT.
 21227
 21228 8300-NOTFND.
 21229
 21230     IF CTBL-SW = '0530'
 21231         MOVE 'AA'                     TO WS-AH-COMP-CD
 21232         MOVE '0550'                   TO CTBL-SW
 21233         MOVE '1'                      TO WS-CTBL-READ-SW
 21234         GO TO 8300-EXIT.
 21235
 21236     IF CTBL-SW = '0540'
 21237         MOVE 'AA'                     TO WS-LF-COMP-CD
 21238         MOVE '0550'                   TO CTBL-SW
 21239         MOVE '1'                      TO WS-CTBL-READ-SW
 21240         GO TO 8300-EXIT.
 21241
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 393
* EL050.cbl
 21242     IF CTBL-SW = '0550'
 21243         MOVE '2'                      TO WS-CTBL-READ-SW
 21244         GO TO 8300-EXIT.
 21245
 21246     GO TO 8300-EXIT.
 21247
 21248 8300-ERRESS-PROBLEM.
 21249
 21250      MOVE ER-8050              TO WS-ERROR.
 21251      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21252
 21253     GO TO 8300-EXIT.
 21254
 21255 8300-EXIT.
 21256      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 394
* EL050.cbl
 21258
 21259
 21260 8400-GETMAIN-ERFORM.
 21261
 21262
 21263* EXEC CICS   GETMAIN
 21264*        LENGTH  (500)
 21265*        SET     (ADDRESS OF FORM-MASTER)
 21266*    END-EXEC.
 21267     MOVE 500
 21268       TO DFHEIV11
 21269*    MOVE '," L                  $   #00020210' TO DFHEIV0
 21270     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21271     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21272     MOVE X'2020233030303230323130' TO DFHEIV0(25:11)
 21273     CALL 'kxdfhei1' USING DFHEIV0,
 21274           DFHEIV20,
 21275           DFHEIV11,
 21276           DFHEIV99
 21277     SET ADDRESS OF FORM-MASTER TO
 21278         DFHEIV20
 21279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21280
 21281
 21282     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21283
 21284 8400-EXIT.
 21285      EXIT.
 21286
 21287 8450-READ-FORM-MASTER.
 21288
 21289
 21290* EXEC CICS  HANDLE CONDITION
 21291*        NOTFND   (8450-FORM-NOT-FOUND)
 21292*        ENDFILE  (8450-FORM-NOT-FOUND)
 21293*    END-EXEC.
 21294*    MOVE '"$I''                  ! 5 #00020222' TO DFHEIV0
 21295     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21297     MOVE X'3520233030303230323232' TO DFHEIV0(25:11)
 21298     CALL 'kxdfhei1' USING DFHEIV0
 21299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21300
 21301
 21302
 21303* EXEC CICS   READ
 21304*        DATASET   (FORM-ID)
 21305*        RIDFLD    (ERFORM-KEY)
 21306*        INTO      (FORM-MASTER)
 21307*        GTEQ
 21308*    END-EXEC.
 21309     MOVE LENGTH OF
 21310      FORM-MASTER
 21311       TO DFHEIV11
 21312*    MOVE '&"IL       G          (   #00020227' TO DFHEIV0
 21313     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21315     MOVE X'2020233030303230323237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 395
* EL050.cbl
 21316     CALL 'kxdfhei1' USING DFHEIV0,
 21317           FORM-ID,
 21318           FORM-MASTER,
 21319           DFHEIV11,
 21320           ERFORM-KEY,
 21321           DFHEIV99,
 21322           DFHEIV99,
 21323           DFHEIV99
 21324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21325
 21326
 21327     MOVE  'Y'           TO  FORM-MASTER-SW.
 21328
 21329     GO TO  8450-EXIT.
 21330
 21331 8450-FORM-NOT-FOUND.
 21332
 21333     MOVE  'N'           TO  FORM-MASTER-SW.
 21334
 21335 8450-EXIT.
 21336      EXIT.
 21337
 21338 8500-DATE-CONVERT.
 21339
 21340* EXEC CICS LINK
 21341*        PROGRAM    ('ELDATCV')
 21342*        COMMAREA   (DATE-CONVERSION-DATA)
 21343*        LENGTH     (DC-COMM-LENGTH)
 21344*    END-EXEC.
 21345     MOVE 'ELDATCV' TO DFHEIV1
 21346*    MOVE '."C                   (   #00020246' TO DFHEIV0
 21347     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21349     MOVE X'2020233030303230323436' TO DFHEIV0(25:11)
 21350     CALL 'kxdfhei1' USING DFHEIV0,
 21351           DFHEIV1,
 21352           DATE-CONVERSION-DATA,
 21353           DC-COMM-LENGTH,
 21354           DFHEIV99,
 21355           DFHEIV99,
 21356           DFHEIV99,
 21357           DFHEIV99
 21358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21359
 21360
 21361 8500-EXIT.
 21362     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 396
* EL050.cbl
 21364
 21365 8555-RELOAD-CONTROL-FILE.
 21366     CONTINUE.
 21367
 21368 8555-EXIT.
 21369     EXIT.
 21370
 21371 8557-GETMAIN-ERPLAN.
 21372
 21373
 21374* EXEC CICS GETMAIN
 21375*        LENGTH    (840)
 21376*        SET       (ADDRESS OF PLAN-RECORDS)
 21377*    END-EXEC.
 21378     MOVE 840
 21379       TO DFHEIV11
 21380*    MOVE '," L                  $   #00020264' TO DFHEIV0
 21381     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21382     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21383     MOVE X'2020233030303230323634' TO DFHEIV0(25:11)
 21384     CALL 'kxdfhei1' USING DFHEIV0,
 21385           DFHEIV20,
 21386           DFHEIV11,
 21387           DFHEIV99
 21388     SET ADDRESS OF PLAN-RECORDS TO
 21389         DFHEIV20
 21390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21391
 21392
 21393     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21394
 21395 8557-EXIT.
 21396     EXIT.
 21397
 21398 8560-GETMAIN.
 21399
 21400* EXEC CICS GETMAIN
 21401*        LENGTH    (2000)
 21402*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21403*    END-EXEC.
 21404     MOVE 2000
 21405       TO DFHEIV11
 21406*    MOVE '," L                  $   #00020275' TO DFHEIV0
 21407     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21408     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21409     MOVE X'2020233030303230323735' TO DFHEIV0(25:11)
 21410     CALL 'kxdfhei1' USING DFHEIV0,
 21411           DFHEIV20,
 21412           DFHEIV11,
 21413           DFHEIV99
 21414     SET ADDRESS OF ACCOUNT-MASTER TO
 21415         DFHEIV20
 21416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21417
 21418
 21419     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21420
 21421 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 397
* EL050.cbl
 21422     EXIT.
 21423
 21424 8570-START-ACCOUNT-MASTER.
 21425
 21426* EXEC CICS HANDLE CONDITION
 21427*        NOTFND    (0199-ACCT-NOT-FOUND)
 21428*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21429*    END-EXEC.
 21430*    MOVE '"$I''                  ! 6 #00020286' TO DFHEIV0
 21431     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21433     MOVE X'3620233030303230323836' TO DFHEIV0(25:11)
 21434     CALL 'kxdfhei1' USING DFHEIV0
 21435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21436
 21437
 21438
 21439* EXEC CICS STARTBR
 21440*        DATASET    (ACCT-ID)
 21441*        RIDFLD     (ERACCT-KEY)
 21442*        GTEQ
 21443*    END-EXEC.
 21444     MOVE 0
 21445       TO DFHEIV11
 21446*    MOVE '&,         G          &   #00020291' TO DFHEIV0
 21447     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21448     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21449     MOVE X'2020233030303230323931' TO DFHEIV0(25:11)
 21450     CALL 'kxdfhei1' USING DFHEIV0,
 21451           ACCT-ID,
 21452           ERACCT-KEY,
 21453           DFHEIV99,
 21454           DFHEIV11,
 21455           DFHEIV99
 21456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21457
 21458
 21459 8570-EXIT.
 21460     EXIT.
 21461
 21462 8580-READ-ACCOUNT-MASTER.
 21463
 21464* EXEC CICS HANDLE CONDITION
 21465*        NOTFND    (0199-ACCT-NOT-FOUND)
 21466*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21467*    END-EXEC.
 21468*    MOVE '"$I''                  ! 7 #00020301' TO DFHEIV0
 21469     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21471     MOVE X'3720233030303230333031' TO DFHEIV0(25:11)
 21472     CALL 'kxdfhei1' USING DFHEIV0
 21473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21474
 21475
 21476
 21477* EXEC CICS READNEXT
 21478*        DATASET     (ACCT-ID)
 21479*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 398
* EL050.cbl
 21480*        RIDFLD      (ERACCT-KEY)
 21481*    END-EXEC.
 21482     MOVE LENGTH OF
 21483      ACCOUNT-MASTER
 21484       TO DFHEIV12
 21485     MOVE 0
 21486       TO DFHEIV11
 21487*    MOVE '&.IL                  )   #00020306' TO DFHEIV0
 21488     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21489     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21490     MOVE X'2020233030303230333036' TO DFHEIV0(25:11)
 21491     CALL 'kxdfhei1' USING DFHEIV0,
 21492           ACCT-ID,
 21493           ACCOUNT-MASTER,
 21494           DFHEIV12,
 21495           ERACCT-KEY,
 21496           DFHEIV99,
 21497           DFHEIV11,
 21498           DFHEIV99,
 21499           DFHEIV99
 21500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21501
 21502
 21503 8580-EXIT.
 21504     EXIT.
 21505
 21506 8582-READ-COMPENSATION-MASTER.
 21507
 21508* EXEC CICS HANDLE CONDITION
 21509*        NOTFND    (8582-COMP-NOT-FOUND)
 21510*        ENDFILE   (8582-COMP-NOT-FOUND)
 21511*    END-EXEC.
 21512*    MOVE '"$I''                  ! 8 #00020316' TO DFHEIV0
 21513     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21515     MOVE X'3820233030303230333136' TO DFHEIV0(25:11)
 21516     CALL 'kxdfhei1' USING DFHEIV0
 21517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21518
 21519
 21520
 21521* EXEC CICS READ
 21522*        DATASET     (COMP-ID)
 21523*        INTO        (COMPENSATION-MASTER)
 21524*        RIDFLD      (ERCOMP-KEY)
 21525*    END-EXEC.
 21526     MOVE LENGTH OF
 21527      COMPENSATION-MASTER
 21528       TO DFHEIV11
 21529*    MOVE '&"IL       E          (   #00020321' TO DFHEIV0
 21530     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21532     MOVE X'2020233030303230333231' TO DFHEIV0(25:11)
 21533     CALL 'kxdfhei1' USING DFHEIV0,
 21534           COMP-ID,
 21535           COMPENSATION-MASTER,
 21536           DFHEIV11,
 21537           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 399
* EL050.cbl
 21538           DFHEIV99,
 21539           DFHEIV99,
 21540           DFHEIV99
 21541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21542
 21543
 21544     MOVE 'Y'                    TO COMP-MASTER-SW
 21545
 21546     GO TO 8582-EXIT
 21547     .
 21548 8582-COMP-NOT-FOUND.
 21549
 21550     MOVE 'N'                    TO COMP-MASTER-SW.
 21551
 21552 8582-EXIT.
 21553     EXIT.
 21554
 21555 8583-READ-ERAGTC.
 21556
 21557* EXEC CICS HANDLE CONDITION
 21558*        NOTFND    (8583-AGTC-NOT-FOUND)
 21559*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21560*    END-EXEC.
 21561*    MOVE '"$I''                  ! 9 #00020339' TO DFHEIV0
 21562     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21564     MOVE X'3920233030303230333339' TO DFHEIV0(25:11)
 21565     CALL 'kxdfhei1' USING DFHEIV0
 21566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21567
 21568
 21569
 21570* EXEC CICS STARTBR
 21571*        DATASET    (AGTC-ID)
 21572*        RIDFLD     (ERAGTC-KEY)
 21573*        GTEQ
 21574*    END-EXEC.
 21575     MOVE 0
 21576       TO DFHEIV11
 21577*    MOVE '&,         G          &   #00020344' TO DFHEIV0
 21578     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21579     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21580     MOVE X'2020233030303230333434' TO DFHEIV0(25:11)
 21581     CALL 'kxdfhei1' USING DFHEIV0,
 21582           AGTC-ID,
 21583           ERAGTC-KEY,
 21584           DFHEIV99,
 21585           DFHEIV11,
 21586           DFHEIV99
 21587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21588
 21589
 21590 8583-READ-ERAGTC-NEXT.
 21591
 21592* EXEC CICS READNEXT
 21593*        DATASET     (AGTC-ID)
 21594*        INTO        (AGENT-COMMISSIONS)
 21595*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 400
* EL050.cbl
 21596*    END-EXEC.
 21597     MOVE LENGTH OF
 21598      AGENT-COMMISSIONS
 21599       TO DFHEIV12
 21600     MOVE 0
 21601       TO DFHEIV11
 21602*    MOVE '&.IL                  )   #00020351' TO DFHEIV0
 21603     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21604     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21605     MOVE X'2020233030303230333531' TO DFHEIV0(25:11)
 21606     CALL 'kxdfhei1' USING DFHEIV0,
 21607           AGTC-ID,
 21608           AGENT-COMMISSIONS,
 21609           DFHEIV12,
 21610           ERAGTC-KEY,
 21611           DFHEIV99,
 21612           DFHEIV11,
 21613           DFHEIV99,
 21614           DFHEIV99
 21615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21616
 21617
 21618*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21619
 21620     GO TO 8583-EXIT
 21621     .
 21622 8583-AGTC-NOT-FOUND.
 21623
 21624     MOVE 'N'                    TO AGTC-MASTER-SW.
 21625
 21626 8583-EXIT.
 21627     EXIT.
 21628
 21629 8584-READ-BANK-CROSS-REF.
 21630
 21631* EXEC CICS HANDLE CONDITION
 21632*        NOTFND    (8584-BXRF-NOT-FOUND)
 21633*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21634*    END-EXEC.
 21635*    MOVE '"$I''                  ! : #00020369' TO DFHEIV0
 21636     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21638     MOVE X'3A20233030303230333639' TO DFHEIV0(25:11)
 21639     CALL 'kxdfhei1' USING DFHEIV0
 21640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21641
 21642
 21643
 21644* EXEC CICS READ
 21645*        DATASET     (BXRF-ID)
 21646*        INTO        (BANK-CROSS-REFERENCE)
 21647*        RIDFLD      (ERBXRF-KEY)
 21648*        LENGTH      (BXRF-REC-LENGTH)
 21649*    END-EXEC.
 21650*    MOVE '&"IL       E          (   #00020374' TO DFHEIV0
 21651     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21653     MOVE X'2020233030303230333734' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 401
* EL050.cbl
 21654     CALL 'kxdfhei1' USING DFHEIV0,
 21655           BXRF-ID,
 21656           BANK-CROSS-REFERENCE,
 21657           BXRF-REC-LENGTH,
 21658           ERBXRF-KEY,
 21659           DFHEIV99,
 21660           DFHEIV99,
 21661           DFHEIV99
 21662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21663
 21664
 21665     MOVE 'Y'                    TO BXRF-MASTER-SW
 21666
 21667     GO TO 8584-EXIT
 21668     .
 21669 8584-BXRF-NOT-FOUND.
 21670
 21671     MOVE 'N'                    TO BXRF-MASTER-SW.
 21672
 21673 8584-EXIT.
 21674     EXIT.
 21675
 21676 8585-READ-PLAN-MASTER.
 21677
 21678
 21679* EXEC CICS HANDLE CONDITION
 21680*        NOTFND    (8585-PLAN-NOT-FOUND)
 21681*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21682*    END-EXEC.
 21683*    MOVE '"$I''                  ! ; #00020394' TO DFHEIV0
 21684     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21686     MOVE X'3B20233030303230333934' TO DFHEIV0(25:11)
 21687     CALL 'kxdfhei1' USING DFHEIV0
 21688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21689
 21690
 21691
 21692* EXEC CICS READ
 21693*        DATASET     (PLAN-ID)
 21694*        INTO        (PLAN-MASTER)
 21695*        RIDFLD      (ERPLAN-KEY)
 21696*    END-EXEC.
 21697     MOVE LENGTH OF
 21698      PLAN-MASTER
 21699       TO DFHEIV11
 21700*    MOVE '&"IL       E          (   #00020399' TO DFHEIV0
 21701     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21703     MOVE X'2020233030303230333939' TO DFHEIV0(25:11)
 21704     CALL 'kxdfhei1' USING DFHEIV0,
 21705           PLAN-ID,
 21706           PLAN-MASTER,
 21707           DFHEIV11,
 21708           ERPLAN-KEY,
 21709           DFHEIV99,
 21710           DFHEIV99,
 21711           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 402
* EL050.cbl
 21712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21713
 21714
 21715     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21716
 21717     GO TO 8585-EXIT.
 21718
 21719 8585-PLAN-NOT-FOUND.
 21720
 21721     MOVE 'N'                    TO PLAN-MASTER-SW.
 21722
 21723 8585-EXIT.
 21724     EXIT.
 21725
 21726 8586-READ-LOAN-OFFICER.
 21727
 21728* EXEC CICS READ
 21729*        DATASET     (LOFC-ID)
 21730*        INTO        (LOAN-OFFICER-MASTER)
 21731*        RIDFLD      (ERLOFC-KEY)
 21732*        RESP        (WS-RESPONSE)
 21733*    END-EXEC
 21734     MOVE LENGTH OF
 21735      LOAN-OFFICER-MASTER
 21736       TO DFHEIV11
 21737*    MOVE '&"IL       E          (  N#00020417' TO DFHEIV0
 21738     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21739     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21740     MOVE X'204E233030303230343137' TO DFHEIV0(25:11)
 21741     CALL 'kxdfhei1' USING DFHEIV0,
 21742           LOFC-ID,
 21743           LOAN-OFFICER-MASTER,
 21744           DFHEIV11,
 21745           ERLOFC-KEY,
 21746           DFHEIV99,
 21747           DFHEIV99,
 21748           DFHEIV99
 21749     MOVE EIBRESP  TO WS-RESPONSE
 21750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21751
 21752     IF WS-RESP-NORMAL
 21753        MOVE 'Y'                 TO LOFC-MASTER-SW
 21754     ELSE
 21755        MOVE 'N'                 TO LOFC-MASTER-SW
 21756     END-IF
 21757     .
 21758 8586-EXIT.
 21759     EXIT.
 21760 8587-START-ERPDEF.
 21761
 21762* EXEC CICS STARTBR
 21763*       DATASET   (PDEF-ID)
 21764*       RIDFLD    (ERPDEF-KEY)
 21765*       GTEQ
 21766*       RESP      (WS-RESPONSE)
 21767*    END-EXEC
 21768     MOVE 0
 21769       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 403
* EL050.cbl
 21770*    MOVE '&,         G          &  N#00020433' TO DFHEIV0
 21771     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21772     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21773     MOVE X'204E233030303230343333' TO DFHEIV0(25:11)
 21774     CALL 'kxdfhei1' USING DFHEIV0,
 21775           PDEF-ID,
 21776           ERPDEF-KEY,
 21777           DFHEIV99,
 21778           DFHEIV11,
 21779           DFHEIV99
 21780     MOVE EIBRESP  TO WS-RESPONSE
 21781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21782     IF WS-RESP-NORMAL
 21783        MOVE 'Y'                 TO PDEF-MASTER-SW
 21784     ELSE
 21785        MOVE 'N'                 TO PDEF-MASTER-SW
 21786     END-IF
 21787     .
 21788 8587-EXIT.
 21789     EXIT.
 21790 8588-READ-ERPDEF.
 21791
 21792* EXEC CICS READNEXT
 21793*       DATASET   (PDEF-ID)
 21794*       RIDFLD    (ERPDEF-KEY)
 21795*       INTO      (PRODUCT-MASTER)
 21796*       RESP      (WS-RESPONSE)
 21797*    END-EXEC
 21798     MOVE LENGTH OF
 21799      PRODUCT-MASTER
 21800       TO DFHEIV12
 21801     MOVE 0
 21802       TO DFHEIV11
 21803*    MOVE '&.IL                  )  N#00020448' TO DFHEIV0
 21804     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21805     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21806     MOVE X'204E233030303230343438' TO DFHEIV0(25:11)
 21807     CALL 'kxdfhei1' USING DFHEIV0,
 21808           PDEF-ID,
 21809           PRODUCT-MASTER,
 21810           DFHEIV12,
 21811           ERPDEF-KEY,
 21812           DFHEIV99,
 21813           DFHEIV11,
 21814           DFHEIV99,
 21815           DFHEIV99
 21816     MOVE EIBRESP  TO WS-RESPONSE
 21817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21818     IF WS-RESP-NORMAL
 21819        MOVE 'Y'                 TO PDEF-MASTER-SW
 21820     ELSE
 21821        MOVE 'N'                 TO PDEF-MASTER-SW
 21822     END-IF
 21823     .
 21824 8588-EXIT.
 21825     EXIT.
 21826 8589-ENDBR-ERPDEF.
 21827
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 404
* EL050.cbl
 21828* EXEC CICS ENDBR
 21829*       DATASET   (PDEF-ID)
 21830*    END-EXEC
 21831     MOVE 0
 21832       TO DFHEIV11
 21833*    MOVE '&2                    $   #00020463' TO DFHEIV0
 21834     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21835     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21836     MOVE X'2020233030303230343633' TO DFHEIV0(25:11)
 21837     CALL 'kxdfhei1' USING DFHEIV0,
 21838           PDEF-ID,
 21839           DFHEIV11,
 21840           DFHEIV99
 21841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21842     .
 21843 8589-EXIT.
 21844     EXIT.
 21845 8590-READ-CERT-MASTER.
 21846     IF PB-COMPANY-ID = 'UCL'
 21847         GO TO 8690-READ-CERT-MASTER-UCL.
 21848
 21849
 21850* EXEC CICS HANDLE CONDITION
 21851*         NOTFND    (0299-CERT-NOT-FOUND)
 21852*    END-EXEC.
 21853*    MOVE '"$I                   ! < #00020473' TO DFHEIV0
 21854     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21856     MOVE X'3C20233030303230343733' TO DFHEIV0(25:11)
 21857     CALL 'kxdfhei1' USING DFHEIV0
 21858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21859
 21860
 21861
 21862* EXEC CICS READ
 21863*        DATASET     (CERT-ID)
 21864*        INTO        (CERTIFICATE-MASTER)
 21865*        RIDFLD      (ELCERT-KEY)
 21866*        UPDATE
 21867*    END-EXEC.
 21868     MOVE LENGTH OF
 21869      CERTIFICATE-MASTER
 21870       TO DFHEIV11
 21871*    MOVE '&"IL       EU         (   #00020477' TO DFHEIV0
 21872     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21873     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21874     MOVE X'2020233030303230343737' TO DFHEIV0(25:11)
 21875     CALL 'kxdfhei1' USING DFHEIV0,
 21876           CERT-ID,
 21877           CERTIFICATE-MASTER,
 21878           DFHEIV11,
 21879           ELCERT-KEY,
 21880           DFHEIV99,
 21881           DFHEIV99,
 21882           DFHEIV99
 21883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21884
 21885
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 405
* EL050.cbl
 21886 8590-EXIT.
 21887     EXIT.
 21888
 21889 8690-READ-CERT-MASTER-UCL.
 21890
 21891* EXEC CICS HANDLE CONDITION
 21892*         NOTFND    (8700-READ-CERT-MASTER)
 21893*    END-EXEC.
 21894*    MOVE '"$I                   ! = #00020488' TO DFHEIV0
 21895     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21897     MOVE X'3D20233030303230343838' TO DFHEIV0(25:11)
 21898     CALL 'kxdfhei1' USING DFHEIV0
 21899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21900
 21901
 21902 8690-READ-CERT-CONT.
 21903
 21904* EXEC CICS READ
 21905*        DATASET     (CERT-ID)
 21906*        INTO        (CERTIFICATE-MASTER)
 21907*        RIDFLD      (ELCERT-KEY)
 21908*        UPDATE
 21909*    END-EXEC.
 21910     MOVE LENGTH OF
 21911      CERTIFICATE-MASTER
 21912       TO DFHEIV11
 21913*    MOVE '&"IL       EU         (   #00020493' TO DFHEIV0
 21914     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21915     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21916     MOVE X'2020233030303230343933' TO DFHEIV0(25:11)
 21917     CALL 'kxdfhei1' USING DFHEIV0,
 21918           CERT-ID,
 21919           CERTIFICATE-MASTER,
 21920           DFHEIV11,
 21921           ELCERT-KEY,
 21922           DFHEIV99,
 21923           DFHEIV99,
 21924           DFHEIV99
 21925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21926
 21927
 21928     GO TO 8590-EXIT.
 21929
 21930 8700-READ-CERT-MASTER.
 21931     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21932     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21933
 21934* EXEC CICS HANDLE CONDITION
 21935*         DUPKEY    (8720-COMP-ACCOUNTS)
 21936*         ENDFILE   (8730-END-BROWSE)
 21937*         NOTFND    (8740-NOT-FOUND)
 21938*    END-EXEC.
 21939*    MOVE '"$$''I                 ! > #00020505' TO DFHEIV0
 21940     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21941     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21942     MOVE X'3E20233030303230353035' TO DFHEIV0(25:11)
 21943     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 406
* EL050.cbl
 21944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21945
 21946
 21947
 21948* EXEC CICS STARTBR
 21949*        DATASET     ('ELCERT5')
 21950*        RIDFLD      (ELCERT2-KEY)
 21951*        EQUAL
 21952*    END-EXEC.
 21953     MOVE 'ELCERT5' TO DFHEIV1
 21954     MOVE 0
 21955       TO DFHEIV11
 21956*    MOVE '&,         E          &   #00020511' TO DFHEIV0
 21957     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21958     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21959     MOVE X'2020233030303230353131' TO DFHEIV0(25:11)
 21960     CALL 'kxdfhei1' USING DFHEIV0,
 21961           DFHEIV1,
 21962           ELCERT2-KEY,
 21963           DFHEIV99,
 21964           DFHEIV11,
 21965           DFHEIV99
 21966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21967
 21968
 21969 8710-READ-NEXT.
 21970
 21971* EXEC CICS READNEXT
 21972*        DATASET     ('ELCERT5')
 21973*        INTO        (CERTIFICATE-MASTER)
 21974*        RIDFLD      (ELCERT2-KEY)
 21975*    END-EXEC.
 21976     MOVE LENGTH OF
 21977      CERTIFICATE-MASTER
 21978       TO DFHEIV12
 21979     MOVE 'ELCERT5' TO DFHEIV1
 21980     MOVE 0
 21981       TO DFHEIV11
 21982*    MOVE '&.IL                  )   #00020518' TO DFHEIV0
 21983     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21984     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21985     MOVE X'2020233030303230353138' TO DFHEIV0(25:11)
 21986     CALL 'kxdfhei1' USING DFHEIV0,
 21987           DFHEIV1,
 21988           CERTIFICATE-MASTER,
 21989           DFHEIV12,
 21990           ELCERT2-KEY,
 21991           DFHEIV99,
 21992           DFHEIV11,
 21993           DFHEIV99,
 21994           DFHEIV99
 21995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21996
 21997
 21998 8720-COMP-ACCOUNTS.
 21999
 22000* EXEC CICS ENTER
 22001*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 407
* EL050.cbl
 22002*         FROM (PB-C-LAST-NAME)
 22003*    END-EXEC.
 22004     MOVE 001
 22005       TO DFHEIV11
 22006*    MOVE ':$F                   %   #00020525' TO DFHEIV0
 22007     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22008     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22009     MOVE X'2020233030303230353235' TO DFHEIV0(25:11)
 22010     CALL 'kxdfhei1' USING DFHEIV0,
 22011           DFHEIV11,
 22012           PB-C-LAST-NAME,
 22013           DFHEIV99,
 22014           DFHEIV99
 22015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22016
 22017
 22018
 22019* EXEC CICS ENTER
 22020*         TRACEID (002)
 22021*         FROM (CM-INSURED-LAST-NAME)
 22022*    END-EXEC.
 22023     MOVE 002
 22024       TO DFHEIV11
 22025*    MOVE ':$F                   %   #00020530' TO DFHEIV0
 22026     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22027     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22028     MOVE X'2020233030303230353330' TO DFHEIV0(25:11)
 22029     CALL 'kxdfhei1' USING DFHEIV0,
 22030           DFHEIV11,
 22031           CM-INSURED-LAST-NAME,
 22032           DFHEIV99,
 22033           DFHEIV99
 22034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22035
 22036
 22037     IF PB-CERT-NO NOT = CM-CERT-NO
 22038         GO TO 8730-END-BROWSE.
 22039
 22040     IF PB-ACCOUNT = CM-ACCOUNT
 22041         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22042             MOVE ER-2799        TO WS-ERROR
 22043             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22044             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22045             GO TO 8730-END-BROWSE.
 22046
 22047     GO TO 8710-READ-NEXT.
 22048
 22049 8730-END-BROWSE.
 22050
 22051* EXEC CICS ENDBR
 22052*         DATASET    ('ELCERT5')
 22053*    END-EXEC.
 22054     MOVE 'ELCERT5' TO DFHEIV1
 22055     MOVE 0
 22056       TO DFHEIV11
 22057*    MOVE '&2                    $   #00020548' TO DFHEIV0
 22058     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 408
* EL050.cbl
 22060     MOVE X'2020233030303230353438' TO DFHEIV0(25:11)
 22061     CALL 'kxdfhei1' USING DFHEIV0,
 22062           DFHEIV1,
 22063           DFHEIV11,
 22064           DFHEIV99
 22065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22066
 22067
 22068 8740-NOT-FOUND.
 22069     GO TO 0299-CERT-NOT-FOUND.
 22070
 22071 8750-START-ELSTAT.
 22072
 22073* EXEC CICS STARTBR
 22074*       DATASET   (STAT-ID)
 22075*       RIDFLD    (ELSTAT-KEY)
 22076*       GTEQ
 22077*       RESP      (WS-RESPONSE)
 22078*    END-EXEC
 22079     MOVE 0
 22080       TO DFHEIV11
 22081*    MOVE '&,         G          &  N#00020556' TO DFHEIV0
 22082     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22083     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22084     MOVE X'204E233030303230353536' TO DFHEIV0(25:11)
 22085     CALL 'kxdfhei1' USING DFHEIV0,
 22086           STAT-ID,
 22087           ELSTAT-KEY,
 22088           DFHEIV99,
 22089           DFHEIV11,
 22090           DFHEIV99
 22091     MOVE EIBRESP  TO WS-RESPONSE
 22092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22093     IF WS-RESP-NORMAL
 22094        MOVE 'Y'                 TO STAT-MASTER-SW
 22095     ELSE
 22096        MOVE 'N'                 TO STAT-MASTER-SW
 22097     END-IF
 22098     .
 22099 8750-EXIT.
 22100     EXIT.
 22101 8752-READ-ELSTAT.
 22102
 22103* EXEC CICS READNEXT
 22104*       DATASET   (STAT-ID)
 22105*       RIDFLD    (ELSTAT-KEY)
 22106*       INTO      (STATE-FILE)
 22107*       RESP      (WS-RESPONSE)
 22108*    END-EXEC
 22109     MOVE LENGTH OF
 22110      STATE-FILE
 22111       TO DFHEIV12
 22112     MOVE 0
 22113       TO DFHEIV11
 22114*    MOVE '&.IL                  )  N#00020571' TO DFHEIV0
 22115     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22116     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22117     MOVE X'204E233030303230353731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 409
* EL050.cbl
 22118     CALL 'kxdfhei1' USING DFHEIV0,
 22119           STAT-ID,
 22120           STATE-FILE,
 22121           DFHEIV12,
 22122           ELSTAT-KEY,
 22123           DFHEIV99,
 22124           DFHEIV11,
 22125           DFHEIV99,
 22126           DFHEIV99
 22127     MOVE EIBRESP  TO WS-RESPONSE
 22128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22129     IF WS-RESP-NORMAL
 22130        MOVE 'Y'                 TO STAT-MASTER-SW
 22131     ELSE
 22132        MOVE 'N'                 TO STAT-MASTER-SW
 22133     END-IF
 22134     .
 22135 8752-EXIT.
 22136     EXIT.
 22137 8800-GET-COMP-RATE.
 22138     MOVE +1 TO IB.
 22139     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22140         ADD +9 TO IB
 22141         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22142             ADD +9 TO IB
 22143             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22144                MOVE ZEROS       TO WS-WK-RATE
 22145                GO TO 8800-EXIT.
 22146
 22147     IF PB-I-AGE GREATER CT-AGE (1)
 22148         ADD +3 TO IB
 22149         IF PB-I-AGE GREATER CT-AGE (2)
 22150             ADD +3 TO IB
 22151             IF PB-I-AGE GREATER CT-AGE (3)
 22152                MOVE ZEROS       TO WS-WK-RATE
 22153                GO TO 8800-EXIT.
 22154
 22155     IF WS-WORK-TERM GREATER CT-TRM (1)
 22156         ADD +1 TO IB
 22157         IF WS-WORK-TERM GREATER CT-TRM (2)
 22158             ADD +1 TO IB
 22159             IF WS-WORK-TERM GREATER CT-TRM (3)
 22160                MOVE ZEROS       TO WS-WK-RATE
 22161                GO TO 8800-EXIT.
 22162
 22163     IF CT-RT (IB) NOT NUMERIC
 22164         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22165         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22166         GO TO 8800-GET-COMP-RATE.
 22167
 22168     MOVE CT-RT (IB) TO WS-WK-RATE.
 22169
 22170 8800-EXIT.
 22171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 410
* EL050.cbl
 22173 8900-ADDRESS-FILE.
 22174     IF ERACCT-FILE-ADDRESSED
 22175         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22176         GO TO 8900-ADDRESS-EXIT.
 22177
 22178     IF ELCNTL-FILE-ADDRESSED
 22179         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22180         GO TO 8900-ADDRESS-EXIT.
 22181
 22182     IF ERPLAN-FILE-ADDRESSED
 22183         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22184         GO TO 8900-ADDRESS-EXIT.
 22185
 22186     IF ERFORM-FILE-ADDRESSED
 22187         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22188         GO TO 8900-ADDRESS-EXIT.
 22189
 22190 8900-ADDRESS-EXIT.
 22191     EXIT.
 22192
 22193 9000-READ-CONTROL.
 22194
 22195* EXEC CICS HANDLE CONDITION
 22196*        NOTFND    (9000-NOTFND)
 22197*    END-EXEC.
 22198*    MOVE '"$I                   ! ? #00020642' TO DFHEIV0
 22199     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22201     MOVE X'3F20233030303230363432' TO DFHEIV0(25:11)
 22202     CALL 'kxdfhei1' USING DFHEIV0
 22203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22204
 22205
 22206
 22207* EXEC CICS READ
 22208*        DATASET     (CNTL-ID)
 22209*        SET         (ADDRESS OF CONTROL-FILE)
 22210*        RIDFLD      (ELCNTL-KEY)
 22211*        GTEQ
 22212*    END-EXEC.
 22213*    MOVE '&"S        G          (   #00020646' TO DFHEIV0
 22214     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22215     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22216     MOVE X'2020233030303230363436' TO DFHEIV0(25:11)
 22217     CALL 'kxdfhei1' USING DFHEIV0,
 22218           CNTL-ID,
 22219           DFHEIV20,
 22220           DFHEIV99,
 22221           ELCNTL-KEY,
 22222           DFHEIV99,
 22223           DFHEIV99,
 22224           DFHEIV99
 22225     SET ADDRESS OF CONTROL-FILE TO
 22226         DFHEIV20
 22227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22228
 22229
 22230     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 411
* EL050.cbl
 22231
 22232 9000-NOTFND.
 22233     IF RC-SW-1 = '1'
 22234        MOVE ER-2616              TO WS-ERROR
 22235        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22236        GO TO 9000-EXIT.
 22237
 22238     IF RC-SW-1 = '2'
 22239        MOVE ER-2602              TO WS-ERROR
 22240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22241
 22242 9000-EXIT.
 22243      EXIT.
 22244
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 412
* EL050.cbl
 22246 9100-READ-CONTROL.
 22247
 22248* EXEC CICS HANDLE CONDITION
 22249*        NOTFND  (9100-NOTFND)
 22250*        ENDFILE (9100-NOTFND)
 22251*    END-EXEC.
 22252*    MOVE '"$I''                  ! @ #00020670' TO DFHEIV0
 22253     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22255     MOVE X'4020233030303230363730' TO DFHEIV0(25:11)
 22256     CALL 'kxdfhei1' USING DFHEIV0
 22257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22258
 22259
 22260
 22261* EXEC CICS READ
 22262*        DATASET     (CNTL-ID)
 22263*        INTO        (CONTROL-FILE)
 22264*        RIDFLD      (ELCNTL-KEY)
 22265*        GTEQ
 22266*    END-EXEC.
 22267     MOVE LENGTH OF
 22268      CONTROL-FILE
 22269       TO DFHEIV11
 22270*    MOVE '&"IL       G          (   #00020675' TO DFHEIV0
 22271     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22272     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22273     MOVE X'2020233030303230363735' TO DFHEIV0(25:11)
 22274     CALL 'kxdfhei1' USING DFHEIV0,
 22275           CNTL-ID,
 22276           CONTROL-FILE,
 22277           DFHEIV11,
 22278           ELCNTL-KEY,
 22279           DFHEIV99,
 22280           DFHEIV99,
 22281           DFHEIV99
 22282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22283
 22284
 22285     GO TO 9100-EXIT.
 22286
 22287 9100-NOTFND.
 22288     IF RC-SW-2 = '0'
 22289        MOVE '1'                  TO STATE-RECORD-ERROR
 22290        GO TO 9100-EXIT
 22291     END-IF
 22292     IF RC-SW-2 = '1'
 22293        MOVE '1'                  TO LF-BENEFIT-ERROR
 22294        MOVE ER-2604              TO WS-ERROR
 22295        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22296        GO TO 9100-EXIT.
 22297
 22298     IF RC-SW-2 = '2'
 22299        MOVE '1'                  TO AH-BENEFIT-ERROR
 22300        MOVE ER-2605              TO WS-ERROR
 22301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22302        GO TO 9100-EXIT.
 22303
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 413
* EL050.cbl
 22304     IF RC-SW-2 = '3'
 22305         MOVE ER-2603           TO WS-ERROR
 22306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22307         GO TO 9100-EXIT.
 22308
 22309     IF RC-SW-2 = '4'
 22310         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22311         GO TO 9100-EXIT.
 22312
 22313     IF RC-SW-2 = '5'
 22314         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22315         IF WS-AH-INPUT-CD-1 = SPACE
 22316             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22317         ELSE
 22318             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22319
 22320 9100-EXIT.
 22321      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 414
* EL050.cbl
 22323 9200-CONTROL-GETMAIN.
 22324
 22325* EXEC CICS GETMAIN
 22326*         LENGTH   (750)
 22327*         SET      (ADDRESS OF CONTROL-FILE)
 22328*    END-EXEC.
 22329     MOVE 750
 22330       TO DFHEIV11
 22331*    MOVE '," L                  $   #00020721' TO DFHEIV0
 22332     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22333     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22334     MOVE X'2020233030303230373231' TO DFHEIV0(25:11)
 22335     CALL 'kxdfhei1' USING DFHEIV0,
 22336           DFHEIV20,
 22337           DFHEIV11,
 22338           DFHEIV99
 22339     SET ADDRESS OF CONTROL-FILE TO
 22340         DFHEIV20
 22341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22342
 22343
 22344     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22345
 22346 9200-EXIT.
 22347     EXIT.
 22348
 22349 9250-UNLOCK-RETURN.
 22350
 22351* EXEC CICS UNLOCK
 22352*        DATASET   (CERT-ID)
 22353*    END-EXEC.
 22354*    MOVE '&*                    #   #00020732' TO DFHEIV0
 22355     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22356     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22357     MOVE X'2020233030303230373332' TO DFHEIV0(25:11)
 22358     CALL 'kxdfhei1' USING DFHEIV0,
 22359           CERT-ID,
 22360           DFHEIV99
 22361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22362
 22363
 22364 9300-ABEND.
 22365     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22366
 22367
 22368* EXEC CICS LINK
 22369*        PROGRAM   ('EL004')
 22370*        COMMAREA  (WS-ERROR-LINE)
 22371*        LENGTH    (72)
 22372*    END-EXEC.
 22373     MOVE 'EL004' TO DFHEIV1
 22374     MOVE 72
 22375       TO DFHEIV11
 22376*    MOVE '."C                   (   #00020739' TO DFHEIV0
 22377     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22379     MOVE X'2020233030303230373339' TO DFHEIV0(25:11)
 22380     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 415
* EL050.cbl
 22381           DFHEIV1,
 22382           WS-ERROR-LINE,
 22383           DFHEIV11,
 22384           DFHEIV99,
 22385           DFHEIV99,
 22386           DFHEIV99,
 22387           DFHEIV99
 22388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22389
 22390
 22391     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22392
 22393
 22394* EXEC CICS ABEND
 22395*        ABCODE ('EL50')
 22396*    END-EXEC.
 22397     MOVE 'EL50' TO DFHEIV5
 22398*    MOVE '.,A                   "   #00020747' TO DFHEIV0
 22399     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22400     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22401     MOVE X'2020233030303230373437' TO DFHEIV0(25:11)
 22402     CALL 'kxdfhei1' USING DFHEIV0,
 22403           DFHEIV5
 22404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22405
 22406
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 416
* EL050.cbl
 22408
 22409******************************************************************
 22410*                                                                *
 22411*            E R R O R   F O R M A T   R O U T I N E             *
 22412*                                                                *
 22413******************************************************************
 22414
 22415 9900-ERROR-FORMAT.
 22416
 22417     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22418                    PB-COMMON-ERROR (2) OR
 22419                    PB-COMMON-ERROR (3) OR
 22420                    PB-COMMON-ERROR (4) OR
 22421                    PB-COMMON-ERROR (5) OR
 22422                    PB-COMMON-ERROR (6) OR
 22423                    PB-COMMON-ERROR (7) OR
 22424                    PB-COMMON-ERROR (8) OR
 22425                    PB-COMMON-ERROR (9) OR
 22426                    PB-COMMON-ERROR (10)
 22427        GO TO 9900-EXIT.
 22428
 22429     IF PB-NO-OF-ERRORS = +10
 22430        GO TO 9900-EXIT.
 22431
 22432     ADD +1  TO PB-NO-OF-ERRORS.
 22433     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22434                                       (PB-NO-OF-ERRORS).
 22435 9900-EXIT.
 22436     EXIT.
 22437
 22438 9990-RETURN.
 22439     IF BROWSE-STARTED
 22440
 22441* EXEC CICS ENDBR
 22442*            DATASET  (ACCT-ID)
 22443*       END-EXEC.
 22444     MOVE 0
 22445       TO DFHEIV11
 22446*    MOVE '&2                    $   #00020784' TO DFHEIV0
 22447     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22448     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22449     MOVE X'2020233030303230373834' TO DFHEIV0(25:11)
 22450     CALL 'kxdfhei1' USING DFHEIV0,
 22451           ACCT-ID,
 22452           DFHEIV11,
 22453           DFHEIV99
 22454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22455
 22456
 22457 9990-EXIT.
 22458     EXIT.
 22459
 22460
 22461****Check for CRTO record, add one if not found.
 22462 9991-CHECK-FOR-ELCRTO.
 22463
 22464* EXEC CICS HANDLE CONDITION
 22465*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 417
* EL050.cbl
 22466*         ENDFILE (9991-CRTO-NOT-FOUND)
 22467*     END-EXEC.
 22468*    MOVE '"$I''                  ! A #00020794' TO DFHEIV0
 22469     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22471     MOVE X'4120233030303230373934' TO DFHEIV0(25:11)
 22472     CALL 'kxdfhei1' USING DFHEIV0
 22473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22474
 22475     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22476     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22477     MOVE +0                     TO ELCRTO-SEQ-NO
 22478
 22479
 22480* EXEC CICS READ
 22481*       DATASET   ('ELCRTO')
 22482*       INTO      (ORIGINAL-CERTIFICATE)
 22483*       RIDFLD    (ELCRTO-KEY)
 22484*       GTEQ
 22485*       RESP      (WS-RESPONSE)
 22486*    END-EXEC
 22487     MOVE LENGTH OF
 22488      ORIGINAL-CERTIFICATE
 22489       TO DFHEIV11
 22490     MOVE 'ELCRTO' TO DFHEIV1
 22491*    MOVE '&"IL       G          (  N#00020802' TO DFHEIV0
 22492     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22494     MOVE X'204E233030303230383032' TO DFHEIV0(25:11)
 22495     CALL 'kxdfhei1' USING DFHEIV0,
 22496           DFHEIV1,
 22497           ORIGINAL-CERTIFICATE,
 22498           DFHEIV11,
 22499           ELCRTO-KEY,
 22500           DFHEIV99,
 22501           DFHEIV99,
 22502           DFHEIV99
 22503     MOVE EIBRESP  TO WS-RESPONSE
 22504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22505
 22506     IF WS-RESP-NORMAL
 22507        AND (OC-CONTROL-PRIMARY (1:33) =
 22508                 PB-CONTROL-BY-ACCOUNT (1:33))
 22509        AND (OC-RECORD-TYPE =  'I')
 22510           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22511               GO TO 9991-CHECK-INDICATORS
 22512           ELSE
 22513               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22514               GO TO 9991-CRTO-ADD-REC
 22515           END-IF
 22516     END-IF.
 22517
 22518 9991-CRTO-NOT-FOUND.
 22519
 22520     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22521     MOVE 'OC'                TO OC-RECORD-ID
 22522     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22523                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 418
* EL050.cbl
 22524     MOVE +4096               TO OC-KEY-SEQ-NO.
 22525
 22526 9991-CRTO-ADD-REC.
 22527
 22528     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22529     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22530     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22531     MOVE 'I'                 TO OC-RECORD-TYPE
 22532     IF PB-ISSUE
 22533         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22534         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22535         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22536         MOVE PB-I-AGE               TO OC-INS-AGE
 22537         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22538         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22539         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22540         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22541         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22542         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22543         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22544         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22545         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22546         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22547         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22548         IF PB-I-JOINT-COMMISSION > +0
 22549             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22550         ELSE
 22551             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22552         END-IF
 22553         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22554         MOVE +0                     TO OC-LF-CANCEL-AMT
 22555                                        OC-LF-ITD-CANCEL-AMT
 22556         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22557         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22558         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22559         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22560         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22561         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22562         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22563         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22564         MOVE +0                     TO OC-AH-CANCEL-AMT
 22565                                        OC-AH-ITD-CANCEL-AMT
 22566         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22567         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22568         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22569     ELSE
 22570         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22571         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22572         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22573         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22574         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22575         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22576         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22577         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22578         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22579          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22580             MOVE SPACES             TO OC-LF-BENCD
 22581             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 419
* EL050.cbl
 22582                                        OC-LF-BEN-AMT
 22583                                        OC-LF-PRM-AMT
 22584                                        OC-LF-ALT-BEN-AMT
 22585                                        OC-LF-ALT-PRM-AMT
 22586                                        OC-LF-COMM-PCT
 22587                                        OC-LF-CANCEL-AMT
 22588             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22589             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22590         ELSE
 22591             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22592             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22593             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22594             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22595             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22596             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22597             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22598             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22599             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22600             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22601         END-IF
 22602         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22603         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22604          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22605             MOVE SPACES             TO OC-AH-BENCD
 22606             MOVE ZEROS              TO OC-AH-TERM
 22607                                        OC-AH-BEN-AMT
 22608                                        OC-AH-PRM-AMT
 22609                                        OC-AH-COMM-PCT
 22610                                        OC-AH-CANCEL-AMT
 22611                                        OC-AH-CP
 22612             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22613             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22614         ELSE
 22615             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22616             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22617             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22618             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22619             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22620             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22621             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22622             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22623             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22624         END-IF
 22625         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22626         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22627         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22628         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22629     END-IF
 22630     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22631
 22632     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22633
 22634
 22635* EXEC CICS READ
 22636*         DATASET   (FILE-ERMAIL)
 22637*         RIDFLD    (MA-CONTROL-PRIMARY)
 22638*         INTO      (MAILING-DATA)
 22639*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 420
* EL050.cbl
 22640*    END-EXEC
 22641     MOVE LENGTH OF
 22642      MAILING-DATA
 22643       TO DFHEIV11
 22644*    MOVE '&"IL       E          (  N#00020938' TO DFHEIV0
 22645     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22647     MOVE X'204E233030303230393338' TO DFHEIV0(25:11)
 22648     CALL 'kxdfhei1' USING DFHEIV0,
 22649           FILE-ERMAIL,
 22650           MAILING-DATA,
 22651           DFHEIV11,
 22652           MA-CONTROL-PRIMARY,
 22653           DFHEIV99,
 22654           DFHEIV99,
 22655           DFHEIV99
 22656     MOVE EIBRESP  TO WS-RESPONSE
 22657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22658
 22659     IF WS-RESP-NORMAL
 22660         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22661     END-IF.
 22662
 22663     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22664     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22665
 22666
 22667* EXEC CICS READ
 22668*         DATASET  (CRTT-ID)
 22669*         RIDFLD   (WS-ELCRTT-KEY)
 22670*         INTO     (CERTIFICATE-TRAILERS)
 22671*         RESP     (WS-RESPONSE)
 22672*    END-EXEC
 22673     MOVE LENGTH OF
 22674      CERTIFICATE-TRAILERS
 22675       TO DFHEIV11
 22676*    MOVE '&"IL       E          (  N#00020952' TO DFHEIV0
 22677     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22678     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22679     MOVE X'204E233030303230393532' TO DFHEIV0(25:11)
 22680     CALL 'kxdfhei1' USING DFHEIV0,
 22681           CRTT-ID,
 22682           CERTIFICATE-TRAILERS,
 22683           DFHEIV11,
 22684           WS-ELCRTT-KEY,
 22685           DFHEIV99,
 22686           DFHEIV99,
 22687           DFHEIV99
 22688     MOVE EIBRESP  TO WS-RESPONSE
 22689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22690
 22691     IF WS-RESP-NORMAL
 22692         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22693         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22694     END-IF.
 22695
 22696
 22697* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 421
* EL050.cbl
 22698*       DATASET   ('ELCRTO')
 22699*       FROM      (ORIGINAL-CERTIFICATE)
 22700*       RIDFLD    (OC-CONTROL-PRIMARY)
 22701*       RESP      (WS-RESPONSE)
 22702*    END-EXEC.
 22703     MOVE LENGTH OF
 22704      ORIGINAL-CERTIFICATE
 22705       TO DFHEIV11
 22706     MOVE 'ELCRTO' TO DFHEIV1
 22707*    MOVE '&$ L                  ''  N#00020964' TO DFHEIV0
 22708     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22709     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22710     MOVE X'204E233030303230393634' TO DFHEIV0(25:11)
 22711     CALL 'kxdfhei1' USING DFHEIV0,
 22712           DFHEIV1,
 22713           ORIGINAL-CERTIFICATE,
 22714           DFHEIV11,
 22715           OC-CONTROL-PRIMARY,
 22716           DFHEIV99,
 22717           DFHEIV99
 22718     MOVE EIBRESP  TO WS-RESPONSE
 22719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22720
 22721
 22722     GO TO 9991-EXIT.
 22723
 22724 9991-CHECK-INDICATORS.
 22725
 22726     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22727         GO TO 9991-EXIT
 22728     END-IF.
 22729
 22730     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22731         GO TO 9991-EXIT
 22732     END-IF.
 22733
 22734
 22735* EXEC CICS READ
 22736*       DATASET   ('ELCRTO')
 22737*       INTO      (ORIGINAL-CERTIFICATE)
 22738*       RIDFLD    (OC-CONTROL-PRIMARY)
 22739*       UPDATE
 22740*       RESP      (WS-RESPONSE)
 22741*    END-EXEC
 22742     MOVE LENGTH OF
 22743      ORIGINAL-CERTIFICATE
 22744       TO DFHEIV11
 22745     MOVE 'ELCRTO' TO DFHEIV1
 22746*    MOVE '&"IL       EU         (  N#00020983' TO DFHEIV0
 22747     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22748     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22749     MOVE X'204E233030303230393833' TO DFHEIV0(25:11)
 22750     CALL 'kxdfhei1' USING DFHEIV0,
 22751           DFHEIV1,
 22752           ORIGINAL-CERTIFICATE,
 22753           DFHEIV11,
 22754           OC-CONTROL-PRIMARY,
 22755           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 422
* EL050.cbl
 22756           DFHEIV99,
 22757           DFHEIV99
 22758     MOVE EIBRESP  TO WS-RESPONSE
 22759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22760     IF WS-RESP-NORMAL
 22761        IF PB-ISSUE
 22762          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22763          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22764          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22765          MOVE PB-I-AGE               TO OC-INS-AGE
 22766          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22767          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22768          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22769          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22770          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22771          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22772          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22773          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22774          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22775          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22776          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22777          IF PB-I-JOINT-COMMISSION > +0
 22778              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22779          ELSE
 22780              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22781          END-IF
 22782          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22783          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22784          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22785          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22786          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22787          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22788          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22789          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22790          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22791
 22792          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22793
 22794* EXEC CICS READ
 22795*             DATASET   (FILE-ERMAIL)
 22796*             RIDFLD    (MA-CONTROL-PRIMARY)
 22797*             INTO      (MAILING-DATA)
 22798*             RESP      (WS-RESPONSE)
 22799*         END-EXEC
 22800     MOVE LENGTH OF
 22801      MAILING-DATA
 22802       TO DFHEIV11
 22803*    MOVE '&"IL       E          (  N#00021023' TO DFHEIV0
 22804     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22806     MOVE X'204E233030303231303233' TO DFHEIV0(25:11)
 22807     CALL 'kxdfhei1' USING DFHEIV0,
 22808           FILE-ERMAIL,
 22809           MAILING-DATA,
 22810           DFHEIV11,
 22811           MA-CONTROL-PRIMARY,
 22812           DFHEIV99,
 22813           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 423
* EL050.cbl
 22814           DFHEIV99
 22815     MOVE EIBRESP  TO WS-RESPONSE
 22816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22817          IF WS-RESP-NORMAL
 22818             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22819          END-IF
 22820
 22821          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22822          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22823
 22824* EXEC CICS READ
 22825*             DATASET  (CRTT-ID)
 22826*             RIDFLD   (WS-ELCRTT-KEY)
 22827*             INTO     (CERTIFICATE-TRAILERS)
 22828*             RESP     (WS-RESPONSE)
 22829*         END-EXEC
 22830     MOVE LENGTH OF
 22831      CERTIFICATE-TRAILERS
 22832       TO DFHEIV11
 22833*    MOVE '&"IL       E          (  N#00021035' TO DFHEIV0
 22834     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22836     MOVE X'204E233030303231303335' TO DFHEIV0(25:11)
 22837     CALL 'kxdfhei1' USING DFHEIV0,
 22838           CRTT-ID,
 22839           CERTIFICATE-TRAILERS,
 22840           DFHEIV11,
 22841           WS-ELCRTT-KEY,
 22842           DFHEIV99,
 22843           DFHEIV99,
 22844           DFHEIV99
 22845     MOVE EIBRESP  TO WS-RESPONSE
 22846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22847          IF WS-RESP-NORMAL
 22848             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22849                               OC-INS-AGE-DEFAULT-FLAG
 22850             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22851                               OC-JNT-AGE-DEFAULT-FLAG
 22852          END-IF
 22853
 22854        ELSE
 22855          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22856             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22857             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22858             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22859          END-IF
 22860          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22861             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22862             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22863             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22864          END-IF
 22865          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22866        END-IF
 22867
 22868* EXEC CICS REWRITE
 22869*          DATASET   ('ELCRTO')
 22870*          FROM      (ORIGINAL-CERTIFICATE)
 22871*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 424
* EL050.cbl
 22872*       END-EXEC
 22873     MOVE LENGTH OF
 22874      ORIGINAL-CERTIFICATE
 22875       TO DFHEIV11
 22876     MOVE 'ELCRTO' TO DFHEIV1
 22877*    MOVE '&& L                  %  N#00021061' TO DFHEIV0
 22878     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22879     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22880     MOVE X'204E233030303231303631' TO DFHEIV0(25:11)
 22881     CALL 'kxdfhei1' USING DFHEIV0,
 22882           DFHEIV1,
 22883           ORIGINAL-CERTIFICATE,
 22884           DFHEIV11,
 22885           DFHEIV99
 22886     MOVE EIBRESP  TO WS-RESPONSE
 22887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22888     END-IF.
 22889
 22890 9991-EXIT.
 22891     EXIT.
 22892
 22893
 22894 9999-RETURN.
 22895     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22896
 22897
 22898* EXEC CICS RETURN
 22899*    END-EXEC.
 22900*    MOVE '.(                    ''   #00021075' TO DFHEIV0
 22901     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22902     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22903     MOVE X'2020233030303231303735' TO DFHEIV0(25:11)
 22904     CALL 'kxdfhei1' USING DFHEIV0,
 22905           DFHEIV99,
 22906           DFHEIV99,
 22907           DFHEIV99,
 22908           DFHEIV99,
 22909           DFHEIV99,
 22910           DFHEIV99
 22911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22912
 22913
 22914
 22915* GOBACK.
 22916     MOVE '9%                    "   ' TO DFHEIV0
 22917     MOVE 'EL050' TO DFHEIV1
 22918     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22919     GOBACK.
 22920
 22921 9999-DFHBACK SECTION.
 22922     MOVE '9%                    "   ' TO DFHEIV0
 22923     MOVE 'EL050' TO DFHEIV1
 22924     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22925     GOBACK.
 22926 9999-DFHEXIT.
 22927     IF DFHEIGDJ EQUAL 0001
 22928         NEXT SENTENCE
 22929     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 425
* EL050.cbl
 22930         GO TO 9300-ABEND,
 22931               3990-FILES-NOT-OPEN
 22932         DEPENDING ON DFHEIGDI
 22933     ELSE IF DFHEIGDJ EQUAL 3
 22934         GO TO 6610-START-BROWSE,
 22935               6630-ERRESS-PROBLEM,
 22936               6630-END-OF-FILE
 22937         DEPENDING ON DFHEIGDI
 22938     ELSE IF DFHEIGDJ EQUAL 4
 22939         GO TO 6630-END-OF-FILE,
 22940               6630-ERRESS-PROBLEM,
 22941               6630-ERRESS-PROBLEM,
 22942               6630-END-OF-FILE
 22943         DEPENDING ON DFHEIGDI
 22944     ELSE IF DFHEIGDJ EQUAL 5
 22945         GO TO 6630-END-OF-FILE,
 22946               6630-END-OF-FILE,
 22947               6630-ERRESS-PROBLEM,
 22948               6630-ERRESS-PROBLEM
 22949         DEPENDING ON DFHEIGDI
 22950     ELSE IF DFHEIGDJ EQUAL 6
 22951         GO TO 6660-START-BROWSE,
 22952               6690-ERRESC-PROBLEM,
 22953               6690-ERRESC-PROBLEM,
 22954               6690-END-OF-FILE
 22955         DEPENDING ON DFHEIGDI
 22956     ELSE IF DFHEIGDJ EQUAL 7
 22957         GO TO 6690-END-OF-FILE,
 22958               6690-ERRESC-PROBLEM,
 22959               6690-ERRESC-PROBLEM,
 22960               6690-END-OF-FILE
 22961         DEPENDING ON DFHEIGDI
 22962     ELSE IF DFHEIGDJ EQUAL 8
 22963         GO TO 6690-END-OF-FILE,
 22964               6690-ERRESC-PROBLEM,
 22965               6690-ERRESC-PROBLEM,
 22966               6690-END-OF-FILE
 22967         DEPENDING ON DFHEIGDI
 22968     ELSE IF DFHEIGDJ EQUAL 9
 22969         GO TO 7250-CONTINUE,
 22970               7250-CONTINUE
 22971         DEPENDING ON DFHEIGDI
 22972     ELSE IF DFHEIGDJ EQUAL 10
 22973         GO TO 7300-CONTINUE,
 22974               7300-CONTINUE
 22975         DEPENDING ON DFHEIGDI
 22976     ELSE IF DFHEIGDJ EQUAL 11
 22977         GO TO 8000-FREE-MAIN
 22978         DEPENDING ON DFHEIGDI
 22979     ELSE IF DFHEIGDJ EQUAL 12
 22980         GO TO 8100-NOTFND,
 22981               8100-NOTFND
 22982         DEPENDING ON DFHEIGDI
 22983     ELSE IF DFHEIGDJ EQUAL 13
 22984         GO TO 8110-NOTFND,
 22985               8110-NOTFND
 22986         DEPENDING ON DFHEIGDI
 22987     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 426
* EL050.cbl
 22988         GO TO 8130-EXIT
 22989         DEPENDING ON DFHEIGDI
 22990     ELSE IF DFHEIGDJ EQUAL 15
 22991         GO TO 8150-exit
 22992         DEPENDING ON DFHEIGDI
 22993     ELSE IF DFHEIGDJ EQUAL 16
 22994         GO TO 8180-NOTFND
 22995         DEPENDING ON DFHEIGDI
 22996     ELSE IF DFHEIGDJ EQUAL 17
 22997         GO TO 8190-NOTFND
 22998         DEPENDING ON DFHEIGDI
 22999     ELSE IF DFHEIGDJ EQUAL 18
 23000         GO TO 8195-NOTFND
 23001         DEPENDING ON DFHEIGDI
 23002     ELSE IF DFHEIGDJ EQUAL 19
 23003         GO TO 8200-NOTFND
 23004         DEPENDING ON DFHEIGDI
 23005     ELSE IF DFHEIGDJ EQUAL 20
 23006         GO TO 8300-NOTFND,
 23007               8300-ERRESS-PROBLEM,
 23008               8300-ERRESS-PROBLEM,
 23009               8300-NOTFND
 23010         DEPENDING ON DFHEIGDI
 23011     ELSE IF DFHEIGDJ EQUAL 21
 23012         GO TO 8450-FORM-NOT-FOUND,
 23013               8450-FORM-NOT-FOUND
 23014         DEPENDING ON DFHEIGDI
 23015     ELSE IF DFHEIGDJ EQUAL 22
 23016         GO TO 0199-ACCT-NOT-FOUND,
 23017               0199-ACCT-NOT-FOUND
 23018         DEPENDING ON DFHEIGDI
 23019     ELSE IF DFHEIGDJ EQUAL 23
 23020         GO TO 0199-ACCT-NOT-FOUND,
 23021               0199-ACCT-NOT-FOUND
 23022         DEPENDING ON DFHEIGDI
 23023     ELSE IF DFHEIGDJ EQUAL 24
 23024         GO TO 8582-COMP-NOT-FOUND,
 23025               8582-COMP-NOT-FOUND
 23026         DEPENDING ON DFHEIGDI
 23027     ELSE IF DFHEIGDJ EQUAL 25
 23028         GO TO 8583-AGTC-NOT-FOUND,
 23029               8583-AGTC-NOT-FOUND
 23030         DEPENDING ON DFHEIGDI
 23031     ELSE IF DFHEIGDJ EQUAL 26
 23032         GO TO 8584-BXRF-NOT-FOUND,
 23033               8584-BXRF-NOT-FOUND
 23034         DEPENDING ON DFHEIGDI
 23035     ELSE IF DFHEIGDJ EQUAL 27
 23036         GO TO 8585-PLAN-NOT-FOUND,
 23037               8585-PLAN-NOT-FOUND
 23038         DEPENDING ON DFHEIGDI
 23039     ELSE IF DFHEIGDJ EQUAL 28
 23040         GO TO 0299-CERT-NOT-FOUND
 23041         DEPENDING ON DFHEIGDI
 23042     ELSE IF DFHEIGDJ EQUAL 29
 23043         GO TO 8700-READ-CERT-MASTER
 23044         DEPENDING ON DFHEIGDI
 23045     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 03-Jul-18 09:30 Page 427
* EL050.cbl
 23046         GO TO 8720-COMP-ACCOUNTS,
 23047               8730-END-BROWSE,
 23048               8740-NOT-FOUND
 23049         DEPENDING ON DFHEIGDI
 23050     ELSE IF DFHEIGDJ EQUAL 31
 23051         GO TO 9000-NOTFND
 23052         DEPENDING ON DFHEIGDI
 23053     ELSE IF DFHEIGDJ EQUAL 32
 23054         GO TO 9100-NOTFND,
 23055               9100-NOTFND
 23056         DEPENDING ON DFHEIGDI
 23057     ELSE IF DFHEIGDJ EQUAL 33
 23058         GO TO 9991-CRTO-NOT-FOUND,
 23059               9991-CRTO-NOT-FOUND
 23060         DEPENDING ON DFHEIGDI.
 23061     MOVE '9%                    "   ' TO DFHEIV0
 23062     MOVE 'EL050' TO DFHEIV1
 23063     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23064     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41760     Code:       94722
