* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45******************************************************************
    46 ENVIRONMENT DIVISION.
    47
    48 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page   3
* EL050.cbl
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52
    53 77  FILLER   PIC X(32) VALUE '********************************'.
    54 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    55 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    56
    57 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    58 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    59                                   USAGE POINTER.
    60 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    61 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    63                                   USAGE IS POINTER.
    64 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    65 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    66                                   USAGE IS POINTER.
    67 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    69                                   USAGE IS POINTER.
    70
    71 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    73                                   USAGE IS POINTER.
    74
    75*    COPY ELC50WS.
    76*****************************************************************
    77*                                                               *
    78*                            ELC50WS.                           *
    79*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    80*                            VMOD=2.061.                        *
    81*                                                               *
    82*   THIS IS THE WORKING STORAGE FOR EL050                       *
    83*                                   EL517                       *
    84*****************************************************************
    85******************************************************************
    86*                   C H A N G E   L O G
    87*
    88* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    89*-----------------------------------------------------------------
    90*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    91* EFFECTIVE    NUMBER
    92*-----------------------------------------------------------------
    93* 123102                   PEMA  ADD DCC PROCESSING
    94* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    95* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    96* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    97* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    98* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    99* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   100* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   101* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   102* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   103* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   104* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   105* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   107* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page   4
* EL050.cbl
   108* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   109* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   110* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   111* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   112* 030309  CR2009021700001  PEMA  ADD ER-2883
   113* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   114* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   115* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   116* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   117* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   118* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   119* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   120* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   121* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   122* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   123* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   124* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   125* 061412  CR2011022800001  AJRA  NAPERSOFT
   126* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   127* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   128* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   129*-----------------------------------------------------------------
   130
   131 01  WORK-AREAS.
   132
   133*****************************************************************
   134*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   135*****************************************************************
   136
   137     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   138     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   139     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   140     12  WS-NAME-EDIT-WORK-AREA.
   141         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   142         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   143             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   144         16  WS-WORK-NAME.
   145             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   146             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   147             20  FILLER           PIC X(10)     VALUE SPACES.
   148         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   149             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   150
   151*****************************************************************
   152*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   153*****************************************************************
   154
   155     12  WS-ERRESC-KEY.
   156         16 WS-ERRESC-SEARCH-KEY.
   157             20  WS-ERRESC-COMPANY-CD PIC  X.
   158             20  WS-ERRESC-CARRIER    PIC  X.
   159             20  WS-ERRESC-GROUP      PIC X(6).
   160             20  WS-ERRESC-STATE      PIC XX.
   161             20  WS-ERRESC-ACCOUNT    PIC X(10).
   162         16 WS-ERRESC-RESIDUAL-KEY.
   163             20  WS-ERRESC-AGENT      PIC X(10).
   164             20  WS-ERRESC-RES-STATE  PIC XX.
   165             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page   5
* EL050.cbl
   166*                                          YYYYMMDD
   167     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   168     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   169
   170*RESIDENT STATE TAX MASTER(ERRESS)
   171*
   172     12  WS-ERRESS-KEY.
   173         16  WS-ERRESS-COMPANY-CD      PIC  X.
   174         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   175         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   176         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   177*                                          YYYYMMDD
   178
   179     12  WS-CONTRACT-DATE              PIC 9(8).
   180*                                          YYYYMMDD
   181     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   182     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   183         16 WS-YEAR-YY                 PIC   9999.
   184         16 FILLER                     PIC 9(4).
   185*                                          YYYYMMDD
   186     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   187     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   188     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   189     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   190
   191     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   192         88  DPRB-1ST-TIME                      VALUE ' '.
   193
   194*****************************************************************
   195*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   196*****************************************************************
   197
   198     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   199     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   200     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   201     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   202     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   203     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   204     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   205     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   206     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   207     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   208         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   209         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   210     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   211         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   212         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   213     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   214
   215     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   216     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   217
   218     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   219     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page   6
* EL050.cbl
   224     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   225     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   231     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   232     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   233     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   254     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   255     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   256     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   257     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   266     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   267     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   268     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   269     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   270     12  WS-2671-SW               PIC X         VALUE SPACE.
   271     12  WS-2672-SW               PIC X         VALUE SPACE.
   272     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   273         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   274     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   275         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   276     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   277
   278     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   279         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   280         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   281         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page   7
* EL050.cbl
   282         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   283
   284     12  WS-CREDIT-EDIT-CONTROLS.
   285         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   286         16  WS-MIN-AGE           PIC 99                VALUE  0.
   287         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   288         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   289         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   290         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   291
   292     12  WS-AGE-FIELDS.
   293         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   294         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   295         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   296         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   297
   298     12  WS-SAVE-ALLOWABLE-BENEFIT.
   299         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   300         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   301         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   302         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   303         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   304         16  FILLER                      PIC XX.
   305
   306     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   307     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   308     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   309     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   310     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   311     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   312     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   313     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   314     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   315     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   316
   317     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   318     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   319     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   320     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   321     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   322     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   323     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   324     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   325         88  WS-REDUCING              VALUE 'R'.
   326         88  WS-LEVEL                 VALUE 'L' 'P'.
   327     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   328
   329     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   330     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   331     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   332     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   333     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   334     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   335     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   336     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   337     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   338
   339     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page   8
* EL050.cbl
   340     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   341     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   342     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   343     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   344     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   345     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   346     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   347     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   348     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   349     12  WS-ACCT-SIG-SW.
   350         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   351         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   352     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   353     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   354     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-INITIALS.
   361         16  WS-INIT-1            PIC X         VALUE SPACES.
   362         16  WS-INIT-2            PIC X         VALUE SPACES.
   363
   364     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   365     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   366     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   367     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   368     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   369*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   370     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   371     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   377     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   378     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   380     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   381     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   382     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   383     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   386     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392******** FLA
   393     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   395     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   396     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   397     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page   9
* EL050.cbl
   398********
   399     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   400     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   401     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   402     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   403     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   404     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   405     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   406     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   407     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   408     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   409
   410     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   411         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   412                                         '0' THRU '9'.
   413
   414     12  NUMBER-OF-MONTHS.
   415         16  SK-MO OCCURS 12 TIMES PIC X.
   416
   417     12  WS-WORK-DATE.
   418         16  WS-YEAR            PIC 99    VALUE 00.
   419         16  WS-MONTH           PIC 99    VALUE 00.
   420         16  WS-DAY             PIC 99    VALUE 00.
   421
   422     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   423     12  WS-WORK-CRIT-DEV       REDEFINES
   424         WS-WORK-LF-CRIT-PER    PIC X(03).
   425
   426     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   427     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   428
   429     12  WS-WORK-DATE-FROM.
   430         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   431         16  FILLER             PIC X  VALUE SPACE.
   432         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   433         16  FILLER             PIC X         VALUE SPACE.
   434         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   435
   436     12  WS-WORK-DATE-THRU.
   437         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   438         16  FILLER             PIC X         VALUE SPACE.
   439         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   440         16  FILLER             PIC X         VALUE SPACE.
   441         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   442
   443     12  WS-LF-INPUT-CD.
   444         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   445         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   446
   447     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   448     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   449         16  WS-AH-INPUT-CD-1   PIC X.
   450         16  WS-AH-INPUT-CD-2-3 PIC XX.
   451
   452     12  WS-SWITCHES.
   453         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   454         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   455             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  10
* EL050.cbl
   456         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   457             88  BANK-ACCT-FOUND          VALUE 'Y'.
   458         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   459             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   460         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   461             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   462         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   463             88  COMP-MASTER-FOUND        VALUE 'Y'.
   464         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   465             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   466         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   467             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   468         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   469             88  STAT-MASTER-FOUND        VALUE 'Y'.
   470         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   471             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   472         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   473             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   474         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   475             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   476         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   477             88  FORM-MASTER-FOUND        VALUE 'Y'.
   478         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   479             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   480         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   481             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   482         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   483             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   484         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   485             88  NO-BENEFIT-FOUND         VALUE 'N'.
   486         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   487             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   488         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   489             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   490         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   491             88  AH-BENEFIT-FOUND         VALUE ' '.
   492             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   493         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   494             88  LF-BENEFIT-FOUND         VALUE ' '.
   495             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   496         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   497             88  NO-STATE-RECORD          VALUE '1'.
   498         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   499             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   500         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   501             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   502         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   503             88  CERT-WAS-FOUND           VALUE ' '.
   504             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   505         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   506             88  BROWSE-STARTED           VALUE 'Y'.
   507         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   508             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   509         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   510             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   511         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   512             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   513         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  11
* EL050.cbl
   514             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   515         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   516             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   517         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   518             88  APP-CERT-USED            VALUE 'Y' 'A'.
   519         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   520             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   521             88  FIRST-TIME-THROUGH       VALUE '1'.
   522             88  CTBL-NOT-FOUND           VALUE '2'.
   523
   524         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   525             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   526
   527         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   528             88  DLO-ERROR-FOUND          VALUE 'Y'.
   529
   530********FLA
   531     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   532     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   533********
   534     12  RC-SW-1                  PIC X           VALUE '0'.
   535     12  RC-SW-2                  PIC X           VALUE '0'.
   536     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   537     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   538     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   539     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   546     12  LIT-SPACES               PIC X           VALUE SPACES.
   547     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   548     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   549     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   550     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   551     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   552     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   553     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   554         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   555         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   556     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   557         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   558
   559 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   560     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   561     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   562 01  WS-CRI-SSN-WORK-AREA.
   563     05  WS-CRI-SOC-SEC-NO.
   564         10  WS-SS-REPT-CD       PIC X(5).
   565         10  WS-SS-LAST-NAME     PIC X(5).
   566         10  WS-SS-INITIAL       PIC X.
   567
   568     05  WS-CRI-REPORT-CODE.
   569         10  FILLER              PIC X(5).
   570         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   571
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  12
* EL050.cbl
   572     05  WS-CRI-LAST-NAME.
   573         10  WS-CRI-NAME-MOVE    PIC X(5).
   574         10  FILLER              PIC X(10).
   575
   576 01  WS-NUM-TABLE                PIC X(26)  VALUE
   577     '12345678012345070923456789'.
   578 01  FILLER REDEFINES WS-NUM-TABLE.
   579     05  WS-NUM OCCURS 26        PIC 9.
   580 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   581 01  V1                          PIC S999 COMP-3.
   582 01  V2                          PIC S999 COMP-3.
   583 01  V3                          PIC S999 COMP-3.
   584 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   585 01  FILLER REDEFINES WS-WORK-VIN.
   586     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   587 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   588 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   589 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   590 01  WS-HEX-WORK.
   591     05  FILLER                  PIC X  VALUE LOW-VALUES.
   592     05  WS-HEX-BYTE             PIC X.
   593 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   594 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   595 01  WS-WORK-HIN-ROW-B.
   596     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   597
   598 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   599 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   600     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   601 01  WS-ROW-D-TABLE.
   602     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   603
   604 01  WS-HIN-TABLE-B.
   605     05  F                       PIC XX VALUE 'A2'.
   606     05  F                       PIC XX VALUE 'B3'.
   607     05  F                       PIC XX VALUE 'C4'.
   608     05  F                       PIC XX VALUE 'D5'.
   609     05  F                       PIC XX VALUE 'E6'.
   610     05  F                       PIC XX VALUE 'F7'.
   611     05  F                       PIC XX VALUE 'G8'.
   612     05  F                       PIC XX VALUE 'H9'.
   613     05  F                       PIC XX VALUE 'I1'.
   614     05  F                       PIC XX VALUE 'J2'.
   615     05  F                       PIC XX VALUE 'K3'.
   616     05  F                       PIC XX VALUE 'L4'.
   617     05  F                       PIC XX VALUE 'M5'.
   618     05  F                       PIC XX VALUE 'N6'.
   619     05  F                       PIC XX VALUE 'O0'.
   620     05  F                       PIC XX VALUE 'P7'.
   621     05  F                       PIC XX VALUE 'Q0'.
   622     05  F                       PIC XX VALUE 'R8'.
   623     05  F                       PIC XX VALUE 'S9'.
   624     05  F                       PIC XX VALUE 'T2'.
   625     05  F                       PIC XX VALUE 'U3'.
   626     05  F                       PIC XX VALUE 'V4'.
   627     05  F                       PIC XX VALUE 'W5'.
   628     05  F                       PIC XX VALUE 'X6'.
   629     05  F                       PIC XX VALUE 'Y7'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  13
* EL050.cbl
   630     05  F                       PIC XX VALUE 'Z8'.
   631 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   632     05  WS-VAL-IN               PIC X.
   633     05  WS-VAL-OUT              PIC 9.
   634 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   635 01  WS-COMPARE-BINARY-DATES.
   636     05  WS-971231                PIC XX VALUE X'92FF'.
   637     05  WS-931231                PIC XX VALUE X'8CFF'.
   638     05  WS-791231                PIC XX VALUE X'77FF'.
   639     05  WS-771001                PIC XX VALUE X'74A1'.
   640     05  WS-820301                PIC XX VALUE X'7B41'.
   641     05  WS-831031                PIC XX VALUE X'7DBF'.
   642     05  WS-831231                PIC XX VALUE X'7DFF'.
   643     05  WS-810831                PIC XX VALUE X'7A7F'.
   644     05  WS-830901                PIC XX VALUE X'7D81'.
   645
   646 01  FILE-ACCESS-IDS.
   647     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   648     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   649     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   650     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   651     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   652     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   653     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   654     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   655     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   656     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   657     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   658     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   659     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   660     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   661     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   662     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   663     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   664 01  DD-IU-SW                    PIC X   VALUE ' '.
   665     88  DD-IU-PRESENT                 VALUE 'Y'.
   666
   667 01  ACCESS-KEYS.
   668     12  ELMSTR-KEY.
   669         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   670         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   671     12  W-CLAIM-KEY.
   672         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   673         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   674
   675     12  ELCNTL-KEY.
   676         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   677         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   678         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   679         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   680
   681     12  ELCERT-KEY.
   682         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   683         16  CERT-CARRIER         PIC X       VALUE SPACE.
   684         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   685         16  CERT-STATE           PIC XX      VALUE SPACES.
   686         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   687         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  14
* EL050.cbl
   688         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   689
   690     12  ELCERT2-KEY.
   691         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   692         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   693
   694     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   695
   696     12  ELCERT-SAVE.
   697         16  FILLER                      PIC XX    VALUE SPACES.
   698
   699         16  WCS-CONTROL-PRIMARY.
   700             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   701             20  WCS-CARRIER             PIC X     VALUE SPACE.
   702             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   703             20  WCS-STATE               PIC XX    VALUE SPACES.
   704             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   705             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   706             20  WCS-CERT-NO.
   707                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   708                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   709
   710         16  CS-CONTROL-BY-NAME.
   711             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   712             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   713             20  CS-INSURED-INITIALS.
   714                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   715                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-SSN.
   718             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   719             20  CS-SOC-SEC-NO.
   720                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   721                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   722                 24  CS-SSN-LN3.
   723                     28 CS-INSURED-INITIALS-A2   PIC XX
   724                                     VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A2     PIC X
   726                                     VALUE SPACE.
   727
   728         16  CS-CONTROL-BY-CERT-NO.
   729             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   730             20  CS-CERT-NO-A4           PIC X(11)
   731                                     VALUE SPACES.
   732
   733         16  CS-CONTROL-BY-MEMB.
   734             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   735             20  CS-MEMBER-NO.
   736                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   737                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   738                 24  CS-MEMB-LN4.
   739                     28 CS-INSURED-INITIALS-A5   PIC XX
   740                                      VALUE SPACES.
   741                     28 CS-PART-LAST-NAME-A5     PIC XX
   742                                      VALUE SPACES.
   743
   744         16  FILLER              PIC X(360) VALUE SPACES.
   745
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  15
* EL050.cbl
   746     12  ERACCT-KEY.
   747         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   749         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   750         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   751         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   753
   754     12  ERCOMP-KEY.
   755         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   756         16  COMP-CARRIER         PIC X     VALUE SPACES.
   757         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   758         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   759         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   760         16  COMP-TYPE            PIC X     VALUE SPACES.
   761
   762     12  ERLOFC-KEY.
   763         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   764         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   765         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   766         16  LOFC-STATE           PIC XX    VALUE SPACES.
   767         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   768         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   769
   770     12  WS-ELCRTT-KEY.
   771         16  WS-ELCRTT-PRIMARY       PIC X(33).
   772         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   773
   774     12  ERBXRF-KEY.
   775         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   776         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   777         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   778         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   779
   780     12  ERAGTC-KEY.
   781         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   782         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   783         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   784         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   785         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   786         16  AGTC-TYPE            PIC X     VALUE SPACES.
   787
   788     12  ERPLAN-KEY.
   789         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   790         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   791         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   792         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   793         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   794         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   795         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   796         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   797
   798     12  ERFORM-KEY.
   799         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   800         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   801         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   802         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   803
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  16
* EL050.cbl
   804     12  ERREIN-KEY.
   805         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  REIN-TYPE            PIC X     VALUE SPACES.
   807         16  REIN-TABLE-CO.
   808             20  REIN-CODE-1      PIC X     VALUE SPACE.
   809             20  REIN-CODE-2      PIC X     VALUE SPACE.
   810             20  REIN-CODE-3      PIC X     VALUE SPACE.
   811         16  FILLER               PIC X(3)  VALUE SPACES.
   812
   813     12  ERCTBL-KEY.
   814         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   815         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   816         16  CTBL-CNTRL-2.
   817             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   818             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   819
   820     12  ELCRTO-KEY.
   821         16  ELCRTO-COMPANY-CD       PIC X.
   822         16  ELCRTO-CARRIER          PIC X.
   823         16  ELCRTO-GROUPING         PIC X(6).
   824         16  ELCRTO-STATE            PIC XX.
   825         16  ELCRTO-ACCOUNT          PIC X(10).
   826         16  ELCRTO-CERT-EFF-DT      PIC XX.
   827         16  ELCRTO-CERT-NO.
   828             20  ELCRTO-CERT-PRIME   PIC X(10).
   829             20  ELCRTO-CERT-SFX     PIC X.
   830         16  ELCRTO-RECORD-TYPE      PIC X.
   831         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   832
   833
   834     12  WS-ACCESS.
   835         16  FILLER               PIC XX    VALUE SPACES.
   836         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   837
   838     12  WS-CARR-ACCESS.
   839         16  FILLER               PIC X(3)  VALUE SPACES.
   840         16  WS-CARR              PIC X     VALUE SPACE.
   841*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   842*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   843     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   844         88  WS-DMD-LF-RATING   VALUE 'Y'.
   845         88  WS-DMD-AH-RATING   VALUE 'Y'.
   846         88  WS-DMD-NO-RATING   VALUE 'N'.
   847
   848     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   849         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   850                                         'NJ' 'NL'
   851                                         'PJ' 'PL'
   852                                         'SJ' 'SL'.
   853     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   854         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   855                                         'NI' 'NJ' 'NL' 'NU'
   856                                         'PJ' 'PL' 'PI' 'PU'
   857                                         'SI' 'SJ' 'SL' 'SU'
   858                                         'MX' 'MY' 'MZ'.
   859 01  ERPDEF-KEY-SAVE             PIC X(18).
   860 01  ERPDEF-KEY.
   861     12  ERPDEF-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  17
* EL050.cbl
   862     12  ERPDEF-STATE            PIC XX.
   863     12  ERPDEF-PROD-CD          PIC XXX.
   864     12  F                       PIC X(7).
   865     12  ERPDEF-BEN-TYPE         PIC X.
   866     12  ERPDEF-BEN-CODE         PIC XX.
   867     12  ERPDEF-EXP-DT           PIC XX.
   868
   869 01  ELSTAT-KEY-SAVE             PIC X(20).
   870 01  ELSTAT-KEY.
   871     12  ELSTAT-COMPANY-ID       PIC XXX.
   872     12  ELSTAT-CARRIER          PIC X.
   873     12  ELSTAT-GROUP            PIC X(6).
   874     12  ELSTAT-STATE            PIC XX.
   875     12  ELSTAT-EXP-DT           PIC 9(8).
   876 01  WS-ERROR-VALUES.
   877     12  ER-1570                     PIC S9(4)   VALUE +1570.
   878     12  ER-1571                     PIC S9(4)   VALUE +1571.
   879     12  ER-1575                     PIC S9(4)   VALUE +1575.
   880     12  ER-1891                     PIC S9(4)   VALUE +1891.
   881     12  ER-1892                     PIC S9(4)   VALUE +1892.
   882     12  ER-1893                     PIC S9(4)   VALUE +1893.
   883     12  ER-1894                     PIC S9(4)   VALUE +1894.
   884     12  ER-1895                     PIC S9(4)   VALUE +1895.
   885     12  ER-1896                     PIC S9(4)   VALUE +1896.
   886     12  ER-1897                     PIC S9(4)   VALUE +1897.
   887     12  ER-1898                     PIC S9(4)   VALUE +1898.
   888     12  ER-1899                     PIC S9(4)   VALUE +1899.
   889     12  ER-1900                     PIC S9(4)   VALUE +1900.
   890     12  ER-1901                     PIC S9(4)   VALUE +1901.
   891     12  ER-1902                     PIC S9(4)   VALUE +1902.
   892     12  ER-1903                     PIC S9(4)   VALUE +1903.
   893     12  ER-1904                     PIC S9(4)   VALUE +1904.
   894     12  ER-1905                     PIC S9(4)   VALUE +1905.
   895     12  ER-1906                     PIC S9(4)   VALUE +1906.
   896     12  ER-1907                     PIC S9(4)   VALUE +1907.
   897     12  ER-1909                     PIC S9(4)   VALUE +1909.
   898     12  ER-1910                     PIC S9(4)   VALUE +1910.
   899     12  ER-1911                     PIC S9(4)   VALUE +1911.
   900     12  ER-1912                     PIC S9(4)   VALUE +1912.
   901     12  ER-1913                     PIC S9(4)   VALUE +1913.
   902     12  ER-1914                     PIC S9(4)   VALUE +1914.
   903     12  ER-1915                     PIC S9(4)   VALUE +1915.
   904     12  ER-1916                     PIC S9(4)   VALUE +1916.
   905     12  ER-1917                     PIC S9(4)   VALUE +1917.
   906     12  ER-1918                     PIC S9(4)   VALUE +1918.
   907     12  ER-1919                     PIC S9(4)   VALUE +1919.
   908     12  ER-1920                     PIC S9(4)   VALUE +1920.
   909     12  ER-1921                     PIC S9(4)   VALUE +1921.
   910     12  ER-1922                     PIC S9(4)   VALUE +1922.
   911     12  ER-1923                     PIC S9(4)   VALUE +1923.
   912     12  ER-1924                     PIC S9(4)   VALUE +1924.
   913     12  ER-1925                     PIC S9(4)   VALUE +1925.
   914     12  ER-1926                     PIC S9(4)   VALUE +1926.
   915     12  ER-1927                     PIC S9(4)   VALUE +1927.
   916     12  ER-2393                     PIC S9(4)   VALUE +2393.
   917     12  ER-2600                     PIC S9(4)   VALUE +2600.
   918     12  ER-2601                     PIC S9(4)   VALUE +2601.
   919     12  ER-2602                     PIC S9(4)   VALUE +2602.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  18
* EL050.cbl
   920     12  ER-2603                     PIC S9(4)   VALUE +2603.
   921     12  ER-2604                     PIC S9(4)   VALUE +2604.
   922     12  ER-2605                     PIC S9(4)   VALUE +2605.
   923     12  ER-2606                     PIC S9(4)   VALUE +2606.
   924     12  ER-2607                     PIC S9(4)   VALUE +2607.
   925     12  ER-2608                     PIC S9(4)   VALUE +2608.
   926     12  ER-2609                     PIC S9(4)   VALUE +2609.
   927     12  ER-2610                     PIC S9(4)   VALUE +2610.
   928     12  ER-2611                     PIC S9(4)   VALUE +2611.
   929     12  ER-2612                     PIC S9(4)   VALUE +2612.
   930     12  ER-2613                     PIC S9(4)   VALUE +2613.
   931     12  ER-2614                     PIC S9(4)   VALUE +2614.
   932     12  ER-2615                     PIC S9(4)   VALUE +2615.
   933     12  ER-2616                     PIC S9(4)   VALUE +2616.
   934     12  ER-2617                     PIC S9(4)   VALUE +2617.
   935     12  ER-2618                     PIC S9(4)   VALUE +2618.
   936     12  ER-2619                     PIC S9(4)   VALUE +2619.
   937     12  ER-2620                     PIC S9(4)   VALUE +2620.
   938     12  ER-2621                     PIC S9(4)   VALUE +2621.
   939     12  ER-2622                     PIC S9(4)   VALUE +2622.
   940     12  ER-2623                     PIC S9(4)   VALUE +2623.
   941     12  ER-2624                     PIC S9(4)   VALUE +2624.
   942     12  ER-2625                     PIC S9(4)   VALUE +2625.
   943     12  ER-2626                     PIC S9(4)   VALUE +2626.
   944     12  ER-2627                     PIC S9(4)   VALUE +2627.
   945     12  ER-2628                     PIC S9(4)   VALUE +2628.
   946     12  ER-2629                     PIC S9(4)   VALUE +2629.
   947     12  ER-2630                     PIC S9(4)   VALUE +2630.
   948     12  ER-2631                     PIC S9(4)   VALUE +2631.
   949     12  ER-2632                     PIC S9(4)   VALUE +2632.
   950     12  ER-2633                     PIC S9(4)   VALUE +2633.
   951     12  ER-2634                     PIC S9(4)   VALUE +2634.
   952     12  ER-2635                     PIC S9(4)   VALUE +2635.
   953     12  ER-2636                     PIC S9(4)   VALUE +2636.
   954     12  ER-2637                     PIC S9(4)   VALUE +2637.
   955     12  ER-2638                     PIC S9(4)   VALUE +2638.
   956     12  ER-2639                     PIC S9(4)   VALUE +2639.
   957     12  ER-2640                     PIC S9(4)   VALUE +2640.
   958     12  ER-2641                     PIC S9(4)   VALUE +2641.
   959     12  ER-2642                     PIC S9(4)   VALUE +2642.
   960     12  ER-2643                     PIC S9(4)   VALUE +2643.
   961     12  ER-2644                     PIC S9(4)   VALUE +2644.
   962     12  ER-2645                     PIC S9(4)   VALUE +2645.
   963     12  ER-2646                     PIC S9(4)   VALUE +2646.
   964     12  ER-2647                     PIC S9(4)   VALUE +2647.
   965     12  ER-2648                     PIC S9(4)   VALUE +2648.
   966     12  ER-2649                     PIC S9(4)   VALUE +2649.
   967     12  ER-2650                     PIC S9(4)   VALUE +2650.
   968     12  ER-2651                     PIC S9(4)   VALUE +2651.
   969     12  ER-2652                     PIC S9(4)   VALUE +2652.
   970     12  ER-2653                     PIC S9(4)   VALUE +2653.
   971     12  ER-2654                     PIC S9(4)   VALUE +2654.
   972     12  ER-2655                     PIC S9(4)   VALUE +2655.
   973     12  ER-2656                     PIC S9(4)   VALUE +2656.
   974     12  ER-2657                     PIC S9(4)   VALUE +2657.
   975     12  ER-2658                     PIC S9(4)   VALUE +2658.
   976     12  ER-2659                     PIC S9(4)   VALUE +2659.
   977     12  ER-2660                     PIC S9(4)   VALUE +2660.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  19
* EL050.cbl
   978     12  ER-2661                     PIC S9(4)   VALUE +2661.
   979     12  ER-2662                     PIC S9(4)   VALUE +2662.
   980     12  ER-2663                     PIC S9(4)   VALUE +2663.
   981     12  ER-2664                     PIC S9(4)   VALUE +2664.
   982     12  ER-2665                     PIC S9(4)   VALUE +2665.
   983     12  ER-2666                     PIC S9(4)   VALUE +2666.
   984     12  ER-2667                     PIC S9(4)   VALUE +2667.
   985     12  ER-2668                     PIC S9(4)   VALUE +2668.
   986     12  ER-2669                     PIC S9(4)   VALUE +2669.
   987     12  ER-2670                     PIC S9(4)   VALUE +2670.
   988     12  ER-2671                     PIC S9(4)   VALUE +2671.
   989     12  ER-2672                     PIC S9(4)   VALUE +2672.
   990     12  ER-2673                     PIC S9(4)   VALUE +2673.
   991     12  ER-2674                     PIC S9(4)   VALUE +2674.
   992     12  ER-2675                     PIC S9(4)   VALUE +2675.
   993     12  ER-2676                     PIC S9(4)   VALUE +2676.
   994     12  ER-2677                     PIC S9(4)   VALUE +2677.
   995     12  ER-2678                     PIC S9(4)   VALUE +2678.
   996     12  ER-2679                     PIC S9(4)   VALUE +2679.
   997     12  ER-2680                     PIC S9(4)   VALUE +2680.
   998     12  ER-2681                     PIC S9(4)   VALUE +2681.
   999     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1000     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1001     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1002     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1003     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1004     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1005     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1006     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1007     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1008     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1009     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1010     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1011     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1012     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1013     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1014     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1015     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1016     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1017     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1018     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1019     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1020     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1021     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1022     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1023     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1024     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1025     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1026     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1027     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1028     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1029     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1030     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1031     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1032     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1033     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1034     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1035     12  ER-2728                     PIC S9(4)   VALUE +2728.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  20
* EL050.cbl
  1036     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1037     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1038     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1039     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1040     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1041     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1042     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1043     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1044     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1045     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1046     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1047     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1048     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1049     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1050     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1051     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1052     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1053     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1054     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1055     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1056     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1057     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1058     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1059     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1060     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1061     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1062     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1063     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1064     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1065     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1066     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1067     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1068     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1069     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1070     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1071     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1072     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1073     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1074     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1075     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1076     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1077     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1078     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1079     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1080     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1081     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1082     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1083     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1084     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1085     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1086     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1087     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1088     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1089     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1090     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1091     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1092     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1093     12  ER-2788                     PIC S9(4)   VALUE +2788.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  21
* EL050.cbl
  1094     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1095     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1096     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1097     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1098     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1099     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1100     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1101     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1102     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1103     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1104     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1105     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1106     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1107     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1108     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1109     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1110     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1111     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1112     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1113     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1114     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1115     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1116     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1117     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1118     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1119     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1120     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1121     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1122     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1123     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1124     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1125     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1126     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1127     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1128     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1129     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1130     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1131     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1132     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1133     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1134     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1135     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1136     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1137     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1138     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1139     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1140     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1141     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1142     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1143     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1144     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1145     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1146     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1147     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1148     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1149     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1150     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1151     12  ER-8039                     PIC S9(4)   VALUE +8039.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  22
* EL050.cbl
  1152     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1153     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1154     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1155     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1156     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1157     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1158     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1159     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1160     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1161     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1162     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1163     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1164     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1165     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1166     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1167     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1168     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1169     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1170     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1171     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1172     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1173     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1174     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1175     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1176     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1177     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1178     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1179     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1180     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1181     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1182     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1183     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1184     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1185     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1186     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1187     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1188     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1189     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1190     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1191     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1192     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1193     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1194     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1195     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1196     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1197     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1198     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1199     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1200     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1201     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1202     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1203     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1204     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1205     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1206     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1207     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1208     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1209     12  ER-8313                     PIC S9(4)   VALUE +8313.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  23
* EL050.cbl
  1210     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1211     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1212     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1213     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1214     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1215     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1216     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1217     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1218     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1219******************************************************************
  1220***************   END OF ELC50WS     ****************************
  1221******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  24
* EL050.cbl
  1224 01  WORKING-STORAGE-WORK-AREAS.
  1225     12  WS-RESPONSE             PIC S9(8)  COMP.
  1226         88  WS-RESP-NORMAL           VALUE +00.
  1227         88  WS-RESP-ERROR            VALUE +01.
  1228         88  WS-RESP-NOTFND           VALUE +13.
  1229         88  WS-RESP-DUPREC           VALUE +14.
  1230         88  WS-RESP-ENDFILE          VALUE +20.
  1231     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1232     12  WORK-AREAS.
  1233         16  WK-CONV-GREG.
  1234             24  WCG-CENT             PIC XX.
  1235             24  WCG-REST             PIC X(4).
  1236         16  WORK-GREGORIAN-DATE.
  1237             24  WK-GREG-CENT         PIC XX.
  1238             24  WK-GREG-DATE-YYMMDD.
  1239                 28  WK-GREG-YYMM     PIC X(4).
  1240                 28  WK-GREG-DD       PIC XX.
  1241
  1242         16  WORK-SELECT-DATE.
  1243             24  WK-SELECT-CENT            PIC XX.
  1244             24  WK-SELECT-DATE-YYMMDD.
  1245                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1246                 28  FILLER                PIC XX.
  1247
  1248         16  WK-FORM-NO.
  1249             24  WK-FORM-BANK-ID       PIC X(5).
  1250             24  WK-FORM-UNDRWRTR      PIC X(1).
  1251             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1252
  1253         16  WK-MEMBER-NO.
  1254             24  WK-MEMBER-1-6        PIC X(6).
  1255             24  WK-MEMBER-7-12       PIC X(6).
  1256
  1257         16  WK-FULL-CERT-NO.
  1258             24  WK-CERT-POS-1-2      PIC X(2).
  1259             24  WK-CERT-POS-3        PIC X(1).
  1260             24  WK-CERT-POS-4        PIC X(1).
  1261             24  WK-CERT-POS-5-6      PIC X(2).
  1262             24  WK-CERT-POS-7        PIC X(1).
  1263             24  WK-CERT-POS-8-11     PIC X(4).
  1264
  1265         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1266             88  VALID-RATE-CODE        VALUE 'Y'.
  1267             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1268
  1269         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1270         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1271         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1272         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1273         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1274         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1275         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1276         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1277         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1278         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1279
  1280* DLO001
  1281 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  25
* EL050.cbl
  1282     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1283     12  DMPF-RETURN-CODE          PIC XX.
  1284         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1285         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1286         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1287         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1288         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1289         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1290
  1291* DLO002
  1292 01  WS-DLO-INTERNAL-POLICY-FORM.
  1293     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1294     12  DIPF-RETURN-CODE          PIC XX.
  1295         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1296         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1297         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1298         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1299         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1300         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1301
  1302* DLO003
  1303 01  WS-DLO-VALID-BANK-ID.
  1304     12  DVBI-BANK-ID              PIC X(5).
  1305     12  DVBI-BANK-ID-TYPE         PIC X.
  1306         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1307         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1308         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1309         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1310         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1311     12  DVBI-RETURN-CODE          PIC XX.
  1312         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1313         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1314         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1315         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1316         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1317         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1318         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1319         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1320         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1321
  1322* DLO007
  1323 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1324     12  DCUA-RES-STATE            PIC XX.
  1325     12  DCUA-BEN-TYPE             PIC XX.
  1326     12  DCUA-SYS-IDENT            PIC X.
  1327         88  DCUA-CLAIM                        VALUE 'C'.
  1328         88  DCUA-PREMIUM                      VALUE 'P'.
  1329     12  DCUA-COVERAGE-RULE        PIC X.
  1330     12  DCUA-CLIENT-ID            PIC X(10).
  1331     12  DCUA-EFF-DATE             PIC X(8).
  1332     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1333     12  DCUA-RETURN-CODE          PIC XX.
  1334         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1335     12  DCUA-CERT-NUMBER          PIC X(11).
  1336     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1337     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1338
  1339* DLO011
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  26
* EL050.cbl
  1340 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1341     12  DPRB-RATE-CODE            PIC X(4).
  1342     12  DPRB-COVERAGE-CATEG       PIC X.
  1343     12  DPRB-RETURN-CODE          PIC XX.
  1344         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1345         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1346         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1347         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1348         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1349         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1350         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1351         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1352         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1353     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1354     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1355     12  DPRB-BEN-TYPE             PIC XX.
  1356
  1357* DLO017
  1358 01  WS-DLO-VALID-RATE-CODE.
  1359     12  DVRC-RATE-CODE            PIC X(4).
  1360     12  DVRC-RETURN-CODE          PIC XX.
  1361         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1362         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1363         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1364         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1365         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1366         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO019
  1369 01  WS-DLO-ORIG-COV-CAT.
  1370     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1371     12  DOCC-RETURN-CODE          PIC XX.
  1372     12  DOCC-ORIG-COV-CAT         PIC X.
  1373     12  DOCC-UNDERWITER           PIC XX.
  1374     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1375     12  DOCC-FILLER               PIC X(6).
  1376
  1377* DLO021
  1378 01  WS-DLO-VALID-LOAN-OFFICER.
  1379     12  DVLO-LOAN-OFFICER.
  1380         16  DVLO-BILL-TYPE        PIC X.
  1381         16  DVLO-BILL-SOURCE      PIC X.
  1382         16  DVLO-BATCH-TYPE       PIC X.
  1383     12  DVLO-RETURN-CODE          PIC XX.
  1384         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1385         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1386         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1387         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1388         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1389         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1390
  1391* DLO022
  1392 01  WS-DLO-VALID-STATE-CODE.
  1393     12  DVSC-STATE-CODE           PIC XX.
  1394     12  DVSC-RETURN-CODE          PIC XX.
  1395         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1396
  1397* DLO023
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  27
* EL050.cbl
  1398 01  WS-DLO-VALID-CODE-VALUES.
  1399     12  DVCV-SYSTEM-ID            PIC XX.
  1400         88  DVCV-CLAIMS                       VALUE 'CL'.
  1401         88  DVCV-CREDIT                       VALUE 'CR'.
  1402     12  DVCV-RECORD-TYPE          PIC XX.
  1403         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1404         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1405         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1406         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1407         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1408         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1409         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1410         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1411     12  DVCV-RECORD-KEY           PIC X(6).
  1412     12  DVCV-RETURN-CODE          PIC XX.
  1413         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1414         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1415         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1416         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1417         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1418         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1419         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1420     12  DVCV-CODE-DESC            PIC X(60).
  1421     12  DVCV-GEN-DESC-1           PIC X(20).
  1422     12  DVCV-GEN-DESC-2           PIC X(20).
  1423     12  DVCV-GEN-DESC-3           PIC X(20).
  1424
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  28
* EL050.cbl
  1426*    COPY ERCBXRF.
  1427******************************************************************
  1428*                                                                *
  1429*                                                                *
  1430*                            ERCBXRF                             *
  1431*                                                                *
  1432*   ONLINE CREDIT SYSTEM                                         *
  1433*                                                                *
  1434*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1435*                                                                *
  1436*   FILE TYPE = VSAM,KSDS                                        *
  1437*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1438*                                                                *
  1439*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1440*       ALTERNATE PATH = NONE                                    *
  1441*                                                                *
  1442*   LOG = NO                                                     *
  1443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1444*                                                                *
  1445******************************************************************
  1446
  1447 01  BANK-CROSS-REFERENCE.
  1448     12  BK-RECORD-ID                PIC XX.
  1449         88  VALID-BK-ID             VALUE 'BK'.
  1450
  1451     12  BK-CONTROL-PRIMARY.
  1452         16  BK-COMPANY-CD           PIC X.
  1453         16  BK-CARRIER              PIC X.
  1454         16  BK-GROUPING             PIC X(6).
  1455         16  BK-BANK-NO              PIC X(10).
  1456
  1457     12  BK-MAINT-INFORMATION.
  1458         16  BK-LAST-MAINT-DT        PIC XX.
  1459         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1460         16  BK-LAST-MAINT-USER      PIC X(4).
  1461         16  FILLER                  PIC X(9).
  1462
  1463     12  FILLER                      PIC X(37).
  1464
  1465     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1466
  1467     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1468                            DEPENDING ON BK-BANK-POINTER-CNT.
  1469         16  BK-AM-ACCOUNT           PIC X(10).
  1470         16  BK-AM-EXP-DT            PIC XX.
  1471         16  BK-AM-EFF-DT            PIC XX.
  1472         16  BK-AM-STATE             PIC XX.
  1473         16  FILLER                  PIC X(20).
  1474
  1475******************************************************************
  1476
  1477*    COPY ERCCOMP.
  1478******************************************************************
  1479*                                                                *
  1480*                                                                *
  1481*                            ERCCOMP                             *
  1482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1483*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  29
* EL050.cbl
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499*                   C H A N G E   L O G
  1500*
  1501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1502*-----------------------------------------------------------------
  1503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1504* EFFECTIVE    NUMBER
  1505*-----------------------------------------------------------------
  1506* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1507* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1508* 092205    2005050300006  PEMA  ADD LEASE FEE
  1509* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1510* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1511* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1512* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1513* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1514* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1515******************************************************************
  1516
  1517 01  COMPENSATION-MASTER.
  1518     12  CO-RECORD-ID                          PIC XX.
  1519         88  VALID-CO-ID                          VALUE 'CO'.
  1520
  1521     12  CO-CONTROL-PRIMARY.
  1522         16  CO-COMPANY-CD                     PIC X.
  1523         16  CO-CONTROL.
  1524             20  CO-CTL-1.
  1525                 24  CO-CARR-GROUP.
  1526                     28  CO-CARRIER            PIC X.
  1527                     28  CO-GROUPING.
  1528                         32  CO-GROUP-PREFIX   PIC XXX.
  1529                         32  CO-GROUP-PRIME    PIC XXX.
  1530                 24  CO-RESP-NO.
  1531                     28  CO-RESP-PREFIX        PIC X(4).
  1532                     28  CO-RESP-PRIME         PIC X(6).
  1533             20  CO-CTL-2.
  1534                 24  CO-ACCOUNT.
  1535                     28  CO-ACCT-PREFIX        PIC X(4).
  1536                     28  CO-ACCT-PRIME         PIC X(6).
  1537         16  CO-TYPE                           PIC X.
  1538             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1539             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1540             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1541
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  30
* EL050.cbl
  1542     12  CO-MAINT-INFORMATION.
  1543         16  CO-LAST-MAINT-DT                  PIC XX.
  1544         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1545         16  CO-LAST-MAINT-USER                PIC X(4).
  1546     12  FILLER                                PIC XX.
  1547     12  CO-STMT-TYPE                          PIC XXX.
  1548     12  CO-COMP-TYPE                          PIC X.
  1549         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1550     12  CO-STMT-OWNER                         PIC X(4).
  1551     12  CO-BALANCE-CONTROL                    PIC X.
  1552         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1553         88  CO-NO-BALANCE                        VALUE 'N'.
  1554
  1555     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1556         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1557         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1558         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1559
  1560     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1561         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1562         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1563
  1564     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1565     12  CO-GA-DIRECT-DEP                      PIC X.
  1566     12  CO-FUTURE-SPACE                       PIC X.
  1567         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1568
  1569     12  CO-ACCT-NAME                          PIC X(30).
  1570     12  CO-MAIL-NAME                          PIC X(30).
  1571     12  CO-ADDR-1                             PIC X(30).
  1572     12  CO-ADDR-2                             PIC X(30).
  1573     12  CO-ADDR-3.
  1574         16  CO-ADDR-CITY                      PIC X(27).
  1575         16  CO-ADDR-STATE                     PIC XX.
  1576     12  CO-CSO-1099                           PIC X.
  1577     12  CO-ZIP.
  1578         16  CO-ZIP-PRIME.
  1579             20  CO-ZIP-PRI-1ST                PIC X.
  1580                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1581             20  FILLER                        PIC X(4).
  1582         16  CO-ZIP-PLUS4                      PIC X(4).
  1583     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1584         16  CO-CAN-POSTAL-1                   PIC XXX.
  1585         16  CO-CAN-POSTAL-2                   PIC XXX.
  1586         16  FILLER                            PIC XXX.
  1587     12  CO-SOC-SEC                            PIC X(13).
  1588     12  CO-TELEPHONE.
  1589         16  CO-AREA-CODE                      PIC XXX.
  1590         16  CO-PREFIX                         PIC XXX.
  1591         16  CO-PHONE                          PIC X(4).
  1592
  1593     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1594
  1595     12  CO-AR-BAL-LEVEL                       PIC X.
  1596         88  CO-AR-REF-LVL                        VALUE '1'.
  1597         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1598         88  CO-AR-BILL-LVL                       VALUE '2'.
  1599         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  31
* EL050.cbl
  1600         88  CO-AR-FR-LVL                         VALUE '4'.
  1601
  1602     12  CO-AR-NORMAL-PRINT                    PIC X.
  1603         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1604         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1605
  1606     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1607
  1608     12  CO-AR-REPORTING                       PIC X.
  1609         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1610         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1611
  1612     12  CO-AR-PULL-CHECK                      PIC X.
  1613         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1614         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1615
  1616     12  CO-AR-BALANCE-PRINT                   PIC X.
  1617         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1618
  1619     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1620         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1621         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1622         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1623
  1624     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1625
  1626     12  CO-USER-CODE                          PIC X.
  1627     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1628
  1629******************************************************************
  1630*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1631*    THE LAST MONTH END RUN.
  1632******************************************************************
  1633
  1634     12  CO-LAST-ACTIVITY-DATE.
  1635         16  CO-ACT-YEAR                       PIC 99.
  1636         16  CO-ACT-MONTH                      PIC 99.
  1637         16  CO-ACT-DAY                        PIC 99.
  1638
  1639     12  CO-LAST-STMT-DT.
  1640         16  CO-LAST-STMT-YEAR                 PIC 99.
  1641         16  CO-LAST-STMT-MONTH                PIC 99.
  1642         16  CO-LAST-STMT-DAY                  PIC 99.
  1643
  1644     12  CO-MO-END-TOTALS.
  1645         16  CO-MONTHLY-TOTALS.
  1646             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1647             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1648             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1649             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1650             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1651
  1652         16  CO-AGING-TOTALS.
  1653             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1654             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1655             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1656             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1657
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  32
* EL050.cbl
  1658         16  CO-YTD-TOTALS.
  1659             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1660             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1661
  1662         16  CO-OVER-UNDER-TOTALS.
  1663             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1664             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1665
  1666     12  CO-MISCELLANEOUS-TOTALS.
  1667         16  CO-FICA-TOTALS.
  1668             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1669             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1670
  1671         16  CO-CLAIM-TOTALS.
  1672             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1673             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1674
  1675******************************************************************
  1676*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1677*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1678******************************************************************
  1679
  1680     12  CO-CURRENT-TOTALS.
  1681         16  CO-CURRENT-LAST-STMT-DT.
  1682             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1683             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1684             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1685
  1686         16  CO-CURRENT-MONTHLY-TOTALS.
  1687             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1689             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1690             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1691             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1692
  1693         16  CO-CURRENT-AGING-TOTALS.
  1694             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1695             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1696             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1697             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1698
  1699         16  CO-CURRENT-YTD-TOTALS.
  1700             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1702
  1703     12  CO-PAID-COMM-TOTALS.
  1704         16  CO-YTD-PAID-COMMS.
  1705             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1706             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1707
  1708     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1709         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1710         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1711
  1712     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1713         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1714         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1715         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  33
* EL050.cbl
  1716         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1717         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1718         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1719         88  CO-FINAL-LETTER                  VALUE 'F'.
  1720         88  CO-RECONCILING                   VALUE 'R'.
  1721         88  CO-PHONE-CALL                    VALUE 'P'.
  1722         88  CO-LEGAL                         VALUE 'L'.
  1723         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1724         88  CO-WRITE-OFF                     VALUE 'W'.
  1725         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1726
  1727     12  CO-CSR-CODE                       PIC X(4).
  1728
  1729     12  CO-GA-STATUS-INFO.
  1730         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1731         16  CO-GA-TERMINATION-DT          PIC XX.
  1732         16  CO-GA-STATUS-CODE             PIC X.
  1733             88  CO-GA-ACTIVE                 VALUE 'A'.
  1734             88  CO-GA-INACTIVE               VALUE 'I'.
  1735             88  CO-GA-PENDING                VALUE 'P'.
  1736         16  CO-GA-COMMENTS.
  1737             20  CO-GA-COMMENT-1           PIC X(40).
  1738             20  CO-GA-COMMENT-2           PIC X(40).
  1739             20  CO-GA-COMMENT-3           PIC X(40).
  1740             20  CO-GA-COMMENT-4           PIC X(40).
  1741
  1742     12  CO-RPTCD2                         PIC X(10).
  1743     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1744         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1745         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1746
  1747     12  CO-TYPE-AGENT                     PIC X(01).
  1748         88  CO-CORPORATION                   VALUE 'C'.
  1749         88  CO-PARTNERSHIP                   VALUE 'P'.
  1750         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1751         88  CO-TRUST                         VALUE 'T'.
  1752         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1753
  1754     12  CO-FAXNO.
  1755         16  CO-FAX-AREA-CODE                  PIC XXX.
  1756         16  CO-FAX-PREFIX                     PIC XXX.
  1757         16  CO-FAX-PHONE                      PIC X(4).
  1758
  1759     12  CO-BANK-INFORMATION.
  1760         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1761         16  CO-BANK-TRANSIT-NON REDEFINES
  1762             CO-BANK-TRANSIT-NO                PIC 9(8).
  1763
  1764         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1765     12  CO-MISC-DEDUCT-INFO REDEFINES
  1766                  CO-BANK-INFORMATION.
  1767         16  CO-MD-GL-ACCT                     PIC X(10).
  1768         16  CO-MD-DIV                         PIC XX.
  1769         16  CO-MD-CENTER                      PIC X(4).
  1770         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1771         16  CO-CREATE-AP-CHECK                PIC X.
  1772         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1773         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  34
* EL050.cbl
  1774     12  CO-ACH-STATUS                         PIC X.
  1775         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1776         88  CO-ACH-PENDING                        VALUE 'P'.
  1777
  1778     12  CO-BILL-SW                            PIC X.
  1779     12  CO-CONTROL-NAME                       PIC X(30).
  1780     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1781     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1782     12  CO-CLP-STATE                          PIC XX.
  1783     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1784     12  CO-SPP-REFUND-EDIT                    PIC X.
  1785
  1786******************************************************************
  1787
  1788*    COPY ERCAGTC.
  1789******************************************************************
  1790*                                                                *
  1791*                                                                *
  1792*                            ERCAGTC                             *
  1793*                            VMOD=2.001                          *
  1794*                                                                *
  1795*   ONLINE CREDIT SYSTEM                                         *
  1796*                                                                *
  1797*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1798*                                                                *
  1799*   FILE TYPE = VSAM,KSDS                                        *
  1800*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1801*                                                                *
  1802*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1803*       ALTERNATE PATH = NONE                                    *
  1804*                                                                *
  1805*   LOG = NO                                                     *
  1806*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1807*                                                                *
  1808******************************************************************
  1809*                   C H A N G E   L O G
  1810*
  1811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1812*-----------------------------------------------------------------
  1813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1814* EFFECTIVE    NUMBER
  1815*-----------------------------------------------------------------
  1816* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1817* 111004                         NEW FILE AND COPYBOOK
  1818* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1819******************************************************************
  1820 01  AGENT-COMMISSIONS.
  1821     12  AG-RECORD-ID                          PIC XX.
  1822         88  VALID-CO-ID                          VALUE 'AG'.
  1823     12  AG-CONTROL-PRIMARY.
  1824         16  AG-COMPANY-CD                     PIC X.
  1825         16  AG-CONTROL.
  1826             20  AG-CTL-1.
  1827                 24  AG-CARR-GROUP.
  1828                     28  AG-CARRIER            PIC X.
  1829                     28  AG-GROUPING           PIC X(6).
  1830                 24  AG-BANK                   PIC X(10).
  1831             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  35
* EL050.cbl
  1832                 24  AG-EXP-DT                 PIC XX.
  1833         16  AG-TYPE                           PIC X.
  1834             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1835             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1836     12  AG-MAINT-INFORMATION.
  1837         16  AG-LAST-MAINT-DT                  PIC XX.
  1838         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1839         16  AG-LAST-MAINT-USER                PIC X(4).
  1840         16  FILLER                            PIC X(10).
  1841     12  AG-EFF-DT                             PIC XX.
  1842     12  AG-COMM-STRUCTURE.
  1843         16  AG-AGT-COMMS OCCURS 10.
  1844             20  AG-AGT                PIC X(10).
  1845             20  AG-COM-TYP            PIC X.
  1846             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1847             20  AG-RECALC-LV-INDIC    PIC X.
  1848             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1849             20  AG-LRCALC-LV-INDIC    PIC X.
  1850             20  FILLER                PIC X(05).
  1851     12  FILLER                  PIC X(145).
  1852******************************************************************
  1853*    COPY ERCRESS.
  1854******************************************************************
  1855*                                                                *
  1856*                            ERCRESS                             *
  1857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1858*                            VMOD=2.002                          *
  1859*                                                                *
  1860*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1861*                                                                *
  1862*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1863*   VSAM RESIDENT STATE TAX MASTER                              *
  1864*                                                                *
  1865*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1866*                                                                *
  1867*   FILE TYPE = VSAM,KSDS                                        *
  1868*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1869*                                                                *
  1870*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1871*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1872*                                                                *
  1873*   LOG = NO                                                     *
  1874*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1875*                                                                *
  1876*                                                                *
  1877******************************************************************
  1878
  1879 01  RESIDENT-STATE-TAX-MASTER.
  1880
  1881     10  ERRESS-PRIMARY-KEY.
  1882         15  RES-COMPANY-CD        PIC X.
  1883         15  RES-RESIDENT-STATE    PIC XX.
  1884         15  RES-COVERAGE-CATEGORY PIC X.
  1885         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1886*                                      YYYYMMDD
  1887*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1888
  1889     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  36
* EL050.cbl
  1890
  1891         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1892         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1893         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1894         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1895
  1896     10 RES-RECALC-SW              PIC   X.
  1897         88 RECALC                VALUE 'Y'.
  1898         88 NO-RECALC             VALUE 'N'.
  1899     10  RES-MAINT-BY              PIC X(4).
  1900     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1901     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1902*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  37
* EL050.cbl
  1904*    COPY ERCRESC.
  1905******************************************************************
  1906*                                                                *
  1907*                            ERCRESC                             *
  1908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1909*                            VMOD=2.003                          *
  1910*                                                                *
  1911*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1912*                                                                *
  1913*   FILE TYPE = VSAM,KSDS                                        *
  1914*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1915*                                                                *
  1916*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1917*       ALTERNATE PATH1 = NONE                                   *
  1918*                                                                *
  1919*   LOG = NO                                                     *
  1920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1921*                                                                *
  1922******************************************************************
  1923
  1924 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1925
  1926     10  ERRESC-RECORD-KEY.
  1927         15  RESC-COMPANY-CD           PIC   X.
  1928         15  RESC-CARRIER              PIC   X.
  1929         15  RESC-GROUP                PIC   X(6).
  1930         15  RESC-STATE                PIC   XX.
  1931         15  RESC-ACCOUNT              PIC   X(10).
  1932         15  RESC-AGENT                PIC   X(10).
  1933         15  RESC-RESIDENT-STATE       PIC   XX.
  1934         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1935*                                           YYYYMMDD
  1936     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1937
  1938     10  RESC-COMM-RECORD-DATA.
  1939         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1940             20 RESC-COVERAGE-CAT      PIC    X.
  1941             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1942             20 RESC-COMMISSION-TAB REDEFINES
  1943                RESC-COMMISSION-PER    PIC  XXX.
  1944
  1945     10  RESC-MAINT-BY                 PIC X(4).
  1946     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1947     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1948*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  38
* EL050.cbl
  1950*    COPY ERCPLAN.
  1951******************************************************************
  1952*                                                                *
  1953*                                                                *
  1954*                            ERCPLAN                             *
  1955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1956*                            VMOD=2.003                          *
  1957*                                                                *
  1958*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1959*                                                                *
  1960*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1961*   PLAN MASTER                                                  *
  1962*                                                                *
  1963*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1964*                                                                *
  1965*   FILE TYPE = VSAM,KSDS                                        *
  1966*   RECORD SIZE = 420   RECFORM = FIX                            *
  1967*                                                                *
  1968*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1969*       ALTERNATE PATH1 = N/A                                    *
  1970*                                                                *
  1971*   LOG = NO                                                     *
  1972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1973*                                                                *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  PLAN-MASTER.
  1978     12  PL-RECORD-ID                      PIC XX.
  1979         88  VALID-PL-ID                      VALUE 'PL'.
  1980
  1981     12  PL-CONTROL-PRIMARY.
  1982         16  PL-COMPANY-CD                 PIC X.
  1983         16  PL-MSTR-CNTRL.
  1984             20  PL-CONTROL-A.
  1985                 24  PL-CARRIER            PIC X.
  1986                 24  PL-GROUPING           PIC X(6).
  1987                 24  PL-STATE              PIC XX.
  1988                 24  PL-ACCOUNT            PIC X(10).
  1989             20  PL-BENEFIT-TYPE           PIC X.
  1990             20  PL-BENEFIT-CODE           PIC XX.
  1991             20  PL-REVISION-NO            PIC X(3).
  1992
  1993     12  PL-CONTROL-BY-VAR-GRP.
  1994         16  PL-COMPANY-CD-A1              PIC X.
  1995         16  PL-VG-CARRIER                 PIC X.
  1996         16  PL-VG-GROUPING                PIC X(6).
  1997         16  PL-VG-STATE                   PIC XX.
  1998         16  PL-VG-ACCOUNT                 PIC X(10).
  1999         16  PL-BENEFIT-TYPE-A1            PIC X.
  2000         16  PL-BENEFIT-CODE-A1            PIC XX.
  2001         16  PL-REVISION-NO-A1             PIC 999.
  2002
  2003     12  PL-MAINT-INFORMATION.
  2004         16  PL-LAST-MAINT-DT              PIC XX.
  2005         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2006         16  PL-LAST-MAINT-USER            PIC X(4).
  2007         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  39
* EL050.cbl
  2008
  2009     12  PL-LIABILITY-LIMITS.
  2010         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2011         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2012             20  PL-LM-AGE                 PIC S99        COMP-3.
  2013             20  PL-LM-DUR                 PIC S999       COMP-3.
  2014             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2015             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2016
  2017     12  FILLER                            PIC X(30).
  2018
  2019     12  PL-GL-ACCOUNT-NOS.
  2020         16  PL-PREMIUM-GL                 PIC X(8).
  2021         16  PL-COMM-GL                    PIC X(8).
  2022         16  PL-CLAIM-GL                   PIC X(8).
  2023     12  FILLER                            PIC X(24).
  2024     12  PL-TOLERANCES.
  2025         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2026         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2027         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2028         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2029         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2030         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2031     12  PL-OVER-SHORT.
  2032         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2033         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2034     12  FILLER                            PIC X(24).
  2035     12  PLAN-MISC.
  2036         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2037         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2038         16  PL-IG                         PIC X.
  2039         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2040         16  PL-POLICY-FORM                PIC X(12).
  2041         16  PL-EDIT-FOR-FORM              PIC X(01).
  2042         16  PL-DEV-CODE                   PIC XXX.
  2043         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2044         16  PL-CALC-METHOD                PIC X.
  2045         16  PL-BENEFIT-GROUP              PIC X(05).
  2046         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2047
  2048         16  FILLER                        PIC X(99).
  2049******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  40
* EL050.cbl
  2051*    COPY ELCCERT.
  2052******************************************************************
  2053*                                                                *
  2054*                            ELCCERT.                            *
  2055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2056*                            VMOD=2.013                          *
  2057*                                                                *
  2058*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2059*                                                                *
  2060*   FILE TYPE = VSAM,KSDS                                        *
  2061*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2062*                                                                *
  2063*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2064*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2065*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2066*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2067*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2068*                                                                *
  2069*   LOG = YES                                                    *
  2070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2071******************************************************************
  2072*                   C H A N G E   L O G
  2073*
  2074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2075*-----------------------------------------------------------------
  2076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2077* EFFECTIVE    NUMBER
  2078*-----------------------------------------------------------------
  2079* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2080* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2081* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2082* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2083* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2084* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2085* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2086* 032612  CR2011110200001  PEMA  AHL CHANGES
  2087******************************************************************
  2088
  2089 01  CERTIFICATE-MASTER.
  2090     12  CM-RECORD-ID                      PIC XX.
  2091         88  VALID-CM-ID                      VALUE 'CM'.
  2092
  2093     12  CM-CONTROL-PRIMARY.
  2094         16  CM-COMPANY-CD                 PIC X.
  2095         16  CM-CARRIER                    PIC X.
  2096         16  CM-GROUPING.
  2097             20  CM-GROUPING-PREFIX        PIC X(3).
  2098             20  CM-GROUPING-PRIME         PIC X(3).
  2099         16  CM-STATE                      PIC XX.
  2100         16  CM-ACCOUNT.
  2101             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2102             20  CM-ACCOUNT-PRIME          PIC X(6).
  2103         16  CM-CERT-EFF-DT                PIC XX.
  2104         16  CM-CERT-NO.
  2105             20  CM-CERT-PRIME             PIC X(10).
  2106             20  CM-CERT-SFX               PIC X.
  2107
  2108     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  41
* EL050.cbl
  2109         16  CM-COMPANY-CD-A1              PIC X.
  2110         16  CM-INSURED-LAST-NAME          PIC X(15).
  2111         16  CM-INSURED-INITIALS.
  2112             20  CM-INSURED-INITIAL1       PIC X.
  2113             20  CM-INSURED-INITIAL2       PIC X.
  2114
  2115     12  CM-CONTROL-BY-SSN.
  2116         16  CM-COMPANY-CD-A2              PIC X.
  2117         16  CM-SOC-SEC-NO.
  2118             20  CM-SSN-STATE              PIC XX.
  2119             20  CM-SSN-ACCOUNT            PIC X(6).
  2120             20  CM-SSN-LN3.
  2121                 25  CM-INSURED-INITIALS-A2.
  2122                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2123                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2124                 25 CM-PART-LAST-NAME-A2         PIC X.
  2125
  2126     12  CM-CONTROL-BY-CERT-NO.
  2127         16  CM-COMPANY-CD-A4              PIC X.
  2128         16  CM-CERT-NO-A4                 PIC X(11).
  2129
  2130     12  CM-CONTROL-BY-MEMB.
  2131         16  CM-COMPANY-CD-A5              PIC X.
  2132         16  CM-MEMBER-NO.
  2133             20  CM-MEMB-STATE             PIC XX.
  2134             20  CM-MEMB-ACCOUNT           PIC X(6).
  2135             20  CM-MEMB-LN4.
  2136                 25  CM-INSURED-INITIALS-A5.
  2137                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2138                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2139                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2140
  2141     12  CM-INSURED-PROFILE-DATA.
  2142         16  CM-INSURED-FIRST-NAME.
  2143             20  CM-INSURED-1ST-INIT       PIC X.
  2144             20  FILLER                    PIC X(9).
  2145         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2146         16  CM-INSURED-SEX                PIC X.
  2147             88  CM-SEX-MALE                  VALUE 'M'.
  2148             88  CM-SEX-FEMAL                 VALUE 'F'.
  2149         16  CM-INSURED-JOINT-AGE          PIC 99.
  2150         16  CM-JOINT-INSURED-NAME.
  2151             20  CM-JT-LAST-NAME           PIC X(15).
  2152             20  CM-JT-FIRST-NAME.
  2153                 24  CM-JT-1ST-INIT        PIC X.
  2154                 24  FILLER                PIC X(9).
  2155             20  CM-JT-INITIAL             PIC X.
  2156
  2157     12  CM-LIFE-DATA.
  2158         16  CM-LF-BENEFIT-CD              PIC XX.
  2159         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2160         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2161         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2162         16  CM-LF-DEV-CODE                PIC XXX.
  2163         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2164         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2165         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2166         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  42
* EL050.cbl
  2167         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2168         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2169         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2170         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2171         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2172         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2173         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2174         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2175         16  FILLER                        PIC XX.
  2176
  2177     12  CM-AH-DATA.
  2178         16  CM-AH-BENEFIT-CD              PIC XX.
  2179         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2180         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2181         16  CM-AH-DEV-CODE                PIC XXX.
  2182         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2183         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2184         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2185         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2186         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2187         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2188         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2189         16  CM-AH-PAID-THRU-DT            PIC XX.
  2190             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2191         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2192         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2193         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2194         16  FILLER                        PIC X.
  2195
  2196     12  CM-LOAN-INFORMATION.
  2197         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2198         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2199                                           PIC S9(5)V99  COMP-3.
  2200         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2201         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2202         16  CM-PAY-FREQUENCY              PIC S99.
  2203         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2204         16  CM-RATE-CLASS                 PIC XX.
  2205         16  CM-BENEFICIARY                PIC X(25).
  2206         16  CM-POLICY-FORM-NO             PIC X(12).
  2207         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2208         16  CM-LAST-ADD-ON-DT             PIC XX.
  2209         16  CM-DEDUCTIBLE-AMOUNTS.
  2210             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2211             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2212         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2213             20  CM-RESIDENT-STATE         PIC XX.
  2214             20  CM-RATE-CODE              PIC X(4).
  2215             20  FILLER                    PIC XX.
  2216         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2217             20  CM-LOAN-OFFICER           PIC X(5).
  2218             20  FILLER                    PIC XXX.
  2219         16  CM-CSR-CODE                   PIC XXX.
  2220         16  CM-UNDERWRITING-CODE          PIC X.
  2221             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2222         16  CM-POST-CARD-IND              PIC X.
  2223         16  CM-NH-INTERFACE-SW            PIC X.
  2224         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  43
* EL050.cbl
  2225             88  CM-SING-PRM                  VALUE '1'.
  2226             88  CM-O-B-COVERAGE              VALUE '2'.
  2227             88  CM-OPEN-END                  VALUE '3'.
  2228         16  CM-IND-GRP-TYPE               PIC X.
  2229             88  CM-INDIVIDUAL                VALUE 'I'.
  2230             88  CM-GROUP                     VALUE 'G'.
  2231         16  CM-SKIP-CODE                  PIC X.
  2232             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2233             88  SKIP-JULY                    VALUE '1'.
  2234             88  SKIP-AUGUST                  VALUE '2'.
  2235             88  SKIP-SEPTEMBER               VALUE '3'.
  2236             88  SKIP-JULY-AUG                VALUE '4'.
  2237             88  SKIP-AUG-SEPT                VALUE '5'.
  2238             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2239             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2240             88  SKIP-JUNE                    VALUE '8'.
  2241             88  SKIP-JUNE-JULY               VALUE '9'.
  2242             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2243             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2244         16  CM-PAYMENT-MODE               PIC X.
  2245             88  PAY-MONTHLY                  VALUE SPACE.
  2246             88  PAY-WEEKLY                   VALUE '1'.
  2247             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2248             88  PAY-BI-WEEKLY                VALUE '3'.
  2249             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2250         16  CM-LOAN-NUMBER                PIC X(8).
  2251         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2252         16  CM-OLD-LOF                    PIC XXX.
  2253*        16  CM-LOAN-OFFICER               PIC XXX.
  2254         16  CM-REIN-TABLE                 PIC XXX.
  2255         16  CM-SPECIAL-REIN-CODE          PIC X.
  2256         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2257         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2258         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2259
  2260     12  CM-STATUS-DATA.
  2261         16  CM-ENTRY-STATUS               PIC X.
  2262         16  CM-ENTRY-DT                   PIC XX.
  2263
  2264         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2265         16  CM-LF-CANCEL-DT               PIC XX.
  2266         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2267
  2268         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2269         16  CM-LF-DEATH-DT                PIC XX.
  2270         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2271
  2272         16  CM-LF-CURRENT-STATUS          PIC X.
  2273             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2274                                                'M' '4' '5' '9'.
  2275             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2276             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2277             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2278             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2279             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2280             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2281             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2282             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  44
* EL050.cbl
  2283             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2284             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2285             88  CM-LF-DECLINED               VALUE 'D'.
  2286             88  CM-LF-VOIDED                 VALUE 'V'.
  2287
  2288         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2289         16  CM-AH-CANCEL-DT               PIC XX.
  2290         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2291
  2292         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2293         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2294         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2295
  2296         16  CM-AH-CURRENT-STATUS          PIC X.
  2297             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2298                                                'M' '4' '5' '9'.
  2299             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2300             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2301             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2302             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2303             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2304             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2305             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2306             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2307             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2308             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2309             88  CM-AH-DECLINED               VALUE 'D'.
  2310             88  CM-AH-VOIDED                 VALUE 'V'.
  2311
  2312         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2313             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2314             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2315             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2316         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2317
  2318         16  CM-ENTRY-BATCH                PIC X(6).
  2319         16  CM-LF-EXIT-BATCH              PIC X(6).
  2320         16  CM-AH-EXIT-BATCH              PIC X(6).
  2321         16  CM-LAST-MONTH-END             PIC XX.
  2322
  2323     12  CM-NOTE-SW                        PIC X.
  2324         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2325         88  CERT-NOTES-PRESENT               VALUE '1'.
  2326         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2327         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2328         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2329         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2330         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2331         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2332     12  CM-COMP-EXCP-SW                   PIC X.
  2333         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2334         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2335     12  CM-INSURED-ADDRESS-SW             PIC X.
  2336         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2337         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2338
  2339*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2340     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  45
* EL050.cbl
  2341     12  FILLER                            PIC X.
  2342
  2343*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2344     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2345     12  FILLER                            PIC X.
  2346*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2347     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2348
  2349     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2350         88  CERT-ADDED-BATCH                 VALUE ' '.
  2351         88  CERT-ADDED-ONLINE                VALUE '1'.
  2352         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2353         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2354         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2355     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2356         88  CERT-AS-LOADED                   VALUE ' '.
  2357         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2358         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2359         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2360         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2361         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2362         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2363         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2364
  2365     12  CM-ACCOUNT-COMM-PCTS.
  2366         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2367         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2368
  2369     12  CM-USER-FIELD                     PIC X.
  2370     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2371     12  CM-CLP-STATE                      PIC XX.
  2372     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2373     12  CM-USER-RESERVED                  PIC XXX.
  2374     12  FILLER REDEFINES CM-USER-RESERVED.
  2375         16  CM-AH-CLASS-CD                PIC XX.
  2376         16  F                             PIC X.
  2377******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  46
* EL050.cbl
  2379*    COPY ERCMAIL.
  2380******************************************************************
  2381*                                                                *
  2382*                                                                *
  2383*                            ERCMAIL                             *
  2384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2385*                            VMOD=2.003                          *
  2386*                                                                *
  2387*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2388*                                                                *
  2389*   FILE TYPE = VSAM,KSDS                                        *
  2390*   RECORD SIZE = 374   RECFORM = FIX                            *
  2391*                                                                *
  2392*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2393*   ALTERNATE PATH    = NOT USED                                 *
  2394*                                                                *
  2395*   LOG = YES                                                    *
  2396*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2397******************************************************************
  2398*                   C H A N G E   L O G
  2399*
  2400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2401*-----------------------------------------------------------------
  2402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2403* EFFECTIVE    NUMBER
  2404*-----------------------------------------------------------------
  2405* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2406* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2407* 111108                   PEMA  ADD CRED BENE ADDR2
  2408******************************************************************
  2409
  2410 01  MAILING-DATA.
  2411     12  MA-RECORD-ID                      PIC XX.
  2412         88  VALID-MA-ID                       VALUE 'MA'.
  2413
  2414     12  MA-CONTROL-PRIMARY.
  2415         16  MA-COMPANY-CD                 PIC X.
  2416         16  MA-CARRIER                    PIC X.
  2417         16  MA-GROUPING.
  2418             20  MA-GROUPING-PREFIX        PIC XXX.
  2419             20  MA-GROUPING-PRIME         PIC XXX.
  2420         16  MA-STATE                      PIC XX.
  2421         16  MA-ACCOUNT.
  2422             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2423             20  MA-ACCOUNT-PRIME          PIC X(6).
  2424         16  MA-CERT-EFF-DT                PIC XX.
  2425         16  MA-CERT-NO.
  2426             20  MA-CERT-PRIME             PIC X(10).
  2427             20  MA-CERT-SFX               PIC X.
  2428
  2429     12  FILLER                            PIC XX.
  2430
  2431     12  MA-ACCESS-CONTROL.
  2432         16  MA-SOURCE-SYSTEM              PIC XX.
  2433             88  MA-FROM-CREDIT                VALUE 'CR'.
  2434             88  MA-FROM-VSI                   VALUE 'VS'.
  2435             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2436             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  47
* EL050.cbl
  2437         16  MA-RECORD-ADD-DT              PIC XX.
  2438         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2439         16  MA-LAST-MAINT-DT              PIC XX.
  2440         16  MA-LAST-MAINT-BY              PIC XXXX.
  2441         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2442
  2443     12  MA-PROFILE-INFO.
  2444         16  MA-QUALIFY-CODE-1             PIC XX.
  2445         16  MA-QUALIFY-CODE-2             PIC XX.
  2446         16  MA-QUALIFY-CODE-3             PIC XX.
  2447         16  MA-QUALIFY-CODE-4             PIC XX.
  2448         16  MA-QUALIFY-CODE-5             PIC XX.
  2449
  2450         16  MA-INSURED-LAST-NAME          PIC X(15).
  2451         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2452         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2453         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2454         16  MA-INSURED-BIRTH-DT           PIC XX.
  2455         16  MA-INSURED-SEX                PIC X.
  2456             88  MA-SEX-MALE                   VALUE 'M'.
  2457             88  MA-SEX-FEMALE                 VALUE 'F'.
  2458         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2459
  2460         16  MA-ADDRESS-CORRECTED          PIC X.
  2461         16  MA-JOINT-BIRTH-DT             PIC XX.
  2462*        16  FILLER                        PIC X(12).
  2463
  2464         16  MA-ADDRESS-LINE-1             PIC X(30).
  2465         16  MA-ADDRESS-LINE-2             PIC X(30).
  2466         16  MA-CITY-STATE.
  2467             20  MA-CITY                   PIC X(28).
  2468             20  MA-ADDR-STATE             PIC XX.
  2469         16  MA-ZIP.
  2470             20  MA-ZIP-CODE.
  2471                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2472                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2473                 24  FILLER                PIC X(4).
  2474             20  MA-ZIP-PLUS4              PIC X(4).
  2475         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2476             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2477             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2478             20  FILLER                    PIC X(3).
  2479
  2480         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2481
  2482         16  FILLER                        PIC XXX.
  2483*        16  FILLER                        PIC X(10).
  2484
  2485     12  MA-CRED-BENE-INFO.
  2486         16  MA-CRED-BENE-NAME                 PIC X(25).
  2487         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2488         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2489         16  MA-CRED-BENE-CTYST.
  2490             20  MA-CRED-BENE-CITY             PIC X(28).
  2491             20  MA-CRED-BENE-STATE            PIC XX.
  2492         16  MA-CRED-BENE-ZIP.
  2493             20  MA-CB-ZIP-CODE.
  2494                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  48
* EL050.cbl
  2495                     88  MA-CB-CANADIAN-POST-CODE
  2496                                           VALUE 'A' THRU 'Z'.
  2497                 24  FILLER                    PIC X(4).
  2498             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2499         16  MA-CB-CANADIAN-POSTAL-CODE
  2500                            REDEFINES MA-CRED-BENE-ZIP.
  2501             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2502             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2503             20  FILLER                        PIC X(3).
  2504     12  MA-POST-CARD-MAIL-DATA.
  2505         16  MA-MAIL-DATA OCCURS 7.
  2506             20  MA-MAIL-TYPE              PIC X.
  2507                 88  MA-12MO-MAILING           VALUE '1'.
  2508                 88  MA-EXP-MAILING            VALUE '2'.
  2509             20  MA-MAIL-STATUS            PIC X.
  2510                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2511                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2512                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2513             20  MA-MAIL-DATE              PIC XX.
  2514     12  FILLER                            PIC XX.
  2515     12  FILLER                            PIC XX.
  2516*    12  FILLER                            PIC X(30).
  2517******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  49
* EL050.cbl
  2519*    COPY ERCPNDM.
  2520******************************************************************
  2521*                                                                *
  2522*                                                                *
  2523*                            ERCPNDM                             *
  2524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2525*                            VMOD=2.003                          *
  2526*                                                                *
  2527*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2528*                                                                *
  2529*   FILE TYPE = VSAM,KSDS                                        *
  2530*   RECORD SIZE = 374   RECFORM = FIX                            *
  2531*                                                                *
  2532*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2533*   ALTERNATE PATH    = NOT USED                                 *
  2534*                                                                *
  2535*   LOG = YES                                                    *
  2536*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2537******************************************************************
  2538*                   C H A N G E   L O G
  2539*
  2540* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2541*-----------------------------------------------------------------
  2542*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2543* EFFECTIVE    NUMBER
  2544*-----------------------------------------------------------------
  2545* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2546* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2547* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2548******************************************************************
  2549
  2550 01  PENDING-MAILING-DATA.
  2551     12  PM-RECORD-ID                      PIC XX.
  2552         88  VALID-MA-ID                       VALUE 'PM'.
  2553
  2554     12  PM-CONTROL-PRIMARY.
  2555         16  PM-COMPANY-CD                 PIC X.
  2556         16  PM-ENTRY-BATCH                PIC X(6).
  2557         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2558         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2559
  2560     12  FILLER                            PIC X(14).
  2561
  2562     12  PM-ACCESS-CONTROL.
  2563         16  PM-SOURCE-SYSTEM              PIC XX.
  2564             88  PM-FROM-CREDIT                VALUE 'CR'.
  2565             88  PM-FROM-VSI                   VALUE 'VS'.
  2566             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2567             88  PM-FROM-OTHER                 VALUE 'OT'.
  2568         16  PM-RECORD-ADD-DT              PIC XX.
  2569         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2570         16  PM-LAST-MAINT-DT              PIC XX.
  2571         16  PM-LAST-MAINT-BY              PIC XXXX.
  2572         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2573
  2574     12  PM-PROFILE-INFO.
  2575         16  PM-QUALIFY-CODE-1             PIC XX.
  2576         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  50
* EL050.cbl
  2577         16  PM-QUALIFY-CODE-3             PIC XX.
  2578         16  PM-QUALIFY-CODE-4             PIC XX.
  2579         16  PM-QUALIFY-CODE-5             PIC XX.
  2580
  2581         16  PM-INSURED-LAST-NAME          PIC X(15).
  2582         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2583         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2584         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2585         16  PM-INSURED-BIRTH-DT           PIC XX.
  2586         16  PM-INSURED-SEX                PIC X.
  2587             88  PM-SEX-MALE                   VALUE 'M'.
  2588             88  PM-SEX-FEMALE                 VALUE 'F'.
  2589         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2590
  2591         16  PM-ADDRESS-CORRECTED          PIC X.
  2592         16  PM-JOINT-BIRTH-DT             PIC XX.
  2593*        16  FILLER                        PIC X(12).
  2594
  2595         16  PM-ADDRESS-LINE-1             PIC X(30).
  2596         16  PM-ADDRESS-LINE-2             PIC X(30).
  2597         16  PM-CITY-STATE.
  2598             20  PM-CITY                   PIC X(28).
  2599             20  PM-STATE                  PIC XX.
  2600         16  PM-ZIP.
  2601             20  PM-ZIP-CODE.
  2602                 24  PM-ZIP-1              PIC X.
  2603                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2604                 24  FILLER                PIC X(4).
  2605             20  PM-ZIP-PLUS4              PIC X(4).
  2606         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2607             20  PM-CAN-POST1              PIC XXX.
  2608             20  PM-CAN-POST2              PIC XXX.
  2609             20  FILLER                    PIC XXX.
  2610
  2611         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2612
  2613         16  FILLER                        PIC X(03).
  2614
  2615     12  PM-CRED-BENE-INFO.
  2616         16  PM-CRED-BENE-NAME             PIC X(25).
  2617         16  PM-CRED-BENE-ADDR             PIC X(30).
  2618         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2619         16  PM-CRED-BENE-CTYST.
  2620             20  PM-CRED-BENE-CITY         PIC X(28).
  2621             20  PM-CRED-BENE-STATE        PIC XX.
  2622         16  PM-CRED-BENE-ZIP.
  2623             20  PM-CB-ZIP-CODE.
  2624                 24  PM-CB-ZIP-1           PIC X.
  2625                     88  PM-CB-CANADIAN-POST-CODE
  2626                                  VALUE 'A' THRU 'Z'.
  2627                 24  FILLER                PIC X(4).
  2628             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2629         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2630             20  PM-CB-CAN-POST1           PIC XXX.
  2631             20  PM-CB-CAN-POST2           PIC XXX.
  2632             20  FILLER                    PIC XXX.
  2633     12  PM-POST-CARD-MAIL-DATA.
  2634         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  51
* EL050.cbl
  2635             20  PM-MAIL-TYPE              PIC X.
  2636                 88  PM-12MO-MAILING           VALUE '1'.
  2637                 88  PM-EXP-MAILING            VALUE '2'.
  2638             20  PM-MAIL-STATUS            PIC X.
  2639                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2640                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2641                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2642             20  PM-MAIL-DATE              PIC XX.
  2643     12  FILLER                            PIC XX.
  2644     12  FILLER                            PIC X(12).
  2645*    12  FILLER                            PIC X(30).
  2646
  2647******************************************************************
  2648*                                COPY ERCLOFC.
  2649******************************************************************
  2650*                                                                *
  2651*                                                                *
  2652*                            ERCLOFC                             *
  2653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2654*                            VMOD=2.003                          *
  2655*                                                                *
  2656*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2657*                                                                *
  2658*   FILE TYPE = VSAM,KSDS                                        *
  2659*   RECORD SIZE = 670   RECFORM = FIX                            *
  2660*                                                                *
  2661*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2662*                                                                *
  2663*   LOG = YES                                                    *
  2664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2665*                                                                *
  2666******************************************************************
  2667
  2668 01  LOAN-OFFICER-MASTER.
  2669     12  LO-RECORD-ID                PIC XX.
  2670         88  VALID-LO-ID                VALUE 'LO'.
  2671
  2672     12  LO-CONTROL-PRIMARY.
  2673         16  LO-COMPANY-CD           PIC X.
  2674         16  LO-CARRIER              PIC X.
  2675         16  LO-GROUPING.
  2676             20  LO-GROUPING-PREFIX  PIC XXX.
  2677             20  LO-GROUPING-PRIME   PIC XXX.
  2678         16  LO-STATE                PIC XX.
  2679         16  LO-ACCOUNT.
  2680             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2681             20  LO-ACCOUNT-PRIME    PIC X(6).
  2682         16  LO-OFFICER-CODE         PIC X(5).
  2683
  2684     12  LO-OFFICER-NAME             PIC X(30).
  2685
  2686     12  LO-LAST-MAINT-DT            PIC XX.
  2687     12  LO-LAST-USER                PIC X(4).
  2688     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2689
  2690     12  LO-COMP-CONTROL             PIC X.
  2691             88  LO-SHOW-COMP           VALUE 'Y'.
  2692             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  52
* EL050.cbl
  2693     12  LO-DETAIL-CONTROL           PIC X.
  2694             88  LO-PRINT-DETAIL        VALUE 'D'.
  2695             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2696
  2697     12  LO-SV-CARRIER               PIC X.
  2698     12  LO-SV-GROUPING              PIC X(6).
  2699     12  LO-SV-STATE                 PIC XX.
  2700
  2701     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2702     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2703
  2704     12  LO-OFFICER-INFO.
  2705         16  FILLER OCCURS 12 TIMES.
  2706             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2707             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2708             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2709             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2710             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2711             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2712             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2713             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2714     12  FILLER                      PIC X(198).
  2715******************************************************************
  2716*                                COPY ERCPDEF.
  2717******************************************************************
  2718*                                                                *
  2719*                                                                *
  2720*                            ERCPDEF.                            *
  2721*                                                                *
  2722*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2723*                                                                *
  2724*    FILE TYPE = VSAM,KSDS                                       *
  2725*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2726*                                                                *
  2727*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2728*                                                                *
  2729*    LOG = YES                                                   *
  2730*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2731******************************************************************
  2732 01  PRODUCT-MASTER.
  2733    12  PD-RECORD-ID                 PIC X(02).
  2734        88  VALID-PD-ID                  VALUE 'PD'.
  2735    12  PD-CONTROL-PRIMARY.
  2736        16  PD-COMPANY-CD            PIC X.
  2737        16  PD-STATE                 PIC XX.
  2738        16  PD-PRODUCT-CD            PIC XXX.
  2739        16  PD-FILLER                PIC X(7).
  2740        16  PD-BEN-TYPE              PIC X.
  2741        16  PD-BEN-CODE              PIC XX.
  2742        16  PD-PROD-EXP-DT           PIC XX.
  2743    12  FILLER                       PIC X(50).
  2744    12  PD-PRODUCT-DATA OCCURS 8.
  2745        16  PD-PROD-CODE             PIC X.
  2746            88  PD-PROD-LIFE           VALUE 'L'.
  2747            88  PD-PROD-PROP           VALUE 'P'.
  2748            88  PD-PROD-AH             VALUE 'A'.
  2749            88  PD-PROD-IU             VALUE 'I'.
  2750            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  53
* EL050.cbl
  2751        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2752        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2753        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2754        16  PD-MAX-TERM              PIC S999        COMP-3.
  2755        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2756        16  FILLER                   PIC X.
  2757        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2758        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2759        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2760        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2761        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2762        16  PD-REC-CRIT-PERIOD       PIC X.
  2763        16  PD-RTW-MOS               PIC 99.
  2764        16  FILLER                   PIC X(5).
  2765    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2766    12  PD-TERM-LIMITS OCCURS 15.
  2767        16  PD-LOW-TERM              PIC S999        COMP-3.
  2768        16  PD-HI-TERM               PIC S999        COMP-3.
  2769*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2770    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2771        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2772        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2773    12  PD-EARN-FACTORS.
  2774        16  FILLER OCCURS 15.
  2775            20  FILLER OCCURS 15.
  2776                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2777    12  PD-PRODUCT-DESC              PIC X(80).
  2778    12  PD-TRUNCATED                 PIC X.
  2779    12  FILLER                       PIC X(59).
  2780    12  PD-MAINT-INFORMATION.
  2781        16  PD-LAST-MAINT-DT         PIC X(02).
  2782        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2783        16  PD-LAST-MAINT-BY         PIC X(04).
  2784*                                COPY ELCSTATE.
  2785******************************************************************
  2786*                                                                *
  2787*                                                                *
  2788*                            ELCSTATE.                           *
  2789*                                                                *
  2790*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2791*                                                                *
  2792*   FILE TYPE = VSAM,KSDS                                        *
  2793*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2794*                                                                *
  2795*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2796*       ALTERNATE INDEX = NONE                                   *
  2797*                                                                *
  2798*   LOG = YES                                                    *
  2799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2800******************************************************************
  2801*                   C H A N G E   L O G
  2802*
  2803* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2804*-----------------------------------------------------------------
  2805*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2806* EFFECTIVE    NUMBER
  2807*-----------------------------------------------------------------
  2808* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  54
* EL050.cbl
  2809******************************************************************
  2810*
  2811 01  STATE-FILE.
  2812     12  SF-RECORD-ID                       PIC XX.
  2813         88  VALID-CF-ID                        VALUE 'SF'.
  2814     12  SF-CONTROL-PRIMARY.
  2815         16  SF-COMPANY-ID                  PIC XXX.
  2816         16  SF-CARRIER-CODE                PIC X.
  2817         16  SF-GROUPING                    PIC X(6).
  2818         16  SF-STATE-CODE                  PIC XX.
  2819         16  SF-EXPIRE-DATE                 PIC 9(8).
  2820****************************************************************
  2821*             STATE CONTROLS
  2822****************************************************************
  2823     12  SF-LAST-MAINT-DT                   PIC XX.
  2824     12  SF-LAST-MAINT-BY                   PIC X(4).
  2825     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2826     12  SF-STATE-RT-CONTROLS.
  2827         16  SF-ST-RT-CALC                  PIC X.
  2828     12  SF-ST-TAX-CONTROLS.
  2829         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2830         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2831         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2832     12  SF-ST-REFUND-OPTIONS.
  2833         16  SF-ST-RF-LR-CALC               PIC X.
  2834         16  SF-ST-RF-LL-CALC               PIC X.
  2835         16  SF-ST-RF-LN-CALC               PIC X.
  2836         16  SF-ST-RF-AH-CALC               PIC X.
  2837         16  SF-ST-RF-CP-CALC               PIC X.
  2838     12  SF-ST-UNEARN-PREM-OPTIONS.
  2839         16  SF-ST-LUEP-R78                 PIC X.
  2840         16  SF-ST-LUEP-PRO                 PIC X.
  2841         16  SF-ST-LUEP-ST                  PIC X.
  2842         16  SF-ST-LUEP-DOM                 PIC X.
  2843         16  SF-ST-AUEP-R78                 PIC X.
  2844         16  SF-ST-AUEP-PRO                 PIC X.
  2845         16  SF-ST-AUEP-ST                  PIC X.
  2846         16  SF-ST-AUEP-DOM                 PIC X.
  2847         16  SF-ST-CUEP-R78                 PIC X.
  2848         16  SF-ST-CUEP-PRO                 PIC X.
  2849         16  SF-ST-CUEP-ST                  PIC X.
  2850         16  SF-ST-CUEP-DOM                 PIC X.
  2851     12  SF-ST-EARN-PREM-OPTIONS.
  2852         16  SF-ST-LEP-R78                  PIC X.
  2853         16  SF-ST-LEP-PRO                  PIC X.
  2854         16  SF-ST-LEP-ST                   PIC X.
  2855         16  SF-ST-LEP-DOM                  PIC X.
  2856         16  SF-ST-AEP-R78                  PIC X.
  2857         16  SF-ST-AEP-PRO                  PIC X.
  2858         16  SF-ST-AEP-ST                   PIC X.
  2859         16  SF-ST-AEP-DOM                  PIC X.
  2860         16  SF-ST-CEP-R78                  PIC X.
  2861         16  SF-ST-CEP-PRO                  PIC X.
  2862         16  SF-ST-CEP-ST                   PIC X.
  2863         16  SF-ST-CEP-DOM                  PIC X.
  2864     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  55
* EL050.cbl
  2866*    COPY ELCCRTT.
  2867******************************************************************
  2868*                                                                *
  2869*                            ELCCRTT.                            *
  2870*                                                                *
  2871*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2872*                                                                *
  2873*   FILE TYPE = VSAM,KSDS                                        *
  2874*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2875*                                                                *
  2876*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2877*                                                                *
  2878*   LOG = YES                                                    *
  2879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2880******************************************************************
  2881*                   C H A N G E   L O G
  2882*
  2883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2884*-----------------------------------------------------------------
  2885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2886* EFFECTIVE    NUMBER
  2887*-----------------------------------------------------------------
  2888* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2889* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2890* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2891* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2892* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2893******************************************************************
  2894
  2895 01  CERTIFICATE-TRAILERS.
  2896     12  CS-RECORD-ID                      PIC XX.
  2897         88  VALID-CS-ID                      VALUE 'CS'.
  2898
  2899     12  CS-CONTROL-PRIMARY.
  2900         16  CS-COMPANY-CD                 PIC X.
  2901         16  CS-CARRIER                    PIC X.
  2902         16  CS-GROUPING                   PIC X(6).
  2903         16  CS-STATE                      PIC XX.
  2904         16  CS-ACCOUNT                    PIC X(10).
  2905         16  CS-CERT-EFF-DT                PIC XX.
  2906         16  CS-CERT-NO.
  2907             20  CS-CERT-PRIME             PIC X(10).
  2908             20  CS-CERT-SFX               PIC X.
  2909         16  CS-TRAILER-TYPE               PIC X.
  2910             88  COMM-TRLR           VALUE 'A'.
  2911             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2912             88  CERT-DATA-TRLR      VALUE 'C'.
  2913
  2914     12  CS-DATA-AREA                      PIC X(516).
  2915
  2916     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2917         16  CS-BANK-COMMISSION-AREA.
  2918             20  CS-BANK-COMMS       OCCURS 10.
  2919                 24  CS-AGT                PIC X(10).
  2920                 24  CS-COM-TYP            PIC X.
  2921                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2922                 24  CS-RECALC-LV-INDIC    PIC X.
  2923                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  56
* EL050.cbl
  2924         16  FILLER                        PIC X(256).
  2925
  2926     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2927****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2928****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2929         16  CS-MB-CLAIM-DATA OCCURS 2.
  2930             20  FILLER OCCURS 10.
  2931                 24  CS-CLAIM-TYPE         PIC X.
  2932                     88  CS-AH-CLM           VALUE 'A'.
  2933                     88  CS-IU-CLM           VALUE 'I'.
  2934                     88  CS-GP-CLM           VALUE 'G'.
  2935                     88  CS-LF-CLM           VALUE 'L'.
  2936                     88  CS-PR-CLM           VALUE 'P'.
  2937                 24  CS-BANK               PIC S999 COMP-3.
  2938                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2939                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2940                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2941         16  FILLER                        PIC X(216).
  2942     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2943         16  CS-VIN-NUMBER                 PIC X(17).
  2944         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2945         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2946         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2947         16  FILLER                        PIC X(496).
  2948******************************************************************
  2949*    COPY ELCCRTO.
  2950******************************************************************
  2951*                                                                *
  2952*                            ELCCRTO.                            *
  2953*                                                                *
  2954*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2955*                                                                *
  2956*   FILE TYPE = VSAM,KSDS                                        *
  2957*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2958*                                                                *
  2959*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2960*                                                                *
  2961*   LOG = YES                                                    *
  2962*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2963******************************************************************
  2964*                   C H A N G E   L O G
  2965*
  2966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2967*-----------------------------------------------------------------
  2968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2969* EFFECTIVE    NUMBER
  2970*-----------------------------------------------------------------
  2971* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2972* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2973* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2974* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2975* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2976******************************************************************
  2977 01  ORIGINAL-CERTIFICATE.
  2978     12  OC-RECORD-ID                      PIC XX.
  2979         88  VALID-OC-ID                      VALUE 'OC'.
  2980     12  OC-CONTROL-PRIMARY.
  2981         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  57
* EL050.cbl
  2982         16  OC-CARRIER                    PIC X.
  2983         16  OC-GROUPING                   PIC X(6).
  2984         16  OC-STATE                      PIC XX.
  2985         16  OC-ACCOUNT                    PIC X(10).
  2986         16  OC-CERT-EFF-DT                PIC XX.
  2987         16  OC-CERT-NO.
  2988             20  OC-CERT-PRIME             PIC X(10).
  2989             20  OC-CERT-SFX               PIC X.
  2990         16  OC-RECORD-TYPE                PIC X.
  2991         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2992     12  OC-LAST-MAINT-DT                  PIC XX.
  2993     12  OC-LAST-MAINT-BY                  PIC X(4).
  2994     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2995     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2996     12  FILLER                            PIC X(49).
  2997     12  OC-ORIG-REC.
  2998         16  OC-INS-LAST-NAME              PIC X(15).
  2999         16  OC-INS-FIRST-NAME             PIC X(10).
  3000         16  OC-INS-MIDDLE-INIT            PIC X.
  3001         16  OC-INS-AGE                    PIC S999     COMP-3.
  3002         16  OC-JNT-LAST-NAME              PIC X(15).
  3003         16  OC-JNT-FIRST-NAME             PIC X(10).
  3004         16  OC-JNT-MIDDLE-INIT            PIC X.
  3005         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3006         16  OC-LF-BENCD                   PIC XX.
  3007         16  OC-LF-TERM                    PIC S999      COMP-3.
  3008         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3009         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3010         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3011         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3012         16  OC-LF-EXP-DT                  PIC XX.
  3013         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3014         16  OC-LF-CANCEL-DT               PIC XX.
  3015         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3016         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3017         16  OC-AH-BENCD                   PIC XX.
  3018         16  OC-AH-TERM                    PIC S999      COMP-3.
  3019         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3020         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3021         16  OC-AH-EXP-DT                  PIC XX.
  3022         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3023         16  OC-AH-CP                      PIC 99.
  3024         16  OC-AH-CANCEL-DT               PIC XX.
  3025         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3026         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3027         16  OC-CRED-BENE-NAME             PIC X(25).
  3028         16  OC-1ST-PMT-DT                 PIC XX.
  3029         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3030         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3031         16  OC-ISSUE-TRAN-IND             PIC X.
  3032         16  OC-CANCEL-TRAN-IND            PIC X.
  3033         16  FILLER                        PIC X(211).
  3034
  3035     12  FILLER                            PIC X(50).
  3036******************************************************************
  3037
  3038*    COPY ELCDATE.
  3039******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  58
* EL050.cbl
  3040*                                                                *
  3041*                                                                *
  3042*                            ELCDATE.                            *
  3043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3044*                            VMOD=2.003
  3045*                                                                *
  3046*                                                                *
  3047*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3048*                 LENGTH = 200                                   *
  3049******************************************************************
  3050
  3051 01  DATE-CONVERSION-DATA.
  3052     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3053     12  DC-OPTION-CODE                PIC X.
  3054         88  BIN-TO-GREG                VALUE ' '.
  3055         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3056         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3057         88  YMD-GREG-TO-BIN            VALUE '3'.
  3058         88  MDY-GREG-TO-BIN            VALUE '4'.
  3059         88  JULIAN-TO-BIN              VALUE '5'.
  3060         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3061         88  FIND-CENTURY               VALUE '7'.
  3062         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3063         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3064         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3065         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3066         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3067         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3068         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3069         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3070         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3071         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3072         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3073         88  BIN-3-TO-GREG              VALUE 'I'.
  3074         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3075         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3076         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3077         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3078         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3079         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3080         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3081         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3082         88  THREE-CHARACTER-BIN
  3083                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3084         88  GREGORIAN-TO-BIN
  3085                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3086         88  BIN-TO-GREGORIAN
  3087                  VALUES ' ' '1' 'I' '8' 'G'.
  3088         88  JULIAN-TO-BINARY
  3089                  VALUES '5' 'C' 'E' 'F'.
  3090     12  DC-ERROR-CODE                 PIC X.
  3091         88  NO-CONVERSION-ERROR        VALUE ' '.
  3092         88  DATE-CONVERSION-ERROR
  3093                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3094         88  DATE-IS-ZERO               VALUE '1'.
  3095         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3096         88  DATE-IS-INVALID            VALUE '3'.
  3097         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  59
* EL050.cbl
  3098         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3099         88  DATE-INVALID-OPTION        VALUE '9'.
  3100         88  INVALID-CENTURY            VALUE 'A'.
  3101         88  ONLY-CENTURY               VALUE 'B'.
  3102         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3103         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3104     12  DC-END-OF-MONTH               PIC X.
  3105         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3106     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3107         88  USE-NORMAL-PROCESS         VALUE ' '.
  3108         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3109         88  ADJUST-UP-100-YRS          VALUE '2'.
  3110     12  FILLER                        PIC X.
  3111     12  DC-CONVERSION-DATES.
  3112         16  DC-BIN-DATE-1             PIC XX.
  3113         16  DC-BIN-DATE-2             PIC XX.
  3114         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3115         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3116                       DC-GREG-DATE-1-EDIT.
  3117             20  DC-EDIT1-MONTH        PIC 99.
  3118             20  SLASH1-1              PIC X.
  3119             20  DC-EDIT1-DAY          PIC 99.
  3120             20  SLASH1-2              PIC X.
  3121             20  DC-EDIT1-YEAR         PIC 99.
  3122         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3123         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3124                     DC-GREG-DATE-2-EDIT.
  3125             20  DC-EDIT2-MONTH        PIC 99.
  3126             20  SLASH2-1              PIC X.
  3127             20  DC-EDIT2-DAY          PIC 99.
  3128             20  SLASH2-2              PIC X.
  3129             20  DC-EDIT2-YEAR         PIC 99.
  3130         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3131         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3132                     DC-GREG-DATE-1-YMD.
  3133             20  DC-YMD-YEAR           PIC 99.
  3134             20  DC-YMD-MONTH          PIC 99.
  3135             20  DC-YMD-DAY            PIC 99.
  3136         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3137         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3138                      DC-GREG-DATE-1-MDY.
  3139             20  DC-MDY-MONTH          PIC 99.
  3140             20  DC-MDY-DAY            PIC 99.
  3141             20  DC-MDY-YEAR           PIC 99.
  3142         16  DC-GREG-DATE-1-ALPHA.
  3143             20  DC-ALPHA-MONTH        PIC X(10).
  3144             20  DC-ALPHA-DAY          PIC 99.
  3145             20  FILLER                PIC XX.
  3146             20  DC-ALPHA-CENTURY.
  3147                 24 DC-ALPHA-CEN-N     PIC 99.
  3148             20  DC-ALPHA-YEAR         PIC 99.
  3149         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3150         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3151         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3152         16  DC-JULIAN-DATE            PIC 9(05).
  3153         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3154                                       PIC 9(05).
  3155         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  60
* EL050.cbl
  3156             20  DC-JULIAN-YEAR        PIC 99.
  3157             20  DC-JULIAN-DAYS        PIC 999.
  3158         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3159         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3160         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3161     12  DATE-CONVERSION-VARIBLES.
  3162         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3163         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3164             20  FILLER                PIC 9(3).
  3165             20  HOLD-CEN-1-CCYY.
  3166                 24  HOLD-CEN-1-CC     PIC 99.
  3167                 24  HOLD-CEN-1-YY     PIC 99.
  3168             20  HOLD-CEN-1-MO         PIC 99.
  3169             20  HOLD-CEN-1-DA         PIC 99.
  3170         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3171             20  HOLD-CEN-1-R-MO       PIC 99.
  3172             20  HOLD-CEN-1-R-DA       PIC 99.
  3173             20  HOLD-CEN-1-R-CCYY.
  3174                 24  HOLD-CEN-1-R-CC   PIC 99.
  3175                 24  HOLD-CEN-1-R-YY   PIC 99.
  3176             20  FILLER                PIC 9(3).
  3177         16  HOLD-CENTURY-1-X.
  3178             20  FILLER                PIC X(3)  VALUE SPACES.
  3179             20  HOLD-CEN-1-X-CCYY.
  3180                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3181                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3182             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3183             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3184         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3185             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3186             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3187             20  HOLD-CEN-1-R-X-CCYY.
  3188                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3189                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3190             20  FILLER                PIC XXX.
  3191         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3192         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3193         16  DC-JULIAN-DATE-1          PIC 9(07).
  3194         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3195             20  DC-JULIAN-1-CCYY.
  3196                 24  DC-JULIAN-1-CC    PIC 99.
  3197                 24  DC-JULIAN-1-YR    PIC 99.
  3198             20  DC-JULIAN-DA-1        PIC 999.
  3199         16  DC-JULIAN-DATE-2          PIC 9(07).
  3200         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3201             20  DC-JULIAN-2-CCYY.
  3202                 24  DC-JULIAN-2-CC    PIC 99.
  3203                 24  DC-JULIAN-2-YR    PIC 99.
  3204             20  DC-JULIAN-DA-2        PIC 999.
  3205         16  DC-GREG-DATE-A-EDIT.
  3206             20  DC-EDITA-MONTH        PIC 99.
  3207             20  SLASHA-1              PIC X VALUE '/'.
  3208             20  DC-EDITA-DAY          PIC 99.
  3209             20  SLASHA-2              PIC X VALUE '/'.
  3210             20  DC-EDITA-CCYY.
  3211                 24  DC-EDITA-CENT     PIC 99.
  3212                 24  DC-EDITA-YEAR     PIC 99.
  3213         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  61
* EL050.cbl
  3214             20  DC-EDITB-MONTH        PIC 99.
  3215             20  SLASHB-1              PIC X VALUE '/'.
  3216             20  DC-EDITB-DAY          PIC 99.
  3217             20  SLASHB-2              PIC X VALUE '/'.
  3218             20  DC-EDITB-CCYY.
  3219                 24  DC-EDITB-CENT     PIC 99.
  3220                 24  DC-EDITB-YEAR     PIC 99.
  3221         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3222         16  DC-GREG-DATE-CYMD-R REDEFINES
  3223                              DC-GREG-DATE-CYMD.
  3224             20  DC-CYMD-CEN           PIC 99.
  3225             20  DC-CYMD-YEAR          PIC 99.
  3226             20  DC-CYMD-MONTH         PIC 99.
  3227             20  DC-CYMD-DAY           PIC 99.
  3228         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3229         16  DC-GREG-DATE-MDCY-R REDEFINES
  3230                              DC-GREG-DATE-MDCY.
  3231             20  DC-MDCY-MONTH         PIC 99.
  3232             20  DC-MDCY-DAY           PIC 99.
  3233             20  DC-MDCY-CEN           PIC 99.
  3234             20  DC-MDCY-YEAR          PIC 99.
  3235    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3236        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3237    12  DC-EL310-DATE                  PIC X(21).
  3238    12  FILLER                         PIC X(28).
  3239
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  62
* EL050.cbl
  3241*    COPY ELCCALC.
  3242******************************************************************
  3243*                                                                *
  3244*                           ELCCALC.                            *
  3245*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3246*                            VMOD=2.025                          *
  3247*                                                                *
  3248*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3249*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3250*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3251*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3252*                                                                *
  3253*  PASSED TO ELRTRM                                              *
  3254*  -----------------                                             *
  3255*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3256*  ORIGINAL TERM                                                 *
  3257*  BEGINNING DATE                                                *
  3258*  ENDING DATE                                                   *
  3259*  COMPANY I.D.                                                  *
  3260*  ACCOUNT MASTER USER FIELD                                     *
  3261*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3262*  FREE LOOK DAYS                                                *
  3263*                                                                *
  3264*  RETURNED FROM ELRTRM                                          *
  3265*  ---------------------                                         *
  3266*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3267*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3268*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3269*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3270*----------------------------------------------------------------*
  3271*  PASSED TO ELRAMT                                              *
  3272*  ----------------                                              *
  3273*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3274*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3275*  ORIGINAL AMOUNT                                               *
  3276*  ALTERNATE BENEFIT (BALLON)                                    *
  3277*  A.P.R. - NET PAY ONLY                                         *
  3278*  METHOD
  3279*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3280*  COMPANY I.D.                                                  *
  3281*  BENEFIT TYPE                                                  *
  3282*                                                                *
  3283*  RETURNED FROM ELRAMT                                          *
  3284*  --------------------                                          *
  3285*  REMAINING AMOUNT 1 - CURRENT                                  *
  3286*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3287*  REMAINING AMOUNT FACTOR
  3288*----------------------------------------------------------------*
  3289*  PASSED TO ELRESV                                              *
  3290*  -----------------                                             *
  3291*  CERTIFICATE EFFECTIVE DATE                                    *
  3292*  VALUATION DATE                                                *
  3293*  PAID THRU DATE                                                *
  3294*  BENEFIT                                                       *
  3295*  INCURRED DATE                                                 *
  3296*  REPORTED DATE                                                 *
  3297*  ISSUE AGE                                                     *
  3298*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  63
* EL050.cbl
  3299*  CDT PERCENT                                                   *
  3300*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3301* *CLAIM TYPE (LIFE, A/H)                                        *
  3302* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3303* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3304*                                                                *
  3305*  RETURNED FROM ELRESV                                          *
  3306*  --------------------                                          *
  3307*  CDT TABLE USED                                                *
  3308*  CDT FACTOR USED                                               *
  3309*  PAY TO CURRENT RESERVE                                        *
  3310*  I.B.N.R. - A/H ONLY                                           *
  3311*  FUTURE (ACCRUED) AH ONLY                                      *
  3312*----------------------------------------------------------------*
  3313*  PASSED TO ELRATE                                              *
  3314*  ----------------                                              *
  3315*  CERT ISSUE DATE                                               *
  3316*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3317*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3318*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3319*  STATE CODE (CLIENT DEFINED)                                   *
  3320*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3321*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3322*  DEVIATION CODE                                                *
  3323*  ISSUE AGE                                                     *
  3324*  ORIGINAL BENEFIT AMOUNT                                       *
  3325*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3326*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3327*  BENEFIT KIND (LIFE OR A/H)                                    *
  3328*  A.P.R.                                                        *
  3329*  METHOD
  3330*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3331*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3332*  COMPANY I.D. (3 CHARACTER)                                    *
  3333*  BENEFIT CODE                                                  *
  3334*  BENEFIT OVERRIDE CODE                                         *
  3335*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3336*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3337*  JOINT INDICATOR (CSL ONLY)                                    *
  3338*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3339*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3340*                                                                *
  3341*  RETURNED FROM ELRATE                                          *
  3342*  --------------------                                          *
  3343*  CALCULATED PREMIUM                                            *
  3344*  PREMIUM RATE                                                  *
  3345*  MORTALITY CODE                                                *
  3346*  MAX ATTAINED AGE                                              *
  3347*  MAX AGE                                                       *
  3348*  MAX TERM                                                      *
  3349*  MAX MONTHLY BENEFIT                                           *
  3350*  MAX TOTAL BENIFIT                                             *
  3351*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3352*----------------------------------------------------------------*
  3353*  PASSED TO ELRFND                                              *
  3354*  ----------------                                              *
  3355*  CERT ISSUE DATE                                               *
  3356*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  64
* EL050.cbl
  3357*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3358*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3359*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3360*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3361*  STATE CODE (CLIENT DEFINED)                                   *
  3362*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3363*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3364*  DEVIATION CODE                                                *
  3365*  ISSUE AGE                                                     *
  3366*  ORIGINAL BENEFIT AMOUNT                                       *
  3367*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3368*  PROCESS TYPE (CANCEL)                                         *
  3369*  BENEFIT KIND (LIFE OR A/H)                                    *
  3370*  A.P.R.                                                        *
  3371*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3372*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3373*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3374*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3375*  COMPANY I.D. (3 CHARACTER)                                    *
  3376*  BENEFIT CODE                                                  *
  3377*  BENEFIT OVERRIDE CODE                                         *
  3378*                                                                *
  3379*  RETURNED FROM ELRFND                                          *
  3380*  --------------------                                          *
  3381*  CALCULATED REFUND                                             *
  3382*----------------------------------------------------------------*
  3383*  PASSED TO ELEARN                                              *
  3384*  ----------------                                              *
  3385*  CERT ISSUE DATE                                               *
  3386*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3387*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3388*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3389*  STATE CODE (CLIENT DEFINED)                                   *
  3390*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3391*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3392*  DEVIATION CODE                                                *
  3393*  ISSUE AGE                                                     *
  3394*  ORIGINAL BENEFIT AMOUNT                                       *
  3395*  BENEFIT KIND (LIFE OR A/H)                                    *
  3396*  A.P.R.                                                        *
  3397*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3398*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3399*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3400*  COMPANY I.D. (3 CHARACTER)                                    *
  3401*  BENEFIT CODE                                                  *
  3402*  BENEFIT OVERRIDE CODE                                         *
  3403*                                                                *
  3404*  RETURNED FROM ELEARN                                          *
  3405*  --------------------                                          *
  3406*  INDICATED  EARNINGS                                           *
  3407*----------------------------------------------------------------*
  3408*                 LENGTH = 450                                   *
  3409*                                                                *
  3410******************************************************************
  3411******************************************************************
  3412*                   C H A N G E   L O G
  3413*
  3414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  65
* EL050.cbl
  3415*-----------------------------------------------------------------
  3416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3417* EFFECTIVE    NUMBER
  3418*-----------------------------------------------------------------
  3419* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3420* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3421* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3422* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3423* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3424* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3425* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3426* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3427* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3428******************************************************************
  3429
  3430 01  CALCULATION-PASS-AREA.
  3431     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3432                                     COMP.
  3433
  3434     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3435       88  NO-CP-ERROR                             VALUE ZERO.
  3436       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3437                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3438       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3439       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3440       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3441       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3442       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3443       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3444       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3445       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3446       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3447       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3448       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3449       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3450       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3451       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3452       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3453       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3454       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3455
  3456     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3457       88  NO-CP-ERROR-2                           VALUE ZERO.
  3458***********************  INPUT AREAS ****************************
  3459
  3460     12  CP-CALCULATION-AREA.
  3461         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3462         16  CP-CERT-EFF-DT        PIC XX.
  3463         16  CP-VALUATION-DT       PIC XX.
  3464         16  CP-PAID-THRU-DT       PIC XX.
  3465         16  CP-BENEFIT-TYPE       PIC X.
  3466           88  CP-AH                               VALUE 'A' 'D'
  3467                                                   'I' 'U'.
  3468           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3469           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3470         16  CP-INCURRED-DT        PIC XX.
  3471         16  CP-REPORTED-DT        PIC XX.
  3472         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  66
* EL050.cbl
  3473         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3474         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3475                                     COMP-3.
  3476         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-CDT-METHOD         PIC X.
  3479           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3480           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3481           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3482         16  CP-CLAIM-TYPE         PIC X.
  3483           88  CP-AH-CLAIM                         VALUE 'A'.
  3484           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3485         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3486                                     COMP-3.
  3487         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3488                                     COMP-3.
  3489         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3490                                     COMP-3.
  3491         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3492                                     COMP-3.
  3493         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3494                                     COMP-3.
  3495         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3496                                     COMP-3.
  3497         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-REM-TERM-METHOD    PIC X.
  3500           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3501           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3502           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3503           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3504           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3505           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3506           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3507         16  CP-EARNING-METHOD     PIC X.
  3508           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3509           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3510           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3511           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3512           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3513           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3514           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3515           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3516           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3517           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3518           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3519           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3520           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3521           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3522         16  CP-PROCESS-TYPE       PIC X.
  3523           88  CP-CLAIM                            VALUE '1'.
  3524           88  CP-CANCEL                           VALUE '2'.
  3525           88  CP-ISSUE                            VALUE '3'.
  3526         16  CP-SPECIAL-CALC-CD    PIC X.
  3527           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3528           88  CP-1-MTH-INTEREST               VALUE ' '.
  3529           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3530           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  67
* EL050.cbl
  3531           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3532           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3533           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3534           88  CP-FARM-PLAN                    VALUE 'F'.
  3535           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3536           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3537           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3538           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3539           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3540           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3541           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3542           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3543           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3544           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3545                                                     'W' 'X'.
  3546           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3547           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3548           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3549           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3550           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3551           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3552           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3553           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3554           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3555           88  CP-CSL-METH-1                   VALUE '5'.
  3556           88  CP-CSL-METH-2                   VALUE '6'.
  3557           88  CP-CSL-METH-3                   VALUE '7'.
  3558           88  CP-CSL-METH-4                   VALUE '8'.
  3559
  3560         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3561                                     COMP-3.
  3562         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3563         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3564         16  CP-STATE              PIC XX          VALUE SPACE.
  3565         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3566         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3567           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3568               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3569         16  CP-R78-OPTION         PIC X.
  3570           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3571           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3572
  3573         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3574         16  CP-IBNR-RESERVE-SW    PIC X.
  3575         16  CP-CLAIM-STATUS       PIC X.
  3576         16  CP-RATE-FILE          PIC X.
  3577         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3578                                     COMP-3.
  3579
  3580         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3581         16  CP-AH-OVERRIDE-CODE   PIC X.
  3582
  3583         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3586                                   PIC S9(5)V99 COMP-3.
  3587         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3588                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  68
* EL050.cbl
  3589         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3594                                  PIC S9(7)V99 COMP-3.
  3595
  3596         16  CP-PAID-FROM-DATE     PIC X(02).
  3597         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3598         16  CP-EXT-DAYS-CALC      PIC X.
  3599           88  CP-EXT-NO-CHG                   VALUE ' '.
  3600           88  CP-EXT-CHG-LF                   VALUE '1'.
  3601           88  CP-EXT-CHG-AH                   VALUE '2'.
  3602           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3603         16  CP-DOMICILE-STATE     PIC XX.
  3604         16  CP-CARRIER            PIC X.
  3605         16  CP-REIN-FLAG          PIC X.
  3606         16  CP-REM-TRM-CALC-OPTION PIC X.
  3607           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3608                      '2' '3' '4' '5'.
  3609           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3610           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3611           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3612           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3613           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3614           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3615           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3616           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3617         16  CP-SIG-SWITCH         PIC X.
  3618         16  CP-RATING-METHOD      PIC X.
  3619           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3620           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3621           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3622           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3623           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3624           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3625           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3626           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3627           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3628         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3629                                     COMP-3.
  3630         16  CP-BEN-CATEGORY       PIC X.
  3631         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3632         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3633                                   PIC S99V9(5) COMP-3.
  3634         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3635         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3636                                   PIC S99V9(5) COMP-3.
  3637         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3638         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3639         16  CP-EXPIRE-DT          PIC XX.
  3640         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3641         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3642         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3643         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3644         16  CP-DDF-SPEC-CALC      PIC X.
  3645             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3646             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  69
* EL050.cbl
  3647         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3648         16  CP-CANCEL-REASON      PIC X.
  3649         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3650         16  CP-PMT-MODE           PIC X.
  3651         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3652         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3653         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3654         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3655         16  FILLER                PIC X.
  3656
  3657***************    OUTPUT FROM ELRESV   ************************
  3658
  3659         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3660
  3661         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3662                                     COMP-3.
  3663         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  FILLER                PIC X(09).
  3670***************    OUTPUT FROM ELRTRM   *************************
  3671
  3672         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3673                                     COMP-3.
  3674         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3675                                     COMP-3.
  3676         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3677                                     COMP-3.
  3678         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3679                                     COMP-3.
  3680         16  FILLER                PIC X(12).
  3681
  3682***************    OUTPUT FROM ELRAMT   *************************
  3683
  3684         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3685                                     COMP-3.
  3686         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3687                                     COMP-3.
  3688         16  FILLER                PIC X(12).
  3689
  3690***************    OUTPUT FROM ELRATE   *************************
  3691
  3692         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3693                                     COMP-3.
  3694         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3695                                     COMP-3.
  3696         16  CP-MORTALITY-CODE     PIC X(4).
  3697         16  CP-RATE-EDIT-FLAG     PIC X.
  3698             88  CP-RATES-NEED-APR                  VALUE '1'.
  3699         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3702         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3703         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3704                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  70
* EL050.cbl
  3705         16  FILLER                PIC X(07).
  3706
  3707***************    OUTPUT FROM ELRFND   *************************
  3708
  3709         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-REFUND-TYPE-USED   PIC X.
  3712           88  CP-R-AS-R78                         VALUE '1'.
  3713           88  CP-R-AS-PRORATA                     VALUE '2'.
  3714           88  CP-R-AS-CALIF                       VALUE '3'.
  3715           88  CP-R-AS-TEXAS                       VALUE '4'.
  3716           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3717           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3718           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3719           88  CP-R-AS-MEAN                        VALUE '8'.
  3720           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3721           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3722           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3723           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3724           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3725           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3726         16  FILLER                PIC X(12).
  3727
  3728***************    OUTPUT FROM ELEARN   *************************
  3729
  3730         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3739                                     COMP-3.
  3740         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-EARNING-TYPE-USED  PIC X.
  3743           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3744           88  CP-E-AS-R78                         VALUE '1'.
  3745           88  CP-E-AS-PRORATA                     VALUE '2'.
  3746           88  CP-E-AS-TEXAS                       VALUE '4'.
  3747           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3748           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3749           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3750           88  CP-E-AS-MEAN                        VALUE '8'.
  3751           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3752         16  FILLER                PIC X(12).
  3753
  3754***************    OUTPUT FROM ELPMNT   *************************
  3755
  3756         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3759                                     COMP-3.
  3760         16  FILLER                PIC X(12).
  3761
  3762***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  71
* EL050.cbl
  3763         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3764                                     COMP-3.
  3765         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3774                                     COMP-3.
  3775         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3776             88  OPEN-RATE-FILE                   VALUE 'O'.
  3777             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3778             88  IO-ERROR                         VALUE 'E'.
  3779
  3780         16  CP-FIRST-PAY-DATE     PIC XX.
  3781
  3782         16  CP-JOINT-INDICATOR    PIC X.
  3783
  3784         16  CP-RESERVE-REMAINING-TERM
  3785                                   PIC S9(4)V9    VALUE ZERO
  3786                                     COMP-3.
  3787
  3788         16  CP-INSURED-BIRTH-DT   PIC XX.
  3789
  3790         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3791                                     COMP-3.
  3792
  3793         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3794                                     COMP-3.
  3795
  3796         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3797                                     COMP-3.
  3798
  3799         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3803                                     COMP-3.
  3804
  3805         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3806                                     COMP-3.
  3807
  3808         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3809                                     COMP-3.
  3810
  3811         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3812             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3813
  3814         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3815                                     COMP-3.
  3816         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3819         16  FILLER                PIC X(15).
  3820******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  72
* EL050.cbl
  3822******************************************************************
  3823*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3824*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3825*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3826*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3827*** MODIFICATION.                                              ***
  3828*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3829*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3830******************************************************************
  3831*    COPY ERCPNDB.
  3832******************************************************************
  3833*                                                                *
  3834*                                                                *
  3835*                            ERCPNDB.                            *
  3836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3837*                            VMOD=2.025                          *
  3838*                                                                *
  3839*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3840*                                                                *
  3841******************************************************************
  3842*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3843*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3844******************************************************************
  3845*                                                                *
  3846*                                                                *
  3847*   FILE TYPE = VSAM,KSDS                                        *
  3848*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3849*                                                                *
  3850*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3851*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3852*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3853*                                                 RKP=13,LEN=36  *
  3854*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3855*                                      AND CHG-SEQ.)             *
  3856*                                                RKP=49,LEN=11   *
  3857*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3858*                                      AND CHG-SEQ.)             *
  3859*                                                RKP=60,LEN=15   *
  3860*                                                                *
  3861*   LOG = NO                                                     *
  3862*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3863******************************************************************
  3864******************************************************************
  3865*                   C H A N G E   L O G
  3866*
  3867* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3868*-----------------------------------------------------------------
  3869*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3870* EFFECTIVE    NUMBER
  3871*-----------------------------------------------------------------
  3872* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3873* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3874* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3875* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3876* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3877* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3878* 032306                   PEMA  ADD BOW LOAN NUMBER
  3879* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  73
* EL050.cbl
  3880* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3881* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3882* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3883* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3884* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3885* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3886* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3887******************************************************************
  3888
  3889 01  PENDING-BUSINESS.
  3890     12  PB-RECORD-ID                     PIC XX.
  3891         88  VALID-PB-ID                        VALUE 'PB'.
  3892
  3893     12  PB-CONTROL-PRIMARY.
  3894         16  PB-COMPANY-CD                PIC X.
  3895         16  PB-ENTRY-BATCH               PIC X(6).
  3896         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3897         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3898
  3899     12  PB-CONTROL-BY-ACCOUNT.
  3900         16  PB-COMPANY-CD-A1             PIC X.
  3901         16  PB-CARRIER                   PIC X.
  3902         16  PB-GROUPING.
  3903             20  PB-GROUPING-PREFIX       PIC XXX.
  3904             20  PB-GROUPING-PRIME        PIC XXX.
  3905         16  PB-STATE                     PIC XX.
  3906         16  PB-ACCOUNT.
  3907             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3908             20  PB-ACCOUNT-PRIME         PIC X(6).
  3909         16  PB-CERT-EFF-DT               PIC XX.
  3910         16  PB-CERT-NO.
  3911             20  PB-CERT-PRIME            PIC X(10).
  3912             20  PB-CERT-SFX              PIC X.
  3913         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3914
  3915         16  PB-RECORD-TYPE               PIC X.
  3916             88  PB-MAILING-DATA                VALUE '0'.
  3917             88  PB-ISSUE                       VALUE '1'.
  3918             88  PB-CANCELLATION                VALUE '2'.
  3919             88  PB-BATCH-TRAILER               VALUE '9'.
  3920
  3921     12  PB-CONTROL-BY-ORIG-BATCH.
  3922         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3923         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3924         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3925         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3926
  3927     12  PB-CONTROL-BY-CSR.
  3928         16  PB-CSR-COMPANY-CD            PIC X.
  3929         16  PB-CSR-ID                    PIC X(4).
  3930         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3931         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3932         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3933******************************************************************
  3934*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3935******************************************************************
  3936
  3937     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  74
* EL050.cbl
  3938     12  PB-LAST-MAINT-BY                 PIC X(4).
  3939     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3940
  3941     12  PB-RECORD-BODY                   PIC X(375).
  3942
  3943     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3944         16  PB-CERT-ORIGIN               PIC X.
  3945             88  CLASIC-CREATED-CERT         VALUE '1'.
  3946         16  PB-I-NAME.
  3947             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3948             20  PB-I-INSURED-FIRST-NAME.
  3949                 24  PB-I-INSURED-1ST-INIT PIC X.
  3950                 24  FILLER                PIC X(9).
  3951             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3952         16  PB-I-AGE                     PIC S99   COMP-3.
  3953         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3954         16  PB-I-BIRTHDAY                PIC XX.
  3955         16  PB-I-INSURED-SEX             PIC X.
  3956             88  PB-SEX-MALE     VALUE 'M'.
  3957             88  PB-SEX-FEMALE   VALUE 'F'.
  3958
  3959         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3960         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3961         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3962         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3963         16  PB-I-SKIP-CODE               PIC X.
  3964             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3965             88  PB-SKIP-JULY              VALUE '1'.
  3966             88  PB-SKIP-AUGUST            VALUE '2'.
  3967             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3968             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3969             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3970             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3971             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3972             88  PB-SKIP-JUNE              VALUE '8'.
  3973             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3974             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3975             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3976         16  PB-I-TERM-TYPE               PIC X.
  3977             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3978             88  PB-PAID-WEEKLY            VALUE 'W'.
  3979             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3980             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3981             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3982         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3983         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3984         16  PB-I-DATA-ENTRY-SW           PIC X.
  3985             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3986             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3987             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3988             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3989         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3990         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3991*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3992         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3993         16  FILLER                       PIC X.
  3994
  3995         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  75
* EL050.cbl
  3996             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3997             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3998                                                   '90' THRU '99'.
  3999         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4000                                          PIC XX.
  4001         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4002         16  PB-I-AMOUNT-FINANCED REDEFINES
  4003                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4004         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4005         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4006                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4007         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4008         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4009         16  PB-I-CLP-AMOUNT REDEFINES
  4010                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4011         16  PB-I-LF-CALC-FLAG            PIC X.
  4012             88 PB-COMP-LF-PREM               VALUE '?'.
  4013         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4014         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4015         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4016         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4017         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4018         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4019         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4020         16  PB-I-LF-ABBR                 PIC XXX.
  4021         16  PB-I-LF-INPUT-CD             PIC XX.
  4022
  4023         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4024             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4025             88  PB-INVALID-AH               VALUE '  ' '00'
  4026                                                   '90' THRU '99'.
  4027         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4028         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4029         16  PB-I-AH-CALC-FLAG            PIC X.
  4030             88 PB-COMP-AH-PREM                  VALUE '?'.
  4031         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4032         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4033         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4034         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4035         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4036         16  PB-I-AH-ABBR                 PIC XXX.
  4037         16  PB-I-AH-INPUT-CD             PIC XXX.
  4038
  4039         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4040         16  PB-I-REIN-TABLE              PIC XXX.
  4041         16  PB-I-BUSINESS-TYPE           PIC 99.
  4042         16  PB-I-INDV-GRP-CD             PIC X.
  4043         16  PB-I-MORT-CODE.
  4044             20  PB-I-TABLE               PIC X.
  4045             20  PB-I-INTEREST            PIC XX.
  4046             20  PB-I-MORT-TYP            PIC X.
  4047         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4048         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4049         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4050         16  PB-I-INDV-GRP-OVRD           PIC X.
  4051         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4052         16  PB-I-SIG-SW                  PIC X.
  4053             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  76
* EL050.cbl
  4054         16  PB-I-RATE-CLASS              PIC XX.
  4055         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4056         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4057         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4058         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4059         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4060         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4061         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4062         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4063         16  PB-I-OB-FLAG                 PIC X.
  4064             88  PB-I-OB                      VALUE 'B'.
  4065             88  PB-I-SUMMARY                 VALUE 'Z'.
  4066         16  PB-I-ENTRY-STATUS            PIC X.
  4067             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4068                                              'M' '5' '9' '2'.
  4069             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4070             88  PB-I-POLICY-PENDING          VALUE '2'.
  4071             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4072             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4073             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4074             88  PB-I-REIN-ONLY               VALUE '9'.
  4075             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4076             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4077             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4078             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4079         16  PB-I-INT-CODE                PIC X.
  4080             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4081             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4082         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4083         16  PB-I-SOC-SEC-NO              PIC X(11).
  4084         16  PB-I-MEMBER-NO               PIC X(12).
  4085         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4086*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4087         16  PB-I-OLD-LOF                 PIC XXX.
  4088         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4089         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4090         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4091         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4092         16  PB-I-LIFE-INDICATOR          PIC X.
  4093             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4094         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4095         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4096                                          PIC S9(5)V99    COMP-3.
  4097         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4098             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4099             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4100         16  PB-I-1ST-PMT-DT              PIC XX.
  4101         16  PB-I-JOINT-INSURED.
  4102             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4103             20 PB-I-JOINT-FIRST-NAME.
  4104                24  PB-I-JOINT-FIRST-INIT PIC X.
  4105                24  FILLER                PIC X(9).
  4106             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4107*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4108         16  PB-I-BENEFICIARY-NAME.
  4109             20  PB-I-BANK-NUMBER         PIC X(10).
  4110             20  FILLER                   PIC X(15).
  4111         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  77
* EL050.cbl
  4112         16  PB-I-REFERENCE               PIC X(12).
  4113         16  FILLER REDEFINES PB-I-REFERENCE.
  4114             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4115             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4116             20  PB-I-CLP-STATE           PIC XX.
  4117         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4118             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4119             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4120             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4121         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4122         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4123         16  PB-I-RESIDENT-STATE          PIC XX.
  4124         16  PB-I-RATE-CODE               PIC X(4).
  4125         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4126         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4127         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4128         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4129         16  PB-I-BANK-NOCHRGB            PIC 99.
  4130         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4131         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4132
  4133     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4134         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4135             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4136         16  PB-C-CANCEL-ORIGIN           PIC X.
  4137             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4138         16  PB-C-LF-CANCEL-DT            PIC XX.
  4139         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4140         16  PB-C-LF-CALC-REQ             PIC X.
  4141             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4142         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4143         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4144         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4145             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4146         16  PB-C-AH-CANCEL-DT            PIC XX.
  4147         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4148         16  PB-C-AH-CALC-REQ             PIC X.
  4149             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4150         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4151         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4152         16  PB-C-LAST-NAME               PIC X(15).
  4153         16  PB-C-REFUND-SW               PIC X.
  4154             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4155             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4156         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4157         16  PB-C-PAYEE-CODE              PIC X(6).
  4158         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4159         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4160         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4161         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4162         16  PB-C-REFERENCE               PIC X(12).
  4163         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4164         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4165         16  PB-C-POST-CARD-IND           PIC X.
  4166         16  PB-C-CANCEL-REASON           PIC X.
  4167         16  PB-C-REF-INTERFACE-SW        PIC X.
  4168         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4169         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  78
* EL050.cbl
  4170         16  FILLER                       PIC X(01).
  4171*        16  FILLER                       PIC X(18).
  4172         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4173*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4174         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4175         16  PB-CANCELED-CERT-DATA.
  4176             20  PB-CI-INSURED-NAME.
  4177                 24  PB-CI-LAST-NAME      PIC X(15).
  4178                 24  PB-CI-INITIALS       PIC XX.
  4179             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4180             20  PB-CI-INSURED-SEX        PIC X.
  4181             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4182             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4183             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4184             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4185             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4186             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4187             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4188             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4189             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4190             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4191             20  PB-CI-RATE-CLASS         PIC XX.
  4192             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4193             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4194             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4195             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4196             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4197             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4198             20  PB-CI-LF-ABBR            PIC X(3).
  4199             20  PB-CI-AH-ABBR            PIC X(3).
  4200             20  PB-CI-OB-FLAG            PIC X.
  4201                 88  PB-CI-OB                VALUE 'B'.
  4202             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4203                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4204                                           'M' '4' '5' '9' '2'.
  4205                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4206                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4207                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4208                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4209                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4210                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4211                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4212                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4213                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4214                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4215                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4216                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4217             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4218                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4219                                           'M' '4' '5' '9' '2'.
  4220                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4221                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4222                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4223                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4224                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4225                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4226                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4227                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  79
* EL050.cbl
  4228                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4229                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4230                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4231                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4232             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4233             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4234             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4235             20  PB-CI-MEMBER-NO          PIC X(12).
  4236             20  PB-CI-INT-CODE           PIC X.
  4237                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4238                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4239             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4240             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4241             20  PB-CI-COMP-EXCP-SW       PIC X.
  4242                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4243                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4244             20  PB-CI-ENTRY-STATUS       PIC X.
  4245             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4246             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4247             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4248             20  PB-CI-DEATH-DT           PIC XX.
  4249             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4250             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4251             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4252             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4253             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4254             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4255             20  PB-CI-ENTRY-DT              PIC XX.
  4256             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4257             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4258             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4259             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4260             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4261             20  PB-CI-OLD-LOF               PIC XXX.
  4262*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4263             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4264             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4265             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4266             20  PB-CI-INDV-GRP-CD           PIC X.
  4267             20  PB-CI-BENEFICIARY-NAME.
  4268                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4269                 24  FILLER                  PIC X(15).
  4270             20  PB-CI-NOTE-SW               PIC X.
  4271             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4272             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4273             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4274             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4275             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4276             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4277             20  PB-CI-FIRST-NAME            PIC X(10).
  4278             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4279
  4280         16  FILLER                       PIC X(13).
  4281*032306  16  FILLER                       PIC X(27).
  4282*        16  FILLER                       PIC X(46).
  4283
  4284     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4285         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  80
* EL050.cbl
  4286         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4287         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4288         16  PB-M-INSURED-MID-INIT        PIC X.
  4289         16  PB-M-INSURED-AGE             PIC 99.
  4290         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4291         16  PB-M-INSURED-SEX             PIC X.
  4292         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4293         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4294         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4295         16  PB-M-INSURED-CITY-STATE.
  4296             20  PB-M-INSURED-CITY        PIC X(28).
  4297             20  PB-M-INSURED-STATE       PIC XX.
  4298         16  PB-M-INSURED-ZIP-CODE.
  4299             20  PB-M-INSURED-ZIP-PRIME.
  4300                 24  PB-M-INSURED-ZIP-1   PIC X.
  4301                     88  PB-M-CANADIAN-POST-CODE
  4302                                             VALUE 'A' THRU 'Z'.
  4303                 24  FILLER               PIC X(4).
  4304             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4305         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4306                                        PB-M-INSURED-ZIP-CODE.
  4307             20  PM-M-INS-CAN-POST1       PIC XXX.
  4308             20  PM-M-INS-CAN-POST2       PIC XXX.
  4309             20  FILLER                   PIC XXX.
  4310         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4311         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4312         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4313         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4314         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4315         16  PB-M-CRED-BENE-CITYST.
  4316             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4317             20  PB-M-CRED-BENE-STATE     PIC XX.
  4318         16  FILLER                       PIC X(92).
  4319
  4320     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4321         16  FILLER                       PIC X(10).
  4322         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4323         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4324         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4325         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4326         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4327         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4328         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4329         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4330         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4331         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4332         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4333         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4334         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4335         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4336         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4337         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4338         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4339         16  PB-ACCOUNT-NAME              PIC X(30).
  4340         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4341         16  PB-REFERENCE                 PIC X(12).
  4342         16  PB-B-RECEIVED-DT             PIC XX.
  4343         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  81
* EL050.cbl
  4344
  4345     12  PB-RECORD-STATUS.
  4346         16  PB-CREDIT-SELECT-DT          PIC XX.
  4347         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4348         16  PB-BILLED-DT                 PIC XX.
  4349         16  PB-BILLING-STATUS            PIC X.
  4350             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4351             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4352             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4353         16  PB-RECORD-BILL               PIC X.
  4354             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4355             88  PB-RECORD-RETURNED           VALUE 'R'.
  4356             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4357             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4358             88  PB-OVERRIDE-AH               VALUE 'A'.
  4359             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4360         16  PB-BATCH-ENTRY               PIC X.
  4361             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4362             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4363             88  PB-REISSUED-CERT             VALUE 'E'.
  4364             88  PB-MONTHLY-CERT              VALUE 'M'.
  4365             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4366             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4367             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4368         16  PB-FORCE-CODE                PIC X.
  4369             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4370             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4371             88  PB-CANCEL-FORCE              VALUE '8'.
  4372             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4373             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4374             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4375             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4376             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4377             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4378             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4379         16  PB-FATAL-FLAG                PIC X.
  4380             88  PB-FATAL-ERRORS              VALUE 'X'.
  4381         16  PB-FORCE-ER-CD               PIC X.
  4382             88  PB-FORCE-ERRORS              VALUE 'F'.
  4383             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4384         16  PB-WARN-ER-CD                PIC X.
  4385             88  PB-WARNING-ERRORS            VALUE 'W'.
  4386         16  FILLER                       PIC X.
  4387         16  PB-OUT-BAL-CD                PIC X.
  4388             88  PB-OUT-OF-BAL                VALUE 'O'.
  4389         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4390         16  PB-AH-OVERRIDE-L1            PIC X.
  4391         16  PB-INPUT-DT                  PIC XX.
  4392         16  PB-INPUT-BY                  PIC X(4).
  4393         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4394         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4395         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4396         16  PB-LF-EARNING-METHOD         PIC X.
  4397         16  PB-AH-EARNING-METHOD         PIC X.
  4398         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4399         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4400         16  PB-REIN-CD                   PIC XXX.
  4401         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  82
* EL050.cbl
  4402         16  PB-AH-REFUND-TYPE            PIC X.
  4403         16  PB-ACCT-EFF-DT               PIC XX.
  4404         16  PB-ACCT-EXP-DT               PIC XX.
  4405         16  PB-COMPANY-ID                PIC X(3).
  4406         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4407         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4408         16  PB-SV-CARRIER                PIC X.
  4409         16  PB-SV-GROUPING               PIC X(6).
  4410         16  PB-SV-STATE                  PIC XX.
  4411         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4412         16  PB-GA-BILLING-INFO.
  4413             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4414                                          PIC XX.
  4415         16  PB-SV-REMIT-TO  REDEFINES
  4416             PB-GA-BILLING-INFO           PIC X(10).
  4417         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4418         16  PB-I-LOAN-OFFICER            PIC X(5).
  4419         16  PB-I-VIN                     PIC X(17).
  4420
  4421         16  FILLER                       PIC X(04).
  4422         16  IMNET-BYPASS-SW              PIC X.
  4423
  4424******************************************************************
  4425*                COMMON EDIT ERRORS                              *
  4426******************************************************************
  4427
  4428     12  PB-COMMON-ERRORS.
  4429         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4430                                           PIC S9(4)     COMP.
  4431
  4432******************************************************************
  4433
  4434* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4435*    COPY ELC50W1.
  4436******************************************************************
  4437*                                                                *
  4438*                                                                *
  4439*                             ELC50W1                            *
  4440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4441*                            VMOD=2.004                          *
  4442*                                                                *
  4443*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4444*                                                                *
  4445*                                                                *
  4446******************************************************************
  4447
  4448     12  WK-WORK-AREA.
  4449         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4450         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4451         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4452         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4453         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4454         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4455         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4456         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4457         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4458         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4459         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  83
* EL050.cbl
  4460         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4461         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4462         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4463         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4464         16  WK-CREDIT-EDIT-CONTROLS.
  4465             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4466             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4467             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4468             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4469             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4470             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4471         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4472         16  WK-SAVE-REIN-DATA.
  4473             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4474             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4475             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4476         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4477             88  ENTRY-FROM-EL6311       VALUE '6'.
  4478         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4479         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4480     12  WK-RECORD-ADDRESSES.
  4481         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4482         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4483         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4484         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4485         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4486         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4487         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4488         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4489     12  WK-OVER-SHORT-AREA.
  4490         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4491         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4492         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4493             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4494         16  FILLER                   PIC X(5) VALUE SPACES.
  4495
  4496*    COPY ELCEDITC.
  4497******************************************************************
  4498*                                                                *
  4499*                                                                *
  4500*                            ELCEDITC                            *
  4501*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4502*                            VMOD=2.012                          *
  4503*                                                                *
  4504*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4505*                     EL6313, EL050 AND EL517.                   *
  4506*                                                                *
  4507******************************************************************
  4508******************************************************************
  4509*                   C H A N G E   L O G
  4510*
  4511* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4512*-----------------------------------------------------------------
  4513*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4514* EFFECTIVE    NUMBER
  4515*-----------------------------------------------------------------
  4516* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4517******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  84
* EL050.cbl
  4518
  4519     12  EDIT-CRITERIA-DATA.
  4520         16  EC-CO-MONTH-END-DT       PIC XX.
  4521         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4522         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4523         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4524         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4525         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4526         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4527         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4528         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4529         16  EC-CO-REM-TERM-CALC      PIC X.
  4530               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4531               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4532               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4533               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4534
  4535         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4536               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4537               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4538               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4539               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4540               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4541               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4542               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4543               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4544               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4545               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4546
  4547         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4548               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4549               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4550               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4551               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4552               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4553               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4554               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4555               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4556
  4557         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4558                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4559                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4560
  4561         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4562                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4563                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4564                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4565                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4566                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4567                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4568                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4569                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4570
  4571         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4572               88  EC-BR-REDUCING                   VALUE 'R'.
  4573               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4574
  4575         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  85
* EL050.cbl
  4576         16  EC-BR-LF-DESC             PIC X(10).
  4577         16  EC-BR-AH-DESC             PIC X(10).
  4578         16  EC-BR-LF-COMMENT          PIC X(10).
  4579         16  EC-BR-AH-COMMENT          PIC X(10).
  4580
  4581         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4582               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4583               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4584               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4585               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4586
  4587         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4588               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4589               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4590               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4591               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4592
  4593         16  EC-BR-LF-REFUND-CALC      PIC X.
  4594                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4595                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4596                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4597                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4598                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4599                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4600                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4601
  4602         16  EC-BR-AH-REFUND-CALC      PIC X.
  4603                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4604                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4605                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4606                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4607                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4608                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4609                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4610                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4611
  4612         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4613                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4614                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4615                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4616
  4617         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4618                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4619                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4620                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4621
  4622         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4623         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4624         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4625         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4626
  4627         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4628         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4629                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4630                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4631                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4632                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4633
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  86
* EL050.cbl
  4634         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4635               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4636               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4637               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4638               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4639               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4640
  4641         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4642               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4643               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4644               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4645               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4646               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4647
  4648         16  EC-ST-LF-REFUND-CALC      PIC X.
  4649                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4650                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4651                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4652                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4653                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4654                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4655                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4656                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4657
  4658         16  EC-ST-AH-REFUND-CALC      PIC X.
  4659                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4660                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4661                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4662                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4663                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4664                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4665                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4666                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4667
  4668         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4669         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4670         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4671         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4672         16  EC-AM-EXPIRATION-DT       PIC XX.
  4673         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4674         16  EC-AM-CLASS-CD            PIC XX.
  4675         16  EC-AM-LF-DEVIATION        PIC XXX.
  4676         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4677         16  EC-AM-AH-DEVIATION        PIC XXX.
  4678         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4679         16  EC-AM-PHONE-NO            PIC X(10).
  4680
  4681         16  EC-AM-LF-REFUND-CALC      PIC X.
  4682                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4683                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4684                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4685                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4686                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4687                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4688                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4689
  4690         16  EC-AM-AH-REFUND-CALC      PIC X.
  4691                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  87
* EL050.cbl
  4692                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4693                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4694                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4695                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4696                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4697                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4698
  4699         16  EC-AM-BEN-I-G-CD          PIC X.
  4700                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4701                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4702                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4703
  4704         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4705         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4706         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4707         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4708         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4709         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4710         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4711         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4712         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4713
  4714         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4715         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4716         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4717         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4718         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4719         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4720         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4721         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4722         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4723         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4724         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4725         16  EC-RT-LF-NSP-ST           PIC XX.
  4726         16  EC-RT-AH-NSP-ST           PIC XX.
  4727         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4728         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4729
  4730         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4731             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4732                                             'M' '5' '9' '2'.
  4733             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4734             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4735             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4736             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4737             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4738             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4739             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4740             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4741             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4742             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4743
  4744         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4745             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4746                                             'M' '5' '9' '2'.
  4747             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4748             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4749             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  88
* EL050.cbl
  4750             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4751             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4752             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4753             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4754             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4755             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4756             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4757
  4758         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4759         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4760         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4761         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4762         16  EC-CM-DEATH-DT            PIC XX.
  4763
  4764*DMD CUSTOM CODING FIELDS BELOW
  4765*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4766         16  EC-BR-DMD-RATING-SW       PIC X.
  4767                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4768                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4769                 88  NO-DMD-RATING               VALUE 'N'.
  4770
  4771         16  EC-NEW-CERT               PIC X(11).
  4772         16  EC-NEW-STATE              PIC XX.
  4773         16  FILLER                    PIC X.
  4774*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4775         16  OVER-SHORT-EDIT-FIELDS.
  4776             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4777             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4778             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4779             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4780             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4781             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4782             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4783             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4784             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4785         16  FILLER                    PIC X(71).
  4786******************************************************************
  4787
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  89
* EL050.cbl
  4789*    COPY ELCDIFRD.
  4790******************************************************************
  4791*                                                                *
  4792*                                                                *
  4793*                            ELCDIFRD.                           *
  4794*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4795*                            VMOD=2.004                          *
  4796*                                                                *
  4797*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4798*                                                                *
  4799******************************************************************
  4800*
  4801  01  WS-DIFFERENCE-CALCULATION.
  4802        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4803        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4804        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4805        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4806        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4807        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4808        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4809        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4810        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4811        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4812        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4813
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  90
* EL050.cbl
  4815****************************************************************
  4816*
  4817* Copyright (c) 2007 by Clerity Solutions, Inc.
  4818* All rights reserved.
  4819*
  4820****************************************************************
  4821 01  DFHEIV.
  4822   02  DFHEIV0               PIC X(35).
  4823   02  DFHEIV1               PIC X(08).
  4824   02  DFHEIV2               PIC X(08).
  4825   02  DFHEIV3               PIC X(08).
  4826   02  DFHEIV4               PIC X(06).
  4827   02  DFHEIV5               PIC X(04).
  4828   02  DFHEIV6               PIC X(04).
  4829   02  DFHEIV7               PIC X(02).
  4830   02  DFHEIV8               PIC X(02).
  4831   02  DFHEIV9               PIC X(01).
  4832   02  DFHEIV10              PIC S9(7) COMP-3.
  4833   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4834   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4835   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4836   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4837   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4838   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4839   02  DFHEIV17              PIC X(04).
  4840   02  DFHEIV18              PIC X(04).
  4841   02  DFHEIV19              PIC X(04).
  4842   02  DFHEIV20              USAGE IS POINTER.
  4843   02  DFHEIV21              USAGE IS POINTER.
  4844   02  DFHEIV22              USAGE IS POINTER.
  4845   02  DFHEIV23              USAGE IS POINTER.
  4846   02  DFHEIV24              USAGE IS POINTER.
  4847   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4848   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4849   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4850   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4851   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4852   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4853   02  FILLER                PIC X(02).
  4854   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4855   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4856   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4857   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4858   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4859 LINKAGE  SECTION.
  4860*****************************************************************
  4861*                                                               *
  4862* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4863* All rights reserved.                                          *
  4864*                                                               *
  4865*****************************************************************
  4866 01  dfheiblk.
  4867     02  eibtime          pic s9(7) comp-3.
  4868     02  eibdate          pic s9(7) comp-3.
  4869     02  eibtrnid         pic x(4).
  4870     02  eibtaskn         pic s9(7) comp-3.
  4871     02  eibtrmid         pic x(4).
  4872     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  91
* EL050.cbl
  4873     02  eibcposn         pic s9(4) comp.
  4874     02  eibcalen         pic s9(4) comp.
  4875     02  eibaid           pic x(1).
  4876     02  eibfiller1       pic x(1).
  4877     02  eibfn            pic x(2).
  4878     02  eibfiller2       pic x(2).
  4879     02  eibrcode         pic x(6).
  4880     02  eibfiller3       pic x(2).
  4881     02  eibds            pic x(8).
  4882     02  eibreqid         pic x(8).
  4883     02  eibrsrce         pic x(8).
  4884     02  eibsync          pic x(1).
  4885     02  eibfree          pic x(1).
  4886     02  eibrecv          pic x(1).
  4887     02  eibsend          pic x(1).
  4888     02  eibatt           pic x(1).
  4889     02  eibeoc           pic x(1).
  4890     02  eibfmh           pic x(1).
  4891     02  eibcompl         pic x(1).
  4892     02  eibsig           pic x(1).
  4893     02  eibconf          pic x(1).
  4894     02  eiberr           pic x(1).
  4895     02  eibrldbk         pic x(1).
  4896     02  eiberrcd         pic x(4).
  4897     02  eibsynrb         pic x(1).
  4898     02  eibnodat         pic x(1).
  4899     02  eibfiller5       pic x(2).
  4900     02  eibresp          pic 9(09) comp.
  4901     02  eibresp2         pic 9(09) comp.
  4902     02  dfheigdj         pic s9(4) comp.
  4903     02  dfheigdk         pic s9(4) comp.
  4904
  4905 01  DFHCOMMAREA                   PIC X(1036).
  4906
  4907*01 PARMLIST .
  4908*    02  FILLER                    PIC S9(8)   COMP.
  4909*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4910*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4911*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4912*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4913*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4914*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4915*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4916
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  92
* EL050.cbl
  4918*    COPY ELCCNTL.
  4919******************************************************************
  4920*                                                                *
  4921*                                                                *
  4922*                            ELCCNTL.                            *
  4923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4924*                            VMOD=2.059                          *
  4925*                                                                *
  4926*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4927*                                                                *
  4928*   FILE TYPE = VSAM,KSDS                                        *
  4929*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4930*                                                                *
  4931*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4932*       ALTERNATE INDEX = NONE                                   *
  4933*                                                                *
  4934*   LOG = YES                                                    *
  4935*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4936******************************************************************
  4937*                   C H A N G E   L O G
  4938*
  4939* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4940*-----------------------------------------------------------------
  4941*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4942* EFFECTIVE    NUMBER
  4943*-----------------------------------------------------------------
  4944* 082503                   PEMA  ADD BENEFIT GROUP
  4945* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4946* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4947* 092705    2005050300006  PEMA  ADD SPP LEASES
  4948* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4949* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4950* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4951* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4952* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4953* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4954* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4955* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4956******************************************************************
  4957*
  4958 01  CONTROL-FILE.
  4959     12  CF-RECORD-ID                       PIC XX.
  4960         88  VALID-CF-ID                        VALUE 'CF'.
  4961
  4962     12  CF-CONTROL-PRIMARY.
  4963         16  CF-COMPANY-ID                  PIC XXX.
  4964         16  CF-RECORD-TYPE                 PIC X.
  4965             88  CF-COMPANY-MASTER              VALUE '1'.
  4966             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4967             88  CF-STATE-MASTER                VALUE '3'.
  4968             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4969             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4970             88  CF-CARRIER-MASTER              VALUE '6'.
  4971             88  CF-MORTALITY-MASTER            VALUE '7'.
  4972             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4973             88  CF-TERMINAL-MASTER             VALUE '9'.
  4974             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4975             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  93
* EL050.cbl
  4976             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4977             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4978             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4979             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4980             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4981             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4982             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4983         16  CF-ACCESS-CD-GENL              PIC X(4).
  4984         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4985             20  CF-PROCESSOR               PIC X(4).
  4986         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4987             20  CF-STATE-CODE              PIC XX.
  4988             20  FILLER                     PIC XX.
  4989         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4990             20  FILLER                     PIC XX.
  4991             20  CF-HI-BEN-IN-REC           PIC XX.
  4992         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4993             20  FILLER                     PIC XXX.
  4994             20  CF-CARRIER-CNTL            PIC X.
  4995         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4996             20  FILLER                     PIC XX.
  4997             20  CF-HI-TYPE-IN-REC          PIC 99.
  4998         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4999             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5000                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5001             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5002             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5003         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5004             20  FILLER                     PIC X.
  5005             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5006         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5007             20  FILLER                     PIC XX.
  5008             20  CF-MORTGAGE-PLAN           PIC XX.
  5009         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5010
  5011     12  CF-LAST-MAINT-DT                   PIC XX.
  5012     12  CF-LAST-MAINT-BY                   PIC X(4).
  5013     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5014
  5015     12  CF-RECORD-BODY                     PIC X(728).
  5016
  5017
  5018****************************************************************
  5019*             COMPANY MASTER RECORD                            *
  5020****************************************************************
  5021
  5022     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5023         16  CF-COMPANY-ADDRESS.
  5024             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5025             20  CF-CL-IN-CARE-OF           PIC X(30).
  5026             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5027             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5028             20  CF-CL-CITY-STATE           PIC X(30).
  5029             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5030             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5031         16  CF-COMPANY-CD                  PIC X.
  5032         16  CF-COMPANY-PASSWORD            PIC X(8).
  5033         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  94
* EL050.cbl
  5034             88  ALL-SECURITY                   VALUE '1'.
  5035             88  COMPANY-VERIFY                 VALUE '2'.
  5036             88  PROCESSOR-VERIFY               VALUE '3'.
  5037             88  NO-SECURITY                    VALUE '4'.
  5038             88  ALL-BUT-TERM                   VALUE '5'.
  5039         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5040             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5041         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5042             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5043         16  CF-INFORCE-LOCATION            PIC X.
  5044             88  CERTS-ARE-ONLINE               VALUE '1'.
  5045             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5046             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5047         16  CF-LOWER-CASE-LETTERS          PIC X.
  5048         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5049             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5050             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5051             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5052             88  CF-ACCNT-CNTL                  VALUE '3'.
  5053             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5054
  5055         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5056         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5057
  5058         16  CF-LGX-CREDIT-USER             PIC X.
  5059             88  CO-IS-NOT-USER                 VALUE 'N'.
  5060             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5061
  5062         16 CF-CREDIT-CALC-CODES.
  5063             20  CF-CR-REM-TERM-CALC PIC X.
  5064               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5065               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5066               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5067               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5068               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5069               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5070               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5071             20  CF-CR-R78-METHOD           PIC X.
  5072               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5073               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5074
  5075         16  CF-CLAIM-CONTROL-COUNTS.
  5076             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5077                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5078
  5079             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5080                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5081
  5082             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5083                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5084
  5085             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5086                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5087
  5088         16  CF-CURRENT-MONTH-END           PIC XX.
  5089
  5090         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5091             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  95
* EL050.cbl
  5092             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5093             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5094             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5095                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5096                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5097             20  CF-CO-PREM-REJECT-SW       PIC X.
  5098                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5099                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5100             20  CF-CO-REF-REJECT-SW        PIC X.
  5101                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5102                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5103
  5104         16  CF-CO-REPORTING-DT             PIC XX.
  5105         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5106         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5107           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5108           88  CF-CO-MONTH-END                  VALUE '1'.
  5109
  5110         16  CF-LGX-CLAIM-USER              PIC X.
  5111             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5112             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5113
  5114         16  CF-CREDIT-EDIT-CONTROLS.
  5115             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5116             20  CF-MIN-AGE                 PIC 99.
  5117             20  CF-DEFAULT-AGE             PIC 99.
  5118             20  CF-MIN-TERM                PIC S999      COMP-3.
  5119             20  CF-MAX-TERM                PIC S999      COMP-3.
  5120             20  CF-DEFAULT-SEX             PIC X.
  5121             20  CF-JOINT-AGE-INPUT         PIC X.
  5122                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5123             20  CF-BIRTH-DATE-INPUT        PIC X.
  5124                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5125             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5126                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5127                 88  CF-ZERO-CARRIER            VALUE '1'.
  5128                 88  CF-ZERO-GROUPING           VALUE '2'.
  5129                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5130             20  CF-EDIT-SW                 PIC X.
  5131                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5132             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5133             20  CF-CR-PR-METHOD            PIC X.
  5134               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5135               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5136             20  FILLER                     PIC X.
  5137
  5138         16  CF-CREDIT-MISC-CONTROLS.
  5139             20  CF-REIN-TABLE-SW           PIC X.
  5140                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5141             20  CF-COMP-TABLE-SW           PIC X.
  5142                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5143             20  CF-EXPERIENCE-RETENTION-AGE
  5144                                            PIC S9        COMP-3.
  5145             20  CF-CONVERSION-DT           PIC XX.
  5146             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5147             20  CF-RUN-FREQUENCY-SW        PIC X.
  5148                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5149                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  96
* EL050.cbl
  5150
  5151             20  CF-CR-CHECK-NO-CONTROL.
  5152                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5153                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5154                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5155                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5156                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5157                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5158
  5159                 24  CF-CR-CHECK-COUNT       REDEFINES
  5160                     CF-CR-CHECK-COUNTER      PIC X(4).
  5161
  5162                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5163                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5164
  5165                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5166                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5167                 24  CF-MAIL-PROCESSING       PIC X.
  5168                     88  MAIL-PROCESSING          VALUE 'Y'.
  5169
  5170         16  CF-MISC-SYSTEM-CONTROL.
  5171             20  CF-SYSTEM-C                 PIC X.
  5172                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5173             20  CF-SYSTEM-D                 PIC X.
  5174                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5175             20  CF-SOC-SEC-NO-SW            PIC X.
  5176                 88  SOC-SEC-NO-USED             VALUE '1'.
  5177             20  CF-MEMBER-NO-SW             PIC X.
  5178                 88  MEMBER-NO-USED              VALUE '1'.
  5179             20  CF-TAX-ID-NUMBER            PIC X(11).
  5180             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5181             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5182                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5183                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5184                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5185                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5186             20  CF-SYSTEM-E                 PIC X.
  5187                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5188
  5189         16  CF-LGX-LIFE-USER               PIC X.
  5190             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5191             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5192
  5193         16  CF-CR-MONTH-END-DT             PIC XX.
  5194
  5195         16  CF-FILE-MAINT-DATES.
  5196             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5197                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5198             20  CF-LAST-BATCH       REDEFINES
  5199                 CF-LAST-BATCH-NO               PIC X(4).
  5200             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5201             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5202             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5203             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5204             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5205             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5206             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5207             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  97
* EL050.cbl
  5208             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5209             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5210
  5211         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5212         16  FILLER                         PIC X.
  5213
  5214         16  CF-ALT-MORT-CODE               PIC X(4).
  5215         16  CF-MEMBER-CAPTION              PIC X(10).
  5216
  5217         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5218             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5219             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5220             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5221             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5222             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5223
  5224         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5225
  5226         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5227         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5228         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5229         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5230
  5231         16  CF-AH-OVERRIDE-L1              PIC X.
  5232         16  CF-AH-OVERRIDE-L2              PIC XX.
  5233         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5234         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5235
  5236         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5237         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5238
  5239         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5240         16  CF-AR-LAST-EL860-DT            PIC XX.
  5241         16  CF-MP-MONTH-END-DT             PIC XX.
  5242
  5243         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5244         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5245             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5246
  5247         16  CF-AR-MONTH-END-DT             PIC XX.
  5248
  5249         16  CF-CRDTCRD-USER                PIC X.
  5250             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5251             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5252
  5253         16  CF-CC-MONTH-END-DT             PIC XX.
  5254
  5255         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5256
  5257         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5258             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5259             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5260             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5261         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5262         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5263         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5264         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5265             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  98
* EL050.cbl
  5266             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5267         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5268         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5269         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5270             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5271         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5272
  5273         16  CF-CL-ZIP-CODE.
  5274             20  CF-CL-ZIP-PRIME.
  5275                 24  CF-CL-ZIP-1ST          PIC X.
  5276                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5277                 24  FILLER                 PIC X(4).
  5278             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5279         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5280             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5281             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5282             20  FILLER                     PIC XXX.
  5283
  5284         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5285         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5286         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5287         16  CF-CO-OPTION-START-DATE        PIC XX.
  5288         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5289           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5290                                                      '3' '4'.
  5291           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5292           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5293           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5294           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5295           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5296           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5297
  5298         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5299
  5300         16  CF-PAYMENT-APPROVAL-LEVELS.
  5301             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5302             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5303             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5304             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5305             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5306             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5307
  5308         16  CF-END-USER-REPORTING-USER     PIC X.
  5309             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5310             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5311
  5312         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5313             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5314             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5315
  5316         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5317
  5318         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5319         16  FILLER                         PIC X.
  5320
  5321         16  CF-CREDIT-ARCHIVE-CNTL.
  5322             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5323             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page  99
* EL050.cbl
  5324             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5325
  5326         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5327
  5328         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5329             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5330             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5331
  5332         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5333             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5334             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5335
  5336         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5337
  5338         16  CF-CO-ACH-ID-CODE              PIC  X.
  5339             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5340             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5341             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5342         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5343         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5344         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5345         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5346         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5347         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5348         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5349         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5350         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5351                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5352         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5353                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5354
  5355         16  CF-CO-OVER-SHORT.
  5356             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5357             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5358
  5359*         16  FILLER                         PIC X(102).
  5360         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5361             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5362             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5363
  5364         16  CF-AH-APPROVAL-DAYS.
  5365             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5366             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5367             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5368             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5369
  5370         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5371
  5372         16  FILLER                         PIC X(79).
  5373****************************************************************
  5374*             PROCESSOR/USER RECORD                            *
  5375****************************************************************
  5376
  5377     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5378         16  CF-PROCESSOR-NAME              PIC X(30).
  5379         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5380         16  CF-PROCESSOR-TITLE             PIC X(26).
  5381         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 100
* EL050.cbl
  5382                 88  MESSAGE-YES                VALUE 'Y'.
  5383                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5384
  5385*****************************************************
  5386****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5387****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5388****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5389****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5390*****************************************************
  5391
  5392         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5393             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5394             20  CF-APPLICATION-FORCE       PIC X.
  5395             20  CF-INDIVIDUAL-APP.
  5396                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5397                     28  CF-BROWSE-APP      PIC X.
  5398                     28  CF-UPDATE-APP      PIC X.
  5399
  5400         16  CF-CURRENT-TERM-ON             PIC X(4).
  5401         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5402             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5403             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5404             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5405             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5406             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5407             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5408             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5409         16  CF-PROCESSOR-CARRIER           PIC X.
  5410             88  NO-CARRIER-SECURITY            VALUE ' '.
  5411         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5412             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5413         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5414             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5415         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5416             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5417
  5418         16  CF-PROC-SYS-ACCESS-SW.
  5419             20  CF-PROC-CREDIT-CLAIMS-SW.
  5420                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5421                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5422                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5423                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5424             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5425                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5426                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5427             20  CF-PROC-LIFE-GNRLDGR-SW.
  5428                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5429                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5430                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5431                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5432             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5433                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5434                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5435         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5436             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5437             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5438         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5439
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 101
* EL050.cbl
  5440         16  CF-APPROVAL-LEVEL                  PIC X.
  5441             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5442             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5443             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5444             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5445
  5446         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5447
  5448         16  CF-LANGUAGE-TYPE                   PIC X.
  5449             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5450             88  CF-LANG-IS-FR                      VALUE 'F'.
  5451
  5452         16  CF-CSR-IND                         PIC X.
  5453         16  FILLER                             PIC X(239).
  5454
  5455****************************************************************
  5456*             PROCESSOR/REMINDERS RECORD                       *
  5457****************************************************************
  5458
  5459     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5460         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5461             20  CF-START-REMIND-DT         PIC XX.
  5462             20  CF-END-REMIND-DT           PIC XX.
  5463             20  CF-REMINDER-TEXT           PIC X(50).
  5464         16  FILLER                         PIC X(296).
  5465
  5466
  5467****************************************************************
  5468*             STATE MASTER RECORD                              *
  5469****************************************************************
  5470
  5471     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5472         16  CF-STATE-ABBREVIATION          PIC XX.
  5473         16  CF-STATE-NAME                  PIC X(25).
  5474         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5475         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5476             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5477             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5478             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5479             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5480                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5481                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5482             20  CF-ST-PREM-REJECT-SW       PIC X.
  5483                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5484                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5485             20  CF-ST-REF-REJECT-SW        PIC X.
  5486                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5487                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5488         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5489         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5490         16  CF-ST-REFUND-RULES.
  5491             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5492             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5493             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5494         16  CF-ST-FST-PMT-EXTENSION.
  5495             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5496             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5497                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 102
* EL050.cbl
  5498                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5499                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5500                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5501         16  CF-ST-STATE-CALL.
  5502             20  CF-ST-CALL-UNEARNED        PIC X.
  5503             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5504             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5505         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5506             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5507             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5508         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5509         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5510         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5511         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5512         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5513         16  FILLER                         PIC X.
  5514         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5515             20  CF-ST-BENEFIT-CD           PIC XX.
  5516             20  CF-ST-BENEFIT-KIND         PIC X.
  5517                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5518                 88  CF-ST-AH-KIND              VALUE 'A'.
  5519             20  CF-ST-REM-TERM-CALC        PIC X.
  5520                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5521                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5522                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5523                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5524                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5525                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5526                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5527                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5528
  5529             20  CF-ST-REFUND-CALC          PIC X.
  5530                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5531                 88  ST-REFD-BY-R78             VALUE '1'.
  5532                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5533                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5534                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5535                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5536                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5537                 88  ST-REFD-UTAH               VALUE '7'.
  5538                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5539                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5540                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5541
  5542             20  CF-ST-EARNING-CALC         PIC X.
  5543                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5544                 88  ST-EARN-BY-R78             VALUE '1'.
  5545                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5546                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5547                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5548                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5549                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5550                 88  ST-EARN-MEAN               VALUE '8'.
  5551                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5552
  5553             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5554                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5555                 88  ST-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 103
* EL050.cbl
  5556                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5557                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5558                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5559                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5560                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5561                 88  ST-OVRD-MEAN               VALUE '8'.
  5562                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5563             20  FILLER                     PIC X.
  5564
  5565         16  CF-ST-COMMISSION-CAPS.
  5566             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5567             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5568             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5569             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5570         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5571                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5572
  5573         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5574
  5575         16  CF-ST-STATUTORY-INTEREST.
  5576             20  CF-ST-STAT-DATE-FROM       PIC X.
  5577                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5578                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5579             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5580             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5581             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5582             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5583             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5584
  5585         16  CF-ST-OVER-SHORT.
  5586             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5587             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5588
  5589         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5590
  5591         16  CF-ST-RT-CALC                  PIC X.
  5592
  5593         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5594         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5595         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5596         16  CF-ST-RF-LR-CALC               PIC X.
  5597         16  CF-ST-RF-LL-CALC               PIC X.
  5598         16  CF-ST-RF-LN-CALC               PIC X.
  5599         16  CF-ST-RF-AH-CALC               PIC X.
  5600         16  CF-ST-RF-CP-CALC               PIC X.
  5601*        16  FILLER                         PIC X(206).
  5602*CIDMOD         16  FILLER                         PIC X(192).
  5603         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5604             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5605         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5606         16  CF-ST-VFY-2ND-BENE             PIC X.
  5607         16  CF-ST-CAUSAL-STATE             PIC X.
  5608         16  FILLER                         PIC X(185).
  5609
  5610****************************************************************
  5611*             BENEFIT MASTER RECORD                            *
  5612****************************************************************
  5613
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 104
* EL050.cbl
  5614     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5615         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5616             20  CF-BENEFIT-CODE            PIC XX.
  5617             20  CF-BENEFIT-NUMERIC  REDEFINES
  5618                 CF-BENEFIT-CODE            PIC XX.
  5619             20  CF-BENEFIT-ALPHA           PIC XXX.
  5620             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5621             20  CF-BENEFIT-COMMENT         PIC X(10).
  5622
  5623             20  CF-LF-COVERAGE-TYPE        PIC X.
  5624                 88  CF-REDUCING                VALUE 'R'.
  5625                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5626
  5627             20  CF-SPECIAL-CALC-CD         PIC X.
  5628                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5629                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5630                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5631                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5632                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5633                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5634                 88  CF-FARM-PLAN               VALUE 'F'.
  5635                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5636                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5637                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5638                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5639                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5640                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5641                 88  CF-PRUDENTIAL              VALUE 'P'.
  5642                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5643                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5644                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5645                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5646                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5647                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5648
  5649             20  CF-JOINT-INDICATOR         PIC X.
  5650                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5651
  5652*            20  FILLER                     PIC X(12).
  5653             20  FILLER                     PIC X(11).
  5654             20  CF-BENEFIT-CATEGORY        PIC X.
  5655             20  CF-LOAN-TYPE               PIC X(8).
  5656
  5657             20  CF-CO-REM-TERM-CALC        PIC X.
  5658                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5659                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5660                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5661                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5662                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5663
  5664             20  CF-CO-EARNINGS-CALC        PIC X.
  5665                 88  CO-EARN-BY-R78             VALUE '1'.
  5666                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5667                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5668                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5669                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5670                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5671                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 105
* EL050.cbl
  5672                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5673
  5674             20  CF-CO-REFUND-CALC          PIC X.
  5675                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5676                 88  CO-REFD-BY-R78             VALUE '1'.
  5677                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5678                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5679                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5680                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5681                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5682                 88  CO-REFD-MEAN               VALUE '8'.
  5683                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5684                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5685                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5686
  5687             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5688                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5689                 88  CO-OVRD-BY-R78             VALUE '1'.
  5690                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5691                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5692                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5693                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5694                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5695                 88  CO-OVRD-MEAN               VALUE '8'.
  5696                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5697
  5698             20  CF-CO-BEN-I-G-CD           PIC X.
  5699                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5700                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5701                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5702
  5703         16  FILLER                         PIC X(304).
  5704
  5705
  5706****************************************************************
  5707*             CARRIER MASTER RECORD                            *
  5708****************************************************************
  5709
  5710     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5711         16  CF-ADDRESS-DATA.
  5712             20  CF-MAIL-TO-NAME            PIC X(30).
  5713             20  CF-IN-CARE-OF              PIC X(30).
  5714             20  CF-ADDRESS-LINE-1          PIC X(30).
  5715             20  CF-ADDRESS-LINE-2          PIC X(30).
  5716             20  CF-CITY-STATE              PIC X(30).
  5717             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5718             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5719
  5720         16  CF-CLAIM-NO-CONTROL.
  5721             20  CF-CLAIM-NO-METHOD         PIC X.
  5722                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5723                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5724                 88  CLAIM-NO-SEQ               VALUE '3'.
  5725                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5726             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5727                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5728                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5729                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 106
* EL050.cbl
  5730
  5731         16  CF-CHECK-NO-CONTROL.
  5732             20  CF-CHECK-NO-METHOD         PIC X.
  5733                 88  CHECK-NO-MANUAL            VALUE '1'.
  5734                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5735                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5736                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5737             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5738                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5739
  5740         16  CF-DOMICILE-STATE              PIC XX.
  5741
  5742         16  CF-EXPENSE-CONTROLS.
  5743             20  CF-EXPENSE-METHOD          PIC X.
  5744                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5745                 88  DOLLARS-PER-PMT            VALUE '2'.
  5746                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5747                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5748             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5749             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5750
  5751         16  CF-CORRESPONDENCE-CONTROL.
  5752             20  CF-LETTER-RESEND-OPT       PIC X.
  5753                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5754                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5755             20  FILLER                     PIC X(4).
  5756
  5757         16  CF-RESERVE-CONTROLS.
  5758             20  CF-MANUAL-SW               PIC X.
  5759                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5760             20  CF-FUTURE-SW               PIC X.
  5761                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5762             20  CF-PTC-SW                  PIC X.
  5763                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5764             20  CF-IBNR-SW                 PIC X.
  5765                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5766             20  CF-PTC-LF-SW               PIC X.
  5767                 88  CF-LF-PTC-USED             VALUE '1'.
  5768             20  CF-CDT-ACCESS-METHOD       PIC X.
  5769                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5770                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5771                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5772             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5773
  5774         16  CF-CLAIM-CALC-METHOD           PIC X.
  5775             88  360-PLUS-MONTHS                VALUE '1'.
  5776             88  365-PLUS-MONTHS                VALUE '2'.
  5777             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5778             88  360-DAILY                      VALUE '4'.
  5779             88  365-DAILY                      VALUE '5'.
  5780
  5781         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5782         16  FILLER                         PIC X(11).
  5783
  5784         16  CF-LIMIT-AMOUNTS.
  5785             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5786             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5787             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 107
* EL050.cbl
  5788             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5789             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5790             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5791             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5792             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5793             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5794             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5795
  5796         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5797         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5798         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5799
  5800         16  CF-ZIP-CODE.
  5801             20  CF-ZIP-PRIME.
  5802                 24  CF-ZIP-1ST             PIC X.
  5803                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5804                 24  FILLER                 PIC X(4).
  5805             20  CF-ZIP-PLUS4               PIC X(4).
  5806         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5807             20  CF-CAN-POSTAL-1            PIC XXX.
  5808             20  CF-CAN-POSTAL-2            PIC XXX.
  5809             20  FILLER                     PIC XXX.
  5810
  5811         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5812         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5813         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5814
  5815         16  CF-RATING-SWITCH               PIC X.
  5816             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5817             88  CF-NO-RATING                   VALUE 'N'.
  5818
  5819         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5820
  5821         16  CF-CARRIER-OVER-SHORT.
  5822             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5823             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5824
  5825         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5826         16  CF-SECPAY-SWITCH               PIC X.
  5827             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5828             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5829         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5830         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5831         16  FILLER                         PIC X(444).
  5832*        16  FILLER                         PIC X(452).
  5833
  5834
  5835****************************************************************
  5836*             MORTALITY MASTER RECORD                          *
  5837****************************************************************
  5838
  5839     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5840         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5841                                INDEXED BY CF-MORT-NDX.
  5842             20  CF-MORT-TABLE              PIC X(5).
  5843             20  CF-MORT-TABLE-TYPE         PIC X.
  5844                 88  CF-MORT-JOINT              VALUE 'J'.
  5845                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 108
* EL050.cbl
  5846                 88  CF-MORT-COMBINED           VALUE 'C'.
  5847                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5848                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5849             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5850             20  CF-MORT-AGE-METHOD         PIC XX.
  5851                 88  CF-AGE-LAST                VALUE 'AL'.
  5852                 88  CF-AGE-NEAR                VALUE 'AN'.
  5853             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5854             20  CF-MORT-ADJUSTMENT-DIRECTION
  5855                                            PIC X.
  5856                 88  CF-MINUS                   VALUE '-'.
  5857                 88  CF-PLUS                    VALUE '+'.
  5858             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5859             20  CF-MORT-JOINT-CODE         PIC X.
  5860                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5861             20  CF-MORT-PC-Q               PIC X.
  5862                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5863             20  CF-MORT-TABLE-CODE         PIC X(4).
  5864             20  CF-MORT-COMMENTS           PIC X(15).
  5865             20  FILLER                     PIC X(14).
  5866
  5867         16  FILLER                         PIC X(251).
  5868
  5869
  5870****************************************************************
  5871*             BUSSINESS TYPE MASTER RECORD                     *
  5872****************************************************************
  5873
  5874     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5875* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5876* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5877* AND RECORD 05 IS TYPES 81-99
  5878         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5879             20  CF-BUSINESS-TITLE          PIC  X(19).
  5880             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5881                                            PIC S9V9(4) COMP-3.
  5882             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5883             20  FILLER                     PIC  X.
  5884         16  FILLER                         PIC  X(248).
  5885
  5886
  5887****************************************************************
  5888*             TERMINAL MASTER RECORD                           *
  5889****************************************************************
  5890
  5891     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5892
  5893         16  CF-COMPANY-TERMINALS.
  5894             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5895                                  PIC X(4).
  5896         16  FILLER               PIC X(248).
  5897
  5898
  5899****************************************************************
  5900*             LIFE EDIT MASTER RECORD                          *
  5901****************************************************************
  5902
  5903     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 109
* EL050.cbl
  5904         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5905             20  CF-LIFE-CODE-IN            PIC XX.
  5906             20  CF-LIFE-CODE-OUT           PIC XX.
  5907         16  FILLER                         PIC X(248).
  5908
  5909
  5910****************************************************************
  5911*             AH EDIT MASTER RECORD                            *
  5912****************************************************************
  5913
  5914     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5915         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5916             20  CF-AH-CODE-IN              PIC XXX.
  5917             20  CF-AH-CODE-OUT             PIC XX.
  5918         16  FILLER                         PIC X(248).
  5919
  5920
  5921****************************************************************
  5922*             CREDIBILITY TABLES                               *
  5923****************************************************************
  5924
  5925     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5926         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5927                             INDEXED BY CF-CRDB-NDX.
  5928             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5929             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5930             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5931         16  FILLER                         PIC  X(332).
  5932
  5933
  5934****************************************************************
  5935*             REPORT CUSTOMIZATION RECORD                      *
  5936****************************************************************
  5937
  5938     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5939         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5940             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5941             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5942             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5943**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5944****       A T-TRANSFER.                                   ****
  5945             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5946
  5947         16  FILLER                         PIC XX.
  5948
  5949         16  CF-CARRIER-CNTL-OPT.
  5950             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5951                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5952                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5953             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5954                                            PIC X.
  5955         16  CF-GROUP-CNTL-OPT.
  5956             20  CF-GROUP-OPT-SEQ           PIC 9.
  5957                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5958                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5959             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5960                                            PIC X(6).
  5961         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 110
* EL050.cbl
  5962             20  CF-STATE-OPT-SEQ           PIC 9.
  5963                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5964                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5965             20  CF-STATE-SELECT OCCURS 3 TIMES
  5966                                            PIC XX.
  5967         16  CF-ACCOUNT-CNTL-OPT.
  5968             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5969                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5970                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5971             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5972                                            PIC X(10).
  5973         16  CF-BUS-TYP-CNTL-OPT.
  5974             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5975                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5976                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5977             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5978                                            PIC XX.
  5979         16  CF-LF-TYP-CNTL-OPT.
  5980             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5981                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5982                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5983             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5984                                            PIC XX.
  5985         16  CF-AH-TYP-CNTL-OPT.
  5986             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5987                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5988                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5989             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5990                                            PIC XX.
  5991         16  CF-REPTCD1-CNTL-OPT.
  5992             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5993                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5994                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5995             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5996                                            PIC X(10).
  5997         16  CF-REPTCD2-CNTL-OPT.
  5998             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5999                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6000                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6001             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6002                                            PIC X(10).
  6003         16  CF-USER1-CNTL-OPT.
  6004             20  CF-USER1-OPT-SEQ           PIC 9.
  6005                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6006                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6007             20  CF-USER1-SELECT OCCURS 3 TIMES
  6008                                            PIC X(10).
  6009         16  CF-USER2-CNTL-OPT.
  6010             20  CF-USER2-OPT-SEQ           PIC 9.
  6011                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6012                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6013             20  CF-USER2-SELECT OCCURS 3 TIMES
  6014                                            PIC X(10).
  6015         16  CF-USER3-CNTL-OPT.
  6016             20  CF-USER3-OPT-SEQ           PIC 9.
  6017                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6018                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6019             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 111
* EL050.cbl
  6020                                            PIC X(10).
  6021         16  CF-USER4-CNTL-OPT.
  6022             20  CF-USER4-OPT-SEQ           PIC 9.
  6023                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6024                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6025             20  CF-USER4-SELECT OCCURS 3 TIMES
  6026                                            PIC X(10).
  6027         16  CF-USER5-CNTL-OPT.
  6028             20  CF-USER5-OPT-SEQ           PIC 9.
  6029                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6030                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6031             20  CF-USER5-SELECT OCCURS 3 TIMES
  6032                                            PIC X(10).
  6033         16  CF-REINS-CNTL-OPT.
  6034             20  CF-REINS-OPT-SEQ           PIC 9.
  6035                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6036                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6037             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6038                 24  CF-REINS-PRIME         PIC XXX.
  6039                 24  CF-REINS-SUB           PIC XXX.
  6040
  6041         16  CF-AGENT-CNTL-OPT.
  6042             20  CF-AGENT-OPT-SEQ           PIC 9.
  6043                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6044                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6045             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6046                                            PIC X(10).
  6047
  6048         16  FILLER                         PIC X(43).
  6049
  6050         16  CF-LOSS-RATIO-SELECT.
  6051             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6052             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6053         16  CF-ENTRY-DATE-SELECT.
  6054             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6055             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6056         16  CF-EFFECTIVE-DATE-SELECT.
  6057             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6058             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6059
  6060         16  CF-EXCEPTION-LIST-IND          PIC X.
  6061             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6062
  6063         16  FILLER                         PIC X(318).
  6064
  6065****************************************************************
  6066*                  EXCEPTION REPORTING RECORD                  *
  6067****************************************************************
  6068
  6069     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6070         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6071             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6072
  6073         16  CF-COMBINED-LIFE-AH-OPT.
  6074             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6075             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6076             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6077             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 112
* EL050.cbl
  6078
  6079         16  CF-LIFE-OPT.
  6080             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6081             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6082             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6083             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6084             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6085             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6086             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6087             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6088             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6089             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6090
  6091         16  CF-AH-OPT.
  6092             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6093             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6094             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6095             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6096             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6097             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6098             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6099             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6100             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6101             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6102
  6103         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6104             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6105             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6106             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6107
  6108         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6109
  6110         16  FILLER                         PIC X(673).
  6111
  6112
  6113****************************************************************
  6114*             MORTGAGE SYSTEM PLAN RECORD                      *
  6115****************************************************************
  6116
  6117     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6118         16  CF-PLAN-TYPE                   PIC X.
  6119             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6120             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6121             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6122         16  CF-PLAN-ABBREV                 PIC XXX.
  6123         16  CF-PLAN-DESCRIPT               PIC X(10).
  6124         16  CF-PLAN-NOTES                  PIC X(20).
  6125         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6126         16  CF-PLAN-UNDERWRITING.
  6127             20  CF-PLAN-TERM-DATA.
  6128                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6129                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6130             20  CF-PLAN-AGE-DATA.
  6131                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6132                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6133                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6134             20  CF-PLAN-BENEFIT-DATA.
  6135                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 113
* EL050.cbl
  6136                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6137                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6138                                            PIC S9(7)V99  COMP-3.
  6139         16  CF-PLAN-POLICY-FORMS.
  6140             20  CF-POLICY-FORM             PIC X(12).
  6141             20  CF-MASTER-APPLICATION      PIC X(12).
  6142             20  CF-MASTER-POLICY           PIC X(12).
  6143         16  CF-PLAN-RATING.
  6144             20  CF-RATE-CODE               PIC X(5).
  6145             20  CF-SEX-RATING              PIC X.
  6146                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6147                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6148             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6149             20  CF-SUB-STD-TYPE            PIC X.
  6150                 88  CF-PCT-OF-PREM            VALUE '1'.
  6151                 88  CF-PCT-OF-BENE            VALUE '2'.
  6152         16  CF-PLAN-PREM-TOLERANCES.
  6153             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6154             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6155         16  CF-PLAN-PYMT-TOLERANCES.
  6156             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6157             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6158         16  CF-PLAN-MISC-DATA.
  6159             20  FILLER                     PIC X.
  6160             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6161             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6162         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6163         16  CF-PLAN-IND-GRP                PIC X.
  6164             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6165                                                     '1'.
  6166             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6167                                                     '2'.
  6168         16  CF-MIB-SEARCH-SW               PIC X.
  6169             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6170             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6171             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6172             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6173         16  CF-ALPHA-SEARCH-SW             PIC X.
  6174             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6175             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6176             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6177             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6178             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6179             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6180             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6181             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6182             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6183             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6184                                                     'A' 'B' 'C'
  6185                                                     'X' 'Y' 'Z'.
  6186         16  CF-EFF-DT-RULE-SW              PIC X.
  6187             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6188             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6189             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6190             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6191             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6192         16  FILLER                         PIC X(4).
  6193         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 114
* EL050.cbl
  6194             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6195         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6196         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6197         16  CF-PLAN-SNGL-JNT               PIC X.
  6198             88  CF-COMBINED-PLAN              VALUE 'C'.
  6199             88  CF-JNT-PLAN                   VALUE 'J'.
  6200             88  CF-SNGL-PLAN                  VALUE 'S'.
  6201         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6202         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6203         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6204         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6205         16  CF-RERATE-CNTL                 PIC  X.
  6206             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6207             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6208             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6209             88  CF-AUTO-RECALC                 VALUE '4'.
  6210         16  CF-BENEFIT-TYPE                PIC  X.
  6211             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6212             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6213         16  CF-POLICY-FEE                  PIC S999V99
  6214                                                    COMP-3.
  6215         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6216         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6217         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6218         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6219         16  FILLER                         PIC  X(32).
  6220         16  CF-TERMINATION-FORM            PIC  X(04).
  6221         16  FILLER                         PIC  X(08).
  6222         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6223                                                       COMP-3.
  6224         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6225         16  CF-ISSUE-LETTER                PIC  X(4).
  6226         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6227         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6228             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6229             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6230         16  CF-MP-REFUND-CALC              PIC X.
  6231             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6232             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6233             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6234             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6235             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6236             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6237             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6238             88  CF-MP-REFD-MEAN                VALUE '8'.
  6239         16  CF-ALT-RATE-CODE               PIC  X(5).
  6240
  6241
  6242         16  FILLER                         PIC X(498).
  6243****************************************************************
  6244*             MORTGAGE COMPANY MASTER RECORD                   *
  6245****************************************************************
  6246
  6247     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6248         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6249         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6250             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6251             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 115
* EL050.cbl
  6252             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6253             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6254             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6255
  6256         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6257         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6258         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6259         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6260         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6261
  6262         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6263             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6264         16  CF-MP-RECON-USE-IND            PIC X(1).
  6265             88  CF-MP-USE-RECON             VALUE 'Y'.
  6266         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6267             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6268         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6269             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6270             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6271         16  FILLER                         PIC X(1).
  6272         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6273             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6274         16  CF-MORTG-MIB-VERSION           PIC X.
  6275             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6276             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6277             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6278         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6279             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6280                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6281             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6282                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6283             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6284                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6285             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6286                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6287             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6288                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6289             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6290                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6291         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6292         16  FILLER                         PIC X(7).
  6293         16  CF-MORTG-DESTINATION-SYMBOL.
  6294             20  CF-MORTG-MIB-COMM          PIC X(5).
  6295             20  CF-MORTG-MIB-TERM          PIC X(5).
  6296         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6297             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6298         16  FILLER                         PIC X(03).
  6299         16  CF-MP-CHECK-NO-CONTROL.
  6300             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6301                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6302                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6303                                                ' ' LOW-VALUES.
  6304                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6305                                               VALUE '3'.
  6306         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6307         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6308         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6309             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 116
* EL050.cbl
  6310                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6311             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6312                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6313             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6314                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6315             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6316                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6317             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6318                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6319             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6320                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6321         16  CF-MORTG-BILLING-AREA.
  6322             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6323                                            PIC X.
  6324         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6325         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6326         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6327         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6328             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6329             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6330         16  FILLER                         PIC X.
  6331         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6332             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6333             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6334         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6335         16  FILLER                         PIC X(8).
  6336         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6337         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6338         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6339         16  CF-ACH-COMPANY-ID.
  6340             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6341                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6342                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6343                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6344             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6345         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6346             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6347         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6348             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6349             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6350         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6351         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6352         16  FILLER                         PIC X(536).
  6353
  6354****************************************************************
  6355*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6356****************************************************************
  6357
  6358     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6359         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6360             20  CF-FEMALE-HEIGHT.
  6361                 24  CF-FEMALE-FT           PIC 99.
  6362                 24  CF-FEMALE-IN           PIC 99.
  6363             20  CF-FEMALE-MIN-WT           PIC 999.
  6364             20  CF-FEMALE-MAX-WT           PIC 999.
  6365         16  FILLER                         PIC X(428).
  6366
  6367     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 117
* EL050.cbl
  6368         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6369             20  CF-MALE-HEIGHT.
  6370                 24  CF-MALE-FT             PIC 99.
  6371                 24  CF-MALE-IN             PIC 99.
  6372             20  CF-MALE-MIN-WT             PIC 999.
  6373             20  CF-MALE-MAX-WT             PIC 999.
  6374         16  FILLER                         PIC X(428).
  6375******************************************************************
  6376*             AUTOMATIC ACTIVITY RECORD                          *
  6377******************************************************************
  6378     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6379         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6380             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6381             20  CF-SYS-LETTER-ID           PIC X(04).
  6382             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6383             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6384             20  CF-SYS-RESET-SW            PIC X(01).
  6385             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6386             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6387
  6388         16  FILLER                         PIC X(50).
  6389
  6390         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6391             20  CF-USER-ACTIVE-SW          PIC X(01).
  6392             20  CF-USER-LETTER-ID          PIC X(04).
  6393             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6394             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6395             20  CF-USER-RESET-SW           PIC X(01).
  6396             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6397             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6398             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6399
  6400         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 118
* EL050.cbl
  6402*    COPY ERCACCT.
  6403******************************************************************
  6404*                                                                *
  6405*                                                                *
  6406*                            ERCACCT                             *
  6407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6408*                            VMOD=2.031                          *
  6409*                                                                *
  6410*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6411*                                                                *
  6412*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6413*   VSAM ACCOUNT MASTER FILES.                                   *
  6414*                                                                *
  6415*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6416*                                                                *
  6417*   FILE TYPE = VSAM,KSDS                                        *
  6418*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6419*                                                                *
  6420*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6421*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6422*                                                                *
  6423*   LOG = NO                                                     *
  6424*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6425*                                                                *
  6426*                                                                *
  6427******************************************************************
  6428*                   C H A N G E   L O G
  6429*
  6430* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6431*-----------------------------------------------------------------
  6432*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6433* EFFECTIVE    NUMBER
  6434*-----------------------------------------------------------------
  6435* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6436* 092705    2005050300006  PEMA  ADD SPP LEASES
  6437* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6438* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6439* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6440* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6441* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6442******************************************************************
  6443
  6444 01  ACCOUNT-MASTER.
  6445     12  AM-RECORD-ID                      PIC XX.
  6446         88  VALID-AM-ID                      VALUE 'AM'.
  6447
  6448     12  AM-CONTROL-PRIMARY.
  6449         16  AM-COMPANY-CD                 PIC X.
  6450         16  AM-MSTR-CNTRL.
  6451             20  AM-CONTROL-A.
  6452                 24  AM-CARRIER            PIC X.
  6453                 24  AM-GROUPING.
  6454                     28 AM-GROUPING-PREFIX PIC XXX.
  6455                     28 AM-GROUPING-PRIME  PIC XXX.
  6456                 24  AM-STATE              PIC XX.
  6457                 24  AM-ACCOUNT.
  6458                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6459                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 119
* EL050.cbl
  6460             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6461                                           PIC X(19).
  6462             20  AM-CNTRL-B.
  6463                 24  AM-EXPIRATION-DT      PIC XX.
  6464                 24  FILLER                PIC X(4).
  6465             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6466                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6467
  6468     12  AM-CONTROL-BY-VAR-GRP.
  6469         16  AM-COMPANY-CD-A1              PIC X.
  6470         16  AM-VG-CARRIER                 PIC X.
  6471         16  AM-VG-GROUPING                PIC X(6).
  6472         16  AM-VG-STATE                   PIC XX.
  6473         16  AM-VG-ACCOUNT                 PIC X(10).
  6474         16  AM-VG-DATE.
  6475             20  AM-VG-EXPIRATION-DT       PIC XX.
  6476             20  FILLER                    PIC X(4).
  6477         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6478                                           PIC 9(11)      COMP-3.
  6479     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6480         16  FILLER                        PIC X(10).
  6481         16  AM-VG-KEY3.
  6482             20  AM-VG3-ACCOUNT            PIC X(10).
  6483             20  AM-VG3-EXP-DT             PIC XX.
  6484         16  FILLER                        PIC X(4).
  6485     12  AM-MAINT-INFORMATION.
  6486         16  AM-LAST-MAINT-DT              PIC XX.
  6487         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6488         16  AM-LAST-MAINT-USER            PIC X(4).
  6489         16  FILLER                        PIC XX.
  6490
  6491     12  AM-EFFECTIVE-DT                   PIC XX.
  6492     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6493
  6494     12  AM-PREV-DATES  COMP-3.
  6495         16  AM-PREV-EXP-DT                PIC 9(11).
  6496         16  AM-PREV-EFF-DT                PIC 9(11).
  6497
  6498     12  AM-REPORT-CODE-1                  PIC X(10).
  6499     12  AM-REPORT-CODE-2                  PIC X(10).
  6500
  6501     12  AM-CITY-CODE                      PIC X(4).
  6502     12  AM-COUNTY-PARISH                  PIC X(6).
  6503
  6504     12  AM-NAME                           PIC X(30).
  6505     12  AM-PERSON                         PIC X(30).
  6506     12  AM-ADDRS                          PIC X(30).
  6507     12  AM-CITY.
  6508         16  AM-ADDR-CITY                  PIC X(28).
  6509         16  AM-ADDR-STATE                 PIC XX.
  6510     12  AM-ZIP.
  6511         16  AM-ZIP-PRIME.
  6512             20  AM-ZIP-PRI-1ST            PIC X.
  6513                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6514             20  FILLER                    PIC X(4).
  6515         16  AM-ZIP-PLUS4                  PIC X(4).
  6516     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6517         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 120
* EL050.cbl
  6518         16  AM-CAN-POSTAL-2               PIC XXX.
  6519         16  FILLER                        PIC XXX.
  6520     12  AM-TEL-NO.
  6521         16  AM-AREA-CODE                  PIC 999.
  6522         16  AM-TEL-PRE                    PIC 999.
  6523         16  AM-TEL-NBR                    PIC 9(4).
  6524     12  AM-TEL-LOC                        PIC X.
  6525         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6526         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6527
  6528     12  AM-COMM-STRUCTURE.
  6529         16  AM-DEFN-1.
  6530             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6531                 24  AM-AGT.
  6532                     28  AM-AGT-PREFIX     PIC X(4).
  6533                     28  AM-AGT-PRIME      PIC X(6).
  6534                 24  AM-COM-TYP            PIC X.
  6535                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6536                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6537                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6538                 24  AM-RECALC-LV-INDIC    PIC X.
  6539                 24  AM-RETRO-LV-INDIC     PIC X.
  6540                 24  AM-GL-CODES           PIC X.
  6541                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6542                 24  FILLER                PIC X(01).
  6543         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6544             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6545                 24  FILLER                PIC X(11).
  6546                 24  AM-L-COMA             PIC XXX.
  6547                 24  AM-J-COMA             PIC XXX.
  6548                 24  AM-A-COMA             PIC XXX.
  6549                 24  FILLER                PIC X(6).
  6550
  6551     12  AM-COMM-CHANGE-STATUS             PIC X.
  6552         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6553
  6554     12  AM-CSR-CODE                       PIC X(4).
  6555
  6556     12  AM-BILLING-STATUS                 PIC X.
  6557         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6558         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6559     12  AM-AUTO-REFUND-SW                 PIC X.
  6560         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6561         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6562     12  AM-GPCD                           PIC 99.
  6563     12  AM-IG                             PIC X.
  6564         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6565         88  AM-HAS-GROUP                     VALUE '2'.
  6566     12  AM-STATUS                         PIC X.
  6567         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6568         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6569         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6570         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6571         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6572         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6573     12  AM-REMIT-TO                       PIC 99.
  6574     12  AM-ID-NO                          PIC X(11).
  6575
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 121
* EL050.cbl
  6576     12  AM-CAL-TABLE                      PIC XX.
  6577     12  AM-LF-DEVIATION                   PIC XXX.
  6578     12  AM-AH-DEVIATION                   PIC XXX.
  6579     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6580     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6581     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6582     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6583     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6584     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6585
  6586     12  AM-USER-FIELDS.
  6587         16  AM-FLD-1                      PIC XX.
  6588         16  AM-FLD-2                      PIC XX.
  6589         16  AM-FLD-3                      PIC XX.
  6590         16  AM-FLD-4                      PIC XX.
  6591         16  AM-FLD-5                      PIC XX.
  6592
  6593     12  AM-1ST-PROD-DATE.
  6594         16  AM-1ST-PROD-YR                PIC XX.
  6595         16  AM-1ST-PROD-MO                PIC XX.
  6596         16  AM-1ST-PROD-DA                PIC XX.
  6597     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6598     12  AM-CERTS-PURGED-DATE.
  6599         16  AM-PUR-YR                     PIC XX.
  6600         16  AM-PUR-MO                     PIC XX.
  6601         16  AM-PUR-DA                     PIC XX.
  6602     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6603     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6604     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6605     12  AM-INACTIVE-DATE.
  6606         16  AM-INA-MO                     PIC 99.
  6607         16  AM-INA-DA                     PIC 99.
  6608         16  AM-INA-YR                     PIC 99.
  6609     12  AM-AR-HI-CERT-DATE                PIC XX.
  6610
  6611     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6612     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6613
  6614     12  AM-OB-PAYMENT-MODE                PIC X.
  6615         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6616         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6617         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6618         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6619
  6620     12  AM-AH-ONLY-INDICATOR              PIC X.
  6621         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6622         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6623
  6624     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6625
  6626     12  AM-OVER-SHORT.
  6627         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6628         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6629
  6630     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6631     12  AM-DCC-CLP-STATE                  PIC XX.
  6632
  6633     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 122
* EL050.cbl
  6634     12  AM-RECALC-REIN                    PIC X.
  6635
  6636     12  AM-REI-TABLE                      PIC XXX.
  6637     12  AM-REI-ET-LF                      PIC X.
  6638     12  AM-REI-ET-AH                      PIC X.
  6639     12  AM-REI-PE-LF                      PIC X.
  6640     12  AM-REI-PE-AH                      PIC X.
  6641     12  AM-REI-PRT-ST                     PIC X.
  6642     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6643     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6644     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6645     12  AM-REI-GROUP-A                    PIC X(6).
  6646     12  AM-REI-MORT                       PIC X(4).
  6647     12  AM-REI-PRT-OW                     PIC X.
  6648     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6649     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6650     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6651     12  AM-REI-GROUP-B                    PIC X(6).
  6652
  6653     12  AM-TRUST-TYPE                     PIC X(2).
  6654
  6655     12  AM-EMPLOYER-STMT-USED             PIC X.
  6656     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6657
  6658     12  AM-STD-AH-TYPE                    PIC XX.
  6659     12  AM-EARN-METHODS.
  6660         16  AM-EARN-METHOD-R              PIC X.
  6661             88 AM-REF-RL-R78                 VALUE 'R'.
  6662             88 AM-REF-RL-PR                  VALUE 'P'.
  6663             88 AM-REF-RL-MEAN                VALUE 'M'.
  6664             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6665         16  AM-EARN-METHOD-L              PIC X.
  6666             88 AM-REF-LL-R78                 VALUE 'R'.
  6667             88 AM-REF-LL-PR                  VALUE 'P'.
  6668             88 AM-REF-LL-MEAN                VALUE 'M'.
  6669             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6670         16  AM-EARN-METHOD-A              PIC X.
  6671             88 AM-REF-AH-R78                 VALUE 'R'.
  6672             88 AM-REF-AH-PR                  VALUE 'P'.
  6673             88 AM-REF-AH-MEAN                VALUE 'M'.
  6674             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6675             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6676             88 AM-REF-AH-NET                 VALUE 'N'.
  6677
  6678     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6679     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6680     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6681
  6682     12  AM-RET-Y-N                        PIC X.
  6683     12  AM-RET-P-E                        PIC X.
  6684     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6685     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6686     12  AM-RET-GRP                        PIC X(6).
  6687     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6688         16  AM-POOL-PRIME                 PIC XXX.
  6689         16  AM-POOL-SUB                   PIC XXX.
  6690     12  AM-RETRO-EARNINGS.
  6691         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 123
* EL050.cbl
  6692         16  AM-RET-EARN-L                 PIC X.
  6693         16  AM-RET-EARN-A                 PIC X.
  6694     12  AM-RET-ST-TAX-USE                 PIC X.
  6695         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6696         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6697     12  AM-RETRO-BEG-EARNINGS.
  6698         16  AM-RET-BEG-EARN-R             PIC X.
  6699         16  AM-RET-BEG-EARN-L             PIC X.
  6700         16  AM-RET-BEG-EARN-A             PIC X.
  6701     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6702     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6703
  6704     12  AM-USER-SELECT-OPTIONS.
  6705         16  AM-USER-SELECT-1              PIC X(10).
  6706         16  AM-USER-SELECT-2              PIC X(10).
  6707         16  AM-USER-SELECT-3              PIC X(10).
  6708         16  AM-USER-SELECT-4              PIC X(10).
  6709         16  AM-USER-SELECT-5              PIC X(10).
  6710
  6711     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6712
  6713     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6714
  6715     12  AM-RPT045A-SWITCH                 PIC X.
  6716         88  RPT045A-OFF                   VALUE 'N'.
  6717
  6718     12  AM-INSURANCE-LIMITS.
  6719         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6720         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6721
  6722     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6723         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6724
  6725     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6726         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6727         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6728
  6729     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6730
  6731     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6732     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6733     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6734     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6735     12  AM-DCC-UEF-STATE                  PIC XX.
  6736     12  FILLER                            PIC XXX.
  6737     12  AM-REPORT-CODE-3                  PIC X(10).
  6738*    12  FILLER                            PIC X(22).
  6739
  6740     12  AM-RESERVE-DATE.
  6741         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6742         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6743         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6744
  6745     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6746     12  AM-NOTIFICATION-TYPES.
  6747         16  AM-NOTIF-OF-LETTERS           PIC X.
  6748         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6749         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 124
* EL050.cbl
  6750         16  AM-NOTIF-OF-STATUS            PIC X.
  6751
  6752     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6753         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6754         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6755         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6756         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6757
  6758     12  AM-BENEFIT-CONTROLS.
  6759         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6760             20  AM-BENEFIT-CODE           PIC XX.
  6761             20  AM-BENEFIT-TYPE           PIC X.
  6762             20  AM-BENEFIT-REVISION       PIC XXX.
  6763             20  AM-BENEFIT-REM-TERM       PIC X.
  6764             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6765             20  FILLER                    PIC XX.
  6766         16  FILLER                        PIC X(80).
  6767
  6768     12  AM-TRANSFER-DATA.
  6769         16  AM-TRANSFERRED-FROM.
  6770             20  AM-TRNFROM-CARRIER        PIC X.
  6771             20  AM-TRNFROM-GROUPING.
  6772                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6773                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6774             20  AM-TRNFROM-STATE          PIC XX.
  6775             20  AM-TRNFROM-ACCOUNT.
  6776                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6777                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6778             20  AM-TRNFROM-DTE            PIC XX.
  6779         16  AM-TRANSFERRED-TO.
  6780             20  AM-TRNTO-CARRIER          PIC X.
  6781             20  AM-TRNTO-GROUPING.
  6782                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6783                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6784             20  AM-TRNTO-STATE            PIC XX.
  6785             20  AM-TRNTO-ACCOUNT.
  6786                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6787                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6788             20  AM-TRNTO-DTE              PIC XX.
  6789         16  FILLER                        PIC X(10).
  6790
  6791     12  AM-SAVED-REMIT-TO                 PIC 99.
  6792
  6793     12  AM-COMM-STRUCTURE-SAVED.
  6794         16  AM-DEFN-1-SAVED.
  6795             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6796                 24  AM-AGT-SV             PIC X(10).
  6797                 24  AM-COM-TYP-SV         PIC X.
  6798                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6799                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6800                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6801                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6802                 24  FILLER                PIC X.
  6803                 24  AM-GL-CODES-SV        PIC X.
  6804                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6805                 24  FILLER                PIC X.
  6806         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6807             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 125
* EL050.cbl
  6808                 24  FILLER                PIC X(11).
  6809                 24  AM-L-COMA-SV          PIC XXX.
  6810                 24  AM-J-COMA-SV          PIC XXX.
  6811                 24  AM-A-COMA-SV          PIC XXX.
  6812                 24  FILLER                PIC X(6).
  6813
  6814     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6815         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6816            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6817            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6818            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6819
  6820     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6821     12  FILLER                            PIC X(120).
  6822
  6823     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6824         16  AM-CONTROL-NAME               PIC X(30).
  6825         16  AM-EXECUTIVE-ONE.
  6826             20  AM-EXEC1-NAME             PIC X(15).
  6827             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6828                                                          COMP-3.
  6829             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6830                                                          COMP-3.
  6831         16  AM-EXECUTIVE-TWO.
  6832             20  AM-EXEC2-NAME             PIC X(15).
  6833             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6834                                                          COMP-3.
  6835             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6836                                                          COMP-3.
  6837
  6838     12  AM-RETRO-ADDITIONAL-DATA.
  6839         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6840         16  AM-RETRO-PREM-P-E             PIC X.
  6841         16  AM-RETRO-CLMS-P-I             PIC X.
  6842         16  AM-RETRO-RET-BRACKET-LF.
  6843             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6844                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6845                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6846             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6847                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6848                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6849             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6850                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6851                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6852         16  AM-RETRO-RET-BRACKET-AH.
  6853             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6854                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6855                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6856                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6857             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6858                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6859                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6860             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6861                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6862                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6863
  6864     12  AM-COMMENTS.
  6865         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 126
* EL050.cbl
  6866
  6867     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6868         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6869         16  AM-FLI-BILLING-CODE           PIC X.
  6870         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6871         16  AM-FLI-UNITED-IDENT           PIC X.
  6872         16  AM-FLI-INTEREST-LOST-DATA.
  6873             20  AM-FLI-BANK-NO            PIC X(5).
  6874             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6875             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6876             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6877         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6878             20  AM-FLI-AGT                PIC X(9).
  6879             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6880             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6881         16  FILLER                        PIC X(102).
  6882
  6883     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6884         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6885             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6886             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6887             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6888             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6889             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6890         16  FILLER                          PIC X(10).
  6891******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 127
* EL050.cbl
  6893*    COPY ERCREIN.
  6894******************************************************************
  6895*                                                                *
  6896*                            ERCREIN                             *
  6897*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6898*                            VMOD=2.010                          *
  6899*                                                                *
  6900*   ONLINE CREDIT SYSTEM                                         *
  6901*                                                                *
  6902*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6903*                                                                *
  6904*   FILE TYPE = VSAM,KSDS                                        *
  6905*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6906*                                                                *
  6907*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6908*       ALTERNATE PATH = NONE                                    *
  6909*                                                                *
  6910*   LOG = NO                                                     *
  6911*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6912*                                                                *
  6913******************************************************************
  6914*                   C H A N G E   L O G
  6915*
  6916* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6917*-----------------------------------------------------------------
  6918*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6919* EFFECTIVE    NUMBER
  6920*-----------------------------------------------------------------
  6921* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6922* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6923******************************************************************
  6924 01  REINSURANCE-RECORD.
  6925     12  RE-RECORD-ID                      PIC XX.
  6926         88  VALID-RE-ID                      VALUE 'RE'.
  6927
  6928     12  RE-CONTROL-PRIMARY.
  6929         16  RE-COMPANY-CD                 PIC X.
  6930         16  RE-KEY.
  6931             20  RE-CODE                   PIC X.
  6932                 88  RE-TABLE-RECORD          VALUE 'A'.
  6933                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6934             20  RE-TABLE                  PIC XXX.
  6935             20  FILLER                    PIC XXX.
  6936         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6937             20  FILLER                    PIC X.
  6938             20  RE-COMPANY.
  6939                 24  RE-COMP-PRIME         PIC XXX.
  6940                 24  RE-COMP-SUB           PIC XXX.
  6941
  6942     12  RE-MAINT-INFORMATION.
  6943         16  RE-LAST-MAINT-DT              PIC XX.
  6944         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6945         16  RE-LAST-MAINT-USER            PIC X(4).
  6946         16  FILLER                        PIC X(10).
  6947
  6948     12  RE-TABLE-DATA.
  6949         16  RE-100-COMP                   PIC 99.
  6950
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 128
* EL050.cbl
  6951         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6952             20  RE-REI-COMP-NO.
  6953                 24  RE-REI-COMP           PIC XXX.
  6954                 24  RE-REI-COMP-SUB       PIC XXX.
  6955             20  RE-LF-QC                  PIC X.
  6956             20  RE-AH-QC                  PIC X.
  6957             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6958             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6959             20  RE-LFAGE-LO               PIC 99.
  6960             20  RE-LFAGE-HI               PIC 99.
  6961             20  RE-AHAGE-LO               PIC 99.
  6962             20  RE-AHAGE-HI               PIC 99.
  6963             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6964             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6965             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6966             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6967             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6968             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6969             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6970             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6971             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6972             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6973             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6974             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6975             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6976             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6977             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6978             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6979             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6980             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6981             20  RE-LF-BEN-CODE            PIC X.
  6982             20  RE-AH-BEN-CODE            PIC X.
  6983             20  RE-INTERACTIVE            PIC X.
  6984             20  RE-REMAINING              PIC X.
  6985             20  RE-LF-RUNOFF-SW           PIC X.
  6986             20  RE-AH-RUNOFF-SW           PIC X.
  6987             20  FILLER                    PIC X(19).
  6988
  6989         16  RE-COMP-INFO-END              PIC X(6).
  6990         16  RE-NSP-ST-CD-LF               PIC XX.
  6991         16  RE-NSP-ST-CD-AH               PIC XX.
  6992         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6993             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6994
  6995         16  FILLER                        PIC X(27).
  6996
  6997     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6998         16  RE-NAME                       PIC X(30).
  6999         16  RE-LF-PE                      PIC X.
  7000         16  RE-AH-PE                      PIC X.
  7001         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7002         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7003         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7004         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7005         16  RE-PRT-ST                     PIC X.
  7006         16  RE-PRT-OW                     PIC X.
  7007         16  RE-MORT-CODE                  PIC X(4).
  7008         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 129
* EL050.cbl
  7009         16  RE-ZERO-LF-FEE                PIC X.
  7010         16  RE-ZERO-AH-FEE                PIC X.
  7011         16  RE-CEDE-NAME                  PIC X(30).
  7012         16  RE-LF-COMM                    PIC X.
  7013         16  RE-AH-COMM                    PIC X.
  7014         16  RE-LF-TAX                     PIC X.
  7015         16  RE-AH-TAX                     PIC X.
  7016         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7017         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7018         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7019
  7020         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7021             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7022
  7023         16  RE-LF-CEDING-FEE-BRACKETS.
  7024             20  RE-LF-FEE-METHOD          PIC X.
  7025                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7026                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7027                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7028                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7029             20  RE-LF-FEE-BASIS           PIC X.
  7030                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7031                 88  RE-LF-NET-CEDED               VALUE '2'.
  7032                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7033                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7034                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7035                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7036                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7037                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7038             20  FILLER                    PIC XXX.
  7039             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7040                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7041                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7042
  7043         16  RE-AH-CEDING-FEE-BRACKETS.
  7044             20  RE-AH-FEE-METHOD          PIC X.
  7045                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7046                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7047                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7048                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7049             20  RE-AH-FEE-BASIS           PIC X.
  7050                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7051                 88  RE-AH-NET-CEDED               VALUE '2'.
  7052                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7053                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7054                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7055                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7056                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7057                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7058             20  FILLER                    PIC XXX.
  7059             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7060                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7061                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7062
  7063         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7064
  7065         16  RE-OLD-CEDING-STMT            PIC X.
  7066
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 130
* EL050.cbl
  7067         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7068         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7069         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7070         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7071         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7072         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7073         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7074         16  RE-MORT-SW                    PIC X.
  7075         16  RE-CEDING-TYPE-FLAG           PIC X.
  7076             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7077             88  RE-CEDED                          VALUE 'C'.
  7078             88  RE-ASSUMED                        VALUE 'A'.
  7079             88  RE-PHANTOM                        VALUE 'P'.
  7080
  7081         16  RE-CEDING-STMT-OPT-A          PIC X.
  7082             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7083         16  RE-CEDING-STMT-OPT-B          PIC X.
  7084             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7085         16  RE-CEDING-STMT-OPT-C          PIC X.
  7086             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7087         16  RE-CEDING-STMT-OPT-D          PIC X.
  7088             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7089         16  RE-CEDING-STMT-OPT-E          PIC X.
  7090             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7091
  7092         16  RE-PRT-CRSV                   PIC X.
  7093
  7094         16  RE-GL-CENTER                  PIC X(4).
  7095
  7096         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7097
  7098         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7099
  7100         16  RE-EARN-STOP-CODE             PIC X.
  7101             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7102             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7103
  7104         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7105             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7106
  7107         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7108         16  FILLER                        PIC X(2281).
  7109
  7110         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7111
  7112******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 131
* EL050.cbl
  7114*    COPY ERCCTBL.
  7115******************************************************************
  7116*                                                                *
  7117*                                                                *
  7118*                            ERCCTBL                             *
  7119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7120*                            VMOD=2.003
  7121*                                                                *
  7122*   ONLINE CREDIT SYSTEM                                         *
  7123*                                                                *
  7124*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7125*                                                                *
  7126*   FILE TYPE = VSAM,KSDS                                        *
  7127*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7128*                                                                *
  7129*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7130*       ALTERNATE PATH = NONE                                    *
  7131*                                                                *
  7132*   LOG = NO                                                     *
  7133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7134*                                                                *
  7135*                                                                *
  7136******************************************************************
  7137
  7138 01  COMM-TABLE-RECORD.
  7139     12  CT-RECORD-ID                      PIC XX.
  7140         88  VALID-CT-ID                      VALUE 'CT'.
  7141
  7142     12  CT-CONTROL-PRIMARY.
  7143         16  CT-COMPANY-CD                 PIC X.
  7144         16  CT-TABLE                      PIC XXX.
  7145         16  CT-CNTRL-2.
  7146             20  CT-BEN-TYPE               PIC X.
  7147             20  CT-BEN-CODE               PIC XX.
  7148
  7149     12  CT-MAINT-INFORMATION.
  7150         16  CT-LAST-MAINT-DT              PIC XX.
  7151         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7152         16  CT-LAST-MAINT-USER            PIC X(4).
  7153         16  FILLER                        PIC X(31).
  7154
  7155     12  CT-LIMITS.
  7156         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7157
  7158         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7159
  7160         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7161
  7162     12  CT-RATES.
  7163         16  CT-RTX          OCCURS 27 TIMES.
  7164             20  CT-RT                     PIC SV9(5)     COMP-3.
  7165             20  CT-RT-R   REDEFINES
  7166                 CT-RT                     PIC XXX.
  7167
  7168     12  FILLER                            PIC  X(42).
  7169
  7170******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 132
* EL050.cbl
  7172*    COPY ERCFORM.
  7173******************************************************************
  7174*                                                                *
  7175*                                                                *
  7176*                            ERCFORM.                            *
  7177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7178*                            VMOD=2.003                          *
  7179*                                                                *
  7180*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7181*                                                                *
  7182*    FILE TYPE = VSAM,KSDS                                       *
  7183*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7184*                                                                *
  7185*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7186*                                                                *
  7187*    LOG = YES                                                   *
  7188*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7189******************************************************************
  7190 01  FORM-MASTER.
  7191    12  FO-RECORD-ID                 PIC X(02).
  7192        88  VALID-FO-ID                  VALUE 'FO'.
  7193
  7194    12  FO-CONTROL-PRIMARY.
  7195        16  FO-COMPANY-CD            PIC X(01).
  7196        16  FO-STATE                 PIC X(02).
  7197        16  FO-FORM-ID               PIC X(12).
  7198        16  FO-FORM-EXP-DT           PIC X(02).
  7199
  7200    12  FO-POLICY-FORM-DATA.
  7201        16  FO-IND-GRP-CD            PIC X(01).
  7202        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7203        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7204        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7205        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7206        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7207        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7208        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7209        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7210        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7211        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7212        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7213        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7214        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7215        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7216        16  FO-APP-CERT-USE-CD       PIC X(01).
  7217
  7218    12  FILLER                       PIC X(29).
  7219
  7220    12  FO-FORM-PLAN-TABLE.
  7221        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7222            20  FO-PLAN-TYPE         PIC X(01).
  7223            20  FO-PLAN-ID           PIC X(02).
  7224            20  FO-PLAN-TERM         PIC 9(03).
  7225            20  FO-PLAN-REFUND-METHOD
  7226                                     PIC X.
  7227
  7228    12  FILLER                       PIC X(30).
  7229
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 133
* EL050.cbl
  7230    12  FO-COMMENTS-AREA.
  7231        16  FO-COMMENT-LINE-1        PIC X(78).
  7232
  7233    12  FILLER                       PIC X(20).
  7234
  7235    12  FO-MAINT-INFORMATION.
  7236        16  FO-LAST-MAINT-DT         PIC X(02).
  7237        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7238        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 134
* EL050.cbl
  7240*    COPY ELCMSTR.
  7241******************************************************************
  7242*                                                                *
  7243*                            ELCMSTR.                            *
  7244*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7245*                            VMOD=2.012                          *
  7246*                                                                *
  7247*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7248*                                                                *
  7249*   FILE TYPE = VSAM,KSDS                                        *
  7250*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7251*                                                                *
  7252*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7253*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7254*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7255*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7256*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7257*                                                 RKP=75,LEN=21  *
  7258*                                                                *
  7259*   **** NOTE ****                                               *
  7260*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7261*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7262*                                                                *
  7263*   LOG = YES                                                    *
  7264*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7265******************************************************************
  7266*                   C H A N G E   L O G
  7267*
  7268* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7269*-----------------------------------------------------------------
  7270*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7271* EFFECTIVE    NUMBER
  7272*-----------------------------------------------------------------
  7273* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7274* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7275* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7276******************************************************************
  7277 01  CLAIM-MASTER.
  7278     12  CL-RECORD-ID                PIC XX.
  7279         88  VALID-CL-ID         VALUE 'CL'.
  7280
  7281     12  CL-CONTROL-PRIMARY.
  7282         16  CL-COMPANY-CD           PIC X.
  7283         16  CL-CARRIER              PIC X.
  7284         16  CL-CLAIM-NO             PIC X(7).
  7285         16  CL-CERT-NO.
  7286             20  CL-CERT-PRIME       PIC X(10).
  7287             20  CL-CERT-SFX         PIC X.
  7288
  7289     12  CL-CONTROL-BY-NAME.
  7290         16  CL-COMPANY-CD-A1        PIC X.
  7291         16  CL-INSURED-LAST-NAME    PIC X(15).
  7292         16  CL-INSURED-NAME.
  7293             20  CL-INSURED-1ST-NAME PIC X(12).
  7294             20  CL-INSURED-MID-INIT PIC X.
  7295
  7296     12  CL-CONTROL-BY-SSN.
  7297         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 135
* EL050.cbl
  7298         16  CL-SOC-SEC-NO.
  7299             20  CL-SSN-STATE        PIC XX.
  7300             20  CL-SSN-ACCOUNT      PIC X(6).
  7301             20  CL-SSN-LN3          PIC X(3).
  7302
  7303     12  CL-CONTROL-BY-CERT-NO.
  7304         16  CL-COMPANY-CD-A4        PIC X.
  7305         16  CL-CERT-NO-A4.
  7306             20  CL-CERT-A4-PRIME    PIC X(10).
  7307             20  CL-CERT-A4-SFX      PIC X.
  7308
  7309     12  CL-CONTROL-BY-CCN.
  7310         16  CL-COMPANY-CD-A5        PIC X.
  7311         16  CL-CCN-A5.
  7312             20  CL-CCN.
  7313                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7314                 24  CL-CCN-PRIME-A5 PIC X(12).
  7315             20  CL-CCN-FILLER-A5    PIC X(4).
  7316
  7317     12  CL-INSURED-PROFILE-DATA.
  7318         16  CL-INSURED-BIRTH-DT     PIC XX.
  7319         16  CL-INSURED-SEX-CD       PIC X.
  7320             88  INSURED-IS-MALE        VALUE 'M'.
  7321             88  INSURED-IS-FEMALE      VALUE 'F'.
  7322             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7323         16  CL-INSURED-OCC-CD       PIC X(6).
  7324         16  FILLER                  PIC X(5).
  7325
  7326     12  CL-PROCESSING-INFO.
  7327         16  CL-PROCESSOR-ID         PIC X(4).
  7328         16  CL-CLAIM-STATUS         PIC X.
  7329             88  CLAIM-IS-OPEN          VALUE 'O'.
  7330             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7331         16  CL-CLAIM-TYPE           PIC X.
  7332*            88  AH-CLAIM               VALUE 'A'.
  7333*            88  LIFE-CLAIM             VALUE 'L'.
  7334*            88  PROPERTY-CLAIM         VALUE 'P'.
  7335*            88  IUI-CLAIM              VALUE 'I'.
  7336*            88  GAP-CLAIM              VALUE 'G'.
  7337         16  CL-CLAIM-PREM-TYPE      PIC X.
  7338             88  SINGLE-PREMIUM         VALUE '1'.
  7339             88  O-B-COVERAGE           VALUE '2'.
  7340             88  OPEN-END-COVERAGE      VALUE '3'.
  7341         16  CL-INCURRED-DT          PIC XX.
  7342         16  CL-REPORTED-DT          PIC XX.
  7343         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7344         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7345         16  CL-LAST-PMT-DT          PIC XX.
  7346         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7347         16  CL-PAID-THRU-DT         PIC XX.
  7348         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7349         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7350         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7351         16  CL-PMT-CALC-METHOD      PIC X.
  7352             88  CL-360-DAY-YR          VALUE '1'.
  7353             88  CL-365-DAY-YR          VALUE '2'.
  7354             88  CL-FULL-MONTHS         VALUE '3'.
  7355         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 136
* EL050.cbl
  7356
  7357         16  CL-PRIME-CERT-NO.
  7358             20  CL-PRIME-CERT-PRIME PIC X(10).
  7359             20  CL-PRIME-CERT-SFX   PIC X.
  7360
  7361         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7362             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7363             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7364
  7365         16  CL-MICROFILM-NO         PIC X(10).
  7366         16  CL-PROG-FORM-TYPE       PIC X.
  7367         16  CL-LAST-ADD-ON-DT       PIC XX.
  7368
  7369         16  CL-LAST-REOPEN-DT       PIC XX.
  7370         16  CL-LAST-CLOSE-DT        PIC XX.
  7371         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7372             88  FINAL-PAID             VALUE '1'.
  7373             88  CLAIM-DENIED           VALUE '2'.
  7374             88  AUTO-CLOSE             VALUE '3'.
  7375             88  MANUAL-CLOSE           VALUE '4'.
  7376             88  BENEFITS-CHANGED       VALUE 'C'.
  7377             88  SETUP-ERRORS           VALUE 'E'.
  7378         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7379         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7380         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7381             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7382         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7383         16  FILLER                  PIC X.
  7384
  7385     12  CL-CERTIFICATE-DATA.
  7386         16  CL-CERT-ORIGIN          PIC X.
  7387             88  CERT-WAS-ONLINE        VALUE '1'.
  7388             88  CERT-WAS-CREATED       VALUE '2'.
  7389             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7390         16  CL-CERT-KEY-DATA.
  7391             20  CL-CERT-CARRIER     PIC X.
  7392             20  CL-CERT-GROUPING    PIC X(6).
  7393             20  CL-CERT-STATE       PIC XX.
  7394             20  CL-CERT-ACCOUNT.
  7395                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7396                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7397             20  CL-CERT-EFF-DT      PIC XX.
  7398
  7399     12  CL-STATUS-CONTROLS.
  7400         16  CL-PRIORITY-CD          PIC X.
  7401             88  CONFIDENTIAL-DATA      VALUE '8'.
  7402             88  HIGHEST-PRIORITY       VALUE '9'.
  7403         16  CL-SUPV-ATTN-CD         PIC X.
  7404             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7405             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7406         16  CL-PURGED-DT            PIC XX.
  7407         16  CL-RESTORED-DT          PIC XX.
  7408         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7409         16  CL-NEXT-RESEND-DT       PIC XX.
  7410         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7411         16  CL-CRITICAL-PERIOD      PIC 99.
  7412*        16  FILLER                  PIC XX.
  7413         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 137
* EL050.cbl
  7414         16  CL-LAST-MAINT-USER      PIC X(4).
  7415         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7416         16  CL-LAST-MAINT-TYPE      PIC X.
  7417             88  CLAIM-SET-UP           VALUE ' '.
  7418             88  PAYMENT-MADE           VALUE '1'.
  7419             88  LETTER-SENT            VALUE '2'.
  7420             88  MASTER-WAS-ALTERED     VALUE '3'.
  7421             88  MASTER-WAS-RESTORED    VALUE '4'.
  7422             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7423             88  FILE-CONVERTED         VALUE '6'.
  7424             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7425             88  ERROR-CORRECTION       VALUE 'E'.
  7426         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7427         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7428         16  CL-BENEFICIARY          PIC X(10).
  7429         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7430         16  CL-DENIAL-TYPE          PIC X.
  7431             88  CL-TYPE-DENIAL          VALUE '1'.
  7432             88  CL-TYPE-RESCISSION      VALUE '2'.
  7433             88  CL-TYPE-REFORMATION     VALUE '3'.
  7434             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7435             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7436         16  CL-CRIT-PER-RECURRENT   PIC X.
  7437         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7438         16  CL-RTW-DT               PIC XX.
  7439
  7440     12  CL-TRAILER-CONTROLS.
  7441         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7442             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7443             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7444             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7445         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7446         16  FILLER                  PIC XX.
  7447         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7448         16  CL-ADDRESS-TRAILER-CNT.
  7449             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7450                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7451             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7452                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7453             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7454                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7455             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7456                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7457             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7458                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7459             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7460                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7461             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7462                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7463
  7464     12  CL-CV-REFERENCE-NO.
  7465         16  CL-CV-REFNO-PRIME       PIC X(18).
  7466         16  CL-CV-REFNO-SFX         PIC XX.
  7467
  7468     12  CL-FILE-LOCATION            PIC X(4).
  7469
  7470     12  CL-PROCESS-ERRORS.
  7471         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 138
* EL050.cbl
  7472             88  NO-FATAL-ERRORS        VALUE ZERO.
  7473         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7474             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7475
  7476     12  CL-PRODUCT-CD               PIC X.
  7477
  7478     12  CL-CURRENT-KEY-DATA.
  7479         16  CL-CURRENT-CARRIER      PIC X.
  7480         16  CL-CURRENT-GROUPING     PIC X(6).
  7481         16  CL-CURRENT-STATE        PIC XX.
  7482         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7483
  7484     12  CL-ASSOCIATES               PIC X.
  7485         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7486         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7487         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7488         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7489
  7490     12  CL-ACTIVITY-CODE            PIC 99.
  7491     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7492     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7493
  7494     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7495     12  CL-LAG-REPORT-CODE          PIC 9.
  7496     12  CL-LOAN-TYPE                PIC XX.
  7497     12  CL-LEGAL-STATE              PIC XX.
  7498
  7499     12  CL-YESNOSW                  PIC X.
  7500     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7501         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7502         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7503         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7504     12  cl-insured-claim            pic x.
  7505         88  cl-claim-on-primary         value 'P'.
  7506         88  cl-claim-on-secondary       value 'S'.
  7507     12  cl-benefit-expiration-dt    PIC XX.
  7508
  7509 01  PLAN-RECORDS.
  7510     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7511     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7512
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 139
* EL050.cbl
  7514 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7515                          ACCOUNT-MASTER REINSURANCE-RECORD
  7516                          COMM-TABLE-RECORD FORM-MASTER
  7517                          CLAIM-MASTER PLAN-RECORDS.
  7518 0000-DFHEXIT SECTION.
  7519     MOVE '9#                    $   ' TO DFHEIV0.
  7520     MOVE 'EL050' TO DFHEIV1.
  7521     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7522
  7523     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7524
  7525
  7526* EXEC CICS  HANDLE CONDITION
  7527*           ERROR    (9300-ABEND)
  7528*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7529*    END-EXEC.
  7530*    MOVE '"$.J                  ! " #00007521' TO DFHEIV0
  7531     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7532     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7533     MOVE X'2220233030303037353231' TO DFHEIV0(25:11)
  7534     CALL 'kxdfhei1' USING DFHEIV0
  7535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7536
  7537
  7538 0000-COPY-PROCEDURE-DIV.
  7539*                          COPY ELC50PD.
  7540******************************************************************
  7541*                                                                *
  7542*                            ELC50PD                             *
  7543*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7544*                            VMOD=2.188                          *
  7545*                                                                *
  7546******************************************************************
  7547*                   C H A N G E   L O G
  7548*
  7549* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7550*-----------------------------------------------------------------
  7551*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7552* EFFECTIVE    NUMBER
  7553*-----------------------------------------------------------------
  7554* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7555* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7556* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7557*                             2709 AND 2718
  7558* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7559* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7560* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7561* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7562* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7563*                                IS OPEN OR CNC DT < PD THRU
  7564* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7565* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7566* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7567* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7568* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7569* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7570* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7571* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 140
* EL050.cbl
  7572* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7573* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7574* 020906                   PEMA  EXPAND LOAN OFFICER
  7575* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7576* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7577* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7578* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7579* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7580* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7581* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7582* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7583* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7584* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7585* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7586* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7587* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7588* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7589* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7590* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7591* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7592* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7593* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7594* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7595* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7596* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7597* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7598* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7599* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7600*                                UPDATE VIN ON CERT TRAILER
  7601* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7602* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7603* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7604* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7605* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7606* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7607* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7608* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7609* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7610* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7611* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7612* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7613* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7614* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7615* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7616* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7617* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7618* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7619* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7620* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7621* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7622* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7623* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7624* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7625* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7626* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7627* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7628* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7629* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 141
* EL050.cbl
  7630* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7631* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7632* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7633* 032912  CR2011110200001  PEMA  AHL CHANGES
  7634* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7635* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7636* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7637* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7638* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7639* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7640* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7641* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7642* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7643* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7644* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7645* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7646* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7647* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7648******************************************************************
  7649************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7650******************************************************************
  7651
  7652     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7653
  7654     MOVE SPACES                 TO PB-FATAL-FLAG
  7655                                    PB-FORCE-ER-CD
  7656                                    PB-WARN-ER-CD
  7657                                    PB-OUT-BAL-CD.
  7658
  7659     MOVE SPACE                  TO WS-IG-OVRD-AH
  7660                                    WS-IG-OVRD-LF
  7661                                    WS-IG-OVRD-AM
  7662                                    WS-IG-OVRD
  7663                                    WS-IG-OVRD-AH-PL
  7664                                    WS-IG-OVRD-LF-PL
  7665                                    WS-IG-OVRD-AH-BEN
  7666                                    WS-IG-OVRD-LF-BEN.
  7667
  7668******************************************************************
  7669*************       INITIALIZE COMMON ERRORS       ***************
  7670******************************************************************
  7671
  7672     MOVE +0                     TO PB-NO-OF-ERRORS.
  7673     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7674
  7675******************************************************************
  7676
  7677     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7678     SET JULIAN-TO-BIN           TO TRUE.
  7679*    MOVE 5                      TO DC-OPTION-CODE.
  7680     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7681     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7682
  7683     MOVE ZERO                   TO  SUB4.
  7684
  7685 0040-INITIALIZE-GA-BILL-DT.
  7686
  7687     ADD +1                      TO  SUB4.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 142
* EL050.cbl
  7688
  7689     IF  SUB4 GREATER THAN +5
  7690         GO TO 0050-CHECK-CNTL-FOUND.
  7691
  7692     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7693         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7694
  7695     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7696
  7697 0050-CHECK-CNTL-FOUND.
  7698
  7699     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7700        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7701                                         WS-AH-REM-TERM-CALC
  7702                                         EC-CO-REM-TERM-CALC
  7703        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7704        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7705        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7706                                         WS-TOL-AH-CLAIM
  7707        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7708                                         WS-TOL-AH-PREM
  7709                                         EC-CO-TOL-PREM
  7710        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7711                                         WS-TOL-AH-REFUND
  7712                                         EC-CO-TOL-REFUND
  7713        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7714                                         WS-AH-REFUND-OVS-AMT
  7715                                         EC-CO-OVR-SHT-AMT
  7716        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7717                                         WS-TOL-AH-PREM-PCT
  7718                                         EC-CO-TOL-PREM-PCT
  7719        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7720                                         WS-TOL-AH-REFUND-PCT
  7721                                         EC-CO-TOL-REFUND-PCT
  7722        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7723                                         WS-AH-REFUND-OVS-PCT
  7724                                         EC-CO-OVR-SHT-PCT
  7725        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7726        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7727        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7728        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7729        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7730        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7731        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7732        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7733        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7734        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7735        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7736        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7737                                         EC-CO-MONTH-END-DT
  7738        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7739          GO TO 0100-READ-ACCT.
  7740
  7741     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7742     MOVE SPACES                 TO CNTL-ACCESS.
  7743     MOVE '1'                    TO CNTL-REC-TYPE.
  7744     MOVE +0                     TO CNTL-SEQ-NO.
  7745
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 143
* EL050.cbl
  7746     MOVE '1' TO RC-SW-1.
  7747     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7748     IF NOT CF-COMPANY-MASTER
  7749         MOVE ZEROS             TO WK-CO-TOL-PREM
  7750                                   WK-CO-TOL-CLAIM
  7751                                   WK-CO-TOL-REFUND
  7752                                   WK-REFUND-OVS-AMT
  7753                                   WK-REFUND-OVS-PCT
  7754                                   WK-CO-TOL-PREM-PCT
  7755                                   WK-CO-TOL-REFUND-PCT
  7756                                   WK-DEFAULT-APR
  7757                                   WK-CO-MAX-CAP
  7758        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7759                                   WK-CR-R78-METHOD
  7760                                   WK-CO-REF-REJECT-SW
  7761                                   WK-CO-PREM-REJECT-SW
  7762                                   WK-REM-TRM-CALC-OPTION
  7763                                   WK-BIRTH-DATE-INPUT
  7764                                   WK-JOINT-AGE-INPUT
  7765        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7766        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7767        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7768        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7769          GO TO 0099-COMPANY-NOT-FOUND.
  7770
  7771     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7772        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7773     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7774        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7775     IF CF-CO-TOL-CAP NOT NUMERIC
  7776        MOVE +0                    TO CF-CO-TOL-CAP.
  7777     IF CF-DEFAULT-APR NOT NUMERIC
  7778        MOVE +0                    TO CF-DEFAULT-APR.
  7779
  7780     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7781     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7782     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7783     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7784     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7785     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7786     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7787     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7788     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7789     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7790     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7791     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7792
  7793     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7794          CF-CO-OVR-SHT-AMT > +0
  7795        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7796
  7797     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7798          CF-CO-OVR-SHT-PCT > +0
  7799        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7800
  7801     IF CF-VALID-REM-TRM-OPTION
  7802         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7803     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 144
* EL050.cbl
  7804         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7805
  7806     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7807     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7808     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7809     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7810
  7811     GO TO 0050-CHECK-CNTL-FOUND.
  7812
  7813 0099-COMPANY-NOT-FOUND.
  7814
  7815     MOVE ER-2616                TO WS-ERROR.
  7816     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7817
  7818 0100-READ-ACCT.
  7819
  7820     MOVE SPACES                 TO DATE-RANGE-SW.
  7821
  7822     IF WK-ACCT-ADDR = ZEROS
  7823        GO TO 0102-ACCT-GETMAIN.
  7824
  7825     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7826     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7827     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7828
  7829     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7830        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7831        GO TO 0105-READ-ACCT
  7832     END-IF
  7833
  7834     IF PB-CARRIER NOT = SPACES
  7835        IF PB-CARRIER NOT = AM-VG-CARRIER
  7836           GO TO 0105-READ-ACCT.
  7837
  7838     IF PB-STATE NOT = SPACES
  7839        IF PB-STATE NOT = AM-VG-STATE
  7840           GO TO 0105-READ-ACCT.
  7841
  7842     IF PB-GROUPING NOT = SPACES
  7843        IF PB-GROUPING NOT = AM-VG-GROUPING
  7844           GO TO 0105-READ-ACCT.
  7845
  7846     MOVE 'X'                 TO DATE-RANGE-SW.
  7847
  7848     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7849        MOVE 'X'                 TO DATE-RANGE-SW
  7850        GO TO 0105-READ-ACCT.
  7851
  7852     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7853        GO TO 0105-READ-ACCT.
  7854
  7855     GO TO 0180-ACCOUNT-FOUND.
  7856
  7857 0102-ACCT-GETMAIN.
  7858     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7859     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7860
  7861 0105-READ-ACCT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 145
* EL050.cbl
  7862     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7863     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7864     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7865     MOVE PB-STATE               TO ACCT-STATE.
  7866     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7867     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7868
  7869     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7870
  7871     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7872
  7873 0110-FIND-ACCT-TOLERANCES-LOOP.
  7874     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7875
  7876     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7877        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7878        GO TO 0199-ACCT-NOT-FOUND
  7879     END-IF
  7880     IF PB-CARRIER NOT = SPACES
  7881        IF PB-CARRIER NOT = AM-VG-CARRIER
  7882           GO TO 0199-ACCT-NOT-FOUND.
  7883
  7884     IF PB-STATE NOT = SPACES
  7885        IF PB-STATE NOT = AM-VG-STATE
  7886           GO TO 0199-ACCT-NOT-FOUND.
  7887
  7888     IF PB-GROUPING NOT = SPACES
  7889        IF PB-GROUPING NOT = AM-VG-GROUPING
  7890           GO TO 0199-ACCT-NOT-FOUND.
  7891
  7892     MOVE 'X'                    TO DATE-RANGE-SW.
  7893
  7894     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7895        MOVE 'X'                 TO DATE-RANGE-SW
  7896        GO TO 0199-ACCT-NOT-FOUND.
  7897
  7898     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7899        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7900
  7901 0180-ACCOUNT-FOUND.
  7902     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7903     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7904     MOVE AM-STATE               TO PB-SV-STATE.
  7905     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7906
  7907     IF AM-CANCEL-FEE  NOT NUMERIC
  7908        MOVE ZEROS TO AM-CANCEL-FEE.
  7909
  7910     IF AM-MAX-MON-BEN NOT NUMERIC
  7911        MOVE ZEROS TO AM-MAX-MON-BEN.
  7912
  7913     IF AM-MAX-TOT-BEN NOT NUMERIC
  7914        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7915
  7916     IF AM-CLP-TOL-PCT NOT NUMERIC
  7917        MOVE +0                  TO AM-CLP-TOL-PCT
  7918     END-IF
  7919     IF AM-SPP-LEASE-COMM NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 146
* EL050.cbl
  7920        MOVE +0                  TO AM-SPP-LEASE-COMM
  7921     END-IF
  7922     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7923        MOVE ER-2611             TO   WS-ERROR
  7924        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7925
  7926     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7927        MOVE ER-2621             TO   WS-ERROR
  7928        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7929
  7930     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7931        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7932        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7933        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7934         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7935
  7936     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7937     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7938     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7939     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7940     IF AM-CLP-TOL-PCT NOT = ZEROS
  7941        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7942     END-IF
  7943     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7944        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7945     END-IF
  7946*    IF PB-COMPANY-ID = 'DCC'
  7947*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7948*                                   WS-ADMIN-FEES
  7949*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7950*          (SUB5 > +10)
  7951*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7952*             AND (AM-A-COM (SUB5) NUMERIC)
  7953*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7954*                + (AM-A-COM (SUB5) * 1000)
  7955*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7956*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7957*                + (AM-A-COM (SUB5) * 1000)
  7958*             END-IF
  7959*             IF AM-COM-TYP (SUB5) = 'N'
  7960*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7961*                + (AM-A-COM (SUB5) * 1000)
  7962*             END-IF
  7963*          END-IF
  7964*       END-PERFORM
  7965*    END-IF
  7966     IF (PB-COMPANY-ID = 'DCC')
  7967        AND (PB-ISSUE)
  7968        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7969        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7970           (SUB5 > +10)
  7971           MOVE +0 TO WS-WK-RATE
  7972           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7973              IF (AM-A-COM (SUB5) NUMERIC)
  7974                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7975                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7976              ELSE
  7977                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 147
* EL050.cbl
  7978                 IF PB-ISSUE
  7979                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7980                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7981                 ELSE
  7982                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7983                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7984                 END-IF
  7985                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7986                 MOVE ZEROS             TO WS-SUB1
  7987                                           WS-COMMISSION
  7988                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7989                 MOVE '0530'               TO CTBL-SW
  7990                 MOVE ' '                  TO WS-CTBL-READ-SW
  7991                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7992                 IF FIRST-TIME-THROUGH
  7993                    MOVE 'AA'              TO CTBL-BEN-CODE
  7994                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7995                 END-IF
  7996                 IF CTBL-TABLE-FOUND
  7997                    IF PB-ISSUE
  7998                       COMPUTE WS-COMM-CK-AMT =
  7999                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8000                    ELSE
  8001                       COMPUTE WS-COMM-CK-AMT =
  8002                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8003                    END-IF
  8004                    PERFORM 8800-GET-COMP-RATE
  8005                              THRU 8800-EXIT
  8006                 END-IF
  8007              END-IF
  8008              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8009                + (WS-WK-RATE * 1000)
  8010           END-IF
  8011        END-PERFORM
  8012     END-IF
  8013     IF PB-COMPANY-ID EQUAL 'CRI'
  8014         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8015
  8016     IF PB-COMPANY-ID EQUAL 'NCL'
  8017         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8018     END-IF
  8019
  8020     GO TO 0200-READ-CERT.
  8021
  8022 0199-ACCT-NOT-FOUND.
  8023
  8024     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8025
  8026     IF DATE-RANGE-SW NOT = SPACES
  8027        MOVE ER-2601             TO WS-ERROR
  8028        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8029     ELSE
  8030        MOVE ER-2619             TO WS-ERROR
  8031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8032
  8033     GO TO 9990-RETURN.
  8034
  8035 0200-READ-CERT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 148
* EL050.cbl
  8036
  8037     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8038     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8039     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8040     MOVE PB-SV-STATE            TO CERT-STATE.
  8041     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8042     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8043     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8044
  8045     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8046
  8047     IF CERT-WAS-NOT-FOUND
  8048        GO TO 0299-CERT-NOT-FOUND.
  8049
  8050     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8051        MOVE ER-2759             TO WS-ERROR
  8052        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8053        GO TO 0298-UNLOCK-RETURN.
  8054
  8055     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8056         MOVE ER-2758            TO WS-ERROR
  8057         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8058         GO TO 0298-UNLOCK-RETURN.
  8059
  8060     IF PB-ISSUE
  8061        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8062           IF CERT-WAS-CREATED-FOR-CLAIM
  8063              NEXT SENTENCE
  8064            ELSE
  8065              MOVE ER-2626       TO WS-ERROR
  8066              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8067              GO TO 0298-UNLOCK-RETURN.
  8068
  8069     IF NOT PB-CANCELLATION
  8070        GO TO 0300-CONTINUE-EDIT.
  8071
  8072     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8073     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8074     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8075     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8076     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8077     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8078
  8079     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8080     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8081     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8082     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8083     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8084     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8085     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8086     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8087     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8088
  8089     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8090     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8091     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8092     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8093     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 149
* EL050.cbl
  8094     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8095     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8096
  8097     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8098     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8099
  8100     MOVE CM-CREDIT-INTERFACE-SW-1
  8101                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8102     MOVE CM-CREDIT-INTERFACE-SW-2
  8103                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8104
  8105     IF CM-O-B-COVERAGE
  8106         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8107
  8108     IF CM-LIVES NOT NUMERIC
  8109         MOVE ZERO                TO CM-LIVES.
  8110
  8111     IF CM-BILLED NOT NUMERIC
  8112         MOVE ZERO                TO CM-BILLED.
  8113
  8114     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8115         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8116         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8117         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8118         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8119         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8120         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8121         MOVE CM-LIVES             TO PB-CI-LIVES
  8122*The next line causes a problem with my change  I dont think it is
  8123*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8124
  8125     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8126     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8127     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8128     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8129     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8130     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8131
  8132     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8133     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8134     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8135     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8136
  8137     IF CM-LIFE-COMM-PCT NUMERIC
  8138         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8139     ELSE
  8140         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8141
  8142     IF CM-AH-COMM-PCT NUMERIC
  8143         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8144     ELSE
  8145         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8146
  8147     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8148
  8149     IF CM-LOAN-APR       NOT NUMERIC
  8150           MOVE ZERO               TO CM-LOAN-APR.
  8151
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 150
* EL050.cbl
  8152     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8153           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8154
  8155     IF CM-LOAN-TERM      NOT NUMERIC
  8156           MOVE ZERO               TO CM-LOAN-TERM.
  8157
  8158     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8159           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8160
  8161     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8162           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8163
  8164     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8165     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8166     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8167     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8168     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8169     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8170     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8171     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8172     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8173     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8174     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8175     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8176
  8177     IF CM-STATE = CM-SSN-STATE
  8178         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8179
  8180     IF CM-STATE NOT = CM-MEMB-STATE
  8181         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8182
  8183     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8184
  8185     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8186        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8187        IF CM-ADDL-CLP NOT NUMERIC
  8188           MOVE +0               TO CM-ADDL-CLP
  8189        END-IF
  8190        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8191        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8192           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8193        END-IF
  8194     END-IF
  8195     IF PB-COMPANY-ID = 'DCC'
  8196        MOVE +0                  TO WS-ADMIN-FEES
  8197                                    WS-CSO-ADMIN-FEE
  8198                                    WS-COMM-AND-MFEE
  8199                                    WS-1ST-YR-ALLOW
  8200        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8201           (SUB5 > +10)
  8202           MOVE +0 TO WS-WK-RATE
  8203           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8204              IF (AM-A-COM (SUB5) NUMERIC)
  8205                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8206                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8207              ELSE
  8208                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8209                 IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 151
* EL050.cbl
  8210                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8211                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8212                 ELSE
  8213                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8214                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8215                 END-IF
  8216                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8217                 MOVE ZEROS             TO WS-SUB1
  8218                                           WS-COMMISSION
  8219                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8220                 MOVE '0530'               TO CTBL-SW
  8221                 MOVE ' '                  TO WS-CTBL-READ-SW
  8222                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8223                 IF FIRST-TIME-THROUGH
  8224                    MOVE 'AA'              TO CTBL-BEN-CODE
  8225                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8226                 END-IF
  8227                 IF CTBL-TABLE-FOUND
  8228                    IF PB-ISSUE
  8229                       COMPUTE WS-COMM-CK-AMT =
  8230                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8231                    ELSE
  8232                       COMPUTE WS-COMM-CK-AMT =
  8233                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8234                    END-IF
  8235                    PERFORM 8800-GET-COMP-RATE
  8236                              THRU 8800-EXIT
  8237                 END-IF
  8238              END-IF
  8239              IF AM-COM-TYP (SUB5) = 'I'
  8240                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8241                   + (WS-WK-RATE * 1000)
  8242              END-IF
  8243              IF AM-COM-TYP (SUB5) = 'N'
  8244                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8245                   + (WS-WK-RATE * 1000)
  8246              END-IF
  8247              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8248                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8249                   + (WS-WK-RATE * 1000)
  8250              END-IF
  8251              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8252                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8253                   + (WS-WK-RATE * 1000)
  8254              END-IF
  8255           END-IF
  8256        END-PERFORM
  8257     END-IF
  8258     GO TO 0300-CONTINUE-EDIT.
  8259
  8260 0298-UNLOCK-RETURN.
  8261      PERFORM 9250-UNLOCK-RETURN
  8262      GO TO 9990-RETURN.
  8263
  8264 0299-CERT-NOT-FOUND.
  8265
  8266     MOVE '1'                     TO CERT-STATUS-SW.
  8267
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 152
* EL050.cbl
  8268     IF PB-COMPANY-ID = 'UCL'
  8269         IF WS-ERROR = ER-2799
  8270             GO TO 3000-CONTINUE-EDIT.
  8271
  8272     IF NOT PB-CANCELLATION
  8273         GO TO 0300-CONTINUE-EDIT.
  8274
  8275     MOVE ER-2726                  TO  WS-ERROR.
  8276     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8277     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8278     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8279                                    PB-CI-LF-TERM
  8280                                    PB-C-LF-REM-TERM
  8281                                    PB-CI-AH-TERM
  8282                                    PB-C-AH-REM-TERM
  8283                                    PB-CI-LF-BENEFIT-CD
  8284                                    PB-CI-LF-BENEFIT-AMT
  8285                                    PB-CI-LF-ALT-BENEFIT-AMT
  8286                                    PB-CI-LF-PREMIUM-AMT
  8287                                    PB-CI-LF-ALT-PREMIUM-AMT
  8288                                    PB-CI-AH-BENEFIT-CD
  8289                                    PB-CI-AH-BENEFIT-AMT
  8290                                    PB-CI-AH-PREMIUM-AMT
  8291                                    PB-CI-PAY-FREQUENCY
  8292                                    PB-CI-LOAN-APR
  8293                                    PB-CI-LOAN-TERM
  8294                                    PB-CI-LIFE-COMMISSION
  8295                                    PB-CI-AH-COMMISSION
  8296                                    PB-CI-CURR-SEQ
  8297                                    PB-CI-AH-CANCEL-AMT
  8298                                    PB-CI-LF-CANCEL-AMT
  8299                                    PB-CI-RATE-DEV-PCT-LF
  8300                                    PB-CI-RATE-DEV-PCT-AH
  8301                                    PB-CI-EXTENTION-DAYS
  8302                                    PB-CI-TERM-IN-DAYS
  8303                                    PB-CI-LIVES
  8304                                    PB-CI-LF-CRIT-PER
  8305                                    PB-CI-AH-CRIT-PER
  8306                                    PB-CI-ADDL-CLP
  8307                                    PB-CI-DDF-IU-RATE-UP.
  8308
  8309     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8310                                    PB-CI-AH-SETTLEMENT-DT
  8311                                    PB-CI-DEATH-DT
  8312                                    PB-CI-LF-PRIOR-CANCEL-DT
  8313                                    PB-CI-AH-PRIOR-CANCEL-DT
  8314                                    PB-CI-ENTRY-DT
  8315                                    PB-CI-LF-EXPIRE-DT
  8316                                    PB-CI-AH-EXPIRE-DT
  8317                                    PB-CI-LOAN-1ST-PMT-DT.
  8318
  8319     IF ACCOUNT-MAST-FOUND
  8320        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8321        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8322
  8323     GO TO 3000-CONTINUE-EDIT.
  8324
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 153
* EL050.cbl
  8326
  8327 0300-CONTINUE-EDIT.
  8328
  8329     IF PB-ISSUE
  8330        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8331            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8332
  8333     IF PB-ISSUE
  8334        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8335            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8336
  8337     IF PB-ISSUE
  8338       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8339          (AM-NO-AH-ONLY)
  8340           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8341               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8342                   MOVE ER-2679 TO WS-ERROR
  8343                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8344
  8345     IF PB-ISSUE
  8346        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8347        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8348        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8349     ELSE
  8350        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8351        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8352        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8353
  8354     MOVE 'N'                    TO PLAN-MASTER-SW
  8355                                    PLAN-MASTER-LIFE-SW
  8356                                    FORM-MASTER-SW
  8357                                    WS-APP-CERT-SW.
  8358
  8359     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8360                                    WS-PL-TOL-LF-REFUND
  8361                                    WS-PL-REF-OVS-AMT
  8362                                    WS-PL-TOL-LF-PREM-PCT
  8363                                    WS-PL-TOL-LF-REFUND-PCT
  8364                                    WS-PL-REF-OVS-PCT
  8365                                    WS-PL-TOL-LF-CLAIM.
  8366
  8367     IF PB-COMPANY-ID = 'NCL'
  8368       IF PB-ISSUE
  8369         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8370             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8371             IF FORM-MASTER-FOUND
  8372                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8373
  8374     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8375        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8376
  8377********************** MON CODE **********************
  8378     IF PB-COMPANY-ID = 'MON'
  8379     IF PB-ISSUE
  8380     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8381        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8382             PB-I-LOAN-APR = ZERO)
  8383               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 154
* EL050.cbl
  8384******************************************************
  8385
  8386     IF PB-COMPANY-ID = 'NCL'
  8387       IF PB-ISSUE
  8388           IF FORM-MASTER-FOUND
  8389             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8390                AM-DISMBR-COVERAGE
  8391                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8392                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8393                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8394                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8395                                           PB-I-LIFE-BENEFIT-CD.
  8396
  8397     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8398
  8399     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8400         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8401         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8402         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8403         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8404         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8405           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8406             GO TO 0301-LIFE-BENEFIT-SEARCH
  8407         ELSE
  8408             NEXT SENTENCE
  8409     ELSE
  8410         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8411
  8412     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8413     MOVE '4'                    TO CNTL-REC-TYPE.
  8414     MOVE +0                     TO CNTL-SEQ-NO.
  8415     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8416
  8417     MOVE '1' TO RC-SW-2.
  8418     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8419
  8420     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8421        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8422         GO TO 0305-BENEFIT-NOT-FOUND.
  8423
  8424     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8425
  8426 0301-LIFE-BENEFIT-SEARCH.
  8427
  8428     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8429
  8430     IF NO-BENEFIT-FOUND
  8431        GO TO 0305-BENEFIT-NOT-FOUND.
  8432
  8433     IF WS-BEN-CD = '99'
  8434        GO TO 0305-BENEFIT-NOT-FOUND.
  8435
  8436     IF PB-COMPANY-ID = 'NCL'
  8437         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8438             GO TO 0304-LIFE-BENEFIT-FOUND.
  8439
  8440     MOVE +1                     TO SUB5.
  8441     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 155
* EL050.cbl
  8442
  8443* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8444* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8445     IF PB-COMPANY-ID = 'DMD'
  8446         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8447
  8448 0302-EDIT-ACCT-LF-BENEFITS.
  8449
  8450     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8451        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8452           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8453                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8454           GO TO 03XX-GET-LIFE-ERPLAN.
  8455
  8456     IF SUB5 LESS THAN +20
  8457        ADD +1                   TO SUB5
  8458        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8459
  8460     MOVE +1                     TO SUB5.
  8461
  8462     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8463        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8464
  8465 0303-EDIT-DMD-EXTRA-BENEFITS.
  8466
  8467     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8468        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8469           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8470                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8471           GO TO 03XX-GET-LIFE-ERPLAN.
  8472
  8473     IF SUB5 LESS THAN +30
  8474        ADD +1                   TO SUB5
  8475        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8476
  8477     MOVE +1                     TO SUB5.
  8478
  8479 03XX-EDIT-FOR-NINETY-LF.
  8480
  8481***************************************************************
  8482*                                                             *
  8483*    NINETY BENEFIT PLAN TYPES:                               *
  8484*                                                             *
  8485*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8486*      92 = ALL GROUP REDUCING BENEFITS                       *
  8487*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8488*      94 = ALL GROUP LEVEL BENEFITS                          *
  8489*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8490*           BENEFIT CONTROLS.                                 *
  8491*      99 = ALL BENEFITS                                      *
  8492*                                                             *
  8493***************************************************************
  8494
  8495     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8496                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8497
  8498     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8499       AND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 156
* EL050.cbl
  8500        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8501        GO TO 03XX-GET-LIFE-ERPLAN.
  8502
  8503     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8504       AND
  8505        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8506        IF CF-REDUCING (SUB3)
  8507           IF (PB-I-INDV-GRP-OVRD = 'I')
  8508              OR
  8509           ((AM-IG = '1') AND
  8510           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8511              OR
  8512           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8513           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8514           (AM-IG NOT = '2'))
  8515              GO TO 03XX-GET-LIFE-ERPLAN.
  8516
  8517     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8518       AND
  8519        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8520        IF CF-REDUCING (SUB3)
  8521           IF (PB-I-INDV-GRP-OVRD = 'G')
  8522              OR
  8523           ((AM-IG = '2') AND
  8524           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8525              OR
  8526           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8527           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8528           (AM-IG NOT = '1'))
  8529              GO TO 03XX-GET-LIFE-ERPLAN.
  8530
  8531     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8532       AND
  8533        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8534        IF CF-LEVEL    (SUB3)
  8535           IF (PB-I-INDV-GRP-OVRD = 'I')
  8536              OR
  8537           ((AM-IG = '1') AND
  8538           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8539              OR
  8540           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8541           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8542            (AM-IG NOT = '2'))
  8543              GO TO 03XX-GET-LIFE-ERPLAN.
  8544
  8545     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8546       AND
  8547        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8548        IF CF-LEVEL    (SUB3)
  8549           IF (PB-I-INDV-GRP-OVRD = 'G')
  8550              OR
  8551           ((AM-IG = '2') AND
  8552           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8553              OR
  8554           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8555           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8556           (AM-IG NOT = '1'))
  8557              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 157
* EL050.cbl
  8558
  8559     IF SUB5 LESS THAN +20
  8560        ADD +1                   TO SUB5
  8561        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8562
  8563     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8564
  8565     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8566        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8567
  8568     MOVE +1                     TO SUB5.
  8569
  8570 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8571
  8572     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8573                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8574
  8575     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8576       AND
  8577        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8578        GO TO 03XX-GET-LIFE-ERPLAN.
  8579
  8580     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8581       AND
  8582        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8583        IF CF-REDUCING (SUB3)
  8584           IF (PB-I-INDV-GRP-OVRD = 'I')
  8585              OR
  8586           ((AM-IG = '1') AND
  8587           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8588              OR
  8589           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8590           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8591           (AM-IG NOT = '2'))
  8592              GO TO 03XX-GET-LIFE-ERPLAN.
  8593
  8594     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8595       AND
  8596        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8597        IF CF-REDUCING (SUB3)
  8598           IF (PB-I-INDV-GRP-OVRD = 'G')
  8599              OR
  8600           ((AM-IG = '2') AND
  8601           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8602              OR
  8603           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8604           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8605           (AM-IG NOT = '1'))
  8606              GO TO 03XX-GET-LIFE-ERPLAN.
  8607
  8608     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8609       AND
  8610        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8611        IF CF-LEVEL    (SUB3)
  8612           IF (PB-I-INDV-GRP-OVRD = 'I')
  8613              OR
  8614           ((AM-IG = '1') AND
  8615           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 158
* EL050.cbl
  8616              OR
  8617           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8618           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8619            (AM-IG NOT = '2'))
  8620              GO TO 03XX-GET-LIFE-ERPLAN.
  8621
  8622     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8623       AND
  8624        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8625        IF CF-LEVEL    (SUB3)
  8626           IF (PB-I-INDV-GRP-OVRD = 'G')
  8627              OR
  8628           ((AM-IG = '2') AND
  8629           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8630              OR
  8631           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8632           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8633           (AM-IG NOT = '1'))
  8634              GO TO 03XX-GET-LIFE-ERPLAN.
  8635
  8636     IF SUB5 LESS THAN +30
  8637        ADD +1                   TO SUB5
  8638        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8639
  8640     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8641
  8642 03XX-EDIT-FOR-NINETY-LF-CONT.
  8643
  8644     MOVE +99                    TO SUB5.
  8645
  8646     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8647        IF PB-ISSUE
  8648           MOVE ER-1924          TO  WS-ERROR
  8649           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8650
  8651     GO TO 0304-LIFE-BENEFIT-FOUND.
  8652
  8653 03XX-GET-LIFE-ERPLAN.
  8654
  8655     IF WK-PLAN-ADDR EQUAL +0
  8656        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8657
  8658     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8659     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8660     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8661     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8662     MOVE 'Y'                    TO PLAN-MASTER-SW
  8663                                    PLAN-MASTER-LIFE-SW.
  8664     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8665
  8666 03XX-ERPLAN-LIFE-GETMAIN.
  8667
  8668     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8669     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8670
  8671 03XX-ERPLAN-LIFE-READ.
  8672
  8673     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 159
* EL050.cbl
  8674     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8675     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8676     MOVE PB-SV-STATE            TO PLAN-STATE.
  8677     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8678     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8679     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8680     MOVE WS-SAVE-BENEFIT-REVISION
  8681                                 TO PLAN-REVISION-NO.
  8682
  8683     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8684     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8685
  8686     IF PB-COMPANY-ID = 'NCL'
  8687       IF NOT LF-PLAN-MASTER-FOUND
  8688         IF NOT PB-POLICY-IS-DECLINED  AND
  8689            NOT PB-POLICY-IS-VOIDED
  8690             MOVE  ER-1921         TO  WS-ERROR
  8691             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8692             GO TO 0304-LIFE-BENEFIT-FOUND.
  8693
  8694     IF NOT LF-PLAN-MASTER-FOUND
  8695        GO TO 0304-LIFE-BENEFIT-FOUND.
  8696
  8697 XXXX-CHECK-LF-PLAN-KEY.
  8698
  8699     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8700        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8701        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8702        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8703        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8704        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8705        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8706        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8707        MOVE 'N'                 TO PLAN-MASTER-SW
  8708          GO TO 03XX-ERPLAN-LIFE-READ.
  8709
  8710     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8711
  8712     IF  PB-CANCELLATION
  8713         GO TO  0303-LF-ACCT-BEN-FOUND.
  8714
  8715     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8716        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8717           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8718           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8719              MOVE ER-2644             TO WS-ERROR
  8720              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8721           ELSE
  8722              NEXT SENTENCE
  8723        ELSE
  8724           IF PB-COMPANY-ID NOT = 'NCL'
  8725              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8726                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8727
  8728 0303-LF-ACCT-BEN-FOUND.
  8729
  8730     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8731
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 160
* EL050.cbl
  8732     IF PL-DEV-CODE NOT = SPACES
  8733        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8734
  8735     IF PL-DEV-PCT NUMERIC AND
  8736        PL-DEV-PCT NOT = ZEROS
  8737        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8738
  8739     IF PL-TOL-PREM-AMT GREATER THAN +0
  8740        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8741
  8742     IF PL-TOL-REF-AMT GREATER THAN +0
  8743        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8744
  8745     IF PL-TOL-PREM-PCT GREATER THAN +0
  8746        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8747
  8748     IF PL-TOL-REF-PCT GREATER THAN +0
  8749        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8750
  8751     IF PL-TOL-CLM-AMT GREATER THAN +0
  8752        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8753
  8754     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8755                          PL-OVER-SHORT-AMT > +0
  8756        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8757
  8758     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8759                          PL-OVER-SHORT-PCT > +0
  8760        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8761
  8762     IF PL-SALES-TAX NUMERIC AND
  8763                          PL-SALES-TAX > +0
  8764         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8765
  8766     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8767        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8768                                    WS-IG-OVRD-AM.
  8769
  8770 0304-LIFE-BENEFIT-FOUND.
  8771
  8772     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8773
  8774     IF PB-ISSUE
  8775        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8776     ELSE
  8777        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8778
  8779     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8780     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8781     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8782     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8783     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8784                                         WS-LF-REFUND-CALC.
  8785
  8786     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8787        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8788
  8789     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 161
* EL050.cbl
  8790        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8791     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8792
  8793     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8794     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8795     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8796     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8797     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8798     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8799
  8800     IF PB-COMPANY-ID = 'NCL'  AND
  8801        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8802         NEXT SENTENCE
  8803     ELSE
  8804         IF SUB5 NOT GREATER THAN +20
  8805            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8806               MOVE WS-SAVE-BENEFIT-REM-TERM
  8807                                      TO WS-AM-LF-BENE-REM-TERM
  8808                                         EC-BR-LF-REM-TERM-CALC.
  8809
  8810     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8811     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8812
  8813     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8814
  8815 0305-BENEFIT-NOT-FOUND.
  8816
  8817     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8818     MOVE ER-2604                TO WS-ERROR.
  8819     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8820
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 162
* EL050.cbl
  8822
  8823 0310-FIND-AH-BENEFIT-RECORD.
  8824
  8825     MOVE 'N'                    TO PLAN-MASTER-SW
  8826                                    PLAN-MASTER-AH-SW.
  8827
  8828     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8829                                    WS-PL-TOL-AH-REFUND
  8830                                    WS-AH-PL-REF-OVS-AMT
  8831                                    WS-PL-TOL-AH-PREM-PCT
  8832                                    WS-PL-TOL-AH-REFUND-PCT
  8833                                    WS-AH-PL-REF-OVS-PCT
  8834                                    WS-PL-TOL-AH-CLAIM.
  8835     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8836
  8837
  8838     if pb-issue
  8839        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8840           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8841        end-if
  8842        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8843           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8844           GO TO 0399-BENEFIT-NOT-FOUND
  8845        end-if
  8846     end-if
  8847
  8848     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8849        GO TO 0400-FIND-CARRIER.
  8850
  8851     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8852
  8853     IF WK-AH-BEN-ADDR NOT = ZEROS
  8854         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8855         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8856         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8857         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8858           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8859             GO TO 0311-AH-BENEFIT-SEARCH
  8860         ELSE
  8861             NEXT SENTENCE
  8862     ELSE
  8863         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8864
  8865     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8866     MOVE '5'                    TO CNTL-REC-TYPE.
  8867     MOVE +0                     TO CNTL-SEQ-NO.
  8868     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8869
  8870     MOVE '2' TO RC-SW-2.
  8871     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8872
  8873     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8874        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8875          GO TO 0399-BENEFIT-NOT-FOUND.
  8876
  8877     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8878
  8879 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 163
* EL050.cbl
  8880
  8881     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8882
  8883     IF NO-BENEFIT-FOUND
  8884         GO TO 0399-BENEFIT-NOT-FOUND.
  8885
  8886     IF WS-BEN-CD = '99'
  8887        GO TO 0399-BENEFIT-NOT-FOUND.
  8888
  8889     IF PB-COMPANY-ID  =  'NCL'
  8890         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8891             GO TO 0314-A-H-BENEFIT-FOUND.
  8892
  8893     MOVE +1                     TO SUB5.
  8894     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8895
  8896* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8897* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8898     IF PB-COMPANY-ID = 'DMD'
  8899         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8900
  8901 0312-EDIT-ACCT-AH-BENEFITS.
  8902
  8903     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8904        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8905           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8906                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8907           GO TO 03XX-GET-AH-ERPLAN.
  8908
  8909     IF SUB5 LESS THAN +20
  8910        ADD +1                   TO SUB5
  8911        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8912
  8913     MOVE +1                     TO SUB5.
  8914
  8915     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8916        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8917
  8918 0313-EDIT-DMD-EXTRA-BENEFITS.
  8919
  8920     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8921        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8922           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8923                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8924           GO TO 03XX-GET-AH-ERPLAN.
  8925
  8926     IF SUB5 LESS THAN +30
  8927        ADD +1                   TO SUB5
  8928        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8929
  8930     MOVE +1                     TO SUB5.
  8931
  8932 03XX-EDIT-FOR-NINETY-AH.
  8933
  8934***************************************************************
  8935*                                                             *
  8936*    NINETY BENEFIT PLAN TYPES:                               *
  8937*                                                             *
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 164
* EL050.cbl
  8938*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8939*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8940*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8941*           BENEFIT CONTROLS.                                 *
  8942*      99 = ALL BENEFITS.                                     *
  8943*                                                             *
  8944***************************************************************
  8945
  8946     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8947                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8948
  8949     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8950       AND
  8951        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8952        GO TO 03XX-GET-AH-ERPLAN.
  8953
  8954     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8955       AND
  8956        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8957           IF (PB-I-INDV-GRP-OVRD = 'I')
  8958              OR
  8959           ((AM-IG = '1') AND
  8960           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8961              OR
  8962           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8963           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8964           (AM-IG NOT = '2'))
  8965              GO TO 03XX-GET-AH-ERPLAN.
  8966
  8967     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8968       AND
  8969        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8970           IF (PB-I-INDV-GRP-OVRD = 'G')
  8971              OR
  8972           ((AM-IG = '2') AND
  8973           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8974              OR
  8975           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8976           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8977           (AM-IG NOT = '1'))
  8978              GO TO 03XX-GET-AH-ERPLAN.
  8979
  8980     IF SUB5 LESS THAN +20
  8981        ADD +1                   TO SUB5
  8982        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8983
  8984     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8985        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8986
  8987     MOVE +1                    TO SUB5.
  8988
  8989 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8990
  8991     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8992                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8993
  8994     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8995       AND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 165
* EL050.cbl
  8996        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8997        GO TO 03XX-GET-AH-ERPLAN.
  8998
  8999     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9000       AND
  9001        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9002           IF (PB-I-INDV-GRP-OVRD = 'I')
  9003              OR
  9004           ((AM-IG = '1') AND
  9005           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9006              OR
  9007           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9008           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9009           (AM-IG NOT = '2'))
  9010              GO TO 03XX-GET-AH-ERPLAN.
  9011
  9012     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9013       AND
  9014        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9015           IF (PB-I-INDV-GRP-OVRD = 'G')
  9016              OR
  9017           ((AM-IG = '2') AND
  9018           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9019              OR
  9020           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9021           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9022           (AM-IG NOT = '1'))
  9023              GO TO 03XX-GET-AH-ERPLAN.
  9024
  9025     IF SUB5 LESS THAN +30
  9026        ADD +1                   TO SUB5
  9027        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9028
  9029 03XX-EDIT-FOR-NINETY-AH-CONT.
  9030
  9031     MOVE +99                    TO SUB5.
  9032
  9033     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9034
  9035     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9036        IF PB-ISSUE
  9037           MOVE ER-1925          TO  WS-ERROR
  9038           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9039
  9040     GO TO 0314-A-H-BENEFIT-FOUND.
  9041
  9042 03XX-GET-AH-ERPLAN.
  9043
  9044     IF WK-PLAN-ADDR EQUAL +0
  9045         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9046
  9047     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9048     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9049     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9050     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9051     MOVE 'Y'                    TO PLAN-MASTER-SW
  9052                                    PLAN-MASTER-AH-SW.
  9053*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 166
* EL050.cbl
  9054     GO TO 03XX-ERPLAN-AH-READ.
  9055
  9056 03XX-ERPLAN-AH-GETMAIN.
  9057
  9058     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9059     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9060
  9061 03XX-ERPLAN-AH-READ.
  9062
  9063     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9064     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9065     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9066     MOVE PB-SV-STATE            TO PLAN-STATE.
  9067     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9068     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9069     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9070     MOVE WS-SAVE-BENEFIT-REVISION
  9071                                 TO PLAN-REVISION-NO.
  9072
  9073     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9074     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9075
  9076     IF PB-COMPANY-ID = 'NCL'
  9077       IF NOT AH-PLAN-MASTER-FOUND
  9078         IF NOT PB-POLICY-IS-DECLINED  AND
  9079            NOT PB-POLICY-IS-VOIDED
  9080             MOVE  ER-1922         TO  WS-ERROR
  9081             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9082             GO TO 0314-A-H-BENEFIT-FOUND.
  9083
  9084     IF NOT AH-PLAN-MASTER-FOUND
  9085        GO TO 0314-A-H-BENEFIT-FOUND.
  9086
  9087 XXXX-CHECK-AH-PLAN-KEY.
  9088
  9089     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9090        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9091        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9092        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9093        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9094        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9095        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9096        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9097        MOVE 'N'                 TO PLAN-MASTER-SW
  9098          GO TO 03XX-ERPLAN-AH-READ.
  9099
  9100     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9101
  9102     IF  PB-CANCELLATION
  9103         GO TO  0313-AH-ACCT-BEN-FOUND.
  9104
  9105     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9106       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9107          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9108          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9109             MOVE ER-2644             TO WS-ERROR
  9110             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111          ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 167
* EL050.cbl
  9112             NEXT SENTENCE
  9113       ELSE
  9114          IF PB-COMPANY-ID NOT = 'NCL'
  9115             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9116                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9117
  9118 0313-AH-ACCT-BEN-FOUND.
  9119
  9120     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9121
  9122     IF PL-DEV-CODE NOT = SPACES
  9123        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9124
  9125     IF PL-DEV-PCT NUMERIC AND
  9126        PL-DEV-PCT NOT = ZEROS
  9127        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9128
  9129     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9130        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9131
  9132     IF PL-TOL-REF-AMT NOT EQUAL +0
  9133        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9134
  9135     IF PL-TOL-PREM-PCT GREATER THAN +0
  9136        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9137
  9138     IF PL-TOL-REF-PCT GREATER THAN +0
  9139        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9140
  9141     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9142        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9143
  9144     IF PL-OVER-SHORT-AMT NUMERIC AND
  9145                          PL-OVER-SHORT-AMT > +0
  9146        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9147
  9148     IF PL-OVER-SHORT-PCT NUMERIC AND
  9149                          PL-OVER-SHORT-PCT > +0
  9150        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9151
  9152     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9153        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9154        IF WS-IG-OVRD-AM EQUAL SPACES
  9155            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9156
  9157 0314-A-H-BENEFIT-FOUND.
  9158
  9159     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9160
  9161     IF PB-ISSUE
  9162        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9163       ELSE
  9164        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9165
  9166     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9167     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9168     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9169     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 168
* EL050.cbl
  9170                                         WS-AH-REFUND-CALC.
  9171
  9172     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9173        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9174
  9175     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9176        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9177     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9178
  9179     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9180     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9181     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9182     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9183     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9184     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9185
  9186     IF PB-COMPANY-ID = 'NCL'  AND
  9187        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9188         NEXT SENTENCE
  9189     ELSE
  9190         IF SUB5 NOT GREATER THAN +20
  9191            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9192                MOVE WS-SAVE-BENEFIT-REM-TERM
  9193                                      TO WS-AM-AH-BENE-REM-TERM
  9194                                         EC-BR-AH-REM-TERM-CALC.
  9195
  9196     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9197     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9198
  9199     GO TO 0400-FIND-CARRIER.
  9200
  9201 0399-BENEFIT-NOT-FOUND.
  9202
  9203     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9204     MOVE ER-2605                TO WS-ERROR.
  9205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9206
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 169
* EL050.cbl
  9208
  9209 0400-FIND-CARRIER.
  9210
  9211     MOVE PB-SV-CARRIER          TO WS-CARR.
  9212
  9213     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9214     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9215     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9216     MOVE '6'                    TO CNTL-REC-TYPE.
  9217
  9218*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9219     MOVE SPACE                  TO WS-DMD-RATING-SW
  9220                                    EC-BR-DMD-RATING-SW.
  9221
  9222     MOVE '2'                    TO RC-SW-1.
  9223     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9224
  9225     IF NOT CF-CARRIER-MASTER
  9226        GO TO 0400-CARRIER-NOT-FOUND.
  9227
  9228 0400-BUILD-CARR-TOL.
  9229
  9230     IF CF-CR-TOL-PREM NUMERIC AND
  9231        CF-CR-TOL-PREM GREATER THAN +0
  9232        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9233                                    WS-TOL-AH-PREM.
  9234
  9235     IF CF-CR-TOL-REFUND NUMERIC AND
  9236        CF-CR-TOL-REFUND GREATER THAN +0
  9237        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9238                                    WS-TOL-AH-REFUND.
  9239
  9240     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9241        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9242        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9243                                    WS-AH-REFUND-OVS-AMT.
  9244
  9245     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9246        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9247        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9248                                    WS-AH-REFUND-OVS-PCT.
  9249
  9250     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9251        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9252        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9253                                    WS-TOL-AH-PREM-PCT.
  9254
  9255     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9256        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9257        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9258                                     WS-TOL-AH-REFUND-PCT.
  9259
  9260     IF CF-COMPANY-ID EQUAL 'DMD'
  9261         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9262                                    EC-BR-DMD-RATING-SW.
  9263
  9264     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9265     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 170
* EL050.cbl
  9266        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9267     END-IF
  9268     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9269        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9270     END-IF
  9271     IF WS-TOL-CLP-PCT = ZEROS
  9272        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9273     END-IF
  9274
  9275     IF WS-SPP-LEASE-COMM = ZEROS
  9276        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9277     END-IF
  9278     GO TO 0400-FIND-ERPDEF.
  9279
  9280 0400-CARRIER-NOT-FOUND.
  9281
  9282     MOVE ER-2602                TO WS-ERROR.
  9283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9284
  9285 0400-FIND-ERPDEF.
  9286     IF PB-COMPANY-ID = 'DCC'
  9287        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9288        CONTINUE
  9289     ELSE
  9290        GO TO 0400-FIND-ERCOMP
  9291     END-IF
  9292     MOVE ' '                    TO PDEF-MASTER-SW
  9293     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9294     MOVE PB-STATE               TO ERPDEF-STATE
  9295     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9296     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9297     IF PB-ISSUE
  9298        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9299     ELSE
  9300        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9301     END-IF
  9302     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9303     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9304     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9305     IF PDEF-MASTER-FOUND
  9306        MOVE 'N'                 TO PDEF-MASTER-SW
  9307        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9308        IF PDEF-MASTER-FOUND
  9309           IF (ERPDEF-KEY-SAVE (1:16) =
  9310                        PD-CONTROL-PRIMARY (1:16))
  9311              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9312              CONTINUE
  9313           ELSE
  9314              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9315              IF (ERPDEF-KEY-SAVE (1:16) =
  9316                        PD-CONTROL-PRIMARY (1:16))
  9317                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9318                 CONTINUE
  9319              ELSE
  9320                 MOVE 'N'        TO PDEF-MASTER-SW
  9321              END-IF
  9322           END-IF
  9323        END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 171
* EL050.cbl
  9324        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9325     END-IF
  9326     IF PDEF-MASTER-FOUND
  9327        IF PD-TRUNCATED = 'Y'
  9328           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9329        END-IF
  9330     END-IF
  9331     .
  9332 0400-FIND-ERCOMP.
  9333     IF PB-COMPANY-ID = 'DCC'
  9334        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9335           (WS-SUB1 > +10)
  9336           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9337                 OR 'A' OR 'N'
  9338              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9339              MOVE PB-CARRIER    TO COMP-CARRIER
  9340              MOVE PB-GROUPING   TO COMP-GROUPING
  9341              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9342              MOVE AM-AGT (WS-SUB1)
  9343                                 TO COMP-FIN-RESP
  9344              MOVE 'G'           TO COMP-TYPE
  9345              PERFORM 8582-READ-COMPENSATION-MASTER
  9346                                 THRU 8582-EXIT
  9347              IF COMP-MASTER-FOUND
  9348                 IF CO-GA-INACTIVE
  9349                    MOVE ER-2763 TO WS-ERROR
  9350                    PERFORM 9900-ERROR-FORMAT
  9351                                 THRU 9900-EXIT
  9352                    MOVE +11     TO WS-SUB1
  9353                 END-IF
  9354                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9355                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9356                    MOVE ER-2788 TO WS-ERROR
  9357                    PERFORM 9900-ERROR-FORMAT
  9358                                 THRU 9900-EXIT
  9359                    MOVE +11     TO WS-SUB1
  9360                 END-IF
  9361              END-IF
  9362           END-IF
  9363        END-PERFORM
  9364     END-IF
  9365     IF PB-COMPANY-ID = 'DCC'
  9366        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9367           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9368                                    WS-CLP-STATE
  9369        ELSE
  9370           MOVE SPACES           TO PB-I-CLP-STATE
  9371                                    WS-CLP-STATE
  9372        END-IF
  9373     END-IF
  9374
  9375     IF (PB-COMPANY-ID = 'DCC')
  9376        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9377        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9378        CONTINUE
  9379     ELSE
  9380        GO TO 0400-FIND-STATE-RECORD
  9381     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 172
* EL050.cbl
  9382     MOVE SPACES                 TO WS-CLP-STATE
  9383     MOVE +0                     TO WS-BANK-FEE
  9384                                    WS-BANK-LFEE
  9385                                    WS-BANK-NOCHRGB
  9386
  9387     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9388     IF (PB-ISSUE)
  9389        AND (PB-I-BANK-NUMBER NOT =
  9390            SPACES AND ZEROS AND LOW-VALUES)
  9391        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9392     ELSE
  9393        IF (PB-CANCELLATION)
  9394           AND (PB-CI-BANK-NUMBER NOT =
  9395                SPACES AND ZEROS AND LOW-VALUES)
  9396           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9397        END-IF
  9398     END-IF
  9399     IF COMP-FIN-RESP NOT = LOW-VALUES
  9400        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9401        MOVE PB-CARRIER          TO COMP-CARRIER
  9402        MOVE PB-GROUPING         TO COMP-GROUPING
  9403        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9404        MOVE 'B'                 TO COMP-TYPE
  9405        PERFORM 8582-READ-COMPENSATION-MASTER
  9406                                 THRU 8582-EXIT
  9407        IF COMP-MASTER-FOUND
  9408           IF CO-MAX-BANK-FEE NOT NUMERIC
  9409              MOVE +0            TO CO-MAX-BANK-FEE
  9410           END-IF
  9411           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9412              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9413           END-IF
  9414           IF CO-GA-INACTIVE
  9415              MOVE ER-2763       TO WS-ERROR
  9416              PERFORM 9900-ERROR-FORMAT
  9417                                 THRU 9900-EXIT
  9418           END-IF
  9419           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9420              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9421              MOVE ER-2788 TO WS-ERROR
  9422              PERFORM 9900-ERROR-FORMAT
  9423                                 THRU 9900-EXIT
  9424              MOVE +11     TO WS-SUB1
  9425           END-IF
  9426           IF WS-AH-BEN-CATEGORY = 'G'
  9427              MOVE CO-MAX-BANK-FEE
  9428                                 TO WS-BANK-FEE
  9429                                    PB-I-BANK-FEE
  9430           ELSE
  9431              MOVE CO-MAX-BANK-FEE-LEASE
  9432                                 TO WS-BANK-LFEE
  9433                                    PB-I-BANK-FEE
  9434           END-IF
  9435           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9436              AND (WS-AH-REFUND-CALC = 'G'))
  9437                        OR
  9438              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9439              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 173
* EL050.cbl
  9440              CONTINUE
  9441           ELSE
  9442              MOVE ER-2789 TO WS-ERROR
  9443              PERFORM 9900-ERROR-FORMAT
  9444                                 THRU 9900-EXIT
  9445           END-IF
  9446           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9447                                    PB-I-CLP-STATE
  9448           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9449           MOVE CO-CARRIER       TO BXRF-CARRIER
  9450           MOVE CO-GROUPING      TO BXRF-GROUPING
  9451           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9452           MOVE BXRF-MAX-REC-LENGTH
  9453                                 TO BXRF-REC-LENGTH
  9454           PERFORM 8584-READ-BANK-CROSS-REF
  9455                                 THRU 8584-EXIT
  9456           IF BXRF-MASTER-FOUND
  9457              MOVE ' '           TO BANK-ACCT-SW
  9458              MOVE BK-BANK-POINTER-CNT
  9459                                 TO BK-BANK-POINTER-CNT
  9460              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9461                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9462                 OR (BANK-ACCT-FOUND)
  9463                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9464                    AND (BK-AM-EXP-DT (WS-SUB1)
  9465                                 > PB-CERT-EFF-DT)
  9466                    AND (BK-AM-EFF-DT (WS-SUB1)
  9467                                 NOT > PB-CERT-EFF-DT)
  9468                    SET BANK-ACCT-FOUND TO TRUE
  9469                 END-IF
  9470              END-PERFORM
  9471              IF NOT BANK-ACCT-FOUND
  9472                 MOVE ZEROS      TO WS-BANK-FEE
  9473                                    WS-BANK-LFEE
  9474                 MOVE ER-2869    TO WS-ERROR
  9475                 PERFORM 9900-ERROR-FORMAT
  9476                                 THRU 9900-EXIT
  9477              ELSE
  9478                 PERFORM 5000-PROCESS-REPS
  9479                                 THRU 5000-EXIT
  9480                 IF AGENT-MASTER-FOUND
  9481                    MOVE +0      TO WS-BANK-FEE
  9482                                    WS-BANK-LFEE
  9483*                   MOVE AG-SPP-FEES (1)
  9484*                                TO PB-I-BANK-FEE
  9485*                                   WS-BANK-FEE
  9486                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9487                       (WS-SUB1 > +10)
  9488                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9489                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9490                       END-IF
  9491                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9492                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9493                       END-IF
  9494                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9495                          AG-SPP-FEES (WS-SUB1)
  9496                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9497                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 174
* EL050.cbl
  9498                    END-PERFORM
  9499                    IF WS-AH-BEN-CATEGORY = 'G'
  9500                       MOVE WS-BANK-FEE
  9501                                 TO PB-I-BANK-FEE
  9502                    ELSE
  9503                       MOVE WS-BANK-LFEE
  9504                                 TO PB-I-BANK-FEE
  9505                    END-IF
  9506                 END-IF
  9507              END-IF
  9508           END-IF
  9509        ELSE
  9510           MOVE ER-2879          TO WS-ERROR
  9511           PERFORM 9900-ERROR-FORMAT
  9512                                 THRU 9900-EXIT
  9513        END-IF
  9514     ELSE
  9515        MOVE ER-2879             TO WS-ERROR
  9516        PERFORM 9900-ERROR-FORMAT
  9517                                 THRU 9900-EXIT
  9518     END-IF
  9519     IF WS-AH-BEN-CATEGORY = 'G'
  9520        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9521        + WS-BANK-FEE
  9522     ELSE
  9523        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9524        + WS-BANK-LFEE
  9525     END-IF
  9526     .
  9527 0400-FIND-STATE-RECORD.
  9528
  9529     IF WK-STATE-ADDR NOT = ZEROS
  9530         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9531         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9532         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9533         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9534         IF PB-SV-STATE = CF-STATE-CODE
  9535             GO TO 0405-CONTINUE-EDIT
  9536         ELSE
  9537             NEXT SENTENCE
  9538     ELSE
  9539         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9540
  9541     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9542     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9543     MOVE '3'                    TO CNTL-REC-TYPE.
  9544     MOVE +0                     TO CNTL-SEQ-NO.
  9545
  9546     MOVE '3'                    TO RC-SW-2.
  9547     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9548
  9549     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9550        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9551        PB-SV-STATE   NOT = CF-STATE-CODE)
  9552        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9553                                    WS-TOL-AH-CLAIM
  9554                                    WS-MINIMUM-REFUND
  9555                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 175
* EL050.cbl
  9556                                    WS-TOL-AH-PREM
  9557                                    WS-TOL-LF-REFUND
  9558                                    WS-TOL-AH-REFUND
  9559                                    EC-ST-TOL-PREM-PCT
  9560                                    WS-TOL-LF-PREM-PCT
  9561                                    WS-TOL-AH-PREM-PCT
  9562                                    EC-ST-TOL-REFUND-PCT
  9563                                    WS-TOL-LF-REFUND-PCT
  9564                                    WS-TOL-AH-REFUND-PCT
  9565                                    EC-ST-TOL-PREM
  9566                                    EC-ST-TOL-REFUND
  9567                                    EC-ST-FST-PMT-DAYS-MAX
  9568                                    WS-FREE-LOOK-PERIOD
  9569                                    WS-ST-LF-PREM-TAX
  9570                                    WS-ST-AH-PREM-TAX-I
  9571                                    WS-ST-AH-PREM-TAX-G
  9572                                    WS-BANK-FEE
  9573                                    WS-BANK-LFEE
  9574                                    WS-TOL-CLP-PCT
  9575                                    WS-SPP-LEASE-COMM
  9576        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9577                                    EC-ST-FST-PMT-DAYS-CHG
  9578                                    WS-LF-REM-TERM-CALC
  9579                                    WS-LF-REFUND-CALC
  9580                                    EC-ST-LF-REM-TERM-CALC
  9581                                    EC-ST-LF-REFUND-CALC
  9582                                    WS-AH-REM-TERM-CALC
  9583                                    WS-AH-REFUND-CALC
  9584                                    WS-LF-BEN-CATEGORY
  9585                                    WS-AH-BEN-CATEGORY
  9586                                    WS-CLP-STATE
  9587                                    WS-ST-REFUND-CLAIM-FLAG
  9588                                    EC-ST-AH-REM-TERM-CALC
  9589                                    EC-ST-AH-REFUND-CALC
  9590          GO TO 0499-STATE-NOT-FOUND.
  9591
  9592     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9593
  9594 0405-CONTINUE-EDIT.
  9595
  9596     if pb-company-id = 'AHL'
  9597        continue
  9598     else
  9599        IF PB-CERT-PRIME NOT NUMERIC
  9600           MOVE ER-2722          TO WS-ERROR
  9601           PERFORM 9900-ERROR-FORMAT
  9602                                 THRU 9900-EXIT
  9603        end-if
  9604     END-IF
  9605*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9606*       MOVE +0                  TO SUB3
  9607*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9608*       IF SUB3 > +0
  9609*          MOVE ER-2722          TO WS-ERROR
  9610*          PERFORM 9900-ERROR-FORMAT
  9611*                                THRU 9900-EXIT
  9612*       END-IF
  9613*    END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 176
* EL050.cbl
  9614*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9615*       IF PB-CERT-PRIME NOT NUMERIC
  9616*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9617*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9618*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9619*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9620*
  9621*          MOVE ER-2722          TO WS-ERROR
  9622*          PERFORM 9900-ERROR-FORMAT
  9623*                                THRU 9900-EXIT
  9624*       END-IF
  9625*    END-IF
  9626
  9627     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9628
  9629     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9630        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9631                                    WS-TOL-AH-CLAIM.
  9632
  9633     IF CF-ST-REFUND-MIN NOT NUMERIC
  9634        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9635
  9636     IF CF-ST-REFUND-MIN NOT = ZEROS
  9637        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9638
  9639     IF CF-ST-TOL-PREM  NOT = ZEROS
  9640        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9641                                    WS-TOL-AH-PREM
  9642        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9643
  9644     IF CF-ST-TOL-REFUND NOT = ZEROS
  9645        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9646                                    WS-TOL-AH-REFUND
  9647        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9648
  9649     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9650        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9651        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9652                                    WS-AH-REFUND-OVS-AMT
  9653                                    EC-ST-OVR-SHT-AMT.
  9654
  9655     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9656        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9657        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9658                                    WS-TOL-LF-PREM-PCT
  9659                                    WS-TOL-AH-PREM-PCT.
  9660
  9661     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9662        CF-ST-TOL-REF-PCT GREATER THAN +0
  9663        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9664                                    WS-TOL-LF-REFUND-PCT
  9665                                    WS-TOL-AH-REFUND-PCT.
  9666
  9667     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9668        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9669        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9670                                    WS-AH-REFUND-OVS-PCT
  9671                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 177
* EL050.cbl
  9672
  9673     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9674     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9675
  9676     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9677          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9678
  9679     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9680     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9681     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9682
  9683     IF CF-ST-LF-PREM-TAX NUMERIC
  9684        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9685     END-IF
  9686     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9687        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9688     END-IF
  9689     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9690        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9691     END-IF
  9692
  9693     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9694         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9695     END-IF.
  9696
  9697     IF WS-LF-BENEFIT-CD = ZEROS
  9698        GO TO 0410-CHECK-AH.
  9699
  9700     IF CF-ST-RT-CALC NOT = SPACES
  9701        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9702                                    EC-ST-LF-REM-TERM-CALC
  9703     END-IF
  9704
  9705     IF WS-LF-COVERAGE-TYPE = 'R'
  9706        IF WS-LF-EARNINGS-CALC = '5'
  9707           IF CF-ST-RF-LN-CALC > '0'
  9708              MOVE CF-ST-RF-LN-CALC
  9709                                 TO WS-LF-REFUND-CALC
  9710                                    EC-ST-LF-REFUND-CALC
  9711           END-IF
  9712        ELSE
  9713           IF CF-ST-RF-LR-CALC > '0'
  9714              MOVE CF-ST-RF-LR-CALC
  9715                                 TO WS-LF-REFUND-CALC
  9716                                    EC-ST-LF-REFUND-CALC
  9717           END-IF
  9718        END-IF
  9719     ELSE
  9720        IF CF-ST-RF-LL-CALC > '0'
  9721           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9722                                    EC-ST-LF-REFUND-CALC
  9723        END-IF
  9724     END-IF
  9725
  9726     IF CF-ST-RT-CALC NOT = SPACES
  9727        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9728                                    EC-ST-LF-REM-TERM-CALC
  9729     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 178
* EL050.cbl
  9730
  9731     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9732     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9733
  9734     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9735
  9736     IF NO-BENEFIT-FOUND
  9737        GO TO 0410-CHECK-AH.
  9738
  9739     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9740        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9741                                 TO EC-ST-LF-REM-TERM-CALC
  9742                                    WS-LF-REM-TERM-CALC
  9743     END-IF
  9744
  9745     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9746        MOVE CF-ST-REFUND-CALC (SUB3)
  9747                                 TO WS-LF-REFUND-CALC
  9748                                    EC-ST-LF-REFUND-CALC
  9749     END-IF
  9750*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9751
  9752     .
  9753 0410-CHECK-AH.
  9754
  9755     IF WS-AH-BENEFIT-CD = ZEROS
  9756        GO TO 0500-SET-ACCOUNT.
  9757
  9758     IF CF-ST-RT-CALC NOT = SPACES
  9759        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9760                                    EC-ST-AH-REM-TERM-CALC
  9761     END-IF
  9762
  9763     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9764        IF CF-ST-RF-CP-CALC > '0'
  9765           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9766                                    EC-ST-AH-REFUND-CALC
  9767        END-IF
  9768     ELSE
  9769        IF CF-ST-RF-AH-CALC > '0'
  9770           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9771                                    EC-ST-AH-REFUND-CALC
  9772        END-IF
  9773     END-IF
  9774     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9775     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9776
  9777     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9778
  9779     IF NO-BENEFIT-FOUND
  9780        GO TO 0500-SET-ACCOUNT.
  9781
  9782     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9783        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9784                                 TO WS-AH-REM-TERM-CALC
  9785                                    EC-ST-AH-REM-TERM-CALC
  9786     END-IF
  9787
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 179
* EL050.cbl
  9788     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9789        MOVE CF-ST-REFUND-CALC (SUB3)
  9790                                 TO WS-AH-REFUND-CALC
  9791                                    EC-ST-AH-REFUND-CALC
  9792     END-IF
  9793
  9794*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9795
  9796     GO TO 0500-SET-ACCOUNT.
  9797
  9798 0499-STATE-NOT-FOUND.
  9799
  9800     MOVE ER-2603                TO WS-ERROR.
  9801     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9802
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 180
* EL050.cbl
  9804
  9805 0500-SET-ACCOUNT.
  9806*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9807     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9808        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9809        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9810        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9811        MOVE '3'                 TO CNTL-REC-TYPE
  9812        MOVE +0                  TO CNTL-SEQ-NO
  9813
  9814        MOVE '3'                 TO RC-SW-2
  9815        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9816
  9817        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9818           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9819           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9820           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9821                                    WS-ST-AH-PREM-TAX-I
  9822                                    WS-ST-AH-PREM-TAX-G
  9823        ELSE
  9824           IF CF-ST-LF-PREM-TAX NUMERIC
  9825              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9826           END-IF
  9827           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9828              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9829           END-IF
  9830           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9831              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9832           END-IF
  9833        END-IF
  9834        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9835     END-IF
  9836*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9837*  FOR DCC ONLY
  9838     IF PB-COMPANY-ID = 'DCC'
  9839
  9840     MOVE ' '                    TO STAT-MASTER-SW
  9841     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9842     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9843     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9844     MOVE PB-STATE               TO ELSTAT-STATE
  9845     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9846        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9847     END-IF
  9848
  9849     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9850     SET BIN-TO-GREG             TO TRUE
  9851     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9852     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9853     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9854
  9855     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9856     IF STAT-MASTER-FOUND
  9857        MOVE 'N'                 TO STAT-MASTER-SW
  9858        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9859        IF STAT-MASTER-FOUND
  9860           IF (ELSTAT-KEY-SAVE (1:12) =
  9861                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 181
* EL050.cbl
  9862              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9863                 MOVE 'F'        TO STAT-MASTER-SW
  9864              ELSE
  9865                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9866                 IF (STAT-MASTER-FOUND)
  9867                    AND (ELSTAT-KEY-SAVE (1:12) =
  9868                        SF-CONTROL-PRIMARY (1:12))
  9869                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9870                    MOVE 'F'     TO STAT-MASTER-SW
  9871                 END-IF
  9872              END-IF
  9873           END-IF
  9874        END-IF
  9875     END-IF
  9876
  9877     IF STAT-MASTER-SW = 'F'
  9878        IF SF-ST-LF-PREM-TAX NUMERIC
  9879           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9880        END-IF
  9881        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9882           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9883        END-IF
  9884        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9885           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9886        END-IF
  9887     END-IF
  9888
  9889     END-IF
  9890     IF (PB-COMPANY-ID = 'DCC')
  9891        AND (PB-ISSUE)
  9892        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9893        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9894        AND (AM-GPCD = 06)
  9895        MOVE 'Y'                 TO WS-GOOD-HIN
  9896        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9897           MOVE PB-I-VIN         TO WS-WORK-VIN
  9898           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9899              (V1 > 16)
  9900              IF WS-WORK-VIN (V1:1) NUMERIC
  9901                 MOVE WS-WORK-VIN-N (V1)
  9902                                 TO WS-ROW-B-VAL (V1)
  9903              ELSE
  9904                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9905                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9906                    OR (V2 > 26)
  9907                 END-PERFORM
  9908                 IF V2 < 27
  9909                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9910                 ELSE
  9911                    MOVE 'N'     TO WS-GOOD-HIN
  9912                 END-IF
  9913              END-IF
  9914              COMPUTE WS-ROW-D-VAL (V1) =
  9915                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9916              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9917                 WS-ROW-D-VAL (V1)
  9918           END-PERFORM
  9919           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 182
* EL050.cbl
  9920           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9921             REMAINDER WS-VIN-REMAINDER
  9922           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9923              CONTINUE
  9924           ELSE
  9925              MOVE 'N'           TO WS-GOOD-HIN
  9926           END-IF
  9927        ELSE
  9928           MOVE 'N'              TO WS-GOOD-HIN
  9929        END-IF
  9930        IF WS-GOOD-HIN NOT = 'Y'
  9931           MOVE ER-3826           TO WS-ERROR
  9932           PERFORM 9900-ERROR-FORMAT
  9933                                 THRU 9900-EXIT
  9934        END-IF
  9935     END-IF
  9936     IF (PB-COMPANY-ID = 'DCC')
  9937        AND (PB-ISSUE)
  9938        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9939        AND (AM-GPCD NOT = 06)
  9940        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9941          MOVE PB-I-VIN          TO WS-WORK-VIN
  9942          MOVE +8                TO V2
  9943          MOVE ZEROS             TO WS-VIN-TOTAL
  9944          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9945           (V1 > 17)
  9946             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9947                MOVE ER-3825     TO WS-ERROR
  9948                PERFORM 9900-ERROR-FORMAT
  9949                                 THRU 9900-EXIT
  9950             ELSE
  9951                IF V1 = 8
  9952                   MOVE 10       TO V2
  9953                END-IF
  9954                IF V1 = 9
  9955                   MOVE 0        TO V2
  9956                END-IF
  9957                IF V1 = 10
  9958                   MOVE 9        TO V2
  9959                END-IF
  9960                IF WS-WORK-VIN (V1:1) NUMERIC
  9961                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9962                    + (WS-WORK-VIN-N (V1) * V2)
  9963                ELSE
  9964                   MOVE WS-WORK-VIN (V1:1)
  9965                                 TO WS-HEX-BYTE
  9966                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9967                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9968                    + (WS-NUM (V3) * V2)
  9969                END-IF
  9970                COMPUTE V2 = V2 - 1
  9971             END-IF
  9972          END-PERFORM
  9973          MOVE ZEROS TO WS-VIN-REMAINDER
  9974          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9975             REMAINDER WS-VIN-REMAINDER
  9976          IF ((WS-WORK-VIN (9:1) = 'X')
  9977             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 183
* EL050.cbl
  9978                     OR
  9979             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9980             CONTINUE
  9981          ELSE
  9982             MOVE ER-3826        TO WS-ERROR
  9983             PERFORM 9900-ERROR-FORMAT
  9984                                 THRU 9900-EXIT
  9985          END-IF
  9986        ELSE
  9987          MOVE ER-3826           TO WS-ERROR
  9988          PERFORM 9900-ERROR-FORMAT
  9989                                 THRU 9900-EXIT
  9990        END-IF
  9991     END-IF
  9992******************************************************************
  9993******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9994******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9995******* METHODS.
  9996******************************************************************
  9997     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9998        IF PB-CANCELLATION
  9999           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10000              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10001                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10002                IF FORM-MASTER-FOUND
 10003                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10004******************************************************************
 10005
 10006     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10007     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10008
 10009     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10010     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10011     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10012     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10013
 10014
 10015     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10016     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10017     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10018
 10019     IF AM-LF-OB-RATE NOT NUMERIC
 10020         MOVE ZERO               TO AM-LF-OB-RATE.
 10021
 10022     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10023         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10024
 10025     IF AM-AH-OB-RATE NOT NUMERIC
 10026         MOVE ZERO               TO AM-AH-OB-RATE.
 10027
 10028     IF WS-LF-JOINT-INDICATOR = 'J'
 10029         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10030     ELSE
 10031         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10032
 10033     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10034
 10035     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 184
* EL050.cbl
 10036         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10037
 10038     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10039         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10040                                       WS-IG-OVRD
 10041     ELSE
 10042         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10043             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10044                                       WS-IG-OVRD
 10045         ELSE
 10046             MOVE AM-IG             TO WS-IG-OVRD-AH
 10047                                       WS-IG-OVRD.
 10048
 10049     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10050         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10051                                       WS-IG-OVRD
 10052     ELSE
 10053         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10054             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10055                                       WS-IG-OVRD
 10056         ELSE
 10057             MOVE AM-IG             TO WS-IG-OVRD-LF
 10058                                       WS-IG-OVRD.
 10059
 10060     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10061     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10062     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10063     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10064     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10065
 10066     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10067     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10068     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10069     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10070
 10071     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10072     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10073     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10074     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10075     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10076     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10077     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10078
 10079     IF WS-ACCT-AH-DEV-PCT > +0
 10080        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10081     ELSE
 10082        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10083
 10084     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10085        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10086     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10087        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10088
 10089        IF AM-EARN-METHOD-L = 'S'
 10090            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10091                                        WS-LF-REFUND-CALC.
 10092
 10093        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 185
* EL050.cbl
 10094            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10095                                        WS-LF-REFUND-CALC.
 10096
 10097     IF WS-LF-COVERAGE-TYPE = 'R'
 10098         IF AM-EARN-METHOD-R = 'R'
 10099            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10100                                    WS-LF-REFUND-CALC.
 10101     IF WS-LF-COVERAGE-TYPE = 'R'
 10102         IF AM-EARN-METHOD-R = 'P'
 10103            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10104                                    WS-LF-REFUND-CALC.
 10105     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10106         IF AM-EARN-METHOD-L = 'R'
 10107            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10108                                    WS-LF-REFUND-CALC.
 10109     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10110         IF AM-EARN-METHOD-L = 'P'
 10111            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10112                                    WS-LF-REFUND-CALC.
 10113     IF WS-LF-COVERAGE-TYPE = 'R'
 10114         IF AM-EARN-METHOD-R = 'A'
 10115            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10116                                    WS-LF-REFUND-CALC.
 10117     IF WS-LF-COVERAGE-TYPE = 'R'
 10118         IF AM-EARN-METHOD-R = 'M'
 10119            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10120                                    WS-LF-REFUND-CALC.
 10121     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10122         IF AM-EARN-METHOD-L = 'A'
 10123            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10124                                    WS-LF-REFUND-CALC.
 10125     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10126         IF AM-EARN-METHOD-L = 'M'
 10127            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10128                                    WS-LF-REFUND-CALC.
 10129
 10130     IF AM-EARN-METHOD-A = 'R'
 10131        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10132                                    WS-AH-REFUND-CALC.
 10133     IF AM-EARN-METHOD-A = 'P'
 10134        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10135                                    WS-AH-REFUND-CALC.
 10136     IF AM-EARN-METHOD-A = 'C'
 10137        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10138                                    WS-AH-REFUND-CALC.
 10139     IF AM-EARN-METHOD-A = 'A'
 10140        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10141                                    WS-AH-REFUND-CALC.
 10142     IF AM-EARN-METHOD-A = 'M'
 10143        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10144                                    WS-AH-REFUND-CALC.
 10145     IF AM-EARN-METHOD-A = 'N'
 10146        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10147                                    WS-AH-REFUND-CALC.
 10148     IF AM-EARN-METHOD-A = 'S'
 10149        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10150                                    WS-AH-REFUND-CALC.
 10151
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 186
* EL050.cbl
 10152     IF AM-TOL-PREM NOT = ZEROS
 10153        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10154                                    WS-TOL-AH-PREM.
 10155
 10156     IF AM-OVR-SHT-AMT NUMERIC AND
 10157                  AM-OVR-SHT-AMT > 0
 10158        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10159                                    EC-AM-LF-OVR-SHT-AMT
 10160                                    WS-AH-REFUND-OVS-AMT
 10161                                    EC-AM-AH-OVR-SHT-AMT.
 10162
 10163     IF AM-OVR-SHT-PCT NUMERIC AND
 10164                    AM-OVR-SHT-PCT > 0
 10165        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10166                                    EC-AM-LF-OVR-SHT-PCT
 10167                                    WS-AH-REFUND-OVS-PCT
 10168                                    EC-AM-AH-OVR-SHT-PCT.
 10169
 10170     IF AM-TOL-REF-PCT NUMERIC AND
 10171                  AM-TOL-REF-PCT > 0
 10172        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10173                                    WS-TOL-AH-REFUND-PCT.
 10174
 10175     IF AM-TOL-REF  NOT = ZEROS  AND
 10176                  AM-TOL-REF NUMERIC
 10177        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10178                                    EC-AM-LF-TOL-REFUND
 10179                                    WS-TOL-AH-REFUND
 10180                                    EC-AM-AH-TOL-REFUND.
 10181
 10182     IF AM-TOL-CLM  NOT = ZEROS
 10183        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10184                                    WS-TOL-AH-CLAIM.
 10185
 10186     IF AM-CLP-TOL-PCT NOT NUMERIC
 10187        MOVE +0                  TO AM-CLP-TOL-PCT
 10188     END-IF
 10189
 10190     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10191        MOVE +0                  TO AM-SPP-LEASE-COMM
 10192     END-IF
 10193     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10194        MOVE WS-PL-TOL-LF-PREM-PCT
 10195                                 TO WS-TOL-LF-PREM-PCT.
 10196
 10197     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10198        MOVE WS-PL-TOL-AH-PREM-PCT
 10199                                 TO WS-TOL-AH-PREM-PCT.
 10200
 10201     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10202        MOVE WS-PL-TOL-LF-REFUND-PCT
 10203                                 TO WS-TOL-LF-REFUND-PCT.
 10204
 10205     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10206        MOVE WS-PL-TOL-AH-REFUND-PCT
 10207                                 TO WS-TOL-AH-REFUND-PCT.
 10208
 10209     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 187
* EL050.cbl
 10210        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10211
 10212     IF WS-PL-REF-OVS-PCT > +0
 10213        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10214
 10215     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10216        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10217     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10218        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10219     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10220        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10221     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10222        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10223     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10224        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10225     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10226        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10227
 10228     IF WS-AH-PL-REF-OVS-AMT > +0
 10229        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10230
 10231     IF WS-AH-PL-REF-OVS-PCT > +0
 10232        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10233
 10234     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10235     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10236
 10237     IF PB-CANCELLATION
 10238        GO TO 3000-CONTINUE-EDIT.
 10239
 10240     MOVE +1 TO SUB1.
 10241     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10242     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10243
 10244     IF CF-COMPANY-ID = 'DMD'
 10245       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10246         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10247        ELSE
 10248         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10249
 10250  0525-FIND-ACCT-COMM.
 10251     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10252        NEXT SENTENCE
 10253      ELSE
 10254         ADD +1 TO SUB1
 10255         IF SUB1 LESS +11
 10256            GO TO 0525-FIND-ACCT-COMM
 10257          ELSE
 10258             GO TO 0560-EDIT-CONTINUE.
 10259
 10260     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10261     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10262                                    PB-I-LIFE-COMMISSION.
 10263***  IF PB-COMPANY-ID = 'CRI'
 10264     IF PB-PREM-ACCTNG-ONLY
 10265         GO TO 0560-EDIT-CONTINUE.
 10266
 10267     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 188
* EL050.cbl
 10268     MOVE ' '    TO WS-CTBL-READ-SW.
 10269
 10270
 10271 0530-GET-AH-COMP.
 10272     IF NO-AH-COVERAGE  OR
 10273        NO-AH-BENEFIT-MATCH
 10274           GO TO 0540-NEXT-READ-STEP.
 10275
 10276     IF AM-A-COM (SUB1) NUMERIC
 10277        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10278         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10279         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10280         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10281         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10282     ELSE
 10283          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10284          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10285          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10286          MOVE ZEROS             TO WS-SUB1
 10287                                    WS-COMMISSION
 10288          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10289          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10290          IF WS-COMMISSION > ZEROS
 10291             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10292             GO TO 0540-NEXT-READ-STEP
 10293          END-IF
 10294          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10295          IF CTBL-TABLE-FOUND
 10296             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10297                                        PB-I-AH-TERM
 10298             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10299             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10300             GO TO 0540-NEXT-READ-STEP
 10301          ELSE
 10302             IF FIRST-TIME-THROUGH
 10303                 GO TO 0530-GET-AH-COMP
 10304             ELSE
 10305                 MOVE ER-2609                TO WS-ERROR
 10306                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10307
 10308 0540-NEXT-READ-STEP.
 10309     MOVE '0540' TO CTBL-SW.
 10310     MOVE ' '    TO WS-CTBL-READ-SW.
 10311
 10312 0540-GET-LF-COMP.
 10313     IF NO-LIFE-COVERAGE  OR
 10314        NO-LF-BENEFIT-MATCH
 10315           GO TO 0560-EDIT-CONTINUE.
 10316
 10317     IF WS-LF-JOINT-INDICATOR = 'J'
 10318        IF AM-J-COM (SUB1) NUMERIC
 10319           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10320           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10321           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10322           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10323           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10324        ELSE
 10325           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 189
* EL050.cbl
 10326           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10327           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10328           MOVE ZEROS                TO WS-SUB1
 10329                                        WS-COMMISSION
 10330           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10331           IF WS-COMMISSION > ZEROS
 10332              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10333              GO TO 0560-EDIT-CONTINUE
 10334           END-IF
 10335           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10336           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10337           IF CTBL-TABLE-FOUND
 10338              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10339              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10340              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10341              GO TO 0560-EDIT-CONTINUE
 10342           ELSE
 10343              IF FIRST-TIME-THROUGH
 10344                  GO TO 0540-GET-LF-COMP
 10345              ELSE
 10346                  MOVE ER-2609                TO WS-ERROR
 10347                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10348                  GO TO 0560-EDIT-CONTINUE.
 10349
 10350     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10351        IF AM-L-COM (SUB1) NUMERIC
 10352           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10353           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10354           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10355           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10356           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10357        ELSE
 10358           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10359           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10360           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10361           MOVE ZEROS                TO WS-SUB1
 10362                                        WS-COMMISSION
 10363           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10364           IF WS-COMMISSION IS GREATER THAN ZEROS
 10365              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10366              GO TO 0560-EDIT-CONTINUE
 10367           END-IF
 10368           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10369           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10370           IF CTBL-TABLE-FOUND
 10371              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10372              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10373              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10374              GO TO 0560-EDIT-CONTINUE
 10375           ELSE
 10376              IF FIRST-TIME-THROUGH
 10377                  GO TO 0540-GET-LF-COMP
 10378              ELSE
 10379                  MOVE ER-2609                TO WS-ERROR
 10380                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10381
 10382*    GO TO 0560-EDIT-CONTINUE.
 10383
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 190
* EL050.cbl
 10384 0560-EDIT-CONTINUE.
 10385     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10386                                    WS-AH-PMF-COMM
 10387*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10388*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10389     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10390        (SUB1 > +10)
 10391        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10392           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10393           MOVE '0530'           TO CTBL-SW
 10394           MOVE ' '              TO WS-CTBL-READ-SW
 10395           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10396           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10397           MOVE '0540'           TO CTBL-SW
 10398           MOVE ' '              TO WS-CTBL-READ-SW
 10399           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10400        END-IF
 10401     END-PERFORM
 10402     GO TO 0564-EDIT-CONTINUE
 10403     .
 10404 0561-CHECK-AH.
 10405     IF (NO-AH-COVERAGE)
 10406        OR (NO-AH-BENEFIT-MATCH)
 10407        CONTINUE
 10408     ELSE
 10409        IF (AM-A-COM (SUB1) NUMERIC)
 10410           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10411           IF (AM-COM-TYP (SUB1) = 'A')
 10412              AND (WS-AH-PMF-COMM = ZEROS)
 10413              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10414           END-IF
 10415           CONTINUE
 10416        ELSE
 10417           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10418           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10419           MOVE PB-AH-OVERRIDE-L1
 10420                                 TO CTBL-BEN-TYPE
 10421           MOVE ZEROS            TO WS-SUB1
 10422                                    WS-COMMISSION
 10423           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10424           PERFORM 8300-READ-CTBL-TABLE
 10425                                 THRU 8300-EXIT
 10426           IF CTBL-TABLE-FOUND
 10427              IF (AM-COM-TYP (SUB1) = 'A')
 10428                 AND (WS-AH-PMF-COMM = ZEROS)
 10429                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10430                                        PB-I-AH-TERM
 10431                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10432                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10433              END-IF
 10434              CONTINUE
 10435           ELSE
 10436              IF FIRST-TIME-THROUGH
 10437                 GO TO 0561-CHECK-AH
 10438              ELSE
 10439                 MOVE ER-2609    TO WS-ERROR
 10440                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10441              END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 191
* EL050.cbl
 10442           END-IF
 10443        END-IF
 10444     END-IF
 10445     .
 10446 0561-EXIT.
 10447     EXIT.
 10448 0563-CHECK-LF.
 10449     IF (NO-LIFE-COVERAGE)
 10450        OR (NO-LF-BENEFIT-MATCH)
 10451        CONTINUE
 10452     ELSE
 10453        IF WS-LF-JOINT-INDICATOR = 'J'
 10454           IF AM-J-COM (SUB1) NUMERIC
 10455              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10456              IF (AM-COM-TYP (SUB1) = 'A')
 10457                 AND (WS-LF-PMF-COMM = ZEROS)
 10458                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10459              END-IF
 10460              CONTINUE
 10461           ELSE
 10462              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10463              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10464              MOVE PB-LIFE-OVERRIDE-L1
 10465                                 TO CTBL-BEN-TYPE
 10466              MOVE ZEROS         TO WS-SUB1
 10467                                    WS-COMMISSION
 10468              MOVE AM-J-COMA (SUB1)
 10469                                 TO CTBL-TABLE
 10470              PERFORM 8300-READ-CTBL-TABLE
 10471                                 THRU 8300-EXIT
 10472              IF CTBL-TABLE-FOUND
 10473                 IF (AM-COM-TYP (SUB1) = 'A')
 10474                    AND (WS-LF-PMF-COMM = ZEROS)
 10475                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10476                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10477                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10478                 END-IF
 10479                 CONTINUE
 10480              ELSE
 10481                 IF FIRST-TIME-THROUGH
 10482                    GO TO 0563-CHECK-LF
 10483                 ELSE
 10484                    MOVE ER-2609 TO WS-ERROR
 10485                    PERFORM 9900-ERROR-FORMAT
 10486                                 THRU 9900-EXIT
 10487*                   GO TO 0560-EDIT-CONTINUE
 10488                 END-IF
 10489              END-IF
 10490           END-IF
 10491        ELSE
 10492           IF AM-L-COM (SUB1) NUMERIC
 10493              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10494              IF (AM-COM-TYP (SUB1) = 'A')
 10495                 AND (WS-LF-PMF-COMM = ZEROS)
 10496                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10497              END-IF
 10498              CONTINUE
 10499           ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 192
* EL050.cbl
 10500              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10501              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10502              MOVE PB-LIFE-OVERRIDE-L1
 10503                                 TO CTBL-BEN-TYPE
 10504              MOVE ZEROS         TO WS-SUB1
 10505                                    WS-COMMISSION
 10506              MOVE AM-L-COMA (SUB1)
 10507                                 TO CTBL-TABLE
 10508              PERFORM 8300-READ-CTBL-TABLE
 10509                                 THRU 8300-EXIT
 10510              IF CTBL-TABLE-FOUND
 10511                 CONTINUE
 10512              ELSE
 10513                 IF FIRST-TIME-THROUGH
 10514                    GO TO 0563-CHECK-LF
 10515                 ELSE
 10516                    MOVE ER-2609 TO WS-ERROR
 10517                    PERFORM 9900-ERROR-FORMAT
 10518                                 THRU 9900-EXIT
 10519                 END-IF
 10520              END-IF
 10521           END-IF
 10522        END-IF
 10523     END-IF
 10524     .
 10525 0563-EXIT.
 10526     EXIT.
 10527 0564-EDIT-CONTINUE.
 10528
 10529     IF  PB-COMPANY-ID EQUAL 'DMD'
 10530         IF PB-I-NUM-BILLED EQUAL ZEROS
 10531            MOVE ER-8148       TO WS-ERROR
 10532            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10533
 10534*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10535*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10536*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10537*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10538*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10539*         IF NO-CONVERSION-ERROR
 10540*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10541*         ELSE
 10542*             IF PB-COMPANY-ID EQUAL 'HAN'
 10543*                 MOVE ZEROS     TO PB-I-AGE.
 10544     IF PB-I-BIRTHDAY > LOW-VALUES
 10545        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10546        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10547        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10548        PERFORM 8500-DATE-CONVERT
 10549                                 THRU 8500-EXIT
 10550        IF NO-CONVERSION-ERROR
 10551           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10552           IF PB-I-AGE > ZEROS
 10553              IF WS-WORK-AGE NOT = PB-I-AGE
 10554                 MOVE ER-9501    TO WS-ERROR
 10555                 PERFORM 9900-ERROR-FORMAT
 10556                                 THRU 9900-EXIT
 10557              END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 193
* EL050.cbl
 10558           ELSE
 10559              MOVE WS-WORK-AGE   TO PB-I-AGE
 10560           END-IF
 10561        END-IF
 10562     END-IF
 10563     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10564                                   WS-INS-AGE-SET
 10565     IF PB-I-AGE = ZEROS
 10566        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10567           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10568                                   WS-INS-AGE-SET
 10569           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10570
 10571     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10572                                   WS-AH-EDIT-AGE.
 10573
 10574     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10575        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10576        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10577        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10578        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10579        IF NO-CONVERSION-ERROR
 10580           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10581           IF PB-I-JOINT-AGE > 0
 10582              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10583                 MOVE ER-9503    TO WS-ERROR
 10584                 PERFORM 9900-ERROR-FORMAT
 10585                                 THRU 9900-EXIT
 10586              END-IF
 10587           ELSE
 10588              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10589           END-IF
 10590        ELSE
 10591           MOVE ZEROS            TO PB-I-JOINT-AGE
 10592        END-IF
 10593     END-IF
 10594     IF PB-I-JOINT-AGE NOT NUMERIC
 10595        MOVE ZERO               TO PB-I-JOINT-AGE.
 10596
 10597     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10598                                   WS-JNT-AGE-SET
 10599     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10600        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10601           (WS-AH-JOINT-INDICATOR = 'J')
 10602           IF PB-I-JOINT-AGE = ZEROS
 10603               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10604                                          WS-JNT-AGE-SET
 10605               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10606           END-IF
 10607        END-IF
 10608     END-IF
 10609
 10610     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10611     IF WS-LF-JOINT-INDICATOR = 'J'
 10612        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10613        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10614            IF  PB-I-JOINT-AGE = ZERO
 10615                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 194
* EL050.cbl
 10616                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10617            ELSE
 10618                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10619                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10620                    IF PB-COMPANY-ID NOT = 'LBL'
 10621                        MOVE ER-2685    TO WS-ERROR
 10622                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10623
 10624     IF WS-AH-JOINT-INDICATOR = 'J'
 10625        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10626            IF  PB-I-JOINT-AGE = ZERO
 10627                MOVE ER-2686       TO WS-ERROR
 10628                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10629            ELSE
 10630                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10631                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10632                                           WS-EDIT-AGE
 10633                    IF PB-COMPANY-ID NOT = 'LBL'
 10634                        MOVE ER-2685    TO WS-ERROR
 10635                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10636
 10637******************************************************************
 10638*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10639******************************************************************
 10640
 10641     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10642        (WS-AH-SPECIAL-CALC-CD = 'O')
 10643        NEXT SENTENCE
 10644     ELSE
 10645        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10646          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10647           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10648            WS-AH-JOINT-INDICATOR = 'J')  AND
 10649           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10650            MOVE ER-2627             TO WS-ERROR
 10651            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10652
 10653     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10654        (WS-AH-SPECIAL-CALC-CD = 'O')
 10655         NEXT SENTENCE
 10656     ELSE
 10657         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10658            WS-AH-JOINT-INDICATOR = 'J'
 10659             IF PB-I-JOINT-INSURED = SPACES
 10660                 IF PB-COMPANY-ID NOT = 'JAL'
 10661                     MOVE ER-2696    TO WS-ERROR
 10662                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10663
 10664     IF PB-COMPANY-ID NOT = 'BOA'
 10665        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10666           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10667           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10668               PB-I-JOINT-INSURED NOT = SPACES)
 10669                MOVE ER-2691         TO WS-ERROR
 10670                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10671
 10672     IF PB-COMPANY-ID = 'BOA'
 10673        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 195
* EL050.cbl
 10674           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10675            IF PB-I-JOINT-AGE NOT = ZEROS
 10676                MOVE ER-2691         TO WS-ERROR
 10677                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10678
 10679     IF PB-COMPANY-ID = 'CRI'
 10680        IF PB-I-SIG-SW = 'J'
 10681           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10682              WS-AH-JOINT-INDICATOR NOT = 'J'
 10683              MOVE ER-2675       TO WS-ERROR
 10684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10685
 10686     IF PB-COMPANY-ID = 'CRI'
 10687        IF PB-I-SIG-SW = 'S'
 10688           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10689              WS-AH-JOINT-INDICATOR = 'J'
 10690              MOVE ER-2676       TO WS-ERROR
 10691              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10692
 10693     IF PB-COMPANY-ID = 'CVL'
 10694         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10695            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10696              MOVE ER-2783           TO WS-ERROR
 10697              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10698     IF (WS-LF-JOINT-INDICATOR = 'J')
 10699        AND (WS-AH-JOINT-INDICATOR = 'J')
 10700        AND (PB-I-LF-TERM > 120)
 10701        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10702        MOVE ER-2783             TO WS-ERROR
 10703        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10704     END-IF
 10705     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10706
 10707     IF PB-I-INDV-GRP-OVRD = 'I'
 10708        MOVE ER-2666             TO WS-ERROR
 10709        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10710        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10711
 10712     IF PB-I-INDV-GRP-OVRD = 'G'
 10713        MOVE ER-2666             TO WS-ERROR
 10714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10715        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10716
 10717     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10718        NEXT SENTENCE
 10719     ELSE
 10720        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10721
 10722     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10723        IF WS-ERROR = ER-2666
 10724           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10725           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10726
 10727     IF PB-COMPANY-ID = 'CID'
 10728        IF PB-STATE = 'UT' OR 'MO'
 10729           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10730                 OR '76' OR '77')
 10731                      OR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 196
* EL050.cbl
 10732               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10733                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10734                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10735                   OR '2K' OR '2L'))
 10736              AND PB-I-INDV-GRP-CD = 'I'
 10737              MOVE ER-2721             TO WS-ERROR
 10738              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10739           END-IF
 10740        END-IF
 10741     END-IF
 10742
 10743     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10744     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10745        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10746     ELSE
 10747        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10748     END-IF
 10749
 10750*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10751*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10752     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10753                                    ACCOUNT-AH-CK-SW.
 10754
 10755     IF PB-REISSUED-CERT       OR
 10756        PB-REIN-ONLY-CERT      OR
 10757        PB-POLICY-IS-DECLINED  OR
 10758        PB-POLICY-IS-VOIDED
 10759*       OR PB-MONTHLY-CERT
 10760         GO TO 3000-CONTINUE-EDIT.
 10761
 10762     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10763        IF WS-EDIT-AGE           > +65
 10764           MOVE ER-2709          TO WS-ERROR
 10765           PERFORM 9900-ERROR-FORMAT
 10766                                 THRU 9900-EXIT
 10767        ELSE
 10768           IF WS-EDIT-AGE        > +55
 10769              MOVE ER-2718       TO WS-ERROR
 10770              PERFORM 9900-ERROR-FORMAT
 10771                                 THRU 9900-EXIT
 10772           END-IF
 10773        END-IF
 10774     IF PB-COMPANY-ID = 'DCC'
 10775        IF WS-EDIT-AGE           > +65
 10776           MOVE ER-2709          TO WS-ERROR
 10777           PERFORM 9900-ERROR-FORMAT
 10778                                 THRU 9900-EXIT
 10779        END-IF
 10780     END-IF
 10781     .
 10782
 10783 0565-LIFE-PLAN-LIMIT-EDITS.
 10784
 10785     IF NOT LF-PLAN-MASTER-FOUND
 10786        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10787                                    EC-AM-LF-MAX-TOT-BEN
 10788        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10789
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 197
* EL050.cbl
 10790     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10791
 10792     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10793         IF PL-LM-AGE (1) = ZEROS
 10794             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10795
 10796     IF NO-LF-BENEFIT-MATCH          OR
 10797        WS-LF-BENEFIT-CD = ZEROS     OR
 10798        WS-LF-SPECIAL-CALC-CD = 'M'
 10799        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10800
 10801     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10802     MOVE +1                     TO SUB2.
 10803
 10804     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10805        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10806           MOVE +5   TO SUB2
 10807           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10808              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10809              (PL-LM-AGE (SUB2) EQUAL +0)
 10810              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10811              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10812
 10813     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10814
 10815     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10816                               + PB-I-LF-ALT-BENEFIT-AMT.
 10817
 10818 0568-CHECK-LIFE-ATT-AGE.
 10819
 10820     IF PL-ATT-AGE NUMERIC AND
 10821        PL-ATT-AGE > +0
 10822        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10823     END-IF
 10824*    IF PL-ATT-AGE NUMERIC AND
 10825*       PL-ATT-AGE > +0
 10826*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10827*       IF PB-I-BIRTHDAY > LOW-VALUES
 10828*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10829*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10830*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10831*          SET BIN-PLUS-ELAPSED  TO TRUE
 10832*          PERFORM 8500-DATE-CONVERT
 10833*                                THRU 8500-EXIT
 10834*          IF NO-CONVERSION-ERROR
 10835*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10836*             MOVE ER-2669       TO WS-ERROR
 10837*             PERFORM 9900-ERROR-FORMAT
 10838*                                THRU 9900-EXIT
 10839*          END-IF
 10840*       ELSE
 10841*          IF WS-ATT-AGE >= PL-ATT-AGE
 10842*             MOVE ER-2669       TO WS-ERROR
 10843*             PERFORM 9900-ERROR-FORMAT
 10844*                                THRU 9900-EXIT
 10845*          END-IF
 10846*       END-IF
 10847*    END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 198
* EL050.cbl
 10848     .
 10849 0570-CHECK-LIFE-LIMITS.
 10850
 10851     IF PB-COMPANY-ID EQUAL 'CRI'
 10852        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10853           IF SUB2 GREATER THAN +4
 10854              MOVE ER-2637 TO WS-ERROR
 10855              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10856              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10857
 10858     IF PB-COMPANY-ID  =  'NCL'
 10859        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10860            SUB2 GREATER THAN +8
 10861             MOVE 'U'         TO PB-BATCH-ENTRY
 10862             MOVE ER-2637     TO WS-ERROR
 10863             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10864             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10865
 10866     IF SUB2 > +8
 10867        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10868           AND (PB-I-SIG-SW = 'Y')
 10869           CONTINUE
 10870        ELSE
 10871           MOVE ER-2637          TO WS-ERROR
 10872           PERFORM 9900-ERROR-FORMAT
 10873                                 THRU 9900-EXIT
 10874        END-IF
 10875        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10876     END-IF
 10877     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10878     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10879     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10880
 10881     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10882        ADD +1  TO SUB2
 10883        GO TO 0570-CHECK-LIFE-LIMITS.
 10884
 10885     IF PB-COMPANY-ID = 'NCL'
 10886         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10887
 10888     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10889        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10890        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10891           AND (PB-I-SIG-SW = 'Y')
 10892           CONTINUE
 10893        ELSE
 10894           MOVE ER-2637          TO WS-ERROR
 10895           PERFORM 9900-ERROR-FORMAT
 10896                                 THRU 9900-EXIT
 10897        END-IF
 10898     END-IF
 10899     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10900
 10901
 10902 0570-CHECK-NCL-LIFE-LIMITS.
 10903
 10904     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10905        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 199
* EL050.cbl
 10906         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10907
 10908     IF APP-CERT-USED
 10909         IF SUB2  LESS THAN  +5
 10910             MOVE +5          TO SUB2
 10911             GO TO 0570-CHECK-LIFE-LIMITS.
 10912
 10913     MOVE ER-2637             TO WS-ERROR.
 10914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10915
 10916     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10917
 10918 0575-CHECK-NCL-SIG-SWITCH.
 10919
 10920     IF NOT APP-CERT-USED
 10921         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10922
 10923     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10924        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10925        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10926        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10927         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10928
 10929     IF SUB2 GREATER THAN +4
 10930         IF PL-LM-AGE (5) = ZEROS  AND
 10931            PL-LM-AGE (6) = ZEROS  AND
 10932            PL-LM-AGE (7) = ZEROS  AND
 10933            PL-LM-AGE (8) = ZEROS
 10934             MOVE  ER-1927        TO WS-ERROR
 10935             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10936             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10937         ELSE
 10938             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10939                 MOVE  ER-1920    TO WS-ERROR
 10940                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10941
 10942     IF PB-I-SIG-SW  = 'Y'
 10943       IF NOT PB-I-POLICY-ACCEPTED  AND
 10944          NOT PB-I-POLICY-DECLINED
 10945           MOVE 'U'               TO PB-BATCH-ENTRY
 10946           MOVE  ER-1926          TO WS-ERROR
 10947           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10948
 10949
 10950 0580-AH-PLAN-LIMIT-EDITS.
 10951
 10952     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10953        IF PB-I-AH-BENEFIT-AMT > +1250
 10954           MOVE ER-2702          TO WS-ERROR
 10955           PERFORM 9900-ERROR-FORMAT
 10956                                 THRU 9900-EXIT
 10957        END-IF
 10958     END-IF
 10959
 10960     IF (PB-COMPANY-ID = 'DCC')
 10961        AND (PB-MONTHLY-CERT)
 10962        IF PB-I-AH-BENEFIT-AMT > +3000
 10963           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 200
* EL050.cbl
 10964           PERFORM 9900-ERROR-FORMAT
 10965                                 THRU 9900-EXIT
 10966        END-IF
 10967     END-IF
 10968     IF NOT AH-PLAN-MASTER-FOUND
 10969        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10970        GO TO 3000-CONTINUE-EDIT.
 10971
 10972     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10973
 10974     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10975         IF PL-LM-AGE (1) = ZEROS
 10976             GO TO 3000-CONTINUE-EDIT.
 10977
 10978     IF NO-AH-BENEFIT-MATCH          OR
 10979        WS-AH-BENEFIT-CD = ZEROS     OR
 10980        WS-AH-SPECIAL-CALC-CD = 'M'
 10981        GO TO 3000-CONTINUE-EDIT.
 10982
 10983     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10984     MOVE +1                     TO SUB2.
 10985
 10986     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10987        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10988           MOVE +5 TO SUB2
 10989           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10990              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10991              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10992              (PL-LM-AGE (SUB2) EQUAL +0)
 10993              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10994              GO TO 3000-CONTINUE-EDIT.
 10995
 10996     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10997
 10998 0590-CHECK-AH-ATT-AGE.
 10999
 11000     IF PL-ATT-AGE NUMERIC AND
 11001        PL-ATT-AGE GREATER THAN +0
 11002        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11003     END-IF
 11004*       IF WS-ATT-AGE >= PL-ATT-AGE
 11005*          MOVE ER-3054          TO WS-ERROR
 11006*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11007     .
 11008 0597-CHECK-AH-LIMITS.
 11009
 11010     IF PB-COMPANY-ID EQUAL 'CRI'
 11011        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11012           IF SUB2 GREATER THAN +4
 11013              MOVE ER-2638       TO WS-ERROR
 11014              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11015              GO TO 3000-CONTINUE-EDIT.
 11016
 11017     IF PB-COMPANY-ID  =  'NCL'
 11018        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11019            SUB2 GREATER THAN +8
 11020             MOVE 'U'            TO PB-BATCH-ENTRY
 11021             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 201
* EL050.cbl
 11022             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11023             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11024
 11025     IF SUB2 > +8
 11026        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11027           AND (PB-I-SIG-SW = 'Y')
 11028           CONTINUE
 11029        ELSE
 11030           MOVE ER-2638          TO WS-ERROR
 11031           PERFORM 9900-ERROR-FORMAT
 11032                                 THRU 9900-EXIT
 11033        END-IF
 11034        GO TO 3000-CONTINUE-EDIT
 11035     END-IF
 11036
 11037     IF PB-COMPANY-ID = 'CRI'
 11038        IF WS-ERROR = ER-2638
 11039           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11040
 11041     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11042     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11043     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11044     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11045
 11046     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11047        ADD +1                   TO SUB2
 11048        GO TO 0597-CHECK-AH-LIMITS.
 11049
 11050     IF PB-COMPANY-ID = 'NCL'
 11051         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11052
 11053     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11054        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11055        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11056                                 > PL-LM-AMT (SUB2))
 11057        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11058           AND (PB-I-SIG-SW = 'Y')
 11059           CONTINUE
 11060        ELSE
 11061           MOVE ER-2638          TO WS-ERROR
 11062           PERFORM 9900-ERROR-FORMAT
 11063                                 THRU 9900-EXIT
 11064        END-IF
 11065     END-IF
 11066
 11067     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11068         IF  WS-ERROR    EQUAL    ER-2638
 11069             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11070                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11071                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11072                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11073                MOVE  ER-1910    TO  WS-ERROR
 11074                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11075
 11076     IF PB-COMPANY-ID = 'CRI'
 11077        IF WS-ERROR = ER-2638
 11078            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11079            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 202
* EL050.cbl
 11080            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11081
 11082     GO TO 3000-CONTINUE-EDIT.
 11083
 11084 0597-CHECK-NCL-AH-LIMITS.
 11085
 11086     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11087        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11088        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11089                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11090         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11091
 11092     IF APP-CERT-USED
 11093         IF SUB2  LESS THAN  +5
 11094             MOVE +5             TO SUB2
 11095             GO TO 0597-CHECK-AH-LIMITS.
 11096
 11097     MOVE ER-2638                TO WS-ERROR.
 11098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11099
 11100     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11101
 11102 0599-CHECK-NCL-SIG-SWITCH.
 11103
 11104     IF NOT APP-CERT-USED
 11105         GO TO 3000-CONTINUE-EDIT.
 11106
 11107     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11108        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11109        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11110        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11111         GO TO 3000-CONTINUE-EDIT.
 11112
 11113     IF SUB2 GREATER THAN +4
 11114         IF PL-LM-AGE (5) = ZEROS  AND
 11115            PL-LM-AGE (6) = ZEROS  AND
 11116            PL-LM-AGE (7) = ZEROS  AND
 11117            PL-LM-AGE (8) = ZEROS
 11118             MOVE  ER-1927        TO WS-ERROR
 11119             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11120             GO TO 3000-CONTINUE-EDIT
 11121         ELSE
 11122             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11123                 MOVE  ER-1920    TO WS-ERROR
 11124                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11125
 11126     IF PB-I-SIG-SW  = 'Y'
 11127       IF NOT PB-I-POLICY-ACCEPTED  AND
 11128          NOT PB-I-POLICY-DECLINED
 11129           MOVE 'U'               TO PB-BATCH-ENTRY
 11130           MOVE  ER-1926          TO WS-ERROR
 11131           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11132
 11133******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 203
* EL050.cbl
 11135
 11136 3000-CONTINUE-EDIT.
 11137
 11138     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11139     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11140     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11141     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11142     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11143
 11144     IF BROWSE-STARTED
 11145        PERFORM 9990-RETURN THRU 9990-EXIT
 11146        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11147
 11148     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11149        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11150        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11151        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11152*       MOVE 1                   TO DC-OPTION-CODE
 11153        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11154        IF DATE-CONVERSION-ERROR
 11155           MOVE ER-2622          TO WS-ERROR
 11156           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11157        ELSE
 11158           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11159              MOVE ER-2623       TO WS-ERROR
 11160              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11161           ELSE
 11162              MOVE ER-2622       TO WS-ERROR
 11163              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11164
 11165     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11166     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11167     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11168*    MOVE 1                      TO DC-OPTION-CODE.
 11169     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11170     IF DATE-CONVERSION-ERROR
 11171        GO TO 3005-EDIT-CONTINUE
 11172     ELSE
 11173        IF DC-ELAPSED-DAYS GREATER +180
 11174           MOVE ER-2613          TO WS-ERROR
 11175           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11176        ELSE
 11177           IF DC-ELAPSED-DAYS GREATER +90
 11178              MOVE ER-2612       TO WS-ERROR
 11179              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11180           ELSE
 11181             IF DC-ELAPSED-DAYS GREATER +60
 11182                MOVE ER-2614     TO WS-ERROR
 11183                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11184
 11185 3005-EDIT-CONTINUE.
 11186
 11187     IF PB-CANCELLATION
 11188         GO TO 3700-EDIT-CANCEL.
 11189
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 204
* EL050.cbl
 11191******************************************************************
 11192*                  E D I T   I S S U E                           *
 11193******************************************************************
 11194
 11195 3020-EDIT-ISSUE.
 11196
 11197      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11198      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11199      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11200      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11201      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11202
 11203     IF PB-ISSUE-FORCE
 11204        OR PB-ISSUE-DATE-FORCED
 11205        OR PB-FORCE-OFF
 11206        OR PB-OVERCHARGE-FORCE
 11207        CONTINUE
 11208     ELSE
 11209        MOVE ER-2670             TO WS-ERROR
 11210        PERFORM 9900-ERROR-FORMAT
 11211                                 THRU 9900-EXIT
 11212     END-IF
 11213     .
 11214 3022-SET-POLICY-STATUS.
 11215
 11216     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11217
 11218     IF (PB-REISSUED-CERT)
 11219             OR
 11220        ((PB-COMPANY-ID NOT = 'DCC')
 11221         AND (PB-MONTHLY-CERT))
 11222         MOVE '5'                TO PB-I-ENTRY-STATUS
 11223         MOVE 'E'                TO PB-BATCH-ENTRY
 11224     END-IF
 11225
 11226     IF PB-COMPANY-ID = 'DCC'
 11227        IF PB-MONTHLY-CERT
 11228           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11229        END-IF
 11230     END-IF
 11231     IF PB-POLICY-IS-DECLINED
 11232         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11233     IF PB-POLICY-IS-VOIDED
 11234         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11235     IF PB-NEEDS-UNDERWRITING
 11236         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11237     IF PB-REIN-ONLY-CERT
 11238         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11239     IF PB-PREM-ACCTNG-ONLY
 11240         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11241
 11242     MOVE SPACE                  TO PB-I-OB-FLAG.
 11243
 11244     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11245         MOVE ER-2665            TO WS-ERROR
 11246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11247         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11248
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 205
* EL050.cbl
 11249     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11250        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11251           MOVE 'Z'             TO PB-I-OB-FLAG.
 11252
 11253     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11254        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11255           MOVE 'Z'             TO PB-I-OB-FLAG.
 11256
 11257     IF ACCOUNT-MAST-FOUND
 11258         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11259         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11260         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11261         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11262         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11263         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11264         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11265     END-IF
 11266
 11267     IF ACCOUNT-MAST-FOUND
 11268        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11269         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11270
 11271     IF (ACCOUNT-MAST-FOUND)
 11272        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11273        IF PB-REISSUED-CERT
 11274           CONTINUE
 11275        ELSE
 11276           MOVE ER-2608          TO WS-ERROR
 11277           PERFORM 9900-ERROR-FORMAT
 11278                                 THRU 9900-EXIT
 11279         END-IF
 11280     END-IF
 11281
 11282     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11283        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11284        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11285
 11286**********   DMD CUSTOM CODE FOLLOWS  **********
 11287 3024-EDIT-DMD-FIELDS.
 11288     IF PB-COMPANY-ID NOT = 'DMD'
 11289        GO TO 3025-EDIT-REINSURANCE.
 11290
 11291*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11292*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11293*** ERROR IF THEY ARE NOT EQUAL.
 11294
 11295     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11296     SET BIN-TO-GREG               TO TRUE.
 11297     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11298     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11299**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11300
 11301     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11302     SET BIN-TO-GREG               TO TRUE.
 11303     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11304     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11305**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11306
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 206
* EL050.cbl
 11307     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11308        MOVE ER-8116               TO WS-ERROR
 11309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11310
 11311     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11312
 11313     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11314                                      WK-FULL-CERT-NO.
 11315     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11316
 11317     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11318
 11319     IF PB-VALID-LIFE
 11320        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11321     ELSE
 11322        IF PB-VALID-AH
 11323          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11324
 11325
 11326     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11327     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11328     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11329                                      DCUA-UNDRWRTR-CODE
 11330                                      DCUA-UNDRWRTR-GROUP-CODE
 11331                                      DCUA-RETURN-CODE.
 11332
 11333****************************************************************
 11334*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11335***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11336***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11337***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11338***   TO THIS RECORD.                                        ***
 11339****************************************************************
 11340     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11341     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11342     IF DCUA-SUCCESSFUL-PROCESS
 11343        GO TO 3024-EDIT-DL7-CONT.
 11344
 11345     IF DCUA-RETURN-CODE EQUAL '01'
 11346        MOVE ER-8110               TO WS-ERROR
 11347        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11349        GO TO 3024-EDIT-DL7-CONT.
 11350
 11351     IF DCUA-RETURN-CODE EQUAL '02'
 11352        MOVE ER-8111               TO WS-ERROR
 11353        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11354        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11355        GO TO 3024-EDIT-DL7-CONT.
 11356
 11357     IF DCUA-RETURN-CODE EQUAL '03'
 11358        MOVE ER-8074               TO WS-ERROR
 11359        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11361        GO TO 3024-EDIT-DL7-CONT.
 11362
 11363     IF DCUA-RETURN-CODE EQUAL '04'
 11364        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 207
* EL050.cbl
 11365        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11367        GO TO 3024-EDIT-DL7-CONT.
 11368
 11369     IF DCUA-RETURN-CODE EQUAL '05'
 11370        MOVE ER-8076               TO WS-ERROR
 11371        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11373        GO TO 3024-EDIT-DL7-CONT.
 11374
 11375     IF DCUA-RETURN-CODE EQUAL '06'
 11376        MOVE ER-8077               TO WS-ERROR
 11377        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11378        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11379        GO TO 3024-EDIT-DL7-CONT.
 11380
 11381     IF DCUA-RETURN-CODE EQUAL '07'
 11382        MOVE ER-8078               TO WS-ERROR
 11383        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11385        GO TO 3024-EDIT-DL7-CONT.
 11386
 11387     IF DCUA-RETURN-CODE EQUAL 'E1'
 11388        MOVE ER-8079               TO WS-ERROR
 11389        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11390        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11391        GO TO 3024-EDIT-DL7-CONT.
 11392
 11393     IF DCUA-RETURN-CODE EQUAL 'E2'
 11394        MOVE ER-8080               TO WS-ERROR
 11395        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11397        GO TO 3024-EDIT-DL7-CONT.
 11398
 11399     IF DCUA-RETURN-CODE EQUAL 'E3'
 11400        MOVE ER-8098               TO WS-ERROR
 11401        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11403        GO TO 3024-EDIT-DL7-CONT.
 11404
 11405     IF DCUA-RETURN-CODE EQUAL 'C1'
 11406        MOVE ER-8099               TO WS-ERROR
 11407        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11408        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11409        GO TO 3024-EDIT-DL7-CONT.
 11410
 11411     IF DCUA-RETURN-CODE EQUAL 'U1'
 11412        MOVE ER-8109               TO WS-ERROR
 11413        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11415        GO TO 3024-EDIT-DL7-CONT.
 11416
 11417     IF DCUA-RETURN-CODE EQUAL 'N1'
 11418        MOVE ER-8112               TO WS-ERROR
 11419        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11421        GO TO 3024-EDIT-DL7-CONT.
 11422
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 208
* EL050.cbl
 11423     IF DCUA-RETURN-CODE EQUAL 'N2'
 11424        MOVE ER-8113               TO WS-ERROR
 11425        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11426        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11427        GO TO 3024-EDIT-DL7-CONT.
 11428
 11429     IF DCUA-RETURN-CODE EQUAL 'N3'
 11430        MOVE ER-8114               TO WS-ERROR
 11431        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11433        GO TO 3024-EDIT-DL7-CONT.
 11434
 11435     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11436     MOVE ER-8097                  TO WS-ERROR.
 11437     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11438     GO TO 3024-EDIT-DL7-CONT.
 11439
 11440 3024-EDIT-DL7-CONT.
 11441
 11442     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11443     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11444     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11445        NEXT SENTENCE
 11446     ELSE
 11447        MOVE ER-9263               TO WS-ERROR
 11448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11449
 11450******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11451******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11452     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11453        NEXT SENTENCE
 11454     ELSE
 11455        MOVE ER-8039               TO WS-ERROR
 11456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11457
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 209
* EL050.cbl
 11459****************************************************************
 11460*** VALIDATE STATE  : DLO022                                 ***
 11461****************************************************************
 11462     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11463     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11464
 11465     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11466     IF DVSC-SUCCESSFUL-EDIT
 11467        GO TO 3024-EDIT-DL22-CONT.
 11468
 11469     IF DVSC-RETURN-CODE EQUAL '01'
 11470        MOVE ER-8300               TO WS-ERROR
 11471        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11472        GO TO 3024-EDIT-DL22-CONT.
 11473
 11474     IF DVSC-RETURN-CODE EQUAL '02'
 11475        MOVE ER-8301               TO WS-ERROR
 11476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11477        GO TO 3024-EDIT-DL22-CONT.
 11478
 11479     IF DVSC-RETURN-CODE EQUAL '03'
 11480        MOVE ER-8302               TO WS-ERROR
 11481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11482        GO TO 3024-EDIT-DL22-CONT.
 11483
 11484     IF DVSC-RETURN-CODE EQUAL 'N1'
 11485        MOVE ER-8304               TO WS-ERROR
 11486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11487        GO TO 3024-EDIT-DL22-CONT.
 11488
 11489     MOVE ER-8303                  TO WS-ERROR
 11490     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11491
 11492 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 210
* EL050.cbl
 11494****************************************************************
 11495*** VALIDATE LOAN OFFICER : DLO021                           ***
 11496****************************************************************
 11497
 11498     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11499     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11500     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11501     IF DVLO-SUCCESSFUL-EDIT
 11502        GO TO 3024-EDIT-DL21-CONT.
 11503
 11504     IF DVLO-RETURN-CODE EQUAL '01'
 11505        MOVE ER-8081               TO WS-ERROR
 11506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507        GO TO 3024-EDIT-DL21-CONT.
 11508
 11509     IF DVLO-RETURN-CODE EQUAL '02'
 11510        MOVE ER-8082               TO WS-ERROR
 11511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11512        GO TO 3024-EDIT-DL21-CONT.
 11513
 11514     IF DVLO-RETURN-CODE EQUAL '03'
 11515        MOVE ER-8083               TO WS-ERROR
 11516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11517        GO TO 3024-EDIT-DL21-CONT.
 11518
 11519     IF DVLO-RETURN-CODE EQUAL '04'
 11520        MOVE ER-8084               TO WS-ERROR
 11521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11522        GO TO 3024-EDIT-DL21-CONT.
 11523
 11524     IF DVLO-RETURN-CODE EQUAL '05'
 11525        MOVE ER-8085               TO WS-ERROR
 11526        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11527        GO TO 3024-EDIT-DL21-CONT.
 11528
 11529     MOVE ER-7825                  TO WS-ERROR
 11530     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11531     GO TO 3024-EDIT-DL21-CONT.
 11532
 11533 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 211
* EL050.cbl
 11535
 11536****************************************************************
 11537*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11538****************************************************************
 11539
 11540     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11541     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11542     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11543     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11544     IF DIPF-SUCCESSFUL-EDIT
 11545        GO TO 3024-EDIT-DL02-CONT.
 11546
 11547     IF DIPF-RETURN-CODE EQUAL '01'
 11548        MOVE ER-8086               TO WS-ERROR
 11549        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11550        GO TO 3024-EDIT-DL02-CONT.
 11551
 11552     IF DIPF-RETURN-CODE EQUAL '02'
 11553        MOVE ER-8087               TO WS-ERROR
 11554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11555        GO TO 3024-EDIT-DL02-CONT.
 11556
 11557     IF DIPF-RETURN-CODE EQUAL '03'
 11558        MOVE ER-8088               TO WS-ERROR
 11559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11560        GO TO 3024-EDIT-DL02-CONT.
 11561
 11562     MOVE ER-8095                  TO WS-ERROR
 11563     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11564     GO TO 3024-EDIT-DL02-CONT.
 11565
 11566 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 212
* EL050.cbl
 11568
 11569****************************************************************
 11570*** VALIDATE BANK ID : DLO003                                ***
 11571****************************************************************
 11572
 11573     MOVE WK-GREG-CENT           TO WCG-CENT.
 11574     MOVE WK-GREG-YYMM           TO WCG-REST.
 11575     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11576        MOVE ER-8040               TO WS-ERROR
 11577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11578
 11579     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11580     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11581     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11582     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11583     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11584     IF DVBI-SUCCESSFUL-EDIT
 11585        GO TO 3024-EDIT-DL03-CONT.
 11586
 11587     IF DVBI-RETURN-CODE EQUAL '01'
 11588        MOVE ER-8089               TO WS-ERROR
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590        GO TO 3024-EDIT-DL03-CONT.
 11591
 11592     IF DVBI-RETURN-CODE EQUAL '02'
 11593        MOVE ER-8090               TO WS-ERROR
 11594        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11595        GO TO 3024-EDIT-DL03-CONT.
 11596
 11597     IF DVBI-RETURN-CODE EQUAL '03'
 11598        MOVE ER-8091               TO WS-ERROR
 11599        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11600        GO TO 3024-EDIT-DL03-CONT.
 11601
 11602     IF DVBI-RETURN-CODE EQUAL '04'
 11603        MOVE ER-8092               TO WS-ERROR
 11604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11605        GO TO 3024-EDIT-DL03-CONT.
 11606
 11607     IF DVBI-RETURN-CODE EQUAL '05'
 11608        MOVE ER-8093               TO WS-ERROR
 11609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11610        GO TO 3024-EDIT-DL03-CONT.
 11611
 11612     IF DVBI-RETURN-CODE EQUAL '06'
 11613        MOVE ER-8094               TO WS-ERROR
 11614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615        GO TO 3024-EDIT-DL03-CONT.
 11616
 11617     MOVE ER-8096                  TO WS-ERROR
 11618     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11619     GO TO 3024-EDIT-DL03-CONT.
 11620
 11621 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 213
* EL050.cbl
 11623
 11624     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11625        NEXT SENTENCE
 11626     ELSE
 11627        MOVE ER-8042               TO WS-ERROR
 11628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11629
 11630     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11631     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11632     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11633
 11634     IF DMPF-RETURN-CODE = '01'
 11635        MOVE ER-8067               TO WS-ERROR
 11636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11637        GO TO 3024-EDIT-DL01-CONT.
 11638
 11639     IF DMPF-RETURN-CODE = '02'
 11640        MOVE ER-8068               TO WS-ERROR
 11641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11642        GO TO 3024-EDIT-DL01-CONT.
 11643
 11644     IF DMPF-RETURN-CODE = '03'
 11645        MOVE ER-8069               TO WS-ERROR
 11646        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11647        GO TO 3024-EDIT-DL01-CONT.
 11648
 11649     IF DMPF-RETURN-CODE = 'E1'
 11650        MOVE ER-8070               TO WS-ERROR
 11651        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11652        GO TO 3024-EDIT-DL01-CONT.
 11653
 11654     IF DMPF-RETURN-CODE = 'N1'
 11655        MOVE ER-8071               TO WS-ERROR
 11656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11657        GO TO 3024-EDIT-DL01-CONT.
 11658
 11659     IF DMPF-RETURN-CODE NOT = 'OK'
 11660        MOVE ER-8072               TO WS-ERROR
 11661        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11662
 11663 3024-EDIT-DL01-CONT.
 11664******************************************************************
 11665***  VALIDATES RATE CODES : DLO017                             ***
 11666******************************************************************
 11667
 11668      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11669      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11670      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11671      IF DVRC-SUCCESSFUL-EDIT
 11672        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11673        GO TO 3024-CHECK-VALID-RATE.
 11674
 11675      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11676
 11677      IF DVRC-RETURN-CODE EQUAL '01'
 11678         MOVE ER-7817                   TO WS-ERROR
 11679         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11680         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 214
* EL050.cbl
 11681
 11682      IF DVRC-RETURN-CODE EQUAL '02'
 11683         MOVE ER-7818                   TO WS-ERROR
 11684         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11685         GO TO 3025-EDIT-REINSURANCE.
 11686
 11687      IF DVRC-RETURN-CODE EQUAL '03'
 11688         MOVE ER-7819                   TO WS-ERROR
 11689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11690         GO TO 3025-EDIT-REINSURANCE.
 11691
 11692       MOVE ER-7820                     TO WS-ERROR.
 11693       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11694       GO TO 3025-EDIT-REINSURANCE.
 11695
 11696******************************************************************
 11697***  GET PREMIUM RATES : DLO011                                ***
 11698******************************************************************
 11699
 11700 3024-CHECK-VALID-RATE.
 11701
 11702     IF VALID-RATE-CODE
 11703        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11704        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11705        MOVE SPACES                TO DPRB-RETURN-CODE
 11706        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11707     ELSE
 11708         GO TO 3025-EDIT-REINSURANCE.
 11709
 11710      IF DPRB-SUCCESSFUL-PROCESS
 11711         IF PB-VALID-LIFE
 11712             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11713             GO TO 3025-EDIT-REINSURANCE
 11714         ELSE
 11715             IF PB-VALID-AH
 11716                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11717                 GO TO 3025-EDIT-REINSURANCE.
 11718
 11719      IF DPRB-RETURN-CODE EQUAL '01'
 11720         MOVE ER-7812                   TO WS-ERROR
 11721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11722         GO TO 3025-EDIT-REINSURANCE.
 11723
 11724      IF DPRB-RETURN-CODE EQUAL '02'
 11725         MOVE ER-7813                   TO WS-ERROR
 11726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11727         GO TO 3025-EDIT-REINSURANCE.
 11728
 11729      IF DPRB-RETURN-CODE EQUAL '03'
 11730         MOVE ER-7814                   TO WS-ERROR
 11731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11732         GO TO 3025-EDIT-REINSURANCE.
 11733
 11734      IF DPRB-RETURN-CODE EQUAL '04'
 11735         IF NOT DPRB-1ST-TIME
 11736            MOVE ER-7815                   TO WS-ERROR
 11737            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11738            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 215
* EL050.cbl
 11739          ELSE
 11740         IF PB-VALID-LIFE
 11741            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11742          ELSE
 11743            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11744         END-IF
 11745         MOVE SPACES                TO DOCC-RETURN-CODE
 11746         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11747         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11748         IF DOCC-RETURN-CODE = 'OK'
 11749             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11750             GO TO 3024-CHECK-VALID-RATE
 11751           ELSE
 11752             MOVE ER-7823               TO WS-ERROR
 11753             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11754             GO TO 3025-EDIT-REINSURANCE.
 11755
 11756       MOVE ER-7816                     TO WS-ERROR.
 11757       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11758       GO TO 3025-EDIT-REINSURANCE.
 11759
 11760**********   DMD CUSTOM CODE ABOVE    **********
 11761
 11762 3025-EDIT-REINSURANCE.
 11763     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11764         GO TO 3027-EDIT-CONTINUE.
 11765
 11766     MOVE LOW-VALUES               TO ERREIN-KEY.
 11767     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11768     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11769                                      REIN-CODE-2
 11770                                      REIN-CODE-3.
 11771     MOVE 'A'                      TO REIN-TYPE.
 11772
 11773     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11774
 11775     MOVE '3026' TO REIN-SW.
 11776     MOVE ' '                   TO WS-REIN-READ-SW.
 11777
 11778     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11779     IF REIN-TABLE-NOT-FOUND
 11780         GO TO 3026-NO-SPEC-TABLE.
 11781
 11782     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11783     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11784                                   WS-NSP-ST-CD-LF.
 11785     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11786                                   WS-NSP-ST-CD-AH.
 11787
 11788     GO TO 3040-EDIT-CONTINUE.
 11789
 11790 3026-NO-SPEC-TABLE.
 11791
 11792     MOVE ER-2664                TO WS-ERROR.
 11793     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11794     GO TO 3040-EDIT-CONTINUE.
 11795
 11796 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 216
* EL050.cbl
 11797
 11798     IF PB-I-REIN-TABLE = SPACES
 11799       GO TO 3040-EDIT-CONTINUE.
 11800
 11801     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11802          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11803          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11804           GO TO 3040-EDIT-CONTINUE.
 11805
 11806     MOVE LOW-VALUES            TO ERREIN-KEY.
 11807     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11808     MOVE 'A'                   TO REIN-TYPE.
 11809     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11810
 11811     MOVE '3028'                TO REIN-SW.
 11812     MOVE ' '                   TO WS-REIN-READ-SW.
 11813
 11814     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11815     IF REIN-TABLE-NOT-FOUND
 11816         GO TO 3028-NO-REIN-TABLE.
 11817
 11818     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11819     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11820                                   WS-NSP-ST-CD-LF.
 11821     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11822                                   WS-NSP-ST-CD-AH.
 11823
 11824     GO TO 3040-EDIT-CONTINUE.
 11825
 11826 3028-NO-REIN-TABLE.
 11827
 11828     MOVE ER-2615                TO WS-ERROR.
 11829     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11830     GO TO 3040-EDIT-CONTINUE.
 11831
 11832 3040-EDIT-CONTINUE.
 11833
 11834     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11835         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11836
 11837     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11838         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11839
 11840     IF (NOT PB-REISSUED-CERT)
 11841        AND (NOT PB-MONTHLY-CERT)
 11842        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11843            MOVE '001'           TO PB-I-LF-TERM
 11844            MOVE 'M'             TO PB-I-INSURED-SEX.
 11845
 11846     IF (NOT PB-REISSUED-CERT)
 11847        AND (NOT PB-MONTHLY-CERT)
 11848        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11849            MOVE '001'           TO PB-I-AH-TERM
 11850            MOVE 'M'             TO PB-I-INSURED-SEX.
 11851
 11852 3040-EDIT-1ST-PMT-DT.
 11853     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11854     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 217
* EL050.cbl
 11855         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11856
 11857******************************************************************
 11858*                                                                *
 11859*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11860*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11861*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11862*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11863*                                                                *
 11864******************************************************************
 11865
 11866     IF PB-EFF-DT-PROCESSING
 11867        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11868                                    PB-I-LF-EXPIRE-DT
 11869                                    PB-I-AH-EXPIRE-DT
 11870        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11871        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11872        MOVE ZERO                TO DC-ELAPSED-DAYS
 11873        MOVE +1                  TO DC-ELAPSED-MONTHS
 11874        SET BIN-PLUS-ELAPSED     TO TRUE
 11875*       MOVE 6                   TO DC-OPTION-CODE
 11876        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11877        IF NO-CONVERSION-ERROR
 11878           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11879
 11880******************************************************************
 11881*                                                                *
 11882*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11883*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11884*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11885*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11886*                                                                *
 11887******************************************************************
 11888
 11889     IF PB-EXT-DAYS-PROCESSING
 11890          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11891                                         PB-I-LF-EXPIRE-DT
 11892                                         PB-I-AH-EXPIRE-DT
 11893          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11894          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11895          MOVE +1                     TO DC-ELAPSED-MONTHS
 11896          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11897          SET BIN-PLUS-ELAPSED        TO TRUE
 11898*         MOVE 6                      TO DC-OPTION-CODE
 11899          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11900          IF NO-CONVERSION-ERROR
 11901             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11902
 11903******************************************************************
 11904*                                                                *
 11905*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11906*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11907*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11908*        (EXPIRE DATE - (TERM -1))  *  -1.
 11909*                                                                *
 11910******************************************************************
 11911
 11912     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 218
* EL050.cbl
 11913        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11914           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11915              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11916              MOVE PB-I-AH-TERM      TO WS-TERM
 11917           ELSE
 11918              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11919              MOVE PB-I-LF-TERM      TO WS-TERM
 11920        ELSE
 11921           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11922              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11923              MOVE PB-I-LF-TERM      TO WS-TERM
 11924           ELSE
 11925              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11926              MOVE PB-I-AH-TERM      TO WS-TERM.
 11927
 11928     IF PB-EXPIRE-DT-PROCESSING
 11929        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11930        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11931        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11932        MOVE ZERO                TO DC-ELAPSED-DAYS
 11933                                    DC-ODD-DAYS-OVER
 11934          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11935          SET BIN-PLUS-ELAPSED    TO TRUE
 11936*         MOVE 6                  TO DC-OPTION-CODE
 11937          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11938          IF NO-CONVERSION-ERROR
 11939             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11940
 11941******************************************************************
 11942*                                                                *
 11943*            1ST PAYMENT DATE PROCESSING                         *
 11944*                                                                *
 11945******************************************************************
 11946
 11947     IF PB-1ST-PMT-DT-PROCESSING
 11948        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11949                                    PB-I-AH-EXPIRE-DT
 11950        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11951
 11952     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11953         NEXT SENTENCE
 11954     ELSE
 11955         MOVE ER-2680                 TO WS-ERROR
 11956         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11957         GO TO 3060-ORIG-TERM-CHECK.
 11958
 11959     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11960     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11961     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11962*    MOVE 1                      TO DC-OPTION-CODE.
 11963     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11964                                    DC-ELAPSED-DAYS
 11965                                    DC-ODD-DAYS-OVER.
 11966
 11967     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11968
 11969     IF DATE-CONVERSION-ERROR
 11970        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 219
* EL050.cbl
 11971
 11972     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11973     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11974        AND (WS-LF-COVERAGE-TYPE = 'L')
 11975        IF (DC-ELAPSED-MONTHS > 1)
 11976                      OR
 11977           ((DC-ELAPSED-MONTHS = 1)
 11978           AND (DC-ODD-DAYS-OVER > 0))
 11979           MOVE ER-2882          TO WS-ERROR
 11980           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11981        END-IF
 11982     END-IF
 11983     if dc-elapsed-months > 0
 11984        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 11985        + dc-odd-days-over
 11986     end-if
 11987     IF PB-EXT-DAYS-PROCESSING
 11988        CONTINUE
 11989     ELSE
 11990        IF DC-ELAPSED-MONTHS = +0
 11991           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11992        ELSE
 11993           IF (WS-LF-EARNINGS-CALC = '4')
 11994              AND (DC-ELAPSED-MONTHS > ZERO)
 11995              AND (DC-ELAPSED-DAYS > ZERO)
 11996              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11997           ELSE
 11998              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11999                                 THRU 6499-EXIT
 12000              MOVE WS-ODD-DAYS-OVER
 12001                                 TO PB-I-EXTENTION-DAYS
 12002           END-IF
 12003        END-IF
 12004     END-IF
 12005******************************************************************
 12006*                                                                *
 12007*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12008*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12009*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12010*            AND ANY ODD DAYS.                                   *
 12011*                                                                *
 12012******************************************************************
 12013
 12014     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12015                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12016     IF WS-LF-EARNINGS-CALC NOT = '4'
 12017        IF DC-ELAPSED-DAYS > ZEROS
 12018           MOVE ER-2681          TO WS-ERROR
 12019           PERFORM 9900-ERROR-FORMAT
 12020                                 THRU 9900-EXIT
 12021        END-IF
 12022     END-IF
 12023
 12024     IF WS-LF-EARNINGS-CALC NOT = '4'
 12025        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12026           MOVE ER-2681          TO WS-ERROR
 12027           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12028
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 220
* EL050.cbl
 12029     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12030        (PB-I-LF-TERM NOT = ZERO) AND
 12031         NOT NO-LIFE-COVERAGE
 12032          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12033          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12034          IF WS-LF-EARNINGS-CALC = '4'
 12035             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12036             PB-I-PAY-FREQUENCY
 12037          END-IF
 12038          MOVE ZERO              TO DC-ELAPSED-DAYS
 12039                                    DC-ODD-DAYS-OVER
 12040          MOVE 1                 TO DC-END-OF-MONTH
 12041          SET BIN-PLUS-ELAPSED        TO TRUE
 12042*         MOVE 6                 TO DC-OPTION-CODE
 12043          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12044          IF NO-CONVERSION-ERROR
 12045             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12046             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12047                (WS-LF-SPECIAL-CALC-CD = 'L')
 12048                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12049                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12050                  MOVE +1             TO DC-ELAPSED-MONTHS
 12051                  SET BIN-PLUS-ELAPSED  TO TRUE
 12052*                 MOVE 6              TO DC-OPTION-CODE
 12053                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12054                  IF NO-CONVERSION-ERROR
 12055                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12056
 12057* okay, i had to move the new att age edit down here because the
 12058* expiration date could get recalculated and i need the exp date
 12059     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12060        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12061        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12062        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12063           AND ZEROS
 12064           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12065           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12066           SET ELAPSED-BETWEEN-BIN TO TRUE
 12067           PERFORM 8500-DATE-CONVERT
 12068                                 THRU 8500-EXIT
 12069           IF NO-CONVERSION-ERROR
 12070              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12071                 MOVE ER-2669       TO WS-ERROR
 12072*                PERFORM 9900-ERROR-FORMAT
 12073*                                THRU 9900-EXIT
 12074              END-IF
 12075           END-IF
 12076        ELSE
 12077           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12078           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12079              MOVE ER-2669       TO WS-ERROR
 12080*             PERFORM 9900-ERROR-FORMAT
 12081*                                THRU 9900-EXIT
 12082           ELSE
 12083              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12084                 MOVE ER-1570    TO WS-ERROR
 12085                 PERFORM 9900-ERROR-FORMAT
 12086                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 221
* EL050.cbl
 12087              END-IF
 12088           END-IF
 12089        END-IF
 12090        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12091           AND ZEROS
 12092           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12093           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12094           SET ELAPSED-BETWEEN-BIN TO TRUE
 12095           PERFORM 8500-DATE-CONVERT
 12096                                 THRU 8500-EXIT
 12097           IF NO-CONVERSION-ERROR
 12098              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12099                 MOVE ER-2669       TO WS-ERROR
 12100*                PERFORM 9900-ERROR-FORMAT
 12101*                                THRU 9900-EXIT
 12102              END-IF
 12103           END-IF
 12104        ELSE
 12105           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12106             (PB-I-LF-TERM / 12)
 12107           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12108              MOVE ER-2669       TO WS-ERROR
 12109*             PERFORM 9900-ERROR-FORMAT
 12110*                                THRU 9900-EXIT
 12111           ELSE
 12112              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12113                 MOVE ER-1571    TO WS-ERROR
 12114                 PERFORM 9900-ERROR-FORMAT
 12115                                 THRU 9900-EXIT
 12116              END-IF
 12117           END-IF
 12118        END-IF
 12119        IF WS-ERROR = ER-2669
 12120           PERFORM 9900-ERROR-FORMAT
 12121                                 THRU 9900-EXIT
 12122        END-IF
 12123     END-IF
 12124     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12125        (PB-I-AH-TERM NOT = ZERO) AND
 12126         NOT NO-AH-COVERAGE
 12127          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12128             AND (PB-COMPANY-ID = 'DCC')
 12129             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12130             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12131          ELSE
 12132             IF WS-LF-EARNINGS-CALC = '4'
 12133                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12134                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12135                PB-I-PAY-FREQUENCY
 12136             ELSE
 12137                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12138                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12139             END-IF
 12140          END-IF
 12141          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12142                                         DC-ODD-DAYS-OVER
 12143          MOVE 1                      TO DC-END-OF-MONTH
 12144          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 222
* EL050.cbl
 12145*         MOVE 6                      TO DC-OPTION-CODE
 12146          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12147          IF NO-CONVERSION-ERROR
 12148             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12149     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12150        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12151        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12152        IF PB-I-BIRTHDAY > LOW-VALUES
 12153           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12154           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12155           SET ELAPSED-BETWEEN-BIN TO TRUE
 12156           PERFORM 8500-DATE-CONVERT
 12157                                 THRU 8500-EXIT
 12158           IF NO-CONVERSION-ERROR
 12159              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12160                 MOVE ER-3054       TO WS-ERROR
 12161*                PERFORM 9900-ERROR-FORMAT
 12162*                                THRU 9900-EXIT
 12163              END-IF
 12164           END-IF
 12165        ELSE
 12166           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12167           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12168              MOVE ER-3054       TO WS-ERROR
 12169*             PERFORM 9900-ERROR-FORMAT
 12170*                                THRU 9900-EXIT
 12171           END-IF
 12172        END-IF
 12173        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12174           AND ZEROS
 12175           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12176           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12177           SET ELAPSED-BETWEEN-BIN TO TRUE
 12178           PERFORM 8500-DATE-CONVERT
 12179                                 THRU 8500-EXIT
 12180           IF NO-CONVERSION-ERROR
 12181              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12182                 MOVE ER-3054       TO WS-ERROR
 12183*                PERFORM 9900-ERROR-FORMAT
 12184*                                THRU 9900-EXIT
 12185              END-IF
 12186           END-IF
 12187        ELSE
 12188           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12189             (PB-I-AH-TERM / 12)
 12190           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12191              MOVE ER-3054       TO WS-ERROR
 12192*             PERFORM 9900-ERROR-FORMAT
 12193*                                THRU 9900-EXIT
 12194           END-IF
 12195        END-IF
 12196        IF WS-ERROR = ER-3054
 12197           PERFORM 9900-ERROR-FORMAT
 12198                                 THRU 9900-EXIT
 12199        END-IF
 12200     END-IF
 12201     MOVE SPACE                       TO DC-END-OF-MONTH.
 12202
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 223
* EL050.cbl
 12203     IF PB-COMPANY-ID = 'NCB'
 12204        GO TO 3040-EDIT-EXTENSION-DAYS.
 12205
 12206     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12207       AND
 12208        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12209        NEXT SENTENCE
 12210     ELSE
 12211        GO TO 3040-EDIT-EXTENSION-DAYS.
 12212
 12213     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12214        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12215        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12216     ELSE
 12217        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12218        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12219
 12220     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12221*    MOVE '1'      TO DC-OPTION-CODE
 12222     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12223     IF (NO-CONVERSION-ERROR)
 12224        AND (DC-ELAPSED-MONTHS > +1)
 12225        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12226        MOVE ER-2668   TO WS-ERROR
 12227        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12228
 12229 3040-EDIT-EXTENSION-DAYS.
 12230
 12231     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12232        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12233         GO TO 3050-EDIT-TERM-IN-DAYS
 12234     ELSE
 12235         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12236
 12237     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12238         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12239     ELSE
 12240        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12241           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12242           MOVE ER-2681         TO WS-ERROR
 12243           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12244
 12245     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12246        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12247        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12248         GO TO 3060-ORIG-TERM-CHECK.
 12249
 12250     GO TO 3060-ORIG-TERM-CHECK.
 12251
 12252 3050-EDIT-TERM-IN-DAYS.
 12253
 12254     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12255
 12256     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12257         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12258     ELSE
 12259         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12260            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 224
* EL050.cbl
 12261            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12262
 12263     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12264                                       REMAINDER WS-WORK-TERM.
 12265     IF WS-WORK-TERM GREATER THAN ZERO
 12266         ADD +1 TO PB-I-LF-TERM.
 12267
 12268     IF NOT NO-AH-COVERAGE
 12269         MOVE ER-2684            TO WS-ERROR
 12270         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12271
 12272
 12273 3060-ORIG-TERM-CHECK.
 12274
 12275******************************************************************
 12276*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12277******************************************************************
 12278
 12279     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12280        NEXT SENTENCE
 12281     ELSE
 12282        IF NOT NO-LIFE-COVERAGE
 12283           IF PB-I-LF-TERM NUMERIC
 12284              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12285              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12286              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12287                  NEXT SENTENCE
 12288           ELSE
 12289              MOVE ER-2647       TO WS-ERROR
 12290              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12291
 12292     IF NOT NO-AH-COVERAGE
 12293         IF PB-I-AH-TERM NUMERIC
 12294            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12295            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12296            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12297             NEXT SENTENCE
 12298          ELSE
 12299              MOVE ER-2658       TO WS-ERROR
 12300              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12301
 12302     IF PB-COMPANY-ID = 'NCB'
 12303        GO TO 3070-LOAN-TERM-CHECK.
 12304
 12305     IF POLICY-HAS-AH
 12306       AND
 12307        POLICY-HAS-LIFE
 12308       AND
 12309        PB-I-LF-TERM NUMERIC
 12310       AND
 12311        PB-I-AH-TERM NUMERIC
 12312        NEXT SENTENCE
 12313     ELSE
 12314        GO TO 3070-LOAN-TERM-CHECK.
 12315
 12316     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12317     IF WS-TEX-FACT-2 LESS THAN +0
 12318        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 225
* EL050.cbl
 12319
 12320     IF WS-TEX-FACT-2 GREATER THAN +1
 12321        MOVE ER-2668             TO WS-ERROR
 12322        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12323
 12324 3070-LOAN-TERM-CHECK.
 12325
 12326     IF (WS-LF-BENEFIT-CD = ZERO)
 12327         OR (NO-LF-BENEFIT-MATCH)
 12328            GO TO 3125-EDIT-PMT-FREQ.
 12329*    IF PB-COMPANY-ID NOT = 'DCC'
 12330*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12331*          AND 'V' AND 'W' AND 'X'
 12332*          GO TO 3125-EDIT-PMT-FREQ
 12333*       END-IF
 12334*    ELSE
 12335*       IF WS-AH-DCC-TRUNC = 'T'
 12336*          CONTINUE
 12337*       ELSE
 12338*          GO TO 3125-EDIT-PMT-FREQ
 12339*       END-IF
 12340*    END-IF
 12341     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12342                    OR
 12343        ((PB-COMPANY-ID = 'DCC')
 12344        AND (WS-AH-DCC-TRUNC = 'T'))
 12345        CONTINUE
 12346     ELSE
 12347        GO TO 3125-EDIT-PMT-FREQ
 12348     END-IF
 12349     IF PB-I-LOAN-TERM NOT NUMERIC
 12350         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12351
 12352     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12353        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12354*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12355        PB-I-LOAN-TERM NOT GREATER THAN +360
 12356         NEXT SENTENCE
 12357     ELSE
 12358         MOVE ER-2648            TO WS-ERROR
 12359         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12360
 12361     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12362        MOVE ER-3058             TO WS-ERROR
 12363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12364     end-if
 12365
 12366     IF WS-STATE-ABBREVIATION = 'NC'
 12367        IF PB-I-LOAN-TERM > +59
 12368           CONTINUE
 12369        ELSE
 12370           MOVE ER-2792          TO WS-ERROR
 12371           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12372        END-IF
 12373     END-IF
 12374
 12375     .
 12376 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 226
* EL050.cbl
 12377     IF (WS-LF-BENEFIT-CD = ZERO)
 12378         OR (NO-LF-BENEFIT-MATCH)
 12379            GO TO 3127-EDIT-LOAN-OFFICER.
 12380     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12381                    OR
 12382        ((PB-COMPANY-ID = 'DCC')
 12383        AND (WS-AH-DCC-TRUNC = 'T'))
 12384                    OR
 12385         (PB-COMPANY-ID = 'AHL')
 12386        CONTINUE
 12387     ELSE
 12388        IF (PB-I-LOAN-TERM > ZEROS)
 12389           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12390           MOVE ER-1575          TO WS-ERROR
 12391           PERFORM 9900-ERROR-FORMAT
 12392                                 THRU 9900-EXIT
 12393        END-IF
 12394     END-IF
 12395     IF WS-LF-EARNINGS-CALC NOT = '4'
 12396         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12397            MOVE ER-2653         TO WS-ERROR
 12398            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12399            GO TO 3127-EDIT-LOAN-OFFICER
 12400         ELSE
 12401            GO TO 3127-EDIT-LOAN-OFFICER.
 12402
 12403     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12404         MOVE ER-2655            TO WS-ERROR
 12405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12406         GO TO 3127-EDIT-LOAN-OFFICER.
 12407
 12408     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12409         MOVE ER-2654            TO WS-ERROR
 12410         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12411         GO TO 3127-EDIT-LOAN-OFFICER.
 12412
 12413     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12414         GIVING WS-TEX-FACT-2
 12415             REMAINDER WS-TEX-FACT-3.
 12416
 12417*    IF WS-TEX-FACT-3 NOT = ZERO
 12418*       MOVE ER-2654             TO WS-ERROR
 12419*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12420
 12421
 12422 3127-EDIT-LOAN-OFFICER.
 12423
 12424     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12425        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12426           MOVE ER-2690          TO WS-ERROR
 12427           PERFORM 9900-ERROR-FORMAT
 12428                                 THRU 9900-EXIT
 12429        ELSE
 12430           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12431           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12432           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12433           MOVE PB-SV-STATE      TO LOFC-STATE
 12434           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 227
* EL050.cbl
 12435           MOVE PB-I-LOAN-OFFICER
 12436                                 TO LOFC-CODE
 12437           PERFORM 8586-READ-LOAN-OFFICER
 12438                                 THRU 8586-EXIT
 12439           IF (NOT LOFC-MASTER-FOUND)
 12440              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12441              MOVE ER-3006       TO WS-ERROR
 12442              PERFORM 9900-ERROR-FORMAT
 12443                                 THRU 9900-EXIT
 12444           END-IF
 12445        END-IF
 12446     END-IF
 12447     .
 12448 3129-EDIT-APR.
 12449
 12450     IF (WS-LF-BENEFIT-CD = ZERO)
 12451        OR (NO-LF-BENEFIT-MATCH)
 12452        IF PB-COMPANY-ID NOT = 'DCC'
 12453           GO TO 3130-EDIT-AGE
 12454*       ELSE
 12455*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12456*             GO TO 3130-EDIT-AGE
 12457*          END-IF
 12458        END-IF
 12459     END-IF
 12460
 12461     IF (WS-STATE-ABBREVIATION = 'OH')
 12462         AND (PB-I-RATE-CLASS NOT = 'L ')
 12463         AND (PB-I-LF-TERM GREATER THAN 60)
 12464         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12465         GO TO 3129-APR-CONT.
 12466
 12467     IF (WS-STATE-ABBREVIATION = 'RI')
 12468         AND (PB-I-LF-TERM GREATER THAN 60)
 12469         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12470         GO TO 3129-APR-CONT.
 12471
 12472     IF (WS-STATE-ABBREVIATION = 'UT')
 12473         AND (PB-I-LF-TERM GREATER THAN 62)
 12474         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12475         AND (PB-CERT-EFF-DT LESS WS-830901)
 12476         GO TO 3129-APR-CONT.
 12477
 12478     IF PB-COMPANY-ID = 'LAP'
 12479        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12480           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12481              MOVE ER-2656         TO WS-ERROR
 12482              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12483              GO TO 3130-EDIT-AGE.
 12484
 12485     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12486        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12487        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12488        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12489        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12490        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12491         GO TO 3130-EDIT-AGE.
 12492
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 228
* EL050.cbl
 12493 3129-APR-CONT.
 12494     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12495         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12496         GO TO 3130-EDIT-AGE.
 12497
 12498     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12499         WS-AH-BENEFIT-CD (1:1) = 'S')
 12500        AND (PB-COMPANY-ID = 'DCC')
 12501        AND (PB-I-LOAN-APR = ZERO)
 12502        MOVE ER-2657             TO WS-ERROR
 12503        PERFORM 9900-ERROR-FORMAT
 12504                                 THRU 9900-EXIT
 12505        GO TO 3130-EDIT-AGE
 12506     END-IF
 12507     IF PB-I-LOAN-APR = ZERO
 12508        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12509     END-IF
 12510
 12511     IF PB-I-LOAN-APR = ZERO
 12512        MOVE ER-2656             TO WS-ERROR
 12513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12514        GO TO 3130-EDIT-AGE.
 12515
 12516*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12517     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12518        MOVE ER-2657             TO WS-ERROR
 12519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12520
 12521 3130-EDIT-AGE.
 12522
 12523******************************************************************
 12524*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12525******************************************************************
 12526
 12527     IF NOT NO-LIFE-COVERAGE
 12528        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12529           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12530               MOVE ER-2628             TO WS-ERROR
 12531               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12532
 12533     IF NOT NO-AH-COVERAGE
 12534        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12535           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12536               MOVE ER-2628         TO WS-ERROR
 12537               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12538
 12539 3133-SEX-CODE.
 12540     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12541         IF WS-DEFAULT-SEX = 'M'
 12542             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12543          ELSE
 12544             IF WS-DEFAULT-SEX = 'F'
 12545             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12546
 12547     IF PB-I-INSURED-SEX = '1'
 12548         MOVE 'M' TO PB-I-INSURED-SEX.
 12549
 12550     IF PB-I-INSURED-SEX = '2'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 229
* EL050.cbl
 12551         MOVE 'F' TO PB-I-INSURED-SEX.
 12552
 12553 3134-SIG-SW-EDIT.
 12554     IF PB-I-SIG-SW = SPACE
 12555         MOVE 'N'                TO  PB-I-SIG-SW.
 12556
 12557     IF PB-COMPANY-ID = 'NCL'
 12558         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12559             NEXT SENTENCE
 12560         ELSE
 12561             MOVE ER-1923        TO  WS-ERROR
 12562             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12563     ELSE
 12564     IF PB-COMPANY-ID = 'CRI'
 12565         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12566             NEXT SENTENCE
 12567         ELSE
 12568             MOVE ER-2606        TO  WS-ERROR
 12569             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12570     ELSE
 12571     IF PB-COMPANY-ID = 'TMS'
 12572         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12573             NEXT SENTENCE
 12574         ELSE
 12575             MOVE ER-2689        TO  WS-ERROR
 12576             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12577     ELSE
 12578         IF PB-I-SIG-SW = 'Y' OR 'N'
 12579             NEXT SENTENCE
 12580         ELSE
 12581             MOVE ER-2651        TO  WS-ERROR
 12582             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12583
 12584     IF PB-COMPANY-ID = 'FLA'
 12585         IF (WS-EDIT-AGE GREATER 54  OR
 12586             WS-AH-EDIT-AGE GREATER 54)  AND
 12587            PB-I-SIG-SW = 'N'
 12588            MOVE ER-2651         TO  WS-ERROR
 12589            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12590
 12591 3135-NAME-EDIT.
 12592
 12593     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12594        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12595        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12596           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12597                                 TO PB-I-JOINT-FIRST-NAME
 12598        END-PERFORM
 12599     END-IF
 12600     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12601        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12602        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12603           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12604                                 TO PB-I-JOINT-LAST-NAME
 12605        END-PERFORM
 12606     END-IF
 12607     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12608        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 230
* EL050.cbl
 12609        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12610           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12611                                 TO PB-I-INSURED-FIRST-NAME
 12612        END-PERFORM
 12613     END-IF
 12614     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12615        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12616        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12617           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12618                                 TO PB-I-INSURED-LAST-NAME
 12619        END-PERFORM
 12620     END-IF
 12621     IF PB-I-INSURED-LAST-NAME = SPACES
 12622       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12623       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12624           MOVE ER-2660    TO WS-ERROR
 12625           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12626
 12627 3136-EDIT-SEX.
 12628
 12629******************************************************************
 12630*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12631******************************************************************
 12632
 12633     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12634        (WS-AH-SPECIAL-CALC-CD = 'O')
 12635        NEXT SENTENCE
 12636     ELSE
 12637        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12638           NEXT SENTENCE
 12639        ELSE
 12640           MOVE ER-2629            TO WS-ERROR
 12641           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12642
 12643 3137-EDIT-EFF-DATE.
 12644
 12645     IF PB-REISSUED-CERT       OR
 12646        PB-POLICY-IS-DECLINED  OR
 12647        PB-POLICY-IS-VOIDED
 12648         GO TO 3139-EDIT-COVERAGE-CODES.
 12649
 12650     MOVE SPACE                  TO WS-2671-SW
 12651                                    WS-2672-SW.
 12652
 12653     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12654         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12655             MOVE ER-2703        TO WS-ERROR
 12656             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12657             GO TO 3139-EDIT-COVERAGE-CODES.
 12658
 12659     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12660         GO TO 3139-EDIT-COVERAGE-CODES.
 12661
 12662     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12663     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12664*    MOVE '1'                    TO DC-OPTION-CODE.
 12665     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12666     MOVE +0                     TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 231
* EL050.cbl
 12667                                    DC-ELAPSED-DAYS.
 12668     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12669
 12670     IF DATE-CONVERSION-ERROR
 12671         GO TO 3139-EDIT-COVERAGE-CODES.
 12672
 12673     IF DC-ELAPSED-DAYS GREATER +180
 12674         MOVE ER-2672            TO WS-ERROR
 12675         MOVE 'Y'                TO WS-2672-SW
 12676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12677     END-IF
 12678
 12679     IF WS-ERROR = ER-2671  AND
 12680        PB-COMPANY-ID  = 'LBL'
 12681        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12682        MOVE SPACE               TO WS-2671-SW
 12683        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12684
 12685     IF PB-ISSUE-DATE-FORCED  AND
 12686      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12687         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12688         MOVE ER-2673            TO WS-ERROR
 12689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12690         MOVE SPACE              TO WS-2671-SW
 12691                                    WS-2672-SW.
 12692
 12693     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12694         IF PB-ISSUE-DATE-FORCED
 12695             MOVE ER-2600          TO  WS-ERROR
 12696             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12697         ELSE
 12698             MOVE ER-2692          TO  WS-ERROR
 12699             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12700
 12701
 12702 3139-EDIT-COVERAGE-CODES.
 12703
 12704     if pb-company-id not = 'AHL'
 12705        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12706           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12707           MOVE ER-2787          TO WS-ERROR
 12708           PERFORM 9900-ERROR-FORMAT
 12709                                 THRU 9900-EXIT
 12710        END-IF
 12711     end-if
 12712     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12713        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12714                                 > 250000.00
 12715           MOVE ER-2719          TO WS-ERROR
 12716           PERFORM 9900-ERROR-FORMAT
 12717                                 THRU 9900-EXIT
 12718        END-IF
 12719     END-IF
 12720
 12721     IF PB-POLICY-IS-DECLINED  OR
 12722        PB-POLICY-IS-VOIDED
 12723         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12724
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 232
* EL050.cbl
 12725     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12726        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12727         MOVE ER-2630                TO WS-ERROR
 12728         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12729
 12730     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12731        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12732        PB-I-LF-PREMIUM-AMT = ZERO
 12733         GO TO 3140-CHECK-AH-FOR-ZERO.
 12734
 12735     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12736        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12737        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12738         GO TO 3140-CHECK-AH-FOR-ZERO.
 12739
 12740     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12741        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12742        MOVE ER-2631             TO WS-ERROR
 12743        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12744     END-IF
 12745
 12746
 12747******************************************************************
 12748*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12749******************************************************************
 12750
 12751     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12752        NEXT SENTENCE
 12753     ELSE
 12754        IF PB-I-LF-BENEFIT-AMT = ZERO
 12755           MOVE ER-2632             TO WS-ERROR
 12756           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12757
 12758
 12759******************************************************************
 12760*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12761******************************************************************
 12762
 12763     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12764        CONTINUE
 12765     ELSE
 12766        IF PB-I-LF-PREMIUM-AMT = ZERO
 12767           IF (NOT PB-COMP-LF-PREM)
 12768              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12769              MOVE ER-2633       TO WS-ERROR
 12770              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12771           END-IF
 12772        END-IF
 12773     END-IF
 12774     .
 12775 3140-CHECK-AH-FOR-ZERO.
 12776
 12777     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12778        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12779        PB-I-AH-PREMIUM-AMT = ZERO
 12780         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12781
 12782     IF PB-COMPANY-ID = 'CSL'  AND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 233
* EL050.cbl
 12783        PB-I-AH-BENEFIT-CD = ZERO  AND
 12784        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12785        PB-I-AH-PREMIUM-AMT = ZERO
 12786         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12787
 12788     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12789        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12790        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12791         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12792
 12793     IF PB-I-AH-BENEFIT-CD = ZERO
 12794         MOVE ER-2634            TO WS-ERROR
 12795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12796
 12797******************************************************************
 12798*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12799******************************************************************
 12800
 12801     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12802        NEXT SENTENCE
 12803     ELSE
 12804        IF PB-I-AH-BENEFIT-AMT = ZERO
 12805           MOVE ER-2635             TO WS-ERROR
 12806           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12807
 12808******************************************************************
 12809*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12810******************************************************************
 12811
 12812     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12813        NEXT SENTENCE
 12814     ELSE
 12815        IF PB-I-AH-PREMIUM-AMT = ZERO
 12816            IF NOT PB-COMP-AH-PREM
 12817                MOVE ER-2636    TO WS-ERROR
 12818                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12819
 12820
 12821 3140-EDIT-MAX-AMT-SIZES.
 12822* CUSTOM CODE FOR CLIENT    'DMD'
 12823     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12824                                     WS-RES-MUNI-TAX
 12825                                     PB-I-STATE-TAX
 12826                                     PB-I-MUNI-TAX.
 12827
 12828     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12829
 12830     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12831        GO TO 3150-RATE-OUTSTAND-BAL.
 12832
 12833     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12834        GO TO 3150-RATE-OUTSTAND-BAL.
 12835
 12836     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12837        GO TO 3150-RATE-OUTSTAND-BAL.
 12838
 12839     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12840                             OR 'RIC')
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 234
* EL050.cbl
 12841        GO TO 3150-RATE-OUTSTAND-BAL.
 12842
 12843     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12844        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12845            GO TO 3150-RATE-OUTSTAND-BAL
 12846        ELSE
 12847           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12848               GO TO 3150-RATE-OUTSTAND-BAL.
 12849
 12850     IF NOT PB-NO-MONTHS-SKIPPED
 12851        GO TO 3150-RATE-OUTSTAND-BAL.
 12852
 12853     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12854        GO TO 3150-RATE-OUTSTAND-BAL.
 12855
 12856     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12857        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12858           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12859             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12860           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12861           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12862              MOVE ER-2693     TO WS-ERROR
 12863              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12864              GO TO 3150-RATE-OUTSTAND-BAL
 12865           ELSE
 12866              GO TO 3150-RATE-OUTSTAND-BAL.
 12867
 12868 3150-RATE-OUTSTAND-BAL.
 12869
 12870* DMD RATING TEST
 12871     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12872         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12873         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12874         MOVE ER-2687                 TO WS-ERROR
 12875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12876         MOVE 'B'                     TO PB-I-OB-FLAG
 12877         GO TO 3260-EDIT-CONTINUE.
 12878
 12879     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12880         IF  WS-ERROR    EQUAL    ER-2693
 12881             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12882                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12883                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12884                 MOVE  +0            TO  WS-ERROR.
 12885
 12886     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12887         IF  WS-ERROR    EQUAL    ER-2693
 12888             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12889                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12890                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12891                 MOVE  +0            TO  WS-ERROR.
 12892
 12893     IF PLAN-MASTER-AH-SW = 'Y'
 12894        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12895            IF  WS-ERROR    EQUAL    ER-2693
 12896              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12897                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12898                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 235
* EL050.cbl
 12899                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12900                 MOVE  ER-1910           TO  WS-ERROR
 12901                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12902
 12903     IF PLAN-MASTER-AH-SW = 'Y'
 12904        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12905            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12906               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12907               MOVE  ER-1910           TO  WS-ERROR
 12908               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12909
 12910     IF PLAN-MASTER-AH-SW = 'Y'
 12911        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12912            IF  WS-ERROR    EQUAL    ER-2693
 12913                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12914                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12915                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12916                 MOVE  +0       TO  WS-ERROR.
 12917
 12918     IF WS-ERROR = ER-2693
 12919        IF PB-COMPANY-ID = 'JAL' AND
 12920           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12921           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12922           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12923
 12924     IF WS-ERROR = ER-2693
 12925        IF PB-COMPANY-ID = 'NCL'  AND
 12926           PB-I-AH-BENEFIT-CD = 'OA'
 12927           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12928           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12929
 12930     IF WS-ERROR = ER-2693
 12931        IF PB-COMPANY-ID = 'CNL' AND
 12932           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12933           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12934           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12935
 12936     IF WS-ERROR = ER-2693
 12937        IF PB-COMPANY-ID = 'HER'
 12938           IF WS-LEVEL
 12939              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12940              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12941
 12942     IF ((LF-BENEFIT-FOUND) AND
 12943         (NOT NO-LIFE-COVERAGE)  AND
 12944         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12945       OR   ((AH-BENEFIT-FOUND) AND
 12946             (NOT NO-AH-COVERAGE)    AND
 12947             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12948         NEXT SENTENCE
 12949     ELSE
 12950         GO TO 3215-EDIT-RATES.
 12951
 12952     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12953        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12954           MOVE ER-2674          TO WS-ERROR
 12955           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12956           GO TO 3215-EDIT-RATES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 236
* EL050.cbl
 12957
 12958     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12959        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12960           MOVE ER-2674          TO WS-ERROR
 12961           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12962           GO TO 3215-EDIT-RATES.
 12963
 12964     MOVE 'B'                    TO PB-I-OB-FLAG.
 12965
 12966     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12967         NEXT SENTENCE
 12968     ELSE
 12969         IF NOT NO-LIFE-COVERAGE
 12970             IF WS-ACCT-LF-OB-RT = ZERO
 12971                MOVE ER-2641    TO WS-ERROR
 12972                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12973
 12974     IF PB-COMPANY-ID = 'CRI'
 12975       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12976         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12977         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12978         IF WS-ERROR = ER-2675
 12979            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12980            MOVE ER-2687              TO WS-ERROR
 12981            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12982         ELSE
 12983            MOVE ER-2687              TO WS-ERROR
 12984            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12985
 12986
 12987     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12988         NEXT SENTENCE
 12989     ELSE
 12990       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12991            NEXT SENTENCE
 12992       ELSE
 12993         IF NOT NO-AH-COVERAGE
 12994             IF WS-ACCT-AH-OB-RT = ZERO
 12995                MOVE ER-2642    TO WS-ERROR
 12996                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12997
 12998     IF PB-COMPANY-ID = 'CRI'
 12999       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13000         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13001         IF WS-ERROR = ER-2676
 13002            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13003            MOVE ER-2687              TO WS-ERROR
 13004            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13005         ELSE
 13006            MOVE ER-2687              TO WS-ERROR
 13007            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13008
 13009     IF PB-COMPANY-ID NOT = 'GIC'
 13010         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13011            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13012     ELSE
 13013         IF PB-I-LF-PREM-CALC = ZEROS
 13014             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 237
* EL050.cbl
 13015                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13016
 13017     IF PB-COMPANY-ID NOT = 'GIC'
 13018         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13019            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13020     ELSE
 13021         IF PB-I-AH-PREM-CALC = ZEROS
 13022             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13023                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13024
 13025     MOVE ZEROS TO PB-I-MORT-CODE.
 13026
 13027     GO TO 3260-EDIT-CONTINUE.
 13028
 13029
 13030 3215-EDIT-RATES.
 13031     IF ACCOUNT-MAST-FOUND
 13032         NEXT SENTENCE
 13033     ELSE
 13034         GO TO 3999-END-EDIT.
 13035
 13036 3220-CHECK-LF-RATES.
 13037
 13038     IF PB-COMPANY-ID = 'DCC'
 13039        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13040        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13041        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13042           AND (NOT WS-LF-CASH))
 13043                           OR
 13044           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13045           AND (NOT WS-AH-CASH)))
 13046                       AND
 13047           (PB-I-ENTRY-STATUS NOT = '5')
 13048           MOVE 'M'              TO PB-BATCH-ENTRY
 13049                                    PB-I-ENTRY-STATUS
 13050        END-IF
 13051     END-IF
 13052     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13053                                    PB-I-AH-PREM-CALC
 13054                                    PB-I-LF-ALT-PREM-CALC
 13055                                    PB-I-LF-ALT-RATE
 13056                                    PB-I-LF-REI-RATE
 13057                                    PB-I-LF-ALT-REI-RATE
 13058                                    PB-I-AH-REI-RATE
 13059                                    PB-I-TOT-FEES-CALC.
 13060
 13061     IF PB-COMPANY-ID EQUAL 'DMD'
 13062        NEXT SENTENCE
 13063     ELSE
 13064        MOVE ZEROS               TO PB-I-LF-RATE
 13065                                    PB-I-AH-RATE.
 13066
 13067     IF PB-I-TOT-FEES NOT NUMERIC
 13068        MOVE ZEROS               TO PB-I-TOT-FEES
 13069     END-IF
 13070     IF PB-I-LIVES NOT NUMERIC
 13071         MOVE ZERO               TO PB-I-LIVES.
 13072
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 238
* EL050.cbl
 13073     IF PB-I-NUM-BILLED NOT NUMERIC
 13074         MOVE ZERO               TO PB-I-NUM-BILLED.
 13075
 13076     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13077        MOVE +0                  TO PB-I-LF-PREM-TAX
 13078     END-IF
 13079
 13080     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13081        MOVE +0                  TO PB-I-AH-PREM-TAX
 13082     END-IF
 13083
 13084     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13085        PB-I-PAY-FREQUENCY = ZEROS
 13086            MOVE 12 TO CP-PAY-FREQUENCY
 13087     ELSE
 13088            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13089
 13090     IF PB-I-STATE-TAX NOT NUMERIC
 13091         MOVE ZEROS               TO PB-I-STATE-TAX.
 13092
 13093     IF PB-I-MUNI-TAX NOT NUMERIC
 13094         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13095
 13096     MOVE SPACES                 TO CP-BEN-CATEGORY
 13097     IF PB-COMPANY-ID  = 'CSL'  AND
 13098        PB-I-LF-TERM NOT = ZERO
 13099        COMPUTE WS-PAYMENT-AMT =
 13100             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13101        COMPUTE WS-CSL-AMT1 =
 13102             PB-I-LF-TERM * AM-MAX-MON-BEN
 13103        COMPUTE WS-CSL-AMT2 =
 13104             WS-PAYMENT-AMT * PB-I-LF-TERM
 13105        IF CP-PAY-FREQUENCY NOT = 12
 13106           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13107           MOVE '8' TO WS-CSL-CALC-CD
 13108        ELSE
 13109           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13110              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13111               AM-MAX-TOT-BEN
 13112               MOVE '6' TO WS-CSL-CALC-CD
 13113           ELSE
 13114              IF (WS-CSL-AMT1  GREATER THAN
 13115                 AM-MAX-TOT-BEN) AND
 13116                 (WS-CSL-AMT2  GREATER THAN
 13117                 AM-MAX-TOT-BEN)
 13118                 MOVE '7' TO WS-CSL-CALC-CD
 13119              ELSE
 13120                 MOVE '5' TO WS-CSL-CALC-CD.
 13121
 13122     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13123         NEXT SENTENCE
 13124     ELSE
 13125         GO TO 3300-CHECK-AH-RATES.
 13126
 13127*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13128
 13129     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13130        IF (PB-I-LF-CRIT-PER    EQUAL +0)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 239
* EL050.cbl
 13131              OR
 13132           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13133           MOVE ER-2618          TO WS-ERROR
 13134           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13135           GO TO 3300-CHECK-AH-RATES.
 13136
 13137     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13138           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13139                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13140
 13141     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13142         MOVE ER-2687             TO WS-ERROR
 13143         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13144         MOVE 'Z000'              TO PB-I-MORT-CODE
 13145         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13146         GO TO 3300-CHECK-AH-RATES.
 13147
 13148     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13149        IF PB-I-LIVES = ZERO
 13150           MOVE ER-2688          TO WS-ERROR
 13151           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13152
 13153     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13154
 13155     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13156     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13157     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13158     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13159     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13160     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13161     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13162     MOVE '3'                    TO CP-PROCESS-TYPE.
 13163     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13164     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13165
 13166******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13167     IF PB-COMPANY-ID EQUAL 'CDL'
 13168         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13169            CP-EARN-AS-NET-PAY)
 13170             IF PB-CERT-EFF-DT GREATER  WS-931231
 13171                 MOVE '1'        TO CP-EARNING-METHOD.
 13172*******
 13173
 13174     MOVE PB-SV-STATE            TO CP-STATE.
 13175     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13176     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13177     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13178     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13179     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13180                                    CP-RATING-BENEFIT-AMT.
 13181     IF CP-STATE-STD-ABBRV = 'OR'
 13182         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13183                                         PB-I-LF-ALT-BENEFIT-AMT.
 13184     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13185     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13186     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13187     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13188     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 240
* EL050.cbl
 13189     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13190     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13191     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13192     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13193                                    CP-REMAINING-TERM
 13194                                    CP-LOAN-TERM.
 13195
 13196     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13197         NEXT SENTENCE
 13198     ELSE
 13199         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13200             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13201                                           PB-I-LF-PREMIUM-AMT.
 13202
 13203     IF PB-COMPANY-ID EQUAL 'CSL'
 13204        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13205           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13206                                         PB-I-LF-PREMIUM-AMT.
 13207
 13208     IF PB-COMPANY-ID EQUAL 'NCB'
 13209         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13210            CP-EARN-AS-NET-PAY
 13211             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13212                 PB-I-LF-PREMIUM-AMT.
 13213
 13214     IF (CP-TRUNCATED-LIFE)
 13215        or ((pb-company-id = 'AHL')
 13216           and (pb-i-loan-term > pb-i-lf-term))
 13217        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13218
 13219     IF PB-COMPANY-ID EQUAL 'CRI'
 13220        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13221
 13222     IF CP-TERM-IS-DAYS
 13223         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13224     ELSE
 13225         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13226     IF PB-COMPANY-ID = 'DCC'
 13227        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13228        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13229        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13230        IF WS-LF-BEN-CATEGORY = 'D'
 13231           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13232           MOVE PB-I-LIFE-COMMISSION
 13233                                 TO CP-DCC-ACT-COMM
 13234           MOVE WS-LF-BEN-CATEGORY
 13235                                 TO CP-BEN-CATEGORY
 13236        END-IF
 13237        IF (CP-BENEFIT-CD (1:1) = 'P')
 13238           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13239           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13240           add pb-i-ah-premium-amt to cp-original-premium
 13241        END-IF
 13242     END-IF
 13243     IF PB-COMPANY-ID = 'CSL'
 13244         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13245         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13246         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 241
* EL050.cbl
 13247
 13248     IF PB-COMPANY-ID = 'CSL'
 13249        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13250
 13251     IF (CP-SPECIAL-CALC-CD = 'H')
 13252        OR (PB-COMPANY-ID = 'DCC')
 13253         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13254                                    TO CP-ALTERNATE-BENEFIT
 13255         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13256
 13257     IF (PB-COMPANY-ID = 'CID')
 13258        AND (WS-LF-EARNINGS-CALC = 'B')
 13259        AND (CP-STATE-STD-ABBRV = 'MN')
 13260        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13261                                 TO CP-ALTERNATE-BENEFIT
 13262        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13263     END-IF
 13264     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13265     MOVE 'R'                   TO CP-RATE-FILE.
 13266     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13267
 13268     IF CP-ERROR-RATE-NOT-FOUND
 13269        MOVE ER-2641            TO WS-ERROR
 13270        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13271        GO TO 3300-CHECK-AH-RATES.
 13272
 13273     IF PB-COMPANY-ID EQUAL 'CRI'
 13274        IF CP-ERROR-NO-LIMITS-CRI
 13275           IF NOT ACCOUNT-LIFE-CHECKED
 13276              MOVE ER-2607      TO WS-ERROR
 13277              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13278
 13279******************************************************************
 13280*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13281*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13282******************************************************************
 13283
 13284* CALC LIFE AGE AT EXPIRATION.
 13285
 13286     COMPUTE WS-AGE-AT-EXPIRE =
 13287          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13288
 13289*    IF PB-STATE = 'CO' OR 'UT'
 13290*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13291*        MOVE 'F'            TO PB-FATAL-FLAG
 13292*        MOVE ER-2709        TO WS-ERROR
 13293*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13294*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13295
 13296*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13297*        MOVE 'X'            TO PB-FATAL-FLAG
 13298*        MOVE ER-2718        TO WS-ERROR
 13299*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13300*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13301
 13302* CALC A & H AGE AT EXPIRATION.
 13303
 13304     COMPUTE WS-AGE-AT-EXPIRE =
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 242
* EL050.cbl
 13305          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13306
 13307*    IF PB-STATE = 'CO' OR 'UT'
 13308*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13309*        MOVE 'F'            TO PB-FATAL-FLAG
 13310*        MOVE ER-2709        TO WS-ERROR
 13311*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13312*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13313
 13314*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13315*        MOVE 'X'            TO PB-FATAL-FLAG
 13316*        MOVE ER-2718        TO WS-ERROR
 13317*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13318*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13319
 13320     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13321        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13322
 13323     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13324        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13325
 13326     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13327        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13328
 13329     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13330         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13331         MOVE ER-2639        TO WS-ERROR
 13332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13333
 13334
 13335******************************************************************
 13336*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13337******************************************************************
 13338
 13339 PREMIUM-EDITING-IS-BYPASSED.
 13340     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13341        AND (CP-R-MAX-ATT-AGE > +0)
 13342        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13343        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13344           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13345           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13346           MOVE '1'              TO DC-OPTION-CODE
 13347           PERFORM 8500-DATE-CONVERT
 13348                                 THRU 8500-EXIT
 13349           IF NO-CONVERSION-ERROR
 13350              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13351                 MOVE ER-2661       TO WS-ERROR
 13352*                PERFORM 9900-ERROR-FORMAT
 13353*                                THRU 9900-EXIT
 13354              END-IF
 13355           END-IF
 13356        ELSE
 13357           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13358           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13359              MOVE ER-2661       TO WS-ERROR
 13360*             PERFORM 9900-ERROR-FORMAT
 13361*                                THRU 9900-EXIT
 13362           ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 243
* EL050.cbl
 13363              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13364                 MOVE ER-1570    TO WS-ERROR
 13365                 PERFORM 9900-ERROR-FORMAT
 13366                                 THRU 9900-EXIT
 13367              END-IF
 13368           END-IF
 13369        END-IF
 13370        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13371           MOVE PB-I-JOINT-BIRTHDAY
 13372                                 TO DC-BIN-DATE-1
 13373           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13374           MOVE '1'              TO DC-OPTION-CODE
 13375           PERFORM 8500-DATE-CONVERT
 13376                                 THRU 8500-EXIT
 13377           IF NO-CONVERSION-ERROR
 13378              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13379                 MOVE ER-2661       TO WS-ERROR
 13380*                PERFORM 9900-ERROR-FORMAT
 13381*                                THRU 9900-EXIT
 13382              END-IF
 13383           ELSE
 13384              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13385           END-IF
 13386        ELSE
 13387           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13388             (PB-I-LF-TERM / 12)
 13389           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13390              MOVE ER-2661       TO WS-ERROR
 13391*             PERFORM 9900-ERROR-FORMAT
 13392*                                THRU 9900-EXIT
 13393           ELSE
 13394              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13395                 MOVE ER-1571    TO WS-ERROR
 13396                 PERFORM 9900-ERROR-FORMAT
 13397                                 THRU 9900-EXIT
 13398              END-IF
 13399           END-IF
 13400        END-IF
 13401        IF WS-ERROR = ER-2661
 13402           PERFORM 9900-ERROR-FORMAT
 13403                                 THRU 9900-EXIT
 13404        END-IF
 13405     END-IF
 13406*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13407*       MOVE ER-2661             TO WS-ERROR
 13408*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13409
 13410     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13411        MOVE ER-2662             TO WS-ERROR
 13412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13413
 13414     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13415        MOVE ER-2677             TO WS-ERROR
 13416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13417
 13418     IF CP-ERROR-LOAN-TERM
 13419        MOVE ER-2648             TO WS-ERROR
 13420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 244
* EL050.cbl
 13421
 13422 3221-CHECK-ERROR-RATE-OPEN.
 13423
 13424     IF CP-ERROR-RATE-FILE-NOTOPEN
 13425         GO TO 3990-FILES-NOT-OPEN.
 13426
 13427     IF PB-COMPANY-ID NOT = 'DMD'
 13428        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13429     END-IF
 13430     .
 13431 3221-CONTINUE.
 13432     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13433                                    WS-DCC-AH-RATE
 13434     IF PB-COMPANY-ID = 'DCC'
 13435        IF WS-LF-BEN-CATEGORY = 'D'
 13436           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13437              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13438        END-IF
 13439     END-IF
 13440     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13441*   X'A4FF' = 12/31/2009
 13442     IF (PB-COMPANY-ID = 'CID')
 13443        AND (WS-LF-EARNINGS-CALC = 'B')
 13444        AND (CP-STATE-STD-ABBRV = 'MN')
 13445        AND (PB-CERT-EFF-DT > X'A4FF')
 13446        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13447     END-IF
 13448     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13449
 13450     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13451     IF (PB-COMPANY-ID = 'DCC')
 13452        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13453        AND (PB-I-POLICY-IS-MONTHLY)
 13454        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13455        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13456     END-IF
 13457     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13458     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13459     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13460     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13461     IF (PB-COMPANY-ID = 'DCC')
 13462        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13463        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13464        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13465        MOVE ER-2786             TO WS-ERROR
 13466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13467     END-IF
 13468
 13469     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13470
 13471******************************************************************
 13472*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13473******************************************************************
 13474     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13475        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13476
 13477     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13478        GO TO 3225-CHECK-ALT-LIFE-RATE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 245
* EL050.cbl
 13479     ELSE
 13480       IF PB-I-LF-RATE = ZERO
 13481          MOVE ER-2641          TO WS-ERROR
 13482          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13483
 13484 3225-CHECK-ALT-LIFE-RATE.
 13485
 13486     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13487        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13488        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13489         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13490
 13491     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13492         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13493             AND PB-COMPANY-ID NOT = 'DCC')
 13494                   OR
 13495              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13496              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13497              AND PB-COMPANY-ID NOT = 'DCC')
 13498             MOVE ER-2720        TO  WS-ERROR
 13499             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13500             GO TO 3225-RATING-CONT
 13501         ELSE
 13502             GO TO 3225-RATING-CONT.
 13503     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13504        AND (AM-GPCD = 01 OR 06 OR 15)
 13505        MOVE ER-2798             TO WS-ERROR
 13506        PERFORM 9900-ERROR-FORMAT
 13507                                 THRU 9900-EXIT
 13508*       GO TO 3225-RATING-CONT
 13509     END-IF
 13510     IF (PB-COMPANY-ID = 'CID')
 13511        AND (WS-LF-EARNINGS-CALC = 'B')
 13512        AND (CP-STATE-STD-ABBRV = 'MN')
 13513        AND (PB-CERT-EFF-DT > X'A4FF')
 13514        GO TO 3225-RATING-CONT
 13515     END-IF
 13516     IF PB-COMPANY-ID = 'DCC'
 13517        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13518           AND (PB-I-POLICY-IS-MONTHLY)
 13519           GO TO 3225-RATING-CONT
 13520        END-IF
 13521     END-IF
 13522
 13523     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13524        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13525        CP-EARN-AS-REG-BALLOON
 13526        NEXT SENTENCE
 13527     ELSE
 13528        MOVE '2'                 TO CP-EARNING-METHOD.
 13529
 13530 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13531
 13532     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13533
 13534     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13535        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13536        (CP-SPECIAL-CALC-CD EQUAL 'H')
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 246
* EL050.cbl
 13537         NEXT SENTENCE
 13538     ELSE
 13539         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13540
 13541     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13542     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13543     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13544                                     CP-RATING-BENEFIT-AMT.
 13545     IF CP-STATE-STD-ABBRV = 'OR'
 13546         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13547                                         PB-I-LF-ALT-BENEFIT-AMT.
 13548     IF PB-COMPANY-ID = 'DCC'
 13549        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13550     END-IF
 13551     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13552     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13553     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13554                                    CP-REMAINING-TERM
 13555                                    CP-LOAN-TERM.
 13556     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13557        ADD +1                   TO CP-ORIGINAL-TERM
 13558                                    CP-REMAINING-TERM
 13559                                    CP-LOAN-TERM.
 13560
 13561     MOVE 'R'                   TO CP-RATE-FILE.
 13562     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13563
 13564     IF CP-ERROR-RATE-NOT-FOUND
 13565         MOVE ER-2641            TO WS-ERROR
 13566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13567         GO TO 3300-CHECK-AH-RATES.
 13568
 13569     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13570     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13571
 13572     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13573         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13574
 13575     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13576                               + PB-I-LF-ALT-BENEFIT-AMT.
 13577
 13578     IF ACCOUNT-LIFE-CHECKED  OR
 13579        PB-POLICY-IS-VOIDED   OR
 13580        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13581        GO TO 3225-CONTINUE.
 13582
 13583     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13584        GO TO 3225-CONTINUE.
 13585
 13586     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13587                             EC-RT-LF-MAX-TOT-BEN
 13588        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13589        MOVE ER-2639       TO WS-ERROR
 13590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13591
 13592 3225-CONTINUE.
 13593     IF PB-I-LF-ALT-RATE = ZERO
 13594         MOVE ER-2659            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 247
* EL050.cbl
 13595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13596
 13597     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13598        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13599        MOVE ER-2698             TO WS-ERROR
 13600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13601
 13602 3225-RATING-CONT.
 13603
 13604     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13605         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13606         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13607         IF (PB-COMPANY-ID = 'DCC')
 13608            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13609            CONTINUE
 13610         ELSE
 13611            MOVE ER-2687         TO WS-ERROR
 13612            PERFORM 9900-ERROR-FORMAT
 13613                                 THRU 9900-EXIT
 13614         END-IF
 13615         GO TO 3290-EDIT-LF-REIN-RATE
 13616     END-IF
 13617
 13618* DMD RATING TEST
 13619     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13620         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13621         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13622         MOVE ER-2687                 TO WS-ERROR
 13623         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13624         GO TO 3290-EDIT-LF-REIN-RATE.
 13625
 13626 3230-CLIENT-MORT-CD-SPECIALS.
 13627
 13628     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13629     SET BIN-TO-GREG          TO TRUE.
 13630*    MOVE ' '                 TO DC-OPTION-CODE.
 13631     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13632     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13633
 13634 C-POS-3230-MORT-CD.
 13635     IF PB-COMPANY-ID = 'POS' AND
 13636        PB-SV-CARRIER = '2'
 13637         NEXT SENTENCE
 13638     ELSE
 13639         GO TO C-POS-3240-MORT-CD.
 13640
 13641     IF PB-SV-GROUPING = '030'
 13642        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13643         MOVE '2350' TO PB-I-MORT-CODE
 13644      ELSE
 13645         MOVE '3300' TO PB-I-MORT-CODE.
 13646
 13647
 13648 C-POS-3240-MORT-CD.
 13649     IF PB-COMPANY-ID = 'POS' AND
 13650        PB-SV-CARRIER = '1'
 13651         NEXT SENTENCE
 13652     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 248
* EL050.cbl
 13653         GO TO 3230-CONTINUE.
 13654
 13655     IF PB-SV-STATE = '45' OR '47'
 13656        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13657         MOVE '5200' TO PB-I-MORT-CODE
 13658     ELSE
 13659         MOVE '8300' TO PB-I-MORT-CODE.
 13660
 13661 3230-CONTINUE.
 13662
 13663     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13664        GO TO 3240-CONTINUE
 13665     END-IF
 13666
 13667     IF PB-CERT-EFF-DT > WS-971231
 13668        GO TO 3240-CONTINUE
 13669     END-IF
 13670
 13671     IF LF-BENEFIT-FOUND AND
 13672        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13673         MOVE 'F250'       TO PB-I-MORT-CODE
 13674     ELSE
 13675         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13676             MOVE '7250'   TO PB-I-MORT-CODE
 13677         ELSE
 13678             MOVE '4251'   TO PB-I-MORT-CODE
 13679         END-IF
 13680     END-IF
 13681
 13682     .
 13683 3240-CONTINUE.
 13684
 13685     IF PB-COMPANY-ID NOT = 'GNL'
 13686         GO TO 3256-CONTINUE.
 13687
 13688     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13689         MOVE 'A300' TO PB-I-MORT-CODE
 13690     ELSE
 13691         MOVE '8350' TO PB-I-MORT-CODE.
 13692
 13693 3256-CONTINUE.
 13694     IF PB-COMPANY-ID NOT = 'ABL'
 13695         GO TO 3260-EDIT-CONTINUE.
 13696
 13697     IF PB-I-LF-TERM GREATER THAN 59
 13698         MOVE 'F550' TO PB-I-MORT-CODE
 13699     ELSE
 13700         MOVE 'E550' TO PB-I-MORT-CODE.
 13701
 13702 3260-EDIT-CONTINUE.
 13703     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13704
 13705 3290-EDIT-LF-REIN-RATE.
 13706     IF LF-REIN-NSP-NOT-USED
 13707         GO TO 3290-RATING-CONT.
 13708
 13709     IF PB-COMPANY-ID = 'DCC'
 13710        GO TO 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 249
* EL050.cbl
 13711     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13712     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13713     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13714     MOVE '3'                   TO CP-PROCESS-TYPE.
 13715     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13716
 13717******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13718     IF PB-COMPANY-ID EQUAL 'CDL'
 13719         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13720            CP-EARN-AS-NET-PAY)
 13721             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13722*            MOVE SPACE          TO DC-OPTION-CODE
 13723             SET BIN-TO-GREG     TO TRUE
 13724             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13725***  Y2K PROJ 7744
 13726             IF DC-GREG-DATE-CYMD GREATER 19931231
 13727                 MOVE '1'        TO CP-EARNING-METHOD.
 13728***  Y2K PROJ 7744
 13729*******
 13730
 13731     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13732     MOVE PB-SV-STATE           TO CP-STATE.
 13733     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13734     MOVE ZERO                  TO CP-DEVIATION-CODE
 13735                                   CP-RATE-DEV-PCT.
 13736     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13737     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13738                                   CP-RATING-BENEFIT-AMT.
 13739
 13740************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13741     IF PB-COMPANY-ID EQUAL 'NCB'
 13742         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13743            CP-EARN-AS-NET-PAY
 13744             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13745                 PB-I-LF-PREMIUM-AMT.
 13746************
 13747
 13748     IF CP-STATE-STD-ABBRV = 'OR'
 13749         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13750                                         PB-I-LF-ALT-BENEFIT-AMT.
 13751     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13752     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13753     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13754     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13755     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13756     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13757     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13758     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13759                                   CP-REMAINING-TERM
 13760                                   CP-LOAN-TERM.
 13761     IF CP-TRUNCATED-LIFE
 13762        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13763
 13764     IF CP-TERM-IS-DAYS
 13765         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13766     ELSE
 13767         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13768
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 250
* EL050.cbl
 13769     IF PB-COMPANY-ID = 'DCC'
 13770        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13771     END-IF
 13772     IF PB-COMPANY-ID NOT = 'TIC'
 13773          MOVE ZERO          TO CP-CLASS-CODE.
 13774
 13775     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13776
 13777     MOVE 'R'                   TO CP-RATE-FILE.
 13778     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13779
 13780     IF CP-ERROR-RATE-NOT-FOUND
 13781        IF PB-I-OB
 13782           MOVE ER-2625      TO WS-ERROR
 13783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13784           GO TO 3299-EDIT-CONTINUE
 13785        ELSE
 13786           MOVE ER-2643      TO WS-ERROR
 13787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13788           GO TO 3299-EDIT-CONTINUE.
 13789
 13790     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13791
 13792     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13793     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13794
 13795     IF PB-I-LF-REI-RATE = ZERO
 13796         MOVE ER-2643        TO WS-ERROR
 13797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13798
 13799 3290-CHECK-ALT-REIN-RATE.
 13800
 13801     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13802        GO TO 3290-RATING-CONT.
 13803
 13804     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13805     MOVE '2'                    TO CP-EARNING-METHOD.
 13806     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13807     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13808     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13809     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13810                                     CP-RATING-BENEFIT-AMT.
 13811     IF CP-STATE-STD-ABBRV = 'OR'
 13812         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13813                                         PB-I-LF-ALT-BENEFIT-AMT.
 13814     IF PB-COMPANY-ID = 'DCC'
 13815        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13816     END-IF
 13817     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13818     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13819     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13820                                    CP-REMAINING-TERM
 13821                                    CP-LOAN-TERM.
 13822     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13823        ADD +1                   TO CP-ORIGINAL-TERM
 13824                                    CP-REMAINING-TERM
 13825                                    CP-LOAN-TERM.
 13826
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 251
* EL050.cbl
 13827     MOVE 'R'                   TO CP-RATE-FILE.
 13828     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13829
 13830     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13831
 13832     IF PB-I-LF-ALT-REI-RATE = ZERO
 13833         MOVE ER-2643            TO WS-ERROR
 13834         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13835
 13836 3290-RATING-CONT.
 13837
 13838     IF PB-I-OB
 13839*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13840        GO TO 3300-CHECK-AH-RATES.
 13841
 13842 3299-EDIT-CONTINUE.
 13843
 13844     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13845         NEXT SENTENCE
 13846     ELSE
 13847         MOVE ER-2620           TO WS-ERROR
 13848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13849
 13850 3300-CHECK-AH-RATES.
 13851     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13852         NEXT SENTENCE
 13853     ELSE
 13854         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13855
 13856     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13857        ((CF-COMPANY-ID = 'DMD') AND
 13858                (NO-DMD-RATING))
 13859         IF (PB-COMPANY-ID = 'DCC')
 13860            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13861            CONTINUE
 13862         ELSE
 13863            MOVE ER-2687         TO WS-ERROR
 13864            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13865         END-IF
 13866         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13867         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13868     END-IF
 13869
 13870     IF PB-I-OB
 13871        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13872
 13873     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13874         MOVE ER-2687             TO WS-ERROR
 13875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13876         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13877         GO TO 3999-END-EDIT.
 13878
 13879*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13880
 13881     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13882        IF PB-I-AH-CRIT-PER = ZERO
 13883           IF PB-COMPANY-ID = 'DCC'
 13884              AND AM-DCC-PRODUCT-CODE = 'DDF'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 252
* EL050.cbl
 13885              CONTINUE
 13886           ELSE
 13887              MOVE ER-2618       TO WS-ERROR
 13888              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13889              GO TO 3999-END-EDIT
 13890           END-IF
 13891        END-IF
 13892     END-IF
 13893     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13894     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13895     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13896     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13897     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13898     MOVE PB-SV-STATE            TO CP-STATE.
 13899     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13900     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13901     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13902*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13903     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13904     MOVE '3'                    TO CP-PROCESS-TYPE.
 13905     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13906     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13907                                    CP-RATING-BENEFIT-AMT.
 13908     IF PB-COMPANY-ID = 'CID'
 13909               OR
 13910        CP-STATE-STD-ABBRV = 'OR'
 13911         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13912                                         PB-I-AH-TERM.
 13913     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13914        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13915           AND (PB-I-POLICY-IS-MONTHLY)
 13916           MOVE PB-I-LF-BENEFIT-AMT
 13917                                 TO CP-NET-BENEFIT-AMT
 13918           move pb-i-ah-premium-amt to cp-original-premium
 13919           add pb-i-lf-premium-amt to cp-original-premium
 13920        END-IF
 13921     END-IF
 13922     MOVE SPACES                 TO CP-BEN-CATEGORY
 13923     IF PB-COMPANY-ID = 'DCC'
 13924        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13925        EVALUATE TRUE
 13926           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13927              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13928              MOVE PB-I-LF-BENEFIT-AMT
 13929                                 TO CP-RATING-BENEFIT-AMT
 13930              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13931           WHEN WS-AH-BEN-CATEGORY = 'G'
 13932              MOVE PB-I-UNPAID-CASH-PRICE
 13933                                 TO CP-RATING-BENEFIT-AMT
 13934           WHEN WS-AH-BEN-CATEGORY = 'D'
 13935              MOVE WS-AH-PMF-COMM
 13936                                 TO CP-DCC-PMF-COMM
 13937              MOVE PB-I-AH-COMMISSION
 13938                                 TO CP-DCC-ACT-COMM
 13939        END-EVALUATE
 13940     END-IF
 13941     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13942     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 253
* EL050.cbl
 13943     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13944     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13945     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13946     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13947     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13948                                    CP-REMAINING-TERM
 13949                                    WS-WORK-TERM.
 13950     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13951
 13952     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13953     SET BIN-TO-GREG             TO TRUE.
 13954*    MOVE ' '                    TO DC-OPTION-CODE.
 13955     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13956     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13957
 13958     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13959     IF NOT VALID-SKIP-CODE
 13960         MOVE ER-2683            TO WS-ERROR
 13961         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13962         GO TO 3320-RATE-CONTINUE.
 13963
 13964     IF PB-NO-MONTHS-SKIPPED
 13965         GO TO 3320-RATE-CONTINUE.
 13966
 13967     MOVE SPACE TO NUMBER-OF-MONTHS.
 13968
 13969     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13970         MOVE 'S'                TO SK-MO (6).
 13971     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13972         MOVE 'S'                TO SK-MO (7).
 13973     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13974         MOVE 'S'                TO SK-MO (8).
 13975     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13976         MOVE 'S'                TO SK-MO (9).
 13977     IF PB-I-SKIP-CODE = 'A'
 13978         MOVE 'S'                TO SK-MO (10).
 13979
 13980     MOVE 1                      TO SUB2.
 13981     MOVE PB-I-AH-TERM           TO SUB3.
 13982     MOVE WS-MONTH               TO SUB1.
 13983     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13984     GO TO 3320-RATE-CONTINUE.
 13985
 13986 3310-GET-SKIP-MO.
 13987     IF SUB1 = 13
 13988         MOVE 1                  TO SUB1.
 13989
 13990     IF SK-MO (SUB1) = 'S'
 13991         SUBTRACT 1 FROM WS-WORK-TERM.
 13992
 13993     ADD 1 TO SUB2
 13994              SUB1.
 13995
 13996 3320-RATE-CONTINUE.
 13997
 13998     IF WS-WORK-TERM = ZERO
 13999         MOVE 1                  TO WS-WORK-TERM.
 14000
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 254
* EL050.cbl
 14001     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14002                                    CP-LOAN-TERM.
 14003
 14004     IF PB-COMPANY-ID EQUAL 'DMD'
 14005         NEXT SENTENCE
 14006     ELSE
 14007         MOVE ZERO               TO PB-I-AH-RATE
 14008                                    PB-I-AH-REI-RATE.
 14009
 14010
 14011     IF PB-COMPANY-ID EQUAL 'CRI'
 14012        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14013
 14014     IF PB-COMPANY-ID = 'CSL'
 14015         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14016         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14017         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14018         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14019
 14020     IF PB-COMPANY-ID = 'DCC'
 14021        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14022           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14023              PB-I-RATE-DEV-PCT-LF
 14024        END-IF
 14025        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14026                                 TO CP-ALTERNATE-BENEFIT
 14027        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14028        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14029        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14030     END-IF
 14031     IF (PB-COMPANY-ID = 'CID')
 14032        AND (WS-LF-EARNINGS-CALC = 'B')
 14033        AND (CP-STATE-STD-ABBRV = 'MN')
 14034        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14035     ELSE
 14036        MOVE ' '                 TO CP-AH-BALLOON-SW
 14037     END-IF
 14038     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14039     MOVE 'R'                   TO CP-RATE-FILE.
 14040     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14041
 14042     IF CP-ERROR-RATE-NOT-FOUND
 14043        IF PB-I-OB
 14044           MOVE ER-2624          TO WS-ERROR
 14045           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14046           GO TO 3340-CALCULATE-PREMIUM-AMT
 14047        ELSE
 14048          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14049              NEXT SENTENCE
 14050          ELSE
 14051           MOVE ER-2642          TO WS-ERROR
 14052           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14053           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14054
 14055     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14056        CP-ERROR-DIV-BY-ZERO
 14057           MOVE ER-3782          TO WS-ERROR
 14058           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 255
* EL050.cbl
 14059
 14060     IF PB-COMPANY-ID EQUAL 'CRI'
 14061        IF CP-ERROR-NO-LIMITS-CRI
 14062           IF NOT ACCOUNT-AH-CHECKED
 14063              MOVE ER-2607          TO WS-ERROR
 14064              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14065
 14066     IF ACCOUNT-AH-CHECKED
 14067        NEXT SENTENCE
 14068     ELSE
 14069       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14070          MOVE ER-2640           TO WS-ERROR
 14071          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14072
 14073     IF PB-COMPANY-ID = 'CRI'
 14074         IF WS-ERROR = ER-2640
 14075             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14076     IF ACCOUNT-AH-CHECKED
 14077        CONTINUE
 14078     ELSE
 14079        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14080           AND (CP-R-MAX-ATT-AGE > +0)
 14081           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14082           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14083              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14084              MOVE PB-I-AH-EXPIRE-DT
 14085                                 TO DC-BIN-DATE-2
 14086              MOVE '1'           TO DC-OPTION-CODE
 14087              PERFORM 8500-DATE-CONVERT
 14088                                 THRU 8500-EXIT
 14089              IF NO-CONVERSION-ERROR
 14090                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14091                    MOVE ER-2661       TO WS-ERROR
 14092*                   PERFORM 9900-ERROR-FORMAT
 14093*                                THRU 9900-EXIT
 14094                 END-IF
 14095              END-IF
 14096           ELSE
 14097              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14098              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14099                 MOVE ER-2661    TO WS-ERROR
 14100*                PERFORM 9900-ERROR-FORMAT
 14101*                                THRU 9900-EXIT
 14102              ELSE
 14103                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14104                    MOVE ER-1570 TO WS-ERROR
 14105                    PERFORM 9900-ERROR-FORMAT
 14106                                 THRU 9900-EXIT
 14107                 END-IF
 14108              END-IF
 14109           END-IF
 14110           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14111              MOVE PB-I-JOINT-BIRTHDAY
 14112                                    TO DC-BIN-DATE-1
 14113              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14114              MOVE '1'              TO DC-OPTION-CODE
 14115              PERFORM 8500-DATE-CONVERT
 14116                                    THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 256
* EL050.cbl
 14117              IF NO-CONVERSION-ERROR
 14118                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14119                    MOVE ER-2661       TO WS-ERROR
 14120*                   PERFORM 9900-ERROR-FORMAT
 14121*                                   THRU 9900-EXIT
 14122                 END-IF
 14123              END-IF
 14124           ELSE
 14125              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14126                (PB-I-AH-TERM / 12)
 14127              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14128                 MOVE ER-2661       TO WS-ERROR
 14129*                PERFORM 9900-ERROR-FORMAT
 14130*                                   THRU 9900-EXIT
 14131              ELSE
 14132                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14133                    MOVE ER-1571 TO WS-ERROR
 14134                    PERFORM 9900-ERROR-FORMAT
 14135                                 THRU 9900-EXIT
 14136                 END-IF
 14137              END-IF
 14138           END-IF
 14139           IF WS-ERROR = ER-2661
 14140              PERFORM 9900-ERROR-FORMAT
 14141                                    THRU 9900-EXIT
 14142           END-IF
 14143        END-IF
 14144     END-IF
 14145*    IF ACCOUNT-AH-CHECKED
 14146*       NEXT SENTENCE
 14147*    ELSE
 14148*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14149*          MOVE ER-2661          TO WS-ERROR
 14150*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14151
 14152     IF ACCOUNT-AH-CHECKED
 14153        NEXT SENTENCE
 14154     ELSE
 14155        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14156           MOVE ER-2663          TO WS-ERROR
 14157           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14158
 14159     IF ACCOUNT-AH-CHECKED OR
 14160        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14161         PB-POLICY-IS-VOIDED
 14162        NEXT SENTENCE
 14163     ELSE
 14164        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14165           MOVE ER-2667            TO WS-ERROR
 14166           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14167
 14168     IF PB-COMPANY-ID = 'CRI'
 14169         IF WS-ERROR = ER-2667
 14170             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14171
 14172     IF ACCOUNT-AH-CHECKED
 14173        NEXT SENTENCE
 14174     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 257
* EL050.cbl
 14175        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14176           MOVE ER-2678            TO WS-ERROR
 14177           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14178
 14179     IF CP-ERROR-RATE-FILE-NOTOPEN
 14180         GO TO 3990-FILES-NOT-OPEN.
 14181
 14182 3321-CONTINUE.
 14183     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14184     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14185     IF (PB-COMPANY-ID = 'DCC')
 14186        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14187        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14188                                    PB-I-LF-ALT-PREM-CALC
 14189        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14190        IF WS-AH-BEN-CATEGORY = 'G'
 14191           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14192           + PB-I-ADDL-CLP)
 14193           * (1 + WS-TOL-CLP-PCT)
 14194*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14195        ELSE
 14196           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14197           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14198*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14199        END-IF
 14200        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14201                                 TO PB-I-AH-PREM-CALC
 14202        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14203           MOVE ER-8152          TO WS-ERROR
 14204           PERFORM 9900-ERROR-FORMAT
 14205                                 THRU 9900-EXIT
 14206        ELSE
 14207           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14208                 PB-I-ADDL-CLP)
 14209              MOVE ER-8148       TO WS-ERROR
 14210              PERFORM 9900-ERROR-FORMAT
 14211                                 THRU 9900-EXIT
 14212           END-IF
 14213        END-IF
 14214     END-IF
 14215     IF (PB-COMPANY-ID = 'DCC')
 14216        AND (PB-I-POLICY-IS-MONTHLY)
 14217        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14218        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14219        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14220           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14221        END-IF
 14222     END-IF
 14223     IF (PB-COMPANY-ID = 'DCC')
 14224        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14225        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14226        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14227        MOVE ER-2786             TO WS-ERROR
 14228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14229     END-IF
 14230     MOVE +0                     TO PB-I-AH-CLP
 14231     IF PB-COMPANY-ID = 'DCC'
 14232        IF WS-AH-BEN-CATEGORY = 'D'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 258
* EL050.cbl
 14233           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14234              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14235        ELSE
 14236           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14237              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14238           END-IF
 14239        END-IF
 14240     END-IF
 14241     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14242
 14243     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14244         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14245
 14246     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14247         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14248
 14249     IF PB-COMPANY-ID = 'CRI'
 14250         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14251            PB-I-PAYMENT-AMOUNT = ZERO
 14252             NEXT SENTENCE
 14253         ELSE
 14254             COMPUTE PB-I-AH-PREM-CALC =
 14255                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14256                 (CP-PREMIUM-RATE / 100)
 14257             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14258                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14259                                             PB-I-RATE-DEV-PCT-AH.
 14260
 14261     IF PB-I-AH-RATE  = ZERO
 14262       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14263           NEXT SENTENCE
 14264       ELSE
 14265         MOVE ER-2642            TO WS-ERROR
 14266         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14267
 14268     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14269     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14270     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14271     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14272     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14273     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14274
 14275     IF (PB-COMPANY-ID = 'DCC')
 14276        AND (WS-AH-BEN-CATEGORY = 'G')
 14277        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14278        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14279        IF CP-DEVIATION-CODE NOT = '000'
 14280           MOVE '000'            TO CP-DEVIATION-CODE
 14281           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14282           IF NO-CP-ERROR
 14283              COMPUTE PB-I-DDF-IU-RATE-UP =
 14284              PB-I-AH-CLP - CP-CALC-PREMIUM
 14285           ELSE
 14286              MOVE ER-3057        TO WS-ERROR
 14287              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14288           END-IF
 14289        END-IF
 14290     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 259
* EL050.cbl
 14291     .
 14292 3335-EDIT-AH-REIN-NSP-RATE.
 14293     IF AH-REIN-NSP-NOT-USED
 14294         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14295
 14296     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14297     IF PB-COMPANY-ID = 'DCC'
 14298         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14299     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14300     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14301     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14302     MOVE PB-SV-STATE            TO CP-STATE.
 14303     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14304     MOVE ZERO                   TO CP-DEVIATION-CODE
 14305                                    CP-RATE-DEV-PCT.
 14306*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14307     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14308     MOVE '3'                    TO CP-PROCESS-TYPE.
 14309     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14310     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14311                                    CP-RATING-BENEFIT-AMT.
 14312     IF CP-STATE-STD-ABBRV = 'OR'
 14313         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14314                                         PB-I-AH-TERM.
 14315     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14316     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14317     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14318     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14319     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14320     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14321                                    CP-REMAINING-TERM
 14322                                    WS-WORK-TERM.
 14323     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14324     IF PB-COMPANY-ID = 'DCC'
 14325        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14326     END-IF
 14327     IF  PB-COMPANY-ID = 'TIC'
 14328         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14329            MOVE ZERO TO CP-CLASS-CODE.
 14330
 14331     IF PB-COMPANY-ID NOT = 'TIC'
 14332          MOVE ZERO          TO CP-CLASS-CODE.
 14333
 14334     MOVE ZERO               TO CP-DEVIATION-CODE.
 14335
 14336     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14337
 14338     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14339
 14340     MOVE 'R'                   TO CP-RATE-FILE.
 14341     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14342
 14343     IF CP-ERROR-RATE-NOT-FOUND
 14344         MOVE ER-2645        TO WS-ERROR
 14345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14346         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14347
 14348     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 260
* EL050.cbl
 14349
 14350     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14351     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14352
 14353     IF PB-I-AH-REI-RATE = ZERO
 14354         MOVE ER-2645        TO WS-ERROR
 14355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14356
 14357
 14358 3340-CALCULATE-PREMIUM-AMT.
 14359
 14360     IF PB-COMPANY-ID = 'NCL'
 14361         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14362             WS-AH-SPECIAL-CALC-CD = 'O')
 14363             GO TO 3999-END-EDIT.
 14364
 14365     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14366                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14367                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14368                         OR 'AHL'
 14369         NEXT SENTENCE
 14370     ELSE
 14371         IF WS-STATE-ABBREVIATION = 'CT'
 14372             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14373                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14374                 COMPUTE PB-I-LF-PREM-CALC =
 14375                                     PB-I-LF-PREM-CALC * .90
 14376                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14377                                     PB-I-LF-ALT-PREM-CALC * .90
 14378                 COMPUTE PB-I-AH-PREM-CALC =
 14379                                     PB-I-AH-PREM-CALC * .90.
 14380
 14381     IF PB-COMP-LF-PREM
 14382        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14383        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14384
 14385     IF PB-COMP-AH-PREM
 14386        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14387
 14388 3340-CHECK-DCC-TOT-FEES.
 14389     IF (PB-COMPANY-ID = 'DCC')
 14390        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14391        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14392        AND (PB-I-POLICY-IS-MONTHLY)
 14393        CONTINUE
 14394     ELSE
 14395        GO TO 3340-EDIT-LF-AH-TOL
 14396     END-IF
 14397     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14398     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14399     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14400        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14401           PB-I-RATE-DEV-PCT-LF
 14402     END-IF
 14403     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14404        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14405           PB-I-RATE-DEV-PCT-AH
 14406     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 261
* EL050.cbl
 14407     MOVE 'N'                    TO CP-BEN-CATEGORY
 14408     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14409
 14410     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14411     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14412     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14413     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14414     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14415     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14416     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14417     MOVE '3'                    TO CP-PROCESS-TYPE.
 14418     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14419     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14420
 14421     MOVE PB-SV-STATE            TO CP-STATE.
 14422     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14423     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14424     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14425     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14426     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14427                                    CP-RATING-BENEFIT-AMT.
 14428     IF CP-STATE-STD-ABBRV = 'OR'
 14429         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14430                                         PB-I-LF-ALT-BENEFIT-AMT.
 14431     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14432     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14433     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14434     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14435     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14436     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14437     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14438     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14439     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14440                                    CP-REMAINING-TERM
 14441                                    CP-LOAN-TERM.
 14442     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14443         NEXT SENTENCE
 14444     ELSE
 14445         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14446             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14447                                           PB-I-LF-PREMIUM-AMT.
 14448
 14449     IF CP-TRUNCATED-LIFE
 14450        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14451
 14452     IF CP-TERM-IS-DAYS
 14453         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14454     ELSE
 14455         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14456
 14457     IF PB-COMPANY-ID = 'DCC'
 14458        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14459     END-IF
 14460     IF CP-SPECIAL-CALC-CD = 'H'
 14461         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14462                                    TO CP-ALTERNATE-BENEFIT
 14463         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14464     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 262
* EL050.cbl
 14465     MOVE 'R'                    TO CP-RATE-FILE
 14466     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14467     IF NOT CP-ERROR-RATE-NOT-FOUND
 14468        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14469        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14470           AND (CP-BENEFIT-CD (1:1) = 'S')
 14471           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14472                                    PB-I-LF-PREMIUM-AMT
 14473        END-IF
 14474     ELSE
 14475        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14476     END-IF
 14477     .
 14478 3340-EDIT-LF-AH-TOL.
 14479
 14480***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14481***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14482***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14483***
 14484     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14485         PB-I-AH-PREMIUM-AMT
 14486          GIVING WS-CALC-WORK.
 14487
 14488     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14489        AND WS-CALC-WORK NOT = ZERO
 14490         MOVE ER-2649            TO WS-ERROR
 14491         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14492
 14493     SUBTRACT PB-I-LF-PREM-CALC
 14494             FROM PB-I-LF-PREMIUM-AMT
 14495                 GIVING WS-UNSIGN-WRK1.
 14496
 14497     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14498             FROM PB-I-LF-ALT-PREMIUM-AMT
 14499                 GIVING WS-UNSIGN-WRK4.
 14500
 14501     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14502                                + WS-UNSIGN-WRK4.
 14503
 14504     SUBTRACT PB-I-AH-PREM-CALC
 14505             FROM PB-I-AH-PREMIUM-AMT
 14506                 GIVING WS-UNSIGN-WRK2.
 14507
 14508******************************************************************
 14509*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14510******************************************************************
 14511
 14512     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14513         MOVE ZERO TO WS-UNSIGN-WRK1.
 14514
 14515     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14516         MOVE ZERO TO WS-UNSIGN-WRK2.
 14517
 14518     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14519             GIVING WS-UNSIGN-WRK3.
 14520
 14521 3342-CONTINUE.
 14522
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 263
* EL050.cbl
 14523     IF (PB-I-LF-RATE = ZERO  AND
 14524         PB-I-AH-RATE = ZERO)
 14525         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14526            WS-AH-SPECIAL-CALC-CD = 'O'
 14527              NEXT SENTENCE
 14528         ELSE
 14529             GO TO 3345-EDIT-CONTINUE.
 14530
 14531     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14532         NEXT SENTENCE
 14533     ELSE
 14534     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14535        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14536           IF (PB-REISSUED-CERT         OR
 14537               PB-POLICY-IS-DECLINED    OR
 14538               PB-POLICY-IS-VOIDED)
 14539              NEXT SENTENCE
 14540           ELSE
 14541              IF WS-PREM-REJECT-SW = SPACE
 14542                 MOVE ER-2652    TO WS-ERROR
 14543                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14544                 GO TO 3344-CHECK-AH
 14545              ELSE
 14546                 MOVE ER-2650    TO WS-ERROR
 14547                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14548                 GO TO 3344-CHECK-AH.
 14549
 14550***
 14551***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14552***
 14553
 14554     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14555         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14556            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14557             (1 + WS-TOL-LF-PREM-PCT)
 14558         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14559            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14560             (1 - WS-TOL-LF-PREM-PCT)
 14561     ELSE
 14562         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14563         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14564
 14565***
 14566***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14567***
 14568
 14569     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14570         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14571          WS-TOL-LF-PREM.
 14572
 14573     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14574         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14575          WS-TOL-LF-PREM.
 14576
 14577     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14578        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14579
 14580     IF PB-REISSUED-CERT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 264
* EL050.cbl
 14581        or PB-POLICY-IS-DECLINED
 14582        or PB-POLICY-IS-VOIDED
 14583        continue
 14584     ELSE
 14585        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14586              > WS-TOL-LF-HIGH-PREM-AMT)
 14587           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14588              < WS-TOL-LF-LOW-PREM-AMT))
 14589                      or
 14590           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14591              > WS-TOL-LF-HIGH-PREM-PCT)
 14592           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14593              < WS-TOL-LF-LOW-PREM-PCT))
 14594           IF WS-PREM-REJECT-SW = SPACE
 14595              MOVE ER-2652       TO WS-ERROR
 14596              PERFORM 9900-ERROR-FORMAT
 14597                                 THRU 9900-EXIT
 14598           ELSE
 14599              MOVE ER-2650       TO WS-ERROR
 14600              PERFORM 9900-ERROR-FORMAT
 14601                                 THRU 9900-EXIT
 14602           end-if
 14603        end-if
 14604     end-if
 14605
 14606*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14607*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14608*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14609*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14610
 14611     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14612        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14613                      OR
 14614           ((PB-COMPANY-ID = 'DCC')
 14615           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14616           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14617           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14618        END-IF
 14619     END-IF
 14620
 14621     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14622        IF WS-COMP-MAX-CAP GREATER THAN +0
 14623           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14624              IF (PB-REISSUED-CERT         OR
 14625                  PB-POLICY-IS-DECLINED    OR
 14626                  PB-POLICY-IS-VOIDED)
 14627                 NEXT SENTENCE
 14628              ELSE
 14629                  MOVE ER-2646   TO  WS-ERROR
 14630                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14631
 14632 3344-CVL-TOLERANCE-CHECK.
 14633
 14634      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14635          GO TO 3344-CHECK-AH.
 14636
 14637      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14638          GO TO 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 265
* EL050.cbl
 14639
 14640      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14641                                     WS-UNSIGN-WRK6.
 14642
 14643      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14644          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14645                                 + PB-I-LF-PREMIUM-AMT
 14646                                 - PB-I-LF-PREM-CALC.
 14647
 14648      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14649          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14650                                 + PB-I-LF-ALT-PREMIUM-AMT
 14651                                 - PB-I-LF-ALT-PREM-CALC.
 14652
 14653      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14654          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14655              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14656                 MOVE ER-2652    TO  WS-ERROR
 14657                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14658              ELSE
 14659                 MOVE ER-2650    TO  WS-ERROR
 14660                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14661
 14662      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14663          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14664              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14665                 MOVE ER-2652    TO  WS-ERROR
 14666                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14667              ELSE
 14668                 MOVE ER-2650    TO  WS-ERROR
 14669                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14670
 14671 3344-CHECK-AH.
 14672
 14673****************************************************************
 14674***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14675***
 14676
 14677     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14678         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14679             (1 + WS-TOL-AH-PREM-PCT)
 14680         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14681             (1 - WS-TOL-AH-PREM-PCT)
 14682     ELSE
 14683         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14684         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14685
 14686***
 14687***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14688***
 14689
 14690     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14691         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14692
 14693     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14694         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14695
 14696     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 266
* EL050.cbl
 14697        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14698
 14699     IF (PB-REISSUED-CERT)
 14700        OR (PB-POLICY-IS-DECLINED)
 14701        OR (PB-POLICY-IS-VOIDED)
 14702        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14703        CONTINUE
 14704     ELSE
 14705        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14706              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14707                          or
 14708           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14709              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14710           IF WS-PREM-REJECT-SW = SPACE
 14711              MOVE ER-3052       TO WS-ERROR
 14712              PERFORM 9900-ERROR-FORMAT
 14713                                 THRU 9900-EXIT
 14714           ELSE
 14715              MOVE ER-3050       TO WS-ERROR
 14716              PERFORM 9900-ERROR-FORMAT
 14717                                 THRU 9900-EXIT
 14718           END-IF
 14719        END-IF
 14720     END-IF
 14721     if (pb-company-id = 'DCC')
 14722        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14723        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14724        and (pb-i-policy-is-monthly)
 14725        compute ws-tol-ah-high-prem-amt =
 14726           pb-i-tot-fees-calc + ws-tol-ah-prem
 14727        compute ws-tol-ah-low-prem-amt =
 14728           pb-i-tot-fees-calc - ws-tol-ah-prem
 14729        if ws-tol-ah-prem-pct > zeros
 14730           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14731              (1 + ws-tol-ah-prem-pct)
 14732           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14733              (1 - ws-tol-ah-prem-pct)
 14734        else
 14735           move +9999999.99      to ws-tol-ah-high-prem-pct
 14736           move +0               to ws-tol-ah-low-prem-pct
 14737        end-if
 14738        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14739            or
 14740           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14741                          or
 14742           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14743           or
 14744           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14745            move er-3049         to ws-error
 14746           perform 9900-error-format
 14747                                 thru 9900-exit
 14748
 14749        end-if
 14750     end-if
 14751     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14752         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14753             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14754             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 267
* EL050.cbl
 14755
 14756     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14757        IF WS-COMP-MAX-CAP GREATER THAN +0
 14758           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14759              IF (PB-REISSUED-CERT         OR
 14760                  PB-POLICY-IS-DECLINED    OR
 14761                  PB-POLICY-IS-VOIDED)
 14762                 NEXT SENTENCE
 14763              ELSE
 14764                  MOVE ER-2646   TO  WS-ERROR
 14765                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14766
 14767     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14768        (WS-COMP-MAX-CAP EQUAL +0)
 14769           GO TO 3345-EDIT-CONTINUE.
 14770
 14771     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14772        GREATER THAN WS-COMP-MAX-CAP
 14773           MOVE ER-2646          TO  WS-ERROR
 14774           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14775
 14776 3345-EDIT-CONTINUE.
 14777
 14778*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14779*       IF PB-ENTRY-BATCH   NUMERIC
 14780*          IF PB-ISSUE
 14781*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14782*          ELSE
 14783*              IF PB-CANCELLATION
 14784*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14785
 14786*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14787*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14788*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14789*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14790*        ELSE
 14791*            MOVE  ER-1909            TO  WS-ERROR
 14792*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14793
 14794     IF PB-I-POLICY-ACCEPTED
 14795        IF PB-POLICY-IS-DECLINED  OR
 14796           PB-REISSUED-CERT  OR
 14797           PB-REIN-ONLY-CERT  OR
 14798           PB-POLICY-IS-VOIDED
 14799            MOVE  ER-1891         TO  WS-ERROR
 14800            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14801        ELSE
 14802            MOVE SPACE            TO  PB-BATCH-ENTRY
 14803            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14804
 14805     IF PB-I-POLICY-DECLINED
 14806        IF PB-REISSUED-CERT  OR
 14807           PB-REIN-ONLY-CERT  OR
 14808           PB-POLICY-IS-VOIDED
 14809            MOVE  ER-1906         TO  WS-ERROR
 14810            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14811        ELSE
 14812            MOVE  'D'             TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 268
* EL050.cbl
 14813                                      PB-I-ENTRY-STATUS.
 14814
 14815     IF PB-I-NEEDS-UNDERWRITING
 14816        IF PB-POLICY-IS-DECLINED OR
 14817           PB-REISSUED-CERT  OR
 14818           PB-REIN-ONLY-CERT  OR
 14819           PB-POLICY-IS-VOIDED
 14820            MOVE  ER-1907         TO  WS-ERROR
 14821            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14822        ELSE
 14823            MOVE 'U'              TO  PB-BATCH-ENTRY
 14824                                      PB-I-ENTRY-STATUS.
 14825
 14826     IF PB-NEEDS-UNDERWRITING
 14827        MOVE  ER-1901             TO  WS-ERROR
 14828        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14829     IF PB-COMPANY-ID = 'DCC'
 14830        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14831        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14832        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14833           AND (NOT WS-LF-CASH))
 14834                           OR
 14835           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14836           AND (NOT WS-AH-CASH)))
 14837                       AND
 14838           (PB-I-ENTRY-STATUS NOT = '5')
 14839           MOVE 'M'              TO PB-BATCH-ENTRY
 14840                                    PB-I-ENTRY-STATUS
 14841        END-IF
 14842     END-IF
 14843     IF  PB-COMPANY-ID NOT = 'NCL'
 14844         GO TO 3999-END-EDIT.
 14845
 14846     IF PB-REISSUED-CERT  OR
 14847        PB-POLICY-IS-DECLINED  OR
 14848        PB-POLICY-IS-VOIDED  OR
 14849        PB-I-OB
 14850         GO TO 3999-END-EDIT.
 14851
 14852     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14853         MOVE  ER-2644            TO  WS-ERROR
 14854         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14855         GO TO 3999-END-EDIT.
 14856
 14857     MOVE 'N'                     TO  FORM-MASTER-SW.
 14858     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14859
 14860     IF NOT FORM-MASTER-FOUND
 14861         GO TO 3999-END-EDIT.
 14862
 14863     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14864                                      FORM-MASTER-AH-SW.
 14865
 14866     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14867         MOVE  +1                 TO SUB6
 14868         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14869
 14870     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 269
* EL050.cbl
 14871         MOVE  +1                 TO SUB6
 14872         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14873
 14874     IF LF-FORM-MASTER-FOUND  OR
 14875        AH-FORM-MASTER-FOUND
 14876         GO TO 3360-CHECK-FORM-LIMITS
 14877     ELSE
 14878         GO TO 3999-END-EDIT.
 14879
 14880******************************************************************
 14881*                  3350-GET-ERFORM                               *
 14882*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14883*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14884******************************************************************
 14885
 14886 3350-GET-ERFORM.
 14887
 14888     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14889         GO TO  3350-ERFORM-GETMAIN.
 14890
 14891     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14892     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14893     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14894     MOVE 'Y'                     TO FORM-MASTER-SW.
 14895
 14896     IF PB-CANCELLATION
 14897         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14898            PB-SV-STATE          EQUAL   FO-STATE       AND
 14899            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14900              GO TO 3350-EXIT
 14901         ELSE
 14902             NEXT SENTENCE
 14903     ELSE
 14904         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14905            PB-SV-STATE          EQUAL   FO-STATE       AND
 14906            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14907              GO TO 3350-EXIT.
 14908
 14909 3350-ERFORM-GETMAIN.
 14910
 14911     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14912     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14913
 14914 3350-ERFORM-READ.
 14915
 14916     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14917     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14918     IF PB-CANCELLATION
 14919         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14920     ELSE
 14921         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14922     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14923
 14924     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14925
 14926     IF FORM-MASTER-FOUND
 14927       IF PB-CANCELLATION
 14928          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 270
* EL050.cbl
 14929             PB-SV-STATE          EQUAL   FO-STATE       AND
 14930             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14931              GO  TO 3350-EXIT
 14932          ELSE
 14933              NEXT SENTENCE
 14934       ELSE
 14935          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14936             PB-SV-STATE          EQUAL   FO-STATE       AND
 14937             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14938              GO  TO 3350-EXIT.
 14939
 14940     MOVE  'N'                    TO  FORM-MASTER-SW.
 14941     MOVE  ER-1895                TO  WS-ERROR.
 14942     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14943
 14944 3350-EXIT.
 14945      EXIT.
 14946
 14947******************************************************************
 14948*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14949*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14950*   VALID FOR THE POLICY FORM USED.                              *
 14951******************************************************************
 14952
 14953 3355-EDIT-FORM-LF-BENEFITS.
 14954
 14955     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14956        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14957         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14958         GO TO   3355-EXIT.
 14959
 14960     IF  SUB6    LESS THAN   +40
 14961         ADD  +1      TO  SUB6
 14962         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14963
 14964     MOVE  ER-1896         TO  WS-ERROR.
 14965     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14966
 14967 3355-EXIT.
 14968      EXIT.
 14969
 14970******************************************************************
 14971*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14972*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14973*   VALID FOR THE POLICY FORM USED.                              *
 14974******************************************************************
 14975
 14976 3356-EDIT-FORM-AH-BENEFITS.
 14977
 14978     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14979        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14980         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14981         GO TO  3356-EXIT.
 14982
 14983      IF  SUB6    LESS THAN     +40
 14984          ADD  +1      TO  SUB6
 14985          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14986
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 271
* EL050.cbl
 14987     MOVE  ER-1897         TO  WS-ERROR.
 14988     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14989
 14990 3356-EXIT.
 14991      EXIT.
 14992
 14993******************************************************************
 14994*                  3357-BENEFIT-SEARCH                           *
 14995*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14996*   CANCELLATIONS ONLY.                                          *
 14997******************************************************************
 14998 3357-BENEFIT-SEARCH.
 14999     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15000         MOVE +1                          TO SUB6
 15001         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15002
 15003     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15004         MOVE +1                          TO SUB6
 15005         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15006
 15007 3357-EXIT.
 15008     EXIT.
 15009
 15010******************************************************************
 15011*                  3358-BENEFIT-LIFE-SEARCH                      *
 15012*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15013*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15014*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15015******************************************************************
 15016 3358-BENEFIT-LIFE-SEARCH.
 15017     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15018       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15019         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15020           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15021              IF FO-PLAN-REFUND-METHOD (SUB6)
 15022                     IS GREATER THAN SPACES
 15023                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15024                                          WS-LF-REFUND-CALC
 15025                 GO TO 3358-EXIT.
 15026
 15027     IF SUB6 LESS THAN +40
 15028         ADD +1                 TO SUB6
 15029         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15030
 15031 3358-EXIT.
 15032     EXIT.
 15033******************************************************************
 15034*                  3359-BENEFIT-AH-SEARCH                        *
 15035*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15036*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15037*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15038******************************************************************
 15039 3359-BENEFIT-AH-SEARCH.
 15040     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15041       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15042         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15043           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15044              IF FO-PLAN-REFUND-METHOD (SUB6)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 272
* EL050.cbl
 15045                      IS GREATER THAN SPACES
 15046                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15047                                          WS-AH-REFUND-CALC
 15048                 GO TO 3359-EXIT.
 15049
 15050     IF SUB6 LESS THAN +40
 15051         ADD +1                 TO SUB6
 15052         GO TO 3359-BENEFIT-AH-SEARCH.
 15053
 15054 3359-EXIT.
 15055     EXIT.
 15056
 15057******************************************************************
 15058*                  3360-CHECK-FORM-LIMITS                        *
 15059*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15060*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15061******************************************************************
 15062
 15063 3360-CHECK-FORM-LIMITS.
 15064
 15065     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15066         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15067
 15068     IF NOT LF-FORM-MASTER-FOUND
 15069         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15070
 15071 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15072
 15073     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15074       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15075        WS-LF-JOINT-INDICATOR = 'J'  AND
 15076        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15077         IF PB-COMPANY-ID = 'NCL'
 15078            MOVE  ER-1911          TO  WS-ERROR
 15079            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15080         ELSE
 15081            MOVE  ER-1892          TO  WS-ERROR
 15082            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15083
 15084 3360-CHECK-FORM-LF-ATT-AGE.
 15085
 15086     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15087
 15088     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15089         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15090         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15091            IF PB-COMPANY-ID = 'NCL'
 15092                MOVE  ER-1913      TO  WS-ERROR
 15093                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15094            ELSE
 15095                MOVE  ER-1894      TO  WS-ERROR
 15096                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15097
 15098 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15099
 15100     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15101         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15102         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 273
* EL050.cbl
 15103            IF PB-COMPANY-ID = 'NCL'
 15104                MOVE  ER-1914      TO  WS-ERROR
 15105                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15106            ELSE
 15107                MOVE  ER-1899      TO  WS-ERROR
 15108                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15109
 15110 3360-CHECK-FORM-LF-TERM-BAMT.
 15111
 15112     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15113         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15114         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15115           IF  PB-COMPANY-ID = 'NCL'
 15116               MOVE  ER-1916       TO  WS-ERROR
 15117               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15118           ELSE
 15119               MOVE  ER-1902       TO  WS-ERROR
 15120               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15121
 15122     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15123                                    PB-I-LF-ALT-BENEFIT-AMT.
 15124
 15125     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15126         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15127         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15128             IF  PB-COMPANY-ID = 'NCL'
 15129                 MOVE  ER-1918     TO  WS-ERROR
 15130                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15131             ELSE
 15132                 MOVE  ER-1904     TO  WS-ERROR
 15133                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15134
 15135******************************************************************
 15136*                  3360-CHECK-FORM-AH-LIMITS                     *
 15137*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15138*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15139******************************************************************
 15140
 15141 3360-CHECK-FORM-AH-LIMITS.
 15142
 15143     IF NOT AH-FORM-MASTER-FOUND
 15144         GO TO 3999-END-EDIT.
 15145
 15146 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15147
 15148     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15149       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15150        WS-AH-JOINT-INDICATOR = 'J'  AND
 15151        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15152         IF PB-COMPANY-ID = 'NCL'
 15153            MOVE  ER-1912          TO  WS-ERROR
 15154            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15155         ELSE
 15156            MOVE  ER-1893          TO  WS-ERROR
 15157            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15158
 15159 3360-CHECK-FORM-AH-ATT-AGE.
 15160
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 274
* EL050.cbl
 15161     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15162
 15163     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15164         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15165         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15166            IF PB-COMPANY-ID = 'NCL'
 15167                MOVE  ER-1913      TO  WS-ERROR
 15168                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15169            ELSE
 15170                MOVE  ER-1894      TO  WS-ERROR
 15171                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15172
 15173 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15174
 15175     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15176         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15177         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15178            IF PB-COMPANY-ID = 'NCL'
 15179                MOVE  ER-1915      TO  WS-ERROR
 15180                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15181            ELSE
 15182                MOVE  ER-1900      TO  WS-ERROR
 15183                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15184
 15185 3360-CHECK-FORM-AH-TERM-BAMT.
 15186
 15187     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15188         FO-AH-MAX-TERM    GREATER THAN  +0
 15189         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15190             IF  PB-COMPANY-ID = 'NCL'
 15191                 MOVE  ER-1917     TO  WS-ERROR
 15192                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15193             ELSE
 15194                  MOVE  ER-1903    TO  WS-ERROR
 15195                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15196
 15197     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15198         FO-MAX-AH-AMT    GREATER THAN  +0
 15199         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15200             IF  PB-COMPANY-ID = 'NCL'
 15201                 MOVE  ER-1919     TO  WS-ERROR
 15202                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15203             ELSE
 15204                 MOVE  ER-1905     TO  WS-ERROR
 15205                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15206
 15207     GO TO 3999-END-EDIT.
 15208
 15209******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 275
* EL050.cbl
 15211******************************************************************
 15212*                  E D I T   C A N C E L                         *
 15213******************************************************************
 15214
 15215 3700-EDIT-CANCEL.
 15216     IF PB-COMPANY-ID = 'DMD'
 15217         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15218                                         WS-RES-MUNI-TAX
 15219                                         PB-CI-STATE-TAX
 15220                                         PB-CI-MUNI-TAX
 15221         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15222
 15223*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15224*       IF PB-ENTRY-BATCH  NUMERIC
 15225*          IF PB-CANCELLATION
 15226*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15227*          ELSE
 15228*             IF PB-ISSUE
 15229*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15230
 15231     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15232        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15233     END-IF
 15234*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15235*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15236
 15237     IF CM-ENTRY-STATUS = 'V'
 15238        MOVE ER-2780             TO WS-ERROR
 15239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15240        GO TO 3999-END-EDIT.
 15241
 15242     IF CM-ENTRY-STATUS = 'D'
 15243        MOVE ER-2781             TO WS-ERROR
 15244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15245        GO TO 3999-END-EDIT.
 15246
 15247     IF CM-ENTRY-STATUS = 'U'
 15248        MOVE ER-2782             TO WS-ERROR
 15249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15250
 15251***************************************************************
 15252*                                                             *
 15253*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15254*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15255*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15256*   OF ANOTHER COVERAGE.                                      *
 15257*                                                             *
 15258***************************************************************
 15259
 15260     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15261                                    PB-C-AH-CANCEL-VOID-SW.
 15262
 15263     IF PB-C-LF-CANCEL-AMT = ZERO
 15264        NEXT SENTENCE
 15265     ELSE
 15266        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15267           AND
 15268           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 276
* EL050.cbl
 15269               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15270               MOVE ER-2745           TO WS-ERROR
 15271               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15272
 15273     IF PB-C-AH-CANCEL-AMT = ZERO
 15274        NEXT SENTENCE
 15275     ELSE
 15276        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15277           AND
 15278           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15279               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15280               MOVE ER-2745           TO WS-ERROR
 15281               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15282
 15283     IF WS-LF-EARNINGS-CALC = '4'
 15284        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15285
 15286     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15287     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15288     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15289     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15290     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15291     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15292
 15293     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15294                                      PB-C-AH-REF-CALC.
 15295     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15296
 15297******************************************************************
 15298*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15299*             TO VALIDATE COVERAGE.                              *
 15300******************************************************************
 15301
 15302     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15303        PB-C-LF-CANCEL-AMT = ZEROS
 15304          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15305      ELSE
 15306          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15307
 15308     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15309        PB-C-AH-CANCEL-AMT = ZEROS
 15310          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15311      ELSE
 15312          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15313
 15314     EVALUATE TRUE
 15315         WHEN PB-CANCEL-FORCE             OR
 15316              PB-CANCEL-DATE-FORCED       OR
 15317              PB-FORCE-OFF
 15318                  IF PB-COMPANY-ID = 'ACE'
 15319                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15320                  END-IF
 15321         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15322               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15323              (PB-COMPANY-ID = 'ACE' )
 15324                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15325         WHEN OTHER
 15326              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 277
* EL050.cbl
 15327                 MOVE ER-2794              TO WS-ERROR
 15328              ELSE
 15329                 MOVE ER-2749              TO WS-ERROR
 15330              END-IF
 15331              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15332     END-EVALUATE.
 15333
 15334
 15335*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15336*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15337*            MOVE  ER-1909            TO  WS-ERROR
 15338*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15339*        ELSE
 15340*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15341
 15342     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15343     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15344        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15345     ELSE
 15346        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15347     END-IF
 15348     .
 15349 3705-EDIT-CANCEL-DT.
 15350
 15351     IF LF-COVERAGE-CANCELLED
 15352        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15353         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15354         MOVE WS-CURRENT-MONTH-END
 15355                                 TO DC-BIN-DATE-2
 15356         SET ELAPSED-BETWEEN-BIN TO TRUE
 15357*        MOVE 1                  TO DC-OPTION-CODE
 15358         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15359         IF DATE-CONVERSION-ERROR
 15360            NEXT SENTENCE
 15361          ELSE
 15362             IF DC-ELAPSED-DAYS GREATER +180
 15363                IF PB-CANCEL-DATE-FORCED  OR
 15364                   PB-CANCEL-DATE-FORCED-NO-FEE
 15365                      MOVE ER-2751  TO WS-ERROR
 15366                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15367                 ELSE
 15368                   MOVE ER-2752  TO WS-ERROR
 15369                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15370
 15371     IF AH-COVERAGE-CANCELLED
 15372        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15373         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15374         MOVE WS-CURRENT-MONTH-END
 15375                                 TO DC-BIN-DATE-2
 15376         SET ELAPSED-BETWEEN-BIN TO TRUE
 15377*        MOVE 1                  TO DC-OPTION-CODE
 15378         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15379         IF DATE-CONVERSION-ERROR
 15380            NEXT SENTENCE
 15381          ELSE
 15382             IF DC-ELAPSED-DAYS GREATER +180
 15383                IF PB-CANCEL-DATE-FORCED OR
 15384                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 278
* EL050.cbl
 15385                      MOVE ER-2751  TO WS-ERROR
 15386                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15387                 ELSE
 15388                   MOVE ER-2752  TO WS-ERROR
 15389                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15390
 15391     IF WS-ERROR = ER-2752
 15392        AND (PB-COMPANY-ID = 'ABL'
 15393         OR  PB-COMPANY-ID = 'FGL'
 15394         OR  PB-COMPANY-ID = 'IST'
 15395         OR  PB-COMPANY-ID = 'JHL'
 15396         OR  PB-COMPANY-ID = 'LAP'
 15397         OR  PB-COMPANY-ID = 'LBL'
 15398         OR  PB-COMPANY-ID = 'NCB'
 15399         OR  PB-COMPANY-ID = 'NLI'
 15400         OR  PB-COMPANY-ID = 'OFI'
 15401         OR  PB-COMPANY-ID = 'PLI'
 15402         OR  PB-COMPANY-ID = 'TAO'
 15403         OR  PB-COMPANY-ID = 'TIC'
 15404         OR  PB-COMPANY-ID = 'HER'
 15405         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15406         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15407            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15408            MOVE ER-2762     TO WS-ERROR
 15409            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15410
 15411     IF LF-COVERAGE-CANCELLED
 15412        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15413        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15414             MOVE ER-2733         TO WS-ERROR
 15415             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15416
 15417     IF AH-COVERAGE-CANCELLED
 15418        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15419        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15420              MOVE ER-2733        TO WS-ERROR
 15421              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15422
 15423     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15424        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15425        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15426           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15427            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15428              IF PB-COMPANY-ID NOT = 'LAP'
 15429               MOVE ER-2704            TO WS-ERROR
 15430               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15431
 15432     IF CERT-WAS-NOT-FOUND
 15433         GO TO 3999-END-EDIT.
 15434
 15435     IF PB-COMPANY-ID EQUAL 'CDC'
 15436        IF LF-COVERAGE-CANCELLED
 15437           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15438            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15439            MOVE PB-C-LF-CANCEL-DT
 15440                                 TO DC-BIN-DATE-2
 15441            SET ELAPSED-BETWEEN-BIN TO TRUE
 15442*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 279
* EL050.cbl
 15443            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15444            IF DATE-CONVERSION-ERROR
 15445               NEXT SENTENCE
 15446             ELSE
 15447                IF DC-ELAPSED-DAYS GREATER +60
 15448                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15449
 15450     IF PB-COMPANY-ID EQUAL 'CDC'
 15451        IF AH-COVERAGE-CANCELLED
 15452           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15453            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15454            MOVE PB-C-AH-CANCEL-DT
 15455                                 TO DC-BIN-DATE-2
 15456            MOVE +0              TO DC-ELAPSED-DAYS
 15457                                    DC-ELAPSED-MONTHS
 15458            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15459*           MOVE 1               TO DC-OPTION-CODE
 15460            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15461            IF DATE-CONVERSION-ERROR
 15462               NEXT SENTENCE
 15463             ELSE
 15464                IF DC-ELAPSED-DAYS GREATER +60
 15465                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15466
 15467     MOVE +0                     TO DC-ELAPSED-DAYS
 15468                                    DC-ELAPSED-MONTHS.
 15469
 15470     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15471        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15472          MOVE 'Z'                TO PB-CI-OB-FLAG
 15473          MOVE ER-2767            TO WS-ERROR
 15474          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15475          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15476          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15477          GO TO 3775-OVER-REF-CHK
 15478        ELSE
 15479          MOVE ZEROS              TO PB-CI-LIVES
 15480                                     PB-C-LIVES
 15481          IF PB-CI-OB-FLAG NOT = 'B'
 15482             MOVE SPACE           TO PB-CI-OB-FLAG.
 15483
 15484     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15485         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15486     ELSE
 15487         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15488
 15489     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15490        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15491            MOVE ER-2760         TO WS-ERROR
 15492            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15493
 15494     IF LF-COVERAGE-CANCELLED
 15495        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15496         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15497            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15498               MOVE ER-2774       TO WS-ERROR
 15499               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15500
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 280
* EL050.cbl
 15501     IF AH-COVERAGE-CANCELLED
 15502        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15503         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15504            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15505               MOVE ER-2775       TO WS-ERROR
 15506               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15507
 15508     IF LF-COVERAGE-CANCELLED
 15509        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15510         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15511            MOVE ER-2776         TO WS-ERROR
 15512            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15513
 15514     IF AH-COVERAGE-CANCELLED
 15515        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15516         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15517            MOVE ER-2777         TO WS-ERROR
 15518            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15519     IF LF-COVERAGE-CANCELLED
 15520        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15521        if pb-ci-lf-expire-dt = low-values or spaces
 15522           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15523           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15524           MOVE PB-CI-EXTENTION-DAYS
 15525                                 TO DC-ELAPSED-DAYS
 15526           SET BIN-PLUS-ELAPSED  TO TRUE
 15527           PERFORM 8500-DATE-CONVERT
 15528                                 THRU 8500-EXIT
 15529           IF DATE-CONVERSION-ERROR
 15530              move low-values    to dc-bin-date-2
 15531           end-if
 15532        else
 15533           move pb-ci-lf-expire-dt
 15534                                 to dc-bin-date-2
 15535        end-if
 15536        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15537           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15538                             OR  'FIA'
 15539              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15540           ELSE
 15541              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15542              MOVE ER-2731       TO WS-ERROR
 15543              PERFORM 9900-ERROR-FORMAT
 15544                                 THRU 9900-EXIT
 15545           end-if
 15546        end-if
 15547     end-if
 15548*    IF LF-COVERAGE-CANCELLED
 15549*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15550*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15551*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15552*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15553*        SET BIN-PLUS-ELAPSED      TO TRUE
 15554*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15555*        IF DATE-CONVERSION-ERROR
 15556*           NEXT SENTENCE
 15557*         ELSE
 15558*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 281
* EL050.cbl
 15559*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15560*                            OR  'FIA'
 15561*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15562*              ELSE
 15563*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15564*               MOVE ER-2731       TO WS-ERROR
 15565*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15566     .
 15567 3705-EDIT-AH-CANCEL-DT.
 15568     IF AH-COVERAGE-CANCELLED
 15569        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15570        if pb-ci-AH-expire-dt = low-values or spaces
 15571           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15572           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15573           MOVE PB-CI-EXTENTION-DAYS
 15574                                 TO DC-ELAPSED-DAYS
 15575           SET BIN-PLUS-ELAPSED  TO TRUE
 15576           PERFORM 8500-DATE-CONVERT
 15577                                 THRU 8500-EXIT
 15578           IF DATE-CONVERSION-ERROR
 15579              move low-values    to dc-bin-date-2
 15580           end-if
 15581        else
 15582           move pb-ci-ah-expire-dt
 15583                                 to dc-bin-date-2
 15584        end-if
 15585        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15586           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15587                             OR  'FIA'
 15588              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15589           ELSE
 15590              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15591              MOVE ER-2771       TO WS-ERROR
 15592              PERFORM 9900-ERROR-FORMAT
 15593                                 THRU 9900-EXIT
 15594           end-if
 15595        end-if
 15596     end-if
 15597*    IF AH-COVERAGE-CANCELLED
 15598*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15599*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15600*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15601*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15602**       MOVE 6                    TO DC-OPTION-CODE
 15603*        SET BIN-PLUS-ELAPSED      TO TRUE
 15604*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15605*        IF DATE-CONVERSION-ERROR
 15606*           NEXT SENTENCE
 15607*         ELSE
 15608*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15609*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15610*                             OR 'FIA'
 15611*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15612*             ELSE
 15613*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15614*              MOVE ER-2771       TO WS-ERROR
 15615*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15616     .
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 282
* EL050.cbl
 15617 3705-EDIT-CONTINUED.
 15618
 15619*    IF LF-COVERAGE-CANCELLED
 15620*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15621*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15622*            MOVE ER-2727         TO WS-ERROR
 15623*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15624*
 15625*    IF AH-COVERAGE-CANCELLED
 15626*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15627*        IF PB-COMPANY-ID = 'ACE'
 15628*           MOVE ER-2727        TO WS-ERROR
 15629*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15630*        ELSE
 15631*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15632*              MOVE ER-2727     TO WS-ERROR
 15633*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15634
 15635     IF PB-COMPANY-ID = 'ACE'
 15636       IF AH-COVERAGE-CANCELLED
 15637         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15638           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15639              MOVE ER-2732      TO WS-ERROR
 15640              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15641
 15642     IF PB-COMPANY-ID      EQUAL   'HER'
 15643        IF WS-ERROR        EQUAL   ER-2727
 15644            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15645            MOVE  ER-2725          TO  WS-ERROR
 15646            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15647
 15648     IF PB-C-CLAIM-CREATED-CANCEL
 15649            MOVE ER-2748         TO WS-ERROR
 15650            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15651
 15652     IF PB-C-LAST-NAME NOT = SPACES
 15653         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15654            MOVE ER-2747         TO WS-ERROR
 15655            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15656
 15657 3710-EDIT-LUMP-SUM-PRIOR.
 15658
 15659     IF AH-COVERAGE-CANCELLED
 15660         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15661             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15662                MOVE ER-2735    TO WS-ERROR
 15663                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15664
 15665     IF LF-COVERAGE-CANCELLED
 15666         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15667             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15668                MOVE ER-2735    TO WS-ERROR
 15669                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15670
 15671 3710-EDIT-PRIOR-DEATH.
 15672
 15673*    IF LF-COVERAGE-CANCELLED
 15674*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 283
* EL050.cbl
 15675*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15676*           (NOT PB-CI-OB)
 15677*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15678*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15679*                   MOVE ER-2732  TO WS-ERROR
 15680*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15681*
 15682*    IF AH-COVERAGE-CANCELLED
 15683*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15684*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15685*           (NOT PB-CI-OB)
 15686*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15687*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15688*                   MOVE ER-2732  TO WS-ERROR
 15689*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15690
 15691     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15692         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15693            (NOT PB-COMP-LF-CANCEL)
 15694             NEXT SENTENCE
 15695         ELSE
 15696           IF PB-C-LF-CANCEL-VOIDED
 15697              NEXT SENTENCE
 15698           ELSE
 15699              MOVE ER-2753      TO WS-ERROR
 15700              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15701
 15702     IF CANCEL-FUTURE-DT
 15703         GO TO 3999-END-EDIT.
 15704
 15705 3715-GET-REMAIN-TERM-LF.
 15706
 15707     IF NO-LF-BENEFIT-MATCH  OR
 15708        WS-LF-BENEFIT-CD = ZEROS
 15709        GO TO 3730-GET-AH-REMAIN-TERM.
 15710
 15711     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15712     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15713     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15714     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15715     MOVE PB-SV-STATE            TO CP-STATE.
 15716     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15717     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15718     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15719     MOVE '2'                    TO CP-PROCESS-TYPE.
 15720     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15721     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15722     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15723     IF (PB-COMPANY-ID = 'CID')
 15724        AND (CP-STATE-STD-ABBRV = 'WI')
 15725        MOVE '7'                 TO CP-REM-TERM-METHOD
 15726        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15727     ELSE
 15728        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15729        MOVE WS-REM-TRM-CALC-OPTION
 15730                                 TO CP-REM-TRM-CALC-OPTION
 15731     END-IF
 15732**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 284
* EL050.cbl
 15733     IF (PB-COMPANY-ID = 'CID')
 15734        AND (CP-STATE-STD-ABBRV = 'MO')
 15735        AND (PB-CERT-EFF-DT >= X'9B41')
 15736        AND (PB-CERT-EFF-DT <= X'A2FB')
 15737        MOVE '7'                 TO CP-REM-TERM-METHOD
 15738        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15739     END-IF
 15740     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15741                                    CP-LOAN-TERM.
 15742     IF CP-TRUNCATED-LIFE
 15743        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15744
 15745     IF CP-TERM-IS-DAYS
 15746         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15747     ELSE
 15748         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15749
 15750     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15751
 15752     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15753
 15754     IF LF-COVERAGE-CANCELLED
 15755        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15756        NEXT SENTENCE
 15757      ELSE
 15758          GO TO 3730-GET-AH-REMAIN-TERM.
 15759
 15760 3720-GET-LF-REFUND.
 15761
 15762     IF PB-C-LF-CANCEL-VOIDED OR
 15763        PB-C-AH-CANCEL-VOIDED
 15764        GO TO 3780-UPDATE-CANCEL-CERT.
 15765
 15766     IF PB-COMPANY-ID EQUAL 'BOA'
 15767         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15768         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15769         GO TO 3730-GET-AH-REMAIN-TERM.
 15770
 15771     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15772        (WS-AH-SPECIAL-CALC-CD = 'M')
 15773         MOVE ER-2767            TO WS-ERROR
 15774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15775         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15776         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15777         GO TO 3780-UPDATE-CANCEL-CERT.
 15778
 15779     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15780
 15781     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15782     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15783     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15784     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15785     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15786     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15787     IF (PB-COMPANY-ID = 'DCC')
 15788        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15789        IF PDEF-MASTER-FOUND
 15790           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 285
* EL050.cbl
 15791              (V1 > +8)
 15792              OR (PD-PROD-CODE (V1) = 'L')
 15793           END-PERFORM
 15794           IF V1 < +9
 15795              MOVE PD-MAX-AMT (V1)
 15796                           TO CP-R-MAX-TOT-BEN
 15797                              EC-AM-LF-MAX-TOT-BEN
 15798           END-IF
 15799        ELSE
 15800        MOVE ' '                 TO PDEF-MASTER-SW
 15801        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15802        MOVE PB-STATE            TO ERPDEF-STATE
 15803        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15804        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15805        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15806        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15807        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15808        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15809        IF PDEF-MASTER-FOUND
 15810           MOVE 'N'              TO PDEF-MASTER-SW
 15811           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15812           IF PDEF-MASTER-FOUND
 15813              IF (ERPDEF-KEY-SAVE (1:16) =
 15814                           PD-CONTROL-PRIMARY (1:16))
 15815                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15816                 CONTINUE
 15817              ELSE
 15818                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15819                 IF (ERPDEF-KEY-SAVE (1:16) =
 15820                           PD-CONTROL-PRIMARY (1:16))
 15821                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15822                    CONTINUE
 15823                 ELSE
 15824                    MOVE 'N'     TO PDEF-MASTER-SW
 15825                 END-IF
 15826              END-IF
 15827              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15828
 15829              IF PDEF-MASTER-FOUND
 15830                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15831                    (V1 > +8)
 15832                    OR (PD-PROD-CODE (V1) = 'L')
 15833                 END-PERFORM
 15834                 IF V1 < +9
 15835                    MOVE PD-MAX-AMT (V1)
 15836                                 TO CP-R-MAX-TOT-BEN
 15837                                    EC-AM-LF-MAX-TOT-BEN
 15838                 END-IF
 15839              END-IF
 15840           END-IF
 15841           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15842        END-IF
 15843        END-IF
 15844     END-IF
 15845     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15846
 15847     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15848
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 286
* EL050.cbl
 15849     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15850                                    PB-C-LF-REM-TERM.
 15851
 15852     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15853     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15854
 15855     IF PB-COMPANY-ID EQUAL 'FLC'
 15856        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15857           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15858           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15859                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15860                    - CM-LF-ITD-DEATH-AMT
 15861           IF PB-C-LF-REF-CALC LESS THAN +0
 15862              MOVE +0            TO PB-C-LF-REF-CALC
 15863              GO TO 3730-GET-AH-REMAIN-TERM
 15864           ELSE
 15865              GO TO 3730-GET-AH-REMAIN-TERM.
 15866
 15867     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15868                            OR '4' OR '5' OR '6' OR '8'
 15869                            OR '9' OR 'G'
 15870        MOVE PB-C-LF-REFUND-OVERRIDE
 15871                                 TO CP-EARNING-METHOD.
 15872
 15873     if pb-company-id = 'AHL'
 15874        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15875        if cp-class-code = spaces
 15876           move zeros            to cp-class-code
 15877        end-if
 15878     ELSE
 15879        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15880     END-IF
 15881*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15882     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15883     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15884                                    CP-RATING-BENEFIT-AMT.
 15885     IF CP-STATE-STD-ABBRV = 'OR'
 15886         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15887                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15888     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15889     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15890     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15891     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15892     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15893     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15894     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15895     IF WS-DEFAULT-APR NOT NUMERIC
 15896         MOVE ZEROS TO WS-DEFAULT-APR.
 15897****   N O T E   ****
 15898*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15899*      THE OH HARD CODING IN ELCRFNDP
 15900
 15901     IF PB-COMPANY-ID = 'CID'
 15902        IF CP-STATE-STD-ABBRV = 'OH'
 15903           MOVE WS-LF-EARNINGS-CALC
 15904                                 TO CP-EARNING-METHOD
 15905        END-IF
 15906     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 287
* EL050.cbl
 15907
 15908****   N O T E   ****
 15909
 15910     IF CP-EARN-AS-NET-PAY
 15911         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15912            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15913                MOVE WS-DEFAULT-APR
 15914                                 TO  CP-LOAN-APR
 15915                MOVE ER-3780     TO  WS-ERROR
 15916                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15917            ELSE
 15918                MOVE ER-3781     TO  WS-ERROR
 15919                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15920     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15921     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15922
 15923     IF CP-REFUND-TYPE-USED NOT = SPACE
 15924         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15925
 15926     IF CP-ERROR-RATE-IS-ZERO OR
 15927        CP-ERROR-RATE-NOT-FOUND
 15928        MOVE ER-2740             TO WS-ERROR
 15929        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15930
 15931     IF CP-ERROR-RATE-FILE-NOTOPEN
 15932        MOVE ER-2617             TO WS-ERROR
 15933        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15934
 15935     IF PB-COMPANY-ID = 'DCC'
 15936        AND PB-CI-ENTRY-STATUS = 'M'
 15937        MOVE +0                  TO PB-C-LF-REF-CALC
 15938     ELSE
 15939        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15940     END-IF
 15941
 15942     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15943         GO TO 3730-GET-AH-REMAIN-TERM.
 15944
 15945*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15946*       ADD +1                   TO PB-C-LF-REM-TERM
 15947*                                   CP-REMAINING-TERM
 15948*                                   CP-ORIGINAL-TERM.
 15949
 15950     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15951     MOVE '2'                    TO CP-EARNING-METHOD
 15952                                    CP-RATING-METHOD.
 15953     IF PB-COMPANY-ID = 'CID'
 15954        IF (CP-STATE-STD-ABBRV = 'MN')
 15955           AND (PB-CERT-EFF-DT > X'A4FF')
 15956           AND (WS-LF-EARNINGS-CALC = 'B')
 15957           MOVE '5'              TO CP-EARNING-METHOD
 15958           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15959        END-IF
 15960     END-IF
 15961     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15962                                        CP-REMAINING-BENEFIT
 15963                                        CP-RATING-BENEFIT-AMT.
 15964     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 288
* EL050.cbl
 15965         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15966                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15967     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15968     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15969
 15970     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15971
 15972     IF CP-ERROR-RATE-IS-ZERO OR
 15973        CP-ERROR-RATE-NOT-FOUND
 15974        MOVE ER-2740             TO WS-ERROR
 15975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15976
 15977     IF CP-ERROR-RATE-FILE-NOTOPEN
 15978        MOVE ER-2617             TO WS-ERROR
 15979        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15980
 15981     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15982
 15983******************************************************************
 15984
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 289
* EL050.cbl
 15986 3730-GET-AH-REMAIN-TERM.
 15987     IF NO-AH-BENEFIT-MATCH  OR
 15988        WS-AH-BENEFIT-CD = ZEROS
 15989         GO TO 3770-CHECK-REFUNDS.
 15990
 15991     IF PB-CI-AH-LUMP-SUM-DISAB
 15992         IF  PB-C-AH-CANCEL-AMT = ZERO
 15993            IF NOT PB-COMP-AH-CANCEL
 15994             GO TO 3770-CHECK-REFUNDS.
 15995
 15996     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15997     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15998     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15999     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16000     MOVE PB-SV-STATE            TO CP-STATE.
 16001     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16002     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16003     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16004     MOVE '2'                    TO CP-PROCESS-TYPE.
 16005     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16006     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16007     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16008     IF (PB-COMPANY-ID = 'CID')
 16009        AND (CP-STATE-STD-ABBRV = 'WI')
 16010        MOVE '7'                 TO CP-REM-TERM-METHOD
 16011        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16012     ELSE
 16013        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16014        MOVE WS-REM-TRM-CALC-OPTION
 16015                                 TO CP-REM-TRM-CALC-OPTION
 16016     END-IF
 16017     IF (PB-COMPANY-ID = 'CID')
 16018        AND (CP-STATE-STD-ABBRV = 'MO')
 16019        AND (PB-CERT-EFF-DT >= X'9B41')
 16020        AND (PB-CERT-EFF-DT <= X'A2FB')
 16021        MOVE '7'                 TO CP-REM-TERM-METHOD
 16022        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16023     END-IF
 16024     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16025                                    CP-LOAN-TERM.
 16026     IF NOT CP-TERM-IS-DAYS
 16027         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16028
 16029     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16030
 16031     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16032
 16033     IF AH-COVERAGE-CANCELLED
 16034        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16035        NEXT SENTENCE
 16036      ELSE
 16037         GO TO 3770-CHECK-REFUNDS.
 16038
 16039 3740-GET-AH-REFUND.
 16040
 16041     IF PB-C-LF-CANCEL-VOIDED OR
 16042        PB-C-AH-CANCEL-VOIDED
 16043        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 290
* EL050.cbl
 16044
 16045     IF PB-COMPANY-ID = 'BOA'
 16046         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16047         GO TO 3770-CHECK-REFUNDS.
 16048
 16049     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16050*    MOVE ' '                    TO DC-OPTION-CODE
 16051     SET BIN-TO-GREG             TO TRUE
 16052     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16053     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16054                                    PB-C-AH-REM-TERM.
 16055     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16056     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16057
 16058     IF PB-COMPANY-ID EQUAL 'FLC'
 16059        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16060           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16061           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16062                    - CM-AH-ITD-AH-PMT)
 16063           IF PB-C-AH-REF-CALC LESS THAN +0
 16064              MOVE +0            TO PB-C-AH-REF-CALC
 16065              GO TO 3770-CHECK-REFUNDS
 16066           ELSE
 16067              GO TO 3770-CHECK-REFUNDS.
 16068
 16069     IF PB-COMPANY-ID = 'DCC'
 16070        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16071            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16072           MOVE 'S'              TO CP-EARNING-METHOD
 16073        END-IF
 16074     END-IF
 16075     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16076                            OR '4' OR '5' OR '6' OR '8'
 16077                            OR '9' OR 'G' OR 'S'
 16078        MOVE PB-C-AH-REFUND-OVERRIDE
 16079                                 TO CP-EARNING-METHOD.
 16080
 16081     if pb-company-id = 'AHL'
 16082        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16083        if cp-class-code = spaces
 16084           move zeros            to cp-class-code
 16085        end-if
 16086     ELSE
 16087        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16088     END-IF
 16089*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16090     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16091     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16092                                    CP-RATING-BENEFIT-AMT.
 16093     IF CP-STATE-STD-ABBRV = 'OR'
 16094         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16095                                         PB-CI-AH-TERM.
 16096     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16097     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16098     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16099     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16100     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16101     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 291
* EL050.cbl
 16102
 16103     IF CP-STATE-STD-ABBRV = 'OH'
 16104        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16105                                AND 'CID' AND 'DCC' AND 'AHL')
 16106           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16107              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16108              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16109              MOVE '6' TO CP-EARNING-METHOD
 16110           END-IF
 16111        END-IF
 16112        IF PB-COMPANY-ID = 'CID'
 16113           IF NO-LIFE-COVERAGE
 16114              IF CP-CRITICAL-PERIOD
 16115                 MOVE '2'       TO CP-EARNING-METHOD
 16116              ELSE
 16117                 MOVE '6'       TO CP-EARNING-METHOD
 16118              END-IF
 16119           ELSE
 16120              IF WS-LF-COVERAGE-TYPE = 'L'
 16121                 MOVE '2'       TO CP-EARNING-METHOD
 16122              ELSE
 16123                 IF (PB-CI-LF-TERM > +60) OR
 16124                    (WS-LF-EARNINGS-CALC = '5')
 16125                    IF CP-CRITICAL-PERIOD
 16126                       MOVE '2'  TO CP-EARNING-METHOD
 16127                    ELSE
 16128                       MOVE '6'  TO CP-EARNING-METHOD
 16129                    END-IF
 16130                 ELSE
 16131                    MOVE '1'     TO CP-EARNING-METHOD
 16132                 END-IF
 16133              END-IF
 16134           END-IF
 16135        END-IF
 16136     END-IF
 16137
 16138*    IF CP-STATE-STD-ABBRV = 'VA'
 16139*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16140*          IF CP-ORIGINAL-TERM GREATER 61
 16141*             MOVE '6' TO CP-EARNING-METHOD
 16142*          ELSE
 16143*             MOVE '1' TO CP-EARNING-METHOD.
 16144
 16145     IF WS-DEFAULT-APR NOT NUMERIC
 16146         MOVE ZEROS TO WS-DEFAULT-APR.
 16147     IF CP-EARN-AS-NET-PAY
 16148         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16149            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16150                MOVE WS-DEFAULT-APR
 16151                                 TO  CP-LOAN-APR
 16152                MOVE ER-3780     TO  WS-ERROR
 16153                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16154            ELSE
 16155                MOVE ER-3781     TO  WS-ERROR
 16156                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16157     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16158     IF PB-COMPANY-ID = 'DCC'
 16159        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 292
* EL050.cbl
 16160        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16161        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16162     END-IF
 16163     IF PB-COMPANY-ID = 'DCC'
 16164        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16165        AND (CP-EARNING-METHOD = 'D')
 16166        AND (CP-CANCEL-REASON NOT = 'R')
 16167        CONTINUE
 16168     ELSE
 16169        GO TO 3750-CONTINUE
 16170     END-IF
 16171     MOVE ' '                    TO DD-IU-SW
 16172     IF NOT PDEF-MASTER-FOUND
 16173        MOVE ' '                 TO PDEF-MASTER-SW
 16174        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16175        MOVE PB-STATE            TO ERPDEF-STATE
 16176        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16177        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16178        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16179        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16180        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16181        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16182        IF PDEF-MASTER-FOUND
 16183           MOVE 'N'              TO PDEF-MASTER-SW
 16184           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16185           IF PDEF-MASTER-FOUND
 16186              IF (ERPDEF-KEY-SAVE (1:16) =
 16187                           PD-CONTROL-PRIMARY (1:16))
 16188                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16189                 CONTINUE
 16190              ELSE
 16191                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16192                 IF (ERPDEF-KEY-SAVE (1:16) =
 16193                           PD-CONTROL-PRIMARY (1:16))
 16194                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16195                    CONTINUE
 16196                 ELSE
 16197                    MOVE ER-2740 TO WS-ERROR
 16198                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16199                    GO TO 3770-CHECK-REFUNDS
 16200                 END-IF
 16201              END-IF
 16202           END-IF
 16203           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16204        END-IF
 16205     END-IF
 16206     IF PDEF-MASTER-FOUND
 16207        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16208           (V1 > +8)
 16209           OR (PD-PROD-CODE (V1) = 'I')
 16210        END-PERFORM
 16211        IF V1 < +9
 16212           SET DD-IU-PRESENT        TO TRUE
 16213        END-IF
 16214        IF WS-AH-DCC-TRUNC = 'T'
 16215           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16216        ELSE
 16217           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 293
* EL050.cbl
 16218        END-IF
 16219        EVALUATE TRUE
 16220           WHEN WS-TERM > +168
 16221              MOVE 15               TO V1
 16222           WHEN WS-TERM > +156
 16223              MOVE 14               TO V1
 16224           WHEN WS-TERM > +144
 16225              MOVE 13               TO V1
 16226           WHEN WS-TERM > +132
 16227              MOVE 12               TO V1
 16228           WHEN WS-TERM > +120
 16229              MOVE 11               TO V1
 16230           WHEN WS-TERM > +108
 16231              MOVE 10               TO V1
 16232           WHEN WS-TERM > +96
 16233              MOVE 9                TO V1
 16234           WHEN WS-TERM > +84
 16235              MOVE 8                TO V1
 16236           WHEN WS-TERM > +72
 16237              MOVE 7                TO V1
 16238           WHEN WS-TERM > +60
 16239              MOVE 6                TO V1
 16240           WHEN WS-TERM > +48
 16241              MOVE 5                TO V1
 16242           WHEN WS-TERM > +36
 16243              MOVE 4                TO V1
 16244           WHEN WS-TERM > +24
 16245              MOVE 3                TO V1
 16246           WHEN WS-TERM > +12
 16247              MOVE 2                TO V1
 16248           WHEN OTHER
 16249              MOVE 1                TO V1
 16250        END-EVALUATE
 16251
 16252        EVALUATE TRUE
 16253*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16254*             < +13)
 16255*             AND (DD-IU-PRESENT)
 16256*             MOVE 2                TO V2
 16257*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16258*             MOVE 1                TO V2
 16259           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16260              MOVE 2                TO V2
 16261           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16262              MOVE 3                TO V2
 16263           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16264              MOVE 4                TO V2
 16265           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16266              MOVE 5                TO V2
 16267           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16268              MOVE 6                TO V2
 16269           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16270              MOVE 7                TO V2
 16271           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16272              MOVE 8                TO V2
 16273           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16274              MOVE 9                TO V2
 16275           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 294
* EL050.cbl
 16276              MOVE 10               TO V2
 16277           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16278              MOVE 11               TO V2
 16279           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16280              MOVE 12               TO V2
 16281           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16282              MOVE 13               TO V2
 16283           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16284              MOVE 14               TO V2
 16285           WHEN OTHER
 16286              MOVE 15               TO V2
 16287        END-EVALUATE
 16288
 16289        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16290                                 TO CP-DDF-LO-FACT
 16291        MOVE PD-UEP-FACTOR (V1 V2)
 16292                                 TO CP-DDF-HI-FACT
 16293
 16294        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16295        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16296        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16297           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16298        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16299        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16300        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16301           + PD-1ST-YR-ADMIN-ALLOW
 16302
 16303        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16304*       IF PI-CLP-YN = 'Y'
 16305*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16306*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16307*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16308*       END-IF
 16309
 16310        IF DD-IU-PRESENT
 16311           MOVE 'I'              TO CP-EARNING-METHOD
 16312        END-IF
 16313        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16314                                     CP-CLP-RATE-UP
 16315        IF CP-IU-RATE-UP NOT = ZEROS
 16316           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16317              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16318           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16319              / (1 - WS-WORK-FACT)
 16320        END-IF
 16321     END-IF
 16322     .
 16323 3750-CONTINUE.
 16324     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16325
 16326     IF CP-REFUND-TYPE-USED NOT = SPACE
 16327         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16328
 16329     IF CP-ERROR-RATE-IS-ZERO OR
 16330        CP-ERROR-RATE-NOT-FOUND
 16331        MOVE ER-2740             TO WS-ERROR
 16332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16333
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 295
* EL050.cbl
 16334     IF CP-ERROR-RATE-FILE-NOTOPEN
 16335        MOVE ER-2617             TO WS-ERROR
 16336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16337     IF PB-COMPANY-ID = 'DCC'
 16338        AND PB-CI-ENTRY-STATUS = 'M'
 16339        MOVE +0                  TO PB-C-AH-REF-CALC
 16340     ELSE
 16341        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16342     END-IF
 16343     IF PB-COMPANY-ID = 'DCC'
 16344        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16345        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16346        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16347        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16348        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16349        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16350        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16351        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16352        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16353     END-IF
 16354     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 296
* EL050.cbl
 16356
 16357 3770-CHECK-REFUNDS.
 16358
 16359     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16360        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16361           MOVE ER-2766          TO WS-ERROR
 16362           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16363           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16364           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16365              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16366
 16367     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16368        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16369           MOVE ER-2766          TO WS-ERROR
 16370           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16371           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16372           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16373              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16374
 16375     IF PB-COMP-LF-CANCEL
 16376        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16377        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16378           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16379              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16380
 16381     IF PB-COMP-AH-CANCEL
 16382        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16383        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16384           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16385              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16386
 16387     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16388             GIVING WS-UNSIGN-WRK1
 16389     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16390             GIVING WS-UNSIGN-WRK2.
 16391
 16392     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16393         MOVE ZERO TO WS-UNSIGN-WRK1.
 16394
 16395     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16396         MOVE ZERO TO WS-UNSIGN-WRK2.
 16397
 16398     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16399
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 297
* EL050.cbl
 16401
 16402 3772-CONTINUE.
 16403
 16404**********************************
 16405*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16406*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16407*** DOUBLES THE TOLERANCE AMOUNT.
 16408***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16409**********************************
 16410     IF PB-COMPANY-ID = 'MON'
 16411     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16412         IF WS-REF-REJECT-SW = SPACE
 16413             MOVE ER-2754        TO WS-ERROR
 16414             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16415           ELSE
 16416             MOVE ER-2736        TO WS-ERROR
 16417             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16418**********************************
 16419
 16420 3773-CONTINUE.
 16421
 16422     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16423        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16424           MOVE ER-2723          TO WS-ERROR
 16425           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16426
 16427     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16428        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16429           MOVE ER-2724          TO WS-ERROR
 16430           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16431
 16432     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16433         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16434             (1 + WS-LF-REFUND-OVS-PCT)
 16435     ELSE
 16436         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16437
 16438     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16439         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16440             (1 - WS-TOL-LF-REFUND-PCT)
 16441     ELSE
 16442         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16443
 16444     IF (PB-COMPANY-ID = 'DCC')
 16445        AND (PB-CI-ENTRY-STATUS = 'M')
 16446        AND (PB-C-LF-CANCEL-AMT > +0)
 16447        MOVE ER-3843             TO WS-ERROR
 16448        PERFORM 9900-ERROR-FORMAT
 16449                                 THRU 9900-EXIT
 16450     END-IF
 16451     EVALUATE TRUE
 16452        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16453           CONTINUE
 16454        WHEN PB-C-LF-CANCEL-AMT = +0
 16455                 AND PB-C-LF-REF-CALC > +0
 16456           CONTINUE
 16457        WHEN WS-LF-REFUND-OVS-AMT = 0
 16458                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 298
* EL050.cbl
 16459           CONTINUE
 16460        WHEN OTHER
 16461           IF WS-TOL-LF-REFUND  = +0
 16462              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16463           END-IF
 16464           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16465                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16466                          (PB-C-LF-CANCEL-AMT))
 16467              CONTINUE
 16468           ELSE
 16469              IF WS-LF-REFUND-OVS-AMT = +0
 16470                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16471              END-IF
 16472              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16473                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16474                                       PB-C-LF-CANCEL-AMT)
 16475                 CONTINUE
 16476              ELSE
 16477                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16478                   MOVE ER-2754   TO  WS-ERROR
 16479                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16480                 ELSE
 16481                    MOVE ER-2736   TO  WS-ERROR
 16482                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16483                 END-IF
 16484              END-IF
 16485           END-IF
 16486     END-EVALUATE.
 16487
 16488     EVALUATE TRUE
 16489        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16490           CONTINUE
 16491        WHEN PB-C-LF-CANCEL-AMT = +0
 16492                 AND PB-C-LF-REF-CALC > +0
 16493           CONTINUE
 16494        WHEN OTHER
 16495           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16496               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16497              CONTINUE
 16498           ELSE
 16499              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16500               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16501                CONTINUE
 16502              ELSE
 16503                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16504                     MOVE ER-2754   TO  WS-ERROR
 16505                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16506                 ELSE
 16507                     MOVE ER-2736   TO  WS-ERROR
 16508                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16509                 END-IF
 16510              END-IF
 16511           END-IF
 16512     END-EVALUATE.
 16513
 16514     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16515         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16516             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 299
* EL050.cbl
 16517     ELSE
 16518         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16519
 16520     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16521         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16522             (1 - WS-TOL-AH-REFUND-PCT)
 16523     ELSE
 16524         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16525
 16526     IF (PB-COMPANY-ID = 'DCC')
 16527        AND (PB-CI-ENTRY-STATUS = 'M')
 16528        AND (PB-C-AH-CANCEL-AMT > +0)
 16529        MOVE ER-3843             TO WS-ERROR
 16530        PERFORM 9900-ERROR-FORMAT
 16531                                 THRU 9900-EXIT
 16532     END-IF
 16533     EVALUATE TRUE
 16534        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16535           CONTINUE
 16536*       WHEN PB-C-AH-REF-CALC = +0 AND
 16537*                  PB-C-AH-CANCEL-AMT > +0
 16538        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16539                   PB-C-AH-REF-CALC > +0
 16540           CONTINUE
 16541        WHEN WS-AH-REFUND-OVS-AMT = +0
 16542                AND WS-TOL-AH-REFUND = +0
 16543           CONTINUE
 16544        WHEN OTHER
 16545           IF WS-TOL-AH-REFUND = +0
 16546              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16547           END-IF
 16548           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16549               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16550                                         PB-C-AH-CANCEL-AMT)
 16551              CONTINUE
 16552           ELSE
 16553              IF WS-AH-REFUND-OVS-AMT = +0
 16554                 MOVE +9999999.99 TO
 16555                         WS-AH-REFUND-OVS-AMT
 16556              END-IF
 16557              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16558                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16559                                         PB-C-AH-CANCEL-AMT)
 16560                 CONTINUE
 16561              ELSE
 16562                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16563                    MOVE ER-2754   TO  WS-ERROR
 16564                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16565                 ELSE
 16566                    MOVE ER-2736   TO  WS-ERROR
 16567                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16568                 END-IF
 16569              END-IF
 16570           END-IF
 16571     END-EVALUATE.
 16572
 16573     EVALUATE TRUE
 16574        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 300
* EL050.cbl
 16575           CONTINUE
 16576*       WHEN PB-C-AH-REF-CALC > +0 AND
 16577*                  PB-C-AH-CANCEL-AMT = +0
 16578        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16579                   PB-C-AH-REF-CALC = +0
 16580           CONTINUE
 16581        WHEN OTHER
 16582           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16583               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16584              CONTINUE
 16585           ELSE
 16586              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16587                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16588                 CONTINUE
 16589              ELSE
 16590                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16591                     MOVE ER-2754   TO  WS-ERROR
 16592                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16593                 ELSE
 16594                     MOVE ER-2736   TO  WS-ERROR
 16595                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16596                 END-IF
 16597              END-IF
 16598           END-IF
 16599     END-EVALUATE.
 16600
 16601     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16602        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16603        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16604           AND  PB-C-LF-REF-CALC < +1.00
 16605           AND  PB-C-AH-REF-CALC < +1.00
 16606           CONTINUE
 16607        ELSE
 16608           IF (PB-COMPANY-ID = 'DCC')
 16609              AND (PB-CI-ENTRY-STATUS = 'M')
 16610              CONTINUE
 16611           ELSE
 16612              MOVE ER-2741       TO WS-ERROR
 16613              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16614           END-IF
 16615        END-IF
 16616     END-IF
 16617
 16618     IF (PB-C-LF-CANCEL-AMT = ZERO
 16619        AND WS-LF-BENEFIT-CD NOT = ZERO
 16620        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16621        AND PB-C-LF-REF-CALC NOT = ZERO)
 16622        OR
 16623        (PB-C-LF-CANCEL-AMT = ZERO
 16624        AND WS-LF-BENEFIT-CD NOT = ZERO
 16625        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16626             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16627                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16628                NEXT SENTENCE
 16629             ELSE
 16630                MOVE ER-2739        TO WS-ERROR
 16631                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16632
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 301
* EL050.cbl
 16633     IF (PB-C-AH-CANCEL-AMT = ZERO
 16634        AND WS-AH-BENEFIT-CD NOT = ZERO
 16635        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16636        AND PB-C-AH-REF-CALC NOT = ZERO)
 16637        OR
 16638        (PB-C-AH-CANCEL-AMT = ZERO
 16639        AND WS-AH-BENEFIT-CD NOT = ZERO
 16640        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16641             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16642                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16643                NEXT SENTENCE
 16644             ELSE
 16645                MOVE ER-2738        TO WS-ERROR
 16646                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16647
 16648 3775-OVER-REF-CHK.
 16649
 16650     IF PB-CI-ENTRY-STATUS = '5'
 16651        GO TO 3780-UPDATE-CANCEL-CERT.
 16652
 16653     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16654                              PB-CI-LF-ALT-PREMIUM-AMT.
 16655
 16656     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16657        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16658                                 PB-C-LF-REF-CALC
 16659      ELSE
 16660        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16661                                 PB-C-LF-CANCEL-AMT.
 16662
 16663     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16664        MOVE ER-2755             TO WS-ERROR
 16665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16666
 16667     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16668
 16669     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16670        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16671                                 PB-C-AH-REF-CALC
 16672      ELSE
 16673        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16674                                 PB-C-AH-CANCEL-AMT.
 16675
 16676     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16677        MOVE ER-2778             TO WS-ERROR
 16678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16679
 16680     IF PB-CI-OB-FLAG NOT = 'Z'
 16681        NEXT SENTENCE
 16682       ELSE
 16683         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16684            MOVE ER-2757           TO WS-ERROR
 16685            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16686
 16687 3780-UPDATE-CANCEL-CERT.
 16688
 16689     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16690        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 302
* EL050.cbl
 16691        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16692
 16693     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16694         MOVE ER-2729              TO WS-ERROR
 16695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16696
 16697     IF PB-CI-LF-BENEFIT-CD = ZERO
 16698         GO TO 3780-UPDATE-CONT-1.
 16699
 16700     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16701         GO TO 3780-UPDATE-CONT-1.
 16702
 16703     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16704       AND
 16705        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16706       AND
 16707        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16708       AND
 16709        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16710            NEXT SENTENCE
 16711       ELSE
 16712        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16713          AND
 16714***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16715***       AND
 16716           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16717            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16718               MOVE ER-2730      TO WS-ERROR
 16719               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16720               GO TO 3999-END-EDIT
 16721            ELSE
 16722               GO TO 3999-END-EDIT
 16723        ELSE
 16724            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16725               MOVE ER-2765           TO WS-ERROR
 16726               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16727               GO TO 3785-CHECK-NH.
 16728*              GO TO 3999-END-EDIT.
 16729
 16730 3780-UPDATE-CONT-1.
 16731     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16732
 16733     IF PB-CI-AH-BENEFIT-CD = ZERO
 16734         GO TO 3780-UPDATE-CONT-2.
 16735
 16736     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16737         GO TO 3780-UPDATE-CONT-2.
 16738
 16739     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16740
 16741     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16742       AND
 16743        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16744       AND
 16745        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16746       AND
 16747        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16748            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 303
* EL050.cbl
 16749       ELSE
 16750        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16751          AND
 16752***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16753***       AND
 16754           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16755           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16756            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16757               MOVE ER-2773      TO WS-ERROR
 16758               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16759               GO TO 3999-END-EDIT
 16760            ELSE
 16761               GO TO 3999-END-EDIT
 16762            END-IF
 16763           ELSE
 16764             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16765                MOVE ER-2890 TO WS-ERROR
 16766                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16767                GO TO 3999-END-EDIT
 16768             ELSE
 16769                GO TO 3785-CHECK-NH
 16770             END-IF
 16771           END-IF
 16772          ELSE
 16773            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16774              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16775                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16776                   MOVE ER-2890 TO WS-ERROR
 16777                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16778                   GO TO 3999-END-EDIT
 16779                ELSE
 16780                   MOVE ER-2765 TO WS-ERROR
 16781                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16782                   GO TO 3785-CHECK-NH
 16783                END-IF
 16784              ELSE
 16785               MOVE ER-2765      TO WS-ERROR
 16786               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16787               GO TO 3785-CHECK-NH.
 16788*              GO TO 3999-END-EDIT.
 16789
 16790 3780-UPDATE-CONT-2.
 16791
 16792     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16793        AND WS-LF-BENEFIT-CD = ZERO
 16794           MOVE ER-2743           TO WS-ERROR
 16795           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16796
 16797     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16798        AND WS-AH-BENEFIT-CD = ZERO
 16799           MOVE ER-2744           TO WS-ERROR
 16800           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16801
 16802     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16803        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16804        AND
 16805        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16806         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 304
* EL050.cbl
 16807           MOVE ER-2746           TO WS-ERROR
 16808           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16809
 16810     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16811       AND
 16812        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16813             MOVE ER-2737        TO WS-ERROR
 16814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16815
 16816     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16817       AND
 16818        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16819             MOVE ER-2737        TO WS-ERROR
 16820             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16821
 16822     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16823         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16824             OR 'CID' OR 'DCC' OR 'AHL'
 16825             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16826         ELSE
 16827             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16828                 MOVE ER-2768    TO WS-ERROR
 16829                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16830             ELSE
 16831                 MOVE ER-2756    TO WS-ERROR
 16832                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16833
 16834     IF CERT-PEND-ISSUE-RETURNED
 16835        MOVE ER-2772             TO WS-ERROR
 16836        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16837 3785-CHECK-NH.
 16838     IF PB-STATE NOT = 'NH'
 16839        GO TO 3999-END-EDIT
 16840     END-IF
 16841
 16842     MOVE ER-2796                TO WS-ERROR
 16843     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16844     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16845        OR (CM-NH-INTERFACE-SW = 'Y')
 16846        MOVE ER-2793             TO WS-ERROR
 16847        PERFORM 9900-ERROR-FORMAT
 16848                                 THRU 9900-EXIT
 16849     END-IF
 16850     MOVE +0                     TO WS-PAYMENT-AMT
 16851     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16852        GO TO 3999-END-EDIT
 16853     END-IF
 16854     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16855        GO TO 3999-END-EDIT
 16856     END-IF
 16857     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16858     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16859     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16860        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16861     END-IF
 16862     MOVE '1'                    TO DC-OPTION-CODE
 16863     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16864     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 305
* EL050.cbl
 16865        IF DC-ELAPSED-DAYS < +16
 16866           GO TO 3999-END-EDIT
 16867        END-IF
 16868     END-IF
 16869     MOVE +0                     TO DC-ELAPSED-DAYS
 16870     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16871     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16872     MOVE '1'                    TO DC-OPTION-CODE
 16873     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16874     IF NO-CONVERSION-ERROR
 16875        IF DC-ELAPSED-DAYS > +30
 16876           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16877        ELSE
 16878           GO TO 3999-END-EDIT
 16879        END-IF
 16880     ELSE
 16881        GO TO 3999-END-EDIT
 16882     END-IF
 16883     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16884        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16885           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16886     IF WS-PAYMENT-AMT < 600.00
 16887        GO TO 3999-END-EDIT
 16888     END-IF
 16889     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16890
 16891     IF (ERMAIL-FOUND = ' ')
 16892         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16893         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16894        GO TO 3999-END-EDIT
 16895     END-IF
 16896     MOVE ER-2795                TO WS-ERROR
 16897     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16898
 16899     GO TO 3999-END-EDIT.
 16900******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 306
* EL050.cbl
 16902 3990-FILES-NOT-OPEN.
 16903
 16904     MOVE ER-2617                TO WS-ERROR.
 16905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16906     GO TO 9990-RETURN.
 16907
 16908 3999-END-EDIT.
 16909
 16910     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16911
 16912     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16913         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16914         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16915             PERFORM 9250-UNLOCK-RETURN
 16916             GO TO 9990-RETURN
 16917          ELSE
 16918             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16919             GO TO 9990-RETURN.
 16920
 16921     IF PB-CANCELLATION
 16922          GO TO 9990-RETURN.
 16923
 16924     IF CERT-WAS-NOT-FOUND
 16925        MOVE SPACES              TO CERTIFICATE-MASTER.
 16926
 16927     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16928
 16929     IF CERT-WAS-FOUND
 16930         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16931             PERFORM 9250-UNLOCK-RETURN
 16932          ELSE
 16933            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16934      ELSE
 16935         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16936
 16937     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16938        IF PB-COMPANY-ID = 'DCC' AND
 16939           (PB-CARRIER = '2' OR '4' OR '6')
 16940              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16941        END-IF
 16942     END-IF.
 16943
 16944     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16945         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16946     END-IF.
 16947
 16948     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16949     IF ((PB-COMPANY-ID = 'DCC')
 16950        AND (WS-NO-SECURE-PAY))
 16951                  OR
 16952        (WS-LF-SPECIAL-CALC-CD = 'O'
 16953        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16954        SET SKIP-ADDR-EDIT       TO TRUE
 16955     END-IF
 16956     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16957        AND (NOT SKIP-ADDR-EDIT)
 16958        MOVE ER-2963             TO WS-ERROR
 16959        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 307
* EL050.cbl
 16960                                 THRU 9900-EXIT
 16961        GO TO 9990-RETURN
 16962     END-IF
 16963     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16964     IF ERPNDM-FOUND NOT = 'X'
 16965        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16966           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16967           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16968           AND (NOT SKIP-ADDR-EDIT)
 16969           MOVE ER-2694          TO WS-ERROR
 16970           PERFORM 9900-ERROR-FORMAT
 16971                                 THRU 9900-EXIT
 16972        END-IF
 16973        MOVE ' '                 TO STATE-RECORD-ERROR
 16974        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16975        MOVE PM-STATE            TO CNTL-ACCESS
 16976        MOVE '3'                 TO CNTL-REC-TYPE
 16977        MOVE +0                  TO CNTL-SEQ-NO
 16978        MOVE '0'                 TO RC-SW-2
 16979        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16980        IF (NO-STATE-RECORD)
 16981           OR (CF-RECORD-TYPE NOT = '3')
 16982           OR (PM-STATE NOT = CF-STATE-CODE)
 16983           IF (PM-STATE = SPACES)
 16984              AND (SKIP-ADDR-EDIT)
 16985              CONTINUE
 16986           ELSE
 16987              MOVE ER-2963       TO WS-ERROR
 16988              PERFORM 9900-ERROR-FORMAT
 16989                                 THRU 9900-EXIT
 16990           END-IF
 16991        END-IF
 16992        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16993           MOVE ER-2883          TO WS-ERROR
 16994           PERFORM 9900-ERROR-FORMAT
 16995                                 THRU 9900-EXIT
 16996        END-IF
 16997        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16998           MOVE ' '                 TO STATE-RECORD-ERROR
 16999           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17000           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17001           MOVE '3'                 TO CNTL-REC-TYPE
 17002           MOVE +0                  TO CNTL-SEQ-NO
 17003           MOVE '0'                 TO RC-SW-2
 17004           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17005           IF NO-STATE-RECORD
 17006              OR (CF-RECORD-TYPE NOT = '3')
 17007              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17008              MOVE ER-2964          TO WS-ERROR
 17009              PERFORM 9900-ERROR-FORMAT
 17010                                    THRU 9900-EXIT
 17011           END-IF
 17012        END-IF
 17013     ELSE
 17014        IF NOT SKIP-ADDR-EDIT
 17015           MOVE ER-2393          TO WS-ERROR
 17016           PERFORM 9900-ERROR-FORMAT
 17017                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 308
* EL050.cbl
 17018        END-IF
 17019     END-IF
 17020
 17021     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17022
 17023     IF (ERMAIL-FOUND = ' ' AND
 17024        ERPNDM-FOUND = ' ')
 17025        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17026           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17027           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17028          OR
 17029           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17030          OR
 17031           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17032           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17033           GO TO 3999-UNLOCK-ERMAIL.
 17034
 17035     IF ERPNDM-FOUND = 'X'
 17036        GO TO 3999-UNLOCK-ERMAIL.
 17037
 17038     IF PM-INSURED-LAST-NAME      = SPACES
 17039        AND PM-INSURED-FIRST-NAME = SPACES
 17040        AND PM-ADDRESS-LINE-1     = SPACES
 17041        AND PM-ADDRESS-LINE-2     = SPACES
 17042        AND PM-CITY-STATE         = SPACES
 17043        AND PM-CRED-BENE-NAME     = SPACES
 17044        AND PM-CRED-BENE-ADDR     = SPACES
 17045        AND PM-CRED-BENE-CTYST    = SPACES
 17046        GO TO 3999-UNLOCK-ERMAIL
 17047     END-IF
 17048
 17049     MOVE SPACES                 TO MAILING-DATA.
 17050
 17051     MOVE 'MA'                   TO MA-RECORD-ID.
 17052     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17053     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17054     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17055     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17056     MOVE PB-SV-STATE            TO MA-STATE.
 17057     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17058     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17059
 17060     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17061     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17062
 17063     IF ERMAIL-FOUND = ' '
 17064        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17065     ELSE
 17066        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17067        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17068        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17069
 17070     GO TO 9990-RETURN.
 17071
 17072 3999-UNLOCK-ERMAIL.
 17073     IF ERMAIL-FOUND = ' '
 17074        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17075
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 309
* EL050.cbl
 17076     GO TO 9990-RETURN.
 17077******************************************************************
 17078
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 310
* EL050.cbl
 17080 4000-UPDATE-CANCELLED-CERT.
 17081     IF CERT-WAS-NOT-FOUND
 17082        GO TO 4299-EXIT.
 17083
 17084*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17085     IF PB-C-NH-INT-ON-REFS > ZEROS
 17086        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17087     END-IF
 17088     IF PB-C-REF-INTERFACE-SW = 'Y'
 17089        MOVE PB-C-REF-INTERFACE-SW
 17090                                 TO CM-NH-INTERFACE-SW
 17091     END-IF
 17092     IF PB-C-POST-CARD-IND = 'Y'
 17093        MOVE +8                  TO SUB
 17094        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17095        IF ERMAIL-FOUND = ' '
 17096           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17097              (SUB > +7)
 17098              OR (MA-MAIL-STATUS (SUB) = '1')
 17099           END-PERFORM
 17100        END-IF
 17101        IF (SUB > +7)
 17102           OR (ERMAIL-FOUND = 'X')
 17103           MOVE ER-3789          TO WS-ERROR
 17104           PERFORM 9900-ERROR-FORMAT
 17105                                 THRU 9900-EXIT
 17106        END-IF
 17107     ELSE
 17108        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17109     END-IF
 17110     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17111
 17112     IF PB-CI-OB-FLAG = 'Z'
 17113        GO TO 4150-SUMMARY-CERT-CANCEL.
 17114
 17115     IF PB-C-LF-CANCEL-VOIDED
 17116         PERFORM 4200-REVERSE-LF-CANCEL.
 17117     IF PB-C-AH-CANCEL-VOIDED
 17118         PERFORM 4200-REVERSE-AH-CANCEL.
 17119
 17120 4100-APPLY-LF-CANCEL.
 17121
 17122     MOVE +0                     TO WS-SUB.
 17123
 17124 4100-CHECK-LF-ERRORS.
 17125
 17126     ADD +1                       TO WS-SUB.
 17127
 17128     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17129        IF LF-COVERAGE-CANCELLED
 17130           GO TO 4100-LF-CANCEL-CONT
 17131        ELSE
 17132           GO TO 4100-UPDATE-LF-COVERAGE.
 17133
 17134     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17135                                   ER-2729 OR
 17136                                   ER-2730 OR
 17137                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 311
* EL050.cbl
 17138                                   ER-2732 OR
 17139                                   ER-2737 OR
 17140                                   ER-2740 OR
 17141                                   ER-2743 OR
 17142                                   ER-2749 OR
 17143                                   ER-2750 OR
 17144                                   ER-2755 OR
 17145                                   ER-2757 OR
 17146                                   ER-2760 OR
 17147                                   ER-2772 OR
 17148                                   ER-2774 OR
 17149                                   ER-2776 OR
 17150                                   ER-2794
 17151        GO TO 4100-UPDATE-LF-COVERAGE.
 17152
 17153     GO TO 4100-CHECK-LF-ERRORS.
 17154
 17155 4100-UPDATE-LF-COVERAGE.
 17156
 17157     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17158     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17159     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17160        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17161     END-IF
 17162     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17163                                      TO CM-CREDIT-INTERFACE-SW-2.
 17164     IF CM-LF-CANCEL-DT = LOW-VALUE
 17165         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17166
 17167     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17168         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17169                                         CM-LF-STATUS-AT-CANCEL.
 17170
 17171     GO TO 4100-APPLY-AH-CANCEL.
 17172
 17173 4100-LF-CANCEL-CONT.
 17174     IF PB-C-LF-CANCEL-VOIDED
 17175         GO TO 4100-APPLY-AH-CANCEL.
 17176
 17177     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17178         GO TO 4100-APPLY-AH-CANCEL.
 17179
 17180     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17181        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17182           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17183        ELSE
 17184           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17185
 17186     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17187     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17188
 17189     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17190         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17191
 17192     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17193        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17194         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17195         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 312
* EL050.cbl
 17196
 17197     IF PB-RECORD-RETURNED
 17198        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17199      ELSE
 17200        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17201
 17202 4100-APPLY-AH-CANCEL.
 17203
 17204     MOVE +0                      TO WS-SUB.
 17205
 17206 4100-CHECK-AH-ERRORS.
 17207
 17208     ADD +1                       TO WS-SUB.
 17209
 17210     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17211        IF AH-COVERAGE-CANCELLED
 17212           GO TO 4100-AH-CANCEL-CONT
 17213        ELSE
 17214           GO TO 4100-UPDATE-AH-COVERAGE.
 17215
 17216     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17217                                   ER-2729 OR
 17218                                   ER-2732 OR
 17219                                   ER-2737 OR
 17220                                   ER-2740 OR
 17221                                   ER-2744 OR
 17222                                   ER-2749 OR
 17223                                   ER-2750 OR
 17224                                   ER-2755 OR
 17225                                   ER-2757 OR
 17226                                   ER-2760 OR
 17227                                   ER-2771 OR
 17228                                   ER-2772 OR
 17229                                   ER-2773 OR
 17230                                   ER-2775 OR
 17231                                   ER-2777 OR
 17232                                   ER-2794
 17233        GO TO 4100-UPDATE-AH-COVERAGE.
 17234
 17235     GO TO 4100-CHECK-AH-ERRORS.
 17236
 17237 4100-UPDATE-AH-COVERAGE.
 17238
 17239     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17240     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17241     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17242     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17243                                      TO CM-CREDIT-INTERFACE-SW-2.
 17244     IF CM-AH-CANCEL-DT = LOW-VALUE
 17245         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17246
 17247     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17248         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17249                                         CM-AH-STATUS-AT-CANCEL.
 17250
 17251     IF LF-COVERAGE-CANCELLED
 17252         IF PB-RECORD-RETURNED
 17253              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 313
* EL050.cbl
 17254          ELSE
 17255              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17256
 17257     GO TO 4299-EXIT.
 17258
 17259 4100-AH-CANCEL-CONT.
 17260     IF PB-C-AH-CANCEL-VOIDED
 17261         GO TO 4299-EXIT.
 17262
 17263     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17264         GO TO 4299-EXIT.
 17265
 17266     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17267        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17268           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17269        ELSE
 17270           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17271
 17272     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17273     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17274
 17275     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17276         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17277
 17278     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17279         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17280         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17281
 17282     IF PB-RECORD-RETURNED
 17283        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17284      ELSE
 17285        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17286
 17287     GO TO 4299-EXIT.
 17288
 17289 4150-SUMMARY-CERT-CANCEL.
 17290     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17291
 17292     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17293        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17294                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17295     ELSE
 17296        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17297                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17298
 17299     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17300        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17301                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17302     ELSE
 17303        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17304                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17305
 17306     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17307        NEXT SENTENCE
 17308     ELSE
 17309        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17310
 17311     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 314
* EL050.cbl
 17312
 17313 4200-REVERSE-LF-CANCEL.
 17314     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17315
 17316     IF CM-LF-CANCEL-APPLIED
 17317        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17318        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17319        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17320
 17321     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17322
 17323     IF PB-RECORD-RETURNED
 17324        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17325       ELSE
 17326        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17327
 17328 4200-REVERSE-LF-EXIT.
 17329       EXIT.
 17330
 17331 4200-REVERSE-AH-CANCEL.
 17332     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17333
 17334     IF CM-AH-CANCEL-APPLIED
 17335        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17336        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17337        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17338
 17339     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17340
 17341     IF PB-RECORD-RETURNED
 17342        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17343       ELSE
 17344        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17345
 17346 4200-REVERSE-AH-EXIT.
 17347       EXIT.
 17348
 17349 4299-EXIT.
 17350       EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 315
* EL050.cbl
 17352
 17353 4500-UPDATE-NEW-CERT.
 17354     IF CERT-WAS-FOUND
 17355         NEXT SENTENCE
 17356       ELSE
 17357         GO TO 4520-BUILD-NEW-KEY.
 17358
 17359     IF  CLASIC-CREATED-CERT
 17360         GO TO 4999-EXIT.
 17361
 17362     IF  CERT-WAS-CREATED-FOR-CLAIM
 17363         GO TO 4520-BUILD-NEW-KEY.
 17364
 17365     IF CERT-ADDED-BATCH
 17366        IF CM-RECORD-ID = 'CM'
 17367            GO TO 4999-EXIT.
 17368
 17369 4520-BUILD-NEW-KEY.
 17370* BUILD CONTROL PRIMARY
 17371
 17372     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17373                                       CM-COMPANY-CD-A1
 17374                                       CM-COMPANY-CD-A2
 17375                                       CM-COMPANY-CD-A4
 17376                                       CM-COMPANY-CD-A5.
 17377
 17378     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17379     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17380     MOVE PB-SV-STATE               TO CM-STATE.
 17381     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17382     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17383     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17384     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17385
 17386     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17387
 17388     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17389     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17390     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17391     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17392
 17393     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17394        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17395
 17396     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17397         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17398         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17399         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17400         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17401     ELSE
 17402         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17403
 17404     IF PB-COMPANY-ID   EQUAL  'CRI'
 17405         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17406         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17407         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17408         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17409         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 316
* EL050.cbl
 17410
 17411     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17412        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17413         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17414
 17415     IF PB-COMPANY-ID  = 'LBL'
 17416        IF PB-I-JOINT-COVERAGE
 17417            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17418                                           PB-I-MEMBER-NO
 17419            GO TO 4550-CONT-CERT-PROCESS.
 17420
 17421     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17422        NEXT SENTENCE
 17423     ELSE
 17424        GO TO 4540-BUILD-MEMBER-NO.
 17425
 17426******************************************************************
 17427*                                                                *
 17428*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17429*    FOR 'MON'.                                                  *
 17430*                                                                *
 17431******************************************************************
 17432
 17433     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17434     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17435     MOVE +1                     TO WS-SUB1
 17436                                    WS-SUB2.
 17437
 17438 4530-EDIT-MEMB-NAME.
 17439
 17440     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17441        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17442        ADD +1                       TO WS-SUB2.
 17443
 17444     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17445        ADD +1                       TO WS-SUB1
 17446        GO TO 4530-EDIT-MEMB-NAME.
 17447
 17448     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17449     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17450     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17451*    MOVE SPACE                      TO DC-OPTION-CODE.
 17452     SET  BIN-TO-GREG                TO TRUE.
 17453     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17454     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17455
 17456     GO TO 4550-CONT-CERT-PROCESS.
 17457
 17458******************************************************************
 17459*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17460******************************************************************
 17461
 17462 4540-BUILD-MEMBER-NO.
 17463
 17464     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17465         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17466         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17467         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 317
* EL050.cbl
 17468         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17469     ELSE
 17470         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17471
 17472     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17473        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17474         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17475
 17476 4550-CONT-CERT-PROCESS.
 17477
 17478*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17479*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17480*    ELSE
 17481*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17482
 17483     IF CERT-WAS-CREATED-FOR-CLAIM
 17484        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17485        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17486
 17487     IF CERT-AND-CLAIM-ONLINE
 17488        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17489        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17490
 17491     MOVE 'CM'                     TO CM-RECORD-ID.
 17492     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17493
 17494     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17495        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17496        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17497     ELSE
 17498        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17499        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17500
 17501     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17502     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17503     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17504     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17505     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17506     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17507     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17508                                      CM-LF-ITD-CANCEL-AMT
 17509                                      CM-LF-ITD-DEATH-AMT
 17510                                      CM-AH-ITD-AH-PMT
 17511                                      CM-AH-ITD-LUMP-PMT
 17512                                      CM-AH-ITD-CANCEL-AMT
 17513                                      CM-LF-NSP-PREMIUM-AMT
 17514                                      CM-AH-NSP-PREMIUM-AMT.
 17515*                                     CM-CLAIM-DEDUCT-WITHHELD
 17516*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17517     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17518     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17519     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17520     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17521     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17522     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17523     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17524     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17525     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 318
* EL050.cbl
 17526     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17527     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17528     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17529
 17530     IF PB-I-LIVES NOT NUMERIC
 17531         MOVE ZERO                 TO PB-I-LIVES.
 17532
 17533     IF PB-I-NUM-BILLED NOT NUMERIC
 17534         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17535
 17536     MOVE PB-I-LIVES               TO CM-LIVES.
 17537     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17538
 17539     IF PB-COMPANY-ID EQUAL  'DMD'
 17540         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17541         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17542
 17543     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17544     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17545     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17546     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17547     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17548     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17549
 17550     IF PB-I-LF-POLICY-FEE NUMERIC
 17551        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17552     ELSE
 17553        MOVE +0                    TO CM-LF-POLICY-FEE.
 17554
 17555     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17556        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17557        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17558     ELSE
 17559        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17560
 17561     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17562     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17563     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17564     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17565     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17566     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17567     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17568     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17569     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17570
 17571     IF PB-I-AH-POLICY-FEE NUMERIC
 17572        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17573     ELSE
 17574        MOVE +0                    TO CM-AH-POLICY-FEE.
 17575
 17576     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17577        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17578     ELSE
 17579        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17580
 17581     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17582     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17583
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 319
* EL050.cbl
 17584     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17585                                      CM-LF-DEATH-EXIT-DT
 17586                                      CM-AH-SETTLEMENT-EXIT-DT.
 17587
 17588*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17589*                       'TIH' OR 'OFL' OR 'FLA' OR
 17590*                       'TII' OR 'TMS' OR 'CRI' OR
 17591*                       'NCL'
 17592     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17593
 17594     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17595         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17596            MOVE '2'                TO CM-PREMIUM-TYPE.
 17597
 17598     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17599         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17600            MOVE '2'                TO CM-PREMIUM-TYPE.
 17601
 17602     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17603         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17604     ELSE
 17605         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17606         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17607
 17608     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17609     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17610     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17611     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17612     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17613     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17614     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17615     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17616
 17617     IF PB-NO-MONTHS-SKIPPED
 17618         MOVE SPACE                 TO CM-SKIP-CODE
 17619     ELSE
 17620         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17621
 17622     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17623     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17624                                       CM-LF-STATUS-AT-CANCEL.
 17625
 17626     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17627     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17628                                       CM-AH-STATUS-AT-CANCEL.
 17629
 17630     MOVE '1'                       TO CM-ENTRY-STATUS.
 17631
 17632     IF PB-REISSUED-CERT
 17633        MOVE '5'                    TO CM-ENTRY-STATUS.
 17634
 17635     IF PB-MONTHLY-CERT
 17636        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17637
 17638     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17639     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17640     IF PB-POLICY-IS-DECLINED
 17641        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 320
* EL050.cbl
 17642
 17643     IF PB-POLICY-IS-VOIDED
 17644        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17645
 17646     IF PB-NEEDS-UNDERWRITING
 17647        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17648
 17649     IF PB-REIN-ONLY-CERT
 17650        MOVE '9'                    TO CM-ENTRY-STATUS.
 17651
 17652     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17653         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17654     ELSE
 17655         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17656
 17657     IF PB-RECORD-RETURNED
 17658        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17659      ELSE
 17660        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17661
 17662     IF PB-I-MAIL-ADDRS-PRESENT
 17663        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17664
 17665     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17666                                       CM-ENTRY-DT.
 17667
 17668 4999-EXIT.
 17669     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 321
* EL050.cbl
 17671
 17672 5000-PROCESS-REPS.
 17673     MOVE ' '                    TO AGTC-MASTER-SW
 17674     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17675     MOVE CO-TYPE                TO AGTC-TYPE
 17676     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17677     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17678     IF (AGTC-MASTER-SW NOT = 'N')
 17679        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17680        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17681        PERFORM 8583-READ-ERAGTC-NEXT
 17682                                 THRU 8583-EXIT
 17683     END-IF
 17684     IF AGTC-MASTER-SW = 'N'
 17685        CONTINUE
 17686     ELSE
 17687        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17688           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17689              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17690              MOVE 'Y'           TO AGTC-MASTER-SW
 17691           END-IF
 17692        END-IF
 17693     END-IF
 17694     .
 17695 5000-EXIT.
 17696     EXIT.
 17697 6370-EDIT-INPUT-LF-CODE.
 17698     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17699        MOVE +1                  TO SUB
 17700        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17701        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17702        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17703        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17704        GO TO 6370-SEARCH-LOOP.
 17705
 17706     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17707
 17708     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17709     MOVE SPACES                 TO CNTL-ACCESS.
 17710*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17711     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17712     MOVE +0                     TO CNTL-SEQ-NO.
 17713     MOVE '4' TO RC-SW-2.
 17714     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17715
 17716     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17717        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17718        GO TO 6370-NO-LF-FOUND.
 17719
 17720     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17721     MOVE +1                     TO SUB.
 17722
 17723 6370-SEARCH-LOOP.
 17724     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17725         GO TO 6370-NO-LF-FOUND.
 17726
 17727     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17728         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 322
* EL050.cbl
 17729         GO TO 6370-HER-NET-PAY-CHECK.
 17730
 17731     ADD 1   TO SUB.
 17732*    IF SUB GREATER 120
 17733     IF SUB GREATER 200
 17734         GO TO 6370-NO-LF-FOUND.
 17735
 17736     GO TO 6370-SEARCH-LOOP.
 17737
 17738 6370-NO-LF-FOUND.
 17739
 17740     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17741
 17742 6370-HER-NET-PAY-CHECK.
 17743
 17744     IF PB-COMPANY-ID = 'CID'
 17745        IF PB-SV-STATE = 'CA' OR 'MN'
 17746           IF PB-I-LF-BENEFIT-CD = '02'
 17747              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17748           ELSE
 17749              IF PB-I-LF-BENEFIT-CD = '04'
 17750                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17751              END-IF
 17752           END-IF
 17753        END-IF
 17754     END-IF
 17755
 17756     IF PB-COMPANY-ID NOT = 'HER'
 17757         GO TO 6370-EXIT.
 17758
 17759     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17760         GO TO 6370-EXIT.
 17761
 17762     IF PB-I-LF-TERM NOT NUMERIC
 17763         MOVE ZEROS              TO PB-I-LF-TERM.
 17764
 17765     IF PB-I-LOAN-TERM NOT NUMERIC
 17766         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17767
 17768     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17769         GO TO 6370-EXIT.
 17770
 17771     IF PB-I-LF-BENEFIT-CD = '33'
 17772         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17773
 17774     IF PB-I-LF-BENEFIT-CD = '34'
 17775         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17776
 17777 6370-EXIT.
 17778     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 323
* EL050.cbl
 17780
 17781 6380-EDIT-INPUT-AH-CODE.
 17782     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17783        MOVE +1                  TO SUB
 17784        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17785        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17786        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17787        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17788        GO TO 6380-SEARCH-LOOP.
 17789
 17790     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17791
 17792     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17793     MOVE SPACES                 TO CNTL-ACCESS.
 17794     MOVE 'A'                    TO CNTL-REC-TYPE.
 17795*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17796     MOVE +0                     TO CNTL-SEQ-NO.
 17797     MOVE '5' TO RC-SW-2.
 17798     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17799
 17800     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17801        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17802        GO TO 6380-NO-AH-FOUND.
 17803
 17804     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17805     MOVE +1 TO SUB.
 17806
 17807 6380-SEARCH-LOOP.
 17808     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17809         GO TO 6380-NO-AH-FOUND.
 17810
 17811     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17812         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17813         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17814
 17815     ADD 1   TO SUB.
 17816     IF SUB GREATER THAN 96
 17817*    IF SUB GREATER THAN 300
 17818         GO TO 6380-NO-AH-FOUND.
 17819
 17820     GO TO 6380-SEARCH-LOOP.
 17821
 17822 6380-NO-AH-FOUND.
 17823
 17824     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17825
 17826     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17827         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17828     ELSE
 17829         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17830
 17831 6380-CSO-AH-ONLY-CHECKS.
 17832
 17833     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17834        NEXT SENTENCE
 17835      ELSE
 17836        GO TO 6380-EXIT.
 17837
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 324
* EL050.cbl
 17838     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17839         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17840
 17841
 17842     GO TO 6380-EXIT
 17843     .
 17844 6380-CSO-LIFE-WITH-AH-CHECKS.
 17845
 17846
 17847     .
 17848 6380-EXIT.
 17849     EXIT.
 17850
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 325
* EL050.cbl
 17852
 17853 6400-COMPUTE-EXTENSION-DAYS.
 17854
 17855******************************************************************
 17856*                                                                *
 17857*                   COMPUTE EXTENSION DAYS                       *
 17858*                                                                *
 17859*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17860*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17861*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17862*    THE EXTENSION DAYS.                                         *
 17863*                                                                *
 17864******************************************************************
 17865
 17866     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17867     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17868
 17869******************************************************************
 17870*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17871*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17872******************************************************************
 17873
 17874     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17875        COMPUTE WS-ODD-DAYS-OVER =
 17876               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17877     ELSE
 17878        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17879
 17880     IF WS-ODD-DAYS-OVER = ZEROS
 17881           GO TO 6499-EXIT
 17882     ELSE
 17883        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17884           IF WS-WDF-MONTH = 02
 17885              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17886              ADD 2       TO  WS-ODD-DAYS-OVER
 17887              GO TO 6499-EXIT
 17888           ELSE
 17889              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17890                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17891                 GO TO 6499-EXIT
 17892               ELSE
 17893                 GO TO 6499-EXIT
 17894        ELSE
 17895           GO TO 6499-EXIT.
 17896
 17897 6412-CHECK-TO-DAY.
 17898
 17899        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17900           IF WS-WDT-DAY = 28
 17901              ADD 2              TO WS-ODD-DAYS-OVER
 17902           ELSE
 17903              IF WS-WDT-DAY = 29
 17904                 ADD 1           TO WS-ODD-DAYS-OVER
 17905              ELSE
 17906                 NEXT SENTENCE
 17907        ELSE
 17908           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17909              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 326
* EL050.cbl
 17910
 17911     GO TO 6499-EXIT.
 17912
 17913
 17914 6415-CHECK-LEAP-YEAR.
 17915
 17916     IF DC-DAYS-IN-MONTH = 29
 17917        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17918
 17919 6415-EXIT.
 17920     EXIT.
 17921
 17922 6499-EXIT.
 17923      EXIT.
 17924
 17925 6500-END.
 17926     EXIT.
 17927
 17928
 17929******************************************************************
 17930************* PROCEDURE DIVISION FOR EL050 ***********************
 17931********************** ELC50PD END *******************************
 17932
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 327
* EL050.cbl
 17934
 17935**START***********************************************************
 17936*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17937*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17938******************************************************************
 17939*
 17940 6600-GET-STATE-MUNICIPAL-TAX.
 17941
 17942     IF PB-COMPANY-ID NOT = 'DMD'
 17943         GO TO 6640-EXIT.
 17944
 17945     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17946     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17947     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17948*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17949*
 17950***  Y2K PROJ 7744
 17951     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17952     SET BIN-TO-GREG          TO TRUE.
 17953     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17954
 17955     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17956
 17957     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17958     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17959
 17960
 17961* EXEC CICS HANDLE CONDITION
 17962*        INVREQ    (6610-START-BROWSE)
 17963*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17964*        NOTFND    (6630-END-OF-FILE)
 17965*    END-EXEC.
 17966*    MOVE '"$8JI                 ! # #00017948' TO DFHEIV0
 17967     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17969     MOVE X'2320233030303137393438' TO DFHEIV0(25:11)
 17970     CALL 'kxdfhei1' USING DFHEIV0
 17971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17972
 17973
 17974 6610-START-BROWSE.
 17975
 17976
 17977* EXEC CICS HANDLE CONDITION
 17978*        NOTFND    (6630-END-OF-FILE)
 17979*        DISABLED  (6630-ERRESS-PROBLEM)
 17980*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17981*        ENDFILE   (6630-END-OF-FILE)
 17982*    END-EXEC.
 17983*    MOVE '"$IcJ''                ! $ #00017956' TO DFHEIV0
 17984     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17985     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17986     MOVE X'2420233030303137393536' TO DFHEIV0(25:11)
 17987     CALL 'kxdfhei1' USING DFHEIV0
 17988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17989
 17990
 17991
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 328
* EL050.cbl
 17992* EXEC CICS STARTBR
 17993*        DATASET (FILE-ID-ERRESS)
 17994*        RIDFLD  (WS-ERRESS-KEY)
 17995*        GTEQ
 17996*    END-EXEC.
 17997     MOVE 0
 17998       TO DFHEIV11
 17999*    MOVE '&,         G          &   #00017963' TO DFHEIV0
 18000     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18001     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18002     MOVE X'2020233030303137393633' TO DFHEIV0(25:11)
 18003     CALL 'kxdfhei1' USING DFHEIV0,
 18004           FILE-ID-ERRESS,
 18005           WS-ERRESS-KEY,
 18006           DFHEIV99,
 18007           DFHEIV11,
 18008           DFHEIV99
 18009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18010
 18011
 18012 6620-READ-NEXT-ERRESS-MASTER.
 18013
 18014
 18015* EXEC CICS HANDLE CONDITION
 18016*        NOTFND    (6630-END-OF-FILE)
 18017*        ENDFILE   (6630-END-OF-FILE)
 18018*        DISABLED  (6630-ERRESS-PROBLEM)
 18019*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18020*    END-EXEC.
 18021*    MOVE '"$I''cJ                ! % #00017971' TO DFHEIV0
 18022     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18024     MOVE X'2520233030303137393731' TO DFHEIV0(25:11)
 18025     CALL 'kxdfhei1' USING DFHEIV0
 18026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18027
 18028
 18029
 18030* EXEC CICS READNEXT
 18031*        DATASET (FILE-ID-ERRESS)
 18032*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18033*        RIDFLD  (WS-ERRESS-KEY)
 18034*    END-EXEC.
 18035     MOVE LENGTH OF
 18036      RESIDENT-STATE-TAX-MASTER
 18037       TO DFHEIV12
 18038     MOVE 0
 18039       TO DFHEIV11
 18040*    MOVE '&.IL                  )   #00017978' TO DFHEIV0
 18041     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18042     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18043     MOVE X'2020233030303137393738' TO DFHEIV0(25:11)
 18044     CALL 'kxdfhei1' USING DFHEIV0,
 18045           FILE-ID-ERRESS,
 18046           RESIDENT-STATE-TAX-MASTER,
 18047           DFHEIV12,
 18048           WS-ERRESS-KEY,
 18049           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 329
* EL050.cbl
 18050           DFHEIV11,
 18051           DFHEIV99,
 18052           DFHEIV99
 18053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18054
 18055
 18056     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18057
 18058* EXEC CICS ENDBR
 18059*            DATASET (FILE-ID-ERRESS)
 18060*       END-EXEC
 18061     MOVE 0
 18062       TO DFHEIV11
 18063*    MOVE '&2                    $   #00017985' TO DFHEIV0
 18064     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18065     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18066     MOVE X'2020233030303137393835' TO DFHEIV0(25:11)
 18067     CALL 'kxdfhei1' USING DFHEIV0,
 18068           FILE-ID-ERRESS,
 18069           DFHEIV11,
 18070           DFHEIV99
 18071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18072        GO TO 6630-END-OF-FILE.
 18073
 18074     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18075        NEXT SENTENCE
 18076      ELSE
 18077        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18078
 18079*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18080*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18081*
 18082     MOVE +2                     TO WS-SUB1.
 18083
 18084     IF PB-ISSUE
 18085     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18086        MOVE +1                  TO WS-SUB1.
 18087
 18088     IF PB-CANCELLATION
 18089     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18090        MOVE +1                  TO WS-SUB1.
 18091*
 18092*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18093*
 18094***  Y2K PROJ 7744
 18095     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18096***  Y2K PROJ 7744
 18097
 18098*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18099* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18100* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18101
 18102     ADD 1                    TO WS-YEAR-YY.
 18103
 18104     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18105         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18106                              TO WS-RES-STATE-TAX
 18107         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 330
* EL050.cbl
 18108                              TO WS-RES-MUNI-TAX
 18109     ELSE
 18110         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18111                              TO WS-RES-STATE-TAX
 18112         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18113                              TO WS-RES-MUNI-TAX.
 18114
 18115*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18116
 18117     IF PB-CANCELLATION
 18118         GO TO 6640-CANCEL-TAX.
 18119
 18120     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18121         COMPUTE PB-I-STATE-TAX ROUNDED =
 18122                                   PB-I-LF-PREMIUM-AMT
 18123                                 * WS-RES-STATE-TAX
 18124         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18125                                   PB-I-LF-PREMIUM-AMT
 18126                                 * WS-RES-MUNI-TAX
 18127     ELSE
 18128     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18129         COMPUTE PB-I-STATE-TAX ROUNDED =
 18130                                   PB-I-AH-PREMIUM-AMT
 18131                                 * WS-RES-STATE-TAX
 18132         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18133                                   PB-I-AH-PREMIUM-AMT
 18134                                 * WS-RES-MUNI-TAX.
 18135
 18136
 18137* EXEC CICS ENDBR
 18138*         DATASET (FILE-ID-ERRESS)
 18139*    END-EXEC.
 18140     MOVE 0
 18141       TO DFHEIV11
 18142*    MOVE '&2                    $   #00018052' TO DFHEIV0
 18143     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18144     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18145     MOVE X'2020233030303138303532' TO DFHEIV0(25:11)
 18146     CALL 'kxdfhei1' USING DFHEIV0,
 18147           FILE-ID-ERRESS,
 18148           DFHEIV11,
 18149           DFHEIV99
 18150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18151
 18152
 18153     GO TO 6640-EXIT.
 18154
 18155 6640-CANCEL-TAX.
 18156     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18157
 18158     IF PB-C-LF-CANCEL-AMT > ZEROS
 18159         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18160                                   PB-C-LF-CANCEL-AMT
 18161                                 * WS-RES-STATE-TAX
 18162         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18163                                   PB-C-LF-CANCEL-AMT
 18164                                *  WS-RES-MUNI-TAX
 18165     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 331
* EL050.cbl
 18166     IF PB-C-AH-CANCEL-AMT > ZEROS
 18167         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18168                                   PB-C-AH-CANCEL-AMT
 18169                                 * WS-RES-STATE-TAX
 18170         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18171                                   PB-C-AH-CANCEL-AMT
 18172                                *  WS-RES-MUNI-TAX.
 18173
 18174
 18175* EXEC CICS ENDBR
 18176*         DATASET (FILE-ID-ERRESS)
 18177*    END-EXEC.
 18178     MOVE 0
 18179       TO DFHEIV11
 18180*    MOVE '&2                    $   #00018077' TO DFHEIV0
 18181     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18182     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18183     MOVE X'2020233030303138303737' TO DFHEIV0(25:11)
 18184     CALL 'kxdfhei1' USING DFHEIV0,
 18185           FILE-ID-ERRESS,
 18186           DFHEIV11,
 18187           DFHEIV99
 18188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18189
 18190
 18191     GO TO 6640-EXIT.
 18192
 18193 6630-END-OF-FILE.
 18194     MOVE ER-8002              TO WS-ERROR.
 18195     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18196
 18197     GO TO 6640-EXIT.
 18198
 18199 6630-ERRESS-PROBLEM.
 18200     MOVE ER-8044              TO WS-ERROR.
 18201     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18202
 18203 6640-EXIT.
 18204     EXIT.
 18205
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 332
* EL050.cbl
 18207 6650-GET-RES-STATE-COMM.
 18208
 18209     IF PB-COMPANY-ID NOT = 'DMD'
 18210         GO TO 6700-COMM-EXIT.
 18211
 18212     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18213     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18214     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18215     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18216     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18217     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18218     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18219
 18220*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18221*
 18222***  Y2K PROJ 7744
 18223     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18224     SET BIN-TO-GREG          TO TRUE.
 18225     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18226
 18227     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18228***  Y2K PROJ 7744
 18229
 18230     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18231
 18232
 18233* EXEC CICS HANDLE CONDITION
 18234*        INVREQ    (6660-START-BROWSE)
 18235*        DISABLED  (6690-ERRESC-PROBLEM)
 18236*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18237*        NOTFND    (6690-END-OF-FILE)
 18238*    END-EXEC.
 18239*    MOVE '"$8cJI                ! & #00018122' TO DFHEIV0
 18240     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18242     MOVE X'2620233030303138313232' TO DFHEIV0(25:11)
 18243     CALL 'kxdfhei1' USING DFHEIV0
 18244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18245
 18246
 18247
 18248* EXEC CICS RESETBR
 18249*        DATASET (FILE-ID-ERRESC)
 18250*        RIDFLD  (WS-ERRESC-KEY)
 18251*    END-EXEC.
 18252     MOVE 0
 18253       TO DFHEIV11
 18254*    MOVE '&4         G          &   #00018129' TO DFHEIV0
 18255     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18256     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18257     MOVE X'2020233030303138313239' TO DFHEIV0(25:11)
 18258     CALL 'kxdfhei1' USING DFHEIV0,
 18259           FILE-ID-ERRESC,
 18260           WS-ERRESC-KEY,
 18261           DFHEIV99,
 18262           DFHEIV11,
 18263           DFHEIV99
 18264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 333
* EL050.cbl
 18265
 18266
 18267 6660-START-BROWSE.
 18268
 18269
 18270* EXEC CICS HANDLE CONDITION
 18271*        NOTFND    (6690-END-OF-FILE)
 18272*        DISABLED  (6690-ERRESC-PROBLEM)
 18273*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18274*        ENDFILE   (6690-END-OF-FILE)
 18275*    END-EXEC.
 18276*    MOVE '"$IcJ''                ! '' #00018136' TO DFHEIV0
 18277     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18279     MOVE X'2720233030303138313336' TO DFHEIV0(25:11)
 18280     CALL 'kxdfhei1' USING DFHEIV0
 18281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18282
 18283
 18284
 18285* EXEC CICS STARTBR
 18286*        DATASET (FILE-ID-ERRESC)
 18287*        RIDFLD  (WS-ERRESC-KEY)
 18288*        GTEQ
 18289*    END-EXEC.
 18290     MOVE 0
 18291       TO DFHEIV11
 18292*    MOVE '&,         G          &   #00018143' TO DFHEIV0
 18293     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18295     MOVE X'2020233030303138313433' TO DFHEIV0(25:11)
 18296     CALL 'kxdfhei1' USING DFHEIV0,
 18297           FILE-ID-ERRESC,
 18298           WS-ERRESC-KEY,
 18299           DFHEIV99,
 18300           DFHEIV11,
 18301           DFHEIV99
 18302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18303
 18304
 18305     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18306
 18307 6670-READ-NEXT-ERRESC-MASTER.
 18308
 18309
 18310* EXEC CICS HANDLE CONDITION
 18311*        NOTFND    (6690-END-OF-FILE)
 18312*        DISABLED  (6690-ERRESC-PROBLEM)
 18313*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18314*        ENDFILE   (6690-END-OF-FILE)
 18315*    END-EXEC.
 18316*    MOVE '"$IcJ''                ! ( #00018153' TO DFHEIV0
 18317     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18319     MOVE X'2820233030303138313533' TO DFHEIV0(25:11)
 18320     CALL 'kxdfhei1' USING DFHEIV0
 18321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18322
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 334
* EL050.cbl
 18323
 18324
 18325* EXEC CICS READNEXT
 18326*        DATASET (FILE-ID-ERRESC)
 18327*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18328*        RIDFLD  (ERRESC-RECORD-KEY)
 18329*    END-EXEC.
 18330     MOVE LENGTH OF
 18331      ACCOUNT-RESIDENT-ST-COMMISSION
 18332       TO DFHEIV12
 18333     MOVE 0
 18334       TO DFHEIV11
 18335*    MOVE '&.IL                  )   #00018160' TO DFHEIV0
 18336     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18337     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18338     MOVE X'2020233030303138313630' TO DFHEIV0(25:11)
 18339     CALL 'kxdfhei1' USING DFHEIV0,
 18340           FILE-ID-ERRESC,
 18341           ACCOUNT-RESIDENT-ST-COMMISSION,
 18342           DFHEIV12,
 18343           ERRESC-RECORD-KEY,
 18344           DFHEIV99,
 18345           DFHEIV11,
 18346           DFHEIV99,
 18347           DFHEIV99
 18348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18349
 18350
 18351     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18352        NEXT SENTENCE
 18353     ELSE
 18354
 18355* EXEC CICS ENDBR
 18356*            DATASET (FILE-ID-ERRESC)
 18357*       END-EXEC
 18358     MOVE 0
 18359       TO DFHEIV11
 18360*    MOVE '&2                    $   #00018169' TO DFHEIV0
 18361     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18363     MOVE X'2020233030303138313639' TO DFHEIV0(25:11)
 18364     CALL 'kxdfhei1' USING DFHEIV0,
 18365           FILE-ID-ERRESC,
 18366           DFHEIV11,
 18367           DFHEIV99
 18368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18369        GO TO 6690-END-OF-FILE.
 18370
 18371     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18372
 18373* EXEC CICS ENDBR
 18374*            DATASET (FILE-ID-ERRESC)
 18375*       END-EXEC
 18376     MOVE 0
 18377       TO DFHEIV11
 18378*    MOVE '&2                    $   #00018175' TO DFHEIV0
 18379     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18380     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 335
* EL050.cbl
 18381     MOVE X'2020233030303138313735' TO DFHEIV0(25:11)
 18382     CALL 'kxdfhei1' USING DFHEIV0,
 18383           FILE-ID-ERRESC,
 18384           DFHEIV11,
 18385           DFHEIV99
 18386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18387        GO TO 6690-END-OF-FILE.
 18388
 18389     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18390        NEXT SENTENCE
 18391      ELSE
 18392        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18393
 18394* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18395*
 18396     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18397
 18398     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18399
 18400     IF WS-SUB1 > ZERO
 18401         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18402             PERFORM 6680-SET-COMMISSION
 18403         ELSE
 18404             PERFORM 6680-SET-TABLE-CODE.
 18405
 18406
 18407* EXEC CICS ENDBR
 18408*         DATASET (FILE-ID-ERRESC)
 18409*    END-EXEC.
 18410     MOVE 0
 18411       TO DFHEIV11
 18412*    MOVE '&2                    $   #00018197' TO DFHEIV0
 18413     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18414     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18415     MOVE X'2020233030303138313937' TO DFHEIV0(25:11)
 18416     CALL 'kxdfhei1' USING DFHEIV0,
 18417           FILE-ID-ERRESC,
 18418           DFHEIV11,
 18419           DFHEIV99
 18420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18421
 18422
 18423     GO TO 6700-COMM-EXIT.
 18424
 18425 6680-SET-TABLE-CODE.
 18426     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18427        MOVE ZEROS             TO WS-SUB1
 18428     ELSE
 18429* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18430* TO COMPUTE AH COMMISSION.
 18431        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18432        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18433        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18434        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18435        PERFORM 6680-READ-CTBL-TABLE
 18436        IF WS-CTBL-READ-SW NOT = 'Y'
 18437           MOVE ZEROS          TO WS-SUB1.
 18438
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 336
* EL050.cbl
 18439 6680-READ-CTBL-TABLE.
 18440*
 18441* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18442* TO COMPUTE LIFE COMMISSION
 18443
 18444     IF CTBL-SW = '0540'
 18445        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18446        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18447        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18448
 18449     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18450
 18451     IF CTBL-TABLE-FOUND
 18452        IF CTBL-SW = '0530'
 18453             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18454                                    * PB-I-AH-TERM
 18455             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18456             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18457        ELSE
 18458             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18459             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18460             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18461     ELSE
 18462        IF FIRST-TIME-THROUGH
 18463            GO TO 6680-READ-CTBL-TABLE
 18464        ELSE
 18465            MOVE ZEROS         TO WS-SUB1.
 18466
 18467 6680-SET-COMMISSION.
 18468     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18469           MOVE ZEROS          TO WS-SUB1
 18470       ELSE
 18471           MOVE RESC-COMMISSION-PER (WS-SUB)
 18472                               TO WS-COMMISSION
 18473           IF CTBL-SW = '0530'
 18474               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18475           ELSE
 18476               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18477
 18478 6680-SEARCH-CATEGORY.
 18479     ADD +1                   TO WS-SUB.
 18480     IF WS-SUB > +12
 18481         GO TO 6680-EXIT.
 18482
 18483     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18484          MOVE WS-SUB         TO WS-SUB1
 18485          GO TO 6680-EXIT.
 18486
 18487     GO TO 6680-SEARCH-CATEGORY.
 18488
 18489 6680-EXIT.
 18490     EXIT.
 18491
 18492 6690-END-OF-FILE.
 18493     GO TO 6700-COMM-EXIT.
 18494
 18495 6690-ERRESC-PROBLEM.
 18496      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 337
* EL050.cbl
 18497      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18498
 18499      GO TO 6700-COMM-EXIT.
 18500
 18501 6700-COMM-EXIT.
 18502     EXIT.
 18503
 18504 7000-GET-RATE.
 18505
 18506* EXEC CICS LINK
 18507*        PROGRAM    ('ELRATE')
 18508*        COMMAREA   (CALCULATION-PASS-AREA)
 18509*        LENGTH     (CP-COMM-LENGTH)
 18510*    END-EXEC.
 18511     MOVE 'ELRATE' TO DFHEIV1
 18512*    MOVE '."C                   (   #00018283' TO DFHEIV0
 18513     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18515     MOVE X'2020233030303138323833' TO DFHEIV0(25:11)
 18516     CALL 'kxdfhei1' USING DFHEIV0,
 18517           DFHEIV1,
 18518           CALCULATION-PASS-AREA,
 18519           CP-COMM-LENGTH,
 18520           DFHEIV99,
 18521           DFHEIV99,
 18522           DFHEIV99,
 18523           DFHEIV99
 18524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18525
 18526
 18527 7000-EXIT.
 18528     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 338
* EL050.cbl
 18530 7100-FIND-BENEFIT-IN-STATE.
 18531     MOVE 'N'                    TO BEN-SEARCH-SW.
 18532
 18533     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18534         VARYING SUB3 FROM 1 BY 1 UNTIL
 18535            ((SUB3 GREATER 50) OR
 18536              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18537               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18538
 18539     IF SUB3 NOT = 51
 18540         MOVE 'Y'                TO BEN-SEARCH-SW.
 18541
 18542     GO TO 7199-EXIT.
 18543
 18544 7100-BENEFIT-DUMMY.
 18545
 18546 7100-DUMMY-EXIT.
 18547     EXIT.
 18548
 18549 7199-EXIT.
 18550     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 339
* EL050.cbl
 18552 7200-FIND-BENEFIT.
 18553     MOVE 'N'                    TO BEN-SEARCH-SW.
 18554
 18555     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18556         VARYING SUB3 FROM 1 BY 1 UNTIL
 18557            ((SUB3 GREATER 8) OR
 18558            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18559
 18560     IF SUB3 NOT = 9
 18561         MOVE 'Y'                TO BEN-SEARCH-SW.
 18562
 18563     GO TO 7200-EXIT.
 18564
 18565 7200-BENEFIT-DUMMY.
 18566
 18567 7200-DUMMY-EXIT.
 18568     EXIT.
 18569
 18570 7200-EXIT.
 18571     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 340
* EL050.cbl
 18573 7250-LOOK-FOR-RESCINDED-CLAIM.
 18574     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18575                                    W-CL-COMP-CD.
 18576     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18577                                    W-CL-CERT-NO.
 18578
 18579
 18580* EXEC CICS HANDLE CONDITION
 18581*        NOTFND  (7250-CONTINUE)
 18582*        ENDFILE (7250-CONTINUE)
 18583*    END-EXEC.
 18584*    MOVE '"$I''                  ! ) #00018341' TO DFHEIV0
 18585     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18587     MOVE X'2920233030303138333431' TO DFHEIV0(25:11)
 18588     CALL 'kxdfhei1' USING DFHEIV0
 18589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18590
 18591
 18592
 18593* EXEC CICS IGNORE CONDITION
 18594*        DUPKEY
 18595*    END-EXEC.
 18596*    MOVE '"*$                   !   #00018346' TO DFHEIV0
 18597     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18599     MOVE X'2020233030303138333436' TO DFHEIV0(25:11)
 18600     CALL 'kxdfhei1' USING DFHEIV0
 18601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18602
 18603
 18604
 18605* EXEC CICS STARTBR
 18606*        DATASET   (CLMS-ID)
 18607*        RIDFLD    (ELMSTR-KEY)
 18608*        GENERIC   EQUAL
 18609*        KEYLENGTH (ELMSTR-LENGTH)
 18610*    END-EXEC.
 18611     MOVE 0
 18612       TO DFHEIV11
 18613*    MOVE '&,   KG    E          &   #00018350' TO DFHEIV0
 18614     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18615     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18616     MOVE X'2020233030303138333530' TO DFHEIV0(25:11)
 18617     CALL 'kxdfhei1' USING DFHEIV0,
 18618           CLMS-ID,
 18619           ELMSTR-KEY,
 18620           ELMSTR-LENGTH,
 18621           DFHEIV11,
 18622           DFHEIV99
 18623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18624
 18625
 18626     MOVE 'Y'                    TO W-BROWSE-SW.
 18627
 18628 7250-NEXT-CLAIM.
 18629
 18630
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 341
* EL050.cbl
 18631* EXEC CICS READNEXT
 18632*        DATASET   (CLMS-ID)
 18633*        RIDFLD    (ELMSTR-KEY)
 18634*        SET       (ADDRESS OF CLAIM-MASTER)
 18635*    END-EXEC.
 18636     MOVE 0
 18637       TO DFHEIV11
 18638*    MOVE '&.S                   )   #00018361' TO DFHEIV0
 18639     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18640     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18641     MOVE X'2020233030303138333631' TO DFHEIV0(25:11)
 18642     CALL 'kxdfhei1' USING DFHEIV0,
 18643           CLMS-ID,
 18644           DFHEIV20,
 18645           DFHEIV99,
 18646           ELMSTR-KEY,
 18647           DFHEIV99,
 18648           DFHEIV11,
 18649           DFHEIV99,
 18650           DFHEIV99
 18651     SET ADDRESS OF CLAIM-MASTER TO
 18652         DFHEIV20
 18653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18654
 18655
 18656     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18657        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18658         GO TO 7250-CONTINUE
 18659     END-IF.
 18660
 18661     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18662        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18663        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18664        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18665        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18666         GO TO 7250-NEXT-CLAIM
 18667     END-IF.
 18668
 18669     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18670        OR (CL-CLAIM-TYPE = 'I')
 18671        OR (CL-CLAIM-TYPE = 'G')
 18672          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18673              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18674              GO TO 7250-CONTINUE
 18675          END-IF
 18676     END-IF.
 18677
 18678     GO TO 7250-NEXT-CLAIM.
 18679
 18680 7250-CONTINUE.
 18681
 18682     IF W-BROWSE-SW = 'Y'
 18683
 18684* EXEC CICS ENDBR
 18685*            DATASET   (CLMS-ID)
 18686*        END-EXEC
 18687     MOVE 0
 18688       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 342
* EL050.cbl
 18689*    MOVE '&2                    $   #00018394' TO DFHEIV0
 18690     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18691     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18692     MOVE X'2020233030303138333934' TO DFHEIV0(25:11)
 18693     CALL 'kxdfhei1' USING DFHEIV0,
 18694           CLMS-ID,
 18695           DFHEIV11,
 18696           DFHEIV99
 18697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18698         MOVE 'N' TO W-BROWSE-SW
 18699     END-IF.
 18700
 18701 7250-EXIT.
 18702     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 343
* EL050.cbl
 18704 7300-CHECK-FOR-OPEN-CLMS.
 18705
 18706*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18707*    MOVE SPACES                 TO CNTL-ACCESS.
 18708*    MOVE '1'                    TO CNTL-REC-TYPE.
 18709*    MOVE +0                     TO CNTL-SEQ-NO.
 18710
 18711*    MOVE '3'                    TO RC-SW-1.
 18712*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18713
 18714*    IF NOT CF-COMPANY-MASTER
 18715*         PERFORM 0099-COMPANY-NOT-FOUND
 18716*         GO TO 7300-EXIT.
 18717
 18718     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18719                                    W-CL-COMP-CD.
 18720     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18721                                    W-CL-CERT-NO.
 18722
 18723
 18724* EXEC CICS HANDLE CONDITION
 18725*        NOTFND  (7300-CONTINUE)
 18726*        ENDFILE (7300-CONTINUE)
 18727*    END-EXEC.
 18728*    MOVE '"$I''                  ! * #00018422' TO DFHEIV0
 18729     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18731     MOVE X'2A20233030303138343232' TO DFHEIV0(25:11)
 18732     CALL 'kxdfhei1' USING DFHEIV0
 18733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18734
 18735
 18736
 18737* EXEC CICS IGNORE CONDITION
 18738*        DUPKEY
 18739*    END-EXEC.
 18740*    MOVE '"*$                   !   #00018427' TO DFHEIV0
 18741     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18742     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18743     MOVE X'2020233030303138343237' TO DFHEIV0(25:11)
 18744     CALL 'kxdfhei1' USING DFHEIV0
 18745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18746
 18747
 18748
 18749* EXEC CICS STARTBR
 18750*        DATASET   (CLMS-ID)
 18751*        RIDFLD    (ELMSTR-KEY)
 18752*        GENERIC   EQUAL
 18753*        KEYLENGTH (ELMSTR-LENGTH)
 18754*    END-EXEC.
 18755     MOVE 0
 18756       TO DFHEIV11
 18757*    MOVE '&,   KG    E          &   #00018431' TO DFHEIV0
 18758     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18759     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18760     MOVE X'2020233030303138343331' TO DFHEIV0(25:11)
 18761     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 344
* EL050.cbl
 18762           CLMS-ID,
 18763           ELMSTR-KEY,
 18764           ELMSTR-LENGTH,
 18765           DFHEIV11,
 18766           DFHEIV99
 18767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18768
 18769
 18770     MOVE 'Y'                    TO W-BROWSE-SW.
 18771
 18772 7300-NEXT-CLAIM.
 18773
 18774
 18775* EXEC CICS READNEXT
 18776*        DATASET   (CLMS-ID)
 18777*        RIDFLD    (ELMSTR-KEY)
 18778*        SET       (ADDRESS OF CLAIM-MASTER)
 18779*    END-EXEC.
 18780     MOVE 0
 18781       TO DFHEIV11
 18782*    MOVE '&.S                   )   #00018442' TO DFHEIV0
 18783     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18784     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18785     MOVE X'2020233030303138343432' TO DFHEIV0(25:11)
 18786     CALL 'kxdfhei1' USING DFHEIV0,
 18787           CLMS-ID,
 18788           DFHEIV20,
 18789           DFHEIV99,
 18790           ELMSTR-KEY,
 18791           DFHEIV99,
 18792           DFHEIV11,
 18793           DFHEIV99,
 18794           DFHEIV99
 18795     SET ADDRESS OF CLAIM-MASTER TO
 18796         DFHEIV20
 18797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18798
 18799
 18800     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18801        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18802         GO TO 7300-CONTINUE.
 18803
 18804     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18805        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18806        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18807        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18808        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18809         GO TO 7300-NEXT-CLAIM.
 18810
 18811*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18812     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18813        OR (CL-CLAIM-TYPE = 'I')
 18814        OR (CL-CLAIM-TYPE = 'G')
 18815        IF CLAIM-IS-OPEN
 18816           EVALUATE TRUE
 18817             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18818                 MOVE ER-2884      TO WS-ERROR
 18819             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 345
* EL050.cbl
 18820                 MOVE ER-2887      TO WS-ERROR
 18821             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18822                 MOVE ER-2886      TO WS-ERROR
 18823             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18824                 MOVE ER-2888      TO WS-ERROR
 18825             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18826                 MOVE ER-2885      TO WS-ERROR
 18827             WHEN OTHER
 18828                 MOVE ER-2768      TO WS-ERROR
 18829           END-EVALUATE
 18830           IF PB-C-AH-CANCEL-VOIDED OR
 18831              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18832                NOT AH-COVERAGE-CANCELLED)
 18833               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18834               MOVE ER-2768      TO WS-ERROR
 18835           END-IF
 18836           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18837           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18838              PB-FORCE-CODE NOT EQUAL '8'
 18839               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18840           END-IF
 18841           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18842           GO TO 7300-CONTINUE
 18843        ELSE
 18844           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18845*****THIS IS A RESCISSION OR REFORMATION
 18846              IF (AH-COVERAGE-CANCELLED AND
 18847                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18848                    MOVE ER-2890 TO WS-ERROR
 18849                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18850                    GO TO 7300-CONTINUE
 18851              END-IF
 18852           ELSE
 18853              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18854               AND PB-C-AH-CANCEL-DT > SPACES
 18855                 MOVE ER-2756        TO WS-ERROR
 18856                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18857                 GO TO 7300-CONTINUE
 18858              END-IF
 18859           END-IF
 18860        END-IF
 18861     ELSE
 18862*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18863        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18864           IF CLAIM-IS-OPEN
 18865              MOVE ER-2889      TO WS-ERROR
 18866              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18867              GO TO 7300-CONTINUE
 18868           ELSE
 18869              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18870*****THIS IS A RESCISSION OR REFORMATION
 18871                 IF (LF-COVERAGE-CANCELLED AND
 18872                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18873                       MOVE ER-2890 TO WS-ERROR
 18874                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18875                       GO TO 7300-CONTINUE
 18876                 END-IF
 18877              ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 346
* EL050.cbl
 18878                 IF (AH-COVERAGE-CANCELLED AND
 18879                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18880                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18881                    (LF-COVERAGE-CANCELLED AND
 18882                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18883                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18884                       MOVE ER-2965 TO WS-ERROR
 18885                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18886                       GO TO 7300-CONTINUE
 18887                 END-IF
 18888                 IF LF-COVERAGE-CANCELLED
 18889                  IF CL-TOTAL-PAID-AMT > 0
 18890                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18891                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18892                        MOVE ER-2891 TO WS-ERROR
 18893                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18894                        GO TO 7300-CONTINUE
 18895                      END-IF
 18896                    ELSE
 18897                      MOVE ER-2892 TO WS-ERROR
 18898                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18899                      GO TO 7300-CONTINUE
 18900                    END-IF
 18901                  END-IF
 18902                 END-IF
 18903              END-IF
 18904           END-IF
 18905        END-IF
 18906     END-IF
 18907
 18908     GO TO 7300-NEXT-CLAIM.
 18909
 18910 7300-CONTINUE.
 18911
 18912     IF W-BROWSE-SW = 'Y'
 18913
 18914* EXEC CICS ENDBR
 18915*            DATASET   (CLMS-ID)
 18916*        END-EXEC.
 18917     MOVE 0
 18918       TO DFHEIV11
 18919*    MOVE '&2                    $   #00018561' TO DFHEIV0
 18920     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18921     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18922     MOVE X'2020233030303138353631' TO DFHEIV0(25:11)
 18923     CALL 'kxdfhei1' USING DFHEIV0,
 18924           CLMS-ID,
 18925           DFHEIV11,
 18926           DFHEIV99
 18927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18928
 18929
 18930 7300-EXIT.
 18931     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 347
* EL050.cbl
 18933
 18934 7400-GET-REMAIN-TERM.
 18935
 18936* EXEC CICS LINK
 18937*        PROGRAM    ('ELRTRM')
 18938*        COMMAREA   (CALCULATION-PASS-AREA)
 18939*        LENGTH     (CP-COMM-LENGTH)
 18940*    END-EXEC.
 18941     MOVE 'ELRTRM' TO DFHEIV1
 18942*    MOVE '."C                   (   #00018570' TO DFHEIV0
 18943     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18944     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18945     MOVE X'2020233030303138353730' TO DFHEIV0(25:11)
 18946     CALL 'kxdfhei1' USING DFHEIV0,
 18947           DFHEIV1,
 18948           CALCULATION-PASS-AREA,
 18949           CP-COMM-LENGTH,
 18950           DFHEIV99,
 18951           DFHEIV99,
 18952           DFHEIV99,
 18953           DFHEIV99
 18954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18955
 18956
 18957 7400-EXIT.
 18958     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 348
* EL050.cbl
 18960
 18961 7500-GET-REMAIN-AMOUNT.
 18962
 18963* EXEC CICS LINK
 18964*        PROGRAM    ('ELRAMT')
 18965*        COMMAREA   (CALCULATION-PASS-AREA)
 18966*        LENGTH     (CP-COMM-LENGTH)
 18967*    END-EXEC.
 18968     MOVE 'ELRAMT' TO DFHEIV1
 18969*    MOVE '."C                   (   #00018581' TO DFHEIV0
 18970     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18971     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18972     MOVE X'2020233030303138353831' TO DFHEIV0(25:11)
 18973     CALL 'kxdfhei1' USING DFHEIV0,
 18974           DFHEIV1,
 18975           CALCULATION-PASS-AREA,
 18976           CP-COMM-LENGTH,
 18977           DFHEIV99,
 18978           DFHEIV99,
 18979           DFHEIV99,
 18980           DFHEIV99
 18981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18982
 18983
 18984 7500-EXIT.
 18985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 349
* EL050.cbl
 18987
 18988 7600-GET-REFUND.
 18989
 18990* EXEC CICS LINK
 18991*        PROGRAM    ('ELRFND')
 18992*        COMMAREA   (CALCULATION-PASS-AREA)
 18993*        LENGTH     (CP-COMM-LENGTH)
 18994*    END-EXEC.
 18995     MOVE 'ELRFND' TO DFHEIV1
 18996*    MOVE '."C                   (   #00018592' TO DFHEIV0
 18997     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18999     MOVE X'2020233030303138353932' TO DFHEIV0(25:11)
 19000     CALL 'kxdfhei1' USING DFHEIV0,
 19001           DFHEIV1,
 19002           CALCULATION-PASS-AREA,
 19003           CP-COMM-LENGTH,
 19004           DFHEIV99,
 19005           DFHEIV99,
 19006           DFHEIV99,
 19007           DFHEIV99
 19008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19009
 19010
 19011 7600-EXIT.
 19012     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 350
* EL050.cbl
 19014 7700-CALL-DL1.
 19015
 19016* EXEC CICS LINK
 19017*        PROGRAM    ('DLO001')
 19018*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19019*        LENGTH     (DLO001-COMM-LENGTH)
 19020*    END-EXEC.
 19021     MOVE 'DLO001' TO DFHEIV1
 19022*    MOVE '."C                   (   #00018602' TO DFHEIV0
 19023     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19024     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19025     MOVE X'2020233030303138363032' TO DFHEIV0(25:11)
 19026     CALL 'kxdfhei1' USING DFHEIV0,
 19027           DFHEIV1,
 19028           WS-DLO-MASTER-POLICY-FORM,
 19029           DLO001-COMM-LENGTH,
 19030           DFHEIV99,
 19031           DFHEIV99,
 19032           DFHEIV99,
 19033           DFHEIV99
 19034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19035
 19036
 19037 7700-EXIT.
 19038     EXIT.
 19039
 19040 7710-CALL-DL2.
 19041
 19042* EXEC CICS LINK
 19043*        PROGRAM    ('DLO002')
 19044*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19045*        LENGTH     (DLO002-COMM-LENGTH)
 19046*    END-EXEC.
 19047     MOVE 'DLO002' TO DFHEIV1
 19048*    MOVE '."C                   (   #00018612' TO DFHEIV0
 19049     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19050     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19051     MOVE X'2020233030303138363132' TO DFHEIV0(25:11)
 19052     CALL 'kxdfhei1' USING DFHEIV0,
 19053           DFHEIV1,
 19054           WS-DLO-INTERNAL-POLICY-FORM,
 19055           DLO002-COMM-LENGTH,
 19056           DFHEIV99,
 19057           DFHEIV99,
 19058           DFHEIV99,
 19059           DFHEIV99
 19060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19061
 19062
 19063 7710-EXIT.
 19064     EXIT.
 19065
 19066 7720-CALL-DL3.
 19067
 19068* EXEC CICS LINK
 19069*        PROGRAM    ('DLO003')
 19070*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19071*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 351
* EL050.cbl
 19072*    END-EXEC.
 19073     MOVE 'DLO003' TO DFHEIV1
 19074*    MOVE '."C                   (   #00018622' TO DFHEIV0
 19075     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19077     MOVE X'2020233030303138363232' TO DFHEIV0(25:11)
 19078     CALL 'kxdfhei1' USING DFHEIV0,
 19079           DFHEIV1,
 19080           WS-DLO-VALID-BANK-ID,
 19081           DLO003-COMM-LENGTH,
 19082           DFHEIV99,
 19083           DFHEIV99,
 19084           DFHEIV99,
 19085           DFHEIV99
 19086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19087
 19088
 19089 7720-EXIT.
 19090     EXIT.
 19091
 19092 7730-CALL-DL7.
 19093
 19094* EXEC CICS LINK
 19095*        PROGRAM    ('DLO007')
 19096*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19097*        LENGTH     (DLO007-COMM-LENGTH)
 19098*    END-EXEC.
 19099     MOVE 'DLO007' TO DFHEIV1
 19100*    MOVE '."C                   (   #00018632' TO DFHEIV0
 19101     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19102     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19103     MOVE X'2020233030303138363332' TO DFHEIV0(25:11)
 19104     CALL 'kxdfhei1' USING DFHEIV0,
 19105           DFHEIV1,
 19106           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19107           DLO007-COMM-LENGTH,
 19108           DFHEIV99,
 19109           DFHEIV99,
 19110           DFHEIV99,
 19111           DFHEIV99
 19112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19113
 19114
 19115 7730-EXIT.
 19116     EXIT.
 19117
 19118 7740-CALL-DL11.
 19119
 19120* EXEC CICS LINK
 19121*        PROGRAM    ('DLO011')
 19122*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19123*        LENGTH     (DLO011-COMM-LENGTH)
 19124*    END-EXEC.
 19125     MOVE 'DLO011' TO DFHEIV1
 19126*    MOVE '."C                   (   #00018642' TO DFHEIV0
 19127     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19128     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19129     MOVE X'2020233030303138363432' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 352
* EL050.cbl
 19130     CALL 'kxdfhei1' USING DFHEIV0,
 19131           DFHEIV1,
 19132           WS-DLO-PREM-RATES-BEN-TYPE,
 19133           DLO011-COMM-LENGTH,
 19134           DFHEIV99,
 19135           DFHEIV99,
 19136           DFHEIV99,
 19137           DFHEIV99
 19138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19139
 19140
 19141 7740-EXIT.
 19142     EXIT.
 19143
 19144 7750-CALL-DL17.
 19145
 19146* EXEC CICS LINK
 19147*        PROGRAM    ('DLO017')
 19148*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19149*        LENGTH     (DLO017-COMM-LENGTH)
 19150*    END-EXEC.
 19151     MOVE 'DLO017' TO DFHEIV1
 19152*    MOVE '."C                   (   #00018652' TO DFHEIV0
 19153     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19154     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19155     MOVE X'2020233030303138363532' TO DFHEIV0(25:11)
 19156     CALL 'kxdfhei1' USING DFHEIV0,
 19157           DFHEIV1,
 19158           WS-DLO-VALID-RATE-CODE,
 19159           DLO017-COMM-LENGTH,
 19160           DFHEIV99,
 19161           DFHEIV99,
 19162           DFHEIV99,
 19163           DFHEIV99
 19164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19165
 19166
 19167 7750-EXIT.
 19168     EXIT.
 19169
 19170 7755-CALL-DL19.
 19171
 19172* EXEC CICS LINK
 19173*        PROGRAM    ('DLO019')
 19174*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19175*        LENGTH     (DLO019-COMM-LENGTH)
 19176*    END-EXEC.
 19177     MOVE 'DLO019' TO DFHEIV1
 19178*    MOVE '."C                   (   #00018662' TO DFHEIV0
 19179     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19181     MOVE X'2020233030303138363632' TO DFHEIV0(25:11)
 19182     CALL 'kxdfhei1' USING DFHEIV0,
 19183           DFHEIV1,
 19184           WS-DLO-ORIG-COV-CAT,
 19185           DLO019-COMM-LENGTH,
 19186           DFHEIV99,
 19187           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 353
* EL050.cbl
 19188           DFHEIV99,
 19189           DFHEIV99
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19191
 19192
 19193 7755-EXIT.
 19194     EXIT.
 19195
 19196 7760-CALL-DL21.
 19197
 19198* EXEC CICS LINK
 19199*        PROGRAM    ('DLO021')
 19200*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19201*        LENGTH     (DLO021-COMM-LENGTH)
 19202*    END-EXEC.
 19203     MOVE 'DLO021' TO DFHEIV1
 19204*    MOVE '."C                   (   #00018672' TO DFHEIV0
 19205     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19207     MOVE X'2020233030303138363732' TO DFHEIV0(25:11)
 19208     CALL 'kxdfhei1' USING DFHEIV0,
 19209           DFHEIV1,
 19210           WS-DLO-VALID-LOAN-OFFICER,
 19211           DLO021-COMM-LENGTH,
 19212           DFHEIV99,
 19213           DFHEIV99,
 19214           DFHEIV99,
 19215           DFHEIV99
 19216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19217
 19218
 19219 7760-EXIT.
 19220     EXIT.
 19221
 19222 7770-CALL-DL22.
 19223
 19224* EXEC CICS LINK
 19225*        PROGRAM    ('DLO022')
 19226*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19227*        LENGTH     (DLO022-COMM-LENGTH)
 19228*    END-EXEC.
 19229     MOVE 'DLO022' TO DFHEIV1
 19230*    MOVE '."C                   (   #00018682' TO DFHEIV0
 19231     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19232     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19233     MOVE X'2020233030303138363832' TO DFHEIV0(25:11)
 19234     CALL 'kxdfhei1' USING DFHEIV0,
 19235           DFHEIV1,
 19236           WS-DLO-VALID-STATE-CODE,
 19237           DLO022-COMM-LENGTH,
 19238           DFHEIV99,
 19239           DFHEIV99,
 19240           DFHEIV99,
 19241           DFHEIV99
 19242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19243
 19244
 19245 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 354
* EL050.cbl
 19246     EXIT.
 19247
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 355
* EL050.cbl
 19249
 19250 7800-REWRITE-CERT.
 19251******************************************************************
 19252*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19253*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19254******************************************************************
 19255
 19256     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19257        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19258        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19259        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19260
 19261* EXEC CICS REWRITE
 19262*                  DATASET (CERT-ID)
 19263*                  FROM    (CERTIFICATE-MASTER)
 19264*              END-EXEC
 19265     MOVE LENGTH OF
 19266      CERTIFICATE-MASTER
 19267       TO DFHEIV11
 19268*    MOVE '&& L                  %   #00018703' TO DFHEIV0
 19269     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19270     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19271     MOVE X'2020233030303138373033' TO DFHEIV0(25:11)
 19272     CALL 'kxdfhei1' USING DFHEIV0,
 19273           CERT-ID,
 19274           CERTIFICATE-MASTER,
 19275           DFHEIV11,
 19276           DFHEIV99
 19277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19278        GO TO 7800-EXIT.
 19279
 19280       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19281       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19282
 19283 7800-EXIT.
 19284      EXIT.
 19285
 19286 7900-DELETE-CERT.
 19287
 19288* EXEC CICS DELETE
 19289*        DATASET (CERT-ID)
 19290*    END-EXEC.
 19291*    MOVE '&(                    &   #00018716' TO DFHEIV0
 19292     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19293     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19294     MOVE X'2020233030303138373136' TO DFHEIV0(25:11)
 19295     CALL 'kxdfhei1' USING DFHEIV0,
 19296           CERT-ID,
 19297           DFHEIV99,
 19298           DFHEIV99,
 19299           DFHEIV99,
 19300           DFHEIV99
 19301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19302
 19303
 19304 7900-EXIT.
 19305     EXIT.
 19306
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 356
* EL050.cbl
 19307 8000-WRITE-CERT.
 19308
 19309* EXEC CICS HANDLE CONDITION
 19310*        DUPKEY    (8000-FREE-MAIN)
 19311*    END-EXEC.
 19312*    MOVE '"$$                   ! + #00018724' TO DFHEIV0
 19313     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19315     MOVE X'2B20233030303138373234' TO DFHEIV0(25:11)
 19316     CALL 'kxdfhei1' USING DFHEIV0
 19317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19318
 19319
 19320
 19321* EXEC CICS WRITE
 19322*        DATASET     (CERT-ID)
 19323*        FROM        (CERTIFICATE-MASTER)
 19324*        RIDFLD      (ELCERT-KEY)
 19325*    END-EXEC.
 19326     MOVE LENGTH OF
 19327      CERTIFICATE-MASTER
 19328       TO DFHEIV11
 19329*    MOVE '&$ L                  ''   #00018728' TO DFHEIV0
 19330     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19331     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19332     MOVE X'2020233030303138373238' TO DFHEIV0(25:11)
 19333     CALL 'kxdfhei1' USING DFHEIV0,
 19334           CERT-ID,
 19335           CERTIFICATE-MASTER,
 19336           DFHEIV11,
 19337           ELCERT-KEY,
 19338           DFHEIV99,
 19339           DFHEIV99
 19340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19341
 19342
 19343 8000-FREE-MAIN.
 19344
 19345 8000-EXIT.
 19346      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 357
* EL050.cbl
 19348
 19349 8100-READ-ERPNDM.
 19350
 19351* EXEC CICS HANDLE CONDITION
 19352*         NOTFND     (8100-NOTFND)
 19353*         ENDFILE    (8100-NOTFND)
 19354*    END-EXEC.
 19355*    MOVE '"$I''                  ! , #00018741' TO DFHEIV0
 19356     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19358     MOVE X'2C20233030303138373431' TO DFHEIV0(25:11)
 19359     CALL 'kxdfhei1' USING DFHEIV0
 19360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19361
 19362
 19363     MOVE SPACES                 TO ERPNDM-FOUND.
 19364     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19365
 19366
 19367* EXEC CICS READ
 19368*         DATASET   (FILE-ERPNDM)
 19369*         RIDFLD    (PM-CONTROL-PRIMARY)
 19370*         INTO      (PENDING-MAILING-DATA)
 19371*    END-EXEC.
 19372     MOVE LENGTH OF
 19373      PENDING-MAILING-DATA
 19374       TO DFHEIV11
 19375*    MOVE '&"IL       E          (   #00018749' TO DFHEIV0
 19376     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19378     MOVE X'2020233030303138373439' TO DFHEIV0(25:11)
 19379     CALL 'kxdfhei1' USING DFHEIV0,
 19380           FILE-ERPNDM,
 19381           PENDING-MAILING-DATA,
 19382           DFHEIV11,
 19383           PM-CONTROL-PRIMARY,
 19384           DFHEIV99,
 19385           DFHEIV99,
 19386           DFHEIV99
 19387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19388
 19389
 19390     GO TO 8100-EXIT.
 19391
 19392 8100-NOTFND.
 19393
 19394     MOVE 'X'                    TO ERPNDM-FOUND.
 19395     MOVE ER-2694                TO WS-ERROR.
 19396     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19397     MOVE ER-2883                TO WS-ERROR
 19398     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19399     .
 19400 8100-EXIT.
 19401     EXIT.
 19402
 19403 8110-READ-ERMAIL.
 19404
 19405* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 358
* EL050.cbl
 19406*         NOTFND     (8110-NOTFND)
 19407*         ENDFILE    (8110-NOTFND)
 19408*    END-EXEC.
 19409*    MOVE '"$I''                  ! - #00018769' TO DFHEIV0
 19410     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19412     MOVE X'2D20233030303138373639' TO DFHEIV0(25:11)
 19413     CALL 'kxdfhei1' USING DFHEIV0
 19414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19415
 19416
 19417     MOVE SPACES                 TO ERMAIL-FOUND.
 19418     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19419     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19420     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19421     MOVE PB-SV-STATE            TO MA-STATE.
 19422
 19423
 19424* EXEC CICS READ
 19425*         UPDATE
 19426*         DATASET   (FILE-ERMAIL)
 19427*         RIDFLD    (MA-CONTROL-PRIMARY)
 19428*         INTO      (MAILING-DATA)
 19429*    END-EXEC.
 19430     MOVE LENGTH OF
 19431      MAILING-DATA
 19432       TO DFHEIV11
 19433*    MOVE '&"IL       EU         (   #00018780' TO DFHEIV0
 19434     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19435     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19436     MOVE X'2020233030303138373830' TO DFHEIV0(25:11)
 19437     CALL 'kxdfhei1' USING DFHEIV0,
 19438           FILE-ERMAIL,
 19439           MAILING-DATA,
 19440           DFHEIV11,
 19441           MA-CONTROL-PRIMARY,
 19442           DFHEIV99,
 19443           DFHEIV99,
 19444           DFHEIV99
 19445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19446
 19447
 19448     GO TO 8110-EXIT.
 19449
 19450 8110-NOTFND.
 19451     MOVE 'X'                    TO ERMAIL-FOUND.
 19452
 19453 8110-EXIT.
 19454     EXIT.
 19455
 19456 8120-REWRITE-ERMAIL.
 19457
 19458* EXEC CICS REWRITE
 19459*         DATASET    (FILE-ERMAIL)
 19460*         FROM       (MAILING-DATA)
 19461*    END-EXEC.
 19462     MOVE LENGTH OF
 19463      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 359
* EL050.cbl
 19464       TO DFHEIV11
 19465*    MOVE '&& L                  %   #00018796' TO DFHEIV0
 19466     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19467     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19468     MOVE X'2020233030303138373936' TO DFHEIV0(25:11)
 19469     CALL 'kxdfhei1' USING DFHEIV0,
 19470           FILE-ERMAIL,
 19471           MAILING-DATA,
 19472           DFHEIV11,
 19473           DFHEIV99
 19474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19475
 19476
 19477 8120-EXIT.
 19478     EXIT.
 19479
 19480 8130-WRITE-ERMAIL.
 19481
 19482* EXEC CICS HANDLE CONDITION
 19483*         DUPKEY   (8130-EXIT)
 19484*    END-EXEC.
 19485*    MOVE '"$$                   ! . #00018805' TO DFHEIV0
 19486     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19488     MOVE X'2E20233030303138383035' TO DFHEIV0(25:11)
 19489     CALL 'kxdfhei1' USING DFHEIV0
 19490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19491
 19492
 19493
 19494* EXEC CICS WRITE
 19495*         DATASET     (FILE-ERMAIL)
 19496*         RIDFLD      (MA-CONTROL-PRIMARY)
 19497*         FROM        (MAILING-DATA)
 19498*    END-EXEC.
 19499     MOVE LENGTH OF
 19500      MAILING-DATA
 19501       TO DFHEIV11
 19502*    MOVE '&$ L                  ''   #00018809' TO DFHEIV0
 19503     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19504     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19505     MOVE X'2020233030303138383039' TO DFHEIV0(25:11)
 19506     CALL 'kxdfhei1' USING DFHEIV0,
 19507           FILE-ERMAIL,
 19508           MAILING-DATA,
 19509           DFHEIV11,
 19510           MA-CONTROL-PRIMARY,
 19511           DFHEIV99,
 19512           DFHEIV99
 19513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19514
 19515
 19516 8130-EXIT.
 19517     EXIT.
 19518
 19519 8140-UNLOCK-ERMAIL.
 19520
 19521* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 360
* EL050.cbl
 19522*         DATASET   (FILE-ERMAIL)
 19523*    END-EXEC.
 19524*    MOVE '&*                    #   #00018819' TO DFHEIV0
 19525     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19526     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19527     MOVE X'2020233030303138383139' TO DFHEIV0(25:11)
 19528     CALL 'kxdfhei1' USING DFHEIV0,
 19529           FILE-ERMAIL,
 19530           DFHEIV99
 19531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19532
 19533
 19534 8140-EXIT.
 19535     EXIT.
 19536
 19537 8180-UPDATE-VIN-NUMBER.
 19538
 19539* EXEC CICS HANDLE CONDITION
 19540*        NOTFND   (8180-NOTFND)
 19541*    END-EXEC.
 19542*    MOVE '"$I                   ! / #00018827' TO DFHEIV0
 19543     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19545     MOVE X'2F20233030303138383237' TO DFHEIV0(25:11)
 19546     CALL 'kxdfhei1' USING DFHEIV0
 19547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19548
 19549
 19550     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19551     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19552
 19553
 19554* EXEC CICS READ
 19555*        UPDATE
 19556*        DATASET  (CRTT-ID)
 19557*        RIDFLD   (WS-ELCRTT-KEY)
 19558*        INTO     (CERTIFICATE-TRAILERS)
 19559*    END-EXEC.
 19560     MOVE LENGTH OF
 19561      CERTIFICATE-TRAILERS
 19562       TO DFHEIV11
 19563*    MOVE '&"IL       EU         (   #00018834' TO DFHEIV0
 19564     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19565     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19566     MOVE X'2020233030303138383334' TO DFHEIV0(25:11)
 19567     CALL 'kxdfhei1' USING DFHEIV0,
 19568           CRTT-ID,
 19569           CERTIFICATE-TRAILERS,
 19570           DFHEIV11,
 19571           WS-ELCRTT-KEY,
 19572           DFHEIV99,
 19573           DFHEIV99,
 19574           DFHEIV99
 19575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19576
 19577
 19578     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19579         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 361
* EL050.cbl
 19580
 19581* EXEC CICS REWRITE
 19582*           DATASET  (CRTT-ID)
 19583*           FROM     (CERTIFICATE-TRAILERS)
 19584*        END-EXEC
 19585     MOVE LENGTH OF
 19586      CERTIFICATE-TRAILERS
 19587       TO DFHEIV11
 19588*    MOVE '&& L                  %   #00018843' TO DFHEIV0
 19589     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19590     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19591     MOVE X'2020233030303138383433' TO DFHEIV0(25:11)
 19592     CALL 'kxdfhei1' USING DFHEIV0,
 19593           CRTT-ID,
 19594           CERTIFICATE-TRAILERS,
 19595           DFHEIV11,
 19596           DFHEIV99
 19597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19598     ELSE
 19599
 19600* EXEC CICS UNLOCK
 19601*          DATASET  (CRTT-ID)
 19602*       END-EXEC
 19603*    MOVE '&*                    #   #00018848' TO DFHEIV0
 19604     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19605     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19606     MOVE X'2020233030303138383438' TO DFHEIV0(25:11)
 19607     CALL 'kxdfhei1' USING DFHEIV0,
 19608           CRTT-ID,
 19609           DFHEIV99
 19610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19611     END-IF.
 19612
 19613     GO TO 8180-EXIT.
 19614
 19615 8180-NOTFND.
 19616
 19617     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19618     MOVE 'CS'         TO CS-RECORD-ID.
 19619     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19620     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19621     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19622     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19623
 19624* EXEC CICS WRITE
 19625*       DATASET  (CRTT-ID)
 19626*       RIDFLD   (WS-ELCRTT-KEY)
 19627*       FROM     (CERTIFICATE-TRAILERS)
 19628*    END-EXEC.
 19629     MOVE LENGTH OF
 19630      CERTIFICATE-TRAILERS
 19631       TO DFHEIV11
 19632*    MOVE '&$ L                  ''   #00018863' TO DFHEIV0
 19633     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19634     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19635     MOVE X'2020233030303138383633' TO DFHEIV0(25:11)
 19636     CALL 'kxdfhei1' USING DFHEIV0,
 19637           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 362
* EL050.cbl
 19638           CERTIFICATE-TRAILERS,
 19639           DFHEIV11,
 19640           WS-ELCRTT-KEY,
 19641           DFHEIV99,
 19642           DFHEIV99
 19643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19644
 19645
 19646 8180-EXIT.
 19647     EXIT.
 19648
 19649 8190-UPDATE-REFUND-CLAIM-FLAG.
 19650
 19651* EXEC CICS HANDLE CONDITION
 19652*        NOTFND   (8190-NOTFND)
 19653*    END-EXEC.
 19654*    MOVE '"$I                   ! 0 #00018873' TO DFHEIV0
 19655     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19657     MOVE X'3020233030303138383733' TO DFHEIV0(25:11)
 19658     CALL 'kxdfhei1' USING DFHEIV0
 19659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19660
 19661
 19662     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19663     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19664
 19665
 19666* EXEC CICS READ
 19667*        UPDATE
 19668*        DATASET  (CRTT-ID)
 19669*        RIDFLD   (WS-ELCRTT-KEY)
 19670*        INTO     (CERTIFICATE-TRAILERS)
 19671*    END-EXEC.
 19672     MOVE LENGTH OF
 19673      CERTIFICATE-TRAILERS
 19674       TO DFHEIV11
 19675*    MOVE '&"IL       EU         (   #00018880' TO DFHEIV0
 19676     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19677     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19678     MOVE X'2020233030303138383830' TO DFHEIV0(25:11)
 19679     CALL 'kxdfhei1' USING DFHEIV0,
 19680           CRTT-ID,
 19681           CERTIFICATE-TRAILERS,
 19682           DFHEIV11,
 19683           WS-ELCRTT-KEY,
 19684           DFHEIV99,
 19685           DFHEIV99,
 19686           DFHEIV99
 19687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19688
 19689
 19690     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19691
 19692* EXEC CICS REWRITE
 19693*       DATASET  (CRTT-ID)
 19694*       FROM     (CERTIFICATE-TRAILERS)
 19695*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 363
* EL050.cbl
 19696     MOVE LENGTH OF
 19697      CERTIFICATE-TRAILERS
 19698       TO DFHEIV11
 19699*    MOVE '&& L                  %   #00018888' TO DFHEIV0
 19700     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19701     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19702     MOVE X'2020233030303138383838' TO DFHEIV0(25:11)
 19703     CALL 'kxdfhei1' USING DFHEIV0,
 19704           CRTT-ID,
 19705           CERTIFICATE-TRAILERS,
 19706           DFHEIV11,
 19707           DFHEIV99
 19708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19709
 19710
 19711     GO TO 8190-EXIT.
 19712
 19713 8190-NOTFND.
 19714
 19715     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19716     MOVE 'CS'         TO CS-RECORD-ID.
 19717     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19718     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19719     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19720     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19721
 19722* EXEC CICS WRITE
 19723*       DATASET  (CRTT-ID)
 19724*       RIDFLD   (WS-ELCRTT-KEY)
 19725*       FROM     (CERTIFICATE-TRAILERS)
 19726*    END-EXEC.
 19727     MOVE LENGTH OF
 19728      CERTIFICATE-TRAILERS
 19729       TO DFHEIV11
 19730*    MOVE '&$ L                  ''   #00018903' TO DFHEIV0
 19731     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19732     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19733     MOVE X'2020233030303138393033' TO DFHEIV0(25:11)
 19734     CALL 'kxdfhei1' USING DFHEIV0,
 19735           CRTT-ID,
 19736           CERTIFICATE-TRAILERS,
 19737           DFHEIV11,
 19738           WS-ELCRTT-KEY,
 19739           DFHEIV99,
 19740           DFHEIV99
 19741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19742
 19743
 19744 8190-EXIT.
 19745     EXIT.
 19746
 19747 8195-UPDATE-AGE-FLAGS.
 19748
 19749* EXEC CICS HANDLE CONDITION
 19750*        NOTFND   (8195-NOTFND)
 19751*    END-EXEC.
 19752*    MOVE '"$I                   ! 1 #00018913' TO DFHEIV0
 19753     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 364
* EL050.cbl
 19754     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19755     MOVE X'3120233030303138393133' TO DFHEIV0(25:11)
 19756     CALL 'kxdfhei1' USING DFHEIV0
 19757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19758
 19759
 19760     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19761     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19762
 19763
 19764* EXEC CICS READ
 19765*        UPDATE
 19766*        DATASET  (CRTT-ID)
 19767*        RIDFLD   (WS-ELCRTT-KEY)
 19768*        INTO     (CERTIFICATE-TRAILERS)
 19769*    END-EXEC.
 19770     MOVE LENGTH OF
 19771      CERTIFICATE-TRAILERS
 19772       TO DFHEIV11
 19773*    MOVE '&"IL       EU         (   #00018920' TO DFHEIV0
 19774     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19775     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19776     MOVE X'2020233030303138393230' TO DFHEIV0(25:11)
 19777     CALL 'kxdfhei1' USING DFHEIV0,
 19778           CRTT-ID,
 19779           CERTIFICATE-TRAILERS,
 19780           DFHEIV11,
 19781           WS-ELCRTT-KEY,
 19782           DFHEIV99,
 19783           DFHEIV99,
 19784           DFHEIV99
 19785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19786
 19787
 19788     IF WS-INS-AGE-SET = 'Y'
 19789        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19790     END-IF
 19791     IF WS-JNT-AGE-SET = 'Y'
 19792        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19793     END-IF
 19794
 19795
 19796* EXEC CICS REWRITE
 19797*       DATASET  (CRTT-ID)
 19798*       FROM     (CERTIFICATE-TRAILERS)
 19799*    END-EXEC.
 19800     MOVE LENGTH OF
 19801      CERTIFICATE-TRAILERS
 19802       TO DFHEIV11
 19803*    MOVE '&& L                  %   #00018934' TO DFHEIV0
 19804     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19805     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19806     MOVE X'2020233030303138393334' TO DFHEIV0(25:11)
 19807     CALL 'kxdfhei1' USING DFHEIV0,
 19808           CRTT-ID,
 19809           CERTIFICATE-TRAILERS,
 19810           DFHEIV11,
 19811           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 365
* EL050.cbl
 19812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19813
 19814
 19815     GO TO 8195-EXIT.
 19816
 19817 8195-NOTFND.
 19818
 19819     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19820     MOVE 'CS'         TO CS-RECORD-ID.
 19821     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19822     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19823     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19824     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19825     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19826
 19827* EXEC CICS WRITE
 19828*       DATASET  (CRTT-ID)
 19829*       RIDFLD   (WS-ELCRTT-KEY)
 19830*       FROM     (CERTIFICATE-TRAILERS)
 19831*    END-EXEC.
 19832     MOVE LENGTH OF
 19833      CERTIFICATE-TRAILERS
 19834       TO DFHEIV11
 19835*    MOVE '&$ L                  ''   #00018950' TO DFHEIV0
 19836     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19837     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19838     MOVE X'2020233030303138393530' TO DFHEIV0(25:11)
 19839     CALL 'kxdfhei1' USING DFHEIV0,
 19840           CRTT-ID,
 19841           CERTIFICATE-TRAILERS,
 19842           DFHEIV11,
 19843           WS-ELCRTT-KEY,
 19844           DFHEIV99,
 19845           DFHEIV99
 19846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19847
 19848
 19849 8195-EXIT.
 19850     EXIT.
 19851
 19852 8200-READ-REIN-TABLE.
 19853
 19854* EXEC CICS HANDLE CONDITION
 19855*         NOTFND   (8200-NOTFND)
 19856*    END-EXEC.
 19857*    MOVE '"$I                   ! 2 #00018960' TO DFHEIV0
 19858     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19859     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19860     MOVE X'3220233030303138393630' TO DFHEIV0(25:11)
 19861     CALL 'kxdfhei1' USING DFHEIV0
 19862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19863
 19864
 19865
 19866* EXEC CICS READ
 19867*        DATASET     (REIN-ID)
 19868*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19869*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 366
* EL050.cbl
 19870*    END-EXEC.
 19871*    MOVE '&"S        E          (   #00018964' TO DFHEIV0
 19872     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19874     MOVE X'2020233030303138393634' TO DFHEIV0(25:11)
 19875     CALL 'kxdfhei1' USING DFHEIV0,
 19876           REIN-ID,
 19877           DFHEIV20,
 19878           DFHEIV99,
 19879           ERREIN-KEY,
 19880           DFHEIV99,
 19881           DFHEIV99,
 19882           DFHEIV99
 19883     SET ADDRESS OF REINSURANCE-RECORD TO
 19884         DFHEIV20
 19885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19886
 19887
 19888     GO TO 8200-EXIT.
 19889
 19890 8200-NOTFND.
 19891     MOVE 'N'             TO WS-REIN-READ-SW.
 19892
 19893 8200-EXIT.
 19894      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 367
* EL050.cbl
 19896
 19897 8300-READ-CTBL-TABLE.
 19898
 19899* EXEC CICS HANDLE CONDITION
 19900*        NOTFND    (8300-NOTFND)
 19901*        DISABLED  (8300-ERRESS-PROBLEM)
 19902*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19903*        ENDFILE   (8300-NOTFND)
 19904*    END-EXEC.
 19905*    MOVE '"$IcJ''                ! 3 #00018980' TO DFHEIV0
 19906     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19908     MOVE X'3320233030303138393830' TO DFHEIV0(25:11)
 19909     CALL 'kxdfhei1' USING DFHEIV0
 19910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19911
 19912
 19913
 19914* EXEC CICS READ
 19915*        DATASET     (CTBL-ID)
 19916*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19917*        RIDFLD      (ERCTBL-KEY)
 19918*    END-EXEC.
 19919*    MOVE '&"S        E          (   #00018987' TO DFHEIV0
 19920     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19921     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19922     MOVE X'2020233030303138393837' TO DFHEIV0(25:11)
 19923     CALL 'kxdfhei1' USING DFHEIV0,
 19924           CTBL-ID,
 19925           DFHEIV20,
 19926           DFHEIV99,
 19927           ERCTBL-KEY,
 19928           DFHEIV99,
 19929           DFHEIV99,
 19930           DFHEIV99
 19931     SET ADDRESS OF COMM-TABLE-RECORD TO
 19932         DFHEIV20
 19933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19934
 19935
 19936     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19937
 19938     GO TO 8300-EXIT.
 19939
 19940 8300-NOTFND.
 19941
 19942     IF CTBL-SW = '0530'
 19943         MOVE 'AA'                     TO WS-AH-COMP-CD
 19944         MOVE '0550'                   TO CTBL-SW
 19945         MOVE '1'                      TO WS-CTBL-READ-SW
 19946         GO TO 8300-EXIT.
 19947
 19948     IF CTBL-SW = '0540'
 19949         MOVE 'AA'                     TO WS-LF-COMP-CD
 19950         MOVE '0550'                   TO CTBL-SW
 19951         MOVE '1'                      TO WS-CTBL-READ-SW
 19952         GO TO 8300-EXIT.
 19953
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 368
* EL050.cbl
 19954     IF CTBL-SW = '0550'
 19955         MOVE '2'                      TO WS-CTBL-READ-SW
 19956         GO TO 8300-EXIT.
 19957
 19958     GO TO 8300-EXIT.
 19959
 19960 8300-ERRESS-PROBLEM.
 19961
 19962      MOVE ER-8050              TO WS-ERROR.
 19963      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19964
 19965     GO TO 8300-EXIT.
 19966
 19967 8300-EXIT.
 19968      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 369
* EL050.cbl
 19970
 19971
 19972 8400-GETMAIN-ERFORM.
 19973
 19974
 19975* EXEC CICS   GETMAIN
 19976*        LENGTH  (500)
 19977*        SET     (ADDRESS OF FORM-MASTER)
 19978*    END-EXEC.
 19979     MOVE 500
 19980       TO DFHEIV11
 19981*    MOVE '," L                  $   #00019031' TO DFHEIV0
 19982     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19983     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19984     MOVE X'2020233030303139303331' TO DFHEIV0(25:11)
 19985     CALL 'kxdfhei1' USING DFHEIV0,
 19986           DFHEIV20,
 19987           DFHEIV11,
 19988           DFHEIV99
 19989     SET ADDRESS OF FORM-MASTER TO
 19990         DFHEIV20
 19991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19992
 19993
 19994     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19995
 19996 8400-EXIT.
 19997      EXIT.
 19998
 19999 8450-READ-FORM-MASTER.
 20000
 20001
 20002* EXEC CICS  HANDLE CONDITION
 20003*        NOTFND   (8450-FORM-NOT-FOUND)
 20004*        ENDFILE  (8450-FORM-NOT-FOUND)
 20005*    END-EXEC.
 20006*    MOVE '"$I''                  ! 4 #00019043' TO DFHEIV0
 20007     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20009     MOVE X'3420233030303139303433' TO DFHEIV0(25:11)
 20010     CALL 'kxdfhei1' USING DFHEIV0
 20011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20012
 20013
 20014
 20015* EXEC CICS   READ
 20016*        DATASET   (FORM-ID)
 20017*        RIDFLD    (ERFORM-KEY)
 20018*        INTO      (FORM-MASTER)
 20019*        GTEQ
 20020*    END-EXEC.
 20021     MOVE LENGTH OF
 20022      FORM-MASTER
 20023       TO DFHEIV11
 20024*    MOVE '&"IL       G          (   #00019048' TO DFHEIV0
 20025     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20027     MOVE X'2020233030303139303438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 370
* EL050.cbl
 20028     CALL 'kxdfhei1' USING DFHEIV0,
 20029           FORM-ID,
 20030           FORM-MASTER,
 20031           DFHEIV11,
 20032           ERFORM-KEY,
 20033           DFHEIV99,
 20034           DFHEIV99,
 20035           DFHEIV99
 20036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20037
 20038
 20039     MOVE  'Y'           TO  FORM-MASTER-SW.
 20040
 20041     GO TO  8450-EXIT.
 20042
 20043 8450-FORM-NOT-FOUND.
 20044
 20045     MOVE  'N'           TO  FORM-MASTER-SW.
 20046
 20047 8450-EXIT.
 20048      EXIT.
 20049
 20050 8500-DATE-CONVERT.
 20051
 20052* EXEC CICS LINK
 20053*        PROGRAM    ('ELDATCV')
 20054*        COMMAREA   (DATE-CONVERSION-DATA)
 20055*        LENGTH     (DC-COMM-LENGTH)
 20056*    END-EXEC.
 20057     MOVE 'ELDATCV' TO DFHEIV1
 20058*    MOVE '."C                   (   #00019067' TO DFHEIV0
 20059     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20061     MOVE X'2020233030303139303637' TO DFHEIV0(25:11)
 20062     CALL 'kxdfhei1' USING DFHEIV0,
 20063           DFHEIV1,
 20064           DATE-CONVERSION-DATA,
 20065           DC-COMM-LENGTH,
 20066           DFHEIV99,
 20067           DFHEIV99,
 20068           DFHEIV99,
 20069           DFHEIV99
 20070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20071
 20072
 20073 8500-EXIT.
 20074     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 371
* EL050.cbl
 20076
 20077 8555-RELOAD-CONTROL-FILE.
 20078     CONTINUE.
 20079
 20080 8555-EXIT.
 20081     EXIT.
 20082
 20083 8557-GETMAIN-ERPLAN.
 20084
 20085
 20086* EXEC CICS GETMAIN
 20087*        LENGTH    (840)
 20088*        SET       (ADDRESS OF PLAN-RECORDS)
 20089*    END-EXEC.
 20090     MOVE 840
 20091       TO DFHEIV11
 20092*    MOVE '," L                  $   #00019085' TO DFHEIV0
 20093     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20094     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20095     MOVE X'2020233030303139303835' TO DFHEIV0(25:11)
 20096     CALL 'kxdfhei1' USING DFHEIV0,
 20097           DFHEIV20,
 20098           DFHEIV11,
 20099           DFHEIV99
 20100     SET ADDRESS OF PLAN-RECORDS TO
 20101         DFHEIV20
 20102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20103
 20104
 20105     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20106
 20107 8557-EXIT.
 20108     EXIT.
 20109
 20110 8560-GETMAIN.
 20111
 20112* EXEC CICS GETMAIN
 20113*        LENGTH    (2000)
 20114*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20115*    END-EXEC.
 20116     MOVE 2000
 20117       TO DFHEIV11
 20118*    MOVE '," L                  $   #00019096' TO DFHEIV0
 20119     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20120     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20121     MOVE X'2020233030303139303936' TO DFHEIV0(25:11)
 20122     CALL 'kxdfhei1' USING DFHEIV0,
 20123           DFHEIV20,
 20124           DFHEIV11,
 20125           DFHEIV99
 20126     SET ADDRESS OF ACCOUNT-MASTER TO
 20127         DFHEIV20
 20128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20129
 20130
 20131     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20132
 20133 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 372
* EL050.cbl
 20134     EXIT.
 20135
 20136 8570-START-ACCOUNT-MASTER.
 20137
 20138* EXEC CICS HANDLE CONDITION
 20139*        NOTFND    (0199-ACCT-NOT-FOUND)
 20140*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20141*    END-EXEC.
 20142*    MOVE '"$I''                  ! 5 #00019107' TO DFHEIV0
 20143     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20145     MOVE X'3520233030303139313037' TO DFHEIV0(25:11)
 20146     CALL 'kxdfhei1' USING DFHEIV0
 20147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20148
 20149
 20150
 20151* EXEC CICS STARTBR
 20152*        DATASET    (ACCT-ID)
 20153*        RIDFLD     (ERACCT-KEY)
 20154*        GTEQ
 20155*    END-EXEC.
 20156     MOVE 0
 20157       TO DFHEIV11
 20158*    MOVE '&,         G          &   #00019112' TO DFHEIV0
 20159     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20160     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20161     MOVE X'2020233030303139313132' TO DFHEIV0(25:11)
 20162     CALL 'kxdfhei1' USING DFHEIV0,
 20163           ACCT-ID,
 20164           ERACCT-KEY,
 20165           DFHEIV99,
 20166           DFHEIV11,
 20167           DFHEIV99
 20168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20169
 20170
 20171 8570-EXIT.
 20172     EXIT.
 20173
 20174 8580-READ-ACCOUNT-MASTER.
 20175
 20176* EXEC CICS HANDLE CONDITION
 20177*        NOTFND    (0199-ACCT-NOT-FOUND)
 20178*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20179*    END-EXEC.
 20180*    MOVE '"$I''                  ! 6 #00019122' TO DFHEIV0
 20181     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20183     MOVE X'3620233030303139313232' TO DFHEIV0(25:11)
 20184     CALL 'kxdfhei1' USING DFHEIV0
 20185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20186
 20187
 20188
 20189* EXEC CICS READNEXT
 20190*        DATASET     (ACCT-ID)
 20191*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 373
* EL050.cbl
 20192*        RIDFLD      (ERACCT-KEY)
 20193*    END-EXEC.
 20194     MOVE LENGTH OF
 20195      ACCOUNT-MASTER
 20196       TO DFHEIV12
 20197     MOVE 0
 20198       TO DFHEIV11
 20199*    MOVE '&.IL                  )   #00019127' TO DFHEIV0
 20200     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20201     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20202     MOVE X'2020233030303139313237' TO DFHEIV0(25:11)
 20203     CALL 'kxdfhei1' USING DFHEIV0,
 20204           ACCT-ID,
 20205           ACCOUNT-MASTER,
 20206           DFHEIV12,
 20207           ERACCT-KEY,
 20208           DFHEIV99,
 20209           DFHEIV11,
 20210           DFHEIV99,
 20211           DFHEIV99
 20212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20213
 20214
 20215 8580-EXIT.
 20216     EXIT.
 20217
 20218 8582-READ-COMPENSATION-MASTER.
 20219
 20220* EXEC CICS HANDLE CONDITION
 20221*        NOTFND    (8582-COMP-NOT-FOUND)
 20222*        ENDFILE   (8582-COMP-NOT-FOUND)
 20223*    END-EXEC.
 20224*    MOVE '"$I''                  ! 7 #00019137' TO DFHEIV0
 20225     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20227     MOVE X'3720233030303139313337' TO DFHEIV0(25:11)
 20228     CALL 'kxdfhei1' USING DFHEIV0
 20229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20230
 20231
 20232
 20233* EXEC CICS READ
 20234*        DATASET     (COMP-ID)
 20235*        INTO        (COMPENSATION-MASTER)
 20236*        RIDFLD      (ERCOMP-KEY)
 20237*    END-EXEC.
 20238     MOVE LENGTH OF
 20239      COMPENSATION-MASTER
 20240       TO DFHEIV11
 20241*    MOVE '&"IL       E          (   #00019142' TO DFHEIV0
 20242     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20244     MOVE X'2020233030303139313432' TO DFHEIV0(25:11)
 20245     CALL 'kxdfhei1' USING DFHEIV0,
 20246           COMP-ID,
 20247           COMPENSATION-MASTER,
 20248           DFHEIV11,
 20249           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 374
* EL050.cbl
 20250           DFHEIV99,
 20251           DFHEIV99,
 20252           DFHEIV99
 20253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20254
 20255
 20256     MOVE 'Y'                    TO COMP-MASTER-SW
 20257
 20258     GO TO 8582-EXIT
 20259     .
 20260 8582-COMP-NOT-FOUND.
 20261
 20262     MOVE 'N'                    TO COMP-MASTER-SW.
 20263
 20264 8582-EXIT.
 20265     EXIT.
 20266
 20267 8583-READ-ERAGTC.
 20268
 20269* EXEC CICS HANDLE CONDITION
 20270*        NOTFND    (8583-AGTC-NOT-FOUND)
 20271*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20272*    END-EXEC.
 20273*    MOVE '"$I''                  ! 8 #00019160' TO DFHEIV0
 20274     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20276     MOVE X'3820233030303139313630' TO DFHEIV0(25:11)
 20277     CALL 'kxdfhei1' USING DFHEIV0
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20279
 20280
 20281
 20282* EXEC CICS STARTBR
 20283*        DATASET    (AGTC-ID)
 20284*        RIDFLD     (ERAGTC-KEY)
 20285*        GTEQ
 20286*    END-EXEC.
 20287     MOVE 0
 20288       TO DFHEIV11
 20289*    MOVE '&,         G          &   #00019165' TO DFHEIV0
 20290     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20291     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20292     MOVE X'2020233030303139313635' TO DFHEIV0(25:11)
 20293     CALL 'kxdfhei1' USING DFHEIV0,
 20294           AGTC-ID,
 20295           ERAGTC-KEY,
 20296           DFHEIV99,
 20297           DFHEIV11,
 20298           DFHEIV99
 20299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20300
 20301
 20302 8583-READ-ERAGTC-NEXT.
 20303
 20304* EXEC CICS READNEXT
 20305*        DATASET     (AGTC-ID)
 20306*        INTO        (AGENT-COMMISSIONS)
 20307*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 375
* EL050.cbl
 20308*    END-EXEC.
 20309     MOVE LENGTH OF
 20310      AGENT-COMMISSIONS
 20311       TO DFHEIV12
 20312     MOVE 0
 20313       TO DFHEIV11
 20314*    MOVE '&.IL                  )   #00019172' TO DFHEIV0
 20315     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20316     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20317     MOVE X'2020233030303139313732' TO DFHEIV0(25:11)
 20318     CALL 'kxdfhei1' USING DFHEIV0,
 20319           AGTC-ID,
 20320           AGENT-COMMISSIONS,
 20321           DFHEIV12,
 20322           ERAGTC-KEY,
 20323           DFHEIV99,
 20324           DFHEIV11,
 20325           DFHEIV99,
 20326           DFHEIV99
 20327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20328
 20329
 20330*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20331
 20332     GO TO 8583-EXIT
 20333     .
 20334 8583-AGTC-NOT-FOUND.
 20335
 20336     MOVE 'N'                    TO AGTC-MASTER-SW.
 20337
 20338 8583-EXIT.
 20339     EXIT.
 20340
 20341 8584-READ-BANK-CROSS-REF.
 20342
 20343* EXEC CICS HANDLE CONDITION
 20344*        NOTFND    (8584-BXRF-NOT-FOUND)
 20345*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20346*    END-EXEC.
 20347*    MOVE '"$I''                  ! 9 #00019190' TO DFHEIV0
 20348     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20350     MOVE X'3920233030303139313930' TO DFHEIV0(25:11)
 20351     CALL 'kxdfhei1' USING DFHEIV0
 20352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20353
 20354
 20355
 20356* EXEC CICS READ
 20357*        DATASET     (BXRF-ID)
 20358*        INTO        (BANK-CROSS-REFERENCE)
 20359*        RIDFLD      (ERBXRF-KEY)
 20360*        LENGTH      (BXRF-REC-LENGTH)
 20361*    END-EXEC.
 20362*    MOVE '&"IL       E          (   #00019195' TO DFHEIV0
 20363     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20365     MOVE X'2020233030303139313935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 376
* EL050.cbl
 20366     CALL 'kxdfhei1' USING DFHEIV0,
 20367           BXRF-ID,
 20368           BANK-CROSS-REFERENCE,
 20369           BXRF-REC-LENGTH,
 20370           ERBXRF-KEY,
 20371           DFHEIV99,
 20372           DFHEIV99,
 20373           DFHEIV99
 20374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20375
 20376
 20377     MOVE 'Y'                    TO BXRF-MASTER-SW
 20378
 20379     GO TO 8584-EXIT
 20380     .
 20381 8584-BXRF-NOT-FOUND.
 20382
 20383     MOVE 'N'                    TO BXRF-MASTER-SW.
 20384
 20385 8584-EXIT.
 20386     EXIT.
 20387
 20388 8585-READ-PLAN-MASTER.
 20389
 20390
 20391* EXEC CICS HANDLE CONDITION
 20392*        NOTFND    (8585-PLAN-NOT-FOUND)
 20393*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20394*    END-EXEC.
 20395*    MOVE '"$I''                  ! : #00019215' TO DFHEIV0
 20396     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20398     MOVE X'3A20233030303139323135' TO DFHEIV0(25:11)
 20399     CALL 'kxdfhei1' USING DFHEIV0
 20400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20401
 20402
 20403
 20404* EXEC CICS READ
 20405*        DATASET     (PLAN-ID)
 20406*        INTO        (PLAN-MASTER)
 20407*        RIDFLD      (ERPLAN-KEY)
 20408*    END-EXEC.
 20409     MOVE LENGTH OF
 20410      PLAN-MASTER
 20411       TO DFHEIV11
 20412*    MOVE '&"IL       E          (   #00019220' TO DFHEIV0
 20413     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20415     MOVE X'2020233030303139323230' TO DFHEIV0(25:11)
 20416     CALL 'kxdfhei1' USING DFHEIV0,
 20417           PLAN-ID,
 20418           PLAN-MASTER,
 20419           DFHEIV11,
 20420           ERPLAN-KEY,
 20421           DFHEIV99,
 20422           DFHEIV99,
 20423           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 377
* EL050.cbl
 20424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20425
 20426
 20427     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20428
 20429     GO TO 8585-EXIT.
 20430
 20431 8585-PLAN-NOT-FOUND.
 20432
 20433     MOVE 'N'                    TO PLAN-MASTER-SW.
 20434
 20435 8585-EXIT.
 20436     EXIT.
 20437
 20438 8586-READ-LOAN-OFFICER.
 20439
 20440* EXEC CICS READ
 20441*        DATASET     (LOFC-ID)
 20442*        INTO        (LOAN-OFFICER-MASTER)
 20443*        RIDFLD      (ERLOFC-KEY)
 20444*        RESP        (WS-RESPONSE)
 20445*    END-EXEC
 20446     MOVE LENGTH OF
 20447      LOAN-OFFICER-MASTER
 20448       TO DFHEIV11
 20449*    MOVE '&"IL       E          (  N#00019238' TO DFHEIV0
 20450     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20452     MOVE X'204E233030303139323338' TO DFHEIV0(25:11)
 20453     CALL 'kxdfhei1' USING DFHEIV0,
 20454           LOFC-ID,
 20455           LOAN-OFFICER-MASTER,
 20456           DFHEIV11,
 20457           ERLOFC-KEY,
 20458           DFHEIV99,
 20459           DFHEIV99,
 20460           DFHEIV99
 20461     MOVE EIBRESP  TO WS-RESPONSE
 20462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20463
 20464     IF WS-RESP-NORMAL
 20465        MOVE 'Y'                 TO LOFC-MASTER-SW
 20466     ELSE
 20467        MOVE 'N'                 TO LOFC-MASTER-SW
 20468     END-IF
 20469     .
 20470 8586-EXIT.
 20471     EXIT.
 20472 8587-START-ERPDEF.
 20473
 20474* EXEC CICS STARTBR
 20475*       DATASET   (PDEF-ID)
 20476*       RIDFLD    (ERPDEF-KEY)
 20477*       GTEQ
 20478*       RESP      (WS-RESPONSE)
 20479*    END-EXEC
 20480     MOVE 0
 20481       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 378
* EL050.cbl
 20482*    MOVE '&,         G          &  N#00019254' TO DFHEIV0
 20483     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20484     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20485     MOVE X'204E233030303139323534' TO DFHEIV0(25:11)
 20486     CALL 'kxdfhei1' USING DFHEIV0,
 20487           PDEF-ID,
 20488           ERPDEF-KEY,
 20489           DFHEIV99,
 20490           DFHEIV11,
 20491           DFHEIV99
 20492     MOVE EIBRESP  TO WS-RESPONSE
 20493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20494     IF WS-RESP-NORMAL
 20495        MOVE 'Y'                 TO PDEF-MASTER-SW
 20496     ELSE
 20497        MOVE 'N'                 TO PDEF-MASTER-SW
 20498     END-IF
 20499     .
 20500 8587-EXIT.
 20501     EXIT.
 20502 8588-READ-ERPDEF.
 20503
 20504* EXEC CICS READNEXT
 20505*       DATASET   (PDEF-ID)
 20506*       RIDFLD    (ERPDEF-KEY)
 20507*       INTO      (PRODUCT-MASTER)
 20508*       RESP      (WS-RESPONSE)
 20509*    END-EXEC
 20510     MOVE LENGTH OF
 20511      PRODUCT-MASTER
 20512       TO DFHEIV12
 20513     MOVE 0
 20514       TO DFHEIV11
 20515*    MOVE '&.IL                  )  N#00019269' TO DFHEIV0
 20516     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20517     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20518     MOVE X'204E233030303139323639' TO DFHEIV0(25:11)
 20519     CALL 'kxdfhei1' USING DFHEIV0,
 20520           PDEF-ID,
 20521           PRODUCT-MASTER,
 20522           DFHEIV12,
 20523           ERPDEF-KEY,
 20524           DFHEIV99,
 20525           DFHEIV11,
 20526           DFHEIV99,
 20527           DFHEIV99
 20528     MOVE EIBRESP  TO WS-RESPONSE
 20529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20530     IF WS-RESP-NORMAL
 20531        MOVE 'Y'                 TO PDEF-MASTER-SW
 20532     ELSE
 20533        MOVE 'N'                 TO PDEF-MASTER-SW
 20534     END-IF
 20535     .
 20536 8588-EXIT.
 20537     EXIT.
 20538 8589-ENDBR-ERPDEF.
 20539
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 379
* EL050.cbl
 20540* EXEC CICS ENDBR
 20541*       DATASET   (PDEF-ID)
 20542*    END-EXEC
 20543     MOVE 0
 20544       TO DFHEIV11
 20545*    MOVE '&2                    $   #00019284' TO DFHEIV0
 20546     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20547     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20548     MOVE X'2020233030303139323834' TO DFHEIV0(25:11)
 20549     CALL 'kxdfhei1' USING DFHEIV0,
 20550           PDEF-ID,
 20551           DFHEIV11,
 20552           DFHEIV99
 20553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20554     .
 20555 8589-EXIT.
 20556     EXIT.
 20557 8590-READ-CERT-MASTER.
 20558     IF PB-COMPANY-ID = 'UCL'
 20559         GO TO 8690-READ-CERT-MASTER-UCL.
 20560
 20561
 20562* EXEC CICS HANDLE CONDITION
 20563*         NOTFND    (0299-CERT-NOT-FOUND)
 20564*    END-EXEC.
 20565*    MOVE '"$I                   ! ; #00019294' TO DFHEIV0
 20566     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20568     MOVE X'3B20233030303139323934' TO DFHEIV0(25:11)
 20569     CALL 'kxdfhei1' USING DFHEIV0
 20570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20571
 20572
 20573
 20574* EXEC CICS READ
 20575*        DATASET     (CERT-ID)
 20576*        INTO        (CERTIFICATE-MASTER)
 20577*        RIDFLD      (ELCERT-KEY)
 20578*        UPDATE
 20579*    END-EXEC.
 20580     MOVE LENGTH OF
 20581      CERTIFICATE-MASTER
 20582       TO DFHEIV11
 20583*    MOVE '&"IL       EU         (   #00019298' TO DFHEIV0
 20584     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20585     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20586     MOVE X'2020233030303139323938' TO DFHEIV0(25:11)
 20587     CALL 'kxdfhei1' USING DFHEIV0,
 20588           CERT-ID,
 20589           CERTIFICATE-MASTER,
 20590           DFHEIV11,
 20591           ELCERT-KEY,
 20592           DFHEIV99,
 20593           DFHEIV99,
 20594           DFHEIV99
 20595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20596
 20597
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 380
* EL050.cbl
 20598 8590-EXIT.
 20599     EXIT.
 20600
 20601 8690-READ-CERT-MASTER-UCL.
 20602
 20603* EXEC CICS HANDLE CONDITION
 20604*         NOTFND    (8700-READ-CERT-MASTER)
 20605*    END-EXEC.
 20606*    MOVE '"$I                   ! < #00019309' TO DFHEIV0
 20607     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20608     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20609     MOVE X'3C20233030303139333039' TO DFHEIV0(25:11)
 20610     CALL 'kxdfhei1' USING DFHEIV0
 20611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20612
 20613
 20614 8690-READ-CERT-CONT.
 20615
 20616* EXEC CICS READ
 20617*        DATASET     (CERT-ID)
 20618*        INTO        (CERTIFICATE-MASTER)
 20619*        RIDFLD      (ELCERT-KEY)
 20620*        UPDATE
 20621*    END-EXEC.
 20622     MOVE LENGTH OF
 20623      CERTIFICATE-MASTER
 20624       TO DFHEIV11
 20625*    MOVE '&"IL       EU         (   #00019314' TO DFHEIV0
 20626     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20627     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20628     MOVE X'2020233030303139333134' TO DFHEIV0(25:11)
 20629     CALL 'kxdfhei1' USING DFHEIV0,
 20630           CERT-ID,
 20631           CERTIFICATE-MASTER,
 20632           DFHEIV11,
 20633           ELCERT-KEY,
 20634           DFHEIV99,
 20635           DFHEIV99,
 20636           DFHEIV99
 20637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20638
 20639
 20640     GO TO 8590-EXIT.
 20641
 20642 8700-READ-CERT-MASTER.
 20643     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20644     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20645
 20646* EXEC CICS HANDLE CONDITION
 20647*         DUPKEY    (8720-COMP-ACCOUNTS)
 20648*         ENDFILE   (8730-END-BROWSE)
 20649*         NOTFND    (8740-NOT-FOUND)
 20650*    END-EXEC.
 20651*    MOVE '"$$''I                 ! = #00019326' TO DFHEIV0
 20652     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20653     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20654     MOVE X'3D20233030303139333236' TO DFHEIV0(25:11)
 20655     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 381
* EL050.cbl
 20656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20657
 20658
 20659
 20660* EXEC CICS STARTBR
 20661*        DATASET     ('ELCERT5')
 20662*        RIDFLD      (ELCERT2-KEY)
 20663*        EQUAL
 20664*    END-EXEC.
 20665     MOVE 'ELCERT5' TO DFHEIV1
 20666     MOVE 0
 20667       TO DFHEIV11
 20668*    MOVE '&,         E          &   #00019332' TO DFHEIV0
 20669     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20670     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20671     MOVE X'2020233030303139333332' TO DFHEIV0(25:11)
 20672     CALL 'kxdfhei1' USING DFHEIV0,
 20673           DFHEIV1,
 20674           ELCERT2-KEY,
 20675           DFHEIV99,
 20676           DFHEIV11,
 20677           DFHEIV99
 20678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20679
 20680
 20681 8710-READ-NEXT.
 20682
 20683* EXEC CICS READNEXT
 20684*        DATASET     ('ELCERT5')
 20685*        INTO        (CERTIFICATE-MASTER)
 20686*        RIDFLD      (ELCERT2-KEY)
 20687*    END-EXEC.
 20688     MOVE LENGTH OF
 20689      CERTIFICATE-MASTER
 20690       TO DFHEIV12
 20691     MOVE 'ELCERT5' TO DFHEIV1
 20692     MOVE 0
 20693       TO DFHEIV11
 20694*    MOVE '&.IL                  )   #00019339' TO DFHEIV0
 20695     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20696     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20697     MOVE X'2020233030303139333339' TO DFHEIV0(25:11)
 20698     CALL 'kxdfhei1' USING DFHEIV0,
 20699           DFHEIV1,
 20700           CERTIFICATE-MASTER,
 20701           DFHEIV12,
 20702           ELCERT2-KEY,
 20703           DFHEIV99,
 20704           DFHEIV11,
 20705           DFHEIV99,
 20706           DFHEIV99
 20707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20708
 20709
 20710 8720-COMP-ACCOUNTS.
 20711
 20712* EXEC CICS ENTER
 20713*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 382
* EL050.cbl
 20714*         FROM (PB-C-LAST-NAME)
 20715*    END-EXEC.
 20716     MOVE 001
 20717       TO DFHEIV11
 20718*    MOVE ':$F                   %   #00019346' TO DFHEIV0
 20719     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20720     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20721     MOVE X'2020233030303139333436' TO DFHEIV0(25:11)
 20722     CALL 'kxdfhei1' USING DFHEIV0,
 20723           DFHEIV11,
 20724           PB-C-LAST-NAME,
 20725           DFHEIV99,
 20726           DFHEIV99
 20727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20728
 20729
 20730
 20731* EXEC CICS ENTER
 20732*         TRACEID (002)
 20733*         FROM (CM-INSURED-LAST-NAME)
 20734*    END-EXEC.
 20735     MOVE 002
 20736       TO DFHEIV11
 20737*    MOVE ':$F                   %   #00019351' TO DFHEIV0
 20738     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20739     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20740     MOVE X'2020233030303139333531' TO DFHEIV0(25:11)
 20741     CALL 'kxdfhei1' USING DFHEIV0,
 20742           DFHEIV11,
 20743           CM-INSURED-LAST-NAME,
 20744           DFHEIV99,
 20745           DFHEIV99
 20746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20747
 20748
 20749     IF PB-CERT-NO NOT = CM-CERT-NO
 20750         GO TO 8730-END-BROWSE.
 20751
 20752     IF PB-ACCOUNT = CM-ACCOUNT
 20753         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20754             MOVE ER-2799        TO WS-ERROR
 20755             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20756             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20757             GO TO 8730-END-BROWSE.
 20758
 20759     GO TO 8710-READ-NEXT.
 20760
 20761 8730-END-BROWSE.
 20762
 20763* EXEC CICS ENDBR
 20764*         DATASET    ('ELCERT5')
 20765*    END-EXEC.
 20766     MOVE 'ELCERT5' TO DFHEIV1
 20767     MOVE 0
 20768       TO DFHEIV11
 20769*    MOVE '&2                    $   #00019369' TO DFHEIV0
 20770     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20771     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 383
* EL050.cbl
 20772     MOVE X'2020233030303139333639' TO DFHEIV0(25:11)
 20773     CALL 'kxdfhei1' USING DFHEIV0,
 20774           DFHEIV1,
 20775           DFHEIV11,
 20776           DFHEIV99
 20777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20778
 20779
 20780 8740-NOT-FOUND.
 20781     GO TO 0299-CERT-NOT-FOUND.
 20782
 20783 8750-START-ELSTAT.
 20784
 20785* EXEC CICS STARTBR
 20786*       DATASET   (STAT-ID)
 20787*       RIDFLD    (ELSTAT-KEY)
 20788*       GTEQ
 20789*       RESP      (WS-RESPONSE)
 20790*    END-EXEC
 20791     MOVE 0
 20792       TO DFHEIV11
 20793*    MOVE '&,         G          &  N#00019377' TO DFHEIV0
 20794     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20795     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20796     MOVE X'204E233030303139333737' TO DFHEIV0(25:11)
 20797     CALL 'kxdfhei1' USING DFHEIV0,
 20798           STAT-ID,
 20799           ELSTAT-KEY,
 20800           DFHEIV99,
 20801           DFHEIV11,
 20802           DFHEIV99
 20803     MOVE EIBRESP  TO WS-RESPONSE
 20804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20805     IF WS-RESP-NORMAL
 20806        MOVE 'Y'                 TO STAT-MASTER-SW
 20807     ELSE
 20808        MOVE 'N'                 TO STAT-MASTER-SW
 20809     END-IF
 20810     .
 20811 8750-EXIT.
 20812     EXIT.
 20813 8752-READ-ELSTAT.
 20814
 20815* EXEC CICS READNEXT
 20816*       DATASET   (STAT-ID)
 20817*       RIDFLD    (ELSTAT-KEY)
 20818*       INTO      (STATE-FILE)
 20819*       RESP      (WS-RESPONSE)
 20820*    END-EXEC
 20821     MOVE LENGTH OF
 20822      STATE-FILE
 20823       TO DFHEIV12
 20824     MOVE 0
 20825       TO DFHEIV11
 20826*    MOVE '&.IL                  )  N#00019392' TO DFHEIV0
 20827     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20828     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20829     MOVE X'204E233030303139333932' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 384
* EL050.cbl
 20830     CALL 'kxdfhei1' USING DFHEIV0,
 20831           STAT-ID,
 20832           STATE-FILE,
 20833           DFHEIV12,
 20834           ELSTAT-KEY,
 20835           DFHEIV99,
 20836           DFHEIV11,
 20837           DFHEIV99,
 20838           DFHEIV99
 20839     MOVE EIBRESP  TO WS-RESPONSE
 20840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20841     IF WS-RESP-NORMAL
 20842        MOVE 'Y'                 TO STAT-MASTER-SW
 20843     ELSE
 20844        MOVE 'N'                 TO STAT-MASTER-SW
 20845     END-IF
 20846     .
 20847 8752-EXIT.
 20848     EXIT.
 20849 8800-GET-COMP-RATE.
 20850     MOVE +1 TO IB.
 20851     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20852         ADD +9 TO IB
 20853         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20854             ADD +9 TO IB
 20855             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20856                MOVE ZEROS       TO WS-WK-RATE
 20857                GO TO 8800-EXIT.
 20858
 20859     IF PB-I-AGE GREATER CT-AGE (1)
 20860         ADD +3 TO IB
 20861         IF PB-I-AGE GREATER CT-AGE (2)
 20862             ADD +3 TO IB
 20863             IF PB-I-AGE GREATER CT-AGE (3)
 20864                MOVE ZEROS       TO WS-WK-RATE
 20865                GO TO 8800-EXIT.
 20866
 20867     IF WS-WORK-TERM GREATER CT-TRM (1)
 20868         ADD +1 TO IB
 20869         IF WS-WORK-TERM GREATER CT-TRM (2)
 20870             ADD +1 TO IB
 20871             IF WS-WORK-TERM GREATER CT-TRM (3)
 20872                MOVE ZEROS       TO WS-WK-RATE
 20873                GO TO 8800-EXIT.
 20874
 20875     IF CT-RT (IB) NOT NUMERIC
 20876         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20877         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20878         GO TO 8800-GET-COMP-RATE.
 20879
 20880     MOVE CT-RT (IB) TO WS-WK-RATE.
 20881
 20882 8800-EXIT.
 20883     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 385
* EL050.cbl
 20885 8900-ADDRESS-FILE.
 20886     IF ERACCT-FILE-ADDRESSED
 20887         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20888         GO TO 8900-ADDRESS-EXIT.
 20889
 20890     IF ELCNTL-FILE-ADDRESSED
 20891         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20892         GO TO 8900-ADDRESS-EXIT.
 20893
 20894     IF ERPLAN-FILE-ADDRESSED
 20895         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20896         GO TO 8900-ADDRESS-EXIT.
 20897
 20898     IF ERFORM-FILE-ADDRESSED
 20899         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20900         GO TO 8900-ADDRESS-EXIT.
 20901
 20902 8900-ADDRESS-EXIT.
 20903     EXIT.
 20904
 20905 9000-READ-CONTROL.
 20906
 20907* EXEC CICS HANDLE CONDITION
 20908*        NOTFND    (9000-NOTFND)
 20909*    END-EXEC.
 20910*    MOVE '"$I                   ! > #00019463' TO DFHEIV0
 20911     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20913     MOVE X'3E20233030303139343633' TO DFHEIV0(25:11)
 20914     CALL 'kxdfhei1' USING DFHEIV0
 20915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20916
 20917
 20918
 20919* EXEC CICS READ
 20920*        DATASET     (CNTL-ID)
 20921*        SET         (ADDRESS OF CONTROL-FILE)
 20922*        RIDFLD      (ELCNTL-KEY)
 20923*        GTEQ
 20924*    END-EXEC.
 20925*    MOVE '&"S        G          (   #00019467' TO DFHEIV0
 20926     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20927     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20928     MOVE X'2020233030303139343637' TO DFHEIV0(25:11)
 20929     CALL 'kxdfhei1' USING DFHEIV0,
 20930           CNTL-ID,
 20931           DFHEIV20,
 20932           DFHEIV99,
 20933           ELCNTL-KEY,
 20934           DFHEIV99,
 20935           DFHEIV99,
 20936           DFHEIV99
 20937     SET ADDRESS OF CONTROL-FILE TO
 20938         DFHEIV20
 20939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20940
 20941
 20942     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 386
* EL050.cbl
 20943
 20944 9000-NOTFND.
 20945     IF RC-SW-1 = '1'
 20946        MOVE ER-2616              TO WS-ERROR
 20947        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20948        GO TO 9000-EXIT.
 20949
 20950     IF RC-SW-1 = '2'
 20951        MOVE ER-2602              TO WS-ERROR
 20952        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20953
 20954 9000-EXIT.
 20955      EXIT.
 20956
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 387
* EL050.cbl
 20958 9100-READ-CONTROL.
 20959
 20960* EXEC CICS HANDLE CONDITION
 20961*        NOTFND  (9100-NOTFND)
 20962*        ENDFILE (9100-NOTFND)
 20963*    END-EXEC.
 20964*    MOVE '"$I''                  ! ? #00019491' TO DFHEIV0
 20965     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20966     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20967     MOVE X'3F20233030303139343931' TO DFHEIV0(25:11)
 20968     CALL 'kxdfhei1' USING DFHEIV0
 20969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20970
 20971
 20972
 20973* EXEC CICS READ
 20974*        DATASET     (CNTL-ID)
 20975*        INTO        (CONTROL-FILE)
 20976*        RIDFLD      (ELCNTL-KEY)
 20977*        GTEQ
 20978*    END-EXEC.
 20979     MOVE LENGTH OF
 20980      CONTROL-FILE
 20981       TO DFHEIV11
 20982*    MOVE '&"IL       G          (   #00019496' TO DFHEIV0
 20983     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20985     MOVE X'2020233030303139343936' TO DFHEIV0(25:11)
 20986     CALL 'kxdfhei1' USING DFHEIV0,
 20987           CNTL-ID,
 20988           CONTROL-FILE,
 20989           DFHEIV11,
 20990           ELCNTL-KEY,
 20991           DFHEIV99,
 20992           DFHEIV99,
 20993           DFHEIV99
 20994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20995
 20996
 20997     GO TO 9100-EXIT.
 20998
 20999 9100-NOTFND.
 21000     IF RC-SW-2 = '0'
 21001        MOVE '1'                  TO STATE-RECORD-ERROR
 21002        GO TO 9100-EXIT
 21003     END-IF
 21004     IF RC-SW-2 = '1'
 21005        MOVE '1'                  TO LF-BENEFIT-ERROR
 21006        MOVE ER-2604              TO WS-ERROR
 21007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21008        GO TO 9100-EXIT.
 21009
 21010     IF RC-SW-2 = '2'
 21011        MOVE '1'                  TO AH-BENEFIT-ERROR
 21012        MOVE ER-2605              TO WS-ERROR
 21013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21014        GO TO 9100-EXIT.
 21015
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 388
* EL050.cbl
 21016     IF RC-SW-2 = '3'
 21017         MOVE ER-2603           TO WS-ERROR
 21018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21019         GO TO 9100-EXIT.
 21020
 21021     IF RC-SW-2 = '4'
 21022         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21023         GO TO 9100-EXIT.
 21024
 21025     IF RC-SW-2 = '5'
 21026         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21027         IF WS-AH-INPUT-CD-1 = SPACE
 21028             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21029         ELSE
 21030             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21031
 21032 9100-EXIT.
 21033      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 389
* EL050.cbl
 21035 9200-CONTROL-GETMAIN.
 21036
 21037* EXEC CICS GETMAIN
 21038*         LENGTH   (750)
 21039*         SET      (ADDRESS OF CONTROL-FILE)
 21040*    END-EXEC.
 21041     MOVE 750
 21042       TO DFHEIV11
 21043*    MOVE '," L                  $   #00019542' TO DFHEIV0
 21044     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21045     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21046     MOVE X'2020233030303139353432' TO DFHEIV0(25:11)
 21047     CALL 'kxdfhei1' USING DFHEIV0,
 21048           DFHEIV20,
 21049           DFHEIV11,
 21050           DFHEIV99
 21051     SET ADDRESS OF CONTROL-FILE TO
 21052         DFHEIV20
 21053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21054
 21055
 21056     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21057
 21058 9200-EXIT.
 21059     EXIT.
 21060
 21061 9250-UNLOCK-RETURN.
 21062
 21063* EXEC CICS UNLOCK
 21064*        DATASET   (CERT-ID)
 21065*    END-EXEC.
 21066*    MOVE '&*                    #   #00019553' TO DFHEIV0
 21067     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21068     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21069     MOVE X'2020233030303139353533' TO DFHEIV0(25:11)
 21070     CALL 'kxdfhei1' USING DFHEIV0,
 21071           CERT-ID,
 21072           DFHEIV99
 21073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21074
 21075
 21076 9300-ABEND.
 21077     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21078
 21079
 21080* EXEC CICS LINK
 21081*        PROGRAM   ('EL004')
 21082*        COMMAREA  (WS-ERROR-LINE)
 21083*        LENGTH    (72)
 21084*    END-EXEC.
 21085     MOVE 'EL004' TO DFHEIV1
 21086     MOVE 72
 21087       TO DFHEIV11
 21088*    MOVE '."C                   (   #00019560' TO DFHEIV0
 21089     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21090     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21091     MOVE X'2020233030303139353630' TO DFHEIV0(25:11)
 21092     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 390
* EL050.cbl
 21093           DFHEIV1,
 21094           WS-ERROR-LINE,
 21095           DFHEIV11,
 21096           DFHEIV99,
 21097           DFHEIV99,
 21098           DFHEIV99,
 21099           DFHEIV99
 21100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21101
 21102
 21103     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21104
 21105
 21106* EXEC CICS ABEND
 21107*        ABCODE ('EL50')
 21108*    END-EXEC.
 21109     MOVE 'EL50' TO DFHEIV5
 21110*    MOVE '.,A                   "   #00019568' TO DFHEIV0
 21111     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21112     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21113     MOVE X'2020233030303139353638' TO DFHEIV0(25:11)
 21114     CALL 'kxdfhei1' USING DFHEIV0,
 21115           DFHEIV5
 21116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21117
 21118
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 391
* EL050.cbl
 21120
 21121******************************************************************
 21122*                                                                *
 21123*            E R R O R   F O R M A T   R O U T I N E             *
 21124*                                                                *
 21125******************************************************************
 21126
 21127 9900-ERROR-FORMAT.
 21128
 21129     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21130                    PB-COMMON-ERROR (2) OR
 21131                    PB-COMMON-ERROR (3) OR
 21132                    PB-COMMON-ERROR (4) OR
 21133                    PB-COMMON-ERROR (5) OR
 21134                    PB-COMMON-ERROR (6) OR
 21135                    PB-COMMON-ERROR (7) OR
 21136                    PB-COMMON-ERROR (8) OR
 21137                    PB-COMMON-ERROR (9) OR
 21138                    PB-COMMON-ERROR (10)
 21139        GO TO 9900-EXIT.
 21140
 21141     IF PB-NO-OF-ERRORS = +10
 21142        GO TO 9900-EXIT.
 21143
 21144     ADD +1  TO PB-NO-OF-ERRORS.
 21145     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21146                                       (PB-NO-OF-ERRORS).
 21147 9900-EXIT.
 21148     EXIT.
 21149
 21150 9990-RETURN.
 21151     IF BROWSE-STARTED
 21152
 21153* EXEC CICS ENDBR
 21154*            DATASET  (ACCT-ID)
 21155*       END-EXEC.
 21156     MOVE 0
 21157       TO DFHEIV11
 21158*    MOVE '&2                    $   #00019605' TO DFHEIV0
 21159     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21160     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21161     MOVE X'2020233030303139363035' TO DFHEIV0(25:11)
 21162     CALL 'kxdfhei1' USING DFHEIV0,
 21163           ACCT-ID,
 21164           DFHEIV11,
 21165           DFHEIV99
 21166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21167
 21168
 21169 9990-EXIT.
 21170     EXIT.
 21171
 21172
 21173****Check for CRTO record, add one if not found.
 21174 9991-CHECK-FOR-ELCRTO.
 21175
 21176* EXEC CICS HANDLE CONDITION
 21177*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 392
* EL050.cbl
 21178*         ENDFILE (9991-CRTO-NOT-FOUND)
 21179*     END-EXEC.
 21180*    MOVE '"$I''                  ! @ #00019615' TO DFHEIV0
 21181     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21183     MOVE X'4020233030303139363135' TO DFHEIV0(25:11)
 21184     CALL 'kxdfhei1' USING DFHEIV0
 21185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21186
 21187     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21188     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21189     MOVE +0                     TO ELCRTO-SEQ-NO
 21190
 21191
 21192* EXEC CICS READ
 21193*       DATASET   ('ELCRTO')
 21194*       INTO      (ORIGINAL-CERTIFICATE)
 21195*       RIDFLD    (ELCRTO-KEY)
 21196*       GTEQ
 21197*       RESP      (WS-RESPONSE)
 21198*    END-EXEC
 21199     MOVE LENGTH OF
 21200      ORIGINAL-CERTIFICATE
 21201       TO DFHEIV11
 21202     MOVE 'ELCRTO' TO DFHEIV1
 21203*    MOVE '&"IL       G          (  N#00019623' TO DFHEIV0
 21204     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21206     MOVE X'204E233030303139363233' TO DFHEIV0(25:11)
 21207     CALL 'kxdfhei1' USING DFHEIV0,
 21208           DFHEIV1,
 21209           ORIGINAL-CERTIFICATE,
 21210           DFHEIV11,
 21211           ELCRTO-KEY,
 21212           DFHEIV99,
 21213           DFHEIV99,
 21214           DFHEIV99
 21215     MOVE EIBRESP  TO WS-RESPONSE
 21216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21217
 21218     IF WS-RESP-NORMAL
 21219        AND (OC-CONTROL-PRIMARY (1:33) =
 21220                 PB-CONTROL-BY-ACCOUNT (1:33))
 21221        AND (OC-RECORD-TYPE =  'I')
 21222           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21223               GO TO 9991-CHECK-INDICATORS
 21224           ELSE
 21225               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21226               GO TO 9991-CRTO-ADD-REC
 21227           END-IF
 21228     END-IF.
 21229
 21230 9991-CRTO-NOT-FOUND.
 21231
 21232     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21233     MOVE 'OC'                TO OC-RECORD-ID
 21234     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21235                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 393
* EL050.cbl
 21236     MOVE +4096               TO OC-KEY-SEQ-NO.
 21237
 21238 9991-CRTO-ADD-REC.
 21239
 21240     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21241     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21242     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21243     MOVE 'I'                 TO OC-RECORD-TYPE
 21244     IF PB-ISSUE
 21245         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21246         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21247         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21248         MOVE PB-I-AGE               TO OC-INS-AGE
 21249         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21250         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21251         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21252         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21253         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21254         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21255         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21256         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21257         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21258         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21259         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21260         IF PB-I-JOINT-COMMISSION > +0
 21261             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21262         ELSE
 21263             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21264         END-IF
 21265         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21266         MOVE +0                     TO OC-LF-CANCEL-AMT
 21267                                        OC-LF-ITD-CANCEL-AMT
 21268         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21269         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21270         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21271         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21272         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21273         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21274         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21275         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21276         MOVE +0                     TO OC-AH-CANCEL-AMT
 21277                                        OC-AH-ITD-CANCEL-AMT
 21278         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21279         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21280         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21281     ELSE
 21282         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21283         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21284         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21285         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21286         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21287         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21288         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21289         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21290         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21291          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21292             MOVE SPACES             TO OC-LF-BENCD
 21293             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 394
* EL050.cbl
 21294                                        OC-LF-BEN-AMT
 21295                                        OC-LF-PRM-AMT
 21296                                        OC-LF-ALT-BEN-AMT
 21297                                        OC-LF-ALT-PRM-AMT
 21298                                        OC-LF-COMM-PCT
 21299                                        OC-LF-CANCEL-AMT
 21300             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21301             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21302         ELSE
 21303             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21304             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21305             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21306             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21307             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21308             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21309             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21310             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21311             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21312             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21313         END-IF
 21314         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21315         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21316          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21317             MOVE SPACES             TO OC-AH-BENCD
 21318             MOVE ZEROS              TO OC-AH-TERM
 21319                                        OC-AH-BEN-AMT
 21320                                        OC-AH-PRM-AMT
 21321                                        OC-AH-COMM-PCT
 21322                                        OC-AH-CANCEL-AMT
 21323                                        OC-AH-CP
 21324             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21325             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21326         ELSE
 21327             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21328             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21329             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21330             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21331             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21332             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21333             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21334             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21335             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21336         END-IF
 21337         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21338         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21339         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21340         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21341     END-IF
 21342     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21343
 21344     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21345
 21346
 21347* EXEC CICS READ
 21348*         DATASET   (FILE-ERMAIL)
 21349*         RIDFLD    (MA-CONTROL-PRIMARY)
 21350*         INTO      (MAILING-DATA)
 21351*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 395
* EL050.cbl
 21352*    END-EXEC
 21353     MOVE LENGTH OF
 21354      MAILING-DATA
 21355       TO DFHEIV11
 21356*    MOVE '&"IL       E          (  N#00019759' TO DFHEIV0
 21357     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21358     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21359     MOVE X'204E233030303139373539' TO DFHEIV0(25:11)
 21360     CALL 'kxdfhei1' USING DFHEIV0,
 21361           FILE-ERMAIL,
 21362           MAILING-DATA,
 21363           DFHEIV11,
 21364           MA-CONTROL-PRIMARY,
 21365           DFHEIV99,
 21366           DFHEIV99,
 21367           DFHEIV99
 21368     MOVE EIBRESP  TO WS-RESPONSE
 21369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21370
 21371     IF WS-RESP-NORMAL
 21372         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21373     END-IF.
 21374
 21375     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21376     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21377
 21378
 21379* EXEC CICS READ
 21380*         DATASET  (CRTT-ID)
 21381*         RIDFLD   (WS-ELCRTT-KEY)
 21382*         INTO     (CERTIFICATE-TRAILERS)
 21383*         RESP     (WS-RESPONSE)
 21384*    END-EXEC
 21385     MOVE LENGTH OF
 21386      CERTIFICATE-TRAILERS
 21387       TO DFHEIV11
 21388*    MOVE '&"IL       E          (  N#00019773' TO DFHEIV0
 21389     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21390     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21391     MOVE X'204E233030303139373733' TO DFHEIV0(25:11)
 21392     CALL 'kxdfhei1' USING DFHEIV0,
 21393           CRTT-ID,
 21394           CERTIFICATE-TRAILERS,
 21395           DFHEIV11,
 21396           WS-ELCRTT-KEY,
 21397           DFHEIV99,
 21398           DFHEIV99,
 21399           DFHEIV99
 21400     MOVE EIBRESP  TO WS-RESPONSE
 21401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21402
 21403     IF WS-RESP-NORMAL
 21404         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21405         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21406     END-IF.
 21407
 21408
 21409* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 396
* EL050.cbl
 21410*       DATASET   ('ELCRTO')
 21411*       FROM      (ORIGINAL-CERTIFICATE)
 21412*       RIDFLD    (OC-CONTROL-PRIMARY)
 21413*       RESP      (WS-RESPONSE)
 21414*    END-EXEC.
 21415     MOVE LENGTH OF
 21416      ORIGINAL-CERTIFICATE
 21417       TO DFHEIV11
 21418     MOVE 'ELCRTO' TO DFHEIV1
 21419*    MOVE '&$ L                  ''  N#00019785' TO DFHEIV0
 21420     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21421     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21422     MOVE X'204E233030303139373835' TO DFHEIV0(25:11)
 21423     CALL 'kxdfhei1' USING DFHEIV0,
 21424           DFHEIV1,
 21425           ORIGINAL-CERTIFICATE,
 21426           DFHEIV11,
 21427           OC-CONTROL-PRIMARY,
 21428           DFHEIV99,
 21429           DFHEIV99
 21430     MOVE EIBRESP  TO WS-RESPONSE
 21431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21432
 21433
 21434     GO TO 9991-EXIT.
 21435
 21436 9991-CHECK-INDICATORS.
 21437
 21438     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21439         GO TO 9991-EXIT
 21440     END-IF.
 21441
 21442     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21443         GO TO 9991-EXIT
 21444     END-IF.
 21445
 21446
 21447* EXEC CICS READ
 21448*       DATASET   ('ELCRTO')
 21449*       INTO      (ORIGINAL-CERTIFICATE)
 21450*       RIDFLD    (OC-CONTROL-PRIMARY)
 21451*       UPDATE
 21452*       RESP      (WS-RESPONSE)
 21453*    END-EXEC
 21454     MOVE LENGTH OF
 21455      ORIGINAL-CERTIFICATE
 21456       TO DFHEIV11
 21457     MOVE 'ELCRTO' TO DFHEIV1
 21458*    MOVE '&"IL       EU         (  N#00019804' TO DFHEIV0
 21459     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21461     MOVE X'204E233030303139383034' TO DFHEIV0(25:11)
 21462     CALL 'kxdfhei1' USING DFHEIV0,
 21463           DFHEIV1,
 21464           ORIGINAL-CERTIFICATE,
 21465           DFHEIV11,
 21466           OC-CONTROL-PRIMARY,
 21467           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 397
* EL050.cbl
 21468           DFHEIV99,
 21469           DFHEIV99
 21470     MOVE EIBRESP  TO WS-RESPONSE
 21471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21472     IF WS-RESP-NORMAL
 21473        IF PB-ISSUE
 21474          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21475          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21476          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21477          MOVE PB-I-AGE               TO OC-INS-AGE
 21478          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21479          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21480          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21481          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21482          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21483          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21484          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21485          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21486          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21487          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21488          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21489          IF PB-I-JOINT-COMMISSION > +0
 21490              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21491          ELSE
 21492              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21493          END-IF
 21494          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21495          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21496          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21497          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21498          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21499          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21500          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21501          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21502          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21503
 21504          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21505
 21506* EXEC CICS READ
 21507*             DATASET   (FILE-ERMAIL)
 21508*             RIDFLD    (MA-CONTROL-PRIMARY)
 21509*             INTO      (MAILING-DATA)
 21510*             RESP      (WS-RESPONSE)
 21511*         END-EXEC
 21512     MOVE LENGTH OF
 21513      MAILING-DATA
 21514       TO DFHEIV11
 21515*    MOVE '&"IL       E          (  N#00019844' TO DFHEIV0
 21516     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21517     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21518     MOVE X'204E233030303139383434' TO DFHEIV0(25:11)
 21519     CALL 'kxdfhei1' USING DFHEIV0,
 21520           FILE-ERMAIL,
 21521           MAILING-DATA,
 21522           DFHEIV11,
 21523           MA-CONTROL-PRIMARY,
 21524           DFHEIV99,
 21525           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 398
* EL050.cbl
 21526           DFHEIV99
 21527     MOVE EIBRESP  TO WS-RESPONSE
 21528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21529          IF WS-RESP-NORMAL
 21530             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21531          END-IF
 21532
 21533          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21534          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21535
 21536* EXEC CICS READ
 21537*             DATASET  (CRTT-ID)
 21538*             RIDFLD   (WS-ELCRTT-KEY)
 21539*             INTO     (CERTIFICATE-TRAILERS)
 21540*             RESP     (WS-RESPONSE)
 21541*         END-EXEC
 21542     MOVE LENGTH OF
 21543      CERTIFICATE-TRAILERS
 21544       TO DFHEIV11
 21545*    MOVE '&"IL       E          (  N#00019856' TO DFHEIV0
 21546     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21547     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21548     MOVE X'204E233030303139383536' TO DFHEIV0(25:11)
 21549     CALL 'kxdfhei1' USING DFHEIV0,
 21550           CRTT-ID,
 21551           CERTIFICATE-TRAILERS,
 21552           DFHEIV11,
 21553           WS-ELCRTT-KEY,
 21554           DFHEIV99,
 21555           DFHEIV99,
 21556           DFHEIV99
 21557     MOVE EIBRESP  TO WS-RESPONSE
 21558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21559          IF WS-RESP-NORMAL
 21560             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21561                               OC-INS-AGE-DEFAULT-FLAG
 21562             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21563                               OC-JNT-AGE-DEFAULT-FLAG
 21564          END-IF
 21565
 21566        ELSE
 21567          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21568             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21569             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21570             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21571          END-IF
 21572          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21573             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21574             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21575             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21576          END-IF
 21577          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21578        END-IF
 21579
 21580* EXEC CICS REWRITE
 21581*          DATASET   ('ELCRTO')
 21582*          FROM      (ORIGINAL-CERTIFICATE)
 21583*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 399
* EL050.cbl
 21584*       END-EXEC
 21585     MOVE LENGTH OF
 21586      ORIGINAL-CERTIFICATE
 21587       TO DFHEIV11
 21588     MOVE 'ELCRTO' TO DFHEIV1
 21589*    MOVE '&& L                  %  N#00019882' TO DFHEIV0
 21590     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21591     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21592     MOVE X'204E233030303139383832' TO DFHEIV0(25:11)
 21593     CALL 'kxdfhei1' USING DFHEIV0,
 21594           DFHEIV1,
 21595           ORIGINAL-CERTIFICATE,
 21596           DFHEIV11,
 21597           DFHEIV99
 21598     MOVE EIBRESP  TO WS-RESPONSE
 21599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21600     END-IF.
 21601
 21602 9991-EXIT.
 21603     EXIT.
 21604
 21605
 21606 9999-RETURN.
 21607     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21608
 21609
 21610* EXEC CICS RETURN
 21611*    END-EXEC.
 21612*    MOVE '.(                    ''   #00019896' TO DFHEIV0
 21613     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21614     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21615     MOVE X'2020233030303139383936' TO DFHEIV0(25:11)
 21616     CALL 'kxdfhei1' USING DFHEIV0,
 21617           DFHEIV99,
 21618           DFHEIV99,
 21619           DFHEIV99,
 21620           DFHEIV99,
 21621           DFHEIV99,
 21622           DFHEIV99
 21623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21624
 21625
 21626
 21627* GOBACK.
 21628     MOVE '9%                    "   ' TO DFHEIV0
 21629     MOVE 'EL050' TO DFHEIV1
 21630     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21631     GOBACK.
 21632
 21633 9999-DFHBACK SECTION.
 21634     MOVE '9%                    "   ' TO DFHEIV0
 21635     MOVE 'EL050' TO DFHEIV1
 21636     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21637     GOBACK.
 21638 9999-DFHEXIT.
 21639     IF DFHEIGDJ EQUAL 0001
 21640         NEXT SENTENCE
 21641     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 400
* EL050.cbl
 21642         GO TO 9300-ABEND,
 21643               3990-FILES-NOT-OPEN
 21644         DEPENDING ON DFHEIGDI
 21645     ELSE IF DFHEIGDJ EQUAL 3
 21646         GO TO 6610-START-BROWSE,
 21647               6630-ERRESS-PROBLEM,
 21648               6630-END-OF-FILE
 21649         DEPENDING ON DFHEIGDI
 21650     ELSE IF DFHEIGDJ EQUAL 4
 21651         GO TO 6630-END-OF-FILE,
 21652               6630-ERRESS-PROBLEM,
 21653               6630-ERRESS-PROBLEM,
 21654               6630-END-OF-FILE
 21655         DEPENDING ON DFHEIGDI
 21656     ELSE IF DFHEIGDJ EQUAL 5
 21657         GO TO 6630-END-OF-FILE,
 21658               6630-END-OF-FILE,
 21659               6630-ERRESS-PROBLEM,
 21660               6630-ERRESS-PROBLEM
 21661         DEPENDING ON DFHEIGDI
 21662     ELSE IF DFHEIGDJ EQUAL 6
 21663         GO TO 6660-START-BROWSE,
 21664               6690-ERRESC-PROBLEM,
 21665               6690-ERRESC-PROBLEM,
 21666               6690-END-OF-FILE
 21667         DEPENDING ON DFHEIGDI
 21668     ELSE IF DFHEIGDJ EQUAL 7
 21669         GO TO 6690-END-OF-FILE,
 21670               6690-ERRESC-PROBLEM,
 21671               6690-ERRESC-PROBLEM,
 21672               6690-END-OF-FILE
 21673         DEPENDING ON DFHEIGDI
 21674     ELSE IF DFHEIGDJ EQUAL 8
 21675         GO TO 6690-END-OF-FILE,
 21676               6690-ERRESC-PROBLEM,
 21677               6690-ERRESC-PROBLEM,
 21678               6690-END-OF-FILE
 21679         DEPENDING ON DFHEIGDI
 21680     ELSE IF DFHEIGDJ EQUAL 9
 21681         GO TO 7250-CONTINUE,
 21682               7250-CONTINUE
 21683         DEPENDING ON DFHEIGDI
 21684     ELSE IF DFHEIGDJ EQUAL 10
 21685         GO TO 7300-CONTINUE,
 21686               7300-CONTINUE
 21687         DEPENDING ON DFHEIGDI
 21688     ELSE IF DFHEIGDJ EQUAL 11
 21689         GO TO 8000-FREE-MAIN
 21690         DEPENDING ON DFHEIGDI
 21691     ELSE IF DFHEIGDJ EQUAL 12
 21692         GO TO 8100-NOTFND,
 21693               8100-NOTFND
 21694         DEPENDING ON DFHEIGDI
 21695     ELSE IF DFHEIGDJ EQUAL 13
 21696         GO TO 8110-NOTFND,
 21697               8110-NOTFND
 21698         DEPENDING ON DFHEIGDI
 21699     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 401
* EL050.cbl
 21700         GO TO 8130-EXIT
 21701         DEPENDING ON DFHEIGDI
 21702     ELSE IF DFHEIGDJ EQUAL 15
 21703         GO TO 8180-NOTFND
 21704         DEPENDING ON DFHEIGDI
 21705     ELSE IF DFHEIGDJ EQUAL 16
 21706         GO TO 8190-NOTFND
 21707         DEPENDING ON DFHEIGDI
 21708     ELSE IF DFHEIGDJ EQUAL 17
 21709         GO TO 8195-NOTFND
 21710         DEPENDING ON DFHEIGDI
 21711     ELSE IF DFHEIGDJ EQUAL 18
 21712         GO TO 8200-NOTFND
 21713         DEPENDING ON DFHEIGDI
 21714     ELSE IF DFHEIGDJ EQUAL 19
 21715         GO TO 8300-NOTFND,
 21716               8300-ERRESS-PROBLEM,
 21717               8300-ERRESS-PROBLEM,
 21718               8300-NOTFND
 21719         DEPENDING ON DFHEIGDI
 21720     ELSE IF DFHEIGDJ EQUAL 20
 21721         GO TO 8450-FORM-NOT-FOUND,
 21722               8450-FORM-NOT-FOUND
 21723         DEPENDING ON DFHEIGDI
 21724     ELSE IF DFHEIGDJ EQUAL 21
 21725         GO TO 0199-ACCT-NOT-FOUND,
 21726               0199-ACCT-NOT-FOUND
 21727         DEPENDING ON DFHEIGDI
 21728     ELSE IF DFHEIGDJ EQUAL 22
 21729         GO TO 0199-ACCT-NOT-FOUND,
 21730               0199-ACCT-NOT-FOUND
 21731         DEPENDING ON DFHEIGDI
 21732     ELSE IF DFHEIGDJ EQUAL 23
 21733         GO TO 8582-COMP-NOT-FOUND,
 21734               8582-COMP-NOT-FOUND
 21735         DEPENDING ON DFHEIGDI
 21736     ELSE IF DFHEIGDJ EQUAL 24
 21737         GO TO 8583-AGTC-NOT-FOUND,
 21738               8583-AGTC-NOT-FOUND
 21739         DEPENDING ON DFHEIGDI
 21740     ELSE IF DFHEIGDJ EQUAL 25
 21741         GO TO 8584-BXRF-NOT-FOUND,
 21742               8584-BXRF-NOT-FOUND
 21743         DEPENDING ON DFHEIGDI
 21744     ELSE IF DFHEIGDJ EQUAL 26
 21745         GO TO 8585-PLAN-NOT-FOUND,
 21746               8585-PLAN-NOT-FOUND
 21747         DEPENDING ON DFHEIGDI
 21748     ELSE IF DFHEIGDJ EQUAL 27
 21749         GO TO 0299-CERT-NOT-FOUND
 21750         DEPENDING ON DFHEIGDI
 21751     ELSE IF DFHEIGDJ EQUAL 28
 21752         GO TO 8700-READ-CERT-MASTER
 21753         DEPENDING ON DFHEIGDI
 21754     ELSE IF DFHEIGDJ EQUAL 29
 21755         GO TO 8720-COMP-ACCOUNTS,
 21756               8730-END-BROWSE,
 21757               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:04 Page 402
* EL050.cbl
 21758         DEPENDING ON DFHEIGDI
 21759     ELSE IF DFHEIGDJ EQUAL 30
 21760         GO TO 9000-NOTFND
 21761         DEPENDING ON DFHEIGDI
 21762     ELSE IF DFHEIGDJ EQUAL 31
 21763         GO TO 9100-NOTFND,
 21764               9100-NOTFND
 21765         DEPENDING ON DFHEIGDI
 21766     ELSE IF DFHEIGDJ EQUAL 32
 21767         GO TO 9991-CRTO-NOT-FOUND,
 21768               9991-CRTO-NOT-FOUND
 21769         DEPENDING ON DFHEIGDI.
 21770     MOVE '9%                    "   ' TO DFHEIV0
 21771     MOVE 'EL050' TO DFHEIV1
 21772     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21773     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39992     Code:       87764
