* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL689 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:10:07.
     7*                            VMOD=2.037
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*DATE-COMPILED.
    12*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
    13*
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   2
* EL689.cbl
    14******************************************************************
    15
    16* W-FILE-USED REFERENCE LIST:
    17* (1)  ELCNTL - COMPANY
    18* (2)  ELCNTL - LIFE BENEFIT
    19* (3)  ELCNTL - A&H BENEFIT
    20* (4)  ELCNTL - CARRIER
    21* (5)  MAIL
    22* (6)  ERACCT
    23* (7)  USED FOR SYSTEM VARIABLES ?
    24* (8)  ELCERT
    25* (9)  PENDING BUSINESS
    26* (10) COMPENSATION
    27* (11) ELCNTL - PROCESSOR DATA ?
    28* (12) ERCHEK
    29* (13) ERPYAJ
    30* (14) NOT USED
    31* (15) NOT USED
    32* (16) NOT USED
    33* (17) NOT USED
    34* (18) NOT USED
    35* (19) NOT USED
    36* (20) NOT USED
    37*
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 101501    2001100100006  SMVA  ADD USERID to screen header
    47*                                ADJUSTED REDEFINES EL689AI FILLER
    48* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    49* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    50* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    51* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    52* 092908    2008013100006  PEMA  MOVE VAR 154
    53* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    54* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    55* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    56* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    57* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    58* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    59* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    60* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    61* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    62* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    63* 122011  CR2011022800001  AJRA  NAPERSOFT
    64* 090612  IR2012090600001  AJRA  NAPERSOFT
    65* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    66* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    67* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    68* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    69* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    70* 011013  CR2012101700002  AJRA  CHECK REQ REASON CODE IND
    71* 012413  CR2013012100001  AJRA  ADD AUTO BILLING NOTE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   3
* EL689.cbl
    72******************************************************************
    73
    74 DATA DIVISION.
    75 WORKING-STORAGE SECTION.
    76 01  DFH-START PIC X(04).
    77 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    78 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    79                                   USAGE POINTER.
    80 77  FILLER  PIC X(32) VALUE '********************************'.
    81 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    82 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    83 01  P pointer.
    84 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    85 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    86 01  var-ptr pointer.
    87 01  env-var-len                 pic 9(4)  binary.
    88 01  rc                          pic 9(9)  binary.
    89 01  WS-KIXHOST                  PIC X(10).
    90 01  WS-KIXSYS.
    91     05  WS-KIX-FIL1             PIC X(10).
    92     05  WS-KIX-APPS             PIC X(10).
    93     05  WS-KIX-ENV              PIC X(10).
    94     05  WS-KIX-MYENV            PIC X(10).
    95     05  WS-KIX-SYS              PIC X(10).
    96 01 srch-commarea.
    97*                                copy ELCADLTRSPI.
    98******************************************************************
    99*                   C H A N G E   L O G
   100*
   101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   102*-----------------------------------------------------------------
   103*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   104* EFFECTIVE    NUMBER
   105*-----------------------------------------------------------------
   106* 060611    2011022800001  PEMA  NEW COPYBOOK
   107* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   108* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   109******************************************************************
   110****************************************
   111*  commarea for NaperSoft On Demand Admin services letters
   112*  (business logic input & output)
   113****************************************
   114     03  BL-INPUT.
   115         05  BL-DATA-SRCE        PIC X.
   116         05  BL-LETTER-ID        PIC XXXX.
   117         05  BL-CARRIER          PIC X.
   118         05  BL-GROUP            PIC X(6).
   119         05  BL-STATE            PIC XX.
   120         05  BL-ACCOUNT          PIC X(10).
   121         05  BL-EFF-DT           PIC X(10).
   122         05  BL-CERT-NO          PIC X(11).
   123         05  BL-BATCH-NO         PIC X(6).
   124         05  BL-BATCH-SEQ        PIC 9(8).
   125         05  BL-RESP-NO          PIC X(10).
   126         05  BL-NO-OF-COPIES     PIC 99.
   127         05  BL-PROC-ID          PIC XXXX.
   128         05  BL-COMP-ID          PIC XXX.
   129         05  BL-PRINT-NOW-SW     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   4
* EL689.cbl
   130         05  BL-ENC-CD           PIC XXX.
   131         05  BL-RESEND-DT        PIC X(10).
   132         05  BL-FOLLOW-UP-DT     PIC X(10).
   133         05  BL-ARCHIVE-NO       PIC 9(8).
   134         05  BL-FUNC             PIC X(8).
   135         05  BL-COMMENTS         PIC X(100).
   136         05  FILLER REDEFINES BL-COMMENTS.
   137             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   138             10  BL-LETTER-TO-ACCT PIC X.
   139             10  BL-LETTER-TO-BENE PIC X.
   140             10  BL-WRITE-ERARCH   PIC X.
   141                 88  ERARCH-QWS      VALUE 'Q'.
   142                 88  ERARCH-BATCH    VALUE 'B'.
   143                 88  ERARCH-TEMP     VALUE 'T'.
   144             10  BL-PROCESS-TYPE PIC X(07).
   145             10  BL-CERT-FORM-ID PIC X(05).
   146             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   147             10  BL-SOURCE-SCREEN PIC X(8).
   148             10  FILLER          PIC X(25).
   149     03  BL-OUTPUT.
   150         05  BL-STATUS                   PIC X.
   151             88  BL-OK                      VALUE "P".
   152             88  BL-FAIL                  VALUE "F".
   153         05  BL-MESSAGE          PIC X(50).
   154     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   155     03  FILLER                  PIC X(31).
   156 01  W-WORK-AREAS.
   157     12  FILLER                  PIC  X(18)
   158                                      VALUE 'PROGRAM WORK AREA:'.
   159
   160     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   161     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   162     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   163     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   164     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   165     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   166     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   167     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   168     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   169     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   170
   171     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   172     12  W-DIFFERENCE            PIC S9(07)V9(02)
   173                                            VALUE +0   COMP-3.
   174     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   175     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   176     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   177     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
   178     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   179     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   180     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   181     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   182     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   183     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   184     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   185     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   186     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   187     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   5
* EL689.cbl
   188     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   189     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   190     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   191     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   192     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   193     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   194     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   195     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   196     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   197     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   198     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   199                                            VALUE +0   COMP-3.
   200
   201     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   202     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   203         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   204     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   205     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   206     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   207     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   208     12  W-SAVE-REVISION         PIC  9(03) value 0.
   209     12  W-DISPLAY-3             PIC  9(03) value 0.
   210     12  W-DISPLAY-8             PIC  9(08) value 0.
   211     12  W-DISPLAY-7             PIC  9(07) value 0.
   212     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   213     12  W-EDIT-3-0              PIC  ZZ9.
   214     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   215     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   216     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   217     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   218
   219     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   220         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   221
   222     12  W-ARCH-SUPPRESS         PIC 99999999.
   223     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   224                                 PIC  X(08).
   225     12  W-COMP-WORK-AREA.
   226         16  W-CWA-CHAR OCCURS 10 TIMES
   227                                 PIC  X(01).
   228     12  W-INCOMING-ARCHIVE      PIC  X(08).
   229     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   230                                 PIC  9(08).
   231
   232     12  W-BATCH-BREAKDOWN.
   233         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   234         16  W-BATCH-SEQ         PIC S9(04) COMP.
   235     12  W-BEN-HOLD              PIC  X(02).
   236     12  W-BENEFIT-WORK          PIC  X(03).
   237     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   238         16  W-ELIM-DAYS         PIC  X(02).
   239         16  FILLER              PIC  X(01).
   240     12  W-CALL-PGM              PIC  X(08).
   241     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   242
   243     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   244     12  W-LINE-CONTROL-RECORD.
   245         16  W-LC-LINE-WIDTH     PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   6
* EL689.cbl
   246         16  FILLER              PIC  X(01).
   247         16  W-LC-PARAGRAPH-INDENT
   248                                 PIC  9(02).
   249         16  FILLER              PIC  X(01).
   250         16  W-LC-MAX-LINES-PER-PAGE
   251                                 PIC  9(02).
   252         16  FILLER              PIC  X(01).
   253         16  W-LC-LINE-ADJUST    PIC  9(02).
   254         16  FILLER              PIC  X(01).
   255         16  W-LC-LINE-INDENT-1  PIC  9(02).
   256         16  FILLER              PIC  X(01).
   257         16  W-LC-LINE-INDENT-2  PIC  9(02).
   258         16  FILLER              PIC  X(01).
   259         16  W-LC-LINE-INDENT-3  PIC  9(02).
   260         16  FILLER              PIC  X(01).
   261         16  W-LC-LINE-INDENT-4  PIC  9(02).
   262         16  FILLER              PIC  X(01).
   263         16  W-LC-LINE-INDENT-5  PIC  9(02).
   264         16  FILLER              PIC  X(01).
   265         16  W-LC-TOP-MARGIN     PIC  9(02).
   266         16  FILLER              PIC  X(01).
   267         16  W-LC-CASE-IND       PIC  X(01).
   268             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   269         16  FILLER              PIC  X(01).
   270         16  W-LC-PAGE-IND       PIC  X(01).
   271             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   272     12  W-DATE-WORK             PIC  9(07).
   273     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   274         16  FILLER              PIC  X(02).
   275         16  W-DT-WORK           PIC  9(05).
   276
   277     12  W-DEEDIT-FIELD          PIC  X(15).
   278     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   279
   280     12  W-EDIT-DATE-1.
   281         16  W-ED1-MM            PIC  X(02).
   282         16  FILLER              PIC  X(01) VALUE '/'.
   283         16  W-ED1-DD            PIC  X(02).
   284         16  FILLER              PIC  X(01) VALUE '/'.
   285         16  W-ED1-YY            PIC  X(02).
   286
   287     12  W-EDIT-DATE-2.
   288         16  W-ED2-DD            PIC  X(02).
   289         16  FILLER              PIC  X(01) VALUE '/'.
   290         16  W-ED2-MM            PIC  X(02).
   291         16  FILLER              PIC  X(01) VALUE '/'.
   292         16  W-ED2-YY            PIC  X(02).
   293
   294     12  W-LABEL-HOLD-AREA.
   295         16  W-LABEL-LINES OCCURS 6 TIMES.
   296             20  W-LABEL-ZIP.
   297                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   298                 24  W-LABEL-DASH     PIC  X(01).
   299                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   300             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   301                 24  W-LAB-CAN-POSTAL-CD-1
   302                                      PIC  X(03).
   303                 24  W-LAB-CAN-DASH   PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   7
* EL689.cbl
   304                 24  W-LAB-CAN-POSTAL-CD-2
   305                                      PIC  X(03).
   306                 24  W-LAB-CAN-FILLER PIC  X(03).
   307             20  FILLER               PIC  X(10).
   308             20  W-LAST-ZIP.
   309                 24  W-LAST-1ST-ZIP   PIC  X(05).
   310                 24  W-LABEL-DASH-LAST
   311                                      PIC  X(01).
   312                 24  W-LAST-2ND-ZIP   PIC  X(04).
   313             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   314                 24  W-LAST-CAN-POSTAL-CD-1
   315                                      PIC  X(03).
   316                 24  W-LAST-CAN-DASH  PIC  X(01).
   317                 24  W-LAST-CAN-POSTAL-CD-2
   318                                      PIC  X(03).
   319                 24  W-LAST-CAN-FILLER
   320                                      PIC  X(03).
   321
   322     12  W-LAST-CHAR             PIC  X(01).
   323         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   324     12  W-LAST-SQ-CHAR          PIC  X(01).
   325
   326     12  W-LINE-NUM.
   327         16  W-LINE1             PIC  X(01).
   328         16  W-LINE23            PIC  9(02).
   329     12  W-LIN-NUM REDEFINES W-LINE-NUM
   330                                 PIC  9(03).
   331
   332     12  W-NAME-LAST             PIC  X(15).
   333     12  W-NAME-FIRST.
   334         16  W-NAME-FIRST-INIT   PIC  X(01).
   335         16  W-NAME-FIRST-REMAIN PIC  X(14).
   336     12  W-NAME-MIDDLE.
   337         16  FILLER              PIC  X(01).
   338         16  W-NAME-MIDDLE-2     PIC  X(01).
   339         16  FILLER              PIC  X(13).
   340
   341     12  W-PAGE-PRT.
   342         16  FILLER              PIC  X(34) VALUE SPACES.
   343         16  W-PAGE-NUMBER       PIC  Z9.
   344         16  FILLER              PIC  X(01) VALUE '.'.
   345         16  FILLER              PIC  X(33) VALUE SPACES.
   346
   347     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   348     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   349         16  FILLER              PIC  9(01).
   350         16  W-PHI-AREA          PIC  9(03).
   351         16  W-PHI-PFX           PIC  9(03).
   352         16  W-PHI-SFX           PIC  9(04).
   353     12  W-PHONE-OUT.
   354         16  W-PO-AREA           PIC  X(03).
   355         16  FILLER              PIC  X(01) VALUE '-'.
   356         16  W-PO-PFX            PIC  X(03).
   357         16  FILLER              PIC  X(01) VALUE '-'.
   358         16  W-PO-SFX            PIC  X(04).
   359
   360     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   361     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   8
* EL689.cbl
   362     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   363
   364     12  W-SINGLE-LINE           PIC  X(70).
   365     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   366         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   367                                 PIC  X(01).
   368
   369     12  W-SQUEEZED-LINE.
   370         16  W-SQ-CHAR OCCURS 70 TIMES
   371                       INDEXED BY W-SQ-NDX
   372                                 PIC  X(01).
   373
   374     12  W-TIME-IN               PIC S9(07).
   375     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   376         16  FILLER              PIC  X(01).
   377         16  W-TIME-OUT          PIC  99V9(02).
   378         16  FILLER              PIC  X(02).
   379
   380     12  W-TS-NAME-TEXT.
   381         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   382         16  W-TS-ID-TIME
   383             REDEFINES W-TS-ID-TEXT
   384                                 PIC S9(07) COMP-3.
   385         16  W-TS-TERM-TEXT.
   386             20 W-TS-TERM-PREFIX PIC  X(02).
   387             20 FILLER           PIC  X(02).
   388     12  W-TS-NAME-SCREEN.
   389         16  FILLER              PIC  X(04) VALUE '689X'.
   390         16  W-TS-TERM-SCREEN    PIC  X(04).
   391
   392     12  W-WORK-LINE.
   393         16  W-WORK-CHAR OCCURS 70 TIMES
   394                       INDEXED BY W-WC-NDX
   395                                  W-WC-NDX2
   396                                  W-WC-NDX3
   397                                 PIC  X(01).
   398
   399     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   400     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   401         16  W-WORK-ZIP5         PIC  X(05).
   402         16  W-WORK-ZIP4         PIC  X(04).
   403     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   404         16  W-CAN-POSTAL-CD-1.
   405             20  FILLER          PIC  X(01).
   406                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   407             20  FILLER          PIC  X(02).
   408         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   409         16  W-FILLER            PIC  X(03).
   410
   411**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   412*                   COPY ELCZREC.
   413******************************************************************
   414*                                                                *
   415*                                                                *
   416*                            ELCZREC.                            *
   417*                                                                *
   418*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   419*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   9
* EL689.cbl
   420******************************************************************
   421*-----------------------------------------------------------------
   422*                   C H A N G E   L O G
   423*
   424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   425*-----------------------------------------------------------------
   426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   427* EFFECTIVE    NUMBER
   428*-----------------------------------------------------------------
   429* 122011    2011022800001  AJRA  NEW FILE
   430* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   431* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   432*-----------------------------------------------------------------
   433 01  W-Z-CONTROL-DATA.
   434     05  W-NUMBER-OF-COPIES      PIC  9.
   435     05  FILLER                  PIC  X.
   436     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   437     05  FILLER                  PIC  X.
   438     05  W-DAYS-TO-RESEND        PIC  999.
   439     05  FILLER                  PIC  X.
   440     05  W-FORM-TO-RESEND        PIC  X(4).
   441     05  FILLER                  PIC  X.
   442     05  W-PROMPT-LETTER         PIC  X.
   443     05  FILLER                  PIC  X.
   444     05  W-ENCLOSURE-CD          PIC  XXX.
   445     05  FILLER                  PIC  X.
   446     05  W-AUTO-CLOSE-IND        PIC  X.
   447     05  FILLER                  PIC  X.
   448     05  W-LETTER-TO-BENE        PIC  X.
   449     05  FILLER                  PIC  X.
   450     05  W-LETTER-TO-ACCT        PIC  X.
   451     05  FILLER                  PIC  X.
   452     05  W-LETTER-TYPE           PIC  X.
   453     05  FILLER                  PIC  X.
   454     05  W-PRINT-CERTIFICATE     PIC  X.
   455     05  FILLER                  PIC  X.
   456     05  W-REFUND-REQUIRED       PIC  X.
   457     05  FILLER                  PIC  X.
   458     05  W-ONBASE-CODE           PIC  XX.
   459     05  FILLER                  PIC  X.
   460     05  W-ACCT-SUMM             PIC  X.
   461     05  FILLER                  PIC  X.
   462     05  W-CSO-SUMM              PIC  X.
   463     05  FILLER                  PIC  X.
   464     05  W-REASONS-REQUIRED      PIC  X.
   465     05  FILLER                  PIC  X(29).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  10
* EL689.cbl
   467 01  W-SWITCH-INDICATORS-AREA.
   468     12  FILLER                  PIC  X(16)
   469                                      VALUE 'PROGRAM SWITCHS:'.
   470     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   471         88  W-ADDRESS-ONLY      VALUE 'Y'.
   472         88  W-FULL-DATA         VALUE ' '.
   473     12  W-ACCT-BROWSE-STARTED-SW
   474                                 PIC  X(01) VALUE 'N'.
   475         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   476     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   477     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   478         88  W-CERT-FOUND                   VALUE 'Y'.
   479     12  W-CHARACTER-TYPE        PIC  X(01).
   480         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   481         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   482         88  W-SPACE             VALUE ' '.
   483     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   484         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   485     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   486         88  W-DATA-SHRINKING    VALUE 'Y'.
   487     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   488         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   489     12  W-FIRST-BAD-VARIABLE-IND
   490                                 PIC  X(01) VALUE SPACES.
   491         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   492     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   493         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   494         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   495     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   496         88  W-FORM-CHANGED                 VALUE 'Y'.
   497     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   498         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   499         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   500     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   501         88  W-HOLD-ON                      VALUE 'Y'.
   502         88  W-HOLD-OFF                     VALUE ' '.
   503     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   504         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   505         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   506     12  W-KEY-FIELDS-CHANGED-IND
   507                                 PIC  X(01) VALUE ' '.
   508         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   509         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   510     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   511         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   512     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   513         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   514                                                   'T' 'U'.
   515         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   516                                                   'G' 'H'.
   517         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   518         88  W-DO-NOT-ADJUST                VALUE 'N'.
   519         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   520         88  W-AS-IS                        VALUE 'A' 'N'.
   521         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   522                                                   '4' '5'.
   523
   524     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  11
* EL689.cbl
   525         88  W-PNDB-FOUND                   VALUE 'Y'.
   526     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   527         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   528     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   529         88  W-REVERSE-DATE                 VALUE 'Y'.
   530     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   531         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   532         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   533
   534     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   535         88  W-VALID-ENDT                   VALUE 'Y'.
   536     12  W-RESPONSE              PIC S9(8)   COMP.
   537         88  RESP-NORMAL                  VALUE +00.
   538         88  RESP-NOTFND                  VALUE +13.
   539         88  RESP-DUPREC                  VALUE +14.
   540         88  RESP-DUPKEY                  VALUE +15.
   541         88  RESP-NOTOPEN                 VALUE +19.
   542         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  12
* EL689.cbl
   544 01  WS-SAVE-AREA.
   545     12  WS-SAV-AM-DEFN-1.
   546         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   547             20  WS-SAV-AM-AGT             PIC  X(10).
   548             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   549             20  FILLER                    PIC  X(15).
   550     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   551     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   552     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   553     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   554     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   555     12  WS-SAV-AM-NAME                    PIC  X(30).
   556     12  WS-SAV-AM-PERSON                  PIC  X(30).
   557     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   558     12  WS-SAV-AM-CITY                    PIC  X(30).
   559     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   560     12  WS-SAV-AM-ZIP.
   561         16  WS-SAV-AM-ZIP-PRIME.
   562             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   563                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   564                     'A' THRU 'Z'.
   565             20  FILLER                    PIC  X(04).
   566         16  FILLER                        PIC  X(04).
   567     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   568                        WS-SAV-AM-ZIP      PIC  X(09).
   569     12  WS-SAV-AM-TEL-NO.
   570         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   571         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   572         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   573 01  W-KEY-AREAS.
   574     12  FILLER                    PIC  X(13)
   575                                      VALUE 'PROGRAM KEYS:'.
   576
   577     12  W-ACCT-SAVE-KEY           PIC  X(20).
   578     12  W-ACCT-KEY.
   579         16  W-ACCT-PARTIAL-KEY.
   580             20  W-ACCT-COMPANY-CD PIC  X(01).
   581             20  W-ACCT-CARRIER    PIC  X(01).
   582             20  W-ACCT-GROUPING   PIC  X(06).
   583             20  W-ACCT-STATE      PIC  X(02).
   584             20  W-ACCT-ACCOUNT    PIC  X(10).
   585         16  W-ACCT-EXP-DT         PIC  X(02).
   586
   587     12  W-ARCH-SAVE-KEY         PIC  X(05).
   588     12  W-ARCH-KEY.
   589         16  W-ARCH-PARTIAL-KEY.
   590             20  W-ARCH-COMPANY-CD
   591                                 PIC  X(01).
   592             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   593         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   594
   595     12  W-ARCT-KEY.
   596         16  W-ARCT-PARTIAL-KEY.
   597             20  W-ARCT-COMPANY-CD
   598                                 PIC  X(01).
   599             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   600         16  W-ARCT-REC-TYPE     PIC  X(01).
   601         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  13
* EL689.cbl
   602
   603     12  W-CERT-KEY.
   604         16  W-CERT-COMPANY-CD   PIC  X(01).
   605         16  W-CERT-CARRIER      PIC  X(01).
   606         16  W-CERT-GROUPING     PIC  X(06).
   607         16  W-CERT-STATE        PIC  X(02).
   608         16  W-CERT-ACCOUNT      PIC  X(10).
   609         16  W-CERT-EFF-DT       PIC  X(02).
   610         16  W-CERT-CERT-NO.
   611             20  W-CERT-CERT-PRIME
   612                                 PIC  X(10).
   613             20  W-CERT-CERT-SFX PIC  X(01).
   614
   615     12  W-CHEK-KEY.
   616         16  W-CHEK-COMPANY-CD   PIC  X(01).
   617         16  W-CHEK-CARRIER      PIC  X(01).
   618         16  W-CHEK-GROUPING     PIC  X(06).
   619         16  W-CHEK-STATE        PIC  X(02).
   620         16  W-CHEK-ACCOUNT      PIC  X(10).
   621         16  W-CHEK-EFF-DT       PIC  X(02).
   622         16  W-CHEK-CERT-NO.
   623             20  W-CHEK-CERT-PRIME
   624                                 PIC  X(10).
   625             20  W-CHEK-CERT-SFX PIC  X(01).
   626         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   627
   628     12  W-CNTL-KEY.
   629         16  W-CNTL-COMPANY-ID   PIC  X(03).
   630         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   631         16  W-CNTL-GENL.
   632             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   633             20  W-CNTL-GEN2.
   634                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   635                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   636         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   637
   638     12  W-COMP-SAVE-KEY         PIC  X(29).
   639     12  W-COMP-KEY.
   640         16  W-COMP-COMPANY-CD   PIC  X(01).
   641         16  W-COMP-CARRIER      PIC  X(01).
   642         16  W-COMP-GROUPING     PIC  X(06).
   643         16  W-COMP-RESP-PERSON.
   644             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   645                                INDEXED BY W-COMP-NDX
   646                                 PIC  X(01).
   647         16  W-COMP-ACCOUNT      PIC  X(10).
   648         16  W-COMP-TYPE         PIC  X(01).
   649
   650     12  W-DELETE-KEY.
   651         16  W-DELETE-PARTIAL-KEY.
   652             20  W-DELETE-COMPANY-CD
   653                                 PIC  X(01).
   654             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   655         16  W-DELETE-RECORD-TYPE
   656                                 PIC  X(01).
   657         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   658
   659     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  14
* EL689.cbl
   660         16  W-MAIL-COMPANY-CD   PIC  X(01).
   661         16  W-MAIL-CARRIER      PIC  X(01).
   662         16  W-MAIL-GROUPING     PIC  X(06).
   663         16  W-MAIL-STATE        PIC  X(02).
   664         16  W-MAIL-ACCOUNT      PIC  X(10).
   665         16  W-MAIL-EFF-DT       PIC  X(02).
   666         16  W-MAIL-CERT-NO.
   667             20  W-MAIL-CERT-PRIME
   668                                 PIC  X(10).
   669             20  W-MAIL-CERT-SFX PIC  X(01).
   670
   671     12  W-PNDB-KEY.
   672         16  W-PNDB-COMPANY-CD   PIC  X(01).
   673         16  W-PNDB-ENTRY        PIC  X(06).
   674         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   675         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   676
   677     12  W-PNDB2-KEY.
   678         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   679         16  W-PNDB2-CARRIER     PIC  X(01).
   680         16  W-PNDB2-GROUPING    PIC  X(06).
   681         16  W-PNDB2-STATE       PIC  X(02).
   682         16  W-PNDB2-ACCOUNT     PIC  X(10).
   683         16  W-PNDB2-EFF-DT      PIC  X(02).
   684         16  W-PNDB2-CERT-NO.
   685             20  W-PNDB2-CERT-PRIME
   686                                 PIC  X(10).
   687             20  W-PNDB2-CERT-SFX
   688                                 PIC  X(01).
   689         16  W-PNDB2-ALT-CHG-SEQ-NO
   690                                 PIC S9(04)  COMP.
   691         16  W-PNDB2-TYPE        PIC  X(01).
   692
   693     12  W-PYAJ-KEY.
   694         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   695         16  W-PYAJ-CARRIER      PIC  X(01).
   696         16  W-PYAJ-GROUPING     PIC  X(06).
   697         16  W-PYAJ-FIN-RESP     PIC  X(10).
   698         16  W-PYAJ-ACCOUNT      PIC  X(10).
   699         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   700         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   701
   702     12  W-SC-QUID-KEY.
   703         16  W-SC-QUID-TERMINAL  PIC  X(04).
   704         16  W-SC-QUID-SYSTEM    PIC  X(04).
   705
   706     12  W-TEXT-SAVE-KEY         PIC  X(05).
   707     12  W-TEXT-KEY.
   708         16  W-TEXT-PARTIAL-KEY.
   709             20  W-TEXT-COMPANY-CD
   710                                 PIC  X(01).
   711             20  W-TEXT-LETTER   PIC  X(04).
   712         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   713         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   714
   715     12  W-ERENDT-KEY-BY-ARCH.
   716         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   717         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  15
* EL689.cbl
   718
   719     12  W-ELEOBC-KEY.
   720         16  W-EOBC-COMPANY-CD   PIC X.
   721         16  W-EOBC-REC-TYPE     PIC X.
   722         16  W-EOBC-CODE         PIC X(4).
   723         16  FILLER              PIC X(9).
   724     12  W-ERNOTE-KEY.
   725         16  W-NOTE-COMPANY-CD   PIC X.
   726         16  W-NOTE-CARRIER      PIC X.
   727         16  W-NOTE-GROUPING     PIC X(6).
   728         16  W-NOTE-STATE        PIC XX.
   729         16  W-NOTE-ACCOUNT      PIC X(10).
   730         16  W-NOTE-CERT-EFF-DT  PIC XX.
   731         16  W-NOTE-CERT-PRIME   PIC X(10).
   732         16  W-NOTE-CERT-SFX     PIC X.
   733     12  W-SAVE-KEY.
   734         16  W-SV-COMPANY-CD     PIC X.
   735         16  W-SV-CARRIER        PIC X.
   736         16  W-SV-GROUPING       PIC X(6).
   737         16  W-SV-STATE          PIC XX.
   738         16  W-SV-ACCOUNT        PIC X(10).
   739         16  W-SV-CERT-EFF-DT    PIC XX.
   740         16  W-SV-CERT-PRIME     PIC X(10).
   741         16  W-SV-CERT-SFX       PIC X.
   742     12  W-BILLING-NOTE.
   743         16  W-BN-NOTE           PIC X(25).
   744         16  W-BN-LTRID          PIC X(4).
   745         16  FILLER              PIC X(3).
   746         16  W-BN-DATE           PIC X(8).
   747         16  FILLER              PIC X(3).
   748         16  W-BN-USERID         PIC X(4).
   749         16  FILLER              PIC X(30).
   750     12  W-LEN                   PIC S9(5) COMP-3 VALUE +0.
   751     12  NOTE-SUB                PIC S9(5) COMP-3 VALUE +0.
   752     12  W-CERT-UPDATE-SW        PIC X  VALUE ' '.
   753         88  NO-CERT-RW                 VALUE 'N'.
   754         88  CERT-RW                    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  16
* EL689.cbl
   756 01  FILLER                      PIC  X(22)
   757                                 VALUE 'INTERFACE AREA STARTS:'.
   758*    COPY ELCINTF.
   759******************************************************************
   760*                                                                *
   761*                                                                *
   762*                            ELCINTF.                            *
   763*                            VMOD=2.017                          *
   764*                                                                *
   765*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   766*                                                                *
   767*       LENGTH = 1024                                            *
   768*                                                                *
   769******************************************************************
   770*                   C H A N G E   L O G
   771*
   772* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   773*-----------------------------------------------------------------
   774*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   775* EFFECTIVE    NUMBER
   776*-----------------------------------------------------------------
   777* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   778******************************************************************
   779 01  PROGRAM-INTERFACE-BLOCK.
   780     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   781     12  PI-CALLING-PROGRAM              PIC X(8).
   782     12  PI-SAVED-PROGRAM-1              PIC X(8).
   783     12  PI-SAVED-PROGRAM-2              PIC X(8).
   784     12  PI-SAVED-PROGRAM-3              PIC X(8).
   785     12  PI-SAVED-PROGRAM-4              PIC X(8).
   786     12  PI-SAVED-PROGRAM-5              PIC X(8).
   787     12  PI-SAVED-PROGRAM-6              PIC X(8).
   788     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   789     12  PI-COMPANY-ID                   PIC XXX.
   790     12  PI-COMPANY-CD                   PIC X.
   791
   792     12  PI-COMPANY-PASSWORD             PIC X(8).
   793
   794     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   795
   796     12  PI-CONTROL-IN-PROGRESS.
   797         16  PI-CARRIER                  PIC X.
   798         16  PI-GROUPING                 PIC X(6).
   799         16  PI-STATE                    PIC XX.
   800         16  PI-ACCOUNT                  PIC X(10).
   801         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   802                                         PIC X(10).
   803         16  PI-CLAIM-CERT-GRP.
   804             20  PI-CLAIM-NO             PIC X(7).
   805             20  PI-CERT-NO.
   806                 25  PI-CERT-PRIME       PIC X(10).
   807                 25  PI-CERT-SFX         PIC X.
   808             20  PI-CERT-EFF-DT          PIC XX.
   809         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   810             20  PI-PLAN-CODE            PIC X(2).
   811             20  PI-REVISION-NUMBER      PIC X(3).
   812             20  PI-PLAN-EFF-DT          PIC X(2).
   813             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  17
* EL689.cbl
   814             20  FILLER                  PIC X(11).
   815         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   816             20  PI-OE-REFERENCE-1.
   817                 25  PI-OE-REF-1-PRIME   PIC X(18).
   818                 25  PI-OE-REF-1-SUFF    PIC XX.
   819
   820     12  PI-SESSION-IN-PROGRESS          PIC X.
   821         88  CLAIM-SESSION                   VALUE '1'.
   822         88  CREDIT-SESSION                  VALUE '2'.
   823         88  WARRANTY-SESSION                VALUE '3'.
   824         88  MORTGAGE-SESSION                VALUE '4'.
   825         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   826
   827
   828*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   829
   830     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   831     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   832
   833     12  PI-CREDIT-USER                  PIC X.
   834         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   835         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   836
   837     12  PI-CLAIM-USER                   PIC X.
   838         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   839         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   840
   841     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   842         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   843         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   844         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   845         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   846         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   847
   848     12  PI-PROCESSOR-ID                 PIC X(4).
   849
   850     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   851
   852     12  PI-MEMBER-CAPTION               PIC X(10).
   853
   854     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   855         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   856
   857     12  PI-LIFE-OVERRIDE-L1             PIC X.
   858     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   859     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   860     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   861
   862     12  PI-AH-OVERRIDE-L1               PIC X.
   863     12  PI-AH-OVERRIDE-L2               PIC XX.
   864     12  PI-AH-OVERRIDE-L6               PIC X(6).
   865     12  PI-AH-OVERRIDE-L12              PIC X(12).
   866
   867     12  PI-NEW-SYSTEM                   PIC X(2).
   868
   869     12  PI-PRIMARY-CERT-NO              PIC X(11).
   870     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   871         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  18
* EL689.cbl
   872     12  PI-CRDTCRD-SYSTEM.
   873         16  PI-CRDTCRD-USER             PIC X.
   874             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   875             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   876         16  PI-CC-MONTH-END-DT          PIC XX.
   877     12  PI-PROCESSOR-PRINTER            PIC X(4).
   878
   879     12  PI-OE-REFERENCE-2.
   880         16  PI-OE-REF-2-PRIME           PIC X(10).
   881         16  PI-OE-REF-2-SUFF            PIC X.
   882
   883     12  PI-REM-TRM-CALC-OPTION          PIC X.
   884
   885     12  PI-LANGUAGE-TYPE                PIC X.
   886             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   887             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   888             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   889
   890     12  PI-POLICY-LINKAGE-IND           PIC X.
   891         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   892         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   893                                                   LOW-VALUES.
   894
   895     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   896     12  PI-CLAIM-PW-SESSION             PIC X(1).
   897         88  PI-CLAIM-CREDIT                 VALUE '1'.
   898         88  PI-CLAIM-CONVEN                 VALUE '2'.
   899
   900     12  PI-PROCESSOR-CSR-IND            PIC X.
   901         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   902         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   903
   904     12  FILLER                          PIC X(3).
   905
   906     12  PI-SYSTEM-LEVEL                 PIC X(145).
   907
   908     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   909         PI-SYSTEM-LEVEL.
   910
   911         16  PI-ENTRY-CODES.
   912             20  PI-ENTRY-CD-1           PIC X.
   913             20  PI-ENTRY-CD-2           PIC X.
   914
   915         16  PI-RETURN-CODES.
   916             20  PI-RETURN-CD-1          PIC X.
   917             20  PI-RETURN-CD-2          PIC X.
   918
   919         16  PI-UPDATE-STATUS-SAVE.
   920             20  PI-UPDATE-BY            PIC X(4).
   921             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   922
   923         16  PI-LOWER-CASE-LETTERS       PIC X.
   924             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   925
   926*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   927*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   928*            88  CARRIER-CLM-CNTL            VALUE '2'.
   929
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  19
* EL689.cbl
   930         16  PI-CERT-ACCESS-CONTROL      PIC X.
   931             88  ST-ACCNT-CNTL               VALUE ' '.
   932             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   933             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   934             88  ACCNT-CNTL                  VALUE '3'.
   935             88  CARR-ACCNT-CNTL             VALUE '4'.
   936
   937         16  PI-PROCESSOR-CAP-LIST.
   938             20  PI-SYSTEM-CONTROLS.
   939                24 PI-SYSTEM-DISPLAY     PIC X.
   940                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   941                24 PI-SYSTEM-MODIFY      PIC X.
   942                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   943             20  FILLER                  PIC XX.
   944             20  PI-DISPLAY-CAP          PIC X.
   945                 88  DISPLAY-CAP             VALUE 'Y'.
   946             20  PI-MODIFY-CAP           PIC X.
   947                 88  MODIFY-CAP              VALUE 'Y'.
   948             20  PI-MSG-AT-LOGON-CAP     PIC X.
   949                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   950             20  PI-FORCE-CAP            PIC X.
   951                 88  FORCE-CAP               VALUE 'Y'.
   952
   953         16  PI-PROGRAM-CONTROLS.
   954             20  PI-PGM-PRINT-OPT        PIC X.
   955             20  PI-PGM-FORMAT-OPT       PIC X.
   956             20  PI-PGM-PROCESS-OPT      PIC X.
   957             20  PI-PGM-TOTALS-OPT       PIC X.
   958
   959         16  PI-HELP-INTERFACE.
   960             20  PI-LAST-ERROR-NO        PIC X(4).
   961             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   962
   963         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   964             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   965
   966         16  PI-CR-CONTROL-IN-PROGRESS.
   967             20  PI-CR-CARRIER           PIC X.
   968             20  PI-CR-GROUPING          PIC X(6).
   969             20  PI-CR-STATE             PIC XX.
   970             20  PI-CR-ACCOUNT           PIC X(10).
   971             20  PI-CR-FIN-RESP          PIC X(10).
   972             20  PI-CR-TYPE              PIC X.
   973
   974         16  PI-CR-BATCH-NUMBER          PIC X(6).
   975
   976         16  PI-CR-MONTH-END-DT          PIC XX.
   977
   978         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   979             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   980             88  PI-ZERO-CARRIER             VALUE '1'.
   981             88  PI-ZERO-GROUPING            VALUE '2'.
   982             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   983
   984         16  PI-CARRIER-SECURITY         PIC X.
   985             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   986
   987         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  20
* EL689.cbl
   988             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   989             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   990
   991         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   992             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   993                                         INDEXED BY PI-ACCESS-NDX
   994                                         PIC X.
   995
   996         16  PI-GA-BILLING-CONTROL       PIC X.
   997             88  PI-GA-BILLING               VALUE '1'.
   998
   999         16  PI-MAIL-PROCESSING          PIC X.
  1000             88  PI-MAIL-YES                 VALUE 'Y'.
  1001
  1002         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1003
  1004         16  PI-AR-SYSTEM.
  1005             20  PI-AR-PROCESSING-CNTL   PIC X.
  1006                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1007             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1008             20  PI-AR-MONTH-END-DT      PIC XX.
  1009
  1010         16  PI-MP-SYSTEM.
  1011             20  PI-MORTGAGE-USER            PIC X.
  1012                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1013                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1014             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1015                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1016                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1017                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1018                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1019                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1020             20  PI-MP-MONTH-END-DT          PIC XX.
  1021             20  PI-MP-REFERENCE-NO.
  1022                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1023                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1024
  1025         16  PI-LABEL-CONTROL            PIC X(01).
  1026             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1027             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1028
  1029         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1030             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1031
  1032         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1033             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1034             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1035
  1036         16  FILLER                      PIC X(14).
  1037
  1038     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1039******************************************************************
  1040     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1041*    COPY ELC1042.
  1042******************************************************************
  1043*                                                                *
  1044*                                                                *
  1045*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  21
* EL689.cbl
  1046*                            VMOD=2.002                          *
  1047*                                                                *
  1048*    NOTE                                                        *
  1049*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1050*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1051*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1052*        TO THESE PROGRAMS.                                      *
  1053*                                                                *
  1054*    NOTE                                                        *
  1055*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1056*        USE ONLY!                                               *
  1057*                                                                *
  1058******************************************************************
  1059
  1060         16  PI-1042-WA.
  1061             20  PI-ACTION       PIC  X(01).
  1062                 88 PI-SHOW-MODE           VALUE '1'.
  1063                 88 PI-CLEAR-MODE          VALUE '2'.
  1064                 88 PI-CREATE-MODE         VALUE '3'.
  1065             20  PI-COMM-CONTROL PIC  X(12).
  1066             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1067             20  PI-EOF-SW       PIC  X(01).
  1068                 88  PI-FILE-EOF           VALUE 'Y'.
  1069             20  PI-FILETYP      PIC  X(01).
  1070             20  PI-FORM-SQUEEZE-CONTROL
  1071                                 PIC  X(01).
  1072                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1073                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1074             20  PI-LAST-CONTROL PIC  X(12).
  1075             20  PI-TEMP-STOR-ITEMS
  1076                                 PIC S9(04) COMP.
  1077             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1078             20  PI-UPDATE-SW    PIC  9(01).
  1079                 88 ANY-UPDATES            VALUE 1.
  1080             20  PI-104-SCREEN-SENT-IND
  1081                                 PIC  X(01).
  1082                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1083                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1084             20  PI-1042-SCREEN-SENT-IND
  1085                                 PIC  X(01).
  1086                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1087                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1088             20  PI-1042-ARCHIVE-IND
  1089                                 PIC  X(01).
  1090                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1091             20  FILLER          PIC  X(29).
  1092*    COPY ELC689PI.
  1093******************************************************************
  1094*                                                                *
  1095*                            ELC689PI                            *
  1096*                            VMOD=2.003                          *
  1097*                                                                *
  1098*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1099*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1100*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1101*                                                                *
  1102*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1103*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  22
* EL689.cbl
  1104*    BETWEEN PROGRAMS.                                           *
  1105*                                                                *
  1106*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1107*                                                                *
  1108*               EL631 - EL689  - EL6891 - EL6892                 *
  1109*                                                                *
  1110******************************************************************
  1111*                   C H A N G E   L O G
  1112*
  1113* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1114*-----------------------------------------------------------------
  1115*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1116* EFFECTIVE    NUMBER
  1117*-----------------------------------------------------------------
  1118* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1119* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1120* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1121******************************************************************
  1122
  1123
  1124         16  PI-689-WORK-AREA.
  1125             20  PI-689-ALT-PRINTER-ID
  1126                                 PIC  X(04).
  1127             20  PI-689-ARCHIVE-NUMBER
  1128                                 PIC  9(08).
  1129             20  PI-689-ARCHIVE-SW
  1130                                 PIC  X(01).
  1131                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1132             20  PI-689-DATA-SOURCE
  1133                                 PIC  X(01).
  1134                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1135                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1136                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1137                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1138                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1139             20  PI-689-ERROR-IND
  1140                                 PIC  X(01).
  1141                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1142             20  PI-689-ERROR    PIC  9(04).
  1143                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1144                 88  PI-689-FATAL-ERROR
  1145                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1146                            0042 0047 0051 0066 0067 0070
  1147                            0168 0169 0174 0175 0176 0177 0179
  1148                            0180 0181 0182 0184 0185 0189 0190
  1149                            0191
  1150                            0215 0279 0280
  1151                            0412 0413 0454
  1152                            0533 0537
  1153                            2055 2114 2208 2209 2216 2232 2369
  1154                            2398 2433 2908 2999
  1155                            3000 3770 3771 3775
  1156                            7250 7365 7367 7368 7369 7370 7371
  1157                            7272 7373 7374 7376 7377 7378 7379
  1158                            7381 7388 7390 7393 7395 7396 7398
  1159                            9095 9096 9281 9298 9299 9320 9327
  1160                            9426 9427.
  1161                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  23
* EL689.cbl
  1162                     VALUES 0004 0008 0013 0023 0029 0033
  1163                            0042 0047 0066 0067 0070
  1164                            0168 0169 0174 0175 0176 0177
  1165                            0181 0182 0184 0185 0189 0190
  1166                            0279 0280
  1167                            0412 0413 0454
  1168                            2055 2208 2209 2216 2232
  1169                            2398 2999
  1170                            3000 3770 3771 3775
  1171                            7250 7365 7369 7370 7371
  1172                            7272 7373 7374 7376 7377 7378 7379
  1173                            7381 7388 7390 7393 7396 7398
  1174                            9095 9096 9299 9320 9426.
  1175             20  PI-689-FOLLOW-UP-DATE
  1176                                 PIC  X(02).
  1177             20  PI-689-FORM-NUMBER
  1178                                 PIC  X(04).
  1179             20  PI-689-LABEL-SOURCE
  1180                                 PIC X(01).
  1181                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1182                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1183                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1184                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1185                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1186                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1187                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1188             20  PI-689-NUMBER-COPIES
  1189                                 PIC  9(01).
  1190             20  PI-689-NUMBER-LABEL-LINES
  1191                                 PIC  9(01).
  1192             20  PI-689-NUMBER-TEXT-RECORDS
  1193                                 PIC  9(03).
  1194             20  PI-689-PRINT-ORDER-SW
  1195                                 PIC  X(01).
  1196                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1197                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1198                 88  PI-689-PRINT-LATER     VALUE '3'.
  1199                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1200             20  PI-689-PRINT-RESTRICTION
  1201                                 PIC  X(01).
  1202                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1203                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1204                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1205             20  PI-689-PRINT-SW PIC  X(01).
  1206                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1207             20  PI-689-RESEND-DATE-1
  1208                                 PIC  X(02).
  1209             20  PI-689-RESEND-LETR-1
  1210                                 PIC X(4).
  1211             20  PI-689-TEMP-STOR-ID
  1212                                 PIC  X(08).
  1213             20  PI-689-USE-SCREEN-IND
  1214                                 PIC  X(01).
  1215                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1216             20  PI-689-ARCH-POINTER
  1217                                 PIC S9(08) COMP.
  1218                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1219             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  24
* EL689.cbl
  1220                                 PIC S9(08) COMP.
  1221                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1222             20  PI-689-VARIABLE-DATA-GRP.
  1223                 24  PI-689-VARIABLE-DATA-1
  1224                                 PIC  X(30).
  1225                 24  PI-689-VARIABLE-DATA-2
  1226                                 PIC  X(30).
  1227                 24  PI-689-VARIABLE-DATA-3
  1228                                 PIC  X(30).
  1229                 24  PI-689-VARIABLE-DATA-4
  1230                                 PIC  X(30).
  1231
  1232         16  PI-689-KEY-DATA-FIELDS.
  1233             20  PI-689-ACCOUNT  PIC  X(10).
  1234             20  PI-689-CARRIER  PIC  X(01).
  1235             20  PI-689-CERT-NO.
  1236                 24  PI-689-CERT-PRIME
  1237                                 PIC  X(10).
  1238                 24  PI-689-CERT-SFX
  1239                                 PIC  X(01).
  1240             20  PI-689-CHG-SEQ-NO
  1241                                 PIC S9(04)    COMP.
  1242             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1243                                 PIC  X(02).
  1244             20  PI-689-ENTRY-BATCH
  1245                                 PIC  X(06).
  1246             20  PI-689-EFF-DATE PIC  X(02).
  1247             20  PI-689-EXP-DATE PIC  X(02).
  1248             20  PI-689-GROUPING PIC  X(06).
  1249             20  PI-689-RESP-PERSON
  1250                                 PIC  X(10).
  1251             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1252             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1253                                 PIC  X(04).
  1254             20  PI-689-STATE    PIC  X(02).
  1255             20  PI-689-TYPE     PIC  X(01).
  1256             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1257             20  PI-689-ALT-SEQ-NO
  1258                                 PIC S9(04)    COMP.
  1259         16  PI-689-DATE-EDIT    PIC  X(08).
  1260         16  PI-689-FOLLOW-UP-EDIT
  1261                                 PIC  X(08).
  1262         16  PI-689-RESEND1-EDIT PIC  X(08).
  1263         16  PI-689-SEQ-EDIT     PIC  X(08).
  1264         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1265         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1266             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1267         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1268         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1269         16  PI-PROMPT-IND       PIC X(1).
  1270         16  PI-CERT-FORM-ID     PIC X(5).
  1271         16  PI-PRINT-NOW        PIC X(1).
  1272         16  PI-ENCLOSURE-CD     PIC X(3).
  1273         16  PI-CERT-REQ-IND     PIC X(1).
  1274         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1275         16  PI-REASON-REQ-IND   PIC X(1).
  1276         16  FILLER              PIC X(244).
  1277*        16  FILLER                        PIC X(276).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  25
* EL689.cbl
  1278*        16  FILLER                        PIC X(280).
  1279
  1280 01  FILLER                      PIC  X(20)
  1281                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  26
* EL689.cbl
  1283 01  FILLER                      PIC  X(16)
  1284                        VALUE 'MAP AREA STARTS:'.
  1285*    COPY EL689S.
  1286 01  EL689AI.
  1287     05  FILLER            PIC  X(0012).
  1288*    -------------------------------
  1289     05  RUNDTEL PIC S9(0004) COMP.
  1290     05  RUNDTEF PIC  X(0001).
  1291     05  FILLER REDEFINES RUNDTEF.
  1292         10  RUNDTEA PIC  X(0001).
  1293     05  RUNDTEI PIC  X(0008).
  1294*    -------------------------------
  1295     05  RUNTIMEL PIC S9(0004) COMP.
  1296     05  RUNTIMEF PIC  X(0001).
  1297     05  FILLER REDEFINES RUNTIMEF.
  1298         10  RUNTIMEA PIC  X(0001).
  1299     05  RUNTIMEI PIC  X(0005).
  1300*    -------------------------------
  1301     05  HOSTL PIC S9(0004) COMP.
  1302     05  HOSTF PIC  X(0001).
  1303     05  FILLER REDEFINES HOSTF.
  1304         10  HOSTA PIC  X(0001).
  1305     05  HOSTI PIC  X(0010).
  1306*    -------------------------------
  1307     05  SYSL PIC S9(0004) COMP.
  1308     05  SYSF PIC  X(0001).
  1309     05  FILLER REDEFINES SYSF.
  1310         10  SYSA PIC  X(0001).
  1311     05  SYSI PIC  X(0008).
  1312*    -------------------------------
  1313     05  COMPANYL PIC S9(0004) COMP.
  1314     05  COMPANYF PIC  X(0001).
  1315     05  FILLER REDEFINES COMPANYF.
  1316         10  COMPANYA PIC  X(0001).
  1317     05  COMPANYI PIC  X(0003).
  1318*    -------------------------------
  1319     05  USERIDL PIC S9(0004) COMP.
  1320     05  USERIDF PIC  X(0001).
  1321     05  FILLER REDEFINES USERIDF.
  1322         10  USERIDA PIC  X(0001).
  1323     05  USERIDI PIC  X(0004).
  1324*    -------------------------------
  1325     05  MAINTL PIC S9(0004) COMP.
  1326     05  MAINTF PIC  X(0001).
  1327     05  FILLER REDEFINES MAINTF.
  1328         10  MAINTA PIC  X(0001).
  1329     05  MAINTI PIC  X(0001).
  1330*    -------------------------------
  1331     05  FORML PIC S9(0004) COMP.
  1332     05  FORMF PIC  X(0001).
  1333     05  FILLER REDEFINES FORMF.
  1334         10  FORMA PIC  X(0001).
  1335     05  FORMI PIC  X(0004).
  1336*    -------------------------------
  1337     05  ARCHNUML PIC S9(0004) COMP.
  1338     05  ARCHNUMF PIC  X(0001).
  1339     05  FILLER REDEFINES ARCHNUMF.
  1340         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  27
* EL689.cbl
  1341     05  ARCHNUMI PIC  99999999.
  1342*    -------------------------------
  1343     05  PRTNOWL PIC S9(0004) COMP.
  1344     05  PRTNOWF PIC  X(0001).
  1345     05  FILLER REDEFINES PRTNOWF.
  1346         10  PRTNOWA PIC  X(0001).
  1347     05  PRTNOWI PIC  X(0001).
  1348*    -------------------------------
  1349     05  CARRIERL PIC S9(0004) COMP.
  1350     05  CARRIERF PIC  X(0001).
  1351     05  FILLER REDEFINES CARRIERF.
  1352         10  CARRIERA PIC  X(0001).
  1353     05  CARRIERI PIC  X(0001).
  1354*    -------------------------------
  1355     05  GROUPL PIC S9(0004) COMP.
  1356     05  GROUPF PIC  X(0001).
  1357     05  FILLER REDEFINES GROUPF.
  1358         10  GROUPA PIC  X(0001).
  1359     05  GROUPI PIC  X(0006).
  1360*    -------------------------------
  1361     05  STATEL PIC S9(0004) COMP.
  1362     05  STATEF PIC  X(0001).
  1363     05  FILLER REDEFINES STATEF.
  1364         10  STATEA PIC  X(0001).
  1365     05  STATEI PIC  X(0002).
  1366*    -------------------------------
  1367     05  ACCTL PIC S9(0004) COMP.
  1368     05  ACCTF PIC  X(0001).
  1369     05  FILLER REDEFINES ACCTF.
  1370         10  ACCTA PIC  X(0001).
  1371     05  ACCTI PIC  X(0010).
  1372*    -------------------------------
  1373     05  CERTL PIC S9(0004) COMP.
  1374     05  CERTF PIC  X(0001).
  1375     05  FILLER REDEFINES CERTF.
  1376         10  CERTA PIC  X(0001).
  1377     05  CERTI PIC  X(0010).
  1378*    -------------------------------
  1379     05  SFXL PIC S9(0004) COMP.
  1380     05  SFXF PIC  X(0001).
  1381     05  FILLER REDEFINES SFXF.
  1382         10  SFXA PIC  X(0001).
  1383     05  SFXI PIC  X(0001).
  1384*    -------------------------------
  1385     05  TYPEL PIC S9(0004) COMP.
  1386     05  TYPEF PIC  X(0001).
  1387     05  FILLER REDEFINES TYPEF.
  1388         10  TYPEA PIC  X(0001).
  1389     05  TYPEI PIC  X(0001).
  1390*    -------------------------------
  1391     05  DATEL PIC S9(0004) COMP.
  1392     05  DATEF PIC  X(0001).
  1393     05  FILLER REDEFINES DATEF.
  1394         10  DATEA PIC  X(0001).
  1395     05  DATEI PIC  X(0008).
  1396*    -------------------------------
  1397     05  FOLLOWL PIC S9(0004) COMP.
  1398     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  28
* EL689.cbl
  1399     05  FILLER REDEFINES FOLLOWF.
  1400         10  FOLLOWA PIC  X(0001).
  1401     05  FOLLOWI PIC  X(0008).
  1402*    -------------------------------
  1403     05  RESEND1L PIC S9(0004) COMP.
  1404     05  RESEND1F PIC  X(0001).
  1405     05  FILLER REDEFINES RESEND1F.
  1406         10  RESEND1A PIC  X(0001).
  1407     05  RESEND1I PIC  X(0008).
  1408*    -------------------------------
  1409     05  ENCL PIC S9(0004) COMP.
  1410     05  ENCF PIC  X(0001).
  1411     05  FILLER REDEFINES ENCF.
  1412         10  ENCA PIC  X(0001).
  1413     05  ENCI PIC  X(0003).
  1414*    -------------------------------
  1415     05  ENDARCHL PIC S9(0004) COMP.
  1416     05  ENDARCHF PIC  X(0001).
  1417     05  FILLER REDEFINES ENDARCHF.
  1418         10  ENDARCHA PIC  X(0001).
  1419     05  ENDARCHI PIC  99999999.
  1420*    -------------------------------
  1421     05  CERTIDL PIC S9(0004) COMP.
  1422     05  CERTIDF PIC  X(0001).
  1423     05  FILLER REDEFINES CERTIDF.
  1424         10  CERTIDA PIC  X(0001).
  1425     05  CERTIDI PIC  X(0005).
  1426*    -------------------------------
  1427     05  ADDRSL PIC S9(0004) COMP.
  1428     05  ADDRSF PIC  X(0001).
  1429     05  FILLER REDEFINES ADDRSF.
  1430         10  ADDRSA PIC  X(0001).
  1431     05  ADDRSI PIC  X(0001).
  1432*    -------------------------------
  1433     05  PRINTERL PIC S9(0004) COMP.
  1434     05  PRINTERF PIC  X(0001).
  1435     05  FILLER REDEFINES PRINTERF.
  1436         10  PRINTERA PIC  X(0001).
  1437     05  PRINTERI PIC  X(0004).
  1438*    -------------------------------
  1439     05  COPIESL PIC S9(0004) COMP.
  1440     05  COPIESF PIC  X(0001).
  1441     05  FILLER REDEFINES COPIESF.
  1442         10  COPIESA PIC  X(0001).
  1443     05  COPIESI PIC  X(0001).
  1444*    -------------------------------
  1445     05  DATASORL PIC S9(0004) COMP.
  1446     05  DATASORF PIC  X(0001).
  1447     05  FILLER REDEFINES DATASORF.
  1448         10  DATASORA PIC  X(0001).
  1449     05  DATASORI PIC  X(0001).
  1450*    -------------------------------
  1451     05  ADDRLBLL PIC S9(0004) COMP.
  1452     05  ADDRLBLF PIC  X(0001).
  1453     05  FILLER REDEFINES ADDRLBLF.
  1454         10  ADDRLBLA PIC  X(0001).
  1455     05  ADDRLBLI PIC  X(0001).
  1456*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  29
* EL689.cbl
  1457     05  RPERSONL PIC S9(0004) COMP.
  1458     05  RPERSONF PIC  X(0001).
  1459     05  FILLER REDEFINES RPERSONF.
  1460         10  RPERSONA PIC  X(0001).
  1461     05  RPERSONI PIC  X(0010).
  1462*    -------------------------------
  1463     05  BENTRYL PIC S9(0004) COMP.
  1464     05  BENTRYF PIC  X(0001).
  1465     05  FILLER REDEFINES BENTRYF.
  1466         10  BENTRYA PIC  X(0001).
  1467     05  BENTRYI PIC  X(0006).
  1468*    -------------------------------
  1469     05  SEQL PIC S9(0004) COMP.
  1470     05  SEQF PIC  X(0001).
  1471     05  FILLER REDEFINES SEQF.
  1472         10  SEQA PIC  X(0001).
  1473     05  SEQI PIC  X(0008).
  1474*    -------------------------------
  1475     05  BCSEQL PIC S9(0004) COMP.
  1476     05  BCSEQF PIC  X(0001).
  1477     05  FILLER REDEFINES BCSEQF.
  1478         10  BCSEQA PIC  X(0001).
  1479     05  BCSEQI PIC  X(0004).
  1480*    -------------------------------
  1481     05  L1L PIC S9(0004) COMP.
  1482     05  L1F PIC  X(0001).
  1483     05  FILLER REDEFINES L1F.
  1484         10  L1A PIC  X(0001).
  1485     05  L1I PIC  X(0003).
  1486*    -------------------------------
  1487     05  TEXT1L PIC S9(0004) COMP.
  1488     05  TEXT1F PIC  X(0001).
  1489     05  FILLER REDEFINES TEXT1F.
  1490         10  TEXT1A PIC  X(0001).
  1491     05  TEXT1I PIC  X(0070).
  1492*    -------------------------------
  1493     05  L2L PIC S9(0004) COMP.
  1494     05  L2F PIC  X(0001).
  1495     05  FILLER REDEFINES L2F.
  1496         10  L2A PIC  X(0001).
  1497     05  L2I PIC  X(0003).
  1498*    -------------------------------
  1499     05  TEXT2L PIC S9(0004) COMP.
  1500     05  TEXT2F PIC  X(0001).
  1501     05  FILLER REDEFINES TEXT2F.
  1502         10  TEXT2A PIC  X(0001).
  1503     05  TEXT2I PIC  X(0070).
  1504*    -------------------------------
  1505     05  L3L PIC S9(0004) COMP.
  1506     05  L3F PIC  X(0001).
  1507     05  FILLER REDEFINES L3F.
  1508         10  L3A PIC  X(0001).
  1509     05  L3I PIC  X(0003).
  1510*    -------------------------------
  1511     05  TEXT3L PIC S9(0004) COMP.
  1512     05  TEXT3F PIC  X(0001).
  1513     05  FILLER REDEFINES TEXT3F.
  1514         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  30
* EL689.cbl
  1515     05  TEXT3I PIC  X(0070).
  1516*    -------------------------------
  1517     05  L4L PIC S9(0004) COMP.
  1518     05  L4F PIC  X(0001).
  1519     05  FILLER REDEFINES L4F.
  1520         10  L4A PIC  X(0001).
  1521     05  L4I PIC  X(0003).
  1522*    -------------------------------
  1523     05  TEXT4L PIC S9(0004) COMP.
  1524     05  TEXT4F PIC  X(0001).
  1525     05  FILLER REDEFINES TEXT4F.
  1526         10  TEXT4A PIC  X(0001).
  1527     05  TEXT4I PIC  X(0070).
  1528*    -------------------------------
  1529     05  L5L PIC S9(0004) COMP.
  1530     05  L5F PIC  X(0001).
  1531     05  FILLER REDEFINES L5F.
  1532         10  L5A PIC  X(0001).
  1533     05  L5I PIC  X(0003).
  1534*    -------------------------------
  1535     05  TEXT5L PIC S9(0004) COMP.
  1536     05  TEXT5F PIC  X(0001).
  1537     05  FILLER REDEFINES TEXT5F.
  1538         10  TEXT5A PIC  X(0001).
  1539     05  TEXT5I PIC  X(0070).
  1540*    -------------------------------
  1541     05  L6L PIC S9(0004) COMP.
  1542     05  L6F PIC  X(0001).
  1543     05  FILLER REDEFINES L6F.
  1544         10  L6A PIC  X(0001).
  1545     05  L6I PIC  X(0003).
  1546*    -------------------------------
  1547     05  TEXT6L PIC S9(0004) COMP.
  1548     05  TEXT6F PIC  X(0001).
  1549     05  FILLER REDEFINES TEXT6F.
  1550         10  TEXT6A PIC  X(0001).
  1551     05  TEXT6I PIC  X(0070).
  1552*    -------------------------------
  1553     05  L7L PIC S9(0004) COMP.
  1554     05  L7F PIC  X(0001).
  1555     05  FILLER REDEFINES L7F.
  1556         10  L7A PIC  X(0001).
  1557     05  L7I PIC  X(0003).
  1558*    -------------------------------
  1559     05  TEXT7L PIC S9(0004) COMP.
  1560     05  TEXT7F PIC  X(0001).
  1561     05  FILLER REDEFINES TEXT7F.
  1562         10  TEXT7A PIC  X(0001).
  1563     05  TEXT7I PIC  X(0070).
  1564*    -------------------------------
  1565     05  L8L PIC S9(0004) COMP.
  1566     05  L8F PIC  X(0001).
  1567     05  FILLER REDEFINES L8F.
  1568         10  L8A PIC  X(0001).
  1569     05  L8I PIC  X(0003).
  1570*    -------------------------------
  1571     05  TEXT8L PIC S9(0004) COMP.
  1572     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  31
* EL689.cbl
  1573     05  FILLER REDEFINES TEXT8F.
  1574         10  TEXT8A PIC  X(0001).
  1575     05  TEXT8I PIC  X(0070).
  1576*    -------------------------------
  1577     05  L9L PIC S9(0004) COMP.
  1578     05  L9F PIC  X(0001).
  1579     05  FILLER REDEFINES L9F.
  1580         10  L9A PIC  X(0001).
  1581     05  L9I PIC  X(0003).
  1582*    -------------------------------
  1583     05  TEXT9L PIC S9(0004) COMP.
  1584     05  TEXT9F PIC  X(0001).
  1585     05  FILLER REDEFINES TEXT9F.
  1586         10  TEXT9A PIC  X(0001).
  1587     05  TEXT9I PIC  X(0070).
  1588*    -------------------------------
  1589     05  L10L PIC S9(0004) COMP.
  1590     05  L10F PIC  X(0001).
  1591     05  FILLER REDEFINES L10F.
  1592         10  L10A PIC  X(0001).
  1593     05  L10I PIC  X(0003).
  1594*    -------------------------------
  1595     05  TEXT10L PIC S9(0004) COMP.
  1596     05  TEXT10F PIC  X(0001).
  1597     05  FILLER REDEFINES TEXT10F.
  1598         10  TEXT10A PIC  X(0001).
  1599     05  TEXT10I PIC  X(0070).
  1600*    -------------------------------
  1601     05  L11L PIC S9(0004) COMP.
  1602     05  L11F PIC  X(0001).
  1603     05  FILLER REDEFINES L11F.
  1604         10  L11A PIC  X(0001).
  1605     05  L11I PIC  X(0003).
  1606*    -------------------------------
  1607     05  TEXT11L PIC S9(0004) COMP.
  1608     05  TEXT11F PIC  X(0001).
  1609     05  FILLER REDEFINES TEXT11F.
  1610         10  TEXT11A PIC  X(0001).
  1611     05  TEXT11I PIC  X(0070).
  1612*    -------------------------------
  1613     05  L12L PIC S9(0004) COMP.
  1614     05  L12F PIC  X(0001).
  1615     05  FILLER REDEFINES L12F.
  1616         10  L12A PIC  X(0001).
  1617     05  L12I PIC  X(0003).
  1618*    -------------------------------
  1619     05  TEXT12L PIC S9(0004) COMP.
  1620     05  TEXT12F PIC  X(0001).
  1621     05  FILLER REDEFINES TEXT12F.
  1622         10  TEXT12A PIC  X(0001).
  1623     05  TEXT12I PIC  X(0070).
  1624*    -------------------------------
  1625     05  ERRMSGL PIC S9(0004) COMP.
  1626     05  ERRMSGF PIC  X(0001).
  1627     05  FILLER REDEFINES ERRMSGF.
  1628         10  ERRMSGA PIC  X(0001).
  1629     05  ERRMSGI PIC  X(0079).
  1630*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  32
* EL689.cbl
  1631     05  ENTERPFL PIC S9(0004) COMP.
  1632     05  ENTERPFF PIC  X(0001).
  1633     05  FILLER REDEFINES ENTERPFF.
  1634         10  ENTERPFA PIC  X(0001).
  1635     05  ENTERPFI PIC  99.
  1636*    -------------------------------
  1637     05  PF8HDL PIC S9(0004) COMP.
  1638     05  PF8HDF PIC  X(0001).
  1639     05  FILLER REDEFINES PF8HDF.
  1640         10  PF8HDA PIC  X(0001).
  1641     05  PF8HDI PIC  X(0022).
  1642 01  EL689AO REDEFINES EL689AI.
  1643     05  FILLER            PIC  X(0012).
  1644*    -------------------------------
  1645     05  FILLER            PIC  X(0003).
  1646     05  RUNDTEO PIC  X(0008).
  1647*    -------------------------------
  1648     05  FILLER            PIC  X(0003).
  1649     05  RUNTIMEO PIC  99.99.
  1650*    -------------------------------
  1651     05  FILLER            PIC  X(0003).
  1652     05  HOSTO PIC  X(0010).
  1653*    -------------------------------
  1654     05  FILLER            PIC  X(0003).
  1655     05  SYSO PIC  X(0008).
  1656*    -------------------------------
  1657     05  FILLER            PIC  X(0003).
  1658     05  COMPANYO PIC  X(0003).
  1659*    -------------------------------
  1660     05  FILLER            PIC  X(0003).
  1661     05  USERIDO PIC  X(0004).
  1662*    -------------------------------
  1663     05  FILLER            PIC  X(0003).
  1664     05  MAINTO PIC  X(0001).
  1665*    -------------------------------
  1666     05  FILLER            PIC  X(0003).
  1667     05  FORMO PIC  X(0004).
  1668*    -------------------------------
  1669     05  FILLER            PIC  X(0003).
  1670     05  ARCHNUMO PIC  99999999.
  1671*    -------------------------------
  1672     05  FILLER            PIC  X(0003).
  1673     05  PRTNOWO PIC  X(0001).
  1674*    -------------------------------
  1675     05  FILLER            PIC  X(0003).
  1676     05  CARRIERO PIC  X(0001).
  1677*    -------------------------------
  1678     05  FILLER            PIC  X(0003).
  1679     05  GROUPO PIC  X(0006).
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  STATEO PIC  X(0002).
  1683*    -------------------------------
  1684     05  FILLER            PIC  X(0003).
  1685     05  ACCTO PIC  X(0010).
  1686*    -------------------------------
  1687     05  FILLER            PIC  X(0003).
  1688     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  33
* EL689.cbl
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  SFXO PIC  X(0001).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  TYPEO PIC  X(0001).
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  DATEO PIC  X(0008).
  1698*    -------------------------------
  1699     05  FILLER            PIC  X(0003).
  1700     05  FOLLOWO PIC  X(0008).
  1701*    -------------------------------
  1702     05  FILLER            PIC  X(0003).
  1703     05  RESEND1O PIC  X(0008).
  1704*    -------------------------------
  1705     05  FILLER            PIC  X(0003).
  1706     05  ENCO PIC  X(0003).
  1707*    -------------------------------
  1708     05  FILLER            PIC  X(0003).
  1709     05  ENDARCHO PIC  99999999.
  1710*    -------------------------------
  1711     05  FILLER            PIC  X(0003).
  1712     05  CERTIDO PIC  X(0005).
  1713*    -------------------------------
  1714     05  FILLER            PIC  X(0003).
  1715     05  ADDRSO PIC  X(0001).
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  PRINTERO PIC  X(0004).
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  COPIESO PIC  X(0001).
  1722*    -------------------------------
  1723     05  FILLER            PIC  X(0003).
  1724     05  DATASORO PIC  X(0001).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  ADDRLBLO PIC  X(0001).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  RPERSONO PIC  X(0010).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  BENTRYO PIC  X(0006).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  SEQO PIC  X(0008).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  BCSEQO PIC  X(0004).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  L1O PIC  X(0003).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  TEXT1O PIC  X(0070).
  1746*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  34
* EL689.cbl
  1747     05  FILLER            PIC  X(0003).
  1748     05  L2O PIC  X(0003).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  TEXT2O PIC  X(0070).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  L3O PIC  X(0003).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  TEXT3O PIC  X(0070).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  L4O PIC  X(0003).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  TEXT4O PIC  X(0070).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  L5O PIC  X(0003).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  TEXT5O PIC  X(0070).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  L6O PIC  X(0003).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  TEXT6O PIC  X(0070).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  L7O PIC  X(0003).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  TEXT7O PIC  X(0070).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  L8O PIC  X(0003).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  TEXT8O PIC  X(0070).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  L9O PIC  X(0003).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  TEXT9O PIC  X(0070).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  L10O PIC  X(0003).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  TEXT10O PIC  X(0070).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  L11O PIC  X(0003).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  35
* EL689.cbl
  1805     05  TEXT11O PIC  X(0070).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  L12O PIC  X(0003).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  TEXT12O PIC  X(0070).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  ERRMSGO PIC  X(0079).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  ENTERPFO PIC  X(0002).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  PF8HDO PIC  X(0022).
  1821*    -------------------------------
  1822 01  W-MAP-REDEF REDEFINES EL689AI.
  1823*    12  FILLER                  PIC X(218).
  1824     12  FILLER                  PIC X(267).
  1825     12  EL689RI.
  1826         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1827             20  W-SC-LINEL      PIC S9(04) COMP.
  1828             20  W-SC-LINEA      PIC  X(01).
  1829             20  W-SC-LINE       PIC  X(03).
  1830             20  W-SC-TEXTL      PIC S9(04) COMP.
  1831             20  W-SC-TEXTA      PIC  X(01).
  1832             20  W-SC-TEXT       PIC  X(70).
  1833*    12  FILLER                  PIC  X(87).
  1834     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  36
* EL689.cbl
  1836 01  W-CONSTANT-AREA.
  1837     12  FILLER                  PIC  X(18)
  1838                                 VALUE 'PROGRAM CONSTANTS:'.
  1839     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1840     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1841     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1842     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1843     12  W-NOTE-LENGTH           PIC S9(04)  COMP  VALUE +825.
  1844     12  W-EOBC-LENGTH           PIC S9(04)  COMP  VALUE +350.
  1845     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1846     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1847     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1848     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1849     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1850     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1851
  1852     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  1853     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  1854     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  1855     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  1856     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  1857     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  1858     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  1859     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  1860     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  1861     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  1862     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  1863     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  1864     12  W-NOTE-FILE-ID          PIC  X(08) VALUE 'ERNOTE'.
  1865     12  W-EOBC-FILE-ID          PIC  X(08) VALUE 'ELEOBC'.
  1866     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  1867     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  1868     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  1869     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  1870     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  1871     12  W-LOWER-CASE            PIC  X(26)
  1872         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  1873     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  1874     12  W-MAP.
  1875         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  1876         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  1877         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  1878     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  1879     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  1880     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  1881     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  1882     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  1883     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  1884     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  1885
  1886     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  1887     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  1888     12  W-TOP-FORM              PIC  X(70)
  1889                              VALUE '*****TOP OF FORM *****'.
  1890     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  1891     12  W-UPPER-CASE            PIC  X(26)
  1892         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  1893     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  37
* EL689.cbl
  1894     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  1895     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  38
* EL689.cbl
  1897 01  W-VARIABLE-PROCESS-CNTLS.
  1898     12  FILLER                  PIC  X(26)
  1899                        VALUE 'VARIABLE WORK AREA STARTS:'.
  1900     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  1901     12  W-VAR-HOLD.
  1902         16  W-V1                PIC  X(01).
  1903         16  W-V2                PIC  X(01).
  1904         16  W-V3                PIC  X(01).
  1905     12  FILLER REDEFINES W-VAR-HOLD.
  1906         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  1907     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  1908         88  W-SQUEEZE-FIELD          VALUE '#'.
  1909
  1910 01  W-SUPPORTED-VARIABLES.
  1911
  1912*****************COMPANY VARIABLES - ELCNTL ********************
  1913*****COMPANY NAME
  1914     12  FILLER                  PIC  X(03) VALUE '001'.
  1915     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1916     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1917     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1918     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1919
  1920*****FULL COMPANY ADDRESS
  1921     12  FILLER                  PIC  X(03) VALUE '002'.
  1922     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1923     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1924     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1925     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1926
  1927     12  FILLER                  PIC  X(03) VALUE '003'.
  1928     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1929     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1930     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1931     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1932
  1933     12  FILLER                  PIC  X(03) VALUE '004'.
  1934     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1935     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1936     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1937     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1938
  1939     12  FILLER                  PIC  X(03) VALUE '005'.
  1940     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1941     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1942     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1943     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1944
  1945     12  FILLER                  PIC  X(03) VALUE '006'.
  1946     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1947     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1948     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1949     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1950
  1951*****REMAINING 4 ARE NOT CURRENTLY USED
  1952     12  FILLER                  PIC  X(03) VALUE '007'.
  1953     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1954     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  39
* EL689.cbl
  1955     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1956     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1957
  1958     12  FILLER                  PIC  X(03) VALUE '008'.
  1959     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1960     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1961     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1962     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1963
  1964     12  FILLER                  PIC  X(03) VALUE '009'.
  1965     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1966     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1967     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1968     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1969
  1970     12  FILLER                  PIC  X(03) VALUE '010'.
  1971     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1972     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1973     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1974     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1975
  1976************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  1977*****LIFE BENEFIT DESCRIPTION
  1978     12  FILLER                  PIC  X(03) VALUE '011'.
  1979     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1980     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1981     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1982     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1983
  1984*****REMAINING 3 ARE NOT CURRENTLY USED
  1985     12  FILLER                  PIC  X(03) VALUE '012'.
  1986     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1987     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1988     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1989     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1990
  1991     12  FILLER                  PIC  X(03) VALUE '013'.
  1992     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1993     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1994     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1995     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1996
  1997     12  FILLER                  PIC  X(03) VALUE '014'.
  1998     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1999     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2000     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2001     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2002
  2003************* A&H BENEFIT VARIABLES - ELCNTL *******************
  2004*****AH BENEFIT DESCRIPTION
  2005     12  FILLER                  PIC  X(03) VALUE '015'.
  2006     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2007     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2008     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2009     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2010
  2011*****ELIMINATION PERIOD
  2012     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  40
* EL689.cbl
  2013     12  FILLER                  PIC S9(04) COMP VALUE +2.
  2014     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2015     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2016     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2017
  2018*****REMAINING 3 ARE NOT CURRENTLY USED
  2019     12  FILLER                  PIC  X(03) VALUE '017'.
  2020     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2021     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2022     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2023     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2024
  2025     12  FILLER                  PIC  X(03) VALUE '018'.
  2026     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2027     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2028     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2029     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2030
  2031     12  FILLER                  PIC  X(03) VALUE '019'.
  2032     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2033     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2034     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2035     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2036
  2037*****************CARRIER VARIABLES - ELCNTL ********************
  2038*****CARRIER NAME
  2039     12  FILLER                  PIC  X(03) VALUE '020'.
  2040     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2041     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2042     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2043     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2044
  2045*****FULL CARRIER ADDRESS
  2046     12  FILLER                  PIC  X(03) VALUE '021'.
  2047     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2048     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2049     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2050     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2051
  2052     12  FILLER                  PIC  X(03) VALUE '022'.
  2053     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2054     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2055     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2056     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2057
  2058     12  FILLER                  PIC  X(03) VALUE '023'.
  2059     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2060     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2061     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2062     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2063
  2064     12  FILLER                  PIC  X(03) VALUE '024'.
  2065     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2066     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2067     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2068     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2069
  2070     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  41
* EL689.cbl
  2071     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2072     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2073     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2074     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2075
  2076*****CARRIER PHONE NUMBER
  2077     12  FILLER                  PIC  X(03) VALUE '026'.
  2078     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2079     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2080     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2081     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2082
  2083*****REMAINING 4 ARE NOT CURRENTLY USED
  2084     12  FILLER                  PIC  X(03) VALUE '027'.
  2085     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2086     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2087     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2088     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2089
  2090     12  FILLER                  PIC  X(03) VALUE '028'.
  2091     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2092     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2093     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2094     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2095
  2096     12  FILLER                  PIC  X(03) VALUE '029'.
  2097     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2098     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2099     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2100     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2101
  2102     12  FILLER                  PIC  X(03) VALUE '030'.
  2103     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2104     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2105     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2106     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2107
  2108***************** MAIL VARIABLES - ELMAIL **********************
  2109*****FULL MAIL ADDRESS
  2110     12  FILLER                  PIC  X(03) VALUE '031'.
  2111     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2112     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2113     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2114     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2115
  2116     12  FILLER                  PIC  X(03) VALUE '032'.
  2117     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2118     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2119     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2120     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2121
  2122     12  FILLER                  PIC  X(03) VALUE '033'.
  2123     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2124     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2125     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2126     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2127
  2128     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  42
* EL689.cbl
  2129     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2130     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2131     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2132     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2133
  2134     12  FILLER                  PIC  X(03) VALUE '035'.
  2135     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2136     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2137     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2138     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2139
  2140     12  FILLER                  PIC  X(03) VALUE '036'.
  2141     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2142     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2143     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2144     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2145**** CRED BENE NAME FROM ERMAIL
  2146     12  FILLER                  PIC  X(03) VALUE '037'.
  2147     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2148     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2149     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2150     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2151*****REMAINING 2 ARE NOT CURRENTLY USED
  2152     12  FILLER                  PIC  X(03) VALUE '038'.
  2153     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2154     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2155     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2156     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2157
  2158     12  FILLER                  PIC  X(03) VALUE '039'.
  2159     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2160     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2161     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2162     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2163
  2164*************** ACCOUNT VARIABLES - ERACCT *********************
  2165*****ACCOUNT NAME
  2166     12  FILLER                  PIC  X(03) VALUE '040'.
  2167     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2168     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2169     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2170     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2171
  2172*****FULL ACCOUNT ADDRESS
  2173     12  FILLER                  PIC  X(03) VALUE '041'.
  2174     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2175     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2176     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2177     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2178
  2179     12  FILLER                  PIC  X(03) VALUE '042'.
  2180     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2181     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2182     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2183     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2184
  2185     12  FILLER                  PIC  X(03) VALUE '043'.
  2186     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  43
* EL689.cbl
  2187     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2188     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2189     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2190
  2191     12  FILLER                  PIC  X(03) VALUE '044'.
  2192     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2193     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2194     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2195     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2196
  2197     12  FILLER                  PIC  X(03) VALUE '045'.
  2198     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2199     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2200     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2201     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2202
  2203*****ACCOUNT PHONE NUMBER
  2204     12  FILLER                  PIC  X(03) VALUE '046'.
  2205     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2206     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2207     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2208     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2209
  2210*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2211     12  FILLER                  PIC  X(03) VALUE '047'.
  2212     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2213     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2214     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2215     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2216
  2217****ACCOUNT CSR CODE
  2218     12  FILLER                  PIC  X(03) VALUE '048'.
  2219     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2220     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2221     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2222     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2223****ACCOUNT ACCOUNT NUMBER
  2224     12  FILLER                  PIC  X(03) VALUE '049'.
  2225     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2226     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2227     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2228     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2229
  2230**** CRED BENE ADDRESS LINE 1 ERMAIL
  2231     12  FILLER                  PIC  X(03) VALUE '050'.
  2232     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2233     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2234     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2235     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2236
  2237**** CRED BENE ADDRESS LINE 2 ERMAIL
  2238     12  FILLER                  PIC  X(03) VALUE '051'.
  2239     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2240     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2241     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2242     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2243
  2244**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  44
* EL689.cbl
  2245     12  FILLER                  PIC  X(03) VALUE '052'.
  2246     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2247     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2248     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2249     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2250
  2251**** CRED BENE ZIP  1 ERMAIL
  2252     12  FILLER                  PIC  X(03) VALUE '053'.
  2253     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2254     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2255     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2256     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2257
  2258*****REMAINING 6 ARE NOT CURRENTLY USED
  2259     12  FILLER                  PIC  X(03) VALUE '054'.
  2260     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2261     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2262     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2263     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2264
  2265     12  FILLER                  PIC  X(03) VALUE '055'.
  2266     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2267     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2268     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2269     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2270
  2271     12  FILLER                  PIC  X(03) VALUE '056'.
  2272     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2273     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2274     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2275     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2276
  2277     12  FILLER                  PIC  X(03) VALUE '057'.
  2278     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2279     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2280     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2281     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2282
  2283     12  FILLER                  PIC  X(03) VALUE '058'.
  2284     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2285     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2286     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2287     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2288
  2289     12  FILLER                  PIC  X(03) VALUE '059'.
  2290     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2291     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2292     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2293     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2294
  2295*************** NON FILE VARIABLES *****************************
  2296*****CURRENT DATE
  2297     12  FILLER                  PIC  X(03) VALUE '060'.
  2298     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2299     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2300     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2301     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2302
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  45
* EL689.cbl
  2303*****FULL CURRENT DATE
  2304     12  FILLER                  PIC  X(03) VALUE '061'.
  2305     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2306     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2307     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2308     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2309
  2310*****FORM
  2311     12  FILLER                  PIC  X(03) VALUE '062'.
  2312     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2313     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2314     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2315     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2316
  2317*****VARIABLE 1
  2318     12  FILLER                  PIC  X(03) VALUE '063'.
  2319     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2320     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2321     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2322     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2323
  2324*****VARIABLE 2
  2325     12  FILLER                  PIC  X(03) VALUE '064'.
  2326     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2327     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2328     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2329     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2330
  2331*****VARIABLE 3
  2332     12  FILLER                  PIC  X(03) VALUE '065'.
  2333     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2334     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2335     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2336     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2337
  2338*****VARIABLE 4
  2339     12  FILLER                  PIC  X(03) VALUE '066'.
  2340     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2341     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2342     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2343     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2344
  2345*****REMAINING 3 ARE NOT CURRENTLY USED
  2346     12  FILLER                  PIC  X(03) VALUE '067'.
  2347     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2348     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2349     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2350     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2351
  2352     12  FILLER                  PIC  X(03) VALUE '068'.
  2353     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2354     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2355     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2356     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2357
  2358     12  FILLER                  PIC  X(03) VALUE '069'.
  2359     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2360     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  46
* EL689.cbl
  2361     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2362     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2363
  2364************** CERTIFICATE VARIABLES - ELCERT *****************
  2365*****CARRIER CODE IN CERT
  2366     12  FILLER                  PIC  X(03) VALUE '070'.
  2367     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2368     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2369     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2370     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2371
  2372*****GROUPING CODE IN CERT
  2373     12  FILLER                  PIC  X(03) VALUE '071'.
  2374     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2375     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2376     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2377     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2378
  2379*****ACCOUNT NUMBER IN CERT
  2380     12  FILLER                  PIC  X(03) VALUE '072'.
  2381     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2382     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2383     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2384     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2385
  2386*****CERTIFICATE NUMBER
  2387     12  FILLER                  PIC  X(03) VALUE '073'.
  2388     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2389     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2390     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2391     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2392
  2393*****CERT EFFECTIVE DATE
  2394     12  FILLER                  PIC  X(03) VALUE '074'.
  2395     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2396     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2397     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2398     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2399
  2400*****CERT EXPIRATION DATE (LIFE)
  2401     12  FILLER                  PIC  X(03) VALUE '075'.
  2402     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2403     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2404     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2405     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2406
  2407*****CERT EXPIRATION DATE (AH)
  2408     12  FILLER                  PIC  X(03) VALUE '076'.
  2409     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2410     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2411     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2412     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2413
  2414*****LIFE TERM
  2415     12  FILLER                  PIC  X(03) VALUE '077'.
  2416     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2417     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2418     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  47
* EL689.cbl
  2419     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2420
  2421*****AH  TERM
  2422     12  FILLER                  PIC  X(03) VALUE '078'.
  2423     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2424     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2425     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2426     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2427
  2428*****LIFE COVERAGE AMOUNT
  2429     12  FILLER                  PIC  X(03) VALUE '079'.
  2430     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2431     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2432     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2433     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2434
  2435*****AH MONTHLY BENEFIT
  2436     12  FILLER                  PIC  X(03) VALUE '080'.
  2437     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2438     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2439     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2440     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2441
  2442*****LIFE CANCEL DATE
  2443     12  FILLER                  PIC  X(03) VALUE '081'.
  2444     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2445     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2446     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2447     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2448
  2449*****AH CANCEL DATE
  2450     12  FILLER                  PIC  X(03) VALUE '082'.
  2451     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2452     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2453     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2454     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2455
  2456*****LIFE COVERAGE FORM NUMBER
  2457     12  FILLER                  PIC  X(03) VALUE '083'.
  2458     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2459     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2460     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2461     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2462
  2463*****UNUSED
  2464     12  FILLER                  PIC  X(03) VALUE '084'.
  2465     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2466     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2467     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2468     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2469
  2470*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2471     12  FILLER                  PIC  X(03) VALUE '085'.
  2472     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2473     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2474     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2475     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2476
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  48
* EL689.cbl
  2477*****LOAN NUMBER
  2478     12  FILLER                  PIC  X(03) VALUE '086'.
  2479     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2480     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2481     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2482     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2483
  2484*****LOAN BALANCE
  2485     12  FILLER                  PIC  X(03) VALUE '087'.
  2486     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2487     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2488     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2489     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2490
  2491*****MEMBER NUMBER
  2492     12  FILLER                  PIC  X(03) VALUE '088'.
  2493     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2494     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2495     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2496     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2497
  2498*****INSURED SOC SEC NUMBER
  2499     12  FILLER                  PIC  X(03) VALUE '089'.
  2500     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2501     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2502     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2503     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2504
  2505*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2506     12  FILLER                  PIC  X(03) VALUE '090'.
  2507     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2508     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2509     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2510     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2511
  2512*****INSURED FIRST NAME (CERTIFICATE)
  2513     12  FILLER                  PIC  X(03) VALUE '091'.
  2514     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2515     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2516     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2517     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2518
  2519*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2520     12  FILLER                  PIC  X(03) VALUE '092'.
  2521     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2522     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2523     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2524     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2525
  2526*****ORIG TERM * MON BEN
  2527     12  FILLER                  PIC  X(03) VALUE '093'.
  2528     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2529     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2530     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2531     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2532
  2533*****INSURED'S NAME (LAST, FIRST, INIT)
  2534     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  49
* EL689.cbl
  2535     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2536     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2537     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2538     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2539
  2540*****INSURED'S NAME (FIRST, INIT, LAST)
  2541     12  FILLER                  PIC  X(03) VALUE  '095'.
  2542     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2543     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2544     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2545     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2546
  2547*****TITLE (MR/MS)
  2548     12  FILLER                  PIC  X(03) VALUE '096'.
  2549     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2550     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2551     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2552     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2553
  2554*****LIFE PREMIUM (CERTIFICATE)
  2555     12  FILLER                  PIC  X(03) VALUE '097'.
  2556     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2557     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2558     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2559     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2560
  2561*****A/H PREMIUM (CERTIFICATE)
  2562     12  FILLER                  PIC  X(03) VALUE '098'.
  2563     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2564     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2565     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2566     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2567
  2568*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2569     12  FILLER                  PIC  X(03) VALUE '099'.
  2570     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2571     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2572     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2573     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2574
  2575*****JOINT'S FIRST NAME (CERTIFICATE)
  2576     12  FILLER                  PIC  X(03) VALUE '100'.
  2577     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2578     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2579     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2580     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2581
  2582*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2583     12  FILLER                  PIC  X(03) VALUE '101'.
  2584     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2585     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2586     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2587     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2588
  2589*****JOINT'S NAME (LAST, FIRST, INIT)
  2590     12  FILLER                  PIC  X(03) VALUE '102'.
  2591     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2592     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  50
* EL689.cbl
  2593     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2594     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2595
  2596*****JOINT'S NAME (FIRST, INIT, LAST)
  2597     12  FILLER                  PIC  X(03) VALUE '103'.
  2598     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2599     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2600     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2601     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2602
  2603*****INSURED'S FIRST AND LAST NAME
  2604     12  FILLER                  PIC  X(03) VALUE '104'.
  2605     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2606     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2607     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2608     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2609
  2610*****JOINT'S FIRST AND LAST NAME
  2611     12  FILLER                  PIC  X(03) VALUE '105'.
  2612     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2613     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2614     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2615     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2616
  2617*****ENTERED LIFE REFUND (CERT)
  2618     12  FILLER                  PIC  X(03) VALUE '106'.
  2619     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2620     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2621     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2622     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2623
  2624*****ENTERED A/H REFUND (CERT)
  2625     12  FILLER                  PIC  X(03) VALUE '107'.
  2626     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2627     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2628     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2629     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2630
  2631*****INSURED'S LAST NAME
  2632     12  FILLER                  PIC  X(03) VALUE '108'.
  2633     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2634     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2635     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2636     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2637
  2638*****BENEFICIARY
  2639     12  FILLER                  PIC  X(03) VALUE  '109'.
  2640     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2641     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2642     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2643     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2644
  2645************** PENDING VARIABLES - ERPNDB *********************
  2646*****INSURED DATE OF BIRTH
  2647     12  FILLER                  PIC  X(03) VALUE '110'.
  2648     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2649     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2650     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  51
* EL689.cbl
  2651     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2652
  2653*****ENTERED LIFE PREMIUM (PENDING)
  2654     12  FILLER                  PIC  X(03) VALUE '111'.
  2655     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2656     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2657     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2658     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2659
  2660*****ENTERED A/H PREMIUM (PENDING)
  2661     12  FILLER                  PIC  X(03) VALUE '112'.
  2662     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2663     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2664     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2665     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2666
  2667*****CALCULATED LIFE PREMIUM (PENDING)
  2668     12  FILLER                  PIC  X(03) VALUE '113'.
  2669     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2670     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2671     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2672     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2673
  2674*****CALCULATED A/H PREMIUM (PENDING)
  2675     12  FILLER                  PIC  X(03) VALUE '114'.
  2676     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2677     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2678     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2679     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2680
  2681*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2682     12  FILLER                  PIC  X(03) VALUE '115'.
  2683     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2684     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2685     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2686     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2687
  2688*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2689     12  FILLER                  PIC  X(03) VALUE '116'.
  2690     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2691     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2692     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2693     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2694
  2695*****PRIOR CANCEL DATE
  2696     12  FILLER                  PIC  X(03) VALUE '117'.
  2697     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2698     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2699     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2700     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2701
  2702*****ENTERED LIFE REFUND (PENDING)
  2703     12  FILLER                  PIC  X(03) VALUE '118'.
  2704     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2705     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2706     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2707     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2708
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  52
* EL689.cbl
  2709*****ENTERED A/H REFUND (PENDING)
  2710     12  FILLER                  PIC  X(03) VALUE '119'.
  2711     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2712     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2713     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2714     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2715
  2716*****CALCULATED LIFE REFUND (PENDING)
  2717     12  FILLER                  PIC  X(03) VALUE '120'.
  2718     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2719     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2720     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2721     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2722
  2723*****CALCULATED A/H REFUND (PENDING)
  2724     12  FILLER                  PIC  X(03) VALUE '121'.
  2725     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2726     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2727     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2728     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2729
  2730*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2731     12  FILLER                  PIC  X(03) VALUE '122'.
  2732     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2733     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2734     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2735     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2736
  2737*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2738     12  FILLER                  PIC  X(03) VALUE '123'.
  2739     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2740     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2741     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2742     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2743
  2744*****INSUREDS AGE
  2745     12  FILLER                  PIC  X(03) VALUE '124'.
  2746     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2747     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2748     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2749     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2750
  2751*****LIFE BENEFIT (PENDING)
  2752     12  FILLER                  PIC  X(03) VALUE '125'.
  2753     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2754     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2755     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2756     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2757
  2758*****A/H BENEFIT (PENDING)
  2759     12  FILLER                  PIC  X(03) VALUE '126'.
  2760     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2761     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2762     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2763     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2764
  2765*****LIFE RATE
  2766     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  53
* EL689.cbl
  2767     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2768     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2769     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2770     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2771
  2772*****A/H RATE
  2773     12  FILLER                  PIC  X(03) VALUE '128'.
  2774     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2775     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2776     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2777     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2778
  2779*****TERM (PENDING)
  2780     12  FILLER                  PIC  X(03) VALUE '129'.
  2781     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2782     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2783     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2784     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2785
  2786*****BATCH NUMBER
  2787     12  FILLER                  PIC  X(03) VALUE '130'.
  2788     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2789     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2790     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2791     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2792
  2793*****TOTAL OF LIFE AND A&H REFUND
  2794     12  FILLER                  PIC  X(03) VALUE '131'.
  2795     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2796     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2797     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2798     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2799
  2800*****NH INTEREST ON REFUNDS
  2801     12  FILLER                  PIC  X(03) VALUE '132'.
  2802     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2803     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2804     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2805     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2806*****GREATER OF THE LIFE AND AH CANCEL DATE
  2807     12  FILLER                  PIC  X(03) VALUE '133'.
  2808     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2809     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2810     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2811     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2812
  2813*****THE NEXT 6 NOT CURRENTLY USED
  2814     12  FILLER                  PIC  X(03) VALUE '134'.
  2815     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2816     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2817     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2818     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2819
  2820     12  FILLER                  PIC  X(03) VALUE '135'.
  2821     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2822     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2823     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2824     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  54
* EL689.cbl
  2825
  2826     12  FILLER                  PIC  X(03) VALUE '136'.
  2827     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2828     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2829     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2830     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2831
  2832     12  FILLER                  PIC  X(03) VALUE '137'.
  2833     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2834     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2835     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2836     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2837
  2838     12  FILLER                  PIC  X(03) VALUE '138'.
  2839     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2840     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2841     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2842     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2843
  2844     12  FILLER                  PIC  X(03) VALUE '139'.
  2845     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2846     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2847     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2848     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2849
  2850************** COMPENSATION VARIABLES - ERCOMP ****************
  2851*****COMPENSATION ACCT NAME
  2852     12  FILLER                  PIC  X(03) VALUE '140'.
  2853     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2854     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2855     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2856     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2857
  2858*****FULL COMPENSATION ADDRESS TYPE 'A'
  2859     12  FILLER                  PIC  X(03) VALUE '141'.
  2860     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2861     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2862     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2863     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2864
  2865     12  FILLER                  PIC  X(03) VALUE '142'.
  2866     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2867     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2868     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2869     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2870
  2871     12  FILLER                  PIC  X(03) VALUE '143'.
  2872     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2873     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2874     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2875     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2876
  2877     12  FILLER                  PIC  X(03) VALUE '144'.
  2878     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2879     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2880     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2881     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2882
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  55
* EL689.cbl
  2883     12  FILLER                  PIC  X(03) VALUE '145'.
  2884     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2885     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2886     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2887     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2888
  2889     12  FILLER                  PIC  X(03) VALUE '146'.
  2890     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2891     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2892     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2893     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2894
  2895*****COMPENSATION PHONE NUMBER
  2896     12  FILLER                  PIC  X(03) VALUE '147'.
  2897     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2898     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2899     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2900     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2901
  2902*****COMPENSATION CSR NAME
  2903     12  FILLER                  PIC  X(03) VALUE '148'.
  2904     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2905     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2906     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2907     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2908
  2909*****COMPENSATION LAST STATEMENT DATE
  2910     12  FILLER                  PIC  X(03) VALUE '149'.
  2911     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2912     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2913     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2914     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2915
  2916*****COMPENSATION ENDING BALANCE
  2917     12  FILLER                  PIC  X(03) VALUE '150'.
  2918     12  FILLER                  PIC S9(04) COMP VALUE +14.
  2919     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2920     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2921     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2922
  2923******************  PROCESSOR DATA - ELCNTL (2) ****************
  2924*****EXECUTING PROCESSOR NAME
  2925     12  FILLER                  PIC  X(03) VALUE '151'.
  2926     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2927     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2928     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2929     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2930
  2931*****PROCESSOR TITLE
  2932     12  FILLER                  PIC  X(03) VALUE '152'.
  2933     12  FILLER                  PIC S9(04) COMP VALUE +26.
  2934     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2935     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2936     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2937
  2938*****PROCESSOR
  2939     12  FILLER                  PIC  X(03) VALUE '153'.
  2940     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  56
* EL689.cbl
  2941     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2942     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2943     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2944
  2945*****CSR TITLE
  2946     12  FILLER                  PIC  X(03) VALUE '154'.
  2947     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2948     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2949     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2950     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2951*****REMAINING 2 ARE NOT CURRENTLY USED
  2952     12  FILLER                  PIC  X(03) VALUE '155'.
  2953     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2954     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2955     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2956     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2957
  2958     12  FILLER                  PIC  X(03) VALUE '156'.
  2959     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2960     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2961     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2962     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2963
  2964******************  CHECK DATA - ERCHEK    *********************
  2965*****CHECK AMOUNT
  2966     12  FILLER                  PIC  X(03) VALUE '157'.
  2967     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2968     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2969     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2970     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2971
  2972*****CHECK NUMBER
  2973     12  FILLER                  PIC  X(03) VALUE '158'.
  2974     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2975     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2976     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2977     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2978
  2979*****PAYEE 1 NAME
  2980     12  FILLER                  PIC  X(03) VALUE '159'.
  2981     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2982     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2983     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2984     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2985
  2986*****PAYEE 2 NAME
  2987     12  FILLER                  PIC  X(03) VALUE '160'.
  2988     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2989     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2990     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2991     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2992
  2993*****ADDRSS 1
  2994     12  FILLER                  PIC  X(03) VALUE '161'.
  2995     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2996     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2997     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2998     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  57
* EL689.cbl
  2999
  3000*****ADDRESS 2
  3001     12  FILLER                  PIC  X(03) VALUE '162'.
  3002     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3003     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3004     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3005     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3006
  3007*****PAYEE CITY STATE
  3008     12  FILLER                  PIC  X(03) VALUE '163'.
  3009     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3010     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3011     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3012     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3013
  3014*****ZIP CODE
  3015     12  FILLER                  PIC  X(03) VALUE '164'.
  3016     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3017     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3018     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3019     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3020
  3021*****CHECK CONTROL
  3022     12  FILLER                  PIC  X(03) VALUE '165'.
  3023     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3024     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3025     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3026     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3027
  3028*****REASON FOR CHECK
  3029     12  FILLER                  PIC  X(03) VALUE '166'.
  3030     12  FILLER                  PIC S9(04) COMP VALUE +25.
  3031     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3032     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3033     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3034
  3035*****REMAINING 3 ARE NOT CURRENTLY USED
  3036     12  FILLER                  PIC  X(03) VALUE '167'.
  3037     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3038     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3039     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3040     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3041
  3042     12  FILLER                  PIC  X(03) VALUE '168'.
  3043     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3044     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3045     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3046     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3047
  3048     12  FILLER                  PIC  X(03) VALUE '169'.
  3049     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3050     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3051     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3052     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3053
  3054
  3055*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3056*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  58
* EL689.cbl
  3057     12  FILLER                  PIC  X(03) VALUE '170'.
  3058     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3059     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3060     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3061     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3062
  3063*****CHECK NUMBER - PYAJ
  3064     12  FILLER                  PIC  X(03) VALUE '171'.
  3065     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3066     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3067     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3068     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3069
  3070*****CHECK CONTROL - PYAJ
  3071     12  FILLER                  PIC  X(03) VALUE '172'.
  3072     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3073     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3074     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3075     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3076
  3077***** COMMENT - PYAJ
  3078     12  FILLER                  PIC  X(03) VALUE '173'.
  3079     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3080     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3081     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3082     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3083
  3084*****NEW FIELDS.
  3085*****COMPENSATION FULL ADDRESS TYPE 'G'
  3086     12  FILLER                  PIC  X(03) VALUE '174'.
  3087     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3088     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3089     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3090     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3091
  3092     12  FILLER                  PIC  X(03) VALUE '175'.
  3093     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3094     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3095     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3096     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3097
  3098     12  FILLER                  PIC  X(03) VALUE '176'.
  3099     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3100     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3101     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3102     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3103
  3104     12  FILLER                  PIC  X(03) VALUE '177'.
  3105     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3106     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3107     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3108     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3109
  3110     12  FILLER                  PIC  X(03) VALUE '178'.
  3111     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3112     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3113     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3114     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  59
* EL689.cbl
  3115
  3116     12  FILLER                  PIC  X(03) VALUE '179'.
  3117     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3118     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3119     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3120     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3121
  3122*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3123     12  FILLER                  PIC  X(03) VALUE '180'.
  3124     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3125     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3126     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3127     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3128**** COMPENSATION BILLING SWITCH
  3129     12  FILLER                  PIC XXX    VALUE '181'.
  3130     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3131     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3132     12  FILLER                  PIC X      VALUE ALL 'N'.
  3133     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3134*****COMPENSATION FAX NUMBER
  3135     12  FILLER                  PIC  X(03) VALUE '182'.
  3136     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3137     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3138     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3139     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3140**** COMPENSATION STATUS
  3141     12  FILLER                  PIC XXX    VALUE '183'.
  3142     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3143     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3144     12  FILLER                  PIC X      VALUE ALL 'N'.
  3145     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3146***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3147*****COMPENSATION FULL ADDRESS TYPE 'B'
  3148     12  FILLER                  PIC  X(03) VALUE '184'.
  3149     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3150     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3151     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3152     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3153
  3154     12  FILLER                  PIC  X(03) VALUE '185'.
  3155     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3156     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3157     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3158     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3159
  3160     12  FILLER                  PIC  X(03) VALUE '186'.
  3161     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3162     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3163     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3164     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3165
  3166     12  FILLER                  PIC  X(03) VALUE '187'.
  3167     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3168     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3169     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3170     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3171
  3172     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  60
* EL689.cbl
  3173     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3174     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3175     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3176     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3177
  3178     12  FILLER                  PIC  X(03) VALUE '189'.
  3179     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3180     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3181     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3182     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3183
  3184
  3185 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3186*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3187     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3188                        INDEXED BY W-VG-NDX.
  3189         16  W-VARIABLE-ID         PIC  X(03).
  3190         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3191         16  W-VG-TEXT.
  3192             20  W-VAR-CHAR
  3193                        OCCURS 30 TIMES
  3194                        INDEXED BY W-VC-NDX
  3195                                   PIC  X(01).
  3196         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3197             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3198
  3199         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3200
  3201 01  W-VAR-END                   PIC  X(23)
  3202                        VALUE ':VARIABLE WORK AREA END'.
  3203
  3204 01  W-PROGRAM-TABLE-AREA.
  3205     12  FILLER                  PIC  X(15)
  3206                                 VALUE 'PROGRAM TABLES:'.
  3207
  3208     12  W-RECORD-TABLE              VALUE SPACES.
  3209         16  W-RC-GRP OCCURS 500 TIMES
  3210                       INDEXED BY W-RG-NDX
  3211                                  W-RG-NDX1.
  3212             20  W-RC-TEXT.
  3213                 24  W-RC-CHAR OCCURS 70 TIMES
  3214                                INDEXED BY W-RC-NDX
  3215                                           W-RC-NDX1
  3216                                 PIC  X(01).
  3217             20  W-RC-PC         PIC  9(02).
  3218             20  W-RC-SC         PIC  X(01).
  3219
  3220     12  FILLER REDEFINES W-RECORD-TABLE.
  3221         16  W-REC-CHAR OCCURS 36500 TIMES
  3222                        INDEXED BY W-RVS-NDX
  3223                                   W-RVS-NDX2
  3224                                 PIC  X(01).
  3225     12  FILLER REDEFINES W-RECORD-TABLE.
  3226         16  W-TS-GROUP OCCURS 10 TIMES
  3227                        INDEXED BY W-TS-NDX
  3228                                 PIC X(3650).
  3229
  3230     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  61
* EL689.cbl
  3231                                 VALUE 'TEXT TABLE:'.
  3232     12  W-TX-TABLE                  VALUE SPACES.
  3233         16  W-TX-GRP OCCURS 500 TIMES
  3234                       INDEXED BY W-TG-NDX
  3235                                  W-TG-NDX2.
  3236             20  W-TX-TEXT.
  3237                 24  W-TX-CHAR OCCURS 70 TIMES
  3238                                    INDEXED BY W-TX-NDX
  3239                                               W-TX-NDX1
  3240                                               W-TX-NDX2
  3241                                 PIC  X(01).
  3242             20  W-TX-PC         PIC  9(02).
  3243             20  W-TX-SC         PIC  X(01).
  3244
  3245     12  FILLER                  PIC  X(11)
  3246                                 VALUE 'FILE TABLE:'.
  3247     12  W-FILE-TABLE                VALUE SPACES.
  3248         16  W-FILE-USE-IND OCCURS 20 TIMES
  3249                       INDEXED BY W-FILE-NDX
  3250                                 PIC  X(01).
  3251             88  W-FILE-NOT-USED     VALUE SPACE.
  3252             88  W-FILE-USED         VALUE 'Y'.
  3253
  3254     12  FILLER                  PIC  X(14)
  3255                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  62
* EL689.cbl
  3257 01  ERROR-MESSAGES.
  3258     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3259     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3260     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3261     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3262     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3263     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3264     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3265     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3266     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3267     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3268     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3269     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3270     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3271     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3272     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3273     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3274     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3275     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3276     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3277     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3278     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3279     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3280     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3281     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3282     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3283     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3284     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3285     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3286     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3287     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3288     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3289     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3290     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3291     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3292     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3293     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3294     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3295     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3296     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3297     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3298     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3299     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3300     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3301     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3302     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3303     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3304     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3305     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3306     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3307     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3308     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3309     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3310     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3311     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3312     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3313     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3314     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  63
* EL689.cbl
  3315     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3316     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3317     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3318     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3319     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3320     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3321     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3322     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3323     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3324     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3325     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3326     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3327     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3328     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3329     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3330     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3331     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3332     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3333     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3334     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3335     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3336     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3337     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3338     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3339     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3340     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3341     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3342     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3343     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3344     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3345     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3346     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3347     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3348     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3349     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3350     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3351     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3352     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3353     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3354     12  ER-9427                 PIC  X(04) VALUE '9427'.
  3355     12  ER-9840                 PIC  X(04) VALUE '9840'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  64
* EL689.cbl
  3357*    COPY ELCAID.
  3358******************************************************************
  3359*                                                                *
  3360*                            ELCAID.                             *
  3361*                            VMOD=2.001                          *
  3362*                                                                *
  3363*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3364*                                                                *
  3365*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3366*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3367******************************************************************
  3368
  3369 01  DFHAID.
  3370   02  DFHNULL   PIC  X  VALUE  ' '.
  3371   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3372   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3373   02  DFHPEN    PIC  X  VALUE  '='.
  3374   02  DFHOPID   PIC  X  VALUE  'W'.
  3375   02  DFHPA1    PIC  X  VALUE  '%'.
  3376   02  DFHPA2    PIC  X  VALUE  '>'.
  3377   02  DFHPA3    PIC  X  VALUE  ','.
  3378   02  DFHPF1    PIC  X  VALUE  '1'.
  3379   02  DFHPF2    PIC  X  VALUE  '2'.
  3380   02  DFHPF3    PIC  X  VALUE  '3'.
  3381   02  DFHPF4    PIC  X  VALUE  '4'.
  3382   02  DFHPF5    PIC  X  VALUE  '5'.
  3383   02  DFHPF6    PIC  X  VALUE  '6'.
  3384   02  DFHPF7    PIC  X  VALUE  '7'.
  3385   02  DFHPF8    PIC  X  VALUE  '8'.
  3386   02  DFHPF9    PIC  X  VALUE  '9'.
  3387   02  DFHPF10   PIC  X  VALUE  ':'.
  3388   02  DFHPF11   PIC  X  VALUE  '#'.
  3389   02  DFHPF12   PIC  X  VALUE  '@'.
  3390   02  DFHPF13   PIC  X  VALUE  'A'.
  3391   02  DFHPF14   PIC  X  VALUE  'B'.
  3392   02  DFHPF15   PIC  X  VALUE  'C'.
  3393   02  DFHPF16   PIC  X  VALUE  'D'.
  3394   02  DFHPF17   PIC  X  VALUE  'E'.
  3395   02  DFHPF18   PIC  X  VALUE  'F'.
  3396   02  DFHPF19   PIC  X  VALUE  'G'.
  3397   02  DFHPF20   PIC  X  VALUE  'H'.
  3398   02  DFHPF21   PIC  X  VALUE  'I'.
  3399*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3400   02  DFHPF22   PIC  X  VALUE  '['.
  3401   02  DFHPF23   PIC  X  VALUE  '.'.
  3402   02  DFHPF24   PIC  X  VALUE  '<'.
  3403   02  DFHMSRE   PIC  X  VALUE  'X'.
  3404   02  DFHSTRF   PIC  X  VALUE  'h'.
  3405   02  DFHTRIG   PIC  X  VALUE  '"'.
  3406 01  FILLER    REDEFINES DFHAID.
  3407     12  FILLER                  PIC  X(08).
  3408     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  65
* EL689.cbl
  3410*    COPY ELCATTR.
  3411******************************************************************
  3412*                                                                *
  3413*                            ELCATTR.                            *
  3414*                            VMOD=2.001                          *
  3415*                                                                *
  3416*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3417*                                                                *
  3418*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3419*                                                                *
  3420*                   POS 1   P=PROTECTED                          *
  3421*                           U=UNPROTECTED                        *
  3422*                           S=ASKIP                              *
  3423*                   POS 2   A=ALPHA/NUMERIC                      *
  3424*                           N=NUMERIC                            *
  3425*                   POS 3   N=NORMAL                             *
  3426*                           B=BRIGHT                             *
  3427*                           D=DARK                               *
  3428*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3429*                           OF=MODIFIED DATA TAG OFF             *
  3430*                                                                *
  3431*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3432******************************************************************
  3433 01  ATTRIBUTE-LIST.
  3434     12  AL-PABOF            PIC X       VALUE 'Y'.
  3435     12  AL-PABON            PIC X       VALUE 'Z'.
  3436     12  AL-PADOF            PIC X       VALUE '%'.
  3437     12  AL-PADON            PIC X       VALUE '_'.
  3438     12  AL-PANOF            PIC X       VALUE '-'.
  3439     12  AL-PANON            PIC X       VALUE '/'.
  3440     12  AL-SABOF            PIC X       VALUE '8'.
  3441     12  AL-SABON            PIC X       VALUE '9'.
  3442     12  AL-SADOF            PIC X       VALUE '@'.
  3443     12  AL-SADON            PIC X       VALUE QUOTE.
  3444     12  AL-SANOF            PIC X       VALUE '0'.
  3445     12  AL-SANON            PIC X       VALUE '1'.
  3446     12  AL-UABOF            PIC X       VALUE 'H'.
  3447     12  AL-UABON            PIC X       VALUE 'I'.
  3448     12  AL-UADOF            PIC X       VALUE '<'.
  3449     12  AL-UADON            PIC X       VALUE '('.
  3450     12  AL-UANOF            PIC X       VALUE ' '.
  3451     12  AL-UANON            PIC X       VALUE 'A'.
  3452     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3453     12  AL-UNBON            PIC X       VALUE 'R'.
  3454     12  AL-UNDOF            PIC X       VALUE '*'.
  3455     12  AL-UNDON            PIC X       VALUE ')'.
  3456     12  AL-UNNOF            PIC X       VALUE '&'.
  3457     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  66
* EL689.cbl
  3459*    COPY ELCDATE.
  3460******************************************************************
  3461*                                                                *
  3462*                                                                *
  3463*                            ELCDATE.                            *
  3464*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3465*                            VMOD=2.003
  3466*                                                                *
  3467*                                                                *
  3468*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3469*                 LENGTH = 200                                   *
  3470******************************************************************
  3471
  3472 01  DATE-CONVERSION-DATA.
  3473     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3474     12  DC-OPTION-CODE                PIC X.
  3475         88  BIN-TO-GREG                VALUE ' '.
  3476         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3477         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3478         88  YMD-GREG-TO-BIN            VALUE '3'.
  3479         88  MDY-GREG-TO-BIN            VALUE '4'.
  3480         88  JULIAN-TO-BIN              VALUE '5'.
  3481         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3482         88  FIND-CENTURY               VALUE '7'.
  3483         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3484         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3485         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3486         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3487         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3488         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3489         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3490         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3491         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3492         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3493         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3494         88  BIN-3-TO-GREG              VALUE 'I'.
  3495         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3496         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3497         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3498         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3499         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3500         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3501         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3502         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3503         88  THREE-CHARACTER-BIN
  3504                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3505         88  GREGORIAN-TO-BIN
  3506                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3507         88  BIN-TO-GREGORIAN
  3508                  VALUES ' ' '1' 'I' '8' 'G'.
  3509         88  JULIAN-TO-BINARY
  3510                  VALUES '5' 'C' 'E' 'F'.
  3511     12  DC-ERROR-CODE                 PIC X.
  3512         88  NO-CONVERSION-ERROR        VALUE ' '.
  3513         88  DATE-CONVERSION-ERROR
  3514                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3515         88  DATE-IS-ZERO               VALUE '1'.
  3516         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  67
* EL689.cbl
  3517         88  DATE-IS-INVALID            VALUE '3'.
  3518         88  DATE1-GREATER-DATE2        VALUE '4'.
  3519         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3520         88  DATE-INVALID-OPTION        VALUE '9'.
  3521         88  INVALID-CENTURY            VALUE 'A'.
  3522         88  ONLY-CENTURY               VALUE 'B'.
  3523         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3524         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3525     12  DC-END-OF-MONTH               PIC X.
  3526         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3527     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3528         88  USE-NORMAL-PROCESS         VALUE ' '.
  3529         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3530         88  ADJUST-UP-100-YRS          VALUE '2'.
  3531     12  FILLER                        PIC X.
  3532     12  DC-CONVERSION-DATES.
  3533         16  DC-BIN-DATE-1             PIC XX.
  3534         16  DC-BIN-DATE-2             PIC XX.
  3535         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3536         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3537                       DC-GREG-DATE-1-EDIT.
  3538             20  DC-EDIT1-MONTH        PIC 99.
  3539             20  SLASH1-1              PIC X.
  3540             20  DC-EDIT1-DAY          PIC 99.
  3541             20  SLASH1-2              PIC X.
  3542             20  DC-EDIT1-YEAR         PIC 99.
  3543         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3544         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3545                     DC-GREG-DATE-2-EDIT.
  3546             20  DC-EDIT2-MONTH        PIC 99.
  3547             20  SLASH2-1              PIC X.
  3548             20  DC-EDIT2-DAY          PIC 99.
  3549             20  SLASH2-2              PIC X.
  3550             20  DC-EDIT2-YEAR         PIC 99.
  3551         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3552         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3553                     DC-GREG-DATE-1-YMD.
  3554             20  DC-YMD-YEAR           PIC 99.
  3555             20  DC-YMD-MONTH          PIC 99.
  3556             20  DC-YMD-DAY            PIC 99.
  3557         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3558         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3559                      DC-GREG-DATE-1-MDY.
  3560             20  DC-MDY-MONTH          PIC 99.
  3561             20  DC-MDY-DAY            PIC 99.
  3562             20  DC-MDY-YEAR           PIC 99.
  3563         16  DC-GREG-DATE-1-ALPHA.
  3564             20  DC-ALPHA-MONTH        PIC X(10).
  3565             20  DC-ALPHA-DAY          PIC 99.
  3566             20  FILLER                PIC XX.
  3567             20  DC-ALPHA-CENTURY.
  3568                 24 DC-ALPHA-CEN-N     PIC 99.
  3569             20  DC-ALPHA-YEAR         PIC 99.
  3570         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3571         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3572         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3573         16  DC-JULIAN-DATE            PIC 9(05).
  3574         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  68
* EL689.cbl
  3575                                       PIC 9(05).
  3576         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3577             20  DC-JULIAN-YEAR        PIC 99.
  3578             20  DC-JULIAN-DAYS        PIC 999.
  3579         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3580         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3581         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3582     12  DATE-CONVERSION-VARIBLES.
  3583         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3584         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3585             20  FILLER                PIC 9(3).
  3586             20  HOLD-CEN-1-CCYY.
  3587                 24  HOLD-CEN-1-CC     PIC 99.
  3588                 24  HOLD-CEN-1-YY     PIC 99.
  3589             20  HOLD-CEN-1-MO         PIC 99.
  3590             20  HOLD-CEN-1-DA         PIC 99.
  3591         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3592             20  HOLD-CEN-1-R-MO       PIC 99.
  3593             20  HOLD-CEN-1-R-DA       PIC 99.
  3594             20  HOLD-CEN-1-R-CCYY.
  3595                 24  HOLD-CEN-1-R-CC   PIC 99.
  3596                 24  HOLD-CEN-1-R-YY   PIC 99.
  3597             20  FILLER                PIC 9(3).
  3598         16  HOLD-CENTURY-1-X.
  3599             20  FILLER                PIC X(3)  VALUE SPACES.
  3600             20  HOLD-CEN-1-X-CCYY.
  3601                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3602                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3603             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3604             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3605         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3606             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3607             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3608             20  HOLD-CEN-1-R-X-CCYY.
  3609                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3610                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3611             20  FILLER                PIC XXX.
  3612         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3613         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3614         16  DC-JULIAN-DATE-1          PIC 9(07).
  3615         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3616             20  DC-JULIAN-1-CCYY.
  3617                 24  DC-JULIAN-1-CC    PIC 99.
  3618                 24  DC-JULIAN-1-YR    PIC 99.
  3619             20  DC-JULIAN-DA-1        PIC 999.
  3620         16  DC-JULIAN-DATE-2          PIC 9(07).
  3621         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3622             20  DC-JULIAN-2-CCYY.
  3623                 24  DC-JULIAN-2-CC    PIC 99.
  3624                 24  DC-JULIAN-2-YR    PIC 99.
  3625             20  DC-JULIAN-DA-2        PIC 999.
  3626         16  DC-GREG-DATE-A-EDIT.
  3627             20  DC-EDITA-MONTH        PIC 99.
  3628             20  SLASHA-1              PIC X VALUE '/'.
  3629             20  DC-EDITA-DAY          PIC 99.
  3630             20  SLASHA-2              PIC X VALUE '/'.
  3631             20  DC-EDITA-CCYY.
  3632                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  69
* EL689.cbl
  3633                 24  DC-EDITA-YEAR     PIC 99.
  3634         16  DC-GREG-DATE-B-EDIT.
  3635             20  DC-EDITB-MONTH        PIC 99.
  3636             20  SLASHB-1              PIC X VALUE '/'.
  3637             20  DC-EDITB-DAY          PIC 99.
  3638             20  SLASHB-2              PIC X VALUE '/'.
  3639             20  DC-EDITB-CCYY.
  3640                 24  DC-EDITB-CENT     PIC 99.
  3641                 24  DC-EDITB-YEAR     PIC 99.
  3642         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3643         16  DC-GREG-DATE-CYMD-R REDEFINES
  3644                              DC-GREG-DATE-CYMD.
  3645             20  DC-CYMD-CEN           PIC 99.
  3646             20  DC-CYMD-YEAR          PIC 99.
  3647             20  DC-CYMD-MONTH         PIC 99.
  3648             20  DC-CYMD-DAY           PIC 99.
  3649         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3650         16  DC-GREG-DATE-MDCY-R REDEFINES
  3651                              DC-GREG-DATE-MDCY.
  3652             20  DC-MDCY-MONTH         PIC 99.
  3653             20  DC-MDCY-DAY           PIC 99.
  3654             20  DC-MDCY-CEN           PIC 99.
  3655             20  DC-MDCY-YEAR          PIC 99.
  3656    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3657        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3658    12  DC-EL310-DATE                  PIC X(21).
  3659    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  70
* EL689.cbl
  3661*    COPY ELCNWA.
  3662*****************************************************************
  3663*                                                               *
  3664*                                                               *
  3665*                            ELCNWA.                            *
  3666*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3667*                            VMOD=2.003                         *
  3668*                                                               *
  3669*            M O V E   N A M E   W O R K   A R E A.             *
  3670*                                                               *
  3671*****************************************************************.
  3672
  3673 01  WS-NAME-WORK-AREA.
  3674     05  WS-INSURED-LAST-NAME        PIC X(15).
  3675     05  WS-INSURED-1ST-NAME         PIC X(12).
  3676     05  WS-INSURED-MID-INIT         PIC X.
  3677
  3678     05  WS-NAME-WORK.
  3679         10  WS-NW                   PIC X
  3680             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3681
  3682     05  WS-NAME-WORK2.
  3683         10  WS-NW2                  PIC X
  3684             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3685                                        NWA-INDEX0.
  3686
  3687     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3688                                     COMP-3.
  3689
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  71
* EL689.cbl
  3691*    COPY ELCEMIB.
  3692******************************************************************
  3693*                                                                *
  3694*                                                                *
  3695*                            ELCEMIB.                            *
  3696*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3697*                            VMOD=2.005                          *
  3698*                                                                *
  3699*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3700*                                                                *
  3701******************************************************************
  3702 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3703     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3704     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3705     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3706     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3707     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3708     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3709     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3710     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3711     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3712         88  EMI-NO-ERRORS                    VALUE '1'.
  3713         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3714         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3715     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3716         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3717     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3718         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3719         88  EMI-AREA1-FULL                   VALUE '2'.
  3720     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3721         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3722         88  EMI-AREA2-FULL                   VALUE '2'.
  3723     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3724         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3725         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3726         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3727         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3728         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3729     12  EMI-ERROR-LINES.
  3730         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3731         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3732         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3733         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3734             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3735                 24  EMI-ERR-NUM         PIC X(4).
  3736                 24  EMI-FILLER          PIC X.
  3737                 24  EMI-SEV             PIC X.
  3738                 24  FILLER              PIC X.
  3739             20  FILLER                  PIC X(02).
  3740     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3741         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3742             20  EMI-ERROR-NUMBER    PIC X(4).
  3743             20  EMI-FILL            PIC X.
  3744             20  EMI-SEVERITY        PIC X.
  3745             20  FILLER              PIC X.
  3746             20  EMI-ERROR-TEXT.
  3747                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3748                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  72
* EL689.cbl
  3749     12  EMI-SEVERITY-SAVE           PIC X.
  3750         88  EMI-NOTE                    VALUE 'N'.
  3751         88  EMI-WARNING                 VALUE 'W'.
  3752         88  EMI-FORCABLE                VALUE 'F'.
  3753         88  EMI-FATAL                   VALUE 'X'.
  3754     12  EMI-MESSAGE-FLAG            PIC X.
  3755         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3756         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3757     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3758     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3759         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3760         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3761         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3762     12  FILLER                      PIC X(137)  VALUE SPACES.
  3763     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3764     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3765     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3766     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3767 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  73
* EL689.cbl
  3769*    COPY ELCLOGOF.
  3770******************************************************************
  3771*                                                                *
  3772*                                                                *
  3773*                            ELCLOGOF.                           *
  3774*                            VMOD=2.001                          *
  3775*                                                                *
  3776*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3777*                                                                *
  3778******************************************************************
  3779 01  CLASIC-LOGOFF.
  3780     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3781     12  LOGOFF-TEXT.
  3782         16  FILLER          PIC X(5)    VALUE SPACES.
  3783         16  LOGOFF-MSG.
  3784             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3785             20  FILLER      PIC X       VALUE SPACES.
  3786             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3787         16  FILLER          PIC X(80)
  3788           VALUE '* YOU ARE NOW LOGGED OFF'.
  3789         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3790         16  FILLER          PIC X       VALUE QUOTE.
  3791         16  LOGOFF-SYS-MSG  PIC X(17)
  3792           VALUE 'S CLAS-IC SYSTEM '.
  3793     12  TEXT-MESSAGES.
  3794         16  UNACCESS-MSG    PIC X(29)
  3795             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3796         16  PGMIDERR-MSG    PIC X(17)
  3797             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  74
* EL689.cbl
  3799*    COPY ELCSCTM.
  3800******************************************************************
  3801*                                                                *
  3802*                                                                *
  3803*                            ELCSCTM                             *
  3804*                            VMOD=2.001                          *
  3805*                                                                *
  3806*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3807*                                                                *
  3808******************************************************************
  3809 01  SECURITY-MESSAGE.
  3810     12  FILLER                          PIC X(30)
  3811            VALUE '** LOGIC SECURITY VIOLATION -'.
  3812     12  SM-READ                         PIC X(6).
  3813     12  FILLER                          PIC X(5)
  3814            VALUE ' PGM='.
  3815     12  SM-PGM                          PIC X(6).
  3816     12  FILLER                          PIC X(5)
  3817            VALUE ' OPR='.
  3818     12  SM-PROCESSOR-ID                 PIC X(4).
  3819     12  FILLER                          PIC X(6)
  3820            VALUE ' TERM='.
  3821     12  SM-TERMID                       PIC X(4).
  3822     12  FILLER                          PIC XX   VALUE SPACE.
  3823     12  SM-JUL-DATE                     PIC 9(5).
  3824     12  FILLER                          PIC X    VALUE SPACE.
  3825     12  SM-TIME                         PIC 99.99.
  3826
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  75
* EL689.cbl
  3828*    COPY ELCSCRTY.
  3829******************************************************************
  3830*                                                                *
  3831*                                                                *
  3832*                            ELCSCRTY                            *
  3833*                            VMOD=2.001                          *
  3834*                                                                *
  3835*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3836*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3837*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3838*                                                                *
  3839******************************************************************
  3840 01  SECURITY-CONTROL.
  3841     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3842     12  FILLER                       PIC XX    VALUE 'SC'.
  3843     12  SC-CREDIT-CODES.
  3844         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3845             20  SC-CREDIT-DISPLAY    PIC X.
  3846             20  SC-CREDIT-UPDATE     PIC X.
  3847     12  SC-CLAIMS-CODES.
  3848         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3849             20  SC-CLAIMS-DISPLAY    PIC X.
  3850             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  76
* EL689.cbl
  3852
  3853 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  77
* EL689.cbl
  3855****************************************************************
  3856*
  3857* Copyright (c) 2007 by Clerity Solutions, Inc.
  3858* All rights reserved.
  3859*
  3860****************************************************************
  3861 01  DFHEIV.
  3862   02  DFHEIV0               PIC X(35).
  3863   02  DFHEIV1               PIC X(08).
  3864   02  DFHEIV2               PIC X(08).
  3865   02  DFHEIV3               PIC X(08).
  3866   02  DFHEIV4               PIC X(06).
  3867   02  DFHEIV5               PIC X(04).
  3868   02  DFHEIV6               PIC X(04).
  3869   02  DFHEIV7               PIC X(02).
  3870   02  DFHEIV8               PIC X(02).
  3871   02  DFHEIV9               PIC X(01).
  3872   02  DFHEIV10              PIC S9(7) COMP-3.
  3873   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3874   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3875   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3876   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3877   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3878   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3879   02  DFHEIV17              PIC X(04).
  3880   02  DFHEIV18              PIC X(04).
  3881   02  DFHEIV19              PIC X(04).
  3882   02  DFHEIV20              USAGE IS POINTER.
  3883   02  DFHEIV21              USAGE IS POINTER.
  3884   02  DFHEIV22              USAGE IS POINTER.
  3885   02  DFHEIV23              USAGE IS POINTER.
  3886   02  DFHEIV24              USAGE IS POINTER.
  3887   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3888   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3889   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3890   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3891   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3892   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3893   02  FILLER                PIC X(02).
  3894   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3895   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3896   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3897   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3898   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3899 LINKAGE  SECTION.
  3900*****************************************************************
  3901*                                                               *
  3902* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3903* All rights reserved.                                          *
  3904*                                                               *
  3905*****************************************************************
  3906 01  dfheiblk.
  3907     02  eibtime          pic s9(7) comp-3.
  3908     02  eibdate          pic s9(7) comp-3.
  3909     02  eibtrnid         pic x(4).
  3910     02  eibtaskn         pic s9(7) comp-3.
  3911     02  eibtrmid         pic x(4).
  3912     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  78
* EL689.cbl
  3913     02  eibcposn         pic s9(4) comp.
  3914     02  eibcalen         pic s9(4) comp.
  3915     02  eibaid           pic x(1).
  3916     02  eibfiller1       pic x(1).
  3917     02  eibfn            pic x(2).
  3918     02  eibfiller2       pic x(2).
  3919     02  eibrcode         pic x(6).
  3920     02  eibfiller3       pic x(2).
  3921     02  eibds            pic x(8).
  3922     02  eibreqid         pic x(8).
  3923     02  eibrsrce         pic x(8).
  3924     02  eibsync          pic x(1).
  3925     02  eibfree          pic x(1).
  3926     02  eibrecv          pic x(1).
  3927     02  eibsend          pic x(1).
  3928     02  eibatt           pic x(1).
  3929     02  eibeoc           pic x(1).
  3930     02  eibfmh           pic x(1).
  3931     02  eibcompl         pic x(1).
  3932     02  eibsig           pic x(1).
  3933     02  eibconf          pic x(1).
  3934     02  eiberr           pic x(1).
  3935     02  eibrldbk         pic x(1).
  3936     02  eiberrcd         pic x(4).
  3937     02  eibsynrb         pic x(1).
  3938     02  eibnodat         pic x(1).
  3939     02  eibfiller5       pic x(2).
  3940     02  eibresp          pic 9(09) comp.
  3941     02  eibresp2         pic 9(09) comp.
  3942     02  dfheigdj         pic s9(4) comp.
  3943     02  dfheigdk         pic s9(4) comp.
  3944 01  DFHCOMMAREA                 PIC X(1024).
  3945 01  var  pic x(30).
  3946
  3947*    COPY ERCACCT.
  3948******************************************************************
  3949*                                                                *
  3950*                                                                *
  3951*                            ERCACCT                             *
  3952*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3953*                            VMOD=2.031                          *
  3954*                                                                *
  3955*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3956*                                                                *
  3957*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3958*   VSAM ACCOUNT MASTER FILES.                                   *
  3959*                                                                *
  3960*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3961*                                                                *
  3962*   FILE TYPE = VSAM,KSDS                                        *
  3963*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3964*                                                                *
  3965*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3966*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3967*                                                                *
  3968*   LOG = NO                                                     *
  3969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3970*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  79
* EL689.cbl
  3971*                                                                *
  3972******************************************************************
  3973*                   C H A N G E   L O G
  3974*
  3975* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3976*-----------------------------------------------------------------
  3977*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3978* EFFECTIVE    NUMBER
  3979*-----------------------------------------------------------------
  3980* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3981* 092705    2005050300006  PEMA  ADD SPP LEASES
  3982* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3983* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3984* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3985* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3986* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3987******************************************************************
  3988
  3989 01  ACCOUNT-MASTER.
  3990     12  AM-RECORD-ID                      PIC XX.
  3991         88  VALID-AM-ID                      VALUE 'AM'.
  3992
  3993     12  AM-CONTROL-PRIMARY.
  3994         16  AM-COMPANY-CD                 PIC X.
  3995         16  AM-MSTR-CNTRL.
  3996             20  AM-CONTROL-A.
  3997                 24  AM-CARRIER            PIC X.
  3998                 24  AM-GROUPING.
  3999                     28 AM-GROUPING-PREFIX PIC XXX.
  4000                     28 AM-GROUPING-PRIME  PIC XXX.
  4001                 24  AM-STATE              PIC XX.
  4002                 24  AM-ACCOUNT.
  4003                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4004                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4005             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4006                                           PIC X(19).
  4007             20  AM-CNTRL-B.
  4008                 24  AM-EXPIRATION-DT      PIC XX.
  4009                 24  FILLER                PIC X(4).
  4010             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4011                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4012
  4013     12  AM-CONTROL-BY-VAR-GRP.
  4014         16  AM-COMPANY-CD-A1              PIC X.
  4015         16  AM-VG-CARRIER                 PIC X.
  4016         16  AM-VG-GROUPING                PIC X(6).
  4017         16  AM-VG-STATE                   PIC XX.
  4018         16  AM-VG-ACCOUNT                 PIC X(10).
  4019         16  AM-VG-DATE.
  4020             20  AM-VG-EXPIRATION-DT       PIC XX.
  4021             20  FILLER                    PIC X(4).
  4022         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4023                                           PIC 9(11)      COMP-3.
  4024     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4025         16  FILLER                        PIC X(10).
  4026         16  AM-VG-KEY3.
  4027             20  AM-VG3-ACCOUNT            PIC X(10).
  4028             20  AM-VG3-EXP-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  80
* EL689.cbl
  4029         16  FILLER                        PIC X(4).
  4030     12  AM-MAINT-INFORMATION.
  4031         16  AM-LAST-MAINT-DT              PIC XX.
  4032         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4033         16  AM-LAST-MAINT-USER            PIC X(4).
  4034         16  FILLER                        PIC XX.
  4035
  4036     12  AM-EFFECTIVE-DT                   PIC XX.
  4037     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4038
  4039     12  AM-PREV-DATES  COMP-3.
  4040         16  AM-PREV-EXP-DT                PIC 9(11).
  4041         16  AM-PREV-EFF-DT                PIC 9(11).
  4042
  4043     12  AM-REPORT-CODE-1                  PIC X(10).
  4044     12  AM-REPORT-CODE-2                  PIC X(10).
  4045
  4046     12  AM-CITY-CODE                      PIC X(4).
  4047     12  AM-COUNTY-PARISH                  PIC X(6).
  4048
  4049     12  AM-NAME                           PIC X(30).
  4050     12  AM-PERSON                         PIC X(30).
  4051     12  AM-ADDRS                          PIC X(30).
  4052     12  AM-CITY.
  4053         16  AM-ADDR-CITY                  PIC X(28).
  4054         16  AM-ADDR-STATE                 PIC XX.
  4055     12  AM-ZIP.
  4056         16  AM-ZIP-PRIME.
  4057             20  AM-ZIP-PRI-1ST            PIC X.
  4058                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4059             20  FILLER                    PIC X(4).
  4060         16  AM-ZIP-PLUS4                  PIC X(4).
  4061     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4062         16  AM-CAN-POSTAL-1               PIC XXX.
  4063         16  AM-CAN-POSTAL-2               PIC XXX.
  4064         16  FILLER                        PIC XXX.
  4065     12  AM-TEL-NO.
  4066         16  AM-AREA-CODE                  PIC 999.
  4067         16  AM-TEL-PRE                    PIC 999.
  4068         16  AM-TEL-NBR                    PIC 9(4).
  4069     12  AM-TEL-LOC                        PIC X.
  4070         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4071         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4072
  4073     12  AM-COMM-STRUCTURE.
  4074         16  AM-DEFN-1.
  4075             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4076                 24  AM-AGT.
  4077                     28  AM-AGT-PREFIX     PIC X(4).
  4078                     28  AM-AGT-PRIME      PIC X(6).
  4079                 24  AM-COM-TYP            PIC X.
  4080                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4081                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4082                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4083                 24  AM-RECALC-LV-INDIC    PIC X.
  4084                 24  AM-RETRO-LV-INDIC     PIC X.
  4085                 24  AM-GL-CODES           PIC X.
  4086                 24  AM-COMM-CHARGEBACK    PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  81
* EL689.cbl
  4087                 24  FILLER                PIC X(01).
  4088         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4089             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4090                 24  FILLER                PIC X(11).
  4091                 24  AM-L-COMA             PIC XXX.
  4092                 24  AM-J-COMA             PIC XXX.
  4093                 24  AM-A-COMA             PIC XXX.
  4094                 24  FILLER                PIC X(6).
  4095
  4096     12  AM-COMM-CHANGE-STATUS             PIC X.
  4097         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4098
  4099     12  AM-CSR-CODE                       PIC X(4).
  4100
  4101     12  AM-BILLING-STATUS                 PIC X.
  4102         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4103         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4104     12  AM-AUTO-REFUND-SW                 PIC X.
  4105         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4106         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4107     12  AM-GPCD                           PIC 99.
  4108     12  AM-IG                             PIC X.
  4109         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4110         88  AM-HAS-GROUP                     VALUE '2'.
  4111     12  AM-STATUS                         PIC X.
  4112         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4113         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4114         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4115         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4116         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4117         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4118     12  AM-REMIT-TO                       PIC 99.
  4119     12  AM-ID-NO                          PIC X(11).
  4120
  4121     12  AM-CAL-TABLE                      PIC XX.
  4122     12  AM-LF-DEVIATION                   PIC XXX.
  4123     12  AM-AH-DEVIATION                   PIC XXX.
  4124     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4125     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4126     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4127     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4128     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4129     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4130
  4131     12  AM-USER-FIELDS.
  4132         16  AM-FLD-1                      PIC XX.
  4133         16  AM-FLD-2                      PIC XX.
  4134         16  AM-FLD-3                      PIC XX.
  4135         16  AM-FLD-4                      PIC XX.
  4136         16  AM-FLD-5                      PIC XX.
  4137
  4138     12  AM-1ST-PROD-DATE.
  4139         16  AM-1ST-PROD-YR                PIC XX.
  4140         16  AM-1ST-PROD-MO                PIC XX.
  4141         16  AM-1ST-PROD-DA                PIC XX.
  4142     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4143     12  AM-CERTS-PURGED-DATE.
  4144         16  AM-PUR-YR                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  82
* EL689.cbl
  4145         16  AM-PUR-MO                     PIC XX.
  4146         16  AM-PUR-DA                     PIC XX.
  4147     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4148     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4149     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4150     12  AM-INACTIVE-DATE.
  4151         16  AM-INA-MO                     PIC 99.
  4152         16  AM-INA-DA                     PIC 99.
  4153         16  AM-INA-YR                     PIC 99.
  4154     12  AM-AR-HI-CERT-DATE                PIC XX.
  4155
  4156     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4157     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4158
  4159     12  AM-OB-PAYMENT-MODE                PIC X.
  4160         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4161         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4162         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4163         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4164
  4165     12  AM-AH-ONLY-INDICATOR              PIC X.
  4166         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4167         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4168
  4169     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4170
  4171     12  AM-OVER-SHORT.
  4172         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4173         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4174
  4175     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4176     12  AM-DCC-CLP-STATE                  PIC XX.
  4177
  4178     12  AM-RECALC-COMM                    PIC X.
  4179     12  AM-RECALC-REIN                    PIC X.
  4180
  4181     12  AM-REI-TABLE                      PIC XXX.
  4182     12  AM-REI-ET-LF                      PIC X.
  4183     12  AM-REI-ET-AH                      PIC X.
  4184     12  AM-REI-PE-LF                      PIC X.
  4185     12  AM-REI-PE-AH                      PIC X.
  4186     12  AM-REI-PRT-ST                     PIC X.
  4187     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4188     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4189     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4190     12  AM-REI-GROUP-A                    PIC X(6).
  4191     12  AM-REI-MORT                       PIC X(4).
  4192     12  AM-REI-PRT-OW                     PIC X.
  4193     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4194     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4195     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4196     12  AM-REI-GROUP-B                    PIC X(6).
  4197
  4198     12  AM-TRUST-TYPE                     PIC X(2).
  4199
  4200     12  AM-EMPLOYER-STMT-USED             PIC X.
  4201     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4202
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  83
* EL689.cbl
  4203     12  AM-STD-AH-TYPE                    PIC XX.
  4204     12  AM-EARN-METHODS.
  4205         16  AM-EARN-METHOD-R              PIC X.
  4206             88 AM-REF-RL-R78                 VALUE 'R'.
  4207             88 AM-REF-RL-PR                  VALUE 'P'.
  4208             88 AM-REF-RL-MEAN                VALUE 'M'.
  4209             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4210         16  AM-EARN-METHOD-L              PIC X.
  4211             88 AM-REF-LL-R78                 VALUE 'R'.
  4212             88 AM-REF-LL-PR                  VALUE 'P'.
  4213             88 AM-REF-LL-MEAN                VALUE 'M'.
  4214             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4215         16  AM-EARN-METHOD-A              PIC X.
  4216             88 AM-REF-AH-R78                 VALUE 'R'.
  4217             88 AM-REF-AH-PR                  VALUE 'P'.
  4218             88 AM-REF-AH-MEAN                VALUE 'M'.
  4219             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4220             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4221             88 AM-REF-AH-NET                 VALUE 'N'.
  4222
  4223     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4224     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4225     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4226
  4227     12  AM-RET-Y-N                        PIC X.
  4228     12  AM-RET-P-E                        PIC X.
  4229     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4230     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4231     12  AM-RET-GRP                        PIC X(6).
  4232     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4233         16  AM-POOL-PRIME                 PIC XXX.
  4234         16  AM-POOL-SUB                   PIC XXX.
  4235     12  AM-RETRO-EARNINGS.
  4236         16  AM-RET-EARN-R                 PIC X.
  4237         16  AM-RET-EARN-L                 PIC X.
  4238         16  AM-RET-EARN-A                 PIC X.
  4239     12  AM-RET-ST-TAX-USE                 PIC X.
  4240         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4241         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4242     12  AM-RETRO-BEG-EARNINGS.
  4243         16  AM-RET-BEG-EARN-R             PIC X.
  4244         16  AM-RET-BEG-EARN-L             PIC X.
  4245         16  AM-RET-BEG-EARN-A             PIC X.
  4246     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4247     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4248
  4249     12  AM-USER-SELECT-OPTIONS.
  4250         16  AM-USER-SELECT-1              PIC X(10).
  4251         16  AM-USER-SELECT-2              PIC X(10).
  4252         16  AM-USER-SELECT-3              PIC X(10).
  4253         16  AM-USER-SELECT-4              PIC X(10).
  4254         16  AM-USER-SELECT-5              PIC X(10).
  4255
  4256     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4257
  4258     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4259
  4260     12  AM-RPT045A-SWITCH                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  84
* EL689.cbl
  4261         88  RPT045A-OFF                   VALUE 'N'.
  4262
  4263     12  AM-INSURANCE-LIMITS.
  4264         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4265         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4266
  4267     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4268         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4269
  4270     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4271         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4272         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4273
  4274     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4275
  4276     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4277     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4278     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4279     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4280     12  AM-DCC-UEF-STATE                  PIC XX.
  4281     12  FILLER                            PIC XXX.
  4282     12  AM-REPORT-CODE-3                  PIC X(10).
  4283*    12  FILLER                            PIC X(22).
  4284
  4285     12  AM-RESERVE-DATE.
  4286         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4287         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4288         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4289
  4290     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4291     12  AM-NOTIFICATION-TYPES.
  4292         16  AM-NOTIF-OF-LETTERS           PIC X.
  4293         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4294         16  AM-NOTIF-OF-REPORTS           PIC X.
  4295         16  AM-NOTIF-OF-STATUS            PIC X.
  4296
  4297     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4298         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4299         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4300         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4301         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4302
  4303     12  AM-BENEFIT-CONTROLS.
  4304         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4305             20  AM-BENEFIT-CODE           PIC XX.
  4306             20  AM-BENEFIT-TYPE           PIC X.
  4307             20  AM-BENEFIT-REVISION       PIC XXX.
  4308             20  AM-BENEFIT-REM-TERM       PIC X.
  4309             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4310             20  FILLER                    PIC XX.
  4311         16  FILLER                        PIC X(80).
  4312
  4313     12  AM-TRANSFER-DATA.
  4314         16  AM-TRANSFERRED-FROM.
  4315             20  AM-TRNFROM-CARRIER        PIC X.
  4316             20  AM-TRNFROM-GROUPING.
  4317                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4318                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  85
* EL689.cbl
  4319             20  AM-TRNFROM-STATE          PIC XX.
  4320             20  AM-TRNFROM-ACCOUNT.
  4321                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4322                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4323             20  AM-TRNFROM-DTE            PIC XX.
  4324         16  AM-TRANSFERRED-TO.
  4325             20  AM-TRNTO-CARRIER          PIC X.
  4326             20  AM-TRNTO-GROUPING.
  4327                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4328                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4329             20  AM-TRNTO-STATE            PIC XX.
  4330             20  AM-TRNTO-ACCOUNT.
  4331                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4332                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4333             20  AM-TRNTO-DTE              PIC XX.
  4334         16  FILLER                        PIC X(10).
  4335
  4336     12  AM-SAVED-REMIT-TO                 PIC 99.
  4337
  4338     12  AM-COMM-STRUCTURE-SAVED.
  4339         16  AM-DEFN-1-SAVED.
  4340             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4341                 24  AM-AGT-SV             PIC X(10).
  4342                 24  AM-COM-TYP-SV         PIC X.
  4343                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4344                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4345                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4346                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4347                 24  FILLER                PIC X.
  4348                 24  AM-GL-CODES-SV        PIC X.
  4349                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4350                 24  FILLER                PIC X.
  4351         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4352             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4353                 24  FILLER                PIC X(11).
  4354                 24  AM-L-COMA-SV          PIC XXX.
  4355                 24  AM-J-COMA-SV          PIC XXX.
  4356                 24  AM-A-COMA-SV          PIC XXX.
  4357                 24  FILLER                PIC X(6).
  4358
  4359     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4360         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4361            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4362            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4363            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4364
  4365     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4366     12  FILLER                            PIC X(120).
  4367
  4368     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4369         16  AM-CONTROL-NAME               PIC X(30).
  4370         16  AM-EXECUTIVE-ONE.
  4371             20  AM-EXEC1-NAME             PIC X(15).
  4372             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4373                                                          COMP-3.
  4374             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4375                                                          COMP-3.
  4376         16  AM-EXECUTIVE-TWO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  86
* EL689.cbl
  4377             20  AM-EXEC2-NAME             PIC X(15).
  4378             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4379                                                          COMP-3.
  4380             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4381                                                          COMP-3.
  4382
  4383     12  AM-RETRO-ADDITIONAL-DATA.
  4384         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4385         16  AM-RETRO-PREM-P-E             PIC X.
  4386         16  AM-RETRO-CLMS-P-I             PIC X.
  4387         16  AM-RETRO-RET-BRACKET-LF.
  4388             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4389                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4390                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4391             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4392                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4393                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4394             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4395                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4396                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4397         16  AM-RETRO-RET-BRACKET-AH.
  4398             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4399                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4400                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4401                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4402             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4403                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4404                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4405             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4406                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4407                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4408
  4409     12  AM-COMMENTS.
  4410         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4411
  4412     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4413         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4414         16  AM-FLI-BILLING-CODE           PIC X.
  4415         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4416         16  AM-FLI-UNITED-IDENT           PIC X.
  4417         16  AM-FLI-INTEREST-LOST-DATA.
  4418             20  AM-FLI-BANK-NO            PIC X(5).
  4419             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4420             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4421             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4422         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4423             20  AM-FLI-AGT                PIC X(9).
  4424             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4425             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4426         16  FILLER                        PIC X(102).
  4427
  4428     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4429         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4430             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4431             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4432             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4433             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4434             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  87
* EL689.cbl
  4435         16  FILLER                          PIC X(10).
  4436******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  88
* EL689.cbl
  4438*    COPY ERCARCH.
  4439******************************************************************
  4440*                                                                *
  4441*                            ERCARCH.                            *
  4442*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4443*                            VMOD=2.002                          *
  4444*                                                                *
  4445*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4446*                                                                *
  4447*   FILE TYPE = VSAM,KSDS                                        *
  4448*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4449*                                                                *
  4450*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4451*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4452*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4453*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4454*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4455*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4456*                                                                *
  4457*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4458******************************************************************
  4459*                   C H A N G E   L O G
  4460*
  4461* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4462*-----------------------------------------------------------------
  4463*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4464* EFFECTIVE    NUMBER
  4465*-----------------------------------------------------------------
  4466* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4467* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4468* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4469******************************************************************
  4470 01  LETTER-ARCHIVE.
  4471     12  LA-RECORD-ID                PIC  X(02).
  4472         88  LA-VALID-ID                VALUE 'LA'.
  4473
  4474     12  LA-CONTROL-PRIMARY.
  4475         16  LA-COMPANY-CD           PIC  X(01).
  4476         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4477
  4478     12  LA-CONTROL-BY-CERT-RESP.
  4479         16  LA-COMPANY-CD-A2        PIC  X(01).
  4480         16  LA-CERT-NO-A2.
  4481             20  LA-CERT-PRIME-A2    PIC  X(10).
  4482             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4483         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4484             20  LA-RESP-PERSON-A2   PIC  X(10).
  4485             20  LA-TYPE-A2          PIC  X(01).
  4486         16  LA-CARRIER-A2           PIC  X(01).
  4487         16  LA-GROUPING-A2          PIC  X(06).
  4488         16  LA-STATE-A2             PIC  X(02).
  4489         16  LA-ACCOUNT-A2           PIC  X(10).
  4490         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4491         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4492
  4493     12  LA-CONTROL-BY-FORM.
  4494         16  LA-COMPANY-CD-A3        PIC  X(01).
  4495         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  89
* EL689.cbl
  4496         16  LA-CARRIER-A3           PIC  X(01).
  4497         16  LA-GROUPING-A3          PIC  X(06).
  4498         16  LA-STATE-A3             PIC  X(02).
  4499         16  LA-ACCOUNT-A3           PIC  X(10).
  4500         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4501
  4502     12  LA-CONTROL-BY-PROCESSOR.
  4503         16  LA-COMPANY-CD-A4        PIC  X(01).
  4504         16  LA-PROCESSOR-CD         PIC  X(04).
  4505         16  LA-CARRIER-A4           PIC  X(01).
  4506         16  LA-GROUPING-A4          PIC  X(06).
  4507         16  LA-STATE-A4             PIC  X(02).
  4508         16  LA-ACCOUNT-A4           PIC  X(10).
  4509         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4510
  4511     12  LA-CONTROL-BY-KEY-FIELDS.
  4512         16  LA-COMPANY-CD-A5        PIC  X(01).
  4513         16  LA-CARRIER-A5           PIC  X(01).
  4514         16  LA-GROUPING-A5          PIC  X(06).
  4515         16  LA-STATE-A5             PIC  X(02).
  4516         16  LA-ACCOUNT-A5           PIC  X(10).
  4517         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4518
  4519     12  LA-CONTROL-BY-GROUP-CODE.
  4520         16  LA-COMPANY-CD-A6        PIC  X(01).
  4521         16  LA-ENTRY-A6.
  4522             20  LA-FILLER           PIC  X(02).
  4523             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4524         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4525
  4526     12  FILLER                      PIC  X(09).
  4527
  4528     12  LA-HEADER-RECORD.
  4529         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4530         16  LA-CREATION-DATE        PIC  X(02).
  4531         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4532         16  LA-FINAL-ACT-DATE       REDEFINES
  4533               LA-FOLLOW-UP-DATE     PIC  X(02).
  4534         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4535         16  LA-NO-OF-COPIES         PIC S9(01).
  4536         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4537         16  LA-REPLY-DATE           PIC  X(02).
  4538         16  LA-RESEND-DATES.
  4539             20  LA-RESEND-DATE      PIC  X(02).
  4540             20  LA-SENT-DATE        PIC  X(02).
  4541             20  FILLER              PIC  X(08).
  4542         16  LA-SOURCE-INFORMATION.
  4543             20  LA-DATA-SOURCE      PIC  X(01).
  4544             20  LA-ADDR-SOURCE      PIC  X(01).
  4545         16  LA-STATUS               PIC  X(01).
  4546             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4547             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4548             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4549             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4550             88  LA-STATUS-PURGED         VALUE 'P'.
  4551             88  LA-STATUS-VOIDED         VALUE 'V'.
  4552         16  LA-LAST-RESENT-PRINT-DATE
  4553                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  90
* EL689.cbl
  4554         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4555             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4556                                          VALUE 'C'.
  4557             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4558                                          VALUE 'F'.
  4559             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4560                                          VALUE 'P'.
  4561         16  LA-PURGED-DATE          PIC  X(02).
  4562         16  LA-VOIDED-DATE          PIC  X(02).
  4563         16  LA-RESEND-LETR          PIC  X(4).
  4564         16  FILLER                  PIC  X(08).
  4565*        16  LA-RESEND-LETR-2        PIC  X(4).
  4566*        16  LA-RESEND-LETR-3        PIC  X(4).
  4567*        16  FILLER                  PIC  X(59).
  4568         16  LA-ARCHIVE-STATUS       PIC  X.
  4569             88  LA-TEMP                VALUE 'T'.
  4570             88  LA-QWS                 VALUE 'Q'.
  4571             88  LA-BATCH               VALUE 'B'.
  4572         16  LA-FINAL-ACT-IND        PIC  X(1).
  4573         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4574         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4575         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4576                                     PIC X(4).
  4577         16  FILLER                  PIC  X(42).
  4578*        16  FILLER                  PIC  X(71).
  4579         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4580         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4581         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4582                                     PIC  X(4).
  4583         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4584
  4585******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  91
* EL689.cbl
  4587*    COPY ERCARCT.
  4588******************************************************************
  4589*                                                                *
  4590*                            ERCARCT.                            *
  4591*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4592*                            VMOD=2.002                          *
  4593*                                                                *
  4594*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4595*                                                                *
  4596*   FILE TYPE = VSAM,KSDS                                        *
  4597*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4598*                                                                *
  4599*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4600*                                                                *
  4601*   LOG = NO                                                     *
  4602*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4603******************************************************************
  4604*                   C H A N G E   L O G
  4605*
  4606* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4607*-----------------------------------------------------------------
  4608*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4609* EFFECTIVE    NUMBER
  4610*-----------------------------------------------------------------
  4611* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4612******************************************************************
  4613 01  LETTER-ARCHIVE-TEXT.
  4614     12  LT-RECORD-ID                PIC  X(02).
  4615         88  LT-VALID-ID                VALUE 'LT'.
  4616
  4617     12  LT-CONTROL-PRIMARY.
  4618         16  LT-COMPANY-CD           PIC  X(01).
  4619         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4620         16  LT-RECORD-TYPE          PIC  X(01).
  4621             88  LT-ADDRESS-DATA        VALUE '1'.
  4622             88  LT-TEXT-DATA           VALUE '2'.
  4623             88  LT-COMMENT-DATA        VALUE '3'.
  4624         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4625
  4626     12  FILLER                      PIC  X(28).
  4627     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4628
  4629     12  LT-TEXT-RECORD.
  4630         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4631                            INDEXED BY LT-NDX.
  4632             20  LT-TEXT-LINE        PIC  X(70).
  4633             20  LT-SKIP-CONTROL     PIC  X(02).
  4634                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4635                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4636             20  FILLER              PIC  X(08).
  4637
  4638     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4639         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4640             20  LT-COMMENT-LINE     PIC X(69).
  4641             20  LT-COMMENT-CHG-DT   PIC X(02).
  4642             20  LT-COMMENT-CHG-BY   PIC X(04).
  4643             20  FILLER              PIC X(05).
  4644
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  92
* EL689.cbl
  4646*    COPY ELCCERT.
  4647******************************************************************
  4648*                                                                *
  4649*                            ELCCERT.                            *
  4650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4651*                            VMOD=2.013                          *
  4652*                                                                *
  4653*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4654*                                                                *
  4655*   FILE TYPE = VSAM,KSDS                                        *
  4656*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4657*                                                                *
  4658*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4659*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4660*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4661*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4662*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4663*                                                                *
  4664*   LOG = YES                                                    *
  4665*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4666******************************************************************
  4667*                   C H A N G E   L O G
  4668*
  4669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4670*-----------------------------------------------------------------
  4671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4672* EFFECTIVE    NUMBER
  4673*-----------------------------------------------------------------
  4674* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4675* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4676* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4677* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4678* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4679* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4680* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4681* 032612  CR2011110200001  PEMA  AHL CHANGES
  4682******************************************************************
  4683
  4684 01  CERTIFICATE-MASTER.
  4685     12  CM-RECORD-ID                      PIC XX.
  4686         88  VALID-CM-ID                      VALUE 'CM'.
  4687
  4688     12  CM-CONTROL-PRIMARY.
  4689         16  CM-COMPANY-CD                 PIC X.
  4690         16  CM-CARRIER                    PIC X.
  4691         16  CM-GROUPING.
  4692             20  CM-GROUPING-PREFIX        PIC X(3).
  4693             20  CM-GROUPING-PRIME         PIC X(3).
  4694         16  CM-STATE                      PIC XX.
  4695         16  CM-ACCOUNT.
  4696             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4697             20  CM-ACCOUNT-PRIME          PIC X(6).
  4698         16  CM-CERT-EFF-DT                PIC XX.
  4699         16  CM-CERT-NO.
  4700             20  CM-CERT-PRIME             PIC X(10).
  4701             20  CM-CERT-SFX               PIC X.
  4702
  4703     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  93
* EL689.cbl
  4704         16  CM-COMPANY-CD-A1              PIC X.
  4705         16  CM-INSURED-LAST-NAME          PIC X(15).
  4706         16  CM-INSURED-INITIALS.
  4707             20  CM-INSURED-INITIAL1       PIC X.
  4708             20  CM-INSURED-INITIAL2       PIC X.
  4709
  4710     12  CM-CONTROL-BY-SSN.
  4711         16  CM-COMPANY-CD-A2              PIC X.
  4712         16  CM-SOC-SEC-NO.
  4713             20  CM-SSN-STATE              PIC XX.
  4714             20  CM-SSN-ACCOUNT            PIC X(6).
  4715             20  CM-SSN-LN3.
  4716                 25  CM-INSURED-INITIALS-A2.
  4717                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4718                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4719                 25 CM-PART-LAST-NAME-A2         PIC X.
  4720
  4721     12  CM-CONTROL-BY-CERT-NO.
  4722         16  CM-COMPANY-CD-A4              PIC X.
  4723         16  CM-CERT-NO-A4                 PIC X(11).
  4724
  4725     12  CM-CONTROL-BY-MEMB.
  4726         16  CM-COMPANY-CD-A5              PIC X.
  4727         16  CM-MEMBER-NO.
  4728             20  CM-MEMB-STATE             PIC XX.
  4729             20  CM-MEMB-ACCOUNT           PIC X(6).
  4730             20  CM-MEMB-LN4.
  4731                 25  CM-INSURED-INITIALS-A5.
  4732                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4733                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4734                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4735
  4736     12  CM-INSURED-PROFILE-DATA.
  4737         16  CM-INSURED-FIRST-NAME.
  4738             20  CM-INSURED-1ST-INIT       PIC X.
  4739             20  FILLER                    PIC X(9).
  4740         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4741         16  CM-INSURED-SEX                PIC X.
  4742             88  CM-SEX-MALE                  VALUE 'M'.
  4743             88  CM-SEX-FEMAL                 VALUE 'F'.
  4744         16  CM-INSURED-JOINT-AGE          PIC 99.
  4745         16  CM-JOINT-INSURED-NAME.
  4746             20  CM-JT-LAST-NAME           PIC X(15).
  4747             20  CM-JT-FIRST-NAME.
  4748                 24  CM-JT-1ST-INIT        PIC X.
  4749                 24  FILLER                PIC X(9).
  4750             20  CM-JT-INITIAL             PIC X.
  4751
  4752     12  CM-LIFE-DATA.
  4753         16  CM-LF-BENEFIT-CD              PIC XX.
  4754         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4755         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4756         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4757         16  CM-LF-DEV-CODE                PIC XXX.
  4758         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4759         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4760         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4761         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  94
* EL689.cbl
  4762         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4763         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4764         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4765         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4766         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4767         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4768         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4769         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4770         16  FILLER                        PIC XX.
  4771
  4772     12  CM-AH-DATA.
  4773         16  CM-AH-BENEFIT-CD              PIC XX.
  4774         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4775         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4776         16  CM-AH-DEV-CODE                PIC XXX.
  4777         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4778         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4779         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4780         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4781         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4782         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4783         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4784         16  CM-AH-PAID-THRU-DT            PIC XX.
  4785             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4786         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4787         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4788         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4789         16  FILLER                        PIC X.
  4790
  4791     12  CM-LOAN-INFORMATION.
  4792         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4793         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4794                                           PIC S9(5)V99  COMP-3.
  4795         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4796         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4797         16  CM-PAY-FREQUENCY              PIC S99.
  4798         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4799         16  CM-RATE-CLASS                 PIC XX.
  4800         16  CM-BENEFICIARY                PIC X(25).
  4801         16  CM-POLICY-FORM-NO             PIC X(12).
  4802         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4803         16  CM-LAST-ADD-ON-DT             PIC XX.
  4804         16  CM-DEDUCTIBLE-AMOUNTS.
  4805             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4806             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4807         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4808             20  CM-RESIDENT-STATE         PIC XX.
  4809             20  CM-RATE-CODE              PIC X(4).
  4810             20  FILLER                    PIC XX.
  4811         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4812             20  CM-LOAN-OFFICER           PIC X(5).
  4813             20  FILLER                    PIC XXX.
  4814         16  CM-CSR-CODE                   PIC XXX.
  4815         16  CM-UNDERWRITING-CODE          PIC X.
  4816             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4817         16  CM-POST-CARD-IND              PIC X.
  4818         16  CM-NH-INTERFACE-SW            PIC X.
  4819         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  95
* EL689.cbl
  4820             88  CM-SING-PRM                  VALUE '1'.
  4821             88  CM-O-B-COVERAGE              VALUE '2'.
  4822             88  CM-OPEN-END                  VALUE '3'.
  4823         16  CM-IND-GRP-TYPE               PIC X.
  4824             88  CM-INDIVIDUAL                VALUE 'I'.
  4825             88  CM-GROUP                     VALUE 'G'.
  4826         16  CM-SKIP-CODE                  PIC X.
  4827             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4828             88  SKIP-JULY                    VALUE '1'.
  4829             88  SKIP-AUGUST                  VALUE '2'.
  4830             88  SKIP-SEPTEMBER               VALUE '3'.
  4831             88  SKIP-JULY-AUG                VALUE '4'.
  4832             88  SKIP-AUG-SEPT                VALUE '5'.
  4833             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4834             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4835             88  SKIP-JUNE                    VALUE '8'.
  4836             88  SKIP-JUNE-JULY               VALUE '9'.
  4837             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4838             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4839         16  CM-PAYMENT-MODE               PIC X.
  4840             88  PAY-MONTHLY                  VALUE SPACE.
  4841             88  PAY-WEEKLY                   VALUE '1'.
  4842             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4843             88  PAY-BI-WEEKLY                VALUE '3'.
  4844             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4845         16  CM-LOAN-NUMBER                PIC X(8).
  4846         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4847         16  CM-OLD-LOF                    PIC XXX.
  4848*        16  CM-LOAN-OFFICER               PIC XXX.
  4849         16  CM-REIN-TABLE                 PIC XXX.
  4850         16  CM-SPECIAL-REIN-CODE          PIC X.
  4851         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4852         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4853         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4854
  4855     12  CM-STATUS-DATA.
  4856         16  CM-ENTRY-STATUS               PIC X.
  4857         16  CM-ENTRY-DT                   PIC XX.
  4858
  4859         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4860         16  CM-LF-CANCEL-DT               PIC XX.
  4861         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4862
  4863         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4864         16  CM-LF-DEATH-DT                PIC XX.
  4865         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4866
  4867         16  CM-LF-CURRENT-STATUS          PIC X.
  4868             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4869                                                'M' '4' '5' '9'.
  4870             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4871             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4872             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4873             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4874             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4875             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4876             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4877             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  96
* EL689.cbl
  4878             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4879             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4880             88  CM-LF-DECLINED               VALUE 'D'.
  4881             88  CM-LF-VOIDED                 VALUE 'V'.
  4882
  4883         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4884         16  CM-AH-CANCEL-DT               PIC XX.
  4885         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4886
  4887         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4888         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4889         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4890
  4891         16  CM-AH-CURRENT-STATUS          PIC X.
  4892             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4893                                                'M' '4' '5' '9'.
  4894             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4895             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4896             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4897             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4898             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4899             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4900             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4901             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4902             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4903             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4904             88  CM-AH-DECLINED               VALUE 'D'.
  4905             88  CM-AH-VOIDED                 VALUE 'V'.
  4906
  4907         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4908             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4909             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4910             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4911         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4912
  4913         16  CM-ENTRY-BATCH                PIC X(6).
  4914         16  CM-LF-EXIT-BATCH              PIC X(6).
  4915         16  CM-AH-EXIT-BATCH              PIC X(6).
  4916         16  CM-LAST-MONTH-END             PIC XX.
  4917
  4918     12  CM-NOTE-SW                        PIC X.
  4919         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4920         88  CERT-NOTES-PRESENT               VALUE '1'.
  4921         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4922         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4923         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4924         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4925         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4926         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4927     12  CM-COMP-EXCP-SW                   PIC X.
  4928         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4929         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4930     12  CM-INSURED-ADDRESS-SW             PIC X.
  4931         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4932         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4933
  4934*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4935     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  97
* EL689.cbl
  4936     12  FILLER                            PIC X.
  4937
  4938*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4939     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4940     12  FILLER                            PIC X.
  4941*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4942     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4943
  4944     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4945         88  CERT-ADDED-BATCH                 VALUE ' '.
  4946         88  CERT-ADDED-ONLINE                VALUE '1'.
  4947         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4948         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4949         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4950     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4951         88  CERT-AS-LOADED                   VALUE ' '.
  4952         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4953         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4954         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4955         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4956         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4957         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4958         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4959
  4960     12  CM-ACCOUNT-COMM-PCTS.
  4961         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4962         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4963
  4964     12  CM-USER-FIELD                     PIC X.
  4965     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4966     12  CM-CLP-STATE                      PIC XX.
  4967     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4968     12  CM-USER-RESERVED                  PIC XXX.
  4969     12  FILLER REDEFINES CM-USER-RESERVED.
  4970         16  CM-AH-CLASS-CD                PIC XX.
  4971         16  F                             PIC X.
  4972******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  98
* EL689.cbl
  4974*    COPY ERCCHEK.
  4975******************************************************************
  4976*                                                                *
  4977*                                                                *
  4978*                            ERCCHEK                             *
  4979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4980*                            VMOD=2.008                          *
  4981*                                                                *
  4982*   FILE DESCRIPTION = CHECK RECORDS                             *
  4983*                                                                *
  4984*   FILE TYPE = VSAM,KSDS                                        *
  4985*   RECORD SIZE = 600    RECFORM = FIXED                         *
  4986*                                                                *
  4987*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  4988*       ALTERNATE INDEX = NONE                                   *
  4989*                                                                *
  4990*   LOG = YES                                                    *
  4991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4992******************************************************************
  4993 01  CHECK-RECORDS.
  4994     12  CH-RECORD-ID                      PIC XX.
  4995         88  VALID-CH-ID                      VALUE 'CH'.
  4996
  4997     12  CH-CONTROL-PRIMARY.
  4998         16  CH-COMPANY-CD                 PIC X.
  4999         16  CH-CARRIER                    PIC X.
  5000         16  CH-GROUPING                   PIC X(6).
  5001         16  CH-STATE                      PIC XX.
  5002         16  CH-ACCOUNT                    PIC X(10).
  5003         16  CH-CERT-EFF-DT                PIC XX.
  5004         16  CH-CERT-NO.
  5005             20  CH-CERT-PRIME             PIC X(10).
  5006             20  CH-CERT-SFX               PIC X.
  5007         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  5008
  5009     12  CH-RECORDED-DT                    PIC XX.
  5010     12  CH-RECORDED-BY                    PIC X(4).
  5011     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  5012
  5013     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  5014     12  CH-CHECK-NO                       PIC X(7).
  5015     12  CH-REASON-FOR-CHECK               PIC X(25).
  5016     12  CH-CHECK-WRITTEN-DT               PIC XX.
  5017     12  CH-OFFLINE-CHECK-IND              PIC X.
  5018         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  5019
  5020     12  CH-PAYEE-INFO.
  5021         16  CH-PAYEE-NAME-1               PIC X(30).
  5022         16  CH-PAYEE-NAME-2               PIC X(30).
  5023         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  5024         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  5025         16  CH-PAYEE-CITY-ST              PIC X(30).
  5026         16  CH-PAYEE-ZIP-CODE.
  5027             20  CH-PAYEE-ZIP.
  5028                 24  CH-ZIP-PRI-1ST        PIC X.
  5029                     88  CH-CANADIAN-POST-CODE
  5030                                           VALUES 'A' THRU 'Z'.
  5031                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  99
* EL689.cbl
  5032             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  5033         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  5034             20  CH-CAN-POSTAL-1           PIC XXX.
  5035             20  CH-CAN-POSTAL-2           PIC XXX.
  5036             20  FILLER                    PIC XXX.
  5037
  5038     12  CH-CHECK-STUB-TEXT.
  5039         16  CH-STUB-LINE-1                PIC X(50).
  5040         16  CH-STUB-LINE-2                PIC X(50).
  5041         16  CH-STUB-LINE-3                PIC X(50).
  5042         16  FILLER.
  5043           18  CH-STUB-LINE-4              PIC X(20).
  5044           18  CH-LIENHOLDER-NAME          PIC X(30).
  5045
  5046     12  CH-COMPENSATION-CONTROL.
  5047         16  CH-COMP-CARRIER               PIC X.
  5048         16  CH-COMP-GROUPING              PIC X(6).
  5049         16  CH-COMP-FIN-RESP              PIC X(10).
  5050         16  CH-COMP-ACCOUNT               PIC X(10).
  5051
  5052     12  CH-CREDIT-SELECT-DT               PIC XX.
  5053     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5054     12  CH-PAYEE-CODE                     PIC X(6).
  5055
  5056     12  CH-VOID-DATA.
  5057         20  CH-VOID-DT                    PIC XX.
  5058         20  CH-VOID-BY                    PIC X(4).
  5059         20  CH-VOID-REASON                PIC X(25).
  5060
  5061     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5062             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5063     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5064
  5065     12  CH-CHECK-REFERENCE                PIC X(12).
  5066     12  CH-CHECK-ORIGIN-SW                PIC X.
  5067             88  CH-REFUND-CHECK              VALUE 'R'.
  5068             88  CH-MAINT-CHECK               VALUE 'M'.
  5069
  5070     12  CH-CANC-DT                        PIC XX.
  5071     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5072     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5073
  5074     12  CH-INSURED-NAME                   PIC X(28).
  5075
  5076     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  5077     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  5078
  5079     12  CH-LETTER-TABLE.
  5080         16  CH-LETTERS OCCURS 3 TIMES
  5081                        INDEXED BY CH-LT-NDX
  5082                                           PIC X(04).
  5083
  5084     12  FILLER                            PIC X(07).
  5085
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 100
* EL689.cbl
  5087*    COPY ELCCNTL.
  5088******************************************************************
  5089*                                                                *
  5090*                                                                *
  5091*                            ELCCNTL.                            *
  5092*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5093*                            VMOD=2.059                          *
  5094*                                                                *
  5095*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5096*                                                                *
  5097*   FILE TYPE = VSAM,KSDS                                        *
  5098*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5099*                                                                *
  5100*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5101*       ALTERNATE INDEX = NONE                                   *
  5102*                                                                *
  5103*   LOG = YES                                                    *
  5104*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5105******************************************************************
  5106*                   C H A N G E   L O G
  5107*
  5108* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5109*-----------------------------------------------------------------
  5110*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5111* EFFECTIVE    NUMBER
  5112*-----------------------------------------------------------------
  5113* 082503                   PEMA  ADD BENEFIT GROUP
  5114* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5115* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5116* 092705    2005050300006  PEMA  ADD SPP LEASES
  5117* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5118* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5119* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5120* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5121* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5122* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5123******************************************************************
  5124*
  5125 01  CONTROL-FILE.
  5126     12  CF-RECORD-ID                       PIC XX.
  5127         88  VALID-CF-ID                        VALUE 'CF'.
  5128
  5129     12  CF-CONTROL-PRIMARY.
  5130         16  CF-COMPANY-ID                  PIC XXX.
  5131         16  CF-RECORD-TYPE                 PIC X.
  5132             88  CF-COMPANY-MASTER              VALUE '1'.
  5133             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5134             88  CF-STATE-MASTER                VALUE '3'.
  5135             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5136             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5137             88  CF-CARRIER-MASTER              VALUE '6'.
  5138             88  CF-MORTALITY-MASTER            VALUE '7'.
  5139             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5140             88  CF-TERMINAL-MASTER             VALUE '9'.
  5141             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5142             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5143             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5144             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 101
* EL689.cbl
  5145             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5146             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5147             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5148             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5149             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5150         16  CF-ACCESS-CD-GENL              PIC X(4).
  5151         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5152             20  CF-PROCESSOR               PIC X(4).
  5153         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5154             20  CF-STATE-CODE              PIC XX.
  5155             20  FILLER                     PIC XX.
  5156         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5157             20  FILLER                     PIC XX.
  5158             20  CF-HI-BEN-IN-REC           PIC XX.
  5159         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5160             20  FILLER                     PIC XXX.
  5161             20  CF-CARRIER-CNTL            PIC X.
  5162         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5163             20  FILLER                     PIC XX.
  5164             20  CF-HI-TYPE-IN-REC          PIC 99.
  5165         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5166             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5167                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5168             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5169             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5170         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5171             20  FILLER                     PIC X.
  5172             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5173         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5174             20  FILLER                     PIC XX.
  5175             20  CF-MORTGAGE-PLAN           PIC XX.
  5176         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5177
  5178     12  CF-LAST-MAINT-DT                   PIC XX.
  5179     12  CF-LAST-MAINT-BY                   PIC X(4).
  5180     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5181
  5182     12  CF-RECORD-BODY                     PIC X(728).
  5183
  5184
  5185****************************************************************
  5186*             COMPANY MASTER RECORD                            *
  5187****************************************************************
  5188
  5189     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5190         16  CF-COMPANY-ADDRESS.
  5191             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5192             20  CF-CL-IN-CARE-OF           PIC X(30).
  5193             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5194             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5195             20  CF-CL-CITY-STATE           PIC X(30).
  5196             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5197             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5198         16  CF-COMPANY-CD                  PIC X.
  5199         16  CF-COMPANY-PASSWORD            PIC X(8).
  5200         16  CF-SECURITY-OPTION             PIC X.
  5201             88  ALL-SECURITY                   VALUE '1'.
  5202             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 102
* EL689.cbl
  5203             88  PROCESSOR-VERIFY               VALUE '3'.
  5204             88  NO-SECURITY                    VALUE '4'.
  5205             88  ALL-BUT-TERM                   VALUE '5'.
  5206         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5207             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5208         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5209             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5210         16  CF-INFORCE-LOCATION            PIC X.
  5211             88  CERTS-ARE-ONLINE               VALUE '1'.
  5212             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5213             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5214         16  CF-LOWER-CASE-LETTERS          PIC X.
  5215         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5216             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5217             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5218             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5219             88  CF-ACCNT-CNTL                  VALUE '3'.
  5220             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5221
  5222         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5223         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5224
  5225         16  CF-LGX-CREDIT-USER             PIC X.
  5226             88  CO-IS-NOT-USER                 VALUE 'N'.
  5227             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5228
  5229         16 CF-CREDIT-CALC-CODES.
  5230             20  CF-CR-REM-TERM-CALC PIC X.
  5231               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5232               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5233               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5234               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5235               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5236               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5237               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5238             20  CF-CR-R78-METHOD           PIC X.
  5239               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5240               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5241
  5242         16  CF-CLAIM-CONTROL-COUNTS.
  5243             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5244                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5245
  5246             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5247                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5248
  5249             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5250                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5251
  5252             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5253                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5254
  5255         16  CF-CURRENT-MONTH-END           PIC XX.
  5256
  5257         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5258             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5259             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5260             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 103
* EL689.cbl
  5261             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5262                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5263                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5264             20  CF-CO-PREM-REJECT-SW       PIC X.
  5265                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5266                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5267             20  CF-CO-REF-REJECT-SW        PIC X.
  5268                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5269                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5270
  5271         16  CF-CO-REPORTING-DT             PIC XX.
  5272         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5273         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5274           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5275           88  CF-CO-MONTH-END                  VALUE '1'.
  5276
  5277         16  CF-LGX-CLAIM-USER              PIC X.
  5278             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5279             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5280
  5281         16  CF-CREDIT-EDIT-CONTROLS.
  5282             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5283             20  CF-MIN-AGE                 PIC 99.
  5284             20  CF-DEFAULT-AGE             PIC 99.
  5285             20  CF-MIN-TERM                PIC S999      COMP-3.
  5286             20  CF-MAX-TERM                PIC S999      COMP-3.
  5287             20  CF-DEFAULT-SEX             PIC X.
  5288             20  CF-JOINT-AGE-INPUT         PIC X.
  5289                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5290             20  CF-BIRTH-DATE-INPUT        PIC X.
  5291                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5292             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5293                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5294                 88  CF-ZERO-CARRIER            VALUE '1'.
  5295                 88  CF-ZERO-GROUPING           VALUE '2'.
  5296                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5297             20  CF-EDIT-SW                 PIC X.
  5298                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5299             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5300             20  CF-CR-PR-METHOD            PIC X.
  5301               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5302               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5303             20  FILLER                     PIC X.
  5304
  5305         16  CF-CREDIT-MISC-CONTROLS.
  5306             20  CF-REIN-TABLE-SW           PIC X.
  5307                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5308             20  CF-COMP-TABLE-SW           PIC X.
  5309                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5310             20  CF-EXPERIENCE-RETENTION-AGE
  5311                                            PIC S9        COMP-3.
  5312             20  CF-CONVERSION-DT           PIC XX.
  5313             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5314             20  CF-RUN-FREQUENCY-SW        PIC X.
  5315                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5316                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5317
  5318             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 104
* EL689.cbl
  5319                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5320                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5321                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5322                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5323                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5324                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5325
  5326                 24  CF-CR-CHECK-COUNT       REDEFINES
  5327                     CF-CR-CHECK-COUNTER      PIC X(4).
  5328
  5329                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5330                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5331
  5332                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5333                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5334                 24  CF-MAIL-PROCESSING       PIC X.
  5335                     88  MAIL-PROCESSING          VALUE 'Y'.
  5336
  5337         16  CF-MISC-SYSTEM-CONTROL.
  5338             20  CF-SYSTEM-C                 PIC X.
  5339                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5340             20  CF-SYSTEM-D                 PIC X.
  5341                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5342             20  CF-SOC-SEC-NO-SW            PIC X.
  5343                 88  SOC-SEC-NO-USED             VALUE '1'.
  5344             20  CF-MEMBER-NO-SW             PIC X.
  5345                 88  MEMBER-NO-USED              VALUE '1'.
  5346             20  CF-TAX-ID-NUMBER            PIC X(11).
  5347             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5348             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5349                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5350                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5351                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5352                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5353             20  CF-SYSTEM-E                 PIC X.
  5354                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5355
  5356         16  CF-LGX-LIFE-USER               PIC X.
  5357             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5358             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5359
  5360         16  CF-CR-MONTH-END-DT             PIC XX.
  5361
  5362         16  CF-FILE-MAINT-DATES.
  5363             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5364                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5365             20  CF-LAST-BATCH       REDEFINES
  5366                 CF-LAST-BATCH-NO               PIC X(4).
  5367             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5368             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5369             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5370             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5371             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5372             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5373             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5374             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5375             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5376             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 105
* EL689.cbl
  5377
  5378         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5379         16  FILLER                         PIC X.
  5380
  5381         16  CF-ALT-MORT-CODE               PIC X(4).
  5382         16  CF-MEMBER-CAPTION              PIC X(10).
  5383
  5384         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5385             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5386             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5387             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5388             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5389             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5390
  5391         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5392
  5393         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5394         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5395         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5396         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5397
  5398         16  CF-AH-OVERRIDE-L1              PIC X.
  5399         16  CF-AH-OVERRIDE-L2              PIC XX.
  5400         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5401         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5402
  5403         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5404         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5405
  5406         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5407         16  CF-AR-LAST-EL860-DT            PIC XX.
  5408         16  CF-MP-MONTH-END-DT             PIC XX.
  5409
  5410         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5411         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5412             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5413
  5414         16  CF-AR-MONTH-END-DT             PIC XX.
  5415
  5416         16  CF-CRDTCRD-USER                PIC X.
  5417             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5418             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5419
  5420         16  CF-CC-MONTH-END-DT             PIC XX.
  5421
  5422         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5423
  5424         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5425             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5426             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5427             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5428         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5429         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5430         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5431         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5432             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5433             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5434         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 106
* EL689.cbl
  5435         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5436         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5437             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5438         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5439
  5440         16  CF-CL-ZIP-CODE.
  5441             20  CF-CL-ZIP-PRIME.
  5442                 24  CF-CL-ZIP-1ST          PIC X.
  5443                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5444                 24  FILLER                 PIC X(4).
  5445             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5446         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5447             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5448             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5449             20  FILLER                     PIC XXX.
  5450
  5451         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5452         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5453         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5454         16  CF-CO-OPTION-START-DATE        PIC XX.
  5455         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5456           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5457                                                      '3' '4'.
  5458           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5459           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5460           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5461           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5462           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5463           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5464
  5465         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5466
  5467         16  CF-PAYMENT-APPROVAL-LEVELS.
  5468             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5469             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5470             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5471             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5472             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5473             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5474
  5475         16  CF-END-USER-REPORTING-USER     PIC X.
  5476             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5477             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5478
  5479         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5480             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5481             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5482
  5483         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5484
  5485         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5486         16  FILLER                         PIC X.
  5487
  5488         16  CF-CREDIT-ARCHIVE-CNTL.
  5489             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5490             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5491             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5492
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 107
* EL689.cbl
  5493         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5494
  5495         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5496             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5497             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5498
  5499         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5500             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5501             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5502
  5503         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5504
  5505         16  CF-CO-ACH-ID-CODE              PIC  X.
  5506             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5507             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5508             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5509         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5510         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5511         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5512         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5513         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5514         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5515         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5516         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5517         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5518                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5519         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5520                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5521
  5522         16  CF-CO-OVER-SHORT.
  5523             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5524             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5525
  5526*         16  FILLER                         PIC X(102).
  5527         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5528             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5529             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5530
  5531         16  CF-AH-APPROVAL-DAYS.
  5532             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5533             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5534             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5535             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5536
  5537         16  FILLER                         PIC X(82).
  5538****************************************************************
  5539*             PROCESSOR/USER RECORD                            *
  5540****************************************************************
  5541
  5542     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5543         16  CF-PROCESSOR-NAME              PIC X(30).
  5544         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5545         16  CF-PROCESSOR-TITLE             PIC X(26).
  5546         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5547                 88  MESSAGE-YES                VALUE 'Y'.
  5548                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5549
  5550*****************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 108
* EL689.cbl
  5551****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5552****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5553****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5554****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5555*****************************************************
  5556
  5557         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5558             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5559             20  CF-APPLICATION-FORCE       PIC X.
  5560             20  CF-INDIVIDUAL-APP.
  5561                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5562                     28  CF-BROWSE-APP      PIC X.
  5563                     28  CF-UPDATE-APP      PIC X.
  5564
  5565         16  CF-CURRENT-TERM-ON             PIC X(4).
  5566         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5567             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5568             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5569             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5570             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5571             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5572             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5573             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5574         16  CF-PROCESSOR-CARRIER           PIC X.
  5575             88  NO-CARRIER-SECURITY            VALUE ' '.
  5576         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5577             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5578         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5579             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5580         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5581             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5582
  5583         16  CF-PROC-SYS-ACCESS-SW.
  5584             20  CF-PROC-CREDIT-CLAIMS-SW.
  5585                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5586                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5587                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5588                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5589             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5590                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5591                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5592             20  CF-PROC-LIFE-GNRLDGR-SW.
  5593                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5594                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5595                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5596                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5597             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5598                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5599                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5600         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5601             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5602             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5603         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5604
  5605         16  CF-APPROVAL-LEVEL                  PIC X.
  5606             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5607             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5608             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 109
* EL689.cbl
  5609             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5610
  5611         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5612
  5613         16  CF-LANGUAGE-TYPE                   PIC X.
  5614             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5615             88  CF-LANG-IS-FR                      VALUE 'F'.
  5616
  5617         16  CF-CSR-IND                         PIC X.
  5618         16  FILLER                             PIC X(239).
  5619
  5620****************************************************************
  5621*             PROCESSOR/REMINDERS RECORD                       *
  5622****************************************************************
  5623
  5624     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5625         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5626             20  CF-START-REMIND-DT         PIC XX.
  5627             20  CF-END-REMIND-DT           PIC XX.
  5628             20  CF-REMINDER-TEXT           PIC X(50).
  5629         16  FILLER                         PIC X(296).
  5630
  5631
  5632****************************************************************
  5633*             STATE MASTER RECORD                              *
  5634****************************************************************
  5635
  5636     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5637         16  CF-STATE-ABBREVIATION          PIC XX.
  5638         16  CF-STATE-NAME                  PIC X(25).
  5639         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5640         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5641             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5642             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5643             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5644             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5645                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5646                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5647             20  CF-ST-PREM-REJECT-SW       PIC X.
  5648                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5649                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5650             20  CF-ST-REF-REJECT-SW        PIC X.
  5651                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5652                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5653         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5654         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5655         16  CF-ST-REFUND-RULES.
  5656             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5657             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5658             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5659         16  CF-ST-FST-PMT-EXTENSION.
  5660             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5661             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5662                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5663                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5664                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5665                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5666         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 110
* EL689.cbl
  5667             20  CF-ST-CALL-UNEARNED        PIC X.
  5668             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5669             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5670         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5671             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5672             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5673         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5674         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5675         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5676         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5677         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5678         16  FILLER                         PIC X.
  5679         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5680             20  CF-ST-BENEFIT-CD           PIC XX.
  5681             20  CF-ST-BENEFIT-KIND         PIC X.
  5682                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5683                 88  CF-ST-AH-KIND              VALUE 'A'.
  5684             20  CF-ST-REM-TERM-CALC        PIC X.
  5685                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5686                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5687                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5688                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5689                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5690                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5691                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5692                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5693
  5694             20  CF-ST-REFUND-CALC          PIC X.
  5695                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5696                 88  ST-REFD-BY-R78             VALUE '1'.
  5697                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5698                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5699                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5700                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5701                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5702                 88  ST-REFD-UTAH               VALUE '7'.
  5703                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5704                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5705                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5706
  5707             20  CF-ST-EARNING-CALC         PIC X.
  5708                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5709                 88  ST-EARN-BY-R78             VALUE '1'.
  5710                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5711                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5712                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5713                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5714                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5715                 88  ST-EARN-MEAN               VALUE '8'.
  5716                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5717
  5718             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5719                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5720                 88  ST-OVRD-BY-R78             VALUE '1'.
  5721                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5722                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5723                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5724                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 111
* EL689.cbl
  5725                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5726                 88  ST-OVRD-MEAN               VALUE '8'.
  5727                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5728             20  FILLER                     PIC X.
  5729
  5730         16  CF-ST-COMMISSION-CAPS.
  5731             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5732             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5733             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5734             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5735         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5736                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5737
  5738         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5739
  5740         16  CF-ST-STATUTORY-INTEREST.
  5741             20  CF-ST-STAT-DATE-FROM       PIC X.
  5742                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5743                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5744             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5745             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5746             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5747             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5748             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5749
  5750         16  CF-ST-OVER-SHORT.
  5751             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5752             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5753
  5754         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5755
  5756         16  CF-ST-RT-CALC                  PIC X.
  5757
  5758         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5759         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5760         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5761         16  CF-ST-RF-LR-CALC               PIC X.
  5762         16  CF-ST-RF-LL-CALC               PIC X.
  5763         16  CF-ST-RF-LN-CALC               PIC X.
  5764         16  CF-ST-RF-AH-CALC               PIC X.
  5765         16  CF-ST-RF-CP-CALC               PIC X.
  5766*        16  FILLER                         PIC X(206).
  5767*CIDMOD         16  FILLER                         PIC X(192).
  5768         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5769             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5770         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5771         16  CF-ST-VFY-2ND-BENE             PIC X.
  5772         16  FILLER                         PIC X(186).
  5773
  5774****************************************************************
  5775*             BENEFIT MASTER RECORD                            *
  5776****************************************************************
  5777
  5778     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5779         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5780             20  CF-BENEFIT-CODE            PIC XX.
  5781             20  CF-BENEFIT-NUMERIC  REDEFINES
  5782                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 112
* EL689.cbl
  5783             20  CF-BENEFIT-ALPHA           PIC XXX.
  5784             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5785             20  CF-BENEFIT-COMMENT         PIC X(10).
  5786
  5787             20  CF-LF-COVERAGE-TYPE        PIC X.
  5788                 88  CF-REDUCING                VALUE 'R'.
  5789                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5790
  5791             20  CF-SPECIAL-CALC-CD         PIC X.
  5792                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5793                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5794                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5795                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5796                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5797                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5798                 88  CF-FARM-PLAN               VALUE 'F'.
  5799                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5800                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5801                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5802                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5803                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5804                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5805                 88  CF-PRUDENTIAL              VALUE 'P'.
  5806                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5807                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5808                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5809                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5810                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5811                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5812
  5813             20  CF-JOINT-INDICATOR         PIC X.
  5814                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5815
  5816*            20  FILLER                     PIC X(12).
  5817             20  FILLER                     PIC X(11).
  5818             20  CF-BENEFIT-CATEGORY        PIC X.
  5819             20  CF-LOAN-TYPE               PIC X(8).
  5820
  5821             20  CF-CO-REM-TERM-CALC        PIC X.
  5822                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5823                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5824                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5825                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5826                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5827
  5828             20  CF-CO-EARNINGS-CALC        PIC X.
  5829                 88  CO-EARN-BY-R78             VALUE '1'.
  5830                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5831                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5832                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5833                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5834                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5835                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5836                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5837
  5838             20  CF-CO-REFUND-CALC          PIC X.
  5839                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5840                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 113
* EL689.cbl
  5841                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5842                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5843                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5844                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5845                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5846                 88  CO-REFD-MEAN               VALUE '8'.
  5847                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5848                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5849                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5850
  5851             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5852                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5853                 88  CO-OVRD-BY-R78             VALUE '1'.
  5854                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5855                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5856                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5857                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5858                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5859                 88  CO-OVRD-MEAN               VALUE '8'.
  5860                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5861
  5862             20  CF-CO-BEN-I-G-CD           PIC X.
  5863                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5864                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5865                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5866
  5867         16  FILLER                         PIC X(304).
  5868
  5869
  5870****************************************************************
  5871*             CARRIER MASTER RECORD                            *
  5872****************************************************************
  5873
  5874     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5875         16  CF-ADDRESS-DATA.
  5876             20  CF-MAIL-TO-NAME            PIC X(30).
  5877             20  CF-IN-CARE-OF              PIC X(30).
  5878             20  CF-ADDRESS-LINE-1          PIC X(30).
  5879             20  CF-ADDRESS-LINE-2          PIC X(30).
  5880             20  CF-CITY-STATE              PIC X(30).
  5881             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5882             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5883
  5884         16  CF-CLAIM-NO-CONTROL.
  5885             20  CF-CLAIM-NO-METHOD         PIC X.
  5886                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5887                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5888                 88  CLAIM-NO-SEQ               VALUE '3'.
  5889                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5890             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5891                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5892                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5893                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5894
  5895         16  CF-CHECK-NO-CONTROL.
  5896             20  CF-CHECK-NO-METHOD         PIC X.
  5897                 88  CHECK-NO-MANUAL            VALUE '1'.
  5898                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 114
* EL689.cbl
  5899                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5900                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5901             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5902                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5903
  5904         16  CF-DOMICILE-STATE              PIC XX.
  5905
  5906         16  CF-EXPENSE-CONTROLS.
  5907             20  CF-EXPENSE-METHOD          PIC X.
  5908                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5909                 88  DOLLARS-PER-PMT            VALUE '2'.
  5910                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5911                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5912             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5913             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5914
  5915         16  CF-CORRESPONDENCE-CONTROL.
  5916             20  CF-LETTER-RESEND-OPT       PIC X.
  5917                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5918                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5919             20  FILLER                     PIC X(4).
  5920
  5921         16  CF-RESERVE-CONTROLS.
  5922             20  CF-MANUAL-SW               PIC X.
  5923                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5924             20  CF-FUTURE-SW               PIC X.
  5925                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5926             20  CF-PTC-SW                  PIC X.
  5927                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5928             20  CF-IBNR-SW                 PIC X.
  5929                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5930             20  CF-PTC-LF-SW               PIC X.
  5931                 88  CF-LF-PTC-USED             VALUE '1'.
  5932             20  CF-CDT-ACCESS-METHOD       PIC X.
  5933                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5934                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5935                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5936             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5937
  5938         16  CF-CLAIM-CALC-METHOD           PIC X.
  5939             88  360-PLUS-MONTHS                VALUE '1'.
  5940             88  365-PLUS-MONTHS                VALUE '2'.
  5941             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5942             88  360-DAILY                      VALUE '4'.
  5943             88  365-DAILY                      VALUE '5'.
  5944
  5945         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5946         16  FILLER                         PIC X(11).
  5947
  5948         16  CF-LIMIT-AMOUNTS.
  5949             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5950             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5951             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5952             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5953             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5954             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5955             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5956             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 115
* EL689.cbl
  5957             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5958             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5959
  5960         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5961         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5962         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5963
  5964         16  CF-ZIP-CODE.
  5965             20  CF-ZIP-PRIME.
  5966                 24  CF-ZIP-1ST             PIC X.
  5967                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5968                 24  FILLER                 PIC X(4).
  5969             20  CF-ZIP-PLUS4               PIC X(4).
  5970         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5971             20  CF-CAN-POSTAL-1            PIC XXX.
  5972             20  CF-CAN-POSTAL-2            PIC XXX.
  5973             20  FILLER                     PIC XXX.
  5974
  5975         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5976         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5977         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5978
  5979         16  CF-RATING-SWITCH               PIC X.
  5980             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5981             88  CF-NO-RATING                   VALUE 'N'.
  5982
  5983         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5984
  5985         16  CF-CARRIER-OVER-SHORT.
  5986             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5987             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5988
  5989         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5990         16  CF-SECPAY-SWITCH               PIC X.
  5991             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5992             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5993         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5994         16  FILLER                         PIC X(448).
  5995*        16  FILLER                         PIC X(452).
  5996
  5997
  5998****************************************************************
  5999*             MORTALITY MASTER RECORD                          *
  6000****************************************************************
  6001
  6002     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6003         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6004                                INDEXED BY CF-MORT-NDX.
  6005             20  CF-MORT-TABLE              PIC X(5).
  6006             20  CF-MORT-TABLE-TYPE         PIC X.
  6007                 88  CF-MORT-JOINT              VALUE 'J'.
  6008                 88  CF-MORT-SINGLE             VALUE 'S'.
  6009                 88  CF-MORT-COMBINED           VALUE 'C'.
  6010                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6011                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6012             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6013             20  CF-MORT-AGE-METHOD         PIC XX.
  6014                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 116
* EL689.cbl
  6015                 88  CF-AGE-NEAR                VALUE 'AN'.
  6016             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6017             20  CF-MORT-ADJUSTMENT-DIRECTION
  6018                                            PIC X.
  6019                 88  CF-MINUS                   VALUE '-'.
  6020                 88  CF-PLUS                    VALUE '+'.
  6021             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6022             20  CF-MORT-JOINT-CODE         PIC X.
  6023                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6024             20  CF-MORT-PC-Q               PIC X.
  6025                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6026             20  CF-MORT-TABLE-CODE         PIC X(4).
  6027             20  CF-MORT-COMMENTS           PIC X(15).
  6028             20  FILLER                     PIC X(14).
  6029
  6030         16  FILLER                         PIC X(251).
  6031
  6032
  6033****************************************************************
  6034*             BUSSINESS TYPE MASTER RECORD                     *
  6035****************************************************************
  6036
  6037     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6038* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6039* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6040* AND RECORD 05 IS TYPES 81-99
  6041         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6042             20  CF-BUSINESS-TITLE          PIC  X(19).
  6043             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6044                                            PIC S9V9(4) COMP-3.
  6045             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6046             20  FILLER                     PIC  X.
  6047         16  FILLER                         PIC  X(248).
  6048
  6049
  6050****************************************************************
  6051*             TERMINAL MASTER RECORD                           *
  6052****************************************************************
  6053
  6054     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6055
  6056         16  CF-COMPANY-TERMINALS.
  6057             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6058                                  PIC X(4).
  6059         16  FILLER               PIC X(248).
  6060
  6061
  6062****************************************************************
  6063*             LIFE EDIT MASTER RECORD                          *
  6064****************************************************************
  6065
  6066     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6067         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6068             20  CF-LIFE-CODE-IN            PIC XX.
  6069             20  CF-LIFE-CODE-OUT           PIC XX.
  6070         16  FILLER                         PIC X(248).
  6071
  6072
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 117
* EL689.cbl
  6073****************************************************************
  6074*             AH EDIT MASTER RECORD                            *
  6075****************************************************************
  6076
  6077     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6078         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6079             20  CF-AH-CODE-IN              PIC XXX.
  6080             20  CF-AH-CODE-OUT             PIC XX.
  6081         16  FILLER                         PIC X(248).
  6082
  6083
  6084****************************************************************
  6085*             CREDIBILITY TABLES                               *
  6086****************************************************************
  6087
  6088     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6089         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6090                             INDEXED BY CF-CRDB-NDX.
  6091             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6092             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6093             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6094         16  FILLER                         PIC  X(332).
  6095
  6096
  6097****************************************************************
  6098*             REPORT CUSTOMIZATION RECORD                      *
  6099****************************************************************
  6100
  6101     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6102         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6103             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6104             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6105             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6106**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6107****       A T-TRANSFER.                                   ****
  6108             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6109
  6110         16  FILLER                         PIC XX.
  6111
  6112         16  CF-CARRIER-CNTL-OPT.
  6113             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6114                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6115                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6116             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6117                                            PIC X.
  6118         16  CF-GROUP-CNTL-OPT.
  6119             20  CF-GROUP-OPT-SEQ           PIC 9.
  6120                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6121                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6122             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6123                                            PIC X(6).
  6124         16  CF-STATE-CNTL-OPT.
  6125             20  CF-STATE-OPT-SEQ           PIC 9.
  6126                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6127                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6128             20  CF-STATE-SELECT OCCURS 3 TIMES
  6129                                            PIC XX.
  6130         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 118
* EL689.cbl
  6131             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6132                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6133                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6134             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6135                                            PIC X(10).
  6136         16  CF-BUS-TYP-CNTL-OPT.
  6137             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6138                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6139                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6140             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6141                                            PIC XX.
  6142         16  CF-LF-TYP-CNTL-OPT.
  6143             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6144                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6145                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6146             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6147                                            PIC XX.
  6148         16  CF-AH-TYP-CNTL-OPT.
  6149             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6150                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6151                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6152             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6153                                            PIC XX.
  6154         16  CF-REPTCD1-CNTL-OPT.
  6155             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6156                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6157                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6158             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6159                                            PIC X(10).
  6160         16  CF-REPTCD2-CNTL-OPT.
  6161             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6162                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6163                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6164             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6165                                            PIC X(10).
  6166         16  CF-USER1-CNTL-OPT.
  6167             20  CF-USER1-OPT-SEQ           PIC 9.
  6168                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6169                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6170             20  CF-USER1-SELECT OCCURS 3 TIMES
  6171                                            PIC X(10).
  6172         16  CF-USER2-CNTL-OPT.
  6173             20  CF-USER2-OPT-SEQ           PIC 9.
  6174                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6175                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6176             20  CF-USER2-SELECT OCCURS 3 TIMES
  6177                                            PIC X(10).
  6178         16  CF-USER3-CNTL-OPT.
  6179             20  CF-USER3-OPT-SEQ           PIC 9.
  6180                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6181                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6182             20  CF-USER3-SELECT OCCURS 3 TIMES
  6183                                            PIC X(10).
  6184         16  CF-USER4-CNTL-OPT.
  6185             20  CF-USER4-OPT-SEQ           PIC 9.
  6186                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6187                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6188             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 119
* EL689.cbl
  6189                                            PIC X(10).
  6190         16  CF-USER5-CNTL-OPT.
  6191             20  CF-USER5-OPT-SEQ           PIC 9.
  6192                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6193                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6194             20  CF-USER5-SELECT OCCURS 3 TIMES
  6195                                            PIC X(10).
  6196         16  CF-REINS-CNTL-OPT.
  6197             20  CF-REINS-OPT-SEQ           PIC 9.
  6198                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6199                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6200             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6201                 24  CF-REINS-PRIME         PIC XXX.
  6202                 24  CF-REINS-SUB           PIC XXX.
  6203
  6204         16  CF-AGENT-CNTL-OPT.
  6205             20  CF-AGENT-OPT-SEQ           PIC 9.
  6206                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6207                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6208             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6209                                            PIC X(10).
  6210
  6211         16  FILLER                         PIC X(43).
  6212
  6213         16  CF-LOSS-RATIO-SELECT.
  6214             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6215             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6216         16  CF-ENTRY-DATE-SELECT.
  6217             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6218             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6219         16  CF-EFFECTIVE-DATE-SELECT.
  6220             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6221             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6222
  6223         16  CF-EXCEPTION-LIST-IND          PIC X.
  6224             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6225
  6226         16  FILLER                         PIC X(318).
  6227
  6228****************************************************************
  6229*                  EXCEPTION REPORTING RECORD                  *
  6230****************************************************************
  6231
  6232     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6233         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6234             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6235
  6236         16  CF-COMBINED-LIFE-AH-OPT.
  6237             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6238             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6239             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6240             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6241
  6242         16  CF-LIFE-OPT.
  6243             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6244             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6245             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6246             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 120
* EL689.cbl
  6247             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6248             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6249             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6250             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6251             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6252             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6253
  6254         16  CF-AH-OPT.
  6255             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6256             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6257             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6258             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6259             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6260             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6261             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6262             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6263             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6264             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6265
  6266         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6267             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6268             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6269             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6270
  6271         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6272
  6273         16  FILLER                         PIC X(673).
  6274
  6275
  6276****************************************************************
  6277*             MORTGAGE SYSTEM PLAN RECORD                      *
  6278****************************************************************
  6279
  6280     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6281         16  CF-PLAN-TYPE                   PIC X.
  6282             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6283             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6284             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6285         16  CF-PLAN-ABBREV                 PIC XXX.
  6286         16  CF-PLAN-DESCRIPT               PIC X(10).
  6287         16  CF-PLAN-NOTES                  PIC X(20).
  6288         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6289         16  CF-PLAN-UNDERWRITING.
  6290             20  CF-PLAN-TERM-DATA.
  6291                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6292                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6293             20  CF-PLAN-AGE-DATA.
  6294                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6295                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6296                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6297             20  CF-PLAN-BENEFIT-DATA.
  6298                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6299                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6300                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6301                                            PIC S9(7)V99  COMP-3.
  6302         16  CF-PLAN-POLICY-FORMS.
  6303             20  CF-POLICY-FORM             PIC X(12).
  6304             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 121
* EL689.cbl
  6305             20  CF-MASTER-POLICY           PIC X(12).
  6306         16  CF-PLAN-RATING.
  6307             20  CF-RATE-CODE               PIC X(5).
  6308             20  CF-SEX-RATING              PIC X.
  6309                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6310                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6311             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6312             20  CF-SUB-STD-TYPE            PIC X.
  6313                 88  CF-PCT-OF-PREM            VALUE '1'.
  6314                 88  CF-PCT-OF-BENE            VALUE '2'.
  6315         16  CF-PLAN-PREM-TOLERANCES.
  6316             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6317             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6318         16  CF-PLAN-PYMT-TOLERANCES.
  6319             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6320             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6321         16  CF-PLAN-MISC-DATA.
  6322             20  FILLER                     PIC X.
  6323             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6324             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6325         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6326         16  CF-PLAN-IND-GRP                PIC X.
  6327             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6328                                                     '1'.
  6329             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6330                                                     '2'.
  6331         16  CF-MIB-SEARCH-SW               PIC X.
  6332             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6333             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6334             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6335             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6336         16  CF-ALPHA-SEARCH-SW             PIC X.
  6337             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6338             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6339             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6340             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6341             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6342             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6343             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6344             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6345             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6346             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6347                                                     'A' 'B' 'C'
  6348                                                     'X' 'Y' 'Z'.
  6349         16  CF-EFF-DT-RULE-SW              PIC X.
  6350             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6351             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6352             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6353             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6354             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6355         16  FILLER                         PIC X(4).
  6356         16  CF-HEALTH-QUESTIONS            PIC X.
  6357             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6358         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6359         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6360         16  CF-PLAN-SNGL-JNT               PIC X.
  6361             88  CF-COMBINED-PLAN              VALUE 'C'.
  6362             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 122
* EL689.cbl
  6363             88  CF-SNGL-PLAN                  VALUE 'S'.
  6364         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6365         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6366         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6367         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6368         16  CF-RERATE-CNTL                 PIC  X.
  6369             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6370             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6371             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6372             88  CF-AUTO-RECALC                 VALUE '4'.
  6373         16  CF-BENEFIT-TYPE                PIC  X.
  6374             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6375             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6376         16  CF-POLICY-FEE                  PIC S999V99
  6377                                                    COMP-3.
  6378         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6379         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6380         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6381         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6382         16  FILLER                         PIC  X(32).
  6383         16  CF-TERMINATION-FORM            PIC  X(04).
  6384         16  FILLER                         PIC  X(08).
  6385         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6386                                                       COMP-3.
  6387         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6388         16  CF-ISSUE-LETTER                PIC  X(4).
  6389         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6390         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6391             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6392             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6393         16  CF-MP-REFUND-CALC              PIC X.
  6394             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6395             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6396             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6397             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6398             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6399             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6400             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6401             88  CF-MP-REFD-MEAN                VALUE '8'.
  6402         16  CF-ALT-RATE-CODE               PIC  X(5).
  6403
  6404
  6405         16  FILLER                         PIC X(498).
  6406****************************************************************
  6407*             MORTGAGE COMPANY MASTER RECORD                   *
  6408****************************************************************
  6409
  6410     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6411         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6412         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6413             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6414             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6415             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6416             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6417             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6418
  6419         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6420         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 123
* EL689.cbl
  6421         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6422         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6423         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6424
  6425         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6426             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6427         16  CF-MP-RECON-USE-IND            PIC X(1).
  6428             88  CF-MP-USE-RECON             VALUE 'Y'.
  6429         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6430             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6431         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6432             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6433             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6434         16  FILLER                         PIC X(1).
  6435         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6436             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6437         16  CF-MORTG-MIB-VERSION           PIC X.
  6438             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6439             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6440             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6441         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6442             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6443                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6444             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6445                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6446             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6447                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6448             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6449                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6450             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6451                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6452             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6453                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6454         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6455         16  FILLER                         PIC X(7).
  6456         16  CF-MORTG-DESTINATION-SYMBOL.
  6457             20  CF-MORTG-MIB-COMM          PIC X(5).
  6458             20  CF-MORTG-MIB-TERM          PIC X(5).
  6459         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6460             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6461         16  FILLER                         PIC X(03).
  6462         16  CF-MP-CHECK-NO-CONTROL.
  6463             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6464                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6465                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6466                                                ' ' LOW-VALUES.
  6467                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6468                                               VALUE '3'.
  6469         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6470         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6471         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6472             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6473                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6474             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6475                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6476             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6477                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6478             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 124
* EL689.cbl
  6479                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6480             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6481                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6482             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6483                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6484         16  CF-MORTG-BILLING-AREA.
  6485             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6486                                            PIC X.
  6487         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6488         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6489         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6490         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6491             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6492             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6493         16  FILLER                         PIC X.
  6494         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6495             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6496             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6497         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6498         16  FILLER                         PIC X(8).
  6499         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6500         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6501         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6502         16  CF-ACH-COMPANY-ID.
  6503             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6504                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6505                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6506                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6507             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6508         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6509             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6510         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6511             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6512             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6513         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6514         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6515         16  FILLER                         PIC X(536).
  6516
  6517****************************************************************
  6518*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6519****************************************************************
  6520
  6521     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6522         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6523             20  CF-FEMALE-HEIGHT.
  6524                 24  CF-FEMALE-FT           PIC 99.
  6525                 24  CF-FEMALE-IN           PIC 99.
  6526             20  CF-FEMALE-MIN-WT           PIC 999.
  6527             20  CF-FEMALE-MAX-WT           PIC 999.
  6528         16  FILLER                         PIC X(428).
  6529
  6530     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6531         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6532             20  CF-MALE-HEIGHT.
  6533                 24  CF-MALE-FT             PIC 99.
  6534                 24  CF-MALE-IN             PIC 99.
  6535             20  CF-MALE-MIN-WT             PIC 999.
  6536             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 125
* EL689.cbl
  6537         16  FILLER                         PIC X(428).
  6538******************************************************************
  6539*             AUTOMATIC ACTIVITY RECORD                          *
  6540******************************************************************
  6541     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6542         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6543             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6544             20  CF-SYS-LETTER-ID           PIC X(04).
  6545             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6546             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6547             20  CF-SYS-RESET-SW            PIC X(01).
  6548             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6549             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6550
  6551         16  FILLER                         PIC X(50).
  6552
  6553         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6554             20  CF-USER-ACTIVE-SW          PIC X(01).
  6555             20  CF-USER-LETTER-ID          PIC X(04).
  6556             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6557             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6558             20  CF-USER-RESET-SW           PIC X(01).
  6559             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6560             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6561             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6562
  6563         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 126
* EL689.cbl
  6565*    COPY ERCCOMP.
  6566******************************************************************
  6567*                                                                *
  6568*                                                                *
  6569*                            ERCCOMP                             *
  6570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6571*                            VMOD=2.019                          *
  6572*                                                                *
  6573*   ONLINE CREDIT SYSTEM                                         *
  6574*                                                                *
  6575*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6576*                                                                *
  6577*   FILE TYPE = VSAM,KSDS                                        *
  6578*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6579*                                                                *
  6580*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6581*       ALTERNATE PATH = NONE                                    *
  6582*                                                                *
  6583*   LOG = NO                                                     *
  6584*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6585*                                                                *
  6586******************************************************************
  6587*                   C H A N G E   L O G
  6588*
  6589* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6590*-----------------------------------------------------------------
  6591*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6592* EFFECTIVE    NUMBER
  6593*-----------------------------------------------------------------
  6594* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6595* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6596* 092205    2005050300006  PEMA  ADD LEASE FEE
  6597* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6598* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6599* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6600* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6601* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6602* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6603******************************************************************
  6604
  6605 01  COMPENSATION-MASTER.
  6606     12  CO-RECORD-ID                          PIC XX.
  6607         88  VALID-CO-ID                          VALUE 'CO'.
  6608
  6609     12  CO-CONTROL-PRIMARY.
  6610         16  CO-COMPANY-CD                     PIC X.
  6611         16  CO-CONTROL.
  6612             20  CO-CTL-1.
  6613                 24  CO-CARR-GROUP.
  6614                     28  CO-CARRIER            PIC X.
  6615                     28  CO-GROUPING.
  6616                         32  CO-GROUP-PREFIX   PIC XXX.
  6617                         32  CO-GROUP-PRIME    PIC XXX.
  6618                 24  CO-RESP-NO.
  6619                     28  CO-RESP-PREFIX        PIC X(4).
  6620                     28  CO-RESP-PRIME         PIC X(6).
  6621             20  CO-CTL-2.
  6622                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 127
* EL689.cbl
  6623                     28  CO-ACCT-PREFIX        PIC X(4).
  6624                     28  CO-ACCT-PRIME         PIC X(6).
  6625         16  CO-TYPE                           PIC X.
  6626             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6627             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6628             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6629
  6630     12  CO-MAINT-INFORMATION.
  6631         16  CO-LAST-MAINT-DT                  PIC XX.
  6632         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6633         16  CO-LAST-MAINT-USER                PIC X(4).
  6634     12  FILLER                                PIC XX.
  6635     12  CO-STMT-TYPE                          PIC XXX.
  6636     12  CO-COMP-TYPE                          PIC X.
  6637         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6638     12  CO-STMT-OWNER                         PIC X(4).
  6639     12  CO-BALANCE-CONTROL                    PIC X.
  6640         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6641         88  CO-NO-BALANCE                        VALUE 'N'.
  6642
  6643     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6644         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6645         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6646         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6647
  6648     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6649         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6650         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6651
  6652     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6653     12  CO-GA-DIRECT-DEP                      PIC X.
  6654     12  CO-FUTURE-SPACE                       PIC X.
  6655         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6656
  6657     12  CO-ACCT-NAME                          PIC X(30).
  6658     12  CO-MAIL-NAME                          PIC X(30).
  6659     12  CO-ADDR-1                             PIC X(30).
  6660     12  CO-ADDR-2                             PIC X(30).
  6661     12  CO-ADDR-3.
  6662         16  CO-ADDR-CITY                      PIC X(27).
  6663         16  CO-ADDR-STATE                     PIC XX.
  6664     12  CO-CSO-1099                           PIC X.
  6665     12  CO-ZIP.
  6666         16  CO-ZIP-PRIME.
  6667             20  CO-ZIP-PRI-1ST                PIC X.
  6668                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6669             20  FILLER                        PIC X(4).
  6670         16  CO-ZIP-PLUS4                      PIC X(4).
  6671     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6672         16  CO-CAN-POSTAL-1                   PIC XXX.
  6673         16  CO-CAN-POSTAL-2                   PIC XXX.
  6674         16  FILLER                            PIC XXX.
  6675     12  CO-SOC-SEC                            PIC X(13).
  6676     12  CO-TELEPHONE.
  6677         16  CO-AREA-CODE                      PIC XXX.
  6678         16  CO-PREFIX                         PIC XXX.
  6679         16  CO-PHONE                          PIC X(4).
  6680
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 128
* EL689.cbl
  6681     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6682
  6683     12  CO-AR-BAL-LEVEL                       PIC X.
  6684         88  CO-AR-REF-LVL                        VALUE '1'.
  6685         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6686         88  CO-AR-BILL-LVL                       VALUE '2'.
  6687         88  CO-AR-AGT-LVL                        VALUE '3'.
  6688         88  CO-AR-FR-LVL                         VALUE '4'.
  6689
  6690     12  CO-AR-NORMAL-PRINT                    PIC X.
  6691         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6692         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6693
  6694     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6695
  6696     12  CO-AR-REPORTING                       PIC X.
  6697         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6698         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6699
  6700     12  CO-AR-PULL-CHECK                      PIC X.
  6701         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6702         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6703
  6704     12  CO-AR-BALANCE-PRINT                   PIC X.
  6705         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6706
  6707     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6708         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6709         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6710         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6711
  6712     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6713
  6714     12  CO-USER-CODE                          PIC X.
  6715     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6716
  6717******************************************************************
  6718*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6719*    THE LAST MONTH END RUN.
  6720******************************************************************
  6721
  6722     12  CO-LAST-ACTIVITY-DATE.
  6723         16  CO-ACT-YEAR                       PIC 99.
  6724         16  CO-ACT-MONTH                      PIC 99.
  6725         16  CO-ACT-DAY                        PIC 99.
  6726
  6727     12  CO-LAST-STMT-DT.
  6728         16  CO-LAST-STMT-YEAR                 PIC 99.
  6729         16  CO-LAST-STMT-MONTH                PIC 99.
  6730         16  CO-LAST-STMT-DAY                  PIC 99.
  6731
  6732     12  CO-MO-END-TOTALS.
  6733         16  CO-MONTHLY-TOTALS.
  6734             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6735             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6736             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6737             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6738             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 129
* EL689.cbl
  6739
  6740         16  CO-AGING-TOTALS.
  6741             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6742             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6743             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6744             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6745
  6746         16  CO-YTD-TOTALS.
  6747             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6748             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6749
  6750         16  CO-OVER-UNDER-TOTALS.
  6751             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6752             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6753
  6754     12  CO-MISCELLANEOUS-TOTALS.
  6755         16  CO-FICA-TOTALS.
  6756             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6757             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6758
  6759         16  CO-CLAIM-TOTALS.
  6760             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6761             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6762
  6763******************************************************************
  6764*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6765*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6766******************************************************************
  6767
  6768     12  CO-CURRENT-TOTALS.
  6769         16  CO-CURRENT-LAST-STMT-DT.
  6770             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6771             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6772             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6773
  6774         16  CO-CURRENT-MONTHLY-TOTALS.
  6775             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6776             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6777             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6778             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6779             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6780
  6781         16  CO-CURRENT-AGING-TOTALS.
  6782             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6783             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6784             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6785             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6786
  6787         16  CO-CURRENT-YTD-TOTALS.
  6788             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6789             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6790
  6791     12  CO-PAID-COMM-TOTALS.
  6792         16  CO-YTD-PAID-COMMS.
  6793             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6794             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6795
  6796     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 130
* EL689.cbl
  6797         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6798         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6799
  6800     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6801         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6802         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6803         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6804         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6805         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6806         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6807         88  CO-FINAL-LETTER                  VALUE 'F'.
  6808         88  CO-RECONCILING                   VALUE 'R'.
  6809         88  CO-PHONE-CALL                    VALUE 'P'.
  6810         88  CO-LEGAL                         VALUE 'L'.
  6811         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6812         88  CO-WRITE-OFF                     VALUE 'W'.
  6813         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6814
  6815     12  CO-CSR-CODE                       PIC X(4).
  6816
  6817     12  CO-GA-STATUS-INFO.
  6818         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6819         16  CO-GA-TERMINATION-DT          PIC XX.
  6820         16  CO-GA-STATUS-CODE             PIC X.
  6821             88  CO-GA-ACTIVE                 VALUE 'A'.
  6822             88  CO-GA-INACTIVE               VALUE 'I'.
  6823             88  CO-GA-PENDING                VALUE 'P'.
  6824         16  CO-GA-COMMENTS.
  6825             20  CO-GA-COMMENT-1           PIC X(40).
  6826             20  CO-GA-COMMENT-2           PIC X(40).
  6827             20  CO-GA-COMMENT-3           PIC X(40).
  6828             20  CO-GA-COMMENT-4           PIC X(40).
  6829
  6830     12  CO-RPTCD2                         PIC X(10).
  6831     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6832         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6833         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6834
  6835     12  CO-TYPE-AGENT                     PIC X(01).
  6836         88  CO-CORPORATION                   VALUE 'C'.
  6837         88  CO-PARTNERSHIP                   VALUE 'P'.
  6838         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6839         88  CO-TRUST                         VALUE 'T'.
  6840         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6841
  6842     12  CO-FAXNO.
  6843         16  CO-FAX-AREA-CODE                  PIC XXX.
  6844         16  CO-FAX-PREFIX                     PIC XXX.
  6845         16  CO-FAX-PHONE                      PIC X(4).
  6846
  6847     12  CO-BANK-INFORMATION.
  6848         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6849         16  CO-BANK-TRANSIT-NON REDEFINES
  6850             CO-BANK-TRANSIT-NO                PIC 9(8).
  6851
  6852         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6853     12  CO-MISC-DEDUCT-INFO REDEFINES
  6854                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 131
* EL689.cbl
  6855         16  CO-MD-GL-ACCT                     PIC X(10).
  6856         16  CO-MD-DIV                         PIC XX.
  6857         16  CO-MD-CENTER                      PIC X(4).
  6858         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  6859         16  CO-CREATE-AP-CHECK                PIC X.
  6860         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6861         16  FILLER                            PIC XXX.
  6862     12  CO-ACH-STATUS                         PIC X.
  6863         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6864         88  CO-ACH-PENDING                        VALUE 'P'.
  6865
  6866     12  CO-BILL-SW                            PIC X.
  6867     12  CO-CONTROL-NAME                       PIC X(30).
  6868     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6869     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6870     12  CO-CLP-STATE                          PIC XX.
  6871     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6872     12  CO-SPP-REFUND-EDIT                    PIC X.
  6873
  6874******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 132
* EL689.cbl
  6876*    COPY ERCMAIL.
  6877******************************************************************
  6878*                                                                *
  6879*                                                                *
  6880*                            ERCMAIL                             *
  6881*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6882*                            VMOD=2.003                          *
  6883*                                                                *
  6884*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6885*                                                                *
  6886*   FILE TYPE = VSAM,KSDS                                        *
  6887*   RECORD SIZE = 374   RECFORM = FIX                            *
  6888*                                                                *
  6889*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6890*   ALTERNATE PATH    = NOT USED                                 *
  6891*                                                                *
  6892*   LOG = YES                                                    *
  6893*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6894******************************************************************
  6895*                   C H A N G E   L O G
  6896*
  6897* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6898*-----------------------------------------------------------------
  6899*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6900* EFFECTIVE    NUMBER
  6901*-----------------------------------------------------------------
  6902* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6903* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6904* 111108                   PEMA  ADD CRED BENE ADDR2
  6905******************************************************************
  6906
  6907 01  MAILING-DATA.
  6908     12  MA-RECORD-ID                      PIC XX.
  6909         88  VALID-MA-ID                       VALUE 'MA'.
  6910
  6911     12  MA-CONTROL-PRIMARY.
  6912         16  MA-COMPANY-CD                 PIC X.
  6913         16  MA-CARRIER                    PIC X.
  6914         16  MA-GROUPING.
  6915             20  MA-GROUPING-PREFIX        PIC XXX.
  6916             20  MA-GROUPING-PRIME         PIC XXX.
  6917         16  MA-STATE                      PIC XX.
  6918         16  MA-ACCOUNT.
  6919             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6920             20  MA-ACCOUNT-PRIME          PIC X(6).
  6921         16  MA-CERT-EFF-DT                PIC XX.
  6922         16  MA-CERT-NO.
  6923             20  MA-CERT-PRIME             PIC X(10).
  6924             20  MA-CERT-SFX               PIC X.
  6925
  6926     12  FILLER                            PIC XX.
  6927
  6928     12  MA-ACCESS-CONTROL.
  6929         16  MA-SOURCE-SYSTEM              PIC XX.
  6930             88  MA-FROM-CREDIT                VALUE 'CR'.
  6931             88  MA-FROM-VSI                   VALUE 'VS'.
  6932             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6933             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 133
* EL689.cbl
  6934         16  MA-RECORD-ADD-DT              PIC XX.
  6935         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6936         16  MA-LAST-MAINT-DT              PIC XX.
  6937         16  MA-LAST-MAINT-BY              PIC XXXX.
  6938         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6939
  6940     12  MA-PROFILE-INFO.
  6941         16  MA-QUALIFY-CODE-1             PIC XX.
  6942         16  MA-QUALIFY-CODE-2             PIC XX.
  6943         16  MA-QUALIFY-CODE-3             PIC XX.
  6944         16  MA-QUALIFY-CODE-4             PIC XX.
  6945         16  MA-QUALIFY-CODE-5             PIC XX.
  6946
  6947         16  MA-INSURED-LAST-NAME          PIC X(15).
  6948         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6949         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6950         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6951         16  MA-INSURED-BIRTH-DT           PIC XX.
  6952         16  MA-INSURED-SEX                PIC X.
  6953             88  MA-SEX-MALE                   VALUE 'M'.
  6954             88  MA-SEX-FEMALE                 VALUE 'F'.
  6955         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6956
  6957         16  MA-ADDRESS-CORRECTED          PIC X.
  6958         16  MA-JOINT-BIRTH-DT             PIC XX.
  6959*        16  FILLER                        PIC X(12).
  6960
  6961         16  MA-ADDRESS-LINE-1             PIC X(30).
  6962         16  MA-ADDRESS-LINE-2             PIC X(30).
  6963         16  MA-CITY-STATE.
  6964             20  MA-CITY                   PIC X(28).
  6965             20  MA-ADDR-STATE             PIC XX.
  6966         16  MA-ZIP.
  6967             20  MA-ZIP-CODE.
  6968                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6969                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6970                 24  FILLER                PIC X(4).
  6971             20  MA-ZIP-PLUS4              PIC X(4).
  6972         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6973             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6974             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6975             20  FILLER                    PIC X(3).
  6976
  6977         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6978
  6979         16  FILLER                        PIC XXX.
  6980*        16  FILLER                        PIC X(10).
  6981
  6982     12  MA-CRED-BENE-INFO.
  6983         16  MA-CRED-BENE-NAME                 PIC X(25).
  6984         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6985         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6986         16  MA-CRED-BENE-CTYST.
  6987             20  MA-CRED-BENE-CITY             PIC X(28).
  6988             20  MA-CRED-BENE-STATE            PIC XX.
  6989         16  MA-CRED-BENE-ZIP.
  6990             20  MA-CB-ZIP-CODE.
  6991                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 134
* EL689.cbl
  6992                     88  MA-CB-CANADIAN-POST-CODE
  6993                                           VALUE 'A' THRU 'Z'.
  6994                 24  FILLER                    PIC X(4).
  6995             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6996         16  MA-CB-CANADIAN-POSTAL-CODE
  6997                            REDEFINES MA-CRED-BENE-ZIP.
  6998             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6999             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7000             20  FILLER                        PIC X(3).
  7001     12  MA-POST-CARD-MAIL-DATA.
  7002         16  MA-MAIL-DATA OCCURS 7.
  7003             20  MA-MAIL-TYPE              PIC X.
  7004                 88  MA-12MO-MAILING           VALUE '1'.
  7005                 88  MA-EXP-MAILING            VALUE '2'.
  7006             20  MA-MAIL-STATUS            PIC X.
  7007                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7008                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7009                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7010             20  MA-MAIL-DATE              PIC XX.
  7011     12  FILLER                            PIC XX.
  7012     12  FILLER                            PIC XX.
  7013*    12  FILLER                            PIC X(30).
  7014******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 135
* EL689.cbl
  7016*    COPY ERCPNDB.
  7017******************************************************************
  7018*                                                                *
  7019*                                                                *
  7020*                            ERCPNDB.                            *
  7021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7022*                            VMOD=2.025                          *
  7023*                                                                *
  7024*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  7025*                                                                *
  7026******************************************************************
  7027*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  7028*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  7029******************************************************************
  7030*                                                                *
  7031*                                                                *
  7032*   FILE TYPE = VSAM,KSDS                                        *
  7033*   RECORD SIZE = 585  RECFORM = FIXED                           *
  7034*                                                                *
  7035*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  7036*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  7037*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  7038*                                                 RKP=13,LEN=36  *
  7039*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  7040*                                      AND CHG-SEQ.)             *
  7041*                                                RKP=49,LEN=11   *
  7042*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  7043*                                      AND CHG-SEQ.)             *
  7044*                                                RKP=60,LEN=15   *
  7045*                                                                *
  7046*   LOG = NO                                                     *
  7047*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7048******************************************************************
  7049******************************************************************
  7050*                   C H A N G E   L O G
  7051*
  7052* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7053*-----------------------------------------------------------------
  7054*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7055* EFFECTIVE    NUMBER
  7056*-----------------------------------------------------------------
  7057* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7058* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7059* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7060* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7061* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7062* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7063* 032306                   PEMA  ADD BOW LOAN NUMBER
  7064* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7065* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7066* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7067* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7068* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7069* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7070* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7071* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7072******************************************************************
  7073
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 136
* EL689.cbl
  7074 01  PENDING-BUSINESS.
  7075     12  PB-RECORD-ID                     PIC XX.
  7076         88  VALID-PB-ID                        VALUE 'PB'.
  7077
  7078     12  PB-CONTROL-PRIMARY.
  7079         16  PB-COMPANY-CD                PIC X.
  7080         16  PB-ENTRY-BATCH               PIC X(6).
  7081         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7082         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7083
  7084     12  PB-CONTROL-BY-ACCOUNT.
  7085         16  PB-COMPANY-CD-A1             PIC X.
  7086         16  PB-CARRIER                   PIC X.
  7087         16  PB-GROUPING.
  7088             20  PB-GROUPING-PREFIX       PIC XXX.
  7089             20  PB-GROUPING-PRIME        PIC XXX.
  7090         16  PB-STATE                     PIC XX.
  7091         16  PB-ACCOUNT.
  7092             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7093             20  PB-ACCOUNT-PRIME         PIC X(6).
  7094         16  PB-CERT-EFF-DT               PIC XX.
  7095         16  PB-CERT-NO.
  7096             20  PB-CERT-PRIME            PIC X(10).
  7097             20  PB-CERT-SFX              PIC X.
  7098         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7099
  7100         16  PB-RECORD-TYPE               PIC X.
  7101             88  PB-MAILING-DATA                VALUE '0'.
  7102             88  PB-ISSUE                       VALUE '1'.
  7103             88  PB-CANCELLATION                VALUE '2'.
  7104             88  PB-BATCH-TRAILER               VALUE '9'.
  7105
  7106     12  PB-CONTROL-BY-ORIG-BATCH.
  7107         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7108         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7109         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7110         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7111
  7112     12  PB-CONTROL-BY-CSR.
  7113         16  PB-CSR-COMPANY-CD            PIC X.
  7114         16  PB-CSR-ID                    PIC X(4).
  7115         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7116         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7117         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7118******************************************************************
  7119*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7120******************************************************************
  7121
  7122     12  PB-LAST-MAINT-DT                 PIC XX.
  7123     12  PB-LAST-MAINT-BY                 PIC X(4).
  7124     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7125
  7126     12  PB-RECORD-BODY                   PIC X(375).
  7127
  7128     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7129         16  PB-CERT-ORIGIN               PIC X.
  7130             88  CLASIC-CREATED-CERT         VALUE '1'.
  7131         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 137
* EL689.cbl
  7132             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7133             20  PB-I-INSURED-FIRST-NAME.
  7134                 24  PB-I-INSURED-1ST-INIT PIC X.
  7135                 24  FILLER                PIC X(9).
  7136             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7137         16  PB-I-AGE                     PIC S99   COMP-3.
  7138         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7139         16  PB-I-BIRTHDAY                PIC XX.
  7140         16  PB-I-INSURED-SEX             PIC X.
  7141             88  PB-SEX-MALE     VALUE 'M'.
  7142             88  PB-SEX-FEMALE   VALUE 'F'.
  7143
  7144         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7145         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7146         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7147         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7148         16  PB-I-SKIP-CODE               PIC X.
  7149             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7150             88  PB-SKIP-JULY              VALUE '1'.
  7151             88  PB-SKIP-AUGUST            VALUE '2'.
  7152             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7153             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7154             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7155             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7156             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7157             88  PB-SKIP-JUNE              VALUE '8'.
  7158             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7159             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7160             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7161         16  PB-I-TERM-TYPE               PIC X.
  7162             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7163             88  PB-PAID-WEEKLY            VALUE 'W'.
  7164             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7165             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7166             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7167         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7168         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7169         16  PB-I-DATA-ENTRY-SW           PIC X.
  7170             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7171             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7172             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7173             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7174         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7175         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7176*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7177         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7178         16  FILLER                       PIC X.
  7179
  7180         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7181             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7182             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7183                                                   '90' THRU '99'.
  7184         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7185                                          PIC XX.
  7186         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7187         16  PB-I-AMOUNT-FINANCED REDEFINES
  7188                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7189         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 138
* EL689.cbl
  7190         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7191                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7192         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7193         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7194         16  PB-I-CLP-AMOUNT REDEFINES
  7195                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7196         16  PB-I-LF-CALC-FLAG            PIC X.
  7197             88 PB-COMP-LF-PREM               VALUE '?'.
  7198         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7199         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7200         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7201         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7202         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7203         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7204         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7205         16  PB-I-LF-ABBR                 PIC XXX.
  7206         16  PB-I-LF-INPUT-CD             PIC XX.
  7207
  7208         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7209             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7210             88  PB-INVALID-AH               VALUE '  ' '00'
  7211                                                   '90' THRU '99'.
  7212         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7213         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7214         16  PB-I-AH-CALC-FLAG            PIC X.
  7215             88 PB-COMP-AH-PREM                  VALUE '?'.
  7216         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7217         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7218         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7219         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7220         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7221         16  PB-I-AH-ABBR                 PIC XXX.
  7222         16  PB-I-AH-INPUT-CD             PIC XXX.
  7223
  7224         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7225         16  PB-I-REIN-TABLE              PIC XXX.
  7226         16  PB-I-BUSINESS-TYPE           PIC 99.
  7227         16  PB-I-INDV-GRP-CD             PIC X.
  7228         16  PB-I-MORT-CODE.
  7229             20  PB-I-TABLE               PIC X.
  7230             20  PB-I-INTEREST            PIC XX.
  7231             20  PB-I-MORT-TYP            PIC X.
  7232         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7233         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7234         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7235         16  PB-I-INDV-GRP-OVRD           PIC X.
  7236         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7237         16  PB-I-SIG-SW                  PIC X.
  7238             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7239         16  PB-I-RATE-CLASS              PIC XX.
  7240         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7241         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7242         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7243         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7244         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7245         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7246         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7247         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 139
* EL689.cbl
  7248         16  PB-I-OB-FLAG                 PIC X.
  7249             88  PB-I-OB                      VALUE 'B'.
  7250             88  PB-I-SUMMARY                 VALUE 'Z'.
  7251         16  PB-I-ENTRY-STATUS            PIC X.
  7252             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7253                                              'M' '5' '9' '2'.
  7254             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7255             88  PB-I-POLICY-PENDING          VALUE '2'.
  7256             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7257             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7258             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7259             88  PB-I-REIN-ONLY               VALUE '9'.
  7260             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7261             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7262             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7263             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7264         16  PB-I-INT-CODE                PIC X.
  7265             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7266             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7267         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7268         16  PB-I-SOC-SEC-NO              PIC X(11).
  7269         16  PB-I-MEMBER-NO               PIC X(12).
  7270         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7271*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7272         16  PB-I-OLD-LOF                 PIC XXX.
  7273         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7274         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7275         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7276         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7277         16  PB-I-LIFE-INDICATOR          PIC X.
  7278             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7279         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7280         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7281                                          PIC S9(5)V99    COMP-3.
  7282         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7283             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7284             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7285         16  PB-I-1ST-PMT-DT              PIC XX.
  7286         16  PB-I-JOINT-INSURED.
  7287             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7288             20 PB-I-JOINT-FIRST-NAME.
  7289                24  PB-I-JOINT-FIRST-INIT PIC X.
  7290                24  FILLER                PIC X(9).
  7291             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7292*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7293         16  PB-I-BENEFICIARY-NAME.
  7294             20  PB-I-BANK-NUMBER         PIC X(10).
  7295             20  FILLER                   PIC X(15).
  7296         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7297         16  PB-I-REFERENCE               PIC X(12).
  7298         16  FILLER REDEFINES PB-I-REFERENCE.
  7299             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7300             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7301             20  PB-I-CLP-STATE           PIC XX.
  7302         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7303             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7304             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7305             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 140
* EL689.cbl
  7306         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7307         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7308         16  PB-I-RESIDENT-STATE          PIC XX.
  7309         16  PB-I-RATE-CODE               PIC X(4).
  7310         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7311         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7312         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7313         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7314         16  PB-I-BANK-NOCHRGB            PIC 99.
  7315         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7316         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7317
  7318     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7319         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7320             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7321         16  PB-C-CANCEL-ORIGIN           PIC X.
  7322             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7323         16  PB-C-LF-CANCEL-DT            PIC XX.
  7324         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7325         16  PB-C-LF-CALC-REQ             PIC X.
  7326             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7327         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7328         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7329         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7330             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7331         16  PB-C-AH-CANCEL-DT            PIC XX.
  7332         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7333         16  PB-C-AH-CALC-REQ             PIC X.
  7334             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7335         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7336         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7337         16  PB-C-LAST-NAME               PIC X(15).
  7338         16  PB-C-REFUND-SW               PIC X.
  7339             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7340             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7341         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7342         16  PB-C-PAYEE-CODE              PIC X(6).
  7343         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7344         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7345         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7346         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7347         16  PB-C-REFERENCE               PIC X(12).
  7348         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7349         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7350         16  PB-C-POST-CARD-IND           PIC X.
  7351         16  PB-C-CANCEL-REASON           PIC X.
  7352         16  PB-C-REF-INTERFACE-SW        PIC X.
  7353         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7354         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7355         16  FILLER                       PIC X(01).
  7356*        16  FILLER                       PIC X(18).
  7357         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7358*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7359         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7360         16  PB-CANCELED-CERT-DATA.
  7361             20  PB-CI-INSURED-NAME.
  7362                 24  PB-CI-LAST-NAME      PIC X(15).
  7363                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 141
* EL689.cbl
  7364             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7365             20  PB-CI-INSURED-SEX        PIC X.
  7366             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7367             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7368             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7369             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7370             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7371             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7372             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7373             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7374             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7375             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7376             20  PB-CI-RATE-CLASS         PIC XX.
  7377             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7378             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7379             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7380             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7381             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7382             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7383             20  PB-CI-LF-ABBR            PIC X(3).
  7384             20  PB-CI-AH-ABBR            PIC X(3).
  7385             20  PB-CI-OB-FLAG            PIC X.
  7386                 88  PB-CI-OB                VALUE 'B'.
  7387             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7388                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7389                                           'M' '4' '5' '9' '2'.
  7390                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7391                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7392                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7393                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7394                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7395                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7396                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7397                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7398                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7399                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7400                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7401                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7402             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7403                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7404                                           'M' '4' '5' '9' '2'.
  7405                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7406                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7407                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7408                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7409                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7410                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7411                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7412                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7413                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7414                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7415                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7416                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7417             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7418             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7419             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7420             20  PB-CI-MEMBER-NO          PIC X(12).
  7421             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 142
* EL689.cbl
  7422                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7423                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7424             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7425             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7426             20  PB-CI-COMP-EXCP-SW       PIC X.
  7427                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7428                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7429             20  PB-CI-ENTRY-STATUS       PIC X.
  7430             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7431             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7432             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7433             20  PB-CI-DEATH-DT           PIC XX.
  7434             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7435             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7436             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7437             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7438             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7439             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7440             20  PB-CI-ENTRY-DT              PIC XX.
  7441             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7442             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7443             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7444             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7445             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7446             20  PB-CI-OLD-LOF               PIC XXX.
  7447*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7448             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7449             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7450             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7451             20  PB-CI-INDV-GRP-CD           PIC X.
  7452             20  PB-CI-BENEFICIARY-NAME.
  7453                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7454                 24  FILLER                  PIC X(15).
  7455             20  PB-CI-NOTE-SW               PIC X.
  7456             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7457             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7458             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7459             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7460             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7461             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7462             20  PB-CI-FIRST-NAME            PIC X(10).
  7463             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7464
  7465         16  FILLER                       PIC X(13).
  7466*032306  16  FILLER                       PIC X(27).
  7467*        16  FILLER                       PIC X(46).
  7468
  7469     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7470         16  FILLER                       PIC X(10).
  7471         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7472         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7473         16  PB-M-INSURED-MID-INIT        PIC X.
  7474         16  PB-M-INSURED-AGE             PIC 99.
  7475         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7476         16  PB-M-INSURED-SEX             PIC X.
  7477         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7478         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7479         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 143
* EL689.cbl
  7480         16  PB-M-INSURED-CITY-STATE.
  7481             20  PB-M-INSURED-CITY        PIC X(28).
  7482             20  PB-M-INSURED-STATE       PIC XX.
  7483         16  PB-M-INSURED-ZIP-CODE.
  7484             20  PB-M-INSURED-ZIP-PRIME.
  7485                 24  PB-M-INSURED-ZIP-1   PIC X.
  7486                     88  PB-M-CANADIAN-POST-CODE
  7487                                             VALUE 'A' THRU 'Z'.
  7488                 24  FILLER               PIC X(4).
  7489             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7490         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7491                                        PB-M-INSURED-ZIP-CODE.
  7492             20  PM-M-INS-CAN-POST1       PIC XXX.
  7493             20  PM-M-INS-CAN-POST2       PIC XXX.
  7494             20  FILLER                   PIC XXX.
  7495         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7496         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7497         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7498         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7499         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7500         16  PB-M-CRED-BENE-CITYST.
  7501             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7502             20  PB-M-CRED-BENE-STATE     PIC XX.
  7503         16  FILLER                       PIC X(92).
  7504
  7505     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7506         16  FILLER                       PIC X(10).
  7507         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7508         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7509         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7510         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7511         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7512         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7513         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7514         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7515         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7516         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7517         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7518         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7519         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7520         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7521         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7522         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7523         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7524         16  PB-ACCOUNT-NAME              PIC X(30).
  7525         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7526         16  PB-REFERENCE                 PIC X(12).
  7527         16  PB-B-RECEIVED-DT             PIC XX.
  7528         16  FILLER                       PIC X(234).
  7529
  7530     12  PB-RECORD-STATUS.
  7531         16  PB-CREDIT-SELECT-DT          PIC XX.
  7532         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7533         16  PB-BILLED-DT                 PIC XX.
  7534         16  PB-BILLING-STATUS            PIC X.
  7535             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7536             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7537             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 144
* EL689.cbl
  7538         16  PB-RECORD-BILL               PIC X.
  7539             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7540             88  PB-RECORD-RETURNED           VALUE 'R'.
  7541             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7542             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7543             88  PB-OVERRIDE-AH               VALUE 'A'.
  7544             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7545         16  PB-BATCH-ENTRY               PIC X.
  7546             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7547             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7548             88  PB-REISSUED-CERT             VALUE 'E'.
  7549             88  PB-MONTHLY-CERT              VALUE 'M'.
  7550             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7551             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7552             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7553         16  PB-FORCE-CODE                PIC X.
  7554             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7555             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7556             88  PB-CANCEL-FORCE              VALUE '8'.
  7557             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7558             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7559             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7560             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7561             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7562             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7563             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7564         16  PB-FATAL-FLAG                PIC X.
  7565             88  PB-FATAL-ERRORS              VALUE 'X'.
  7566         16  PB-FORCE-ER-CD               PIC X.
  7567             88  PB-FORCE-ERRORS              VALUE 'F'.
  7568             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7569         16  PB-WARN-ER-CD                PIC X.
  7570             88  PB-WARNING-ERRORS            VALUE 'W'.
  7571         16  FILLER                       PIC X.
  7572         16  PB-OUT-BAL-CD                PIC X.
  7573             88  PB-OUT-OF-BAL                VALUE 'O'.
  7574         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7575         16  PB-AH-OVERRIDE-L1            PIC X.
  7576         16  PB-INPUT-DT                  PIC XX.
  7577         16  PB-INPUT-BY                  PIC X(4).
  7578         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7579         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7580         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7581         16  PB-LF-EARNING-METHOD         PIC X.
  7582         16  PB-AH-EARNING-METHOD         PIC X.
  7583         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7584         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7585         16  PB-REIN-CD                   PIC XXX.
  7586         16  PB-LF-REFUND-TYPE            PIC X.
  7587         16  PB-AH-REFUND-TYPE            PIC X.
  7588         16  PB-ACCT-EFF-DT               PIC XX.
  7589         16  PB-ACCT-EXP-DT               PIC XX.
  7590         16  PB-COMPANY-ID                PIC X(3).
  7591         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7592         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7593         16  PB-SV-CARRIER                PIC X.
  7594         16  PB-SV-GROUPING               PIC X(6).
  7595         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 145
* EL689.cbl
  7596         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7597         16  PB-GA-BILLING-INFO.
  7598             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7599                                          PIC XX.
  7600         16  PB-SV-REMIT-TO  REDEFINES
  7601             PB-GA-BILLING-INFO           PIC X(10).
  7602         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7603         16  PB-I-LOAN-OFFICER            PIC X(5).
  7604         16  PB-I-VIN                     PIC X(17).
  7605
  7606         16  FILLER                       PIC X(04).
  7607         16  IMNET-BYPASS-SW              PIC X.
  7608
  7609******************************************************************
  7610*                COMMON EDIT ERRORS                              *
  7611******************************************************************
  7612
  7613     12  PB-COMMON-ERRORS.
  7614         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7615                                           PIC S9(4)     COMP.
  7616
  7617******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 146
* EL689.cbl
  7619*    COPY ERCPYAJ.
  7620******************************************************************
  7621*                                                                *
  7622*                            ERCPYAJ                             *
  7623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7624*                            VMOD=2.015                          *
  7625*                                                                *
  7626*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7627*                                                                *
  7628*                                                                *
  7629*   FILE TYPE = VSAM,KSDS                                        *
  7630*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7631*                                                                *
  7632*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7633*       ALTERNATE PATHS = NONE                                   *
  7634*                                                                *
  7635*   LOG = YES                                                    *
  7636*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7637******************************************************************
  7638******************************************************************
  7639*                   C H A N G E   L O G
  7640*
  7641* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7642*-----------------------------------------------------------------
  7643*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7644* EFFECTIVE    NUMBER
  7645*-----------------------------------------------------------------
  7646* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7647* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7648******************************************************************
  7649
  7650 01  PENDING-PAY-ADJ.
  7651     12  PY-RECORD-ID                     PIC XX.
  7652         88  VALID-PY-ID                        VALUE 'PY'.
  7653
  7654     12  PY-CONTROL-PRIMARY.
  7655         16  PY-COMPANY-CD                PIC X.
  7656         16  PY-CARRIER                   PIC X.
  7657         16  PY-GROUPING                  PIC X(6).
  7658         16  PY-FIN-RESP                  PIC X(10).
  7659         16  PY-ACCOUNT                   PIC X(10).
  7660         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7661                                          PIC X(10).
  7662         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7663         16  PY-RECORD-TYPE               PIC X.
  7664             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7665             88  PY-DEPOSIT                   VALUE 'D'.
  7666             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7667             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7668             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7669             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7670             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7671             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7672             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7673             88  PY-FICA-ENTRY                VALUE 'F'.
  7674             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7675             88  PY-POLICY-FEE                VALUE 'W'.
  7676             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 147
* EL689.cbl
  7677
  7678     12  PY-PYMT-TYPE                     PIC X.
  7679             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7680             88  PY-REINS-PYMT                VALUE 'R'.
  7681             88  PY-EXP-PYMT                  VALUE 'E'.
  7682
  7683     12  PY-BIL-INV                       PIC X(6).
  7684     12  PY-REF-NO                        PIC X(12).
  7685
  7686     12  PY-LAST-MAINT-DT                 PIC XX.
  7687     12  PY-LAST-MAINT-BY                 PIC X(4).
  7688     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7689
  7690     12  PY-PYADJ-RECORD.
  7691         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7692         16  PY-ENTRY-COMMENT             PIC X(30).
  7693         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7694             20  PY-GL-ACCOUNT            PIC X(10).
  7695             20  PY-GL-STATE              PIC X(02).
  7696             20  PY-GL-CANC-SW            PIC X(01).
  7697                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7698                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7699             20  PY-GL-COMMENT            PIC X(10).
  7700             20  FILLER      REDEFINES PY-GL-COMMENT.
  7701                 24  PY-GL-CHECK-NO       PIC 9(06).
  7702                 24  FILLER               PIC X(04).
  7703             20  FILLER                   PIC X(07).
  7704         16  PY-SAVE-ACCOUNT              PIC X(10).
  7705         16  PY-SAVE-TYPE                 PIC X(01).
  7706
  7707         16  PY-LETTERS.
  7708             20  PY-LETTER OCCURS 3 TIMES
  7709                           INDEXED BY PY-LET-NDX
  7710                                          PIC X(04).
  7711
  7712         16  PY-ERCOMP-TYPE               PIC X.
  7713             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7714             88  PY-GA-TYPE                   VALUE 'G'.
  7715             88  PY-BANK-TYPE                 VALUE 'B'.
  7716         16  FILLER                       PIC X(05).
  7717
  7718     12  PY-RECORD-STATUS.
  7719         16  PY-CREDIT-SELECT-DT          PIC XX.
  7720         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7721         16  PY-BILLED-DATE               PIC XX.
  7722         16  PY-REPORTED-DT               PIC XX.
  7723         16  PY-PMT-APPLIED               PIC X.
  7724             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7725             88  PY-GA-PMT                    VALUE 'G'.
  7726             88  PY-OVWRITE-PMT               VALUE 'O'.
  7727             88  PY-NON-AR-PMT                VALUE 'N'.
  7728         16  FILLER                       PIC X(5).
  7729         16  PY-INPUT-DT                  PIC XX.
  7730         16  PY-CHECK-NUMBER              PIC X(6).
  7731         16  PY-VOID-SW                   PIC X.
  7732             88  PY-CHECK-VOIDED              VALUE 'V'.
  7733         16  PY-CHECK-ORIGIN-SW           PIC X.
  7734             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 148
* EL689.cbl
  7735             88  PY-REFUND-CHECK              VALUE 'R'.
  7736             88  PY-GA-CHECK                  VALUE 'G'.
  7737             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7738             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7739         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7740         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7741         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7742         16  PY-BILL-FLAG                 PIC X.
  7743             88  PY-BILLED                    VALUE 'B'.
  7744         16  PY-AR-FLAG                   PIC X.
  7745             88  PY-AR-CYCLE                  VALUE 'C'.
  7746             88  PY-AR-MONTH-END              VALUE 'M'.
  7747         16  PY-AR-DATE                   PIC XX.
  7748
  7749     12  PY-GL-CODES.
  7750         16  PY-GL-DB                     PIC X(14).
  7751         16  PY-GL-CR                     PIC X(14).
  7752         16  PY-GL-FLAG                   PIC X.
  7753         16  PY-GL-DATE                   PIC XX.
  7754
  7755     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7756     12  FILLER                           PIC X(3).
  7757******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 149
* EL689.cbl
  7759*    COPY ELCTEXT.
  7760******************************************************************
  7761*                                                                *
  7762*                                                                *
  7763*                            ELCTEXT.                            *
  7764*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7765*                            VMOD=2.008                          *
  7766*                                                                *
  7767*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7768*                                     FORM LETTERS,              *
  7769*                                     CERT FORM DISPLAY.
  7770*                                                                *
  7771*   FILE TYPE = VSAM,KSDS                                        *
  7772*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7773*                                                                *
  7774*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7775*       ALTERNATE INDEX = NONE                                   *
  7776*                                                                *
  7777*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7778*       ALTERNATE INDEX = NONE                                   *
  7779*                                                                *
  7780*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7781*       ALTERNATE INDEX = NONE                                   *
  7782*                                                                *
  7783*   LOG = NO                                                     *
  7784*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7785******************************************************************
  7786 01  TEXT-FILES.
  7787     12  TEXT-FILE-ID                PIC XX.
  7788         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7789         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7790         88  HELP-FILE-TEXT             VALUE 'TH'.
  7791
  7792     12  TX-CONTROL-PRIMARY.
  7793         16  TX-COMPANY-CD           PIC X.
  7794             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7795         16  TX-ACCESS-CD-GENL       PIC X(12).
  7796
  7797         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7798             20  TX-LETTER-NO        PIC X(4).
  7799             20  FILLER              PIC X(8).
  7800
  7801         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7802             20  TX-FORM-NO          PIC X(12).
  7803
  7804         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7805             20  TX-HELP-TYPE        PIC X.
  7806                 88  HELP-FOR-GENERAL   VALUE ' '.
  7807                 88  HELP-BY-SCREEN     VALUE 'S'.
  7808                 88  HELP-BY-ERROR      VALUE 'E'.
  7809             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7810                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7811             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7812                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7813             20  FILLER              PIC X(4).
  7814
  7815         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7816
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 150
* EL689.cbl
  7817     12  TX-PROCESS-CONTROL          PIC XX.
  7818         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7819
  7820     12  TX-TEXT-LINE                PIC X(70).
  7821
  7822     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7823         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7824         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7825         88  TX-VALID-FORM-SQUEEZE-VALUE
  7826                                        VALUE 'Y' ' '.
  7827
  7828     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7829         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7830         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7831         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7832         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7833         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7834         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7835         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7836                                              'K' 'N' ' '
  7837                                              'Z'.
  7838
  7839     12  TX-ARCHIVE-SW               PIC X.
  7840         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  7841         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  7842         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  7843
  7844     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  7845     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  7846
  7847     12  TX-BSR-CODE                 PIC X.
  7848         88  TX-BSR-LETTER              VALUE 'B'.
  7849         88  TX-NON-BSR-LETTER          VALUE ' '.
  7850
  7851     12  FILLER                      PIC X.
  7852*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 151
* EL689.cbl
  7854*    COPY ERCENDT.
  7855******************************************************************
  7856*                                                                *
  7857*                                                                *
  7858*                            ERCENDT.                            *
  7859*                            VMOD=2.001                          *
  7860*                                                                *
  7861*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7862*                                                                *
  7863*   FILE TYPE = VSAM,KSDS                                        *
  7864*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7865*                                                                *
  7866*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7867*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7868*                                                                *
  7869*   LOG = NO                                                     *
  7870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7871******************************************************************
  7872*-----------------------------------------------------------------
  7873*                   C H A N G E   L O G
  7874*
  7875* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7876*-----------------------------------------------------------------
  7877*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7878* EFFECTIVE    NUMBER
  7879*-----------------------------------------------------------------
  7880* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7881*                                WITH OPEN CLAIMS
  7882* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7883* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7884* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7885*-----------------------------------------------------------------
  7886 01  ENDORSEMENT-RECORD.
  7887     12  EN-RECORD-ID                PIC XX.
  7888         88  VALID-EN-ID                VALUE 'EN'.
  7889     12  EN-CONTROL-PRIMARY.
  7890         16  EN-COMPANY-CD           PIC X.
  7891         16  EN-CARRIER              PIC X.
  7892         16  EN-GROUPING             PIC X(6).
  7893         16  EN-STATE                PIC XX.
  7894         16  EN-ACCOUNT              PIC X(10).
  7895         16  EN-CERT-EFF-DT          PIC XX.
  7896         16  EN-CERT-NO.
  7897             20  EN-CERT-PRIME       PIC X(10).
  7898             20  EN-CERT-SFX         PIC X.
  7899         16  EN-REC-TYPE             PIC X.
  7900             88  EN-ISSUE               VALUE 'I'.
  7901             88  EN-CANCELLATION        VALUE 'C'.
  7902         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7903     12  EN-CONTROL-BY-ARCH-NO.
  7904         16  EN-COMPANY-CD-A1              PIC X.
  7905         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7906     12  EN-LAST-MAINT-DT            PIC XX.
  7907     12  EN-LAST-MAINT-BY            PIC X(4).
  7908     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7909     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7910     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7911         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 152
* EL689.cbl
  7912         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7913         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7914         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7915         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7916         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7917         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7918         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7919         16  EN-LF-ORIG-BENCD        PIC XX.
  7920         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7921         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7922         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7923         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7924         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7925         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7926*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7927         16  EN-ORIG-CRED-BENE       PIC X(25).
  7928         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7929         16  FILLER                  PIC X.
  7930         16  EN-AH-ORIG-BENCD        PIC XX.
  7931         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7932         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7933         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7934         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7935*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7936*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7937         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7938         16  F                       PIC X(09).
  7939         16  EN-AH-ORIG-CP           PIC 99.
  7940         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7941         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7942         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7943         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7944         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7945         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7946         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7947         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7948         16  EN-LF-NEW-BENCD         PIC XX.
  7949         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7950         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7951         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7952         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7953         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7954         16  EN-LF-NEW-EXP-DT        PIC XX.
  7955         16  EN-NEW-CRED-BENE        PIC X(25).
  7956         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7957         16  FILLER                  PIC X.
  7958         16  EN-AH-NEW-BENCD         PIC XX.
  7959         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7960         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7961         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7962         16  EN-AH-NEW-EXP-DT        PIC XX.
  7963*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7964*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7965*        16  F                       PIC X(12).
  7966         16  EN-AH-NEW-CP            PIC 99.
  7967         16  EN-SIG-SW               PIC X.
  7968         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7969         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 153
* EL689.cbl
  7970         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7971         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7972         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7973         16  FILLER                  PIC X(33).
  7974     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7975         16  EN-LF-ORIG-REF-DT       PIC XX.
  7976         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7977         16  EN-AH-ORIG-REF-DT       PIC XX.
  7978         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7979         16  EN-LF-NEW-REF-DT        PIC XX.
  7980         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7981         16  EN-AH-NEW-REF-DT        PIC XX.
  7982         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7983         16  EN-FLAG-CERT            PIC X.
  7984         16  EN-INS-LAST-NAME        PIC X(15).
  7985         16  EN-INS-FIRST-NAME       PIC X(10).
  7986         16  EN-INS-MIDDLE-INIT      PIC X.
  7987         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7988         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7989         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7990         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7991         16  FILLER                  PIC X(262).
  7992     12  EN-MONEY-SW             PIC X.
  7993     12  EN-HEALTH-APP           PIC X.
  7994     12  EN-VOUCHER-SW           PIC X.
  7995     12  EN-PAYEE                PIC X(14).
  7996     12  EN-INPUT-DT             PIC XX.
  7997     12  EN-PROCESS-DT           PIC XX.
  7998     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7999     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8000     12  EN-REASON-CODES.
  8001         16  F OCCURS 12.
  8002             20  EN-REASON-CODE  PIC X(4).
  8003     12  EN-TEMPLATE-USED        PIC X(8).
  8004     12  EN-DOCU-TYPE            PIC X.
  8005         88  EN-VERI-DOCU          VALUE 'V'.
  8006         88  EN-GCE-DOCU           VALUE 'G'.
  8007         88  EN-CANC-DOCU          VALUE 'C'.
  8008     12  EN-COMMENTS1            PIC X(13).
  8009     12  EN-COMMENTS2            PIC X(70).
  8010     12  EN-COMM-CHGBK           PIC X.
  8011         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8012         88  EN-CHG-ACCT           VALUE 'Y'.
  8013     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8014     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8015     12  EN-BATCH-NUMBER         PIC X(6).
  8016     12  EN-ACCT-SUMM            PIC X.
  8017     12  EN-CSO-SUMM             PIC X.
  8018     12  FILLER                  PIC X(13).
  8019******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 154
* EL689.cbl
  8021*    COPY ERCNOTE.
  8022******************************************************************
  8023*                                                                *
  8024*                                                                *
  8025*                            ERCNOTE                             *
  8026*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8027*                            VMOD=2.003                          *
  8028*                                                                *
  8029*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  8030*                                                                *
  8031*        FILE TYPE= VSAM,KSDS                                    *
  8032*        RECORD SIZE = 825    RECFORM = FIXED                    *
  8033*                                                                *
  8034*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  8035*                                                                *
  8036*        LOG = YES                                               *
  8037*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8038*                                                                *
  8039******************************************************************
  8040*                   C H A N G E   L O G
  8041*
  8042* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8043*-----------------------------------------------------------------
  8044*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8045* EFFECTIVE    NUMBER
  8046*-----------------------------------------------------------------
  8047* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  8048*                                FILE WILL CONTAIN BILLING NOTES O
  8049******************************************************************
  8050
  8051 01  CERTIFICATE-NOTE.
  8052     12  CN-RECORD-ID                PIC  XX.
  8053         88  VALID-CN-ID                  VALUE 'CN'.
  8054
  8055     12  CN-CONTROL-PRIMARY.
  8056         16  CN-COMPANY-CD           PIC X.
  8057         16  CN-CARRIER              PIC X.
  8058         16  CN-GROUPING.
  8059             20 CN-GROUPING-PREFIX   PIC XXX.
  8060             20 CN-GROUPING-PRIME    PIC XXX.
  8061         16  CN-STATE                PIC XX.
  8062         16  CN-ACCOUNT.
  8063             20 CN-ACCOUNT-PREFIX    PIC X(4).
  8064             20 CN-ACCOUNT-PRIME     PIC X(6).
  8065         16  CN-CERT-EFF-DT          PIC XX.
  8066         16  CN-CERT-NO.
  8067             20  CN-CERT-PRIME       PIC X(10).
  8068             20  CN-CERT-SFX         PIC X.
  8069
  8070     12  CN-BILLING-START-LINE-NO    PIC 99.
  8071     12  CN-BILLING-END-LINE-NO      PIC 99.
  8072
  8073     12  CN-LINES.
  8074         16  CN-LINE OCCURS 10       PIC X(77).
  8075
  8076     12  CN-LAST-MAINT-DT            PIC XX.
  8077     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8078     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 155
* EL689.cbl
  8079     12  FILLER                      PIC X(6).
  8080******************************************************************
  8081*    COPY ELCEOBC.
  8082******************************************************************
  8083*                                                                *
  8084*                                                                *
  8085*                            ELCEOBC                             *
  8086*                            VMOD=2.001                          *
  8087*                                                                *
  8088*   CLAIM SYSTEM EOB CODE TABLE                                  *
  8089*                                                                *
  8090*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  8091*   VSAM EOB CODE TABLE                                          *
  8092*                                                                *
  8093*   FILE DESCRIPTION = EOB CODE TABLE                            *
  8094*                                                                *
  8095*   FILE TYPE = VSAM,KSDS                                        *
  8096*   RECORD SIZE = 350   RECFORM = FIX                            *
  8097*                                                                *
  8098*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  8099*                                                                *
  8100*   LOG = NO                                                     *
  8101*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8102*                                                                *
  8103*                                                                *
  8104******************************************************************
  8105*                   C H A N G E   L O G
  8106*
  8107* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8108*-----------------------------------------------------------------
  8109*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8110* EFFECTIVE    NUMBER
  8111*-----------------------------------------------------------------
  8112* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  8113* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  8114******************************************************************
  8115 01  EOB-CODES.
  8116     12  EO-RECORD-ID                      PIC XX.
  8117         88  VALID-DN-ID                      VALUE 'EO'.
  8118     12  EO-CONTROL-PRIMARY.
  8119         16  EO-COMPANY-CD                 PIC X.
  8120         16  EO-RECORD-TYPE                PIC X.
  8121             88  EO-EOB-RECS                  VALUE '1'.
  8122             88  EO-VERIF-RECS                VALUE '2'.
  8123             88  EO-GCE-RECS                  VALUE '3'.
  8124         16  EO-EOB-CODE                   PIC X(4).
  8125         16  FILLER                        PIC X(9).
  8126     12  EO-MAINT-INFORMATION.
  8127         16  EO-LAST-MAINT-DT              PIC XX.
  8128         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8129         16  EO-LAST-MAINT-USER            PIC X(4).
  8130         16  FILLER                        PIC XX.
  8131     12  EO-DESCRIPTION                    PIC X(275).
  8132     12  FILLER                            PIC X(46).
  8133******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 156
* EL689.cbl
  8135 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  8136                          ACCOUNT-MASTER LETTER-ARCHIVE
  8137                          LETTER-ARCHIVE-TEXT
  8138                          CERTIFICATE-MASTER CHECK-RECORDS
  8139                          CONTROL-FILE COMPENSATION-MASTER
  8140                          MAILING-DATA PENDING-BUSINESS
  8141                          PENDING-PAY-ADJ TEXT-FILES
  8142                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  8143                          EOB-CODES.
  8144 0000-DFHEXIT SECTION.
  8145     MOVE '9#                    $   ' TO DFHEIV0.
  8146     MOVE 'EL689' TO DFHEIV1.
  8147     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8148     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  8149
  8150     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8151     MOVE '5'                    TO DC-OPTION-CODE.
  8152     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  8153     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  8154     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  8155                                    W-CURRENT-SAVE.
  8156
  8157     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8158     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  8159                                 TO EMI-SAVE-AREA.
  8160
  8161     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8162                                    W-TS-TERM-SCREEN.
  8163
  8164     IF  EIBCALEN EQUAL 0
  8165         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  8166         GO TO 8300-SEND-TEXT
  8167     END-IF.
  8168     set P to address of KIXSYS
  8169     CALL "getenv" using by value P returning var-ptr
  8170     if var-ptr = null then
  8171        display ' kixsys not set '
  8172     else
  8173        set address of var to var-ptr
  8174        move 0 to env-var-len
  8175        inspect var tallying env-var-len
  8176          for characters before X'00'
  8177*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8178        unstring var (1:env-var-len) delimited by '/'
  8179           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8180              WS-KIX-SYS
  8181        end-unstring
  8182*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8183*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8184     end-if
  8185     set P to address of KIXHOST
  8186     CALL "getenv" using by value P returning var-ptr
  8187     if var-ptr = null then
  8188        display ' kixhost not set '
  8189     else
  8190        set address of var to var-ptr
  8191        move 0 to env-var-len
  8192        inspect var tallying env-var-len
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 157
* EL689.cbl
  8193          for characters before X'00'
  8194*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8195        MOVE var(1:env-var-len)  to ws-kixhost
  8196*       unstring var (1:env-var-len) delimited by '/'
  8197*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8198*             WS-KIX-SYS
  8199*       end-unstring
  8200        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8201*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8202     end-if
  8203     IF  PI-689-CREATE-NO-SCREENS
  8204         GO TO 0600-BYPASS-SCREEN-CNTL
  8205     END-IF.
  8206
  8207     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8208         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8209             MOVE PI-SAVED-PROGRAM-5
  8210                                 TO PI-SAVED-PROGRAM-6
  8211             MOVE PI-SAVED-PROGRAM-4
  8212                                 TO PI-SAVED-PROGRAM-5
  8213             MOVE PI-SAVED-PROGRAM-3
  8214                                 TO PI-SAVED-PROGRAM-4
  8215             MOVE PI-SAVED-PROGRAM-2
  8216                                 TO PI-SAVED-PROGRAM-3
  8217             MOVE PI-SAVED-PROGRAM-1
  8218                                 TO PI-SAVED-PROGRAM-2
  8219             MOVE PI-RETURN-TO-PROGRAM
  8220                                 TO PI-SAVED-PROGRAM-1
  8221             MOVE PI-CALLING-PROGRAM
  8222                                 TO PI-RETURN-TO-PROGRAM
  8223             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8224             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8225             MOVE LOW-VALUES     TO EL689AO
  8226             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8227             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8228                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8229             END-IF
  8230             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8231                     AND
  8232                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  8233                 GO TO 0400-EL6311-INCOMING
  8234             ELSE
  8235                 MOVE PI-689-ARCHIVE-NUMBER
  8236                                 TO W-INCOMING-ARCHIVE
  8237                 MOVE LOW-VALUES TO PI-1042-WA
  8238                                    PI-689-WORK-AREA
  8239                 MOVE ZEROS      TO PI-CURRENT-LINE
  8240                                    PI-TEMP-STOR-ITEMS
  8241                                    PI-TOTAL-LINES
  8242                                    PI-UPDATE-SW
  8243                                    PI-689-NUMBER-LABEL-LINES
  8244                                    PI-689-NUMBER-TEXT-RECORDS
  8245                                    PI-689-ERROR
  8246                 MOVE SPACES     TO PI-689-PRINT-SW
  8247                                    PI-689-ALT-PRINTER-ID
  8248                                    PI-689-LBL-OVERRIDE
  8249                                    PI-COMM-CONTROL
  8250                                    PI-689-FORM-NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 158
* EL689.cbl
  8251                                    PI-689-TEMP-STOR-ID
  8252                                    PI-689-LABEL-SOURCE
  8253                                    PI-689-USE-SCREEN-IND
  8254                 MOVE '2'        TO PI-ACTION
  8255                 MOVE -1         TO MAINTL
  8256                 MOVE PI-LOWER-CASE-LETTERS
  8257                                 TO W-LC-CASE-IND
  8258                 IF  W-INCOMING-ARCHIVE NUMERIC
  8259                         AND
  8260                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8261                     MOVE 'S'    TO MAINTI
  8262                     MOVE +1     TO MAINTL
  8263                     MOVE AL-UANON
  8264                                 TO MAINTA
  8265                     MOVE W-INCOMING-ARCH-NO
  8266                                 TO ARCHNUMI
  8267                     MOVE +8     TO ARCHNUML
  8268                     MOVE AL-UNNON
  8269                                 TO ARCHNUMA
  8270                     GO TO 1000-SHOW
  8271                 ELSE
  8272                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8273                 END-IF
  8274             END-IF
  8275         ELSE
  8276             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8277             MOVE PI-RETURN-TO-PROGRAM
  8278                                     TO PI-CALLING-PROGRAM
  8279             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8280             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8281             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8282             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8283             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8284             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8285             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8286             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8287             MOVE LOW-VALUES         TO EL689AO
  8288             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8289             SET W-RG-NDX            TO PI-CURRENT-LINE
  8290             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8291                 VARYING
  8292                     W-SC-NDX FROM 1 BY 1
  8293                 UNTIL
  8294                     W-SC-NDX GREATER THAN
  8295                     W-NUM-LINES-PER-SCREEN
  8296             MOVE PI-689-ALT-PRINTER-ID
  8297                                     TO PRINTERO
  8298             MOVE AL-UANON           TO PRINTERA
  8299             MOVE -1                 TO PRINTERL
  8300             GO TO 8100-SEND-INITIAL-MAP
  8301         END-IF
  8302     END-IF.
  8303
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 159
* EL689.cbl
  8305 0200-RECEIVE.
  8306
  8307     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8308     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8309     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8310             OR
  8311         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8312         MOVE 'Y'                TO W-HOLD-IND.
  8313
  8314     MOVE W-TRANSACTION          TO EIBTRNID.
  8315     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8316     MOVE ZEROS                  TO W-LAST-ERROR.
  8317     MOVE LOW-VALUES             TO EL689AI.
  8318     MOVE '104A'                 TO W-TS-ID-TEXT.
  8319     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8320                                    W-TS-TERM-SCREEN.
  8321
  8322
  8323* EXEC CICS HANDLE AID
  8324*        CLEAR    (9300-DFHCLEAR)
  8325*        PA1      (9200-PA)
  8326*        PA2      (9200-PA)
  8327*        PA3      (9200-PA)
  8328*    END-EXEC.
  8329*    MOVE '"&=!"#               V! " #00008318' TO DFHEIV0
  8330     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8331     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8332     MOVE X'2220233030303038333138' TO DFHEIV0(25:11)
  8333     CALL 'kxdfhei1' USING DFHEIV0
  8334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8335
  8336
  8337
  8338* EXEC CICS HANDLE CONDITION
  8339*        PGMIDERR (9700-PGMID-ERROR)
  8340*        ERROR    (9800-ABEND)
  8341*        MAPFAIL  (0325-MAPFAIL)
  8342*    END-EXEC.
  8343*    MOVE '"$L.?                 ! # #00008325' TO DFHEIV0
  8344     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8346     MOVE X'2320233030303038333235' TO DFHEIV0(25:11)
  8347     CALL 'kxdfhei1' USING DFHEIV0
  8348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8349
  8350
  8351
  8352* EXEC CICS SYNCPOINT
  8353*    END-EXEC.
  8354*    MOVE '6"                    !   #00008331' TO DFHEIV0
  8355     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8356     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8357     MOVE X'2020233030303038333331' TO DFHEIV0(25:11)
  8358     CALL 'kxdfhei1' USING DFHEIV0
  8359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8360
  8361
  8362     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 160
* EL689.cbl
  8363*    IF  W-LC-USE-BOTH-CASES
  8364
  8365* EXEC CICS RECEIVE
  8366*            MAP      (W-MAP)
  8367*            MAPSET   (W-MAPSET)
  8368*            INTO     (EL689AI)
  8369*            ASIS
  8370*        END-EXEC
  8371     MOVE LENGTH OF
  8372      EL689AI
  8373       TO DFHEIV11
  8374*    MOVE '8"TAI  L              ''   #00008336' TO DFHEIV0
  8375     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8376     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8377     MOVE X'2020233030303038333336' TO DFHEIV0(25:11)
  8378     CALL 'kxdfhei1' USING DFHEIV0,
  8379           W-MAP,
  8380           EL689AI,
  8381           DFHEIV11,
  8382           W-MAPSET,
  8383           DFHEIV99,
  8384           DFHEIV99
  8385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8386     ELSE
  8387
  8388* EXEC CICS RECEIVE
  8389*            MAP      (W-MAP)
  8390*            MAPSET   (W-MAPSET)
  8391*            INTO     (EL689AI)
  8392*        END-EXEC.
  8393     MOVE LENGTH OF
  8394      EL689AI
  8395       TO DFHEIV11
  8396*    MOVE '8"T I  L              ''   #00008343' TO DFHEIV0
  8397     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8398     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8399     MOVE X'2020233030303038333433' TO DFHEIV0(25:11)
  8400     CALL 'kxdfhei1' USING DFHEIV0,
  8401           W-MAP,
  8402           EL689AI,
  8403           DFHEIV11,
  8404           W-MAPSET,
  8405           DFHEIV99,
  8406           DFHEIV99
  8407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8408
  8409
  8410     IF  NOT DISPLAY-CAP
  8411         MOVE 'READ'             TO SM-READ
  8412         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8413         MOVE ER-9097            TO EMI-ERROR
  8414         MOVE -1                 TO MAINTL
  8415         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8416         GO TO 8100-SEND-INITIAL-MAP.
  8417
  8418     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8419
  8420     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 161
* EL689.cbl
  8421         GO TO 0300-CHECK-PFKEYS.
  8422
  8423     IF  EIBAID NOT EQUAL DFHENTER
  8424         MOVE ER-0004            TO EMI-ERROR
  8425         GO TO 0320-INPUT-ERROR.
  8426
  8427     IF  ENTERPFI NUMERIC
  8428             AND
  8429         ENTERPFI GREATER THAN 0
  8430             AND
  8431         ENTERPFI LESS THAN 25
  8432         MOVE PF-VALUES (ENTERPFI)
  8433                                 TO EIBAID
  8434     ELSE
  8435         MOVE ER-0029            TO EMI-ERROR
  8436         GO TO 0320-INPUT-ERROR.
  8437
  8438 0300-CHECK-PFKEYS.
  8439
  8440     IF  EIBAID EQUAL DFHPF23
  8441         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8442         MOVE ZEROS              TO PI-TOTAL-LINES
  8443                                    PI-CURRENT-LINE
  8444         MOVE EIBAID             TO PI-ENTRY-CD-1
  8445         MOVE W-XCTL-005         TO W-CALL-PGM
  8446         GO TO 9400-XCTL.
  8447
  8448     IF  EIBAID EQUAL DFHPF24
  8449         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8450         MOVE ZEROS              TO PI-TOTAL-LINES
  8451                                    PI-CURRENT-LINE
  8452         MOVE W-XCTL-626         TO W-CALL-PGM
  8453         GO TO 9400-XCTL.
  8454
  8455     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8456                                    W-FORM-CHANGED-IND.
  8457
  8458     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8459             OR
  8460         PI-SHOW-MODE
  8461         NEXT SENTENCE
  8462     ELSE
  8463         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8464                 AND
  8465             FORML NOT EQUAL ZEROS
  8466                 AND
  8467             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8468             MOVE FORMI          TO PI-689-FORM-NUMBER
  8469             MOVE LOW-VALUES     TO EL689AI
  8470                                    PI-1042-WA
  8471                                    PI-689-FOLLOW-UP-DATE
  8472                                    PI-689-PRINT-RESTRICTION
  8473                                    PI-689-RESEND-DATE-1
  8474                                    PI-689-RESEND1-EDIT
  8475                                    PI-689-FOLLOW-UP-DATE
  8476                                    PI-689-FOLLOW-UP-EDIT
  8477                                    PI-689-ERROR-IND
  8478             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 162
* EL689.cbl
  8479                                    PI-689-NUMBER-COPIES
  8480                                    PI-689-NUMBER-LABEL-LINES
  8481                                    PI-689-NUMBER-TEXT-RECORDS
  8482                                    PI-CURRENT-LINE
  8483                                    PI-TEMP-STOR-ITEMS
  8484                                    PI-TOTAL-LINES
  8485                                    PI-UPDATE-SW
  8486             MOVE SPACES         TO PI-689-PRINT-SW
  8487                                    PI-689-ALT-PRINTER-ID
  8488                                    PI-COMM-CONTROL
  8489                                    PI-689-TEMP-STOR-ID
  8490                                    PI-689-USE-SCREEN-IND
  8491                                    PI-689-RESEND-LETR-1
  8492                                    PI-CERT-FORM-ID
  8493                                    PI-CERT-REQ-IND
  8494                                    PI-REASON-REQ-IND
  8495             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8496             MOVE DFHENTER       TO EIBAID
  8497             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8498             GO TO 0330-FUNCTION-CHECK
  8499         ELSE
  8500             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8501                     OR
  8502                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8503                         AND
  8504                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8505                             OR
  8506                         ADDRSI NOT EQUAL LOW-VALUES))
  8507                     OR
  8508                 PI-689-CARRIER NOT EQUAL CARRIERI
  8509                     OR
  8510                 PI-689-GROUPING NOT EQUAL GROUPI
  8511                     OR
  8512                 PI-689-STATE NOT EQUAL STATEI
  8513                     OR
  8514                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8515                     OR
  8516                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8517                     OR
  8518                 PI-689-CERT-SFX NOT EQUAL SFXI
  8519                     OR
  8520                 PI-689-TYPE NOT EQUAL TYPEI
  8521                     OR
  8522                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8523                     OR
  8524                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8525                     OR
  8526                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8527                     OR
  8528                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8529                     OR
  8530                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8531                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8532                 MOVE DFHENTER   TO EIBAID
  8533                 GO TO 0330-FUNCTION-CHECK.
  8534
  8535*    IF  EIBAID EQUAL DFHPF1
  8536*        MOVE +7                 TO W-ROLL-COUNTER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 163
* EL689.cbl
  8537*        GO TO 4000-ROLL-PAGE.
  8538
  8539*    IF  EIBAID EQUAL DFHPF2
  8540*        MOVE -7                 TO W-ROLL-COUNTER
  8541*        GO TO 4000-ROLL-PAGE.
  8542
  8543*    IF  EIBAID EQUAL DFHPF3
  8544*        IF  W-HOLD-ON
  8545*            MOVE ER-7245        TO EMI-ERROR
  8546*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8547*            MOVE -1             TO MAINTL
  8548*            MOVE AL-UABON       TO MAINTA
  8549*            GO TO 8200-SEND-DATAONLY
  8550*        ELSE
  8551*            GO TO 0330-FUNCTION-CHECK.
  8552*    IF (EIBAID = DFHPF8)
  8553*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8554*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8555*       MOVE ER-0029             TO EMI-ERROR
  8556*       GO TO 0320-INPUT-ERROR
  8557*    END-IF
  8558*    IF EIBAID = DFHPF4 OR DFHPF8
  8559*        IF  W-HOLD-ON
  8560*            MOVE ER-7245        TO EMI-ERROR
  8561*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8562*            MOVE -1             TO MAINTL
  8563*            MOVE AL-UABON       TO MAINTA
  8564*            GO TO 8200-SEND-DATAONLY
  8565*        ELSE
  8566*            GO TO 0330-FUNCTION-CHECK.
  8567
  8568*    IF  EIBAID = DFHPF5
  8569*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8570*        GO TO 4000-ROLL-PAGE.
  8571
  8572*    IF  EIBAID = DFHPF6
  8573*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8574*        GO TO 4000-ROLL-PAGE.
  8575
  8576     IF  EIBAID EQUAL DFHPF7
  8577         IF PI-PROMPT-IND EQUAL 'Y'
  8578             MOVE ER-0894        TO EMI-ERROR
  8579             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8580             MOVE -1             TO MAINTL
  8581             MOVE AL-UABON       TO MAINTA
  8582             GO TO 8200-SEND-DATAONLY
  8583         END-IF
  8584     END-IF.
  8585
  8586     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8587         IF  W-HOLD-ON
  8588             MOVE ER-7245        TO EMI-ERROR
  8589             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8590             MOVE -1             TO MAINTL
  8591             MOVE AL-UABON       TO MAINTA
  8592             GO TO 8200-SEND-DATAONLY
  8593         ELSE
  8594             GO TO 0330-FUNCTION-CHECK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 164
* EL689.cbl
  8595
  8596     IF  EIBAID EQUAL DFHENTER
  8597         GO TO 0330-FUNCTION-CHECK.
  8598
  8599     MOVE ER-0029                TO EMI-ERROR.
  8600
  8601 0320-INPUT-ERROR.
  8602
  8603     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8604
  8605     IF  ENTERPFL EQUAL 0
  8606         MOVE -1                 TO MAINTL
  8607         MOVE AL-UABON           TO MAINTA
  8608     ELSE
  8609         MOVE AL-UNBON           TO ENTERPFA
  8610         MOVE -1                 TO ENTERPFL.
  8611
  8612     GO TO 8200-SEND-DATAONLY.
  8613
  8614 0325-MAPFAIL.
  8615***********************************************************
  8616*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  8617*      LETTERS ON A 3275 PRINTER.                         *
  8618***********************************************************
  8619
  8620     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8621
  8622     SET W-RG-NDX                TO PI-CURRENT-LINE.
  8623     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8624             VARYING
  8625         W-SC-NDX FROM 1 BY 1
  8626             UNTIL
  8627         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  8628
  8629     MOVE -1                     TO MAINTL.
  8630     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 165
* EL689.cbl
  8632 0330-FUNCTION-CHECK.
  8633
  8634     IF  MAINTI EQUAL 'S'
  8635*        IF EIBAID = DFHPF4 OR DFHPF8
  8636*            GO TO 7900-PRINT-LETTER-NOW
  8637*        ELSE
  8638             GO TO 1000-SHOW.
  8639
  8640     IF  NOT MODIFY-CAP
  8641         MOVE 'UPDATE'           TO SM-READ
  8642         PERFORM 9995-SECURITY-VIOLATION
  8643         MOVE ER-0070            TO EMI-ERROR
  8644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8645         MOVE -1                 TO MAINTL
  8646         GO TO 8100-SEND-INITIAL-MAP.
  8647
  8648     IF  W-FORM-CHANGED
  8649             OR
  8650         W-KEY-FIELDS-CHANGED
  8651         GO TO 0330-EDIT.
  8652
  8653     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8654
  8655
  8656*    IF  EIBAID EQUAL DFHPF3
  8657*        IF  PI-NO-CARRIER-SECURITY
  8658*                AND
  8659*            PI-NO-ACCOUNT-SECURITY
  8660*            GO TO 5000-EDIT-MODE.
  8661
  8662     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8663         IF  PI-NO-CARRIER-SECURITY
  8664                 AND
  8665             PI-NO-ACCOUNT-SECURITY
  8666             GO TO 5400-LETTER-RELEASE
  8667         ELSE
  8668             IF  PI-689-PRINT-PERFORMED
  8669                 GO TO 5400-LETTER-RELEASE
  8670             ELSE
  8671                 MOVE AL-UNBON TO ENTERPFA
  8672                 MOVE -1       TO ENTERPFL
  8673                 MOVE ER-2398  TO EMI-ERROR
  8674                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8675                 GO TO 8200-SEND-DATAONLY.
  8676
  8677*    IF  EIBAID = DFHPF4 OR DFHPF8
  8678*        GO TO 7900-PRINT-LETTER-NOW.
  8679
  8680 0330-EDIT.
  8681
  8682     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8683             OR
  8684         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8685             OR
  8686         W-SC-TEXTL (3) NOT EQUAL ZEROS
  8687             OR
  8688         W-SC-TEXTL (4) NOT EQUAL ZEROS
  8689             OR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 166
* EL689.cbl
  8690         W-SC-TEXTL (5) NOT EQUAL ZEROS
  8691             OR
  8692         W-SC-TEXTL (6) NOT EQUAL ZEROS
  8693             OR
  8694         W-SC-TEXTL (7) NOT EQUAL ZEROS
  8695             OR
  8696         W-SC-TEXTL (8) NOT EQUAL ZEROS
  8697             OR
  8698         W-SC-TEXTL (9) NOT EQUAL ZEROS
  8699             OR
  8700         W-SC-TEXTL (10) NOT EQUAL ZEROS
  8701             OR
  8702         W-SC-TEXTL (11) NOT EQUAL ZEROS
  8703         IF  W-KEY-FIELDS-CHANGED
  8704                 OR
  8705             W-FORM-CHANGED
  8706             MOVE ER-7250        TO EMI-ERROR
  8707             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8708             MOVE -1             TO MAINTL
  8709             MOVE AL-UABON       TO MAINTA
  8710         ELSE
  8711             PERFORM 4100-SET-NDX THRU 4100-EXIT
  8712             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  8713                     VARYING
  8714                 W-SC-NDX FROM 1 BY 1
  8715                     UNTIL
  8716                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  8717             MOVE ER-7398        TO EMI-ERROR
  8718             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8719             MOVE -1             TO MAINTL
  8720             MOVE AL-UABON       TO MAINTA
  8721             GO TO 8200-SEND-DATAONLY.
  8722
  8723     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8724
  8725     IF  W-KEY-FIELDS-CHANGED
  8726             OR
  8727         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8728         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8729         IF  MAINTI EQUAL 'C'
  8730             GO TO 2000-CREATE
  8731         ELSE
  8732             NEXT SENTENCE
  8733     ELSE
  8734         IF  W-FORM-CHANGED
  8735             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8736             IF  MAINTI EQUAL 'C'
  8737                 GO TO 2000-CREATE
  8738             ELSE
  8739                 NEXT SENTENCE
  8740         ELSE
  8741             MOVE -1             TO MAINTL
  8742             GO TO 8200-SEND-DATAONLY.
  8743
  8744     MOVE ER-0023                TO EMI-ERROR.
  8745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8746     MOVE -1                     TO MAINTL.
  8747     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 167
* EL689.cbl
  8748     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 168
* EL689.cbl
  8750 0350-EDIT-ROUTINE.
  8751
  8752     IF  MAINTI EQUAL 'C'
  8753             AND
  8754         FORML EQUAL ZEROS
  8755         MOVE -1                 TO FORML
  8756         MOVE ER-0177            TO EMI-ERROR
  8757         MOVE AL-UABON           TO FORMA
  8758         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8759
  8760     IF PRTNOWL > ZEROS
  8761        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  8762           MOVE PRTNOWI          TO PI-PRINT-NOW
  8763           MOVE AL-UANON         TO PRTNOWA
  8764        END-IF
  8765     END-IF
  8766     IF ENDARCHL > ZEROS
  8767        IF ENDARCHI NUMERIC
  8768            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  8769            MOVE AL-UNNON       TO ENDARCHA
  8770            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  8771            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  8772            MOVE 'N'            TO W-VALID-ENDT-SW
  8773            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  8774            IF NOT W-VALID-ENDT
  8775                MOVE -1         TO ENDARCHL
  8776                MOVE ER-1565    TO EMI-ERROR
  8777                MOVE AL-UNBON   TO ENDARCHA
  8778                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8779            END-IF
  8780        END-IF
  8781     ELSE
  8782        MOVE ZEROS              TO PI-ENDT-ARCH-NO
  8783     END-IF
  8784     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  8785*    IF  PRTRESTL NOT EQUAL ZEROS
  8786*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  8787
  8788     IF  FOLLOWL NOT EQUAL ZEROS
  8789         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  8790         PERFORM 8600-DEEDIT
  8791         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8792         MOVE '4'                TO DC-OPTION-CODE
  8793         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8794         IF  DATE-CONVERSION-ERROR
  8795             MOVE ER-0182        TO EMI-ERROR
  8796             MOVE -1             TO FOLLOWL
  8797             MOVE AL-UABON       TO FOLLOWA
  8798             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8799         ELSE
  8800             MOVE DC-GREG-DATE-1-EDIT
  8801                                 TO FOLLOWO
  8802                                    PI-689-FOLLOW-UP-EDIT
  8803             MOVE AL-UANON       TO FOLLOWA
  8804             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  8805     ELSE
  8806         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  8807
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 169
* EL689.cbl
  8808     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  8809         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  8810                 W-SAVE-BIN-DATE
  8811             MOVE ER-0533        TO EMI-ERROR
  8812             MOVE AL-UABON       TO FOLLOWA
  8813             MOVE -1             TO FOLLOWL
  8814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8815
  8816     IF  RESEND1L NOT EQUAL ZEROS
  8817         MOVE RESEND1I           TO W-DEEDIT-FIELD
  8818         PERFORM 8600-DEEDIT
  8819         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8820         MOVE '4'                TO DC-OPTION-CODE
  8821         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8822         IF  DATE-CONVERSION-ERROR
  8823             MOVE ER-0185        TO EMI-ERROR
  8824             MOVE -1             TO RESEND1L
  8825             MOVE AL-UABON       TO RESEND1A
  8826             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8827         ELSE
  8828             MOVE DC-GREG-DATE-1-EDIT
  8829                                 TO RESEND1O
  8830                                    PI-689-RESEND1-EDIT
  8831             MOVE AL-UANON       TO RESEND1A
  8832             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  8833     ELSE
  8834         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  8835
  8836     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  8837         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  8838                 W-SAVE-BIN-DATE
  8839             MOVE ER-0537        TO EMI-ERROR
  8840             MOVE AL-UABON       TO RESEND1A
  8841             MOVE -1             TO RESEND1L
  8842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8843
  8844     IF ENCL > ZEROS
  8845        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  8846                                          PI-ENCLOSURE-CD
  8847        IF ENCI  = 'A'   OR
  8848                   'C'   OR
  8849                   'CLM' OR
  8850                   'E'   OR
  8851                   'ENV' OR
  8852                   '0'
  8853              OR 'RE'
  8854              OR '1' OR '2' OR '3' OR 'B' OR 'D'
  8855           MOVE ENCI             TO PI-ENCLOSURE-CD
  8856                                    W-ENCLOSURE-CD
  8857           MOVE AL-UANON         TO ENCA
  8858        ELSE
  8859           MOVE ER-1560          TO EMI-ERROR
  8860           MOVE -1               TO ENCL
  8861           MOVE AL-UABON         TO ENCA
  8862           PERFORM 9900-ERROR-FORMAT
  8863                                 THRU 9900-EXIT
  8864        END-IF
  8865     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 170
* EL689.cbl
  8866
  8867
  8868     IF NOT PI-CREATE-LABELS
  8869         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  8870         MOVE AL-PANON           TO ADDRLBLA
  8871         GO TO 0350-BYPASS-OVERRIDE.
  8872
  8873     IF  ADDRLBLL GREATER THAN ZEROS
  8874          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8875          IF ADDRLBLI = 'N' OR 'Y'
  8876              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  8877              MOVE AL-UANON      TO ADDRLBLA
  8878          ELSE
  8879             MOVE ER-3783        TO EMI-ERROR
  8880             MOVE -1             TO ADDRLBLL
  8881             MOVE AL-UABON       TO ADDRLBLA
  8882             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8883
  8884 0350-BYPASS-OVERRIDE.
  8885
  8886     IF  PI-BYPASS-LABELS
  8887             OR
  8888         FORMI EQUAL '9999'
  8889             OR
  8890         PI-689-LABELS-OVERRIDEN
  8891         MOVE SPACES             TO PI-689-LABEL-SOURCE
  8892         MOVE LOW-VALUES         TO ADDRSI
  8893         MOVE AL-UANOF           TO ADDRSA
  8894         MOVE ZEROS              TO ADDRSL
  8895     ELSE
  8896         IF  ADDRSL GREATER THAN ZEROS
  8897             MOVE ADDRSI         TO W-LABEL-SOURCE
  8898             IF  W-LABEL-SOURCE-VALID
  8899                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  8900             ELSE
  8901                 MOVE -1         TO ADDRSL
  8902                 MOVE ER-0176    TO EMI-ERROR
  8903                 MOVE AL-UABON   TO ADDRSA
  8904                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8905         ELSE
  8906             IF  MAINTI EQUAL 'C'
  8907                 MOVE -1         TO ADDRSL
  8908                 MOVE ER-0176    TO EMI-ERROR
  8909                 MOVE AL-UABON   TO ADDRSA
  8910                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8911
  8912     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  8913     IF  PRINTERL GREATER ZERO
  8914         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8915         MOVE AL-UANON           TO PRINTERA
  8916         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  8917                                    PI-ALT-DMD-PRT-ID
  8918     ELSE
  8919         IF  PI-NO-CARRIER-SECURITY
  8920                 AND
  8921             PI-NO-ACCOUNT-SECURITY
  8922             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  8923                 MOVE PI-PROCESSOR-PRINTER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 171
* EL689.cbl
  8924                                 TO PI-689-ALT-PRINTER-ID
  8925                                    PRINTERI
  8926                 MOVE AL-UABON   TO PRINTERA
  8927             ELSE
  8928                 MOVE PI-COMPANY-ID
  8929                                 TO W-CNTL-COMPANY-ID
  8930                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  8931                 MOVE SPACES     TO W-CNTL-GENL
  8932                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  8933
  8934* EXEC CICS HANDLE CONDITION
  8935*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  8936*                     NOTFND     (7945-NOT-FOUND)
  8937*                END-EXEC
  8938*    MOVE '"$JI                  ! $ #00008872' TO DFHEIV0
  8939     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8941     MOVE X'2420233030303038383732' TO DFHEIV0(25:11)
  8942     CALL 'kxdfhei1' USING DFHEIV0
  8943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8944
  8945* EXEC CICS READ
  8946*                     DATASET    (W-CNTL-FILE-ID)
  8947*                     SET        (ADDRESS OF CONTROL-FILE)
  8948*                     RIDFLD     (W-CNTL-KEY)
  8949*                END-EXEC
  8950*    MOVE '&"S        E          (   #00008876' TO DFHEIV0
  8951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8953     MOVE X'2020233030303038383736' TO DFHEIV0(25:11)
  8954     CALL 'kxdfhei1' USING DFHEIV0,
  8955           W-CNTL-FILE-ID,
  8956           DFHEIV20,
  8957           DFHEIV99,
  8958           W-CNTL-KEY,
  8959           DFHEIV99,
  8960           DFHEIV99,
  8961           DFHEIV99
  8962     SET ADDRESS OF CONTROL-FILE TO
  8963         DFHEIV20
  8964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8965                 MOVE CF-FORMS-PRINTER-ID
  8966                                 TO PI-689-ALT-PRINTER-ID
  8967                                    PRINTERI
  8968                                    W-TS-TERM-TEXT
  8969                 MOVE AL-UABON   TO PRINTERA
  8970         ELSE
  8971             MOVE AL-UABON       TO PRINTERA
  8972             MOVE -1             TO PRINTERL
  8973             MOVE ER-9283        TO EMI-ERROR
  8974             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8975
  8976     IF  COPIESL NOT EQUAL ZEROS
  8977         IF  COPIESI NOT NUMERIC
  8978                 OR
  8979             COPIESI EQUAL '0'
  8980             MOVE ER-0184        TO EMI-ERROR
  8981             MOVE -1             TO COPIESL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 172
* EL689.cbl
  8982             MOVE AL-UABON       TO COPIESA
  8983             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8984         ELSE
  8985             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  8986             MOVE AL-UANON       TO COPIESA
  8987     ELSE
  8988         IF FORMI EQUAL '9999'
  8989             MOVE 1              TO PI-689-NUMBER-COPIES
  8990                                    COPIESL
  8991                                    COPIESO.
  8992
  8993     IF  FORML NOT EQUAL ZEROS
  8994         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8995         MOVE FORMI              TO PI-689-FORM-NUMBER.
  8996
  8997     MOVE SPACES                 TO W-HOLD-IND.
  8998
  8999     IF PI-CERT-REQ-IND = 'Y'
  9000       IF  CERTIDL NOT EQUAL ZEROS
  9001         IF CERTIDI NUMERIC
  9002             MOVE AL-UANON      TO CERTIDA
  9003             MOVE CERTIDI       TO PI-CERT-FORM-ID
  9004         ELSE
  9005             MOVE ER-1778       TO EMI-ERROR
  9006             MOVE -1            TO CERTIDL
  9007             MOVE AL-UABON      TO CERTIDA
  9008             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9009         END-IF
  9010       ELSE
  9011          MOVE ER-0715       TO EMI-ERROR
  9012          MOVE -1            TO CERTIDL
  9013          MOVE AL-UABON      TO CERTIDA
  9014          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9015       END-IF
  9016     END-IF.
  9017
  9018     IF PI-REASON-REQ-IND = 'Y'
  9019        IF PI-ENDT-ARCH-NO NOT > ZERO
  9020          MOVE ER-9840       TO EMI-ERROR
  9021          MOVE -1            TO FORML
  9022          MOVE AL-UABON      TO FORMA
  9023          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9024        END-IF
  9025     END-IF.
  9026
  9027     IF  NOT EMI-NO-ERRORS
  9028         IF  EMI-ERROR EQUAL ER-7250
  9029             GO TO 0350-EXIT
  9030         ELSE
  9031            MOVE -1             TO MAINTL
  9032            GO TO 8200-SEND-DATAONLY.
  9033
  9034 0350-EXIT.
  9035      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 173
* EL689.cbl
  9037 0355-CHECK-ERENDT.
  9038
  9039*     EXEC CICS GETMAIN
  9040*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  9041*          LENGTH   (W-ENDT-LENGTH)
  9042*     END-EXEC
  9043
  9044
  9045* EXEC CICS READ
  9046*         DATASET    ('ERENDT2')
  9047*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  9048*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  9049*         RESP       (W-RESPONSE)
  9050*    END-EXEC
  9051     MOVE 'ERENDT2' TO DFHEIV1
  9052*    MOVE '&"S        E          (  N#00008960' TO DFHEIV0
  9053     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9055     MOVE X'204E233030303038393630' TO DFHEIV0(25:11)
  9056     CALL 'kxdfhei1' USING DFHEIV0,
  9057           DFHEIV1,
  9058           DFHEIV20,
  9059           DFHEIV99,
  9060           W-ERENDT-KEY-BY-ARCH,
  9061           DFHEIV99,
  9062           DFHEIV99,
  9063           DFHEIV99
  9064     SET ADDRESS OF ENDORSEMENT-RECORD TO
  9065         DFHEIV20
  9066     MOVE EIBRESP  TO W-RESPONSE
  9067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9068
  9069     IF (RESP-NORMAL)
  9070         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  9071            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9072            EN-CARRIER     =  PI-689-CARRIER     AND
  9073            EN-GROUPING    =  PI-689-GROUPING    AND
  9074            EN-STATE       =  PI-689-STATE       AND
  9075            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  9076            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  9077            EN-CERT-NO     =  PI-689-CERT-NO
  9078               SET W-VALID-ENDT TO TRUE
  9079         END-IF
  9080         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  9081            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9082            EN-CARRIER     =  PI-CARRIER         AND
  9083            EN-GROUPING    =  PI-GROUPING        AND
  9084            EN-STATE       =  PI-STATE           AND
  9085            EN-ACCOUNT     =  PI-ACCOUNT         AND
  9086            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  9087            EN-CERT-NO     =  PI-CERT-NO
  9088               SET W-VALID-ENDT TO TRUE
  9089         END-IF
  9090     END-IF
  9091      .
  9092
  9093 0355-EXIT.
  9094      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 174
* EL689.cbl
  9096 0360-EDIT-PRINT-RESTRICTIONS.
  9097
  9098*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  9099*                                TO W-UPPER-CASE.
  9100*
  9101*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  9102*                                     OR 'P' OR LOW-VALUES)
  9103*            AND
  9104*        PRTRESTI EQUAL 'C'
  9105*            AND
  9106*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9107*        MOVE ER-7243            TO EMI-ERROR
  9108*        MOVE -1                 TO PRTRESTL
  9109*        MOVE AL-UABON           TO PRTRESTA
  9110*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111*        GO TO 0360-EXIT.
  9112*
  9113*    IF  PRTRESTL NOT EQUAL ZEROS
  9114*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  9115*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  9116*            MOVE AL-UANON       TO PRTRESTA
  9117*        ELSE
  9118*            IF  PRTRESTI EQUAL ' '
  9119*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  9120*                MOVE AL-UANON   TO PRTRESTA
  9121*            ELSE
  9122*                MOVE ER-7393    TO EMI-ERROR
  9123*                MOVE -1         TO PRTRESTL
  9124*                MOVE AL-UABON   TO PRTRESTA
  9125*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9126*
  9127*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  9128*            AND
  9129*        W-HOLD-ON
  9130*            AND
  9131*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9132*        MOVE ER-7243            TO EMI-ERROR
  9133*        MOVE -1                 TO PRTRESTL
  9134*        MOVE AL-UABON           TO PRTRESTA
  9135*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9136     .
  9137 0360-EXIT.
  9138      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 175
* EL689.cbl
  9140 0400-EL6311-INCOMING.
  9141
  9142     MOVE ZEROS                  TO PI-CURRENT-LINE
  9143                                    PI-TEMP-STOR-ITEMS
  9144                                    PI-TOTAL-LINES
  9145                                    PI-UPDATE-SW
  9146                                    PI-689-NUMBER-LABEL-LINES
  9147                                    PI-689-ERROR
  9148                                    PI-689-NUMBER-TEXT-RECORDS.
  9149     MOVE SPACES                 TO PI-689-PRINT-SW
  9150                                    PI-689-ALT-PRINTER-ID
  9151                                    PI-COMM-CONTROL
  9152                                    PI-689-FORM-NUMBER
  9153                                    PI-689-TEMP-STOR-ID
  9154                                    PI-689-LABEL-SOURCE
  9155                                    PI-689-USE-SCREEN-IND.
  9156
  9157     IF PI-CREATE-LABELS
  9158         MOVE  AL-UANON          TO ADDRLBLA
  9159         MOVE  +1                TO ADDRLBLL.
  9160
  9161     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9162                                    PI-689-LBL-OVERRIDE.
  9163
  9164     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9165     MOVE '2'                    TO PI-ACTION.
  9166     MOVE -1                     TO MAINTL.
  9167
  9168     MOVE AL-UANON               TO PRTNOWA.
  9169     MOVE +1                     TO PRTNOWL.
  9170     MOVE 'N'                    TO PRTNOWI
  9171                                    PI-PRINT-NOW.
  9172
  9173     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  9174         MOVE AL-UANON           TO CARRIERA
  9175         MOVE +1                 TO CARRIERL
  9176         MOVE PI-689-CARRIER     TO CARRIERI.
  9177
  9178     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  9179         MOVE +6                 TO GROUPL
  9180         MOVE AL-UANON           TO GROUPA
  9181         MOVE PI-689-GROUPING    TO GROUPI.
  9182
  9183     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9184         MOVE +2                 TO STATEL
  9185         MOVE AL-UANON           TO STATEA
  9186         MOVE PI-689-STATE       TO STATEI.
  9187
  9188     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9189         MOVE +10                TO ACCTL
  9190         MOVE AL-UANON           TO ACCTA
  9191         MOVE PI-689-ACCOUNT     TO ACCTI.
  9192
  9193     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9194         MOVE +10                TO CERTL
  9195         MOVE AL-UANON           TO CERTA
  9196         MOVE PI-689-CERT-PRIME  TO CERTI.
  9197
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 176
* EL689.cbl
  9198     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9199         MOVE +1                 TO SFXL
  9200         MOVE AL-UANON           TO SFXA
  9201         MOVE PI-689-CERT-SFX    TO SFXI.
  9202
  9203     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9204         MOVE +6                 TO BENTRYL
  9205         MOVE AL-UANON           TO BENTRYA
  9206         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9207
  9208     MOVE +4                     TO BCSEQL.
  9209     MOVE AL-UANON               TO BCSEQA.
  9210     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9211
  9212     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9213         MOVE +8                 TO SEQL
  9214         MOVE AL-UANON           TO SEQA
  9215         MOVE PI-689-SEQ-NO      TO SEQI.
  9216
  9217     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9218         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9219         MOVE ' '                TO DC-OPTION-CODE
  9220         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9221         MOVE +8                 TO DATEL
  9222         MOVE DC-GREG-DATE-1-EDIT
  9223                                 TO DATEI
  9224         MOVE AL-UANON           TO DATEA.
  9225
  9226     MOVE -1                     TO MAINTL.
  9227     MOVE '4'                    TO DATASORI
  9228                                    PI-689-DATA-SOURCE.
  9229     MOVE +1                     TO DATASORL.
  9230     MOVE AL-UANON               TO DATASORA.
  9231
  9232     GO TO 8100-SEND-INITIAL-MAP.
  9233
  9234 0400-EXIT.
  9235      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 177
* EL689.cbl
  9237 0450-SPECIAL-INPUT-PROCESS.
  9238
  9239     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9240             AND
  9241         PI-CARRIER GREATER THAN LOW-VALUES
  9242         MOVE '1'                TO DATASORI
  9243                                    PI-689-DATA-SOURCE
  9244         MOVE PI-CARRIER         TO CARRIERI
  9245         MOVE PI-GROUPING        TO GROUPI
  9246         MOVE PI-STATE           TO STATEI
  9247         MOVE PI-ACCOUNT         TO ACCTI
  9248         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9249         MOVE ' '                TO DC-OPTION-CODE
  9250         PERFORM 9500-LINK-DATE-CONVERT
  9251             THRU 9500-EXIT
  9252         MOVE DC-GREG-DATE-1-EDIT
  9253                                 TO DATEI
  9254         MOVE 'N'                TO PRTNOWI
  9255                                    PI-PRINT-NOW
  9256         MOVE AL-UANON           TO ACCTA
  9257                                    CARRIERA
  9258                                    DATEA
  9259                                    DATASORA
  9260                                    GROUPA
  9261                                    STATEA
  9262                                    PRTNOWA
  9263         MOVE +1                 TO CARRIERL
  9264                                    DATASORL
  9265                                    PRTNOWL
  9266         MOVE -1                 TO MAINTL
  9267         MOVE +6                 TO GROUPL
  9268         MOVE +2                 TO STATEL
  9269         MOVE +8                 TO DATEL
  9270         MOVE +10                TO ACCTL
  9271     ELSE
  9272         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9273                 AND
  9274             PI-CARRIER GREATER THAN LOW-VALUES
  9275             MOVE '3'            TO DATASORI
  9276                                    PI-689-DATA-SOURCE
  9277             MOVE PI-CR-CARRIER  TO CARRIERI
  9278             MOVE PI-CR-GROUPING TO GROUPI
  9279             MOVE PI-CR-ACCOUNT  TO ACCTI
  9280             MOVE PI-CR-FIN-RESP TO RPERSONI
  9281             MOVE PI-CR-TYPE     TO TYPEI
  9282             MOVE 'N'            TO PRTNOWI
  9283                                    PI-PRINT-NOW
  9284             MOVE AL-UANON       TO CARRIERA
  9285                                    GROUPA
  9286                                    ACCTA
  9287                                    DATASORA
  9288                                    RPERSONA
  9289                                    TYPEA
  9290                                    PRTNOWA
  9291             MOVE +1             TO CARRIERL
  9292                                    DATASORL
  9293                                    TYPEL
  9294                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 178
* EL689.cbl
  9295             MOVE -1             TO MAINTL
  9296             MOVE +6             TO GROUPL
  9297             MOVE +10            TO ACCTL
  9298                                    RPERSONL
  9299         ELSE
  9300             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9301                     AND
  9302                 PI-CARRIER GREATER THAN LOW-VALUES
  9303                 MOVE '2'        TO DATASORI
  9304                                    PI-689-DATA-SOURCE
  9305                 MOVE PI-CARRIER TO CARRIERI
  9306                 MOVE PI-GROUPING
  9307                                 TO GROUPI
  9308                 MOVE PI-STATE   TO STATEI
  9309                 MOVE PI-ACCOUNT TO ACCTI
  9310                 MOVE PI-CERT-PRIME
  9311                                 TO CERTI
  9312                 MOVE PI-CERT-SFX
  9313                                 TO SFXI
  9314                 MOVE PI-CERT-EFF-DT
  9315                                 TO DC-BIN-DATE-1
  9316                 MOVE ' '        TO DC-OPTION-CODE
  9317                 PERFORM 9500-LINK-DATE-CONVERT
  9318                     THRU 9500-EXIT
  9319                 MOVE DC-GREG-DATE-1-EDIT
  9320                                 TO DATEI
  9321                 MOVE 'N'        TO PRTNOWI
  9322                                    PI-PRINT-NOW
  9323                 MOVE AL-UANON   TO CARRIERA
  9324                                    GROUPA
  9325                                    STATEA
  9326                                    ACCTA
  9327                                    CERTA
  9328                                    SFXA
  9329                                    DATEA
  9330                                    ADDRSA
  9331                                    DATASORA
  9332                                    PRTNOWA
  9333                 MOVE +1         TO CARRIERL
  9334                                    SFXL
  9335                                    DATASORL
  9336                                    ADDRSL
  9337                                    PRTNOWL
  9338                 MOVE -1         TO MAINTL
  9339                 MOVE +6         TO GROUPL
  9340                 MOVE +2         TO STATEL
  9341                 MOVE +8         TO DATEL
  9342                 MOVE +10        TO ACCTL
  9343                                    CERTL.
  9344
  9345     IF PI-CREATE-LABELS
  9346         MOVE  AL-UANON          TO ADDRLBLA
  9347         MOVE  +1                TO ADDRLBLL.
  9348
  9349     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9350                                    PI-689-LBL-OVERRIDE.
  9351
  9352     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 179
* EL689.cbl
  9353     GO TO 8100-SEND-INITIAL-MAP.
  9354
  9355 0450-EXIT.
  9356      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 180
* EL689.cbl
  9358 0600-BYPASS-SCREEN-CNTL.
  9359***************************************************************
  9360*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9361*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9362*     PERFORMING ANY SCREEN IO.                               *
  9363***************************************************************
  9364
  9365
  9366* EXEC CICS HANDLE CONDITION
  9367*        PGMIDERR (9700-PGMID-ERROR)
  9368*        MAPFAIL  (0325-MAPFAIL)
  9369*        ERROR    (9800-ABEND)
  9370*    END-EXEC.
  9371*    MOVE '"$L?.                 ! % #00009263' TO DFHEIV0
  9372     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9373     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9374     MOVE X'2520233030303039323633' TO DFHEIV0(25:11)
  9375     CALL 'kxdfhei1' USING DFHEIV0
  9376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9377
  9378
  9379     MOVE LOW-VALUES             TO EL689AI.
  9380
  9381     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9382
  9383     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9384     MOVE +4                     TO FORML.
  9385
  9386     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9387         MOVE PI-689-NUMBER-COPIES
  9388                                 TO COPIESI
  9389         MOVE +1                 TO COPIESL.
  9390
  9391     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9392     MOVE +1                     TO ADDRSL.
  9393     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9394     MOVE +1                     TO DATASORL.
  9395
  9396*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9397*        MOVE PI-689-PRINT-RESTRICTION
  9398*                                TO PRTRESTI
  9399*        MOVE +1                 TO PRTRESTL.
  9400
  9401     MOVE SPACES                 TO PI-689-PRINT-SW
  9402                                    PI-689-LBL-OVERRIDE.
  9403     MOVE ZEROS                  TO PI-TOTAL-LINES
  9404                                    PI-CURRENT-LINE
  9405                                    PI-TEMP-STOR-ITEMS
  9406                                    PI-UPDATE-SW
  9407                                    PI-689-ERROR
  9408                                    PI-689-NUMBER-LABEL-LINES
  9409                                    PI-689-NUMBER-TEXT-RECORDS.
  9410
  9411     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9412         MOVE +4                 TO PRINTERL
  9413         MOVE PI-689-ALT-PRINTER-ID
  9414                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9415
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 181
* EL689.cbl
  9416     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9417
  9418     IF  PI-689-SOURCE-VARIABLE
  9419         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9420
  9421     MOVE SPACES                 TO W-CNTL-KEY
  9422     MOVE LOW-VALUES             TO W-ACCT-KEY
  9423                                    W-CERT-KEY
  9424                                    W-CHEK-KEY
  9425                                    W-COMP-KEY
  9426                                    W-MAIL-KEY
  9427                                    W-PNDB-KEY
  9428                                    W-PNDB2-KEY
  9429                                    W-PYAJ-KEY.
  9430
  9431     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9432     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9433                                    W-CERT-COMPANY-CD
  9434                                    W-CHEK-COMPANY-CD
  9435                                    W-COMP-COMPANY-CD
  9436                                    W-MAIL-COMPANY-CD
  9437                                    W-PNDB-COMPANY-CD
  9438                                    W-PNDB2-COMPANY-CD
  9439                                    W-PYAJ-COMPANY-CD.
  9440
  9441     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9442         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9443                                    W-CERT-CARRIER
  9444                                    W-MAIL-CARRIER
  9445                                    W-CERT-CARRIER
  9446                                    W-COMP-CARRIER
  9447                                    W-CHEK-CARRIER
  9448                                    W-PNDB2-CARRIER
  9449                                    W-PYAJ-CARRIER.
  9450
  9451     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9452         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9453                                    W-CERT-GROUPING
  9454                                    W-CHEK-GROUPING
  9455                                    W-COMP-GROUPING
  9456                                    W-MAIL-GROUPING
  9457                                    W-PNDB2-GROUPING
  9458                                    W-PYAJ-GROUPING.
  9459
  9460     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9461         MOVE PI-689-STATE       TO W-ACCT-STATE
  9462                                    W-CERT-STATE
  9463                                    W-CHEK-STATE
  9464                                    W-MAIL-STATE
  9465                                    W-PNDB2-STATE.
  9466
  9467     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9468         IF PI-689-DATA-SOURCE = '3' OR '6'
  9469             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9470                                    W-PYAJ-ACCOUNT
  9471         ELSE
  9472             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9473                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 182
* EL689.cbl
  9474                                    W-CHEK-ACCOUNT
  9475                                    W-MAIL-ACCOUNT
  9476                                    W-PNDB2-ACCOUNT.
  9477
  9478     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9479         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9480                                    W-CHEK-EFF-DT
  9481                                    W-MAIL-EFF-DT
  9482                                    W-PNDB2-EFF-DT.
  9483
  9484     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9485         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9486                                    W-CHEK-CERT-PRIME
  9487                                    W-MAIL-CERT-PRIME
  9488                                    W-PNDB2-CERT-PRIME
  9489
  9490         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9491             MOVE PI-689-CERT-SFX
  9492                                 TO W-CERT-CERT-SFX
  9493                                    W-CHEK-CERT-SFX
  9494                                    W-MAIL-CERT-SFX
  9495                                    W-PNDB2-CERT-SFX
  9496         ELSE
  9497             MOVE SPACES         TO W-CERT-CERT-SFX
  9498                                    W-CHEK-CERT-SFX
  9499                                    W-MAIL-CERT-SFX
  9500                                    W-PNDB2-CERT-SFX.
  9501
  9502     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9503         IF PI-689-DATA-SOURCE = '3' OR '6'
  9504             MOVE PI-689-RESP-PERSON
  9505                                 TO W-COMP-RESP-PERSON
  9506                                    W-PYAJ-FIN-RESP.
  9507
  9508     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9509         IF PI-689-DATA-SOURCE = '3' OR '6'
  9510             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9511                                    W-PYAJ-RECORD-TYPE
  9512         ELSE
  9513             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9514
  9515     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9516         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9517                                    W-PYAJ-FILE-SEQ-NO
  9518                                    W-CHEK-SEQ-NO.
  9519
  9520     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9521         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9522                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9523
  9524     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9525         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9526
  9527     IF  PI-689-NO-ERRORS-DETECTED
  9528         PERFORM 2000-CREATE THRU 2000-EXIT
  9529         IF  NOT PI-689-FATAL-ERROR
  9530                 AND
  9531             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 183
* EL689.cbl
  9532             IF  PI-689-PRINT-ONLY
  9533                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9534             ELSE
  9535                 IF  PI-689-PRINT-FIRST
  9536                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9537                     IF  NOT PI-689-FATAL-ERROR
  9538                         IF  PI-689-ARCHIVE-LETTER
  9539                             PERFORM 5400-LETTER-RELEASE
  9540                                 THRU 5400-EXIT
  9541                         ELSE
  9542                             MOVE ER-7390
  9543                                 TO PI-689-ERROR
  9544                     ELSE
  9545                         NEXT SENTENCE
  9546                 ELSE
  9547                     IF  NOT PI-689-ARCHIVE-LETTER
  9548                         MOVE ER-7390
  9549                                 TO PI-689-ERROR
  9550                     ELSE
  9551                         PERFORM 5400-LETTER-RELEASE
  9552                             THRU 5400-EXIT
  9553                         IF  NOT PI-689-FATAL-ERROR
  9554                             IF  PI-689-PRINT-SECOND
  9555                                 PERFORM 7900-PRINT-LETTER-NOW
  9556                                     THRU 7900-EXIT.
  9557
  9558 0600-EXIT.
  9559     EXIT.
  9560
  9561 0620-RETURN-TO-CALLER.
  9562
  9563     MOVE PROGRAM-INTERFACE-BLOCK
  9564                                 TO DFHCOMMAREA.
  9565
  9566* EXEC CICS RETURN
  9567*    END-EXEC.
  9568*    MOVE '.(                    ''   #00009455' TO DFHEIV0
  9569     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9570     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9571     MOVE X'2020233030303039343535' TO DFHEIV0(25:11)
  9572     CALL 'kxdfhei1' USING DFHEIV0,
  9573           DFHEIV99,
  9574           DFHEIV99,
  9575           DFHEIV99,
  9576           DFHEIV99,
  9577           DFHEIV99,
  9578           DFHEIV99
  9579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9580
  9581
  9582 0700-GET-VARIABLE-LABEL.
  9583
  9584     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  9585         MOVE '(VARIABLE NOT PROVIDED)'
  9586                                 TO W-RC-TEXT (1)
  9587                                    W-VG-TEXT (48)
  9588         GO TO 0700-EXIT.
  9589
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 184
* EL689.cbl
  9590     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
  9591                                    W-VG-TEXT (48).
  9592     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  9593                                    W-VG-TEXT (49).
  9594     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  9595                                    W-VG-TEXT (50).
  9596     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  9597                                    W-VG-TEXT (51).
  9598     SET W-RG-NDX                TO +5.
  9599
  9600 0700-EXIT.
  9601     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 185
* EL689.cbl
  9603 0800-EDIT-KEY-FIELDS.
  9604***************************************************************
  9605*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  9606*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  9607*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  9608*     PROCESSING.                                             *
  9609***************************************************************
  9610     MOVE SPACES                 TO W-CNTL-KEY
  9611     MOVE LOW-VALUES             TO W-ACCT-KEY
  9612                                    W-CERT-KEY
  9613                                    W-CHEK-KEY
  9614                                    W-COMP-KEY
  9615                                    W-MAIL-KEY
  9616                                    W-PNDB-KEY
  9617                                    W-PNDB2-KEY
  9618                                    W-PYAJ-KEY.
  9619
  9620     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9621     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9622                                    W-CERT-COMPANY-CD
  9623                                    W-CHEK-COMPANY-CD
  9624                                    W-COMP-COMPANY-CD
  9625                                    W-MAIL-COMPANY-CD
  9626                                    W-PNDB-COMPANY-CD
  9627                                    W-PNDB2-COMPANY-CD
  9628                                    W-PYAJ-COMPANY-CD.
  9629
  9630     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  9631     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  9632     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  9633     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  9634     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  9635     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  9636     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  9637     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  9638     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  9639     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  9640     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  9641     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  9642     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  9643     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  9644     PERFORM 0970-EDIT-CSO THRU 0970-EXIT.
  9645
  9646     IF  DATASORI NUMERIC
  9647         MOVE DATASORI           TO W-DATA-SOURCE
  9648                                    PI-689-DATA-SOURCE
  9649         GO TO 0800-SOURCE-ACCOUNT
  9650               0800-SOURCE-CERTIFICATE
  9651               0800-SOURCE-COMPENSATION
  9652               0800-SOURCE-PENDING
  9653               0800-SOURCE-CHEK
  9654               0800-SOURCE-PAYMENTS-ADJS
  9655                                 DEPENDING ON W-DATA-SOURCE.
  9656
  9657     IF  FORMI NOT EQUAL '9999'
  9658         MOVE ER-7365            TO EMI-ERROR
  9659         MOVE -1                 TO MAINTL
  9660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 186
* EL689.cbl
  9661         GO TO 8200-SEND-DATAONLY
  9662
  9663     ELSE
  9664         GO TO 0800-EXIT.
  9665
  9666 0800-SOURCE-ACCOUNT.
  9667
  9668     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
  9669             OR
  9670         W-ACCT-CARRIER EQUAL LOW-VALUES
  9671             OR
  9672         W-ACCT-GROUPING EQUAL LOW-VALUES
  9673             OR
  9674         W-ACCT-STATE EQUAL LOW-VALUES
  9675             OR
  9676         W-ACCT-ACCOUNT EQUAL LOW-VALUES
  9677             OR
  9678         W-ACCT-EXP-DT EQUAL LOW-VALUES
  9679         MOVE ER-7376            TO EMI-ERROR
  9680         MOVE -1                 TO MAINTL
  9681         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9682
  9683     GO TO 0800-ERROR-TEST.
  9684
  9685 0800-SOURCE-CERTIFICATE.
  9686
  9687     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
  9688             OR
  9689         W-CERT-CARRIER EQUAL LOW-VALUES
  9690             OR
  9691         W-CERT-GROUPING EQUAL LOW-VALUES
  9692             OR
  9693         W-CERT-STATE EQUAL LOW-VALUES
  9694             OR
  9695         W-CERT-ACCOUNT EQUAL LOW-VALUES
  9696             OR
  9697         W-CERT-EFF-DT EQUAL LOW-VALUES
  9698             OR
  9699         W-CERT-CERT-NO EQUAL LOW-VALUES
  9700         MOVE ER-7377            TO EMI-ERROR
  9701         MOVE -1                 TO MAINTL
  9702         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9703
  9704     GO TO 0800-ERROR-TEST.
  9705
  9706 0800-SOURCE-COMPENSATION.
  9707
  9708     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
  9709             OR
  9710         W-COMP-CARRIER EQUAL LOW-VALUES
  9711             OR
  9712         W-COMP-GROUPING EQUAL LOW-VALUES
  9713             OR
  9714         W-COMP-RESP-PERSON EQUAL LOW-VALUES
  9715             OR
  9716         W-COMP-TYPE EQUAL LOW-VALUES
  9717             OR
  9718         (W-COMP-TYPE EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 187
* EL689.cbl
  9719                 AND
  9720             W-COMP-ACCOUNT EQUAL LOW-VALUES)
  9721         MOVE ER-7378            TO EMI-ERROR
  9722         MOVE -1                 TO MAINTL
  9723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9724
  9725     GO TO 0800-ERROR-TEST.
  9726
  9727 0800-SOURCE-PENDING.
  9728
  9729     IF  BENTRYL EQUAL ZEROS
  9730         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
  9731                 OR
  9732             W-PNDB2-CARRIER EQUAL LOW-VALUES
  9733                 OR
  9734             W-PNDB2-GROUPING EQUAL LOW-VALUES
  9735                 OR
  9736             W-PNDB2-STATE EQUAL LOW-VALUES
  9737                 OR
  9738             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
  9739                 OR
  9740             W-PNDB2-EFF-DT EQUAL LOW-VALUES
  9741                 OR
  9742             W-PNDB2-CERT-NO EQUAL LOW-VALUES
  9743                 OR
  9744             W-PNDB2-TYPE EQUAL LOW-VALUES
  9745                 OR
  9746             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
  9747             MOVE ER-7379        TO EMI-ERROR
  9748             MOVE -1             TO MAINTL
  9749             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9750         ELSE
  9751             NEXT SENTENCE
  9752     ELSE
  9753         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
  9754                 OR
  9755             W-PNDB-ENTRY EQUAL LOW-VALUES
  9756                 OR
  9757             W-PNDB-SEQ-NO EQUAL ZEROS
  9758             MOVE ER-7379        TO EMI-ERROR
  9759             MOVE -1             TO MAINTL
  9760             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9761
  9762     GO TO 0800-ERROR-TEST.
  9763
  9764 0800-SOURCE-CHEK.
  9765
  9766     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
  9767             OR
  9768         W-CHEK-CARRIER EQUAL LOW-VALUES
  9769             OR
  9770         W-CHEK-GROUPING EQUAL LOW-VALUES
  9771             OR
  9772         W-CHEK-STATE EQUAL LOW-VALUES
  9773             OR
  9774         W-CHEK-ACCOUNT EQUAL LOW-VALUES
  9775             OR
  9776         W-CHEK-EFF-DT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 188
* EL689.cbl
  9777             OR
  9778         W-CHEK-CERT-NO EQUAL LOW-VALUES
  9779         MOVE ER-7381            TO EMI-ERROR
  9780         MOVE -1                 TO MAINTL
  9781         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9782
  9783     GO TO 0800-ERROR-TEST.
  9784
  9785 0800-SOURCE-PAYMENTS-ADJS.
  9786
  9787     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
  9788             OR
  9789         W-PYAJ-CARRIER EQUAL LOW-VALUES
  9790             OR
  9791         W-PYAJ-GROUPING EQUAL LOW-VALUES
  9792             OR
  9793         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
  9794             OR
  9795         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
  9796             OR
  9797         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
  9798         MOVE ER-7396            TO EMI-ERROR
  9799         MOVE -1                 TO MAINTL
  9800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9801
  9802     GO TO 0800-ERROR-TEST.
  9803
  9804 0800-ERROR-TEST.
  9805
  9806     IF  NOT EMI-NO-ERRORS
  9807         IF  EMI-ERROR EQUAL ER-7250
  9808             GO TO 0800-EXIT
  9809         ELSE
  9810             GO TO 8200-SEND-DATAONLY.
  9811
  9812 0800-EXIT.
  9813     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 189
* EL689.cbl
  9815 0900-EDIT-CARRIER.
  9816
  9817     IF  CARRIERL EQUAL ZEROES
  9818         MOVE LOW-VALUES         TO PI-689-CARRIER
  9819                                    W-ACCT-CARRIER
  9820                                    W-CERT-CARRIER
  9821                                    W-COMP-CARRIER
  9822                                    W-CHEK-CARRIER
  9823                                    W-MAIL-CARRIER
  9824                                    W-PNDB2-CARRIER
  9825                                    W-PYAJ-CARRIER
  9826     ELSE
  9827         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
  9828
  9829 0900-EXIT.
  9830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 190
* EL689.cbl
  9832 0905-EDIT-GROUPING.
  9833
  9834     IF  GROUPL EQUAL ZEROES
  9835         MOVE LOW-VALUES         TO PI-689-GROUPING
  9836                                    W-ACCT-GROUPING
  9837                                    W-CERT-GROUPING
  9838                                    W-CHEK-GROUPING
  9839                                    W-COMP-GROUPING
  9840                                    W-MAIL-GROUPING
  9841                                    W-PNDB2-GROUPING
  9842                                    W-PYAJ-GROUPING
  9843     ELSE
  9844         MOVE AL-UANON           TO GROUPA
  9845         MOVE GROUPI             TO PI-689-GROUPING
  9846                                    W-ACCT-GROUPING
  9847                                    W-CERT-GROUPING
  9848                                    W-CHEK-GROUPING
  9849                                    W-COMP-GROUPING
  9850                                    W-MAIL-GROUPING
  9851                                    W-PNDB2-GROUPING
  9852                                    W-PYAJ-GROUPING.
  9853
  9854 0905-EXIT.
  9855     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 191
* EL689.cbl
  9857 0910-EDIT-STATE.
  9858
  9859     IF  STATEL EQUAL ZEROES
  9860         MOVE LOW-VALUES         TO PI-689-STATE
  9861                                    W-ACCT-STATE
  9862                                    W-CERT-STATE
  9863                                    W-CHEK-STATE
  9864                                    W-MAIL-STATE
  9865                                    W-PNDB2-STATE
  9866     ELSE
  9867         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
  9868
  9869 0910-EXIT.
  9870     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 192
* EL689.cbl
  9872 0915-EDIT-ACCOUNT.
  9873
  9874     IF  ACCTL EQUAL ZEROES
  9875         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9876                                    W-ACCT-ACCOUNT
  9877                                    W-CERT-ACCOUNT
  9878                                    W-CHEK-ACCOUNT
  9879                                    W-COMP-ACCOUNT
  9880                                    W-MAIL-ACCOUNT
  9881                                    W-PNDB2-ACCOUNT
  9882                                    W-PYAJ-ACCOUNT
  9883     ELSE
  9884         MOVE AL-UANON           TO ACCTA
  9885         MOVE ACCTI              TO PI-689-ACCOUNT
  9886                                    W-ACCT-ACCOUNT
  9887                                    W-CERT-ACCOUNT
  9888                                    W-CHEK-ACCOUNT
  9889                                    W-COMP-ACCOUNT
  9890                                    W-MAIL-ACCOUNT
  9891                                    W-PYAJ-ACCOUNT
  9892                                    W-PNDB2-ACCOUNT.
  9893
  9894 0915-EXIT.
  9895     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 193
* EL689.cbl
  9897 0920-EDIT-EXP-DATE.
  9898
  9899     IF  DATEL NOT EQUAL ZEROS
  9900         IF  DATEI EQUAL '99/99/99' OR '999999'
  9901             MOVE '99/99/99'     TO DATEO
  9902                                    PI-689-DATE-EDIT
  9903             MOVE AL-UANON       TO DATEA
  9904             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
  9905                                    W-ACCT-EXP-DT
  9906         ELSE
  9907             MOVE DATEI          TO W-DEEDIT-FIELD
  9908             PERFORM 8600-DEEDIT
  9909             MOVE W-DEEDIT-FIELD-V0
  9910                                 TO DC-GREG-DATE-1-MDY
  9911             MOVE '4'            TO DC-OPTION-CODE
  9912             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9913             IF  DATE-CONVERSION-ERROR
  9914                 MOVE ER-0454    TO EMI-ERROR
  9915                 MOVE -1         TO DATEL
  9916                 MOVE AL-UABON   TO DATEA
  9917                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9918             ELSE
  9919                 MOVE DC-GREG-DATE-1-EDIT
  9920                                 TO DATEO
  9921                                    PI-689-DATE-EDIT
  9922                 MOVE AL-UANON   TO DATEA
  9923                 MOVE DC-BIN-DATE-1
  9924                                 TO PI-689-EXP-DATE
  9925                                    W-ACCT-EXP-DT
  9926     ELSE
  9927         MOVE LOW-VALUES         TO PI-689-EXP-DATE
  9928                                    W-ACCT-EXP-DT
  9929                                    PI-689-DATE-EDIT.
  9930
  9931 0920-EXIT.
  9932     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 194
* EL689.cbl
  9934 0925-EDIT-EFF-DATE.
  9935
  9936     IF  CERTL EQUAL ZERO
  9937             AND
  9938         DATASORI NOT EQUAL '2'
  9939         GO TO 0925-EXIT.
  9940
  9941     IF  DATEL NOT EQUAL ZEROS
  9942         MOVE DATEI              TO W-DEEDIT-FIELD
  9943         PERFORM 8600-DEEDIT
  9944         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9945         MOVE '4'                TO DC-OPTION-CODE
  9946         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9947
  9948         IF  DATE-CONVERSION-ERROR
  9949             MOVE ER-0215        TO EMI-ERROR
  9950             MOVE -1             TO DATEL
  9951             MOVE AL-UABON       TO DATEA
  9952             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9953         ELSE
  9954             MOVE DC-GREG-DATE-1-EDIT
  9955                                 TO DATEO
  9956                                    PI-689-DATE-EDIT
  9957             MOVE AL-UANON       TO DATEA
  9958             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
  9959                                    W-CERT-EFF-DT
  9960                                    W-CHEK-EFF-DT
  9961                                    W-MAIL-EFF-DT
  9962                                    W-PNDB2-EFF-DT
  9963     ELSE
  9964         MOVE LOW-VALUES         TO PI-689-EFF-DATE
  9965                                    W-PNDB2-EFF-DT
  9966                                    W-CHEK-EFF-DT
  9967                                    W-MAIL-EFF-DT
  9968                                    W-CERT-EFF-DT
  9969                                    PI-689-DATE-EDIT.
  9970
  9971 0925-EXIT.
  9972     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 195
* EL689.cbl
  9974 0930-EDIT-CERTIFICATE.
  9975
  9976     IF  CERTL EQUAL ZEROES
  9977         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
  9978                                    W-CERT-CERT-PRIME
  9979                                    W-CHEK-CERT-PRIME
  9980                                    W-MAIL-CERT-PRIME
  9981                                    W-PNDB2-CERT-PRIME
  9982                                    PI-689-CERT-SFX
  9983                                    W-CERT-CERT-SFX
  9984                                    W-CHEK-CERT-SFX
  9985                                    W-MAIL-CERT-SFX
  9986                                    W-PNDB2-CERT-SFX
  9987     ELSE
  9988         MOVE AL-UANON           TO CERTA
  9989         MOVE CERTI              TO PI-689-CERT-PRIME
  9990                                    W-CERT-CERT-PRIME
  9991                                    W-CHEK-CERT-PRIME
  9992                                    W-MAIL-CERT-PRIME
  9993                                    W-PNDB2-CERT-PRIME
  9994         IF  SFXL EQUAL ZEROES
  9995                 OR
  9996             SFXI EQUAL LOW-VALUES
  9997             MOVE SPACES         TO PI-689-CERT-SFX
  9998                                    W-CERT-CERT-SFX
  9999                                    W-CHEK-CERT-SFX
 10000                                    W-MAIL-CERT-SFX
 10001                                    W-PNDB2-CERT-SFX
 10002         ELSE
 10003             MOVE AL-UANON       TO SFXA
 10004             MOVE SFXI           TO PI-689-CERT-SFX
 10005                                    W-CERT-CERT-SFX
 10006                                    W-CHEK-CERT-SFX
 10007                                    W-MAIL-CERT-SFX
 10008                                    W-PNDB2-CERT-SFX.
 10009
 10010 0930-EXIT.
 10011     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 196
* EL689.cbl
 10013 0935-EDIT-RESP-PERSON.
 10014
 10015     IF  RPERSONL EQUAL ZEROES
 10016         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
 10017                                    W-COMP-RESP-PERSON
 10018                                    W-PYAJ-FIN-RESP
 10019     ELSE
 10020         MOVE AL-UANON           TO RPERSONA
 10021         MOVE RPERSONI           TO PI-689-RESP-PERSON
 10022                                    W-PYAJ-FIN-RESP
 10023                                    W-COMP-RESP-PERSON.
 10024
 10025 0935-EXIT.
 10026     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 197
* EL689.cbl
 10028 0940-EDIT-ACCOUNT.
 10029
 10030     IF  ACCTL EQUAL ZEROES
 10031         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10032                                    W-COMP-ACCOUNT
 10033                                    W-PYAJ-ACCOUNT
 10034     ELSE
 10035         MOVE AL-UANON           TO ACCTA
 10036         MOVE ACCTI              TO PI-689-ACCOUNT
 10037                                    W-PYAJ-ACCOUNT
 10038                                    W-COMP-ACCOUNT.
 10039
 10040 0940-EXIT.
 10041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 198
* EL689.cbl
 10043 0945-EDIT-TYPE.
 10044
 10045     IF  TYPEL EQUAL ZEROES
 10046         MOVE LOW-VALUES         TO PI-689-TYPE
 10047                                    W-COMP-TYPE
 10048                                    W-PYAJ-RECORD-TYPE
 10049     ELSE
 10050         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
 10051         IF TYPEI = 'C' OR 'G' OR 'A'
 10052             MOVE AL-UANON       TO TYPEA
 10053             MOVE TYPEI          TO PI-689-TYPE
 10054                                    W-COMP-TYPE
 10055                                    W-PYAJ-RECORD-TYPE
 10056         ELSE
 10057             MOVE ER-7368        TO EMI-ERROR
 10058             MOVE -1             TO TYPEL
 10059             MOVE AL-UABON       TO TYPEA
 10060             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10061
 10062 0945-EXIT.
 10063     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 199
* EL689.cbl
 10065 0950-EDIT-ENTRY.
 10066
 10067     IF  BENTRYL EQUAL ZEROES
 10068         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
 10069                                    W-PNDB-ENTRY
 10070     ELSE
 10071         MOVE AL-UANON           TO BENTRYA
 10072         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
 10073                                    W-PNDB-ENTRY.
 10074
 10075 0950-EXIT.
 10076     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 200
* EL689.cbl
 10078 0955-EDIT-SEQUENCE.
 10079
 10080     IF  SEQL NOT EQUAL ZEROS
 10081         IF  SEQI NOT NUMERIC
 10082                 OR
 10083             SEQI EQUAL '0'
 10084             MOVE ER-7367        TO EMI-ERROR
 10085             MOVE -1             TO SEQL
 10086             MOVE AL-UABON       TO SEQA
 10087             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10088         ELSE
 10089             MOVE AL-UANON       TO SEQA
 10090             MOVE SEQI           TO PI-689-SEQ-NO
 10091                                    W-CHEK-SEQ-NO
 10092                                    W-PYAJ-FILE-SEQ-NO
 10093                                    W-PNDB-SEQ-NO
 10094                                    PI-689-SEQ-EDIT
 10095     ELSE
 10096         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
 10097
 10098 0955-EXIT.
 10099     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 201
* EL689.cbl
 10101 0960-EDIT-BATCH-SEQ.
 10102
 10103     IF  BCSEQL NOT EQUAL ZEROS
 10104         IF  BCSEQI NOT NUMERIC
 10105             MOVE ER-7368        TO EMI-ERROR
 10106             MOVE -1             TO BCSEQL
 10107             MOVE AL-UABON       TO BCSEQA
 10108             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10109         ELSE
 10110             MOVE AL-UANON       TO BCSEQA
 10111             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
 10112                                    W-PNDB-CHG-SEQ-NO
 10113                                    W-PNDB2-ALT-CHG-SEQ-NO
 10114                                    PI-689-BCSEQ-EDIT
 10115     ELSE
 10116         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
 10117
 10118 0960-EXIT.
 10119     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 202
* EL689.cbl
 10121 0965-EDIT-TYPE.
 10122
 10123     IF  TYPEL EQUAL ZEROES
 10124         MOVE LOW-VALUES         TO PI-689-TYPE
 10125                                    W-PNDB2-TYPE
 10126     ELSE
 10127         IF  DATASORI NOT EQUAL '4'
 10128             GO TO 0965-EXIT
 10129         ELSE
 10130             IF TYPEI = '0' OR '1' OR '2' OR '3'
 10131                 MOVE AL-UANON   TO TYPEA
 10132                 MOVE TYPEI      TO PI-689-TYPE
 10133                                    W-PNDB2-TYPE
 10134             ELSE
 10135                 MOVE ER-7370    TO EMI-ERROR
 10136                 MOVE -1         TO TYPEL
 10137                 MOVE AL-UABON   TO TYPEA
 10138                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10139
 10140 0965-EXIT.
 10141     EXIT.
 10142
 10143 0970-EDIT-CSO.
 10144
 10145     IF ENDARCHL > ZEROS
 10146        IF ENDARCHI NUMERIC
 10147            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
 10148            MOVE AL-UNNON       TO ENDARCHA
 10149            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
 10150            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
 10151            MOVE 'N'            TO W-VALID-ENDT-SW
 10152            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
 10153            IF NOT W-VALID-ENDT
 10154                MOVE -1         TO ENDARCHL
 10155                MOVE ER-1565    TO EMI-ERROR
 10156                MOVE AL-UNBON   TO ENDARCHA
 10157                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10158            END-IF
 10159        END-IF
 10160     ELSE
 10161        MOVE ZEROS              TO PI-ENDT-ARCH-NO
 10162     END-IF
 10163
 10164     IF PI-CERT-REQ-IND = 'Y'
 10165       IF  CERTIDL NOT EQUAL ZEROS
 10166         IF CERTIDI NUMERIC
 10167             MOVE AL-UANON      TO CERTIDA
 10168             MOVE CERTIDI       TO PI-CERT-FORM-ID
 10169         ELSE
 10170             MOVE ER-1778       TO EMI-ERROR
 10171             MOVE -1            TO CERTIDL
 10172             MOVE AL-UABON      TO CERTIDA
 10173             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10174         END-IF
 10175       ELSE
 10176          MOVE ER-0715       TO EMI-ERROR
 10177          MOVE -1            TO CERTIDL
 10178          MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 203
* EL689.cbl
 10179          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10180       END-IF
 10181     END-IF.
 10182
 10183 0970-EXIT.
 10184      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 204
* EL689.cbl
 10186 0990-CARRIER-VALIDITY-CHECK.
 10187
 10188     IF  CARRIERI EQUAL SPACES
 10189         GO TO 0990-EXIT.
 10190
 10191     MOVE SPACES                 TO W-CNTL-KEY.
 10192     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10193     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
 10194     MOVE CARRIERI               TO W-CNTL-GEN4.
 10195     MOVE +0                     TO W-CNTL-SEQ-NO.
 10196
 10197
 10198* EXEC CICS HANDLE CONDITION
 10199*        NOTFND  (0990-CARRIER-NOT-FOUND)
 10200*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10201*    END-EXEC.
 10202*    MOVE '"$IJ                  ! & #00010073' TO DFHEIV0
 10203     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10205     MOVE X'2620233030303130303733' TO DFHEIV0(25:11)
 10206     CALL 'kxdfhei1' USING DFHEIV0
 10207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10208
 10209
 10210
 10211* EXEC CICS READ
 10212*        DATASET (W-CNTL-FILE-ID)
 10213*        SET     (ADDRESS OF CONTROL-FILE)
 10214*        RIDFLD  (W-CNTL-KEY)
 10215*    END-EXEC.
 10216*    MOVE '&"S        E          (   #00010078' TO DFHEIV0
 10217     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10218     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10219     MOVE X'2020233030303130303738' TO DFHEIV0(25:11)
 10220     CALL 'kxdfhei1' USING DFHEIV0,
 10221           W-CNTL-FILE-ID,
 10222           DFHEIV20,
 10223           DFHEIV99,
 10224           W-CNTL-KEY,
 10225           DFHEIV99,
 10226           DFHEIV99,
 10227           DFHEIV99
 10228     SET ADDRESS OF CONTROL-FILE TO
 10229         DFHEIV20
 10230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10231
 10232
 10233     IF  PI-NO-CARRIER-SECURITY
 10234             OR
 10235         PI-CARRIER-SECURITY EQUAL CARRIERI
 10236         MOVE AL-UANON           TO CARRIERA
 10237         MOVE CARRIERI           TO PI-689-CARRIER
 10238                                    W-ACCT-CARRIER
 10239                                    W-CERT-CARRIER
 10240                                    W-CHEK-CARRIER
 10241                                    W-COMP-CARRIER
 10242                                    W-MAIL-CARRIER
 10243                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 205
* EL689.cbl
 10244                                    W-PYAJ-CARRIER
 10245     ELSE
 10246         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10247         MOVE ER-9095            TO EMI-ERROR
 10248         MOVE -1                 TO MAINTL
 10249         MOVE AL-UANON           TO MAINTA
 10250         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10251
 10252     GO TO 0990-EXIT.
 10253
 10254 0990-CARRIER-NOT-FOUND.
 10255
 10256     MOVE -1                     TO CARRIERL.
 10257     MOVE AL-UABON               TO CARRIERA.
 10258     MOVE ER-2208                TO EMI-ERROR.
 10259     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10260
 10261 0990-EXIT.
 10262     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 206
* EL689.cbl
 10264 0994-STATE-VALIDITY-CHECK.
 10265
 10266     IF  STATEI EQUAL SPACES
 10267         GO TO 0994-EXIT.
 10268
 10269     MOVE SPACES                 TO W-CNTL-KEY.
 10270     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10271     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10272     MOVE STATEI                 TO W-CNTL-GEN1.
 10273     MOVE +0                     TO W-CNTL-SEQ-NO.
 10274
 10275
 10276* EXEC CICS HANDLE CONDITION
 10277*        NOTFND  (0994-STATE-NOT-FOUND)
 10278*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10279*    END-EXEC.
 10280*    MOVE '"$IJ                  ! '' #00010126' TO DFHEIV0
 10281     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10283     MOVE X'2720233030303130313236' TO DFHEIV0(25:11)
 10284     CALL 'kxdfhei1' USING DFHEIV0
 10285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10286
 10287
 10288
 10289* EXEC CICS READ
 10290*        DATASET (W-CNTL-FILE-ID)
 10291*        SET     (ADDRESS OF CONTROL-FILE)
 10292*        RIDFLD  (W-CNTL-KEY)
 10293*    END-EXEC.
 10294*    MOVE '&"S        E          (   #00010131' TO DFHEIV0
 10295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10297     MOVE X'2020233030303130313331' TO DFHEIV0(25:11)
 10298     CALL 'kxdfhei1' USING DFHEIV0,
 10299           W-CNTL-FILE-ID,
 10300           DFHEIV20,
 10301           DFHEIV99,
 10302           W-CNTL-KEY,
 10303           DFHEIV99,
 10304           DFHEIV99,
 10305           DFHEIV99
 10306     SET ADDRESS OF CONTROL-FILE TO
 10307         DFHEIV20
 10308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10309
 10310
 10311     MOVE AL-UANON               TO STATEA.
 10312     MOVE STATEI                 TO PI-689-STATE
 10313                                    W-ACCT-STATE
 10314                                    W-CERT-STATE
 10315                                    W-CHEK-STATE
 10316                                    W-MAIL-STATE
 10317                                    W-PNDB2-STATE.
 10318
 10319     GO TO 0994-EXIT.
 10320
 10321 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 207
* EL689.cbl
 10322
 10323     MOVE -1                     TO STATEL.
 10324     MOVE AL-UABON               TO STATEA.
 10325     MOVE ER-2209                TO EMI-ERROR.
 10326     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10327
 10328 0994-EXIT.
 10329     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 208
* EL689.cbl
 10331 1000-SHOW.
 10332***************************************************************
 10333*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10334*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10335*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10336*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10337***************************************************************
 10338
 10339     MOVE SPACES                 TO W-RECORD-TABLE.
 10340
 10341     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10342          MOVE PI-689-LBL-OVERRIDE
 10343                                 TO ADDRLBLI
 10344          MOVE +1                TO ADDRLBLL
 10345          MOVE AL-UANON          TO ADDRLBLA
 10346     ELSE
 10347          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10348          MOVE +1                TO ADDRLBLL
 10349          MOVE AL-UANON          TO ADDRLBLA.
 10350
 10351     IF  ARCHNUML EQUAL ZEROS
 10352         MOVE -1                 TO ARCHNUML
 10353         MOVE AL-UNBON           TO ARCHNUMA
 10354         MOVE ER-0174            TO EMI-ERROR
 10355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10356         GO TO 8200-SEND-DATAONLY.
 10357
 10358     IF  ARCHNUMI NOT NUMERIC
 10359         MOVE -1                 TO ARCHNUML
 10360         MOVE AL-UNBON           TO ARCHNUMA
 10361         MOVE ER-0175            TO EMI-ERROR
 10362         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10363         GO TO 8200-SEND-DATAONLY.
 10364
 10365     IF  PI-SHOW-MODE
 10366
 10367         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10368             MOVE -1             TO MAINTL
 10369             GO TO 8200-SEND-DATAONLY
 10370         ELSE
 10371             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10372
 10373     MOVE +0                     TO W-ARCH-SEQ-NO
 10374                                    W-ARCT-SEQ-NO.
 10375     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10376                                    W-ARCT-COMPANY-CD.
 10377     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10378                                    W-ARCT-NUMBER
 10379                                    PI-689-ARCHIVE-NUMBER.
 10380     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10381     MOVE '1'                    TO PI-ACTION.
 10382     MOVE SPACES                 TO PI-689-PRINT-SW
 10383                                    PI-689-FORM-NUMBER
 10384                                    W-DELETE-KEY.
 10385     SET W-RG-NDX                TO W-ZEROS.
 10386
 10387
 10388* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 209
* EL689.cbl
 10389*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10390*         NOTFND     (1070-ARCH-NOT-FOUND)
 10391*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10392*    END-EXEC.
 10393*    MOVE '"$JI''                 ! ( #00010213' TO DFHEIV0
 10394     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10396     MOVE X'2820233030303130323133' TO DFHEIV0(25:11)
 10397     CALL 'kxdfhei1' USING DFHEIV0
 10398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10399
 10400
 10401
 10402* EXEC CICS READ
 10403*        DATASET (W-ARCH-FILE-ID)
 10404*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10405*        RIDFLD  (W-ARCH-KEY)
 10406*    END-EXEC.
 10407*    MOVE '&"S        E          (   #00010219' TO DFHEIV0
 10408     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10409     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10410     MOVE X'2020233030303130323139' TO DFHEIV0(25:11)
 10411     CALL 'kxdfhei1' USING DFHEIV0,
 10412           W-ARCH-FILE-ID,
 10413           DFHEIV20,
 10414           DFHEIV99,
 10415           W-ARCH-KEY,
 10416           DFHEIV99,
 10417           DFHEIV99,
 10418           DFHEIV99
 10419     SET ADDRESS OF LETTER-ARCHIVE TO
 10420         DFHEIV20
 10421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10422
 10423
 10424     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10425
 10426*    EXEC CICS HANDLE CONDITION
 10427*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10428*         NOTFND     (1020-ARCT-ENDBR)
 10429*         ENDFILE    (1020-ARCT-ENDBR)
 10430*    END-EXEC.
 10431*
 10432*1005-START-BROWSE.
 10433*
 10434*    EXEC CICS STARTBR
 10435*         DATASET    (W-ARCT-FILE-ID)
 10436*         RIDFLD     (W-ARCT-KEY)
 10437*         GTEQ
 10438*    END-EXEC.
 10439*
 10440*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10441*
 10442*1010-READ-NEXT.
 10443*
 10444*    EXEC CICS READNEXT
 10445*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10446*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 210
* EL689.cbl
 10447*         RIDFLD    (W-ARCT-KEY)
 10448*    END-EXEC.
 10449*
 10450*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10451*        IF  LT-ADDRESS-DATA
 10452*            IF  PI-CREATE-LABELS  AND
 10453*                NOT PI-689-LABELS-OVERRIDEN
 10454*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10455*                        VARYING
 10456*                    LT-NDX FROM 1 BY 1
 10457*                        UNTIL
 10458*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10459*                GO TO 1010-READ-NEXT
 10460*            ELSE
 10461*                MOVE LT-CONTROL-PRIMARY
 10462*                                TO W-DELETE-KEY
 10463*                GO TO 1010-READ-NEXT
 10464*        ELSE
 10465*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10466*                    VARYING
 10467*                LT-NDX FROM 1 BY 1
 10468*                    UNTIL
 10469*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10470*                    OR
 10471*                LT-NDX GREATER THAN +20
 10472*            GO TO 1010-READ-NEXT.
 10473*
 10474*1020-ARCT-ENDBR.
 10475*
 10476*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10477*        EXEC CICS ENDBR
 10478*             DATASET   (W-ARCT-FILE-ID)
 10479*        END-EXEC.
 10480*
 10481*    IF  W-RG-NDX EQUAL ZEROS
 10482*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10483*
 10484*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10485*            AND
 10486*        PI-BYPASS-LABELS
 10487*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10488*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10489*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10490*
 10491*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10492*    MOVE 1                      TO PI-CURRENT-LINE.
 10493*    SET W-RG-NDX                TO +1.
 10494*
 10495*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10496*            VARYING
 10497*        W-SC-NDX FROM 1 BY 1
 10498*            UNTIL
 10499*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10500
 10501     MOVE -1                     TO MAINTL.
 10502     GO TO 8100-SEND-INITIAL-MAP.
 10503
 10504 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 211
* EL689.cbl
 10505     EXIT.
 10506
 10507 1030-TEXT-BUILD.
 10508
 10509     SET W-RG-NDX UP BY 1.
 10510     MOVE LT-SKIP-CONTROL (LT-NDX)
 10511                                 TO W-PRINT-CONTROL.
 10512
 10513     IF  W-PRINT-CONTROL EQUAL 99
 10514         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10515         SET W-RG-NDX UP BY 1
 10516     ELSE
 10517         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10518
 10519     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10520     MOVE LT-SKIP-CONTROL (LT-NDX)
 10521                                 TO W-RC-PC (W-RG-NDX).
 10522     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10523
 10524 1030-EXIT.
 10525     EXIT.
 10526
 10527 1040-FORMAT-HEADER-DATA.
 10528
 10529     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10530     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10531     MOVE LA-CARRIER-A2          TO CARRIERO.
 10532     MOVE LA-CERT-NO-A2          TO CERTO.
 10533     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10534     MOVE LA-DATA-SOURCE         TO DATASORO.
 10535
 10536     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10537         MOVE ZEROES             TO DATEO
 10538
 10539     ELSE
 10540         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10541         MOVE ' '                TO DC-OPTION-CODE
 10542         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10543         MOVE DC-GREG-DATE-1-EDIT
 10544                                 TO DATEO.
 10545
 10546     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10547         MOVE ZEROES             TO FOLLOWO
 10548     ELSE
 10549         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10550         MOVE ' '                TO DC-OPTION-CODE
 10551         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10552         MOVE DC-GREG-DATE-1-EDIT
 10553                                 TO FOLLOWO.
 10554
 10555     MOVE LA-FORM-A3             TO FORMO.
 10556     MOVE LA-GROUPING-A2         TO GROUPO.
 10557     MOVE LA-NO-OF-COPIES        TO COPIESO
 10558                                    PI-689-NUMBER-COPIES.
 10559
 10560*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10561*        MOVE LA-PRINT-RESTRICTION
 10562*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 212
* EL689.cbl
 10563*    ELSE
 10564*        MOVE SPACES             TO PRTRESTO.
 10565
 10566     IF  LA-RESEND-DATE = LOW-VALUES
 10567         MOVE ZEROES             TO RESEND1O
 10568     ELSE
 10569         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10570         MOVE ' '                TO DC-OPTION-CODE
 10571         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10572         MOVE DC-GREG-DATE-1-EDIT
 10573                                 TO RESEND1O.
 10574
 10575     MOVE LA-STATE-A2            TO STATEO.
 10576
 10577     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10578
 10579 1040-EXIT.
 10580     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 213
* EL689.cbl
 10582 1050-MOVE-LABELS.
 10583
 10584     SET W-RG-NDX                TO LT-NDX.
 10585     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 10586     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10587     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10588
 10589 1050-EXIT.
 10590     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 214
* EL689.cbl
 10592 1060-DELETE-ADDRESS-RECORD.
 10593
 10594
 10595* EXEC CICS DELETE
 10596*        DATASET (W-ARCT-FILE-ID)
 10597*        RIDFLD  (W-DELETE-KEY)
 10598*    END-EXEC.
 10599*    MOVE '&(  R                 &   #00010395' TO DFHEIV0
 10600     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 10601     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10602     MOVE X'2020233030303130333935' TO DFHEIV0(25:11)
 10603     CALL 'kxdfhei1' USING DFHEIV0,
 10604           W-ARCT-FILE-ID,
 10605           W-DELETE-KEY,
 10606           DFHEIV99,
 10607           DFHEIV99,
 10608           DFHEIV99
 10609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10610
 10611
 10612
 10613* EXEC CICS READ
 10614*        DATASET (W-ARCH-FILE-ID)
 10615*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10616*        RIDFLD  (W-ARCH-KEY)
 10617*        UPDATE
 10618*    END-EXEC.
 10619*    MOVE '&"S        EU         (   #00010400' TO DFHEIV0
 10620     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10621     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10622     MOVE X'2020233030303130343030' TO DFHEIV0(25:11)
 10623     CALL 'kxdfhei1' USING DFHEIV0,
 10624           W-ARCH-FILE-ID,
 10625           DFHEIV20,
 10626           DFHEIV99,
 10627           W-ARCH-KEY,
 10628           DFHEIV99,
 10629           DFHEIV99,
 10630           DFHEIV99
 10631     SET ADDRESS OF LETTER-ARCHIVE TO
 10632         DFHEIV20
 10633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10634
 10635
 10636     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 10637
 10638
 10639* EXEC CICS REWRITE
 10640*         FROM      (LETTER-ARCHIVE)
 10641*         DATASET   (W-ARCH-FILE-ID)
 10642*    END-EXEC.
 10643     MOVE LENGTH OF
 10644      LETTER-ARCHIVE
 10645       TO DFHEIV11
 10646*    MOVE '&& L                  %   #00010409' TO DFHEIV0
 10647     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10648     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10649     MOVE X'2020233030303130343039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 215
* EL689.cbl
 10650     CALL 'kxdfhei1' USING DFHEIV0,
 10651           W-ARCH-FILE-ID,
 10652           LETTER-ARCHIVE,
 10653           DFHEIV11,
 10654           DFHEIV99
 10655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10656
 10657
 10658 1060-EXIT.
 10659     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 216
* EL689.cbl
 10661 1070-ARCH-NOT-FOUND.
 10662
 10663     MOVE ER-7371                TO EMI-ERROR.
 10664     MOVE -1                     TO ARCHNUML.
 10665     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10666     GO TO 8100-SEND-INITIAL-MAP.
 10667
 10668 1080-ARCHIVE-TEXT-NOT-FOUND.
 10669
 10670     MOVE ER-7372                TO EMI-ERROR.
 10671     MOVE -1                     TO ARCHNUML.
 10672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10673     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 217
* EL689.cbl
 10675 2000-CREATE.
 10676***************************************************************
 10677*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 10678*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 10679*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 10680*    WILL BE DISPLAYED ON THE SCREEN.                         *
 10681*                                                             *
 10682***************************************************************
 10683
 10684***************************************************************
 10685*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 10686*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 10687*    THEN FORCE AN ERROR.                                     *
 10688***************************************************************
 10689
 10690     IF  PI-689-CREATE-NO-SCREENS
 10691         GO TO 2000-GET-TEXT.
 10692
 10693     IF  PI-CREATE-MODE
 10694         IF  PI-689-PRINT-PERFORMED
 10695                 AND
 10696             FORMI NOT EQUAL 9999
 10697             MOVE ER-0279    TO EMI-ERROR
 10698             MOVE -1         TO MAINTL
 10699             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10700             GO TO 8200-SEND-DATAONLY.
 10701
 10702     IF  ARCHNUML GREATER THAN ZEROS
 10703         MOVE ER-9320            TO EMI-ERROR
 10704         MOVE -1                 TO ARCHNUML
 10705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10706         GO TO 8200-SEND-DATAONLY.
 10707
 10708***************************************************************
 10709*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 10710*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 10711***************************************************************
 10712
 10713     IF  FORMI EQUAL '9999'
 10714         MOVE 16                 TO PI-TOTAL-LINES
 10715         MOVE 1                  TO PI-CURRENT-LINE
 10716         MOVE SPACES             TO W-FILE-TABLE
 10717                                    W-LINE-CONTROL-RECORD
 10718                                    W-RECORD-TABLE
 10719                                    W-SINGLE-LINE
 10720                                    W-SQUEEZED-LINE
 10721                                    W-TS-WORK-AREA
 10722                                    W-TX-TABLE
 10723         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 10724         MOVE '3'                TO PI-ACTION
 10725         MOVE FORMI              TO PI-689-FORM-NUMBER
 10726                                    PI-COMM-CONTROL
 10727         MOVE ZEROS              TO PI-UPDATE-SW
 10728         MOVE W-PGM-EL1042       TO W-CALL-PGM
 10729         GO TO 9400-XCTL.
 10730
 10731 2000-GET-TEXT.
 10732
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 218
* EL689.cbl
 10733     MOVE SPACES                 TO W-FILE-TABLE
 10734                                    W-LINE-CONTROL-RECORD
 10735                                    W-RECORD-TABLE
 10736                                    W-SINGLE-LINE
 10737                                    W-SQUEEZED-LINE
 10738                                    W-TS-WORK-AREA
 10739                                    W-TX-TABLE.
 10740     SET W-TG-NDX                TO +1
 10741     MOVE ZEROS                  TO W-INITIAL-COLUMN
 10742                                    W-LINE-COUNT
 10743                                    W-LINE-INDENT-1
 10744                                    W-LINE-INDENT-2
 10745                                    W-LINE-INDENT-3
 10746                                    W-LINE-INDENT-4
 10747                                    W-LINE-INDENT-5
 10748                                    W-PAGE
 10749                                    W-PARAGRAPH-INDENT
 10750                                    W-TOP-MARGIN
 10751                                    W-WORK-INDENT.
 10752     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 10753     MOVE +70                    TO W-LAST-COLUMN.
 10754     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 10755     MOVE +1                     TO W-START-COLUMN.
 10756     MOVE +71                    TO W-TOO-FAR.
 10757
 10758     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 10759     MOVE FORMI                  TO W-TEXT-LETTER.
 10760     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 10761     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 10762
 10763
 10764* EXEC CICS HANDLE CONDITION
 10765*         NOTFND     (2001-NOT-FOUND)
 10766*         ENDFILE    (2001-NOT-FOUND)
 10767*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 10768*    END-EXEC.
 10769*    MOVE '"$I''J                 ! ) #00010519' TO DFHEIV0
 10770     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10771     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10772     MOVE X'2920233030303130353139' TO DFHEIV0(25:11)
 10773     CALL 'kxdfhei1' USING DFHEIV0
 10774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10775
 10776
 10777
 10778* EXEC CICS STARTBR
 10779*         DATASET    (W-TEXT-FILE-ID)
 10780*         RIDFLD     (W-TEXT-KEY)
 10781*         GTEQ
 10782*    END-EXEC.
 10783     MOVE 0
 10784       TO DFHEIV11
 10785*    MOVE '&,         G          &   #00010525' TO DFHEIV0
 10786     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10787     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10788     MOVE X'2020233030303130353235' TO DFHEIV0(25:11)
 10789     CALL 'kxdfhei1' USING DFHEIV0,
 10790           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 219
* EL689.cbl
 10791           W-TEXT-KEY,
 10792           DFHEIV99,
 10793           DFHEIV11,
 10794           DFHEIV99
 10795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10796
 10797
 10798
 10799* EXEC CICS HANDLE CONDITION
 10800*         ENDFILE    (2000-ENDBR)
 10801*    END-EXEC.
 10802*    MOVE '"$''                   ! * #00010531' TO DFHEIV0
 10803     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 10804     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10805     MOVE X'2A20233030303130353331' TO DFHEIV0(25:11)
 10806     CALL 'kxdfhei1' USING DFHEIV0
 10807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10808
 10809
 10810 2000-READ-NEXT.
 10811
 10812     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 10813         MOVE ER-0051            TO EMI-ERROR
 10814         MOVE -1                 TO MAINTL
 10815         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10816         GO TO 2000-ENDBR.
 10817
 10818
 10819* EXEC CICS READNEXT
 10820*         DATASET    (W-TEXT-FILE-ID)
 10821*         SET        (ADDRESS OF TEXT-FILES)
 10822*         RIDFLD     (W-TEXT-KEY)
 10823*    END-EXEC.
 10824     MOVE 0
 10825       TO DFHEIV11
 10826*    MOVE '&.S                   )   #00010543' TO DFHEIV0
 10827     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10828     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10829     MOVE X'2020233030303130353433' TO DFHEIV0(25:11)
 10830     CALL 'kxdfhei1' USING DFHEIV0,
 10831           W-TEXT-FILE-ID,
 10832           DFHEIV20,
 10833           DFHEIV99,
 10834           W-TEXT-KEY,
 10835           DFHEIV99,
 10836           DFHEIV11,
 10837           DFHEIV99,
 10838           DFHEIV99
 10839     SET ADDRESS OF TEXT-FILES TO
 10840         DFHEIV20
 10841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10842
 10843
 10844     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 10845         GO TO 2000-ENDBR.
 10846
 10847     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 10848
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 220
* EL689.cbl
 10849     MOVE TX-FORM-SQUEEZE-CONTROL
 10850                                 TO W-FORM-SQUEEZE-IND.
 10851
 10852     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 10853         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 10854
 10855     IF  TX-FORM-CONTROL-LINE
 10856         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 10857         GO TO 2000-READ-NEXT.
 10858
 10859     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 10860         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 10861         GO TO 2000-READ-NEXT.
 10862
 10863     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 10864     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 10865     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 10866     MOVE TX-LINE-SQUEEZE-CONTROL
 10867                                 TO W-TX-SC (W-TG-NDX).
 10868
 10869     SET W-TG-NDX UP BY 1.
 10870     GO TO 2000-READ-NEXT.
 10871
 10872 2000-ENDBR.
 10873
 10874
 10875* EXEC CICS ENDBR
 10876*        DATASET     (W-TEXT-FILE-ID)
 10877*    END-EXEC.
 10878     MOVE 0
 10879       TO DFHEIV11
 10880*    MOVE '&2                    $   #00010579' TO DFHEIV0
 10881     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10882     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10883     MOVE X'2020233030303130353739' TO DFHEIV0(25:11)
 10884     CALL 'kxdfhei1' USING DFHEIV0,
 10885           W-TEXT-FILE-ID,
 10886           DFHEIV11,
 10887           DFHEIV99
 10888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10889
 10890
 10891     IF  W-TEXT-BROWSE-NOT-STARTED
 10892         MOVE ER-0006            TO EMI-ERROR
 10893         MOVE -1                 TO FORML
 10894         MOVE AL-UABON           TO FORMA
 10895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10896         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10897
 10898     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 10899     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 10900     MOVE 1                      TO PI-CURRENT-LINE.
 10901
 10902     IF  COPIESL NOT GREATER THAN ZEROS
 10903         MOVE +1                 TO COPIESI
 10904                                    PI-689-NUMBER-COPIES
 10905         MOVE +1                 TO COPIESL
 10906         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 221
* EL689.cbl
 10907
 10908***************************************************************
 10909*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 10910*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 10911***************************************************************
 10912
 10913     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 10914
 10915*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 10916*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 10917*            MOVE ER-7243        TO EMI-ERROR
 10918*            MOVE -1             TO PRTRESTL
 10919*            MOVE AL-UABON       TO PRTRESTA
 10920*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10921
 10922     IF  PI-CREATE-LABELS AND
 10923         NOT  PI-689-LABELS-OVERRIDEN
 10924         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 10925         SET W-RG-NDX UP BY +1
 10926     ELSE
 10927         SET W-RG-NDX            TO +1.
 10928
 10929     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 10930     SET W-RG-NDX UP BY W-TOP-MARGIN.
 10931
 10932     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 10933
 10934     SET PI-TOTAL-LINES          TO W-RG-NDX.
 10935
 10936     IF  W-FIRST-BAD-VARIABLE-FOUND
 10937         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 10938         MOVE W-FIRST-BAD-VARIABLE
 10939                                 TO PI-CURRENT-LINE
 10940     ELSE
 10941         SET W-RG-NDX            TO 1.
 10942
 10943     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10944             VARYING
 10945         W-SC-NDX FROM 1 BY 1
 10946             UNTIL
 10947         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10948     IF  PI-689-CREATE-NO-SCREENS
 10949         GO TO 2000-EXIT
 10950     ELSE
 10951         IF  W-FORM-CHANGED
 10952             MOVE '3'            TO PI-ACTION
 10953             MOVE -1             TO MAINTL
 10954             GO TO 8100-SEND-INITIAL-MAP
 10955         ELSE
 10956             MOVE '3'            TO PI-ACTION
 10957             MOVE -1             TO MAINTL
 10958             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10959
 10960 2000-EXIT.
 10961     EXIT.
 10962
 10963 2001-NOT-FOUND.
 10964
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 222
* EL689.cbl
 10965     MOVE ER-0006                TO EMI-ERROR.
 10966     MOVE -1                     TO FORML.
 10967     MOVE AL-UABON               TO FORMA.
 10968     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10969     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 223
* EL689.cbl
 10971 2100-PROCESS-FORM-CONTROL-LINE.
 10972
 10973     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 10974
 10975     IF  W-LC-LINE-WIDTH NUMERIC
 10976             AND
 10977         W-LC-LINE-WIDTH GREATER THAN ZEROS
 10978         COMPUTE W-INITIAL-COLUMN
 10979             = (70 - W-LC-LINE-WIDTH) / 2
 10980         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 10981         COMPUTE W-LAST-COLUMN ROUNDED
 10982             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 10983         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 10984     ELSE
 10985         MOVE 70                 TO W-LC-LINE-WIDTH.
 10986
 10987     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 10988             AND
 10989         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 10990         MOVE W-LC-PARAGRAPH-INDENT
 10991                                 TO W-PARAGRAPH-INDENT.
 10992
 10993     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 10994             AND
 10995         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 10996         MOVE W-LC-MAX-LINES-PER-PAGE
 10997                                 TO W-MAX-LINES-PER-PAGE.
 10998
 10999     IF  W-LC-LINE-ADJUST NUMERIC
 11000             AND
 11001         W-LC-LINE-ADJUST GREATER THAN ZEROS
 11002         COMPUTE W-TOTAL-LINE-LENGTH
 11003             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 11004         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 11005             ADD W-LC-LINE-ADJUST
 11006                                 TO W-INITIAL-COLUMN
 11007                                    W-LAST-COLUMN
 11008                                    W-START-COLUMN
 11009                                    W-TOO-FAR.
 11010
 11011     IF  W-LC-LINE-INDENT-1 NUMERIC
 11012             AND
 11013         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 11014         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 11015     ELSE
 11016         MOVE +0                 TO W-LINE-INDENT-1.
 11017
 11018     IF  W-LC-LINE-INDENT-2 NUMERIC
 11019             AND
 11020         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 11021         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 11022     ELSE
 11023         MOVE +0                 TO W-LINE-INDENT-2.
 11024
 11025     IF  W-LC-LINE-INDENT-3 NUMERIC
 11026             AND
 11027         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 11028         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 224
* EL689.cbl
 11029     ELSE
 11030         MOVE +0                 TO W-LINE-INDENT-3.
 11031
 11032     IF  W-LC-LINE-INDENT-4 NUMERIC
 11033             AND
 11034         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 11035         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 11036     ELSE
 11037         MOVE +0                 TO W-LINE-INDENT-4.
 11038
 11039     IF  W-LC-LINE-INDENT-5 NUMERIC
 11040             AND
 11041         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 11042         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 11043
 11044     ELSE
 11045         MOVE +0                 TO W-LINE-INDENT-5.
 11046
 11047     IF  W-LC-TOP-MARGIN NUMERIC
 11048         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 11049     ELSE
 11050         MOVE +0                 TO W-TOP-MARGIN.
 11051
 11052     IF W-LC-CASE-IND = 'Y' OR 'N'
 11053         NEXT SENTENCE
 11054     ELSE
 11055         MOVE PI-LOWER-CASE-LETTERS
 11056                                 TO W-LC-CASE-IND.
 11057
 11058 2100-EXIT.
 11059     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 225
* EL689.cbl
 11061 2150-PROCESS-Z-CONTROLS.
 11062
 11063     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 11064
 11065     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 11066        IF W-DAYS-TO-RESEND NUMERIC
 11067           IF W-DAYS-TO-RESEND > ZEROS
 11068              MOVE '6'           TO DC-OPTION-CODE
 11069              MOVE W-SAVE-BIN-DATE
 11070                                 TO DC-BIN-DATE-1
 11071              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 11072              MOVE W-DAYS-TO-RESEND
 11073                                 TO DC-ELAPSED-DAYS
 11074              PERFORM 9500-LINK-DATE-CONVERT
 11075                                 THRU 9500-EXIT
 11076              IF NO-CONVERSION-ERROR
 11077                 MOVE DC-BIN-DATE-2
 11078                                 TO PI-689-RESEND-DATE-1
 11079                 MOVE DC-GREG-DATE-1-EDIT
 11080                                 TO RESEND1O
 11081                                    PI-689-RESEND1-EDIT
 11082                 MOVE AL-UANON
 11083                                 TO RESEND1A
 11084                 MOVE +8         TO RESEND1L
 11085              ELSE
 11086                 MOVE ER-3770
 11087                                 TO EMI-ERROR
 11088                 MOVE -1         TO MAINTL
 11089                 PERFORM 9900-ERROR-FORMAT
 11090                                 THRU 9900-EXIT
 11091                 GO TO 8200-SEND-DATAONLY
 11092              END-IF
 11093           END-IF
 11094        END-IF
 11095     END-IF
 11096     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 11097        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 11098     END-IF
 11099     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 11100         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 11101            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 11102                 MOVE '6'        TO DC-OPTION-CODE
 11103                 MOVE W-SAVE-BIN-DATE
 11104                                 TO DC-BIN-DATE-1
 11105                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 11106                 MOVE W-DAYS-TO-FOLLOW-UP
 11107                                 TO DC-ELAPSED-DAYS
 11108                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11109                 IF  NO-CONVERSION-ERROR
 11110                     MOVE DC-BIN-DATE-2
 11111                                 TO PI-689-FOLLOW-UP-DATE
 11112                     MOVE DC-GREG-DATE-1-EDIT
 11113                                 TO FOLLOWO
 11114                     MOVE AL-UANON
 11115                                 TO FOLLOWA
 11116                     MOVE +8     TO FOLLOWL
 11117                 ELSE
 11118                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 226
* EL689.cbl
 11119                                 TO EMI-ERROR
 11120                     MOVE -1     TO MAINTL
 11121                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11122                     GO TO 8200-SEND-DATAONLY.
 11123
 11124     IF  COPIESI NOT NUMERIC
 11125             OR
 11126         COPIESI NOT GREATER THAN ZEROS
 11127         IF  W-NUMBER-OF-COPIES NUMERIC
 11128             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 11129                 MOVE W-NUMBER-OF-COPIES
 11130                                 TO COPIESI
 11131                                    PI-689-NUMBER-COPIES
 11132                 MOVE AL-UNNON   TO COPIESA
 11133                 MOVE +1         TO COPIESL
 11134             ELSE
 11135                 MOVE +1         TO COPIESI
 11136                                    PI-689-NUMBER-COPIES
 11137                 MOVE AL-UNNON   TO COPIESA
 11138                 MOVE +1         TO COPIESL
 11139         ELSE
 11140             MOVE +1             TO COPIESI
 11141                                    PI-689-NUMBER-COPIES
 11142             MOVE AL-UNNON       TO COPIESA
 11143             MOVE +1             TO COPIESL.
 11144
 11145     IF W-PROMPT-LETTER EQUAL 'Y'
 11146         MOVE 'Y'                TO PI-PROMPT-IND
 11147         MOVE ER-0894            TO EMI-ERROR
 11148         MOVE -1                 TO MAINTL
 11149         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11150     END-IF.
 11151
 11152     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 11153                                           ENCO
 11154     MOVE AL-UANON                      TO ENCA
 11155     MOVE +3                            TO ENCL
 11156
 11157     IF W-PRINT-CERTIFICATE = 'Y'
 11158        MOVE 'Y' TO PI-CERT-REQ-IND
 11159        IF CERTIDL > ZEROS
 11160            IF CERTIDI NUMERIC
 11161              MOVE AL-UANON      TO CERTIDA
 11162              MOVE CERTIDI       TO PI-CERT-FORM-ID
 11163            ELSE
 11164              MOVE ER-1778       TO EMI-ERROR
 11165              MOVE -1            TO CERTIDL
 11166              MOVE AL-UABON      TO CERTIDA
 11167              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11168           END-IF
 11169        ELSE
 11170              MOVE ER-0715       TO EMI-ERROR
 11171              MOVE -1            TO CERTIDL
 11172              MOVE AL-UABON      TO CERTIDA
 11173              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11174        END-IF
 11175     END-IF.
 11176
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 227
* EL689.cbl
 11177     IF W-REASONS-REQUIRED = 'Y'
 11178        MOVE 'Y' TO PI-REASON-REQ-IND
 11179        IF PI-ENDT-ARCH-NO NOT > ZERO
 11180          MOVE ER-9840       TO EMI-ERROR
 11181          MOVE -1            TO FORML
 11182          MOVE AL-UABON      TO FORMA
 11183          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11184        END-IF
 11185     END-IF.
 11186
 11187*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 11188*                                       SPACES
 11189*        IF  W-PRINT-RESTRICTED
 11190*            MOVE W-PRINT-RESTRICTED-IND
 11191*                                TO PRTRESTI
 11192*                                   PI-689-PRINT-RESTRICTION
 11193*            MOVE AL-UANON       TO PRTRESTA
 11194*            MOVE +1             TO PRTRESTL.
 11195     .
 11196 2150-EXIT.
 11197     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 228
* EL689.cbl
 11199 2200-CHECK-FOR-VARIABLE.
 11200
 11201     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 11202         GO TO 2200-EXIT.
 11203
 11204     SET W-TX-NDX                TO +1.
 11205
 11206 2200-CONTINUE.
 11207
 11208     SEARCH W-TX-CHAR
 11209         VARYING
 11210             W-TX-NDX
 11211         AT END
 11212             GO TO 2200-EXIT
 11213         WHEN
 11214             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11215             NEXT SENTENCE.
 11216
 11217     SET W-TX-NDX UP BY +1.
 11218
 11219     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11220         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 11221         GO TO 2200-CONTINUE.
 11222
 11223 2200-EXIT.
 11224     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 229
* EL689.cbl
 11226 2220-BUILD-VARIABLE-NUMBER.
 11227
 11228     SET W-TX-NDX UP BY +1.
 11229     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 11230     SET W-TX-NDX UP BY +1.
 11231     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 11232     SET W-TX-NDX UP BY +1.
 11233     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11234
 11235     IF  W-VAR-RELATIVE-NUM NUMERIC
 11236         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11237         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11238
 11239 2220-EXIT.
 11240     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 230
* EL689.cbl
 11242 4000-ROLL-PAGE.
 11243
 11244     IF  ENTERPFL NOT EQUAL ZEROS
 11245         MOVE -1                 TO ENTERPFL
 11246     ELSE
 11247         MOVE -1                 TO MAINTL.
 11248
 11249     IF  PI-TOTAL-LINES EQUAL 0
 11250         MOVE ER-0047            TO EMI-ERROR
 11251         MOVE -1                 TO MAINTL
 11252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11253         GO TO 8200-SEND-DATAONLY.
 11254
 11255     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11256         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11257
 11258     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11259             OR
 11260         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11261         MOVE ER-0067            TO EMI-ERROR
 11262         MOVE -1                 TO MAINTL
 11263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11264         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11265
 11266*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11267*            AND
 11268*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11269*        MOVE ER-0066            TO EMI-ERROR
 11270*        MOVE -1                 TO MAINTL
 11271*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11272*        COMPUTE W-TEMP-CURRENT-LINE
 11273*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11274*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11275*                OR
 11276*            W-TEMP-CURRENT-LINE = ZEROS
 11277*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11278
 11279     IF  EMI-ERROR NOT EQUAL ER-0191
 11280             AND
 11281         MAINTI NOT EQUAL 'S'
 11282         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11283         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11284         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11285                 VARYING
 11286             W-SC-NDX FROM 1 BY 1
 11287                 UNTIL
 11288             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11289
 11290     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11291                         ER-0191
 11292         NEXT SENTENCE
 11293     ELSE
 11294         GO TO 8200-SEND-DATAONLY.
 11295
 11296     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11297     SET W-RG-NDX                TO PI-CURRENT-LINE
 11298     MOVE LOW-VALUES             TO EL689RI
 11299*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 231
* EL689.cbl
 11300     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11301     SET W-RG-NDX                TO PI-CURRENT-LINE
 11302     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11303             VARYING
 11304         W-SC-NDX FROM 1 BY 1
 11305             UNTIL
 11306         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11307
 11308     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 232
* EL689.cbl
 11310 4100-SET-NDX.
 11311
 11312     IF  PI-CURRENT-LINE EQUAL 0
 11313         SET W-RG-NDX            TO 1
 11314     ELSE
 11315         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11316
 11317 4100-EXIT.
 11318      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 233
* EL689.cbl
 11320 4200-UPDATE-TABLE-FROM-SCREEN.
 11321
 11322     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11323         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11324         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11325             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11326                 MOVE ER-0051    TO EMI-ERROR
 11327                 MOVE -1         TO MAINTL
 11328                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11329                 GO TO 8200-SEND-DATAONLY
 11330             ELSE
 11331                 MOVE W-SC-TEXT (W-SC-NDX)
 11332                                 TO W-RC-TEXT (W-RG-NDX)
 11333                 ADD 1           TO PI-TOTAL-LINES
 11334         ELSE
 11335             MOVE W-SC-TEXT (W-SC-NDX)
 11336                                 TO W-RC-TEXT (W-RG-NDX).
 11337
 11338     SET W-RG-NDX UP BY 1.
 11339
 11340 4200-EXIT.
 11341      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 234
* EL689.cbl
 11343 5000-EDIT-MODE.
 11344***************************************************************
 11345*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11346*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11347*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11348***************************************************************
 11349
 11350     IF  PI-SHOW-MODE
 11351         MOVE ER-0188            TO EMI-ERROR
 11352         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11353         MOVE -1                 TO MAINTL
 11354         MOVE AL-UABON           TO MAINTA
 11355         GO TO 8200-SEND-DATAONLY.
 11356
 11357     IF  PI-CURRENT-LINE EQUAL ZEROS
 11358         MOVE ER-0187            TO EMI-ERROR
 11359         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11360         MOVE -1                 TO MAINTL
 11361         GO TO 8200-SEND-DATAONLY.
 11362
 11363     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11364     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11365     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11366             VARYING
 11367         W-SC-NDX FROM 1 BY 1
 11368             UNTIL
 11369         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11370
 11371     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11372
 11373     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11374     MOVE ZEROS                  TO PI-UPDATE-SW.
 11375     MOVE '1'                    TO PI-ENTRY-CD-1.
 11376     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11377     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 235
* EL689.cbl
 11379 5400-LETTER-RELEASE.
 11380***************************************************************
 11381*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11382*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11383*    THE ARCHIVE FILE.                                        *
 11384*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11385*        1. CHECK SECURITY.                                   *
 11386*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11387*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11388*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11389*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11390*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11391***************************************************************
 11392
 11393     IF  NOT MODIFY-CAP
 11394         MOVE ER-0070            TO EMI-ERROR
 11395         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11396         MOVE -1                 TO MAINTL
 11397         GO TO 8200-SEND-DATAONLY.
 11398
 11399     IF  PI-SHOW-MODE
 11400         MOVE ER-0188            TO EMI-ERROR
 11401         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11402         MOVE -1                 TO MAINTL
 11403         MOVE AL-UABON           TO MAINTA
 11404         GO TO 8200-SEND-DATAONLY.
 11405
 11406      IF  ARCHNUML GREATER THAN ZEROS
 11407          MOVE ER-9320            TO EMI-ERROR
 11408          MOVE -1                 TO ARCHNUML
 11409          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11410          GO TO 8200-SEND-DATAONLY.
 11411
 11412*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11413*        MOVE ER-0187            TO EMI-ERROR
 11414*        MOVE -1                 TO MAINTL
 11415*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11416*        GO TO 8200-SEND-DATAONLY.
 11417
 11418*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11419*
 11420*    IF  NOT PI-689-CREATE-NO-SCREENS
 11421*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11422*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11423*                VARYING
 11424*            W-SC-NDX FROM 1 BY 1
 11425*                UNTIL
 11426*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11427*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11428*                OR
 11429*            PI-689-FATAL-ERROR
 11430*            GO TO 8200-SEND-DATAONLY.
 11431*
 11432*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11433*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11434*            VARYING
 11435*        W-RVS-NDX FROM +1 BY +1
 11436*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 236
* EL689.cbl
 11437*        W-RVS-NDX > +36500
 11438*            OR
 11439*        W-REMAINING-VAR-FOUND.
 11440*
 11441*    IF  NOT PI-689-CREATE-NO-SCREENS
 11442*        IF  W-REMAINING-VAR-FOUND
 11443*            GO TO 4000-ROLL-PAGE.
 11444
 11445*    MOVE SPACES                 TO W-CNTL-KEY.
 11446*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11447*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11448*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11449*
 11450*    EXEC CICS HANDLE CONDITION
 11451*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11452*         NOTFND     (5470-CNTL-NOT-FOUND)
 11453*    END-EXEC.
 11454*
 11455*    EXEC CICS READ
 11456*         DATASET    (W-CNTL-FILE-ID)
 11457*         SET        (ADDRESS OF CONTROL-FILE)
 11458*         RIDFLD     (W-CNTL-KEY)
 11459*         UPDATE
 11460*    END-EXEC.
 11461*
 11462*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11463*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11464*                                   CF-CREDIT-START-ARCH-NUM.
 11465*
 11466*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11467*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11468*                                TO W-ARCH-NUMBER
 11469*                                   W-ARCT-NUMBER.
 11470*
 11471*    EXEC CICS REWRITE
 11472*         FROM      (CONTROL-FILE)
 11473*         DATASET   (W-CNTL-FILE-ID)
 11474*    END-EXEC
 11475
 11476*    EXEC CICS HANDLE CONDITION
 11477*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11478*    END-EXEC.
 11479*
 11480*    EXEC CICS GETMAIN
 11481*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11482*       LENGTH   (W-ARCH-LENGTH)
 11483*    END-EXEC
 11484*
 11485*    MOVE SPACES                 TO LETTER-ARCHIVE
 11486*    MOVE 'LA'                   TO LA-RECORD-ID.
 11487*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11488*                                   LA-ARCHIVE-NO-A2
 11489*                                   LA-ARCHIVE-NO-A3
 11490*                                   LA-ARCHIVE-NO-A4
 11491*                                   LA-ARCHIVE-NO-A5
 11492*                                   LA-ARCHIVE-NO-A6
 11493*                                   PI-689-ARCHIVE-NUMBER.
 11494*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 237
* EL689.cbl
 11495*                                   LA-COMPANY-CD-A2
 11496*                                   LA-COMPANY-CD-A3
 11497*                                   LA-COMPANY-CD-A4
 11498*                                   LA-COMPANY-CD-A5
 11499*                                   LA-COMPANY-CD-A6.
 11500*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 11501*                                   LA-CARRIER-A3
 11502*                                   LA-CARRIER-A4
 11503*                                   LA-CARRIER-A5.
 11504*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11505*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11506*                                   LA-GROUPING-A3
 11507*                                   LA-GROUPING-A4
 11508*                                   LA-GROUPING-A5.
 11509*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11510*                                   LA-ACCOUNT-A3
 11511*                                   LA-ACCOUNT-A4
 11512*                                   LA-ACCOUNT-A5.
 11513*    MOVE PI-689-STATE           TO LA-STATE-A2
 11514*                                   LA-STATE-A3
 11515*                                   LA-STATE-A4
 11516*                                   LA-STATE-A5.
 11517*
 11518*    IF  PI-689-DATA-SOURCE EQUAL '3'
 11519*            AND
 11520*        PI-689-RESP-PERSON GREATER THAN SPACES
 11521*        MOVE PI-689-RESP-PERSON
 11522*                                TO LA-RESP-PERSON-A2
 11523*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 11524*    ELSE
 11525*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 11526*            MOVE PI-689-CERT-PRIME
 11527*                                TO LA-CERT-PRIME-A2
 11528*            MOVE PI-689-CERT-SFX
 11529*                                TO LA-CERT-SUFFIX-A2
 11530*        ELSE
 11531*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 11532*                                   LA-TYPE-A2.
 11533*
 11534*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 11535*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 11536*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11537*                AND
 11538*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 11539*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11540*            MOVE 'CK'           TO LA-FILLER
 11541*        ELSE
 11542*            NEXT SENTENCE
 11543*    ELSE
 11544*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11545*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11546*            MOVE 'CK'           TO LA-FILLER
 11547*        ELSE
 11548*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 11549*
 11550*    MOVE ZEROS                  TO W-SEQ-CTR.
 11551*
 11552*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 238
* EL689.cbl
 11553*
 11554*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 11555*                                   LA-INITIAL-PRINT-DATE
 11556*                                   LA-SENT-DATE
 11557*                                   LA-REPLY-DATE.
 11558*    MOVE 'A'                    TO LA-STATUS.
 11559*
 11560*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 11561*            OR
 11562*        PI-689-NUMBER-COPIES EQUAL ZEROS
 11563*        MOVE  1                 TO LA-NO-OF-COPIES
 11564*    ELSE
 11565*        MOVE PI-689-NUMBER-COPIES
 11566*                                TO LA-NO-OF-COPIES.
 11567*
 11568*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 11569*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 11570*    MOVE PI-689-PRINT-RESTRICTION
 11571*                                TO LA-PRINT-RESTRICTION
 11572*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 11573*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 11574*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 11575*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 11576*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 11577*
 11578*    IF  PI-689-PRINT-PERFORMED
 11579*        MOVE SPACES             TO PI-689-PRINT-SW
 11580*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 11581*        IF  LA-RESEND-DATE = LOW-VALUES
 11582*            MOVE 'C'            TO LA-STATUS.
 11583*
 11584*    MOVE PI-689-NUMBER-LABEL-LINES
 11585*                                TO LA-NUMBER-LABEL-LINES.
 11586*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 11587*
 11588*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 11589*
 11590*    MOVE PI-689-NUMBER-TEXT-RECORDS
 11591*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 11592*
 11593*    EXEC CICS HANDLE CONDITION
 11594*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 11595*    END-EXEC.
 11596*
 11597*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 11598*    MOVE ER-0280                TO EMI-ERROR.
 11599*    MOVE -1                     TO MAINTL.
 11600*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11602*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 11603     .
 11604 5400-END.
 11605     DISPLAY ' MADE IT TO 5400 '
 11606     MOVE SPACES                 TO BL-INPUT
 11607     MOVE ZEROS                  TO BL-ARCHIVE-NO
 11608     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 11609     MOVE PI-689-CARRIER         TO BL-CARRIER
 11610     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 239
* EL689.cbl
 11611     MOVE PI-689-STATE           TO BL-STATE
 11612     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 11613     IF PI-689-EFF-DATE NOT = LOW-VALUES
 11614        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 11615        MOVE ' '                 TO DC-OPTION-CODE
 11616        PERFORM 9500-LINK-DATE-CONVERT
 11617                                 THRU 9500-EXIT
 11618        IF NO-CONVERSION-ERROR
 11619           MOVE DC-GREG-DATE-1-EDIT
 11620                                 TO BL-EFF-DT
 11621        END-IF
 11622     END-IF
 11623     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 11624     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 11625     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 11626     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 11627     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 11628     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 11629     IF PI-ENDT-ARCH-NO > ZERO
 11630         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 11631     END-IF
 11632     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 11633     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 11634*    MOVE 'ALWA'                 TO BL-PROC-ID
 11635     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 11636*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 11637     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 11638     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 11639        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 11640        MOVE ' '                 TO DC-OPTION-CODE
 11641        PERFORM 9500-LINK-DATE-CONVERT
 11642                                 THRU 9500-EXIT
 11643        IF NO-CONVERSION-ERROR
 11644           MOVE DC-GREG-DATE-B-EDIT
 11645                                 TO BL-RESEND-DT
 11646        END-IF
 11647     END-IF
 11648     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 11649        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 11650        MOVE ' '                 TO DC-OPTION-CODE
 11651        PERFORM 9500-LINK-DATE-CONVERT
 11652                                 THRU 9500-EXIT
 11653        IF NO-CONVERSION-ERROR
 11654           MOVE DC-GREG-DATE-B-EDIT
 11655                                 TO BL-FOLLOW-UP-DT
 11656        END-IF
 11657     END-IF
 11658*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 11659*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 11660     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 11661     if eibaid = dfhpf7
 11662        move 'B'                 TO BL-WRITE-ERARCH
 11663     else
 11664        move 'T'                 to bl-write-erarch
 11665     end-if
 11666    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 11667*****************************************
 11668* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 240
* EL689.cbl
 11669*****************************************
 11670
 11671* exec cics link
 11672*       program('NSRASBL')
 11673*       commarea(srch-commarea)
 11674*    end-exec.
 11675     MOVE LENGTH OF
 11676      srch-commarea
 11677       TO DFHEIV11
 11678     MOVE 'NSRASBL' TO DFHEIV1
 11679*    MOVE '."C                   (   #00011362' TO DFHEIV0
 11680     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11681     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11682     MOVE X'2020233030303131333632' TO DFHEIV0(25:11)
 11683     CALL 'kxdfhei1' USING DFHEIV0,
 11684           DFHEIV1,
 11685           srch-commarea,
 11686           DFHEIV11,
 11687           DFHEIV99,
 11688           DFHEIV99,
 11689           DFHEIV99,
 11690           DFHEIV99
 11691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11692
 11693     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 11694        bl-message ' ' bl-archive-no
 11695     move bl-archive-no to w-arch-number
 11696
 11697     if eibaid = dfhpf7
 11698        PERFORM 5440-ADD-BILLING-NOTE THRU 5440-EXIT
 11699        MOVE ER-0280                TO EMI-ERROR
 11700        MOVE -1                     TO MAINTL
 11701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11702        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11703        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 11704        MOVE '2'                    TO PI-ACTION
 11705        MOVE ZEROS                  TO PI-TOTAL-LINES
 11706                                       PI-CURRENT-LINE
 11707        MOVE SPACES                 TO PI-689-PRINT-SW
 11708                                       PI-689-FORM-NUMBER
 11709        GO TO 9300-DFHCLEAR
 11710     else
 11711        move w-arch-number          to archnumo
 11712        MOVE ER-1818                TO EMI-ERROR
 11713        MOVE -1                     TO MAINTL
 11714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11715     end-if
 11716     MOVE -1                     TO MAINTL
 11717     GO TO 8200-SEND-DATAONLY
 11718     .
 11719 5400-EXIT.
 11720     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 241
* EL689.cbl
 11722 5410-CREATE-TEXT-RECORDS.
 11723
 11724*    EXEC CICS HANDLE CONDITION
 11725*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 11726*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 11727*    END-EXEC.
 11728*
 11729*    IF  PI-689-CREATE-NO-SCREENS
 11730*        IF  PI-689-GET-ARCT-MAIN
 11731*            EXEC CICS GETMAIN
 11732*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11733*                 LENGTH   (W-ARCT-LENGTH)
 11734*            END-EXEC
 11735*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 11736*                                    LETTER-ARCHIVE-TEXT
 11737*            MOVE LCP-WS-ADDR-COMP
 11738*                                TO PI-689-ARCT-POINTER
 11739*        ELSE
 11740*            MOVE PI-689-ARCT-POINTER
 11741*                                TO LCP-WS-ADDR-COMP
 11742*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 11743*                                TO LCP-WS-ADDR-PNTR
 11744*    ELSE
 11745*        EXEC CICS GETMAIN
 11746*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11747*             LENGTH   (W-ARCT-LENGTH)
 11748*        END-EXEC.
 11749*
 11750*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11751*
 11752*    MOVE ZEROS                  TO W-SEQ-CTR
 11753*
 11754*    IF  PI-CREATE-LABELS AND
 11755*        NOT PI-689-LABELS-OVERRIDEN
 11756*        MOVE '1'                TO LT-RECORD-TYPE
 11757*        MOVE +0                 TO LT-LINE-SEQ-NO
 11758*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 11759*                VARYING
 11760*            W-RG-NDX FROM 1 BY 1
 11761*                UNTIL
 11762*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 11763*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11764*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 11765*    ELSE
 11766*        SET W-RG-NDX            TO +1.
 11767*
 11768*    SET LT-NDX                  TO W-ZEROS.
 11769*
 11770*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 11771*            VARYING
 11772*        W-RG-NDX FROM W-RG-NDX BY +1
 11773*            UNTIL
 11774*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 11775
 11776 5410-EXIT.
 11777     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 242
* EL689.cbl
 11779 5415-INITIALIZE-TEXT.
 11780
 11781     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 11782     MOVE 'LT'                   TO LT-RECORD-ID.
 11783
 11784     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 11785     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 11786
 11787     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 11788                                    LT-NUM-LINES-ON-RECORD.
 11789
 11790 5415-EXIT.
 11791     EXIT.
 11792
 11793 5440-ADD-BILLING-NOTE.
 11794
 11795     MOVE LOW-VALUES             TO W-ELEOBC-KEY
 11796     MOVE PI-COMPANY-CD          TO W-EOBC-COMPANY-CD
 11797     MOVE '5'                    TO W-EOBC-REC-TYPE
 11798
 11799
 11800* EXEC CICS STARTBR
 11801*        DATASET   ('ELEOBC')
 11802*        RIDFLD    (W-ELEOBC-KEY)
 11803*        GTEQ
 11804*        RESP      (W-RESPONSE)
 11805*    END-EXEC
 11806     MOVE 'ELEOBC' TO DFHEIV1
 11807     MOVE 0
 11808       TO DFHEIV11
 11809*    MOVE '&,         G          &  N#00011472' TO DFHEIV0
 11810     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11812     MOVE X'204E233030303131343732' TO DFHEIV0(25:11)
 11813     CALL 'kxdfhei1' USING DFHEIV0,
 11814           DFHEIV1,
 11815           W-ELEOBC-KEY,
 11816           DFHEIV99,
 11817           DFHEIV11,
 11818           DFHEIV99
 11819     MOVE EIBRESP  TO W-RESPONSE
 11820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11821
 11822     IF NOT RESP-NORMAL
 11823        GO TO 5440-EXIT
 11824     END-IF
 11825      .
 11826 5440-READNEXT-ELEOBC.
 11827
 11828
 11829* EXEC CICS READNEXT
 11830*       INTO    (EOB-CODES)
 11831*       DATASET ('ELEOBC')
 11832*       RIDFLD  (W-ELEOBC-KEY)
 11833*       RESP    (W-RESPONSE)
 11834*    END-EXEC
 11835     MOVE LENGTH OF
 11836      EOB-CODES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 243
* EL689.cbl
 11837       TO DFHEIV12
 11838     MOVE 'ELEOBC' TO DFHEIV1
 11839     MOVE 0
 11840       TO DFHEIV11
 11841*    MOVE '&.IL                  )  N#00011485' TO DFHEIV0
 11842     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11843     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11844     MOVE X'204E233030303131343835' TO DFHEIV0(25:11)
 11845     CALL 'kxdfhei1' USING DFHEIV0,
 11846           DFHEIV1,
 11847           EOB-CODES,
 11848           DFHEIV12,
 11849           W-ELEOBC-KEY,
 11850           DFHEIV99,
 11851           DFHEIV11,
 11852           DFHEIV99,
 11853           DFHEIV99
 11854     MOVE EIBRESP  TO W-RESPONSE
 11855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11856
 11857     IF RESP-NORMAL
 11858         IF EO-RECORD-TYPE NOT = '5'
 11859             GO TO 5440-EXIT
 11860         END-IF
 11861     ELSE
 11862         GO TO 5440-EXIT
 11863     END-IF
 11864
 11865     IF EO-RECORD-TYPE = '5' AND
 11866        EO-EOB-CODE = PI-689-FORM-NUMBER
 11867           CONTINUE
 11868     ELSE
 11869         GO TO 5440-READNEXT-ELEOBC
 11870     END-IF
 11871
 11872     MOVE SPACES TO W-BILLING-NOTE
 11873     MOVE EO-DESCRIPTION TO W-BN-NOTE
 11874     MOVE PI-689-FORM-NUMBER TO W-BN-LTRID
 11875     MOVE W-SAVE-DATE TO W-BN-DATE
 11876     MOVE PI-PROCESSOR-ID TO W-BN-USERID
 11877     MOVE +25 TO W-LEN
 11878
 11879     PERFORM 5441-UPDATE-BILLING-NOTE THRU 5441-EXIT
 11880     .
 11881 5440-EXIT.
 11882     EXIT.
 11883
 11884 5441-UPDATE-BILLING-NOTE.
 11885
 11886     MOVE PI-COMPANY-CD          TO W-SV-COMPANY-CD
 11887     MOVE PI-689-CARRIER         TO W-SV-CARRIER
 11888     MOVE PI-689-GROUPING        TO W-SV-GROUPING
 11889     MOVE PI-689-STATE           TO W-SV-STATE
 11890     MOVE PI-689-ACCOUNT         TO W-SV-ACCOUNT
 11891     MOVE PI-689-EFF-DATE        TO W-SV-CERT-EFF-DT
 11892     MOVE PI-689-CERT-PRIME      TO W-SV-CERT-PRIME
 11893     MOVE PI-689-CERT-SFX        TO W-SV-CERT-SFX
 11894     MOVE W-SAVE-KEY             TO W-ERNOTE-KEY
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 244
* EL689.cbl
 11895
 11896
 11897* EXEC CICS READ
 11898*       DATASET    (W-NOTE-FILE-ID)
 11899*       RIDFLD     (W-ERNOTE-KEY)
 11900*       INTO       (CERTIFICATE-NOTE)
 11901*       RESP       (W-RESPONSE)
 11902*       UPDATE
 11903*    END-EXEC
 11904     MOVE LENGTH OF
 11905      CERTIFICATE-NOTE
 11906       TO DFHEIV11
 11907*    MOVE '&"IL       EU         (  N#00011531' TO DFHEIV0
 11908     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11909     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11910     MOVE X'204E233030303131353331' TO DFHEIV0(25:11)
 11911     CALL 'kxdfhei1' USING DFHEIV0,
 11912           W-NOTE-FILE-ID,
 11913           CERTIFICATE-NOTE,
 11914           DFHEIV11,
 11915           W-ERNOTE-KEY,
 11916           DFHEIV99,
 11917           DFHEIV99,
 11918           DFHEIV99
 11919     MOVE EIBRESP  TO W-RESPONSE
 11920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11921
 11922     IF RESP-NORMAL
 11923       IF CN-BILLING-START-LINE-NO NOT NUMERIC
 11924          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 11925       END-IF
 11926       IF CN-BILLING-END-LINE-NO NOT NUMERIC
 11927          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 11928       END-IF
 11929       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 11930           (NOTE-SUB > +10) OR
 11931           (CN-LINE (NOTE-SUB) (1:W-LEN) =
 11932                             W-BILLING-NOTE (1:W-LEN))
 11933       END-PERFORM
 11934       IF CN-LINE (NOTE-SUB) (1:W-LEN) =
 11935                              W-BILLING-NOTE (1:W-LEN)
 11936
 11937* EXEC CICS UNLOCK
 11938*           DATASET    (W-NOTE-FILE-ID)
 11939*        END-EXEC
 11940*    MOVE '&*                    #   #00011553' TO DFHEIV0
 11941     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11942     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11943     MOVE X'2020233030303131353533' TO DFHEIV0(25:11)
 11944     CALL 'kxdfhei1' USING DFHEIV0,
 11945           W-NOTE-FILE-ID,
 11946           DFHEIV99
 11947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11948       ELSE
 11949         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 11950           (NOTE-SUB > +10) OR
 11951           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
 11952         END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 245
* EL689.cbl
 11953         IF (NOTE-SUB < +11)
 11954           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
 11955              NOTE-SUB <= CN-BILLING-END-LINE-NO
 11956                MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 11957           ELSE
 11958             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 11959              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
 11960                MOVE W-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
 11961                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
 11962             ELSE
 11963               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 11964                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
 11965                     MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 11966                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
 11967               ELSE
 11968                 IF (CN-BILLING-END-LINE-NO = ZEROS)
 11969                   MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
 11970                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
 11971                                       CN-BILLING-START-LINE-NO
 11972                 ELSE
 11973                    PERFORM 5442-SQUEEZE-IT-IN THRU 5442-EXIT
 11974                 END-IF
 11975               END-IF
 11976             END-IF
 11977           END-IF
 11978           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 11979           MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 11980           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 11981
 11982* EXEC CICS REWRITE
 11983*             DATASET    (W-NOTE-FILE-ID)
 11984*             FROM       (CERTIFICATE-NOTE)
 11985*             RESP       (W-RESPONSE)
 11986*          END-EXEC
 11987     MOVE LENGTH OF
 11988      CERTIFICATE-NOTE
 11989       TO DFHEIV11
 11990*    MOVE '&& L                  %  N#00011589' TO DFHEIV0
 11991     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11992     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11993     MOVE X'204E233030303131353839' TO DFHEIV0(25:11)
 11994     CALL 'kxdfhei1' USING DFHEIV0,
 11995           W-NOTE-FILE-ID,
 11996           CERTIFICATE-NOTE,
 11997           DFHEIV11,
 11998           DFHEIV99
 11999     MOVE EIBRESP  TO W-RESPONSE
 12000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12001           PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12002         END-IF
 12003       END-IF
 12004     ELSE
 12005        MOVE SPACES              TO CERTIFICATE-NOTE
 12006        MOVE 'CN'                TO CN-RECORD-ID
 12007        MOVE W-SAVE-KEY          TO CN-CONTROL-PRIMARY
 12008                                    W-ERNOTE-KEY
 12009        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12010                                    CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 246
* EL689.cbl
 12011        MOVE W-BILLING-NOTE      TO CN-LINE (01)
 12012        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12013        MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12014        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12015
 12016* EXEC CICS WRITE
 12017*          DATASET    (W-NOTE-FILE-ID)
 12018*          FROM       (CERTIFICATE-NOTE)
 12019*          RIDFLD     (W-ERNOTE-KEY)
 12020*          RESP       (W-RESPONSE)
 12021*       END-EXEC
 12022     MOVE LENGTH OF
 12023      CERTIFICATE-NOTE
 12024       TO DFHEIV11
 12025*    MOVE '&$ L                  ''  N#00011608' TO DFHEIV0
 12026     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12027     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12028     MOVE X'204E233030303131363038' TO DFHEIV0(25:11)
 12029     CALL 'kxdfhei1' USING DFHEIV0,
 12030           W-NOTE-FILE-ID,
 12031           CERTIFICATE-NOTE,
 12032           DFHEIV11,
 12033           W-ERNOTE-KEY,
 12034           DFHEIV99,
 12035           DFHEIV99
 12036     MOVE EIBRESP  TO W-RESPONSE
 12037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12038
 12039        PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12040     END-IF
 12041
 12042     .
 12043 5441-EXIT.
 12044     EXIT.
 12045
 12046
 12047 5442-SQUEEZE-IT-IN.
 12048
 12049     IF NOTE-SUB < CN-BILLING-START-LINE-NO
 12050        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
 12051           NOTE-SUB = +10
 12052           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
 12053           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
 12054             MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
 12055             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
 12056             MOVE +9 TO NOTE-SUB
 12057           END-IF
 12058        END-PERFORM
 12059     ELSE
 12060        IF NOTE-SUB > CN-BILLING-END-LINE-NO
 12061           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
 12062             UNTIL NOTE-SUB = +1
 12063             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
 12064             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
 12065                MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
 12066                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
 12067                MOVE +2          TO NOTE-SUB
 12068             END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 247
* EL689.cbl
 12069           END-PERFORM
 12070        END-IF
 12071     END-IF
 12072
 12073     .
 12074 5442-EXIT.
 12075     EXIT.
 12076
 12077 5445-CERTIFICATE-UPDATE.
 12078
 12079     MOVE W-SAVE-KEY         TO W-CERT-KEY
 12080
 12081
 12082* EXEC CICS READ
 12083*        DATASET  (W-CERT-FILE-ID)
 12084*        RIDFLD   (W-CERT-KEY)
 12085*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 12086*        RESP     (W-RESPONSE)
 12087*        UPDATE
 12088*    END-EXEC
 12089*    MOVE '&"S        EU         (  N#00011657' TO DFHEIV0
 12090     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12091     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12092     MOVE X'204E233030303131363537' TO DFHEIV0(25:11)
 12093     CALL 'kxdfhei1' USING DFHEIV0,
 12094           W-CERT-FILE-ID,
 12095           DFHEIV20,
 12096           DFHEIV99,
 12097           W-CERT-KEY,
 12098           DFHEIV99,
 12099           DFHEIV99,
 12100           DFHEIV99
 12101     SET ADDRESS OF CERTIFICATE-MASTER TO
 12102         DFHEIV20
 12103     MOVE EIBRESP  TO W-RESPONSE
 12104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12105
 12106     IF RESP-NORMAL
 12107        EVALUATE CM-NOTE-SW
 12108           WHEN '2'
 12109           WHEN '3'
 12110           WHEN '6'
 12111           WHEN '7'
 12112              SET NO-CERT-RW     TO TRUE
 12113           WHEN ' '
 12114              MOVE '2'           TO CM-NOTE-SW
 12115           WHEN '1'
 12116              MOVE '3'           TO CM-NOTE-SW
 12117           WHEN '4'
 12118              MOVE '6'           TO CM-NOTE-SW
 12119           WHEN '5'
 12120              MOVE '7'           TO CM-NOTE-SW
 12121        END-EVALUATE
 12122     END-IF
 12123     IF NOT NO-CERT-RW
 12124
 12125* EXEC CICS REWRITE
 12126*          FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 248
* EL689.cbl
 12127*          DATASET  (W-CERT-FILE-ID)
 12128*          RESP     (W-RESPONSE)
 12129*       END-EXEC
 12130     MOVE LENGTH OF
 12131      CERTIFICATE-MASTER
 12132       TO DFHEIV11
 12133*    MOVE '&& L                  %  N#00011683' TO DFHEIV0
 12134     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12135     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12136     MOVE X'204E233030303131363833' TO DFHEIV0(25:11)
 12137     CALL 'kxdfhei1' USING DFHEIV0,
 12138           W-CERT-FILE-ID,
 12139           CERTIFICATE-MASTER,
 12140           DFHEIV11,
 12141           DFHEIV99
 12142     MOVE EIBRESP  TO W-RESPONSE
 12143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12144     ELSE
 12145
 12146* EXEC CICS UNLOCK
 12147*          DATASET  (W-CERT-FILE-ID)
 12148*       END-EXEC
 12149*    MOVE '&*                    #   #00011689' TO DFHEIV0
 12150     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12151     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12152     MOVE X'2020233030303131363839' TO DFHEIV0(25:11)
 12153     CALL 'kxdfhei1' USING DFHEIV0,
 12154           W-CERT-FILE-ID,
 12155           DFHEIV99
 12156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12157     END-IF
 12158
 12159     .
 12160 5445-EXIT.
 12161     EXIT.
 12162
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 249
* EL689.cbl
 12164 5460-DUPLICATE-ARCHIVE-RCD.
 12165
 12166     IF  NOT PI-689-CREATE-NO-SCREENS
 12167
 12168* EXEC CICS SYNCPOINT ROLLBACK
 12169*        END-EXEC.
 12170*    MOVE '6"R                   !   #00011702' TO DFHEIV0
 12171     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12173     MOVE X'2020233030303131373032' TO DFHEIV0(25:11)
 12174     CALL 'kxdfhei1' USING DFHEIV0
 12175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12176
 12177
 12178     MOVE ER-9426                TO EMI-ERROR.
 12179     MOVE -1                     TO MAINTL.
 12180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12181     GO TO 8200-SEND-DATAONLY.
 12182
 12183 5465-DUPLICATE-ARCH-TEXT.
 12184
 12185     IF  NOT PI-689-CREATE-NO-SCREENS
 12186
 12187* EXEC CICS SYNCPOINT ROLLBACK
 12188*        END-EXEC.
 12189*    MOVE '6"R                   !   #00011713' TO DFHEIV0
 12190     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12192     MOVE X'2020233030303131373133' TO DFHEIV0(25:11)
 12193     CALL 'kxdfhei1' USING DFHEIV0
 12194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12195
 12196
 12197     MOVE ER-7369                TO EMI-ERROR.
 12198     MOVE -1                     TO MAINTL.
 12199     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12200     GO TO 8200-SEND-DATAONLY.
 12201
 12202 5470-CNTL-NOT-FOUND.
 12203
 12204     MOVE ER-9299                TO EMI-ERROR.
 12205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12206     MOVE -1                     TO MAINTL.
 12207     MOVE AL-UANON               TO MAINTA.
 12208     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 250
* EL689.cbl
 12210 5500-FORMAT-TEXT.
 12211
 12212     SET LT-NDX UP BY +1.
 12213
 12214     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 12215         SET W-RG-NDX UP BY 1
 12216         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 12217         MOVE W-RC-TEXT (W-RG-NDX)
 12218                                 TO LT-TEXT-LINE (LT-NDX)
 12219     ELSE
 12220         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 12221             MOVE ZEROS          TO W-PRINT-CONTROL
 12222             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 12223                     VARYING
 12224                 W-RG-NDX FROM W-RG-NDX BY 1
 12225                     UNTIL
 12226                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12227                     OR
 12228                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 12229             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12230                 GO TO 5500-WRITE-TEST
 12231             ELSE
 12232                 MOVE W-PRINT-CONTROL
 12233                                 TO LT-SKIP-CONTROL (LT-NDX)
 12234                 MOVE W-RC-TEXT (W-RG-NDX)
 12235                                 TO LT-TEXT-LINE (LT-NDX)
 12236         ELSE
 12237             MOVE W-RC-TEXT (W-RG-NDX)
 12238                                 TO LT-TEXT-LINE (LT-NDX)
 12239             MOVE ZEROS          TO W-PRINT-CONTROL.
 12240
 12241     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 12242
 12243 5500-WRITE-TEST.
 12244
 12245     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 12246         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 12247             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12248             MOVE '2'            TO LT-RECORD-TYPE
 12249             ADD +1              TO W-SEQ-CTR
 12250             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12251             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12252         ELSE
 12253             NEXT SENTENCE
 12254     ELSE
 12255         IF  LT-NDX EQUAL +20
 12256             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12257             MOVE '2'            TO LT-RECORD-TYPE
 12258             ADD +1              TO W-SEQ-CTR
 12259             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12260             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12261             SET LT-NDX          TO W-ZEROS
 12262             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12263
 12264 5500-EXIT.
 12265      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 251
* EL689.cbl
 12267 5505-FIND-USED-LINE.
 12268
 12269     ADD +1                      TO W-PRINT-CONTROL.
 12270
 12271 5505-EXIT.
 12272      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 252
* EL689.cbl
 12274 5600-FORMAT-ADDRESS-LINE.
 12275
 12276     SET LT-NDX                  TO W-RG-NDX.
 12277     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 12278
 12279 5600-EXIT.
 12280     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 253
* EL689.cbl
 12282 5650-WRITE-ARCHIVE.
 12283
 12284
 12285* EXEC CICS WRITE
 12286*         DATASET   (W-ARCH-FILE-ID)
 12287*         FROM      (LETTER-ARCHIVE)
 12288*         RIDFLD    (LA-CONTROL-PRIMARY)
 12289*    END-EXEC.
 12290     MOVE LENGTH OF
 12291      LETTER-ARCHIVE
 12292       TO DFHEIV11
 12293*    MOVE '&$ L                  ''   #00011803' TO DFHEIV0
 12294     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12295     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12296     MOVE X'2020233030303131383033' TO DFHEIV0(25:11)
 12297     CALL 'kxdfhei1' USING DFHEIV0,
 12298           W-ARCH-FILE-ID,
 12299           LETTER-ARCHIVE,
 12300           DFHEIV11,
 12301           LA-CONTROL-PRIMARY,
 12302           DFHEIV99,
 12303           DFHEIV99
 12304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12305
 12306
 12307 5650-EXIT.
 12308     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 254
* EL689.cbl
 12310 5655-WRITE-ARCHIVE-TEXT.
 12311
 12312
 12313* EXEC CICS WRITE
 12314*         DATASET   (W-ARCT-FILE-ID)
 12315*         FROM      (LETTER-ARCHIVE-TEXT)
 12316*         RIDFLD    (LT-CONTROL-PRIMARY)
 12317*    END-EXEC.
 12318     MOVE LENGTH OF
 12319      LETTER-ARCHIVE-TEXT
 12320       TO DFHEIV11
 12321*    MOVE '&$ L                  ''   #00011814' TO DFHEIV0
 12322     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12323     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12324     MOVE X'2020233030303131383134' TO DFHEIV0(25:11)
 12325     CALL 'kxdfhei1' USING DFHEIV0,
 12326           W-ARCT-FILE-ID,
 12327           LETTER-ARCHIVE-TEXT,
 12328           DFHEIV11,
 12329           LT-CONTROL-PRIMARY,
 12330           DFHEIV99,
 12331           DFHEIV99
 12332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12333
 12334
 12335 5655-EXIT.
 12336     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 255
* EL689.cbl
 12338 6000-RESOLVE-VARIABLES.
 12339***************************************************************
 12340*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 12341*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 12342*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 12343*    RESOLVE ALL OF THE SYMBOLS.                              *
 12344*                                                             *
 12345***************************************************************
 12346
 12347     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 12348     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 12349     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 12350     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 12351     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 12352*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 12353     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 12354     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 12355     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 12356     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 12357     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 12358     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 12359     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 12360     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 12361
 12362     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 12363
 12364 6000-EXIT.
 12365     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 256
* EL689.cbl
 12367 6200-GET-COMPANY-DATA.
 12368
 12369     IF  ADDRSI EQUAL '3'
 12370             AND
 12371         PI-CREATE-LABELS
 12372             AND
 12373         NOT PI-689-LABELS-OVERRIDEN
 12374         NEXT SENTENCE
 12375     ELSE
 12376         IF  W-FILE-NOT-USED (1)
 12377             GO TO 6200-EXIT.
 12378
 12379     MOVE SPACES                 TO W-CNTL-KEY.
 12380     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12381     MOVE +0                     TO W-CNTL-SEQ-NO.
 12382     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 12383
 12384
 12385* EXEC CICS HANDLE CONDITION
 12386*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 12387*         NOTFND    (6200-CNTL1-NOT-FOUND)
 12388*    END-EXEC.
 12389*    MOVE '"$JI                  ! + #00011869' TO DFHEIV0
 12390     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12392     MOVE X'2B20233030303131383639' TO DFHEIV0(25:11)
 12393     CALL 'kxdfhei1' USING DFHEIV0
 12394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12395
 12396
 12397
 12398* EXEC CICS READ
 12399*         DATASET   (W-CNTL-FILE-ID)
 12400*         SET       (ADDRESS OF CONTROL-FILE)
 12401*         RIDFLD    (W-CNTL-KEY)
 12402*    END-EXEC.
 12403*    MOVE '&"S        E          (   #00011874' TO DFHEIV0
 12404     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12405     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12406     MOVE X'2020233030303131383734' TO DFHEIV0(25:11)
 12407     CALL 'kxdfhei1' USING DFHEIV0,
 12408           W-CNTL-FILE-ID,
 12409           DFHEIV20,
 12410           DFHEIV99,
 12411           W-CNTL-KEY,
 12412           DFHEIV99,
 12413           DFHEIV99,
 12414           DFHEIV99
 12415     SET ADDRESS OF CONTROL-FILE TO
 12416         DFHEIV20
 12417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12418
 12419
 12420     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12421     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 12422                                    W-VG-TEXT (25).
 12423     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 12424     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 257
* EL689.cbl
 12425     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 12426     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 12427
 12428     IF  CF-CL-CAN-POST-CODE
 12429         MOVE CF-CL-CANADIAN-POSTAL-CODE
 12430                                 TO W-CANADIAN-POSTAL-CODES
 12431         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12432         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12433         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12434                                    W-LAB-CAN-FILLER (6)
 12435         GO TO 6200-CONTINUE.
 12436
 12437     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12438         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 12439         MOVE SPACES             TO W-LABEL-ZIP (6)
 12440         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12441
 12442         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12443             MOVE '-'            TO W-LABEL-DASH (6)
 12444             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12445             GO TO 6200-CONTINUE
 12446         ELSE
 12447             MOVE SPACES         TO W-LABEL-DASH (6)
 12448                                    W-LABEL-2ND-ZIP (6)
 12449             GO TO 6200-CONTINUE.
 12450
 12451     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 12452         GO TO 6200-CONTINUE.
 12453
 12454     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 12455
 12456     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12457         COMPUTE W-WORK-ZIP-NUMERIC
 12458             = W-WORK-ZIP-NUMERIC * 10000.
 12459
 12460     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12461     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12462
 12463     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12464         MOVE '-'                TO W-LABEL-DASH (6)
 12465         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12466         GO TO 6200-CONTINUE
 12467     ELSE
 12468         MOVE SPACES             TO W-LABEL-DASH (6)
 12469                                    W-LABEL-2ND-ZIP (6)
 12470         GO TO 6200-CONTINUE.
 12471
 12472 6200-CONTINUE.
 12473
 12474     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12475
 12476     IF  ADDRSI EQUAL '3'
 12477             AND
 12478         PI-CREATE-LABELS
 12479             AND
 12480         NOT PI-689-LABELS-OVERRIDEN
 12481         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 12482         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 258
* EL689.cbl
 12483         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 12484         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 12485         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 12486         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 12487         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12488         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12489         SET W-RG-NDX UP BY +1
 12490     ELSE
 12491         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 12492         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 12493         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 12494         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 12495         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 12496         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 12497
 12498     GO TO 6200-EXIT.
 12499
 12500 6200-CNTL1-NOT-FOUND.
 12501
 12502     MOVE ER-9299                TO EMI-ERROR.
 12503     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12504     MOVE -1                     TO ADDRSL.
 12505     MOVE AL-UANON               TO ADDRSA.
 12506     GO TO 8200-SEND-DATAONLY.
 12507
 12508 6200-EXIT.
 12509     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 259
* EL689.cbl
 12511 6250-GET-CNTL2-DATA.
 12512
 12513     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 12514         GO TO 6250-EXIT.
 12515
 12516     IF  W-FILE-NOT-USED (11)
 12517         GO TO 6250-EXIT.
 12518
 12519     MOVE SPACES                 TO W-CNTL-KEY.
 12520     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12521     MOVE +0                     TO W-CNTL-SEQ-NO.
 12522     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 12523     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 12524
 12525
 12526* EXEC CICS HANDLE CONDITION
 12527*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12528*         NOTFND     (6250-CNTL2-NOT-FOUND)
 12529*    END-EXEC.
 12530*    MOVE '"$JI                  ! , #00011985' TO DFHEIV0
 12531     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12532     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12533     MOVE X'2C20233030303131393835' TO DFHEIV0(25:11)
 12534     CALL 'kxdfhei1' USING DFHEIV0
 12535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12536
 12537
 12538
 12539* EXEC CICS READ
 12540*         DATASET    (W-CNTL-FILE-ID)
 12541*         SET        (ADDRESS OF CONTROL-FILE)
 12542*         RIDFLD     (W-CNTL-KEY)
 12543*    END-EXEC.
 12544*    MOVE '&"S        E          (   #00011990' TO DFHEIV0
 12545     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12546     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12547     MOVE X'2020233030303131393930' TO DFHEIV0(25:11)
 12548     CALL 'kxdfhei1' USING DFHEIV0,
 12549           W-CNTL-FILE-ID,
 12550           DFHEIV20,
 12551           DFHEIV99,
 12552           W-CNTL-KEY,
 12553           DFHEIV99,
 12554           DFHEIV99,
 12555           DFHEIV99
 12556     SET ADDRESS OF CONTROL-FILE TO
 12557         DFHEIV20
 12558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12559
 12560
 12561     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 12562     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 12563     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 12564     GO TO 6250-EXIT.
 12565
 12566 6250-CNTL2-NOT-FOUND.
 12567
 12568     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 260
* EL689.cbl
 12569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12570     MOVE -1                     TO MAINTL.
 12571     MOVE AL-UANON               TO MAINTA.
 12572     GO TO 8200-SEND-DATAONLY.
 12573
 12574 6250-EXIT.
 12575     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 261
* EL689.cbl
 12577 6300-GET-CARRIER-DATA.
 12578
 12579     IF  ADDRSI EQUAL '2'
 12580             AND
 12581         PI-CREATE-LABELS
 12582             AND
 12583         NOT PI-689-LABELS-OVERRIDEN
 12584         NEXT SENTENCE
 12585     ELSE
 12586         IF  W-FILE-NOT-USED (4)
 12587             GO TO 6300-EXIT.
 12588
 12589     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 12590         MOVE SPACES             TO W-CNTL-KEY
 12591         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 12592         MOVE +0                 TO W-CNTL-SEQ-NO
 12593         MOVE '6'                TO W-CNTL-RECORD-TYPE
 12594         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 12595     ELSE
 12596         MOVE ER-9327            TO EMI-ERROR
 12597         MOVE -1                 TO CARRIERL
 12598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12599         GO TO 6300-EXIT.
 12600
 12601
 12602* EXEC CICS HANDLE CONDITION
 12603*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12604*         NOTFND     (6300-CNTL6-NOT-FOUND)
 12605*    END-EXEC.
 12606*    MOVE '"$JI                  ! - #00012036' TO DFHEIV0
 12607     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12608     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12609     MOVE X'2D20233030303132303336' TO DFHEIV0(25:11)
 12610     CALL 'kxdfhei1' USING DFHEIV0
 12611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12612
 12613
 12614
 12615* EXEC CICS READ
 12616*         DATASET    (W-CNTL-FILE-ID)
 12617*         SET        (ADDRESS OF CONTROL-FILE)
 12618*         RIDFLD     (W-CNTL-KEY)
 12619*    END-EXEC.
 12620*    MOVE '&"S        E          (   #00012041' TO DFHEIV0
 12621     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12622     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12623     MOVE X'2020233030303132303431' TO DFHEIV0(25:11)
 12624     CALL 'kxdfhei1' USING DFHEIV0,
 12625           W-CNTL-FILE-ID,
 12626           DFHEIV20,
 12627           DFHEIV99,
 12628           W-CNTL-KEY,
 12629           DFHEIV99,
 12630           DFHEIV99,
 12631           DFHEIV99
 12632     SET ADDRESS OF CONTROL-FILE TO
 12633         DFHEIV20
 12634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 262
* EL689.cbl
 12635
 12636
 12637     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12638     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 12639     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 12640     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 12641     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 12642     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 12643
 12644     IF  CF-CANADIAN-POST-CODE
 12645         MOVE CF-CANADIAN-POSTAL-CODE
 12646                                 TO W-CANADIAN-POSTAL-CODES
 12647         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12648         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12649         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12650                                    W-LAB-CAN-FILLER (6)
 12651         GO TO 6300-CONTINUE.
 12652
 12653     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12654         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 12655         MOVE SPACES             TO W-LABEL-ZIP (6)
 12656         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12657         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12658             MOVE '-'            TO W-LABEL-DASH (6)
 12659             MOVE W-WORK-ZIP4
 12660                                 TO W-LABEL-2ND-ZIP (6)
 12661             GO TO 6300-CONTINUE
 12662         ELSE
 12663             MOVE SPACES         TO W-LABEL-DASH (6)
 12664                                    W-LABEL-2ND-ZIP (6)
 12665             GO TO 6300-CONTINUE.
 12666
 12667     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 12668         GO TO 6300-CONTINUE.
 12669
 12670     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 12671
 12672     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12673         COMPUTE W-WORK-ZIP-NUMERIC
 12674             = W-WORK-ZIP-NUMERIC * 10000.
 12675
 12676     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12677     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12678
 12679     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12680         MOVE '-'                TO W-LABEL-DASH (6)
 12681         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12682         GO TO 6300-CONTINUE
 12683     ELSE
 12684         MOVE SPACES             TO W-LABEL-DASH (6)
 12685                                    W-LABEL-2ND-ZIP (6)
 12686         GO TO 6300-CONTINUE.
 12687
 12688 6300-CONTINUE.
 12689
 12690     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12691
 12692     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 263
* EL689.cbl
 12693             AND
 12694         PI-CREATE-LABELS
 12695             AND
 12696         NOT PI-689-LABELS-OVERRIDEN
 12697         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 12698         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 12699         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 12700         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 12701         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 12702         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 12703         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12704         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12705         SET W-RG-NDX UP BY +1
 12706     ELSE
 12707         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 12708         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 12709         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 12710         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 12711         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 12712         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 12713
 12714     IF  W-FULL-DATA
 12715         MOVE ZEROS              TO W-PHONE-IN
 12716         MOVE CF-PHONE-NO        TO W-PHONE-IN
 12717         MOVE W-PHI-AREA         TO W-PO-AREA
 12718         MOVE W-PHI-PFX          TO W-PO-PFX
 12719         MOVE W-PHI-SFX          TO W-PO-SFX
 12720         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 12721
 12722     GO TO 6300-EXIT.
 12723
 12724 6300-CNTL6-NOT-FOUND.
 12725
 12726     MOVE ER-9298                TO EMI-ERROR.
 12727     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12728     MOVE -1                     TO ADDRSL.
 12729     MOVE AL-UANON               TO ADDRSA.
 12730     GO TO 8200-SEND-DATAONLY.
 12731
 12732 6300-EXIT.
 12733     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 264
* EL689.cbl
 12735 6350-GET-CSR-DATA.
 12736     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 12737        GO TO 6350-EXIT
 12738     END-IF
 12739*    IF W-FILE-NOT-USED (11)
 12740*       GO TO 6350-EXIT
 12741*    END-IF
 12742     MOVE SPACES                 TO W-CNTL-KEY
 12743     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 12744     MOVE +0                     TO W-CNTL-SEQ-NO
 12745     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 12746     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 12747
 12748* EXEC CICS HANDLE CONDITION
 12749*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12750*         NOTFND     (6350-CNTL2-NOT-FOUND)
 12751*    END-EXEC
 12752*    MOVE '"$JI                  ! . #00012157' TO DFHEIV0
 12753     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12754     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12755     MOVE X'2E20233030303132313537' TO DFHEIV0(25:11)
 12756     CALL 'kxdfhei1' USING DFHEIV0
 12757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12758
 12759* EXEC CICS READ
 12760*         DATASET    (W-CNTL-FILE-ID)
 12761*         SET        (ADDRESS OF CONTROL-FILE)
 12762*         RIDFLD     (W-CNTL-KEY)
 12763*    END-EXEC
 12764*    MOVE '&"S        E          (   #00012161' TO DFHEIV0
 12765     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12766     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12767     MOVE X'2020233030303132313631' TO DFHEIV0(25:11)
 12768     CALL 'kxdfhei1' USING DFHEIV0,
 12769           W-CNTL-FILE-ID,
 12770           DFHEIV20,
 12771           DFHEIV99,
 12772           W-CNTL-KEY,
 12773           DFHEIV99,
 12774           DFHEIV99,
 12775           DFHEIV99
 12776     SET ADDRESS OF CONTROL-FILE TO
 12777         DFHEIV20
 12778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12779     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 12780     GO TO 6350-EXIT
 12781     .
 12782 6350-CNTL2-NOT-FOUND.
 12783     MOVE ER-9299                TO EMI-ERROR.
 12784     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12785     MOVE -1                     TO MAINTL.
 12786     MOVE AL-UANON               TO MAINTA.
 12787     GO TO 8200-SEND-DATAONLY.
 12788 6350-EXIT.
 12789     EXIT.
 12790 6400-GET-PENDING-DATA.
 12791
 12792     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 265
* EL689.cbl
 12793        AND (PI-CREATE-LABELS)
 12794        AND (NOT PI-689-LABELS-OVERRIDEN)
 12795        CONTINUE
 12796     ELSE
 12797        IF PI-689-DATA-SOURCE = '4'
 12798           CONTINUE
 12799        ELSE
 12800           IF W-FILE-NOT-USED (9)
 12801              GO TO 6400-EXIT
 12802           END-IF
 12803        END-IF
 12804     END-IF
 12805     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 12806         MOVE ER-9327            TO EMI-ERROR
 12807         MOVE -1                 TO MAINTL
 12808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12809         GO TO 6400-EXIT.
 12810
 12811 6400-READ-PNDB-ONLY.
 12812
 12813
 12814* EXEC CICS HANDLE CONDITION
 12815*         NOTOPEN (8060-PNDB-NOT-OPEN)
 12816*         NOTFND  (8070-PNDB-NOT-FOUND)
 12817*    END-EXEC.
 12818*    MOVE '"$JI                  ! / #00012200' TO DFHEIV0
 12819     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12821     MOVE X'2F20233030303132323030' TO DFHEIV0(25:11)
 12822     CALL 'kxdfhei1' USING DFHEIV0
 12823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12824
 12825
 12826
 12827* EXEC CICS READ
 12828*         DATASET (W-PNDB-FILE-ID)
 12829*         SET     (ADDRESS OF PENDING-BUSINESS)
 12830*         RIDFLD  (W-PNDB-KEY)
 12831*    END-EXEC.
 12832*    MOVE '&"S        E          (   #00012205' TO DFHEIV0
 12833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12835     MOVE X'2020233030303132323035' TO DFHEIV0(25:11)
 12836     CALL 'kxdfhei1' USING DFHEIV0,
 12837           W-PNDB-FILE-ID,
 12838           DFHEIV20,
 12839           DFHEIV99,
 12840           W-PNDB-KEY,
 12841           DFHEIV99,
 12842           DFHEIV99,
 12843           DFHEIV99
 12844     SET ADDRESS OF PENDING-BUSINESS TO
 12845         DFHEIV20
 12846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12847
 12848
 12849     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 12850
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 266
* EL689.cbl
 12851     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 12852         MOVE PB-SV-CARRIER      TO PB-CARRIER
 12853                                    PI-689-CARRIER
 12854         MOVE PB-SV-GROUPING     TO PB-GROUPING
 12855                                    PI-689-GROUPING
 12856         MOVE PB-SV-STATE        TO PB-STATE
 12857                                    PI-689-STATE
 12858         MOVE PB-CONTROL-BY-ACCOUNT
 12859                                 TO W-CERT-KEY
 12860                                    W-MAIL-KEY
 12861                                    W-ACCT-KEY
 12862         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 12863         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 12864         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 12865
 12866 6400-ONLY-STOP.
 12867
 12868     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 12869
 12870     IF  NOT PB-ISSUE
 12871         GO TO 6400-CANCEL.
 12872
 12873     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 12874     MOVE SPACES                 TO DC-OPTION-CODE.
 12875     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12876
 12877     IF  NO-CONVERSION-ERROR
 12878         MOVE DC-GREG-DATE-1-EDIT
 12879                                 TO W-VG-TEXT (110).
 12880
 12881     MOVE PB-I-AGE               TO W-EDIT-3-0.
 12882     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 12883     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 12884     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 12885     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 12886     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 12887     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 12888     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 12889     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 12890     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 12891     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 12892     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 12893     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 12894     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 12895     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 12896     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 12897     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 12898     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 12899     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 12900     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 12901
 12902     COMPUTE W-DIFFERENCE
 12903         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 12904
 12905     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12906     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 12907
 12908     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 267
* EL689.cbl
 12909         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 12910
 12911     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12912     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 12913
 12914 6400-CANCEL.
 12915
 12916     IF  NOT PB-CANCELLATION
 12917         GO TO 6400-EXIT.
 12918
 12919     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 12920                                 TO DC-BIN-DATE-1.
 12921     MOVE SPACES                 TO DC-OPTION-CODE.
 12922     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12923
 12924     IF  NO-CONVERSION-ERROR
 12925         MOVE DC-GREG-DATE-1-EDIT
 12926                                 TO W-VG-TEXT (117).
 12927
 12928     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 12929     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 12930     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 12931     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 12932     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 12933     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 12934     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 12935     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 12936     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 12937     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 12938
 12939     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 12940        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 12941     END-IF
 12942     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 12943     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 12944     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 12945     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 12946        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 12947     END-IF
 12948     MOVE SPACES                 TO DC-OPTION-CODE
 12949     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 12950
 12951     IF NO-CONVERSION-ERROR
 12952        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 12953     END-IF
 12954
 12955     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 12956                           - PB-C-LF-CANCEL-AMT.
 12957
 12958     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12959     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 12960
 12961     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 12962                           - PB-C-AH-CANCEL-AMT.
 12963
 12964     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12965     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 12966
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 268
* EL689.cbl
 12967 6400-EXIT.
 12968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 269
* EL689.cbl
 12970 6450-GET-CERT-DATA.
 12971     IF  W-FILE-NOT-USED (8)
 12972         GO TO 6450-EXIT.
 12973
 12974     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 12975         MOVE ER-9327            TO EMI-ERROR
 12976         MOVE -1                 TO MAINTL
 12977         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12978         GO TO 6450-EXIT.
 12979
 12980 6450-READ-CERT-ONLY.
 12981
 12982
 12983* EXEC CICS HANDLE CONDITION
 12984*         NOTOPEN (8030-CERT-NOT-OPEN)
 12985*         NOTFND  (8035-CERT-NOT-FOUND)
 12986*    END-EXEC.
 12987*    MOVE '"$JI                  ! 0 #00012344' TO DFHEIV0
 12988     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12990     MOVE X'3020233030303132333434' TO DFHEIV0(25:11)
 12991     CALL 'kxdfhei1' USING DFHEIV0
 12992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12993
 12994
 12995
 12996* EXEC CICS READ
 12997*         DATASET (W-CERT-FILE-ID)
 12998*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 12999*         RIDFLD  (W-CERT-KEY)
 13000*    END-EXEC.
 13001*    MOVE '&"S        E          (   #00012349' TO DFHEIV0
 13002     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13004     MOVE X'2020233030303132333439' TO DFHEIV0(25:11)
 13005     CALL 'kxdfhei1' USING DFHEIV0,
 13006           W-CERT-FILE-ID,
 13007           DFHEIV20,
 13008           DFHEIV99,
 13009           W-CERT-KEY,
 13010           DFHEIV99,
 13011           DFHEIV99,
 13012           DFHEIV99
 13013     SET ADDRESS OF CERTIFICATE-MASTER TO
 13014         DFHEIV20
 13015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13016
 13017
 13018     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 13019
 13020 6450-ONLY-STOP.
 13021
 13022     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 13023
 13024     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 13025
 13026     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13027     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 270
* EL689.cbl
 13028     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13029     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13030     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 13031
 13032     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13033     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13034     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13035     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13036     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 13037
 13038     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13039     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13040     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13041     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13042     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13043     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 13044
 13045     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13046     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13047     MOVE SPACES                 TO W-NAME-MIDDLE.
 13048     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13049     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 13050
 13051     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 13052     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 13053
 13054     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13055     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13056     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13057     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13058     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 13059                                    W-LABEL-JOINT-NAME.
 13060
 13061     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13062     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13063     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13064     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13065     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 13066
 13067     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13068     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13069     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13070     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13071     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13072     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 13073
 13074     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13075     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13076     MOVE SPACES                 TO W-NAME-MIDDLE.
 13077     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13078     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 13079
 13080     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 13081     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 13082
 13083     COMPUTE W-WORK-AMOUNT
 13084         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 13085     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 271
* EL689.cbl
 13086     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 13087     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 13088     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 13089
 13090     IF  CM-SEX-FEMAL
 13091         MOVE 'MS.'              TO W-VG-TEXT (96)
 13092
 13093     ELSE
 13094         MOVE 'MR.'              TO W-VG-TEXT (96).
 13095
 13096     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 13097                                 TO W-VG-TEXT (70).
 13098     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 13099     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 13100     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 13101     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 13102     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 13103     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 13104     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 13105     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 13106     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 13107     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 13108     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 13109     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 13110     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 13111     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 13112     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 13113     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 13114     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 13115     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 13116     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 13117     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13118     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 13119     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13120     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 13121     IF PI-689-DATA-SOURCE NOT = '4'
 13122     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 13123        + CM-AH-ITD-CANCEL-AMT
 13124     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13125     IF CM-NH-INT-ON-REFS NOT NUMERIC
 13126        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 13127     END-IF
 13128     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 13129     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13130     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 13131     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 13132        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 13133     END-IF
 13134     MOVE SPACES                 TO DC-OPTION-CODE
 13135     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13136
 13137     IF NO-CONVERSION-ERROR
 13138        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13139     END-IF
 13140     END-IF
 13141     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 13142     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 13143     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 272
* EL689.cbl
 13144
 13145     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 13146     MOVE SPACES                 TO DC-OPTION-CODE.
 13147     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13148
 13149     IF  NO-CONVERSION-ERROR
 13150         MOVE DC-GREG-DATE-1-EDIT
 13151                                 TO W-VG-TEXT (81).
 13152
 13153     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 13154     MOVE SPACES                 TO DC-OPTION-CODE.
 13155     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13156
 13157     IF  NO-CONVERSION-ERROR
 13158         MOVE DC-GREG-DATE-1-EDIT
 13159                                 TO W-VG-TEXT (82).
 13160
 13161     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13162     MOVE SPACES                 TO DC-OPTION-CODE.
 13163     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13164
 13165     IF  NO-CONVERSION-ERROR
 13166         MOVE DC-GREG-DATE-1-EDIT
 13167                                 TO W-VG-TEXT (74).
 13168
 13169     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13170
 13171     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 13172         MOVE CM-PMT-EXTENSION-DAYS
 13173                                 TO DC-ELAPSED-DAYS
 13174     ELSE
 13175         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 13176
 13177     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13178     MOVE '6'                    TO DC-OPTION-CODE.
 13179     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13180
 13181     IF  NO-CONVERSION-ERROR
 13182         MOVE DC-GREG-DATE-1-EDIT
 13183                                 TO W-VG-TEXT (75).
 13184
 13185     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13186     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13187     MOVE '6'                    TO DC-OPTION-CODE.
 13188     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13189
 13190     IF  NO-CONVERSION-ERROR
 13191         MOVE DC-GREG-DATE-1-EDIT
 13192                                 TO W-VG-TEXT (76).
 13193
 13194 6450-EXIT.
 13195     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 273
* EL689.cbl
 13197 6500-GET-ACCOUNT-DATA.
 13198
 13199     IF  ADDRSI EQUAL '1'
 13200             AND
 13201         PI-CREATE-LABELS
 13202             AND
 13203         NOT PI-689-LABELS-OVERRIDEN
 13204         NEXT SENTENCE
 13205     ELSE
 13206         IF  W-FILE-NOT-USED (6)
 13207             GO TO 6500-EXIT
 13208         END-IF
 13209     END-IF.
 13210
 13211 6500-READ-ACCT-ONLY.
 13212
 13213     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 13214         MOVE ER-9327            TO EMI-ERROR
 13215         MOVE -1                 TO MAINTL
 13216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13217         GO TO 6500-EXIT.
 13218
 13219
 13220* EXEC CICS HANDLE CONDITION
 13221*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 13222*         NOTFND     (6500-ACCT-NOT-FOUND)
 13223*         ENDFILE    (6500-ONLY-STOP)
 13224*    END-EXEC.
 13225*    MOVE '"$JI''                 ! 1 #00012556' TO DFHEIV0
 13226     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 13227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13228     MOVE X'3120233030303132353536' TO DFHEIV0(25:11)
 13229     CALL 'kxdfhei1' USING DFHEIV0
 13230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13231
 13232
 13233
 13234* EXEC CICS STARTBR
 13235*         RIDFLD     (W-ACCT-KEY)
 13236*         DATASET    (W-ACCT-FILE-ID)
 13237*         KEYLENGTH  (20)
 13238*         GENERIC
 13239*    END-EXEC.
 13240     MOVE 20
 13241       TO DFHEIV11
 13242     MOVE 0
 13243       TO DFHEIV12
 13244*    MOVE '&,   KG    G          &   #00012562' TO DFHEIV0
 13245     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13246     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13247     MOVE X'2020233030303132353632' TO DFHEIV0(25:11)
 13248     CALL 'kxdfhei1' USING DFHEIV0,
 13249           W-ACCT-FILE-ID,
 13250           W-ACCT-KEY,
 13251           DFHEIV11,
 13252           DFHEIV12,
 13253           DFHEIV99
 13254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 274
* EL689.cbl
 13255
 13256
 13257     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 13258     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 13259
 13260 6500-READNEXT.
 13261
 13262
 13263* EXEC CICS READNEXT
 13264*         DATASET    (W-ACCT-FILE-ID)
 13265*         SET        (ADDRESS OF ACCOUNT-MASTER)
 13266*         RIDFLD     (W-ACCT-KEY)
 13267*    END-EXEC.
 13268     MOVE 0
 13269       TO DFHEIV11
 13270*    MOVE '&.S                   )   #00012574' TO DFHEIV0
 13271     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13272     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13273     MOVE X'2020233030303132353734' TO DFHEIV0(25:11)
 13274     CALL 'kxdfhei1' USING DFHEIV0,
 13275           W-ACCT-FILE-ID,
 13276           DFHEIV20,
 13277           DFHEIV99,
 13278           W-ACCT-KEY,
 13279           DFHEIV99,
 13280           DFHEIV11,
 13281           DFHEIV99,
 13282           DFHEIV99
 13283     SET ADDRESS OF ACCOUNT-MASTER TO
 13284         DFHEIV20
 13285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13286
 13287
 13288     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 13289         IF  PRIOR-MATCH-ACCT-PKEY
 13290             CONTINUE
 13291*            GO TO 6500-ONLY-STOP
 13292         ELSE
 13293             IF  W-FILE-NOT-USED (6)
 13294                 PERFORM 6500-ENDBR
 13295                 GO TO 6500-EXIT
 13296             ELSE
 13297                 GO TO 6500-ACCT-NOT-FOUND
 13298             END-IF
 13299         END-IF
 13300     ELSE
 13301         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 13302         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 13303         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 13304         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 13305         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 13306         MOVE AM-NAME              TO WS-SAV-AM-NAME
 13307         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 13308         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 13309         MOVE SPACES               TO WS-SAV-AM-CITY
 13310*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 13311         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13312            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 275
* EL689.cbl
 13313         END-STRING
 13314         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 13315         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 13316         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 13317         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 13318         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 13319         GO TO 6500-READNEXT
 13320     END-IF
 13321     .
 13322 6500-ONLY-STOP.
 13323
 13324     IF  NOT PI-NO-CARRIER-SECURITY
 13325             AND
 13326         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 13327         MOVE -1                 TO CARRIERL
 13328         MOVE AL-UANON           TO CARRIERA
 13329         MOVE ER-9095            TO EMI-ERROR
 13330         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13331         PERFORM 6500-ENDBR
 13332         GO TO 8200-SEND-DATAONLY.
 13333
 13334     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13335     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 13336     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 13337     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 13338     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 13339
 13340     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 13341     MOVE SPACES                 TO W-LABEL-ZIP (5).
 13342
 13343     IF  SAVE-AM-CANADIAN-POST-CODE
 13344         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 13345                                 TO W-CANADIAN-POSTAL-CODES
 13346         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13347         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13348         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13349                                    W-LAB-CAN-FILLER (5)
 13350     ELSE
 13351         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13352
 13353         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13354             MOVE '-'            TO W-LABEL-DASH (5)
 13355             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13356         ELSE
 13357             MOVE SPACES         TO W-LABEL-DASH (5)
 13358                                    W-LABEL-2ND-ZIP (5).
 13359
 13360     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13361
 13362     IF  ADDRSI EQUAL '1'
 13363             AND
 13364         PI-CREATE-LABELS
 13365             AND
 13366         NOT PI-689-LABELS-OVERRIDEN
 13367         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13368                                    W-VG-TEXT (40)
 13369         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13370                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 276
* EL689.cbl
 13371         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13372                                    W-VG-TEXT (42)
 13373         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13374                                    W-VG-TEXT (43)
 13375         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13376                                    W-VG-TEXT (44)
 13377         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13378                                    W-VG-TEXT (45)
 13379         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13380         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13381         SET W-RG-NDX UP BY +1
 13382     ELSE
 13383         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 13384         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 13385         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 13386         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 13387         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 13388         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 13389
 13390     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 13391             OR
 13392         WS-SAV-AM-TEL-NO EQUAL ZEROS
 13393         MOVE SPACES             TO W-VG-TEXT (46)
 13394     ELSE
 13395         MOVE ZEROS                  TO W-PHONE-IN
 13396         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 13397         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 13398         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 13399         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 13400
 13401     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 13402        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 13403     ELSE
 13404        MOVE SPACES                   TO W-VG-TEXT (47)
 13405     END-IF.
 13406     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 13407     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 13408                                 TO W-VG-TEXT (49)
 13409
 13410     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 13411     PERFORM 6500-ENDBR.
 13412
 13413     GO TO 6500-EXIT.
 13414
 13415 6500-ENDBR.
 13416
 13417     IF  W-ACCT-BROWSE-STARTED
 13418         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 13419
 13420* EXEC CICS ENDBR
 13421*            DATASET (W-ACCT-FILE-ID)
 13422*        END-EXEC
 13423     MOVE 0
 13424       TO DFHEIV11
 13425*    MOVE '&2                    $   #00012711' TO DFHEIV0
 13426     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13427     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13428     MOVE X'2020233030303132373131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 277
* EL689.cbl
 13429     CALL 'kxdfhei1' USING DFHEIV0,
 13430           W-ACCT-FILE-ID,
 13431           DFHEIV11,
 13432           DFHEIV99
 13433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13434     END-IF.
 13435
 13436 6500-ACCT-NOT-FOUND.
 13437
 13438     PERFORM 6500-ENDBR.
 13439
 13440     IF  DATASORI NOT EQUAL '1'
 13441         MOVE ER-0179            TO EMI-ERROR
 13442         GO TO 6500-EXIT.
 13443
 13444     MOVE ER-0179                TO EMI-ERROR.
 13445     MOVE -1                     TO MAINTL.
 13446     MOVE AL-UNBON               TO MAINTA.
 13447     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13448     GO TO 8200-SEND-DATAONLY.
 13449
 13450 6500-EXIT.
 13451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 278
* EL689.cbl
 13453 6600-GET-COMPENSATION-DATA.
 13454
 13455     IF  ADDRSI EQUAL '4'
 13456             AND
 13457         PI-CREATE-LABELS
 13458             AND
 13459         NOT PI-689-LABELS-OVERRIDEN
 13460         NEXT SENTENCE
 13461     ELSE
 13462         IF  W-FILE-NOT-USED (10)
 13463             GO TO 6600-EXIT.
 13464
 13465     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 13466         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 13467         GO TO 6600-START.
 13468
 13469     IF  PI-ZERO-CARRIER
 13470             OR
 13471         PI-ZERO-CAR-GROUP
 13472         MOVE ZEROS              TO W-COMP-CARRIER.
 13473
 13474     IF  PI-ZERO-GROUPING
 13475             OR
 13476         PI-ZERO-CAR-GROUP
 13477         MOVE ZEROS              TO W-COMP-GROUPING.
 13478
 13479     IF  W-FILE-NOT-USED (6)
 13480         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 13481         IF  EMI-ERROR EQUAL ER-0179
 13482             MOVE ER-9327        TO EMI-ERROR
 13483             MOVE -1             TO MAINTL
 13484             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13485             GO TO 6600-EXIT.
 13486
 13487     MOVE  'A'                   TO W-COMP-TYPE.
 13488
 13489     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 13490         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 13491                                 TO W-COMP-RESP-PERSON
 13492     ELSE
 13493         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13494
 13495     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 13496        (W-NDX > +10)
 13497            OR
 13498         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 13499     END-PERFORM
 13500
 13501     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 13502         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 13503     ELSE
 13504         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13505
 13506     PERFORM 6500-ENDBR.
 13507     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13508
 13509     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 13510         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 279
* EL689.cbl
 13511         MOVE -1                 TO MAINTL
 13512         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13513         GO TO 6600-EXIT.
 13514
 13515 6600-START.
 13516
 13517
 13518* EXEC CICS HANDLE CONDITION
 13519*         NOTOPEN (8080-COMP-NOT-OPEN)
 13520*         NOTFND  (6600-COMP-NOT-FOUND)
 13521*    END-EXEC.
 13522*    MOVE '"$JI                  ! 2 #00012797' TO DFHEIV0
 13523     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13525     MOVE X'3220233030303132373937' TO DFHEIV0(25:11)
 13526     CALL 'kxdfhei1' USING DFHEIV0
 13527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13528
 13529
 13530
 13531* EXEC CICS STARTBR
 13532*         RIDFLD  (W-COMP-KEY)
 13533*         DATASET (W-COMP-FILE-ID)
 13534*    END-EXEC.
 13535     MOVE 0
 13536       TO DFHEIV11
 13537*    MOVE '&,         G          &   #00012802' TO DFHEIV0
 13538     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13539     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13540     MOVE X'2020233030303132383032' TO DFHEIV0(25:11)
 13541     CALL 'kxdfhei1' USING DFHEIV0,
 13542           W-COMP-FILE-ID,
 13543           W-COMP-KEY,
 13544           DFHEIV99,
 13545           DFHEIV11,
 13546           DFHEIV99
 13547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13548
 13549
 13550     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 13551
 13552 6600-READNEXT.
 13553
 13554
 13555* EXEC CICS READNEXT
 13556*         DATASET (W-COMP-FILE-ID)
 13557*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13558*         RIDFLD  (W-COMP-KEY)
 13559*    END-EXEC.
 13560     MOVE 0
 13561       TO DFHEIV11
 13562*    MOVE '&.S                   )   #00012811' TO DFHEIV0
 13563     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13564     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13565     MOVE X'2020233030303132383131' TO DFHEIV0(25:11)
 13566     CALL 'kxdfhei1' USING DFHEIV0,
 13567           W-COMP-FILE-ID,
 13568           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 280
* EL689.cbl
 13569           DFHEIV99,
 13570           W-COMP-KEY,
 13571           DFHEIV99,
 13572           DFHEIV11,
 13573           DFHEIV99,
 13574           DFHEIV99
 13575     SET ADDRESS OF COMPENSATION-MASTER TO
 13576         DFHEIV20
 13577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13578
 13579
 13580     IF CO-CONTROL-PRIMARY
 13581           NOT = W-COMP-SAVE-KEY
 13582        GO TO 6600-COMP-NOT-FOUND.
 13583
 13584     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13585     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 13586                                    W-VG-TEXT (140).
 13587     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13588     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13589     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13590*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13591     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13592        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13593     END-STRING
 13594
 13595     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13596
 13597     IF  CO-CANADIAN-POST-CODE
 13598         MOVE CO-CANADIAN-POSTAL-CODE
 13599                                 TO W-CANADIAN-POSTAL-CODES
 13600         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13601         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13602         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13603                                    W-LAB-CAN-FILLER (6)
 13604     ELSE
 13605         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13606
 13607         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13608             MOVE '-'            TO W-LABEL-DASH (6)
 13609             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13610         ELSE
 13611             MOVE SPACES         TO W-LABEL-DASH (6)
 13612                                    W-LABEL-2ND-ZIP (6).
 13613
 13614     IF  CO-TELEPHONE NOT NUMERIC
 13615             OR
 13616         CO-TELEPHONE = ZEROS
 13617         MOVE SPACES             TO W-VG-TEXT (147)
 13618     ELSE
 13619         MOVE ZEROS              TO W-PHONE-IN
 13620         MOVE CO-AREA-CODE       TO W-PO-AREA
 13621         MOVE CO-PREFIX          TO W-PO-PFX
 13622         MOVE CO-PHONE           TO W-PO-SFX
 13623         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 13624
 13625     IF (CO-FAXNO NOT NUMERIC)
 13626        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 281
* EL689.cbl
 13627        MOVE SPACES              TO W-VG-TEXT (182)
 13628     ELSE
 13629        MOVE ZEROS               TO W-PHONE-IN
 13630        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 13631        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 13632        MOVE CO-FAX-PHONE        TO W-PO-SFX
 13633        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 13634     END-IF
 13635     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 13636        MOVE SPACES              TO W-VG-TEXT (183)
 13637     ELSE
 13638        EVALUATE CO-GA-STATUS-CODE
 13639           WHEN 'A'
 13640              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 13641           WHEN 'I'
 13642              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 13643           WHEN 'P'
 13644              MOVE 'PENDING'     TO W-VG-TEXT (183)
 13645        END-EVALUATE
 13646     END-IF
 13647     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 13648        MOVE SPACES              TO W-VG-TEXT (181)
 13649     ELSE
 13650        EVALUATE CO-BILL-SW
 13651           WHEN 'B'
 13652              MOVE 'BILLED'      TO W-VG-TEXT (181)
 13653           WHEN 'R'
 13654              MOVE 'REMIT'       TO W-VG-TEXT (181)
 13655           WHEN 'T'
 13656              MOVE 'T'           TO W-VG-TEXT (181)
 13657           WHEN 'S'
 13658              MOVE 'S'           TO W-VG-TEXT (181)
 13659        END-EVALUATE
 13660     END-IF
 13661     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13662
 13663     IF  ADDRSI EQUAL '4'
 13664             AND
 13665         PI-CREATE-LABELS
 13666             AND
 13667         NOT PI-689-LABELS-OVERRIDEN
 13668         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13669                                    W-VG-TEXT (141)
 13670         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13671                                    W-VG-TEXT (142)
 13672         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13673                                    W-VG-TEXT (143)
 13674         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13675                                    W-VG-TEXT (144)
 13676         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13677                                    W-VG-TEXT (145)
 13678         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13679                                    W-VG-TEXT (146)
 13680         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13681         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13682         SET W-RG-NDX UP BY +1
 13683     ELSE
 13684         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 282
* EL689.cbl
 13685         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 13686         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 13687         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 13688         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 13689         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 13690
 13691     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 13692
 13693     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 13694     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 13695     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 13696
 13697     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 13698     MOVE '3'                    TO DC-OPTION-CODE.
 13699     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13700
 13701     IF  NO-CONVERSION-ERROR
 13702         MOVE DC-GREG-DATE-1-ALPHA
 13703                                 TO W-VG-TEXT (149).
 13704
 13705     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 13706     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 13707
 13708     PERFORM 6600-ENDBR.
 13709     GO TO 6600-EXIT.
 13710
 13711 6600-ENDBR.
 13712
 13713     IF  W-COMP-BROWSE-STARTED
 13714         MOVE 'N'                      TO W-COMP-BROWSE-SW
 13715
 13716* EXEC CICS ENDBR
 13717*             DATASET(W-COMP-FILE-ID)
 13718*        END-EXEC.
 13719     MOVE 0
 13720       TO DFHEIV11
 13721*    MOVE '&2                    $   #00012952' TO DFHEIV0
 13722     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13723     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13724     MOVE X'2020233030303132393532' TO DFHEIV0(25:11)
 13725     CALL 'kxdfhei1' USING DFHEIV0,
 13726           W-COMP-FILE-ID,
 13727           DFHEIV11,
 13728           DFHEIV99
 13729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13730
 13731
 13732 6600-COMP-NOT-FOUND.
 13733
 13734     PERFORM 6600-ENDBR.
 13735
 13736     IF ADDRSL GREATER ZERO
 13737         IF ADDRSI = '4'
 13738            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 13739                MOVE ER-7378                TO EMI-ERROR
 13740                MOVE -1                     TO TYPEL
 13741                MOVE AL-UNBON               TO TYPEA
 13742                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 283
* EL689.cbl
 13743                GO TO 8200-SEND-DATAONLY
 13744            ELSE
 13745                MOVE ER-2114                TO EMI-ERROR
 13746                MOVE -1                     TO ADDRSL
 13747                MOVE AL-UNBON               TO ADDRSA
 13748                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13749                GO TO 8200-SEND-DATAONLY.
 13750
 13751 6600-EXIT.
 13752     EXIT.
 13753 6620-GET-G-DATA.
 13754
 13755     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 13756
 13757     IF  CO-RPTCD2 GREATER THAN SPACES
 13758         MOVE SPACES             TO W-COMP-RESP-PERSON
 13759         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 13760         MOVE +10                TO W-CWA-NDX
 13761         PERFORM 6622-FIND-LAST-NON-SPACE
 13762         SET W-COMP-NDX          TO +10
 13763         PERFORM 6625-FILL-IN-RESP-PERSON.
 13764         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 13765
 13766     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 13767     MOVE 'G'                    TO W-COMP-TYPE.
 13768     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13769
 13770
 13771* EXEC CICS RESETBR
 13772*         RIDFLD  (W-COMP-KEY)
 13773*         DATASET (W-COMP-FILE-ID)
 13774*    END-EXEC.
 13775     MOVE 0
 13776       TO DFHEIV11
 13777*    MOVE '&4         G          &   #00012994' TO DFHEIV0
 13778     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 13779     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13780     MOVE X'2020233030303132393934' TO DFHEIV0(25:11)
 13781     CALL 'kxdfhei1' USING DFHEIV0,
 13782           W-COMP-FILE-ID,
 13783           W-COMP-KEY,
 13784           DFHEIV99,
 13785           DFHEIV11,
 13786           DFHEIV99
 13787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13788
 13789
 13790
 13791* EXEC CICS READNEXT
 13792*         DATASET (W-COMP-FILE-ID)
 13793*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13794*         RIDFLD  (W-COMP-KEY)
 13795*    END-EXEC.
 13796     MOVE 0
 13797       TO DFHEIV11
 13798*    MOVE '&.S                   )   #00012999' TO DFHEIV0
 13799     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13800     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 284
* EL689.cbl
 13801     MOVE X'2020233030303132393939' TO DFHEIV0(25:11)
 13802     CALL 'kxdfhei1' USING DFHEIV0,
 13803           W-COMP-FILE-ID,
 13804           DFHEIV20,
 13805           DFHEIV99,
 13806           W-COMP-KEY,
 13807           DFHEIV99,
 13808           DFHEIV11,
 13809           DFHEIV99,
 13810           DFHEIV99
 13811     SET ADDRESS OF COMPENSATION-MASTER TO
 13812         DFHEIV20
 13813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13814
 13815
 13816     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 13817         GO TO 6620-EXIT.
 13818
 13819     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13820     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 13821     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13822     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13823     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13824*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13825     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13826        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13827     END-STRING
 13828
 13829     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13830
 13831     IF  CO-CANADIAN-POST-CODE
 13832         MOVE CO-CANADIAN-POSTAL-CODE
 13833                                 TO W-CANADIAN-POSTAL-CODES
 13834         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13835         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13836         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13837                                    W-LAB-CAN-FILLER (6)
 13838     ELSE
 13839         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13840         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13841             MOVE '-'            TO W-LABEL-DASH (6)
 13842             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13843         ELSE
 13844             MOVE SPACES         TO W-LABEL-DASH (6)
 13845                                    W-LABEL-2ND-ZIP (6).
 13846
 13847     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13848
 13849     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 13850     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 13851     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 13852     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 13853     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 13854     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 13855
 13856 6620-EXIT.
 13857     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 285
* EL689.cbl
 13859 6622-FIND-LAST-NON-SPACE.
 13860
 13861     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 13862         SUBTRACT +1 FROM W-CWA-NDX
 13863         GO TO 6622-FIND-LAST-NON-SPACE.
 13864
 13865 6622-EXIT.
 13866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 286
* EL689.cbl
 13868 6625-FILL-IN-RESP-PERSON.
 13869
 13870     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 13871     SET W-COMP-NDX DOWN BY +1.
 13872     SUBTRACT +1 FROM W-CWA-NDX.
 13873
 13874     IF  W-CWA-NDX GREATER THAN ZEROS
 13875         GO TO 6625-FILL-IN-RESP-PERSON.
 13876
 13877 6625-EXIT.
 13878     EXIT.
 13879 6626-GET-B-DATA.
 13880     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 13881     IF W-FILE-USED (8)
 13882        PERFORM 6450-READ-CERT-ONLY
 13883        IF W-CERT-FOUND
 13884           MOVE CM-BENEFICIARY (1:10)
 13885                                 TO W-COMP-RESP-PERSON
 13886        ELSE
 13887           MOVE SPACES           TO W-COMP-RESP-PERSON
 13888           GO TO 6626-EXIT
 13889        END-IF
 13890     ELSE
 13891        MOVE CM-BENEFICIARY (1:10)
 13892                                 TO W-COMP-RESP-PERSON
 13893     END-IF
 13894     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 13895     MOVE 'B'                    TO W-COMP-TYPE
 13896     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 13897
 13898
 13899* EXEC CICS RESETBR
 13900*         RIDFLD  (W-COMP-KEY)
 13901*         DATASET (W-COMP-FILE-ID)
 13902*    END-EXEC.
 13903     MOVE 0
 13904       TO DFHEIV11
 13905*    MOVE '&4         G          &   #00013087' TO DFHEIV0
 13906     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 13907     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13908     MOVE X'2020233030303133303837' TO DFHEIV0(25:11)
 13909     CALL 'kxdfhei1' USING DFHEIV0,
 13910           W-COMP-FILE-ID,
 13911           W-COMP-KEY,
 13912           DFHEIV99,
 13913           DFHEIV11,
 13914           DFHEIV99
 13915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13916
 13917
 13918
 13919* EXEC CICS READNEXT
 13920*         DATASET (W-COMP-FILE-ID)
 13921*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13922*         RIDFLD  (W-COMP-KEY)
 13923*    END-EXEC.
 13924     MOVE 0
 13925       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 287
* EL689.cbl
 13926*    MOVE '&.S                   )   #00013092' TO DFHEIV0
 13927     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13928     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13929     MOVE X'2020233030303133303932' TO DFHEIV0(25:11)
 13930     CALL 'kxdfhei1' USING DFHEIV0,
 13931           W-COMP-FILE-ID,
 13932           DFHEIV20,
 13933           DFHEIV99,
 13934           W-COMP-KEY,
 13935           DFHEIV99,
 13936           DFHEIV11,
 13937           DFHEIV99,
 13938           DFHEIV99
 13939     SET ADDRESS OF COMPENSATION-MASTER TO
 13940         DFHEIV20
 13941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13942
 13943
 13944     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 13945         GO TO 6626-EXIT.
 13946
 13947     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13948     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 13949     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13950     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13951     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13952*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13953     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13954        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13955     END-STRING
 13956
 13957     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13958
 13959     IF  CO-CANADIAN-POST-CODE
 13960         MOVE CO-CANADIAN-POSTAL-CODE
 13961                                 TO W-CANADIAN-POSTAL-CODES
 13962         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13963         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13964         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13965                                    W-LAB-CAN-FILLER (6)
 13966     ELSE
 13967         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13968         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13969             MOVE '-'            TO W-LABEL-DASH (6)
 13970             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13971         ELSE
 13972             MOVE SPACES         TO W-LABEL-DASH (6)
 13973                                    W-LABEL-2ND-ZIP (6).
 13974
 13975     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13976
 13977     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 13978     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 13979     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 13980     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 13981     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 13982     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 13983
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 288
* EL689.cbl
 13984 6626-EXIT.
 13985     EXIT.
 13986 6630-GET-CSR-NAME.
 13987
 13988     MOVE SPACES                 TO W-CNTL-KEY.
 13989     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 13990     MOVE +0                     TO W-CNTL-SEQ-NO.
 13991     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 13992     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 13993
 13994
 13995* EXEC CICS HANDLE CONDITION
 13996*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13997*         NOTFND     (6630-CNTL2-NOT-FOUND)
 13998*    END-EXEC.
 13999*    MOVE '"$JI                  ! 3 #00013148' TO DFHEIV0
 14000     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14002     MOVE X'3320233030303133313438' TO DFHEIV0(25:11)
 14003     CALL 'kxdfhei1' USING DFHEIV0
 14004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14005
 14006
 14007
 14008* EXEC CICS READ
 14009*         DATASET    (W-CNTL-FILE-ID)
 14010*         SET        (ADDRESS OF CONTROL-FILE)
 14011*         RIDFLD     (W-CNTL-KEY)
 14012*    END-EXEC.
 14013*    MOVE '&"S        E          (   #00013153' TO DFHEIV0
 14014     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14015     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14016     MOVE X'2020233030303133313533' TO DFHEIV0(25:11)
 14017     CALL 'kxdfhei1' USING DFHEIV0,
 14018           W-CNTL-FILE-ID,
 14019           DFHEIV20,
 14020           DFHEIV99,
 14021           W-CNTL-KEY,
 14022           DFHEIV99,
 14023           DFHEIV99,
 14024           DFHEIV99
 14025     SET ADDRESS OF CONTROL-FILE TO
 14026         DFHEIV20
 14027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14028
 14029
 14030     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 14031     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 14032     GO TO 6630-EXIT.
 14033
 14034 6630-CNTL2-NOT-FOUND.
 14035
 14036*    MOVE ER-8965                TO EMI-ERROR.
 14037*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14038*    MOVE -1                     TO MAINTL.
 14039*    MOVE AL-UANON               TO MAINTA.
 14040*    GO TO 8200-SEND-DATAONLY
 14041     .
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 289
* EL689.cbl
 14042 6630-EXIT.
 14043     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 290
* EL689.cbl
 14045 6700-GET-MAIL-DATA.
 14046
 14047     IF  ADDRSI EQUAL '5'
 14048             AND
 14049         PI-CREATE-LABELS
 14050             AND
 14051         NOT PI-689-LABELS-OVERRIDEN
 14052         NEXT SENTENCE
 14053     ELSE
 14054         IF  W-FILE-NOT-USED (5)
 14055             GO TO 6700-EXIT.
 14056
 14057     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 14058         MOVE ER-9327            TO EMI-ERROR
 14059         MOVE -1                 TO MAINTL
 14060         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14061         GO TO 6700-EXIT.
 14062
 14063
 14064* EXEC CICS HANDLE CONDITION
 14065*         NOTOPEN (8090-MAIL-NOT-OPEN)
 14066*         NOTFND  (6700-MAIL-NOT-FOUND)
 14067*    END-EXEC.
 14068*    MOVE '"$JI                  ! 4 #00013192' TO DFHEIV0
 14069     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14071     MOVE X'3420233030303133313932' TO DFHEIV0(25:11)
 14072     CALL 'kxdfhei1' USING DFHEIV0
 14073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14074
 14075
 14076
 14077* EXEC CICS READ
 14078*         DATASET(W-MAIL-FILE-ID)
 14079*         SET    (ADDRESS OF MAILING-DATA)
 14080*         RIDFLD (W-MAIL-KEY)
 14081*    END-EXEC.
 14082*    MOVE '&"S        E          (   #00013197' TO DFHEIV0
 14083     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14084     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14085     MOVE X'2020233030303133313937' TO DFHEIV0(25:11)
 14086     CALL 'kxdfhei1' USING DFHEIV0,
 14087           W-MAIL-FILE-ID,
 14088           DFHEIV20,
 14089           DFHEIV99,
 14090           W-MAIL-KEY,
 14091           DFHEIV99,
 14092           DFHEIV99,
 14093           DFHEIV99
 14094     SET ADDRESS OF MAILING-DATA TO
 14095         DFHEIV20
 14096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14097
 14098
 14099     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 14100     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 14101     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 14102     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 291
* EL689.cbl
 14103
 14104     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14105     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 14106     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 14107     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 14108     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 14109*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 14110     STRING MA-CITY ' ' MA-ADDR-STATE
 14111        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14112     END-STRING
 14113
 14114     MOVE MA-ZIP                 TO W-WORK-ZIP.
 14115     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14116
 14117     IF  MA-CANADIAN-POST-CODE
 14118         MOVE MA-CANADIAN-POSTAL-CODE
 14119                                 TO W-CANADIAN-POSTAL-CODES
 14120         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14121         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14122         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14123                                    W-LAB-CAN-FILLER (6)
 14124     ELSE
 14125         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14126         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14127             MOVE '-'            TO W-LABEL-DASH (6)
 14128             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14129         ELSE
 14130             MOVE SPACES         TO W-LABEL-DASH (6)
 14131                                    W-LABEL-2ND-ZIP (6).
 14132
 14133     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14134
 14135     IF  ADDRSI EQUAL '5'
 14136             AND
 14137         PI-CREATE-LABELS
 14138             AND
 14139         NOT PI-689-LABELS-OVERRIDEN
 14140         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14141                                    W-VG-TEXT (31)
 14142         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14143                                    W-VG-TEXT (32)
 14144         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14145                                    W-VG-TEXT (33)
 14146         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14147                                    W-VG-TEXT (34)
 14148         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14149                                    W-VG-TEXT (35)
 14150         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14151                                    W-VG-TEXT (36)
 14152         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14153         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14154         SET W-RG-NDX UP BY +1
 14155     ELSE
 14156         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 14157         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 14158         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 14159         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 14160         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 292
* EL689.cbl
 14161         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 14162     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14163     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 14164     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 14165     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 14166     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 14167        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 14168     END-STRING
 14169
 14170     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 14171     MOVE SPACES                 TO W-LABEL-ZIP (5)
 14172
 14173     IF  MA-CB-CANADIAN-POST-CODE
 14174         MOVE MA-CB-CANADIAN-POSTAL-CODE
 14175                                 TO W-CANADIAN-POSTAL-CODES
 14176         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 14177         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 14178         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 14179                                    W-LAB-CAN-FILLER (5)
 14180     ELSE
 14181         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 14182         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14183             MOVE '-'            TO W-LABEL-DASH (5)
 14184             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 14185         ELSE
 14186             MOVE SPACES         TO W-LABEL-DASH (5)
 14187                                    W-LABEL-2ND-ZIP (5)
 14188         END-IF
 14189     END-IF
 14190     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 14191     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 14192     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 14193     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 14194     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 14195     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 14196     GO TO 6700-EXIT.
 14197
 14198 6700-MAIL-NOT-FOUND.
 14199
 14200     IF  ADDRSL GREATER ZERO
 14201         IF ADDRSI = '5'
 14202            MOVE ER-3000         TO EMI-ERROR
 14203            MOVE -1              TO ADDRSL
 14204            MOVE AL-UNBON        TO ADDRSA
 14205            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14206            GO TO 8200-SEND-DATAONLY.
 14207
 14208 6700-EXIT.
 14209     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 293
* EL689.cbl
 14211 6750-GET-LIFE-BENEFIT-DATA.
 14212
 14213     IF  W-FILE-NOT-USED (2)
 14214         GO TO 6750-EXIT.
 14215
 14216     MOVE SPACES                 TO W-CNTL-GEN2.
 14217
 14218     IF  DATASORI EQUAL '2'
 14219         IF  W-FILE-NOT-USED (8)
 14220             PERFORM 6450-READ-CERT-ONLY
 14221             IF  W-CERT-FOUND
 14222                 MOVE CM-LF-BENEFIT-CD
 14223                                 TO W-BEN-HOLD
 14224                                    W-CNTL-GEN2
 14225             ELSE
 14226                 NEXT SENTENCE
 14227         ELSE
 14228             MOVE CM-LF-BENEFIT-CD
 14229                                 TO W-BEN-HOLD
 14230                                    W-CNTL-GEN2
 14231     ELSE
 14232         IF  DATASORI EQUAL '4'
 14233             IF  W-FILE-NOT-USED (9)
 14234                 PERFORM 6400-READ-PNDB-ONLY
 14235                 IF  W-PNDB-FOUND
 14236                     IF  PI-689-TYPE = '1'
 14237                         MOVE PB-I-LF-BENEFIT-CD
 14238                                 TO W-BEN-HOLD
 14239                                    W-CNTL-GEN2
 14240                     ELSE
 14241                         MOVE PB-CI-LF-BENEFIT-CD
 14242                                 TO W-BEN-HOLD
 14243                                    W-CNTL-GEN2
 14244             ELSE
 14245                 NEXT SENTENCE
 14246         ELSE
 14247             IF  W-FILE-USED (8)
 14248                 MOVE CM-LF-BENEFIT-CD
 14249                                 TO W-BEN-HOLD
 14250                                    W-CNTL-GEN2
 14251             ELSE
 14252                 IF  W-FILE-USED (9)
 14253                     IF  PI-689-TYPE = '1'
 14254                         MOVE PB-I-LF-BENEFIT-CD
 14255                                 TO W-BEN-HOLD
 14256                                    W-CNTL-GEN2
 14257                     ELSE
 14258                         MOVE PB-CI-LF-BENEFIT-CD
 14259                                 TO W-BEN-HOLD
 14260                                    W-CNTL-GEN2.
 14261
 14262     IF  W-CNTL-GEN2 EQUAL SPACES
 14263         MOVE ER-9327            TO EMI-ERROR
 14264         MOVE -1                 TO MAINTL
 14265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14266         GO TO 6750-EXIT.
 14267
 14268     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 294
* EL689.cbl
 14269     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 14270     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14271
 14272
 14273* EXEC CICS HANDLE CONDITION
 14274*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14275*         NOTFND  (6750-EXIT)
 14276*    END-EXEC.
 14277*    MOVE '"$JI                  ! 5 #00013376' TO DFHEIV0
 14278     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14280     MOVE X'3520233030303133333736' TO DFHEIV0(25:11)
 14281     CALL 'kxdfhei1' USING DFHEIV0
 14282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14283
 14284
 14285
 14286* EXEC CICS READ
 14287*         DATASET (W-CNTL-FILE-ID)
 14288*         SET     (ADDRESS OF CONTROL-FILE)
 14289*         GTEQ
 14290*         RIDFLD  (W-CNTL-KEY)
 14291*    END-EXEC.
 14292*    MOVE '&"S        G          (   #00013381' TO DFHEIV0
 14293     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14295     MOVE X'2020233030303133333831' TO DFHEIV0(25:11)
 14296     CALL 'kxdfhei1' USING DFHEIV0,
 14297           W-CNTL-FILE-ID,
 14298           DFHEIV20,
 14299           DFHEIV99,
 14300           W-CNTL-KEY,
 14301           DFHEIV99,
 14302           DFHEIV99,
 14303           DFHEIV99
 14304     SET ADDRESS OF CONTROL-FILE TO
 14305         DFHEIV20
 14306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14307
 14308
 14309     MOVE 1                      TO W-NDX.
 14310
 14311 6750-LOOP.
 14312
 14313     IF  W-NDX = 9
 14314         GO TO 6750-EXIT.
 14315
 14316     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14317         ADD 1                   TO W-NDX
 14318         GO TO 6750-LOOP.
 14319
 14320     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14321         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14322                                 TO W-VG-TEXT (11).
 14323
 14324 6750-EXIT.
 14325     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 295
* EL689.cbl
 14327 6800-GET-A-H-BENEFIT-DATA.
 14328
 14329     IF  W-FILE-NOT-USED (3)
 14330         GO TO 6800-EXIT.
 14331
 14332     MOVE SPACES                 TO W-CNTL-GEN2.
 14333
 14334     IF  DATASORI EQUAL '2'
 14335         IF  W-FILE-NOT-USED (8)
 14336             PERFORM 6450-READ-CERT-ONLY
 14337             IF  W-CERT-FOUND
 14338                 MOVE CM-AH-BENEFIT-CD
 14339                                 TO W-BEN-HOLD
 14340                                    W-CNTL-GEN2
 14341             ELSE
 14342                 NEXT SENTENCE
 14343         ELSE
 14344             MOVE CM-AH-BENEFIT-CD
 14345                                 TO W-BEN-HOLD
 14346                                    W-CNTL-GEN2
 14347     ELSE
 14348         IF  DATASORI EQUAL '4'
 14349             IF  W-FILE-NOT-USED (9)
 14350                 PERFORM 6400-READ-PNDB-ONLY
 14351                 IF  W-PNDB-FOUND
 14352                     IF  PI-689-TYPE = '1'
 14353                         MOVE PB-I-AH-BENEFIT-CD
 14354                                 TO W-BEN-HOLD
 14355                                    W-CNTL-GEN2
 14356                     ELSE
 14357                         MOVE PB-CI-AH-BENEFIT-CD
 14358                                 TO W-BEN-HOLD
 14359                                    W-CNTL-GEN2
 14360             ELSE
 14361                 NEXT SENTENCE
 14362         ELSE
 14363             IF  W-FILE-USED (8)
 14364                 MOVE CM-AH-BENEFIT-CD
 14365                                 TO W-BEN-HOLD
 14366                                    W-CNTL-GEN2
 14367             ELSE
 14368                 IF  W-FILE-USED (9)
 14369                     IF  PI-689-TYPE = '1'
 14370                         MOVE PB-I-AH-BENEFIT-CD
 14371                                 TO W-BEN-HOLD
 14372                                    W-CNTL-GEN2
 14373                     ELSE
 14374                         MOVE PB-CI-AH-BENEFIT-CD
 14375                                 TO W-BEN-HOLD
 14376                                    W-CNTL-GEN2.
 14377
 14378     IF  W-CNTL-GEN2 EQUAL SPACES
 14379         MOVE ER-9327            TO EMI-ERROR
 14380         MOVE -1                 TO MAINTL
 14381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14382         GO TO 6800-EXIT.
 14383
 14384     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 296
* EL689.cbl
 14385     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 14386     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14387
 14388
 14389* EXEC CICS HANDLE CONDITION
 14390*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14391*         NOTFND  (6800-EXIT)
 14392*    END-EXEC.
 14393*    MOVE '"$JI                  ! 6 #00013467' TO DFHEIV0
 14394     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14396     MOVE X'3620233030303133343637' TO DFHEIV0(25:11)
 14397     CALL 'kxdfhei1' USING DFHEIV0
 14398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14399
 14400
 14401
 14402* EXEC CICS READ
 14403*         DATASET (W-CNTL-FILE-ID)
 14404*         SET     (ADDRESS OF CONTROL-FILE)
 14405*         RIDFLD  (W-CNTL-KEY)
 14406*         GTEQ
 14407*    END-EXEC.
 14408*    MOVE '&"S        G          (   #00013472' TO DFHEIV0
 14409     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14410     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14411     MOVE X'2020233030303133343732' TO DFHEIV0(25:11)
 14412     CALL 'kxdfhei1' USING DFHEIV0,
 14413           W-CNTL-FILE-ID,
 14414           DFHEIV20,
 14415           DFHEIV99,
 14416           W-CNTL-KEY,
 14417           DFHEIV99,
 14418           DFHEIV99,
 14419           DFHEIV99
 14420     SET ADDRESS OF CONTROL-FILE TO
 14421         DFHEIV20
 14422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14423
 14424
 14425     MOVE 1                      TO W-NDX.
 14426
 14427 6800-LOOP-AH.
 14428
 14429     IF  W-NDX = 9
 14430         GO TO 6800-EXIT.
 14431
 14432     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14433         ADD 1                   TO W-NDX
 14434         GO TO 6800-LOOP-AH.
 14435
 14436     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14437         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14438                                 TO W-VG-TEXT (15)
 14439         MOVE CF-BENEFIT-ALPHA (W-NDX)
 14440                                 TO W-BENEFIT-WORK
 14441         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 14442
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 297
* EL689.cbl
 14443 6800-EXIT.
 14444     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 298
* EL689.cbl
 14446 6850-GET-CHECK-DATA.
 14447
 14448     IF  ADDRSI EQUAL '6'
 14449             AND
 14450         PI-CREATE-LABELS
 14451             AND
 14452         NOT PI-689-LABELS-OVERRIDEN
 14453         NEXT SENTENCE
 14454     ELSE
 14455         IF  W-FILE-NOT-USED (12)
 14456             GO TO 6850-EXIT.
 14457
 14458     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 14459         MOVE ER-9327            TO EMI-ERROR
 14460         MOVE -1                 TO MAINTL
 14461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14462         GO TO 6850-EXIT.
 14463
 14464
 14465* EXEC CICS HANDLE CONDITION
 14466*         NOTOPEN (8045-CHEK-NOT-OPEN)
 14467*         NOTFND  (6850-CHEK-NOT-FOUND)
 14468*    END-EXEC.
 14469*    MOVE '"$JI                  ! 7 #00013518' TO DFHEIV0
 14470     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14471     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14472     MOVE X'3720233030303133353138' TO DFHEIV0(25:11)
 14473     CALL 'kxdfhei1' USING DFHEIV0
 14474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14475
 14476
 14477
 14478* EXEC CICS READ
 14479*         DATASET (W-CHEK-FILE-ID)
 14480*         SET     (ADDRESS OF CHECK-RECORDS)
 14481*         RIDFLD  (W-CHEK-KEY)
 14482*    END-EXEC.
 14483*    MOVE '&"S        E          (   #00013523' TO DFHEIV0
 14484     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14485     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14486     MOVE X'2020233030303133353233' TO DFHEIV0(25:11)
 14487     CALL 'kxdfhei1' USING DFHEIV0,
 14488           W-CHEK-FILE-ID,
 14489           DFHEIV20,
 14490           DFHEIV99,
 14491           W-CHEK-KEY,
 14492           DFHEIV99,
 14493           DFHEIV99,
 14494           DFHEIV99
 14495     SET ADDRESS OF CHECK-RECORDS TO
 14496         DFHEIV20
 14497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14498
 14499
 14500     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 14501     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 14502     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 14503     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 299
* EL689.cbl
 14504                                    PI-689-CONTROL.
 14505     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 14506     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 14507
 14508     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14509     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 14510     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 14511     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 14512     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 14513     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 14514
 14515     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 14516     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14517
 14518     IF  CH-CANADIAN-POST-CODE
 14519         MOVE CH-CANADIAN-POSTAL-CODE
 14520                                 TO W-CANADIAN-POSTAL-CODES
 14521         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14522         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14523         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14524                                    W-LAB-CAN-FILLER (6)
 14525     ELSE
 14526         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14527         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14528             MOVE '-'            TO W-LABEL-DASH (6)
 14529             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14530         ELSE
 14531             MOVE SPACES         TO W-LABEL-DASH (6)
 14532                                    W-LABEL-2ND-ZIP (6).
 14533
 14534     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14535
 14536     IF  ADDRSI EQUAL '6'
 14537             AND
 14538         PI-CREATE-LABELS
 14539             AND
 14540         NOT PI-689-LABELS-OVERRIDEN
 14541         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14542                                    W-VG-TEXT (159)
 14543         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14544                                    W-VG-TEXT (160)
 14545         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14546                                    W-VG-TEXT (161)
 14547         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14548                                    W-VG-TEXT (162)
 14549         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14550                                    W-VG-TEXT (163)
 14551         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14552                                    W-VG-TEXT (164)
 14553         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14554         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14555         SET W-RG-NDX UP BY +1
 14556     ELSE
 14557         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 14558         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 14559         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 14560         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 14561         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 300
* EL689.cbl
 14562         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 14563
 14564     GO TO 6850-EXIT.
 14565
 14566 6850-CHEK-NOT-FOUND.
 14567
 14568     IF  ADDRSL GREATER ZERO
 14569         IF ADDRSI = '6'
 14570            MOVE ER-2908         TO EMI-ERROR
 14571            MOVE -1              TO ADDRSL
 14572            MOVE AL-UNBON        TO ADDRSA
 14573            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14574            GO TO 8200-SEND-DATAONLY.
 14575
 14576 6850-EXIT.
 14577     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 301
* EL689.cbl
 14579 6900-GET-PYAJ-DATA.
 14580
 14581     IF  W-FILE-NOT-USED (13)
 14582         GO TO 6900-EXIT.
 14583
 14584     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 14585         MOVE ER-9327            TO EMI-ERROR
 14586         MOVE -1                 TO MAINTL
 14587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14588         GO TO 6900-EXIT.
 14589
 14590
 14591* EXEC CICS HANDLE CONDITION
 14592*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 14593*         NOTFND  (6900-PYAJ-NOT-FOUND)
 14594*    END-EXEC.
 14595*    MOVE '"$JI                  ! 8 #00013619' TO DFHEIV0
 14596     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14597     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14598     MOVE X'3820233030303133363139' TO DFHEIV0(25:11)
 14599     CALL 'kxdfhei1' USING DFHEIV0
 14600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14601
 14602
 14603 6900-READ-NEXT.
 14604
 14605
 14606* EXEC CICS READ
 14607*         DATASET (W-PYAJ-FILE-ID)
 14608*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 14609*         RIDFLD  (W-PYAJ-KEY)
 14610*         GTEQ
 14611*    END-EXEC.
 14612*    MOVE '&"S        G          (   #00013626' TO DFHEIV0
 14613     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14614     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14615     MOVE X'2020233030303133363236' TO DFHEIV0(25:11)
 14616     CALL 'kxdfhei1' USING DFHEIV0,
 14617           W-PYAJ-FILE-ID,
 14618           DFHEIV20,
 14619           DFHEIV99,
 14620           W-PYAJ-KEY,
 14621           DFHEIV99,
 14622           DFHEIV99,
 14623           DFHEIV99
 14624     SET ADDRESS OF PENDING-PAY-ADJ TO
 14625         DFHEIV20
 14626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14627
 14628
 14629     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 14630             OR
 14631         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 14632             OR
 14633         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 14634             OR
 14635         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 14636             OR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 302
* EL689.cbl
 14637         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 14638         GO TO 6900-PYAJ-NOT-FOUND.
 14639
 14640     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 14641             AND
 14642         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 14643         GO TO 6900-PYAJ-NOT-FOUND.
 14644
 14645     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 14646         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 14647         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 14648         GO TO 6900-READ-NEXT.
 14649
 14650     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 14651     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 14652
 14653     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 14654     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 14655
 14656     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 14657                                    PI-689-CONTROL.
 14658     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 14659     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 14660
 14661     GO TO 6900-EXIT.
 14662
 14663 6900-PYAJ-NOT-FOUND.
 14664
 14665     MOVE ER-7395                TO EMI-ERROR
 14666     MOVE -1                     TO DATASORL
 14667     MOVE AL-UNBON               TO DATASORA
 14668     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14669     GO TO 8200-SEND-DATAONLY.
 14670
 14671 6900-EXIT.
 14672     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 303
* EL689.cbl
 14674 6950-MOVE-SYSTEM-DATA.
 14675
 14676     IF  W-FILE-NOT-USED (7)
 14677         GO TO 6950-EXIT.
 14678
 14679     MOVE EIBDATE                TO W-DATE-WORK.
 14680     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 14681     MOVE '5'                    TO DC-OPTION-CODE.
 14682     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14683     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 14684     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 14685
 14686     MOVE FORMI                  TO W-VG-TEXT (62).
 14687
 14688     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 14689         MOVE PI-689-VARIABLE-DATA-1
 14690                                 TO W-VG-TEXT (63)
 14691         MOVE PI-689-VARIABLE-DATA-2
 14692                                 TO W-VG-TEXT (64)
 14693         MOVE PI-689-VARIABLE-DATA-3
 14694                                 TO W-VG-TEXT (65)
 14695         MOVE PI-689-VARIABLE-DATA-4
 14696                                 TO W-VG-TEXT (66)
 14697     ELSE
 14698         MOVE '(VARIABLE NOT PROVIDED)'
 14699                                 TO W-VG-TEXT (63).
 14700
 14701 6950-EXIT.
 14702     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 304
* EL689.cbl
 14704 7000-FORMAT-SCREEN.
 14705
 14706     IF  MAINTI EQUAL 'S'
 14707             OR
 14708         PI-SHOW-MODE
 14709         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 14710     ELSE
 14711         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 14712
 14713     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 14714         SET W-LINE23            TO W-RG-NDX
 14715         MOVE 'A'                TO W-LINE1
 14716     ELSE
 14717         SET W-LIN-NUM           TO W-RG-NDX
 14718         COMPUTE W-LIN-NUM
 14719             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 14720
 14721     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 14722     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 14723     SET W-RG-NDX UP BY 1.
 14724
 14725 7000-EXIT.
 14726      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 305
* EL689.cbl
 14728 7100-FORMAT-LAST-NAME-1ST.
 14729*****************************************************************
 14730*             M O V E   N A M E   R O U T I N E                 *
 14731*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14732*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14733*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14734*                  FIELD                   VALUE                *
 14735*           W-NAME-LAST    (CL15)      SMITH                    *
 14736*           W-NAME-FIRST   (CL15)      JOHN                     *
 14737*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14738*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14739*     CONTAIN                                                   *
 14740*                SMITH, JOHN ALLEN                              *
 14741*     OR                                                        *
 14742*                SMITH, JOHN A.                                 *
 14743*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14744*     COPYBOOK, ELCNWA.                                         *
 14745*****************************************************************.
 14746
 14747     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14748     MOVE ZERO                   TO WS-NAME-SW.
 14749     SET NWA-INDEX               TO +1.
 14750
 14751     IF  W-NAME-LAST EQUAL SPACES
 14752             AND
 14753         W-NAME-MIDDLE EQUAL SPACES
 14754         MOVE +1                 TO WS-NAME-SW.
 14755
 14756     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14757     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14758
 14759     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14760     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14761
 14762     SET NWA-INDEX UP BY +1.
 14763
 14764     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 14765         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 14766             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14767             SET NWA-INDEX UP BY +1
 14768             MOVE '.'            TO WS-NW (NWA-INDEX)
 14769             SET NWA-INDEX UP BY +2
 14770         ELSE
 14771             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14772             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14773
 14774 7100-EXIT.
 14775     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 306
* EL689.cbl
 14777 7110-MOVE-NAME.
 14778
 14779     IF  WS-NAME-SW GREATER THAN +1
 14780         GO TO 7110-EXIT.
 14781
 14782     IF  WS-NAME-WORK2 = SPACES
 14783         GO TO 7110-EXIT.
 14784
 14785     SET NWA-INDEX2            TO +1.
 14786     SET NWA-INDEX3            TO +2.
 14787
 14788 7110-MOVE-NAME-CYCLE.
 14789
 14790     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14791
 14792     IF  NWA-INDEX LESS THAN +30
 14793         SET NWA-INDEX UP BY +1
 14794     ELSE
 14795         ADD +2                TO WS-NAME-SW
 14796         GO TO 7110-EXIT.
 14797
 14798     IF  NWA-INDEX2 LESS THAN +20
 14799         SET NWA-INDEX3 UP BY +1
 14800         SET NWA-INDEX2 UP BY +1.
 14801
 14802     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 14803             AND
 14804         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 14805         IF  WS-NAME-SW EQUAL ZERO
 14806             MOVE ','            TO WS-NW (NWA-INDEX)
 14807             SET NWA-INDEX UP BY +2
 14808             MOVE +1             TO WS-NAME-SW
 14809             GO TO 7110-EXIT
 14810         ELSE
 14811             GO TO 7110-EXIT.
 14812
 14813     GO TO 7110-MOVE-NAME-CYCLE.
 14814
 14815 7110-EXIT.
 14816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 307
* EL689.cbl
 14818 7200-FORMAT-NAME-STRAIGHT.
 14819*****************************************************************
 14820*           M O V E   N A M E   R O U T I N E                   *
 14821*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14822*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14823*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14824*                  FIELD                   VALUE                *
 14825*           W-NAME-LAST    (CL15)      SMITH                    *
 14826*           W-NAME-FIRST   (CL15)      JOHN                     *
 14827*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14828*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14829*     CONTAIN                                                   *
 14830*              JOHN A. SMITH                                    *
 14831*     OR                                                        *
 14832*              JOHN ALLEN SMITH                                 *
 14833*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14834*     COPYBOOK, ELCNWA.                                         *
 14835*****************************************************************
 14836
 14837     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14838     MOVE ZERO                   TO WS-NAME-SW.
 14839     SET NWA-INDEX               TO +1.
 14840
 14841     IF  W-NAME-FIRST EQUAL SPACES
 14842             AND
 14843         W-NAME-MIDDLE EQUAL SPACES
 14844         MOVE W-NAME-LAST        TO WS-NAME-WORK
 14845         GO TO 7200-EXIT.
 14846
 14847     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14848     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14849
 14850     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 14851         SET NWA-INDEX UP BY +1
 14852
 14853         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 14854             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14855             SET NWA-INDEX UP BY +1
 14856             MOVE '.'            TO WS-NW (NWA-INDEX)
 14857             SET NWA-INDEX UP BY +1
 14858
 14859         ELSE
 14860             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14861             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14862
 14863     SET NWA-INDEX UP BY +1
 14864     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14865     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14866
 14867 7200-EXIT.
 14868     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 308
* EL689.cbl
 14870 7290-MOVE-NAME.
 14871
 14872     IF  WS-NAME-SW GREATER THAN +1
 14873         GO TO 7290-EXIT.
 14874
 14875     IF  WS-NAME-WORK2 EQUAL SPACES
 14876         GO TO 7290-EXIT.
 14877
 14878     SET NWA-INDEX2            TO +1.
 14879     SET NWA-INDEX3            TO +2.
 14880
 14881 7290-MOVE-NAME-CYCLE.
 14882
 14883     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14884
 14885     IF  NWA-INDEX LESS THAN +30
 14886         SET NWA-INDEX UP BY +1
 14887     ELSE
 14888         ADD +2                TO WS-NAME-SW
 14889         GO TO 7290-EXIT.
 14890
 14891     IF  NWA-INDEX2 LESS THAN +20
 14892         SET NWA-INDEX2 UP BY +1
 14893         SET NWA-INDEX3 UP BY +1.
 14894
 14895     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 14896             AND
 14897         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 14898         GO TO 7290-EXIT.
 14899
 14900     GO TO 7290-MOVE-NAME-CYCLE.
 14901
 14902 7290-EXIT.
 14903     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 309
* EL689.cbl
 14905 7300-LABEL-MOVE.
 14906
 14907     IF  W-LABEL-HOLD-AREA = SPACES
 14908         MOVE +0                 TO W-NUMB-LABEL-LINES
 14909         GO TO 7300-EXIT.
 14910
 14911     IF  W-LABEL-LINES (1) = SPACES
 14912         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 14913         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 14914         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14915         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14916         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14917         MOVE SPACES             TO W-LABEL-LINES (6)
 14918         GO TO 7300-LABEL-MOVE.
 14919
 14920     IF  W-LABEL-LINES (2) = SPACES
 14921             AND
 14922         W-LABEL-LINES (3) = SPACES
 14923             AND
 14924         W-LABEL-LINES (4) = SPACES
 14925             AND
 14926         W-LABEL-LINES (5) = SPACES
 14927             AND
 14928         W-LABEL-LINES (6) = SPACES
 14929         MOVE 1                  TO W-NDX
 14930                                    W-NUMB-LABEL-LINES
 14931         GO TO 7300-EXIT.
 14932
 14933 7300-TRY-2.
 14934
 14935     IF  W-LABEL-LINES (2) = SPACES
 14936         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 14937         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14938         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14939         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14940         MOVE SPACES             TO W-LABEL-LINES (6)
 14941         GO TO 7300-TRY-2.
 14942
 14943     IF  W-LABEL-LINES (3) = SPACES
 14944             AND
 14945         W-LABEL-LINES (4) = SPACES
 14946             AND
 14947         W-LABEL-LINES (5) = SPACES
 14948             AND
 14949         W-LABEL-LINES (6) = SPACES
 14950         MOVE 2                  TO W-NDX
 14951         GO TO 7300-MOVE-ZIP.
 14952
 14953 7300-TRY-3.
 14954
 14955     IF  W-LABEL-LINES (3) = SPACES
 14956         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14957         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14958         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14959         MOVE SPACES             TO W-LABEL-LINES (6)
 14960         GO TO 7300-TRY-3.
 14961
 14962     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 310
* EL689.cbl
 14963             AND
 14964         W-LABEL-LINES (5) = SPACES
 14965             AND
 14966         W-LABEL-LINES (6) = SPACES
 14967         MOVE 3                   TO W-NDX
 14968         GO TO 7300-MOVE-ZIP.
 14969
 14970 7300-TRY-4.
 14971
 14972     IF  W-LABEL-LINES (4) = SPACES
 14973         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14974         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14975         MOVE SPACES             TO W-LABEL-LINES (6)
 14976         GO TO 7300-TRY-4.
 14977
 14978     IF  W-LABEL-LINES (5) = SPACES
 14979             AND
 14980         W-LABEL-LINES (6) = SPACES
 14981         MOVE 4                  TO W-NDX
 14982         GO TO 7300-MOVE-ZIP.
 14983
 14984 7300-TRY-5.
 14985
 14986     IF  W-LABEL-LINES (5) = SPACES
 14987         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14988         MOVE SPACES             TO W-LABEL-LINES (6)
 14989         GO TO 7300-TRY-5
 14990     ELSE
 14991         IF  W-LABEL-LINES (6) = SPACES
 14992             MOVE 5              TO W-NDX
 14993             GO TO 7300-MOVE-ZIP
 14994         ELSE
 14995             MOVE 6              TO W-NDX.
 14996
 14997 7300-MOVE-ZIP.
 14998
 14999     COMPUTE W-NDX2 = W-NDX - 1.
 15000
 15001     IF  W-LAST-ZIP (W-NDX2) = SPACES
 15002*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 15003
 15004         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 15005                 MOVE W-LABEL-ZIP (W-NDX)
 15006                                 TO W-LAST-ZIP (W-NDX2)
 15007                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 15008                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 15009                 GO TO 7300-EXIT.
 15010
 15011     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 15012
 15013 7300-EXIT.
 15014     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 311
* EL689.cbl
 15016 7400-CREATE-LETTER.
 15017****************************************************************
 15018*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 15019*    RECORDS.                                                  *
 15020****************************************************************
 15021
 15022     SET W-SQ-NDX                TO W-START-COLUMN.
 15023     MOVE SPACES                 TO W-SQUEEZED-LINE
 15024                                    W-WORK-LINE.
 15025     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 15026     MOVE +1                     TO W-LAST-WC-SPACE.
 15027     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 15028
 15029     SET W-TG-NDX                TO +1.
 15030
 15031     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 15032            VARYING
 15033         W-TG-NDX FROM W-TG-NDX BY +1
 15034            UNTIL
 15035         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 15036
 15037     IF  W-FORM-SQUEEZE-ON
 15038             AND
 15039         W-SQUEEZED-LINE GREATER THAN SPACES
 15040         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 15041
 15042     PERFORM 7640-PAGING THRU 7640-EXIT.
 15043
 15044 7400-EXIT.
 15045     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 312
* EL689.cbl
 15047 7410-TEXT-LINE-PROCESS.
 15048***************************************************************
 15049*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 15050*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 15051*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 15052*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 15053*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 15054*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 15055***************************************************************
 15056
 15057
 15058     SET W-WC-NDX                TO W-ZEROS.
 15059     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15060
 15061     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 15062
 15063     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 15064             VARYING
 15065         W-TX-NDX FROM +1 BY +1
 15066             UNTIL
 15067         W-TX-NDX GREATER THAN +70.
 15068
 15069****************************************************************
 15070*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 15071*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 15072*    LINE SQUEEZE CONTROL.                                     *
 15073****************************************************************
 15074     IF  W-FORM-SQUEEZE-ON
 15075
 15076         IF  W-WORK-LINE GREATER THAN SPACES
 15077                 OR
 15078             W-AS-IS
 15079             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15080
 15081         ELSE
 15082             NEXT SENTENCE
 15083****************************************************************
 15084*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 15085*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 15086****************************************************************
 15087     ELSE
 15088         IF  W-WORK-LINE GREATER THAN SPACES
 15089             MOVE W-TX-PC (W-TG-NDX)
 15090                                 TO W-PRINT-CONTROL
 15091             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 15092             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15093             MOVE SPACES         TO W-WORK-LINE.
 15094
 15095 7410-EXIT.
 15096     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 313
* EL689.cbl
 15098 7420-TEXT-CHAR-PROCESS.
 15099****************************************************************
 15100*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 15101*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 15102*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 15103*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 15104****************************************************************
 15105
 15106     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 15107             AND
 15108         W-LAST-CHAR EQUAL '@'
 15109         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 15110
 15111     SET W-WC-NDX UP BY +1.
 15112
 15113     IF  W-WC-NDX GREATER THAN +70
 15114         IF  W-FORM-SQUEEZE-ON
 15115                 AND
 15116             NOT W-AS-IS
 15117             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 15118                     VARYING
 15119                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 15120                     UNTIL
 15121                 W-WC-NDX EQUAL +71
 15122             SET W-TX-NDX        TO W-LAST-TX-SPACE
 15123
 15124             IF  W-WORK-LINE GREATER THAN SPACES
 15125                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15126                 MOVE SPACES     TO W-WORK-LINE
 15127                                    W-LINE-SQUEEZE-IND
 15128                 SET W-WC-NDX    TO +1
 15129             ELSE
 15130                 SET W-WC-NDX    TO +1
 15131         ELSE
 15132             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 15133
 15134     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15135                                 TO W-CHARACTER-TYPE.
 15136
 15137     SET W-WC-NDX2               TO W-WC-NDX.
 15138     SET W-WC-NDX2 DOWN BY +1.
 15139
 15140     IF  W-PUNCTUATION
 15141             AND
 15142         W-WC-NDX2 GREATER THAN W-ZEROS
 15143             AND
 15144         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 15145         SET W-WC-NDX DOWN BY +1.
 15146
 15147     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15148                                 TO W-LAST-CHAR
 15149                                    W-WORK-CHAR (W-WC-NDX).
 15150
 15151     IF  W-LAST-CHAR EQUAL SPACES
 15152         SET W-LAST-WC-SPACE     TO W-WC-NDX
 15153         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 15154
 15155 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 314
* EL689.cbl
 15156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 315
* EL689.cbl
 15158 7430-PROCESS-VARIABLE.
 15159******************************************************************
 15160*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 15161*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 15162*    ITS CORRESPONDING VALUES.                                   *
 15163******************************************************************
 15164
 15165     SET W-TX-NDX UP BY +1.
 15166
 15167     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15168         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15169                                 TO W-V1
 15170         SET W-TX-NDX UP BY +1
 15171
 15172         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15173             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15174                                 TO W-V2
 15175             SET W-TX-NDX UP BY +1
 15176             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15177                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15178                                 TO W-V3
 15179                 SET W-TX-NDX UP BY +1
 15180                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15181                                 TO W-FIELD-SQUEEZE-IND
 15182                 GO TO 7430-CONTINUE
 15183             ELSE
 15184                 SET W-TX-NDX DOWN BY +3
 15185                 MOVE ER-0180    TO EMI-ERROR
 15186                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15187                 MOVE -1         TO MAINTL
 15188                 MOVE HIGH-VALUES
 15189                                 TO W-LAST-CHAR
 15190         ELSE
 15191             SET W-TX-NDX DOWN BY +2
 15192             MOVE ER-0180        TO EMI-ERROR
 15193             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15194             MOVE -1             TO MAINTL
 15195             MOVE HIGH-VALUES    TO W-LAST-CHAR
 15196     ELSE
 15197         SET W-TX-NDX DOWN BY +1
 15198         MOVE ER-7246            TO EMI-ERROR
 15199         MOVE -1                 TO MAINTL
 15200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15201         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 15202
 15203****************************************************************
 15204*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 15205*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 15206*    ACTION.                                                   *
 15207****************************************************************
 15208
 15209     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15210         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15211         GO TO 7430-EXIT
 15212     ELSE
 15213         GO TO 7430-EXIT.
 15214
 15215 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 316
* EL689.cbl
 15216
 15217     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 15218             OR
 15219         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 15220         SET W-TX-NDX DOWN BY +4
 15221         MOVE ER-0180            TO EMI-ERROR
 15222         MOVE -1                 TO MAINTL
 15223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15224         MOVE HIGH-VALUES        TO W-LAST-CHAR
 15225         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15226             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15227             GO TO 7430-EXIT
 15228         ELSE
 15229             GO TO 7430-EXIT.
 15230
 15231     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 15232
 15233     SET W-WC-NDX DOWN BY +1.
 15234
 15235     IF  (W-FORM-SQUEEZE-OFF
 15236                 AND
 15237             NOT W-SQUEEZE-FIELD)
 15238             OR
 15239         (W-FORM-SQUEEZE-ON
 15240                 AND
 15241             W-AS-IS)
 15242         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 15243                 VARYING
 15244             W-VC-NDX FROM +1 BY +1
 15245                 UNTIL
 15246             W-VC-NDX GREATER THAN
 15247                 W-VARIABLE-SIZE (W-VG-NDX)
 15248
 15249         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 15250             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15251             SET W-TX-NDX DOWN BY +5
 15252             IF  W-TX-NDX GREATER THAN +70
 15253                 SET W-TX-NDX    TO +70
 15254                 GO TO 7430-EXIT
 15255             ELSE
 15256                 GO TO 7430-EXIT
 15257         ELSE
 15258             COMPUTE W-ADJUST-SHORT
 15259                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 15260             SET W-WC-NDX UP BY W-ADJUST-SHORT
 15261             GO TO 7430-EXIT.
 15262
 15263     IF  W-SQUEEZE-FIELD
 15264         SET W-TX-NDX UP BY +1.
 15265
 15266     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 15267
 15268     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 15269             VARYING
 15270         W-VC-NDX FROM +1 BY +1
 15271             UNTIL
 15272         W-VC-NDX GREATER THAN
 15273             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 317
* EL689.cbl
 15274
 15275     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15276
 15277     IF  W-FORM-SQUEEZE-ON
 15278         GO TO 7430-EXIT.
 15279
 15280     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 15281         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15282         SET W-TX-NDX DOWN BY +6
 15283         IF  W-TX-NDX GREATER THAN +70
 15284             SET W-TX-NDX        TO +70.
 15285
 15286     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15287         SET W-WC-NDX DOWN BY +1.
 15288
 15289 7430-EXIT.
 15290     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 318
* EL689.cbl
 15292 7435-MOVE-VARIABLE-DIRECT.
 15293
 15294     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15295             AND
 15296         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15297             AND
 15298         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15299             AND
 15300         (W-VC-NDX GREATER THAN +1
 15301                 AND
 15302             W-LAST-CHAR NOT EQUAL SPACE
 15303                 AND
 15304             NOT W-LAST-CHAR-PUNC)
 15305         IF  W-LC-USE-BOTH-CASES
 15306             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15307                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15308         ELSE
 15309             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15310                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15311
 15312     SET W-WC-NDX UP BY +1.
 15313     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15314                                 TO W-WORK-CHAR (W-WC-NDX)
 15315                                    W-LAST-CHAR.
 15316
 15317 7435-EXIT.
 15318     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 319
* EL689.cbl
 15320 7437-FIND-NEXT-CHARACTER.
 15321*DELIBERATELY LEFT BLANK.
 15322 7437-EXIT.
 15323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 320
* EL689.cbl
 15325 7440-BACK-TO-NEAREST-WORD.
 15326
 15327     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 15328
 15329 7440-EXIT.
 15330     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 321
* EL689.cbl
 15332 7450-SQUEEZING.
 15333
 15334     IF  W-NEW-PARAGRAPH
 15335         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 15336         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 15337         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15338             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15339             MOVE W-TX-PC (W-TG-NDX)
 15340                                 TO W-PRINT-CONTROL
 15341             MOVE SPACES         TO W-SQUEEZED-LINE
 15342             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15343             SET W-SQ-NDX UP BY W-WORK-INDENT
 15344         ELSE
 15345             MOVE W-TX-PC (W-TG-NDX)
 15346                                 TO W-PRINT-CONTROL
 15347             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15348             SET W-SQ-NDX UP BY W-WORK-INDENT
 15349     ELSE
 15350         IF  W-DO-NOT-ADJUST
 15351             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 15352             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15353                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15354                 MOVE W-WORK-LINE
 15355                                 TO W-SQUEEZED-LINE
 15356                 MOVE W-TX-PC (W-TG-NDX)
 15357                                 TO W-PRINT-CONTROL
 15358                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15359                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15360                 MOVE SPACES     TO W-SQUEEZED-LINE
 15361                 GO TO 7450-EXIT
 15362             ELSE
 15363                 MOVE W-WORK-LINE
 15364                                 TO W-SQUEEZED-LINE
 15365                 MOVE W-TX-PC (W-TG-NDX)
 15366                                 TO W-PRINT-CONTROL
 15367                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15368                 MOVE SPACES     TO W-SQUEEZED-LINE
 15369                                    W-WORK-LINE
 15370                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15371                 GO TO 7450-EXIT
 15372         ELSE
 15373             IF  W-ADJUST-TO-LINE-LENGTH
 15374                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 15375
 15376                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15377                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15378                     SET W-SQ-NDX
 15379                                 TO W-INITIAL-COLUMN
 15380                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15381                             VARYING
 15382                         W-WC-NDX FROM 1 BY 1
 15383                             UNTIL
 15384                         W-SQ-NDX EQUAL W-TOO-FAR
 15385                     MOVE W-TX-PC (W-TG-NDX)
 15386                                 TO W-PRINT-CONTROL
 15387                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15388                     SET W-SQ-NDX
 15389                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 322
* EL689.cbl
 15390                     MOVE SPACES TO W-SQUEEZED-LINE
 15391                                    W-WORK-LINE
 15392                     GO TO 7450-EXIT
 15393                 ELSE
 15394                     SET W-SQ-NDX
 15395                                 TO W-INITIAL-COLUMN
 15396                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15397                             VARYING
 15398                         W-WC-NDX FROM 1 BY 1
 15399                             UNTIL
 15400                         W-SQ-NDX EQUAL W-TOO-FAR
 15401                     MOVE W-TX-PC (W-TG-NDX)
 15402                                 TO W-PRINT-CONTROL
 15403                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15404                     MOVE SPACES TO W-SQUEEZED-LINE
 15405                                    W-WORK-LINE
 15406                     SET W-SQ-NDX
 15407                                 TO W-INITIAL-COLUMN
 15408                     GO TO 7450-EXIT
 15409             ELSE
 15410                 IF  W-CONTINUE-PARAGRAPH
 15411                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15412                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15413                         PERFORM 7610-SET-CONP-INDENT
 15414                             THRU 7610-EXIT
 15415                         MOVE SPACES
 15416                                 TO W-LINE-SQUEEZE-IND
 15417                         MOVE W-TX-PC (W-TG-NDX)
 15418                                 TO W-PRINT-CONTROL
 15419                         MOVE SPACES
 15420                                 TO W-SQUEEZED-LINE
 15421                         SET W-SQ-NDX
 15422                                 TO W-INITIAL-COLUMN
 15423                         SET W-SQ-NDX UP BY W-WORK-INDENT
 15424                     ELSE
 15425                         PERFORM 7610-SET-CONP-INDENT
 15426                             THRU 7610-EXIT
 15427                         MOVE SPACES
 15428                                 TO W-LINE-SQUEEZE-IND
 15429                         MOVE W-TX-PC (W-TG-NDX)
 15430                                 TO W-PRINT-CONTROL
 15431                         MOVE SPACES
 15432                                 TO W-SQUEEZED-LINE
 15433                         SET W-SQ-NDX
 15434                                 TO W-INITIAL-COLUMN
 15435                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 15436
 15437
 15438     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 15439             VARYING
 15440         W-WC-NDX FROM +1 BY +1
 15441             UNTIL
 15442         W-WC-NDX GREATER THAN +70.
 15443
 15444 7450-EXIT.
 15445     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 323
* EL689.cbl
 15447 7460-REMAIN-CHAR-CHECK.
 15448
 15449     IF  W-TX-NDX EQUAL W-WC-NDX
 15450         MOVE W-TX-PC (W-TG-NDX)
 15451                                 TO W-PRINT-CONTROL
 15452         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 15453         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15454         MOVE SPACES             TO W-WORK-LINE
 15455         SET W-WC-NDX            TO +1
 15456     ELSE
 15457         SET W-TX-NDX1           TO W-TX-NDX
 15458         SEARCH W-TX-CHAR
 15459             VARYING W-TX-NDX1
 15460             AT END
 15461                 MOVE W-TX-PC (W-TG-NDX)
 15462                                 TO W-PRINT-CONTROL
 15463                 MOVE W-WORK-LINE
 15464                                 TO W-SQUEEZED-LINE
 15465                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15466                 MOVE SPACES     TO W-WORK-LINE
 15467                 SET W-WC-NDX    TO +1
 15468                 SET W-TX-NDX    TO +1
 15469                 SET W-TG-NDX UP BY +1
 15470             WHEN
 15471                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 15472                 MOVE ER-9427    TO EMI-ERROR
 15473                 MOVE -1         TO MAINTL
 15474                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15475                 MOVE W-TX-PC (W-TG-NDX)
 15476                                 TO W-PRINT-CONTROL
 15477                 MOVE W-WORK-LINE
 15478                                 TO W-SQUEEZED-LINE
 15479                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15480                 MOVE SPACES     TO W-WORK-LINE
 15481                 SET W-WC-NDX    TO +1.
 15482
 15483 7460-EXIT.
 15484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 324
* EL689.cbl
 15486 7470-MOVE-CHAR.
 15487
 15488     IF  W-FIRST-CHAR-NOT-FOUND
 15489             AND
 15490         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15491         MOVE SPACES             TO W-LAST-CHAR
 15492         GO TO 7470-EXIT.
 15493
 15494     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 15495
 15496     IF  W-SQUEEZE-FIELD
 15497             AND
 15498         W-LAST-CHAR EQUAL SPACES
 15499             AND
 15500         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15501         GO TO 7470-EXIT.
 15502
 15503     SET W-WC-NDX UP BY +1.
 15504
 15505     IF  W-WC-NDX GREATER THAN +70
 15506         IF  W-FORM-SQUEEZE-ON
 15507             GO TO 7470-EXIT
 15508         ELSE
 15509             MOVE ER-9427        TO EMI-ERROR
 15510             MOVE -1             TO MAINTL
 15511             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15512             GO TO 7470-EXIT.
 15513
 15514     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15515             AND
 15516         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15517             AND
 15518         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15519             AND
 15520         (W-VC-NDX GREATER THAN +1
 15521                 AND
 15522             W-LAST-CHAR NOT EQUAL SPACE
 15523                 AND
 15524             NOT W-LAST-CHAR-PUNC)
 15525         IF  W-LC-USE-BOTH-CASES
 15526             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15527                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15528         ELSE
 15529             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15530                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15531
 15532     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15533                                 TO W-WORK-CHAR (W-WC-NDX)
 15534                                    W-LAST-CHAR.
 15535
 15536     IF  W-LAST-CHAR EQUAL SPACES
 15537         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 15538
 15539 7470-EXIT.
 15540     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 325
* EL689.cbl
 15542 7480-UPDATE-SQUEEZED-LINE.
 15543****************************************************************
 15544*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 15545*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 15546*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 15547*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 15548*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 15549*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 15550****************************************************************
 15551
 15552     SET W-SQ-NDX UP BY +1.
 15553
 15554     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 15555         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 15556                                 TO W-CHARACTER-TYPE
 15557         IF  W-PUNCTUATION
 15558                 OR
 15559             W-SPACE
 15560             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 15561             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15562             MOVE SPACES         TO W-SQUEEZED-LINE
 15563             SET W-SQ-NDX        TO W-START-COLUMN
 15564             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15565             SET W-LAST-SQUEEZED-SPACE
 15566                                 TO W-SQ-NDX
 15567         ELSE
 15568             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 15569             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15570             MOVE SPACES         TO W-SQUEEZED-LINE
 15571             SET W-SQ-NDX        TO W-START-COLUMN
 15572             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15573             SET W-LAST-SQUEEZED-SPACE
 15574                                 TO W-SQ-NDX.
 15575
 15576     IF  W-WC-NDX GREATER THAN +70
 15577         GO TO 7480-EXIT.
 15578
 15579     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 15580
 15581     IF  W-END-OF-SENTENCE
 15582         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 15583         SET W-WORK-NDX          TO W-SQ-NDX
 15584         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 15585         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 15586             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 15587         ELSE
 15588             NEXT SENTENCE
 15589     ELSE
 15590         IF  W-PUNCTUATION
 15591                 AND
 15592             W-LAST-SQ-CHAR EQUAL SPACES
 15593             SET W-SQ-NDX DOWN BY +1
 15594             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 15595         ELSE
 15596             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15597                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 15598                     IF  W-END-OF-SENTENCE-WORKING
 15599                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 326
* EL689.cbl
 15600                                 TO W-END-OF-SENTENCE-IND
 15601                         SET W-LAST-SQUEEZED-SPACE
 15602                                 TO W-SQ-NDX
 15603                     ELSE
 15604                         SET W-SQ-NDX DOWN BY +1
 15605                         GO TO 7480-EXIT
 15606                 ELSE
 15607                     SET W-LAST-SQUEEZED-SPACE
 15608                                 TO W-SQ-NDX
 15609             ELSE
 15610                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 15611
 15612     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 15613                                    W-LAST-SQ-CHAR.
 15614
 15615     IF  W-WC-NDX EQUAL +70
 15616             AND
 15617         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 15618             AND
 15619         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 15620         SET W-SQ-NDX UP BY +1
 15621         SET W-LAST-SQUEEZED-SPACE
 15622                                 TO W-SQ-NDX
 15623         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 15624                                    W-LAST-SQ-CHAR.
 15625
 15626 7480-EXIT.
 15627     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 327
* EL689.cbl
 15629 7485-FIND-NEXT-CHARACTER.
 15630
 15631     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 15632
 15633     IF  W-PUNCTUATION
 15634         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 15635     ELSE
 15636         SET W-WC-NDX            TO W-WC-NDX
 15637         SEARCH W-WORK-CHAR
 15638             VARYING W-WC-NDX
 15639             AT END
 15640                 GO TO 7485-EXIT
 15641             WHEN
 15642                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 15643                 GO TO 7485-EXIT.
 15644
 15645 7485-EXIT.
 15646     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 328
* EL689.cbl
 15648 7490-REMOVE-LAST-WORD.
 15649
 15650*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 15651     IF  W-WC-NDX EQUAL +1
 15652         GO TO 7490-EXIT.
 15653
 15654     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 15655
 15656     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 15657             VARYING
 15658         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 15659             UNTIL
 15660         W-SQ-NDX EQUAL W-TOO-FAR.
 15661
 15662     SET W-WORK-NDX              TO W-WC-NDX.
 15663     COMPUTE W-LAST-WC-SPACE
 15664         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 15665     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 15666
 15667 7490-EXIT.
 15668     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 329
* EL689.cbl
 15670 7500-CLEAR-SQUEEZED-EXCESS.
 15671
 15672     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 15673
 15674 7500-EXIT.
 15675     EXIT.
 15676
 15677 7505-MOVE-STRAIGHT.
 15678
 15679     SET W-SQ-NDX UP BY +1.
 15680
 15681     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 15682
 15683 7505-EXIT.
 15684     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 330
* EL689.cbl
 15686 7510-MOVE-TO-TABLE.
 15687
 15688     IF  W-PRINT-CONTROL NOT NUMERIC
 15689         MOVE 00                 TO W-PRINT-CONTROL
 15690         ADD +1                  TO W-LINE-COUNT
 15691     ELSE
 15692         IF  W-PRINT-CONTROL EQUAL 99
 15693             PERFORM 7640-PAGING THRU 7640-EXIT
 15694             MOVE 00             TO W-PRINT-CONTROL
 15695             SET W-RG-NDX UP BY +1
 15696             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 15697             MOVE +1             TO W-LINE-COUNT
 15698             SET W-RG-NDX UP BY W-TOP-MARGIN
 15699         ELSE
 15700           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 15701             COMPUTE W-LINE-COUNT
 15702                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 15703
 15704     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 15705         PERFORM 7640-PAGING THRU 7640-EXIT
 15706         MOVE 00                 TO W-PRINT-CONTROL
 15707         SET W-RG-NDX UP BY +1
 15708         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 15709         SET W-RG-NDX UP BY W-TOP-MARGIN
 15710         MOVE +1                 TO W-LINE-COUNT.
 15711
 15712     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 15713     SET W-RG-NDX UP BY +1.
 15714     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 15715     MOVE 00                     TO W-PRINT-CONTROL.
 15716
 15717     IF  W-FIRST-BAD-VARIABLE-FOUND
 15718             AND
 15719         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15720         SET W-FIRST-BAD-VARIABLE
 15721                                 TO W-RG-NDX.
 15722
 15723 7510-EXIT.
 15724     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 331
* EL689.cbl
 15726 7600-SET-PARA-INDENT.
 15727
 15728     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 15729         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 15730     ELSE
 15731     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 15732         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 15733         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15734     ELSE
 15735     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 15736         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 15737         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15738     ELSE
 15739     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 15740         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 15741         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15742     ELSE
 15743     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 15744         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 15745         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15746     ELSE
 15747     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 15748         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 15749         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 15750
 15751     SET W-TG-NDX2               TO W-TG-NDX.
 15752     SET W-TG-NDX2 UP BY +1.
 15753
 15754     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 15755         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15756     ELSE
 15757         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 15758
 15759 7600-EXIT.
 15760     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 332
* EL689.cbl
 15762 7610-SET-CONP-INDENT.
 15763
 15764     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 15765         MOVE +0                 TO W-WORK-INDENT
 15766     ELSE
 15767     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 15768         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 15769     ELSE
 15770     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 15771         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 15772     ELSE
 15773     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 15774         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 15775     ELSE
 15776     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 15777         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 15778     ELSE
 15779     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 15780         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 15781
 15782     SET W-TG-NDX2               TO W-TG-NDX.
 15783     SET W-TG-NDX2 UP BY +1.
 15784
 15785     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 15786         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15787     ELSE
 15788         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 15789
 15790 7610-EXIT.
 15791     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 333
* EL689.cbl
 15793 7630-NEXT-LINE.
 15794
 15795     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 15796         MOVE ZEROS              TO W-NEXT-INDENT
 15797     ELSE
 15798     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 15799         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 15800     ELSE
 15801     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 15802         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 15803     ELSE
 15804     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 15805         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 15806     ELSE
 15807     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 15808         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 15809     ELSE
 15810     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 15811         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 15812     ELSE
 15813         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15814         SUBTRACT W-PARAGRAPH-INDENT
 15815                                  FROM W-NEXT-INDENT.
 15816
 15817 7630-EXIT.
 15818     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 334
* EL689.cbl
 15820 7640-PAGING.
 15821
 15822     IF  NOT W-LC-CREATE-PAGES
 15823         GO TO 7640-EXIT.
 15824
 15825     IF  W-LINE-COUNT GREATER ZEROS
 15826             AND
 15827         W-RG-NDX GREATER THAN +1
 15828         ADD +1                  TO W-PAGE
 15829         MOVE W-PAGE             TO W-PAGE-NUMBER
 15830         COMPUTE W-PAGE-LINE
 15831             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 15832         IF  W-PAGE-LINE GREATER THAN +2
 15833             SET W-RG-NDX UP BY W-PAGE-LINE
 15834             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 15835         ELSE
 15836             SET W-RG-NDX UP BY +2
 15837             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 15838
 15839 7640-EXIT.
 15840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 335
* EL689.cbl
 15842 7700-READ-TEXT-TS.
 15843**************************************************************
 15844*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 15845*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 15846*  AND EL1042.                                               *
 15847**************************************************************
 15848
 15849
 15850* EXEC CICS HANDLE CONDITION
 15851*         QIDERR     (7700-TS-ERROR)
 15852*         ITEMERR    (7700-TS-ERROR)
 15853*    END-EXEC.
 15854*    MOVE '"$N<                  ! 9 #00014853' TO DFHEIV0
 15855     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 15856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15857     MOVE X'3920233030303134383533' TO DFHEIV0(25:11)
 15858     CALL 'kxdfhei1' USING DFHEIV0
 15859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15860
 15861
 15862     SET W-TS-NDX                TO 1.
 15863     MOVE 1                      TO W-TS-ITEM.
 15864
 15865 7700-LOOP.
 15866
 15867     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 15868         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 15869             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15870             GO TO 7700-EXIT
 15871         ELSE
 15872             GO TO 7700-EXIT.
 15873
 15874
 15875* EXEC CICS READQ TS
 15876*         INTO     (W-TS-WORK-AREA)
 15877*         QUEUE    (W-TS-NAME-TEXT)
 15878*         LENGTH   (W-TS-LENGTH)
 15879*         ITEM     (W-TS-ITEM)
 15880*    END-EXEC.
 15881*    MOVE '*$II   L              ''   #00014870' TO DFHEIV0
 15882     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 15883     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15884     MOVE X'2020233030303134383730' TO DFHEIV0(25:11)
 15885     CALL 'kxdfhei1' USING DFHEIV0,
 15886           W-TS-NAME-TEXT,
 15887           W-TS-WORK-AREA,
 15888           W-TS-LENGTH,
 15889           W-TS-ITEM,
 15890           DFHEIV99,
 15891           DFHEIV99
 15892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15893
 15894
 15895     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 15896     SET W-TS-NDX UP BY 1.
 15897     ADD 1                       TO W-TS-ITEM.
 15898     GO TO 7700-LOOP.
 15899
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 336
* EL689.cbl
 15900 7700-TS-ERROR.
 15901
 15902     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 15903         MOVE ER-0033            TO EMI-ERROR
 15904         MOVE -1                 TO MAINTL
 15905         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15906         GO TO 8200-SEND-DATAONLY.
 15907
 15908 7700-EXIT.
 15909      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 337
* EL689.cbl
 15911 7740-RESTORE-SCREEN.
 15912
 15913     MOVE 'C'                    TO MAINTI.
 15914     MOVE +1                     TO MAINTL.
 15915     MOVE AL-UANON               TO MAINTA.
 15916
 15917     MOVE PI-689-FORM-NUMBER     TO FORMI.
 15918     MOVE +4                     TO FORML.
 15919     MOVE AL-UANON               TO FORMA.
 15920
 15921*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 15922*        MOVE PI-689-PRINT-RESTRICTION
 15923*                                TO PRTRESTL
 15924*        MOVE +1                 TO PRTRESTL
 15925*        MOVE AL-UANON           TO PRTRESTA.
 15926
 15927     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 15928         MOVE PI-689-FOLLOW-UP-EDIT
 15929                                 TO FOLLOWI
 15930         MOVE +8                 TO FOLLOWL
 15931         MOVE AL-UANON           TO FOLLOWA.
 15932
 15933     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 15934         MOVE PI-689-RESEND1-EDIT
 15935                                 TO RESEND1I
 15936         MOVE +8                 TO RESEND1L
 15937         MOVE AL-UANON           TO RESEND1A.
 15938     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 15939         MOVE PI-689-ALT-PRINTER-ID
 15940                                 TO PRINTERI
 15941         MOVE +1                 TO PRINTERL
 15942         MOVE AL-UANON           TO PRINTERA.
 15943
 15944     IF  PI-BYPASS-LABELS
 15945          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 15946          MOVE +1                TO ADDRLBLL
 15947          MOVE AL-UANON          TO ADDRLBLA
 15948     ELSE
 15949          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 15950               MOVE PI-689-LBL-OVERRIDE
 15951                                 TO ADDRLBLI
 15952               MOVE +1           TO ADDRLBLL
 15953               MOVE AL-UANON     TO ADDRLBLA.
 15954
 15955     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 15956         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 15957         MOVE +1                     TO COPIESL
 15958         MOVE AL-UNNON               TO COPIESA.
 15959
 15960     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 15961         MOVE PI-689-LABEL-SOURCE
 15962                                 TO ADDRSI
 15963         MOVE +1                 TO ADDRSL
 15964         MOVE AL-UANON           TO ADDRSA.
 15965
 15966     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 15967     MOVE +1                     TO DATASORL.
 15968     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 338
* EL689.cbl
 15969
 15970     IF  PI-689-CARRIER GREATER THAN SPACES
 15971         MOVE PI-689-CARRIER     TO CARRIERI
 15972         MOVE +1                 TO CARRIERL
 15973         MOVE AL-UANON           TO CARRIERA.
 15974
 15975     IF  PI-689-GROUPING GREATER THAN SPACES
 15976         MOVE PI-689-GROUPING    TO GROUPI
 15977         MOVE +6                 TO GROUPL
 15978         MOVE AL-UANON           TO GROUPA.
 15979
 15980     IF  PI-689-STATE GREATER THAN SPACES
 15981         MOVE PI-689-STATE       TO STATEI
 15982         MOVE +2                 TO STATEL
 15983         MOVE AL-UANON           TO STATEA.
 15984
 15985     IF  PI-689-ACCOUNT GREATER THAN SPACES
 15986         MOVE PI-689-ACCOUNT     TO ACCTI
 15987         MOVE +10                TO ACCTL
 15988         MOVE AL-UANON           TO ACCTA.
 15989
 15990     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 15991         MOVE PI-689-CERT-PRIME  TO CERTI
 15992         MOVE +10                TO CERTL
 15993         MOVE AL-UANON           TO CERTA.
 15994
 15995     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 15996         MOVE PI-689-CERT-SFX    TO SFXI
 15997         MOVE +1                 TO SFXL
 15998         MOVE AL-UANON           TO SFXA.
 15999
 16000     IF  PI-689-TYPE GREATER THAN SPACES
 16001         MOVE PI-689-TYPE        TO TYPEI
 16002         MOVE +1                 TO TYPEL
 16003         MOVE AL-UANON           TO TYPEA.
 16004
 16005     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 16006         MOVE PI-689-RESP-PERSON TO RPERSONI
 16007         MOVE +10                TO RPERSONL
 16008         MOVE AL-UANON           TO RPERSONA.
 16009
 16010     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 16011         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 16012         MOVE +6                 TO BENTRYL
 16013         MOVE AL-UANON           TO BENTRYA.
 16014
 16015     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 16016         MOVE PI-689-SEQ-EDIT    TO SEQI
 16017         MOVE +8                 TO SEQL
 16018         MOVE AL-UNNON           TO SEQA.
 16019
 16020     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 16021         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 16022         MOVE +4                 TO BCSEQL
 16023         MOVE AL-UNNON           TO BCSEQA.
 16024
 16025     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 16026         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 339
* EL689.cbl
 16027         MOVE +8                 TO DATEL
 16028         MOVE AL-UNNON           TO DATEA.
 16029
 16030     IF PI-CERT-FORM-ID GREATER THAN SPACES
 16031        MOVE PI-CERT-FORM-ID     TO CERTIDI
 16032        MOVE +5                  TO CERTIDL
 16033        MOVE AL-UNNON            TO CERTIDA
 16034     END-IF.
 16035
 16036     IF PI-PRINT-NOW GREATER THAN SPACES
 16037        MOVE PI-PRINT-NOW        TO PRTNOWI
 16038        MOVE +1                  TO PRTNOWL
 16039        MOVE AL-UNNON            TO PRTNOWA
 16040     END-IF.
 16041     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 16042        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 16043        MOVE +8                  TO ENDARCHL
 16044        MOVE AL-UNNON            TO ENDARCHA
 16045     END-IF
 16046
 16047     MOVE PI-ENCLOSURE-CD        TO ENCI.
 16048     MOVE +3                     TO ENCL.
 16049     MOVE AL-UANON               TO ENCA.
 16050
 16051 7749-EXIT.
 16052     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 340
* EL689.cbl
 16054 7760-PUT-TEMP-STORAGE.
 16055**************************************************************
 16056*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 16057*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 16058*  EL1042 AND EL6892.                                        *
 16059**************************************************************
 16060
 16061     SET W-TS-NDX                TO 1.
 16062     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16063
 16064     MOVE -1                     TO MAINTL.
 16065     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16066             VARYING
 16067         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16068             UNTIL
 16069         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16070
 16071 7760-EXIT.
 16072      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 341
* EL689.cbl
 16074 7780-DELETE-TEMP-STOR-TEXT.
 16075
 16076
 16077* EXEC CICS HANDLE CONDITION
 16078*         QIDERR      (7780-EXIT)
 16079*    END-EXEC.
 16080*    MOVE '"$N                   ! : #00015058' TO DFHEIV0
 16081     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 16082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16083     MOVE X'3A20233030303135303538' TO DFHEIV0(25:11)
 16084     CALL 'kxdfhei1' USING DFHEIV0
 16085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16086
 16087
 16088
 16089* EXEC CICS DELETEQ TS
 16090*         QUEUE       (W-TS-NAME-TEXT)
 16091*    END-EXEC.
 16092*    MOVE '*&                    #   #00015062' TO DFHEIV0
 16093     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 16094     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16095     MOVE X'2020233030303135303632' TO DFHEIV0(25:11)
 16096     CALL 'kxdfhei1' USING DFHEIV0,
 16097           W-TS-NAME-TEXT,
 16098           DFHEIV99
 16099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16100
 16101
 16102 7780-EXIT.
 16103     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 342
* EL689.cbl
 16105 7840-WRITE-TS.
 16106
 16107     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 16108     SET W-TS-NDX UP BY 1.
 16109     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 16110
 16111
 16112* EXEC CICS WRITEQ TS
 16113*         FROM    (W-TS-WORK-AREA)
 16114*         QUEUE   (W-TS-NAME-TEXT)
 16115*         LENGTH  (W-TS-LENGTH)
 16116*         ITEM    (PI-TEMP-STOR-ITEMS)
 16117*    END-EXEC.
 16118*    MOVE '*" I                  ''   #00015075' TO DFHEIV0
 16119     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 16120     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16121     MOVE X'2020233030303135303735' TO DFHEIV0(25:11)
 16122     CALL 'kxdfhei1' USING DFHEIV0,
 16123           W-TS-NAME-TEXT,
 16124           W-TS-WORK-AREA,
 16125           W-TS-LENGTH,
 16126           PI-TEMP-STOR-ITEMS,
 16127           DFHEIV99,
 16128           DFHEIV99
 16129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16130
 16131
 16132 7840-EXIT.
 16133     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 343
* EL689.cbl
 16135 7900-PRINT-LETTER-NOW.
 16136***************************************************************
 16137*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 16138*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 16139*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 16140*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 16141*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 16142*     ISSUED FOR THE PRINT TRANSACTION.                       *
 16143***************************************************************
 16144
 16145*    IF (EIBAID = DFHPF4 OR DFHPF8)
 16146*            AND
 16147*        PI-SHOW-MODE
 16148*        IF  PRINTERL GREATER ZERO
 16149*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 16150*                                                    W-UPPER-CASE
 16151*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 16152*                                   PI-ALT-DMD-PRT-ID.
 16153*
 16154*    IF  EIBAID EQUAL DFHPF8
 16155*            AND
 16156*        PI-SHOW-MODE
 16157*            AND
 16158*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 16159*        MOVE ER-7247            TO EMI-ERROR
 16160*        MOVE -1                 TO MAINTL
 16161*        MOVE AL-UABON           TO MAINTA
 16162*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16163*        GO TO 8200-SEND-DATAONLY.
 16164
 16165     IF  PI-TOTAL-LINES EQUAL 0
 16166         MOVE ER-0187            TO EMI-ERROR
 16167         MOVE -1                 TO MAINTL
 16168         MOVE AL-UABON           TO MAINTA
 16169         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16170         GO TO 8200-SEND-DATAONLY.
 16171
 16172     IF  EMI-ERROR NOT EQUAL ER-0191
 16173         IF  PI-689-CREATE-NO-SCREENS
 16174*                OR
 16175*            (EIBAID = DFHPF4 OR DFHPF8)
 16176             SET W-RG-NDX        TO +1
 16177         ELSE
 16178             PERFORM 4100-SET-NDX THRU 4100-EXIT
 16179             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16180                     VARYING
 16181                 W-SC-NDX FROM 1 BY 1
 16182                     UNTIL
 16183                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 16184
 16185     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 16186
 16187     IF EIBAID NOT = DFHPF4 AND DFHPF8
 16188         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 16189                 VARYING
 16190             W-RVS-NDX FROM +1 BY +1
 16191                 UNTIL
 16192             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 344
* EL689.cbl
 16193                 OR
 16194             W-REMAINING-VAR-FOUND
 16195         IF  W-REMAINING-VAR-FOUND
 16196             GO TO 4000-ROLL-PAGE.
 16197
 16198*    IF EIBAID = DFHPF4 OR DFHPF8
 16199*       PERFORM 7700-READ-TEXT-TS
 16200*                                THRU 7700-EXIT
 16201*
 16202*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 16203*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16204*                VARYING
 16205*            W-SC-NDX FROM 1 BY 1
 16206*                UNTIL
 16207*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 16208*
 16209*       PERFORM 7760-PUT-TEMP-STORAGE
 16210*                                THRU 7760-EXIT
 16211*    END-IF
 16212     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 16213         MOVE PI-689-ALT-PRINTER-ID
 16214                                 TO W-TS-TERM-TEXT
 16215     ELSE
 16216         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 16217             MOVE PI-PROCESSOR-PRINTER
 16218                                 TO W-TS-TERM-TEXT
 16219         ELSE
 16220             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 16221             MOVE '1'            TO W-CNTL-RECORD-TYPE
 16222             MOVE SPACES         TO W-CNTL-GENL
 16223             MOVE ZEROS          TO W-CNTL-SEQ-NO
 16224
 16225* EXEC CICS HANDLE CONDITION
 16226*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 16227*                 NOTFND     (7945-NOT-FOUND)
 16228*            END-EXEC
 16229*    MOVE '"$JI                  ! ; #00015174' TO DFHEIV0
 16230     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 16231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16232     MOVE X'3B20233030303135313734' TO DFHEIV0(25:11)
 16233     CALL 'kxdfhei1' USING DFHEIV0
 16234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16235
 16236* EXEC CICS READ
 16237*                 DATASET    (W-CNTL-FILE-ID)
 16238*                 SET        (ADDRESS OF CONTROL-FILE)
 16239*                 RIDFLD     (W-CNTL-KEY)
 16240*            END-EXEC
 16241*    MOVE '&"S        E          (   #00015178' TO DFHEIV0
 16242     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16244     MOVE X'2020233030303135313738' TO DFHEIV0(25:11)
 16245     CALL 'kxdfhei1' USING DFHEIV0,
 16246           W-CNTL-FILE-ID,
 16247           DFHEIV20,
 16248           DFHEIV99,
 16249           W-CNTL-KEY,
 16250           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 345
* EL689.cbl
 16251           DFHEIV99,
 16252           DFHEIV99
 16253     SET ADDRESS OF CONTROL-FILE TO
 16254         DFHEIV20
 16255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16256             MOVE CF-FORMS-PRINTER-ID
 16257                                 TO W-TS-TERM-TEXT.
 16258
 16259***********************************************************
 16260*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 16261*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 16262***********************************************************
 16263
 16264     SET W-TS-NDX                TO 1.
 16265     MOVE EIBTIME                TO W-TS-ID-TIME.
 16266     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 16267     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16268
 16269     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16270             VARYING
 16271         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16272             UNTIL
 16273         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16274
 16275*    IF  EIBAID EQUAL DFHPF8
 16276*        MOVE '1'                TO PI-689-PRINT-SW
 16277*    ELSE
 16278         MOVE SPACES             TO PI-689-PRINT-SW.
 16279
 16280
 16281* EXEC CICS HANDLE CONDITION
 16282*         TERMIDERR  (7935-TERM-ERROR)
 16283*         TRANSIDERR (7940-TRAN-ERROR)
 16284*    END-EXEC.
 16285*    MOVE '"$[\                  ! < #00015207' TO DFHEIV0
 16286     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 16287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16288     MOVE X'3C20233030303135323037' TO DFHEIV0(25:11)
 16289     CALL 'kxdfhei1' USING DFHEIV0
 16290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16291
 16292
 16293
 16294* EXEC CICS START
 16295*             INTERVAL    (0)
 16296*             TRANSID     (W-PRINT-TRANS)
 16297*             FROM        (PROGRAM-INTERFACE-BLOCK)
 16298*             LENGTH      (PI-COMM-LENGTH)
 16299*             TERMID      (W-TS-TERM-TEXT)
 16300*    END-EXEC.
 16301     MOVE 0 TO DFHEIV10
 16302*    MOVE '0(ILFT                1   #00015212' TO DFHEIV0
 16303     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 16304     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 16305     MOVE X'2020233030303135323132' TO DFHEIV0(25:11)
 16306     CALL 'kxdfhei1' USING DFHEIV0,
 16307           DFHEIV10,
 16308           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 346
* EL689.cbl
 16309           DFHEIV99,
 16310           PROGRAM-INTERFACE-BLOCK,
 16311           PI-COMM-LENGTH,
 16312           W-TS-TERM-TEXT,
 16313           DFHEIV99,
 16314           DFHEIV99,
 16315           DFHEIV99,
 16316           DFHEIV99,
 16317           DFHEIV99,
 16318           DFHEIV99,
 16319           DFHEIV99,
 16320           DFHEIV99,
 16321           DFHEIV99,
 16322           DFHEIV99
 16323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16324
 16325
 16326
 16327* EXEC CICS SYNCPOINT
 16328*    END-EXEC.
 16329*    MOVE '6"                    !   #00015220' TO DFHEIV0
 16330     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 16331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16332     MOVE X'2020233030303135323230' TO DFHEIV0(25:11)
 16333     CALL 'kxdfhei1' USING DFHEIV0
 16334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16335
 16336
 16337     IF  PI-689-CREATE-NO-SCREENS
 16338         GO TO 7900-EXIT.
 16339
 16340*    IF  EIBAID EQUAL DFHPF8
 16341*            AND
 16342*        PI-SHOW-MODE
 16343*            AND
 16344*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 16345*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 16346
 16347     MOVE ER-0189                TO EMI-ERROR.
 16348     MOVE -1                     TO MAINTL.
 16349
 16350     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16351     MOVE -1                     TO MAINTL
 16352     MOVE AL-UABON               TO MAINTA
 16353     MOVE '104A'                 TO W-TS-ID-TEXT
 16354     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16355                                    W-TS-TERM-SCREEN
 16356     GO TO 8200-SEND-DATAONLY.
 16357
 16358 7900-EXIT.
 16359     EXIT.
 16360
 16361 7915-SEARCH-REMAINING-VARS.
 16362
 16363     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 16364         SET W-RVS-NDX2          TO W-RVS-NDX
 16365         SET W-RVS-NDX2 UP BY +1
 16366         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 347
* EL689.cbl
 16367             SET W-RVS-NDX2 UP BY +1
 16368             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 16369                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 16370                 COMPUTE PI-CURRENT-LINE
 16371                     = PI-CURRENT-LINE / 73
 16372                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 16373                 MOVE +0         TO W-ROLL-COUNTER
 16374                 MOVE ER-0191    TO EMI-ERROR
 16375                 MOVE -1         TO MAINTL
 16376                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16377
 16378 7915-EXIT.
 16379     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 348
* EL689.cbl
 16381 7920-UPDATE-INITIAL-PRINT.
 16382
 16383
 16384* EXEC CICS HANDLE CONDITION
 16385*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 16386*         NOTFND     (1070-ARCH-NOT-FOUND)
 16387*         ENDFILE    (1070-ARCH-NOT-FOUND)
 16388*    END-EXEC.
 16389*    MOVE '"$JI''                 ! = #00015269' TO DFHEIV0
 16390     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 16391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16392     MOVE X'3D20233030303135323639' TO DFHEIV0(25:11)
 16393     CALL 'kxdfhei1' USING DFHEIV0
 16394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16395
 16396     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 16397     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 16398
 16399* EXEC CICS READ
 16400*        DATASET (W-ARCH-FILE-ID)
 16401*        SET     (ADDRESS OF LETTER-ARCHIVE)
 16402*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 16403*        UPDATE
 16404*    END-EXEC.
 16405*    MOVE '&"S        EU         (   #00015276' TO DFHEIV0
 16406     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16407     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16408     MOVE X'2020233030303135323736' TO DFHEIV0(25:11)
 16409     CALL 'kxdfhei1' USING DFHEIV0,
 16410           W-ARCH-FILE-ID,
 16411           DFHEIV20,
 16412           DFHEIV99,
 16413           W-ARCH-PARTIAL-KEY,
 16414           DFHEIV99,
 16415           DFHEIV99,
 16416           DFHEIV99
 16417     SET ADDRESS OF LETTER-ARCHIVE TO
 16418         DFHEIV20
 16419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16420
 16421
 16422     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 16423
 16424     IF  LA-RESEND-DATE = LOW-VALUES
 16425         MOVE 'C'                TO LA-STATUS.
 16426
 16427
 16428* EXEC CICS REWRITE
 16429*         FROM      (LETTER-ARCHIVE)
 16430*         DATASET   (W-ARCH-FILE-ID)
 16431*    END-EXEC.
 16432     MOVE LENGTH OF
 16433      LETTER-ARCHIVE
 16434       TO DFHEIV11
 16435*    MOVE '&& L                  %   #00015288' TO DFHEIV0
 16436     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16437     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16438     MOVE X'2020233030303135323838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 349
* EL689.cbl
 16439     CALL 'kxdfhei1' USING DFHEIV0,
 16440           W-ARCH-FILE-ID,
 16441           LETTER-ARCHIVE,
 16442           DFHEIV11,
 16443           DFHEIV99
 16444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16445
 16446
 16447 7920-EXIT.
 16448     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 350
* EL689.cbl
 16450 7935-TERM-ERROR.
 16451
 16452     MOVE ER-0412                TO EMI-ERROR.
 16453     MOVE SPACES                 TO PI-689-PRINT-SW.
 16454     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16455     MOVE -1                     TO MAINTL.
 16456     GO TO 8200-SEND-DATAONLY.
 16457
 16458 7940-TRAN-ERROR.
 16459
 16460     MOVE ER-0413                TO EMI-ERROR.
 16461     MOVE SPACES                 TO PI-689-PRINT-SW.
 16462     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16463     MOVE -1                     TO MAINTL.
 16464     GO TO 8200-SEND-DATAONLY.
 16465
 16466 7945-NOT-FOUND.
 16467
 16468     MOVE ER-0190                TO EMI-ERROR.
 16469     MOVE -1                     TO MAINTL.
 16470     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16471     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 351
* EL689.cbl
 16473 8010-ARCH-NOT-OPEN.
 16474
 16475     MOVE ER-7388                TO EMI-ERROR.
 16476     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16477     MOVE -1                     TO MAINTL.
 16478     GO TO 8200-SEND-DATAONLY.
 16479
 16480 8015-ARCT-NOT-OPEN.
 16481
 16482     MOVE ER-7373                TO EMI-ERROR.
 16483     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16484     MOVE -1                     TO MAINTL.
 16485     GO TO 8200-SEND-DATAONLY.
 16486
 16487 8020-ACCT-NOT-OPEN.
 16488
 16489     MOVE ER-0168 TO EMI-ERROR
 16490     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16491     MOVE -1                     TO MAINTL.
 16492     GO TO 8200-SEND-DATAONLY.
 16493
 16494 8030-CERT-NOT-OPEN.
 16495
 16496     MOVE ER-0169 TO EMI-ERROR.
 16497     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16498     MOVE -1                     TO MAINTL.
 16499     GO TO 8200-SEND-DATAONLY.
 16500
 16501 8035-CERT-NOT-FOUND.
 16502
 16503     MOVE ER-2369 TO EMI-ERROR.
 16504     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16505     MOVE -1                     TO MAINTL.
 16506     GO TO 8200-SEND-DATAONLY.
 16507
 16508 8040-CNTL-NOT-OPEN.
 16509
 16510     MOVE ER-0042                TO EMI-ERROR.
 16511     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16512     MOVE -1                     TO MAINTL.
 16513     GO TO 8200-SEND-DATAONLY.
 16514
 16515 8045-CHEK-NOT-OPEN.
 16516
 16517     MOVE ER-3775                TO EMI-ERROR.
 16518     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16519     MOVE -1                     TO MAINTL.
 16520     GO TO 8200-SEND-DATAONLY.
 16521
 16522 8050-TEXT-NOT-OPEN.
 16523
 16524     MOVE ER-0013                TO EMI-ERROR.
 16525     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16526     MOVE -1                     TO MAINTL.
 16527     GO TO 8200-SEND-DATAONLY.
 16528
 16529 8060-PNDB-NOT-OPEN.
 16530
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 352
* EL689.cbl
 16531     MOVE ER-2216 TO EMI-ERROR.
 16532     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16533     MOVE -1                     TO MAINTL.
 16534     GO TO 8200-SEND-DATAONLY.
 16535
 16536 8070-PNDB-NOT-FOUND.
 16537
 16538     MOVE ER-7374 TO EMI-ERROR.
 16539     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16540     MOVE -1                     TO MAINTL.
 16541     GO TO 8200-SEND-DATAONLY.
 16542
 16543 8080-COMP-NOT-OPEN.
 16544
 16545     MOVE ER-2055 TO EMI-ERROR
 16546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16547     MOVE -1                     TO MAINTL.
 16548     GO TO 8200-SEND-DATAONLY.
 16549
 16550 8085-PYAJ-NOT-OPEN.
 16551
 16552     MOVE ER-2232 TO EMI-ERROR
 16553     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16554     MOVE -1                     TO MAINTL.
 16555     GO TO 8200-SEND-DATAONLY.
 16556
 16557 8090-MAIL-NOT-OPEN.
 16558
 16559     MOVE ER-2999                TO EMI-ERROR.
 16560     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16561     MOVE -1                     TO MAINTL.
 16562     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 353
* EL689.cbl
 16564 8100-SEND-INITIAL-MAP.
 16565
 16566     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 16567     IF  PI-689-CREATE-NO-SCREENS
 16568         MOVE '9999'             TO PI-689-ERROR
 16569         GO TO 0620-RETURN-TO-CALLER.
 16570
 16571     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16572
 16573     IF  NOT EMI-NO-ERRORS
 16574         MOVE EMI-MESSAGE-AREA (1)
 16575                                 TO ERRMSGO
 16576     ELSE
 16577         MOVE SPACES             TO ERRMSGO.
 16578     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 16579                                 TO SYSO
 16580     MOVE WS-KIXHOST             TO HOSTO
 16581     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 16582        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 16583        MOVE AL-SADOF            TO PF8HDA
 16584     END-IF
 16585     IF NOT PI-CREATE-LABELS
 16586         MOVE AL-PANON           TO ADDRLBLA.
 16587
 16588
 16589* EXEC CICS SEND
 16590*        MAP    (W-MAP)
 16591*        MAPSET (W-MAPSET)
 16592*        FROM   (EL689AO)
 16593*        ERASE
 16594*        CURSOR
 16595*    END-EXEC.
 16596     MOVE LENGTH OF
 16597      EL689AO
 16598       TO DFHEIV12
 16599     MOVE -1
 16600       TO DFHEIV11
 16601*    MOVE '8$     CT  E    H L F ,   #00015434' TO DFHEIV0
 16602     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16603     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16604     MOVE X'2020233030303135343334' TO DFHEIV0(25:11)
 16605     CALL 'kxdfhei1' USING DFHEIV0,
 16606           W-MAP,
 16607           EL689AO,
 16608           DFHEIV12,
 16609           W-MAPSET,
 16610           DFHEIV99,
 16611           DFHEIV99,
 16612           DFHEIV99,
 16613           DFHEIV11,
 16614           DFHEIV99,
 16615           DFHEIV99,
 16616           DFHEIV99
 16617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16618
 16619
 16620     GO TO 9000-RETURN-TRANS.
 16621
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 354
* EL689.cbl
 16622 8100-EXIT.
 16623     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 355
* EL689.cbl
 16625 8200-SEND-DATAONLY.
 16626
 16627     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 16628     IF  PI-689-CREATE-NO-SCREENS
 16629         MOVE '9999'             TO PI-689-ERROR
 16630         GO TO 0620-RETURN-TO-CALLER.
 16631
 16632     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16633
 16634     IF EMI-ERROR = ER-0715
 16635         DISPLAY 'ER 0715'
 16636         MOVE -1          TO CERTIDL
 16637         MOVE +0          TO MAINTL
 16638     END-IF
 16639
 16640     IF  NOT EMI-NO-ERRORS
 16641         MOVE EMI-MESSAGE-AREA (1)
 16642                                 TO ERRMSGO
 16643     ELSE
 16644         MOVE SPACES             TO ERRMSGO.
 16645
 16646
 16647* EXEC CICS SEND
 16648*        MAP    (W-MAP)
 16649*        MAPSET (W-MAPSET)
 16650*        FROM   (EL689AO)
 16651*        DATAONLY
 16652*        CURSOR
 16653*    END-EXEC.
 16654     MOVE LENGTH OF
 16655      EL689AO
 16656       TO DFHEIV12
 16657     MOVE -1
 16658       TO DFHEIV11
 16659*    MOVE '8$D    CT       H L F ,   #00015468' TO DFHEIV0
 16660     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16661     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16662     MOVE X'2020233030303135343638' TO DFHEIV0(25:11)
 16663     CALL 'kxdfhei1' USING DFHEIV0,
 16664           W-MAP,
 16665           EL689AO,
 16666           DFHEIV12,
 16667           W-MAPSET,
 16668           DFHEIV99,
 16669           DFHEIV99,
 16670           DFHEIV99,
 16671           DFHEIV11,
 16672           DFHEIV99,
 16673           DFHEIV99,
 16674           DFHEIV99
 16675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16676
 16677
 16678     GO TO 9000-RETURN-TRANS.
 16679
 16680 8200-EXIT.
 16681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 356
* EL689.cbl
 16683 8300-SEND-TEXT.
 16684
 16685     IF  PI-689-CREATE-NO-SCREENS
 16686         MOVE '9999'             TO PI-689-ERROR
 16687         GO TO 0620-RETURN-TO-CALLER.
 16688
 16689
 16690* EXEC CICS SEND TEXT
 16691*        FROM    (LOGOFF-TEXT)
 16692*        LENGTH  (LOGOFF-LENGTH)
 16693*        ERASE
 16694*        FREEKB
 16695*    END-EXEC.
 16696*    MOVE '8&      T  E F  H   F -   #00015487' TO DFHEIV0
 16697     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16698     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16699     MOVE X'2020233030303135343837' TO DFHEIV0(25:11)
 16700     CALL 'kxdfhei1' USING DFHEIV0,
 16701           LOGOFF-TEXT,
 16702           LOGOFF-LENGTH,
 16703           DFHEIV99,
 16704           DFHEIV99,
 16705           DFHEIV99,
 16706           DFHEIV99,
 16707           DFHEIV99,
 16708           DFHEIV99,
 16709           DFHEIV99,
 16710           DFHEIV99,
 16711           DFHEIV99,
 16712           DFHEIV99
 16713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16714
 16715
 16716     GO TO 9000-RETURN-TRANS.
 16717
 16718 8300-EXIT.
 16719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 357
* EL689.cbl
 16721 8350-SEND-DATAONLY-ERASEAUP.
 16722
 16723     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16724     PERFORM 7760-PUT-TEMP-STORAGE
 16725                                 THRU 7760-EXIT
 16726     IF  PI-689-CREATE-NO-SCREENS
 16727         MOVE '9999'             TO PI-689-ERROR
 16728         GO TO 0620-RETURN-TO-CALLER.
 16729
 16730     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16731
 16732     IF EMI-ERROR = ER-0715
 16733         DISPLAY 'ER 0715'
 16734         MOVE -1          TO CERTIDL
 16735         MOVE +0          TO MAINTL
 16736     END-IF
 16737
 16738     IF  NOT EMI-NO-ERRORS
 16739         MOVE EMI-MESSAGE-AREA (1)
 16740                                 TO ERRMSGO
 16741     ELSE
 16742         MOVE SPACES             TO ERRMSGO.
 16743
 16744
 16745* EXEC CICS SEND
 16746*        MAP      (W-MAP)
 16747*        MAPSET   (W-MAPSET)
 16748*        FROM     (EL689AO)
 16749*        DATAONLY
 16750*        ERASEAUP
 16751*        CURSOR
 16752*    END-EXEC.
 16753     MOVE LENGTH OF
 16754      EL689AO
 16755       TO DFHEIV12
 16756     MOVE -1
 16757       TO DFHEIV11
 16758*    MOVE '8$D    CT  A    H L F ,   #00015522' TO DFHEIV0
 16759     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 16760     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16761     MOVE X'2020233030303135353232' TO DFHEIV0(25:11)
 16762     CALL 'kxdfhei1' USING DFHEIV0,
 16763           W-MAP,
 16764           EL689AO,
 16765           DFHEIV12,
 16766           W-MAPSET,
 16767           DFHEIV99,
 16768           DFHEIV99,
 16769           DFHEIV99,
 16770           DFHEIV11,
 16771           DFHEIV99,
 16772           DFHEIV99,
 16773           DFHEIV99
 16774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16775
 16776
 16777     GO TO 9000-RETURN-TRANS.
 16778
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 358
* EL689.cbl
 16779 8350-EXIT.
 16780     EXIT.
 16781
 16782 8600-DEEDIT.
 16783
 16784
 16785* EXEC CICS BIF DEEDIT
 16786*         FIELD    (W-DEEDIT-FIELD)
 16787*         LENGTH   (15)
 16788*    END-EXEC.
 16789     MOVE 15
 16790       TO DFHEIV11
 16791*    MOVE '@"L                   #   #00015538' TO DFHEIV0
 16792     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 16793     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16794     MOVE X'2020233030303135353338' TO DFHEIV0(25:11)
 16795     CALL 'kxdfhei1' USING DFHEIV0,
 16796           W-DEEDIT-FIELD,
 16797           DFHEIV11
 16798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16799
 16800
 16801 8600-EXIT.
 16802     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 359
* EL689.cbl
 16804 9000-RETURN-TRANS.
 16805
 16806     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 16807     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 16808     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 16809     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 16810
 16811* EXEC CICS RETURN
 16812*        TRANSID    (W-TRANSACTION)
 16813*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 16814*        LENGTH     (PI-COMM-LENGTH)
 16815*    END-EXEC.
 16816*    MOVE '.(CT                  ''   #00015552' TO DFHEIV0
 16817     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16818     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16819     MOVE X'2020233030303135353532' TO DFHEIV0(25:11)
 16820     CALL 'kxdfhei1' USING DFHEIV0,
 16821           W-TRANSACTION,
 16822           PROGRAM-INTERFACE-BLOCK,
 16823           PI-COMM-LENGTH,
 16824           DFHEIV99,
 16825           DFHEIV99,
 16826           DFHEIV99
 16827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16828
 16829*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 16830*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16831*    GO TO 0200-RECEIVE.
 16832
 16833 9000-EXIT.
 16834     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 360
* EL689.cbl
 16836 9200-PA.
 16837
 16838     MOVE ER-0008                TO EMI-ERROR.
 16839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16840     MOVE -1                     TO MAINTL.
 16841     GO TO 8200-SEND-DATAONLY.
 16842
 16843 9200-EXIT.
 16844     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 361
* EL689.cbl
 16846 9300-DFHCLEAR.
 16847
 16848     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 16849         MOVE '2'                TO PI-ACTION.
 16850
 16851     IF  PI-CLEAR-MODE
 16852         MOVE PI-RETURN-TO-PROGRAM
 16853                                 TO W-CALL-PGM
 16854         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16855         GO TO 9400-XCTL
 16856     ELSE
 16857         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16858         MOVE LOW-VALUES         TO EL689AO
 16859                                    PI-1042-WA
 16860                                    PI-689-WORK-AREA
 16861         MOVE ZEROS              TO PI-CURRENT-LINE
 16862                                    PI-TEMP-STOR-ITEMS
 16863                                    PI-TOTAL-LINES
 16864                                    PI-UPDATE-SW
 16865                                    PI-689-NUMBER-LABEL-LINES
 16866         MOVE SPACES             TO PI-689-PRINT-SW
 16867                                    PI-689-ALT-PRINTER-ID
 16868                                    PI-COMM-CONTROL
 16869                                    PI-689-FORM-NUMBER
 16870                                    PI-689-TEMP-STOR-ID
 16871                                    PI-689-LABEL-SOURCE
 16872                                    PI-689-USE-SCREEN-IND
 16873         MOVE '2'                TO PI-ACTION
 16874         MOVE -1                 TO MAINTL
 16875         GO TO 8100-SEND-INITIAL-MAP.
 16876
 16877 9300-EXIT.
 16878     EXIT.
 16879
 16880 9400-XCTL.
 16881
 16882
 16883* EXEC CICS XCTL
 16884*        PROGRAM  (W-CALL-PGM)
 16885*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 16886*        LENGTH   (PI-COMM-LENGTH)
 16887*    END-EXEC.
 16888*    MOVE '.$C                   %   #00015610' TO DFHEIV0
 16889     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16890     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16891     MOVE X'2020233030303135363130' TO DFHEIV0(25:11)
 16892     CALL 'kxdfhei1' USING DFHEIV0,
 16893           W-CALL-PGM,
 16894           PROGRAM-INTERFACE-BLOCK,
 16895           PI-COMM-LENGTH,
 16896           DFHEIV99
 16897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16898
 16899
 16900 9400-EXIT.
 16901     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 362
* EL689.cbl
 16903 9500-LINK-DATE-CONVERT.
 16904
 16905     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 16906             AND
 16907         DC-OPTION-CODE EQUAL ' '
 16908         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 16909         GO TO 9500-EXIT.
 16910
 16911
 16912* EXEC CICS LINK
 16913*        PROGRAM    ('ELDATCV')
 16914*        COMMAREA   (DATE-CONVERSION-DATA)
 16915*        LENGTH     (DC-COMM-LENGTH)
 16916*    END-EXEC.
 16917     MOVE 'ELDATCV' TO DFHEIV1
 16918*    MOVE '."C                   (   #00015627' TO DFHEIV0
 16919     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16920     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16921     MOVE X'2020233030303135363237' TO DFHEIV0(25:11)
 16922     CALL 'kxdfhei1' USING DFHEIV0,
 16923           DFHEIV1,
 16924           DATE-CONVERSION-DATA,
 16925           DC-COMM-LENGTH,
 16926           DFHEIV99,
 16927           DFHEIV99,
 16928           DFHEIV99,
 16929           DFHEIV99
 16930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16931
 16932
 16933     IF  NO-CONVERSION-ERROR
 16934             AND
 16935         PI-COMPANY-ID EQUAL 'AUK'
 16936             AND
 16937         W-REVERSE-DATE
 16938         MOVE DC-GREG-DATE-1-EDIT
 16939                                 TO W-EDIT-DATE-1
 16940         MOVE W-ED1-MM           TO W-ED2-MM
 16941         MOVE W-ED1-DD           TO W-ED2-DD
 16942         MOVE W-ED1-YY           TO W-ED2-YY
 16943         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 16944
 16945 9500-EXIT.
 16946     EXIT.
 16947
 16948 9600-FORMAT-DATE-TIME.
 16949
 16950     MOVE W-SAVE-DATE            TO RUNDTEO.
 16951     MOVE EIBTIME                TO W-TIME-IN.
 16952     MOVE W-TIME-OUT             TO RUNTIMEO.
 16953     MOVE PI-COMPANY-ID          TO COMPANYO.
 16954     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16955     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 16956
 16957 9600-EXIT.
 16958     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 363
* EL689.cbl
 16960 9700-PGMID-ERROR.
 16961
 16962     IF  PI-689-CREATE-NO-SCREENS
 16963         MOVE '9999'             TO PI-689-ERROR
 16964         GO TO 0620-RETURN-TO-CALLER.
 16965
 16966
 16967* EXEC CICS  HANDLE CONDITION
 16968*        PGMIDERR  (8300-SEND-TEXT)
 16969*    END-EXEC.
 16970*    MOVE '"$L                   ! > #00015666' TO DFHEIV0
 16971     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16973     MOVE X'3E20233030303135363636' TO DFHEIV0(25:11)
 16974     CALL 'kxdfhei1' USING DFHEIV0
 16975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16976
 16977
 16978     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 16979     MOVE ' '                    TO PI-ENTRY-CD-1.
 16980     MOVE W-XCTL-005             TO W-CALL-PGM
 16981                                    LOGOFF-PGM.
 16982     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16983
 16984     PERFORM 9400-XCTL THRU 9400-EXIT.
 16985
 16986 9700-EXIT.
 16987     EXIT.
 16988
 16989 9800-ABEND.
 16990
 16991     IF  PI-689-CREATE-NO-SCREENS
 16992         MOVE '9999'             TO PI-689-ERROR
 16993         GO TO 0620-RETURN-TO-CALLER.
 16994
 16995     MOVE W-LINK-004             TO W-CALL-PGM.
 16996     MOVE DFHEIBLK               TO EMI-LINE1
 16997
 16998
 16999* EXEC CICS  LINK
 17000*        PROGRAM   (W-CALL-PGM)
 17001*        COMMAREA  (EMI-LINE1)
 17002*        LENGTH    (72)
 17003*    END-EXEC.
 17004     MOVE 72
 17005       TO DFHEIV11
 17006*    MOVE '."C                   (   #00015690' TO DFHEIV0
 17007     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17009     MOVE X'2020233030303135363930' TO DFHEIV0(25:11)
 17010     CALL 'kxdfhei1' USING DFHEIV0,
 17011           W-CALL-PGM,
 17012           EMI-LINE1,
 17013           DFHEIV11,
 17014           DFHEIV99,
 17015           DFHEIV99,
 17016           DFHEIV99,
 17017           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 364
* EL689.cbl
 17018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17019
 17020
 17021     GO TO 8200-SEND-DATAONLY.
 17022
 17023 9800-EXIT.
 17024     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 365
* EL689.cbl
 17026 9900-ERROR-FORMAT.
 17027
 17028     IF  PI-689-CREATE-NO-SCREENS
 17029         MOVE EMI-ERROR          TO PI-689-ERROR
 17030         IF  PI-689-FATAL-ERROR
 17031             GO TO 0620-RETURN-TO-CALLER
 17032         ELSE
 17033             GO TO 9900-EXIT.
 17034
 17035     IF  EMI-ERROR EQUAL ER-9097
 17036         NEXT SENTENCE
 17037     ELSE
 17038         IF  EMI-ERRORS-COMPLETE
 17039                 OR
 17040             EMI-ERROR EQUAL W-LAST-ERROR
 17041             GO TO 9900-EXIT.
 17042
 17043     MOVE W-LINK-001             TO W-CALL-PGM.
 17044
 17045
 17046* EXEC CICS LINK
 17047*        PROGRAM    (W-CALL-PGM)
 17048*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17049*        LENGTH     (EMI-COMM-LENGTH)
 17050*    END-EXEC.
 17051*    MOVE '."C                   (   #00015720' TO DFHEIV0
 17052     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17054     MOVE X'2020233030303135373230' TO DFHEIV0(25:11)
 17055     CALL 'kxdfhei1' USING DFHEIV0,
 17056           W-CALL-PGM,
 17057           ERROR-MESSAGE-INTERFACE-BLOCK,
 17058           EMI-COMM-LENGTH,
 17059           DFHEIV99,
 17060           DFHEIV99,
 17061           DFHEIV99,
 17062           DFHEIV99
 17063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17064
 17065
 17066     IF  EMI-SEVERITY (2) EQUAL 'X'
 17067             AND
 17068         EMI-SEVERITY (1) NOT EQUAL 'X'
 17069         MOVE EMI-MESSAGE-AREA (2)
 17070                                 TO EMI-MESSAGE-AREA (1).
 17071
 17072     MOVE EMI-ERROR              TO W-LAST-ERROR.
 17073
 17074 9900-EXIT.
 17075     EXIT.
 17076
 17077 9905-INITIALIZE-SECURITY.
 17078******************************************************************
 17079*                                                                *
 17080*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 17081*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 17082*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 17083*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 366
* EL689.cbl
 17084*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 17085*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 17086*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 17087*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 17088*                                                                *
 17089*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 17090*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 17091*                                                                *
 17092******************************************************************
 17093
 17094     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 17095         MOVE 'Y'                TO PI-DISPLAY-CAP
 17096                                    PI-MODIFY-CAP
 17097     ELSE
 17098
 17099* EXEC CICS READQ TS
 17100*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 17101*            INTO   (SECURITY-CONTROL)
 17102*            LENGTH (SC-COMM-LENGTH)
 17103*            ITEM   (1)
 17104*        END-EXEC
 17105     MOVE 1
 17106       TO DFHEIV11
 17107*    MOVE '*$II   L              ''   #00015758' TO DFHEIV0
 17108     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 17109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17110     MOVE X'2020233030303135373538' TO DFHEIV0(25:11)
 17111     CALL 'kxdfhei1' USING DFHEIV0,
 17112           PI-SECURITY-TEMP-STORE-ID,
 17113           SECURITY-CONTROL,
 17114           SC-COMM-LENGTH,
 17115           DFHEIV11,
 17116           DFHEIV99,
 17117           DFHEIV99
 17118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17119         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 17120                                 TO PI-DISPLAY-CAP
 17121         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 17122                                 TO PI-MODIFY-CAP.
 17123
 17124 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 367
* EL689.cbl
 17126 9995-SECURITY-VIOLATION.
 17127
 17128     MOVE EIBDATE                TO SM-JUL-DATE.
 17129     MOVE EIBTRMID               TO SM-TERMID.
 17130     MOVE W-THIS-PGM             TO SM-PGM.
 17131     MOVE EIBTIME                TO W-TIME-IN.
 17132     MOVE W-TIME-OUT             TO SM-TIME.
 17133     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 17134
 17135
 17136* EXEC CICS LINK
 17137*         PROGRAM  ('EL003')
 17138*         COMMAREA (SECURITY-MESSAGE)
 17139*         LENGTH   (80)
 17140*    END-EXEC.
 17141     MOVE 'EL003' TO DFHEIV1
 17142     MOVE 80
 17143       TO DFHEIV11
 17144*    MOVE '."C                   (   #00015780' TO DFHEIV0
 17145     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17147     MOVE X'2020233030303135373830' TO DFHEIV0(25:11)
 17148     CALL 'kxdfhei1' USING DFHEIV0,
 17149           DFHEIV1,
 17150           SECURITY-MESSAGE,
 17151           DFHEIV11,
 17152           DFHEIV99,
 17153           DFHEIV99,
 17154           DFHEIV99,
 17155           DFHEIV99
 17156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17157
 17158
 17159 9995-EXIT.
 17160     EXIT.
 17161
 17162 9999-GOBACK.
 17163
 17164
 17165* GOBACK.
 17166     MOVE '9%                    "   ' TO DFHEIV0
 17167     MOVE 'EL689' TO DFHEIV1
 17168     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17169     GOBACK.
 17170
 17171 9999-EXIT.
 17172     EXIT.
 17173
 17174 9999-DFHBACK SECTION.
 17175     MOVE '9%                    "   ' TO DFHEIV0
 17176     MOVE 'EL689' TO DFHEIV1
 17177     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17178     GOBACK.
 17179 9999-DFHEXIT.
 17180     IF DFHEIGDJ EQUAL 0001
 17181         NEXT SENTENCE
 17182     ELSE IF DFHEIGDJ EQUAL 2
 17183         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 368
* EL689.cbl
 17184               9200-PA,
 17185               9200-PA,
 17186               9200-PA
 17187         DEPENDING ON DFHEIGDI
 17188     ELSE IF DFHEIGDJ EQUAL 3
 17189         GO TO 9700-PGMID-ERROR,
 17190               9800-ABEND,
 17191               0325-MAPFAIL
 17192         DEPENDING ON DFHEIGDI
 17193     ELSE IF DFHEIGDJ EQUAL 4
 17194         GO TO 8040-CNTL-NOT-OPEN,
 17195               7945-NOT-FOUND
 17196         DEPENDING ON DFHEIGDI
 17197     ELSE IF DFHEIGDJ EQUAL 5
 17198         GO TO 9700-PGMID-ERROR,
 17199               0325-MAPFAIL,
 17200               9800-ABEND
 17201         DEPENDING ON DFHEIGDI
 17202     ELSE IF DFHEIGDJ EQUAL 6
 17203         GO TO 0990-CARRIER-NOT-FOUND,
 17204               8040-CNTL-NOT-OPEN
 17205         DEPENDING ON DFHEIGDI
 17206     ELSE IF DFHEIGDJ EQUAL 7
 17207         GO TO 0994-STATE-NOT-FOUND,
 17208               8040-CNTL-NOT-OPEN
 17209         DEPENDING ON DFHEIGDI
 17210     ELSE IF DFHEIGDJ EQUAL 8
 17211         GO TO 8010-ARCH-NOT-OPEN,
 17212               1070-ARCH-NOT-FOUND,
 17213               1070-ARCH-NOT-FOUND
 17214         DEPENDING ON DFHEIGDI
 17215     ELSE IF DFHEIGDJ EQUAL 9
 17216         GO TO 2001-NOT-FOUND,
 17217               2001-NOT-FOUND,
 17218               8050-TEXT-NOT-OPEN
 17219         DEPENDING ON DFHEIGDI
 17220     ELSE IF DFHEIGDJ EQUAL 10
 17221         GO TO 2000-ENDBR
 17222         DEPENDING ON DFHEIGDI
 17223     ELSE IF DFHEIGDJ EQUAL 11
 17224         GO TO 8040-CNTL-NOT-OPEN,
 17225               6200-CNTL1-NOT-FOUND
 17226         DEPENDING ON DFHEIGDI
 17227     ELSE IF DFHEIGDJ EQUAL 12
 17228         GO TO 8040-CNTL-NOT-OPEN,
 17229               6250-CNTL2-NOT-FOUND
 17230         DEPENDING ON DFHEIGDI
 17231     ELSE IF DFHEIGDJ EQUAL 13
 17232         GO TO 8040-CNTL-NOT-OPEN,
 17233               6300-CNTL6-NOT-FOUND
 17234         DEPENDING ON DFHEIGDI
 17235     ELSE IF DFHEIGDJ EQUAL 14
 17236         GO TO 8040-CNTL-NOT-OPEN,
 17237               6350-CNTL2-NOT-FOUND
 17238         DEPENDING ON DFHEIGDI
 17239     ELSE IF DFHEIGDJ EQUAL 15
 17240         GO TO 8060-PNDB-NOT-OPEN,
 17241               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 369
* EL689.cbl
 17242         DEPENDING ON DFHEIGDI
 17243     ELSE IF DFHEIGDJ EQUAL 16
 17244         GO TO 8030-CERT-NOT-OPEN,
 17245               8035-CERT-NOT-FOUND
 17246         DEPENDING ON DFHEIGDI
 17247     ELSE IF DFHEIGDJ EQUAL 17
 17248         GO TO 8020-ACCT-NOT-OPEN,
 17249               6500-ACCT-NOT-FOUND,
 17250               6500-ONLY-STOP
 17251         DEPENDING ON DFHEIGDI
 17252     ELSE IF DFHEIGDJ EQUAL 18
 17253         GO TO 8080-COMP-NOT-OPEN,
 17254               6600-COMP-NOT-FOUND
 17255         DEPENDING ON DFHEIGDI
 17256     ELSE IF DFHEIGDJ EQUAL 19
 17257         GO TO 8040-CNTL-NOT-OPEN,
 17258               6630-CNTL2-NOT-FOUND
 17259         DEPENDING ON DFHEIGDI
 17260     ELSE IF DFHEIGDJ EQUAL 20
 17261         GO TO 8090-MAIL-NOT-OPEN,
 17262               6700-MAIL-NOT-FOUND
 17263         DEPENDING ON DFHEIGDI
 17264     ELSE IF DFHEIGDJ EQUAL 21
 17265         GO TO 8040-CNTL-NOT-OPEN,
 17266               6750-EXIT
 17267         DEPENDING ON DFHEIGDI
 17268     ELSE IF DFHEIGDJ EQUAL 22
 17269         GO TO 8040-CNTL-NOT-OPEN,
 17270               6800-EXIT
 17271         DEPENDING ON DFHEIGDI
 17272     ELSE IF DFHEIGDJ EQUAL 23
 17273         GO TO 8045-CHEK-NOT-OPEN,
 17274               6850-CHEK-NOT-FOUND
 17275         DEPENDING ON DFHEIGDI
 17276     ELSE IF DFHEIGDJ EQUAL 24
 17277         GO TO 8085-PYAJ-NOT-OPEN,
 17278               6900-PYAJ-NOT-FOUND
 17279         DEPENDING ON DFHEIGDI
 17280     ELSE IF DFHEIGDJ EQUAL 25
 17281         GO TO 7700-TS-ERROR,
 17282               7700-TS-ERROR
 17283         DEPENDING ON DFHEIGDI
 17284     ELSE IF DFHEIGDJ EQUAL 26
 17285         GO TO 7780-EXIT
 17286         DEPENDING ON DFHEIGDI
 17287     ELSE IF DFHEIGDJ EQUAL 27
 17288         GO TO 8040-CNTL-NOT-OPEN,
 17289               7945-NOT-FOUND
 17290         DEPENDING ON DFHEIGDI
 17291     ELSE IF DFHEIGDJ EQUAL 28
 17292         GO TO 7935-TERM-ERROR,
 17293               7940-TRAN-ERROR
 17294         DEPENDING ON DFHEIGDI
 17295     ELSE IF DFHEIGDJ EQUAL 29
 17296         GO TO 8010-ARCH-NOT-OPEN,
 17297               1070-ARCH-NOT-FOUND,
 17298               1070-ARCH-NOT-FOUND
 17299         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page 370
* EL689.cbl
 17300     ELSE IF DFHEIGDJ EQUAL 30
 17301         GO TO 8300-SEND-TEXT
 17302         DEPENDING ON DFHEIGDI.
 17303     MOVE '9%                    "   ' TO DFHEIV0
 17304     MOVE 'EL689' TO DFHEIV1
 17305     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17306     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       98940     Code:       57549
