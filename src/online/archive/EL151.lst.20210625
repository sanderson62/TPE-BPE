* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page   1
* EL151.cbl
* Options: int("EL151.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL151.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL151.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL151.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL151 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/06/95 13:08:11.
     7*                            VMOD=2.012.
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page   2
* EL151.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24******************************************************************
    25*                   C H A N G E   L O G
    26*
    27* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    28*-----------------------------------------------------------------
    29*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    30* EFFECTIVE    NUMBER
    31*-----------------------------------------------------------------
    32* 050506    2006030600001  AJRA  ADD PROOF DATE TO DENIAL SCREEN
    33* 120808    2008100900001  PEMA  ADD FOR DENIAL CODE
    34* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    35* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    36* 043019  IR2019042300001  PEMA  DISALLOW PROOF DT > REC DT OR < I
    37******************************************************************
    38*REMARKS.
    39
    40*    SCREENS     - EL151S - DENIALS
    41
    42*    ENTERED BY  - EL150 - STATUS AND DISPOSITION
    43
    44*    EXIT TO     - EL150 - CALLING PROGRAM
    45
    46*    INPUT FILE  - ELMSTR - CLAIM MASTER
    47*                - ELTRLR - ACTIVITY TRAILERS
    48*                - ERNOTE - CERTIFICATE NOTES
    49
    50*    OUTPUT FILE - ELMSTR - CLAIM MASTER
    51*                - ELTRLR - ACTIVITY TRAILERS
    52
    53*    COMMAREA    - PASSED
    54
    55*    ERROR-CODES ACCESSED - 132,  133, 270, 137, 29, 315, 008, 50
    56
    57*    NARRATIVE   - 1- PROVIDE CREATION OF DENIAL TRAILERS
    58*                  2- UPDATE CLAIM STATUS TYPE TO CLOSED (ELMSTR)
    59*                  3- UPDATE RESERVE-EXPENSE TRAILER STATUS TO
    60*                     CLOSED, REASON DENIAL
    61
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page   3
* EL151.cbl
    63 ENVIRONMENT DIVISION.
    64
    65 DATA DIVISION.
    66
    67 WORKING-STORAGE SECTION.
    68 01  DFH-START PIC X(04).
    69
    70 77  FILLER  PIC X(32)  VALUE '********************************'.
    71 77  FILLER  PIC X(32)  VALUE '*   EL151  WORKING STORAGE     *'.
    72 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.012 ********'.
    73
    74*                            COPY ELCSCTM.
    75******************************************************************
    76*                                                                *
    77*                                                                *
    78*                            ELCSCTM                             *
    79*                            VMOD=2.001                          *
    80*                                                                *
    81*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    82*                                                                *
    83******************************************************************
    84 01  SECURITY-MESSAGE.
    85     12  FILLER                          PIC X(30)
    86            VALUE '** LOGIC SECURITY VIOLATION -'.
    87     12  SM-READ                         PIC X(6).
    88     12  FILLER                          PIC X(5)
    89            VALUE ' PGM='.
    90     12  SM-PGM                          PIC X(6).
    91     12  FILLER                          PIC X(5)
    92            VALUE ' OPR='.
    93     12  SM-PROCESSOR-ID                 PIC X(4).
    94     12  FILLER                          PIC X(6)
    95            VALUE ' TERM='.
    96     12  SM-TERMID                       PIC X(4).
    97     12  FILLER                          PIC XX   VALUE SPACE.
    98     12  SM-JUL-DATE                     PIC 9(5).
    99     12  FILLER                          PIC X    VALUE SPACE.
   100     12  SM-TIME                         PIC 99.99.
   101
   102
   103*                            COPY ELCSCRTY.
   104******************************************************************
   105*                                                                *
   106*                                                                *
   107*                            ELCSCRTY                            *
   108*                            VMOD=2.001                          *
   109*                                                                *
   110*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   111*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   112*        SAVED IN PI-SECURITY-ADDRESS.                           *
   113*                                                                *
   114******************************************************************
   115 01  SECURITY-CONTROL.
   116     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   117     12  FILLER                       PIC XX    VALUE 'SC'.
   118     12  SC-CREDIT-CODES.
   119         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   120             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page   4
* EL151.cbl
   121             20  SC-CREDIT-UPDATE     PIC X.
   122     12  SC-CLAIMS-CODES.
   123         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   124             20  SC-CLAIMS-DISPLAY    PIC X.
   125             20  SC-CLAIMS-UPDATE     PIC X.
   126
   127*                            COPY ELCNWA.
   128*****************************************************************
   129*                                                               *
   130*                                                               *
   131*                            ELCNWA.                            *
   132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   133*                            VMOD=2.003                         *
   134*                                                               *
   135*            M O V E   N A M E   W O R K   A R E A.             *
   136*                                                               *
   137*****************************************************************.
   138
   139 01  WS-NAME-WORK-AREA.
   140     05  WS-INSURED-LAST-NAME        PIC X(15).
   141     05  WS-INSURED-1ST-NAME         PIC X(12).
   142     05  WS-INSURED-MID-INIT         PIC X.
   143
   144     05  WS-NAME-WORK.
   145         10  WS-NW                   PIC X
   146             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   147
   148     05  WS-NAME-WORK2.
   149         10  WS-NW2                  PIC X
   150             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   151                                        NWA-INDEX0.
   152
   153     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   154                                     COMP-3.
   155
   156
   157 01  WS-DATE-AREA.
   158     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   159     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   160     05  WS-BLANK            PIC X       VALUE ' '.
   161
   162 01  WS-SCRATCH-AREA.
   163     05  GETMAIN-SPACE               PIC X     VALUE SPACE.
   164     05  WS-TRLR-LENGTH              PIC S9(4) VALUE +200  COMP.
   165     05  WS-DMO-LENGTH               PIC S9(4) VALUE +108  COMP.
   166     05  WS-DCT-LENGTH               PIC S9(4) VALUE +53   COMP.
   167     05  SC-ITEM                     PIC S9(4) VALUE +0001 COMP.
   168
   169     05  WS-TRANS-ID                 PIC X(4)   VALUE 'EX32'.
   170     05  WS-SEQ-NO-SAVED             PIC S9(4)   VALUE ZEROS.
   171
   172     05  WS-ORIG-SEQ-CNT             PIC S9(4)   VALUE ZEROS.
   173
   174     05  TR-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   175     05  TR-SUB-2                    PIC S9(4)   VALUE ZERO  COMP.
   176     05  MISC-SUB                    PIC S9(03)  COMP-3  VALUE +0.
   177
   178     05  MAP-NAME                    PIC X(08)   VALUE 'EL151A'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page   5
* EL151.cbl
   179     05  MAPSET-NAME                 PIC X(08)   VALUE 'EL151S'.
   180
   181     05  ELTRLR-FILE-ID              PIC X(08)   VALUE 'ELTRLR'.
   182     05  ELMSTR-FILE-ID              PIC X(08)   VALUE 'ELMSTR'.
   183     05  ELCNTL-FILE-ID              PIC X(08)   VALUE 'ELCNTL'.
   184     05  ELARCH-FILE-ID              PIC X(08)   VALUE 'ELARCH'.
   185
   186     05  THIS-PGM                    PIC X(08)   VALUE  'EL151'.
   187
   188     05  WS-OC-LOAD-SW               PIC X(01)   VALUE SPACE.
   189         88  OC-HISTORY-LOADED       VALUE 'X'.
   190
   191     05  WS-CLAIM-SEQ-SW             PIC X(01)   VALUE SPACE.
   192         88  NO-SEQ-NUMBER           VALUE 'X'.
   193         88  SEQ-NUMBER-EXIST        VALUE ' '.
   194         88  NO-ACCT-TRLR            VALUE 'Y'.
   195
   196     05  WS-RESET-SW                 PIC X(01)   VALUE 'N'.
   197     05  WS-REC-FOUND-SW             PIC X(01)   VALUE 'N'.
   198     05  WS-BROWSE-SW                PIC X(01)   VALUE 'N'.
   199     05  WS-UPDATE-SW                PIC X(01)   VALUE 'N'.
   200
   201     05  TIME-IN                     PIC S9(7).
   202     05  TIME-OUT-R REDEFINES TIME-IN.
   203         10  FILLER                  PIC X(01).
   204         10  TIME-OUT                PIC 99V99.
   205         10  FILLER                  PIC X(02).
   206
   207     05  DEEDIT-FIELD                PIC X(15).
   208     05  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   209
   210     05  WS-PRF-DT                   PIC X(2).
   211     05  WS-MAX-LETTER-ANSWER-DT     PIC X(2)  VALUE LOW-VALUES.
   212
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page   6
* EL151.cbl
   214     05  DENIAL-TABLE.
   215         10  FILLER                  PIC X(44)    VALUE
   216             'DPE  PRE-EXISTING DISABILITY                '.
   217         10  FILLER                  PIC X(44)    VALUE
   218             'DDN  DISABILITY NOT COVERED DUE TO NATURE   '.
   219         10  FILLER                  PIC X(44)    VALUE
   220             'DIR  INSURED RECOVERED FROM DISABILITY      '.
   221         10  FILLER                  PIC X(44)    VALUE
   222             'DEM  EMPLOYMENT INDICATES OCCUPATION NOT MET'.
   223         10  FILLER                  PIC X(44)    VALUE
   224             'DWP  DISABILITY WAITING PERIOD NOT SATISFIED'.
   225         10  FILLER                  PIC X(44)    VALUE
   226             'DNC  NO COVERAGE                            '.
   227         10  FILLER                  PIC X(44)    VALUE
   228             'DAP  APPLICATION MISREPRESENTATION          '.
   229         10  FILLER                  PIC X(44)    VALUE
   230             'DMA  MIS-STATEMENT OF AGE                   '.
   231         10  FILLER                  PIC X(44)    VALUE
   232             'DSU  SUICIDE OR SELF-INFLICTED INJURY       '.
   233         10  FILLER                  PIC X(44)    VALUE
   234             'DOT  OTHER                                  '.
   235         10  FILLER                  PIC X(44)    VALUE
   236             'DAR  AWARE OF UNEMPLOY./RED. AT INCEPTION   '.
   237         10  FILLER                  PIC X(44)    VALUE
   238             'DNE  NOT EMPLOYED SIX MONTHS PRIOR          '.
   239         10  FILLER                  PIC X(44)    VALUE
   240             'DNR  NOT MADE REDUNDANT/NOT UNEMPLOYED      '.
   241         10  FILLER                  PIC X(44)    VALUE
   242             'DSE  SELF EMPLOYED                          '.
   243         10  FILLER                  PIC X(44)    VALUE
   244             'DTW  TEMPORARY WORK                         '.
   245         10  FILLER                  PIC X(44)    VALUE
   246             'LAP  APPLICATION MISREPRESENTATION          '.
   247         10  FILLER                  PIC X(44)    VALUE
   248             'LMA  MIS-STATEMENT OF AGE                   '.
   249         10  FILLER                  PIC X(44)    VALUE
   250             'LNC  NO COVERAGE                            '.
   251         10  FILLER                  PIC X(44)    VALUE
   252             'LOT  OTHER                                  '.
   253     05  DEN-TABLE REDEFINES DENIAL-TABLE OCCURS 19
   254         INDEXED BY DEN-INDEX.
   255         10  DENIAL-CODE.
   256             15  DENIAL-1-1          PIC X(01).
   257             15  DENIAL-2-3          PIC X(02).
   258             15  DENIAL-4-4          PIC X(01).
   259         10  FILLER                  PIC X(01).
   260         10  DENIAL-DESC             PIC X(39).
   261
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page   7
* EL151.cbl
   263 01  ACCESS-KEYS.
   264     05  WS-TRAILER-KEY.
   265         10  WS-CLAIM-KEY.
   266             15  WS-KEY-COMPANY-CD       PIC X.
   267             15  WS-KEY-CARRIER          PIC X.
   268             15  WS-KEY-CLAIM-NO         PIC X(7).
   269             15  WS-KEY-CERT-NO.
   270                 20  WS-KEY-CERT-PRIME   PIC X(10).
   271                 20  WS-KEY-CERT-SFX     PIC X.
   272         10  WS-KEY-SEQUENCE-NO      PIC   S9(4) COMP.
   273
   274     05  ELARCH-KEY.
   275         10  ELARCH-COMPANY-CD   PIC X(01).
   276         10  ELARCH-ARCHIVE-NO   PIC S9(08)  COMP.
   277         10  ELARCH-RECORD-TYPE  PIC X(01).
   278         10  ELARCH-SEQ-NO       PIC S9(04)  COMP.
   279
   280     05  WS-ELDENY-KEY.
   281         10  ELDENY-COMPANY-CD   PIC X.
   282         10  ELDENY-DENIAL-CODE  PIC X(4).
   283         10  FILLER              PIC X(10).
   284     05  ELCNTL-KEY.
   285         10  ELCNTL-COMPANY-ID   PIC X(03).
   286         10  ELCNTL-RECORD-TYPE  PIC X(01).
   287         10  ELCNTL-ACCESS       PIC X(04).
   288         10  ELCNTL-SEQ-NO       PIC S9(04)  COMP.
   289
   290     05  W-NOTE-KEY.
   291         10  W-NOTE-COMP-CD      PIC X.
   292         10  W-NOTE-CERT-KEY.
   293             16  W-NOTE-CARRIER  PIC X.
   294             16  W-NOTE-GROUPING PIC X(6).
   295             16  W-NOTE-STATE    PIC XX.
   296             16  W-NOTE-ACCOUNT  PIC X(10).
   297             16  W-NOTE-EFF-DT   PIC XX.
   298             16  W-NOTE-CERT-NO  PIC X(11).
   299
   300 01  WS-RESPONSE             PIC S9(8)   COMP.
   301     88  RESP-NORMAL              VALUE +00.
   302     88  RESP-ERROR               VALUE +01.
   303     88  RESP-NOTFND              VALUE +13.
   304     88  RESP-NOTOPEN             VALUE +19.
   305     88  RESP-ENDFILE             VALUE +20.
   306 01  ERROR-MESSAGES.
   307     12  ER-0000                 PIC X(4)  VALUE '0000'.
   308     12  ER-0004                 PIC X(4)  VALUE '0004'.
   309     12  ER-0008                 PIC X(4)  VALUE '0008'.
   310     12  ER-0021                 PIC X(4)  VALUE '0021'.
   311     12  ER-0029                 PIC X(4)  VALUE '0029'.
   312     12  ER-0050                 PIC X(4)  VALUE '0050'.
   313     12  ER-0070                 PIC X(4)  VALUE '0070'.
   314     12  ER-0132                 PIC X(4)  VALUE '0132'.
   315     12  ER-0133                 PIC X(4)  VALUE '0133'.
   316     12  ER-0137                 PIC X(4)  VALUE '0137'.
   317     12  ER-0154                 PIC X(4)  VALUE '0154'.
   318     12  ER-0172                 PIC X(4)  VALUE '0172'.
   319     12  ER-0270                 PIC X(4)  VALUE '0270'.
   320     12  ER-0483                 PIC X(4)  VALUE '0483'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page   8
* EL151.cbl
   321     12  ER-0872                 PIC X(4)  VALUE '0872'.
   322     12  ER-0873                 PIC X(4)  VALUE '0873'.
   323     12  ER-0884                 PIC X(4)  VALUE '0884'.
   324     12  ER-0919                 PIC X(4)  VALUE '0919'.
   325     12  ER-0921                 PIC X(4)  VALUE '0921'.
   326     12  ER-0946                 PIC X(4)  VALUE '0946'.
   327     12  ER-0947                 PIC X(4)  VALUE '0947'.
   328     12  ER-0948                 PIC X(4)  VALUE '0948'.
   329     12  ER-0949                 PIC X(4)  VALUE '0949'.
   330     12  ER-0950                 PIC X(4)  VALUE '0950'.
   331     12  ER-0951                 PIC X(4)  VALUE '0951'.
   332     12  ER-0954                 PIC X(4)  VALUE '0954'.
   333     12  ER-0974                 PIC X(4)  VALUE '0974'.
   334     12  ER-0975                 PIC X(4)  VALUE '0975'.
   335     12  ER-8051                 PIC X(4)  VALUE '8051'.
   336     12  ER-8052                 PIC X(4)  VALUE '8052'.
   337     12  ER-8053                 PIC X(4)  VALUE '8053'.
   338     12  ER-8054                 PIC X(4)  VALUE '8054'.
   339     12  ER-8055                 PIC X(4)  VALUE '8055'.
   340     12  ER-8056                 PIC X(4)  VALUE '8056'.
   341     12  ER-8057                 PIC X(4)  VALUE '8057'.
   342     12  ER-8058                 PIC X(4)  VALUE '8058'.
   343     12  ER-8059                 PIC X(4)  VALUE '8059'.
   344     12  ER-8060                 PIC X(4)  VALUE '8060'.
   345     12  ER-8061                 PIC X(4)  VALUE '8061'.
   346     12  ER-8062                 PIC X(4)  VALUE '8062'.
   347     12  ER-8063                 PIC X(4)  VALUE '8063'.
   348     12  ER-8064                 PIC X(4)  VALUE '8064'.
   349     12  ER-8065                 PIC X(4)  VALUE '8065'.
   350     12  ER-8066                 PIC X(4)  VALUE '8066'.
   351     12  ER-8152                 PIC X(4)  VALUE '8152'.
   352     12  ER-8153                 PIC X(4)  VALUE '8153'.
   353     12  ER-8154                 PIC X(4)  VALUE '8154'.
   354     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page   9
* EL151.cbl
   356*                                    COPY ELCAID.
   357******************************************************************
   358*                                                                *
   359*                            ELCAID.                             *
   360*                            VMOD=2.001                          *
   361*                                                                *
   362*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   363*                                                                *
   364*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   365*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   366******************************************************************
   367
   368 01  DFHAID.
   369   02  DFHNULL   PIC  X  VALUE  ' '.
   370   02  DFHENTER  PIC  X  VALUE  QUOTE.
   371   02  DFHCLEAR  PIC  X  VALUE  '_'.
   372   02  DFHPEN    PIC  X  VALUE  '='.
   373   02  DFHOPID   PIC  X  VALUE  'W'.
   374   02  DFHPA1    PIC  X  VALUE  '%'.
   375   02  DFHPA2    PIC  X  VALUE  '>'.
   376   02  DFHPA3    PIC  X  VALUE  ','.
   377   02  DFHPF1    PIC  X  VALUE  '1'.
   378   02  DFHPF2    PIC  X  VALUE  '2'.
   379   02  DFHPF3    PIC  X  VALUE  '3'.
   380   02  DFHPF4    PIC  X  VALUE  '4'.
   381   02  DFHPF5    PIC  X  VALUE  '5'.
   382   02  DFHPF6    PIC  X  VALUE  '6'.
   383   02  DFHPF7    PIC  X  VALUE  '7'.
   384   02  DFHPF8    PIC  X  VALUE  '8'.
   385   02  DFHPF9    PIC  X  VALUE  '9'.
   386   02  DFHPF10   PIC  X  VALUE  ':'.
   387   02  DFHPF11   PIC  X  VALUE  '#'.
   388   02  DFHPF12   PIC  X  VALUE  '@'.
   389   02  DFHPF13   PIC  X  VALUE  'A'.
   390   02  DFHPF14   PIC  X  VALUE  'B'.
   391   02  DFHPF15   PIC  X  VALUE  'C'.
   392   02  DFHPF16   PIC  X  VALUE  'D'.
   393   02  DFHPF17   PIC  X  VALUE  'E'.
   394   02  DFHPF18   PIC  X  VALUE  'F'.
   395   02  DFHPF19   PIC  X  VALUE  'G'.
   396   02  DFHPF20   PIC  X  VALUE  'H'.
   397   02  DFHPF21   PIC  X  VALUE  'I'.
   398*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   399   02  DFHPF22   PIC  X  VALUE  '['.
   400   02  DFHPF23   PIC  X  VALUE  '.'.
   401   02  DFHPF24   PIC  X  VALUE  '<'.
   402   02  DFHMSRE   PIC  X  VALUE  'X'.
   403   02  DFHSTRF   PIC  X  VALUE  'h'.
   404   02  DFHTRIG   PIC  X  VALUE  '"'.
   405 01  PF-AID REDEFINES DFHAID.
   406     05  FILLER                      PIC X(8).
   407     05  PF-VALUES  OCCURS 24        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  10
* EL151.cbl
   409*                                    COPY ELCINTF.
   410******************************************************************
   411*                                                                *
   412*                                                                *
   413*                            ELCINTF.                            *
   414*                            VMOD=2.017                          *
   415*                                                                *
   416*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   417*                                                                *
   418*       LENGTH = 1024                                            *
   419*                                                                *
   420******************************************************************
   421*                   C H A N G E   L O G
   422*
   423* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   424*-----------------------------------------------------------------
   425*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   426* EFFECTIVE    NUMBER
   427*-----------------------------------------------------------------
   428* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   429******************************************************************
   430 01  PROGRAM-INTERFACE-BLOCK.
   431     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   432     12  PI-CALLING-PROGRAM              PIC X(8).
   433     12  PI-SAVED-PROGRAM-1              PIC X(8).
   434     12  PI-SAVED-PROGRAM-2              PIC X(8).
   435     12  PI-SAVED-PROGRAM-3              PIC X(8).
   436     12  PI-SAVED-PROGRAM-4              PIC X(8).
   437     12  PI-SAVED-PROGRAM-5              PIC X(8).
   438     12  PI-SAVED-PROGRAM-6              PIC X(8).
   439     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   440     12  PI-COMPANY-ID                   PIC XXX.
   441     12  PI-COMPANY-CD                   PIC X.
   442
   443     12  PI-COMPANY-PASSWORD             PIC X(8).
   444
   445     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   446
   447     12  PI-CONTROL-IN-PROGRESS.
   448         16  PI-CARRIER                  PIC X.
   449         16  PI-GROUPING                 PIC X(6).
   450         16  PI-STATE                    PIC XX.
   451         16  PI-ACCOUNT                  PIC X(10).
   452         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   453                                         PIC X(10).
   454         16  PI-CLAIM-CERT-GRP.
   455             20  PI-CLAIM-NO             PIC X(7).
   456             20  PI-CERT-NO.
   457                 25  PI-CERT-PRIME       PIC X(10).
   458                 25  PI-CERT-SFX         PIC X.
   459             20  PI-CERT-EFF-DT          PIC XX.
   460         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   461             20  PI-PLAN-CODE            PIC X(2).
   462             20  PI-REVISION-NUMBER      PIC X(3).
   463             20  PI-PLAN-EFF-DT          PIC X(2).
   464             20  PI-PLAN-EXP-DT          PIC X(2).
   465             20  FILLER                  PIC X(11).
   466         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  11
* EL151.cbl
   467             20  PI-OE-REFERENCE-1.
   468                 25  PI-OE-REF-1-PRIME   PIC X(18).
   469                 25  PI-OE-REF-1-SUFF    PIC XX.
   470
   471     12  PI-SESSION-IN-PROGRESS          PIC X.
   472         88  CLAIM-SESSION                   VALUE '1'.
   473         88  CREDIT-SESSION                  VALUE '2'.
   474         88  WARRANTY-SESSION                VALUE '3'.
   475         88  MORTGAGE-SESSION                VALUE '4'.
   476         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   477
   478
   479*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   480
   481     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   482     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   483
   484     12  PI-CREDIT-USER                  PIC X.
   485         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   486         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   487
   488     12  PI-CLAIM-USER                   PIC X.
   489         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   490         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   491
   492     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   493         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   494         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   495         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   496         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   497         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   498
   499     12  PI-PROCESSOR-ID                 PIC X(4).
   500
   501     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   502
   503     12  PI-MEMBER-CAPTION               PIC X(10).
   504
   505     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   506         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   507
   508     12  PI-LIFE-OVERRIDE-L1             PIC X.
   509     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   510     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   511     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   512
   513     12  PI-AH-OVERRIDE-L1               PIC X.
   514     12  PI-AH-OVERRIDE-L2               PIC XX.
   515     12  PI-AH-OVERRIDE-L6               PIC X(6).
   516     12  PI-AH-OVERRIDE-L12              PIC X(12).
   517
   518     12  PI-NEW-SYSTEM                   PIC X(2).
   519
   520     12  PI-PRIMARY-CERT-NO              PIC X(11).
   521     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   522         88  PI-USES-PAID-TO                 VALUE '1'.
   523     12  PI-CRDTCRD-SYSTEM.
   524         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  12
* EL151.cbl
   525             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   526             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   527         16  PI-CC-MONTH-END-DT          PIC XX.
   528     12  PI-PROCESSOR-PRINTER            PIC X(4).
   529
   530     12  PI-OE-REFERENCE-2.
   531         16  PI-OE-REF-2-PRIME           PIC X(10).
   532         16  PI-OE-REF-2-SUFF            PIC X.
   533
   534     12  PI-REM-TRM-CALC-OPTION          PIC X.
   535
   536     12  PI-LANGUAGE-TYPE                PIC X.
   537             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   538             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   539             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   540
   541     12  PI-POLICY-LINKAGE-IND           PIC X.
   542         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   543         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   544                                                   LOW-VALUES.
   545
   546     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   547     12  PI-CLAIM-PW-SESSION             PIC X(1).
   548         88  PI-CLAIM-CREDIT                 VALUE '1'.
   549         88  PI-CLAIM-CONVEN                 VALUE '2'.
   550
   551     12  PI-PROCESSOR-CSR-IND            PIC X.
   552         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   553         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   554
   555     12  FILLER                          PIC X(3).
   556
   557     12  PI-SYSTEM-LEVEL                 PIC X(145).
   558
   559     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   560         PI-SYSTEM-LEVEL.
   561
   562         16  PI-ENTRY-CODES.
   563             20  PI-ENTRY-CD-1           PIC X.
   564             20  PI-ENTRY-CD-2           PIC X.
   565
   566         16  PI-RETURN-CODES.
   567             20  PI-RETURN-CD-1          PIC X.
   568             20  PI-RETURN-CD-2          PIC X.
   569
   570         16  PI-UPDATE-STATUS-SAVE.
   571             20  PI-UPDATE-BY            PIC X(4).
   572             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   573
   574         16  PI-LOWER-CASE-LETTERS       PIC X.
   575             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   576
   577*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   578*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   579*            88  CARRIER-CLM-CNTL            VALUE '2'.
   580
   581         16  PI-CERT-ACCESS-CONTROL      PIC X.
   582             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  13
* EL151.cbl
   583             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   584             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   585             88  ACCNT-CNTL                  VALUE '3'.
   586             88  CARR-ACCNT-CNTL             VALUE '4'.
   587
   588         16  PI-PROCESSOR-CAP-LIST.
   589             20  PI-SYSTEM-CONTROLS.
   590                24 PI-SYSTEM-DISPLAY     PIC X.
   591                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   592                24 PI-SYSTEM-MODIFY      PIC X.
   593                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   594             20  FILLER                  PIC XX.
   595             20  PI-DISPLAY-CAP          PIC X.
   596                 88  DISPLAY-CAP             VALUE 'Y'.
   597             20  PI-MODIFY-CAP           PIC X.
   598                 88  MODIFY-CAP              VALUE 'Y'.
   599             20  PI-MSG-AT-LOGON-CAP     PIC X.
   600                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   601             20  PI-FORCE-CAP            PIC X.
   602                 88  FORCE-CAP               VALUE 'Y'.
   603
   604         16  PI-PROGRAM-CONTROLS.
   605             20  PI-PGM-PRINT-OPT        PIC X.
   606             20  PI-PGM-FORMAT-OPT       PIC X.
   607             20  PI-PGM-PROCESS-OPT      PIC X.
   608             20  PI-PGM-TOTALS-OPT       PIC X.
   609
   610         16  PI-HELP-INTERFACE.
   611             20  PI-LAST-ERROR-NO        PIC X(4).
   612             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   613
   614         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   615             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   616
   617         16  PI-CR-CONTROL-IN-PROGRESS.
   618             20  PI-CR-CARRIER           PIC X.
   619             20  PI-CR-GROUPING          PIC X(6).
   620             20  PI-CR-STATE             PIC XX.
   621             20  PI-CR-ACCOUNT           PIC X(10).
   622             20  PI-CR-FIN-RESP          PIC X(10).
   623             20  PI-CR-TYPE              PIC X.
   624
   625         16  PI-CR-BATCH-NUMBER          PIC X(6).
   626
   627         16  PI-CR-MONTH-END-DT          PIC XX.
   628
   629         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   630             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   631             88  PI-ZERO-CARRIER             VALUE '1'.
   632             88  PI-ZERO-GROUPING            VALUE '2'.
   633             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   634
   635         16  PI-CARRIER-SECURITY         PIC X.
   636             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   637
   638         16  PI-ACCOUNT-SECURITY         PIC X(10).
   639             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   640             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  14
* EL151.cbl
   641
   642         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   643             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   644                                         INDEXED BY PI-ACCESS-NDX
   645                                         PIC X.
   646
   647         16  PI-GA-BILLING-CONTROL       PIC X.
   648             88  PI-GA-BILLING               VALUE '1'.
   649
   650         16  PI-MAIL-PROCESSING          PIC X.
   651             88  PI-MAIL-YES                 VALUE 'Y'.
   652
   653         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   654
   655         16  PI-AR-SYSTEM.
   656             20  PI-AR-PROCESSING-CNTL   PIC X.
   657                 88  PI-AR-PROCESSING        VALUE 'Y'.
   658             20  PI-AR-SUMMARY-CODE      PIC X(6).
   659             20  PI-AR-MONTH-END-DT      PIC XX.
   660
   661         16  PI-MP-SYSTEM.
   662             20  PI-MORTGAGE-USER            PIC X.
   663                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   664                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   665             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   666                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   667                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   668                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   669                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   670                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   671             20  PI-MP-MONTH-END-DT          PIC XX.
   672             20  PI-MP-REFERENCE-NO.
   673                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   674                 24  PI-MP-REFERENCE-SFX     PIC XX.
   675
   676         16  PI-LABEL-CONTROL            PIC X(01).
   677             88  PI-CREATE-LABELS                    VALUE 'Y'.
   678             88  PI-BYPASS-LABELS                    VALUE 'N'.
   679
   680         16  PI-BILL-GROUPING-CODE       PIC X(01).
   681             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   682
   683         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   684             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   685             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   686
   687         16  FILLER                      PIC X(14).
   688
   689     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   690******************************************************************
   691     12  PI-REDEFINES REDEFINES PI-PROGRAM-WORK-AREA.
   692         16  PI-PREV-TRLR-KEY        PIC X(22).
   693*00252          16  FILLER                  PIC X(618).
   694         16  PI-PROOF-DATE           PIC 9(6).
   695         16  FILLER                  PIC X(612).
   696
   697* DLO023
   698 01  DL23-COMM-LENGTH              PIC S9(4) COMP VALUE +132.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  15
* EL151.cbl
   699 01  WS-DLO-CODES-TABLE.
   700     12  DL23-SYSTEM-ID            PIC XX.
   701     12  DL23-RECORD-TYPE          PIC XX.
   702     12  DL23-RECORD-KEY           PIC X(6).
   703     12  DL23-RETURN-CODE          PIC XX.
   704     12  DL23-CODE-DESC.
   705         16  DL23-CODE-TEXT        PIC X(20).
   706         16  DL23-RET-CODE         PIC X(40).
   707     12  DL23-GEN-DESC-1           PIC X(20).
   708     12  DL23-GEN-DESC-2           PIC X(20).
   709     12  DL23-GEN-DESC-3           PIC X(20).
   710
   711 01  DMD-DATE-YYYYMMDD.
   712     12  DMD-DECADE          PIC XX      VALUE SPACES.
   713     12  DMD-YYMMDD.
   714         16  DMD-YY          PIC XX      VALUE SPACES.
   715         16  DMD-MM          PIC XX      VALUE SPACES.
   716         16  DMD-DD          PIC XX      VALUE SPACES.
   717
   718     12  W-NAME-LAST             PIC  X(15).
   719     12  W-NAME-FIRST            PIC  X(15).
   720     12  W-NAME-MIDDLE.
   721         16  FILLER              PIC  X(01).
   722         16  W-NAME-MIDDLE-2     PIC  X(01).
   723         16  FILLER              PIC  X(13).
   724
   725*                                    COPY ELCDCTB.
   726******************************************************************
   727*                                                                *
   728*                                                                *
   729*                            ELCDCTB.                            *
   730*                            VMOD=2.002                          *
   731*                                                                *
   732*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   733*       COMMUNICATIONS AREA                                      *
   734*                                                                *
   735******************************************************************
   736 01  DCT-COMMUNICATION-AREA.
   737     12  DCT-BILLING-BANK-ID      PIC  X(05).
   738     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   739     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   740     12  DCT-PRODUCT-CODE         PIC  X(02).
   741     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   742     12  DCT-RETURN-CODE          PIC  X(02).
   743     12  DCT-MAIL-CODE            PIC  X(05).
   744     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   745     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  16
* EL151.cbl
   747*                                    COPY ELCATTR.
   748******************************************************************
   749*                                                                *
   750*                            ELCATTR.                            *
   751*                            VMOD=2.001                          *
   752*                                                                *
   753*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   754*                                                                *
   755*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   756*                                                                *
   757*                   POS 1   P=PROTECTED                          *
   758*                           U=UNPROTECTED                        *
   759*                           S=ASKIP                              *
   760*                   POS 2   A=ALPHA/NUMERIC                      *
   761*                           N=NUMERIC                            *
   762*                   POS 3   N=NORMAL                             *
   763*                           B=BRIGHT                             *
   764*                           D=DARK                               *
   765*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   766*                           OF=MODIFIED DATA TAG OFF             *
   767*                                                                *
   768*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   769******************************************************************
   770 01  ATTRIBUTE-LIST.
   771     12  AL-PABOF            PIC X       VALUE 'Y'.
   772     12  AL-PABON            PIC X       VALUE 'Z'.
   773     12  AL-PADOF            PIC X       VALUE '%'.
   774     12  AL-PADON            PIC X       VALUE '_'.
   775     12  AL-PANOF            PIC X       VALUE '-'.
   776     12  AL-PANON            PIC X       VALUE '/'.
   777     12  AL-SABOF            PIC X       VALUE '8'.
   778     12  AL-SABON            PIC X       VALUE '9'.
   779     12  AL-SADOF            PIC X       VALUE '@'.
   780     12  AL-SADON            PIC X       VALUE QUOTE.
   781     12  AL-SANOF            PIC X       VALUE '0'.
   782     12  AL-SANON            PIC X       VALUE '1'.
   783     12  AL-UABOF            PIC X       VALUE 'H'.
   784     12  AL-UABON            PIC X       VALUE 'I'.
   785     12  AL-UADOF            PIC X       VALUE '<'.
   786     12  AL-UADON            PIC X       VALUE '('.
   787     12  AL-UANOF            PIC X       VALUE ' '.
   788     12  AL-UANON            PIC X       VALUE 'A'.
   789     12  AL-UNBOF            PIC X       VALUE 'Q'.
   790     12  AL-UNBON            PIC X       VALUE 'R'.
   791     12  AL-UNDOF            PIC X       VALUE '*'.
   792     12  AL-UNDON            PIC X       VALUE ')'.
   793     12  AL-UNNOF            PIC X       VALUE '&'.
   794     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  17
* EL151.cbl
   796*                                    COPY ELCLOGOF.
   797******************************************************************
   798*                                                                *
   799*                                                                *
   800*                            ELCLOGOF.                           *
   801*                            VMOD=2.001                          *
   802*                                                                *
   803*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   804*                                                                *
   805******************************************************************
   806 01  CLASIC-LOGOFF.
   807     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   808     12  LOGOFF-TEXT.
   809         16  FILLER          PIC X(5)    VALUE SPACES.
   810         16  LOGOFF-MSG.
   811             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   812             20  FILLER      PIC X       VALUE SPACES.
   813             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   814         16  FILLER          PIC X(80)
   815           VALUE '* YOU ARE NOW LOGGED OFF'.
   816         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   817         16  FILLER          PIC X       VALUE QUOTE.
   818         16  LOGOFF-SYS-MSG  PIC X(17)
   819           VALUE 'S CLAS-IC SYSTEM '.
   820     12  TEXT-MESSAGES.
   821         16  UNACCESS-MSG    PIC X(29)
   822             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   823         16  PGMIDERR-MSG    PIC X(17)
   824             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  18
* EL151.cbl
   826*                                    COPY ELCDATE.
   827******************************************************************
   828*                                                                *
   829*                                                                *
   830*                            ELCDATE.                            *
   831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   832*                            VMOD=2.003
   833*                                                                *
   834*                                                                *
   835*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   836*                 LENGTH = 200                                   *
   837******************************************************************
   838
   839 01  DATE-CONVERSION-DATA.
   840     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   841     12  DC-OPTION-CODE                PIC X.
   842         88  BIN-TO-GREG                VALUE ' '.
   843         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   844         88  EDIT-GREG-TO-BIN           VALUE '2'.
   845         88  YMD-GREG-TO-BIN            VALUE '3'.
   846         88  MDY-GREG-TO-BIN            VALUE '4'.
   847         88  JULIAN-TO-BIN              VALUE '5'.
   848         88  BIN-PLUS-ELAPSED           VALUE '6'.
   849         88  FIND-CENTURY               VALUE '7'.
   850         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   851         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   852         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   853         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   854         88  JULIAN-TO-BIN-3            VALUE 'C'.
   855         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   856         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   857         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   858         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   859         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   860         88  CHECK-LEAP-YEAR            VALUE 'H'.
   861         88  BIN-3-TO-GREG              VALUE 'I'.
   862         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   863         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   864         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   865         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   866         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   867         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   868         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   869         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   870         88  THREE-CHARACTER-BIN
   871                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   872         88  GREGORIAN-TO-BIN
   873                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   874         88  BIN-TO-GREGORIAN
   875                  VALUES ' ' '1' 'I' '8' 'G'.
   876         88  JULIAN-TO-BINARY
   877                  VALUES '5' 'C' 'E' 'F'.
   878     12  DC-ERROR-CODE                 PIC X.
   879         88  NO-CONVERSION-ERROR        VALUE ' '.
   880         88  DATE-CONVERSION-ERROR
   881                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   882         88  DATE-IS-ZERO               VALUE '1'.
   883         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  19
* EL151.cbl
   884         88  DATE-IS-INVALID            VALUE '3'.
   885         88  DATE1-GREATER-DATE2        VALUE '4'.
   886         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   887         88  DATE-INVALID-OPTION        VALUE '9'.
   888         88  INVALID-CENTURY            VALUE 'A'.
   889         88  ONLY-CENTURY               VALUE 'B'.
   890         88  ONLY-LEAP-YEAR             VALUE 'C'.
   891         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   892     12  DC-END-OF-MONTH               PIC X.
   893         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   894     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   895         88  USE-NORMAL-PROCESS         VALUE ' '.
   896         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   897         88  ADJUST-UP-100-YRS          VALUE '2'.
   898     12  FILLER                        PIC X.
   899     12  DC-CONVERSION-DATES.
   900         16  DC-BIN-DATE-1             PIC XX.
   901         16  DC-BIN-DATE-2             PIC XX.
   902         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   903         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   904                       DC-GREG-DATE-1-EDIT.
   905             20  DC-EDIT1-MONTH        PIC 99.
   906             20  SLASH1-1              PIC X.
   907             20  DC-EDIT1-DAY          PIC 99.
   908             20  SLASH1-2              PIC X.
   909             20  DC-EDIT1-YEAR         PIC 99.
   910         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   911         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   912                     DC-GREG-DATE-2-EDIT.
   913             20  DC-EDIT2-MONTH        PIC 99.
   914             20  SLASH2-1              PIC X.
   915             20  DC-EDIT2-DAY          PIC 99.
   916             20  SLASH2-2              PIC X.
   917             20  DC-EDIT2-YEAR         PIC 99.
   918         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   919         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   920                     DC-GREG-DATE-1-YMD.
   921             20  DC-YMD-YEAR           PIC 99.
   922             20  DC-YMD-MONTH          PIC 99.
   923             20  DC-YMD-DAY            PIC 99.
   924         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   925         16  DC-GREG-DATE-1-MDY-R REDEFINES
   926                      DC-GREG-DATE-1-MDY.
   927             20  DC-MDY-MONTH          PIC 99.
   928             20  DC-MDY-DAY            PIC 99.
   929             20  DC-MDY-YEAR           PIC 99.
   930         16  DC-GREG-DATE-1-ALPHA.
   931             20  DC-ALPHA-MONTH        PIC X(10).
   932             20  DC-ALPHA-DAY          PIC 99.
   933             20  FILLER                PIC XX.
   934             20  DC-ALPHA-CENTURY.
   935                 24 DC-ALPHA-CEN-N     PIC 99.
   936             20  DC-ALPHA-YEAR         PIC 99.
   937         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   938         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   939         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   940         16  DC-JULIAN-DATE            PIC 9(05).
   941         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  20
* EL151.cbl
   942                                       PIC 9(05).
   943         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   944             20  DC-JULIAN-YEAR        PIC 99.
   945             20  DC-JULIAN-DAYS        PIC 999.
   946         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   947         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   948         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   949     12  DATE-CONVERSION-VARIBLES.
   950         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   951         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   952             20  FILLER                PIC 9(3).
   953             20  HOLD-CEN-1-CCYY.
   954                 24  HOLD-CEN-1-CC     PIC 99.
   955                 24  HOLD-CEN-1-YY     PIC 99.
   956             20  HOLD-CEN-1-MO         PIC 99.
   957             20  HOLD-CEN-1-DA         PIC 99.
   958         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   959             20  HOLD-CEN-1-R-MO       PIC 99.
   960             20  HOLD-CEN-1-R-DA       PIC 99.
   961             20  HOLD-CEN-1-R-CCYY.
   962                 24  HOLD-CEN-1-R-CC   PIC 99.
   963                 24  HOLD-CEN-1-R-YY   PIC 99.
   964             20  FILLER                PIC 9(3).
   965         16  HOLD-CENTURY-1-X.
   966             20  FILLER                PIC X(3)  VALUE SPACES.
   967             20  HOLD-CEN-1-X-CCYY.
   968                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   969                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   970             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   971             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   972         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   973             20  HOLD-CEN-1-R-X-MO     PIC XX.
   974             20  HOLD-CEN-1-R-X-DA     PIC XX.
   975             20  HOLD-CEN-1-R-X-CCYY.
   976                 24  HOLD-CEN-1-R-X-CC PIC XX.
   977                 24  HOLD-CEN-1-R-X-YY PIC XX.
   978             20  FILLER                PIC XXX.
   979         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   980         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   981         16  DC-JULIAN-DATE-1          PIC 9(07).
   982         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   983             20  DC-JULIAN-1-CCYY.
   984                 24  DC-JULIAN-1-CC    PIC 99.
   985                 24  DC-JULIAN-1-YR    PIC 99.
   986             20  DC-JULIAN-DA-1        PIC 999.
   987         16  DC-JULIAN-DATE-2          PIC 9(07).
   988         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   989             20  DC-JULIAN-2-CCYY.
   990                 24  DC-JULIAN-2-CC    PIC 99.
   991                 24  DC-JULIAN-2-YR    PIC 99.
   992             20  DC-JULIAN-DA-2        PIC 999.
   993         16  DC-GREG-DATE-A-EDIT.
   994             20  DC-EDITA-MONTH        PIC 99.
   995             20  SLASHA-1              PIC X VALUE '/'.
   996             20  DC-EDITA-DAY          PIC 99.
   997             20  SLASHA-2              PIC X VALUE '/'.
   998             20  DC-EDITA-CCYY.
   999                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  21
* EL151.cbl
  1000                 24  DC-EDITA-YEAR     PIC 99.
  1001         16  DC-GREG-DATE-B-EDIT.
  1002             20  DC-EDITB-MONTH        PIC 99.
  1003             20  SLASHB-1              PIC X VALUE '/'.
  1004             20  DC-EDITB-DAY          PIC 99.
  1005             20  SLASHB-2              PIC X VALUE '/'.
  1006             20  DC-EDITB-CCYY.
  1007                 24  DC-EDITB-CENT     PIC 99.
  1008                 24  DC-EDITB-YEAR     PIC 99.
  1009         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1010         16  DC-GREG-DATE-CYMD-R REDEFINES
  1011                              DC-GREG-DATE-CYMD.
  1012             20  DC-CYMD-CEN           PIC 99.
  1013             20  DC-CYMD-YEAR          PIC 99.
  1014             20  DC-CYMD-MONTH         PIC 99.
  1015             20  DC-CYMD-DAY           PIC 99.
  1016         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1017         16  DC-GREG-DATE-MDCY-R REDEFINES
  1018                              DC-GREG-DATE-MDCY.
  1019             20  DC-MDCY-MONTH         PIC 99.
  1020             20  DC-MDCY-DAY           PIC 99.
  1021             20  DC-MDCY-CEN           PIC 99.
  1022             20  DC-MDCY-YEAR          PIC 99.
  1023    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1024        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1025    12  DC-EL310-DATE                  PIC X(21).
  1026    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  22
* EL151.cbl
  1028*                                    COPY ELCEMIB.
  1029******************************************************************
  1030*                                                                *
  1031*                                                                *
  1032*                            ELCEMIB.                            *
  1033*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1034*                            VMOD=2.005                          *
  1035*                                                                *
  1036*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1037*                                                                *
  1038******************************************************************
  1039 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1040     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1041     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1042     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1043     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1044     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1045     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1046     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1047     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1048     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1049         88  EMI-NO-ERRORS                    VALUE '1'.
  1050         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1051         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1052     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1053         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1054     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1055         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1056         88  EMI-AREA1-FULL                   VALUE '2'.
  1057     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1058         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1059         88  EMI-AREA2-FULL                   VALUE '2'.
  1060     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1061         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1062         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1063         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1064         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1065         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1066     12  EMI-ERROR-LINES.
  1067         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1068         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1069         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1070         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1071             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1072                 24  EMI-ERR-NUM         PIC X(4).
  1073                 24  EMI-FILLER          PIC X.
  1074                 24  EMI-SEV             PIC X.
  1075                 24  FILLER              PIC X.
  1076             20  FILLER                  PIC X(02).
  1077     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1078         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1079             20  EMI-ERROR-NUMBER    PIC X(4).
  1080             20  EMI-FILL            PIC X.
  1081             20  EMI-SEVERITY        PIC X.
  1082             20  FILLER              PIC X.
  1083             20  EMI-ERROR-TEXT.
  1084                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1085                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  23
* EL151.cbl
  1086     12  EMI-SEVERITY-SAVE           PIC X.
  1087         88  EMI-NOTE                    VALUE 'N'.
  1088         88  EMI-WARNING                 VALUE 'W'.
  1089         88  EMI-FORCABLE                VALUE 'F'.
  1090         88  EMI-FATAL                   VALUE 'X'.
  1091     12  EMI-MESSAGE-FLAG            PIC X.
  1092         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1093         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1094     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1095     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1096         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1097         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1098         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1099     12  emi-claim-no                pic x(7).
  1100     12  emi-claim-type              pic x(6).
  1101     12  FILLER                      PIC X(124)  VALUE SPACES.
  1102     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1103     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1104     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1105     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  24
* EL151.cbl
  1107*                                    COPY EL151S.
  1108 01  EL151AI.
  1109     05  FILLER            PIC  X(0012).
  1110*    -------------------------------
  1111     05  MRNDATEL PIC S9(0004) COMP.
  1112     05  MRNDATEF PIC  X(0001).
  1113     05  FILLER REDEFINES MRNDATEF.
  1114         10  MRNDATEA PIC  X(0001).
  1115     05  MRNDATEI PIC  X(0008).
  1116*    -------------------------------
  1117     05  MRNTIMEL PIC S9(0004) COMP.
  1118     05  MRNTIMEF PIC  X(0001).
  1119     05  FILLER REDEFINES MRNTIMEF.
  1120         10  MRNTIMEA PIC  X(0001).
  1121     05  MRNTIMEI PIC  X(0005).
  1122*    -------------------------------
  1123     05  MLINE1L PIC S9(0004) COMP.
  1124     05  MLINE1F PIC  X(0001).
  1125     05  FILLER REDEFINES MLINE1F.
  1126         10  MLINE1A PIC  X(0001).
  1127     05  MLINE1I PIC  X(0060).
  1128*    -------------------------------
  1129     05  MLINE2L PIC S9(0004) COMP.
  1130     05  MLINE2F PIC  X(0001).
  1131     05  FILLER REDEFINES MLINE2F.
  1132         10  MLINE2A PIC  X(0001).
  1133     05  MLINE2I PIC  X(0060).
  1134*    -------------------------------
  1135     05  MDENCDL PIC S9(0004) COMP.
  1136     05  MDENCDF PIC  X(0001).
  1137     05  FILLER REDEFINES MDENCDF.
  1138         10  MDENCDA PIC  X(0001).
  1139     05  MDENCDI PIC  X(0004).
  1140*    -------------------------------
  1141     05  MPRFDTL PIC S9(0004) COMP.
  1142     05  MPRFDTF PIC  X(0001).
  1143     05  FILLER REDEFINES MPRFDTF.
  1144         10  MPRFDTA PIC  X(0001).
  1145     05  MPRFDTI PIC  X(0008).
  1146*    -------------------------------
  1147     05  MERMSG1L PIC S9(0004) COMP.
  1148     05  MERMSG1F PIC  X(0001).
  1149     05  FILLER REDEFINES MERMSG1F.
  1150         10  MERMSG1A PIC  X(0001).
  1151     05  MERMSG1I PIC  X(0070).
  1152*    -------------------------------
  1153     05  MERMSG2L PIC S9(0004) COMP.
  1154     05  MERMSG2F PIC  X(0001).
  1155     05  FILLER REDEFINES MERMSG2F.
  1156         10  MERMSG2A PIC  X(0001).
  1157     05  MERMSG2I PIC  X(0070).
  1158*    -------------------------------
  1159     05  MPFNUMBL PIC S9(0004) COMP.
  1160     05  MPFNUMBF PIC  X(0001).
  1161     05  FILLER REDEFINES MPFNUMBF.
  1162         10  MPFNUMBA PIC  X(0001).
  1163     05  MPFNUMBI PIC  99.
  1164 01  EL151AO REDEFINES EL151AI.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  25
* EL151.cbl
  1165     05  FILLER            PIC  X(0012).
  1166*    -------------------------------
  1167     05  FILLER            PIC  X(0003).
  1168     05  MRNDATEO PIC  X(0008).
  1169*    -------------------------------
  1170     05  FILLER            PIC  X(0003).
  1171     05  MRNTIMEO PIC  99.99.
  1172*    -------------------------------
  1173     05  FILLER            PIC  X(0003).
  1174     05  MLINE1O PIC  X(0060).
  1175*    -------------------------------
  1176     05  FILLER            PIC  X(0003).
  1177     05  MLINE2O PIC  X(0060).
  1178*    -------------------------------
  1179     05  FILLER            PIC  X(0003).
  1180     05  MDENCDO PIC  X(0004).
  1181*    -------------------------------
  1182     05  FILLER            PIC  X(0003).
  1183     05  MPRFDTO PIC  99B99B99.
  1184*    -------------------------------
  1185     05  FILLER            PIC  X(0003).
  1186     05  MERMSG1O PIC  X(0070).
  1187*    -------------------------------
  1188     05  FILLER            PIC  X(0003).
  1189     05  MERMSG2O PIC  X(0070).
  1190*    -------------------------------
  1191     05  FILLER            PIC  X(0003).
  1192     05  MPFNUMBO PIC  99.
  1193*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  26
* EL151.cbl
  1195*                                    COPY ELCDMO.
  1196******************************************************************
  1197*                                                                *
  1198*                                                                *
  1199*                            ELCDMO.                             *
  1200*                            VMOD=2.004                          *
  1201*                                                                *
  1202*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1203*        COMMUNICATION AREA                                      *
  1204*   FILE TYPE = NA                                               *
  1205*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1206*                                                                *
  1207******************************************************************
  1208 01  DMO-COMMUNICATION-AREA.
  1209     12  DM-RECORD-TYPE                  PIC  X(02).
  1210             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1211             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1212             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1213     12  DM-DIST-CODE                    PIC  X(04).
  1214     12  DM-MAIL-CODE                    PIC  X(05).
  1215     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1216     12  DM-INSURED-NAME                 PIC  X(30).
  1217     12  DM-CLAIM-NO                     PIC  X(07).
  1218     12  DM-CLAIM-TYPE                   PIC  X.
  1219
  1220     12  DM-STATUS-DATA-AREA.
  1221         16  DM-CLAIM-STATUS             PIC  X.
  1222             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1223             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1224             88  DM-CLOSED                        VALUE '3'.
  1225             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1226             88  DM-DEFAULT                       VALUE '9'.
  1227         16  DM-STATUS-DATE              PIC  X(08).
  1228******YYYYMMDD
  1229         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1230             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1231             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1232             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1233             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1234             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1235             88  DM-RE-OPENED                     VALUE 'R'.
  1236             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1237             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1238             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1239         16  DM-STAT-CARRIER             PIC X.
  1240
  1241     12  DM-DRAFT-DATA-AREA.
  1242         16  DM-PAYMENT-TYPE             PIC  X.
  1243             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1244         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1245         16  DM-PAYMENT-DATE             PIC  X(08).
  1246******YYYYMMDD
  1247         16  DM-CERT-NO                  PIC  X(11).
  1248         16  DM-TRLR-SEQ-NO              PIC  9(04).
  1249         16  DM-CARRIER                  PIC  X.
  1250
  1251     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  27
* EL151.cbl
  1253****************************************************************
  1254*
  1255* Copyright (c) 2007-2013 Dell Inc.
  1256* All rights reserved.
  1257*
  1258****************************************************************
  1259 01  DFHEIV.
  1260   02  DFHEIV0               PIC X(35).
  1261   02  DFHEIV1               PIC X(08).
  1262   02  DFHEIV2               PIC X(08).
  1263   02  DFHEIV3               PIC X(08).
  1264   02  DFHEIV4               PIC X(06).
  1265   02  DFHEIV5               PIC X(04).
  1266   02  DFHEIV6               PIC X(04).
  1267   02  DFHEIV7               PIC X(02).
  1268   02  DFHEIV8               PIC X(02).
  1269   02  DFHEIV9               PIC X(01).
  1270   02  DFHEIV10              PIC S9(7) COMP-3.
  1271   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1272   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1273   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1274   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1275   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1276   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1277   02  DFHEIV17              PIC X(04).
  1278   02  DFHEIV18              PIC X(04).
  1279   02  DFHEIV19              PIC X(04).
  1280   02  DFHEIV20              USAGE IS POINTER.
  1281   02  DFHEIV21              USAGE IS POINTER.
  1282   02  DFHEIV22              USAGE IS POINTER.
  1283   02  DFHEIV23              USAGE IS POINTER.
  1284   02  DFHEIV24              USAGE IS POINTER.
  1285   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1286   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1287   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1288   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1289   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1290   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1291   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1292   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1293   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1294   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1295   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1296   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1297   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1298   02  FILLER                PIC X(02).
  1299   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1300   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1301   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1302   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1303   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1304   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1305   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1306 LINKAGE  SECTION.
  1307*****************************************************************
  1308*                                                               *
  1309* Copyright (c) 2007-2013 Dell Inc.                             *
  1310* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  28
* EL151.cbl
  1311*                                                               *
  1312*****************************************************************
  1313 01  dfheiblk.
  1314     02  eibtime          pic s9(7) comp-3.
  1315     02  eibdate          pic s9(7) comp-3.
  1316     02  eibtrnid         pic x(4).
  1317     02  eibtaskn         pic s9(7) comp-3.
  1318     02  eibtrmid         pic x(4).
  1319     02  dfheigdi         pic s9(4) comp.
  1320     02  eibcposn         pic s9(4) comp.
  1321     02  eibcalen         pic s9(4) comp.
  1322     02  eibaid           pic x(1).
  1323     02  eibfiller1       pic x(1).
  1324     02  eibfn            pic x(2).
  1325     02  eibfiller2       pic x(2).
  1326     02  eibrcode         pic x(6).
  1327     02  eibfiller3       pic x(2).
  1328     02  eibds            pic x(8).
  1329     02  eibreqid         pic x(8).
  1330     02  eibrsrce         pic x(8).
  1331     02  eibsync          pic x(1).
  1332     02  eibfree          pic x(1).
  1333     02  eibrecv          pic x(1).
  1334     02  eibsend          pic x(1).
  1335     02  eibatt           pic x(1).
  1336     02  eibeoc           pic x(1).
  1337     02  eibfmh           pic x(1).
  1338     02  eibcompl         pic x(1).
  1339     02  eibsig           pic x(1).
  1340     02  eibconf          pic x(1).
  1341     02  eiberr           pic x(1).
  1342     02  eibrldbk         pic x(1).
  1343     02  eiberrcd         pic x(4).
  1344     02  eibsynrb         pic x(1).
  1345     02  eibnodat         pic x(1).
  1346     02  eibfiller5       pic x(2).
  1347     02  eibresp          pic s9(8) comp.
  1348     02  eibresp2         pic s9(8) comp.
  1349     02  dfheigdj         pic s9(4) comp.
  1350     02  dfheigdk         pic s9(4) comp.
  1351 01  DFHCOMMAREA                     PICTURE X(1024).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  29
* EL151.cbl
  1353*                                    COPY ELCMSTR.
  1354******************************************************************
  1355*                                                                *
  1356*                            ELCMSTR.                            *
  1357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1358*                            VMOD=2.012                          *
  1359*                                                                *
  1360*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1361*                                                                *
  1362*   FILE TYPE = VSAM,KSDS                                        *
  1363*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1364*                                                                *
  1365*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1366*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1367*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1368*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1369*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1370*                                                 RKP=75,LEN=21  *
  1371*                                                                *
  1372*   **** NOTE ****                                               *
  1373*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1374*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1375*                                                                *
  1376*   LOG = YES                                                    *
  1377*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1378******************************************************************
  1379*                   C H A N G E   L O G
  1380*
  1381* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1382*-----------------------------------------------------------------
  1383*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1384* EFFECTIVE    NUMBER
  1385*-----------------------------------------------------------------
  1386* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1387* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1388* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1389* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1390* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1391* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  1392* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1393******************************************************************
  1394 01  CLAIM-MASTER.
  1395     12  CL-RECORD-ID                PIC XX.
  1396         88  VALID-CL-ID         VALUE 'CL'.
  1397
  1398     12  CL-CONTROL-PRIMARY.
  1399         16  CL-COMPANY-CD           PIC X.
  1400         16  CL-CARRIER              PIC X.
  1401         16  CL-CLAIM-NO             PIC X(7).
  1402         16  CL-CERT-NO.
  1403             20  CL-CERT-PRIME       PIC X(10).
  1404             20  CL-CERT-SFX         PIC X.
  1405
  1406     12  CL-CONTROL-BY-NAME.
  1407         16  CL-COMPANY-CD-A1        PIC X.
  1408         16  CL-INSURED-LAST-NAME    PIC X(15).
  1409         16  CL-INSURED-NAME.
  1410             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  30
* EL151.cbl
  1411             20  CL-INSURED-MID-INIT PIC X.
  1412
  1413     12  CL-CONTROL-BY-SSN.
  1414         16  CL-COMPANY-CD-A2        PIC X.
  1415         16  CL-SOC-SEC-NO.
  1416             20  CL-SSN-STATE        PIC XX.
  1417             20  CL-SSN-ACCOUNT      PIC X(6).
  1418             20  CL-SSN-LN3          PIC X(3).
  1419
  1420     12  CL-CONTROL-BY-CERT-NO.
  1421         16  CL-COMPANY-CD-A4        PIC X.
  1422         16  CL-CERT-NO-A4.
  1423             20  CL-CERT-A4-PRIME    PIC X(10).
  1424             20  CL-CERT-A4-SFX      PIC X.
  1425
  1426     12  CL-CONTROL-BY-CCN.
  1427         16  CL-COMPANY-CD-A5        PIC X.
  1428         16  CL-CCN-A5.
  1429             20  CL-CCN.
  1430                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1431                 24  CL-CCN-PRIME-A5 PIC X(12).
  1432             20  CL-CCN-FILLER-A5    PIC X(4).
  1433
  1434     12  CL-INSURED-PROFILE-DATA.
  1435         16  CL-INSURED-BIRTH-DT     PIC XX.
  1436         16  CL-INSURED-SEX-CD       PIC X.
  1437             88  INSURED-IS-MALE        VALUE 'M'.
  1438             88  INSURED-IS-FEMALE      VALUE 'F'.
  1439             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1440         16  CL-INSURED-OCC-CD       PIC X(6).
  1441         16  FILLER                  PIC X(5).
  1442
  1443     12  CL-PROCESSING-INFO.
  1444         16  CL-PROCESSOR-ID         PIC X(4).
  1445         16  CL-CLAIM-STATUS         PIC X.
  1446             88  CLAIM-IS-OPEN          VALUE 'O'.
  1447             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1448         16  CL-CLAIM-TYPE           PIC X.
  1449*            88  AH-CLAIM               VALUE 'A'.
  1450*            88  LIFE-CLAIM             VALUE 'L'.
  1451*            88  PROPERTY-CLAIM         VALUE 'P'.
  1452*            88  IUI-CLAIM              VALUE 'I'.
  1453*            88  GAP-CLAIM              VALUE 'G'.
  1454*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1455*            88  OTHER-CLAIM            VALUE 'O'.
  1456         16  CL-CLAIM-PREM-TYPE      PIC X.
  1457             88  SINGLE-PREMIUM         VALUE '1'.
  1458             88  O-B-COVERAGE           VALUE '2'.
  1459             88  OPEN-END-COVERAGE      VALUE '3'.
  1460         16  CL-INCURRED-DT          PIC XX.
  1461         16  CL-REPORTED-DT          PIC XX.
  1462         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1463         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1464         16  CL-LAST-PMT-DT          PIC XX.
  1465         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1466         16  CL-PAID-THRU-DT         PIC XX.
  1467         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1468         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  31
* EL151.cbl
  1469         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1470         16  CL-PMT-CALC-METHOD      PIC X.
  1471             88  CL-360-DAY-YR          VALUE '1'.
  1472             88  CL-365-DAY-YR          VALUE '2'.
  1473             88  CL-FULL-MONTHS         VALUE '3'.
  1474         16  CL-CAUSE-CD             PIC X(6).
  1475
  1476         16  CL-PRIME-CERT-NO.
  1477             20  CL-PRIME-CERT-PRIME PIC X(10).
  1478             20  CL-PRIME-CERT-SFX   PIC X.
  1479
  1480         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1481             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1482             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1483
  1484         16  CL-MICROFILM-NO         PIC X(10).
  1485         16  FILLER REDEFINES CL-MICROFILM-NO.
  1486             20  CL-BENEFIT-PERIOD   PIC 99.
  1487             20  FILLER              PIC X(8).
  1488         16  CL-PROG-FORM-TYPE       PIC X.
  1489         16  CL-LAST-ADD-ON-DT       PIC XX.
  1490
  1491         16  CL-LAST-REOPEN-DT       PIC XX.
  1492         16  CL-LAST-CLOSE-DT        PIC XX.
  1493         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1494             88  FINAL-PAID             VALUE '1'.
  1495             88  CLAIM-DENIED           VALUE '2'.
  1496             88  AUTO-CLOSE             VALUE '3'.
  1497             88  MANUAL-CLOSE           VALUE '4'.
  1498             88  BENEFITS-CHANGED       VALUE 'C'.
  1499             88  SETUP-ERRORS           VALUE 'E'.
  1500         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1501         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1502         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1503             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1504         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1505         16  FILLER                  PIC X.
  1506
  1507     12  CL-CERTIFICATE-DATA.
  1508         16  CL-CERT-ORIGIN          PIC X.
  1509             88  CERT-WAS-ONLINE        VALUE '1'.
  1510             88  CERT-WAS-CREATED       VALUE '2'.
  1511             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1512         16  CL-CERT-KEY-DATA.
  1513             20  CL-CERT-CARRIER     PIC X.
  1514             20  CL-CERT-GROUPING    PIC X(6).
  1515             20  CL-CERT-STATE       PIC XX.
  1516             20  CL-CERT-ACCOUNT.
  1517                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1518                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1519             20  CL-CERT-EFF-DT      PIC XX.
  1520
  1521     12  CL-STATUS-CONTROLS.
  1522         16  CL-PRIORITY-CD          PIC X.
  1523             88  CONFIDENTIAL-DATA      VALUE '8'.
  1524             88  HIGHEST-PRIORITY       VALUE '9'.
  1525         16  CL-SUPV-ATTN-CD         PIC X.
  1526             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  32
* EL151.cbl
  1527             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1528         16  CL-PURGED-DT            PIC XX.
  1529         16  CL-RESTORED-DT          PIC XX.
  1530         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1531         16  CL-NEXT-RESEND-DT       PIC XX.
  1532         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1533         16  CL-CRITICAL-PERIOD      PIC 99.
  1534*        16  FILLER                  PIC XX.
  1535         16  CL-LAST-MAINT-DT        PIC XX.
  1536         16  CL-LAST-MAINT-USER      PIC X(4).
  1537         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1538         16  CL-LAST-MAINT-TYPE      PIC X.
  1539             88  CLAIM-SET-UP           VALUE ' '.
  1540             88  PAYMENT-MADE           VALUE '1'.
  1541             88  LETTER-SENT            VALUE '2'.
  1542             88  MASTER-WAS-ALTERED     VALUE '3'.
  1543             88  MASTER-WAS-RESTORED    VALUE '4'.
  1544             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1545             88  FILE-CONVERTED         VALUE '6'.
  1546             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1547             88  ERROR-CORRECTION       VALUE 'E'.
  1548         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1549         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1550         16  CL-BENEFICIARY          PIC X(10).
  1551         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1552         16  CL-DENIAL-TYPE          PIC X.
  1553             88  CL-TYPE-DENIAL          VALUE '1'.
  1554             88  CL-TYPE-RESCISSION      VALUE '2'.
  1555             88  CL-TYPE-REFORMATION     VALUE '3'.
  1556             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1557             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1558         16  CL-NO-OF-EXTENSIONS     PIC 99.
  1559         16  filler                  pic x(3).
  1560*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1561*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1562*        16  CL-RTW-DT               PIC XX.
  1563
  1564     12  CL-TRAILER-CONTROLS.
  1565         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1566             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1567             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1568             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1569         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1570         16  FILLER                  PIC XX.
  1571         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1572         16  CL-ADDRESS-TRAILER-CNT.
  1573             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1574                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1575             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1576                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1577             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1578                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1579             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1580                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1581             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1582                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1583             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1584                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  33
* EL151.cbl
  1585             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1586                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1587
  1588     12  CL-CV-REFERENCE-NO.
  1589         16  CL-CV-REFNO-PRIME       PIC X(18).
  1590         16  CL-CV-REFNO-SFX         PIC XX.
  1591
  1592     12  CL-FILE-LOCATION            PIC X(4).
  1593
  1594     12  CL-PROCESS-ERRORS.
  1595         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1596             88  NO-FATAL-ERRORS        VALUE ZERO.
  1597         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1598             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1599
  1600     12  CL-PRODUCT-CD               PIC X.
  1601
  1602     12  CL-CURRENT-KEY-DATA.
  1603         16  CL-CURRENT-CARRIER      PIC X.
  1604         16  CL-CURRENT-GROUPING     PIC X(6).
  1605         16  CL-CURRENT-STATE        PIC XX.
  1606         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1607
  1608     12  CL-ASSOCIATES               PIC X.
  1609         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1610         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1611         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1612         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1613
  1614     12  CL-ACTIVITY-CODE            PIC 99.
  1615     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1616     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1617
  1618     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1619     12  CL-LAG-REPORT-CODE          PIC 9.
  1620     12  CL-LOAN-TYPE                PIC XX.
  1621     12  CL-LEGAL-STATE              PIC XX.
  1622
  1623     12  CL-YESNOSW                  PIC X.
  1624     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1625         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1626         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1627         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1628     12  cl-insured-type             pic x.
  1629         88  cl-claim-on-primary         value 'P'.
  1630         88  cl-claim-on-co-borrower     value 'C'.
  1631     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  34
* EL151.cbl
  1633*                                    COPY ELCTRLR.
  1634******************************************************************
  1635*                                                                *
  1636*                            ELCTRLR.                            *
  1637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1638*                            VMOD=2.014                          *
  1639*                                                                *
  1640*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  1641*                                                                *
  1642*   FILE TYPE = VSAM,KSDS                                        *
  1643*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1644*                                                                *
  1645*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  1646*       ALTERNATE INDEX = NONE                                   *
  1647*                                                                *
  1648*   LOG = YES                                                    *
  1649*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1650******************************************************************
  1651*                   C H A N G E   L O G
  1652*
  1653* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1654*-----------------------------------------------------------------
  1655*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1656* EFFECTIVE    NUMBER
  1657*-----------------------------------------------------------------
  1658* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1659* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  1660* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  1661* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  1662* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  1663* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  1664* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  1665* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  1666* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  1667* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  1668* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  1669* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  1670* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  1671* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  1672* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  1673* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1674* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  1675* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  1676* 040814    2014030500002  AJRA  ADD ICD CODES
  1677* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1678* 013017  CR2016053100001  PEMA  ACH PROCESSING
  1679* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  1680* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1681* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  1682******************************************************************
  1683 01  ACTIVITY-TRAILERS.
  1684     12  AT-RECORD-ID                    PIC XX.
  1685         88  VALID-AT-ID                       VALUE 'AT'.
  1686
  1687     12  AT-CONTROL-PRIMARY.
  1688         16  AT-COMPANY-CD               PIC X.
  1689         16  AT-CARRIER                  PIC X.
  1690         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  35
* EL151.cbl
  1691         16  AT-CERT-NO.
  1692             20  AT-CERT-PRIME           PIC X(10).
  1693             20  AT-CERT-SFX             PIC X.
  1694         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  1695             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  1696             88  AT-LAST-TRL-AVAIL            VALUE +100.
  1697             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  1698             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  1699             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  1700             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  1701             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  1702             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  1703             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  1704             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  1705             88  AT-DIAGNOSIS-TRL             VALUE +90.
  1706             88  AT-BENEFICIARY-TRL           VALUE +91.
  1707             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  1708             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  1709             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  1710             88  AT-ERROR-MSGS-TRL            VALUE +95.
  1711
  1712     12  AT-TRAILER-TYPE                 PIC X.
  1713         88  RESERVE-EXPENSE-TR               VALUE '1'.
  1714         88  PAYMENT-TR                       VALUE '2'.
  1715         88  AUTO-PAY-TR                      VALUE '3'.
  1716         88  CORRESPONDENCE-TR                VALUE '4'.
  1717         88  ADDRESS-TR                       VALUE '5'.
  1718         88  GENERAL-INFO-TR                  VALUE '6'.
  1719         88  AUTO-PROMPT-TR                   VALUE '7'.
  1720         88  DENIAL-TR                        VALUE '8'.
  1721         88  INCURRED-CHG-TR                  VALUE '9'.
  1722         88  FORM-CONTROL-TR                  VALUE 'A'.
  1723
  1724     12  AT-RECORDED-DT                  PIC XX.
  1725     12  AT-RECORDED-BY                  PIC X(4).
  1726     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  1727
  1728     12  AT-TRAILER-BODY                 PIC X(165).
  1729
  1730     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  1731         16  AT-RESERVE-CONTROLS.
  1732             20  AT-MANUAL-SW            PIC X.
  1733                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  1734             20  AT-FUTURE-SW            PIC X.
  1735                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  1736             20  AT-PTC-SW               PIC X.
  1737                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  1738             20  AT-IBNR-SW              PIC X.
  1739                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  1740             20  AT-PTC-LF-SW            PIC X.
  1741                 88  AT-LF-PTC-USED          VALUE '1'.
  1742             20  AT-CDT-ACCESS-METHOD    PIC X.
  1743                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  1744                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  1745                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  1746             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  1747         16  AT-LAST-COMPUTED-DT         PIC XX.
  1748         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  36
* EL151.cbl
  1749         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  1750         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  1751         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1752         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1753         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  1754         16  AT-EXPENSE-CONTROLS.
  1755             20  AT-EXPENSE-METHOD       PIC X.
  1756                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  1757                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  1758                 88  PERCENT-OF-PMT           VALUE '3'.
  1759                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  1760             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  1761             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  1762         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  1763         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  1764
  1765         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  1766         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  1767
  1768*        16  FILLER                      PIC X(53).
  1769         16  FILLER                      PIC X(47).
  1770
  1771         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  1772         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  1773
  1774         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  1775             20  AT-OPEN-CLOSE-DATE      PIC XX.
  1776             20  AT-OPEN-CLOSE-TYPE      PIC X.
  1777*                    C = CLOSED
  1778*                    O = OPEN
  1779             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  1780*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  1781
  1782     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  1783         16  AT-PAYMENT-TYPE             PIC X.
  1784             88  PARTIAL-PAYMENT                VALUE '1'.
  1785             88  FINAL-PAYMENT                  VALUE '2'.
  1786             88  LUMP-SUM-PAYMENT               VALUE '3'.
  1787             88  ADDITIONAL-PAYMENT             VALUE '4'.
  1788             88  CHARGEABLE-EXPENSE             VALUE '5'.
  1789             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  1790             88  VOIDED-PAYMENT                 VALUE '9'.
  1791             88  TRANSFER                       VALUE 'T'.
  1792             88  LIFE-INTEREST                  VALUE 'I'.
  1793
  1794         16  AT-CLAIM-TYPE               PIC X.
  1795             88  PAID-FOR-AH                    VALUE 'A'.
  1796             88  PAID-FOR-LIFE                  VALUE 'L'.
  1797             88  PAID-FOR-IUI                   VALUE 'I'.
  1798             88  PAID-FOR-GAP                   VALUE 'G'.
  1799             88  PAID-FOR-FAM                   VALUE 'F'.
  1800             88  PAID-FOR-OTH                   VALUE 'O'.
  1801         16  AT-CLAIM-PREM-TYPE          PIC X.
  1802             88  AT-SINGLE-PREMIUM              VALUE '1'.
  1803             88  AT-O-B-COVERAGE                VALUE '2'.
  1804             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  1805         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  1806         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  37
* EL151.cbl
  1807         16  AT-PAID-FROM-DT             PIC XX.
  1808         16  AT-PAID-THRU-DT             PIC XX.
  1809         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  1810         16  AT-ACH-PAYMENT              PIC X.
  1811*        16  FILLER                      PIC X.
  1812         16  AT-PAYEES-NAME              PIC X(30).
  1813         16  AT-PAYMENT-ORIGIN           PIC X.
  1814             88  ONLINE-MANUAL-PMT              VALUE '1'.
  1815             88  ONLINE-AUTO-PMT                VALUE '2'.
  1816             88  OFFLINE-PMT                    VALUE '3'.
  1817         16  AT-CHECK-WRITTEN-DT         PIC XX.
  1818         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  1819         16  AT-VOID-DATA.
  1820             20  AT-VOID-DT              PIC XX.
  1821*00144       20  AT-VOID-REASON          PIC X(30).
  1822             20  AT-VOID-REASON          PIC X(26).
  1823         16  AT-PMT-APPROVED-BY          PIC X(04).
  1824         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  1825         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  1826         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  1827                                         PIC S99V9(5)  COMP-3.
  1828         16  AT-CREDIT-INTERFACE.
  1829             20  AT-PMT-SELECT-DT        PIC XX.
  1830                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  1831             20  AT-PMT-ACCEPT-DT        PIC XX.
  1832                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  1833             20  AT-VOID-SELECT-DT       PIC XX.
  1834                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  1835             20  AT-VOID-ACCEPT-DT       PIC XX.
  1836                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  1837
  1838         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  1839                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1840                 88  CONVERSION-PAYMENT           VALUE +99999999.
  1841         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  1842
  1843         16  AT-FORCE-CONTROL            PIC X.
  1844             88  PAYMENT-WAS-FORCED           VALUE '1'.
  1845         16  AT-PREV-LAST-PMT-DT         PIC XX.
  1846         16  AT-PREV-PAID-THRU-DT        PIC XX.
  1847         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1848         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  1849         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  1850         16  AT-BENEFIT-TYPE             PIC X.
  1851
  1852         16  AT-EXPENSE-TYPE             PIC X.
  1853         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  1854
  1855         16  AT-PAYEE-TYPE-CD.
  1856             20  AT-PAYEE-TYPE           PIC X.
  1857                 88  INSURED-PAID           VALUE 'I'.
  1858                 88  BENEFICIARY-PAID       VALUE 'B'.
  1859                 88  ACCOUNT-PAID           VALUE 'A'.
  1860                 88  OTHER-1-PAID           VALUE 'O'.
  1861                 88  OTHER-2-PAID           VALUE 'Q'.
  1862                 88  DOCTOR-PAID            VALUE 'P'.
  1863                 88  EMPLOYER-PAID          VALUE 'E'.
  1864             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  38
* EL151.cbl
  1865
  1866         16  AT-CASH-PAYMENT             PIC X.
  1867         16  AT-GROUPED-PAYMENT          PIC X.
  1868         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  1869         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  1870         16  AT-APPROVED-LEVEL           PIC X.
  1871         16  AT-VOID-TYPE                PIC X.
  1872             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  1873             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  1874         16  AT-AIG-UNEMP-IND            PIC X.
  1875             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  1876         16  AT-ASSOCIATES               PIC X.
  1877             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  1878             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  1879
  1880         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  1881         16  AT-CV-PMT-CODE              PIC X.
  1882             88  FULL-DEATH-PAYMENT         VALUE '1'.
  1883             88  HALF-DEATH-PAYMENT         VALUE '2'.
  1884             88  FULL-ADD-PAYMENT           VALUE '3'.
  1885             88  HALF-ADD-PAYMENT           VALUE '4'.
  1886             88  FULL-RIDER-PAYMENT         VALUE '5'.
  1887             88  HALF-RIDER-PAYMENT         VALUE '6'.
  1888             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  1889             88  ADDL-PAYMENT               VALUE '8'.
  1890
  1891         16  AT-EOB-CODE1                PIC XXX.
  1892         16  AT-EOB-CODE2                PIC XXX.
  1893         16  AT-EOB-CODE3                PIC XXX.
  1894         16  FILLER REDEFINES AT-EOB-CODE3.
  1895             20  AT-PRINT-CLM-FORM       PIC X.
  1896             20  AT-PRINT-SURVEY         PIC X.
  1897             20  AT-SPECIAL-RELEASE      PIC X.
  1898         16  AT-EOB-CODE4                PIC XXX.
  1899         16  FILLER REDEFINES AT-EOB-CODE4.
  1900             20  AT-INT-PMT-SELECT-DT    PIC XX.
  1901             20  FILLER                  PIC X.
  1902         16  AT-EOB-CODE5                PIC XXX.
  1903         16  FILLER REDEFINES AT-EOB-CODE5.
  1904             20  AT-PMT-PROOF-DT         PIC XX.
  1905             20  FILLER                  PIC X.
  1906
  1907         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  1908             88  AT-PRINT-EOB            VALUE 'Y'.
  1909
  1910         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  1911         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  1912
  1913     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  1914         16  AT-SCHEDULE-START-DT        PIC XX.
  1915         16  AT-SCHEDULE-END-DT          PIC XX.
  1916         16  AT-TERMINATED-DT            PIC XX.
  1917         16  AT-LAST-PMT-TYPE            PIC X.
  1918             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  1919             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  1920         16  AT-FIRST-PMT-DATA.
  1921             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1922             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  39
* EL151.cbl
  1923             20  AT-1ST-PAY-THRU-DT      PIC XX.
  1924         16  AT-REGULAR-PMT-DATA.
  1925             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  1926             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  1927             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  1928         16  AT-AUTO-PAYEE-CD.
  1929             20  AT-AUTO-PAYEE-TYPE      PIC X.
  1930                 88  INSURED-PAID-AUTO      VALUE 'I'.
  1931                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  1932                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  1933                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1934                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1935             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1936         16  AT-AUTO-PAY-DAY             PIC 99.
  1937         16  AT-AUTO-CASH                PIC X.
  1938             88  AT-CASH                      VALUE 'Y'.
  1939             88  AT-NON-CASH                  VALUE 'N'.
  1940*        16  FILLER                      PIC X(129).
  1941         16  AT-AUTO-END-LETTER          PIC X(4).
  1942         16  FILLER                      PIC X(125).
  1943
  1944         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1945         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1946
  1947     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1948         16  AT-LETTER-SENT-DT           PIC XX.
  1949         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1950         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1951         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1952         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1953         16  AT-LETTER-ORIGIN            PIC X.
  1954             88  ONLINE-CREATION              VALUE '1' '3'.
  1955             88  OFFLINE-CREATION             VALUE '2' '4'.
  1956             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1957             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1958         16  AT-STD-LETTER-FORM          PIC X(4).
  1959         16  AT-REASON-TEXT              PIC X(70).
  1960         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1961         16  AT-ADDRESEE-TYPE            PIC X.
  1962              88  INSURED-ADDRESEE            VALUE 'I'.
  1963              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1964              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1965              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1966              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1967              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1968              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1969         16  AT-ADDRESSEE-NAME           PIC X(30).
  1970         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1971         16  AT-RESEND-PRINT-DATE        PIC XX.
  1972         16  AT-CORR-SOL-UNSOL           PIC X.
  1973         16  AT-LETTER-PURGED-DT         PIC XX.
  1974*
  1975*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1976*
  1977         16  AT-CSO-REDEFINITION.
  1978             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1979             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1980             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  40
* EL151.cbl
  1981             20  AT-STOP-LETTER-DT       PIC X(2).
  1982             20  AT-AUTH-RCVD            PIC X(1).
  1983             20  FILLER                  PIC X(18).
  1984*             20  FILLER                  PIC X(27).
  1985             20  AT-CSO-LETTER-STATUS    PIC X.
  1986                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1987                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1988                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1989             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1990             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1991*
  1992*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1993*
  1994*        16  FILLER                      PIC X(26).
  1995*
  1996*        16  AT-DMD-BSR-CODE             PIC X.
  1997*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1998*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1999*
  2000*        16  AT-DMD-LETTER-STATUS        PIC X.
  2001*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  2002*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  2003*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  2004*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  2005*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  2006
  2007         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  2008         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  2009
  2010     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  2011         16  AT-ADDRESS-TYPE             PIC X.
  2012             88  INSURED-ADDRESS               VALUE 'I'.
  2013             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  2014             88  ACCOUNT-ADDRESS               VALUE 'A'.
  2015             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  2016             88  EMPLOYER-ADDRESS              VALUE 'E'.
  2017             88  OTHER-ADDRESS-1               VALUE 'O'.
  2018             88  OTHER-ADDRESS-2               VALUE 'Q'.
  2019         16  AT-MAIL-TO-NAME             PIC X(30).
  2020         16  AT-ADDRESS-LINE-1           PIC X(30).
  2021         16  AT-ADDRESS-LINE-2           PIC X(30).
  2022         16  AT-CITY-STATE.
  2023             20  AT-CITY                 PIC X(28).
  2024             20  AT-STATE                PIC XX.
  2025         16  AT-ZIP.
  2026             20  AT-ZIP-CODE.
  2027                 24  AT-ZIP-1ST          PIC X.
  2028                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2029                 24  FILLER              PIC X(4).
  2030             20  AT-ZIP-PLUS4            PIC X(4).
  2031         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  2032             20  AT-CAN-POSTAL-1         PIC XXX.
  2033             20  AT-CAN-POSTAL-2         PIC XXX.
  2034             20  FILLER                  PIC XXX.
  2035         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  2036*         16  FILLER                      PIC X(23).
  2037         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  2038         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  41
* EL151.cbl
  2039         16  FILLER                      PIC X(13).
  2040         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  2041         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  2042
  2043     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2044         16  AT-INFO-LINE-1              PIC X(60).
  2045         16  FILLER REDEFINES AT-INFO-LINE-1.
  2046             20  AT-NOTE-ERROR-NO OCCURS 15
  2047                                         PIC X(4).
  2048         16  AT-INFO-LINE-2              PIC X(60).
  2049         16  FILLER REDEFINES AT-INFO-LINE-2.
  2050             20  AT-ICD-CODE-1           PIC X(8).
  2051             20  AT-ICD-CODE-2           PIC X(8).
  2052             20  FILLER                  PIC X(44).
  2053         16  AT-INFO-TRAILER-TYPE        PIC X.
  2054             88  AT-ERRORS-NOTE          VALUE 'E'.
  2055             88  AT-PAYMENT-NOTE         VALUE 'P'.
  2056             88  AT-CALL-NOTE            VALUE 'C'.
  2057             88  AT-MAINT-NOTE           VALUE 'M'.
  2058             88  AT-CERT-CHANGE          VALUE 'X'.
  2059             88  AT-APPROVAL-NOTE        VALUE 'R'.
  2060             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  2061             88  AT-CERT-CANCELLED       VALUE 'T'.
  2062         16  AT-CALL-TYPE                PIC X.
  2063             88  AT-PHONE-CALL-IN        VALUE 'I'.
  2064             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  2065             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  2066         16  AT-NOTE-CONTINUATION        PIC X.
  2067             88  AT-CONTINUED-NOTE       VALUE 'X'.
  2068         16  AT-EOB-CODES-EXIST          PIC X.
  2069             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  2070         16  FILLER                      PIC X(35).
  2071         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  2072         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  2073
  2074     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  2075         16  AT-PROMPT-LINE-1            PIC X(60).
  2076         16  AT-PROMPT-LINE-2            PIC X(60).
  2077         16  AT-PROMPT-START-DT          PIC XX.
  2078         16  AT-PROMPT-END-DT            PIC XX.
  2079         16  FILLER                      PIC X(35).
  2080         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  2081         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  2082
  2083     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2084         16  AT-DENIAL-INFO-1            PIC X(60).
  2085         16  AT-DENIAL-INFO-2            PIC X(60).
  2086         16  AT-DENIAL-DT                PIC XX.
  2087         16  AT-RETRACTION-DT            PIC XX.
  2088         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2089*         16  FILLER                      PIC X(31).
  2090         16  AT-DENIAL-PROOF-DT          PIC XX.
  2091         16  FILLER                      PIC X(29).
  2092         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2093         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2094
  2095     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2096         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  42
* EL151.cbl
  2097         16  AT-OLD-REPORTED-DT          PIC XX.
  2098         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2099         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2100         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2101         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2102         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2103         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2104         16  FILLER                      PIC X(26).
  2105         16  AT-OLD-DIAG-CODE            PIC X(6).
  2106         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2107         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2108         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2109         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2110         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2111         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2112         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2113         16  AT-OLD-ICD-CODE-1           PIC X(8).
  2114         16  AT-OLD-ICD-CODE-2           PIC X(8).
  2115         16  FILLER                      PIC X(9).
  2116         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2117
  2118     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2119         16  AT-FORM-SEND-ON-DT          PIC XX.
  2120         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2121         16  AT-FORM-RE-SEND-DT          PIC XX.
  2122         16  AT-FORM-ANSWERED-DT         PIC XX.
  2123         16  AT-FORM-PRINTED-DT          PIC XX.
  2124         16  AT-FORM-REPRINT-DT          PIC XX.
  2125         16  AT-FORM-TYPE                PIC X.
  2126             88  INITIAL-FORM                  VALUE '1'.
  2127             88  PROGRESS-FORM                 VALUE '2'.
  2128         16  AT-INSTRUCT-LN-1            PIC X(28).
  2129         16  AT-INSTRUCT-LN-2            PIC X(28).
  2130         16  AT-INSTRUCT-LN-3            PIC X(28).
  2131         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2132         16  AT-FORM-ADDRESS             PIC X.
  2133             88  FORM-TO-INSURED              VALUE 'I'.
  2134             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2135             88  FORM-TO-OTHER-1              VALUE 'O'.
  2136             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2137         16  AT-RELATED-1.
  2138             20 AT-REL-CARR-1            PIC X.
  2139             20 AT-REL-CLAIM-1           PIC X(7).
  2140             20 AT-REL-CERT-1            PIC X(11).
  2141         16  AT-RELATED-2.
  2142             20 AT-REL-CARR-2            PIC X.
  2143             20 AT-REL-CLAIM-2           PIC X(7).
  2144             20 AT-REL-CERT-2            PIC X(11).
  2145         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2146         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2147         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2148         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2149         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2150         16  AT-STOP-FORM-DT             PIC X(2).
  2151
  2152         16  FILLER                      PIC X(09).
  2153         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2154         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  43
* EL151.cbl
  2155******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  44
* EL151.cbl
  2157*                                    COPY ELCARCH.
  2158******************************************************************
  2159*                                                                *
  2160*                            ELCARCH.                            *
  2161*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2162*                            VMOD=2.007                          *
  2163*                                                                *
  2164*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2165*                                                                *
  2166*   FILE TYPE = VSAM,KSDS                                        *
  2167*   RECORD SIZE = 090  RECFORM = FIXED                           *
  2168*                                                                *
  2169*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  2170*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  2171*                                                                *
  2172*   LOG = NO                                                     *
  2173*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2174*                                                                *
  2175*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  2176******************************************************************
  2177 01  LETTER-ARCHIVE.
  2178     12  LA-RECORD-ID                PIC XX.
  2179         88  VALID-LA-ID                VALUE 'LA'.
  2180
  2181     12  LA-CONTROL-PRIMARY.
  2182         16  LA-COMPANY-CD           PIC X.
  2183         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  2184         16  LA-RECORD-TYPE          PIC X.
  2185             88  LA-HEADER-DATA         VALUE '1'.
  2186             88  LA-ADDRESS-DATA        VALUE '2'.
  2187             88  LA-TEXT-DATA           VALUE '3'.
  2188             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  2189         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  2190
  2191     12  LA-CONTROL-BY-TYPE.
  2192         16  LA-COMPANY-CD-A1        PIC X.
  2193         16  LA-RECORD-TYPE-A1       PIC X.
  2194         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  2195         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  2196
  2197     12  LA-TEXT-RECORD.
  2198         16  LA-SKIP-CONTROL         PIC XX.
  2199             88  NO-LINES-SKIPPED       VALUE SPACES.
  2200             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  2201         16  LA-TEXT-LINE            PIC X(70).
  2202
  2203     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  2204         16  FILLER                  PIC XX.
  2205         16  LA-ADDRESS-LINE         PIC X(30).
  2206         16  FILLER                  PIC X(40).
  2207
  2208     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  2209         16  FILLER                  PIC XX.
  2210         16  LA-CARRIER              PIC X.
  2211         16  LA-CLAIM-NO             PIC X(7).
  2212         16  LA-CERT-NO.
  2213             20  LA-CERT-PRIME       PIC X(10).
  2214             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  45
* EL151.cbl
  2215         16  LA-NO-OF-COPIES         PIC S9.
  2216         16  LA-RESEND-DATE          PIC XX.
  2217         16  LA-PROCESSOR-CD         PIC X(4).
  2218         16  LA-CREATION-DT          PIC XX.
  2219         16  LA-INITIAL-PRINT-DATE   PIC XX.
  2220         16  LA-RESEND-PRINT-DATE    PIC XX.
  2221         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  2222         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  2223*
  2224* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  2225*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  2226*   I        20  LA-DMD-PROD-CODE        PIC XX.
  2227*   I        20  LA-DMD-RES-ST           PIC XX.
  2228*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  2229*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  2230*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  2231*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  2232*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  2233*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  2234*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  2235*   I        20  LA-DMD-UND-CODE         PIC XX.
  2236*   I        20  LA-DMD-BEN-CODE         PIC XX.
  2237*   V    16  FILLER                  PIC X(15).
  2238* -----
  2239*
  2240* REINSERTED  CSO  MODS
  2241*
  2242         16  FILLER.
  2243             20  FILLER                  PIC X(29).
  2244             20  LA-CSO-LETTER-STATUS    PIC X.
  2245                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  2246                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  2247                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  2248             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  2249             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  2250*
  2251
  2252     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  2253         16  FILLER                  PIC XX.
  2254         16  LA4-CARRIER             PIC X.
  2255         16  LA4-CLAIM-NO            PIC X(7).
  2256         16  LA4-CERT-NO.
  2257             20  LA4-CERT-PRIME      PIC X(10).
  2258             20  LA4-CERT-SFX        PIC X.
  2259         16  LA4-NO-OF-COPIES        PIC S9.
  2260         16  LA4-RESEND-DATE         PIC XX.
  2261         16  LA4-PROCESSOR-CD        PIC X(4).
  2262         16  LA4-CREATION-DT         PIC XX.
  2263         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  2264         16  LA4-RESEND-PRINT-DATE   PIC XX.
  2265         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  2266         16  LA4-FORM-TYPE           PIC X.
  2267             88  LA4-INITIAL-FORM    VALUE '1'.
  2268             88  LA4-PROGRESS-FORM   VALUE '2'.
  2269         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  2270         16  LA4-STATE               PIC X(02).
  2271         16  FILLER                  PIC X(31).
  2272******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  46
* EL151.cbl
  2274*                                    COPY ELCCNTL.
  2275******************************************************************
  2276*                                                                *
  2277*                                                                *
  2278*                            ELCCNTL.                            *
  2279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2280*                            VMOD=2.059                          *
  2281*                                                                *
  2282*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2283*                                                                *
  2284*   FILE TYPE = VSAM,KSDS                                        *
  2285*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2286*                                                                *
  2287*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2288*       ALTERNATE INDEX = NONE                                   *
  2289*                                                                *
  2290*   LOG = YES                                                    *
  2291*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2292******************************************************************
  2293*                   C H A N G E   L O G
  2294*
  2295* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2296*-----------------------------------------------------------------
  2297*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2298* EFFECTIVE    NUMBER
  2299*-----------------------------------------------------------------
  2300* 082503                   PEMA  ADD BENEFIT GROUP
  2301* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2302* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2303* 092705    2005050300006  PEMA  ADD SPP LEASES
  2304* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2305* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2306* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2307* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2308* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2309* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2310* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2311* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2312* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2313* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2314* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2315******************************************************************
  2316*
  2317 01  CONTROL-FILE.
  2318     12  CF-RECORD-ID                       PIC XX.
  2319         88  VALID-CF-ID                        VALUE 'CF'.
  2320
  2321     12  CF-CONTROL-PRIMARY.
  2322         16  CF-COMPANY-ID                  PIC XXX.
  2323         16  CF-RECORD-TYPE                 PIC X.
  2324             88  CF-COMPANY-MASTER              VALUE '1'.
  2325             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2326             88  CF-STATE-MASTER                VALUE '3'.
  2327             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2328             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2329             88  CF-CARRIER-MASTER              VALUE '6'.
  2330             88  CF-MORTALITY-MASTER            VALUE '7'.
  2331             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  47
* EL151.cbl
  2332             88  CF-TERMINAL-MASTER             VALUE '9'.
  2333             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2334             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2335             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2336             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2337             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2338             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2339             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2340             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2341             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2342         16  CF-ACCESS-CD-GENL              PIC X(4).
  2343         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2344             20  CF-PROCESSOR               PIC X(4).
  2345         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2346             20  CF-STATE-CODE              PIC XX.
  2347             20  FILLER                     PIC XX.
  2348         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2349             20  FILLER                     PIC XX.
  2350             20  CF-HI-BEN-IN-REC           PIC XX.
  2351         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2352             20  FILLER                     PIC XXX.
  2353             20  CF-CARRIER-CNTL            PIC X.
  2354         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2355             20  FILLER                     PIC XX.
  2356             20  CF-HI-TYPE-IN-REC          PIC 99.
  2357         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2358             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2359                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2360             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2361             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2362         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2363             20  FILLER                     PIC X.
  2364             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2365         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2366             20  FILLER                     PIC XX.
  2367             20  CF-MORTGAGE-PLAN           PIC XX.
  2368         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2369
  2370     12  CF-LAST-MAINT-DT                   PIC XX.
  2371     12  CF-LAST-MAINT-BY                   PIC X(4).
  2372     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2373
  2374     12  CF-RECORD-BODY                     PIC X(728).
  2375
  2376
  2377****************************************************************
  2378*             COMPANY MASTER RECORD                            *
  2379****************************************************************
  2380
  2381     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2382         16  CF-COMPANY-ADDRESS.
  2383             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2384             20  CF-CL-IN-CARE-OF           PIC X(30).
  2385             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2386             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2387             20  CF-CL-CITY-STATE           PIC X(30).
  2388             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2389             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  48
* EL151.cbl
  2390         16  CF-COMPANY-CD                  PIC X.
  2391         16  CF-COMPANY-PASSWORD            PIC X(8).
  2392         16  CF-SECURITY-OPTION             PIC X.
  2393             88  ALL-SECURITY                   VALUE '1'.
  2394             88  COMPANY-VERIFY                 VALUE '2'.
  2395             88  PROCESSOR-VERIFY               VALUE '3'.
  2396             88  NO-SECURITY                    VALUE '4'.
  2397             88  ALL-BUT-TERM                   VALUE '5'.
  2398         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2399             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2400         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2401             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2402         16  CF-INFORCE-LOCATION            PIC X.
  2403             88  CERTS-ARE-ONLINE               VALUE '1'.
  2404             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2405             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2406         16  CF-LOWER-CASE-LETTERS          PIC X.
  2407         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2408             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2409             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2410             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2411             88  CF-ACCNT-CNTL                  VALUE '3'.
  2412             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2413
  2414         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2415         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2416
  2417         16  CF-LGX-CREDIT-USER             PIC X.
  2418             88  CO-IS-NOT-USER                 VALUE 'N'.
  2419             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2420
  2421         16 CF-CREDIT-CALC-CODES.
  2422             20  CF-CR-REM-TERM-CALC PIC X.
  2423               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2424               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2425               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2426               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2427               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2428               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2429               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2430             20  CF-CR-R78-METHOD           PIC X.
  2431               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2432               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2433
  2434         16  CF-CLAIM-CONTROL-COUNTS.
  2435             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2436                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2437
  2438             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2439                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2440
  2441             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2442                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2443
  2444             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2445                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2446
  2447         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  49
* EL151.cbl
  2448
  2449         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2450             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2451             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2452             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2453             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2454                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2455                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2456             20  CF-CO-PREM-REJECT-SW       PIC X.
  2457                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2458                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2459             20  CF-CO-REF-REJECT-SW        PIC X.
  2460                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2461                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2462
  2463         16  CF-CO-REPORTING-DT             PIC XX.
  2464         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2465         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2466           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2467           88  CF-CO-MONTH-END                  VALUE '1'.
  2468
  2469         16  CF-LGX-CLAIM-USER              PIC X.
  2470             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2471             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2472
  2473         16  CF-CREDIT-EDIT-CONTROLS.
  2474             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2475             20  CF-MIN-AGE                 PIC 99.
  2476             20  CF-DEFAULT-AGE             PIC 99.
  2477             20  CF-MIN-TERM                PIC S999      COMP-3.
  2478             20  CF-MAX-TERM                PIC S999      COMP-3.
  2479             20  CF-DEFAULT-SEX             PIC X.
  2480             20  CF-JOINT-AGE-INPUT         PIC X.
  2481                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2482             20  CF-BIRTH-DATE-INPUT        PIC X.
  2483                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2484             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2485                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2486                 88  CF-ZERO-CARRIER            VALUE '1'.
  2487                 88  CF-ZERO-GROUPING           VALUE '2'.
  2488                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2489             20  CF-EDIT-SW                 PIC X.
  2490                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2491             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2492             20  CF-CR-PR-METHOD            PIC X.
  2493               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2494               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2495             20  FILLER                     PIC X.
  2496
  2497         16  CF-CREDIT-MISC-CONTROLS.
  2498             20  CF-REIN-TABLE-SW           PIC X.
  2499                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2500             20  CF-COMP-TABLE-SW           PIC X.
  2501                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2502             20  CF-EXPERIENCE-RETENTION-AGE
  2503                                            PIC S9        COMP-3.
  2504             20  CF-CONVERSION-DT           PIC XX.
  2505             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  50
* EL151.cbl
  2506             20  CF-RUN-FREQUENCY-SW        PIC X.
  2507                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2508                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2509
  2510             20  CF-CR-CHECK-NO-CONTROL.
  2511                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2512                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2513                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2514                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2515                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2516                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2517
  2518                 24  CF-CR-CHECK-COUNT       REDEFINES
  2519                     CF-CR-CHECK-COUNTER      PIC X(4).
  2520
  2521                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2522                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2523
  2524                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2525                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2526                 24  CF-MAIL-PROCESSING       PIC X.
  2527                     88  MAIL-PROCESSING          VALUE 'Y'.
  2528
  2529         16  CF-MISC-SYSTEM-CONTROL.
  2530             20  CF-SYSTEM-C                 PIC X.
  2531                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2532             20  CF-SYSTEM-D                 PIC X.
  2533                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2534             20  CF-SOC-SEC-NO-SW            PIC X.
  2535                 88  SOC-SEC-NO-USED             VALUE '1'.
  2536             20  CF-MEMBER-NO-SW             PIC X.
  2537                 88  MEMBER-NO-USED              VALUE '1'.
  2538             20  CF-TAX-ID-NUMBER            PIC X(11).
  2539             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2540             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2541                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2542                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2543                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2544                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2545             20  CF-SYSTEM-E                 PIC X.
  2546                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2547
  2548         16  CF-LGX-LIFE-USER               PIC X.
  2549             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2550             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2551
  2552         16  CF-CR-MONTH-END-DT             PIC XX.
  2553
  2554         16  CF-FILE-MAINT-DATES.
  2555             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2556                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2557             20  CF-LAST-BATCH       REDEFINES
  2558                 CF-LAST-BATCH-NO               PIC X(4).
  2559             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2560             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2561             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2562             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2563             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  51
* EL151.cbl
  2564             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2565             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2566             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2567             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2568             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2569
  2570         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2571         16  FILLER                         PIC X.
  2572
  2573         16  CF-ALT-MORT-CODE               PIC X(4).
  2574         16  CF-MEMBER-CAPTION              PIC X(10).
  2575
  2576         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2577             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2578             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2579             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2580             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2581             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2582
  2583         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2584
  2585         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2586         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2587         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2588         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2589
  2590         16  CF-AH-OVERRIDE-L1              PIC X.
  2591         16  CF-AH-OVERRIDE-L2              PIC XX.
  2592         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2593         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2594
  2595         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2596         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2597
  2598         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2599         16  CF-AR-LAST-EL860-DT            PIC XX.
  2600         16  CF-MP-MONTH-END-DT             PIC XX.
  2601
  2602         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2603         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2604             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2605
  2606         16  CF-AR-MONTH-END-DT             PIC XX.
  2607
  2608         16  CF-CRDTCRD-USER                PIC X.
  2609             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2610             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2611
  2612         16  CF-CC-MONTH-END-DT             PIC XX.
  2613
  2614         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2615
  2616         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2617             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2618             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2619             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2620         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2621         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  52
* EL151.cbl
  2622         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2623         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2624             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2625             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2626         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2627         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2628         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2629             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2630         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2631
  2632         16  CF-CL-ZIP-CODE.
  2633             20  CF-CL-ZIP-PRIME.
  2634                 24  CF-CL-ZIP-1ST          PIC X.
  2635                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2636                 24  FILLER                 PIC X(4).
  2637             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2638         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2639             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2640             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2641             20  FILLER                     PIC XXX.
  2642
  2643         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2644         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2645         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2646         16  CF-CO-OPTION-START-DATE        PIC XX.
  2647         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2648           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2649                                                      '3' '4'.
  2650           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2651           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2652           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2653           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2654           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2655           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2656
  2657         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2658
  2659         16  CF-PAYMENT-APPROVAL-LEVELS.
  2660             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2661             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2662             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2663             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2664             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2665             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2666
  2667         16  CF-END-USER-REPORTING-USER     PIC X.
  2668             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2669             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2670
  2671         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2672             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2673             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2674
  2675         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2676
  2677         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2678         16  FILLER                         PIC X.
  2679
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  53
* EL151.cbl
  2680         16  CF-CREDIT-ARCHIVE-CNTL.
  2681             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2682             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2683             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2684
  2685         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2686
  2687         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2688             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2689             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2690
  2691         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2692             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2693             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2694
  2695         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2696
  2697         16  CF-CO-ACH-ID-CODE              PIC  X.
  2698             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2699             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2700             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2701         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2702         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2703         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2704         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2705         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2706         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2707         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2708         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2709         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2710                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2711         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2712                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2713
  2714         16  CF-CO-OVER-SHORT.
  2715             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2716             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2717
  2718*         16  FILLER                         PIC X(102).
  2719         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2720             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2721             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2722
  2723         16  CF-AH-APPROVAL-DAYS.
  2724             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2725             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2726             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2727             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2728
  2729         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2730
  2731         16  CF-APPROV-LEV-5.
  2732             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2733             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2734             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2735
  2736         16  FILLER                         PIC X(68).
  2737****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  54
* EL151.cbl
  2738*             PROCESSOR/USER RECORD                            *
  2739****************************************************************
  2740
  2741     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2742         16  CF-PROCESSOR-NAME              PIC X(30).
  2743         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2744         16  CF-PROCESSOR-TITLE             PIC X(26).
  2745         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2746                 88  MESSAGE-YES                VALUE 'Y'.
  2747                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2748
  2749*****************************************************
  2750****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2751****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2752****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2753****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2754*****************************************************
  2755
  2756         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2757             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2758             20  CF-APPLICATION-FORCE       PIC X.
  2759             20  CF-INDIVIDUAL-APP.
  2760                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2761                     28  CF-BROWSE-APP      PIC X.
  2762                     28  CF-UPDATE-APP      PIC X.
  2763
  2764         16  CF-CURRENT-TERM-ON             PIC X(4).
  2765         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2766             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2767             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2768             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2769             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2770             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2771             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2772             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2773         16  CF-PROCESSOR-CARRIER           PIC X.
  2774             88  NO-CARRIER-SECURITY            VALUE ' '.
  2775         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2776             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2777         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2778             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2779         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2780             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2781
  2782         16  CF-PROC-SYS-ACCESS-SW.
  2783             20  CF-PROC-CREDIT-CLAIMS-SW.
  2784                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2785                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2786                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2787                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2788             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2789                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2790                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2791             20  CF-PROC-LIFE-GNRLDGR-SW.
  2792                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2793                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2794                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2795                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  55
* EL151.cbl
  2796             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2797                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2798                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2799         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2800             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2801             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2802         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2803
  2804         16  CF-APPROVAL-LEVEL                  PIC X.
  2805             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2806             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2807             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2808             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2809             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2810
  2811         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2812
  2813         16  CF-LANGUAGE-TYPE                   PIC X.
  2814             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2815             88  CF-LANG-IS-FR                      VALUE 'F'.
  2816
  2817         16  CF-CSR-IND                         PIC X.
  2818         16  FILLER                             PIC X(239).
  2819
  2820****************************************************************
  2821*             PROCESSOR/REMINDERS RECORD                       *
  2822****************************************************************
  2823
  2824     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2825         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2826             20  CF-START-REMIND-DT         PIC XX.
  2827             20  CF-END-REMIND-DT           PIC XX.
  2828             20  CF-REMINDER-TEXT           PIC X(50).
  2829         16  FILLER                         PIC X(296).
  2830
  2831
  2832****************************************************************
  2833*             STATE MASTER RECORD                              *
  2834****************************************************************
  2835
  2836     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2837         16  CF-STATE-ABBREVIATION          PIC XX.
  2838         16  CF-STATE-NAME                  PIC X(25).
  2839         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2840         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2841             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2842             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2843             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2844             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2845                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2846                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2847             20  CF-ST-PREM-REJECT-SW       PIC X.
  2848                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2849                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2850             20  CF-ST-REF-REJECT-SW        PIC X.
  2851                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2852                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2853         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  56
* EL151.cbl
  2854         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2855         16  CF-ST-REFUND-RULES.
  2856             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2857             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2858             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2859         16  CF-ST-FST-PMT-EXTENSION.
  2860             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2861             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2862                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2863                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2864                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2865                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2866         16  CF-ST-STATE-CALL.
  2867             20  CF-ST-CALL-UNEARNED        PIC X.
  2868             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2869             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2870         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2871             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2872             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2873         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2874         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2875         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2876         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2877         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2878         16  FILLER                         PIC X.
  2879         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2880             20  CF-ST-BENEFIT-CD           PIC XX.
  2881             20  CF-ST-BENEFIT-KIND         PIC X.
  2882                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2883                 88  CF-ST-AH-KIND              VALUE 'A'.
  2884             20  CF-ST-REM-TERM-CALC        PIC X.
  2885                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2886                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2887                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2888                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2889                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2890                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2891                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2892                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2893
  2894             20  CF-ST-REFUND-CALC          PIC X.
  2895                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2896                 88  ST-REFD-BY-R78             VALUE '1'.
  2897                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2898                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2899                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2900                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2901                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2902                 88  ST-REFD-UTAH               VALUE '7'.
  2903                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2904                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2905                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2906
  2907             20  CF-ST-EARNING-CALC         PIC X.
  2908                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2909                 88  ST-EARN-BY-R78             VALUE '1'.
  2910                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2911                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  57
* EL151.cbl
  2912                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2913                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2914                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2915                 88  ST-EARN-MEAN               VALUE '8'.
  2916                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2917
  2918             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2919                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2920                 88  ST-OVRD-BY-R78             VALUE '1'.
  2921                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2922                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2923                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2924                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2925                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2926                 88  ST-OVRD-MEAN               VALUE '8'.
  2927                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2928             20  cf-st-extra-periods        pic 9.
  2929*            20  FILLER                     PIC X.
  2930
  2931         16  CF-ST-COMMISSION-CAPS.
  2932             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2933             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2934             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2935             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2936         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2937                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2938                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2939                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2940
  2941         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2942
  2943         16  CF-ST-STATUTORY-INTEREST.
  2944             20  CF-ST-STAT-DATE-FROM       PIC X.
  2945                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2946                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2947             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2948             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2949             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2950             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2951             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2952
  2953         16  CF-ST-OVER-SHORT.
  2954             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2955             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2956
  2957         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2958
  2959         16  CF-ST-RT-CALC                  PIC X.
  2960
  2961         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2962         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2963         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2964         16  CF-ST-RF-LR-CALC               PIC X.
  2965         16  CF-ST-RF-LL-CALC               PIC X.
  2966         16  CF-ST-RF-LN-CALC               PIC X.
  2967         16  CF-ST-RF-AH-CALC               PIC X.
  2968         16  CF-ST-RF-CP-CALC               PIC X.
  2969*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  58
* EL151.cbl
  2970*CIDMOD         16  FILLER                         PIC X(192).
  2971         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2972             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2973         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2974         16  CF-ST-VFY-2ND-BENE             PIC X.
  2975         16  CF-ST-CAUSAL-STATE             PIC X.
  2976         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2977         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2978         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2979             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2980         16  CF-ST-NET-ONLY-STATE           PIC X.
  2981             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2982         16  cf-commission-cap-required     pic x.
  2983         16  CF-ST-GA-COMMISSION-CAPS.
  2984             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2985             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2986             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2987             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2988         16  CF-ST-TOT-COMMISSION-CAPS.
  2989             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2990             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2991             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2992             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2993         16  FILLER                         PIC X(156).
  2994
  2995****************************************************************
  2996*             BENEFIT MASTER RECORD                            *
  2997****************************************************************
  2998
  2999     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3000         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3001             20  CF-BENEFIT-CODE            PIC XX.
  3002             20  CF-BENEFIT-NUMERIC  REDEFINES
  3003                 CF-BENEFIT-CODE            PIC XX.
  3004             20  CF-BENEFIT-ALPHA           PIC XXX.
  3005             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3006             20  CF-BENEFIT-COMMENT         PIC X(10).
  3007
  3008             20  CF-LF-COVERAGE-TYPE        PIC X.
  3009                 88  CF-REDUCING                VALUE 'R'.
  3010                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3011
  3012             20  CF-SPECIAL-CALC-CD         PIC X.
  3013                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3014                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3015                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3016                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3017                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3018                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3019                 88  CF-FARM-PLAN               VALUE 'F'.
  3020                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3021                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3022                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3023                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3024                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3025                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3026                 88  CF-PRUDENTIAL              VALUE 'P'.
  3027                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  59
* EL151.cbl
  3028                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3029                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3030                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3031                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3032                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3033
  3034             20  CF-JOINT-INDICATOR         PIC X.
  3035                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3036
  3037*            20  FILLER                     PIC X(12).
  3038             20  cf-maximum-benefits        pic s999 comp-3.
  3039             20  FILLER                     PIC X(09).
  3040             20  CF-BENEFIT-CATEGORY        PIC X.
  3041             20  CF-LOAN-TYPE               PIC X(8).
  3042
  3043             20  CF-CO-REM-TERM-CALC        PIC X.
  3044                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3045                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3046                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3047                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3048                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3049
  3050             20  CF-CO-EARNINGS-CALC        PIC X.
  3051                 88  CO-EARN-BY-R78             VALUE '1'.
  3052                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3053                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3054                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3055                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3056                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3057                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3058                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3059
  3060             20  CF-CO-REFUND-CALC          PIC X.
  3061                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3062                 88  CO-REFD-BY-R78             VALUE '1'.
  3063                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3064                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3065                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3066                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3067                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3068                 88  CO-REFD-MEAN               VALUE '8'.
  3069                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3070                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3071                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3072
  3073             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3074                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3075                 88  CO-OVRD-BY-R78             VALUE '1'.
  3076                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3077                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3078                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3079                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3080                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3081                 88  CO-OVRD-MEAN               VALUE '8'.
  3082                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3083
  3084             20  CF-CO-BEN-I-G-CD           PIC X.
  3085                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  60
* EL151.cbl
  3086                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3087                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3088
  3089         16  FILLER                         PIC X(304).
  3090
  3091
  3092****************************************************************
  3093*             CARRIER MASTER RECORD                            *
  3094****************************************************************
  3095
  3096     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3097         16  CF-ADDRESS-DATA.
  3098             20  CF-MAIL-TO-NAME            PIC X(30).
  3099             20  CF-IN-CARE-OF              PIC X(30).
  3100             20  CF-ADDRESS-LINE-1          PIC X(30).
  3101             20  CF-ADDRESS-LINE-2          PIC X(30).
  3102             20  CF-CITY-STATE              PIC X(30).
  3103             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3104             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3105
  3106         16  CF-CLAIM-NO-CONTROL.
  3107             20  CF-CLAIM-NO-METHOD         PIC X.
  3108                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3109                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3110                 88  CLAIM-NO-SEQ               VALUE '3'.
  3111                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3112             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3113                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3114                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3115                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3116
  3117         16  CF-CHECK-NO-CONTROL.
  3118             20  CF-CHECK-NO-METHOD         PIC X.
  3119                 88  CHECK-NO-MANUAL            VALUE '1'.
  3120                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3121                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3122                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3123             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3124                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3125
  3126         16  CF-DOMICILE-STATE              PIC XX.
  3127
  3128         16  CF-EXPENSE-CONTROLS.
  3129             20  CF-EXPENSE-METHOD          PIC X.
  3130                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3131                 88  DOLLARS-PER-PMT            VALUE '2'.
  3132                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3133                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3134             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3135             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3136
  3137         16  CF-CORRESPONDENCE-CONTROL.
  3138             20  CF-LETTER-RESEND-OPT       PIC X.
  3139                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3140                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3141             20  FILLER                     PIC X(4).
  3142
  3143         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  61
* EL151.cbl
  3144             20  CF-MANUAL-SW               PIC X.
  3145                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3146             20  CF-FUTURE-SW               PIC X.
  3147                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3148             20  CF-PTC-SW                  PIC X.
  3149                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3150             20  CF-IBNR-SW                 PIC X.
  3151                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3152             20  CF-PTC-LF-SW               PIC X.
  3153                 88  CF-LF-PTC-USED             VALUE '1'.
  3154             20  CF-CDT-ACCESS-METHOD       PIC X.
  3155                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3156                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3157                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3158             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3159
  3160         16  CF-CLAIM-CALC-METHOD           PIC X.
  3161             88  360-PLUS-MONTHS                VALUE '1'.
  3162             88  365-PLUS-MONTHS                VALUE '2'.
  3163             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3164             88  360-DAILY                      VALUE '4'.
  3165             88  365-DAILY                      VALUE '5'.
  3166
  3167         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3168         16  FILLER                         PIC X(11).
  3169
  3170         16  CF-LIMIT-AMOUNTS.
  3171             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3172             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3173             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3174             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3175             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3176             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3177             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3178             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3179             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3180             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3181
  3182         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3183         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3184         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3185
  3186         16  CF-ZIP-CODE.
  3187             20  CF-ZIP-PRIME.
  3188                 24  CF-ZIP-1ST             PIC X.
  3189                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3190                 24  FILLER                 PIC X(4).
  3191             20  CF-ZIP-PLUS4               PIC X(4).
  3192         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3193             20  CF-CAN-POSTAL-1            PIC XXX.
  3194             20  CF-CAN-POSTAL-2            PIC XXX.
  3195             20  FILLER                     PIC XXX.
  3196
  3197         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3198         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3199         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3200
  3201         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  62
* EL151.cbl
  3202             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3203             88  CF-NO-RATING                   VALUE 'N'.
  3204
  3205         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3206
  3207         16  CF-CARRIER-OVER-SHORT.
  3208             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3209             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3210
  3211         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3212         16  CF-SECPAY-SWITCH               PIC X.
  3213             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3214             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3215         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3216         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3217         16  FILLER                         PIC X(444).
  3218*        16  FILLER                         PIC X(452).
  3219
  3220
  3221****************************************************************
  3222*             MORTALITY MASTER RECORD                          *
  3223****************************************************************
  3224
  3225     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3226         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3227                                INDEXED BY CF-MORT-NDX.
  3228             20  CF-MORT-TABLE              PIC X(5).
  3229             20  CF-MORT-TABLE-TYPE         PIC X.
  3230                 88  CF-MORT-JOINT              VALUE 'J'.
  3231                 88  CF-MORT-SINGLE             VALUE 'S'.
  3232                 88  CF-MORT-COMBINED           VALUE 'C'.
  3233                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3234                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3235             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3236             20  CF-MORT-AGE-METHOD         PIC XX.
  3237                 88  CF-AGE-LAST                VALUE 'AL'.
  3238                 88  CF-AGE-NEAR                VALUE 'AN'.
  3239             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3240             20  CF-MORT-ADJUSTMENT-DIRECTION
  3241                                            PIC X.
  3242                 88  CF-MINUS                   VALUE '-'.
  3243                 88  CF-PLUS                    VALUE '+'.
  3244             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3245             20  CF-MORT-JOINT-CODE         PIC X.
  3246                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3247             20  CF-MORT-PC-Q               PIC X.
  3248                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3249             20  CF-MORT-TABLE-CODE         PIC X(4).
  3250             20  CF-MORT-COMMENTS           PIC X(15).
  3251             20  FILLER                     PIC X(14).
  3252
  3253         16  FILLER                         PIC X(251).
  3254
  3255
  3256****************************************************************
  3257*             BUSSINESS TYPE MASTER RECORD                     *
  3258****************************************************************
  3259
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  63
* EL151.cbl
  3260     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3261* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3262* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3263* AND RECORD 05 IS TYPES 81-99
  3264         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3265             20  CF-BUSINESS-TITLE          PIC  X(19).
  3266             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3267                                            PIC S9V9(4) COMP-3.
  3268             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3269             20  FILLER                     PIC  X.
  3270         16  FILLER                         PIC  X(248).
  3271
  3272
  3273****************************************************************
  3274*             TERMINAL MASTER RECORD                           *
  3275****************************************************************
  3276
  3277     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3278
  3279         16  CF-COMPANY-TERMINALS.
  3280             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3281                                  PIC X(4).
  3282         16  FILLER               PIC X(248).
  3283
  3284
  3285****************************************************************
  3286*             LIFE EDIT MASTER RECORD                          *
  3287****************************************************************
  3288
  3289     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3290         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3291             20  CF-LIFE-CODE-IN            PIC XX.
  3292             20  CF-LIFE-CODE-OUT           PIC XX.
  3293         16  FILLER                         PIC X(248).
  3294
  3295
  3296****************************************************************
  3297*             AH EDIT MASTER RECORD                            *
  3298****************************************************************
  3299
  3300     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3301         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3302             20  CF-AH-CODE-IN              PIC XXX.
  3303             20  CF-AH-CODE-OUT             PIC XX.
  3304         16  FILLER                         PIC X(248).
  3305
  3306
  3307****************************************************************
  3308*             CREDIBILITY TABLES                               *
  3309****************************************************************
  3310
  3311     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3312         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3313                             INDEXED BY CF-CRDB-NDX.
  3314             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3315             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3316             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3317         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  64
* EL151.cbl
  3318
  3319
  3320****************************************************************
  3321*             REPORT CUSTOMIZATION RECORD                      *
  3322****************************************************************
  3323
  3324     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3325         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3326             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3327             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3328             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3329**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3330****       A T-TRANSFER.                                   ****
  3331             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3332
  3333         16  FILLER                         PIC XX.
  3334
  3335         16  CF-CARRIER-CNTL-OPT.
  3336             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3337                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3338                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3339             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3340                                            PIC X.
  3341         16  CF-GROUP-CNTL-OPT.
  3342             20  CF-GROUP-OPT-SEQ           PIC 9.
  3343                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3344                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3345             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3346                                            PIC X(6).
  3347         16  CF-STATE-CNTL-OPT.
  3348             20  CF-STATE-OPT-SEQ           PIC 9.
  3349                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3350                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3351             20  CF-STATE-SELECT OCCURS 3 TIMES
  3352                                            PIC XX.
  3353         16  CF-ACCOUNT-CNTL-OPT.
  3354             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3355                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3356                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3357             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3358                                            PIC X(10).
  3359         16  CF-BUS-TYP-CNTL-OPT.
  3360             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3361                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3362                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3363             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3364                                            PIC XX.
  3365         16  CF-LF-TYP-CNTL-OPT.
  3366             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3367                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3368                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3369             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3370                                            PIC XX.
  3371         16  CF-AH-TYP-CNTL-OPT.
  3372             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3373                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3374                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3375             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  65
* EL151.cbl
  3376                                            PIC XX.
  3377         16  CF-REPTCD1-CNTL-OPT.
  3378             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3379                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3380                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3381             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3382                                            PIC X(10).
  3383         16  CF-REPTCD2-CNTL-OPT.
  3384             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3385                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3386                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3387             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3388                                            PIC X(10).
  3389         16  CF-USER1-CNTL-OPT.
  3390             20  CF-USER1-OPT-SEQ           PIC 9.
  3391                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3392                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3393             20  CF-USER1-SELECT OCCURS 3 TIMES
  3394                                            PIC X(10).
  3395         16  CF-USER2-CNTL-OPT.
  3396             20  CF-USER2-OPT-SEQ           PIC 9.
  3397                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3398                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3399             20  CF-USER2-SELECT OCCURS 3 TIMES
  3400                                            PIC X(10).
  3401         16  CF-USER3-CNTL-OPT.
  3402             20  CF-USER3-OPT-SEQ           PIC 9.
  3403                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3404                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3405             20  CF-USER3-SELECT OCCURS 3 TIMES
  3406                                            PIC X(10).
  3407         16  CF-USER4-CNTL-OPT.
  3408             20  CF-USER4-OPT-SEQ           PIC 9.
  3409                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3410                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3411             20  CF-USER4-SELECT OCCURS 3 TIMES
  3412                                            PIC X(10).
  3413         16  CF-USER5-CNTL-OPT.
  3414             20  CF-USER5-OPT-SEQ           PIC 9.
  3415                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3416                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3417             20  CF-USER5-SELECT OCCURS 3 TIMES
  3418                                            PIC X(10).
  3419         16  CF-REINS-CNTL-OPT.
  3420             20  CF-REINS-OPT-SEQ           PIC 9.
  3421                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3422                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3423             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3424                 24  CF-REINS-PRIME         PIC XXX.
  3425                 24  CF-REINS-SUB           PIC XXX.
  3426
  3427         16  CF-AGENT-CNTL-OPT.
  3428             20  CF-AGENT-OPT-SEQ           PIC 9.
  3429                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3430                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3431             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3432                                            PIC X(10).
  3433
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  66
* EL151.cbl
  3434         16  FILLER                         PIC X(43).
  3435
  3436         16  CF-LOSS-RATIO-SELECT.
  3437             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3438             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3439         16  CF-ENTRY-DATE-SELECT.
  3440             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3441             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3442         16  CF-EFFECTIVE-DATE-SELECT.
  3443             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3444             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3445
  3446         16  CF-EXCEPTION-LIST-IND          PIC X.
  3447             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3448
  3449         16  FILLER                         PIC X(318).
  3450
  3451****************************************************************
  3452*                  EXCEPTION REPORTING RECORD                  *
  3453****************************************************************
  3454
  3455     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3456         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3457             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3458
  3459         16  CF-COMBINED-LIFE-AH-OPT.
  3460             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3461             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3462             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3463             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3464
  3465         16  CF-LIFE-OPT.
  3466             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3467             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3468             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3469             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3470             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3471             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3472             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3473             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3474             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3475             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3476
  3477         16  CF-AH-OPT.
  3478             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3479             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3480             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3481             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3482             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3483             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3484             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3485             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3486             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3487             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3488
  3489         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3490             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3491             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  67
* EL151.cbl
  3492             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3493
  3494         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3495
  3496         16  FILLER                         PIC X(673).
  3497
  3498
  3499****************************************************************
  3500*             MORTGAGE SYSTEM PLAN RECORD                      *
  3501****************************************************************
  3502
  3503     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3504         16  CF-PLAN-TYPE                   PIC X.
  3505             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3506             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3507             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3508         16  CF-PLAN-ABBREV                 PIC XXX.
  3509         16  CF-PLAN-DESCRIPT               PIC X(10).
  3510         16  CF-PLAN-NOTES                  PIC X(20).
  3511         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3512         16  CF-PLAN-UNDERWRITING.
  3513             20  CF-PLAN-TERM-DATA.
  3514                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3515                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3516             20  CF-PLAN-AGE-DATA.
  3517                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3518                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3519                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3520             20  CF-PLAN-BENEFIT-DATA.
  3521                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3522                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3523                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3524                                            PIC S9(7)V99  COMP-3.
  3525         16  CF-PLAN-POLICY-FORMS.
  3526             20  CF-POLICY-FORM             PIC X(12).
  3527             20  CF-MASTER-APPLICATION      PIC X(12).
  3528             20  CF-MASTER-POLICY           PIC X(12).
  3529         16  CF-PLAN-RATING.
  3530             20  CF-RATE-CODE               PIC X(5).
  3531             20  CF-SEX-RATING              PIC X.
  3532                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3533                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3534             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3535             20  CF-SUB-STD-TYPE            PIC X.
  3536                 88  CF-PCT-OF-PREM            VALUE '1'.
  3537                 88  CF-PCT-OF-BENE            VALUE '2'.
  3538         16  CF-PLAN-PREM-TOLERANCES.
  3539             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3540             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3541         16  CF-PLAN-PYMT-TOLERANCES.
  3542             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3543             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3544         16  CF-PLAN-MISC-DATA.
  3545             20  FILLER                     PIC X.
  3546             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3547             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3548         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3549         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  68
* EL151.cbl
  3550             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3551                                                     '1'.
  3552             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3553                                                     '2'.
  3554         16  CF-MIB-SEARCH-SW               PIC X.
  3555             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3556             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3557             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3558             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3559         16  CF-ALPHA-SEARCH-SW             PIC X.
  3560             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3561             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3562             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3563             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3564             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3565             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3566             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3567             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3568             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3569             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3570                                                     'A' 'B' 'C'
  3571                                                     'X' 'Y' 'Z'.
  3572         16  CF-EFF-DT-RULE-SW              PIC X.
  3573             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3574             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3575             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3576             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3577             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3578         16  FILLER                         PIC X(4).
  3579         16  CF-HEALTH-QUESTIONS            PIC X.
  3580             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3581         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3582         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3583         16  CF-PLAN-SNGL-JNT               PIC X.
  3584             88  CF-COMBINED-PLAN              VALUE 'C'.
  3585             88  CF-JNT-PLAN                   VALUE 'J'.
  3586             88  CF-SNGL-PLAN                  VALUE 'S'.
  3587         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3588         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3589         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3590         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3591         16  CF-RERATE-CNTL                 PIC  X.
  3592             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3593             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3594             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3595             88  CF-AUTO-RECALC                 VALUE '4'.
  3596         16  CF-BENEFIT-TYPE                PIC  X.
  3597             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3598             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3599         16  CF-POLICY-FEE                  PIC S999V99
  3600                                                    COMP-3.
  3601         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3602         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3603         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3604         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3605         16  FILLER                         PIC  X(32).
  3606         16  CF-TERMINATION-FORM            PIC  X(04).
  3607         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  69
* EL151.cbl
  3608         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3609                                                       COMP-3.
  3610         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3611         16  CF-ISSUE-LETTER                PIC  X(4).
  3612         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3613         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3614             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3615             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3616         16  CF-MP-REFUND-CALC              PIC X.
  3617             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3618             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3619             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3620             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3621             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3622             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3623             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3624             88  CF-MP-REFD-MEAN                VALUE '8'.
  3625         16  CF-ALT-RATE-CODE               PIC  X(5).
  3626
  3627
  3628         16  FILLER                         PIC X(498).
  3629****************************************************************
  3630*             MORTGAGE COMPANY MASTER RECORD                   *
  3631****************************************************************
  3632
  3633     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3634         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3635         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3636             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3637             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3638             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3639             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3640             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3641
  3642         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3643         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3644         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3645         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3646         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3647
  3648         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3649             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3650         16  CF-MP-RECON-USE-IND            PIC X(1).
  3651             88  CF-MP-USE-RECON             VALUE 'Y'.
  3652         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3653             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3654         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3655             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3656             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3657         16  FILLER                         PIC X(1).
  3658         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3659             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3660         16  CF-MORTG-MIB-VERSION           PIC X.
  3661             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3662             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3663             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3664         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3665             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  70
* EL151.cbl
  3666                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3667             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3668                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3669             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3670                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3671             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3672                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3673             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3674                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3675             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3676                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3677         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3678         16  FILLER                         PIC X(7).
  3679         16  CF-MORTG-DESTINATION-SYMBOL.
  3680             20  CF-MORTG-MIB-COMM          PIC X(5).
  3681             20  CF-MORTG-MIB-TERM          PIC X(5).
  3682         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3683             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3684         16  FILLER                         PIC X(03).
  3685         16  CF-MP-CHECK-NO-CONTROL.
  3686             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3687                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3688                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3689                                                ' ' LOW-VALUES.
  3690                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3691                                               VALUE '3'.
  3692         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3693         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3694         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3695             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3696                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3697             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3698                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3699             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3700                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3701             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3702                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3703             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3704                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3705             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3706                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3707         16  CF-MORTG-BILLING-AREA.
  3708             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3709                                            PIC X.
  3710         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3711         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3712         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3713         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3714             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3715             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3716         16  FILLER                         PIC X.
  3717         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3718             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3719             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3720         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3721         16  FILLER                         PIC X(8).
  3722         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3723         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  71
* EL151.cbl
  3724         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3725         16  CF-ACH-COMPANY-ID.
  3726             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3727                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3728                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3729                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3730             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3731         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3732             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3733         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3734             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3735             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3736         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3737         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3738         16  FILLER                         PIC X(536).
  3739
  3740****************************************************************
  3741*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3742****************************************************************
  3743
  3744     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3745         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3746             20  CF-FEMALE-HEIGHT.
  3747                 24  CF-FEMALE-FT           PIC 99.
  3748                 24  CF-FEMALE-IN           PIC 99.
  3749             20  CF-FEMALE-MIN-WT           PIC 999.
  3750             20  CF-FEMALE-MAX-WT           PIC 999.
  3751         16  FILLER                         PIC X(428).
  3752
  3753     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3754         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3755             20  CF-MALE-HEIGHT.
  3756                 24  CF-MALE-FT             PIC 99.
  3757                 24  CF-MALE-IN             PIC 99.
  3758             20  CF-MALE-MIN-WT             PIC 999.
  3759             20  CF-MALE-MAX-WT             PIC 999.
  3760         16  FILLER                         PIC X(428).
  3761******************************************************************
  3762*             AUTOMATIC ACTIVITY RECORD                          *
  3763******************************************************************
  3764     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3765         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3766             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3767             20  CF-SYS-LETTER-ID           PIC X(04).
  3768             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3769             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3770             20  CF-SYS-RESET-SW            PIC X(01).
  3771             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3772             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3773
  3774         16  FILLER                         PIC X(50).
  3775
  3776         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3777             20  CF-USER-ACTIVE-SW          PIC X(01).
  3778             20  CF-USER-LETTER-ID          PIC X(04).
  3779             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3780             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3781             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  72
* EL151.cbl
  3782             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3783             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3784             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3785
  3786         16  FILLER                         PIC X(246).
  3787*                                    COPY ELCDENY.
  3788******************************************************************
  3789*                                                                *
  3790*                                                                *
  3791*                            ELCDENY                             *
  3792*                            VMOD=2.001                          *
  3793*                                                                *
  3794*   CLAIM SYSTEM DENIAL/RECESSION/REFORMATION TABLE              *
  3795*                                                                *
  3796*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3797*   VSAM DENIAL TABLE                                            *
  3798*                                                                *
  3799*   FILE DESCRIPTION = DENIAL CODE TABLE                         *
  3800*                                                                *
  3801*   FILE TYPE = VSAM,KSDS                                        *
  3802*   RECORD SIZE = 125   RECFORM = FIX                            *
  3803*                                                                *
  3804*   BASE CLUSTER NAME = ELCDENY                   RKP=2,LEN=15   *
  3805*       ALTERNATE PATH1 = ELDENY2 (ALT GROUPING) RKP=17,LEN=16   *
  3806*                                                                *
  3807*   LOG = NO                                                     *
  3808*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3809*                                                                *
  3810*                                                                *
  3811******************************************************************
  3812*                   C H A N G E   L O G
  3813*
  3814* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3815*-----------------------------------------------------------------
  3816*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3817* EFFECTIVE    NUMBER
  3818*-----------------------------------------------------------------
  3819* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  3820******************************************************************
  3821 01  DENIAL-CODES.
  3822     12  DN-RECORD-ID                      PIC XX.
  3823         88  VALID-DN-ID                      VALUE 'DN'.
  3824     12  DN-CONTROL-PRIMARY.
  3825         16  DN-COMPANY-CD                 PIC X.
  3826         16  DN-DENIAL-CODE                PIC X(4).
  3827         16  FILLER                        PIC X(10).
  3828     12  DN-CONTROL-BY-TYPE.
  3829         16  DN-COMPANY-CD-A1              PIC X.
  3830         16  DN-RECORD-TYPE                PIC X.
  3831         16  DN-DENIAL-CODE-A1             PIC X(4).
  3832         16  FILLER                        PIC X(10).
  3833     12  DN-MAINT-INFORMATION.
  3834         16  DN-LAST-MAINT-DT              PIC XX.
  3835         16  DN-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3836         16  DN-LAST-MAINT-USER            PIC X(4).
  3837         16  FILLER                        PIC XX.
  3838     12  DN-DESCRIPTION                    PIC X(50).
  3839     12  FILLER                            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  73
* EL151.cbl
  3840******************************************************************
  3841*                                    COPY ELCDAR.
  3842******************************************************************
  3843*                                                                *
  3844*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  3845*   FILE TYPE = VSAM,KSDS                                        *
  3846*   RECORD SIZE = 25   RECFORM = FIXED                           *
  3847*   BASE CLUSTER = DLYACTV                                       *
  3848*   LOG = YES                                                    *
  3849*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  3850*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  3851*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  3852*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  3853*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  3854*               BY PROGRAM "LGINFCE".                            *
  3855*                                                                *
  3856******************************************************************
  3857 01  DAILY-ACTIVITY-RECORD.
  3858     05  DA-KEY.
  3859         10  DA-COMP-CD          PIC X.
  3860         10  DA-CARRIER          PIC X.
  3861         10  DA-CLAIM-NO         PIC X(7).
  3862         10  DA-CERT-NO.
  3863             15  DA-CERT-PRIME   PIC X(10).
  3864             15  DA-CERT-SFX     PIC X.
  3865     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  3866     05  DA-RECORD-TYPE          PIC X.
  3867     05  FILLER                  PIC X(2).
  3868******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  74
* EL151.cbl
  3870*                                    COPY ERCDMDNT.
  3871******************************************************************
  3872*                                                                *
  3873*                            ERCDMDNT                            *
  3874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3875*                            VMOD=2.005                          *
  3876*                                                                *
  3877*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  3878*                                                                *
  3879*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  3880*                                                                *
  3881*        FILE TYPE= VSAM,KSDS                                    *
  3882*        RECORD SIZE = 825    RECFORM = FIXED                    *
  3883*                                                                *
  3884*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  3885*                                                                *
  3886*        LOG = YES                                               *
  3887*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  3888*                                                                *
  3889******************************************************************
  3890
  3891 01  CERTIFICATE-NOTE.
  3892     12  CN-RECORD-ID                     PIC  XX.
  3893         88  VALID-CN-ID                      VALUE 'CN'.
  3894
  3895     12  CN-CONTROL-PRIMARY.
  3896         16  CN-COMPANY-CD                PIC X.
  3897         16  CN-CERT-KEY.
  3898             20  CN-CARRIER               PIC X.
  3899             20  CN-GROUPING.
  3900                 24  CN-GROUPING-PREFIX   PIC XXX.
  3901                 24  CN-GROUPING-PRIME    PIC XXX.
  3902             20  CN-STATE                 PIC XX.
  3903             20  CN-ACCOUNT.
  3904                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  3905                 24  CN-ACCOUNT-PRIME     PIC X(6).
  3906             20  CN-CERT-EFF-DT           PIC XX.
  3907             20  CN-CERT-NO.
  3908                 24  CN-CERT-PRIME        PIC X(10).
  3909                 24  CN-CERT-SFX          PIC X.
  3910
  3911     12  CN-BILLING-START-LINE-NO         PIC 99.
  3912     12  CN-BILLING-END-LINE-NO           PIC 99.
  3913
  3914     12  CN-LINES.
  3915         16  CN-LINE                      PIC X(77)  OCCURS 10.
  3916
  3917     12  CN-CSI-NOTES REDEFINES CN-LINES.
  3918         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  3919         16  CN-CSI-GENERAL-DATA-AREA.
  3920             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  3921
  3922         16  CN-CSI-GENERAL-DATA-R REDEFINES
  3923             CN-CSI-GENERAL-DATA-AREA.
  3924             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  3925             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  3926             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  3927             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  75
* EL151.cbl
  3928             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  3929             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  3930             20  CN-CSI-GEN-INFRM-MI          PIC X.
  3931             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  3932             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  3933             20  FILLER                       PIC XX.
  3934             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  3935             20  FILLER                       PIC X(38).
  3936
  3937         16  CN-CSI-PRODUCT-DATA-AREA.
  3938             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  3939
  3940         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  3941             CN-CSI-PRODUCT-DATA-AREA.
  3942             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  3943             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  3944             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  3945             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  3946             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  3947             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  3948             20  FILLER                   PIC XX.
  3949             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3950             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3951             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  3952             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  3953             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3954             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3955             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3956             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3957             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  3958             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  3959             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  3960             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  3961             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  3962             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  3963             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  3964             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  3965             20  CN-CSI-CC-TERM-AGE       PIC 999.
  3966             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  3967             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  3968             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  3969             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  3970             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  3971             20  FILLER                   PIC X(25).
  3972
  3973         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  3974             CN-CSI-CREDIT-CARD-DATA.
  3975             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  3976             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  3977             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  3978             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  3979             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  3980             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  3981             20  FILLER                   PIC XX.
  3982             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3983             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3984             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  3985             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  76
* EL151.cbl
  3986             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3987             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3988             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3989             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3990             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  3991             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  3992             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  3993             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  3994             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  3995             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  3996             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  3997             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  3998             20  CN-CSI-FL-TERM-AGE       PIC 999.
  3999             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  4000             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  4001             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  4002             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  4003             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  4004             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  4005             20  FILLER                   PIC X(17).
  4006
  4007         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  4008             CN-CSI-FAMILY-LEAVE-DATA.
  4009             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  4010             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  4011             20  CN-CSI-SL-BENE-REL       PIC X(8).
  4012             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  4013             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  4014             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  4015             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  4016             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  4017             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  4018             20  CN-CSI-SL-INT-ON-PROCEEDS
  4019                                          PIC S9(5)V99  COMP-3.
  4020             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  4021             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  4022             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  4023             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  4024             20  CN-CSI-SL-POLICY-BENEFITS
  4025                                          PIC S9(5)V99  COMP-3.
  4026             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  4027             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  4028             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  4029             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  4030             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  4031             20  CN-CSI-SL-PREM-MODE      PIC 99.
  4032             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  4033             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  4034             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  4035             20  CN-CSI-SL-STATE-NOT      PIC X.
  4036             20  FILLER                   PIC XX.
  4037
  4038         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  4039             CN-CSI-SENIOR-LIFE-DATA.
  4040             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  4041             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  4042             20  CN-CSI-PP-BEN-PAID-TO-DATE
  4043                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  77
* EL151.cbl
  4044             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  4045             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  4046             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  4047             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  4048             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  4049             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  4050             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  4051             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  4052             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  4053             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  4054             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  4055             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  4056             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  4057             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  4058             20  CN-CSI-PP-REPAIR         PIC X.
  4059             20  CN-CSI-PP-REPLACE        PIC X.
  4060             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  4061             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  4062             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  4063             20  CN-CSI-PP-TERM-AGE       PIC 999.
  4064             20  FILLER                   PIC X(5).
  4065
  4066         16  CN-CSI-EXT-WARR-DATA REDEFINES
  4067             CN-CSI-PURCH-PROP-DATA.
  4068             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  4069             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  4070             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  4071             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  4072             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  4073             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  4074             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  4075             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  4076             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  4077             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  4078             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  4079             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  4080             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  4081             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  4082             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  4083             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  4084             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  4085             20  CN-CSI-EW-REPLACE        PIC X.
  4086             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  4087             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  4088             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  4089             20  CN-CSI-EW-TERM-AGE       PIC 999.
  4090             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  4091             20  FILLER                   PIC X(4).
  4092
  4093     12  CN-LAST-MAINT-DT                 PIC XX.
  4094     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  4095     12  CN-LAST-MAINT-USER               PIC X(4).
  4096     12  FILLER                           PIC X(6).
  4097
  4098******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  78
* EL151.cbl
  4100 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  4101                          ACTIVITY-TRAILERS LETTER-ARCHIVE
  4102                          CONTROL-FILE DENIAL-CODES
  4103                          DAILY-ACTIVITY-RECORD
  4104                          CERTIFICATE-NOTE.
  4105 0000-DFHEXIT SECTION.
  4106     MOVE '9#                    $   ' TO DFHEIV0.
  4107     MOVE 'EL151' TO DFHEIV1.
  4108     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4109
  4110     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  4111     MOVE '5'                    TO DC-OPTION-CODE.
  4112     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  4113     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4114     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4115
  4116 0001-PROCESSING-EXITS.
  4117     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4118     IF EIBCALEN NOT GREATER THAN ZEROS
  4119       GO TO 8800-UNAUTHORIZED-ACCESS.
  4120
  4121
  4122* EXEC CICS  HANDLE CONDITION
  4123*           ERROR    (9990-ABEND)
  4124*           PGMIDERR (9600-PGMID-ERROR)
  4125*    END-EXEC.
  4126*    MOVE '"$.L                  ! " #00004117' TO DFHEIV0
  4127     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  4128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4129     MOVE X'2220233030303034313137' TO DFHEIV0(25:11)
  4130     CALL 'kxdfhei1' USING DFHEIV0
  4131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4132
  4133
  4134     IF PI-CALLING-PROGRAM  NOT  = THIS-PGM
  4135         IF PI-RETURN-TO-PROGRAM NOT  =  THIS-PGM
  4136             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  4137             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  4138             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  4139             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  4140             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  4141             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  4142             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  4143             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  4144         ELSE
  4145             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  4146             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  4147             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  4148             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  4149             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  4150             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  4151             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  4152             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  4153
  4154     IF EIBAID IS EQUAL TO DFHCLEAR
  4155         GO TO 9400-CLEAR.
  4156
  4157     IF PI-PROCESSOR-ID = 'LGXX'
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  79
* EL151.cbl
  4158         NEXT SENTENCE
  4159     ELSE
  4160
  4161* EXEC CICS READQ TS
  4162*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4163*            INTO    (SECURITY-CONTROL)
  4164*            LENGTH  (SC-COMM-LENGTH)
  4165*            ITEM    (SC-ITEM)
  4166*        END-EXEC
  4167*    MOVE '*$II   L              ''   #00004148' TO DFHEIV0
  4168     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4169     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4170     MOVE X'2020233030303034313438' TO DFHEIV0(25:11)
  4171     CALL 'kxdfhei1' USING DFHEIV0,
  4172           PI-SECURITY-TEMP-STORE-ID,
  4173           SECURITY-CONTROL,
  4174           SC-COMM-LENGTH,
  4175           SC-ITEM,
  4176           DFHEIV99,
  4177           DFHEIV99
  4178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4179         MOVE SC-CLAIMS-DISPLAY (6)    TO  PI-DISPLAY-CAP
  4180         MOVE SC-CLAIMS-UPDATE  (6)    TO  PI-MODIFY-CAP.
  4181
  4182     IF EIBTRNID IS EQUAL TO WS-TRANS-ID
  4183         GO TO 0200-RECEIVE.
  4184
  4185 0100-FIRST-TIME-IN.
  4186
  4187     MOVE LOW-VALUES                 TO  EL151AO
  4188     MOVE -1                         TO  MLINE1L
  4189     MOVE 1                          TO  EMI-NUMBER-OF-LINES.
  4190
  4191     MOVE SPACE                      TO  DC-ERROR-CODE
  4192                                         WS-CLAIM-SEQ-SW
  4193                                         MERMSG2O.
  4194
  4195     MOVE '153A'                     TO  PI-CURRENT-SCREEN-NO.
  4196
  4197     MOVE 0                          TO  PI-PROOF-DATE.
  4198     PERFORM 3550-FIND-LETTER-TRLR THRU 3550-EXIT.
  4199
  4200     GO TO 8100-SEND-INITIAL-MAP.
  4201
  4202 0200-RECEIVE.
  4203
  4204     MOVE LOW-VALUES              TO  EL151AI.
  4205
  4206     IF (EIBAID IS EQUAL TO DFHPA1 OR DFHPA2 OR DFHPA3)
  4207         MOVE ER-0008             TO  EMI-ERROR
  4208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4209         MOVE -1                  TO  MPFNUMBL
  4210         GO TO 8200-SEND-DATAONLY.
  4211
  4212
  4213* EXEC CICS RECEIVE
  4214*        MAP      (MAP-NAME)
  4215*        MAPSET   (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  80
* EL151.cbl
  4216*        INTO     (EL151AI)
  4217*    END-EXEC.
  4218     MOVE LENGTH OF
  4219      EL151AI
  4220       TO DFHEIV11
  4221*    MOVE '8"T I  L              ''   #00004187' TO DFHEIV0
  4222     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4223     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4224     MOVE X'2020233030303034313837' TO DFHEIV0(25:11)
  4225     CALL 'kxdfhei1' USING DFHEIV0,
  4226           MAP-NAME,
  4227           EL151AI,
  4228           DFHEIV11,
  4229           MAPSET-NAME,
  4230           DFHEIV99,
  4231           DFHEIV99
  4232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4233
  4234
  4235     IF MPFNUMBL IS EQUAL TO +0
  4236         GO TO 0300-CHECK-PFKEYS.
  4237
  4238     IF EIBAID IS NOT EQUAL TO DFHENTER
  4239         MOVE ER-0004             TO  EMI-ERROR
  4240         GO TO 0320-INPUT-ERROR.
  4241
  4242     IF (MPFNUMBI NUMERIC) AND (MPFNUMBI GREATER 0 AND LESS 25)
  4243         MOVE PF-VALUES (MPFNUMBI)    TO  EIBAID
  4244     ELSE
  4245         MOVE ER-0029                 TO  EMI-ERROR
  4246         GO TO 0320-INPUT-ERROR.
  4247
  4248 0300-CHECK-PFKEYS.
  4249
  4250     IF EIBAID IS EQUAL TO DFHPF12
  4251        MOVE  'EL010'            TO  THIS-PGM
  4252        GO TO 9300-XCTL.
  4253
  4254     IF EIBAID IS EQUAL TO DFHPF23
  4255        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4256        MOVE 'EL005'             TO  THIS-PGM
  4257        GO TO 9300-XCTL.
  4258
  4259     IF EIBAID IS EQUAL TO DFHPF24
  4260        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4261        MOVE  'EL126'            TO  THIS-PGM
  4262        GO TO 9300-XCTL.
  4263
  4264     IF EIBAID IS EQUAL TO DFHENTER
  4265        GO TO 0330-EDIT-DATA.
  4266
  4267     MOVE ER-0029                TO  EMI-ERROR.
  4268
  4269 0320-INPUT-ERROR.
  4270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4271
  4272     MOVE -1                     TO  MPFNUMBL.
  4273     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  81
* EL151.cbl
  4274
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  82
* EL151.cbl
  4276 0330-EDIT-DATA.
  4277     IF NOT MODIFY-CAP
  4278        MOVE 'UPDATE'             TO  SM-READ
  4279        PERFORM 9995-SECURITY-VIOLATION
  4280        MOVE ER-0070              TO  EMI-ERROR
  4281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4282        GO TO 8100-SEND-INITIAL-MAP.
  4283
  4284     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CID' OR 'DCC'
  4285                     OR 'AHL' or 'VPP'
  4286         IF MLINE1I = (LOW-VALUES OR SPACES) AND
  4287            MLINE2I = (LOW-VALUES OR SPACES) AND
  4288            MDENCDI = (LOW-VALUES OR SPACES)
  4289             MOVE ER-0483        TO  EMI-ERROR
  4290             MOVE -1             TO  MLINE1L
  4291             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4292             GO TO 8100-SEND-INITIAL-MAP
  4293         ELSE
  4294             NEXT SENTENCE
  4295     ELSE
  4296         IF MLINE1I  = (LOW-VALUES OR SPACES)  AND
  4297            MLINE2I  = (LOW-VALUES OR SPACES)
  4298             MOVE ER-0483        TO  EMI-ERROR
  4299             MOVE -1             TO  MLINE1L
  4300             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4301             GO TO 8100-SEND-INITIAL-MAP.
  4302
  4303     IF MPRFDTL > 0
  4304         MOVE MPRFDTI TO DEEDIT-FIELD
  4305         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4306         MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4307         MOVE PI-PROOF-DATE    TO MPRFDTO
  4308         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4309     END-IF.
  4310
  4311     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES
  4312*     IF  MPRFDTI  = LOW-VALUES OR SPACES
  4313         MOVE ER-0872             TO EMI-ERROR
  4314         MOVE -1                  TO MPRFDTL
  4315         MOVE AL-UABON            TO MPRFDTA
  4316         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4317         GO TO 8200-SEND-DATAONLY
  4318     END-IF.
  4319
  4320     IF  PI-PROOF-DATE > 0
  4321         MOVE PI-PROOF-DATE       TO DEEDIT-FIELD
  4322         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4323         MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  4324         MOVE '4'                 TO DC-OPTION-CODE
  4325         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
  4326         IF DATE-CONVERSION-ERROR
  4327            MOVE ER-0021          TO EMI-ERROR
  4328            MOVE -1               TO MPRFDTL
  4329            MOVE AL-UABON         TO MPRFDTA
  4330            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4331            GO TO 8200-SEND-DATAONLY
  4332         ELSE
  4333            IF DC-BIN-DATE-1 > SAVE-BIN-DATE
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  83
* EL151.cbl
  4334                MOVE ER-0873      TO EMI-ERROR
  4335                MOVE -1           TO MPRFDTL
  4336                MOVE AL-UABON     TO MPRFDTA
  4337                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4338                GO TO 8200-SEND-DATAONLY
  4339            ELSE
  4340                MOVE DC-BIN-DATE-1    TO WS-PRF-DT
  4341                MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4342                MOVE PI-PROOF-DATE    TO MPRFDTO
  4343                INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4344            END-IF
  4345         END-IF
  4346     END-IF.
  4347
  4348     MOVE LOW-VALUES             TO  WS-TRAILER-KEY.
  4349     MOVE PI-COMPANY-CD          TO  WS-KEY-COMPANY-CD.
  4350     MOVE PI-CARRIER             TO  WS-KEY-CARRIER.
  4351     MOVE PI-CLAIM-NO            TO  WS-KEY-CLAIM-NO.
  4352     MOVE PI-CERT-NO             TO  WS-KEY-CERT-NO.
  4353
  4354     PERFORM 7000-READ-ELMSTR-UPDATE THRU 7000-EXIT.
  4355
  4356     IF CL-LAST-TRL-AVAIL
  4357         MOVE ER-0137            TO  EMI-ERROR
  4358         MOVE -1                 TO  MLINE1L
  4359         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4360         GO TO 8200-SEND-DATAONLY.
  4361     if ws-prf-dt < cl-incurred-dt
  4362        MOVE ER-0873             TO EMI-ERROR
  4363        MOVE -1                  TO MPRFDTL
  4364        MOVE AL-UABON            TO MPRFDTA
  4365        PERFORM 9900-ERROR-FORMAT
  4366                                 THRU 9900-EXIT
  4367        GO TO 8200-SEND-DATAONLY
  4368     end-if
  4369     MOVE CL-TRAILER-SEQ-CNT     TO  WS-ORIG-SEQ-CNT.
  4370     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  4371     MOVE CL-TRAILER-SEQ-CNT     TO  WS-SEQ-NO-SAVED.
  4372     MOVE 'C'                    TO  CL-CLAIM-STATUS.
  4373     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  4374     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  4375     MOVE '2'                    TO  CL-LAST-CLOSE-REASON.
  4376     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  4377     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT
  4378                                     CL-LAST-CLOSE-DT.
  4379
  4380     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4381         IF MDENCDL IS GREATER THAN +0
  4382             MOVE MDENCDI        TO  CL-FILE-LOCATION.
  4383
  4384*************************************************************
  4385*****         START BUILDING ACTIVITY RECORD HERE          **
  4386*************************************************************
  4387     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
  4388         PERFORM 2300-GETMAIN-DLYACTV THRU
  4389                 2300-EXIT
  4390         PERFORM 3500-BUILD-ACTIVITY-RECORD THRU
  4391                 3500-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  84
* EL151.cbl
  4392         PERFORM 2350-WRITE-DLYACTV THRU
  4393                 2350-EXIT
  4394     END-IF.
  4395
  4396*************************************************************
  4397*****            END OF BUILDING ACTIVITY RECORD           **
  4398*************************************************************
  4399
  4400     PERFORM 7120-READ-ELTRLR-UPDATE THRU 7120-EXIT.
  4401
  4402     MOVE +1                     TO  MISC-SUB.
  4403     MOVE SPACES                 TO  WS-OC-LOAD-SW.
  4404     PERFORM 1000-SET-OPEN-CLOSE-HIST THRU 1000-EXIT.
  4405
  4406     MOVE +01                    TO  TR-SUB
  4407                                     TR-SUB-2.
  4408     PERFORM 1010-UPDATE-TR1-OC   THRU 1010-EXIT
  4409             UNTIL  OC-HISTORY-LOADED.
  4410
  4411     MOVE PI-PROCESSOR-ID        TO AT-RESERVES-LAST-UPDATED-BY
  4412     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  4413     MOVE SAVE-BIN-DATE          TO AT-RESERVES-LAST-MAINT-DT.
  4414
  4415     IF PI-COMPANY-ID = 'DMD'
  4416         PERFORM 2000-CREATE-DMD-DMO  THRU  2000-EXIT.
  4417
  4418     PERFORM 7130-REWRITE-ELTRLR THRU 7130-EXIT.
  4419
  4420     PERFORM 7100-GETMAIN-ELTRLR  THRU 7100-EXIT.
  4421     PERFORM 1050-BUILD-DENIAL-TRLR THRU 1090-EXIT.
  4422
  4423     PERFORM 7110-WRITE-ELTRLR    THRU 7110-EXIT.
  4424
  4425     PERFORM 6100-CHECK-AUTO-ACTIVITY THRU 6100-EXIT.
  4426
  4427     IF WS-REC-FOUND-SW IS EQUAL TO 'N'
  4428         GO TO 0340-FINISH-EDIT-DATA.
  4429
  4430     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  4431         GO TO 0340-FINISH-EDIT-DATA.
  4432
  4433     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  4434        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  4435         GO TO 0340-FINISH-EDIT-DATA.
  4436
  4437     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4438         PERFORM 6000-RESET-AUTO-ACTIVITY THRU 6000-EXIT
  4439         IF WS-UPDATE-SW IS EQUAL TO 'Y'
  4440             MOVE LOW-VALUES         TO  CL-NEXT-RESEND-DT
  4441                                         CL-NEXT-FOLLOWUP-DT.
  4442
  4443     IF WS-RESET-SW IS EQUAL TO 'Y'
  4444         MOVE ZEROS                  TO  CL-ACTIVITY-CODE
  4445         MOVE SAVE-BIN-DATE          TO  CL-ACTIVITY-MAINT-DT
  4446         MOVE 'DENY'                 TO  CL-ACTIVITY-MAINT-TYPE.
  4447
  4448 0340-FINISH-EDIT-DATA.
  4449
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  85
* EL151.cbl
  4450     PERFORM 7010-REWRITE-ELMSTR  THRU 7010-EXIT.
  4451
  4452     MOVE ER-0000                TO EMI-ERROR.
  4453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4454     MOVE -1                     TO MLINE1L.
  4455*    MOVE LOW-VALUES             TO MLINE1O
  4456*                                   MLINE2O
  4457*                                   MDENCDO.
  4458     GO TO 8200-SEND-DATAONLY.
  4459
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  86
* EL151.cbl
  4461 1000-SET-OPEN-CLOSE-HIST.
  4462     PERFORM 1000-BUMP-OPEN-CLOSE-HIST UNTIL
  4463        (MISC-SUB GREATER THAN +6 OR
  4464        AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES).
  4465
  4466     IF MISC-SUB GREATER THAN +1
  4467        SUBTRACT +1 FROM MISC-SUB
  4468        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = 'C'
  4469           MOVE SAVE-BIN-DATE   TO AT-OPEN-CLOSE-DATE (MISC-SUB)
  4470           MOVE 'C'             TO AT-OPEN-CLOSE-TYPE (MISC-SUB)
  4471           MOVE 'DENIED'        TO AT-OPEN-CLOSE-REASON (MISC-SUB)
  4472           MOVE 'X'             TO WS-OC-LOAD-SW.
  4473
  4474     GO TO 1000-EXIT.
  4475
  4476 1000-BUMP-OPEN-CLOSE-HIST.
  4477     ADD +1 TO MISC-SUB.
  4478
  4479 1000-EXIT.
  4480     EXIT.
  4481
  4482 1010-UPDATE-TR1-OC.
  4483     IF  AT-OPEN-CLOSE-DATE (TR-SUB) = (LOW-VALUE OR SPACES)
  4484         MOVE SAVE-BIN-DATE      TO AT-OPEN-CLOSE-DATE (TR-SUB)
  4485         MOVE 'C'                TO AT-OPEN-CLOSE-TYPE (TR-SUB)
  4486         MOVE 'DENIED'           TO AT-OPEN-CLOSE-REASON (TR-SUB)
  4487         MOVE 'X'                TO WS-OC-LOAD-SW
  4488         GO TO 1010-EXIT.
  4489
  4490     ADD 1  TO TR-SUB.
  4491     IF  TR-SUB  GREATER THAN 6
  4492         MOVE +01                TO TR-SUB
  4493         MOVE +02                TO TR-SUB-2
  4494         PERFORM 1020-BUMP    THRU 1020-EXIT
  4495          UNTIL TR-SUB-2 GREATER THAN 6
  4496         MOVE SPACES             TO AT-OPEN-CLOSE-DATE (TR-SUB).
  4497
  4498 1010-EXIT.
  4499      EXIT.
  4500
  4501 1020-BUMP.
  4502     MOVE AT-OPEN-CLOSE-DATE (TR-SUB-2) TO
  4503                           AT-OPEN-CLOSE-DATE (TR-SUB).
  4504     MOVE AT-OPEN-CLOSE-TYPE (TR-SUB-2) TO
  4505                           AT-OPEN-CLOSE-TYPE (TR-SUB).
  4506     MOVE AT-OPEN-CLOSE-REASON (TR-SUB-2) TO
  4507                           AT-OPEN-CLOSE-REASON (TR-SUB).
  4508
  4509     ADD +1  TO TR-SUB
  4510                TR-SUB-2.
  4511
  4512 1020-EXIT.
  4513     EXIT.
  4514
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  87
* EL151.cbl
  4516 1050-BUILD-DENIAL-TRLR.
  4517
  4518     MOVE 'AT'                   TO AT-RECORD-ID.
  4519     MOVE '8'                    TO AT-TRAILER-TYPE.
  4520
  4521*DLO023
  4522     IF PI-COMPANY-ID NOT = 'DMD'
  4523         GO TO 1055-EDIT-CID-CODE
  4524     END-IF
  4525
  4526     IF MDENCDL GREATER +0
  4527         MOVE 'CL'               TO DL23-SYSTEM-ID
  4528         MOVE 'DN'               TO DL23-RECORD-TYPE
  4529         MOVE MDENCDI            TO DL23-RECORD-KEY
  4530
  4531* EXEC CICS LINK
  4532*            PROGRAM    ('DLO023')
  4533*            COMMAREA   (WS-DLO-CODES-TABLE)
  4534*            LENGTH     (DL23-COMM-LENGTH)
  4535*        END-EXEC
  4536     MOVE 'DLO023' TO DFHEIV1
  4537*    MOVE '."C                   (   #00004488' TO DFHEIV0
  4538     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4540     MOVE X'2020233030303034343838' TO DFHEIV0(25:11)
  4541     CALL 'kxdfhei1' USING DFHEIV0,
  4542           DFHEIV1,
  4543           WS-DLO-CODES-TABLE,
  4544           DL23-COMM-LENGTH,
  4545           DFHEIV99,
  4546           DFHEIV99,
  4547           DFHEIV99,
  4548           DFHEIV99
  4549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4550         IF DL23-RETURN-CODE = 'OK'
  4551             MOVE AL-UANON       TO MDENCDA
  4552          ELSE
  4553             MOVE AL-UABON       TO MDENCDA
  4554             MOVE -1             TO MDENCDL
  4555             MOVE ER-0884        TO EMI-ERROR
  4556             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4557             PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4558             PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4559             GO TO 8200-SEND-DATAONLY.
  4560
  4561     IF MLINE1I = LOW-VALUES OR SPACES
  4562         MOVE SPACES         TO AT-DENIAL-INFO-1
  4563      ELSE
  4564         MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4565
  4566     GO TO 1070-CONTINUE.
  4567
  4568 1055-EDIT-CID-CODE.
  4569     IF MDENCDL > +0
  4570        MOVE LOW-VALUES          TO WS-ELDENY-KEY
  4571        MOVE PI-COMPANY-CD       TO ELDENY-COMPANY-CD
  4572        MOVE MDENCDI             TO ELDENY-DENIAL-CODE
  4573
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  88
* EL151.cbl
  4574* EXEC CICS READ
  4575*          DATASET('ELDENY')
  4576*          SET    (ADDRESS OF DENIAL-CODES)
  4577*          RIDFLD (WS-ELDENY-KEY)
  4578*          RESP   (WS-RESPONSE)
  4579*       END-EXEC
  4580     MOVE 'ELDENY' TO DFHEIV1
  4581*    MOVE '&"S        E          (  N#00004516' TO DFHEIV0
  4582     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4583     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4584     MOVE X'204E233030303034353136' TO DFHEIV0(25:11)
  4585     CALL 'kxdfhei1' USING DFHEIV0,
  4586           DFHEIV1,
  4587           DFHEIV20,
  4588           DFHEIV99,
  4589           WS-ELDENY-KEY,
  4590           DFHEIV99,
  4591           DFHEIV99,
  4592           DFHEIV99
  4593     SET ADDRESS OF DENIAL-CODES TO
  4594         DFHEIV20
  4595     MOVE EIBRESP  TO WS-RESPONSE
  4596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4597        IF RESP-NORMAL
  4598           IF MLINE1L > +0
  4599              STRING DN-DESCRIPTION ' ' MLINE1I
  4600                 DELIMITED BY '  ' INTO AT-DENIAL-INFO-1
  4601              END-STRING
  4602           ELSE
  4603              MOVE DN-DESCRIPTION
  4604                                 TO AT-DENIAL-INFO-1
  4605           END-IF
  4606           MOVE DN-RECORD-TYPE   TO CL-DENIAL-TYPE
  4607           MOVE AT-DENIAL-INFO-1 TO MLINE1O
  4608           MOVE +1               TO MLINE1L
  4609           MOVE AL-UANON         TO MLINE1A
  4610           MOVE DN-RECORD-TYPE
  4611                                 TO CL-DENIAL-TYPE
  4612        ELSE
  4613           MOVE AL-UABON         TO MDENCDA
  4614           MOVE -1               TO MDENCDL
  4615           MOVE ER-0884          TO EMI-ERROR
  4616           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4617           PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4618           PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4619           GO TO 8200-SEND-DATAONLY
  4620        END-IF
  4621     ELSE
  4622        MOVE AL-UABON            TO MDENCDA
  4623        MOVE -1                  TO MDENCDL
  4624        MOVE ER-0884             TO EMI-ERROR
  4625        PERFORM 9900-ERROR-FORMAT
  4626                                 THRU 9900-EXIT
  4627        PERFORM 2250-UNLOCK-CLAIM-MSTR
  4628                                 THRU 2250-EXIT
  4629        PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4630        GO TO 8200-SEND-DATAONLY
  4631     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  89
* EL151.cbl
  4632     GO TO 1070-CONTINUE
  4633     .
  4634 1060-CONTINUE.
  4635     IF MDENCDL IS GREATER THAN +0
  4636         SET DEN-INDEX TO +1
  4637         SEARCH DEN-TABLE VARYING DEN-INDEX
  4638             AT END
  4639                 MOVE MLINE1I                TO  AT-DENIAL-INFO-1
  4640         WHEN MDENCDI IS EQUAL TO DENIAL-CODE (DEN-INDEX)
  4641             MOVE DENIAL-DESC (DEN-INDEX)    TO  AT-DENIAL-INFO-1
  4642                                                 MLINE1O
  4643     ELSE
  4644         IF MLINE1I = LOW-VALUES OR SPACES
  4645             MOVE SPACES         TO AT-DENIAL-INFO-1
  4646         ELSE
  4647             MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4648
  4649 1070-CONTINUE.
  4650     IF  MLINE2I  = LOW-VALUES OR SPACES
  4651         MOVE  SPACES            TO AT-DENIAL-INFO-2
  4652     ELSE
  4653         MOVE MLINE2I            TO AT-DENIAL-INFO-2.
  4654
  4655     IF (AT-DENIAL-INFO-1 IS EQUAL TO SPACES OR LOW-VALUES)
  4656         MOVE AT-DENIAL-INFO-2   TO AT-DENIAL-INFO-1
  4657         MOVE SPACES             TO AT-DENIAL-INFO-2.
  4658
  4659     MOVE WS-PRF-DT              TO AT-DENIAL-PROOF-DT.
  4660     MOVE WS-SEQ-NO-SAVED        TO WS-KEY-SEQUENCE-NO.
  4661
  4662     MOVE WS-TRAILER-KEY         TO AT-CONTROL-PRIMARY.
  4663     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  4664                                    AT-DENIAL-LAST-UPDATED-BY.
  4665     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  4666     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  4667                                    AT-DENIAL-DT
  4668                                    AT-DENIAL-LAST-MAINT-DT.
  4669     MOVE MDENCDI                TO AT-DENIAL-REASON-CODE.
  4670     MOVE LOW-VALUES             TO AT-RETRACTION-DT.
  4671
  4672 1090-EXIT.
  4673      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  90
* EL151.cbl
  4675******************************************************************
  4676*    DMD ONLY  -  CREATE THE DIRECT MARKETING OUTPUT FILE
  4677******************************************************************
  4678 2000-CREATE-DMD-DMO.
  4679
  4680     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
  4681     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
  4682     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
  4683
  4684
  4685* EXEC CICS HANDLE CONDITION
  4686*         NOTFND   (2000-NOTE-NOT-FOUND)
  4687*         END-EXEC.
  4688*    MOVE '"$I                   ! # #00004609' TO DFHEIV0
  4689     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4691     MOVE X'2320233030303034363039' TO DFHEIV0(25:11)
  4692     CALL 'kxdfhei1' USING DFHEIV0
  4693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4694
  4695
  4696
  4697* EXEC CICS READ
  4698*         DATASET('ERNOTE')
  4699*         SET    (ADDRESS OF CERTIFICATE-NOTE)
  4700*         RIDFLD (W-NOTE-KEY)
  4701*         END-EXEC.
  4702     MOVE 'ERNOTE' TO DFHEIV1
  4703*    MOVE '&"S        E          (   #00004613' TO DFHEIV0
  4704     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4705     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4706     MOVE X'2020233030303034363133' TO DFHEIV0(25:11)
  4707     CALL 'kxdfhei1' USING DFHEIV0,
  4708           DFHEIV1,
  4709           DFHEIV20,
  4710           DFHEIV99,
  4711           W-NOTE-KEY,
  4712           DFHEIV99,
  4713           DFHEIV99,
  4714           DFHEIV99
  4715     SET ADDRESS OF CERTIFICATE-NOTE TO
  4716         DFHEIV20
  4717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4718
  4719
  4720     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
  4721     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
  4722     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
  4723
  4724     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
  4725         MOVE 'CC'               TO DCT-PRODUCT-CODE
  4726     ELSE
  4727         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
  4728
  4729     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
  4730     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
  4731
  4732
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  91
* EL151.cbl
  4733* EXEC CICS LINK
  4734*        PROGRAM    ('DLO006')
  4735*        COMMAREA   (DCT-COMMUNICATION-AREA)
  4736*        LENGTH     (WS-DCT-LENGTH)
  4737*    END-EXEC.
  4738     MOVE 'DLO006' TO DFHEIV1
  4739*    MOVE '."C                   (   #00004631' TO DFHEIV0
  4740     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4742     MOVE X'2020233030303034363331' TO DFHEIV0(25:11)
  4743     CALL 'kxdfhei1' USING DFHEIV0,
  4744           DFHEIV1,
  4745           DCT-COMMUNICATION-AREA,
  4746           WS-DCT-LENGTH,
  4747           DFHEIV99,
  4748           DFHEIV99,
  4749           DFHEIV99,
  4750           DFHEIV99
  4751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4752
  4753
  4754     IF  DCT-RETURN-CODE = 'OK'
  4755         GO TO 2000-CONT.
  4756
  4757     IF  DCT-RETURN-CODE = '01' OR '02'
  4758         GO TO 2000-EXIT.
  4759
  4760     IF  DCT-RETURN-CODE = '03'
  4761         MOVE ER-0951            TO EMI-ERROR
  4762         MOVE -1                 TO MLINE1L
  4763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4764         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4765             THRU 2250-EXIT
  4766         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4767         GO TO 8200-SEND-DATAONLY.
  4768
  4769     IF  DCT-RETURN-CODE = '06'
  4770         MOVE ER-0921            TO EMI-ERROR
  4771         MOVE -1                 TO MLINE1L
  4772         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4773         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4774             THRU 2250-EXIT
  4775         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4776         GO TO 8200-SEND-DATAONLY.
  4777
  4778     IF  DCT-RETURN-CODE = '07'
  4779         MOVE ER-0919            TO EMI-ERROR
  4780         MOVE -1                 TO MLINE1L
  4781         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4782         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4783             THRU 2250-EXIT
  4784         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4785         GO TO 8200-SEND-DATAONLY.
  4786
  4787     IF  DCT-RETURN-CODE = '04'
  4788         MOVE ER-0946            TO EMI-ERROR
  4789         MOVE -1                 TO MLINE1L
  4790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  92
* EL151.cbl
  4791         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4792             THRU 2250-EXIT
  4793         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4794         GO TO 8200-SEND-DATAONLY.
  4795
  4796     IF  DCT-RETURN-CODE = '05'
  4797         MOVE ER-0947            TO EMI-ERROR
  4798         MOVE -1                 TO MLINE1L
  4799         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4800         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4801             THRU 2250-EXIT
  4802         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4803         GO TO 8200-SEND-DATAONLY.
  4804
  4805     IF  DCT-RETURN-CODE = '08'
  4806         MOVE ER-0948            TO EMI-ERROR
  4807         MOVE -1                 TO MLINE1L
  4808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4809         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4810             THRU 2250-EXIT
  4811         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4812         GO TO 8200-SEND-DATAONLY.
  4813
  4814     IF  DCT-RETURN-CODE = 'N1'
  4815         MOVE ER-0950            TO EMI-ERROR
  4816         MOVE -1                 TO MLINE1L
  4817         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4818         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4819             THRU 2250-EXIT
  4820         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4821         GO TO 8200-SEND-DATAONLY.
  4822
  4823     IF DCT-RETURN-CODE = 'E1'
  4824         MOVE ER-0974            TO EMI-ERROR
  4825         MOVE -1                 TO MLINE1L
  4826         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4827         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4828             THRU 2250-EXIT
  4829         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4830         GO TO 8200-SEND-DATAONLY.
  4831
  4832     IF DCT-RETURN-CODE = 'E2'
  4833         MOVE ER-0975            TO EMI-ERROR
  4834         MOVE -1                 TO MLINE1L
  4835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4836         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4837             THRU 2250-EXIT
  4838         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4839         GO TO 8200-SEND-DATAONLY.
  4840
  4841     IF DCT-RETURN-CODE NOT = 'OK'
  4842         MOVE ER-0949            TO EMI-ERROR
  4843         MOVE -1                 TO MLINE1L
  4844         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4845         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4846             THRU 2250-EXIT
  4847         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4848         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  93
* EL151.cbl
  4849
  4850 2000-CONT.
  4851
  4852     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
  4853     MOVE 'CS'                   TO DM-RECORD-TYPE.
  4854     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
  4855     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
  4856     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
  4857     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
  4858     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
  4859
  4860     MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1.
  4861     MOVE ' '                    TO  DC-OPTION-CODE.
  4862     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4863     MOVE DC-GREG-DATE-1-YMD     TO  DMD-YYMMDD.
  4864
  4865     IF DMD-YY GREATER THAN 70
  4866         MOVE '19'               TO  DMD-DECADE
  4867     ELSE
  4868         MOVE '20'               TO  DMD-DECADE.
  4869
  4870     MOVE DMD-DATE-YYYYMMDD      TO  DM-STATUS-DATE.
  4871     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
  4872     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
  4873     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
  4874     PERFORM 2100-FORMAT-LAST-NAME-1ST THRU 2100-EXIT.
  4875     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
  4876
  4877     MOVE 'D'                    TO DM-STAT-CHANGE-TYPE.
  4878     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
  4879     MOVE '3'                    TO DM-CLAIM-STATUS.
  4880
  4881
  4882* EXEC CICS LINK
  4883*        PROGRAM    ('DLO025')
  4884*        COMMAREA   (DMO-COMMUNICATION-AREA)
  4885*        LENGTH     (WS-DMO-LENGTH)
  4886*    END-EXEC.
  4887     MOVE 'DLO025' TO DFHEIV1
  4888*    MOVE '."C                   (   #00004764' TO DFHEIV0
  4889     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4891     MOVE X'2020233030303034373634' TO DFHEIV0(25:11)
  4892     CALL 'kxdfhei1' USING DFHEIV0,
  4893           DFHEIV1,
  4894           DMO-COMMUNICATION-AREA,
  4895           WS-DMO-LENGTH,
  4896           DFHEIV99,
  4897           DFHEIV99,
  4898           DFHEIV99,
  4899           DFHEIV99
  4900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4901
  4902
  4903     IF  DM-RETURN-CODE = 'OK'
  4904         GO TO 2000-EXIT.
  4905
  4906     IF  DM-RETURN-CODE = '01'
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  94
* EL151.cbl
  4907         MOVE ER-8051            TO EMI-ERROR
  4908         MOVE -1                 TO MLINE1L
  4909         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4910         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4911             THRU 2250-EXIT
  4912         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4913         GO TO 8200-SEND-DATAONLY.
  4914
  4915     IF  DM-RETURN-CODE = '02'
  4916         MOVE ER-8052            TO EMI-ERROR
  4917         MOVE -1                 TO MLINE1L
  4918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4919         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4920             THRU 2250-EXIT
  4921         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4922         GO TO 8200-SEND-DATAONLY.
  4923
  4924     IF  DM-RETURN-CODE = '03'
  4925         MOVE ER-8053            TO EMI-ERROR
  4926         MOVE -1                 TO MLINE1L
  4927         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4928         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4929             THRU 2250-EXIT
  4930         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4931         GO TO 8200-SEND-DATAONLY.
  4932
  4933     IF  DM-RETURN-CODE = '04'
  4934         MOVE ER-8054            TO EMI-ERROR
  4935         MOVE -1                 TO MLINE1L
  4936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4937         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4938             THRU 2250-EXIT
  4939         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4940         GO TO 8200-SEND-DATAONLY.
  4941
  4942     IF  DM-RETURN-CODE = '05'
  4943         MOVE ER-8055            TO EMI-ERROR
  4944         MOVE -1                 TO MLINE1L
  4945         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4946         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4947             THRU 2250-EXIT
  4948         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4949         GO TO 8200-SEND-DATAONLY.
  4950
  4951     IF  DM-RETURN-CODE = '06'
  4952         MOVE ER-8056            TO EMI-ERROR
  4953         MOVE -1                 TO MLINE1L
  4954         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4955         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4956             THRU 2250-EXIT
  4957         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4958         GO TO 8200-SEND-DATAONLY.
  4959
  4960     IF  DM-RETURN-CODE = '07'
  4961         MOVE ER-8057            TO EMI-ERROR
  4962         MOVE -1                 TO MLINE1L
  4963         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4964         PERFORM 2250-UNLOCK-CLAIM-MSTR
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  95
* EL151.cbl
  4965             THRU 2250-EXIT
  4966         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4967         GO TO 8200-SEND-DATAONLY.
  4968
  4969     IF  DM-RETURN-CODE = '08'
  4970         MOVE ER-8058            TO EMI-ERROR
  4971         MOVE -1                 TO MLINE1L
  4972         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4973         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4974             THRU 2250-EXIT
  4975         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4976         GO TO 8200-SEND-DATAONLY.
  4977
  4978     IF  DM-RETURN-CODE = '09'
  4979         MOVE ER-8059            TO EMI-ERROR
  4980         MOVE -1                 TO MLINE1L
  4981         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4982         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4983             THRU 2250-EXIT
  4984         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4985         GO TO 8200-SEND-DATAONLY.
  4986
  4987     IF  DM-RETURN-CODE = '10'
  4988         MOVE ER-8060            TO EMI-ERROR
  4989         MOVE -1                 TO MLINE1L
  4990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4991         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4992             THRU 2250-EXIT
  4993         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4994         GO TO 8200-SEND-DATAONLY.
  4995
  4996     IF  DM-RETURN-CODE = '11'
  4997         MOVE ER-8061            TO EMI-ERROR
  4998         MOVE -1                 TO MLINE1L
  4999         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5000         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5001             THRU 2250-EXIT
  5002         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5003         GO TO 8200-SEND-DATAONLY.
  5004
  5005     IF  DM-RETURN-CODE = '12'
  5006         MOVE ER-8062            TO EMI-ERROR
  5007         MOVE -1                 TO MLINE1L
  5008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5009         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5010             THRU 2250-EXIT
  5011         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5012         GO TO 8200-SEND-DATAONLY.
  5013
  5014     IF  DM-RETURN-CODE = '13'
  5015         MOVE ER-8063            TO EMI-ERROR
  5016         MOVE -1                 TO MLINE1L
  5017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5018         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5019             THRU 2250-EXIT
  5020         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5021         GO TO 8200-SEND-DATAONLY.
  5022
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  96
* EL151.cbl
  5023     IF  DM-RETURN-CODE = '14'
  5024         MOVE ER-8064            TO EMI-ERROR
  5025         MOVE -1                 TO MLINE1L
  5026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5027         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5028             THRU 2250-EXIT
  5029         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5030         GO TO 8200-SEND-DATAONLY.
  5031
  5032     IF  DM-RETURN-CODE = '15'
  5033         MOVE ER-8065            TO EMI-ERROR
  5034         MOVE -1                 TO MLINE1L
  5035         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5036         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5037             THRU 2250-EXIT
  5038         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5039         GO TO 8200-SEND-DATAONLY.
  5040
  5041     IF DM-RETURN-CODE = '16'
  5042         MOVE ER-8154            TO EMI-ERROR
  5043         MOVE -1                 TO MLINE1L
  5044         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  5045         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  5046         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  5047         GO TO 8200-SEND-DATAONLY.
  5048
  5049     IF DM-RETURN-CODE = '17'
  5050         MOVE ER-8155            TO EMI-ERROR
  5051         MOVE -1                 TO MLINE1L
  5052         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  5053         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  5054         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  5055         GO TO 8200-SEND-DATAONLY.
  5056
  5057     IF DM-RETURN-CODE = 'N1'
  5058         MOVE ER-8152            TO EMI-ERROR
  5059         MOVE -1                 TO MLINE1L
  5060         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5061         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5062             THRU 2250-EXIT
  5063         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5064         GO TO 8200-SEND-DATAONLY.
  5065
  5066     IF DM-RETURN-CODE = 'E1'
  5067         MOVE ER-8153            TO EMI-ERROR
  5068         MOVE -1                 TO MLINE1L
  5069         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5070         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5071             THRU 2250-EXIT
  5072         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5073         GO TO 8200-SEND-DATAONLY.
  5074
  5075     MOVE ER-8066                TO EMI-ERROR.
  5076     MOVE -1                     TO MLINE1L.
  5077     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5078     PERFORM 2250-UNLOCK-CLAIM-MSTR
  5079         THRU 2250-EXIT.
  5080     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  97
* EL151.cbl
  5081     GO TO 8200-SEND-DATAONLY.
  5082
  5083 2000-NOTE-NOT-FOUND.
  5084
  5085     MOVE ER-0954                TO EMI-ERROR.
  5086     MOVE -1                     TO MLINE1L.
  5087     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5088     PERFORM 2250-UNLOCK-CLAIM-MSTR
  5089         THRU 2250-EXIT.
  5090     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
  5091     GO TO 8200-SEND-DATAONLY.
  5092
  5093 2000-EXIT.
  5094     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  98
* EL151.cbl
  5096
  5097 2100-FORMAT-LAST-NAME-1ST.
  5098*****************************************************************
  5099*             M O V E   N A M E   R O U T I N E                 *
  5100*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
  5101*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
  5102*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
  5103*                  FIELD                   VALUE                *
  5104*           W-NAME-LAST    (CL15)      SMITH                    *
  5105*           W-NAME-FIRST   (CL15)      JOHN                     *
  5106*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
  5107*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
  5108*     CONTAIN                                                   *
  5109*                SMITH, JOHN ALLEN                              *
  5110*     OR                                                        *
  5111*                SMITH, JOHN A.                                 *
  5112*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
  5113*     COPYBOOK, ELCNWA.                                         *
  5114*****************************************************************.
  5115
  5116     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  5117     MOVE ZERO                   TO  WS-NAME-SW.
  5118     SET NWA-INDEX               TO +1.
  5119
  5120     IF  W-NAME-LAST EQUAL SPACES
  5121             AND
  5122         W-NAME-MIDDLE EQUAL SPACES
  5123         MOVE +1                 TO WS-NAME-SW.
  5124
  5125     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
  5126     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5127
  5128     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
  5129     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5130
  5131     SET NWA-INDEX UP BY +1.
  5132
  5133     IF  W-NAME-MIDDLE NOT EQUAL SPACES
  5134
  5135         IF  W-NAME-MIDDLE-2 EQUAL SPACES
  5136             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
  5137             SET NWA-INDEX UP BY +1
  5138             MOVE '.'            TO WS-NW (NWA-INDEX)
  5139             SET NWA-INDEX UP BY +2
  5140
  5141         ELSE
  5142             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
  5143             PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5144
  5145 2100-EXIT.
  5146     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page  99
* EL151.cbl
  5148 2150-MOVE-NAME.
  5149
  5150     IF  WS-NAME-SW GREATER THAN +1
  5151         GO TO 2150-EXIT.
  5152
  5153     IF  WS-NAME-WORK2 = SPACES
  5154         GO TO 2150-EXIT.
  5155
  5156     SET NWA-INDEX2            TO +1.
  5157     SET NWA-INDEX3            TO +2.
  5158
  5159 2150-MOVE-NAME-CYCLE.
  5160
  5161     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  5162
  5163     IF  NWA-INDEX LESS THAN +30
  5164         SET NWA-INDEX UP BY +1
  5165
  5166     ELSE
  5167         ADD +2                TO  WS-NAME-SW
  5168         GO TO 2150-EXIT.
  5169
  5170     IF  NWA-INDEX2 LESS THAN +20
  5171         SET NWA-INDEX3 UP BY +1
  5172         SET NWA-INDEX2 UP BY +1.
  5173
  5174     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
  5175             AND
  5176         WS-NW2 (NWA-INDEX3) EQUAL SPACES
  5177
  5178         IF  WS-NAME-SW EQUAL ZERO
  5179             MOVE ','            TO  WS-NW (NWA-INDEX)
  5180             SET NWA-INDEX UP BY +2
  5181             MOVE +1             TO  WS-NAME-SW
  5182             GO TO 2150-EXIT
  5183
  5184         ELSE
  5185             GO TO 2150-EXIT.
  5186
  5187     GO TO 2150-MOVE-NAME-CYCLE.
  5188
  5189 2150-EXIT.
  5190     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 100
* EL151.cbl
  5192 2250-UNLOCK-CLAIM-MSTR.
  5193
  5194* EXEC CICS UNLOCK
  5195*          DATASET  (ELMSTR-FILE-ID)
  5196*          END-EXEC.
  5197*    MOVE '&*                    #   #00005060' TO DFHEIV0
  5198     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5199     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5200     MOVE X'2020233030303035303630' TO DFHEIV0(25:11)
  5201     CALL 'kxdfhei1' USING DFHEIV0,
  5202           ELMSTR-FILE-ID,
  5203           DFHEIV99
  5204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5205
  5206 2250-EXIT.
  5207     EXIT.
  5208 2255-UNLOCK-TRLR.
  5209
  5210* EXEC CICS UNLOCK
  5211*          DATASET (ELTRLR-FILE-ID)
  5212*          END-EXEC.
  5213*    MOVE '&*                    #   #00005066' TO DFHEIV0
  5214     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5215     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5216     MOVE X'2020233030303035303636' TO DFHEIV0(25:11)
  5217     CALL 'kxdfhei1' USING DFHEIV0,
  5218           ELTRLR-FILE-ID,
  5219           DFHEIV99
  5220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5221
  5222 2255-EXIT.
  5223     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 101
* EL151.cbl
  5224/
  5225*************************************************************
  5226*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5227*************************************************************
  5228 2300-GETMAIN-DLYACTV.
  5229
  5230* EXEC CICS GETMAIN
  5231*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  5232*        LENGTH (25)
  5233*        INITIMG (WS-BLANK)
  5234*    END-EXEC.
  5235     MOVE 25
  5236       TO DFHEIV11
  5237*    MOVE ',"IL                  $   #00005076' TO DFHEIV0
  5238     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5239     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5240     MOVE X'2020233030303035303736' TO DFHEIV0(25:11)
  5241     CALL 'kxdfhei1' USING DFHEIV0,
  5242           DFHEIV20,
  5243           DFHEIV11,
  5244           WS-BLANK
  5245     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  5246         DFHEIV20
  5247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5248
  5249 2300-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 102
* EL151.cbl
  5250/
  5251*************************************************************
  5252*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5253*************************************************************
  5254 2350-WRITE-DLYACTV.
  5255
  5256* EXEC CICS HANDLE CONDITION
  5257*        NOTOPEN (9986-NOTOPEN-DLYACTV)
  5258*        DUPREC (2350-EXIT)
  5259*    END-EXEC.
  5260*    MOVE '"$J%                  ! $ #00005087' TO DFHEIV0
  5261     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  5262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5263     MOVE X'2420233030303035303837' TO DFHEIV0(25:11)
  5264     CALL 'kxdfhei1' USING DFHEIV0
  5265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5266
  5267
  5268
  5269* EXEC CICS WRITE
  5270*        DATASET ('DLYACTV')
  5271*        RIDFLD (DA-KEY)
  5272*        FROM (DAILY-ACTIVITY-RECORD)
  5273*    END-EXEC.
  5274     MOVE LENGTH OF
  5275      DAILY-ACTIVITY-RECORD
  5276       TO DFHEIV11
  5277     MOVE 'DLYACTV' TO DFHEIV1
  5278*    MOVE '&$ L                  ''   #00005092' TO DFHEIV0
  5279     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5280     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5281     MOVE X'2020233030303035303932' TO DFHEIV0(25:11)
  5282     CALL 'kxdfhei1' USING DFHEIV0,
  5283           DFHEIV1,
  5284           DAILY-ACTIVITY-RECORD,
  5285           DFHEIV11,
  5286           DA-KEY,
  5287           DFHEIV99,
  5288           DFHEIV99
  5289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5290
  5291
  5292 2350-EXIT.
  5293     EXIT.
  5294
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 103
* EL151.cbl
  5295/
  5296*************************************************************
  5297*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5298*************************************************************
  5299
  5300 3500-BUILD-ACTIVITY-RECORD.
  5301
  5302     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  5303     MOVE WS-CLAIM-KEY           TO DA-KEY.
  5304     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
  5305                                 GIVING DA-TRAILER-SEQ-NO.
  5306     MOVE 'D'                    TO DA-RECORD-TYPE.
  5307
  5308 3500-EXIT.
  5309     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 104
* EL151.cbl
  5310/
  5311 3550-FIND-LETTER-TRLR.
  5312      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5313      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5314      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5315      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5316      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5317
  5318 3550-STARTBR-ELTRLR.
  5319
  5320
  5321* EXEC CICS HANDLE CONDITION
  5322*         ENDFILE   (3550-END)
  5323*         NOTFND    (3550-END)
  5324*     END-EXEC.
  5325*    MOVE '"$''I                  ! % #00005126' TO DFHEIV0
  5326     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5328     MOVE X'2520233030303035313236' TO DFHEIV0(25:11)
  5329     CALL 'kxdfhei1' USING DFHEIV0
  5330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5331
  5332
  5333
  5334* EXEC CICS STARTBR
  5335*         DATASET   (ELTRLR-FILE-ID)
  5336*         RIDFLD    (WS-TRAILER-KEY)
  5337*         GTEQ
  5338*     END-EXEC.
  5339     MOVE 0
  5340       TO DFHEIV11
  5341*    MOVE '&,         G          &   #00005131' TO DFHEIV0
  5342     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5343     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5344     MOVE X'2020233030303035313331' TO DFHEIV0(25:11)
  5345     CALL 'kxdfhei1' USING DFHEIV0,
  5346           ELTRLR-FILE-ID,
  5347           WS-TRAILER-KEY,
  5348           DFHEIV99,
  5349           DFHEIV11,
  5350           DFHEIV99
  5351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5352
  5353
  5354      MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
  5355
  5356 3550-READNEXT-ELTRLR.
  5357
  5358
  5359* EXEC CICS READNEXT
  5360*         DATASET   (ELTRLR-FILE-ID)
  5361*         RIDFLD    (WS-TRAILER-KEY)
  5362*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5363*     END-EXEC.
  5364     MOVE 0
  5365       TO DFHEIV11
  5366*    MOVE '&.S                   )   #00005141' TO DFHEIV0
  5367     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 105
* EL151.cbl
  5368     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5369     MOVE X'2020233030303035313431' TO DFHEIV0(25:11)
  5370     CALL 'kxdfhei1' USING DFHEIV0,
  5371           ELTRLR-FILE-ID,
  5372           DFHEIV20,
  5373           DFHEIV99,
  5374           WS-TRAILER-KEY,
  5375           DFHEIV99,
  5376           DFHEIV11,
  5377           DFHEIV99,
  5378           DFHEIV99
  5379     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5380         DFHEIV20
  5381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5382
  5383
  5384      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5385         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5386         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5387         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5388          GO TO 3550-END.
  5389
  5390      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5391          GO TO 3550-READNEXT-ELTRLR.
  5392
  5393     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-ANSWER-DT
  5394         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER-DT
  5395     END-IF.
  5396
  5397     GO TO 3550-READNEXT-ELTRLR.
  5398
  5399 3550-END.
  5400
  5401     IF WS-MAX-LETTER-ANSWER-DT NOT EQUAL LOW-VALUES AND SPACES
  5402         MOVE SPACES             TO  DC-OPTION-CODE
  5403         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
  5404         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5405         MOVE DC-GREG-DATE-1-MDY TO PI-PROOF-DATE
  5406         MOVE PI-PROOF-DATE TO  MPRFDTO
  5407         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  5408     END-IF.
  5409
  5410
  5411* EXEC CICS ENDBR
  5412*         DATASET   (ELTRLR-FILE-ID)
  5413*     END-EXEC.
  5414     MOVE 0
  5415       TO DFHEIV11
  5416*    MOVE '&2                    $   #00005173' TO DFHEIV0
  5417     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5418     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5419     MOVE X'2020233030303035313733' TO DFHEIV0(25:11)
  5420     CALL 'kxdfhei1' USING DFHEIV0,
  5421           ELTRLR-FILE-ID,
  5422           DFHEIV11,
  5423           DFHEIV99
  5424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5425
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 106
* EL151.cbl
  5426
  5427 3550-EXIT.
  5428     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 107
* EL151.cbl
  5429/
  5430 6000-RESET-AUTO-ACTIVITY.
  5431******************************************************************
  5432*    RESET ALL FUTURE LETTER ACTIVITY AWAITING FURTHER ACTION    *
  5433*    (RESEND, FOLLOW-UP, ETC) BY MOVING LOW-VALUES TO THE        *
  5434*    FOLLOW-UP OR RESEND DATES IN THE ACTIVITY TRAILER AND THE   *
  5435*    RESEND DATE IS THE LETTER ARCHIVE, IF NECESSARY.            *
  5436******************************************************************
  5437      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5438      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5439      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5440      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5441      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5442
  5443 6000-STARTBR-ELTRLR.
  5444
  5445
  5446* EXEC CICS HANDLE CONDITION
  5447*         ENDFILE   (6000-END-RESET)
  5448*         NOTFND    (6000-END-RESET)
  5449*     END-EXEC.
  5450*    MOVE '"$''I                  ! & #00005195' TO DFHEIV0
  5451     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5453     MOVE X'2620233030303035313935' TO DFHEIV0(25:11)
  5454     CALL 'kxdfhei1' USING DFHEIV0
  5455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5456
  5457
  5458
  5459* EXEC CICS STARTBR
  5460*         DATASET   (ELTRLR-FILE-ID)
  5461*         RIDFLD    (WS-TRAILER-KEY)
  5462*         GTEQ
  5463*     END-EXEC.
  5464     MOVE 0
  5465       TO DFHEIV11
  5466*    MOVE '&,         G          &   #00005200' TO DFHEIV0
  5467     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5468     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5469     MOVE X'2020233030303035323030' TO DFHEIV0(25:11)
  5470     CALL 'kxdfhei1' USING DFHEIV0,
  5471           ELTRLR-FILE-ID,
  5472           WS-TRAILER-KEY,
  5473           DFHEIV99,
  5474           DFHEIV11,
  5475           DFHEIV99
  5476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5477
  5478
  5479      MOVE 'Y'                       TO  WS-BROWSE-SW.
  5480
  5481 6000-READNEXT-ELTRLR.
  5482
  5483
  5484* EXEC CICS READNEXT
  5485*         DATASET   (ELTRLR-FILE-ID)
  5486*         RIDFLD    (WS-TRAILER-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 108
* EL151.cbl
  5487*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5488*     END-EXEC.
  5489     MOVE 0
  5490       TO DFHEIV11
  5491*    MOVE '&.S                   )   #00005210' TO DFHEIV0
  5492     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5493     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5494     MOVE X'2020233030303035323130' TO DFHEIV0(25:11)
  5495     CALL 'kxdfhei1' USING DFHEIV0,
  5496           ELTRLR-FILE-ID,
  5497           DFHEIV20,
  5498           DFHEIV99,
  5499           WS-TRAILER-KEY,
  5500           DFHEIV99,
  5501           DFHEIV11,
  5502           DFHEIV99,
  5503           DFHEIV99
  5504     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5505         DFHEIV20
  5506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5507
  5508
  5509      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5510         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5511         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5512         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5513          GO TO 6000-END-RESET.
  5514
  5515      IF WS-TRAILER-KEY IS EQUAL TO PI-PREV-TRLR-KEY
  5516          GO TO 6000-READNEXT-ELTRLR.
  5517
  5518      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5519          GO TO 6000-READNEXT-ELTRLR.
  5520
  5521      IF (AT-LETTER-ANSWERED-DT NOT EQUAL LOW-VALUES AND SPACES)
  5522          GO TO 6000-READNEXT-ELTRLR.
  5523
  5524      IF (AT-AUTO-RE-SEND-DT EQUAL LOW-VALUES OR SPACES)
  5525        AND
  5526         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES OR SPACES)
  5527          GO TO 6000-READNEXT-ELTRLR.
  5528
  5529      IF AT-RECEIPT-FOLLOW-UP IS LESS THAN SAVE-BIN-DATE AND
  5530         AT-AUTO-RE-SEND-DT IS LESS THAN SAVE-BIN-DATE   AND
  5531         AT-RESEND-PRINT-DATE IS LESS THAN SAVE-BIN-DATE
  5532          GO TO 6000-READNEXT-ELTRLR.
  5533
  5534      IF (AT-AUTO-RE-SEND-DT NOT EQUAL LOW-VALUES AND SPACES)
  5535        AND
  5536         (AT-RESEND-PRINT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  5537        AND
  5538         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES)
  5539          GO TO 6000-READNEXT-ELTRLR.
  5540
  5541 6000-END-BROWSE.
  5542
  5543      MOVE WS-TRAILER-KEY            TO  PI-PREV-TRLR-KEY.
  5544
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 109
* EL151.cbl
  5545
  5546* EXEC CICS ENDBR
  5547*         DATASET   (ELTRLR-FILE-ID)
  5548*     END-EXEC.
  5549     MOVE 0
  5550       TO DFHEIV11
  5551*    MOVE '&2                    $   #00005252' TO DFHEIV0
  5552     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5553     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5554     MOVE X'2020233030303035323532' TO DFHEIV0(25:11)
  5555     CALL 'kxdfhei1' USING DFHEIV0,
  5556           ELTRLR-FILE-ID,
  5557           DFHEIV11,
  5558           DFHEIV99
  5559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5560
  5561
  5562      MOVE 'N'                       TO  WS-BROWSE-SW.
  5563
  5564 6000-READ-ELTRLR-UPDATE.
  5565
  5566
  5567* EXEC CICS READ
  5568*         DATASET   (ELTRLR-FILE-ID)
  5569*         RIDFLD    (WS-TRAILER-KEY)
  5570*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5571*         UPDATE
  5572*     END-EXEC.
  5573*    MOVE '&"S        EU         (   #00005260' TO DFHEIV0
  5574     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5575     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5576     MOVE X'2020233030303035323630' TO DFHEIV0(25:11)
  5577     CALL 'kxdfhei1' USING DFHEIV0,
  5578           ELTRLR-FILE-ID,
  5579           DFHEIV20,
  5580           DFHEIV99,
  5581           WS-TRAILER-KEY,
  5582           DFHEIV99,
  5583           DFHEIV99,
  5584           DFHEIV99
  5585     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5586         DFHEIV20
  5587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5588
  5589
  5590      MOVE 'Y'                       TO  WS-UPDATE-SW.
  5591
  5592      IF AT-AUTO-RE-SEND-DT IS NOT LESS THAN SAVE-BIN-DATE
  5593          MOVE LOW-VALUES            TO  AT-AUTO-RE-SEND-DT
  5594          MOVE PI-COMPANY-CD         TO  ELARCH-COMPANY-CD
  5595          MOVE AT-LETTER-ARCHIVE-NO  TO  ELARCH-ARCHIVE-NO
  5596          MOVE '1'                   TO  ELARCH-RECORD-TYPE
  5597          MOVE +0                    TO  ELARCH-SEQ-NO
  5598          PERFORM 6200-READ-ELARCH-UPDATE THRU 6200-EXIT.
  5599
  5600      IF AT-RECEIPT-FOLLOW-UP IS NOT LESS THAN SAVE-BIN-DATE
  5601          MOVE LOW-VALUES            TO  AT-RECEIPT-FOLLOW-UP.
  5602
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 110
* EL151.cbl
  5603 6000-REWRITE-ELTRLR.
  5604
  5605
  5606* EXEC CICS REWRITE
  5607*         DATASET   (ELTRLR-FILE-ID)
  5608*         FROM      (ACTIVITY-TRAILERS)
  5609*     END-EXEC.
  5610     MOVE LENGTH OF
  5611      ACTIVITY-TRAILERS
  5612       TO DFHEIV11
  5613*    MOVE '&& L                  %   #00005282' TO DFHEIV0
  5614     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5615     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5616     MOVE X'2020233030303035323832' TO DFHEIV0(25:11)
  5617     CALL 'kxdfhei1' USING DFHEIV0,
  5618           ELTRLR-FILE-ID,
  5619           ACTIVITY-TRAILERS,
  5620           DFHEIV11,
  5621           DFHEIV99
  5622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5623
  5624
  5625      GO TO 6000-STARTBR-ELTRLR.
  5626
  5627 6000-END-RESET.
  5628
  5629      IF WS-BROWSE-SW IS EQUAL TO 'Y'
  5630          MOVE 'N'                   TO  WS-BROWSE-SW
  5631
  5632* EXEC CICS ENDBR
  5633*             DATASET   (ELTRLR-FILE-ID)
  5634*         END-EXEC.
  5635     MOVE 0
  5636       TO DFHEIV11
  5637*    MOVE '&2                    $   #00005293' TO DFHEIV0
  5638     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5639     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5640     MOVE X'2020233030303035323933' TO DFHEIV0(25:11)
  5641     CALL 'kxdfhei1' USING DFHEIV0,
  5642           ELTRLR-FILE-ID,
  5643           DFHEIV11,
  5644           DFHEIV99
  5645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5646
  5647
  5648 6000-EXIT.
  5649     EXIT.
  5650
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 111
* EL151.cbl
  5652 6100-CHECK-AUTO-ACTIVITY.
  5653******************************************************************
  5654*    READ THE AUTOMATIC ACTIVITY RECORD TO DETERMINE IF THE      *
  5655*    AUTOMATIC ACTIVITY CODE IN THE CLAIM MASTER IS TO BE RESET. *
  5656******************************************************************
  5657
  5658
  5659* EXEC CICS HANDLE CONDITION
  5660*         NOTFND   (6100-NOT-FOUND)
  5661*     END-EXEC.
  5662*    MOVE '"$I                   ! '' #00005307' TO DFHEIV0
  5663     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5665     MOVE X'2720233030303035333037' TO DFHEIV0(25:11)
  5666     CALL 'kxdfhei1' USING DFHEIV0
  5667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5668
  5669
  5670      MOVE PI-COMPANY-ID             TO  ELCNTL-COMPANY-ID.
  5671      MOVE 'T'                       TO  ELCNTL-RECORD-TYPE.
  5672      MOVE SPACES                    TO  ELCNTL-ACCESS.
  5673      MOVE +0                        TO  ELCNTL-SEQ-NO.
  5674
  5675
  5676* EXEC CICS READ
  5677*         DATASET   (ELCNTL-FILE-ID)
  5678*         RIDFLD    (ELCNTL-KEY)
  5679*         SET       (ADDRESS OF CONTROL-FILE)
  5680*     END-EXEC.
  5681*    MOVE '&"S        E          (   #00005316' TO DFHEIV0
  5682     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5683     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5684     MOVE X'2020233030303035333136' TO DFHEIV0(25:11)
  5685     CALL 'kxdfhei1' USING DFHEIV0,
  5686           ELCNTL-FILE-ID,
  5687           DFHEIV20,
  5688           DFHEIV99,
  5689           ELCNTL-KEY,
  5690           DFHEIV99,
  5691           DFHEIV99,
  5692           DFHEIV99
  5693     SET ADDRESS OF CONTROL-FILE TO
  5694         DFHEIV20
  5695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5696
  5697
  5698      IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  5699          MOVE CL-ACTIVITY-CODE      TO  MISC-SUB
  5700          IF MISC-SUB IS GREATER THAN +9
  5701              SUBTRACT +9 FROM MISC-SUB
  5702              MOVE CF-USER-RESET-SW (MISC-SUB) TO  WS-RESET-SW
  5703          ELSE
  5704              MOVE CF-SYS-RESET-SW  (MISC-SUB) TO  WS-RESET-SW.
  5705
  5706      MOVE 'Y'                       TO  WS-REC-FOUND-SW.
  5707      GO TO 6100-EXIT.
  5708
  5709 6100-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 112
* EL151.cbl
  5710
  5711     MOVE 'N'                        TO  WS-RESET-SW
  5712                                         WS-REC-FOUND-SW.
  5713
  5714 6100-EXIT.
  5715     EXIT.
  5716
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 113
* EL151.cbl
  5718 6200-READ-ELARCH-UPDATE.
  5719******************************************************************
  5720*  READ AND UPDATE THE RESEND DATE IN THE LETTER ARCHIVE RECORD  *
  5721******************************************************************
  5722
  5723
  5724* EXEC CICS HANDLE CONDITION
  5725*         NOTFND   (6200-EXIT)
  5726*     END-EXEC.
  5727*    MOVE '"$I                   ! ( #00005347' TO DFHEIV0
  5728     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5730     MOVE X'2820233030303035333437' TO DFHEIV0(25:11)
  5731     CALL 'kxdfhei1' USING DFHEIV0
  5732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5733
  5734
  5735
  5736* EXEC CICS READ
  5737*         DATASET   (ELARCH-FILE-ID)
  5738*         RIDFLD    (ELARCH-KEY)
  5739*         SET       (ADDRESS OF LETTER-ARCHIVE)
  5740*         UPDATE
  5741*     END-EXEC.
  5742*    MOVE '&"S        EU         (   #00005351' TO DFHEIV0
  5743     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5744     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5745     MOVE X'2020233030303035333531' TO DFHEIV0(25:11)
  5746     CALL 'kxdfhei1' USING DFHEIV0,
  5747           ELARCH-FILE-ID,
  5748           DFHEIV20,
  5749           DFHEIV99,
  5750           ELARCH-KEY,
  5751           DFHEIV99,
  5752           DFHEIV99,
  5753           DFHEIV99
  5754     SET ADDRESS OF LETTER-ARCHIVE TO
  5755         DFHEIV20
  5756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5757
  5758
  5759      MOVE LOW-VALUES                TO  LA-RESEND-DATE.
  5760
  5761 6200-REWRITE-ELARCH.
  5762
  5763
  5764* EXEC CICS REWRITE
  5765*         DATASET   (ELARCH-FILE-ID)
  5766*         FROM      (LETTER-ARCHIVE)
  5767*     END-EXEC.
  5768     MOVE LENGTH OF
  5769      LETTER-ARCHIVE
  5770       TO DFHEIV11
  5771*    MOVE '&& L                  %   #00005362' TO DFHEIV0
  5772     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5773     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5774     MOVE X'2020233030303035333632' TO DFHEIV0(25:11)
  5775     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 114
* EL151.cbl
  5776           ELARCH-FILE-ID,
  5777           LETTER-ARCHIVE,
  5778           DFHEIV11,
  5779           DFHEIV99
  5780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5781
  5782
  5783 6200-EXIT.
  5784     EXIT.
  5785
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 115
* EL151.cbl
  5787 7000-READ-ELMSTR-UPDATE.
  5788
  5789
  5790* EXEC CICS  HANDLE CONDITION
  5791*           NOTFND  (7000-NOTFND)
  5792*           NOTOPEN (9981-NOTOPEN-MSTR)
  5793*    END-EXEC.
  5794*    MOVE '"$IJ                  ! ) #00005373' TO DFHEIV0
  5795     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5796     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5797     MOVE X'2920233030303035333733' TO DFHEIV0(25:11)
  5798     CALL 'kxdfhei1' USING DFHEIV0
  5799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5800
  5801
  5802
  5803* EXEC CICS  READ
  5804*        DATASET  (ELMSTR-FILE-ID)
  5805*        RIDFLD   (WS-CLAIM-KEY)
  5806*        SET      (ADDRESS OF CLAIM-MASTER)
  5807*        UPDATE
  5808*    END-EXEC.
  5809*    MOVE '&"S        EU         (   #00005378' TO DFHEIV0
  5810     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5811     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5812     MOVE X'2020233030303035333738' TO DFHEIV0(25:11)
  5813     CALL 'kxdfhei1' USING DFHEIV0,
  5814           ELMSTR-FILE-ID,
  5815           DFHEIV20,
  5816           DFHEIV99,
  5817           WS-CLAIM-KEY,
  5818           DFHEIV99,
  5819           DFHEIV99,
  5820           DFHEIV99
  5821     SET ADDRESS OF CLAIM-MASTER TO
  5822         DFHEIV20
  5823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5824
  5825
  5826     GO TO 7000-EXIT.
  5827
  5828 7000-NOTFND.
  5829
  5830     MOVE ER-0133                TO  EMI-ERROR.
  5831     MOVE -1                     TO  MLINE1L.
  5832     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5833     GO TO 8200-SEND-DATAONLY.
  5834
  5835 7000-EXIT.
  5836      EXIT.
  5837
  5838 7010-REWRITE-ELMSTR.
  5839
  5840
  5841* EXEC CICS HANDLE CONDITION
  5842*        DUPKEY (7010-EXIT)
  5843*        END-EXEC.
  5844*    MOVE '"$$                   ! * #00005399' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 116
* EL151.cbl
  5845     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  5846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5847     MOVE X'2A20233030303035333939' TO DFHEIV0(25:11)
  5848     CALL 'kxdfhei1' USING DFHEIV0
  5849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5850
  5851
  5852
  5853* EXEC CICS  REWRITE
  5854*        DATASET  (ELMSTR-FILE-ID)
  5855*        FROM     (CLAIM-MASTER)
  5856*    END-EXEC.
  5857     MOVE LENGTH OF
  5858      CLAIM-MASTER
  5859       TO DFHEIV11
  5860*    MOVE '&& L                  %   #00005403' TO DFHEIV0
  5861     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5862     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5863     MOVE X'2020233030303035343033' TO DFHEIV0(25:11)
  5864     CALL 'kxdfhei1' USING DFHEIV0,
  5865           ELMSTR-FILE-ID,
  5866           CLAIM-MASTER,
  5867           DFHEIV11,
  5868           DFHEIV99
  5869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5870
  5871
  5872 7010-EXIT.
  5873      EXIT.
  5874
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 117
* EL151.cbl
  5876 7100-GETMAIN-ELTRLR.
  5877
  5878
  5879* EXEC CICS GETMAIN
  5880*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  5881*        INITIMG (GETMAIN-SPACE)
  5882*        LENGTH  (WS-TRLR-LENGTH)
  5883*    END-EXEC.
  5884*    MOVE ',"IL                  $   #00005414' TO DFHEIV0
  5885     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5886     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5887     MOVE X'2020233030303035343134' TO DFHEIV0(25:11)
  5888     CALL 'kxdfhei1' USING DFHEIV0,
  5889           DFHEIV20,
  5890           WS-TRLR-LENGTH,
  5891           GETMAIN-SPACE
  5892     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5893         DFHEIV20
  5894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5895
  5896
  5897 7100-EXIT.
  5898     EXIT.
  5899
  5900 7110-WRITE-ELTRLR.
  5901
  5902* EXEC CICS  HANDLE CONDITION
  5903*           DUPREC   (7110-DUPREC)
  5904*    END-EXEC.
  5905*    MOVE '"$%                   ! + #00005424' TO DFHEIV0
  5906     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5908     MOVE X'2B20233030303035343234' TO DFHEIV0(25:11)
  5909     CALL 'kxdfhei1' USING DFHEIV0
  5910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5911
  5912
  5913
  5914* EXEC CICS  WRITE
  5915*           DATASET  (ELTRLR-FILE-ID)
  5916*           RIDFLD   (WS-TRAILER-KEY)
  5917*           FROM     (ACTIVITY-TRAILERS)
  5918*    END-EXEC.
  5919     MOVE LENGTH OF
  5920      ACTIVITY-TRAILERS
  5921       TO DFHEIV11
  5922*    MOVE '&$ L                  ''   #00005428' TO DFHEIV0
  5923     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5924     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5925     MOVE X'2020233030303035343238' TO DFHEIV0(25:11)
  5926     CALL 'kxdfhei1' USING DFHEIV0,
  5927           ELTRLR-FILE-ID,
  5928           ACTIVITY-TRAILERS,
  5929           DFHEIV11,
  5930           WS-TRAILER-KEY,
  5931           DFHEIV99,
  5932           DFHEIV99
  5933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 118
* EL151.cbl
  5934
  5935
  5936     GO TO 7110-EXIT.
  5937
  5938 7110-DUPREC.
  5939
  5940     MOVE ER-0132                TO  EMI-ERROR.
  5941     MOVE -1                     TO  MLINE1L.
  5942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5943     GO TO 8200-SEND-DATAONLY.
  5944
  5945 7110-EXIT.
  5946      EXIT.
  5947
  5948 7120-READ-ELTRLR-UPDATE.
  5949
  5950
  5951* EXEC CICS  HANDLE CONDITION
  5952*           NOTFND  (9965-NO-TRLR-ERROR)
  5953*           NOTOPEN (9982-NOTOPEN-TRLR)
  5954*    END-EXEC.
  5955*    MOVE '"$IJ                  ! , #00005448' TO DFHEIV0
  5956     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5958     MOVE X'2C20233030303035343438' TO DFHEIV0(25:11)
  5959     CALL 'kxdfhei1' USING DFHEIV0
  5960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5961
  5962
  5963
  5964* EXEC CICS  READ
  5965*        DATASET  (ELTRLR-FILE-ID)
  5966*        RIDFLD   (WS-TRAILER-KEY)
  5967*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  5968*        UPDATE
  5969*    END-EXEC.
  5970*    MOVE '&"S        EU         (   #00005453' TO DFHEIV0
  5971     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5972     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5973     MOVE X'2020233030303035343533' TO DFHEIV0(25:11)
  5974     CALL 'kxdfhei1' USING DFHEIV0,
  5975           ELTRLR-FILE-ID,
  5976           DFHEIV20,
  5977           DFHEIV99,
  5978           WS-TRAILER-KEY,
  5979           DFHEIV99,
  5980           DFHEIV99,
  5981           DFHEIV99
  5982     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5983         DFHEIV20
  5984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5985
  5986
  5987 7120-EXIT.
  5988      EXIT.
  5989
  5990 7130-REWRITE-ELTRLR.
  5991
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 119
* EL151.cbl
  5992
  5993* EXEC CICS  REWRITE
  5994*        DATASET  (ELTRLR-FILE-ID)
  5995*        FROM     (ACTIVITY-TRAILERS)
  5996*    END-EXEC.
  5997     MOVE LENGTH OF
  5998      ACTIVITY-TRAILERS
  5999       TO DFHEIV11
  6000*    MOVE '&& L                  %   #00005465' TO DFHEIV0
  6001     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6002     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6003     MOVE X'2020233030303035343635' TO DFHEIV0(25:11)
  6004     CALL 'kxdfhei1' USING DFHEIV0,
  6005           ELTRLR-FILE-ID,
  6006           ACTIVITY-TRAILERS,
  6007           DFHEIV11,
  6008           DFHEIV99
  6009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6010
  6011
  6012 7130-EXIT.
  6013      EXIT.
  6014
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 120
* EL151.cbl
  6016 8100-SEND-INITIAL-MAP.
  6017
  6018     MOVE SAVE-DATE                  TO  MRNDATEO.
  6019     MOVE EIBTIME                    TO  TIME-IN.
  6020     MOVE TIME-OUT                   TO  MRNTIMEO.
  6021
  6022
  6023* EXEC CICS  SEND
  6024*         MAP      (MAP-NAME)
  6025*         MAPSET   (MAPSET-NAME)
  6026*         FROM     (EL151AO)
  6027*         ERASE
  6028*         CURSOR
  6029*    END-EXEC.
  6030     MOVE LENGTH OF
  6031      EL151AO
  6032       TO DFHEIV12
  6033     MOVE -1
  6034       TO DFHEIV11
  6035*    MOVE '8$     CT  E    H L F ,   #00005480' TO DFHEIV0
  6036     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  6037     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6038     MOVE X'2020233030303035343830' TO DFHEIV0(25:11)
  6039     CALL 'kxdfhei1' USING DFHEIV0,
  6040           MAP-NAME,
  6041           EL151AO,
  6042           DFHEIV12,
  6043           MAPSET-NAME,
  6044           DFHEIV99,
  6045           DFHEIV99,
  6046           DFHEIV99,
  6047           DFHEIV11,
  6048           DFHEIV99,
  6049           DFHEIV99,
  6050           DFHEIV99
  6051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6052
  6053
  6054     GO TO 9100-RETURN-TRAN.
  6055
  6056 8200-SEND-DATAONLY.
  6057
  6058     MOVE SAVE-DATE                  TO  MRNDATEO.
  6059     MOVE EIBTIME                    TO  TIME-IN.
  6060     MOVE TIME-OUT                   TO  MRNTIMEO.
  6061
  6062
  6063* EXEC CICS  SEND
  6064*        MAP       (MAP-NAME)
  6065*        MAPSET    (MAPSET-NAME)
  6066*        FROM      (EL151AO)
  6067*        DATAONLY
  6068*        CURSOR
  6069*    END-EXEC.
  6070     MOVE LENGTH OF
  6071      EL151AO
  6072       TO DFHEIV12
  6073     MOVE -1
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 121
* EL151.cbl
  6074       TO DFHEIV11
  6075*    MOVE '8$D    CT       H L F ,   #00005496' TO DFHEIV0
  6076     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  6077     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6078     MOVE X'2020233030303035343936' TO DFHEIV0(25:11)
  6079     CALL 'kxdfhei1' USING DFHEIV0,
  6080           MAP-NAME,
  6081           EL151AO,
  6082           DFHEIV12,
  6083           MAPSET-NAME,
  6084           DFHEIV99,
  6085           DFHEIV99,
  6086           DFHEIV99,
  6087           DFHEIV11,
  6088           DFHEIV99,
  6089           DFHEIV99,
  6090           DFHEIV99
  6091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6092
  6093
  6094     GO TO 9100-RETURN-TRAN.
  6095
  6096 8300-SEND-TEXT.
  6097
  6098* EXEC CICS SEND TEXT
  6099*        FROM     (LOGOFF-TEXT)
  6100*        LENGTH   (LOGOFF-LENGTH)
  6101*        ERASE
  6102*        FREEKB
  6103*    END-EXEC.
  6104*    MOVE '8&      T  E F  H   F -   #00005507' TO DFHEIV0
  6105     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6106     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6107     MOVE X'2020233030303035353037' TO DFHEIV0(25:11)
  6108     CALL 'kxdfhei1' USING DFHEIV0,
  6109           LOGOFF-TEXT,
  6110           LOGOFF-LENGTH,
  6111           DFHEIV99,
  6112           DFHEIV99,
  6113           DFHEIV99,
  6114           DFHEIV99,
  6115           DFHEIV99,
  6116           DFHEIV99,
  6117           DFHEIV99,
  6118           DFHEIV99,
  6119           DFHEIV99,
  6120           DFHEIV99
  6121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6122
  6123
  6124
  6125* EXEC CICS RETURN
  6126*        END-EXEC.
  6127*    MOVE '.(                    ''   #00005514' TO DFHEIV0
  6128     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6130     MOVE X'2020233030303035353134' TO DFHEIV0(25:11)
  6131     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 122
* EL151.cbl
  6132           DFHEIV99,
  6133           DFHEIV99,
  6134           DFHEIV99,
  6135           DFHEIV99,
  6136           DFHEIV99,
  6137           DFHEIV99
  6138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6139
  6140
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 123
* EL151.cbl
  6142 9600-PGMID-ERROR.
  6143
  6144* EXEC CICS HANDLE CONDITION
  6145*        PGMIDERR (8300-SEND-TEXT)
  6146*    END-EXEC.
  6147*    MOVE '"$L                   ! - #00005519' TO DFHEIV0
  6148     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6150     MOVE X'2D20233030303035353139' TO DFHEIV0(25:11)
  6151     CALL 'kxdfhei1' USING DFHEIV0
  6152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6153
  6154
  6155     MOVE THIS-PGM               TO LOGOFF-PGM
  6156                                    PI-CALLING-PROGRAM.
  6157     MOVE SPACES                 TO PI-ENTRY-CD-1.
  6158     MOVE 'EL005'                TO THIS-PGM.
  6159     MOVE THIS-PGM               TO LOGOFF-PGM.
  6160     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  6161     GO TO 9300-XCTL.
  6162
  6163 8800-UNAUTHORIZED-ACCESS.
  6164
  6165     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  6166     GO TO 8300-SEND-TEXT.
  6167
  6168 9100-RETURN-TRAN.
  6169     MOVE EMI-ERROR-NUMBER (1)    TO  PI-LAST-ERROR-NO.
  6170     MOVE '151A'                  TO  PI-CURRENT-SCREEN-NO.
  6171
  6172
  6173* EXEC CICS  RETURN
  6174*        TRANSID  (WS-TRANS-ID)
  6175*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6176*        LENGTH   (PI-COMM-LENGTH)
  6177*    END-EXEC.
  6178*    MOVE '.(CT                  ''   #00005540' TO DFHEIV0
  6179     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6180     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6181     MOVE X'2020233030303035353430' TO DFHEIV0(25:11)
  6182     CALL 'kxdfhei1' USING DFHEIV0,
  6183           WS-TRANS-ID,
  6184           PROGRAM-INTERFACE-BLOCK,
  6185           PI-COMM-LENGTH,
  6186           DFHEIV99,
  6187           DFHEIV99,
  6188           DFHEIV99
  6189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6190
  6191
  6192 9300-XCTL.
  6193
  6194* EXEC CICS XCTL
  6195*        PROGRAM  (THIS-PGM)
  6196*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6197*        LENGTH   (PI-COMM-LENGTH)
  6198*    END-EXEC.
  6199*    MOVE '.$C                   %   #00005547' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 124
* EL151.cbl
  6200     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6201     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6202     MOVE X'2020233030303035353437' TO DFHEIV0(25:11)
  6203     CALL 'kxdfhei1' USING DFHEIV0,
  6204           THIS-PGM,
  6205           PROGRAM-INTERFACE-BLOCK,
  6206           PI-COMM-LENGTH,
  6207           DFHEIV99
  6208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6209
  6210
  6211 9400-CLEAR.
  6212     MOVE PI-RETURN-TO-PROGRAM       TO  THIS-PGM.
  6213     GO TO 9300-XCTL.
  6214
  6215 9650-DEEDIT.
  6216
  6217* EXEC CICS BIF DEEDIT
  6218*        FIELD (DEEDIT-FIELD)
  6219*        LENGTH(15)
  6220*    END-EXEC.
  6221     MOVE 15
  6222       TO DFHEIV11
  6223*    MOVE '@"L                   #   #00005558' TO DFHEIV0
  6224     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6225     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6226     MOVE X'2020233030303035353538' TO DFHEIV0(25:11)
  6227     CALL 'kxdfhei1' USING DFHEIV0,
  6228           DEEDIT-FIELD,
  6229           DFHEIV11
  6230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6231
  6232
  6233 9650-EXIT.
  6234      EXIT.
  6235
  6236 9700-LINK-DATE-CONVERT.
  6237
  6238* EXEC CICS LINK
  6239*           PROGRAM  ('ELDATCV')
  6240*           COMMAREA (DATE-CONVERSION-DATA)
  6241*           LENGTH   (DC-COMM-LENGTH)
  6242*    END-EXEC.
  6243     MOVE 'ELDATCV' TO DFHEIV1
  6244*    MOVE '."C                   (   #00005567' TO DFHEIV0
  6245     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6247     MOVE X'2020233030303035353637' TO DFHEIV0(25:11)
  6248     CALL 'kxdfhei1' USING DFHEIV0,
  6249           DFHEIV1,
  6250           DATE-CONVERSION-DATA,
  6251           DC-COMM-LENGTH,
  6252           DFHEIV99,
  6253           DFHEIV99,
  6254           DFHEIV99,
  6255           DFHEIV99
  6256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6257
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 125
* EL151.cbl
  6258
  6259 9700-EXIT.
  6260      EXIT.
  6261
  6262 9900-ERROR-FORMAT.
  6263
  6264
  6265* EXEC CICS LINK
  6266*        PROGRAM  ('EL001')
  6267*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  6268*        LENGTH   (EMI-COMM-LENGTH)
  6269*    END-EXEC.
  6270     MOVE 'EL001' TO DFHEIV1
  6271*    MOVE '."C                   (   #00005578' TO DFHEIV0
  6272     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6273     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6274     MOVE X'2020233030303035353738' TO DFHEIV0(25:11)
  6275     CALL 'kxdfhei1' USING DFHEIV0,
  6276           DFHEIV1,
  6277           ERROR-MESSAGE-INTERFACE-BLOCK,
  6278           EMI-COMM-LENGTH,
  6279           DFHEIV99,
  6280           DFHEIV99,
  6281           DFHEIV99,
  6282           DFHEIV99
  6283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6284
  6285
  6286     MOVE EMI-LINE1              TO  MERMSG1O.
  6287
  6288 9900-EXIT.
  6289      EXIT.
  6290
  6291 9965-NO-TRLR-ERROR.
  6292     MOVE ER-0270                TO  EMI-ERROR.
  6293     MOVE -1                     TO  MLINE1L.
  6294     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6295     GO TO 8200-SEND-DATAONLY.
  6296
  6297 9981-NOTOPEN-MSTR.
  6298     MOVE ER-0154                TO EMI-ERROR
  6299     MOVE -1                     TO  MLINE1L.
  6300     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6301     GO TO 8200-SEND-DATAONLY.
  6302
  6303 9982-NOTOPEN-TRLR.
  6304     MOVE ER-0172                TO EMI-ERROR
  6305     MOVE -1                     TO  MLINE1L.
  6306     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6307     GO TO 8200-SEND-DATAONLY.
  6308
  6309 9986-NOTOPEN-DLYACTV.
  6310     MOVE '2955'                 TO EMI-ERROR.
  6311     MOVE -1                     TO  MLINE1L.
  6312     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6313     GO TO 8200-SEND-DATAONLY.
  6314
  6315 9995-SECURITY-VIOLATION.
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 126
* EL151.cbl
  6316*                            COPY ELCSCTP.
  6317******************************************************************
  6318*                                                                *
  6319*                            ELCSCTP                             *
  6320*                            VMOD=2.001                          *
  6321*                                                                *
  6322*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6323******************************************************************
  6324
  6325
  6326     MOVE EIBDATE          TO SM-JUL-DATE.
  6327     MOVE EIBTRMID         TO SM-TERMID.
  6328     MOVE THIS-PGM         TO SM-PGM.
  6329     MOVE EIBTIME          TO TIME-IN.
  6330     MOVE TIME-OUT         TO SM-TIME.
  6331     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6332
  6333
  6334* EXEC CICS LINK
  6335*         PROGRAM  ('EL003')
  6336*         COMMAREA (SECURITY-MESSAGE)
  6337*         LENGTH   (80)
  6338*    END-EXEC.
  6339     MOVE 'EL003' TO DFHEIV1
  6340     MOVE 80
  6341       TO DFHEIV11
  6342*    MOVE '."C                   (   #00005631' TO DFHEIV0
  6343     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6345     MOVE X'2020233030303035363331' TO DFHEIV0(25:11)
  6346     CALL 'kxdfhei1' USING DFHEIV0,
  6347           DFHEIV1,
  6348           SECURITY-MESSAGE,
  6349           DFHEIV11,
  6350           DFHEIV99,
  6351           DFHEIV99,
  6352           DFHEIV99,
  6353           DFHEIV99
  6354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6355
  6356
  6357******************************************************************
  6358
  6359
  6360 9995-EXIT.
  6361     EXIT.
  6362
  6363 9990-ABEND.
  6364     MOVE -1                      TO  MPFNUMBL.
  6365     MOVE DFHEIBLK                TO  EMI-LINE1.
  6366
  6367
  6368* EXEC CICS LINK
  6369*          PROGRAM  ('EL004')
  6370*          COMMAREA (EMI-LINE1)
  6371*          LENGTH   (72)
  6372*    END-EXEC.
  6373     MOVE 'EL004' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 127
* EL151.cbl
  6374     MOVE 72
  6375       TO DFHEIV11
  6376*    MOVE '."C                   (   #00005647' TO DFHEIV0
  6377     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6379     MOVE X'2020233030303035363437' TO DFHEIV0(25:11)
  6380     CALL 'kxdfhei1' USING DFHEIV0,
  6381           DFHEIV1,
  6382           EMI-LINE1,
  6383           DFHEIV11,
  6384           DFHEIV99,
  6385           DFHEIV99,
  6386           DFHEIV99,
  6387           DFHEIV99
  6388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6389
  6390
  6391     MOVE EMI-LINE1               TO  MERMSG1O.
  6392     GO TO 8200-SEND-DATAONLY.
  6393
  6394
  6395 9999-DFHBACK SECTION.
  6396     MOVE '9%                    "   ' TO DFHEIV0
  6397     MOVE 'EL151' TO DFHEIV1
  6398     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6399     GOBACK.
  6400 9999-DFHEXIT.
  6401     IF DFHEIGDJ EQUAL 0001
  6402         NEXT SENTENCE
  6403     ELSE IF DFHEIGDJ EQUAL 2
  6404         GO TO 9990-ABEND,
  6405               9600-PGMID-ERROR
  6406         DEPENDING ON DFHEIGDI
  6407     ELSE IF DFHEIGDJ EQUAL 3
  6408         GO TO 2000-NOTE-NOT-FOUND
  6409         DEPENDING ON DFHEIGDI
  6410     ELSE IF DFHEIGDJ EQUAL 4
  6411         GO TO 9986-NOTOPEN-DLYACTV,
  6412               2350-EXIT
  6413         DEPENDING ON DFHEIGDI
  6414     ELSE IF DFHEIGDJ EQUAL 5
  6415         GO TO 3550-END,
  6416               3550-END
  6417         DEPENDING ON DFHEIGDI
  6418     ELSE IF DFHEIGDJ EQUAL 6
  6419         GO TO 6000-END-RESET,
  6420               6000-END-RESET
  6421         DEPENDING ON DFHEIGDI
  6422     ELSE IF DFHEIGDJ EQUAL 7
  6423         GO TO 6100-NOT-FOUND
  6424         DEPENDING ON DFHEIGDI
  6425     ELSE IF DFHEIGDJ EQUAL 8
  6426         GO TO 6200-EXIT
  6427         DEPENDING ON DFHEIGDI
  6428     ELSE IF DFHEIGDJ EQUAL 9
  6429         GO TO 7000-NOTFND,
  6430               9981-NOTOPEN-MSTR
  6431         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 06-May-19 08:18 Page 128
* EL151.cbl
  6432     ELSE IF DFHEIGDJ EQUAL 10
  6433         GO TO 7010-EXIT
  6434         DEPENDING ON DFHEIGDI
  6435     ELSE IF DFHEIGDJ EQUAL 11
  6436         GO TO 7110-DUPREC
  6437         DEPENDING ON DFHEIGDI
  6438     ELSE IF DFHEIGDJ EQUAL 12
  6439         GO TO 9965-NO-TRLR-ERROR,
  6440               9982-NOTOPEN-TRLR
  6441         DEPENDING ON DFHEIGDI
  6442     ELSE IF DFHEIGDJ EQUAL 13
  6443         GO TO 8300-SEND-TEXT
  6444         DEPENDING ON DFHEIGDI.
  6445     MOVE '9%                    "   ' TO DFHEIV0
  6446     MOVE 'EL151' TO DFHEIV1
  6447     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6448     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5864     Code:       13374
