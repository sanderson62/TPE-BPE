* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   193******************************************************************
   194
   195 01  NET-PAY-WORK-AREA.
   196     12  OPTION-SW               PIC X   VALUE 'X'.
   197        88  NPO-STD         VALUE SPACE.
   198        88  NPO-ALT         VALUE 'A'.
   199        88  NPO-SIMPLE      VALUE 'S'.
   200        88  NPO-2MO         VALUE 'I'.
   201        88  NPO-3MO         VALUE 'J'.
   202        88  NPO-4MO         VALUE 'K'.
   203        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   204        88  NPO-TRUNC-0     VALUE 'T'.
   205        88  NPO-TRUNC-1     VALUE 'U'.
   206        88  NPO-TRUNC-2     VALUE 'V'.
   207        88  NPO-TRUNC-3     VALUE 'W'.
   208        88  NPO-TRUNC-4     VALUE 'X'.
   209        88  NPO-REFUND      VALUE 'R'.
   210        88  NPO-PRUDENTIAL  VALUE 'P'.
   211
   212     12  TYPE-SW             PIC X   VALUE 'N'.
   213        88  NET-STD             VALUE 'N'.
   214        88  NET-SMP             VALUE 'S'.
   215
   216     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   217        88  NP-RATING           VALUE '1'.
   218        88  NP-REFUND           VALUE '2'.
   219        88  NP-REMAIN-AMT       VALUE '3'.
   220
   221     12  COMP-3-WORK-AREA         COMP-3.
   222         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   223         16  V               PIC SV9(13)       VALUE +.0.
   224         16  J               PIC SV9(9)        VALUE +0.
   225         16  K               PIC SV9(9)        VALUE +0.
   226         16  I               PIC SV9(10)       VALUE +.0.
   227         16  D               PIC S9(5)         VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page   6
* ELRATE.cbl
   228         16  APR100          PIC SV9(9)        VALUE +.0.
   229         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   230         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   232         16  pema            pic s9(2)v9(15)   value +0.
   233         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   234         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   235         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   236         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   237         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   238         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   239         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   240         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   241         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   242         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   243         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   244         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   246         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   247         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   248         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   251         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   252         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.
   253         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   254         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.
   255         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.
   256         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   257         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   258         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.
   259         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   260         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.
   261         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   262         16  K1              PIC S999          VALUE +1.
   263         16  K12             PIC S999          VALUE +12.
   264         16  K100            PIC S999          VALUE +100.
   265         16  K1000           PIC S9(7)         VALUE +1000.
   266         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   267         16  Y REDEFINES NC-LR
   268                             PIC S99V9(5).
   269         16  TI              PIC S999V9(5)     VALUE +0.
   270         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   271         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   272         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   273         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   274         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   275         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   276         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   277         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   278
   279         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   280         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   281         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   282         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   283         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   284         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   285         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page   7
* ELRATE.cbl
   286         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   287         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   288         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   289         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   290         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   291         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   292
   293         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   294
   295         16  ORIGINAL-TERM   PIC S999.
   296         16  M              REDEFINES ORIGINAL-TERM
   297                             PIC S999.
   298
   299         16  REMAINING-TERM  PIC S999.
   300         16  R              REDEFINES REMAINING-TERM
   301                             PIC S999.
   302
   303         16  LOAN-TERM       PIC S999.
   304         16  N              REDEFINES LOAN-TERM
   305                             PIC S999.
   306
   307         16  EXPIRED-TERM    PIC S999.
   308         16  E              REDEFINES EXPIRED-TERM
   309                             PIC S999.
   310
   311         16  PRUDENTIAL-WORK-AMT
   312                             PIC S9(7)V9(8).
   313         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   314                             PIC S9(7)V9(8).
   315
   316         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   317         16  VX              PIC S9V9(13)      VALUE +0.0.
   318         16  SV              PIC S9V9(13)      VALUE +0.0.
   319         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   320         16  SX              PIC S9V9(13)      VALUE +0.0.
   321         16  SE              PIC S9V9(10)      VALUE +0.0.
   322         16  N2              PIC S9(7)         VALUE +0.
   323         16  N3              PIC S9(7)         VALUE +0.
   324         16  K-I             PIC S9V9(8)       VALUE +0.0.
   325
   326     12  BINARY-WORK-AREA        COMP.
   327         16  X1              PIC S999        VALUE +0.
   328         16  X2              PIC S999        VALUE +0.
   329         16  MAX-X           PIC S9(5)       VALUE +0.
   330         16  B1              PIC S9(5)       VALUE +1.
   331         16  LINDX           PIC S999        VALUE ZEROS.
   332         16  AHNDX           PIC S999        VALUE ZEROS.
   333
   334     12  CSO-RATE-WORK-AREAS.
   335         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   336         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   337         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   338     12  WS-WORK-MISC.
   339         16  ws-extra-pmts       pic s999         comp-3.
   340         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   341         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   342*        16  WS-AGE              PIC 99           VALUE ZEROS.
   343         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page   8
* ELRATE.cbl
   344         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   345         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   346         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   347         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   348         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   349         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   350         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   351         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   352         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   353         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   354         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   355******************************************************************
   356
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page   9
* ELRATE.cbl
   358*                            COPY ELCDATE.
   359******************************************************************
   360*                                                                *
   361*                                                                *
   362*                            ELCDATE.                            *
   363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   364*                            VMOD=2.003
   365*                                                                *
   366*                                                                *
   367*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   368*                 LENGTH = 200                                   *
   369******************************************************************
   370
   371 01  DATE-CONVERSION-DATA.
   372     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   373     12  DC-OPTION-CODE                PIC X.
   374         88  BIN-TO-GREG                VALUE ' '.
   375         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   376         88  EDIT-GREG-TO-BIN           VALUE '2'.
   377         88  YMD-GREG-TO-BIN            VALUE '3'.
   378         88  MDY-GREG-TO-BIN            VALUE '4'.
   379         88  JULIAN-TO-BIN              VALUE '5'.
   380         88  BIN-PLUS-ELAPSED           VALUE '6'.
   381         88  FIND-CENTURY               VALUE '7'.
   382         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   383         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   384         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   385         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   386         88  JULIAN-TO-BIN-3            VALUE 'C'.
   387         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   388         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   389         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   390         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   391         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   392         88  CHECK-LEAP-YEAR            VALUE 'H'.
   393         88  BIN-3-TO-GREG              VALUE 'I'.
   394         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   395         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   396         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   397         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   398         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   399         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   400         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   401         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   402         88  THREE-CHARACTER-BIN
   403                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   404         88  GREGORIAN-TO-BIN
   405                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   406         88  BIN-TO-GREGORIAN
   407                  VALUES ' ' '1' 'I' '8' 'G'.
   408         88  JULIAN-TO-BINARY
   409                  VALUES '5' 'C' 'E' 'F'.
   410     12  DC-ERROR-CODE                 PIC X.
   411         88  NO-CONVERSION-ERROR        VALUE ' '.
   412         88  DATE-CONVERSION-ERROR
   413                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   414         88  DATE-IS-ZERO               VALUE '1'.
   415         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  10
* ELRATE.cbl
   416         88  DATE-IS-INVALID            VALUE '3'.
   417         88  DATE1-GREATER-DATE2        VALUE '4'.
   418         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   419         88  DATE-INVALID-OPTION        VALUE '9'.
   420         88  INVALID-CENTURY            VALUE 'A'.
   421         88  ONLY-CENTURY               VALUE 'B'.
   422         88  ONLY-LEAP-YEAR             VALUE 'C'.
   423         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   424     12  DC-END-OF-MONTH               PIC X.
   425         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   426     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   427         88  USE-NORMAL-PROCESS         VALUE ' '.
   428         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   429         88  ADJUST-UP-100-YRS          VALUE '2'.
   430     12  FILLER                        PIC X.
   431     12  DC-CONVERSION-DATES.
   432         16  DC-BIN-DATE-1             PIC XX.
   433         16  DC-BIN-DATE-2             PIC XX.
   434         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   435         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   436                       DC-GREG-DATE-1-EDIT.
   437             20  DC-EDIT1-MONTH        PIC 99.
   438             20  SLASH1-1              PIC X.
   439             20  DC-EDIT1-DAY          PIC 99.
   440             20  SLASH1-2              PIC X.
   441             20  DC-EDIT1-YEAR         PIC 99.
   442         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   443         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   444                     DC-GREG-DATE-2-EDIT.
   445             20  DC-EDIT2-MONTH        PIC 99.
   446             20  SLASH2-1              PIC X.
   447             20  DC-EDIT2-DAY          PIC 99.
   448             20  SLASH2-2              PIC X.
   449             20  DC-EDIT2-YEAR         PIC 99.
   450         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   451         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   452                     DC-GREG-DATE-1-YMD.
   453             20  DC-YMD-YEAR           PIC 99.
   454             20  DC-YMD-MONTH          PIC 99.
   455             20  DC-YMD-DAY            PIC 99.
   456         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   457         16  DC-GREG-DATE-1-MDY-R REDEFINES
   458                      DC-GREG-DATE-1-MDY.
   459             20  DC-MDY-MONTH          PIC 99.
   460             20  DC-MDY-DAY            PIC 99.
   461             20  DC-MDY-YEAR           PIC 99.
   462         16  DC-GREG-DATE-1-ALPHA.
   463             20  DC-ALPHA-MONTH        PIC X(10).
   464             20  DC-ALPHA-DAY          PIC 99.
   465             20  FILLER                PIC XX.
   466             20  DC-ALPHA-CENTURY.
   467                 24 DC-ALPHA-CEN-N     PIC 99.
   468             20  DC-ALPHA-YEAR         PIC 99.
   469         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   470         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   471         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   472         16  DC-JULIAN-DATE            PIC 9(05).
   473         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  11
* ELRATE.cbl
   474                                       PIC 9(05).
   475         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   476             20  DC-JULIAN-YEAR        PIC 99.
   477             20  DC-JULIAN-DAYS        PIC 999.
   478         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   479         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   480         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   481     12  DATE-CONVERSION-VARIBLES.
   482         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   483         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   484             20  FILLER                PIC 9(3).
   485             20  HOLD-CEN-1-CCYY.
   486                 24  HOLD-CEN-1-CC     PIC 99.
   487                 24  HOLD-CEN-1-YY     PIC 99.
   488             20  HOLD-CEN-1-MO         PIC 99.
   489             20  HOLD-CEN-1-DA         PIC 99.
   490         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   491             20  HOLD-CEN-1-R-MO       PIC 99.
   492             20  HOLD-CEN-1-R-DA       PIC 99.
   493             20  HOLD-CEN-1-R-CCYY.
   494                 24  HOLD-CEN-1-R-CC   PIC 99.
   495                 24  HOLD-CEN-1-R-YY   PIC 99.
   496             20  FILLER                PIC 9(3).
   497         16  HOLD-CENTURY-1-X.
   498             20  FILLER                PIC X(3)  VALUE SPACES.
   499             20  HOLD-CEN-1-X-CCYY.
   500                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   501                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   502             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   503             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   504         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   505             20  HOLD-CEN-1-R-X-MO     PIC XX.
   506             20  HOLD-CEN-1-R-X-DA     PIC XX.
   507             20  HOLD-CEN-1-R-X-CCYY.
   508                 24  HOLD-CEN-1-R-X-CC PIC XX.
   509                 24  HOLD-CEN-1-R-X-YY PIC XX.
   510             20  FILLER                PIC XXX.
   511         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   512         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   513         16  DC-JULIAN-DATE-1          PIC 9(07).
   514         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   515             20  DC-JULIAN-1-CCYY.
   516                 24  DC-JULIAN-1-CC    PIC 99.
   517                 24  DC-JULIAN-1-YR    PIC 99.
   518             20  DC-JULIAN-DA-1        PIC 999.
   519         16  DC-JULIAN-DATE-2          PIC 9(07).
   520         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   521             20  DC-JULIAN-2-CCYY.
   522                 24  DC-JULIAN-2-CC    PIC 99.
   523                 24  DC-JULIAN-2-YR    PIC 99.
   524             20  DC-JULIAN-DA-2        PIC 999.
   525         16  DC-GREG-DATE-A-EDIT.
   526             20  DC-EDITA-MONTH        PIC 99.
   527             20  SLASHA-1              PIC X VALUE '/'.
   528             20  DC-EDITA-DAY          PIC 99.
   529             20  SLASHA-2              PIC X VALUE '/'.
   530             20  DC-EDITA-CCYY.
   531                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  12
* ELRATE.cbl
   532                 24  DC-EDITA-YEAR     PIC 99.
   533         16  DC-GREG-DATE-B-EDIT.
   534             20  DC-EDITB-MONTH        PIC 99.
   535             20  SLASHB-1              PIC X VALUE '/'.
   536             20  DC-EDITB-DAY          PIC 99.
   537             20  SLASHB-2              PIC X VALUE '/'.
   538             20  DC-EDITB-CCYY.
   539                 24  DC-EDITB-CENT     PIC 99.
   540                 24  DC-EDITB-YEAR     PIC 99.
   541         16  DC-GREG-DATE-CYMD         PIC 9(08).
   542         16  DC-GREG-DATE-CYMD-R REDEFINES
   543                              DC-GREG-DATE-CYMD.
   544             20  DC-CYMD-CEN           PIC 99.
   545             20  DC-CYMD-YEAR          PIC 99.
   546             20  DC-CYMD-MONTH         PIC 99.
   547             20  DC-CYMD-DAY           PIC 99.
   548         16  DC-GREG-DATE-MDCY         PIC 9(08).
   549         16  DC-GREG-DATE-MDCY-R REDEFINES
   550                              DC-GREG-DATE-MDCY.
   551             20  DC-MDCY-MONTH         PIC 99.
   552             20  DC-MDCY-DAY           PIC 99.
   553             20  DC-MDCY-CEN           PIC 99.
   554             20  DC-MDCY-YEAR          PIC 99.
   555    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   556        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   557    12  DC-EL310-DATE                  PIC X(21).
   558    12  FILLER                         PIC X(28).
   559
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  13
* ELRATE.cbl
   561*                            COPY ELCCALC.
   562******************************************************************
   563*                                                                *
   564*                           ELCCALC.                            *
   565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   566*                            VMOD=2.025                          *
   567*                                                                *
   568*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   569*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   570*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   571*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   572*                                                                *
   573*  PASSED TO ELRTRM                                              *
   574*  -----------------                                             *
   575*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   576*  ORIGINAL TERM                                                 *
   577*  BEGINNING DATE                                                *
   578*  ENDING DATE                                                   *
   579*  COMPANY I.D.                                                  *
   580*  ACCOUNT MASTER USER FIELD                                     *
   581*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   582*  FREE LOOK DAYS                                                *
   583*                                                                *
   584*  RETURNED FROM ELRTRM                                          *
   585*  ---------------------                                         *
   586*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   587*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   588*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   589*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   590*----------------------------------------------------------------*
   591*  PASSED TO ELRAMT                                              *
   592*  ----------------                                              *
   593*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   594*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   595*  ORIGINAL AMOUNT                                               *
   596*  ALTERNATE BENEFIT (BALLON)                                    *
   597*  A.P.R. - NET PAY ONLY                                         *
   598*  METHOD
   599*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   600*  COMPANY I.D.                                                  *
   601*  BENEFIT TYPE                                                  *
   602*                                                                *
   603*  RETURNED FROM ELRAMT                                          *
   604*  --------------------                                          *
   605*  REMAINING AMOUNT 1 - CURRENT                                  *
   606*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   607*  REMAINING AMOUNT FACTOR
   608*----------------------------------------------------------------*
   609*  PASSED TO ELRESV                                              *
   610*  -----------------                                             *
   611*  CERTIFICATE EFFECTIVE DATE                                    *
   612*  VALUATION DATE                                                *
   613*  PAID THRU DATE                                                *
   614*  BENEFIT                                                       *
   615*  INCURRED DATE                                                 *
   616*  REPORTED DATE                                                 *
   617*  ISSUE AGE                                                     *
   618*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  14
* ELRATE.cbl
   619*  CDT PERCENT                                                   *
   620*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   621* *CLAIM TYPE (LIFE, A/H)                                        *
   622* *REMAINING BENEFIT (FROM ELRAMT)                               *
   623* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   624*                                                                *
   625*  RETURNED FROM ELRESV                                          *
   626*  --------------------                                          *
   627*  CDT TABLE USED                                                *
   628*  CDT FACTOR USED                                               *
   629*  PAY TO CURRENT RESERVE                                        *
   630*  I.B.N.R. - A/H ONLY                                           *
   631*  FUTURE (ACCRUED) AH ONLY                                      *
   632*----------------------------------------------------------------*
   633*  PASSED TO ELRATE                                              *
   634*  ----------------                                              *
   635*  CERT ISSUE DATE                                               *
   636*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   637*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   638*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   639*  STATE CODE (CLIENT DEFINED)                                   *
   640*  STATE CODE (STANDARD P.O. ABBRV)                              *
   641*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   642*  DEVIATION CODE                                                *
   643*  ISSUE AGE                                                     *
   644*  ORIGINAL BENEFIT AMOUNT                                       *
   645*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   646*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   647*  BENEFIT KIND (LIFE OR A/H)                                    *
   648*  A.P.R.                                                        *
   649*  METHOD
   650*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   651*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   652*  COMPANY I.D. (3 CHARACTER)                                    *
   653*  BENEFIT CODE                                                  *
   654*  BENEFIT OVERRIDE CODE                                         *
   655*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   656*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   657*  JOINT INDICATOR (CSL ONLY)                                    *
   658*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   659*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   660*                                                                *
   661*  RETURNED FROM ELRATE                                          *
   662*  --------------------                                          *
   663*  CALCULATED PREMIUM                                            *
   664*  PREMIUM RATE                                                  *
   665*  MORTALITY CODE                                                *
   666*  MAX ATTAINED AGE                                              *
   667*  MAX AGE                                                       *
   668*  MAX TERM                                                      *
   669*  MAX MONTHLY BENEFIT                                           *
   670*  MAX TOTAL BENIFIT                                             *
   671*  COMPOSITE RATE (OPEN-END ONLY)                                *
   672*----------------------------------------------------------------*
   673*  PASSED TO ELRFND                                              *
   674*  ----------------                                              *
   675*  CERT ISSUE DATE                                               *
   676*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  15
* ELRATE.cbl
   677*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   678*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   679*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   680*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   681*  STATE CODE (CLIENT DEFINED)                                   *
   682*  STATE CODE (STANDARD P.O. ABBRV)                              *
   683*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   684*  DEVIATION CODE                                                *
   685*  ISSUE AGE                                                     *
   686*  ORIGINAL BENEFIT AMOUNT                                       *
   687*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   688*  PROCESS TYPE (CANCEL)                                         *
   689*  BENEFIT KIND (LIFE OR A/H)                                    *
   690*  A.P.R.                                                        *
   691*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   692*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   693*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   694*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   695*  COMPANY I.D. (3 CHARACTER)                                    *
   696*  BENEFIT CODE                                                  *
   697*  BENEFIT OVERRIDE CODE                                         *
   698*                                                                *
   699*  RETURNED FROM ELRFND                                          *
   700*  --------------------                                          *
   701*  CALCULATED REFUND                                             *
   702*----------------------------------------------------------------*
   703*  PASSED TO ELEARN                                              *
   704*  ----------------                                              *
   705*  CERT ISSUE DATE                                               *
   706*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   707*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   708*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   709*  STATE CODE (CLIENT DEFINED)                                   *
   710*  STATE CODE (STANDARD P.O. ABBRV)                              *
   711*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   712*  DEVIATION CODE                                                *
   713*  ISSUE AGE                                                     *
   714*  ORIGINAL BENEFIT AMOUNT                                       *
   715*  BENEFIT KIND (LIFE OR A/H)                                    *
   716*  A.P.R.                                                        *
   717*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   718*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   719*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   720*  COMPANY I.D. (3 CHARACTER)                                    *
   721*  BENEFIT CODE                                                  *
   722*  BENEFIT OVERRIDE CODE                                         *
   723*                                                                *
   724*  RETURNED FROM ELEARN                                          *
   725*  --------------------                                          *
   726*  INDICATED  EARNINGS                                           *
   727*----------------------------------------------------------------*
   728*                 LENGTH = 450                                   *
   729*                                                                *
   730******************************************************************
   731******************************************************************
   732*                   C H A N G E   L O G
   733*
   734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  16
* ELRATE.cbl
   735*-----------------------------------------------------------------
   736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   737* EFFECTIVE    NUMBER
   738*-----------------------------------------------------------------
   739* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   740* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   741* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   742* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   743* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   744* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   745* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   746* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   747* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   748* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   749* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   750******************************************************************
   751
   752 01  CALCULATION-PASS-AREA.
   753     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   754                                     COMP.
   755
   756     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   757       88  NO-CP-ERROR                             VALUE ZERO.
   758       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   759                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   760       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   761       88  CP-ERROR-IN-DATES                       VALUE '2'.
   762       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   763       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   764       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   765       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   766       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   767       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   768       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   769       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   770       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   771       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   772       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   773       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   774       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   775       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   776       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   777
   778     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   779       88  NO-CP-ERROR-2                           VALUE ZERO.
   780***********************  INPUT AREAS ****************************
   781
   782     12  CP-CALCULATION-AREA.
   783         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   784         16  CP-CERT-EFF-DT        PIC XX.
   785         16  CP-VALUATION-DT       PIC XX.
   786         16  CP-PAID-THRU-DT       PIC XX.
   787         16  CP-BENEFIT-TYPE       PIC X.
   788           88  CP-AH                               VALUE 'A' 'D'
   789                                                   'I' 'U'.
   790           88  CP-REDUCING-LIFE                    VALUE 'R'.
   791           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   792         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  17
* ELRATE.cbl
   793         16  CP-REPORTED-DT        PIC XX.
   794         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   795         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   796         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   797                                     COMP-3.
   798         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   799                                     COMP-3.
   800         16  CP-CDT-METHOD         PIC X.
   801           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   802           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   803           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   804         16  CP-CLAIM-TYPE         PIC X.
   805           88  CP-AH-CLAIM                         VALUE 'A'.
   806           88  CP-LIFE-CLAIM                       VALUE 'L'.
   807         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   808                                     COMP-3.
   809         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   810                                     COMP-3.
   811         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   812                                     COMP-3.
   813         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   814                                     COMP-3.
   815         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   816                                     COMP-3.
   817         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   818                                     COMP-3.
   819         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   820                                     COMP-3.
   821         16  CP-REM-TERM-METHOD    PIC X.
   822           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   823           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   824           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   825           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   826           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   827           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   828           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   829         16  CP-EARNING-METHOD     PIC X.
   830           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   831           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   832           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   833           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   834           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   835           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   836           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   837           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   838           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   839           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   840           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   841           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   842           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   843           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   844         16  CP-PROCESS-TYPE       PIC X.
   845           88  CP-CLAIM                            VALUE '1'.
   846           88  CP-CANCEL                           VALUE '2'.
   847           88  CP-ISSUE                            VALUE '3'.
   848         16  CP-SPECIAL-CALC-CD    PIC X.
   849           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   850           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  18
* ELRATE.cbl
   851           88  CP-0-MTH-INTEREST               VALUE 'A'.
   852           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   853           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   854           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   855           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   856           88  CP-FARM-PLAN                    VALUE 'F'.
   857           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   858           88  CP-2-MTH-INTEREST               VALUE 'I'.
   859           88  CP-3-MTH-INTEREST               VALUE 'J'.
   860           88  CP-4-MTH-INTEREST               VALUE 'K'.
   861           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   862           88  CP-MORTGAGE-REC                 VALUE 'M'.
   863           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   864           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   865           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   866           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   867                                                     'W' 'X'.
   868           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   869           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   870           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   871           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   872           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   873           88  CP-SUMMARY-REC                  VALUE 'Z'.
   874           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   875           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   876           88  CP-AD-D-BENEFIT                 VALUE '4'.
   877           88  CP-CSL-METH-1                   VALUE '5'.
   878           88  CP-CSL-METH-2                   VALUE '6'.
   879           88  CP-CSL-METH-3                   VALUE '7'.
   880           88  CP-CSL-METH-4                   VALUE '8'.
   881
   882         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   883                                     COMP-3.
   884         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   885         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   886         16  CP-STATE              PIC XX          VALUE SPACE.
   887         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   888         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   889           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   890               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   891         16  CP-R78-OPTION         PIC X.
   892           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   893           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   894
   895         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   896         16  CP-IBNR-RESERVE-SW    PIC X.
   897         16  CP-CLAIM-STATUS       PIC X.
   898         16  CP-RATE-FILE          PIC X.
   899         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   900                                     COMP-3.
   901
   902         16  CP-LIFE-OVERRIDE-CODE PIC X.
   903         16  CP-AH-OVERRIDE-CODE   PIC X.
   904
   905         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   906                                     COMP-3.
   907         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   908                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  19
* ELRATE.cbl
   909         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   910                                     COMP-3.
   911         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   912                                     COMP-3.
   913         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   914                                     COMP-3.
   915         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   916                                  PIC S9(7)V99 COMP-3.
   917
   918         16  CP-PAID-FROM-DATE     PIC X(02).
   919         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   920         16  CP-EXT-DAYS-CALC      PIC X.
   921           88  CP-EXT-NO-CHG                   VALUE ' '.
   922           88  CP-EXT-CHG-LF                   VALUE '1'.
   923           88  CP-EXT-CHG-AH                   VALUE '2'.
   924           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   925         16  CP-DOMICILE-STATE     PIC XX.
   926         16  CP-CARRIER            PIC X.
   927         16  CP-REIN-FLAG          PIC X.
   928         16  CP-REM-TRM-CALC-OPTION PIC X.
   929           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   930                      '2' '3' '4' '5'.
   931           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   932           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   933           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   934           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   935           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   936           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   937           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   938           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   939         16  CP-SIG-SWITCH         PIC X.
   940         16  CP-RATING-METHOD      PIC X.
   941           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   942           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   943           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   944           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   945           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   946           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   947           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   948           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   949           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   950         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   951                                     COMP-3.
   952         16  CP-BEN-CATEGORY       PIC X.
   953         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   954         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   955                                   PIC S99V9(5) COMP-3.
   956         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   957         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   958                                   PIC S99V9(5) COMP-3.
   959         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   960         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   961         16  CP-EXPIRE-DT          PIC XX.
   962         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   963         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   964         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   965         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   966         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  20
* ELRATE.cbl
   967             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   968             88  CP-CALC-CLP              VALUE 'C'.
   969         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   970         16  CP-CANCEL-REASON      PIC X.
   971         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   972         16  CP-PMT-MODE           PIC X.
   973         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   974         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   975         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   976         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   977         16  FILLER                PIC X.
   978
   979***************    OUTPUT FROM ELRESV   ************************
   980
   981         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   982
   983         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   984                                     COMP-3.
   985         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   986                                     COMP-3.
   987         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   988                                     COMP-3.
   989         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   990                                     COMP-3.
   991         16  FILLER                PIC X(09).
   992***************    OUTPUT FROM ELRTRM   *************************
   993
   994         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   995                                     COMP-3.
   996         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   997                                     COMP-3.
   998         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   999                                     COMP-3.
  1000         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1001                                     COMP-3.
  1002         16  FILLER                PIC X(12).
  1003
  1004***************    OUTPUT FROM ELRAMT   *************************
  1005
  1006         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1007                                     COMP-3.
  1008         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1009                                     COMP-3.
  1010         16  FILLER                PIC X(12).
  1011
  1012***************    OUTPUT FROM ELRATE   *************************
  1013
  1014         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1015                                     COMP-3.
  1016         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-MORTALITY-CODE     PIC X(4).
  1019         16  CP-RATE-EDIT-FLAG     PIC X.
  1020             88  CP-RATES-NEED-APR                  VALUE '1'.
  1021         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1022                                     COMP-3.
  1023         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1024         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  21
* ELRATE.cbl
  1025         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1026                                   PIC S9(7)V99 COMP-3.
  1027         16  FILLER                PIC X(07).
  1028
  1029***************    OUTPUT FROM ELRFND   *************************
  1030
  1031         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1032                                     COMP-3.
  1033         16  CP-REFUND-TYPE-USED   PIC X.
  1034           88  CP-R-AS-R78                         VALUE '1'.
  1035           88  CP-R-AS-PRORATA                     VALUE '2'.
  1036           88  CP-R-AS-CALIF                       VALUE '3'.
  1037           88  CP-R-AS-TEXAS                       VALUE '4'.
  1038           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1039           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1040           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1041           88  CP-R-AS-MEAN                        VALUE '8'.
  1042           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1043           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1044           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1045           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1046           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1047           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1048         16  FILLER                PIC X(12).
  1049
  1050***************    OUTPUT FROM ELEARN   *************************
  1051
  1052         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1053                                     COMP-3.
  1054         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1055                                     COMP-3.
  1056         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1057                                     COMP-3.
  1058         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1059                                     COMP-3.
  1060         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1061                                     COMP-3.
  1062         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1063                                     COMP-3.
  1064         16  CP-EARNING-TYPE-USED  PIC X.
  1065           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1066           88  CP-E-AS-R78                         VALUE '1'.
  1067           88  CP-E-AS-PRORATA                     VALUE '2'.
  1068           88  CP-E-AS-TEXAS                       VALUE '4'.
  1069           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1070           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1071           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1072           88  CP-E-AS-MEAN                        VALUE '8'.
  1073           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1074         16  FILLER                PIC X(12).
  1075
  1076***************    OUTPUT FROM ELPMNT   *************************
  1077
  1078         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1081                                     COMP-3.
  1082         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  22
* ELRATE.cbl
  1083
  1084***************   MISC WORK AREAS    *****************************
  1085         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1086                                     COMP-3.
  1087         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1088                                     COMP-3.
  1089         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1090                                     COMP-3.
  1091         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1092                                     COMP-3.
  1093         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1094                                     COMP-3.
  1095         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1096                                     COMP-3.
  1097         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1098             88  OPEN-RATE-FILE                   VALUE 'O'.
  1099             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1100             88  IO-ERROR                         VALUE 'E'.
  1101
  1102         16  CP-FIRST-PAY-DATE     PIC XX.
  1103
  1104         16  CP-JOINT-INDICATOR    PIC X.
  1105
  1106         16  CP-RESERVE-REMAINING-TERM
  1107                                   PIC S9(4)V9    VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-INSURED-BIRTH-DT   PIC XX.
  1111
  1112         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1113                                     COMP-3.
  1114
  1115         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1116                                     COMP-3.
  1117
  1118         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1119                                     COMP-3.
  1120
  1121         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1122                                     COMP-3.
  1123
  1124         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1125                                     COMP-3.
  1126
  1127         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1128                                     COMP-3.
  1129
  1130         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1131                                     COMP-3.
  1132
  1133         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1134             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1135
  1136         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1137                                     COMP-3.
  1138         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1139                                     COMP-3.
  1140         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  23
* ELRATE.cbl
  1141         16  cp-extra-periods      pic 9 value zeros.
  1142         16  cp-net-only-state     pic x value spaces.
  1143         16  FILLER                PIC X(13).
  1144******************************************************************
  1145
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  24
* ELRATE.cbl
  1147****************************************************************
  1148*
  1149* Copyright (c) 2007-2013 Dell Inc.
  1150* All rights reserved.
  1151*
  1152****************************************************************
  1153 01  DFHEIV.
  1154   02  DFHEIV0               PIC X(35).
  1155   02  DFHEIV1               PIC X(08).
  1156   02  DFHEIV2               PIC X(08).
  1157   02  DFHEIV3               PIC X(08).
  1158   02  DFHEIV4               PIC X(06).
  1159   02  DFHEIV5               PIC X(04).
  1160   02  DFHEIV6               PIC X(04).
  1161   02  DFHEIV7               PIC X(02).
  1162   02  DFHEIV8               PIC X(02).
  1163   02  DFHEIV9               PIC X(01).
  1164   02  DFHEIV10              PIC S9(7) COMP-3.
  1165   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1166   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1167   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1168   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1169   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1170   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1171   02  DFHEIV17              PIC X(04).
  1172   02  DFHEIV18              PIC X(04).
  1173   02  DFHEIV19              PIC X(04).
  1174   02  DFHEIV20              USAGE IS POINTER.
  1175   02  DFHEIV21              USAGE IS POINTER.
  1176   02  DFHEIV22              USAGE IS POINTER.
  1177   02  DFHEIV23              USAGE IS POINTER.
  1178   02  DFHEIV24              USAGE IS POINTER.
  1179   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1180   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1181   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1182   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1183   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1184   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1185   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1186   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1187   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1188   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1189   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1190   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1191   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1192   02  FILLER                PIC X(02).
  1193   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1194   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1195   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1196   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1197   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1198   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1199   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1200 LINKAGE  SECTION.
  1201*****************************************************************
  1202*                                                               *
  1203* Copyright (c) 2007-2013 Dell Inc.                             *
  1204* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  25
* ELRATE.cbl
  1205*                                                               *
  1206*****************************************************************
  1207 01  dfheiblk.
  1208     02  eibtime          pic s9(7) comp-3.
  1209     02  eibdate          pic s9(7) comp-3.
  1210     02  eibtrnid         pic x(4).
  1211     02  eibtaskn         pic s9(7) comp-3.
  1212     02  eibtrmid         pic x(4).
  1213     02  dfheigdi         pic s9(4) comp.
  1214     02  eibcposn         pic s9(4) comp.
  1215     02  eibcalen         pic s9(4) comp.
  1216     02  eibaid           pic x(1).
  1217     02  eibfiller1       pic x(1).
  1218     02  eibfn            pic x(2).
  1219     02  eibfiller2       pic x(2).
  1220     02  eibrcode         pic x(6).
  1221     02  eibfiller3       pic x(2).
  1222     02  eibds            pic x(8).
  1223     02  eibreqid         pic x(8).
  1224     02  eibrsrce         pic x(8).
  1225     02  eibsync          pic x(1).
  1226     02  eibfree          pic x(1).
  1227     02  eibrecv          pic x(1).
  1228     02  eibsend          pic x(1).
  1229     02  eibatt           pic x(1).
  1230     02  eibeoc           pic x(1).
  1231     02  eibfmh           pic x(1).
  1232     02  eibcompl         pic x(1).
  1233     02  eibsig           pic x(1).
  1234     02  eibconf          pic x(1).
  1235     02  eiberr           pic x(1).
  1236     02  eibrldbk         pic x(1).
  1237     02  eiberrcd         pic x(4).
  1238     02  eibsynrb         pic x(1).
  1239     02  eibnodat         pic x(1).
  1240     02  eibfiller5       pic x(2).
  1241     02  eibresp          pic s9(8) comp.
  1242     02  eibresp2         pic s9(8) comp.
  1243     02  dfheigdj         pic s9(4) comp.
  1244     02  dfheigdk         pic s9(4) comp.
  1245 01  DFHCOMMAREA             PIC X(450).
  1246
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  26
* ELRATE.cbl
  1248*01 PARMLIST              COMP.
  1249*    02  FILLER              PIC S9(8).
  1250*    02  ERRATE-POINTER      PIC S9(8).
  1251
  1252*                                COPY ERCRATE.
  1253******************************************************************
  1254*                                                                *
  1255*                                                                *
  1256*                            ERCRATE                             *
  1257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1258*                            VMOD=2.008                          *
  1259*                                                                *
  1260*   ONLINE CREDIT SYSTEM                                         *
  1261*                                                                *
  1262*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1263*                                                                *
  1264*   FILE TYPE = VSAM,KSDS                                        *
  1265*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1266*                                                                *
  1267*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1268*       ALTERNATE PATH = NONE                                    *
  1269*                                                                *
  1270*   LOG = NO                                                     *
  1271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1272*                                                                *
  1273******************************************************************
  1274******************************************************************
  1275*                   C H A N G E   L O G
  1276*
  1277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1278*-----------------------------------------------------------------
  1279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1280* EFFECTIVE    NUMBER
  1281*-----------------------------------------------------------------
  1282* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1283******************************************************************
  1284
  1285 01  RATE-RECORD.
  1286     12  RT-RECORD-ID                      PIC XX.
  1287         88  VALID-RT-ID                      VALUE 'RT'.
  1288
  1289     12  RT-CONTROL-PRIMARY.
  1290         16  RT-COMPANY-CD                 PIC X.
  1291         16  RT-STATE-CODE.
  1292             20  RT-ST-CODE                PIC XX.
  1293             20  RT-ST-CLASS               PIC XX.
  1294             20  RT-ST-DEV                 PIC XXX.
  1295         16  RT-L-AH-CODE.
  1296             20  RT-L-AH                   PIC X.
  1297             20  RT-LAH-NUM                PIC XX.
  1298         16  RT-LIMITS.
  1299             20  RT-HIGH-AGE               PIC 99.
  1300             20  RT-HIGH-AMT               PIC 9(6).
  1301             20  RT-FUTURE                 PIC XX.
  1302             20  RT-SEX                    PIC X.
  1303         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1304
  1305     12  RT-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  27
* ELRATE.cbl
  1306         16  RT-LAST-MAINT-DT              PIC XX.
  1307         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1308         16  RT-LAST-MAINT-USER            PIC X(4).
  1309         16  FILLER                        PIC X(10).
  1310
  1311     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1312     12  RT-RATE-COMMENT                   PIC X(50).
  1313
  1314     12  CSL-RESERVED                      PIC X(10).
  1315     12  FILLER                            PIC X(12).
  1316
  1317     12  RT-MAX-AGE                        PIC 99.
  1318
  1319     12  RT-LIFE-LIMS-FLDS.
  1320         16  RT-LIFE-MORT-CODE             PIC X(4).
  1321         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1322             20  RT-L-EX-AGE               PIC 99.
  1323             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1324             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1325         16  FILLER                        PIC X(20).
  1326
  1327     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1328         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1329             20  RT-AH-AGE                 PIC 99.
  1330             20  RT-AH-TERM                PIC S999       COMP-3.
  1331             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1332             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1333
  1334     12  RT-LIFE-RATES.
  1335         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1336
  1337     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1338         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1339
  1340     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1341
  1342     12  RT-DISCOUNT-OPTION                PIC X.
  1343         88  RT-DO-NOT-USE                     VALUE ' '.
  1344         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1345         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1346
  1347     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1348     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1349
  1350     12  RT-COMPOSITE-OPTION               PIC X.
  1351         88  RT-NO-COMPOSITE                   VALUE ' '.
  1352         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1353
  1354     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1355
  1356     12  RT-CANCEL-FEE                     PIC S9(3)V99   COMP-3.
  1357     12  FILLER                            PIC X(13).
  1358
  1359     12  RT-TYPE-RATE                      PIC X.
  1360         88  RT-IS-STND                        VALUE ' ' 'S'.
  1361         88  RT-IS-OB                          VALUE 'O'.
  1362
  1363     12  RT-SRT-ALPHA                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  28
* ELRATE.cbl
  1364
  1365     12  RT-CONTROL-2.
  1366         16  RTC-1                         PIC X(7).
  1367         16  RTC-3                         PIC X(11).
  1368         16  RTC-4                         PIC 9(11) COMP-3.
  1369         16  RTC-2                         PIC X(3).
  1370******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  29
* ELRATE.cbl
  1372 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1373 0000-DFHEXIT SECTION.
  1374     MOVE '9#                    $   ' TO DFHEIV0.
  1375     MOVE 'ELRATE' TO DFHEIV1.
  1376     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1377
  1378     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1379
  1380 000-START-PREMIUM-CALC.
  1381     MOVE ZERO                   TO CP-RETURN-CODE
  1382                                    CP-CALC-PREMIUM
  1383                                    CP-PREMIUM-RATE
  1384                                    CP-cancel-FEE.
  1385
  1386     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1387     MOVE ALL '9'                TO ERRATE-KEY.
  1388
  1389*    IF CP-RATE-FILE = 'O'
  1390*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1391
  1392     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1393     MOVE CP-STATE               TO RATE-ST-CODE.
  1394     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1395     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1396     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1397
  1398     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1399        CP-RATING-BENEFIT-AMT = ZEROS
  1400         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1401     ELSE
  1402         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1403
  1404     IF CP-AH
  1405         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1406     ELSE
  1407         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1408
  1409     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1410     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1411     MOVE SPACE                  TO DC-OPTION-CODE.
  1412
  1413     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1414
  1415*** Y2K, PROJ 7744
  1416     IF NO-CONVERSION-ERROR
  1417         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1418                                       WS-HOLD-RATE-EXP-DT
  1419         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1420         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1421         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1422     ELSE
  1423         MOVE '2'                   TO CP-RETURN-CODE
  1424         GO TO 9999-CALC-RATE-PREM-X
  1425     END-IF.
  1426*** Y2K, PROJ 7744
  1427
  1428
  1429* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  30
* ELRATE.cbl
  1430*        NOTFND   (9999-RATE-NOTFND)
  1431*        NOTOPEN  (9999-RATE-NOTOPEN)
  1432*        ENDFILE  (9999-RATE-NOTFND)
  1433*    END-EXEC.
  1434*    MOVE '"$IJ''                 ! " #00001424' TO DFHEIV0
  1435     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1437     MOVE X'2220233030303031343234' TO DFHEIV0(25:11)
  1438     CALL 'kxdfhei1' USING DFHEIV0
  1439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1440
  1441
  1442 0050-RATE-START-BROWSE.
  1443
  1444* EXEC CICS STARTBR
  1445*        DATASET  (ERRATE-FILE-ID)
  1446*        RIDFLD   (ERRATE-KEY)
  1447*        GTEQ
  1448*    END-EXEC.
  1449     MOVE 0
  1450       TO DFHEIV11
  1451*    MOVE '&,         G          &   #00001431' TO DFHEIV0
  1452     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1454     MOVE X'2020233030303031343331' TO DFHEIV0(25:11)
  1455     CALL 'kxdfhei1' USING DFHEIV0,
  1456           ERRATE-FILE-ID,
  1457           ERRATE-KEY,
  1458           DFHEIV99,
  1459           DFHEIV11,
  1460           DFHEIV99
  1461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1462
  1463
  1464     MOVE 'Y'                  TO WS-BROWSE-SW.
  1465
  1466 0100-READ-RATE-LOOP.
  1467
  1468* EXEC CICS READNEXT
  1469*        DATASET  (ERRATE-FILE-ID)
  1470*        SET      (ADDRESS OF RATE-RECORD)
  1471*        RIDFLD   (ERRATE-KEY)
  1472*    END-EXEC.
  1473     MOVE 0
  1474       TO DFHEIV11
  1475*    MOVE '&.S                   )   #00001440' TO DFHEIV0
  1476     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1477     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1478     MOVE X'2020233030303031343430' TO DFHEIV0(25:11)
  1479     CALL 'kxdfhei1' USING DFHEIV0,
  1480           ERRATE-FILE-ID,
  1481           DFHEIV20,
  1482           DFHEIV99,
  1483           ERRATE-KEY,
  1484           DFHEIV99,
  1485           DFHEIV11,
  1486           DFHEIV99,
  1487           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  31
* ELRATE.cbl
  1488     SET ADDRESS OF RATE-RECORD TO
  1489         DFHEIV20
  1490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1491
  1492
  1493 0110-CHECK-KEYS.
  1494*                            COPY ELCRATPD.
  1495******************************************************************
  1496*                                                                *
  1497*                                                                *
  1498*                            ELCRATPD                            *
  1499*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1500*                            VMOD=2.061                          *
  1501*                                                                *
  1502******************************************************************
  1503******************************************************************
  1504*                   C H A N G E   L O G
  1505*
  1506* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1507*-----------------------------------------------------------------
  1508*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1509* EFFECTIVE    NUMBER
  1510*-----------------------------------------------------------------
  1511* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1512* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1513* 032603                   PEMA  ADD SPECIAL AZ CALC
  1514* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1515* 120403                   PEMA  ADD SPECIAL TX CALC
  1516* 092205                   PEMA  FIX CRIT PER FOR DCC
  1517* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1518* 021207                   PEMA  ADD PA NP
  1519* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1520* 032807                   PEMA  ADD VT NP PLUS 2
  1521* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1522* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1523* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1524* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1525* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1526* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1527* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1528* 071211    2010012700001  PEMA  ADD SPPDD
  1529* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1530* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1531* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1532* 032612  CR2011110200001  PEMA  AHL CHANGES
  1533* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  1534* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1535* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1536* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1537* 021519  CR2019021100001  PEMA  non-monthly al calcs
  1538******************************************************************
  1539
  1540 0110-CHECK-KEY.
  1541     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1542        SVRT-ST-CODE    = RT-ST-CODE     AND
  1543        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1544        SVRT-ST-DEV     = RT-ST-DEV      AND
  1545        SVRT-L-AH       = RT-L-AH        AND
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  32
* ELRATE.cbl
  1546        SVRT-LAH-NUM    = RT-LAH-NUM
  1547         NEXT SENTENCE
  1548     ELSE
  1549         GO TO 9999-RATE-NOTFND.
  1550
  1551     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1552         GO TO 9999-RATE-NOTFND.
  1553
  1554     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1555        GO TO 0100-READ-RATE-LOOP.
  1556
  1557     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1558         GO TO 0100-READ-RATE-LOOP.
  1559
  1560     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1561         GO TO 0100-READ-RATE-LOOP.
  1562
  1563     IF RT-MAX-AGE = ZEROS
  1564         NEXT SENTENCE
  1565     ELSE
  1566         COMPUTE WS-AGE =
  1567             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1568         IF WS-AGE >= RT-MAX-AGE
  1569             MOVE 'B'               TO CP-RETURN-CODE.
  1570
  1571     IF CP-LOAN-TERM NOT NUMERIC
  1572         MOVE +0                    TO CP-LOAN-TERM.
  1573
  1574     IF CP-LOAN-TERM = ZERO
  1575         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1576
  1577     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1578         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1579
  1580     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1581     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1582
  1583     IF CP-AH
  1584         GO TO 2000-TYPE-IS-AH.
  1585
  1586*    display ' ben type           ' cp-benefit-type
  1587*    display ' earn meth          ' cp-earning-method
  1588*    display ' process type       ' cp-process-type
  1589*    display ' special            ' cp-special-calc-cd
  1590*    display ' ben code           ' cp-benefit-cd
  1591*    display ' ext days calc      ' cp-ext-days-calc
  1592*    display ' rating meth        ' cp-rating-method
  1593*    display ' orig ben           ' cp-original-benefit
  1594     evaluate true
  1595        when (rt-is-ob)
  1596           and (cp-company-id not = 'CID')
  1597              move cp-loan-term  to ws-rate-term
  1598        when (cp-company-id = 'DCC' OR 'VPP')
  1599           and (cp-benefit-cd (1:1) = 'P')
  1600           move cp-loan-term     to ws-rate-term
  1601        when other
  1602           move cp-original-term to ws-rate-term
  1603     end-evaluate
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  33
* ELRATE.cbl
  1604
  1605*    IF ((RT-IS-OB)
  1606*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1607*                     OR
  1608*       ((CP-COMPANY-ID = 'DCC')
  1609*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1610*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1611*    ELSE
  1612*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1613*    END-IF
  1614
  1615     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1616     MOVE SPACE                     TO DC-OPTION-CODE.
  1617
  1618     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1619
  1620 1000-TYPE-IS-LIFE.
  1621     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1622
  1623     MOVE ZERO                      TO CP-R-MAX-AGE
  1624                                       CP-R-MAX-TERM
  1625                                       CP-R-MAX-MON-BEN
  1626                                       CP-R-MAX-TOT-BEN.
  1627
  1628     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1629
  1630     IF RT-CANCEL-FEE NUMERIC
  1631        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  1632
  1633     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1634
  1635     if rt-discount-ob-rate not numeric
  1636        move zeros               to rt-discount-ob-rate
  1637     end-if
  1638     IF (RT-DISCOUNT-OPTION EQUAL
  1639                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1640        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1641        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1642         NEXT SENTENCE
  1643     ELSE
  1644         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1645            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1646             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1647                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1648                 GO TO 1050-REGULAR-RATES
  1649             ELSE
  1650                 GO TO 1050-REGULAR-RATES
  1651         ELSE
  1652             GO TO 1050-REGULAR-RATES.
  1653
  1654*    display ' discount option ' rt-discount-option
  1655     IF RT-DISCOUNT-RATE NOT NUMERIC
  1656        MOVE +0                  TO RT-DISCOUNT-RATE.
  1657
  1658     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1659        NEXT SENTENCE
  1660     ELSE
  1661        MOVE +0                  TO CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  34
* ELRATE.cbl
  1662                                    CP-COMPOSITE-RATE
  1663                                    CP-CALC-PREMIUM
  1664         MOVE '4'                TO CP-RETURN-CODE
  1665         GO TO 9999-CALC-RATE-PREM-X.
  1666
  1667     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1668        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1669     ELSE
  1670        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1671
  1672*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1673*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1674*       GO TO 1075-BYPASS-REGULAR-RATE.
  1675
  1676     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1677        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1678        COMPUTE WS-WORK-DIS-RATE EQUAL
  1679                WS-WORK-DIS-RATE / +100
  1680        GO TO 1075-BYPASS-REGULAR-RATE.
  1681
  1682     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1683        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1684        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1685        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1686        GO TO 1075-BYPASS-REGULAR-RATE.
  1687
  1688     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1689        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1690        (CP-TRUNCATED-LIFE)
  1691        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1692        GO TO 1075-BYPASS-REGULAR-RATE.
  1693
  1694     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1695        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1696        (CP-EARN-AS-NET-PAY)
  1697*       (CP-TRUNCATED-LIFE)
  1698        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1699        GO TO 1075-BYPASS-REGULAR-RATE.
  1700
  1701     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1702        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1703                   AND
  1704        ((CP-EARN-AS-NET-PAY)
  1705               OR
  1706        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1707        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1708        GO TO 1075-BYPASS-REGULAR-RATE.
  1709
  1710     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1711        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1712        (CP-EARN-AS-NET-PAY) AND
  1713        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1714        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1715        GO TO 1075-BYPASS-REGULAR-RATE.
  1716
  1717     if (cp-company-id = 'CID')
  1718        and (cp-state-std-abbrv = 'WA' or 'AL')
  1719        and (rt-discount-option = '1')
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  35
* ELRATE.cbl
  1720        and (cp-earn-as-farm-plan)
  1721        move rt-discount-ob-rate to cp-premium-rate
  1722        go to 1075-bypass-regular-rate
  1723     end-if
  1724     IF (CP-COMPANY-ID = 'CID')
  1725        AND (CP-STATE-STD-ABBRV = 'MN')
  1726        AND (RT-DISCOUNT-OPTION = '1')
  1727        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1728                     OR
  1729            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1730            AND (CP-CERT-EFF-DT > X'A4FF'))
  1731        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1732*       display ' made it to MN 1 ' cp-premium-rate
  1733        GO TO 1075-BYPASS-REGULAR-RATE
  1734     END-IF
  1735     if (cp-company-id = 'CID')
  1736        and (cp-earn-as-reg-balloon)
  1737        and (cp-ben-category = 'P' or 'I')
  1738        and (rt-discount-ob-rate not = zeros)
  1739        go to 1075-bypass-regular-rate
  1740     end-if
  1741     IF (CP-COMPANY-ID EQUAL 'CID')
  1742        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1743                      OR
  1744            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1745        AND (CP-EARN-AS-NET-PAY)
  1746        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1747        GO TO 1075-BYPASS-REGULAR-RATE
  1748     END-IF
  1749     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1750        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1751        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1752         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1753         GO TO 1075-BYPASS-REGULAR-RATE.
  1754
  1755     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1756        CONTINUE
  1757     ELSE
  1758        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1759           (CP-EARN-AS-NET-PAY ) AND
  1760           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1761            GO TO 1075-BYPASS-REGULAR-RATE
  1762        END-IF
  1763     END-IF
  1764     IF (CP-COMPANY-ID = 'CID') AND
  1765        (CP-EARN-AS-NET-PAY) AND
  1766        (CP-LEVEL-LIFE) AND
  1767        (CP-STATE-STD-ABBRV = 'CA') AND
  1768        (CP-STATE-STD-ABBRV = CP-STATE)
  1769        COMPUTE WS-WORK-DIS-RATE =
  1770             RT-DISCOUNT-RATE / +100
  1771        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1772        GO TO 1075-BYPASS-REGULAR-RATE
  1773     END-IF
  1774
  1775     IF (CP-COMPANY-ID = 'CID')
  1776        AND (CP-EARN-AS-NET-PAY)
  1777        AND (CP-STATE-STD-ABBRV = 'ME')
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  36
* ELRATE.cbl
  1778        COMPUTE WS-WORK-DIS-RATE =
  1779             RT-DISCOUNT-RATE / +100
  1780        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1781        GO TO 1075-BYPASS-REGULAR-RATE
  1782     END-IF
  1783     IF (CP-COMPANY-ID = 'CID')
  1784        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1785           OR 'IN' OR 'AZ')
  1786        AND (CP-FARM-PLAN)
  1787        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1788        GO TO 1075-BYPASS-REGULAR-RATE
  1789     END-IF
  1790     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  1791        AND (CP-BEN-CATEGORY = 'D')
  1792        AND (CP-EARN-AS-NET-PAY)
  1793        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1794        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1795           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1796*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1797*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1798*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1799*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1800        GO TO 1075-BYPASS-REGULAR-RATE
  1801     END-IF
  1802     IF (CP-COMPANY-ID = 'CID') AND
  1803        (CP-EARN-AS-NET-PAY) AND
  1804        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1805                            OR 'VT')
  1806                   OR
  1807        ((CP-STATE-STD-ABBRV = 'IN') AND
  1808        (CP-CERT-EFF-DT > X'9A7F'))
  1809                   OR
  1810        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1811        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1812        (CP-STATE-STD-ABBRV = CP-STATE)
  1813        COMPUTE WS-WORK-DIS-RATE =
  1814             RT-DISCOUNT-RATE / +100
  1815        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1816        GO TO 1075-BYPASS-REGULAR-RATE
  1817     END-IF
  1818
  1819     IF (CP-COMPANY-ID = 'CID') AND
  1820        (CP-EARN-AS-NET-PAY) AND
  1821        (CP-STATE-STD-ABBRV = 'TX') AND
  1822        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1823        (WS-DISCOUNT-OPTION NOT = ' ')
  1824        COMPUTE WS-WORK-DIS-RATE =
  1825             RT-DISCOUNT-RATE / +100
  1826        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1827        GO TO 1075-BYPASS-REGULAR-RATE
  1828     END-IF
  1829
  1830     IF (CP-COMPANY-ID = 'CID') AND
  1831        (CP-EARN-AS-NET-PAY) AND
  1832        (CP-TRUNCATED-LIFE) AND
  1833        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1834        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1835        (WS-DISCOUNT-OPTION NOT = ' ')
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  37
* ELRATE.cbl
  1836        COMPUTE WS-WORK-DIS-RATE =
  1837             RT-DISCOUNT-RATE / +100
  1838        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1839        GO TO 1075-BYPASS-REGULAR-RATE
  1840     END-IF
  1841
  1842     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1843        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1844           COMPUTE WS-WORK-DIS-RATE EQUAL
  1845                   WS-WORK-DIS-RATE / +100.
  1846
  1847     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1848        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1849           IF CP-MONTHLY-PAYMENT EQUAL +0
  1850            IF CP-LOAN-APR GREATER THAN +2
  1851              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1852              CP-ORIGINAL-BENEFIT /
  1853               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1854               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1855            ELSE
  1856             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1857               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1858
  1859     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1860        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1861          IF WS-WORK-DIS-RATE GREATER THAN +0
  1862           COMPUTE WK1 ROUNDED EQUAL
  1863           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1864                              (WS-RATE-TERM - +1)) /
  1865                        (WS-WORK-DIS-RATE / +12)
  1866           COMPUTE WK2 ROUNDED EQUAL
  1867           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1868                              (WS-RATE-TERM)) /
  1869                        (WS-WORK-DIS-RATE / +12)
  1870           COMPUTE WK3 EQUAL
  1871                RT-DISCOUNT-OB-RATE *
  1872                (1 + WS-WORK-DIS-RATE / +12)
  1873                MOVE WK3 TO CP-PREMIUM-RATE
  1874                COMPUTE WK5 EQUAL WK3 / +1000
  1875           GO TO 1075-BYPASS-REGULAR-RATE.
  1876*               (RT-DISCOUNT-OB-RATE / +1000) *
  1877*               (1 + WS-WORK-DIS-RATE / +12)
  1878*          GO TO 1075-BYPASS-REGULAR-RATE.
  1879
  1880     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1881        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1882           COMPUTE WK3 EQUAL
  1883           RT-DISCOUNT-OB-RATE *
  1884           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1885           MOVE WK3 TO CP-PREMIUM-RATE
  1886           COMPUTE WK5 EQUAL WK3 / +1000
  1887           GO TO 1075-BYPASS-REGULAR-RATE.
  1888
  1889     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1890        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1891        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1892        GO TO 1075-BYPASS-REGULAR-RATE.
  1893
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  38
* ELRATE.cbl
  1894     COMPUTE WS-SIN-PREM-RATE =
  1895             (RT-DISCOUNT-OB-RATE / +1000) *
  1896             ((WS-RATE-TERM + +1) / +2).
  1897
  1898     COMPUTE CP-PREMIUM-RATE =
  1899             WS-SIN-PREM-RATE /
  1900             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1901             WS-RATE-TERM) / +24)).
  1902
  1903     IF CP-PREMIUM-RATE NOT = +0
  1904        MULTIPLY +100 BY CP-PREMIUM-RATE
  1905        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1906        GO TO 1075-BYPASS-REGULAR-RATE.
  1907
  1908 1050-REGULAR-RATES.
  1909
  1910     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1911        COMPUTE WK5 EQUAL
  1912        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1913        (6 * (WS-RATE-TERM + 1))
  1914        MOVE WK5 TO CP-PREMIUM-RATE
  1915        GO TO 1075-BYPASS-REGULAR-RATE.
  1916
  1917     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1918        (CP-CSL-VALID-NP-BENEFIT-CD)
  1919        IF CP-JOINT-INDICATOR EQUAL 'J'
  1920           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1921           GO TO 1075-BYPASS-REGULAR-RATE
  1922        ELSE
  1923           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1924           GO TO 1075-BYPASS-REGULAR-RATE.
  1925
  1926     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1927        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1928        (CP-EARN-AS-NET-PAY )
  1929        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1930        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1931        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1932        MOVE '1'                 TO DC-OPTION-CODE
  1933        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1934        IF DATE-CONVERSION-ERROR
  1935            MOVE '2'                TO CP-RETURN-CODE
  1936            GO TO 9999-CALC-RATE-PREM-X
  1937        ELSE
  1938            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1939                                         DC-ODD-DAYS-OVER
  1940            GO TO 1075-BYPASS-REGULAR-RATE.
  1941
  1942     IF RT-COMPOSITE-RATE NOT NUMERIC
  1943         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1944
  1945*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1946     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1947         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1948                                              WS-PREMIUM-RATE
  1949         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1950     ELSE
  1951         MOVE +0                           TO CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  39
* ELRATE.cbl
  1952                                              CP-COMPOSITE-RATE
  1953                                              CP-CALC-PREMIUM
  1954         GO TO 9999-CALC-RATE-PREM-X.
  1955     IF (CP-COMPANY-ID EQUAL 'CID')
  1956        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1957        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1958        AND (CP-EARN-AS-NET-PAY)
  1959        GO TO 1075-BYPASS-REGULAR-RATE
  1960     END-IF
  1961******************************************************
  1962*    IF CP-COMPANY-ID NOT = 'LBL'
  1963     IF (CP-COMPANY-ID NOT = 'LBL' AND 'CID')
  1964                   or
  1965        ((cp-company-id = 'CID')
  1966        and (cp-earn-as-reg-balloon)
  1967        and (cp-ben-category = 'P' or 'I'))
  1968         GO TO 1075-BYPASS-REGULAR-RATE.
  1969
  1970     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1971     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1972     MOVE '1'                    TO DC-OPTION-CODE.
  1973     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1974     IF DATE-CONVERSION-ERROR
  1975         MOVE '2'                TO CP-RETURN-CODE
  1976         GO TO 9999-CALC-RATE-PREM-X
  1977       ELSE
  1978         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1979         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1980
  1981     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1982        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1983        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1984
  1985     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1986        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1987           NEXT SENTENCE
  1988         ELSE
  1989           GO TO 1075-BYPASS-REGULAR-RATE
  1990       ELSE
  1991        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1992           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1993           NEXT SENTENCE
  1994         ELSE
  1995           GO TO 1075-BYPASS-REGULAR-RATE.
  1996
  1997     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1998        COMPUTE CP-PREMIUM-RATE =
  1999        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  2000         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  2001         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2002
  2003     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  2004        COMPUTE CP-PREMIUM-RATE =
  2005        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2006        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  2007        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2008        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  2009         * (CP-ORIGINAL-TERM - 1)).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  40
* ELRATE.cbl
  2010******************************************************
  2011
  2012 1075-BYPASS-REGULAR-RATE.
  2013
  2014     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  2015
  2016     MOVE +1 TO LINDX.
  2017
  2018     IF CP-COMPANY-ID EQUAL 'CRI'
  2019        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2020           MOVE +5               TO LINDX
  2021           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  2022              MOVE 'F'           TO CP-RETURN-CODE
  2023              GO TO 1200-CALCULATE-PREMIUMS.
  2024
  2025     IF RT-L-EX-AGE (LINDX) = ZERO
  2026          GO TO 1200-CALCULATE-PREMIUMS.
  2027
  2028 1100-SEARCH-LIFE-LIMITS.
  2029
  2030     IF CP-COMPANY-ID EQUAL 'CRI'
  2031        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2032           IF LINDX GREATER THAN +4
  2033              MOVE 'A'           TO CP-RETURN-CODE
  2034              GO TO 1200-CALCULATE-PREMIUMS.
  2035
  2036     IF LINDX GREATER +8
  2037         MOVE 'A'                TO CP-RETURN-CODE
  2038         GO TO 1200-CALCULATE-PREMIUMS.
  2039
  2040     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  2041         IF RT-L-EX-AGE (LINDX) = ZEROS
  2042             ADD +1              TO LINDX
  2043             GO TO 1100-SEARCH-LIFE-LIMITS
  2044         ELSE
  2045             MOVE RT-L-EX-AGE (LINDX)
  2046                                 TO CP-R-MAX-AGE
  2047             MOVE RT-L-EX-TERM (LINDX)
  2048                                 TO CP-R-MAX-TERM
  2049             MOVE RT-L-EX-FACE (LINDX)
  2050                                 TO CP-R-MAX-TOT-BEN
  2051             ADD +1              TO LINDX
  2052             GO TO 1100-SEARCH-LIFE-LIMITS
  2053     ELSE
  2054         MOVE RT-L-EX-AGE (LINDX)
  2055                                 TO CP-R-MAX-AGE
  2056         MOVE RT-L-EX-TERM (LINDX)
  2057                                 TO CP-R-MAX-TERM
  2058         MOVE RT-L-EX-FACE (LINDX)
  2059                                 TO CP-R-MAX-TOT-BEN.
  2060
  2061     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  2062         MOVE '9'                TO CP-RETURN-CODE.
  2063
  2064     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  2065         MOVE '8'                TO CP-RETURN-CODE.
  2066
  2067 1200-CALCULATE-PREMIUMS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  41
* ELRATE.cbl
  2068
  2069     IF CP-COMPANY-ID = 'CSL'
  2070        IF CP-CSL-VALID-NP-BENEFIT-CD
  2071           GO TO 1240-NET-PAY-CONT
  2072        ELSE
  2073           GO TO 1250-CSL-CALC.
  2074
  2075     IF CP-COMPANY-ID = 'WDS'
  2076        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2077           IF CP-EARN-AS-REG-BALLOON
  2078              GO TO 1240-NET-PAY-CONT.
  2079
  2080     IF (CP-COMPANY-ID = 'CID')
  2081        AND (CP-STATE-STD-ABBRV = 'MN')
  2082        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  2083        AND (CP-CERT-EFF-DT > X'A4FF')
  2084        GO TO 1240-NET-PAY-CONT
  2085     END-IF
  2086     IF (CP-COMPANY-ID = 'CID')
  2087        AND (CP-STATE-STD-ABBRV = 'WA' or 'AL')
  2088        AND (CP-FARM-PLAN)
  2089        GO TO 1240-NET-PAY-CONT
  2090     END-IF
  2091     if (cp-company-id = 'CID')
  2092        and (cp-earn-as-reg-balloon)
  2093        and (cp-ben-category = 'P' or 'I')
  2094        display ' found balloon p or i ' rt-discount-ob-rate
  2095        evaluate true
  2096           when (cp-net-only-state = 'Y')
  2097              and (rt-discount-ob-rate > zeros)
  2098              compute cp-premium-rate = rt-discount-ob-rate / 10
  2099           when (cp-net-only-state = 'Y')
  2100              and (rt-discount-ob-rate = zeros)
  2101              display ' not ob rate     ' cp-premium-rate
  2102              compute cp-premium-rate =
  2103                 cp-premium-rate / cp-original-term * 12
  2104              display ' new rate ' cp-premium-rate
  2105              display ' net only state ' cp-premium-rate
  2106              compute cp-premium-rate rounded =
  2107                (cp-premium-rate *
  2108                   (cp-original-term + 1) / 12) /
  2109                ((cp-original-term + 2) / 2)
  2110              display ' new OB rate ' cp-premium-rate
  2111           when (cp-net-only-state <> 'Y')
  2112              and (rt-discount-ob-rate = zeros)
  2113              display ' not net only st ' cp-premium-rate
  2114              compute cp-premium-rate =
  2115                 cp-premium-rate / cp-original-term * 12
  2116              display ' new rate ' cp-premium-rate
  2117        end-evaluate
  2118        go to 1240-net-pay-cont
  2119     end-if
  2120     IF (CP-COMPANY-ID = 'CID')
  2121        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2122           OR 'IN' OR 'AZ')
  2123        AND (CP-FARM-PLAN)
  2124***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2125***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  42
* ELRATE.cbl
  2126        MOVE +1.0                TO CP-LOAN-APR
  2127        GO TO 1240-NET-PAY-CONT
  2128     END-IF
  2129     IF CP-RATE-AS-STANDARD
  2130         GO TO 1210-REGULAR-RATE.
  2131
  2132     IF CP-CRITICAL-PERIOD
  2133         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2134
  2135     IF CP-EARN-AS-TEXAS
  2136         GO TO 1230-TEXAS-CONT.
  2137
  2138     IF CP-EARN-AS-NET-PAY
  2139        IF CP-STATE-STD-ABBRV = 'MD'
  2140          IF CP-COMPANY-ID = 'MON'
  2141            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2142                               '14' OR '26' OR '47'
  2143              GO TO 1210-REGULAR-RATE.
  2144
  2145     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2146        IF CP-MONTHLY-PAYMENT EQUAL +0
  2147           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2148                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2149
  2150     IF CP-COMPANY-ID EQUAL 'GTL'
  2151        NEXT SENTENCE
  2152     ELSE
  2153     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2154        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2155           COMPUTE WK3 ROUNDED EQUAL
  2156           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2157           CP-MONTHLY-PAYMENT
  2158           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2159           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2160           CP-ALTERNATE-BENEFIT)
  2161           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2162           WK3 * WK5
  2163           GO TO 9999-CALC-RATE-PREM-X
  2164        ELSE
  2165           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2166           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2167           (WS-WORK-DIS-RATE / +12)
  2168           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2169           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2170                               WK5
  2171           GO TO 9999-CALC-RATE-PREM-X.
  2172
  2173     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2174        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2175        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2176        CP-ORIGINAL-TERM LESS THAN +61
  2177        COMPUTE CP-CALC-PREMIUM EQUAL
  2178                        (CP-ORIGINAL-BENEFIT *
  2179           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2180           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2181        COMPUTE CP-CALC-PREMIUM EQUAL
  2182                CP-CALC-PREMIUM +
  2183              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  43
* ELRATE.cbl
  2184        (CP-ORIGINAL-TERM + 1)) /
  2185        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2186        GO TO 9999-CALC-RATE-PREM-X.
  2187
  2188     IF CP-COMPANY-ID = 'GTL'     AND
  2189        CP-STATE-STD-ABBRV = 'PA' AND
  2190        CP-SPECIAL-CALC-CD = 'H'
  2191         GO TO 1260-GTL-PA-LEASE.
  2192
  2193     IF (CP-EARN-AS-NET-PAY)
  2194*       AND (CP-LOAN-APR > ZEROS)
  2195        GO TO 1240-NET-PAY-CONT
  2196     END-IF
  2197
  2198     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2199         GO TO 1210-REGULAR-RATE.
  2200
  2201**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2202**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2203****
  2204     IF CP-DEVIATION-CODE = 'LEV' AND
  2205        CP-LOAN-APR = ZEROS
  2206         GO TO 1210-REGULAR-RATE.
  2207
  2208     IF (CP-STATE-STD-ABBRV = 'OH')
  2209        AND (CP-CLASS-CODE NOT = 'L ')
  2210        AND (CP-ORIGINAL-TERM > 60)
  2211        AND (DC-GREG-DATE-CYMD > 19831031)
  2212        AND (CP-LOAN-APR > ZEROS)
  2213        GO TO 1240-NET-PAY-CONT
  2214     END-IF
  2215
  2216     IF (CP-STATE-STD-ABBRV = 'UT')
  2217        AND (CP-ORIGINAL-TERM > 62)
  2218        AND (DC-GREG-DATE-CYMD > 19810831)
  2219        AND (DC-GREG-DATE-CYMD < 19830901)
  2220        AND (CP-LOAN-APR > ZEROS)
  2221        GO TO 1240-NET-PAY-CONT
  2222     END-IF
  2223
  2224     IF (CP-STATE-STD-ABBRV = 'RI')
  2225        AND (CP-ORIGINAL-TERM > 60)
  2226        AND (DC-GREG-DATE-CYMD > 19831231)
  2227        AND (CP-LOAN-APR > ZEROS)
  2228        GO TO 1240-NET-PAY-CONT
  2229     END-IF
  2230     .
  2231 1210-REGULAR-RATE.
  2232
  2233     IF (CP-COMPANY-ID = 'CID')
  2234        AND (CP-EARN-AS-NET-PAY)
  2235        AND (CP-LOAN-APR = 0)
  2236        IF RT-L-RATE (WS-RATE-TERM) = 0
  2237           COMPUTE WS-SIN-PREM-RATE =
  2238              (RT-DISCOUNT-OB-RATE / +1000) *
  2239              ((WS-RATE-TERM + +1) / +2)
  2240           COMPUTE CP-PREMIUM-RATE =
  2241              WS-SIN-PREM-RATE /
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  44
* ELRATE.cbl
  2242              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2243              WS-RATE-TERM) / +24))
  2244        ELSE
  2245           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2246        END-IF
  2247     END-IF
  2248*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2249*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2250*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2251*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2252*
  2253*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2254*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2255*          COMPUTE WK3 ROUNDED EQUAL
  2256*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2257*          CP-MONTHLY-PAYMENT
  2258*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2259*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2260*          CP-ALTERNATE-BENEFIT)
  2261*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2262*          WK3 * WK5
  2263*          GO TO 9999-CALC-RATE-PREM-X
  2264*       ELSE
  2265*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2266*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2267*          (WS-WORK-DIS-RATE / +12)
  2268*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2269*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2270*                              WK5
  2271*          GO TO 9999-CALC-RATE-PREM-X.
  2272
  2273     IF CP-TERM-IS-DAYS
  2274         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2275             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2276         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2277             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2278                          * CP-TERM-OR-EXT-DAYS
  2279           GO TO 9999-CALC-RATE-PREM-X.
  2280
  2281     if (cp-company-id = 'AHL')
  2282        and (cp-loan-term > cp-original-term)
  2283        continue
  2284     else
  2285        IF NOT CP-TRUNCATED-LIFE
  2286           GO TO 1212-GROSS-NOT-TRUNCATED
  2287        end-if
  2288     end-if
  2289
  2290****  GROSS TRUNCATED CALCULATION
  2291
  2292     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2293         MOVE 'H'                TO  CP-RETURN-CODE
  2294         GO TO 9999-CALC-RATE-PREM-X.
  2295     if cp-company-id = 'AHL'
  2296        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2297           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2298           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2299           cp-original-term) * (cp-loan-term - cp-original-term
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  45
* ELRATE.cbl
  2300            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2301            cp-premium-rate / 100 * cp-original-term /
  2302            cp-loan-term * cp-original-benefit
  2303        else
  2304           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2305           cp-original-term) * (cp-loan-term - cp-original-term
  2306            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2307            cp-premium-rate * cp-original-benefit / 100
  2308        end-if
  2309        go to 9999-calc-rate-prem-x
  2310     end-if
  2311
  2312     IF CP-COMPANY-ID = 'NCL'
  2313         COMPUTE WK-MONTHLY-RATE =
  2314               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2315                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2316                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2317                                 /
  2318                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2319                                 *
  2320                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2321         COMPUTE CP-CALC-PREMIUM =
  2322                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2323     ELSE
  2324         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2325                                 CP-ORIGINAL-TERM
  2326         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2327                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2328                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2329                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2330     END-IF
  2331     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2332        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2333           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2334           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2335     END-IF
  2336     GO TO 9999-CALC-RATE-PREM-X
  2337     .
  2338 1212-GROSS-NOT-TRUNCATED.
  2339*    display ' premium rate ' cp-premium-rate
  2340
  2341     IF (CP-COMPANY-ID = 'CID')
  2342        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2343           OR 'IN')
  2344        AND (CP-BENEFIT-CD = '55' OR '56')
  2345        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2346          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2347          (CP-ORIGINAL-TERM) *
  2348          ((CP-ORIGINAL-TERM) / 12) *
  2349          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2350          GO TO 9999-CALC-RATE-PREM-X
  2351     END-IF
  2352     IF (CP-COMPANY-ID = 'CID')
  2353        AND (CP-STATE-STD-ABBRV = 'GA')
  2354        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2355        COMPUTE WK3 ROUNDED =
  2356          CP-ORIGINAL-BENEFIT *
  2357          ((CP-ORIGINAL-TERM + 1) / 2) *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  46
* ELRATE.cbl
  2358          (RT-DISCOUNT-OB-RATE / 1000)
  2359          MOVE WK3 TO CP-CALC-PREMIUM
  2360          GO TO 9999-CALC-RATE-PREM-X
  2361     END-IF
  2362     IF (CP-COMPANY-ID EQUAL 'CID')
  2363        AND (CP-STATE-STD-ABBRV = 'MN')
  2364        AND (CP-LEVEL-LIFE)
  2365        AND (CP-CERT-EFF-DT > X'A4FF')
  2366        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2367        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2368        MOVE '1'                 TO DC-OPTION-CODE
  2369        PERFORM 9100-CONVERT-DATE
  2370                                 THRU 9100-EXIT
  2371        IF DATE-CONVERSION-ERROR
  2372           MOVE '2'              TO CP-RETURN-CODE
  2373           MOVE ZEROS            TO FACTOR
  2374                                 CP-CALC-PREMIUM
  2375           GO TO 9999-CALC-RATE-PREM-X
  2376        END-IF
  2377        MOVE DC-ELAPSED-DAYS     TO D
  2378        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2379           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2380           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2381        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2382           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2383        GO TO 9999-CALC-RATE-PREM-X
  2384     END-IF
  2385     IF (CP-COMPANY-ID = 'CID')
  2386        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2387        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2388           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2389     ELSE
  2390        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2391                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2392     END-IF
  2393*    display ' calc premium ' cp-calc-premium
  2394
  2395*    IF CP-COMPANY-ID = 'LBL'
  2396     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2397        AND (NOT CP-EARN-AS-NET-PAY)
  2398        GO TO 9999-CALC-RATE-PREM-X
  2399     END-IF
  2400
  2401     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2402         GO TO 9999-CALC-RATE-PREM-X.
  2403
  2404     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2405         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2406            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2407               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2408
  2409     GO TO 9999-CALC-RATE-PREM-X.
  2410
  2411 1220-CRITICAL-PERIOD-LF-CONT.
  2412     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2413               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2414
  2415     GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  47
* ELRATE.cbl
  2416
  2417 1230-TEXAS-CONT.
  2418     IF CP-FARM-PLAN
  2419         GO TO 1235-TEXAS-FARM-CONT.
  2420
  2421     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2422               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2423
  2424     COMPUTE TEX-FACT-9 =
  2425                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2426                 (CP-ORIGINAL-TERM + 1).
  2427
  2428     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2429                 CP-CALC-PREMIUM * TEX-FACT-9.
  2430
  2431     GO TO 9999-CALC-RATE-PREM-X.
  2432
  2433 1235-TEXAS-FARM-CONT.
  2434     COMPUTE WS-FARM-TERM =
  2435               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2436
  2437     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2438     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2439
  2440
  2441     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2442              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2443
  2444     GO TO 9999-CALC-RATE-PREM-X.
  2445
  2446 1240-NET-PAY-CONT.
  2447
  2448     MOVE CP-LOAN-APR             TO N-P-APR.
  2449     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2450                                     N-P-REM
  2451                                     N-P-LOAN.
  2452
  2453     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2454
  2455     IF CP-TRUNCATED-LIFE
  2456         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2457
  2458     IF CP-COMPANY-ID EQUAL 'NCL'
  2459        NEXT SENTENCE
  2460     ELSE
  2461        GO TO 1241-NET-PAY-CONT.
  2462
  2463     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2464     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2465     MOVE '1'                    TO DC-OPTION-CODE
  2466     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2467     IF DATE-CONVERSION-ERROR
  2468         MOVE '2'                TO CP-RETURN-CODE
  2469         GO TO 9999-CALC-RATE-PREM-X
  2470     ELSE
  2471        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2472        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2473
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  48
* ELRATE.cbl
  2474     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2475        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2476        NEXT SENTENCE
  2477     ELSE
  2478        MOVE +1                  TO ODF
  2479        GO TO 1241-NET-PAY-CONT.
  2480
  2481     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2482        COMPUTE CP-PREMIUM-RATE EQUAL
  2483        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2484        CP-PREMIUM-RATE) *
  2485        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2486
  2487     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2488        COMPUTE CP-PREMIUM-RATE EQUAL
  2489        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2490        N-P-LOAN * (N-P-LOAN - 1))) *
  2491        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2492        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2493
  2494     COMPUTE ODF EQUAL
  2495     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2496     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2497
  2498 1241-NET-PAY-CONT.
  2499
  2500     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2501
  2502*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2503     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2504        NEXT SENTENCE
  2505     ELSE
  2506        GO TO 9999-CALC-RATE-PREM-X.
  2507
  2508     IF RT-DISCOUNT-OPTION EQUAL '6'
  2509         GO TO 9999-CALC-RATE-PREM-X.
  2510
  2511     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2512        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2513        GO TO 9999-CALC-RATE-PREM-X.
  2514
  2515     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2516
  2517     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2518        GO TO 9999-CALC-RATE-PREM-X.
  2519
  2520     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2521        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2522        (CP-TRUNCATED-LIFE)
  2523        GO TO 9999-CALC-RATE-PREM-X.
  2524
  2525     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2526        (CP-CSL-VALID-NP-BENEFIT-CD)
  2527        GO TO 9999-CALC-RATE-PREM-X.
  2528
  2529     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2530        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2531        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  49
* ELRATE.cbl
  2532        GO TO 9999-CALC-RATE-PREM-X.
  2533
  2534*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2535*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2536*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2537*       GO TO 9999-CALC-RATE-PREM-X.
  2538
  2539     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2540        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2541        (CP-EARN-AS-NET-PAY)
  2542        GO TO 9999-CALC-RATE-PREM-X.
  2543
  2544     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2545        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2546        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2547        GO TO 9999-CALC-RATE-PREM-X.
  2548
  2549     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2550        (CP-EARN-AS-NET-PAY)
  2551        GO TO 9999-CALC-RATE-PREM-X.
  2552
  2553     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2554        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2555        (CP-TRUNCATED-LIFE)
  2556        GO TO 9999-CALC-RATE-PREM-X.
  2557
  2558     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2559        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2560        (CP-EARN-AS-NET-PAY)
  2561*       (CP-TRUNCATED-LIFE)
  2562        GO TO 9999-CALC-RATE-PREM-X.
  2563
  2564     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2565        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2566                   AND
  2567        ((CP-EARN-AS-NET-PAY)
  2568               OR
  2569        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2570        GO TO 9999-CALC-RATE-PREM-X.
  2571
  2572     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2573        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2574        (CP-EARN-AS-NET-PAY) AND
  2575        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2576        GO TO 9999-CALC-RATE-PREM-X.
  2577
  2578     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2579        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2580        (CP-EARN-AS-NET-PAY)
  2581        GO TO 9999-CALC-RATE-PREM-X.
  2582
  2583     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2584        CONTINUE
  2585     ELSE
  2586        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2587           (CP-EARN-AS-NET-PAY) AND
  2588           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2589           GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  50
* ELRATE.cbl
  2590        END-IF
  2591     END-IF
  2592
  2593     IF (CP-COMPANY-ID = 'CID')
  2594        AND (CP-EARN-AS-NET-PAY)
  2595        AND (CP-STATE-STD-ABBRV = 'ME')
  2596        GO TO 9999-CALC-RATE-PREM-X
  2597     END-IF
  2598     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2599        AND (CP-BEN-CATEGORY = 'D')
  2600        AND (CP-EARN-AS-NET-PAY)
  2601        GO TO 9999-CALC-RATE-PREM-X
  2602     END-IF
  2603     IF (CP-COMPANY-ID = 'CID')
  2604        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2605           OR 'IN' OR 'AZ')
  2606        AND (CP-FARM-PLAN)
  2607        GO TO 9999-CALC-RATE-PREM-X
  2608     END-IF
  2609     IF (CP-COMPANY-ID = 'CID') AND
  2610        (CP-EARN-AS-NET-PAY) AND
  2611        (CP-LEVEL-LIFE) AND
  2612        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2613        (CP-STATE-STD-ABBRV = CP-STATE)
  2614        GO TO 9999-CALC-RATE-PREM-X
  2615     END-IF
  2616
  2617     IF (CP-COMPANY-ID = 'CID') AND
  2618        (CP-EARN-AS-NET-PAY) AND
  2619        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2620                            OR 'VT')
  2621                   OR
  2622        ((CP-STATE-STD-ABBRV = 'IN') AND
  2623        (CP-CERT-EFF-DT > X'9A7F'))
  2624                   OR
  2625        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2626        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2627        (CP-STATE-STD-ABBRV = CP-STATE)
  2628        GO TO 9999-CALC-RATE-PREM-X
  2629     END-IF
  2630
  2631     IF (CP-COMPANY-ID = 'CID') AND
  2632        (CP-EARN-AS-NET-PAY) AND
  2633        (CP-STATE-STD-ABBRV = 'TX') AND
  2634        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2635        (WS-DISCOUNT-OPTION NOT = ' ')
  2636        GO TO 9999-CALC-RATE-PREM-X
  2637     END-IF
  2638
  2639     if (cp-company-id = 'CID')
  2640        and (cp-state-std-abbrv = 'WA' or 'AL')
  2641        and (rt-discount-option = '1')
  2642        and (cp-earn-as-farm-plan)
  2643        go to 9999-calc-rate-prem-x
  2644     end-if
  2645     if (cp-company-id = 'CID')
  2646        and (cp-earn-as-reg-balloon)
  2647        and (cp-ben-category = 'P' or 'I')
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  51
* ELRATE.cbl
  2648        GO TO 9999-CALC-RATE-PREM-X
  2649     end-if
  2650     IF (CP-COMPANY-ID = 'CID')
  2651        AND (CP-STATE-STD-ABBRV = 'MN')
  2652        AND (RT-DISCOUNT-OPTION = '1')
  2653        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2654           CP-EARN-AS-FARM-PLAN)
  2655        GO TO 9999-CALC-RATE-PREM-X
  2656     END-IF
  2657     IF (CP-COMPANY-ID = 'CID')
  2658        AND (CP-EARN-AS-NET-PAY)
  2659        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2660                      OR
  2661            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2662        GO TO 9999-CALC-RATE-PREM-X
  2663     END-IF
  2664     IF (CP-COMPANY-ID = 'CID')
  2665        AND (CP-EARN-AS-NET-PAY)
  2666        AND (CP-STATE-STD-ABBRV = 'SC')
  2667        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2668        GO TO 9999-CALC-RATE-PREM-X
  2669     END-IF
  2670     IF (CP-COMPANY-ID = 'CID') AND
  2671        (CP-EARN-AS-NET-PAY) AND
  2672        (CP-TRUNCATED-LIFE) AND
  2673        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2674        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2675        (WS-DISCOUNT-OPTION NOT = ' ')
  2676        GO TO 9999-CALC-RATE-PREM-X
  2677     END-IF
  2678
  2679     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP') AND
  2680        (CP-EARN-AS-NET-PAY)
  2681        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2682        GO TO 9999-CALC-RATE-PREM-X
  2683     END-IF
  2684
  2685     IF (CP-COMPANY-ID EQUAL 'CID')
  2686        AND (CP-EARN-AS-NET-PAY)
  2687        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2688        GO TO 9999-CALC-RATE-PREM-X
  2689     END-IF
  2690
  2691     IF (RT-IS-OB) AND
  2692        (CP-COMPANY-ID NOT EQUAL 'CID')
  2693        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2694               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2695      ELSE
  2696         IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2697            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2698            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2699*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2700             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2701               CP-ORIGINAL-TERM
  2702             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2703             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2704        ELSE
  2705           COMPUTE CP-PREMIUM-RATE ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  52
* ELRATE.cbl
  2706               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2707        END-IF
  2708     END-IF
  2709
  2710     IF CP-ROA-PREM-AT-REFUND
  2711         COMPUTE NET-BEN ROUNDED =
  2712             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2713     ELSE
  2714         COMPUTE NET-BEN ROUNDED =
  2715              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2716
  2717     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2718        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2719          COMPUTE NET-BEN ROUNDED =
  2720              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2721                         (CP-TERM-OR-EXT-DAYS / 30)).
  2722
  2723     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2724*       OR 'DCC'
  2725*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2726     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2727       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2728       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2729                        * CP-ORIGINAL-TERM / 1200))
  2730     ELSE
  2731     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2732       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2733       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2734
  2735****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2736****** INTEREST IS CHARGED ON PREMIUM.
  2737
  2738*    IF CP-STATE-STD-ABBRV = 'MI'
  2739*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2740*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2741
  2742     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2743
  2744     GO TO 9999-CALC-RATE-PREM-X.
  2745
  2746******
  2747****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2748******
  2749
  2750 1250-CSL-CALC.
  2751     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2752     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2753     MOVE '1' TO DC-OPTION-CODE.
  2754     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2755
  2756     IF DATE-CONVERSION-ERROR
  2757         MOVE '2' TO CP-RETURN-CODE
  2758         GO TO 9999-CALC-RATE-PREM-X.
  2759
  2760     IF CP-JOINT-INDICATOR = 'J'
  2761         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2762     ELSE
  2763         MOVE RT-L-RATE (1) TO WK-RED-RATE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  53
* ELRATE.cbl
  2764
  2765     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2766     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2767
  2768     IF CP-PAY-FREQUENCY = 12
  2769         MOVE 01               TO WS-PAY-SCH.
  2770     IF CP-PAY-FREQUENCY = 04
  2771         MOVE 03               TO WS-PAY-SCH.
  2772     IF CP-PAY-FREQUENCY = 02
  2773         MOVE 06               TO WS-PAY-SCH.
  2774     IF CP-PAY-FREQUENCY = 01
  2775         MOVE 12               TO WS-PAY-SCH.
  2776
  2777     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2778     IF CP-PAY-FREQUENCY NOT = 12
  2779         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2780                                WS-NUM-PAYMTS.
  2781
  2782     IF CP-STATE = 'SC'  AND
  2783       (CP-BENEFIT-CD = '07'  OR  '08')
  2784         GO TO 1250-CSL-CALC-LIFE-6.
  2785
  2786     IF CP-CSL-METH-1
  2787         GO TO 1250-CSL-CALC-LIFE-1.
  2788
  2789     IF CP-CSL-METH-2
  2790         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2791                          WS-MAX-TOT-BEN
  2792             GO TO 1250-CSL-CALC-LIFE-2
  2793         ELSE
  2794             GO TO 1250-CSL-CALC-LIFE-1.
  2795
  2796     IF CP-CSL-METH-3
  2797         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2798             GO TO 1250-CSL-CALC-LIFE-2
  2799         ELSE
  2800             GO TO 1250-CSL-CALC-LIFE-3.
  2801
  2802     IF CP-CSL-METH-4
  2803         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2804                          WS-MAX-TOT-BEN
  2805             GO TO 1250-CSL-CALC-LIFE-5
  2806         ELSE
  2807             GO TO 1250-CSL-CALC-LIFE-4.
  2808
  2809 1250-CSL-CALC-LIFE-1.
  2810     IF CP-JOINT-INDICATOR = 'J'
  2811         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2812     ELSE
  2813         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2814
  2815     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2816                    365) - 1) * 365 / 12.
  2817     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2818                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2819                    4380.
  2820     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2821                    WS-NUM-PAYMTS * WK-S.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  54
* ELRATE.cbl
  2822
  2823     GO TO 9999-CALC-RATE-PREM-X.
  2824
  2825 1250-CSL-CALC-LIFE-2.
  2826     IF CP-JOINT-INDICATOR = 'J'
  2827         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2828     ELSE
  2829         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2830
  2831     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2832     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2833     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2834                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2835                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2836     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2837                    WK-S) + WK-D.
  2838
  2839     GO TO 9999-CALC-RATE-PREM-X.
  2840
  2841 1250-CSL-CALC-LIFE-3.
  2842     IF CP-JOINT-INDICATOR = 'J'
  2843         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2844     ELSE
  2845         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2846
  2847     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2848     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2849     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2850                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2851                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2852     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2853                    WK-S) + WK-D.
  2854
  2855     GO TO 9999-CALC-RATE-PREM-X.
  2856
  2857 1250-CSL-CALC-LIFE-4.
  2858     IF CP-JOINT-INDICATOR = 'J'
  2859         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2860     ELSE
  2861         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2862
  2863     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2864     COMPUTE WK-S ROUNDED =
  2865                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2866                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2867                    CP-PAY-FREQUENCY.
  2868     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2869                    WS-NUM-PAYMTS * WK-S.
  2870
  2871     GO TO 9999-CALC-RATE-PREM-X.
  2872
  2873 1250-CSL-CALC-LIFE-5.
  2874     IF CP-JOINT-INDICATOR = 'J'
  2875         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2876     ELSE
  2877         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2878
  2879     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  55
* ELRATE.cbl
  2880     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2881                    CP-PAY-FREQUENCY.
  2882     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2883                    - 1) + WS-NUM-PAYMTS) * 12) /
  2884                    CP-PAY-FREQUENCY.
  2885     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2886     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2887                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2888
  2889     GO TO 9999-CALC-RATE-PREM-X.
  2890
  2891 1250-CSL-CALC-LIFE-6.
  2892
  2893     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2894                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2895
  2896     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2897                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2898
  2899     GO TO 9999-CALC-RATE-PREM-X.
  2900
  2901******
  2902****** END OF PREMIUM CALCULATIONS FOR CSL
  2903******
  2904
  2905 1260-GTL-PA-LEASE.
  2906
  2907     IF CP-REDUCING-LIFE
  2908         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2909                                 TO  CP-PREMIUM-RATE
  2910         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2911                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2912     ELSE
  2913         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2914                                 TO  CP-PREMIUM-RATE
  2915         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2916                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2917                 (+1 + CP-SALES-TAX) / +100.
  2918
  2919     GO TO 9999-CALC-RATE-PREM-X.
  2920
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  56
* ELRATE.cbl
  2922******************************************************************
  2923 2000-TYPE-IS-AH.
  2924     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2925
  2926     MOVE ZERO                      TO CP-R-MAX-AGE
  2927                                       CP-R-MAX-TERM
  2928                                       CP-R-MAX-MON-BEN
  2929                                       CP-R-MAX-TOT-BEN.
  2930
  2931     IF RT-CANCEL-FEE NUMERIC
  2932        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  2933
  2934     IF RT-COMPOSITE-RATE NOT NUMERIC
  2935        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2936
  2937     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2938        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2939                                 TO CP-PREMIUM-RATE
  2940                                    WS-PREMIUM-RATE
  2941        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2942     ELSE
  2943         MOVE +0                 TO CP-PREMIUM-RATE
  2944                                    CP-CALC-PREMIUM
  2945         GO TO 9999-CALC-RATE-PREM-X
  2946     END-IF
  2947
  2948     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2949        AND (CP-DDF-SPEC-CALC = 'T')
  2950        AND (CP-LOAN-TERM > ZERO AND < 361)
  2951        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2952                                 TO CP-PREMIUM-RATE
  2953                                    WS-PREMIUM-RATE
  2954     END-IF
  2955*    IF (CP-COMPANY-ID = 'DCC')
  2956*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2957*       OR (CP-DDF-SPEC-CALC = 'T'))
  2958*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2959*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2960*                                TO CP-PREMIUM-RATE
  2961*                                   WS-PREMIUM-RATE
  2962*    END-IF
  2963     MOVE +1 TO AHNDX.
  2964
  2965     IF CP-COMPANY-ID EQUAL 'CRI'
  2966        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2967           MOVE +5               TO AHNDX
  2968           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2969              MOVE 'F'           TO CP-RETURN-CODE
  2970              GO TO 2200-CALCULATE-PREMIUMS.
  2971
  2972     IF RT-AH-AGE (AHNDX) = ZERO
  2973          GO TO 2200-CALCULATE-PREMIUMS.
  2974
  2975 2100-SEARCH-AH-LIMITS.
  2976
  2977     IF CP-COMPANY-ID EQUAL 'CRI'
  2978        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2979           IF AHNDX GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  57
* ELRATE.cbl
  2980              MOVE 'A'             TO CP-RETURN-CODE
  2981              GO TO 2200-CALCULATE-PREMIUMS.
  2982
  2983     IF AHNDX GREATER +8
  2984         MOVE 'A'                TO CP-RETURN-CODE
  2985         GO TO 2200-CALCULATE-PREMIUMS.
  2986
  2987     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2988         IF RT-AH-AGE (AHNDX) = ZEROS
  2989             ADD +1               TO AHNDX
  2990             GO TO 2100-SEARCH-AH-LIMITS
  2991         ELSE
  2992             MOVE RT-AH-AGE (AHNDX)
  2993                                 TO CP-R-MAX-AGE
  2994             MOVE RT-AH-TERM (AHNDX)
  2995                                 TO CP-R-MAX-TERM
  2996             MOVE RT-AH-BEN-M (AHNDX)
  2997                                 TO CP-R-MAX-MON-BEN
  2998             ADD +1               TO AHNDX
  2999             GO TO 2100-SEARCH-AH-LIMITS
  3000     ELSE
  3001         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  3002         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  3003         MOVE RT-AH-BEN-M (AHNDX)
  3004                                 TO CP-R-MAX-MON-BEN.
  3005
  3006     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  3007         MOVE '9'                 TO CP-RETURN-CODE.
  3008
  3009     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  3010         MOVE '8'                 TO CP-RETURN-CODE.
  3011
  3012     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  3013         GIVING WS-AH-FACE-BENEFIT.
  3014
  3015     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  3016         MOVE 'C'                 TO CP-RETURN-CODE.
  3017
  3018 2200-CALCULATE-PREMIUMS.
  3019
  3020     IF CP-COMPANY-ID = 'CSL'
  3021         GO TO 2250-CSL-CALC.
  3022
  3023*    IF CP-CRITICAL-PERIOD
  3024*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  3025
  3026     IF CP-CRITICAL-PERIOD
  3027        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3028           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  3029               OR 'S' OR 'P')
  3030                          OR
  3031                (CP-BEN-CATEGORY = 'G' OR 'L'))
  3032           CONTINUE
  3033        ELSE
  3034           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  3035        END-IF
  3036     END-IF
  3037
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  58
* ELRATE.cbl
  3038     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3039        AND (CP-BEN-CATEGORY = 'D')
  3040        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  3041           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  3042     END-IF
  3043     IF (CP-COMPANY-ID = 'CID')
  3044        AND (CP-STATE-STD-ABBRV = 'AL')
  3045        and (cp-pmt-mode <> ' ')
  3046        continue
  3047     else
  3048        go to 2200-continue
  3049     end-if
  3050
  3051     evaluate true
  3052        when cp-pmt-mode = 'B' *> Bi-Weekly
  3053           move 26               to c-pmts-per-year
  3054           move 14               to c-days-in-pmt-per
  3055        when cp-pmt-mode = 'W' *> Weekly
  3056           move 52               to c-pmts-per-year
  3057           move 07               to c-days-in-pmt-per
  3058        when cp-pmt-mode = 'S' *> Semi-Monthly
  3059           move 24               to c-pmts-per-year
  3060           move 15               to c-days-in-pmt-per
  3061        when cp-pmt-mode = 'A' *> Annual
  3062           move 1                to c-pmts-per-year
  3063           move 360              to c-days-in-pmt-per
  3064        when cp-pmt-mode = 'T' *> Semi-Annual
  3065           move 2                to c-pmts-per-year
  3066           move 180              to c-days-in-pmt-per
  3067        when cp-pmt-mode = 'Q' *> Quarterly
  3068           move 4                to c-pmts-per-year
  3069           move 90               to c-days-in-pmt-per
  3070        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  3071           move 6                to c-pmts-per-year
  3072           move 60               to c-days-in-pmt-per
  3073        when other             *> Assume Monthly
  3074           move 12               to c-pmts-per-year
  3075           move 30               to c-days-in-pmt-per
  3076     end-evaluate
  3077
  3078     compute c-tot-pmts =
  3079        cp-original-term / 12 * c-pmts-per-year
  3080
  3081     compute wk7 rounded =    *> tv3
  3082        (cp-original-benefit * +12) / c-pmts-per-year
  3083
  3084     compute wk6 rounded =
  3085        (wk7 * c-tot-pmts / 100) * cp-premium-rate
  3086
  3087     move wk6                    to cp-calc-premium
  3088
  3089     GO TO 9999-CALC-RATE-PREM-X
  3090
  3091     .
  3092 2200-continue.
  3093     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  3094        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  3095        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  59
* ELRATE.cbl
  3096                                     CP-PREMIUM-RATE
  3097        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  3098        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  3099        CP-PREMIUM-RATE) / +100
  3100     ELSE
  3101        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3102           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  3103           MOVE CP-PREMIUM-RATE  TO WK-S
  3104*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  3105           IF CP-RATE-DEV-PCT NOT = ZEROS
  3106              COMPUTE WK-S ROUNDED =
  3107                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  3108           END-IF
  3109           IF CP-BENEFIT-CD (1:1) = 'M'
  3110              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3111              CP-ORIGINAL-BENEFIT * WK-S / 100
  3112           ELSE
  3113              IF CP-BENEFIT-CD (1:1) = 'H'
  3114                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3115                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3116                    WK-S) / 1000
  3117              ELSE
  3118                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  3119                    GO TO 2300-CALC-DCC-MOB-NET-AH
  3120                 ELSE
  3121                    IF CP-BEN-CATEGORY = 'D'
  3122                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3123                        CP-ORIGINAL-BENEFIT *
  3124                        CP-ORIGINAL-TERM * WK-S / 100
  3125                    ELSE
  3126                      IF CP-BENEFIT-CD (1:1) = 'P'
  3127                         GO TO 2300-CALC-DCC-BEN-P-AH
  3128                      ELSE
  3129                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3130                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3131                        WK-S) / 100
  3132                      END-IF
  3133                    END-IF
  3134                 END-IF
  3135              END-IF
  3136           END-IF
  3137           MOVE ZEROS            TO CP-RATE-DEV-PCT
  3138        ELSE
  3139           IF CP-BENEFIT-CD (1:1) = 'M'
  3140              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3141                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  3142           ELSE
  3143              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  3144                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3145                    (CP-NET-BENEFIT-AMT *
  3146                    CP-PREMIUM-RATE) / 1000
  3147              ELSE
  3148                 IF CP-AH-BALLOON-SW = 'Y'
  3149                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  3150                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  3151                      CP-PREMIUM-RATE) / 100
  3152                 ELSE
  3153                   COMPUTE CP-CALC-PREMIUM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  60
* ELRATE.cbl
  3154                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  3155                    CP-PREMIUM-RATE) / 100
  3156                 END-IF
  3157              END-IF
  3158           END-IF
  3159        END-IF
  3160     END-IF
  3161
  3162     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3163        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3164        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3165     END-IF
  3166     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3167         GO TO 9999-CALC-RATE-PREM-X.
  3168
  3169     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3170         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3171             CP-CALC-PREMIUM +
  3172                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3173                                       * CP-TERM-OR-EXT-DAYS).
  3174
  3175     GO TO 9999-CALC-RATE-PREM-X.
  3176
  3177 2200-CRITICAL-PERIOD-AH-CONT.
  3178
  3179     IF CP-COMPANY-ID = 'WDS'
  3180         IF CP-ORIGINAL-TERM GREATER THAN 60
  3181             MOVE 60              TO CP-LOAN-TERM.
  3182
  3183     IF CP-COMPANY-ID EQUAL 'CVL'
  3184         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3185           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3186                                       * CP-PREMIUM-RATE
  3187         GO TO 9999-CALC-RATE-PREM-X.
  3188
  3189     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3190           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3191                                       * CP-PREMIUM-RATE.
  3192
  3193     GO TO 9999-CALC-RATE-PREM-X.
  3194
  3195 2250-CSL-CALC.
  3196
  3197     IF RT-DAILY-RATE NOT NUMERIC OR
  3198        RT-DAILY-RATE = ZEROS
  3199            MOVE ZEROS TO CP-CALC-PREMIUM
  3200            MOVE '7' TO CP-RETURN-CODE
  3201            GO TO 9999-CALC-RATE-PREM-X.
  3202
  3203     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3204     COMPUTE WK-MONTHLY-RATE =
  3205          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3206
  3207     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3208     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3209     MOVE '1' TO DC-OPTION-CODE.
  3210     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3211     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  61
* ELRATE.cbl
  3212         MOVE '2' TO CP-RETURN-CODE
  3213         GO TO 9999-CALC-RATE-PREM-X.
  3214
  3215     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3216     IF CP-CSL-METH-1
  3217         GO TO 2250-CSL-CALC-AH-1.
  3218     IF CP-CSL-METH-2
  3219         GO TO 2250-CSL-CALC-AH-2.
  3220     IF CP-CSL-METH-3
  3221         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3222             GO TO 2250-CSL-CALC-AH-4
  3223         ELSE
  3224             GO TO 2250-CSL-CALC-AH-3.
  3225
  3226 2250-CSL-CALC-AH-1.
  3227
  3228     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3229     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3230                    + WK-MONTHLY-RATE.
  3231     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3232                    CP-ORIGINAL-TERM * WK-D.
  3233
  3234     GO TO 9999-CALC-RATE-PREM-X.
  3235
  3236
  3237 2250-CSL-CALC-AH-2.
  3238     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3239     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3240                    + WK-MONTHLY-RATE.
  3241     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3242                    CP-ORIGINAL-TERM * WK-D.
  3243
  3244     GO TO 9999-CALC-RATE-PREM-X.
  3245
  3246 2250-CSL-CALC-AH-3.
  3247
  3248     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3249     COMPUTE WK-T = WK-K + 1.
  3250     COMPUTE WK-MONTHLY-RATE-T =
  3251          RT-AH-RATE (WK-T) / 100.
  3252     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3253
  3254     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3255     IF WK-T1 EQUAL ZEROS
  3256         MOVE ZEROS TO CP-CALC-PREMIUM
  3257         MOVE 'G' TO CP-RETURN-CODE
  3258         GO TO 9999-CALC-RATE-PREM-X.
  3259
  3260     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3261                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3262                    - WK-T)).
  3263     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3264     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3265                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3266                       WS-MAX-TOT-BEN).
  3267     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3268                    WK-MONTHLY-RATE-T) + WK-PREM.
  3269
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  62
* ELRATE.cbl
  3270     GO TO 9999-CALC-RATE-PREM-X.
  3271
  3272 2250-CSL-CALC-AH-4.
  3273     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3274     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3275     COMPUTE WK-MONTHLY-RATE-J =
  3276          RT-AH-RATE (WK-J) / 100.
  3277     COMPUTE WK-T = WK-J + 1.
  3278     COMPUTE WK-MONTHLY-RATE-T =
  3279          RT-AH-RATE (WK-T) / 100.
  3280     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3281     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3282                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3283                    (CP-ORIGINAL-TERM - WK-T)).
  3284     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3285     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3286                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3287                       WS-MAX-TOT-BEN).
  3288     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3289                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3290
  3291     GO TO 9999-CALC-RATE-PREM-X.
  3292
  3293 2300-CALC-DCC-BEN-P-AH.
  3294     IF CP-NO-OF-PMTS NOT NUMERIC
  3295        MOVE +0                  TO CP-NO-OF-PMTS
  3296     END-IF
  3297     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3298        AND ' ' AND 'M'
  3299        MOVE ' '                 TO CP-PMT-MODE
  3300     END-IF
  3301******************************************************************
  3302***   Default is monthly, use loan term for rate and amort     ***
  3303******************************************************************
  3304     move cp-loan-term         to c-tot-pmts
  3305     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3306     MOVE +12                  TO C-PMTS-PER-YEAR
  3307******************************************************************
  3308
  3309     evaluate true
  3310        when cp-pmt-mode = 'W'
  3311           MOVE +52              TO C-PMTS-PER-YEAR
  3312           compute c-tot-pmts = cp-loan-term /
  3313              12 * c-pmts-per-year
  3314           MOVE +7               TO C-DAYS-IN-PMT-PER
  3315        when cp-pmt-mode = 'B'
  3316           MOVE +26              TO C-PMTS-PER-YEAR
  3317           compute c-tot-pmts = cp-loan-term /
  3318              12 * c-pmts-per-year
  3319           MOVE +14              TO C-DAYS-IN-PMT-PER
  3320     end-evaluate
  3321     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3322     if i = zeros
  3323        move .0000000001         to i
  3324     end-if
  3325     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3326        C-DAYS-IN-PMT-PER)) / (1 + I)
  3327     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  63
* ELRATE.cbl
  3328     COMPUTE ANGLEN-1 = ANGLEN / Y
  3329     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3330        / ANGLEN-1
  3331     if cp-net-benefit-amt = zeros
  3332        compute wk3 = cp-original-benefit - cp-original-premium
  3333     end-if
  3334     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3335     GO TO 9999-CALC-RATE-PREM-X
  3336     .
  3337 2300-CALC-DCC-MOB-NET-AH.
  3338     IF CP-ALTERNATE-BENEFIT = ZEROS
  3339        CONTINUE
  3340     ELSE
  3341        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3342     END-IF
  3343     MOVE CP-ORIGINAL-TERM       TO M
  3344     MOVE CP-LOAN-TERM           TO N
  3345     IF N = ZEROS
  3346        MOVE M                   TO N
  3347     END-IF
  3348     COMPUTE I = CP-LOAN-APR / +1200
  3349     if i = zeros
  3350        move .0000000001         to i
  3351     end-if
  3352     IF CP-BENEFIT-CD (1:1) = 'S'
  3353        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3354        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3355        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3356          (WK-S / 1000)
  3357          * 1
  3358        MOVE WK3                 TO CP-CALC-PREMIUM
  3359        GO TO 9999-CALC-RATE-PREM-X
  3360     END-IF
  3361     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3362        / (1 + I)
  3363     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3364          ** ((N - M) * -1))) / I)
  3365     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3366     COMPUTE J = I + (WK-S / +1000)
  3367     COMPUTE WK2 = (1 + J) ** (M * -1)
  3368     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3369     COMPUTE ANGLEM = ((1 - ((1 + J)
  3370          ** (M * -1))) / J) / OD
  3371     IF CP-NET-BENEFIT-AMT = ZEROS
  3372        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3373           * ANGLEM
  3374     END-IF
  3375     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3376     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3377          ** ((N - M) * -1))) / I)
  3378     MOVE +0                     TO WK3
  3379     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3380        (WS-COUNTER > M)
  3381        COMPUTE ANGLEM = (1 - ((1 + J)
  3382          ** ((M - WS-COUNTER + 1) * -1))) / J
  3383        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3384        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3385        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  64
* ELRATE.cbl
  3386     END-PERFORM
  3387     MOVE WK3                    TO CP-CALC-PREMIUM
  3388     GO TO 9999-CALC-RATE-PREM-X
  3389     .
  3390 2300-CALC-DCC-MOB-BAL-AH.
  3391     IF CP-BENEFIT-CD (1:1) = 'S'
  3392        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3393     END-IF
  3394     MOVE CP-ORIGINAL-TERM       TO M
  3395     MOVE CP-LOAN-TERM           TO N
  3396     IF N = ZEROS
  3397        MOVE M                   TO N
  3398     END-IF
  3399     COMPUTE I = CP-LOAN-APR / +1200
  3400     if i = zeros
  3401        move .0000000001         to i
  3402     end-if
  3403     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3404        / (1 + I)
  3405     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3406     COMPUTE J = I + (WK-S / +1000)
  3407     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3408     MOVE I TO K
  3409     COMPUTE WK2 = (1 + J) ** (M * -1)
  3410     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3411     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3412          ** ((M - 1) * -1))) / J)
  3413     COMPUTE ANGLEM = ((1 - ((1 + J)
  3414          ** (M * -1))) / J) / OD
  3415     IF CP-NET-BENEFIT-AMT = ZEROS
  3416        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3417           * ANGLEM
  3418     END-IF
  3419     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3420        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3421        / ANGLEM-1
  3422     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3423          ** ((N - M) * -1))) / I)
  3424     MOVE +0                     TO WK3
  3425     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3426        (WS-COUNTER > M)
  3427        COMPUTE ANGLEM = (1 - ((1 + J)
  3428          ** ((M - WS-COUNTER) * -1))) / J
  3429        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3430        COMPUTE WK5-CSL = (RA * ANGLEM)
  3431        + (CP-ALTERNATE-BENEFIT * WK2)
  3432        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3433          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3434          (WK-S / 1000)
  3435     END-PERFORM
  3436     MOVE WK3                    TO CP-CALC-PREMIUM
  3437     GO TO 9999-CALC-RATE-PREM-X
  3438     .
  3439 2300-CALC-DCC-MOB-BAL-AHSUM.
  3440     MOVE CP-ORIGINAL-TERM       TO M
  3441     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3442        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3443        * WK-S / 1000
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  65
* ELRATE.cbl
  3444*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3445*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3446*       * WK-S / 1000
  3447     MOVE WK3                    TO CP-CALC-PREMIUM
  3448     GO TO 9999-CALC-RATE-PREM-X
  3449     .
  3450 9999-RATE-NOTFND.
  3451     MOVE '6'                    TO CP-RETURN-CODE.
  3452     GO TO 9999-CALC-RATE-PREM-X.
  3453
  3454 9999-RATE-NOTOPEN.
  3455     MOVE 'D'                    TO CP-RETURN-CODE.
  3456     GO TO 9999-CALC-RATE-PREM-X.
  3457
  3458 9999-CALC-RATE-PREM-X.
  3459     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3460        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3461        CONTINUE
  3462     ELSE
  3463        IF CP-RATE-DEV-PCT NOT = ZERO
  3464           COMPUTE CP-CALC-PREMIUM =
  3465              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3466
  3467
  3468     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3469
  3470     IF WS-BROWSE-STARTED
  3471
  3472* EXEC CICS ENDBR
  3473*            DATASET  (ERRATE-FILE-ID)
  3474*       END-EXEC.
  3475     MOVE 0
  3476       TO DFHEIV11
  3477*    MOVE '&2                    $   #00003430' TO DFHEIV0
  3478     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3479     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3480     MOVE X'2020233030303033343330' TO DFHEIV0(25:11)
  3481     CALL 'kxdfhei1' USING DFHEIV0,
  3482           ERRATE-FILE-ID,
  3483           DFHEIV11,
  3484           DFHEIV99
  3485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3486
  3487
  3488
  3489* EXEC CICS RETURN
  3490*    END-EXEC.
  3491*    MOVE '.(                    ''   #00003434' TO DFHEIV0
  3492     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3493     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3494     MOVE X'2020233030303033343334' TO DFHEIV0(25:11)
  3495     CALL 'kxdfhei1' USING DFHEIV0,
  3496           DFHEIV99,
  3497           DFHEIV99,
  3498           DFHEIV99,
  3499           DFHEIV99,
  3500           DFHEIV99,
  3501           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  66
* ELRATE.cbl
  3502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3503
  3504
  3505 9100-CONVERT-DATE.
  3506
  3507* EXEC CICS LINK
  3508*        PROGRAM  ('ELDATCV')
  3509*        COMMAREA (DATE-CONVERSION-DATA)
  3510*        LENGTH   (DC-COMM-LENGTH)
  3511*    END-EXEC.
  3512     MOVE 'ELDATCV' TO DFHEIV1
  3513*    MOVE '."C                   (   #00003438' TO DFHEIV0
  3514     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3516     MOVE X'2020233030303033343338' TO DFHEIV0(25:11)
  3517     CALL 'kxdfhei1' USING DFHEIV0,
  3518           DFHEIV1,
  3519           DATE-CONVERSION-DATA,
  3520           DC-COMM-LENGTH,
  3521           DFHEIV99,
  3522           DFHEIV99,
  3523           DFHEIV99,
  3524           DFHEIV99
  3525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3526
  3527
  3528 9100-EXIT.
  3529     EXIT.
  3530
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  67
* ELRATE.cbl
  3532 10000-NET-TERM SECTION.
  3533*                         COPY ERCNETP.
  3534*****************************************************************
  3535*                                                               *
  3536*                            ERCNETP                            *
  3537*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3538*                            VMOD=2.029                         *
  3539*                                                               *
  3540*****************************************************************.
  3541*
  3542*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3543*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3544*                                   ORIGINAL TERM (S999)
  3545*                                   REMAINING TERM (S999)
  3546*                                   NET PAY OPTION (X)
  3547*                                   LOAN TERM (S999)
  3548*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3549*
  3550*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3551*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3552*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3553*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3554*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3555*    CHARGED.
  3556*
  3557*    OPTIONS - S = NET SIMPLE
  3558*          SPACE = NET PAY  (1 MO. INTEREST)
  3559*              A = NET PAY  (0 MO. INTEREST)
  3560*              I = NET PAY  (2 MO. INTEREST)
  3561*              J = NET PAY  (3 MO. INTEREST)
  3562*              K = NET PAY  (4 MO. INTEREST)
  3563*              T = TRUNCATED  (0 MO. INTEREST)
  3564*              U = TRUNCATED  (1 MO. INTEREST)
  3565*              V = TRUNCATED  (2 MO. INTEREST)
  3566*              W = TRUNCATED  (3 MO. INTEREST)
  3567*              X = TRUNCATED  (4 MO. INTEREST)
  3568*              R = REFUNDS (REGULAR OR TRUNCATED)
  3569******************************************************************
  3570*                   C H A N G E   L O G
  3571*
  3572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3573*-----------------------------------------------------------------
  3574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3575* EFFECTIVE    NUMBER
  3576*-----------------------------------------------------------------
  3577* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3578* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3579* 120403                   PEMA  ADD SPECIAL TX CALC
  3580* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3581* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3582* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3583* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3584* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3585* 021207                   PEMA  ADD PA NP
  3586* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3587* 032807                   PEMA  ADD VT NP PLUS 2
  3588* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3589* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  68
* ELRATE.cbl
  3590* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3591* 110207      TO 'AL' NET PAY CALC
  3592* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3593* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3594* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3595* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3596* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3597* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3598* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3599* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3600* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3601* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3602* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3603* 032612  CR2011110200001  PEMA  AHL CHANGES
  3604* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3605* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3606* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3607* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3608* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOON
  3609* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3610* 021519  CR2019021100001  PEMA  non-monthly AL calcs
  3611******************************************************************
  3612
  3613     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3614     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3615     MOVE N-P-LOAN    TO LOAN-TERM.
  3616     MOVE N-P-REM     TO REMAINING-TERM.
  3617     MOVE N-P-OPT     TO OPTION-SW.
  3618
  3619     MOVE +0 TO FACTOR.
  3620     if cp-company-id = 'CID'
  3621        if annual-int-rate = +99.9999
  3622           go to 99000-error
  3623        end-if
  3624     else
  3625        if annual-int-rate = zero
  3626           go to 99000-error
  3627        end-if
  3628     end-if
  3629     IF ORIGINAL-TERM = ZERO
  3630         GO TO 99999-RETURN.
  3631     IF REMAINING-TERM = ZERO
  3632         GO TO 99999-RETURN.
  3633     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3634         GO TO 99000-ERROR.
  3635     IF LOAN-TERM = ZERO
  3636         GO TO 99999-RETURN.
  3637     IF LOAN-TERM LESS ORIGINAL-TERM
  3638         GO TO 99000-ERROR.
  3639
  3640*    IF ANNUAL-INT-RATE LESS +2
  3641*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3642*    IF ANNUAL-INT-RATE LESS +2
  3643*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3644*    IF ANNUAL-INT-RATE LESS +2
  3645*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3646
  3647     IF NPO-REFUND
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  69
* ELRATE.cbl
  3648         MOVE '2' TO NP-PROCESS-SW
  3649       ELSE
  3650         IF ORIGINAL-TERM = REMAINING-TERM
  3651            MOVE '1'   TO NP-PROCESS-SW
  3652           ELSE
  3653            MOVE '3'   TO NP-PROCESS-SW.
  3654
  3655     IF NPO-SIMPLE
  3656         MOVE 'S' TO TYPE-SW
  3657     ELSE
  3658         MOVE 'N' TO TYPE-SW.
  3659
  3660     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3661     if i = zeros
  3662        move .0000000001         to i
  3663     end-if
  3664
  3665     COMPUTE V ROUNDED = K1 / (K1 + I).
  3666
  3667     MOVE V     TO VX
  3668                   SV.
  3669
  3670     MOVE +1    TO X1
  3671                   SX.
  3672
  3673     MOVE LOAN-TERM TO MAX-X.
  3674
  3675     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3676
  3677     IF MAX-X = +1
  3678        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3679
  3680     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3681
  3682     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3683         OR 'DCC' or 'VPP' OR 'NCL') AND
  3684        (NOT NP-REFUND)
  3685        NEXT SENTENCE
  3686     ELSE
  3687     IF LOAN-TERM NOT = ORIGINAL-TERM
  3688        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3689
  3690     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3691
  3692 10500-VX-LOOP.
  3693
  3694***  VX = AMORT. LOAN TERM.
  3695***  SV = AMORT. INSURANCE TERM.
  3696***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3697***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3698***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3699
  3700     IF X2 = 1
  3701        MOVE V         TO SX
  3702     END-IF
  3703     COMPUTE VX ROUNDED = VX * V.
  3704
  3705     ADD B1 TO X1.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  70
* ELRATE.cbl
  3706
  3707     IF X1 = REMAINING-TERM
  3708          MOVE VX    TO SV.
  3709
  3710     IF X1 EQUAL SV-MINUS-ONE
  3711        MOVE VX      TO SV-MINUS-ONE.
  3712
  3713     IF X1 = X2
  3714          MOVE VX    TO SX.
  3715
  3716     IF X1 NOT = MAX-X
  3717          GO TO 10500-VX-LOOP.
  3718
  3719 10700-COMPUTE-REMAINING-FACTOR.
  3720*****  WK1 = LOAN TERM AMORT
  3721     COMPUTE WK1 = K1 - VX.
  3722*****  WK2 = INS TERM AMORT
  3723     COMPUTE WK2 = K1 - SV.
  3724*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3725     COMPUTE WK5 = K1 - SX.
  3726*****  WK6 = INS TERM - 1
  3727     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3728
  3729     IF NP-RATING
  3730         GO TO 12000-PREMIUM-RATE.
  3731
  3732     IF NP-REFUND
  3733         GO TO 11000-REFUND-CALC.
  3734
  3735     IF NET-STD
  3736         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3737
  3738     IF NET-SMP
  3739         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3740         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3741         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3742         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3743
  3744     IF REMAINING-TERM LESS THAN X2
  3745         MOVE +0 TO WK3.
  3746
  3747     MOVE WK3 TO FACTOR.
  3748
  3749     GO TO 99999-RETURN.
  3750
  3751 11000-REFUND-CALC.
  3752     IF REMAINING-TERM NOT LESS MAX-X
  3753        MOVE +1 TO FACTOR
  3754        GO TO 99999-RETURN.
  3755
  3756     IF REMAINING-TERM LESS +1
  3757        MOVE 0 TO FACTOR
  3758        GO TO 99999-RETURN.
  3759
  3760     COMPUTE WK2 ROUNDED = WK2 / I.
  3761     COMPUTE WK5 ROUNDED = WK5 / I.
  3762     COMPUTE WK1 ROUNDED = WK1 / I.
  3763
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  71
* ELRATE.cbl
  3764     IF (CP-COMPANY-ID EQUAL 'CID')
  3765        AND (CP-STATE-STD-ABBRV = 'MN')
  3766        AND (CP-CERT-EFF-DT > X'A4FF')
  3767        AND (CP-RATE-AS-REG-BALLOON)
  3768        AND (CP-EARN-AS-NET-PAY)
  3769        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3770        CONTINUE
  3771     ELSE
  3772        GO TO 11000-CHECK-MN-LEV-BALLOON
  3773     END-IF
  3774
  3775     COMPUTE R = M - E
  3776     COMPUTE FACTOR = (R - WK2 + WK5) /
  3777        (M - WK1 + WK5)
  3778
  3779     GO TO 99999-RETURN
  3780
  3781      .
  3782 11000-CHECK-MN-LEV-BALLOON.
  3783
  3784     IF (CP-COMPANY-ID EQUAL 'CID')
  3785        AND (CP-STATE-STD-ABBRV = 'MN')
  3786        AND (CP-CERT-EFF-DT > X'A4FF')
  3787        AND (CP-RATE-AS-REG-BALLOON)
  3788        AND (CP-EARN-AS-NET-PAY)
  3789        AND (CP-DEVIATION-CODE = 'LEV')
  3790        CONTINUE
  3791     ELSE
  3792        GO TO 11000-CONTINUE-REFUND
  3793     END-IF
  3794
  3795     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3796     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3797        ** (M - E)) / I
  3798
  3799     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3800
  3801     GO TO 99999-RETURN
  3802
  3803     .
  3804 11000-CONTINUE-REFUND.
  3805*    IF CP-GAP-ACTUARIAL
  3806*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3807*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3808*       COMPUTE WK3 = WK2 / ANGLEN
  3809*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3810     IF CP-GAP-ACTUARIAL
  3811        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3812           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3813        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3814     ELSE
  3815        COMPUTE WK3 ROUNDED =
  3816          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3817     END-IF
  3818
  3819     MOVE WK3  TO FACTOR.
  3820
  3821     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  72
* ELRATE.cbl
  3822
  3823 12000-PREMIUM-RATE.
  3824*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3825*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3826*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3827*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3828*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3829*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3830
  3831     COMPUTE K-I = K1 + I.
  3832     MOVE K-I TO ONE-PLUS-I.
  3833
  3834     IF NPO-ALT OR NPO-TRUNC-0
  3835         MOVE K1 TO K-I.
  3836
  3837     IF NPO-2MO OR NPO-TRUNC-2
  3838         COMPUTE K-I = K1 + (2 * I).
  3839
  3840     IF NPO-3MO OR NPO-TRUNC-3
  3841         COMPUTE K-I = K1 + (3 * I).
  3842
  3843     IF NPO-4MO OR NPO-TRUNC-4
  3844         COMPUTE K-I = K1 + (4 * I).
  3845
  3846     COMPUTE RA ROUNDED = 1 -
  3847             ((X2 * (X2 + 1)) /
  3848              (N *  (N  + 1))).
  3849
  3850     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3851        (CP-CSL-VALID-NP-BENEFIT-CD)
  3852        NEXT SENTENCE
  3853     ELSE
  3854        GO TO XXXX-CHECK-DISCOUNT-5.
  3855
  3856     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3857     MOVE ' ' TO DC-OPTION-CODE.
  3858     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3859
  3860     IF DATE-CONVERSION-ERROR
  3861        MOVE '2'                 TO CP-RETURN-CODE
  3862        MOVE ZEROS               TO FACTOR
  3863                                    CP-CALC-PREMIUM
  3864         GO TO 99999-RETURN.
  3865
  3866     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3867     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3868     MOVE ' ' TO DC-OPTION-CODE
  3869     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3870
  3871     IF DATE-CONVERSION-ERROR
  3872        MOVE '2'                 TO CP-RETURN-CODE
  3873        MOVE ZEROS               TO FACTOR
  3874                                    CP-CALC-PREMIUM
  3875         GO TO 99999-RETURN.
  3876
  3877     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3878
  3879     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  73
* ELRATE.cbl
  3880
  3881     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3882        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3883        CP-PAY-FREQUENCY / 365) * I
  3884     ELSE
  3885        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3886        CP-PAY-FREQUENCY / 365) * I.
  3887
  3888     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3889     13).
  3890
  3891     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3892     (N - ( ANGLEN-1 / WK3)).
  3893
  3894     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3895
  3896     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3897       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3898
  3899     COMPUTE WS-Y-X-FACTOR EQUAL
  3900       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3901       WS-CALC-FREQ-RATE).
  3902
  3903     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3904       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3905
  3906     COMPUTE WS-X-Y-FACTOR EQUAL
  3907       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3908
  3909     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3910       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3911       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3912
  3913     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3914
  3915     GO TO 99999-RETURN.
  3916
  3917 XXXX-CHECK-DISCOUNT-5.
  3918
  3919     IF WS-DISCOUNT-OPTION EQUAL '5'
  3920        NEXT SENTENCE
  3921     ELSE
  3922        GO TO 12000-CHECK-CLIENT.
  3923
  3924      COMPUTE ANGLEN EQUAL WK1 / I.
  3925
  3926      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3927
  3928      COMPUTE WK3 EQUAL
  3929        (12 *
  3930        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3931        CP-ORIGINAL-BENEFIT)) /
  3932        APR100.
  3933
  3934     COMPUTE WK3 EQUAL
  3935        (WK3 * CP-PREMIUM-RATE) / +1000.
  3936
  3937     COMPUTE WK3 EQUAL
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  74
* ELRATE.cbl
  3938        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3939
  3940      MOVE WK3 TO CP-CALC-PREMIUM.
  3941
  3942     GO TO 99999-RETURN.
  3943
  3944 12000-CHECK-CLIENT.
  3945
  3946     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3947        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3948        (CP-TRUNCATED-LIFE)
  3949        NEXT SENTENCE
  3950     ELSE
  3951        GO TO 12000-CHECK-NEXT.
  3952
  3953     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3954
  3955     COMPUTE ANGLEN EQUAL WK1 / I.
  3956     COMPUTE ANGLEM EQUAL WK2 / I.
  3957
  3958     COMPUTE FM EQUAL
  3959                    (((ONE-PLUS-I ** M) * I * M) /
  3960                    ((ONE-PLUS-I ** M) - 1))
  3961                    - 1.
  3962
  3963     COMPUTE FN EQUAL
  3964                    (((ONE-PLUS-I ** N) * I * N) /
  3965                    ((ONE-PLUS-I ** N) - 1))
  3966                    - 1.
  3967
  3968     COMPUTE FNM EQUAL
  3969                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3970                    ((ONE-PLUS-I ** (N - M)) - 1))
  3971                    - 1.
  3972
  3973     COMPUTE GR EQUAL
  3974                    (WS-WORK-RATE * ANGLEM * I) /
  3975                    (M - ANGLEM).
  3976
  3977     COMPUTE ODF EQUAL
  3978                     (1 +
  3979                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3980                     360)) /
  3981                     ONE-PLUS-I.
  3982
  3983     COMPUTE OD EQUAL
  3984                    (1 + (ODF * (FN / I - 1))) +
  3985                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3986
  3987     COMPUTE WK3 EQUAL
  3988*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3989                    ((1 + FN) * ODF *
  3990                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3991                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3992                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3993
  3994     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3995     COMPUTE WK3 EQUAL TRUNC-PMT * N.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  75
* ELRATE.cbl
  3996
  3997     COMPUTE WK3 EQUAL
  3998                    (WK3 / (ODF * (1 + FN))) -
  3999*                   CP-ORIGINAL-BENEFIT.
  4000                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  4001
  4002      MOVE WK3 TO CP-CALC-PREMIUM.
  4003
  4004     GO TO 99999-RETURN.
  4005
  4006 12000-CHECK-NEXT.
  4007
  4008     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  4009        NEXT SENTENCE
  4010     ELSE
  4011        GO TO 12000-CHECK-PA-TRUNC.
  4012
  4013      IF WS-WORK-DIS-RATE EQUAL +0
  4014         MOVE '7'                TO CP-RETURN-CODE
  4015         MOVE ZEROS              TO FACTOR
  4016                                    CP-CALC-PREMIUM
  4017         GO TO 99999-RETURN.
  4018
  4019      COMPUTE ANGLEN EQUAL WK1 / I.
  4020
  4021      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  4022
  4023      IF WS-WORK-DIS-RATE EQUAL APR100
  4024         ADD .00001 TO APR100.
  4025
  4026      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  4027      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  4028
  4029     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4030        / (1 + I)
  4031     COMPUTE ANGLEN-1 = ANGLEN / Y
  4032      IF CP-COMPANY-ID EQUAL 'CDL'
  4033         COMPUTE WK3 EQUAL
  4034
  4035          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  4036          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  4037
  4038          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  4039
  4040          ((WK8 ** N) /
  4041          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  4042
  4043          ((WK9 ** N) /
  4044          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  4045
  4046      ELSE
  4047         COMPUTE WK3 EQUAL
  4048
  4049          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  4050          (12 + WS-WORK-DIS-RATE) * 12) *
  4051
  4052          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  4053
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  76
* ELRATE.cbl
  4054          ((WK8 ** N) /
  4055          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  4056
  4057          ((WK9 ** N) /
  4058          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  4059
  4060      COMPUTE WK3 EQUAL
  4061          (WK3 * CP-PREMIUM-RATE) / +1000.
  4062
  4063      MOVE WK3 TO CP-CALC-PREMIUM.
  4064
  4065     GO TO 99999-RETURN.
  4066
  4067 12000-CHECK-PA-TRUNC.
  4068
  4069     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4070        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  4071        (CP-EARN-AS-NET-PAY) AND
  4072        (CP-TRUNCATED-LIFE)
  4073        NEXT SENTENCE
  4074     ELSE
  4075        GO TO 12000-CHECK-MD-TRUNC.
  4076
  4077     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4078
  4079     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4080     COMPUTE ANGLEN EQUAL WK1 / I.
  4081
  4082     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4083
  4084     COMPUTE WK3 EQUAL
  4085        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  4086        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  4087
  4088     MOVE WK3 TO CP-CALC-PREMIUM.
  4089
  4090     GO TO 99999-RETURN.
  4091
  4092 12000-CHECK-MD-TRUNC.
  4093
  4094     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4095        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4096        (CP-EARN-AS-NET-PAY) AND
  4097        (CP-TRUNCATED-LIFE)
  4098        NEXT SENTENCE
  4099     ELSE
  4100        GO TO 12000-CHECK-MD.
  4101
  4102     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4103
  4104     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4105     COMPUTE ANGLEM EQUAL WK2 / I.
  4106     COMPUTE ANGLEN EQUAL WK1 / I.
  4107
  4108     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4109
  4110     COMPUTE WK3 EQUAL
  4111        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  77
* ELRATE.cbl
  4112        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  4113        (ANGLEN-1 * (M - ANGLEM))).
  4114
  4115     MOVE WK3 TO CP-CALC-PREMIUM.
  4116
  4117     GO TO 99999-RETURN.
  4118
  4119 12000-CHECK-MD.
  4120
  4121     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4122        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4123        (CP-EARN-AS-NET-PAY)
  4124        NEXT SENTENCE
  4125     ELSE
  4126        GO TO 12000-CHECK-ME-TRUNC.
  4127
  4128     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4129
  4130     COMPUTE WK3 EQUAL
  4131        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  4132
  4133     MOVE WK3 TO CP-CALC-PREMIUM.
  4134
  4135     GO TO 99999-RETURN.
  4136
  4137 12000-CHECK-ME-TRUNC.
  4138
  4139     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  4140        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4141        AND (CP-EARN-AS-NET-PAY)
  4142        AND (CP-TRUNCATED-LIFE)
  4143        CONTINUE
  4144     ELSE
  4145        GO TO 12000-CHECK-CID-WA-FARMPLAN
  4146     END-IF
  4147
  4148     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4149     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4150     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4151     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4152     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4153     COMPUTE ANGLEN-1 = ANGLEN / Y
  4154     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4155     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4156     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  4157     COMPUTE WK3
  4158        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  4159        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  4160            * (1 / (1.0635 ** (M / 12))))
  4161*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  4162*    COMPUTE WK9 EQUAL
  4163*       1 / (1 + (.045 * (N - M) / 24))
  4164*    COMPUTE WK7 EQUAL
  4165*       WS-WORK-RATE * 20 / (M + 1).
  4166*    COMPUTE WK3 EQUAL
  4167*       ((( N - ANGLEN) * WK7 * WK8) /
  4168*       (10 * ANGLEN-1 * I)) -
  4169*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  78
* ELRATE.cbl
  4170*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  4171*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4172*
  4173     MOVE WK3 TO CP-CALC-PREMIUM.
  4174
  4175     GO TO 99999-RETURN
  4176      .
  4177 12000-CHECK-CID-WA-FARMPLAN.
  4178
  4179     IF (CP-COMPANY-ID EQUAL 'CID')
  4180        AND (CP-STATE-STD-ABBRV = 'WA')
  4181        AND (CP-FARM-PLAN)
  4182        CONTINUE
  4183     ELSE
  4184        GO TO 12000-CHECK-CID-FARMPLAN
  4185     END-IF
  4186**  This was removed due to IR 2015022300001
  4187    GO TO 12000-CHECK-CID-FARMPLAN
  4188
  4189     move cp-original-term       to n
  4190     move cp-no-of-pmts          TO C-TOT-PMTS
  4191     compute c-pmts-per-year = 12 / cp-pay-frequency
  4192     move cp-pay-frequency       to m
  4193     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4194     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4195     if i = zeros
  4196        move .0000000001         to i
  4197     end-if
  4198     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4199
  4200     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4201        (m * 30))) / (1 + I)
  4202     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4203        ** CP-PAY-FREQUENCY) - 1
  4204     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4205     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4206        ** TI) / WS-WORK-DIS-RATE
  4207     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4208     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4209     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4210        ** m) / WS-WORK-DIS-RATE
  4211     COMPUTE WK2 = WK2 * (1 + J)
  4212     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4213     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4214     COMPUTE WK3 = WK3 * (1 + J)
  4215     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4216        ** (c-tot-pmts - 1))) / J
  4217     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4218        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4219        (CP-PREMIUM-RATE / 1000)
  4220     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4221     COMPUTE WK6 = (WK7 * GR)
  4222
  4223     MOVE WK6 TO CP-CALC-PREMIUM
  4224
  4225     GO TO 99999-RETURN
  4226
  4227     .
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  79
* ELRATE.cbl
  4228 12000-CHECK-CID-FARMPLAN.
  4229     IF (CP-COMPANY-ID EQUAL 'CID')
  4230        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4231           OR 'IN' OR 'AZ')
  4232        AND (CP-FARM-PLAN)
  4233        CONTINUE
  4234     ELSE
  4235        GO TO 12000-CHECK-CID-AL-FARMPLAN
  4236     END-IF
  4237     COMPUTE N = M / CP-PAY-FREQUENCY
  4238     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4239     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4240        ** CP-PAY-FREQUENCY) - 1
  4241     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4242     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4243        ** TI) / WS-WORK-DIS-RATE
  4244     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4245     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4246     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4247        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4248     COMPUTE WK2 = WK2 * (1 + J)
  4249     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4250     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4251     COMPUTE WK3 = WK3 * (1 + J)
  4252     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4253        ** (N - 1))) / J
  4254     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4255        ((N * WK2) - WK5)) + (N * WK1)) *
  4256        (CP-PREMIUM-RATE / 1000)
  4257     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4258     COMPUTE WK6 = (WK7 * GR)
  4259     MOVE WK6 TO CP-CALC-PREMIUM
  4260     GO TO 99999-RETURN
  4261     .
  4262 12000-CHECK-CID-AL-FARMPLAN.
  4263
  4264     IF (CP-COMPANY-ID EQUAL 'CID')
  4265        AND (CP-STATE-STD-ABBRV = 'AL')
  4266        AND (CP-FARM-PLAN)
  4267        CONTINUE
  4268     ELSE
  4269        GO TO 12000-CHECK-SC-CID
  4270     END-IF
  4271
  4272     display ' made AL Farm Plan calc '
  4273
  4274     evaluate true
  4275        when cp-pmt-mode = 'B'
  4276           move 26               to c-pmts-per-year
  4277           move 14               to c-days-in-pmt-per
  4278        when cp-pmt-mode = 'W'
  4279           move 52               to c-pmts-per-year
  4280           move 07               to c-days-in-pmt-per
  4281        when cp-pmt-mode = 'S'
  4282           move 24               to c-pmts-per-year
  4283           move 15               to c-days-in-pmt-per
  4284        when cp-pmt-mode = 'A'
  4285           move 1                to c-pmts-per-year
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  80
* ELRATE.cbl
  4286           move 360              to c-days-in-pmt-per
  4287        when cp-pmt-mode = 'T'
  4288           move 2                to c-pmts-per-year
  4289           move 180              to c-days-in-pmt-per
  4290        when cp-pmt-mode = 'Q'
  4291           move 4                to c-pmts-per-year
  4292           move 90               to c-days-in-pmt-per
  4293        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  4294           move 6                to c-pmts-per-year
  4295           move 60               to c-days-in-pmt-per
  4296        when other
  4297           move 12               to c-pmts-per-year
  4298           move 30               to c-days-in-pmt-per
  4299     end-evaluate
  4300
  4301     compute c-tot-pmts = n / 12 * c-pmts-per-year
  4302     compute i = cp-loan-apr / c-pmts-per-year / 100
  4303     if i = zeros
  4304        move .0000000001         to i
  4305     end-if
  4306     compute anglen  =
  4307        (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4308
  4309     compute y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4310        c-days-in-pmt-per)) / (1 + I)
  4311
  4312     compute angleny = anglen / y
  4313
  4314     compute wk3 rounded =   *> tv1
  4315        ((c-tot-pmts - anglen + (i * c-tot-pmts))) / i
  4316
  4317     compute wk6 =           *> tv2
  4318        cp-premium-rate / 10 * 12 / c-pmts-per-year / 100
  4319
  4320     compute wk7 =    *> tv3
  4321        (cp-original-benefit / anglen)
  4322
  4323     compute wk5 rounded = wk7 *wk3 * wk6
  4324
  4325     move wk5                    to cp-calc-premium
  4326     GO TO 99999-RETURN
  4327     .
  4328 12000-CHECK-SC-CID.
  4329     IF (CP-COMPANY-ID = 'CID')
  4330        AND (CP-STATE-STD-ABBRV = 'SC')
  4331        AND (CP-EARN-AS-NET-PAY)
  4332        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4333        move 6                   to ws-extra-pmts
  4334     ELSE
  4335        GO TO 12000-CHECK-AL-CID
  4336     END-IF
  4337     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4338     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4339     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4340        / 12)) / ((M + 1) / 2)
  4341
  4342     if i = .0000000001
  4343        compute wk4 = cp-original-benefit / n
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  81
* ELRATE.cbl
  4344        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4345            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4346        display ' hit sc wo apr - wk2 ' wk2
  4347     else
  4348        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4349        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4350        COMPUTE ANGLEN-1 = ANGLEN / Y
  4351        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4352        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4353           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4354     end-if
  4355*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4356*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4357*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4358*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4359*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4360*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4361*       / 12)) / ((M + 1) / 2)
  4362*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4363*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4364*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4365     MOVE WK3 TO CP-CALC-PREMIUM
  4366     GO TO 99999-RETURN
  4367     .
  4368 12000-CHECK-AL-CID.
  4369     IF (CP-COMPANY-ID EQUAL 'CID')
  4370        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4371        AND (CP-EARN-AS-NET-PAY)
  4372        CONTINUE
  4373     ELSE
  4374        GO TO 12000-CHECK-NH-CID
  4375     END-IF
  4376     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4377     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4378     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4379     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4380                   / (1 + I)
  4381     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4382     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4383     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4384        (CP-PREMIUM-RATE / 1000)
  4385     MOVE WK3 TO CP-CALC-PREMIUM
  4386     GO TO 99999-RETURN
  4387     .
  4388 12000-CHECK-NH-CID.
  4389     IF (CP-COMPANY-ID EQUAL 'CID')
  4390        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4391        AND (CP-EARN-AS-NET-PAY)
  4392        CONTINUE
  4393     ELSE
  4394        GO TO 12000-CHECK-PA-CID
  4395     END-IF
  4396     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4397     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4398     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4399                   / (1 + I)
  4400     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4401     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  82
* ELRATE.cbl
  4402     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4403        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4404     MOVE WK3 TO CP-CALC-PREMIUM
  4405     GO TO 99999-RETURN
  4406     .
  4407 12000-CHECK-PA-CID.
  4408     IF (CP-COMPANY-ID EQUAL 'CID')
  4409        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4410        AND (CP-EARN-AS-NET-PAY)
  4411        CONTINUE
  4412     ELSE
  4413        GO TO 12000-CHECK-ME-CID
  4414     END-IF
  4415
  4416     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4417     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4418     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4419     COMPUTE ANGLEN-1 = ANGLEN / Y
  4420     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4421     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4422     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4423     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4424        * WK5
  4425     MOVE WK3 TO CP-CALC-PREMIUM
  4426     GO TO 99999-RETURN
  4427     .
  4428 12000-CHECK-ME-CID.
  4429     IF (CP-COMPANY-ID EQUAL 'CID')
  4430        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4431        AND (CP-EARN-AS-NET-PAY)
  4432        CONTINUE
  4433     ELSE
  4434        GO TO 12000-CHECK-VT-TRUNC
  4435     END-IF
  4436     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4437     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4438     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4439     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4440     COMPUTE ANGLEN-1 = ANGLEN / Y
  4441     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4442     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4443     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4444        * WK5
  4445     MOVE WK3 TO CP-CALC-PREMIUM
  4446     GO TO 99999-RETURN
  4447     .
  4448 12000-CHECK-VT-TRUNC.
  4449
  4450     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4451        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4452        (CP-EARN-AS-NET-PAY) AND
  4453        (CP-TRUNCATED-LIFE)
  4454        NEXT SENTENCE
  4455     ELSE
  4456        GO TO 12000-CHECK-VT.
  4457
  4458      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4459
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  83
* ELRATE.cbl
  4460      COMPUTE ANGLEN EQUAL WK1 / I.
  4461
  4462      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4463
  4464      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4465      COMPUTE WK9 EQUAL
  4466        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4467        ((.0054 - I) / (1 + I)).
  4468      COMPUTE WK7 EQUAL
  4469        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4470      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4471        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4472
  4473      MOVE WK3 TO CP-CALC-PREMIUM.
  4474
  4475     GO TO 99999-RETURN.
  4476
  4477 12000-CHECK-VT.
  4478
  4479     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4480        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4481        (CP-EARN-AS-NET-PAY)
  4482        NEXT SENTENCE
  4483     ELSE
  4484        GO TO 12000-CHECK-MINN-WDS.
  4485
  4486      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4487
  4488      COMPUTE ANGLEN EQUAL WK1 / I.
  4489
  4490      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4491
  4492      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4493                        (ANGLEN-1 * I)) *
  4494
  4495                        (((1.0054 ** N - 1) /
  4496                        (1.0054 ** (N - 1) * .0054)) -
  4497
  4498                        ((V * (1 - 1.0054 ** N * VX)) /
  4499                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4500
  4501      MOVE WK3 TO CP-CALC-PREMIUM.
  4502
  4503     GO TO 99999-RETURN.
  4504
  4505 12000-CHECK-MINN-WDS.
  4506
  4507     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4508        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4509        (CP-EARN-AS-NET-PAY)
  4510        NEXT SENTENCE
  4511     ELSE
  4512        GO TO 12000-CHECK-MINN-BALL-LEV.
  4513
  4514     COMPUTE ANGLEN EQUAL WK1 / I.
  4515     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4516              (N / +12) * (2 / (N + 1)).
  4517     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  84
* ELRATE.cbl
  4518         WK3 * ((N - ANGLEN) / I).
  4519
  4520      MOVE WK3 TO CP-CALC-PREMIUM.
  4521
  4522     GO TO 99999-RETURN.
  4523
  4524 12000-CHECK-MINN-BALL-LEV.
  4525
  4526     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4527        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4528        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4529        (CP-EARN-AS-REG-BALLOON)
  4530        NEXT SENTENCE
  4531     ELSE
  4532        GO TO 12000-CHECK-MINN-BALL.
  4533
  4534     COMPUTE ANGLEN EQUAL WK1 / I.
  4535
  4536     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4537
  4538     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4539        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4540
  4541     MOVE WK3 TO CP-CALC-PREMIUM.
  4542
  4543     GO TO 99999-RETURN.
  4544
  4545 12000-CHECK-MINN-BALL.
  4546
  4547     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4548        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4549        (CP-EARN-AS-REG-BALLOON)
  4550        NEXT SENTENCE
  4551     ELSE
  4552        GO TO 12000-CHECK-CID-MN-BALL.
  4553
  4554     COMPUTE ANGLEN EQUAL WK1 / I.
  4555     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4556
  4557     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4558     / +100 * (N - 1) / 12 * 2 / N *
  4559     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4560
  4561      MOVE WK3 TO CP-CALC-PREMIUM.
  4562
  4563     GO TO 99999-RETURN.
  4564
  4565 12000-CHECK-CID-MN-BALL.
  4566     IF (CP-COMPANY-ID EQUAL 'CID')
  4567        AND (CP-STATE-STD-ABBRV = 'MN')
  4568        AND (CP-CERT-EFF-DT > X'A4FF')
  4569        AND (CP-EARN-AS-REG-BALLOON)
  4570        CONTINUE
  4571     ELSE
  4572        GO TO 12000-CHECK-CID-MN-FARM
  4573     END-IF
  4574     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4575     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  85
* ELRATE.cbl
  4576     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4577     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4578     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4579     COMPUTE V = 1 / (1 + I)
  4580     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4581     COMPUTE Y = (1 + (D * I) / +30)
  4582        / (1 + I)
  4583     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4584        * CP-PREMIUM-RATE / 1000
  4585*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4586*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4587*    ELSE
  4588*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4589*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4590*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4591*       DISPLAY ' BALLOON TOP ' WK6
  4592*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4593*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4594*          / 100
  4595*       DISPLAY ' BALLOON BOTTOM ' WK7
  4596*       COMPUTE GR = WK6 / WK7
  4597*       DISPLAY ' BALLOON PAYMENT ' GR
  4598*    END-IF
  4599     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4600     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4601        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4602     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4603     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4604        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4605           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4606           * CP-PREMIUM-RATE / 1000
  4607     MOVE WK3                    TO CP-CALC-PREMIUM
  4608     GO TO 99999-RETURN.
  4609     .
  4610 12000-CHECK-CID-MN-FARM.
  4611
  4612     IF (CP-COMPANY-ID EQUAL 'CID')
  4613        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  4614        AND (CP-CERT-EFF-DT > X'A4FF')
  4615        AND (CP-EARN-AS-FARM-PLAN)
  4616        CONTINUE
  4617     ELSE
  4618        GO TO 12000-CHECK-CID-NET-BALLoons
  4619     END-IF
  4620
  4621     EVALUATE CP-PMT-MODE
  4622        WHEN 'B'
  4623           MOVE +14              TO C-DAYS-IN-PMT-PER
  4624           MOVE +26              TO C-PMTS-PER-YEAR
  4625           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4626        WHEN 'S'
  4627           MOVE +15              TO C-DAYS-IN-PMT-PER
  4628           MOVE +24              TO C-PMTS-PER-YEAR
  4629           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4630        WHEN 'T'
  4631           MOVE +360             TO C-DAYS-IN-PMT-PER
  4632           MOVE +1               TO C-PMTS-PER-YEAR
  4633           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  86
* ELRATE.cbl
  4634        WHEN 'W'
  4635           MOVE +7               TO C-DAYS-IN-PMT-PER
  4636           MOVE +52              TO C-PMTS-PER-YEAR
  4637           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4638        WHEN OTHER
  4639           move cp-no-of-pmts    to c-tot-pmts
  4640           if cp-pay-frequency > zeros
  4641              compute c-pmts-per-year =
  4642                 12 / cp-pay-frequency
  4643              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4644           else
  4645              MOVE +30           TO C-DAYS-IN-PMT-PER
  4646              MOVE +12           TO C-PMTS-PER-YEAR
  4647              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4648           end-if
  4649     END-EVALUATE
  4650
  4651     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4652     if i = zeros
  4653        move .0000000001         to i
  4654     end-if
  4655
  4656     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4657        C-DAYS-IN-PMT-PER)) / (1 + I)
  4658
  4659     compute cp-premium-rate =
  4660        cp-premium-rate * 12 / c-pmts-per-year / 10
  4661     move c-tot-pmts to n m
  4662     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4663     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4664     COMPUTE ANGLEN-1 = ANGLEN / Y
  4665     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4666
  4667     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4668        (cp-premium-rate / 100)
  4669
  4670
  4671     MOVE WK3                    TO CP-CALC-PREMIUM
  4672
  4673     GO TO 99999-RETURN.
  4674
  4675     .
  4676 12000-check-cid-net-balloons.
  4677     IF (CP-COMPANY-ID EQUAL 'CID')
  4678        AND (CP-EARN-AS-REG-BALLOON)
  4679        and (CP-NET-ONLY-STATE not = 'Y')
  4680        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4681        CONTINUE
  4682     ELSE
  4683        GO TO 12000-check-cid-net-only-balls
  4684     END-IF
  4685     display ' *** NOT NET ONLY STATE BALLOONS *** '
  4686     COMPUTE Y =
  4687        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4688     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4689     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4690     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4691     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  87
* ELRATE.cbl
  4692     COMPUTE ANGLEMY = ANGLEM / Y
  4693     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4694     COMPUTE ANGLENY = ANGLEN / Y
  4695     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4696     compute cp-original-benefit =
  4697        cp-original-benefit + cp-alternate-benefit
  4698     COMPUTE PVBALLOON rounded =
  4699        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4700     compute wk4 rounded =
  4701        cp-original-benefit - pvballoon
  4702     compute wk6 rounded =
  4703        (cp-original-benefit - cp-alternate-benefit)
  4704***  compute ra = wk4 / anglem-1y
  4705     compute ra = wk4 / anglemy
  4706     compute wk6 rounded = wk6 / anglemy
  4707     display ' rate before ' cp-premium-rate
  4708     compute cp-premium-rate =
  4709        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  4710            / 30) / 12))     /
  4711           ((m + 1) / 2)
  4712     display '************************************'
  4713     display ' orign ben    ' cp-original-benefit
  4714     display ' balloon      ' cp-alternate-benefit
  4715     display ' ra           ' ra
  4716     display ' wk6          ' wk6
  4717     display ' m            ' m
  4718     display ' anglemy      ' anglemy
  4719     display ' anglem-1     ' anglem-1y
  4720     display ' i            ' i
  4721     display ' extra per    ' cp-extra-periods
  4722     display ' prem rate    ' cp-premium-rate
  4723***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4724***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4725     compute wk3 = wk6 * (m - anglem) / i * (1 +
  4726        (cp-extra-periods * i)) * cp-premium-rate / 100
  4727     move wk3                    to cp-calc-premium
  4728     display ' wk3          ' wk3
  4729     display '************************************'
  4730*    compute wk3 rounded =
  4731*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4732*    move wk3                    to cp-lf-balloon-prem
  4733     GO TO 99999-RETURN.
  4734     .
  4735 12000-check-cid-net-only-balls.
  4736     IF (CP-COMPANY-ID EQUAL 'CID')
  4737        AND (CP-EARN-AS-REG-BALLOON)
  4738        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4739        CONTINUE
  4740     ELSE
  4741        GO TO 12000-CHECK-NC-WDS
  4742     END-IF
  4743     display ' *** NET ONLY STATE BALLOONS *** '
  4744     COMPUTE Y =
  4745        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4746     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4747     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4748     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4749     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  88
* ELRATE.cbl
  4750     COMPUTE ANGLEMY = ANGLEM / Y
  4751     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4752     COMPUTE ANGLENY = ANGLEN / Y
  4753     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4754     COMPUTE PVBALLOON rounded =
  4755        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4756     compute wk4 rounded =
  4757        cp-original-benefit - pvballoon
  4758*    compute cp-premium-rate =
  4759*       (cp-premium-rate * (m + 1) / 12)  /
  4760*          ((m + 2) / 2)
  4761***  compute ra = wk4 / anglem-1y
  4762     compute ra = (cp-original-benefit + cp-alternate-benefit -
  4763        pvballoon) / anglemy
  4764     display '************************************'
  4765     display ' ra           ' ra
  4766     display ' m            ' m
  4767     display ' anglemy      ' anglemy
  4768     display ' anglem-1     ' anglem-1y
  4769     display ' i            ' i
  4770     display ' extra per    ' cp-extra-periods
  4771     display ' prem rate    ' cp-premium-rate
  4772     display '************************************'
  4773***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4774***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4775     compute wk3 = ra * (m - anglemy) / i * (1 +
  4776        (cp-extra-periods * i)) * cp-premium-rate / 100
  4777     move wk3                    to cp-calc-premium
  4778     compute wk3 rounded =
  4779        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4780     move wk3                    to cp-lf-balloon-prem
  4781     GO TO 99999-RETURN.
  4782     .
  4783 12000-CHECK-NC-WDS.
  4784
  4785     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4786        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4787        (CP-EARN-AS-NET-PAY)
  4788        NEXT SENTENCE
  4789     ELSE
  4790        GO TO 12000-CHECK-NC-BALL-LEV.
  4791
  4792     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4793     COMPUTE ANGLEN EQUAL WK1 / I.
  4794     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4795              CP-PREMIUM-RATE / +100 *
  4796              N / +12 * 2 / (N + 1) *
  4797              (WK4 - ANGLEN) / (I * ANGLEN).
  4798
  4799      MOVE WK3 TO CP-CALC-PREMIUM.
  4800
  4801     GO TO 99999-RETURN.
  4802
  4803 12000-CHECK-NC-BALL-LEV.
  4804
  4805     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4806        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4807        (CP-DEVIATION-CODE EQUAL 'LEV') AND
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  89
* ELRATE.cbl
  4808        (CP-EARN-AS-REG-BALLOON)
  4809        NEXT SENTENCE
  4810     ELSE
  4811        GO TO 12000-CHECK-NC-BALL.
  4812
  4813     COMPUTE ANGLEN EQUAL WK1 / I.
  4814
  4815**** VX = 1 / (1 + I)**N.
  4816
  4817     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4818        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4819
  4820     MOVE WK3 TO CP-CALC-PREMIUM.
  4821
  4822     GO TO 99999-RETURN.
  4823
  4824 12000-CHECK-NC-BALL.
  4825
  4826     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4827        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4828        (CP-EARN-AS-REG-BALLOON)
  4829        NEXT SENTENCE
  4830     ELSE
  4831        GO TO 12000-CHECK-MINN-TRUNC.
  4832
  4833     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4834     COMPUTE ANGLEN EQUAL WK1 / I.
  4835     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4836**** VX = 1 / (1 + I)**N.
  4837
  4838     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4839     / +100 * (N - 1) / 12 * 2 / N *
  4840     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4841
  4842      MOVE WK3 TO CP-CALC-PREMIUM.
  4843
  4844     GO TO 99999-RETURN.
  4845
  4846 12000-CHECK-MINN-TRUNC.
  4847
  4848     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4849        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4850        (M GREATER THAN +63) AND
  4851        (CP-EARN-AS-NET-PAY) AND
  4852        (CP-TRUNCATED-LIFE)
  4853        NEXT SENTENCE
  4854     ELSE
  4855        GO TO 12000-CHECK-MINN.
  4856
  4857      COMPUTE ANGLEN EQUAL WK1 / I.
  4858      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4859
  4860      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4861
  4862      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4863       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4864       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4865
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  90
* ELRATE.cbl
  4866      MOVE WK3 TO CP-CALC-PREMIUM.
  4867
  4868     GO TO 99999-RETURN.
  4869
  4870 12000-CHECK-MINN.
  4871
  4872     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4873        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4874        (M GREATER THAN +63) AND
  4875        (CP-EARN-AS-NET-PAY)
  4876        NEXT SENTENCE
  4877     ELSE
  4878        GO TO 12000-CHECK-MONTANA-TRUNC.
  4879
  4880      COMPUTE ANGLEN EQUAL WK1 / I.
  4881
  4882      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4883
  4884      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4885       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4886       (((N - ANGLEN) / I) + (2 * N)).
  4887
  4888      MOVE WK3 TO CP-CALC-PREMIUM.
  4889
  4890     GO TO 99999-RETURN.
  4891
  4892 12000-CHECK-MONTANA-TRUNC.
  4893
  4894     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4895        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4896        (M GREATER THAN +63) AND
  4897        (CP-EARN-AS-NET-PAY) AND
  4898        (CP-TRUNCATED-LIFE)
  4899        NEXT SENTENCE
  4900     ELSE
  4901        GO TO 12000-CHECK-MONTANA.
  4902
  4903      COMPUTE ANGLEN EQUAL WK1 / I.
  4904      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4905
  4906      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4907
  4908      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4909      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4910       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4911
  4912      MOVE WK3 TO CP-CALC-PREMIUM.
  4913
  4914     GO TO 99999-RETURN.
  4915
  4916 12000-CHECK-MONTANA.
  4917
  4918     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4919        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4920        (M GREATER THAN +63) AND
  4921        (CP-EARN-AS-NET-PAY)
  4922        NEXT SENTENCE
  4923     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  91
* ELRATE.cbl
  4924        GO TO 12001-CONTINUE-NCL-TRUNC.
  4925
  4926      COMPUTE ANGLEN EQUAL WK1 / I.
  4927
  4928      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4929
  4930      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4931       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4932       (((N - ANGLEN) / I) + (4 * N)).
  4933
  4934      MOVE WK3 TO CP-CALC-PREMIUM.
  4935
  4936     GO TO 99999-RETURN.
  4937
  4938 12001-CONTINUE-NCL-TRUNC.
  4939
  4940     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4941        (CP-EARN-AS-NET-PAY) AND
  4942        (CP-TRUNCATED-LIFE)
  4943        NEXT SENTENCE
  4944     ELSE
  4945        GO TO 12001-CONTINUE-NCL.
  4946
  4947      COMPUTE ANGLEN EQUAL WK1 / I.
  4948      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4949
  4950      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4951
  4952      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4953      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4954      (ANGLEN-1 * (N + 1) * I).
  4955
  4956      MOVE WK3 TO CP-CALC-PREMIUM.
  4957
  4958     GO TO 99999-RETURN.
  4959
  4960 12001-CONTINUE-NCL.
  4961
  4962     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4963        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4964        (CP-EARN-AS-NET-PAY)
  4965        GO TO 12001-CHECK-NC-NET-PLUS3.
  4966
  4967     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4968        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4969        (CP-EARN-AS-NET-PAY)
  4970        GO TO 12001-CHECK-CA.
  4971
  4972     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4973        (CP-EARN-AS-NET-PAY)
  4974        NEXT SENTENCE
  4975     ELSE
  4976        GO TO 12000-CONTINUE-NET.
  4977
  4978      COMPUTE ANGLEN EQUAL WK1 / I.
  4979      MOVE ANGLEN                TO ANGLEN-1.
  4980
  4981      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  92
* ELRATE.cbl
  4982
  4983      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4984       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4985       ((N - ANGLEN) / I).
  4986
  4987      MOVE WK3 TO CP-CALC-PREMIUM.
  4988
  4989     GO TO 99999-RETURN.
  4990
  4991 12000-CONTINUE-NET.
  4992
  4993     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4994        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4995        (CP-EARN-AS-NET-PAY)
  4996        NEXT SENTENCE
  4997     ELSE
  4998        GO TO 12001-CONTINUE-MINN.
  4999
  5000      COMPUTE ANGLEN EQUAL WK6 / I.
  5001      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  5002
  5003      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  5004      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  5005      COMPUTE WK3 EQUAL (WK3 / I) *
  5006       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  5007
  5008      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  5009         MOVE +0 TO CP-R-MAX-TOT-BEN.
  5010
  5011      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  5012
  5013      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  5014         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  5015         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  5016
  5017      MOVE WK3 TO CP-CALC-PREMIUM.
  5018
  5019     GO TO 99999-RETURN.
  5020
  5021 12001-CONTINUE-MINN.
  5022
  5023     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5024        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  5025        (CP-TRUNCATED-LIFE)
  5026        NEXT SENTENCE
  5027     ELSE
  5028        GO TO 12001-CHECK-RI-GTL.
  5029
  5030      COMPUTE ANGLEN EQUAL WK1 / I.
  5031      COMPUTE ANGLEM EQUAL WK2 / I.
  5032
  5033      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  5034       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  5035       * M / 2400) * 1000 + .5) / 1000000.
  5036
  5037      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  5038       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  5039
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  93
* ELRATE.cbl
  5040     GO TO 99999-RETURN.
  5041
  5042 12001-CHECK-RI-GTL.
  5043
  5044     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5045        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  5046        (CP-EARN-AS-NET-PAY)
  5047        NEXT SENTENCE
  5048     ELSE
  5049        GO TO 12001-CHECK-RI-LEASE-GTL.
  5050
  5051      COMPUTE ANGLEN EQUAL WK1 / I.
  5052*     COMPUTE ANGLEM EQUAL WK2 / I.
  5053
  5054      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  5055               (1 + WS-WORK-DIS-RATE * N).
  5056      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  5057         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  5058
  5059
  5060     GO TO 99999-RETURN.
  5061
  5062 12001-CHECK-RI-LEASE-GTL.
  5063
  5064     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5065        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  5066        (CP-SPECIAL-CALC-CD EQUAL 'H')
  5067        NEXT SENTENCE
  5068     ELSE
  5069        GO TO 12001-CHECK-OR-GTL.
  5070
  5071     COMPUTE ANGLEN EQUAL WK1 / I.
  5072
  5073     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  5074        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  5075                        /
  5076        (1000 * I * (1 + .0021 * N)).
  5077     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  5078       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  5079                            /
  5080       (1000 * (1 + .0027 * (N + 1))).
  5081
  5082     GO TO 99999-RETURN.
  5083
  5084 12001-CHECK-OR-GTL.
  5085
  5086     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5087        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  5088        (CP-EARN-AS-NET-PAY)
  5089        NEXT SENTENCE
  5090     ELSE
  5091        GO TO 12001-CHECK-GA-GTL.
  5092
  5093     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5094     COMPUTE ANGLEN EQUAL WK1 / I.
  5095
  5096     IF M LESS THAN +64
  5097        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  94
* ELRATE.cbl
  5098         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  5099                   /
  5100         (I * ANGLEN * (N - (N - M) + 1) * 600)
  5101        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  5102     ELSE
  5103        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  5104        CP-PREMIUM-RATE * (1 + I))
  5105                  /
  5106        (+1000 * I * ANGLEN)
  5107        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  5108*    MOVE WK3 TO CP-CALC-PREMIUM.
  5109     GO TO 99999-RETURN.
  5110
  5111 12001-CHECK-GA-GTL.
  5112
  5113     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5114        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  5115        (CP-EARN-AS-NET-PAY)
  5116*       (CP-TRUNCATED-LIFE)
  5117        NEXT SENTENCE
  5118     ELSE
  5119        GO TO 12001-CHECK-MA-GTL.
  5120
  5121     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5122     COMPUTE ANGLEN EQUAL WK1 / I.
  5123
  5124     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  5125     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  5126      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  5127     MOVE WK3 TO CP-CALC-PREMIUM.
  5128
  5129     GO TO 99999-RETURN.
  5130
  5131 12001-CHECK-MA-GTL.
  5132
  5133     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5134        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  5135        (CP-EARN-AS-NET-PAY) AND
  5136        (CP-SPECIAL-CALC-CD EQUAL 'H')
  5137        NEXT SENTENCE
  5138     ELSE
  5139        GO TO 12001-CHECK-NV-NET.
  5140
  5141     COMPUTE ANGLEN EQUAL WK1 / I.
  5142
  5143     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  5144      CP-ALTERNATE-BENEFIT * N.
  5145
  5146     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  5147     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  5148
  5149     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  5150     WK7 * (N - ANGLEN) / I.
  5151     MOVE WK3 TO CP-CALC-PREMIUM.
  5152
  5153     GO TO 99999-RETURN.
  5154
  5155 12001-CHECK-NV-NET.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  95
* ELRATE.cbl
  5156     IF (CP-COMPANY-ID EQUAL 'CID')
  5157        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  5158        AND (CP-EARN-AS-NET-PAY)
  5159        CONTINUE
  5160     ELSE
  5161        GO TO 12001-CHECK-MN-NET
  5162     END-IF
  5163     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5164     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5165     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5166                   / (1 + I)
  5167     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5168     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5169     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5170        (CP-PREMIUM-RATE * K-I / 1000)
  5171     MOVE WK3                    TO CP-CALC-PREMIUM
  5172     GO TO 99999-RETURN
  5173      .
  5174 12001-CHECK-MN-NET.
  5175     IF (CP-COMPANY-ID EQUAL 'CID')
  5176        AND (CP-STATE-STD-ABBRV = 'MN')
  5177        AND (CP-EARN-AS-NET-PAY)
  5178        AND (NOT CP-LEVEL-LIFE)
  5179        AND (WS-DISCOUNT-OPTION = '1')
  5180        CONTINUE
  5181     ELSE
  5182        GO TO 12001-CHECK-NC-NET
  5183     END-IF
  5184     if i = .0000000001
  5185        compute wk4 = cp-original-benefit / n
  5186        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  5187           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  5188        move wk3 to cp-calc-premium
  5189        go to 99999-return
  5190     end-if
  5191     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5192     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5193     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5194                   / (1 + I)
  5195     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5196     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5197     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5198        (CP-PREMIUM-RATE / 1000) * (1 + I)
  5199     MOVE WK3                    TO CP-CALC-PREMIUM
  5200     GO TO 99999-RETURN
  5201      .
  5202 12001-CHECK-NC-NET.
  5203
  5204     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  5205        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5206        (CP-EARN-AS-NET-PAY)
  5207        NEXT SENTENCE
  5208     ELSE
  5209        GO TO 12001-CHECK-NC-NET-PLUS3.
  5210
  5211      COMPUTE ANGLEN EQUAL WK1 / I.
  5212      COMPUTE ANGLEN-M EQUAL WK5 / I.
  5213
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  96
* ELRATE.cbl
  5214      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  5215          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  5216          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  5217          N * (CP-PREMIUM-RATE / 1000)).
  5218
  5219      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  5220          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  5221
  5222      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  5223          ((N - ANGLEN) / I + 3) / ANGLEN) /
  5224          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  5225          (ANGLEN * 2))
  5226
  5227      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  5228
  5229      IF ANGLEN IS NOT LESS THAN WK7
  5230          COMPUTE CP-PREMIUM-RATE ROUNDED =
  5231              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  5232          COMPUTE WK3 ROUNDED =
  5233              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  5234
  5235     MOVE WK3 TO CP-CALC-PREMIUM.
  5236
  5237     GO TO 99999-RETURN.
  5238
  5239 12001-CHECK-NC-NET-PLUS3.
  5240
  5241     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5242        (CP-EARN-AS-NET-PAY) AND
  5243        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL' AND 'VPP')
  5244        NEXT SENTENCE
  5245     ELSE
  5246        GO TO 12001-CHECK-CA.
  5247
  5248     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  5249     MOVE ' ' TO DC-OPTION-CODE.
  5250     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  5251
  5252     IF DATE-CONVERSION-ERROR
  5253        MOVE '2'                 TO CP-RETURN-CODE
  5254        MOVE ZEROS               TO FACTOR
  5255                                    CP-CALC-PREMIUM
  5256         GO TO 99999-RETURN.
  5257
  5258     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  5259        NEXT SENTENCE
  5260     ELSE
  5261        GO TO 12001-CONTINUE-NET.
  5262
  5263     COMPUTE ANGLEN EQUAL WK1 / I.
  5264     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5265
  5266     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  5267
  5268     COMPUTE NC-R = 20 *
  5269                    ((NC-LR * ORIGINAL-TERM) / 12)
  5270                          / (ORIGINAL-TERM + 1).
  5271
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  97
* ELRATE.cbl
  5272     COMPUTE NC-OB = NC-R / 1000.
  5273
  5274     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  5275                    (NC-OB * ORIGINAL-TERM * 3).
  5276
  5277     IF CP-EXT-CHG-LF
  5278         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  5279     ELSE
  5280         MOVE 30                 TO  NC-BIG-D.
  5281
  5282     COMPUTE NC-LITTLE-D = (1 + I) /
  5283             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  5284
  5285     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  5286             (ANGLEN * NC-LITTLE-D ).
  5287
  5288     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  5289
  5290     GO TO 99999-RETURN.
  5291
  5292 12001-CHECK-CA.
  5293
  5294     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5295        (WS-DISCOUNT-OPTION = '6')
  5296        NEXT SENTENCE
  5297     ELSE
  5298        GO TO 12001-CHECK-GTL-IA.
  5299
  5300     COMPUTE CA-J = CA-DISCOUNT / 12.
  5301     COMPUTE ANGLEN EQUAL WK1 / I.
  5302     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  5303     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  5304     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  5305     COMPUTE CA-VI = (1 + I)** -1.
  5306     COMPUTE CP-CALC-PREMIUM =
  5307         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  5308         ((1 + CA-J) / I) *
  5309         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  5310         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  5311         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  5312
  5313     GO TO 99999-RETURN.
  5314
  5315 12001-CHECK-GTL-IA.
  5316
  5317     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  5318        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  5319        (CP-EARN-AS-NET-PAY)
  5320        NEXT SENTENCE
  5321     ELSE
  5322        GO TO 12001-CHECK-CID-TRN-VA.
  5323
  5324***************************************************************
  5325
  5326     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  5327
  5328     IF GTL-IA-ODD-DAYS = ZEROS
  5329         MOVE ZERO               TO  GTL-IA-SGN
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  98
* ELRATE.cbl
  5330     ELSE
  5331         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  5332             MOVE +1             TO  GTL-IA-SGN
  5333         ELSE
  5334             MOVE -1             TO  GTL-IA-SGN.
  5335
  5336     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  5337     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  5338
  5339     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  5340                          GTL-IA-SGN.
  5341
  5342     COMPUTE ANGLEN EQUAL WK1 / I.
  5343     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5344
  5345     IF GTL-IA-ODF NOT = ZERO
  5346         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  5347         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  5348
  5349     COMPUTE GTL-IA-DIVIDEND =
  5350           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  5351                             (ANGLEN - ANGLEN-M))) *
  5352           ((K1 + I) * CP-PREMIUM-RATE *
  5353                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  5354
  5355     COMPUTE GTL-IA-DIVISOR =
  5356      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  5357
  5358     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  5359
  5360     COMPUTE CP-CALC-PREMIUM =
  5361                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  5362     GO TO 99999-RETURN.
  5363
  5364
  5365 12001-CHECK-CID-TRN-VA.
  5366
  5367     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5368        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  5369        (CP-EARN-AS-NET-PAY) AND
  5370        (CP-TRUNCATED-LIFE) AND
  5371        (CP-STATE-STD-ABBRV = CP-STATE)
  5372        CONTINUE
  5373     ELSE
  5374        GO TO 12001-CHECK-CID-TX
  5375     END-IF
  5376
  5377     COMPUTE ANGLEN EQUAL WK1 / I
  5378     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5379     IF WS-WORK-DIS-RATE = ZEROS
  5380        CONTINUE
  5381     ELSE
  5382        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5383        COMPUTE WK7 = (1 / I) *
  5384              (((WK4 ** M - 1) / (WK4 - 1)) -
  5385              ((WK4 ** M * SX - VX) /
  5386              (WK4 * (1 + I) - 1))) *
  5387              (CP-PREMIUM-RATE / 1000)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page  99
* ELRATE.cbl
  5388        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5389        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5390        COMPUTE CP-CALC-PREMIUM =
  5391           WK8 *  ((WK4 * ANGLEN) / 100)
  5392     END-IF
  5393
  5394     GO TO 99999-RETURN
  5395
  5396     .
  5397
  5398 12001-CHECK-CID-TX.
  5399     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5400        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5401        (CP-EARN-AS-NET-PAY) AND
  5402        (WS-WORK-DIS-RATE > ZEROS) AND
  5403        (CP-STATE-STD-ABBRV = CP-STATE)
  5404        CONTINUE
  5405     ELSE
  5406        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5407     END-IF
  5408* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5409     COMPUTE K-I = 1 + (1 * I)
  5410     COMPUTE ANGLEN EQUAL WK1 / I
  5411     COMPUTE ANGLEM EQUAL WK2 / I
  5412     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5413     IF WS-WORK-DIS-RATE = ZEROS
  5414        CONTINUE
  5415     ELSE
  5416        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5417        COMPUTE WK7 = (K-I / I) *
  5418              (((WK4 ** M - 1) / (WK4 - 1)) -
  5419*             ((WK4 ** M * SX - VX) /
  5420              ((WK4 ** M * SX) - VX) /
  5421*             (WK4 * (1 + I) - 1))) *
  5422              (WK4 * (1 + I) - 1)) *
  5423              (CP-PREMIUM-RATE / 1000)
  5424        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5425        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  5426        COMPUTE CP-CALC-PREMIUM =
  5427           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  5428     END-IF
  5429
  5430     GO TO 99999-RETURN
  5431     .
  5432 12001-CHECK-CID-LEV-MN-NEW.
  5433*    IF (CP-COMPANY-ID EQUAL 'CID')
  5434*       AND (CP-STATE-STD-ABBRV = 'MN')
  5435*       AND (CP-EARN-AS-NET-PAY)
  5436*       AND (CP-LEVEL-LIFE)
  5437*       AND (CP-CERT-EFF-DT > X'A4FF')
  5438*       CONTINUE
  5439*    ELSE
  5440*       GO TO 12001-CHECK-CID-LEV-MN
  5441*    END-IF
  5442*
  5443*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5444*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5445*    MOVE '1'                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 100
* ELRATE.cbl
  5446*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5447*
  5448*    IF DATE-CONVERSION-ERROR
  5449*       MOVE '2'                 TO CP-RETURN-CODE
  5450*       MOVE ZEROS               TO FACTOR
  5451*                                   CP-CALC-PREMIUM
  5452*       GO TO 99999-RETURN
  5453*    END-IF
  5454*
  5455*    COMPUTE I = CP-LOAN-APR / 100
  5456*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5457*
  5458*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5459*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5460*      * 12 / 360 * D)
  5461*
  5462*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5463*       * 12 / 360 * D
  5464*
  5465*    GO TO 99999-RETURN
  5466      .
  5467 12001-CHECK-CID-LEV-MN.
  5468
  5469     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5470        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  5471        (CP-EARN-AS-NET-PAY) AND
  5472        (CP-LEVEL-LIFE) AND
  5473        (CP-STATE-STD-ABBRV = CP-STATE)
  5474        CONTINUE
  5475     ELSE
  5476        GO TO 12001-CHECK-CID-LEV-CA
  5477     END-IF
  5478
  5479     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5480         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5481         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5482
  5483     GO TO 99999-RETURN
  5484
  5485      .
  5486 12001-CHECK-CID-LEV-CA.
  5487
  5488     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5489        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5490        (CP-EARN-AS-NET-PAY) AND
  5491        (CP-LEVEL-LIFE) AND
  5492        (CP-STATE-STD-ABBRV = CP-STATE)
  5493        CONTINUE
  5494     ELSE
  5495        GO TO 12001-CHECK-CID-TRN-CA
  5496     END-IF
  5497
  5498     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5499     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5500     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5501     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5502     COMPUTE CP-CALC-PREMIUM =
  5503          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 101
* ELRATE.cbl
  5504          (CP-PREMIUM-RATE / 1000)) /
  5505          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5506
  5507     GO TO 99999-RETURN
  5508
  5509      .
  5510 12001-CHECK-CID-TRN-CA.
  5511
  5512     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5513        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5514        (CP-EARN-AS-NET-PAY) AND
  5515        (CP-TRUNCATED-LIFE) AND
  5516        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5517        (WS-DISCOUNT-OPTION NOT = ' ')
  5518        CONTINUE
  5519     ELSE
  5520        GO TO 12001-CHECK-CID-TRN-MT
  5521     END-IF
  5522
  5523     COMPUTE ANGLEN EQUAL WK1 / I
  5524     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5525     IF WS-WORK-DIS-RATE = ZEROS
  5526        CONTINUE
  5527     ELSE
  5528        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5529        COMPUTE WK7 = (1 / I) *
  5530              (((WK4 ** M - 1) / (WK4 - 1)) -
  5531              ((WK4 ** M * SX - VX) /
  5532              (WK4 * (1 + I) - 1))) *
  5533              (CP-PREMIUM-RATE / 1000)
  5534        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5535        COMPUTE CP-CALC-PREMIUM =
  5536           WK4 *  WK7
  5537     END-IF
  5538
  5539     GO TO 99999-RETURN
  5540
  5541      .
  5542 12001-CHECK-CID-TRN-MT.
  5543
  5544     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5545        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5546                   OR
  5547        ((CP-STATE-STD-ABBRV = 'IN') AND
  5548        (CP-CERT-EFF-DT > X'9A7F'))
  5549                   OR
  5550        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5551        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5552        (CP-EARN-AS-NET-PAY) AND
  5553        (CP-TRUNCATED-LIFE) AND
  5554        (CP-STATE-STD-ABBRV = CP-STATE)
  5555        CONTINUE
  5556     ELSE
  5557        GO TO 12001-CHECK-CID-MT
  5558     END-IF
  5559
  5560* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5561     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 102
* ELRATE.cbl
  5562        MOVE 0                   TO K-I
  5563     ELSE
  5564        MOVE 2                   TO K-I
  5565     END-IF
  5566     COMPUTE CP-TERM-OR-EXT-DAYS =
  5567           CP-TERM-OR-EXT-DAYS + 30
  5568
  5569     COMPUTE ANGLEN EQUAL WK1 / I
  5570     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5571     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5572                   / (1 + I)
  5573     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5574     IF WS-WORK-DIS-RATE = ZEROS
  5575        CONTINUE
  5576     ELSE
  5577        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5578*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5579        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5580              (((WK4 ** M - 1) / (WK4 - 1)) -
  5581              ((WK4 ** M * SX - VX) /
  5582              (WK4 * (1 + I) - 1))) *
  5583              (CP-PREMIUM-RATE / 1000)
  5584        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5585*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5586        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5587        COMPUTE CP-CALC-PREMIUM =
  5588           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5589*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5590     END-IF
  5591
  5592     GO TO 99999-RETURN
  5593
  5594     .
  5595 12001-CHECK-CID-MT.
  5596
  5597     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5598        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5599                                OR 'VT')
  5600                   OR
  5601        ((CP-STATE-STD-ABBRV = 'IN') AND
  5602        (CP-CERT-EFF-DT > X'9A7F'))
  5603                   OR
  5604        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5605        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5606        (CP-EARN-AS-NET-PAY) AND
  5607        (CP-STATE-STD-ABBRV = CP-STATE)
  5608        CONTINUE
  5609     ELSE
  5610        GO TO 12001-CHECK-DCC-DD
  5611     END-IF
  5612
  5613     COMPUTE CP-TERM-OR-EXT-DAYS =
  5614           CP-TERM-OR-EXT-DAYS + 30
  5615
  5616* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5617     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5618        MOVE 0                   TO K-I
  5619     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 103
* ELRATE.cbl
  5620        IF CP-STATE-STD-ABBRV = 'NJ'
  5621           MOVE 1                TO K-I
  5622        ELSE
  5623           MOVE 2                TO K-I
  5624        END-IF
  5625     END-IF
  5626     COMPUTE ANGLEN EQUAL WK1 / I
  5627     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5628     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5629                   / (1 + I)
  5630     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5631     IF WS-WORK-DIS-RATE = ZEROS
  5632        CONTINUE
  5633     ELSE
  5634        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5635*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5636        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5637              (((WK4 ** N - 1) / (WK4 - 1)) -
  5638              ((WK4 ** N - SV) /
  5639              (WK4 * (1 + I) - 1))) *
  5640              (CP-PREMIUM-RATE / 1000)
  5641        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5642*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5643        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5644        COMPUTE CP-CALC-PREMIUM =
  5645           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5646*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5647     END-IF
  5648
  5649     GO TO 99999-RETURN
  5650
  5651     .
  5652 12001-CHECK-DCC-DD.
  5653     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5654        AND (CP-EARN-AS-NET-PAY)
  5655        AND (CP-BEN-CATEGORY = 'D')
  5656        CONTINUE
  5657     ELSE
  5658        GO TO 12001-CHECK-DCC-NET
  5659     END-IF
  5660
  5661     COMPUTE CP-TERM-OR-EXT-DAYS =
  5662           CP-TERM-OR-EXT-DAYS + 30
  5663
  5664     COMPUTE ANGLEN EQUAL WK1 / I.
  5665     COMPUTE ANGLEM EQUAL WK2 / I.
  5666     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5667
  5668     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5669           / (1 + I)
  5670     COMPUTE GR     = ANGLEN / ODF
  5671*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5672*      CP-RATE-DEV-PCT
  5673     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5674     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5675       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5676     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5677     MOVE WK3                    TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 104
* ELRATE.cbl
  5678
  5679     GO TO 99999-RETURN
  5680
  5681     .
  5682 12001-CHECK-DCC-NET.
  5683
  5684     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5685        AND (CP-EARN-AS-NET-PAY)
  5686        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5687             AND 'H' AND 'S' AND 'P')
  5688        CONTINUE
  5689     ELSE
  5690        GO TO 12001-CHECK-DCC-PNET
  5691     END-IF
  5692
  5693     COMPUTE CP-TERM-OR-EXT-DAYS =
  5694           CP-TERM-OR-EXT-DAYS + 30
  5695
  5696     COMPUTE ANGLEN EQUAL WK1 / I.
  5697     COMPUTE ANGLEM EQUAL WK2 / I.
  5698     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5699
  5700     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5701           / (1 + I)
  5702     COMPUTE GR     = ANGLEN / ODF
  5703     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5704     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5705       CP-RATE-DEV-PCT
  5706     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5707*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5708
  5709     COMPUTE WK8 = CP-PREMIUM-RATE *
  5710        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5711     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5712     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5713     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5714       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5715     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5716     MOVE WK3                    TO CP-CALC-PREMIUM
  5717
  5718     GO TO 99999-RETURN
  5719
  5720     .
  5721 12001-CHECK-DCC-PNET.
  5722     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5723        AND (CP-EARN-AS-NET-PAY)
  5724        AND (CP-BENEFIT-CD (1:1) = 'P')
  5725        CONTINUE
  5726     ELSE
  5727        GO TO 12001-CHECK-DCC-MNET
  5728     END-IF
  5729     IF CP-NO-OF-PMTS NOT NUMERIC
  5730        MOVE +0                  TO CP-NO-OF-PMTS
  5731     END-IF
  5732     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5733        AND ' ' AND 'M'
  5734        MOVE ' '                 TO CP-PMT-MODE
  5735     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 105
* ELRATE.cbl
  5736******************************************************************
  5737***   Default is monthly, use loan term for rate and amort     ***
  5738******************************************************************
  5739     move cp-loan-term         to c-tot-pmts
  5740     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5741     MOVE +12                  TO C-PMTS-PER-YEAR
  5742******************************************************************
  5743
  5744     evaluate true
  5745        when cp-pmt-mode = 'W'
  5746           MOVE +52              TO C-PMTS-PER-YEAR
  5747           compute c-tot-pmts = cp-loan-term /
  5748              12 * c-pmts-per-year
  5749           MOVE +7               TO C-DAYS-IN-PMT-PER
  5750        when cp-pmt-mode = 'B'
  5751           MOVE +26              TO C-PMTS-PER-YEAR
  5752           compute c-tot-pmts = cp-loan-term /
  5753              12 * c-pmts-per-year
  5754           MOVE +14              TO C-DAYS-IN-PMT-PER
  5755     end-evaluate
  5756     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5757     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5758        C-DAYS-IN-PMT-PER)) / (1 + I)
  5759     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5760*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5761     COMPUTE ANGLEN-1 = ANGLEN / Y
  5762     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5763     IF CP-RATE-DEV-PCT NOT = ZEROS
  5764        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5765           CP-PREMIUM-RATE
  5766     END-IF
  5767     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5768     GO TO 99999-RETURN
  5769     .
  5770 12001-CHECK-DCC-MNET.
  5771
  5772     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5773        AND (CP-EARN-AS-NET-PAY)
  5774        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5775        CONTINUE
  5776     ELSE
  5777        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5778     END-IF
  5779
  5780*    COMPUTE ANGLEN EQUAL WK1 / I.
  5781*    COMPUTE ANGLEM EQUAL WK2 / I.
  5782*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5783
  5784     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5785     MOVE WK3                    TO CP-CALC-PREMIUM
  5786
  5787     GO TO 99999-RETURN
  5788
  5789     .
  5790 12001-CHECK-DCC-MNET-LF-BAL.
  5791
  5792     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5793        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 106
* ELRATE.cbl
  5794        AND (CP-BENEFIT-CD (1:1) = 'N')
  5795        AND (CP-BEN-CATEGORY NOT = 'N')
  5796        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5797        CONTINUE
  5798     ELSE
  5799        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5800     END-IF
  5801
  5802     IF CP-RATE-DEV-PCT NOT = ZEROS
  5803        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5804           CP-PREMIUM-RATE
  5805     END-IF
  5806*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5807     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5808        / (1 + I)
  5809     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5810     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5811     COMPUTE WK2 = (1 + J) ** (M * -1)
  5812     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5813     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5814          ** ((M - 1) * -1))) / J)
  5815     COMPUTE ANGLEM = ((1 - ((1 + J)
  5816          ** (M * -1))) / J) / OD
  5817     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5818        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5819        / ANGLEM-1
  5820     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5821          ** ((N - M) * -1))) / I)
  5822     MOVE +0                     TO WK3
  5823     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5824        (WS-COUNTER > M)
  5825        COMPUTE ANGLEM = (1 - ((1 + J)
  5826          ** ((M - WS-COUNTER) * -1))) / J
  5827        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5828        COMPUTE WK5-CSL = (RA * ANGLEM)
  5829        + (CP-ALTERNATE-BENEFIT * WK2)
  5830        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5831     END-PERFORM
  5832     MOVE WK3                    TO CP-CALC-PREMIUM
  5833
  5834     GO TO 99999-RETURN
  5835
  5836     .
  5837 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5838
  5839     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5840        AND (CP-EARN-AS-NET-PAY)
  5841        AND (CP-BENEFIT-CD (1:1) = 'S')
  5842        AND (CP-BEN-CATEGORY NOT = 'N')
  5843        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5844        CONTINUE
  5845     ELSE
  5846        GO TO 12001-CHECK-DCC-MNET-LF
  5847     END-IF
  5848
  5849     IF CP-RATE-DEV-PCT NOT = ZEROS
  5850        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5851           CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 107
* ELRATE.cbl
  5852     END-IF
  5853     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5854     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5855          ** ((M - 1) * -1))) / K)
  5856     COMPUTE ANGLEM = ((1 - ((1 + K)
  5857          ** (M * -1))) / K)
  5858     MOVE CP-MONTHLY-PAYMENT     TO RA
  5859     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5860        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5861        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5862        CP-PREMIUM-RATE / 1000
  5863     MOVE WK3                    TO CP-CALC-PREMIUM
  5864
  5865     GO TO 99999-RETURN
  5866
  5867     .
  5868 12001-CHECK-DCC-MNET-LF.
  5869
  5870     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5871        AND (CP-EARN-AS-NET-PAY)
  5872        AND (CP-BENEFIT-CD (1:1) = 'N')
  5873        AND (CP-BEN-CATEGORY NOT = 'N')
  5874        CONTINUE
  5875     ELSE
  5876        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5877     END-IF
  5878
  5879     IF CP-RATE-DEV-PCT NOT = ZEROS
  5880        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5881           CP-PREMIUM-RATE
  5882     END-IF
  5883*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5884     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5885        / (1 + I)
  5886     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5887     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5888     COMPUTE WK2 = (1 + J) ** (M * -1)
  5889     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5890     COMPUTE ANGLEM = ((1 - ((1 + J)
  5891          ** (M * -1))) / J) / OD
  5892     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5893     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5894          ** ((N - M) * -1))) / I)
  5895     MOVE +0                     TO WK3
  5896     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5897        (WS-COUNTER > M)
  5898        COMPUTE ANGLEM = (1 - ((1 + J)
  5899          ** ((M - WS-COUNTER + 1) * -1))) / J
  5900        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5901        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5902        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5903     END-PERFORM
  5904     MOVE WK3                    TO CP-CALC-PREMIUM
  5905
  5906     GO TO 99999-RETURN
  5907
  5908     .
  5909 12001-CHECK-DCC-MNET-SUMLF.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 108
* ELRATE.cbl
  5910
  5911     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5912        AND (CP-EARN-AS-NET-PAY)
  5913        AND (CP-BENEFIT-CD (1:1) = 'S')
  5914        AND (CP-BEN-CATEGORY NOT = 'N')
  5915        CONTINUE
  5916     ELSE
  5917        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5918     END-IF
  5919
  5920     IF CP-RATE-DEV-PCT NOT = ZEROS
  5921        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5922           CP-PREMIUM-RATE
  5923     END-IF
  5924     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5925     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5926        / (1 + K)
  5927     COMPUTE ANGLEN-M = (WK5 / I)
  5928     COMPUTE WK2 = (1 + K) ** (M * -1)
  5929     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5930     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5931     COMPUTE ANGLEM = ((1 - ((1 + K)
  5932          ** (M * -1))) / K) / Y
  5933     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5934     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5935        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5936        - 1)) / K) * RA
  5937     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5938        + (CP-DAYS-TO-1ST-PMT - +30)
  5939        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5940        +0 / 1000 * 12 / 12)
  5941     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5942        * (12 / 12)
  5943     MOVE WK3                    TO CP-CALC-PREMIUM
  5944
  5945     GO TO 99999-RETURN
  5946
  5947     .
  5948 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5949
  5950     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5951        AND (CP-EARN-AS-NET-PAY)
  5952        AND (CP-BENEFIT-CD (1:1) = 'N')
  5953        AND (CP-BEN-CATEGORY = 'N')
  5954        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5955        CONTINUE
  5956     ELSE
  5957        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5958     END-IF
  5959
  5960*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5961     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5962        / (1 + I)
  5963     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5964     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5965     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5966     COMPUTE WK2 = (1 + J) ** (M * -1)
  5967     COMPUTE ANGLEN-M = ANGLEN-M * WK2
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 109
* ELRATE.cbl
  5968     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5969          ** ((M - 1) * -1))) / J)
  5970     COMPUTE ANGLEM = ((1 - ((1 + J)
  5971          ** (M * -1))) / J) / OD
  5972     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5973        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5974        / ANGLEM-1
  5975     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5976          ** ((N - M) * -1))) / I)
  5977     MOVE +0                     TO WK3
  5978     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5979        (WS-COUNTER > M)
  5980        COMPUTE ANGLEM = (1 - ((1 + J)
  5981          ** ((M - WS-COUNTER) * -1))) / J
  5982        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5983        COMPUTE WK5-CSL = (RA * ANGLEM)
  5984        + (CP-ALTERNATE-BENEFIT * WK2)
  5985        COMPUTE WK3 = WK3 +
  5986         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5987        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5988          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5989          (CP-DCC-AH-RATE / 1000)
  5990     END-PERFORM
  5991     MOVE WK3                    TO CP-CALC-PREMIUM
  5992
  5993     GO TO 99999-RETURN
  5994
  5995     .
  5996 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5997
  5998     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5999        AND (CP-EARN-AS-NET-PAY)
  6000        AND (CP-BENEFIT-CD (1:1) = 'S')
  6001        AND (CP-BEN-CATEGORY = 'N')
  6002        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  6003        CONTINUE
  6004     ELSE
  6005        GO TO 12001-CHECK-DCC-MNET-TOT-N
  6006     END-IF
  6007
  6008     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6009     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  6010          ** ((M - 1) * -1))) / K)
  6011     COMPUTE ANGLEM = ((1 - ((1 + K)
  6012          ** (M * -1))) / K)
  6013     MOVE CP-MONTHLY-PAYMENT     TO RA
  6014     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  6015        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  6016        * CP-DCC-AH-RATE / 1000))
  6017        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  6018        CP-DCC-LF-RATE / 1000
  6019     MOVE WK3                    TO CP-LF-PREM
  6020     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  6021        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  6022        * CP-DCC-AH-RATE / 1000
  6023     COMPUTE WK3 = WK3 + WK5-CSL
  6024     MOVE WK3                    TO CP-CALC-PREMIUM
  6025
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 110
* ELRATE.cbl
  6026     GO TO 99999-RETURN
  6027      .
  6028 12001-CHECK-DCC-MNET-TOT-N.
  6029
  6030     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6031        AND (CP-EARN-AS-NET-PAY)
  6032        AND (CP-BENEFIT-CD (1:1) = 'N')
  6033        AND (CP-BEN-CATEGORY = 'N')
  6034        CONTINUE
  6035     ELSE
  6036        GO TO 12001-CHECK-DCC-MNET-TOT-S
  6037     END-IF
  6038
  6039*    I = APR/1200
  6040*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  6041*    RA = PAYMENT AMOUNT
  6042*    WK5-CSL = THE BALANCE (PAY OFF )
  6043*    WK3 = THE ACCUMULATED PREMIUM
  6044*    WK2 = (1 + I) ^ (m * -1)
  6045*    OD  = GAMMA
  6046*
  6047*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  6048     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  6049        / (1 + I)
  6050     COMPUTE ANGLEN-M = (WK5 / I) / OD
  6051     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  6052        (CP-DCC-AH-RATE / +1000)
  6053     COMPUTE WK2 = (1 + J) ** (M * -1)
  6054     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6055     COMPUTE ANGLEM = ((1 - ((1 + J)
  6056          ** (M * -1))) / J) / OD
  6057     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6058     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6059          ** ((N - M) * -1))) / I)
  6060     MOVE +0                     TO WK3
  6061     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  6062        (WS-COUNTER > M)
  6063        COMPUTE ANGLEM = (1 - ((1 + J)
  6064          ** ((M - WS-COUNTER + 1) * -1))) / J
  6065        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  6066        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  6067        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  6068           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  6069     END-PERFORM
  6070     MOVE WK3                    TO CP-CALC-PREMIUM
  6071
  6072     GO TO 99999-RETURN
  6073
  6074     .
  6075 12001-CHECK-DCC-MNET-TOT-S.
  6076
  6077     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6078        AND (CP-EARN-AS-NET-PAY)
  6079        AND (CP-BENEFIT-CD (1:1) = 'S')
  6080        AND (CP-BEN-CATEGORY = 'N')
  6081        CONTINUE
  6082     ELSE
  6083        GO TO 12001-CONTINUE-NET
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 111
* ELRATE.cbl
  6084     END-IF
  6085
  6086*    I = APR/1200
  6087*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  6088*    RA = PAYMENT AMOUNT
  6089*    WK5-CSL = THE BALANCE (PAY OFF )
  6090*    WK3 = THE ACCUMULATED PREMIUM
  6091*    WK2 = (1 + I) ^ (m * -1)
  6092*    OD  = GAMMA
  6093*
  6094     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  6095     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  6096        / (1 + J)
  6097     COMPUTE ANGLEM = ((1 - ((1 + J)
  6098          ** (M * -1))) / J) / OD
  6099     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6100          ** ((N - M) * -1))) / I)
  6101          * (1 + J) ** (-1 * M)
  6102     COMPUTE ANGLEN-M = ANGLEN-M / OD
  6103     MOVE CP-MONTHLY-PAYMENT     TO RA
  6104     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  6105        / +30)
  6106     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  6107        ** (WK1) - 1)) / J) * RA
  6108     COMPUTE WK5 = (((((M * (M + 1) / 2)
  6109        + (CP-DAYS-TO-1ST-PMT - +30)
  6110        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  6111        CP-DCC-AH-RATE / +1000 * 12 / 12)
  6112     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  6113        (12 / 12)
  6114     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  6115        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  6116        (CP-DCC-AH-RATE / +1000) * 12 / 12
  6117     COMPUTE WK3 = WK3 + WK5-CSL
  6118     MOVE WK3                    TO CP-CALC-PREMIUM
  6119     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6120     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  6121        / (1 + K)
  6122     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6123          ** ((N - M) * -1))) / I)
  6124     COMPUTE WK2 = (1 + K) ** (M * -1)
  6125     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6126     COMPUTE ANGLEN-M = ANGLEN-M / Y
  6127     COMPUTE ANGLEM = ((1 - ((1 + K)
  6128          ** (M * -1))) / K) / Y
  6129*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6130     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  6131        ((1 + K) ** (M + 1 / Y
  6132        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  6133        - 1)) / K) * RA
  6134     COMPUTE WK7 = (((((M * (M + 1) / 2)
  6135        + (CP-DAYS-TO-1ST-PMT - +30)
  6136        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  6137        CP-DCC-AH-RATE / 1000 * 12 / 12)
  6138     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  6139        * (12 / 12)
  6140     MOVE WK3                    TO CP-LF-PREM
  6141
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 112
* ELRATE.cbl
  6142     GO TO 99999-RETURN
  6143
  6144     .
  6145 12001-CONTINUE-NET.
  6146
  6147     IF NET-STD
  6148        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  6149*          OR 'DCC'
  6150         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6151         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6152         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6153         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  6154                               * ((1 + N) / (1 + M))
  6155         if (i = .0000000001)
  6156            and (wk3 = zeros)
  6157            move 1               to wk3
  6158         end-if
  6159        ELSE
  6160         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6161         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6162         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6163         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  6164
  6165     IF NET-SMP
  6166         COMPUTE N2 = N * N
  6167         COMPUTE N3 = N2 * N
  6168         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  6169         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  6170         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  6171         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  6172         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  6173
  6174     IF NPO-PRUDENTIAL
  6175       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  6176           VARYING WS-COUNTER FROM 1 BY 1
  6177               UNTIL WS-COUNTER = N
  6178       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  6179       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  6180
  6181     MOVE WK3 TO FACTOR.
  6182
  6183     GO TO 99999-RETURN.
  6184
  6185 12100-PRU-CALC.
  6186     IF WS-COUNTER = 1
  6187         COMPUTE PWK = (I + 1)
  6188     ELSE
  6189         COMPUTE PWK = PWK * (I + 1).
  6190
  6191 12199-EXIT.
  6192      EXIT.
  6193
  6194 99000-ERROR.
  6195     MOVE +9999.999999999 TO N-P-FACTOR.
  6196     MOVE '4'             TO CP-RETURN-CODE.
  6197
  6198     GO TO 99999-EXIT.
  6199
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 09:00 Page 113
* ELRATE.cbl
  6200 99999-RETURN.
  6201     MOVE FACTOR          TO N-P-FACTOR.
  6202
  6203 99999-EXIT.
  6204      EXIT.
  6205 99999-DUMMY-STOP-RUN.
  6206
  6207* GOBACK.
  6208     MOVE '9%                    "   ' TO DFHEIV0
  6209     MOVE 'ELRATE' TO DFHEIV1
  6210     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6211     GOBACK.
  6212
  6213
  6214 9999-DFHBACK SECTION.
  6215     MOVE '9%                    "   ' TO DFHEIV0
  6216     MOVE 'ELRATE' TO DFHEIV1
  6217     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6218     GOBACK.
  6219 9999-DFHEXIT.
  6220     IF DFHEIGDJ EQUAL 0001
  6221         NEXT SENTENCE
  6222     ELSE IF DFHEIGDJ EQUAL 2
  6223         GO TO 9999-RATE-NOTFND,
  6224               9999-RATE-NOTOPEN,
  6225               9999-RATE-NOTFND
  6226         DEPENDING ON DFHEIGDI.
  6227     MOVE '9%                    "   ' TO DFHEIV0
  6228     MOVE 'ELRATE' TO DFHEIV1
  6229     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6230     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3152     Code:       57310
