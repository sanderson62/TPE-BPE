* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40******************************************************************
    41
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   3
* EL130.cbl
    43 ENVIRONMENT DIVISION.
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    50 77  A1                          PIC S999 COMP-3 VALUE +0.
    51 77  E1                          PIC S999 COMP-3 VALUE +0.
    52 77  s1                          pic s999 comp-3 value +0.
    53 77  s2                          pic s999 comp-3 value +0.
    54 77  P1                          PIC S999 COMP-3 VALUE +0.
    55 77  P2                          PIC S999 COMP-3 VALUE +0.
    56 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    57 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    58 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    59 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    60 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    61 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    62 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    63 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    64     88  ERPDEF-FOUND                 VALUE 'Y'.
    65 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    66 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    67 77  ws-dcc-product-code         pic xxx value spaces.
    68
    69*    COPY ELCSCTM.
    70******************************************************************
    71*                                                                *
    72*                                                                *
    73*                            ELCSCTM                             *
    74*                            VMOD=2.001                          *
    75*                                                                *
    76*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    77*                                                                *
    78******************************************************************
    79 01  SECURITY-MESSAGE.
    80     12  FILLER                          PIC X(30)
    81            VALUE '** LOGIC SECURITY VIOLATION -'.
    82     12  SM-READ                         PIC X(6).
    83     12  FILLER                          PIC X(5)
    84            VALUE ' PGM='.
    85     12  SM-PGM                          PIC X(6).
    86     12  FILLER                          PIC X(5)
    87            VALUE ' OPR='.
    88     12  SM-PROCESSOR-ID                 PIC X(4).
    89     12  FILLER                          PIC X(6)
    90            VALUE ' TERM='.
    91     12  SM-TERMID                       PIC X(4).
    92     12  FILLER                          PIC XX   VALUE SPACE.
    93     12  SM-JUL-DATE                     PIC 9(5).
    94     12  FILLER                          PIC X    VALUE SPACE.
    95     12  SM-TIME                         PIC 99.99.
    96
    97
    98*    COPY ELCSCRTY.
    99******************************************************************
   100*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   4
* EL130.cbl
   101*                                                                *
   102*                            ELCSCRTY                            *
   103*                            VMOD=2.001                          *
   104*                                                                *
   105*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   106*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   107*        SAVED IN PI-SECURITY-ADDRESS.                           *
   108*                                                                *
   109******************************************************************
   110 01  SECURITY-CONTROL.
   111     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   112     12  FILLER                       PIC XX    VALUE 'SC'.
   113     12  SC-CREDIT-CODES.
   114         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   115             20  SC-CREDIT-DISPLAY    PIC X.
   116             20  SC-CREDIT-UPDATE     PIC X.
   117     12  SC-CLAIMS-CODES.
   118         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   119             20  SC-CLAIMS-DISPLAY    PIC X.
   120             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   5
* EL130.cbl
   122 01  WS-DATE-AREA.
   123     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   124     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   125     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   126
   127 01  ws-dcc-error-line.
   128     05  filler occurs 15.
   129         10  ws-error-no        pic x(4).
   130 01  WS-CRI-SSN-WORK-AREA.
   131     05  WS-CRI-SOC-SEC-NO.
   132         10  WS-SS-REPT-CD       PIC X(5).
   133         10  WS-SS-LAST-NAME     PIC X(5).
   134         10  WS-SS-INITIAL       PIC X.
   135
   136     05  WS-CRI-REPORT-CODE.
   137         10  FILLER              PIC X(5).
   138         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   139
   140     05  WS-CRI-LAST-NAME.
   141         10  WS-CRI-NAME-MOVE    PIC X(5).
   142         10  FILLER              PIC X(10).
   143
   144 01  STANDARD-AREAS.
   145     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   146     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   147     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   148     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   149     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   150     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   151     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   152     12  PGM-NAME            PIC X(8).
   153     12  TIME-IN             PIC S9(7).
   154     12  TIME-OUT-R  REDEFINES TIME-IN.
   155         16  FILLER          PIC X.
   156         16  TIME-OUT        PIC 99V99.
   157         16  FILLER          PIC X(2).
   158     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   159     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   160     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   161     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   162     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   163     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   164     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   165     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   166     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   167     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   168     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   169     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   170     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   171     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   172     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   173     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   174     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   175     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   176     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   177     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   178     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   179     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   6
* EL130.cbl
   180     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   181     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   182     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   183     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   184     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   185     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   186     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   187     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   188     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   189     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   190     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   191     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   192     12  FILE-ID             PIC X(8).
   193     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   194     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   195     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   196     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   197     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   198     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   199     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   200     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   201     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   202
   203 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   204     12  M                   PIC S9(7)V99           VALUE ZEROS.
   205     12  L                   PIC S9(7)V99           VALUE ZEROS.
   206     12  N                   PIC S9(3)              VALUE ZEROS.
   207     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   208     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   209     12  I                   PIC S99V9(5)           VALUE ZEROS.
   210     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   211     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   212     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   213     12  R                   PIC S9(3)              VALUE ZEROS.
   214     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   215     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   216     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   217     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   218     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   219     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   220     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   221     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   222     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   223
   224 01  TERM-CALC-WORK-AREA.
   225     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   226     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   227     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   228     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   229     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   230     12  V-EXPONENTS.
   231        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   232     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   233
   234 01  MISC-WORK-AREAS.
   235     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   236     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   237     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   7
* EL130.cbl
   238     12  QID.
   239         16  QID-TERM        PIC X(4).
   240         16  FILLER          PIC X(4)    VALUE '130A'.
   241     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   242     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   243     12  WS-GROUP-NO.
   244         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   245         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   246
   247     12  WS-RESPONSE         PIC S9(8)   COMP.
   248         88  WS-RESP-NORMAL              VALUE +00.
   249         88  WS-RESP-ERROR               VALUE +01.
   250         88  WS-RESP-NOTFND              VALUE +13.
   251         88  WS-RESP-DUPKEY              VALUE +15.
   252         88  WS-RESP-NOTOPEN             VALUE +19.
   253         88  WS-RESP-ENDFILE             VALUE +20.
   254
   255***************************************************************
   256*                                                             *
   257*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   258*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   259*    CHANGES WITH IN MAP EL130A.                              *
   260*                                                             *
   261***************************************************************
   262
   263     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   264     12  WS-SAVE-CLAIM-MASTER.
   265         16  FILLER                    PIC XX.
   266         16  WS-SAVE-CLAIM-KEY.
   267             20  WS-SAVE-COMPANY-CD    PIC X.
   268             20  WS-SAVE-CARRIER       PIC X.
   269             20  WS-SAVE-CLAIM-NO      PIC X(7).
   270             20  WS-SAVE-CERT-NO       PIC X(11).
   271         16  FILLER                    PIC X(328).
   272     12  SAVE-CURRENT-DATE         PIC XX.
   273     12  SAVE-CONTROL              PIC X(39).
   274     12  SAVE-ERACCT-KEY           PIC X(26).
   275     12  SAVE-COUNTER              PIC S9(8)   COMP.
   276     12  SAVE-METHOD               PIC X.
   277     12  SAVE-COMPANY-ID           PIC XXX.
   278     12  SAVE-COMPANY-CD           PIC X.
   279     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   280     12  SAVE-CREDIT-USER          PIC X.
   281     12  SAVE-CLAIM-USER           PIC X.
   282     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   283     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   284     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   285     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   286     12  SAVE-AH-OVERRIDE-L1       PIC X.
   287     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   288     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   289     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   290     12  FILLER                    PIC X.
   291*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   292     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   293     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   294     12  SAVE-EL127-TO-EL130-CNTRL.
   295         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   8
* EL130.cbl
   296         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   297         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   298             20  SAVE-EL127-CARRIER  PIC X.
   299             20  SAVE-EL127-GROUPING PIC X(6).
   300             20  SAVE-EL127-STATE    PIC X(2).
   301             20  SAVE-EL127-ACCOUNT  PIC X(10).
   302             20  SAVE-EL127-CERT-NO  PIC X(11).
   303             20  SAVE-EL127-EFF-DT   PIC XX.
   304     12  SAVE-EL659-TO-EL130-CNTRL.
   305         16  SAVE-EL659-CARRIER    PIC X.
   306         16  SAVE-EL659-GROUPING   PIC X(6).
   307         16  SAVE-EL659-STATE      PIC XX.
   308         16  SAVE-EL659-ACCOUNT    PIC X(10).
   309     12  DIVIDE-QUOT               PIC 999.
   310     12  DIVIDE-REM                PIC 999.
   311     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   312     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   313     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   314     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   315     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   316     12  WS-RESERVE-CONTROLS       PIC X(9).
   317     12  WS-EXPENSE-CONTROLS       PIC X(7).
   318     12  WS-REIN-TABLE.
   319         16  WS-REIN-1             PIC X            VALUE SPACE.
   320         16  WS-REIN-2             PIC X            VALUE SPACE.
   321         16  WS-REIN-3             PIC X            VALUE SPACE.
   322     12  WS-BENE-CALC-METHOD       PIC X.
   323     12  WS-EARNINGS-CALC          PIC X.
   324     12  WS-LF-EARNINGS-CALC       PIC X.
   325         88 TEX-REG                VALUE '4'.
   326         88 NET-PAY                VALUE '5'.
   327     12  WS-AH-EARNINGS-CALC       PIC X.
   328     12  WS-SPECIAL-CALC-CD        PIC X(01).
   329     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   330     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   331     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   332     12  WS-ICD-CODE-1             PIC X(8).
   333     12  WS-ICD-CODE-2             PIC X(8).
   334     12  WS-CLAIM-NUMBER.
   335         16  WS-CN-PREFIX.
   336             20  WS-CN-PRF-A PIC X.
   337             20  WS-CN-PRF-B PIC X.
   338         16  WS-CN-NUMBER    PIC 9(5).
   339     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   340     12  WS-CLAIM-SEQU.
   341         16  FILLER          PIC X    VALUE '('.
   342         16  WS-CURRENT-SEQU PIC Z9.
   343         16  FILLER          PIC X(4) VALUE ' OF '.
   344         16  WS-OF-SEQU      PIC Z9.
   345         16  FILLER          PIC X    VALUE ')'.
   346     12  DATE-WORK.
   347       14  FILLER                PIC XX.
   348       14  DATE-MM               PIC XX.
   349       14  DATE-DD               PIC XX.
   350       14  DATE-YY               PIC XX.
   351     12  CURR-DATE REDEFINES DATE-WORK.
   352         16  CURR-MM.
   353           18  CURR-M1           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page   9
* EL130.cbl
   354           18  CURR-M2           PIC 9.
   355         16  FILLER              PIC X(5).
   356         16  CURR-YEAR           PIC 9.
   357     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   358     12  SUB                     PIC 99.
   359     12  MY-DATE.
   360         16  MY-MM               PIC XX.
   361         16  FILLER              PIC X VALUE '/'.
   362         16  MY-YY               PIC XX.
   363
   364     12  WS-EDIT-BEN-CODE        PIC XX.
   365         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   366                                          '90' THRU '99'.
   367
   368     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   369     12  WS-BEN-HOLD             PIC XX.
   370     12  WS-BEN-ALPHA-HOLD.
   371         15  WS-BEN-ALPHA-2      PIC XX.
   372         15  WS-BEN-ALPHA-1      PIC X.
   373     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   374     12  WS-REC-TYPE             PIC X.
   375     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   376     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   377     12  ARCH-NUMBER             PIC S9(8)   COMP.
   378     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   379         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   380         88  REIN-REC-FOUND                  VALUE 'Y'.
   381
   382     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   383     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   384
   385
   386 01  CSO-WORK-FIELDS.
   387     12  WS-BLANK            PIC X       VALUE ' '.
   388
   389     12  WS-MA-CONTROL-PRIMARY.
   390         16  WS-MA-COMPANY-CD        PIC  X.
   391         16  WS-MA-CARRIER           PIC  X.
   392         16  WS-MA-GROUPING          PIC  X(6).
   393         16  WS-MA-STATE             PIC  XX.
   394         16  WS-MA-ACCOUNT           PIC  X(10).
   395         16  WS-MA-CERT-EFF-DT       PIC  XX.
   396         16  WS-MA-CERT-NO.
   397             20  WS-MA-CERT-PRIME    PIC  X(10).
   398             20  WS-MA-CERT-SFX      PIC  X.
   399
   400     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   401     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   402     12  WS-SOC-SEC-NUMBER.
   403         16  WS-SOC-SEC-NO       PIC 9(9).
   404         16  WS-SOC-SEC-BLANK    PIC X(2).
   405     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   406         16  WS-SSN-1-3          PIC 9(3).
   407         16  WS-SSN-DASH1        PIC X(1).
   408         16  WS-SSN-4-5          PIC 9(2).
   409         16  WS-SSN-DASH2        PIC X(1).
   410         16  WS-SSN-6-9          PIC 9(4).
   411
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  10
* EL130.cbl
   412     12  WS-DIAG-VIN-MSG.
   413         16  FILLER          PIC X(11)
   414             VALUE 'VIN NUMBER '.
   415         16  WS-DIAG-VIN     PIC X(17).
   416
   417     12  WS-VERIFY-NOTE      PIC X(34)
   418         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   419
   420     12  WS-CAUSAL-NOTE      PIC X(40)
   421         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   422
   423     12  WS-VFY-SSN-NOTE     PIC X(25)
   424         VALUE 'SSN VERIFICATION REQUIRED'.
   425
   426 01  MAP-DATE-AREAS.
   427     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   428     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   429     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   430     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   431     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   432     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   433     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   434     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   435     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   436     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   437     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   438     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   439     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   440     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   441     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   442     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   443     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   444     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   445     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   446         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   447     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   448     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   449     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   450     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   451
   452 01  ACCESS-KEYS.
   453     12  ELACTQ-KEY.
   454         16  ELACTQ-COMPANY-CD       PIC X.
   455         16  ELACTQ-CARRIER          PIC X.
   456         16  ELACTQ-CLAIM-NO         PIC X(7).
   457         16  ELACTQ-CERT-NO          PIC X(11).
   458     12  ELMSTR-KEY.
   459         16  MSTR-COMP-CD            PIC X.
   460         16  MSTR-CARRIER            PIC X.
   461         16  MSTR-CLAIM-NO           PIC X(7).
   462         16  MSTR-CERT-NO.
   463             20  MSTR-CERT-NO-PRIME  PIC X(10).
   464             20  MSTR-CERT-NO-SUFX   PIC X.
   465     12  SAVE-ELMSTR-KEY.
   466         16  SAVE-COMP-CD            PIC X.
   467         16  SAVE-CARRIER            PIC X.
   468         16  SAVE-CLAIM-NO           PIC X(7).
   469         16  SAVE-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  11
* EL130.cbl
   470             20  SAVE-CERT-NO-PRIME  PIC X(10).
   471             20  SAVE-CERT-NO-SUFX   PIC X.
   472     12  ELMSTR5-KEY.
   473         16  MSTR5-COMP-CD           PIC X.
   474         16  MSTR5-CERT-NO.
   475             20  MSTR5-CERT-NO-PRIME PIC X(10).
   476             20  MSTR5-CERT-NO-SUFX  PIC X.
   477     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   478         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   479         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   480         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   481     12  ELCNTL-KEY.
   482         16  CNTL-COMP-ID    PIC X(3).
   483         16  CNTL-REC-TYPE   PIC X.
   484         16  CNTL-ACCESS.
   485             20  FILLER      PIC XX.
   486             20  CNTL-BENEFIT.
   487                 24  FILLER  PIC X.
   488                 24  CNTL-CARRIER PIC X.
   489         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   490     12  ELCERT-KEY.
   491         16  CERT-COMP-CD    PIC X.
   492         16  CERT-CARRIER    PIC X.
   493         16  CERT-GROUPING   PIC X(6).
   494         16  CERT-STATE      PIC X(2).
   495         16  CERT-ACCOUNT.
   496             20  CERT-ACCOUNT-PREFIX PIC X(4).
   497             20  CERT-ACCOUNT-PRIME  PIC X(6).
   498         16  CERT-EFF-DT     PIC XX.
   499         16  CERT-CERT-NO.
   500             20  CERT-CERT-NO-PRIME  PIC X(10).
   501             20  CERT-CERT-NO-SUFX   PIC X.
   502     12  ELCERT-KEY-5.
   503         16  CERT-COMP-CD-5      PIC X.
   504         16  CERT-CERT-5.
   505             20  CERT-CERT-5-PRIME   PIC X(10).
   506             20  CERT-CERT-5-SUFX    PIC X.
   507     12  ERACCT-KEY.
   508         16  ACCT-COMP-CD    PIC X.
   509         16  ACCT-CARRIER    PIC X.
   510         16  ACCT-GROUPING   PIC X(6).
   511         16  ACCT-STATE      PIC X(2).
   512         16  ACCT-ACCOUNT    PIC X(10).
   513         16  ACCT-EXP-DT     PIC XX.
   514     12  ELTRLR-KEY.
   515         16  TRLR-COMP-CD    PIC X.
   516         16  TRLR-CARRIER    PIC X.
   517         16  TRLR-CLAIM-NO   PIC X(7).
   518         16  TRLR-CERT-NO.
   519             20  TRLR-CERT-NO-PRIME  PIC X(10).
   520             20  TRLR-CERT-NO-SUFX   PIC X.
   521         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   522         16  TRLR-TYPE       PIC X.
   523     12  ELBENE-KEY.
   524         16  BENE-COMP-CD    PIC X.
   525         16  BENE-RCD-TYPE   PIC X.
   526         16  BENE-CODE       PIC X(10).
   527     12  ERREIN-KEY.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  12
* EL130.cbl
   528         16  REIN-COMP-CD        PIC X(01).
   529         16  REIN-TYPE           PIC X(01).
   530         16  REIN-TABLE-CO.
   531             20  REIN-CODE-1     PIC X(01).
   532             20  REIN-CODE-2     PIC X(01).
   533             20  REIN-CODE-3     PIC X(01).
   534         16  FILLER              PIC X(03).
   535     12  ELCRTT-KEY.
   536         16  CTRLR-COMP-CD       PIC X.
   537         16  CTRLR-CARRIER       PIC X.
   538         16  CTRLR-GROUPING      PIC X(6).
   539         16  CTRLR-STATE         PIC X(2).
   540         16  CTRLR-ACCOUNT       PIC X(10).
   541         16  CTRLR-EFF-DT        PIC XX.
   542         16  CTRLR-CERT-NO       PIC X(11).
   543         16  CTRLR-REC-TYPE      PIC X.
   544 01  ERPDEF-KEY-SAVE             PIC X(18).
   545 01  ERPDEF-KEY.
   546     12  ERPDEF-COMPANY-CD       PIC X.
   547     12  ERPDEF-STATE            PIC XX.
   548     12  ERPDEF-PROD-CD          PIC XXX.
   549     12  F                       PIC X(7).
   550     12  ERPDEF-BEN-TYPE         PIC X.
   551     12  ERPDEF-BEN-CODE         PIC XX.
   552     12  ERPDEF-EXP-DT           PIC XX.
   553 01  ERROR-MESSAGES.
   554     12  ER-0000                 PIC X(4)  VALUE '0000'.
   555     12  ER-0004                 PIC X(4)  VALUE '0004'.
   556     12  ER-0019                 PIC X(4)  VALUE '0019'.
   557     12  ER-0023                 PIC X(4)  VALUE '0023'.
   558     12  ER-0029                 PIC X(4)  VALUE '0029'.
   559     12  ER-0033                 PIC X(4)  VALUE '0033'.
   560     12  ER-0068                 PIC X(4)  VALUE '0068'.
   561     12  ER-0070                 PIC X(4)  VALUE '0070'.
   562     12  ER-0194                 PIC X(4)  VALUE '0194'.
   563     12  ER-0202                 PIC X(4)  VALUE '0202'.
   564     12  ER-0203                 PIC X(4)  VALUE '0203'.
   565     12  ER-0204                 PIC X(4)  VALUE '0204'.
   566     12  ER-0205                 PIC X(4)  VALUE '0205'.
   567     12  ER-0206                 PIC X(4)  VALUE '0206'.
   568     12  ER-0207                 PIC X(4)  VALUE '0207'.
   569     12  ER-0213                 PIC X(4)  VALUE '0213'.
   570     12  ER-0214                 PIC X(4)  VALUE '0214'.
   571     12  ER-0217                 PIC X(4)  VALUE '0217'.
   572     12  ER-0219                 PIC X(4)  VALUE '0219'.
   573     12  ER-0220                 PIC X(4)  VALUE '0220'.
   574     12  ER-0221                 PIC X(4)  VALUE '0221'.
   575     12  ER-0222                 PIC X(4)  VALUE '0222'.
   576     12  ER-0223                 PIC X(4)  VALUE '0223'.
   577     12  ER-0224                 PIC X(4)  VALUE '0224'.
   578     12  ER-0225                 PIC X(4)  VALUE '0225'.
   579     12  ER-0226                 PIC X(4)  VALUE '0226'.
   580     12  ER-0227                 PIC X(4)  VALUE '0227'.
   581     12  ER-0229                 PIC X(4)  VALUE '0229'.
   582     12  ER-0230                 PIC X(4)  VALUE '0230'.
   583     12  ER-0231                 PIC X(4)  VALUE '0231'.
   584     12  ER-0232                 PIC X(4)  VALUE '0232'.
   585     12  ER-0233                 PIC X(4)  VALUE '0233'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  13
* EL130.cbl
   586     12  ER-0234                 PIC X(4)  VALUE '0234'.
   587     12  ER-0235                 PIC X(4)  VALUE '0235'.
   588     12  ER-0236                 PIC X(4)  VALUE '0236'.
   589     12  ER-0237                 PIC X(4)  VALUE '0237'.
   590     12  ER-0238                 PIC X(4)  VALUE '0238'.
   591     12  ER-0239                 PIC X(4)  VALUE '0239'.
   592     12  ER-0240                 PIC X(4)  VALUE '0240'.
   593     12  ER-0241                 PIC X(4)  VALUE '0241'.
   594     12  ER-0243                 PIC X(4)  VALUE '0243'.
   595     12  ER-0244                 PIC X(4)  VALUE '0244'.
   596     12  ER-0245                 PIC X(4)  VALUE '0245'.
   597     12  ER-0246                 PIC X(4)  VALUE '0246'.
   598     12  ER-0247                 PIC X(4)  VALUE '0247'.
   599     12  ER-0248                 PIC X(4)  VALUE '0248'.
   600     12  ER-0250                 PIC X(4)  VALUE '0250'.
   601     12  ER-0251                 PIC X(4)  VALUE '0251'.
   602     12  ER-0252                 PIC X(4)  VALUE '0252'.
   603     12  ER-0253                 PIC X(4)  VALUE '0253'.
   604     12  ER-0254                 PIC X(4)  VALUE '0254'.
   605     12  ER-0257                 PIC X(4)  VALUE '0257'.
   606     12  ER-0258                 PIC X(4)  VALUE '0258'.
   607     12  ER-0260                 PIC X(4)  VALUE '0260'.
   608     12  ER-0261                 PIC X(4)  VALUE '0261'.
   609     12  ER-0263                 PIC X(4)  VALUE '0263'.
   610     12  ER-0264                 PIC X(4)  VALUE '0264'.
   611     12  ER-0265                 PIC X(4)  VALUE '0265'.
   612     12  ER-0266                 PIC X(4)  VALUE '0266'.
   613     12  ER-0267                 PIC X(4)  VALUE '0267'.
   614     12  ER-0334                 PIC X(4)  VALUE '0334'.
   615     12  ER-0337                 PIC X(4)  VALUE '0337'.
   616     12  ER-0412                 PIC X(4)  VALUE '0412'.
   617     12  ER-0413                 PIC X(4)  VALUE '0413'.
   618     12  ER-0428                 PIC X(4)  VALUE '0428'.
   619     12  ER-0429                 PIC X(4)  VALUE '0429'.
   620     12  ER-0430                 PIC X(4)  VALUE '0430'.
   621     12  ER-0433                 PIC X(4)  VALUE '0433'.
   622     12  ER-0434                 PIC X(4)  VALUE '0434'.
   623     12  ER-0458                 PIC X(4)  VALUE '0458'.
   624     12  ER-0489                 PIC X(4)  VALUE '0489'.
   625     12  ER-0509                 PIC X(4)  VALUE '0509'.
   626     12  ER-0510                 PIC X(4)  VALUE '0510'.
   627     12  ER-0511                 PIC X(4)  VALUE '0511'.
   628     12  ER-0512                 PIC X(4)  VALUE '0512'.
   629     12  ER-0516                 PIC X(4)  VALUE '0516'.
   630     12  ER-0517                 PIC X(4)  VALUE '0517'.
   631     12  ER-0518                 PIC X(4)  VALUE '0518'.
   632     12  ER-0519                 PIC X(4)  VALUE '0519'.
   633     12  ER-0520                 PIC X(4)  VALUE '0520'.
   634     12  ER-0521                 PIC X(4)  VALUE '0521'.
   635     12  ER-0522                 PIC X(4)  VALUE '0522'.
   636     12  ER-0523                 PIC X(4)  VALUE '0523'.
   637     12  ER-0544                 PIC X(4)  VALUE '0544'.
   638     12  ER-0546                 PIC X(4)  VALUE '0546'.
   639     12  ER-0558                 PIC X(4)  VALUE '0558'.
   640     12  ER-0560                 PIC X(4)  VALUE '0560'.
   641     12  ER-0562                 PIC X(4)  VALUE '0562'.
   642     12  ER-0565                 PIC X(4)  VALUE '0565'.
   643     12  ER-0569                 PIC X(4)  VALUE '0569'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  14
* EL130.cbl
   644     12  ER-0693                 PIC X(4)  VALUE '0693'.
   645     12  ER-0715                 PIC X(4)  VALUE '0715'.
   646     12  ER-0840                 PIC X(4)  VALUE '0840'.
   647     12  ER-0841                 PIC X(4)  VALUE '0841'.
   648     12  ER-0842                 PIC X(4)  VALUE '0842'.
   649     12  ER-0843                 PIC X(4)  VALUE '0843'.
   650     12  ER-0878                 PIC X(4)  VALUE '0878'.
   651     12  ER-0887                 PIC X(4)  VALUE '0887'.
   652     12  ER-0992                 PIC X(4)  VALUE '0992'.
   653     12  ER-1651                 PIC X(4)  VALUE '1651'.
   654     12  ER-1652                 PIC X(4)  VALUE '1652'.
   655     12  ER-1653                 PIC X(4)  VALUE '1653'.
   656     12  ER-1654                 PIC X(4)  VALUE '1654'.
   657     12  ER-1655                 PIC X(4)  VALUE '1655'.
   658     12  er-1659                 pic x(4)  value '1659'.
   659     12  er-1660                 pic x(4)  value '1660'.
   660     12  er-1661                 pic x(4)  value '1661'.
   661     12  ER-2280                 PIC X(4)  VALUE '2280'.
   662     12  ER-2370                 PIC X(4)  VALUE '2370'.
   663     12  ER-2371                 PIC X(4)  VALUE '2371'.
   664     12  ER-2378                 PIC X(4)  VALUE '2378'.
   665     12  ER-2380                 PIC X(4)  VALUE '2380'.
   666     12  ER-2566                 PIC X(4)  VALUE '2566'.
   667     12  ER-2848                 PIC X(4)  VALUE '2848'.
   668     12  ER-3548                 PIC X(4)  VALUE '3548'.
   669     12  ER-7008                 PIC X(4)  VALUE '7008'.
   670     12  ER-7319                 PIC X(4)  VALUE '7319'.
   671     12  ER-7321                 PIC X(4)  VALUE '7321'.
   672     12  ER-7352                 PIC X(4)  VALUE '7352'.
   673     12  ER-7353                 PIC X(4)  VALUE '7353'.
   674     12  ER-7575                 PIC X(4)  VALUE '7575'.
   675     12  ER-7577                 PIC X(4)  VALUE '7577'.
   676     12  ER-7582                 PIC X(4)  VALUE '7582'.
   677     12  ER-7634                 PIC X(4)  VALUE '7634'.
   678     12  ER-7635                 PIC X(4)  VALUE '7635'.
   679     12  ER-7636                 PIC X(4)  VALUE '7636'.
   680     12  ER-7637                 PIC X(4)  VALUE '7637'.
   681     12  ER-7638                 PIC X(4)  VALUE '7638'.
   682     12  ER-7639                 PIC X(4)  VALUE '7639'.
   683     12  ER-7640                 PIC X(4)  VALUE '7640'.
   684     12  ER-7641                 PIC X(4)  VALUE '7641'.
   685     12  ER-7642                 PIC X(4)  VALUE '7642'.
   686     12  ER-7643                 PIC X(4)  VALUE '7643'.
   687     12  ER-7646                 PIC X(4)  VALUE '7646'.
   688     12  ER-7647                 PIC X(4)  VALUE '7647'.
   689     12  ER-7648                 PIC X(4)  VALUE '7648'.
   690     12  ER-7649                 PIC X(4)  VALUE '7649'.
   691     12  ER-7651                 PIC X(4)  VALUE '7651'.
   692     12  ER-7670                 PIC X(4)  VALUE '7670'.
   693     12  ER-7671                 PIC X(4)  VALUE '7671'.
   694     12  ER-7686                 PIC X(4)  VALUE '7686'.
   695     12  ER-7688                 PIC X(4)  VALUE '7688'.
   696     12  ER-7689                 PIC X(4)  VALUE '7689'.
   697     12  ER-7691                 PIC X(4)  VALUE '7691'.
   698*    COPY ERCPDEF.
   699******************************************************************
   700*                                                                *
   701*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  15
* EL130.cbl
   702*                            ERCPDEF.                            *
   703*                                                                *
   704*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   705*                                                                *
   706*    FILE TYPE = VSAM,KSDS                                       *
   707*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   708*                                                                *
   709*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   710*                                                                *
   711*    LOG = YES                                                   *
   712*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   713******************************************************************
   714 01  PRODUCT-MASTER.
   715    12  PD-RECORD-ID                 PIC X(02).
   716        88  VALID-PD-ID                  VALUE 'PD'.
   717    12  PD-CONTROL-PRIMARY.
   718        16  PD-COMPANY-CD            PIC X.
   719        16  PD-STATE                 PIC XX.
   720        16  PD-PRODUCT-CD            PIC XXX.
   721        16  PD-FILLER                PIC X(7).
   722        16  PD-BEN-TYPE              PIC X.
   723        16  PD-BEN-CODE              PIC XX.
   724        16  PD-PROD-EXP-DT           PIC XX.
   725    12  FILLER                       PIC X(50).
   726    12  PD-PRODUCT-DATA OCCURS 8.
   727        16  PD-PROD-CODE             PIC X.
   728            88  PD-PROD-LIFE           VALUE 'L'.
   729            88  PD-PROD-PROP           VALUE 'P'.
   730            88  PD-PROD-AH             VALUE 'A'.
   731            88  PD-PROD-IU             VALUE 'I'.
   732            88  PD-PROD-GAP            VALUE 'G'.
   733        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   734        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   735        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   736        16  PD-MAX-TERM              PIC S999        COMP-3.
   737        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   738        16  FILLER                   PIC X.
   739        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   740        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   741        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   742        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   743        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   744        16  PD-REC-CRIT-PERIOD       PIC X.
   745        16  PD-RTW-MOS               PIC 99.
   746        16  FILLER                   PIC X(5).
   747    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   748    12  PD-TERM-LIMITS OCCURS 15.
   749        16  PD-LOW-TERM              PIC S999        COMP-3.
   750        16  PD-HI-TERM               PIC S999        COMP-3.
   751*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   752    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   753        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   754        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   755    12  PD-EARN-FACTORS.
   756        16  FILLER OCCURS 15.
   757            20  FILLER OCCURS 15.
   758                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   759    12  PD-PRODUCT-DESC              PIC X(80).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  16
* EL130.cbl
   760    12  PD-TRUNCATED                 PIC X.
   761    12  FILLER                       PIC X(59).
   762    12  PD-MAINT-INFORMATION.
   763        16  PD-LAST-MAINT-DT         PIC X(02).
   764        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   765        16  PD-LAST-MAINT-BY         PIC X(04).
   766*    COPY ELCLNKLT.
   767******************************************************************
   768*                                                                *
   769*                                                                *
   770*                           ELCLNKLT                             *
   771*                            VMOD=2.003                          *
   772*                                                                *
   773*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   774*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   775*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   776*                                                                *
   777*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   778*   COMPLETING THE REQUIRED FIELDS.                              *
   779*                                                                *
   780*   THE CALLING PROGRAM SHOULD CHECK:                            *
   781*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   782*                              9999 INDICATES AN UNKNOWN ABEND   *
   783*                                   WAS DETECTED.                *
   784*                              ALL OTHER VALUES ARE NORMAL ERROR *
   785*                              CODES FOUND IN THE ERROR FILE.    *
   786******************************************************************
   787 01  W-1523-LINKDATA.
   788     12  W-1523-COMMON-PI-DATA.
   789         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   790         16  FILLER              PIC  X(67).
   791         16  W-1523-COMPANY-CD   PIC  X(01).
   792         16  FILLER              PIC  X(10).
   793         16  W-1523-CONTROL-IN-PROGRESS.
   794             20  W-1523-CARRIER  PIC  X(01).
   795             20  W-1523-GROUPING PIC  X(06).
   796             20  W-1523-STATE    PIC  X(02).
   797             20  W-1523-ACCOUNT  PIC  X(10).
   798             20  W-1523-CLAIM-CERT-GRP.
   799                 24  W-1523-CLAIM-NO
   800                                 PIC  X(07).
   801                 24  W-1523-CERT-NO.
   802                     28  W-1523-CERT-PRIME
   803                                 PIC  X(10).
   804                     28  W-1523-CERT-SFX
   805                                 PIC  X(01).
   806                 24  W-1523-CERT-EFF-DT
   807                                 PIC  X(02).
   808         16  FILLER              PIC X(265).
   809
   810     12  W-1523-WORK-AREA.
   811         16  W-1523-FORM-NUMBER  PIC  X(04).
   812         16  W-1523-NUMBER-COPIES
   813                                 PIC  9(01).
   814         16  W-1523-ADDR-TYPE    PIC  X(02).
   815         16  W-1523-FOLLOW-UP-DATE
   816                                 PIC  X(02).
   817         16  W-1523-RESEND-DATE  PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  17
* EL130.cbl
   818         16  W-1523-ERROR-CODE   PIC  9(04).
   819             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   820             88  W-1523-FATAL-ERROR
   821                                    VALUES  0006 0013 0042
   822                                            0154 0168 0169
   823                                            0176 9999 0172
   824                                            0179 0186 0281
   825                                            0332 2055 3697
   826                                            3698 3699 3770
   827                                            3771 3772 7675
   828                                            9106 9808 9883
   829                                            9887.
   830             88  W-1523-STOP-ERRORS
   831                                    VALUES  0013 0042 0154
   832                                            0168 0169 0172
   833                                            0281 0332 2055
   834                                            3698 3699 7675
   835                                            9106 9808 9883
   836                                            9999.
   837         16  W-1523-REASON       PIC  X(70).
   838         16  W-1523-ARCHIVE-NUMBER
   839                                 PIC  9(08).
   840     12  W-1523-POINTER-AREA.
   841         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   842         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   843         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   844         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   845         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  18
* EL130.cbl
   847*    COPY ELCINTF.
   848******************************************************************
   849*                                                                *
   850*                                                                *
   851*                            ELCINTF.                            *
   852*                            VMOD=2.017                          *
   853*                                                                *
   854*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   855*                                                                *
   856*       LENGTH = 1024                                            *
   857*                                                                *
   858******************************************************************
   859*                   C H A N G E   L O G
   860*
   861* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   862*-----------------------------------------------------------------
   863*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   864* EFFECTIVE    NUMBER
   865*-----------------------------------------------------------------
   866* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   867******************************************************************
   868 01  PROGRAM-INTERFACE-BLOCK.
   869     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   870     12  PI-CALLING-PROGRAM              PIC X(8).
   871     12  PI-SAVED-PROGRAM-1              PIC X(8).
   872     12  PI-SAVED-PROGRAM-2              PIC X(8).
   873     12  PI-SAVED-PROGRAM-3              PIC X(8).
   874     12  PI-SAVED-PROGRAM-4              PIC X(8).
   875     12  PI-SAVED-PROGRAM-5              PIC X(8).
   876     12  PI-SAVED-PROGRAM-6              PIC X(8).
   877     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   878     12  PI-COMPANY-ID                   PIC XXX.
   879     12  PI-COMPANY-CD                   PIC X.
   880
   881     12  PI-COMPANY-PASSWORD             PIC X(8).
   882
   883     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   884
   885     12  PI-CONTROL-IN-PROGRESS.
   886         16  PI-CARRIER                  PIC X.
   887         16  PI-GROUPING                 PIC X(6).
   888         16  PI-STATE                    PIC XX.
   889         16  PI-ACCOUNT                  PIC X(10).
   890         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   891                                         PIC X(10).
   892         16  PI-CLAIM-CERT-GRP.
   893             20  PI-CLAIM-NO             PIC X(7).
   894             20  PI-CERT-NO.
   895                 25  PI-CERT-PRIME       PIC X(10).
   896                 25  PI-CERT-SFX         PIC X.
   897             20  PI-CERT-EFF-DT          PIC XX.
   898         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   899             20  PI-PLAN-CODE            PIC X(2).
   900             20  PI-REVISION-NUMBER      PIC X(3).
   901             20  PI-PLAN-EFF-DT          PIC X(2).
   902             20  PI-PLAN-EXP-DT          PIC X(2).
   903             20  FILLER                  PIC X(11).
   904         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  19
* EL130.cbl
   905             20  PI-OE-REFERENCE-1.
   906                 25  PI-OE-REF-1-PRIME   PIC X(18).
   907                 25  PI-OE-REF-1-SUFF    PIC XX.
   908
   909     12  PI-SESSION-IN-PROGRESS          PIC X.
   910         88  CLAIM-SESSION                   VALUE '1'.
   911         88  CREDIT-SESSION                  VALUE '2'.
   912         88  WARRANTY-SESSION                VALUE '3'.
   913         88  MORTGAGE-SESSION                VALUE '4'.
   914         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   915
   916
   917*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   918
   919     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   920     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   921
   922     12  PI-CREDIT-USER                  PIC X.
   923         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   924         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   925
   926     12  PI-CLAIM-USER                   PIC X.
   927         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   928         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   929
   930     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   931         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   932         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   933         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   934         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   935         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   936
   937     12  PI-PROCESSOR-ID                 PIC X(4).
   938
   939     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   940
   941     12  PI-MEMBER-CAPTION               PIC X(10).
   942
   943     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   944         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   945
   946     12  PI-LIFE-OVERRIDE-L1             PIC X.
   947     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   948     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   949     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   950
   951     12  PI-AH-OVERRIDE-L1               PIC X.
   952     12  PI-AH-OVERRIDE-L2               PIC XX.
   953     12  PI-AH-OVERRIDE-L6               PIC X(6).
   954     12  PI-AH-OVERRIDE-L12              PIC X(12).
   955
   956     12  PI-NEW-SYSTEM                   PIC X(2).
   957
   958     12  PI-PRIMARY-CERT-NO              PIC X(11).
   959     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   960         88  PI-USES-PAID-TO                 VALUE '1'.
   961     12  PI-CRDTCRD-SYSTEM.
   962         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  20
* EL130.cbl
   963             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   964             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   965         16  PI-CC-MONTH-END-DT          PIC XX.
   966     12  PI-PROCESSOR-PRINTER            PIC X(4).
   967
   968     12  PI-OE-REFERENCE-2.
   969         16  PI-OE-REF-2-PRIME           PIC X(10).
   970         16  PI-OE-REF-2-SUFF            PIC X.
   971
   972     12  PI-REM-TRM-CALC-OPTION          PIC X.
   973
   974     12  PI-LANGUAGE-TYPE                PIC X.
   975             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   976             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   977             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   978
   979     12  PI-POLICY-LINKAGE-IND           PIC X.
   980         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   981         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   982                                                   LOW-VALUES.
   983
   984     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   985     12  PI-CLAIM-PW-SESSION             PIC X(1).
   986         88  PI-CLAIM-CREDIT                 VALUE '1'.
   987         88  PI-CLAIM-CONVEN                 VALUE '2'.
   988
   989     12  PI-PROCESSOR-CSR-IND            PIC X.
   990         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   991         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   992
   993     12  FILLER                          PIC X(3).
   994
   995     12  PI-SYSTEM-LEVEL                 PIC X(145).
   996
   997     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   998         PI-SYSTEM-LEVEL.
   999
  1000         16  PI-ENTRY-CODES.
  1001             20  PI-ENTRY-CD-1           PIC X.
  1002             20  PI-ENTRY-CD-2           PIC X.
  1003
  1004         16  PI-RETURN-CODES.
  1005             20  PI-RETURN-CD-1          PIC X.
  1006             20  PI-RETURN-CD-2          PIC X.
  1007
  1008         16  PI-UPDATE-STATUS-SAVE.
  1009             20  PI-UPDATE-BY            PIC X(4).
  1010             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1011
  1012         16  PI-LOWER-CASE-LETTERS       PIC X.
  1013             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1014
  1015*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1016*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1017*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1018
  1019         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1020             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  21
* EL130.cbl
  1021             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1022             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1023             88  ACCNT-CNTL                  VALUE '3'.
  1024             88  CARR-ACCNT-CNTL             VALUE '4'.
  1025
  1026         16  PI-PROCESSOR-CAP-LIST.
  1027             20  PI-SYSTEM-CONTROLS.
  1028                24 PI-SYSTEM-DISPLAY     PIC X.
  1029                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1030                24 PI-SYSTEM-MODIFY      PIC X.
  1031                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1032             20  FILLER                  PIC XX.
  1033             20  PI-DISPLAY-CAP          PIC X.
  1034                 88  DISPLAY-CAP             VALUE 'Y'.
  1035             20  PI-MODIFY-CAP           PIC X.
  1036                 88  MODIFY-CAP              VALUE 'Y'.
  1037             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1038                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1039             20  PI-FORCE-CAP            PIC X.
  1040                 88  FORCE-CAP               VALUE 'Y'.
  1041
  1042         16  PI-PROGRAM-CONTROLS.
  1043             20  PI-PGM-PRINT-OPT        PIC X.
  1044             20  PI-PGM-FORMAT-OPT       PIC X.
  1045             20  PI-PGM-PROCESS-OPT      PIC X.
  1046             20  PI-PGM-TOTALS-OPT       PIC X.
  1047
  1048         16  PI-HELP-INTERFACE.
  1049             20  PI-LAST-ERROR-NO        PIC X(4).
  1050             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1051
  1052         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1053             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1054
  1055         16  PI-CR-CONTROL-IN-PROGRESS.
  1056             20  PI-CR-CARRIER           PIC X.
  1057             20  PI-CR-GROUPING          PIC X(6).
  1058             20  PI-CR-STATE             PIC XX.
  1059             20  PI-CR-ACCOUNT           PIC X(10).
  1060             20  PI-CR-FIN-RESP          PIC X(10).
  1061             20  PI-CR-TYPE              PIC X.
  1062
  1063         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1064
  1065         16  PI-CR-MONTH-END-DT          PIC XX.
  1066
  1067         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1068             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1069             88  PI-ZERO-CARRIER             VALUE '1'.
  1070             88  PI-ZERO-GROUPING            VALUE '2'.
  1071             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1072
  1073         16  PI-CARRIER-SECURITY         PIC X.
  1074             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1075
  1076         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1077             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1078             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  22
* EL130.cbl
  1079
  1080         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1081             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1082                                         INDEXED BY PI-ACCESS-NDX
  1083                                         PIC X.
  1084
  1085         16  PI-GA-BILLING-CONTROL       PIC X.
  1086             88  PI-GA-BILLING               VALUE '1'.
  1087
  1088         16  PI-MAIL-PROCESSING          PIC X.
  1089             88  PI-MAIL-YES                 VALUE 'Y'.
  1090
  1091         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1092
  1093         16  PI-AR-SYSTEM.
  1094             20  PI-AR-PROCESSING-CNTL   PIC X.
  1095                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1096             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1097             20  PI-AR-MONTH-END-DT      PIC XX.
  1098
  1099         16  PI-MP-SYSTEM.
  1100             20  PI-MORTGAGE-USER            PIC X.
  1101                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1102                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1103             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1104                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1105                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1106                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1107                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1108                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1109             20  PI-MP-MONTH-END-DT          PIC XX.
  1110             20  PI-MP-REFERENCE-NO.
  1111                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1112                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1113
  1114         16  PI-LABEL-CONTROL            PIC X(01).
  1115             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1116             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1117
  1118         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1119             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1120
  1121         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1122             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1123             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1124
  1125         16  FILLER                      PIC X(14).
  1126
  1127     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1128******************************************************************
  1129     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1130         16  PI-MSTR-DT               PIC XX.
  1131         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1132         16  PI-TRLR-DT               PIC XX.
  1133         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1134         16  PI-LAST-CLAIM            PIC X(7).
  1135         16  PI-LAST-CARR             PIC X.
  1136         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  23
* EL130.cbl
  1137             20  PI-LAST-CERT-PRIME   PIC X(10).
  1138             20  PI-LAST-CERT-SUFX    PIC X.
  1139         16  PI-LAST-CLAIM-TYPE       PIC X.
  1140         16  PI-CURSOR                PIC S9(4)   COMP.
  1141         16  PI-SAVE-CERT.
  1142             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1143             20  PI-SAVE-CERT-SUFX    PIC X.
  1144         16  PI-SAVE-EFFDT            PIC X(2).
  1145         16  PI-SAVE-ACCOUNT          PIC X(10).
  1146         16  PI-INCURR-SW             PIC X.
  1147         16  PI-PRT-OPT               PIC X.
  1148         16  PI-ALT-PRT               PIC X(4).
  1149         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1150             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1151         16  FILLER                   PIC X(272).
  1152         16  PI-EL127-TO-EL130-CNTRL.
  1153             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1154             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1155             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1156                 24  PI-EL127-CARRIER        PIC X.
  1157                 24  PI-EL127-GROUPING       PIC X(6).
  1158                 24  PI-EL127-STATE          PIC X(2).
  1159                 24  PI-EL127-ACCOUNT        PIC X(10).
  1160                 24  PI-EL127-CERT-NO.
  1161                     28  PI-EL127-CERT-PRIME PIC X(10).
  1162                     28  PI-EL127-CERT-SUFX  PIC X.
  1163                 24  PI-EL127-EFF-DT         PIC XX.
  1164*        16  FILLER                          PIC X(50).
  1165         16  FILLER                          PIC X(31).
  1166         16  PI-EL659-TO-EL130-CNTRL.
  1167             20  PI-EL659-CARRIER            PIC X.
  1168             20  PI-EL659-GROUPING           PIC X(6).
  1169             20  PI-EL659-STATE              PIC XX.
  1170             20  PI-EL659-ACCOUNT            PIC X(10).
  1171
  1172         16  FILLER                          PIC X(19).
  1173
  1174         16  PI-SAVE-INCUR-DT                PIC X(02).
  1175         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1176*         16  FILLER                          PIC X(65).
  1177         16  PI-ST-VFY-2ND-BENE              PIC X.
  1178         16  PI-ST-CAUSAL-STATE              PIC X.
  1179         16  pi-dcc-max-benefits             pic s999 comp-3.
  1180         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1181         16  pi-emi-sub                      pic 99.
  1182         16  FILLER                          PIC X(53).
  1183
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  24
* EL130.cbl
  1185*    COPY EL130S.
  1186 01  EL130AI.
  1187     05  FILLER            PIC  X(0012).
  1188*    -------------------------------
  1189     05  RUNDTEL PIC S9(0004) COMP.
  1190     05  RUNDTEF PIC  X(0001).
  1191     05  FILLER REDEFINES RUNDTEF.
  1192         10  RUNDTEA PIC  X(0001).
  1193     05  RUNDTEI PIC  X(0008).
  1194*    -------------------------------
  1195     05  RUNTIMEL PIC S9(0004) COMP.
  1196     05  RUNTIMEF PIC  X(0001).
  1197     05  FILLER REDEFINES RUNTIMEF.
  1198         10  RUNTIMEA PIC  X(0001).
  1199     05  RUNTIMEI PIC  X(0005).
  1200*    -------------------------------
  1201     05  COMPL PIC S9(0004) COMP.
  1202     05  COMPF PIC  X(0001).
  1203     05  FILLER REDEFINES COMPF.
  1204         10  COMPA PIC  X(0001).
  1205     05  COMPI PIC  X(0003).
  1206*    -------------------------------
  1207     05  SEQUL PIC S9(0004) COMP.
  1208     05  SEQUF PIC  X(0001).
  1209     05  FILLER REDEFINES SEQUF.
  1210         10  SEQUA PIC  X(0001).
  1211     05  SEQUI PIC  X(0010).
  1212*    -------------------------------
  1213     05  MAINTL PIC S9(0004) COMP.
  1214     05  MAINTF PIC  X(0001).
  1215     05  FILLER REDEFINES MAINTF.
  1216         10  MAINTA PIC  X(0001).
  1217     05  MAINTI PIC  X(0001).
  1218*    -------------------------------
  1219     05  CLMNOL PIC S9(0004) COMP.
  1220     05  CLMNOF PIC  X(0001).
  1221     05  FILLER REDEFINES CLMNOF.
  1222         10  CLMNOA PIC  X(0001).
  1223     05  CLMNOI PIC  X(0007).
  1224*    -------------------------------
  1225     05  CLMCARRL PIC S9(0004) COMP.
  1226     05  CLMCARRF PIC  X(0001).
  1227     05  FILLER REDEFINES CLMCARRF.
  1228         10  CLMCARRA PIC  X(0001).
  1229     05  CLMCARRI PIC  X(0001).
  1230*    -------------------------------
  1231     05  CLMTYPEL PIC S9(0004) COMP.
  1232     05  CLMTYPEF PIC  X(0001).
  1233     05  FILLER REDEFINES CLMTYPEF.
  1234         10  CLMTYPEA PIC  X(0001).
  1235     05  CLMTYPEI PIC  X(0001).
  1236*    -------------------------------
  1237     05  INSTYPEL PIC S9(0004) COMP.
  1238     05  INSTYPEF PIC  X(0001).
  1239     05  FILLER REDEFINES INSTYPEF.
  1240         10  INSTYPEA PIC  X(0001).
  1241     05  INSTYPEI PIC  X(0001).
  1242*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  25
* EL130.cbl
  1243     05  CERTNOL PIC S9(0004) COMP.
  1244     05  CERTNOF PIC  X(0001).
  1245     05  FILLER REDEFINES CERTNOF.
  1246         10  CERTNOA PIC  X(0001).
  1247     05  CERTNOI PIC  X(0010).
  1248*    -------------------------------
  1249     05  SUFXL PIC S9(0004) COMP.
  1250     05  SUFXF PIC  X(0001).
  1251     05  FILLER REDEFINES SUFXF.
  1252         10  SUFXA PIC  X(0001).
  1253     05  SUFXI PIC  X(0001).
  1254*    -------------------------------
  1255     05  PCERTNOL PIC S9(0004) COMP.
  1256     05  PCERTNOF PIC  X(0001).
  1257     05  FILLER REDEFINES PCERTNOF.
  1258         10  PCERTNOA PIC  X(0001).
  1259     05  PCERTNOI PIC  X(0010).
  1260*    -------------------------------
  1261     05  PSUFXL PIC S9(0004) COMP.
  1262     05  PSUFXF PIC  X(0001).
  1263     05  FILLER REDEFINES PSUFXF.
  1264         10  PSUFXA PIC  X(0001).
  1265     05  PSUFXI PIC  X(0001).
  1266*    -------------------------------
  1267     05  INCURL PIC S9(0004) COMP.
  1268     05  INCURF PIC  X(0001).
  1269     05  FILLER REDEFINES INCURF.
  1270         10  INCURA PIC  X(0001).
  1271     05  INCURI PIC  X(0008).
  1272*    -------------------------------
  1273     05  REPORTL PIC S9(0004) COMP.
  1274     05  REPORTF PIC  X(0001).
  1275     05  FILLER REDEFINES REPORTF.
  1276         10  REPORTA PIC  X(0001).
  1277     05  REPORTI PIC  X(0008).
  1278*    -------------------------------
  1279     05  ICD1L PIC S9(0004) COMP.
  1280     05  ICD1F PIC  X(0001).
  1281     05  FILLER REDEFINES ICD1F.
  1282         10  ICD1A PIC  X(0001).
  1283     05  ICD1I PIC  X(0008).
  1284*    -------------------------------
  1285     05  ICD2L PIC S9(0004) COMP.
  1286     05  ICD2F PIC  X(0001).
  1287     05  FILLER REDEFINES ICD2F.
  1288         10  ICD2A PIC  X(0001).
  1289     05  ICD2I PIC  X(0008).
  1290*    -------------------------------
  1291     05  DIAGL PIC S9(0004) COMP.
  1292     05  DIAGF PIC  X(0001).
  1293     05  FILLER REDEFINES DIAGF.
  1294         10  DIAGA PIC  X(0001).
  1295     05  DIAGI PIC  X(0060).
  1296*    -------------------------------
  1297     05  BENECDL PIC S9(0004) COMP.
  1298     05  BENECDF PIC  X(0001).
  1299     05  FILLER REDEFINES BENECDF.
  1300         10  BENECDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  26
* EL130.cbl
  1301     05  BENECDI PIC  X(0010).
  1302*    -------------------------------
  1303     05  BIRTHDTL PIC S9(0004) COMP.
  1304     05  BIRTHDTF PIC  X(0001).
  1305     05  FILLER REDEFINES BIRTHDTF.
  1306         10  BIRTHDTA PIC  X(0001).
  1307     05  BIRTHDTI PIC  X(0008).
  1308*    -------------------------------
  1309     05  SSNL PIC S9(0004) COMP.
  1310     05  SSNF PIC  X(0001).
  1311     05  FILLER REDEFINES SSNF.
  1312         10  SSNA PIC  X(0001).
  1313     05  SSNI PIC  X(0011).
  1314*    -------------------------------
  1315     05  SEXL PIC S9(0004) COMP.
  1316     05  SEXF PIC  X(0001).
  1317     05  FILLER REDEFINES SEXF.
  1318         10  SEXA PIC  X(0001).
  1319     05  SEXI PIC  X(0001).
  1320*    -------------------------------
  1321     05  OCCCDL PIC S9(0004) COMP.
  1322     05  OCCCDF PIC  X(0001).
  1323     05  FILLER REDEFINES OCCCDF.
  1324         10  OCCCDA PIC  X(0001).
  1325     05  OCCCDI PIC  X(0006).
  1326*    -------------------------------
  1327     05  LSTNMEL PIC S9(0004) COMP.
  1328     05  LSTNMEF PIC  X(0001).
  1329     05  FILLER REDEFINES LSTNMEF.
  1330         10  LSTNMEA PIC  X(0001).
  1331     05  LSTNMEI PIC  X(0015).
  1332*    -------------------------------
  1333     05  FSTNMEL PIC S9(0004) COMP.
  1334     05  FSTNMEF PIC  X(0001).
  1335     05  FILLER REDEFINES FSTNMEF.
  1336         10  FSTNMEA PIC  X(0001).
  1337     05  FSTNMEI PIC  X(0012).
  1338*    -------------------------------
  1339     05  INITL PIC S9(0004) COMP.
  1340     05  INITF PIC  X(0001).
  1341     05  FILLER REDEFINES INITF.
  1342         10  INITA PIC  X(0001).
  1343     05  INITI PIC  X(0001).
  1344*    -------------------------------
  1345     05  LOANNOL PIC S9(0004) COMP.
  1346     05  LOANNOF PIC  X(0001).
  1347     05  FILLER REDEFINES LOANNOF.
  1348         10  LOANNOA PIC  X(0001).
  1349     05  LOANNOI PIC  X(0008).
  1350*    -------------------------------
  1351     05  CRTLNMEL PIC S9(0004) COMP.
  1352     05  CRTLNMEF PIC  X(0001).
  1353     05  FILLER REDEFINES CRTLNMEF.
  1354         10  CRTLNMEA PIC  X(0001).
  1355     05  CRTLNMEI PIC  X(0015).
  1356*    -------------------------------
  1357     05  CRTFNMEL PIC S9(0004) COMP.
  1358     05  CRTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  27
* EL130.cbl
  1359     05  FILLER REDEFINES CRTFNMEF.
  1360         10  CRTFNMEA PIC  X(0001).
  1361     05  CRTFNMEI PIC  X(0012).
  1362*    -------------------------------
  1363     05  CRTINITL PIC S9(0004) COMP.
  1364     05  CRTINITF PIC  X(0001).
  1365     05  FILLER REDEFINES CRTINITF.
  1366         10  CRTINITA PIC  X(0001).
  1367     05  CRTINITI PIC  X(0001).
  1368*    -------------------------------
  1369     05  LOANBALL PIC S9(0004) COMP.
  1370     05  LOANBALF PIC  X(0001).
  1371     05  FILLER REDEFINES LOANBALF.
  1372         10  LOANBALA PIC  X(0001).
  1373     05  LOANBALI PIC  9(7)V99.
  1374*    -------------------------------
  1375     05  MANRSVL PIC S9(0004) COMP.
  1376     05  MANRSVF PIC  X(0001).
  1377     05  FILLER REDEFINES MANRSVF.
  1378         10  MANRSVA PIC  X(0001).
  1379     05  MANRSVI PIC  9(7)V99.
  1380*    -------------------------------
  1381     05  SUPVL PIC S9(0004) COMP.
  1382     05  SUPVF PIC  X(0001).
  1383     05  FILLER REDEFINES SUPVF.
  1384         10  SUPVA PIC  X(0001).
  1385     05  SUPVI PIC  X(0001).
  1386*    -------------------------------
  1387     05  PRICDL PIC S9(0004) COMP.
  1388     05  PRICDF PIC  X(0001).
  1389     05  FILLER REDEFINES PRICDF.
  1390         10  PRICDA PIC  X(0001).
  1391     05  PRICDI PIC  X(0001).
  1392*    -------------------------------
  1393     05  PRODL PIC S9(0004) COMP.
  1394     05  PRODF PIC  X(0001).
  1395     05  FILLER REDEFINES PRODF.
  1396         10  PRODA PIC  X(0001).
  1397     05  PRODI PIC  X(0008).
  1398*    -------------------------------
  1399     05  PRODCDL PIC S9(0004) COMP.
  1400     05  PRODCDF PIC  X(0001).
  1401     05  FILLER REDEFINES PRODCDF.
  1402         10  PRODCDA PIC  X(0001).
  1403     05  PRODCDI PIC  X(0001).
  1404*    -------------------------------
  1405     05  FILETOL PIC S9(0004) COMP.
  1406     05  FILETOF PIC  X(0001).
  1407     05  FILLER REDEFINES FILETOF.
  1408         10  FILETOA PIC  X(0001).
  1409     05  FILETOI PIC  X(0004).
  1410*    -------------------------------
  1411     05  PROCCDL PIC S9(0004) COMP.
  1412     05  PROCCDF PIC  X(0001).
  1413     05  FILLER REDEFINES PROCCDF.
  1414         10  PROCCDA PIC  X(0001).
  1415     05  PROCCDI PIC  X(0004).
  1416*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  28
* EL130.cbl
  1417     05  RELCLML PIC S9(0004) COMP.
  1418     05  RELCLMF PIC  X(0001).
  1419     05  FILLER REDEFINES RELCLMF.
  1420         10  RELCLMA PIC  X(0001).
  1421     05  RELCLMI PIC  X(0007).
  1422*    -------------------------------
  1423     05  PRTOPTL PIC S9(0004) COMP.
  1424     05  PRTOPTF PIC  X(0001).
  1425     05  FILLER REDEFINES PRTOPTF.
  1426         10  PRTOPTA PIC  X(0001).
  1427     05  PRTOPTI PIC  X(0001).
  1428*    -------------------------------
  1429     05  ALTPRTL PIC S9(0004) COMP.
  1430     05  ALTPRTF PIC  X(0001).
  1431     05  FILLER REDEFINES ALTPRTF.
  1432         10  ALTPRTA PIC  X(0001).
  1433     05  ALTPRTI PIC  X(0004).
  1434*    -------------------------------
  1435     05  CERTMTL PIC S9(0004) COMP.
  1436     05  CERTMTF PIC  X(0001).
  1437     05  FILLER REDEFINES CERTMTF.
  1438         10  CERTMTA PIC  X(0001).
  1439     05  CERTMTI PIC  X(0001).
  1440*    -------------------------------
  1441     05  CRTCARRL PIC S9(0004) COMP.
  1442     05  CRTCARRF PIC  X(0001).
  1443     05  FILLER REDEFINES CRTCARRF.
  1444         10  CRTCARRA PIC  X(0001).
  1445     05  CRTCARRI PIC  X(0001).
  1446*    -------------------------------
  1447     05  GROUPL PIC S9(0004) COMP.
  1448     05  GROUPF PIC  X(0001).
  1449     05  FILLER REDEFINES GROUPF.
  1450         10  GROUPA PIC  X(0001).
  1451     05  GROUPI PIC  X(0006).
  1452*    -------------------------------
  1453     05  STATEL PIC S9(0004) COMP.
  1454     05  STATEF PIC  X(0001).
  1455     05  FILLER REDEFINES STATEF.
  1456         10  STATEA PIC  X(0001).
  1457     05  STATEI PIC  X(0002).
  1458*    -------------------------------
  1459     05  ACCOUNTL PIC S9(0004) COMP.
  1460     05  ACCOUNTF PIC  X(0001).
  1461     05  FILLER REDEFINES ACCOUNTF.
  1462         10  ACCOUNTA PIC  X(0001).
  1463     05  ACCOUNTI PIC  X(0010).
  1464*    -------------------------------
  1465     05  EFFDTL PIC S9(0004) COMP.
  1466     05  EFFDTF PIC  X(0001).
  1467     05  FILLER REDEFINES EFFDTF.
  1468         10  EFFDTA PIC  X(0001).
  1469     05  EFFDTI PIC  X(0008).
  1470*    -------------------------------
  1471     05  CRTSSNL PIC S9(0004) COMP.
  1472     05  CRTSSNF PIC  X(0001).
  1473     05  FILLER REDEFINES CRTSSNF.
  1474         10  CRTSSNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  29
* EL130.cbl
  1475     05  CRTSSNI PIC  X(0011).
  1476*    -------------------------------
  1477     05  MEMCAPL PIC S9(0004) COMP.
  1478     05  MEMCAPF PIC  X(0001).
  1479     05  FILLER REDEFINES MEMCAPF.
  1480         10  MEMCAPA PIC  X(0001).
  1481     05  MEMCAPI PIC  X(0010).
  1482*    -------------------------------
  1483     05  MEMBERL PIC S9(0004) COMP.
  1484     05  MEMBERF PIC  X(0001).
  1485     05  FILLER REDEFINES MEMBERF.
  1486         10  MEMBERA PIC  X(0001).
  1487     05  MEMBERI PIC  X(0012).
  1488*    -------------------------------
  1489     05  REINCDL PIC S9(0004) COMP.
  1490     05  REINCDF PIC  X(0001).
  1491     05  FILLER REDEFINES REINCDF.
  1492         10  REINCDA PIC  X(0001).
  1493     05  REINCDI PIC  X(0001).
  1494*    -------------------------------
  1495     05  ISSAGEL PIC S9(0004) COMP.
  1496     05  ISSAGEF PIC  X(0001).
  1497     05  FILLER REDEFINES ISSAGEF.
  1498         10  ISSAGEA PIC  X(0001).
  1499     05  ISSAGEI PIC  X(0002).
  1500*    -------------------------------
  1501     05  APRL PIC S9(0004) COMP.
  1502     05  APRF PIC  X(0001).
  1503     05  FILLER REDEFINES APRF.
  1504         10  APRA PIC  X(0001).
  1505     05  APRI PIC  9(4)V9(4).
  1506*    -------------------------------
  1507     05  PMTFREQL PIC S9(0004) COMP.
  1508     05  PMTFREQF PIC  X(0001).
  1509     05  FILLER REDEFINES PMTFREQF.
  1510         10  PMTFREQA PIC  X(0001).
  1511     05  PMTFREQI PIC  99.
  1512*    -------------------------------
  1513     05  INDGRPL PIC S9(0004) COMP.
  1514     05  INDGRPF PIC  X(0001).
  1515     05  FILLER REDEFINES INDGRPF.
  1516         10  INDGRPA PIC  X(0001).
  1517     05  INDGRPI PIC  X(0001).
  1518*    -------------------------------
  1519     05  PREMTYPL PIC S9(0004) COMP.
  1520     05  PREMTYPF PIC  X(0001).
  1521     05  FILLER REDEFINES PREMTYPF.
  1522         10  PREMTYPA PIC  X(0001).
  1523     05  PREMTYPI PIC  X(0001).
  1524*    -------------------------------
  1525     05  ADDONDTL PIC S9(0004) COMP.
  1526     05  ADDONDTF PIC  X(0001).
  1527     05  FILLER REDEFINES ADDONDTF.
  1528         10  ADDONDTA PIC  X(0001).
  1529     05  ADDONDTI PIC  X(0008).
  1530*    -------------------------------
  1531     05  JNTLNMEL PIC S9(0004) COMP.
  1532     05  JNTLNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  30
* EL130.cbl
  1533     05  FILLER REDEFINES JNTLNMEF.
  1534         10  JNTLNMEA PIC  X(0001).
  1535     05  JNTLNMEI PIC  X(0015).
  1536*    -------------------------------
  1537     05  JNTFNMEL PIC S9(0004) COMP.
  1538     05  JNTFNMEF PIC  X(0001).
  1539     05  FILLER REDEFINES JNTFNMEF.
  1540         10  JNTFNMEA PIC  X(0001).
  1541     05  JNTFNMEI PIC  X(0002).
  1542*    -------------------------------
  1543     05  JNTINITL PIC S9(0004) COMP.
  1544     05  JNTINITF PIC  X(0001).
  1545     05  FILLER REDEFINES JNTINITF.
  1546         10  JNTINITA PIC  X(0001).
  1547     05  JNTINITI PIC  X(0001).
  1548*    -------------------------------
  1549     05  JNTAGEL PIC S9(0004) COMP.
  1550     05  JNTAGEF PIC  X(0001).
  1551     05  FILLER REDEFINES JNTAGEF.
  1552         10  JNTAGEA PIC  X(0001).
  1553     05  JNTAGEI PIC  X(0002).
  1554*    -------------------------------
  1555     05  LCVDSCRL PIC S9(0004) COMP.
  1556     05  LCVDSCRF PIC  X(0001).
  1557     05  FILLER REDEFINES LCVDSCRF.
  1558         10  LCVDSCRA PIC  X(0001).
  1559     05  LCVDSCRI PIC  X(0006).
  1560*    -------------------------------
  1561     05  LCVKINDL PIC S9(0004) COMP.
  1562     05  LCVKINDF PIC  X(0001).
  1563     05  FILLER REDEFINES LCVKINDF.
  1564         10  LCVKINDA PIC  X(0001).
  1565     05  LCVKINDI PIC  X(0003).
  1566*    -------------------------------
  1567     05  LCVCDL PIC S9(0004) COMP.
  1568     05  LCVCDF PIC  X(0001).
  1569     05  FILLER REDEFINES LCVCDF.
  1570         10  LCVCDA PIC  X(0001).
  1571     05  LCVCDI PIC  X(0002).
  1572*    -------------------------------
  1573     05  LCVOTRML PIC S9(0004) COMP.
  1574     05  LCVOTRMF PIC  X(0001).
  1575     05  FILLER REDEFINES LCVOTRMF.
  1576         10  LCVOTRMA PIC  X(0001).
  1577     05  LCVOTRMI PIC  999.
  1578*    -------------------------------
  1579     05  LCVRTRML PIC S9(0004) COMP.
  1580     05  LCVRTRMF PIC  X(0001).
  1581     05  FILLER REDEFINES LCVRTRMF.
  1582         10  LCVRTRMA PIC  X(0001).
  1583     05  LCVRTRMI PIC  X(0003).
  1584*    -------------------------------
  1585     05  LCVRATEL PIC S9(0004) COMP.
  1586     05  LCVRATEF PIC  X(0001).
  1587     05  FILLER REDEFINES LCVRATEF.
  1588         10  LCVRATEA PIC  X(0001).
  1589     05  LCVRATEI PIC  9999V99.
  1590*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  31
* EL130.cbl
  1591     05  LCVBENEL PIC S9(0004) COMP.
  1592     05  LCVBENEF PIC  X(0001).
  1593     05  FILLER REDEFINES LCVBENEF.
  1594         10  LCVBENEA PIC  X(0001).
  1595     05  LCVBENEI PIC  9(9)V99.
  1596*    -------------------------------
  1597     05  LCVFORML PIC S9(0004) COMP.
  1598     05  LCVFORMF PIC  X(0001).
  1599     05  FILLER REDEFINES LCVFORMF.
  1600         10  LCVFORMA PIC  X(0001).
  1601     05  LCVFORMI PIC  X(0012).
  1602*    -------------------------------
  1603     05  LCVCNDTL PIC S9(0004) COMP.
  1604     05  LCVCNDTF PIC  X(0001).
  1605     05  FILLER REDEFINES LCVCNDTF.
  1606         10  LCVCNDTA PIC  X(0001).
  1607     05  LCVCNDTI PIC  X(0008).
  1608*    -------------------------------
  1609     05  LCVEXITL PIC S9(0004) COMP.
  1610     05  LCVEXITF PIC  X(0001).
  1611     05  FILLER REDEFINES LCVEXITF.
  1612         10  LCVEXITA PIC  X(0001).
  1613     05  LCVEXITI PIC  X(0008).
  1614*    -------------------------------
  1615     05  LCVSTATL PIC S9(0004) COMP.
  1616     05  LCVSTATF PIC  X(0001).
  1617     05  FILLER REDEFINES LCVSTATF.
  1618         10  LCVSTATA PIC  X(0001).
  1619     05  LCVSTATI PIC  X(0006).
  1620*    -------------------------------
  1621     05  ACVDSCRL PIC S9(0004) COMP.
  1622     05  ACVDSCRF PIC  X(0001).
  1623     05  FILLER REDEFINES ACVDSCRF.
  1624         10  ACVDSCRA PIC  X(0001).
  1625     05  ACVDSCRI PIC  X(0006).
  1626*    -------------------------------
  1627     05  ACVKINDL PIC S9(0004) COMP.
  1628     05  ACVKINDF PIC  X(0001).
  1629     05  FILLER REDEFINES ACVKINDF.
  1630         10  ACVKINDA PIC  X(0001).
  1631     05  ACVKINDI PIC  X(0003).
  1632*    -------------------------------
  1633     05  ACVCDL PIC S9(0004) COMP.
  1634     05  ACVCDF PIC  X(0001).
  1635     05  FILLER REDEFINES ACVCDF.
  1636         10  ACVCDA PIC  X(0001).
  1637     05  ACVCDI PIC  X(0002).
  1638*    -------------------------------
  1639     05  ACVOTRML PIC S9(0004) COMP.
  1640     05  ACVOTRMF PIC  X(0001).
  1641     05  FILLER REDEFINES ACVOTRMF.
  1642         10  ACVOTRMA PIC  X(0001).
  1643     05  ACVOTRMI PIC  999.
  1644*    -------------------------------
  1645     05  ACVRTRML PIC S9(0004) COMP.
  1646     05  ACVRTRMF PIC  X(0001).
  1647     05  FILLER REDEFINES ACVRTRMF.
  1648         10  ACVRTRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  32
* EL130.cbl
  1649     05  ACVRTRMI PIC  X(0003).
  1650*    -------------------------------
  1651     05  ACVRATEL PIC S9(0004) COMP.
  1652     05  ACVRATEF PIC  X(0001).
  1653     05  FILLER REDEFINES ACVRATEF.
  1654         10  ACVRATEA PIC  X(0001).
  1655     05  ACVRATEI PIC  9999V99.
  1656*    -------------------------------
  1657     05  ACVBENEL PIC S9(0004) COMP.
  1658     05  ACVBENEF PIC  X(0001).
  1659     05  FILLER REDEFINES ACVBENEF.
  1660         10  ACVBENEA PIC  X(0001).
  1661     05  ACVBENEI PIC  9(9)V99.
  1662*    -------------------------------
  1663     05  ACVFORML PIC S9(0004) COMP.
  1664     05  ACVFORMF PIC  X(0001).
  1665     05  FILLER REDEFINES ACVFORMF.
  1666         10  ACVFORMA PIC  X(0001).
  1667     05  ACVFORMI PIC  X(0012).
  1668*    -------------------------------
  1669     05  ACVCNDTL PIC S9(0004) COMP.
  1670     05  ACVCNDTF PIC  X(0001).
  1671     05  FILLER REDEFINES ACVCNDTF.
  1672         10  ACVCNDTA PIC  X(0001).
  1673     05  ACVCNDTI PIC  X(0008).
  1674*    -------------------------------
  1675     05  ACVEXITL PIC S9(0004) COMP.
  1676     05  ACVEXITF PIC  X(0001).
  1677     05  FILLER REDEFINES ACVEXITF.
  1678         10  ACVEXITA PIC  X(0001).
  1679     05  ACVEXITI PIC  X(0008).
  1680*    -------------------------------
  1681     05  ACVSTATL PIC S9(0004) COMP.
  1682     05  ACVSTATF PIC  X(0001).
  1683     05  FILLER REDEFINES ACVSTATF.
  1684         10  ACVSTATA PIC  X(0001).
  1685     05  ACVSTATI PIC  X(0006).
  1686*    -------------------------------
  1687     05  ERRMSG1L PIC S9(0004) COMP.
  1688     05  ERRMSG1F PIC  X(0001).
  1689     05  FILLER REDEFINES ERRMSG1F.
  1690         10  ERRMSG1A PIC  X(0001).
  1691     05  ERRMSG1I PIC  X(0072).
  1692*    -------------------------------
  1693     05  ERRMSG2L PIC S9(0004) COMP.
  1694     05  ERRMSG2F PIC  X(0001).
  1695     05  FILLER REDEFINES ERRMSG2F.
  1696         10  ERRMSG2A PIC  X(0001).
  1697     05  ERRMSG2I PIC  X(0072).
  1698*    -------------------------------
  1699     05  BCERT1L PIC S9(0004) COMP.
  1700     05  BCERT1F PIC  X(0001).
  1701     05  FILLER REDEFINES BCERT1F.
  1702         10  BCERT1A PIC  X(0001).
  1703     05  BCERT1I PIC  X(0010).
  1704*    -------------------------------
  1705     05  BSUFX1L PIC S9(0004) COMP.
  1706     05  BSUFX1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  33
* EL130.cbl
  1707     05  FILLER REDEFINES BSUFX1F.
  1708         10  BSUFX1A PIC  X(0001).
  1709     05  BSUFX1I PIC  X(0001).
  1710*    -------------------------------
  1711     05  BCERT2L PIC S9(0004) COMP.
  1712     05  BCERT2F PIC  X(0001).
  1713     05  FILLER REDEFINES BCERT2F.
  1714         10  BCERT2A PIC  X(0001).
  1715     05  BCERT2I PIC  X(0010).
  1716*    -------------------------------
  1717     05  BSUFX2L PIC S9(0004) COMP.
  1718     05  BSUFX2F PIC  X(0001).
  1719     05  FILLER REDEFINES BSUFX2F.
  1720         10  BSUFX2A PIC  X(0001).
  1721     05  BSUFX2I PIC  X(0001).
  1722*    -------------------------------
  1723     05  BCERT3L PIC S9(0004) COMP.
  1724     05  BCERT3F PIC  X(0001).
  1725     05  FILLER REDEFINES BCERT3F.
  1726         10  BCERT3A PIC  X(0001).
  1727     05  BCERT3I PIC  X(0010).
  1728*    -------------------------------
  1729     05  BSUFX3L PIC S9(0004) COMP.
  1730     05  BSUFX3F PIC  X(0001).
  1731     05  FILLER REDEFINES BSUFX3F.
  1732         10  BSUFX3A PIC  X(0001).
  1733     05  BSUFX3I PIC  X(0001).
  1734*    -------------------------------
  1735     05  BCERT4L PIC S9(0004) COMP.
  1736     05  BCERT4F PIC  X(0001).
  1737     05  FILLER REDEFINES BCERT4F.
  1738         10  BCERT4A PIC  X(0001).
  1739     05  BCERT4I PIC  X(0010).
  1740*    -------------------------------
  1741     05  BSUFX4L PIC S9(0004) COMP.
  1742     05  BSUFX4F PIC  X(0001).
  1743     05  FILLER REDEFINES BSUFX4F.
  1744         10  BSUFX4A PIC  X(0001).
  1745     05  BSUFX4I PIC  X(0001).
  1746*    -------------------------------
  1747     05  BCERT5L PIC S9(0004) COMP.
  1748     05  BCERT5F PIC  X(0001).
  1749     05  FILLER REDEFINES BCERT5F.
  1750         10  BCERT5A PIC  X(0001).
  1751     05  BCERT5I PIC  X(0010).
  1752*    -------------------------------
  1753     05  BSUFX5L PIC S9(0004) COMP.
  1754     05  BSUFX5F PIC  X(0001).
  1755     05  FILLER REDEFINES BSUFX5F.
  1756         10  BSUFX5A PIC  X(0001).
  1757     05  BSUFX5I PIC  X(0001).
  1758*    -------------------------------
  1759     05  ENTERPFL PIC S9(0004) COMP.
  1760     05  ENTERPFF PIC  X(0001).
  1761     05  FILLER REDEFINES ENTERPFF.
  1762         10  ENTERPFA PIC  X(0001).
  1763     05  ENTERPFI PIC  99.
  1764*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  34
* EL130.cbl
  1765     05  PF5L PIC S9(0004) COMP.
  1766     05  PF5F PIC  X(0001).
  1767     05  FILLER REDEFINES PF5F.
  1768         10  PF5A PIC  X(0001).
  1769     05  PF5I PIC  X(0013).
  1770 01  EL130AO REDEFINES EL130AI.
  1771     05  FILLER            PIC  X(0012).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  RUNDTEO PIC  X(0008).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  RUNTIMEO PIC  99.99.
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  COMPO PIC  X(0003).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  SEQUO PIC  X(0010).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  MAINTO PIC  X(0001).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  CLMNOO PIC  X(0007).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  CLMCARRO PIC  X(0001).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  CLMTYPEO PIC  X(0001).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  INSTYPEO PIC  X(0001).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  CERTNOO PIC  X(0010).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  SUFXO PIC  X(0001).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  PCERTNOO PIC  X(0010).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  PSUFXO PIC  X(0001).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  INCURO PIC  X(0008).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  REPORTO PIC  X(0008).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  ICD1O PIC  X(0008).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  ICD2O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  35
* EL130.cbl
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  DIAGO PIC  X(0060).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  BENECDO PIC  X(0010).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  BIRTHDTO PIC  X(0008).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  SSNO PIC  X(0011).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  SEXO PIC  X(0001).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  OCCCDO PIC  X(0006).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  LSTNMEO PIC  X(0015).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  FSTNMEO PIC  X(0012).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  INITO PIC  X(0001).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  LOANNOO PIC  X(0008).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  CRTLNMEO PIC  X(0015).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  CRTFNMEO PIC  X(0012).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  CRTINITO PIC  X(0001).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  LOANBALO PIC  ZZZZZ9.99.
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  MANRSVO PIC  Z(5)9.99.
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  SUPVO PIC  X(0001).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  PRICDO PIC  X(0001).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  PRODO PIC  X(0008).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  PRODCDO PIC  X(0001).
  1880*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  36
* EL130.cbl
  1881     05  FILLER            PIC  X(0003).
  1882     05  FILETOO PIC  X(0004).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  PROCCDO PIC  X(0004).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  RELCLMO PIC  X(0007).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  PRTOPTO PIC  X(0001).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  ALTPRTO PIC  X(0004).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  CERTMTO PIC  X(0001).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  CRTCARRO PIC  X(0001).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  GROUPO PIC  X(0006).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  STATEO PIC  X(0002).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  ACCOUNTO PIC  X(0010).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  EFFDTO PIC  X(0008).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  CRTSSNO PIC  X(0011).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  MEMCAPO PIC  X(0010).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  MEMBERO PIC  X(0012).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  REINCDO PIC  X(0001).
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  ISSAGEO PIC  X(0002).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  APRO PIC  9(3).9(4).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  PMTFREQO PIC  99.
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  INDGRPO PIC  X(0001).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  37
* EL130.cbl
  1939     05  PREMTYPO PIC  X(0001).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  ADDONDTO PIC  X(0008).
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  JNTLNMEO PIC  X(0015).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  JNTFNMEO PIC  X(0002).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  JNTINITO PIC  X(0001).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  JNTAGEO PIC  X(0002).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  LCVDSCRO PIC  X(0006).
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  LCVKINDO PIC  X(0003).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  LCVCDO PIC  X(0002).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  LCVOTRMO PIC  999.
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  LCVRTRMO PIC  ZZZ.
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  LCVRATEO PIC  ZZZ.ZZ.
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  LCVFORMO PIC  X(0012).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  LCVCNDTO PIC  X(0008).
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  LCVEXITO PIC  X(0008).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  LCVSTATO PIC  X(0006).
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  ACVDSCRO PIC  X(0006).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  ACVKINDO PIC  X(0003).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  ACVCDO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  38
* EL130.cbl
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  ACVOTRMO PIC  999.
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  ACVRTRMO PIC  ZZZ.
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  ACVRATEO PIC  ZZZ.ZZ.
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  ACVFORMO PIC  X(0012).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  ACVCNDTO PIC  X(0008).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  ACVEXITO PIC  X(0008).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  ACVSTATO PIC  X(0006).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  ERRMSG1O PIC  X(0072).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  ERRMSG2O PIC  X(0072).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  BCERT1O PIC  X(0010).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  BSUFX1O PIC  X(0001).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  BCERT2O PIC  X(0010).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  BSUFX2O PIC  X(0001).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  BCERT3O PIC  X(0010).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  BSUFX3O PIC  X(0001).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  BCERT4O PIC  X(0010).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  BSUFX4O PIC  X(0001).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  BCERT5O PIC  X(0010).
  2054*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  39
* EL130.cbl
  2055     05  FILLER            PIC  X(0003).
  2056     05  BSUFX5O PIC  X(0001).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  ENTERPFO PIC  X(0002).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  PF5O PIC  X(0013).
  2063*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  40
* EL130.cbl
  2065*    COPY ELCDATE.
  2066******************************************************************
  2067*                                                                *
  2068*                                                                *
  2069*                            ELCDATE.                            *
  2070*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2071*                            VMOD=2.003
  2072*                                                                *
  2073*                                                                *
  2074*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2075*                 LENGTH = 200                                   *
  2076******************************************************************
  2077
  2078 01  DATE-CONVERSION-DATA.
  2079     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2080     12  DC-OPTION-CODE                PIC X.
  2081         88  BIN-TO-GREG                VALUE ' '.
  2082         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2083         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2084         88  YMD-GREG-TO-BIN            VALUE '3'.
  2085         88  MDY-GREG-TO-BIN            VALUE '4'.
  2086         88  JULIAN-TO-BIN              VALUE '5'.
  2087         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2088         88  FIND-CENTURY               VALUE '7'.
  2089         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2090         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2091         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2092         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2093         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2094         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2095         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2096         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2097         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2098         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2099         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2100         88  BIN-3-TO-GREG              VALUE 'I'.
  2101         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2102         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2103         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2104         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2105         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2106         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2107         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2108         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2109         88  THREE-CHARACTER-BIN
  2110                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2111         88  GREGORIAN-TO-BIN
  2112                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2113         88  BIN-TO-GREGORIAN
  2114                  VALUES ' ' '1' 'I' '8' 'G'.
  2115         88  JULIAN-TO-BINARY
  2116                  VALUES '5' 'C' 'E' 'F'.
  2117     12  DC-ERROR-CODE                 PIC X.
  2118         88  NO-CONVERSION-ERROR        VALUE ' '.
  2119         88  DATE-CONVERSION-ERROR
  2120                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2121         88  DATE-IS-ZERO               VALUE '1'.
  2122         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  41
* EL130.cbl
  2123         88  DATE-IS-INVALID            VALUE '3'.
  2124         88  DATE1-GREATER-DATE2        VALUE '4'.
  2125         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2126         88  DATE-INVALID-OPTION        VALUE '9'.
  2127         88  INVALID-CENTURY            VALUE 'A'.
  2128         88  ONLY-CENTURY               VALUE 'B'.
  2129         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2130         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2131     12  DC-END-OF-MONTH               PIC X.
  2132         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2133     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2134         88  USE-NORMAL-PROCESS         VALUE ' '.
  2135         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2136         88  ADJUST-UP-100-YRS          VALUE '2'.
  2137     12  FILLER                        PIC X.
  2138     12  DC-CONVERSION-DATES.
  2139         16  DC-BIN-DATE-1             PIC XX.
  2140         16  DC-BIN-DATE-2             PIC XX.
  2141         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2142         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2143                       DC-GREG-DATE-1-EDIT.
  2144             20  DC-EDIT1-MONTH        PIC 99.
  2145             20  SLASH1-1              PIC X.
  2146             20  DC-EDIT1-DAY          PIC 99.
  2147             20  SLASH1-2              PIC X.
  2148             20  DC-EDIT1-YEAR         PIC 99.
  2149         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2150         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2151                     DC-GREG-DATE-2-EDIT.
  2152             20  DC-EDIT2-MONTH        PIC 99.
  2153             20  SLASH2-1              PIC X.
  2154             20  DC-EDIT2-DAY          PIC 99.
  2155             20  SLASH2-2              PIC X.
  2156             20  DC-EDIT2-YEAR         PIC 99.
  2157         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2158         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2159                     DC-GREG-DATE-1-YMD.
  2160             20  DC-YMD-YEAR           PIC 99.
  2161             20  DC-YMD-MONTH          PIC 99.
  2162             20  DC-YMD-DAY            PIC 99.
  2163         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2164         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2165                      DC-GREG-DATE-1-MDY.
  2166             20  DC-MDY-MONTH          PIC 99.
  2167             20  DC-MDY-DAY            PIC 99.
  2168             20  DC-MDY-YEAR           PIC 99.
  2169         16  DC-GREG-DATE-1-ALPHA.
  2170             20  DC-ALPHA-MONTH        PIC X(10).
  2171             20  DC-ALPHA-DAY          PIC 99.
  2172             20  FILLER                PIC XX.
  2173             20  DC-ALPHA-CENTURY.
  2174                 24 DC-ALPHA-CEN-N     PIC 99.
  2175             20  DC-ALPHA-YEAR         PIC 99.
  2176         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2177         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2178         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2179         16  DC-JULIAN-DATE            PIC 9(05).
  2180         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  42
* EL130.cbl
  2181                                       PIC 9(05).
  2182         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2183             20  DC-JULIAN-YEAR        PIC 99.
  2184             20  DC-JULIAN-DAYS        PIC 999.
  2185         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2186         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2187         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2188     12  DATE-CONVERSION-VARIBLES.
  2189         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2190         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2191             20  FILLER                PIC 9(3).
  2192             20  HOLD-CEN-1-CCYY.
  2193                 24  HOLD-CEN-1-CC     PIC 99.
  2194                 24  HOLD-CEN-1-YY     PIC 99.
  2195             20  HOLD-CEN-1-MO         PIC 99.
  2196             20  HOLD-CEN-1-DA         PIC 99.
  2197         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2198             20  HOLD-CEN-1-R-MO       PIC 99.
  2199             20  HOLD-CEN-1-R-DA       PIC 99.
  2200             20  HOLD-CEN-1-R-CCYY.
  2201                 24  HOLD-CEN-1-R-CC   PIC 99.
  2202                 24  HOLD-CEN-1-R-YY   PIC 99.
  2203             20  FILLER                PIC 9(3).
  2204         16  HOLD-CENTURY-1-X.
  2205             20  FILLER                PIC X(3)  VALUE SPACES.
  2206             20  HOLD-CEN-1-X-CCYY.
  2207                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2208                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2209             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2210             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2211         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2212             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2213             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2214             20  HOLD-CEN-1-R-X-CCYY.
  2215                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2216                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2217             20  FILLER                PIC XXX.
  2218         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2219         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2220         16  DC-JULIAN-DATE-1          PIC 9(07).
  2221         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2222             20  DC-JULIAN-1-CCYY.
  2223                 24  DC-JULIAN-1-CC    PIC 99.
  2224                 24  DC-JULIAN-1-YR    PIC 99.
  2225             20  DC-JULIAN-DA-1        PIC 999.
  2226         16  DC-JULIAN-DATE-2          PIC 9(07).
  2227         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2228             20  DC-JULIAN-2-CCYY.
  2229                 24  DC-JULIAN-2-CC    PIC 99.
  2230                 24  DC-JULIAN-2-YR    PIC 99.
  2231             20  DC-JULIAN-DA-2        PIC 999.
  2232         16  DC-GREG-DATE-A-EDIT.
  2233             20  DC-EDITA-MONTH        PIC 99.
  2234             20  SLASHA-1              PIC X VALUE '/'.
  2235             20  DC-EDITA-DAY          PIC 99.
  2236             20  SLASHA-2              PIC X VALUE '/'.
  2237             20  DC-EDITA-CCYY.
  2238                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  43
* EL130.cbl
  2239                 24  DC-EDITA-YEAR     PIC 99.
  2240         16  DC-GREG-DATE-B-EDIT.
  2241             20  DC-EDITB-MONTH        PIC 99.
  2242             20  SLASHB-1              PIC X VALUE '/'.
  2243             20  DC-EDITB-DAY          PIC 99.
  2244             20  SLASHB-2              PIC X VALUE '/'.
  2245             20  DC-EDITB-CCYY.
  2246                 24  DC-EDITB-CENT     PIC 99.
  2247                 24  DC-EDITB-YEAR     PIC 99.
  2248         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2249         16  DC-GREG-DATE-CYMD-R REDEFINES
  2250                              DC-GREG-DATE-CYMD.
  2251             20  DC-CYMD-CEN           PIC 99.
  2252             20  DC-CYMD-YEAR          PIC 99.
  2253             20  DC-CYMD-MONTH         PIC 99.
  2254             20  DC-CYMD-DAY           PIC 99.
  2255         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2256         16  DC-GREG-DATE-MDCY-R REDEFINES
  2257                              DC-GREG-DATE-MDCY.
  2258             20  DC-MDCY-MONTH         PIC 99.
  2259             20  DC-MDCY-DAY           PIC 99.
  2260             20  DC-MDCY-CEN           PIC 99.
  2261             20  DC-MDCY-YEAR          PIC 99.
  2262    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2263        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2264    12  DC-EL310-DATE                  PIC X(21).
  2265    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  44
* EL130.cbl
  2267*    COPY ELCCALC.
  2268******************************************************************
  2269*                                                                *
  2270*                           ELCCALC.                            *
  2271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2272*                            VMOD=2.025                          *
  2273*                                                                *
  2274*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2275*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2276*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2277*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2278*                                                                *
  2279*  PASSED TO ELRTRM                                              *
  2280*  -----------------                                             *
  2281*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2282*  ORIGINAL TERM                                                 *
  2283*  BEGINNING DATE                                                *
  2284*  ENDING DATE                                                   *
  2285*  COMPANY I.D.                                                  *
  2286*  ACCOUNT MASTER USER FIELD                                     *
  2287*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2288*  FREE LOOK DAYS                                                *
  2289*                                                                *
  2290*  RETURNED FROM ELRTRM                                          *
  2291*  ---------------------                                         *
  2292*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2293*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2294*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2295*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2296*----------------------------------------------------------------*
  2297*  PASSED TO ELRAMT                                              *
  2298*  ----------------                                              *
  2299*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2300*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2301*  ORIGINAL AMOUNT                                               *
  2302*  ALTERNATE BENEFIT (BALLON)                                    *
  2303*  A.P.R. - NET PAY ONLY                                         *
  2304*  METHOD
  2305*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2306*  COMPANY I.D.                                                  *
  2307*  BENEFIT TYPE                                                  *
  2308*                                                                *
  2309*  RETURNED FROM ELRAMT                                          *
  2310*  --------------------                                          *
  2311*  REMAINING AMOUNT 1 - CURRENT                                  *
  2312*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2313*  REMAINING AMOUNT FACTOR
  2314*----------------------------------------------------------------*
  2315*  PASSED TO ELRESV                                              *
  2316*  -----------------                                             *
  2317*  CERTIFICATE EFFECTIVE DATE                                    *
  2318*  VALUATION DATE                                                *
  2319*  PAID THRU DATE                                                *
  2320*  BENEFIT                                                       *
  2321*  INCURRED DATE                                                 *
  2322*  REPORTED DATE                                                 *
  2323*  ISSUE AGE                                                     *
  2324*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  45
* EL130.cbl
  2325*  CDT PERCENT                                                   *
  2326*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2327* *CLAIM TYPE (LIFE, A/H)                                        *
  2328* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2329* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2330*                                                                *
  2331*  RETURNED FROM ELRESV                                          *
  2332*  --------------------                                          *
  2333*  CDT TABLE USED                                                *
  2334*  CDT FACTOR USED                                               *
  2335*  PAY TO CURRENT RESERVE                                        *
  2336*  I.B.N.R. - A/H ONLY                                           *
  2337*  FUTURE (ACCRUED) AH ONLY                                      *
  2338*----------------------------------------------------------------*
  2339*  PASSED TO ELRATE                                              *
  2340*  ----------------                                              *
  2341*  CERT ISSUE DATE                                               *
  2342*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2343*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2344*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2345*  STATE CODE (CLIENT DEFINED)                                   *
  2346*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2347*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2348*  DEVIATION CODE                                                *
  2349*  ISSUE AGE                                                     *
  2350*  ORIGINAL BENEFIT AMOUNT                                       *
  2351*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2352*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2353*  BENEFIT KIND (LIFE OR A/H)                                    *
  2354*  A.P.R.                                                        *
  2355*  METHOD
  2356*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2357*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2358*  COMPANY I.D. (3 CHARACTER)                                    *
  2359*  BENEFIT CODE                                                  *
  2360*  BENEFIT OVERRIDE CODE                                         *
  2361*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2362*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2363*  JOINT INDICATOR (CSL ONLY)                                    *
  2364*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2365*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2366*                                                                *
  2367*  RETURNED FROM ELRATE                                          *
  2368*  --------------------                                          *
  2369*  CALCULATED PREMIUM                                            *
  2370*  PREMIUM RATE                                                  *
  2371*  MORTALITY CODE                                                *
  2372*  MAX ATTAINED AGE                                              *
  2373*  MAX AGE                                                       *
  2374*  MAX TERM                                                      *
  2375*  MAX MONTHLY BENEFIT                                           *
  2376*  MAX TOTAL BENIFIT                                             *
  2377*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2378*----------------------------------------------------------------*
  2379*  PASSED TO ELRFND                                              *
  2380*  ----------------                                              *
  2381*  CERT ISSUE DATE                                               *
  2382*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  46
* EL130.cbl
  2383*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2384*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2385*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2386*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2387*  STATE CODE (CLIENT DEFINED)                                   *
  2388*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2389*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2390*  DEVIATION CODE                                                *
  2391*  ISSUE AGE                                                     *
  2392*  ORIGINAL BENEFIT AMOUNT                                       *
  2393*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2394*  PROCESS TYPE (CANCEL)                                         *
  2395*  BENEFIT KIND (LIFE OR A/H)                                    *
  2396*  A.P.R.                                                        *
  2397*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2398*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2399*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2400*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2401*  COMPANY I.D. (3 CHARACTER)                                    *
  2402*  BENEFIT CODE                                                  *
  2403*  BENEFIT OVERRIDE CODE                                         *
  2404*                                                                *
  2405*  RETURNED FROM ELRFND                                          *
  2406*  --------------------                                          *
  2407*  CALCULATED REFUND                                             *
  2408*----------------------------------------------------------------*
  2409*  PASSED TO ELEARN                                              *
  2410*  ----------------                                              *
  2411*  CERT ISSUE DATE                                               *
  2412*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2413*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2414*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2415*  STATE CODE (CLIENT DEFINED)                                   *
  2416*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2417*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2418*  DEVIATION CODE                                                *
  2419*  ISSUE AGE                                                     *
  2420*  ORIGINAL BENEFIT AMOUNT                                       *
  2421*  BENEFIT KIND (LIFE OR A/H)                                    *
  2422*  A.P.R.                                                        *
  2423*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2424*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2425*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2426*  COMPANY I.D. (3 CHARACTER)                                    *
  2427*  BENEFIT CODE                                                  *
  2428*  BENEFIT OVERRIDE CODE                                         *
  2429*                                                                *
  2430*  RETURNED FROM ELEARN                                          *
  2431*  --------------------                                          *
  2432*  INDICATED  EARNINGS                                           *
  2433*----------------------------------------------------------------*
  2434*                 LENGTH = 450                                   *
  2435*                                                                *
  2436******************************************************************
  2437******************************************************************
  2438*                   C H A N G E   L O G
  2439*
  2440* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  47
* EL130.cbl
  2441*-----------------------------------------------------------------
  2442*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2443* EFFECTIVE    NUMBER
  2444*-----------------------------------------------------------------
  2445* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2446* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2447* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2448* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2449* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2450* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2451* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2452* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2453* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2454******************************************************************
  2455
  2456 01  CALCULATION-PASS-AREA.
  2457     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2458                                     COMP.
  2459
  2460     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2461       88  NO-CP-ERROR                             VALUE ZERO.
  2462       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2463                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2464       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2465       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2466       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2467       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2468       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2469       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2470       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2471       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2472       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2473       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2474       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2475       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2476       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2477       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2478       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2479       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2480       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2481
  2482     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2483       88  NO-CP-ERROR-2                           VALUE ZERO.
  2484***********************  INPUT AREAS ****************************
  2485
  2486     12  CP-CALCULATION-AREA.
  2487         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2488         16  CP-CERT-EFF-DT        PIC XX.
  2489         16  CP-VALUATION-DT       PIC XX.
  2490         16  CP-PAID-THRU-DT       PIC XX.
  2491         16  CP-BENEFIT-TYPE       PIC X.
  2492           88  CP-AH                               VALUE 'A' 'D'
  2493                                                   'I' 'U'.
  2494           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2495           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2496         16  CP-INCURRED-DT        PIC XX.
  2497         16  CP-REPORTED-DT        PIC XX.
  2498         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  48
* EL130.cbl
  2499         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2500         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2501                                     COMP-3.
  2502         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2503                                     COMP-3.
  2504         16  CP-CDT-METHOD         PIC X.
  2505           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2506           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2507           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2508         16  CP-CLAIM-TYPE         PIC X.
  2509           88  CP-AH-CLAIM                         VALUE 'A'.
  2510           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2511         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2512                                     COMP-3.
  2513         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2514                                     COMP-3.
  2515         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2516                                     COMP-3.
  2517         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2518                                     COMP-3.
  2519         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2520                                     COMP-3.
  2521         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2522                                     COMP-3.
  2523         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2524                                     COMP-3.
  2525         16  CP-REM-TERM-METHOD    PIC X.
  2526           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2527           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2528           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2529           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2530           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2531           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2532           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2533         16  CP-EARNING-METHOD     PIC X.
  2534           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2535           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2536           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2537           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2538           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2539           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2540           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2541           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2542           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2543           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2544           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2545           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2546           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2547           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2548         16  CP-PROCESS-TYPE       PIC X.
  2549           88  CP-CLAIM                            VALUE '1'.
  2550           88  CP-CANCEL                           VALUE '2'.
  2551           88  CP-ISSUE                            VALUE '3'.
  2552         16  CP-SPECIAL-CALC-CD    PIC X.
  2553           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2554           88  CP-1-MTH-INTEREST               VALUE ' '.
  2555           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2556           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  49
* EL130.cbl
  2557           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2558           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2559           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2560           88  CP-FARM-PLAN                    VALUE 'F'.
  2561           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2562           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2563           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2564           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2565           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2566           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2567           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2568           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2569           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2570           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2571                                                     'W' 'X'.
  2572           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2573           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2574           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2575           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2576           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2577           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2578           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2579           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2580           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2581           88  CP-CSL-METH-1                   VALUE '5'.
  2582           88  CP-CSL-METH-2                   VALUE '6'.
  2583           88  CP-CSL-METH-3                   VALUE '7'.
  2584           88  CP-CSL-METH-4                   VALUE '8'.
  2585
  2586         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2587                                     COMP-3.
  2588         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2589         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2590         16  CP-STATE              PIC XX          VALUE SPACE.
  2591         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2592         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2593           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2594               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2595         16  CP-R78-OPTION         PIC X.
  2596           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2597           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2598
  2599         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2600         16  CP-IBNR-RESERVE-SW    PIC X.
  2601         16  CP-CLAIM-STATUS       PIC X.
  2602         16  CP-RATE-FILE          PIC X.
  2603         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2604                                     COMP-3.
  2605
  2606         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2607         16  CP-AH-OVERRIDE-CODE   PIC X.
  2608
  2609         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2610                                     COMP-3.
  2611         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2612                                   PIC S9(5)V99 COMP-3.
  2613         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2614                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  50
* EL130.cbl
  2615         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2616                                     COMP-3.
  2617         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2618                                     COMP-3.
  2619         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2620                                  PIC S9(7)V99 COMP-3.
  2621
  2622         16  CP-PAID-FROM-DATE     PIC X(02).
  2623         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2624         16  CP-EXT-DAYS-CALC      PIC X.
  2625           88  CP-EXT-NO-CHG                   VALUE ' '.
  2626           88  CP-EXT-CHG-LF                   VALUE '1'.
  2627           88  CP-EXT-CHG-AH                   VALUE '2'.
  2628           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2629         16  CP-DOMICILE-STATE     PIC XX.
  2630         16  CP-CARRIER            PIC X.
  2631         16  CP-REIN-FLAG          PIC X.
  2632         16  CP-REM-TRM-CALC-OPTION PIC X.
  2633           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2634                      '2' '3' '4' '5'.
  2635           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2636           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2637           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2638           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2639           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2640           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2641           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2642           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2643         16  CP-SIG-SWITCH         PIC X.
  2644         16  CP-RATING-METHOD      PIC X.
  2645           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2646           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2647           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2648           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2649           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2650           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2651           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2652           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2653           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2654         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2655                                     COMP-3.
  2656         16  CP-BEN-CATEGORY       PIC X.
  2657         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2658         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2659                                   PIC S99V9(5) COMP-3.
  2660         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2661         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2662                                   PIC S99V9(5) COMP-3.
  2663         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2664         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2665         16  CP-EXPIRE-DT          PIC XX.
  2666         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2667         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2668         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2669         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2670         16  CP-DDF-SPEC-CALC      PIC X.
  2671             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2672             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  51
* EL130.cbl
  2673         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2674         16  CP-CANCEL-REASON      PIC X.
  2675         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2676         16  CP-PMT-MODE           PIC X.
  2677         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2678         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2679         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2680         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2681         16  FILLER                PIC X.
  2682
  2683***************    OUTPUT FROM ELRESV   ************************
  2684
  2685         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2686
  2687         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2688                                     COMP-3.
  2689         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2690                                     COMP-3.
  2691         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2692                                     COMP-3.
  2693         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2694                                     COMP-3.
  2695         16  FILLER                PIC X(09).
  2696***************    OUTPUT FROM ELRTRM   *************************
  2697
  2698         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2699                                     COMP-3.
  2700         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2701                                     COMP-3.
  2702         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2703                                     COMP-3.
  2704         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2705                                     COMP-3.
  2706         16  FILLER                PIC X(12).
  2707
  2708***************    OUTPUT FROM ELRAMT   *************************
  2709
  2710         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2711                                     COMP-3.
  2712         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2713                                     COMP-3.
  2714         16  FILLER                PIC X(12).
  2715
  2716***************    OUTPUT FROM ELRATE   *************************
  2717
  2718         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2719                                     COMP-3.
  2720         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2721                                     COMP-3.
  2722         16  CP-MORTALITY-CODE     PIC X(4).
  2723         16  CP-RATE-EDIT-FLAG     PIC X.
  2724             88  CP-RATES-NEED-APR                  VALUE '1'.
  2725         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2726                                     COMP-3.
  2727         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2728         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2729         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2730                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  52
* EL130.cbl
  2731         16  FILLER                PIC X(07).
  2732
  2733***************    OUTPUT FROM ELRFND   *************************
  2734
  2735         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2736                                     COMP-3.
  2737         16  CP-REFUND-TYPE-USED   PIC X.
  2738           88  CP-R-AS-R78                         VALUE '1'.
  2739           88  CP-R-AS-PRORATA                     VALUE '2'.
  2740           88  CP-R-AS-CALIF                       VALUE '3'.
  2741           88  CP-R-AS-TEXAS                       VALUE '4'.
  2742           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2743           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2744           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2745           88  CP-R-AS-MEAN                        VALUE '8'.
  2746           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2747           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2748           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2749           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2750           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2751           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2752         16  FILLER                PIC X(12).
  2753
  2754***************    OUTPUT FROM ELEARN   *************************
  2755
  2756         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2757                                     COMP-3.
  2758         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2759                                     COMP-3.
  2760         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2761                                     COMP-3.
  2762         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2763                                     COMP-3.
  2764         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2765                                     COMP-3.
  2766         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2767                                     COMP-3.
  2768         16  CP-EARNING-TYPE-USED  PIC X.
  2769           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2770           88  CP-E-AS-R78                         VALUE '1'.
  2771           88  CP-E-AS-PRORATA                     VALUE '2'.
  2772           88  CP-E-AS-TEXAS                       VALUE '4'.
  2773           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2774           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2775           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2776           88  CP-E-AS-MEAN                        VALUE '8'.
  2777           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2778         16  FILLER                PIC X(12).
  2779
  2780***************    OUTPUT FROM ELPMNT   *************************
  2781
  2782         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2783                                     COMP-3.
  2784         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2785                                     COMP-3.
  2786         16  FILLER                PIC X(12).
  2787
  2788***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  53
* EL130.cbl
  2789         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2790                                     COMP-3.
  2791         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2792                                     COMP-3.
  2793         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2794                                     COMP-3.
  2795         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2796                                     COMP-3.
  2797         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2798                                     COMP-3.
  2799         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2800                                     COMP-3.
  2801         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2802             88  OPEN-RATE-FILE                   VALUE 'O'.
  2803             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2804             88  IO-ERROR                         VALUE 'E'.
  2805
  2806         16  CP-FIRST-PAY-DATE     PIC XX.
  2807
  2808         16  CP-JOINT-INDICATOR    PIC X.
  2809
  2810         16  CP-RESERVE-REMAINING-TERM
  2811                                   PIC S9(4)V9    VALUE ZERO
  2812                                     COMP-3.
  2813
  2814         16  CP-INSURED-BIRTH-DT   PIC XX.
  2815
  2816         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2817                                     COMP-3.
  2818
  2819         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2820                                     COMP-3.
  2821
  2822         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2823                                     COMP-3.
  2824
  2825         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2826                                     COMP-3.
  2827
  2828         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2829                                     COMP-3.
  2830
  2831         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2832                                     COMP-3.
  2833
  2834         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2835                                     COMP-3.
  2836
  2837         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2838             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2839
  2840         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2841                                     COMP-3.
  2842         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2843                                     COMP-3.
  2844         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2845         16  FILLER                PIC X(15).
  2846******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  54
* EL130.cbl
  2848*    COPY ELCLOGOF.
  2849******************************************************************
  2850*                                                                *
  2851*                                                                *
  2852*                            ELCLOGOF.                           *
  2853*                            VMOD=2.001                          *
  2854*                                                                *
  2855*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2856*                                                                *
  2857******************************************************************
  2858 01  CLASIC-LOGOFF.
  2859     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2860     12  LOGOFF-TEXT.
  2861         16  FILLER          PIC X(5)    VALUE SPACES.
  2862         16  LOGOFF-MSG.
  2863             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2864             20  FILLER      PIC X       VALUE SPACES.
  2865             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2866         16  FILLER          PIC X(80)
  2867           VALUE '* YOU ARE NOW LOGGED OFF'.
  2868         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2869         16  FILLER          PIC X       VALUE QUOTE.
  2870         16  LOGOFF-SYS-MSG  PIC X(17)
  2871           VALUE 'S CLAS-IC SYSTEM '.
  2872     12  TEXT-MESSAGES.
  2873         16  UNACCESS-MSG    PIC X(29)
  2874             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2875         16  PGMIDERR-MSG    PIC X(17)
  2876             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  55
* EL130.cbl
  2878*    COPY ELCATTR.
  2879******************************************************************
  2880*                                                                *
  2881*                            ELCATTR.                            *
  2882*                            VMOD=2.001                          *
  2883*                                                                *
  2884*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2885*                                                                *
  2886*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2887*                                                                *
  2888*                   POS 1   P=PROTECTED                          *
  2889*                           U=UNPROTECTED                        *
  2890*                           S=ASKIP                              *
  2891*                   POS 2   A=ALPHA/NUMERIC                      *
  2892*                           N=NUMERIC                            *
  2893*                   POS 3   N=NORMAL                             *
  2894*                           B=BRIGHT                             *
  2895*                           D=DARK                               *
  2896*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2897*                           OF=MODIFIED DATA TAG OFF             *
  2898*                                                                *
  2899*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2900******************************************************************
  2901 01  ATTRIBUTE-LIST.
  2902     12  AL-PABOF            PIC X       VALUE 'Y'.
  2903     12  AL-PABON            PIC X       VALUE 'Z'.
  2904     12  AL-PADOF            PIC X       VALUE '%'.
  2905     12  AL-PADON            PIC X       VALUE '_'.
  2906     12  AL-PANOF            PIC X       VALUE '-'.
  2907     12  AL-PANON            PIC X       VALUE '/'.
  2908     12  AL-SABOF            PIC X       VALUE '8'.
  2909     12  AL-SABON            PIC X       VALUE '9'.
  2910     12  AL-SADOF            PIC X       VALUE '@'.
  2911     12  AL-SADON            PIC X       VALUE QUOTE.
  2912     12  AL-SANOF            PIC X       VALUE '0'.
  2913     12  AL-SANON            PIC X       VALUE '1'.
  2914     12  AL-UABOF            PIC X       VALUE 'H'.
  2915     12  AL-UABON            PIC X       VALUE 'I'.
  2916     12  AL-UADOF            PIC X       VALUE '<'.
  2917     12  AL-UADON            PIC X       VALUE '('.
  2918     12  AL-UANOF            PIC X       VALUE ' '.
  2919     12  AL-UANON            PIC X       VALUE 'A'.
  2920     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2921     12  AL-UNBON            PIC X       VALUE 'R'.
  2922     12  AL-UNDOF            PIC X       VALUE '*'.
  2923     12  AL-UNDON            PIC X       VALUE ')'.
  2924     12  AL-UNNOF            PIC X       VALUE '&'.
  2925     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  56
* EL130.cbl
  2927*    COPY ELCEMIB.
  2928******************************************************************
  2929*                                                                *
  2930*                                                                *
  2931*                            ELCEMIB.                            *
  2932*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2933*                            VMOD=2.005                          *
  2934*                                                                *
  2935*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2936*                                                                *
  2937******************************************************************
  2938 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2939     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2940     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2941     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2942     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2943     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2944     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2945     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2946     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2947     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2948         88  EMI-NO-ERRORS                    VALUE '1'.
  2949         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2950         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2951     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2952         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2953     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2954         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2955         88  EMI-AREA1-FULL                   VALUE '2'.
  2956     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2957         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2958         88  EMI-AREA2-FULL                   VALUE '2'.
  2959     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2960         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2961         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2962         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2963         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2964         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2965     12  EMI-ERROR-LINES.
  2966         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2967         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2968         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2969         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2970             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2971                 24  EMI-ERR-NUM         PIC X(4).
  2972                 24  EMI-FILLER          PIC X.
  2973                 24  EMI-SEV             PIC X.
  2974                 24  FILLER              PIC X.
  2975             20  FILLER                  PIC X(02).
  2976     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2977         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2978             20  EMI-ERROR-NUMBER    PIC X(4).
  2979             20  EMI-FILL            PIC X.
  2980             20  EMI-SEVERITY        PIC X.
  2981             20  FILLER              PIC X.
  2982             20  EMI-ERROR-TEXT.
  2983                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2984                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  57
* EL130.cbl
  2985     12  EMI-SEVERITY-SAVE           PIC X.
  2986         88  EMI-NOTE                    VALUE 'N'.
  2987         88  EMI-WARNING                 VALUE 'W'.
  2988         88  EMI-FORCABLE                VALUE 'F'.
  2989         88  EMI-FATAL                   VALUE 'X'.
  2990     12  EMI-MESSAGE-FLAG            PIC X.
  2991         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2992         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2993     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2994     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2995         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2996         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2997         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2998     12  emi-claim-no                pic x(7).
  2999     12  emi-claim-type              pic x(6).
  3000     12  FILLER                      PIC X(124)  VALUE SPACES.
  3001     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3002     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3003     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3004     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  58
* EL130.cbl
  3006*    COPY ELCJPFX.
  3007******************************************************************
  3008*                                                                *
  3009*                                                                *
  3010*                            ELCJPFX.                            *
  3011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3012*                            VMOD=2.002                          *
  3013*                                                                *
  3014*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3015*                                                                *
  3016*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3017*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3018*        ELCNTL - CONTROL FILE                                   *
  3019*        ELMSTR - CLAIM MASTERS                                  *
  3020*        ELTRLR - ACTIVITY TRAILERS                              *
  3021*        ELCHKQ - CHECK QUE                                      *
  3022******************************************************************
  3023 01  JOURNAL-RECORD.
  3024     12  jp-date                     pic s9(5) comp-3.
  3025     12  jp-time                     pic s9(7) comp-3.
  3026     12  JP-USER-ID                  PIC X(4).
  3027     12  JP-FILE-ID                  PIC X(8).
  3028     12  JP-PROGRAM-ID               PIC X(8).
  3029     12  JP-RECORD-TYPE              PIC X.
  3030         88 JP-ADD              VALUE 'A'.
  3031         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3032         88 JP-AFTER-CHANGE     VALUE 'C'.
  3033         88 JP-DELETE           VALUE 'D'.
  3034         88 JP-GENERIC-DELETE   VALUE 'G'.
  3035         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3036         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3037     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3038     12  JP-RECORD-AREA
  3039
  3040
  3041         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  59
* EL130.cbl
  3043*    COPY ELCAID.
  3044******************************************************************
  3045*                                                                *
  3046*                            ELCAID.                             *
  3047*                            VMOD=2.001                          *
  3048*                                                                *
  3049*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3050*                                                                *
  3051*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3052*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3053******************************************************************
  3054
  3055 01  DFHAID.
  3056   02  DFHNULL   PIC  X  VALUE  ' '.
  3057   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3058   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3059   02  DFHPEN    PIC  X  VALUE  '='.
  3060   02  DFHOPID   PIC  X  VALUE  'W'.
  3061   02  DFHPA1    PIC  X  VALUE  '%'.
  3062   02  DFHPA2    PIC  X  VALUE  '>'.
  3063   02  DFHPA3    PIC  X  VALUE  ','.
  3064   02  DFHPF1    PIC  X  VALUE  '1'.
  3065   02  DFHPF2    PIC  X  VALUE  '2'.
  3066   02  DFHPF3    PIC  X  VALUE  '3'.
  3067   02  DFHPF4    PIC  X  VALUE  '4'.
  3068   02  DFHPF5    PIC  X  VALUE  '5'.
  3069   02  DFHPF6    PIC  X  VALUE  '6'.
  3070   02  DFHPF7    PIC  X  VALUE  '7'.
  3071   02  DFHPF8    PIC  X  VALUE  '8'.
  3072   02  DFHPF9    PIC  X  VALUE  '9'.
  3073   02  DFHPF10   PIC  X  VALUE  ':'.
  3074   02  DFHPF11   PIC  X  VALUE  '#'.
  3075   02  DFHPF12   PIC  X  VALUE  '@'.
  3076   02  DFHPF13   PIC  X  VALUE  'A'.
  3077   02  DFHPF14   PIC  X  VALUE  'B'.
  3078   02  DFHPF15   PIC  X  VALUE  'C'.
  3079   02  DFHPF16   PIC  X  VALUE  'D'.
  3080   02  DFHPF17   PIC  X  VALUE  'E'.
  3081   02  DFHPF18   PIC  X  VALUE  'F'.
  3082   02  DFHPF19   PIC  X  VALUE  'G'.
  3083   02  DFHPF20   PIC  X  VALUE  'H'.
  3084   02  DFHPF21   PIC  X  VALUE  'I'.
  3085*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3086   02  DFHPF22   PIC  X  VALUE  '['.
  3087   02  DFHPF23   PIC  X  VALUE  '.'.
  3088   02  DFHPF24   PIC  X  VALUE  '<'.
  3089   02  DFHMSRE   PIC  X  VALUE  'X'.
  3090   02  DFHSTRF   PIC  X  VALUE  'h'.
  3091   02  DFHTRIG   PIC  X  VALUE  '"'.
  3092
  3093 01  FILLER    REDEFINES DFHAID.
  3094     12  FILLER              PIC X(8).
  3095     12  PF-VALUES           PIC X       OCCURS 12.
  3096
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  60
* EL130.cbl
  3098****************************************************************
  3099*
  3100* Copyright (c) 2007 by Clerity Solutions, Inc.
  3101* All rights reserved.
  3102*
  3103****************************************************************
  3104 01  DFHEIV.
  3105   02  DFHEIV0               PIC X(35).
  3106   02  DFHEIV1               PIC X(08).
  3107   02  DFHEIV2               PIC X(08).
  3108   02  DFHEIV3               PIC X(08).
  3109   02  DFHEIV4               PIC X(06).
  3110   02  DFHEIV5               PIC X(04).
  3111   02  DFHEIV6               PIC X(04).
  3112   02  DFHEIV7               PIC X(02).
  3113   02  DFHEIV8               PIC X(02).
  3114   02  DFHEIV9               PIC X(01).
  3115   02  DFHEIV10              PIC S9(7) COMP-3.
  3116   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3117   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3118   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3119   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3120   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3121   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3122   02  DFHEIV17              PIC X(04).
  3123   02  DFHEIV18              PIC X(04).
  3124   02  DFHEIV19              PIC X(04).
  3125   02  DFHEIV20              USAGE IS POINTER.
  3126   02  DFHEIV21              USAGE IS POINTER.
  3127   02  DFHEIV22              USAGE IS POINTER.
  3128   02  DFHEIV23              USAGE IS POINTER.
  3129   02  DFHEIV24              USAGE IS POINTER.
  3130   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3131   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3132   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3133   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3134   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3135   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3136   02  FILLER                PIC X(02).
  3137   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3138   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3139   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3140   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3141   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3142 LINKAGE  SECTION.
  3143*****************************************************************
  3144*                                                               *
  3145* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3146* All rights reserved.                                          *
  3147*                                                               *
  3148*****************************************************************
  3149 01  dfheiblk.
  3150     02  eibtime          pic s9(7) comp-3.
  3151     02  eibdate          pic s9(7) comp-3.
  3152     02  eibtrnid         pic x(4).
  3153     02  eibtaskn         pic s9(7) comp-3.
  3154     02  eibtrmid         pic x(4).
  3155     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  61
* EL130.cbl
  3156     02  eibcposn         pic s9(4) comp.
  3157     02  eibcalen         pic s9(4) comp.
  3158     02  eibaid           pic x(1).
  3159     02  eibfiller1       pic x(1).
  3160     02  eibfn            pic x(2).
  3161     02  eibfiller2       pic x(2).
  3162     02  eibrcode         pic x(6).
  3163     02  eibfiller3       pic x(2).
  3164     02  eibds            pic x(8).
  3165     02  eibreqid         pic x(8).
  3166     02  eibrsrce         pic x(8).
  3167     02  eibsync          pic x(1).
  3168     02  eibfree          pic x(1).
  3169     02  eibrecv          pic x(1).
  3170     02  eibsend          pic x(1).
  3171     02  eibatt           pic x(1).
  3172     02  eibeoc           pic x(1).
  3173     02  eibfmh           pic x(1).
  3174     02  eibcompl         pic x(1).
  3175     02  eibsig           pic x(1).
  3176     02  eibconf          pic x(1).
  3177     02  eiberr           pic x(1).
  3178     02  eibrldbk         pic x(1).
  3179     02  eiberrcd         pic x(4).
  3180     02  eibsynrb         pic x(1).
  3181     02  eibnodat         pic x(1).
  3182     02  eibfiller5       pic x(2).
  3183     02  eibresp          pic 9(09) comp.
  3184     02  eibresp2         pic 9(09) comp.
  3185     02  dfheigdj         pic s9(4) comp.
  3186     02  dfheigdk         pic s9(4) comp.
  3187
  3188 01  DFHCOMMAREA             PIC X(1024).
  3189
  3190*01 PARMLIST .
  3191*    02  FILLER              PIC S9(8)   COMP.
  3192*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3193*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3194*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3195*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3196*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3197*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3198*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3199*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3200*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  62
* EL130.cbl
  3202*    COPY ELCMSTR.
  3203******************************************************************
  3204*                                                                *
  3205*                            ELCMSTR.                            *
  3206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3207*                            VMOD=2.012                          *
  3208*                                                                *
  3209*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3210*                                                                *
  3211*   FILE TYPE = VSAM,KSDS                                        *
  3212*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3213*                                                                *
  3214*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3215*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3216*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3217*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3218*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3219*                                                 RKP=75,LEN=21  *
  3220*                                                                *
  3221*   **** NOTE ****                                               *
  3222*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3223*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3224*                                                                *
  3225*   LOG = YES                                                    *
  3226*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3227******************************************************************
  3228*                   C H A N G E   L O G
  3229*
  3230* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3231*-----------------------------------------------------------------
  3232*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3233* EFFECTIVE    NUMBER
  3234*-----------------------------------------------------------------
  3235* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3236* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3237* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3238******************************************************************
  3239 01  CLAIM-MASTER.
  3240     12  CL-RECORD-ID                PIC XX.
  3241         88  VALID-CL-ID         VALUE 'CL'.
  3242
  3243     12  CL-CONTROL-PRIMARY.
  3244         16  CL-COMPANY-CD           PIC X.
  3245         16  CL-CARRIER              PIC X.
  3246         16  CL-CLAIM-NO             PIC X(7).
  3247         16  CL-CERT-NO.
  3248             20  CL-CERT-PRIME       PIC X(10).
  3249             20  CL-CERT-SFX         PIC X.
  3250
  3251     12  CL-CONTROL-BY-NAME.
  3252         16  CL-COMPANY-CD-A1        PIC X.
  3253         16  CL-INSURED-LAST-NAME    PIC X(15).
  3254         16  CL-INSURED-NAME.
  3255             20  CL-INSURED-1ST-NAME PIC X(12).
  3256             20  CL-INSURED-MID-INIT PIC X.
  3257
  3258     12  CL-CONTROL-BY-SSN.
  3259         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  63
* EL130.cbl
  3260         16  CL-SOC-SEC-NO.
  3261             20  CL-SSN-STATE        PIC XX.
  3262             20  CL-SSN-ACCOUNT      PIC X(6).
  3263             20  CL-SSN-LN3          PIC X(3).
  3264
  3265     12  CL-CONTROL-BY-CERT-NO.
  3266         16  CL-COMPANY-CD-A4        PIC X.
  3267         16  CL-CERT-NO-A4.
  3268             20  CL-CERT-A4-PRIME    PIC X(10).
  3269             20  CL-CERT-A4-SFX      PIC X.
  3270
  3271     12  CL-CONTROL-BY-CCN.
  3272         16  CL-COMPANY-CD-A5        PIC X.
  3273         16  CL-CCN-A5.
  3274             20  CL-CCN.
  3275                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3276                 24  CL-CCN-PRIME-A5 PIC X(12).
  3277             20  CL-CCN-FILLER-A5    PIC X(4).
  3278
  3279     12  CL-INSURED-PROFILE-DATA.
  3280         16  CL-INSURED-BIRTH-DT     PIC XX.
  3281         16  CL-INSURED-SEX-CD       PIC X.
  3282             88  INSURED-IS-MALE        VALUE 'M'.
  3283             88  INSURED-IS-FEMALE      VALUE 'F'.
  3284             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3285         16  CL-INSURED-OCC-CD       PIC X(6).
  3286         16  FILLER                  PIC X(5).
  3287
  3288     12  CL-PROCESSING-INFO.
  3289         16  CL-PROCESSOR-ID         PIC X(4).
  3290         16  CL-CLAIM-STATUS         PIC X.
  3291             88  CLAIM-IS-OPEN          VALUE 'O'.
  3292             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3293         16  CL-CLAIM-TYPE           PIC X.
  3294*            88  AH-CLAIM               VALUE 'A'.
  3295*            88  LIFE-CLAIM             VALUE 'L'.
  3296*            88  PROPERTY-CLAIM         VALUE 'P'.
  3297*            88  IUI-CLAIM              VALUE 'I'.
  3298*            88  GAP-CLAIM              VALUE 'G'.
  3299         16  CL-CLAIM-PREM-TYPE      PIC X.
  3300             88  SINGLE-PREMIUM         VALUE '1'.
  3301             88  O-B-COVERAGE           VALUE '2'.
  3302             88  OPEN-END-COVERAGE      VALUE '3'.
  3303         16  CL-INCURRED-DT          PIC XX.
  3304         16  CL-REPORTED-DT          PIC XX.
  3305         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3306         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3307         16  CL-LAST-PMT-DT          PIC XX.
  3308         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3309         16  CL-PAID-THRU-DT         PIC XX.
  3310         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3311         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3312         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3313         16  CL-PMT-CALC-METHOD      PIC X.
  3314             88  CL-360-DAY-YR          VALUE '1'.
  3315             88  CL-365-DAY-YR          VALUE '2'.
  3316             88  CL-FULL-MONTHS         VALUE '3'.
  3317         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  64
* EL130.cbl
  3318
  3319         16  CL-PRIME-CERT-NO.
  3320             20  CL-PRIME-CERT-PRIME PIC X(10).
  3321             20  CL-PRIME-CERT-SFX   PIC X.
  3322
  3323         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3324             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3325             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3326
  3327         16  CL-MICROFILM-NO         PIC X(10).
  3328         16  CL-PROG-FORM-TYPE       PIC X.
  3329         16  CL-LAST-ADD-ON-DT       PIC XX.
  3330
  3331         16  CL-LAST-REOPEN-DT       PIC XX.
  3332         16  CL-LAST-CLOSE-DT        PIC XX.
  3333         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3334             88  FINAL-PAID             VALUE '1'.
  3335             88  CLAIM-DENIED           VALUE '2'.
  3336             88  AUTO-CLOSE             VALUE '3'.
  3337             88  MANUAL-CLOSE           VALUE '4'.
  3338             88  BENEFITS-CHANGED       VALUE 'C'.
  3339             88  SETUP-ERRORS           VALUE 'E'.
  3340         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3341         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3342         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3343             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3344         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3345         16  FILLER                  PIC X.
  3346
  3347     12  CL-CERTIFICATE-DATA.
  3348         16  CL-CERT-ORIGIN          PIC X.
  3349             88  CERT-WAS-ONLINE        VALUE '1'.
  3350             88  CERT-WAS-CREATED       VALUE '2'.
  3351             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3352         16  CL-CERT-KEY-DATA.
  3353             20  CL-CERT-CARRIER     PIC X.
  3354             20  CL-CERT-GROUPING    PIC X(6).
  3355             20  CL-CERT-STATE       PIC XX.
  3356             20  CL-CERT-ACCOUNT.
  3357                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3358                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3359             20  CL-CERT-EFF-DT      PIC XX.
  3360
  3361     12  CL-STATUS-CONTROLS.
  3362         16  CL-PRIORITY-CD          PIC X.
  3363             88  CONFIDENTIAL-DATA      VALUE '8'.
  3364             88  HIGHEST-PRIORITY       VALUE '9'.
  3365         16  CL-SUPV-ATTN-CD         PIC X.
  3366             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3367             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3368         16  CL-PURGED-DT            PIC XX.
  3369         16  CL-RESTORED-DT          PIC XX.
  3370         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3371         16  CL-NEXT-RESEND-DT       PIC XX.
  3372         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3373         16  CL-CRITICAL-PERIOD      PIC 99.
  3374*        16  FILLER                  PIC XX.
  3375         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  65
* EL130.cbl
  3376         16  CL-LAST-MAINT-USER      PIC X(4).
  3377         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3378         16  CL-LAST-MAINT-TYPE      PIC X.
  3379             88  CLAIM-SET-UP           VALUE ' '.
  3380             88  PAYMENT-MADE           VALUE '1'.
  3381             88  LETTER-SENT            VALUE '2'.
  3382             88  MASTER-WAS-ALTERED     VALUE '3'.
  3383             88  MASTER-WAS-RESTORED    VALUE '4'.
  3384             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3385             88  FILE-CONVERTED         VALUE '6'.
  3386             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3387             88  ERROR-CORRECTION       VALUE 'E'.
  3388         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3389         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3390         16  CL-BENEFICIARY          PIC X(10).
  3391         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3392         16  CL-DENIAL-TYPE          PIC X.
  3393             88  CL-TYPE-DENIAL          VALUE '1'.
  3394             88  CL-TYPE-RESCISSION      VALUE '2'.
  3395             88  CL-TYPE-REFORMATION     VALUE '3'.
  3396             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3397             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3398         16  CL-CRIT-PER-RECURRENT   PIC X.
  3399         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3400         16  CL-RTW-DT               PIC XX.
  3401
  3402     12  CL-TRAILER-CONTROLS.
  3403         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3404             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3405             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3406             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3407         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3408         16  FILLER                  PIC XX.
  3409         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3410         16  CL-ADDRESS-TRAILER-CNT.
  3411             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3412                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3413             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3414                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3415             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3416                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3417             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3418                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3419             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3420                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3421             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3422                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3423             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3424                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3425
  3426     12  CL-CV-REFERENCE-NO.
  3427         16  CL-CV-REFNO-PRIME       PIC X(18).
  3428         16  CL-CV-REFNO-SFX         PIC XX.
  3429
  3430     12  CL-FILE-LOCATION            PIC X(4).
  3431
  3432     12  CL-PROCESS-ERRORS.
  3433         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  66
* EL130.cbl
  3434             88  NO-FATAL-ERRORS        VALUE ZERO.
  3435         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3436             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3437
  3438     12  CL-PRODUCT-CD               PIC X.
  3439
  3440     12  CL-CURRENT-KEY-DATA.
  3441         16  CL-CURRENT-CARRIER      PIC X.
  3442         16  CL-CURRENT-GROUPING     PIC X(6).
  3443         16  CL-CURRENT-STATE        PIC XX.
  3444         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3445
  3446     12  CL-ASSOCIATES               PIC X.
  3447         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3448         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3449         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3450         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3451
  3452     12  CL-ACTIVITY-CODE            PIC 99.
  3453     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3454     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3455
  3456     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3457     12  CL-LAG-REPORT-CODE          PIC 9.
  3458     12  CL-LOAN-TYPE                PIC XX.
  3459     12  CL-LEGAL-STATE              PIC XX.
  3460
  3461     12  CL-YESNOSW                  PIC X.
  3462     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3463         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3464         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3465         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3466     12  cl-insured-claim            pic x.
  3467         88  cl-claim-on-primary         value 'P'.
  3468         88  cl-claim-on-secondary       value 'S'.
  3469     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  67
* EL130.cbl
  3471*    COPY ELCCNTL.
  3472******************************************************************
  3473*                                                                *
  3474*                                                                *
  3475*                            ELCCNTL.                            *
  3476*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3477*                            VMOD=2.059                          *
  3478*                                                                *
  3479*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3480*                                                                *
  3481*   FILE TYPE = VSAM,KSDS                                        *
  3482*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3483*                                                                *
  3484*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3485*       ALTERNATE INDEX = NONE                                   *
  3486*                                                                *
  3487*   LOG = YES                                                    *
  3488*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3489******************************************************************
  3490*                   C H A N G E   L O G
  3491*
  3492* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3493*-----------------------------------------------------------------
  3494*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3495* EFFECTIVE    NUMBER
  3496*-----------------------------------------------------------------
  3497* 082503                   PEMA  ADD BENEFIT GROUP
  3498* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3499* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3500* 092705    2005050300006  PEMA  ADD SPP LEASES
  3501* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3502* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3503* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3504* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3505* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3506* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3507* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3508* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3509* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3510******************************************************************
  3511*
  3512 01  CONTROL-FILE.
  3513     12  CF-RECORD-ID                       PIC XX.
  3514         88  VALID-CF-ID                        VALUE 'CF'.
  3515
  3516     12  CF-CONTROL-PRIMARY.
  3517         16  CF-COMPANY-ID                  PIC XXX.
  3518         16  CF-RECORD-TYPE                 PIC X.
  3519             88  CF-COMPANY-MASTER              VALUE '1'.
  3520             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3521             88  CF-STATE-MASTER                VALUE '3'.
  3522             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3523             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3524             88  CF-CARRIER-MASTER              VALUE '6'.
  3525             88  CF-MORTALITY-MASTER            VALUE '7'.
  3526             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3527             88  CF-TERMINAL-MASTER             VALUE '9'.
  3528             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  68
* EL130.cbl
  3529             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3530             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3531             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3532             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3533             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3534             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3535             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3536             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3537         16  CF-ACCESS-CD-GENL              PIC X(4).
  3538         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3539             20  CF-PROCESSOR               PIC X(4).
  3540         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3541             20  CF-STATE-CODE              PIC XX.
  3542             20  FILLER                     PIC XX.
  3543         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3544             20  FILLER                     PIC XX.
  3545             20  CF-HI-BEN-IN-REC           PIC XX.
  3546         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3547             20  FILLER                     PIC XXX.
  3548             20  CF-CARRIER-CNTL            PIC X.
  3549         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3550             20  FILLER                     PIC XX.
  3551             20  CF-HI-TYPE-IN-REC          PIC 99.
  3552         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3553             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3554                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3555             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3556             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3557         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3558             20  FILLER                     PIC X.
  3559             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3560         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3561             20  FILLER                     PIC XX.
  3562             20  CF-MORTGAGE-PLAN           PIC XX.
  3563         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3564
  3565     12  CF-LAST-MAINT-DT                   PIC XX.
  3566     12  CF-LAST-MAINT-BY                   PIC X(4).
  3567     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3568
  3569     12  CF-RECORD-BODY                     PIC X(728).
  3570
  3571
  3572****************************************************************
  3573*             COMPANY MASTER RECORD                            *
  3574****************************************************************
  3575
  3576     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3577         16  CF-COMPANY-ADDRESS.
  3578             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3579             20  CF-CL-IN-CARE-OF           PIC X(30).
  3580             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3581             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3582             20  CF-CL-CITY-STATE           PIC X(30).
  3583             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3584             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3585         16  CF-COMPANY-CD                  PIC X.
  3586         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  69
* EL130.cbl
  3587         16  CF-SECURITY-OPTION             PIC X.
  3588             88  ALL-SECURITY                   VALUE '1'.
  3589             88  COMPANY-VERIFY                 VALUE '2'.
  3590             88  PROCESSOR-VERIFY               VALUE '3'.
  3591             88  NO-SECURITY                    VALUE '4'.
  3592             88  ALL-BUT-TERM                   VALUE '5'.
  3593         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3594             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3595         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3596             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3597         16  CF-INFORCE-LOCATION            PIC X.
  3598             88  CERTS-ARE-ONLINE               VALUE '1'.
  3599             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3600             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3601         16  CF-LOWER-CASE-LETTERS          PIC X.
  3602         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3603             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3604             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3605             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3606             88  CF-ACCNT-CNTL                  VALUE '3'.
  3607             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3608
  3609         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3610         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3611
  3612         16  CF-LGX-CREDIT-USER             PIC X.
  3613             88  CO-IS-NOT-USER                 VALUE 'N'.
  3614             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3615
  3616         16 CF-CREDIT-CALC-CODES.
  3617             20  CF-CR-REM-TERM-CALC PIC X.
  3618               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3619               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3620               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3621               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3622               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3623               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3624               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3625             20  CF-CR-R78-METHOD           PIC X.
  3626               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3627               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3628
  3629         16  CF-CLAIM-CONTROL-COUNTS.
  3630             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3631                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3632
  3633             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3634                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3635
  3636             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3637                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3638
  3639             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3640                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3641
  3642         16  CF-CURRENT-MONTH-END           PIC XX.
  3643
  3644         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  70
* EL130.cbl
  3645             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3646             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3647             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3648             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3649                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3650                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3651             20  CF-CO-PREM-REJECT-SW       PIC X.
  3652                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3653                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3654             20  CF-CO-REF-REJECT-SW        PIC X.
  3655                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3656                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3657
  3658         16  CF-CO-REPORTING-DT             PIC XX.
  3659         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3660         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3661           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3662           88  CF-CO-MONTH-END                  VALUE '1'.
  3663
  3664         16  CF-LGX-CLAIM-USER              PIC X.
  3665             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3666             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3667
  3668         16  CF-CREDIT-EDIT-CONTROLS.
  3669             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3670             20  CF-MIN-AGE                 PIC 99.
  3671             20  CF-DEFAULT-AGE             PIC 99.
  3672             20  CF-MIN-TERM                PIC S999      COMP-3.
  3673             20  CF-MAX-TERM                PIC S999      COMP-3.
  3674             20  CF-DEFAULT-SEX             PIC X.
  3675             20  CF-JOINT-AGE-INPUT         PIC X.
  3676                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3677             20  CF-BIRTH-DATE-INPUT        PIC X.
  3678                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3679             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3680                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3681                 88  CF-ZERO-CARRIER            VALUE '1'.
  3682                 88  CF-ZERO-GROUPING           VALUE '2'.
  3683                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3684             20  CF-EDIT-SW                 PIC X.
  3685                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3686             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3687             20  CF-CR-PR-METHOD            PIC X.
  3688               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3689               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3690             20  FILLER                     PIC X.
  3691
  3692         16  CF-CREDIT-MISC-CONTROLS.
  3693             20  CF-REIN-TABLE-SW           PIC X.
  3694                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3695             20  CF-COMP-TABLE-SW           PIC X.
  3696                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3697             20  CF-EXPERIENCE-RETENTION-AGE
  3698                                            PIC S9        COMP-3.
  3699             20  CF-CONVERSION-DT           PIC XX.
  3700             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3701             20  CF-RUN-FREQUENCY-SW        PIC X.
  3702                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  71
* EL130.cbl
  3703                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3704
  3705             20  CF-CR-CHECK-NO-CONTROL.
  3706                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3707                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3708                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3709                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3710                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3711                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3712
  3713                 24  CF-CR-CHECK-COUNT       REDEFINES
  3714                     CF-CR-CHECK-COUNTER      PIC X(4).
  3715
  3716                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3717                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3718
  3719                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3720                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3721                 24  CF-MAIL-PROCESSING       PIC X.
  3722                     88  MAIL-PROCESSING          VALUE 'Y'.
  3723
  3724         16  CF-MISC-SYSTEM-CONTROL.
  3725             20  CF-SYSTEM-C                 PIC X.
  3726                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3727             20  CF-SYSTEM-D                 PIC X.
  3728                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3729             20  CF-SOC-SEC-NO-SW            PIC X.
  3730                 88  SOC-SEC-NO-USED             VALUE '1'.
  3731             20  CF-MEMBER-NO-SW             PIC X.
  3732                 88  MEMBER-NO-USED              VALUE '1'.
  3733             20  CF-TAX-ID-NUMBER            PIC X(11).
  3734             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3735             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3736                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3737                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3738                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3739                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3740             20  CF-SYSTEM-E                 PIC X.
  3741                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3742
  3743         16  CF-LGX-LIFE-USER               PIC X.
  3744             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3745             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3746
  3747         16  CF-CR-MONTH-END-DT             PIC XX.
  3748
  3749         16  CF-FILE-MAINT-DATES.
  3750             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3751                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3752             20  CF-LAST-BATCH       REDEFINES
  3753                 CF-LAST-BATCH-NO               PIC X(4).
  3754             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3755             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3756             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3757             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3758             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3759             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3760             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  72
* EL130.cbl
  3761             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3762             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3763             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3764
  3765         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3766         16  FILLER                         PIC X.
  3767
  3768         16  CF-ALT-MORT-CODE               PIC X(4).
  3769         16  CF-MEMBER-CAPTION              PIC X(10).
  3770
  3771         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3772             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3773             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3774             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3775             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3776             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3777
  3778         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3779
  3780         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3781         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3782         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3783         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3784
  3785         16  CF-AH-OVERRIDE-L1              PIC X.
  3786         16  CF-AH-OVERRIDE-L2              PIC XX.
  3787         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3788         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3789
  3790         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3791         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3792
  3793         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3794         16  CF-AR-LAST-EL860-DT            PIC XX.
  3795         16  CF-MP-MONTH-END-DT             PIC XX.
  3796
  3797         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3798         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3799             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3800
  3801         16  CF-AR-MONTH-END-DT             PIC XX.
  3802
  3803         16  CF-CRDTCRD-USER                PIC X.
  3804             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3805             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3806
  3807         16  CF-CC-MONTH-END-DT             PIC XX.
  3808
  3809         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3810
  3811         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3812             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3813             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3814             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3815         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3816         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3817         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3818         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  73
* EL130.cbl
  3819             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3820             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3821         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3822         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3823         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3824             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3825         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3826
  3827         16  CF-CL-ZIP-CODE.
  3828             20  CF-CL-ZIP-PRIME.
  3829                 24  CF-CL-ZIP-1ST          PIC X.
  3830                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3831                 24  FILLER                 PIC X(4).
  3832             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3833         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3834             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3835             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3836             20  FILLER                     PIC XXX.
  3837
  3838         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3839         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3840         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3841         16  CF-CO-OPTION-START-DATE        PIC XX.
  3842         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3843           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3844                                                      '3' '4'.
  3845           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3846           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3847           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3848           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3849           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3850           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3851
  3852         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3853
  3854         16  CF-PAYMENT-APPROVAL-LEVELS.
  3855             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3856             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3857             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3858             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3859             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3860             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3861
  3862         16  CF-END-USER-REPORTING-USER     PIC X.
  3863             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3864             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3865
  3866         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3867             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3868             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3869
  3870         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3871
  3872         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3873         16  FILLER                         PIC X.
  3874
  3875         16  CF-CREDIT-ARCHIVE-CNTL.
  3876             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  74
* EL130.cbl
  3877             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3878             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3879
  3880         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3881
  3882         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3883             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3884             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3885
  3886         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3887             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3888             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3889
  3890         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3891
  3892         16  CF-CO-ACH-ID-CODE              PIC  X.
  3893             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3894             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3895             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3896         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3897         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3898         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3899         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3900         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3901         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3902         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3903         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3904         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3905                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3906         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3907                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3908
  3909         16  CF-CO-OVER-SHORT.
  3910             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3911             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3912
  3913*         16  FILLER                         PIC X(102).
  3914         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3915             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3916             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3917
  3918         16  CF-AH-APPROVAL-DAYS.
  3919             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3920             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3921             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3922             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3923
  3924         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3925
  3926         16  CF-APPROV-LEV-5.
  3927             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3928             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3929             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3930
  3931         16  FILLER                         PIC X(68).
  3932****************************************************************
  3933*             PROCESSOR/USER RECORD                            *
  3934****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  75
* EL130.cbl
  3935
  3936     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3937         16  CF-PROCESSOR-NAME              PIC X(30).
  3938         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3939         16  CF-PROCESSOR-TITLE             PIC X(26).
  3940         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3941                 88  MESSAGE-YES                VALUE 'Y'.
  3942                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3943
  3944*****************************************************
  3945****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3946****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3947****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3948****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3949*****************************************************
  3950
  3951         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3952             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3953             20  CF-APPLICATION-FORCE       PIC X.
  3954             20  CF-INDIVIDUAL-APP.
  3955                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3956                     28  CF-BROWSE-APP      PIC X.
  3957                     28  CF-UPDATE-APP      PIC X.
  3958
  3959         16  CF-CURRENT-TERM-ON             PIC X(4).
  3960         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3961             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3962             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3963             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3964             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3965             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3966             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3967             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3968         16  CF-PROCESSOR-CARRIER           PIC X.
  3969             88  NO-CARRIER-SECURITY            VALUE ' '.
  3970         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3971             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3972         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3973             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3974         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3975             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3976
  3977         16  CF-PROC-SYS-ACCESS-SW.
  3978             20  CF-PROC-CREDIT-CLAIMS-SW.
  3979                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3980                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3981                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3982                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3983             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3984                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3985                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3986             20  CF-PROC-LIFE-GNRLDGR-SW.
  3987                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3988                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3989                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3990                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3991             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3992                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  76
* EL130.cbl
  3993                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3994         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3995             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3996             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3997         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3998
  3999         16  CF-APPROVAL-LEVEL                  PIC X.
  4000             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4001             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4002             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4003             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4004             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4005
  4006         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4007
  4008         16  CF-LANGUAGE-TYPE                   PIC X.
  4009             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4010             88  CF-LANG-IS-FR                      VALUE 'F'.
  4011
  4012         16  CF-CSR-IND                         PIC X.
  4013         16  FILLER                             PIC X(239).
  4014
  4015****************************************************************
  4016*             PROCESSOR/REMINDERS RECORD                       *
  4017****************************************************************
  4018
  4019     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4020         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4021             20  CF-START-REMIND-DT         PIC XX.
  4022             20  CF-END-REMIND-DT           PIC XX.
  4023             20  CF-REMINDER-TEXT           PIC X(50).
  4024         16  FILLER                         PIC X(296).
  4025
  4026
  4027****************************************************************
  4028*             STATE MASTER RECORD                              *
  4029****************************************************************
  4030
  4031     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4032         16  CF-STATE-ABBREVIATION          PIC XX.
  4033         16  CF-STATE-NAME                  PIC X(25).
  4034         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4035         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4036             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4037             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4038             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4039             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4040                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4041                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4042             20  CF-ST-PREM-REJECT-SW       PIC X.
  4043                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4044                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4045             20  CF-ST-REF-REJECT-SW        PIC X.
  4046                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4047                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4048         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4049         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4050         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  77
* EL130.cbl
  4051             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4052             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4053             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4054         16  CF-ST-FST-PMT-EXTENSION.
  4055             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4056             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4057                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4058                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4059                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4060                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4061         16  CF-ST-STATE-CALL.
  4062             20  CF-ST-CALL-UNEARNED        PIC X.
  4063             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4064             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4065         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4066             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4067             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4068         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4069         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4070         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4071         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4072         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4073         16  FILLER                         PIC X.
  4074         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4075             20  CF-ST-BENEFIT-CD           PIC XX.
  4076             20  CF-ST-BENEFIT-KIND         PIC X.
  4077                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4078                 88  CF-ST-AH-KIND              VALUE 'A'.
  4079             20  CF-ST-REM-TERM-CALC        PIC X.
  4080                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4081                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4082                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4083                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4084                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4085                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4086                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4087                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4088
  4089             20  CF-ST-REFUND-CALC          PIC X.
  4090                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4091                 88  ST-REFD-BY-R78             VALUE '1'.
  4092                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4093                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4094                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4095                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4096                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4097                 88  ST-REFD-UTAH               VALUE '7'.
  4098                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4099                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4100                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4101
  4102             20  CF-ST-EARNING-CALC         PIC X.
  4103                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4104                 88  ST-EARN-BY-R78             VALUE '1'.
  4105                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4106                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4107                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4108                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  78
* EL130.cbl
  4109                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4110                 88  ST-EARN-MEAN               VALUE '8'.
  4111                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4112
  4113             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4114                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4115                 88  ST-OVRD-BY-R78             VALUE '1'.
  4116                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4117                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4118                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4119                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4120                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4121                 88  ST-OVRD-MEAN               VALUE '8'.
  4122                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4123             20  FILLER                     PIC X.
  4124
  4125         16  CF-ST-COMMISSION-CAPS.
  4126             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4127             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4128             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4129             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4130         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4131                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4132
  4133         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4134
  4135         16  CF-ST-STATUTORY-INTEREST.
  4136             20  CF-ST-STAT-DATE-FROM       PIC X.
  4137                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4138                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4139             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4140             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4141             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4142             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4143             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4144
  4145         16  CF-ST-OVER-SHORT.
  4146             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4147             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4148
  4149         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4150
  4151         16  CF-ST-RT-CALC                  PIC X.
  4152
  4153         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4154         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4155         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4156         16  CF-ST-RF-LR-CALC               PIC X.
  4157         16  CF-ST-RF-LL-CALC               PIC X.
  4158         16  CF-ST-RF-LN-CALC               PIC X.
  4159         16  CF-ST-RF-AH-CALC               PIC X.
  4160         16  CF-ST-RF-CP-CALC               PIC X.
  4161*        16  FILLER                         PIC X(206).
  4162*CIDMOD         16  FILLER                         PIC X(192).
  4163         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4164             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4165         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4166         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  79
* EL130.cbl
  4167         16  CF-ST-CAUSAL-STATE             PIC X.
  4168         16  FILLER                         PIC X(185).
  4169
  4170****************************************************************
  4171*             BENEFIT MASTER RECORD                            *
  4172****************************************************************
  4173
  4174     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4175         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4176             20  CF-BENEFIT-CODE            PIC XX.
  4177             20  CF-BENEFIT-NUMERIC  REDEFINES
  4178                 CF-BENEFIT-CODE            PIC XX.
  4179             20  CF-BENEFIT-ALPHA           PIC XXX.
  4180             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4181             20  CF-BENEFIT-COMMENT         PIC X(10).
  4182
  4183             20  CF-LF-COVERAGE-TYPE        PIC X.
  4184                 88  CF-REDUCING                VALUE 'R'.
  4185                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4186
  4187             20  CF-SPECIAL-CALC-CD         PIC X.
  4188                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4189                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4190                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4191                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4192                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4193                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4194                 88  CF-FARM-PLAN               VALUE 'F'.
  4195                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4196                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4197                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4198                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4199                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4200                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4201                 88  CF-PRUDENTIAL              VALUE 'P'.
  4202                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4203                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4204                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4205                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4206                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4207                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4208
  4209             20  CF-JOINT-INDICATOR         PIC X.
  4210                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4211
  4212*            20  FILLER                     PIC X(12).
  4213             20  FILLER                     PIC X(11).
  4214             20  CF-BENEFIT-CATEGORY        PIC X.
  4215             20  CF-LOAN-TYPE               PIC X(8).
  4216
  4217             20  CF-CO-REM-TERM-CALC        PIC X.
  4218                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4219                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4220                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4221                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4222                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4223
  4224             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  80
* EL130.cbl
  4225                 88  CO-EARN-BY-R78             VALUE '1'.
  4226                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4227                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4228                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4229                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4230                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4231                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4232                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4233
  4234             20  CF-CO-REFUND-CALC          PIC X.
  4235                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4236                 88  CO-REFD-BY-R78             VALUE '1'.
  4237                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4238                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4239                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4240                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4241                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4242                 88  CO-REFD-MEAN               VALUE '8'.
  4243                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4244                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4245                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4246
  4247             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4248                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4249                 88  CO-OVRD-BY-R78             VALUE '1'.
  4250                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4251                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4252                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4253                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4254                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4255                 88  CO-OVRD-MEAN               VALUE '8'.
  4256                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4257
  4258             20  CF-CO-BEN-I-G-CD           PIC X.
  4259                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4260                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4261                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4262
  4263         16  FILLER                         PIC X(304).
  4264
  4265
  4266****************************************************************
  4267*             CARRIER MASTER RECORD                            *
  4268****************************************************************
  4269
  4270     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4271         16  CF-ADDRESS-DATA.
  4272             20  CF-MAIL-TO-NAME            PIC X(30).
  4273             20  CF-IN-CARE-OF              PIC X(30).
  4274             20  CF-ADDRESS-LINE-1          PIC X(30).
  4275             20  CF-ADDRESS-LINE-2          PIC X(30).
  4276             20  CF-CITY-STATE              PIC X(30).
  4277             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4278             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4279
  4280         16  CF-CLAIM-NO-CONTROL.
  4281             20  CF-CLAIM-NO-METHOD         PIC X.
  4282                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  81
* EL130.cbl
  4283                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4284                 88  CLAIM-NO-SEQ               VALUE '3'.
  4285                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4286             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4287                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4288                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4289                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4290
  4291         16  CF-CHECK-NO-CONTROL.
  4292             20  CF-CHECK-NO-METHOD         PIC X.
  4293                 88  CHECK-NO-MANUAL            VALUE '1'.
  4294                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4295                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4296                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4297             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4298                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4299
  4300         16  CF-DOMICILE-STATE              PIC XX.
  4301
  4302         16  CF-EXPENSE-CONTROLS.
  4303             20  CF-EXPENSE-METHOD          PIC X.
  4304                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4305                 88  DOLLARS-PER-PMT            VALUE '2'.
  4306                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4307                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4308             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4309             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4310
  4311         16  CF-CORRESPONDENCE-CONTROL.
  4312             20  CF-LETTER-RESEND-OPT       PIC X.
  4313                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4314                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4315             20  FILLER                     PIC X(4).
  4316
  4317         16  CF-RESERVE-CONTROLS.
  4318             20  CF-MANUAL-SW               PIC X.
  4319                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4320             20  CF-FUTURE-SW               PIC X.
  4321                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4322             20  CF-PTC-SW                  PIC X.
  4323                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4324             20  CF-IBNR-SW                 PIC X.
  4325                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4326             20  CF-PTC-LF-SW               PIC X.
  4327                 88  CF-LF-PTC-USED             VALUE '1'.
  4328             20  CF-CDT-ACCESS-METHOD       PIC X.
  4329                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4330                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4331                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4332             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4333
  4334         16  CF-CLAIM-CALC-METHOD           PIC X.
  4335             88  360-PLUS-MONTHS                VALUE '1'.
  4336             88  365-PLUS-MONTHS                VALUE '2'.
  4337             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4338             88  360-DAILY                      VALUE '4'.
  4339             88  365-DAILY                      VALUE '5'.
  4340
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  82
* EL130.cbl
  4341         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4342         16  FILLER                         PIC X(11).
  4343
  4344         16  CF-LIMIT-AMOUNTS.
  4345             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4346             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4347             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4348             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4349             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4350             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4351             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4352             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4353             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4354             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4355
  4356         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4357         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4358         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4359
  4360         16  CF-ZIP-CODE.
  4361             20  CF-ZIP-PRIME.
  4362                 24  CF-ZIP-1ST             PIC X.
  4363                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4364                 24  FILLER                 PIC X(4).
  4365             20  CF-ZIP-PLUS4               PIC X(4).
  4366         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4367             20  CF-CAN-POSTAL-1            PIC XXX.
  4368             20  CF-CAN-POSTAL-2            PIC XXX.
  4369             20  FILLER                     PIC XXX.
  4370
  4371         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4372         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4373         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4374
  4375         16  CF-RATING-SWITCH               PIC X.
  4376             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4377             88  CF-NO-RATING                   VALUE 'N'.
  4378
  4379         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4380
  4381         16  CF-CARRIER-OVER-SHORT.
  4382             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4383             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4384
  4385         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4386         16  CF-SECPAY-SWITCH               PIC X.
  4387             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4388             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4389         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4390         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4391         16  FILLER                         PIC X(444).
  4392*        16  FILLER                         PIC X(452).
  4393
  4394
  4395****************************************************************
  4396*             MORTALITY MASTER RECORD                          *
  4397****************************************************************
  4398
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  83
* EL130.cbl
  4399     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4400         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4401                                INDEXED BY CF-MORT-NDX.
  4402             20  CF-MORT-TABLE              PIC X(5).
  4403             20  CF-MORT-TABLE-TYPE         PIC X.
  4404                 88  CF-MORT-JOINT              VALUE 'J'.
  4405                 88  CF-MORT-SINGLE             VALUE 'S'.
  4406                 88  CF-MORT-COMBINED           VALUE 'C'.
  4407                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4408                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4409             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4410             20  CF-MORT-AGE-METHOD         PIC XX.
  4411                 88  CF-AGE-LAST                VALUE 'AL'.
  4412                 88  CF-AGE-NEAR                VALUE 'AN'.
  4413             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4414             20  CF-MORT-ADJUSTMENT-DIRECTION
  4415                                            PIC X.
  4416                 88  CF-MINUS                   VALUE '-'.
  4417                 88  CF-PLUS                    VALUE '+'.
  4418             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4419             20  CF-MORT-JOINT-CODE         PIC X.
  4420                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4421             20  CF-MORT-PC-Q               PIC X.
  4422                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4423             20  CF-MORT-TABLE-CODE         PIC X(4).
  4424             20  CF-MORT-COMMENTS           PIC X(15).
  4425             20  FILLER                     PIC X(14).
  4426
  4427         16  FILLER                         PIC X(251).
  4428
  4429
  4430****************************************************************
  4431*             BUSSINESS TYPE MASTER RECORD                     *
  4432****************************************************************
  4433
  4434     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4435* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4436* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4437* AND RECORD 05 IS TYPES 81-99
  4438         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4439             20  CF-BUSINESS-TITLE          PIC  X(19).
  4440             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4441                                            PIC S9V9(4) COMP-3.
  4442             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4443             20  FILLER                     PIC  X.
  4444         16  FILLER                         PIC  X(248).
  4445
  4446
  4447****************************************************************
  4448*             TERMINAL MASTER RECORD                           *
  4449****************************************************************
  4450
  4451     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4452
  4453         16  CF-COMPANY-TERMINALS.
  4454             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4455                                  PIC X(4).
  4456         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  84
* EL130.cbl
  4457
  4458
  4459****************************************************************
  4460*             LIFE EDIT MASTER RECORD                          *
  4461****************************************************************
  4462
  4463     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4464         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4465             20  CF-LIFE-CODE-IN            PIC XX.
  4466             20  CF-LIFE-CODE-OUT           PIC XX.
  4467         16  FILLER                         PIC X(248).
  4468
  4469
  4470****************************************************************
  4471*             AH EDIT MASTER RECORD                            *
  4472****************************************************************
  4473
  4474     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4475         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4476             20  CF-AH-CODE-IN              PIC XXX.
  4477             20  CF-AH-CODE-OUT             PIC XX.
  4478         16  FILLER                         PIC X(248).
  4479
  4480
  4481****************************************************************
  4482*             CREDIBILITY TABLES                               *
  4483****************************************************************
  4484
  4485     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4486         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4487                             INDEXED BY CF-CRDB-NDX.
  4488             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4489             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4490             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4491         16  FILLER                         PIC  X(332).
  4492
  4493
  4494****************************************************************
  4495*             REPORT CUSTOMIZATION RECORD                      *
  4496****************************************************************
  4497
  4498     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4499         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4500             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4501             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4502             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4503**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4504****       A T-TRANSFER.                                   ****
  4505             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4506
  4507         16  FILLER                         PIC XX.
  4508
  4509         16  CF-CARRIER-CNTL-OPT.
  4510             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4511                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4512                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4513             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4514                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  85
* EL130.cbl
  4515         16  CF-GROUP-CNTL-OPT.
  4516             20  CF-GROUP-OPT-SEQ           PIC 9.
  4517                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4518                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4519             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4520                                            PIC X(6).
  4521         16  CF-STATE-CNTL-OPT.
  4522             20  CF-STATE-OPT-SEQ           PIC 9.
  4523                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4524                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4525             20  CF-STATE-SELECT OCCURS 3 TIMES
  4526                                            PIC XX.
  4527         16  CF-ACCOUNT-CNTL-OPT.
  4528             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4529                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4530                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4531             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4532                                            PIC X(10).
  4533         16  CF-BUS-TYP-CNTL-OPT.
  4534             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4535                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4536                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4537             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4538                                            PIC XX.
  4539         16  CF-LF-TYP-CNTL-OPT.
  4540             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4541                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4542                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4543             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4544                                            PIC XX.
  4545         16  CF-AH-TYP-CNTL-OPT.
  4546             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4547                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4548                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4549             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4550                                            PIC XX.
  4551         16  CF-REPTCD1-CNTL-OPT.
  4552             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4553                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4554                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4555             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4556                                            PIC X(10).
  4557         16  CF-REPTCD2-CNTL-OPT.
  4558             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4559                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4560                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4561             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4562                                            PIC X(10).
  4563         16  CF-USER1-CNTL-OPT.
  4564             20  CF-USER1-OPT-SEQ           PIC 9.
  4565                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4566                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4567             20  CF-USER1-SELECT OCCURS 3 TIMES
  4568                                            PIC X(10).
  4569         16  CF-USER2-CNTL-OPT.
  4570             20  CF-USER2-OPT-SEQ           PIC 9.
  4571                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4572                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  86
* EL130.cbl
  4573             20  CF-USER2-SELECT OCCURS 3 TIMES
  4574                                            PIC X(10).
  4575         16  CF-USER3-CNTL-OPT.
  4576             20  CF-USER3-OPT-SEQ           PIC 9.
  4577                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4578                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4579             20  CF-USER3-SELECT OCCURS 3 TIMES
  4580                                            PIC X(10).
  4581         16  CF-USER4-CNTL-OPT.
  4582             20  CF-USER4-OPT-SEQ           PIC 9.
  4583                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4584                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4585             20  CF-USER4-SELECT OCCURS 3 TIMES
  4586                                            PIC X(10).
  4587         16  CF-USER5-CNTL-OPT.
  4588             20  CF-USER5-OPT-SEQ           PIC 9.
  4589                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4590                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4591             20  CF-USER5-SELECT OCCURS 3 TIMES
  4592                                            PIC X(10).
  4593         16  CF-REINS-CNTL-OPT.
  4594             20  CF-REINS-OPT-SEQ           PIC 9.
  4595                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4596                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4597             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4598                 24  CF-REINS-PRIME         PIC XXX.
  4599                 24  CF-REINS-SUB           PIC XXX.
  4600
  4601         16  CF-AGENT-CNTL-OPT.
  4602             20  CF-AGENT-OPT-SEQ           PIC 9.
  4603                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4604                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4605             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4606                                            PIC X(10).
  4607
  4608         16  FILLER                         PIC X(43).
  4609
  4610         16  CF-LOSS-RATIO-SELECT.
  4611             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4612             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4613         16  CF-ENTRY-DATE-SELECT.
  4614             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4615             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4616         16  CF-EFFECTIVE-DATE-SELECT.
  4617             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4618             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4619
  4620         16  CF-EXCEPTION-LIST-IND          PIC X.
  4621             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4622
  4623         16  FILLER                         PIC X(318).
  4624
  4625****************************************************************
  4626*                  EXCEPTION REPORTING RECORD                  *
  4627****************************************************************
  4628
  4629     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4630         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  87
* EL130.cbl
  4631             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4632
  4633         16  CF-COMBINED-LIFE-AH-OPT.
  4634             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4635             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4636             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4637             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4638
  4639         16  CF-LIFE-OPT.
  4640             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4641             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4642             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4643             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4644             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4645             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4646             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4647             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4648             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4649             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4650
  4651         16  CF-AH-OPT.
  4652             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4653             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4654             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4655             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4656             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4657             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4658             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4659             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4660             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4661             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4662
  4663         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4664             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4665             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4666             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4667
  4668         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4669
  4670         16  FILLER                         PIC X(673).
  4671
  4672
  4673****************************************************************
  4674*             MORTGAGE SYSTEM PLAN RECORD                      *
  4675****************************************************************
  4676
  4677     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4678         16  CF-PLAN-TYPE                   PIC X.
  4679             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4680             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4681             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4682         16  CF-PLAN-ABBREV                 PIC XXX.
  4683         16  CF-PLAN-DESCRIPT               PIC X(10).
  4684         16  CF-PLAN-NOTES                  PIC X(20).
  4685         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4686         16  CF-PLAN-UNDERWRITING.
  4687             20  CF-PLAN-TERM-DATA.
  4688                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  88
* EL130.cbl
  4689                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4690             20  CF-PLAN-AGE-DATA.
  4691                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4692                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4693                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4694             20  CF-PLAN-BENEFIT-DATA.
  4695                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4696                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4697                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4698                                            PIC S9(7)V99  COMP-3.
  4699         16  CF-PLAN-POLICY-FORMS.
  4700             20  CF-POLICY-FORM             PIC X(12).
  4701             20  CF-MASTER-APPLICATION      PIC X(12).
  4702             20  CF-MASTER-POLICY           PIC X(12).
  4703         16  CF-PLAN-RATING.
  4704             20  CF-RATE-CODE               PIC X(5).
  4705             20  CF-SEX-RATING              PIC X.
  4706                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4707                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4708             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4709             20  CF-SUB-STD-TYPE            PIC X.
  4710                 88  CF-PCT-OF-PREM            VALUE '1'.
  4711                 88  CF-PCT-OF-BENE            VALUE '2'.
  4712         16  CF-PLAN-PREM-TOLERANCES.
  4713             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4714             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4715         16  CF-PLAN-PYMT-TOLERANCES.
  4716             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4717             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4718         16  CF-PLAN-MISC-DATA.
  4719             20  FILLER                     PIC X.
  4720             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4721             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4722         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4723         16  CF-PLAN-IND-GRP                PIC X.
  4724             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4725                                                     '1'.
  4726             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4727                                                     '2'.
  4728         16  CF-MIB-SEARCH-SW               PIC X.
  4729             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4730             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4731             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4732             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4733         16  CF-ALPHA-SEARCH-SW             PIC X.
  4734             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4735             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4736             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4737             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4738             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4739             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4740             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4741             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4742             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4743             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4744                                                     'A' 'B' 'C'
  4745                                                     'X' 'Y' 'Z'.
  4746         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  89
* EL130.cbl
  4747             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4748             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4749             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4750             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4751             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4752         16  FILLER                         PIC X(4).
  4753         16  CF-HEALTH-QUESTIONS            PIC X.
  4754             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4755         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4756         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4757         16  CF-PLAN-SNGL-JNT               PIC X.
  4758             88  CF-COMBINED-PLAN              VALUE 'C'.
  4759             88  CF-JNT-PLAN                   VALUE 'J'.
  4760             88  CF-SNGL-PLAN                  VALUE 'S'.
  4761         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4762         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4763         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4764         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4765         16  CF-RERATE-CNTL                 PIC  X.
  4766             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4767             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4768             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4769             88  CF-AUTO-RECALC                 VALUE '4'.
  4770         16  CF-BENEFIT-TYPE                PIC  X.
  4771             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4772             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4773         16  CF-POLICY-FEE                  PIC S999V99
  4774                                                    COMP-3.
  4775         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4776         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4777         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4778         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4779         16  FILLER                         PIC  X(32).
  4780         16  CF-TERMINATION-FORM            PIC  X(04).
  4781         16  FILLER                         PIC  X(08).
  4782         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4783                                                       COMP-3.
  4784         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4785         16  CF-ISSUE-LETTER                PIC  X(4).
  4786         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4787         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4788             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4789             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4790         16  CF-MP-REFUND-CALC              PIC X.
  4791             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4792             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4793             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4794             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4795             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4796             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4797             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4798             88  CF-MP-REFD-MEAN                VALUE '8'.
  4799         16  CF-ALT-RATE-CODE               PIC  X(5).
  4800
  4801
  4802         16  FILLER                         PIC X(498).
  4803****************************************************************
  4804*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  90
* EL130.cbl
  4805****************************************************************
  4806
  4807     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4808         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4809         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4810             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4811             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4812             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4813             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4814             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4815
  4816         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4817         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4818         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4819         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4820         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4821
  4822         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4823             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4824         16  CF-MP-RECON-USE-IND            PIC X(1).
  4825             88  CF-MP-USE-RECON             VALUE 'Y'.
  4826         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4827             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4828         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4829             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4830             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4831         16  FILLER                         PIC X(1).
  4832         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4833             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4834         16  CF-MORTG-MIB-VERSION           PIC X.
  4835             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4836             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4837             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4838         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4839             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4840                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4841             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4842                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4843             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4844                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4845             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4846                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4847             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4848                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4849             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4850                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4851         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4852         16  FILLER                         PIC X(7).
  4853         16  CF-MORTG-DESTINATION-SYMBOL.
  4854             20  CF-MORTG-MIB-COMM          PIC X(5).
  4855             20  CF-MORTG-MIB-TERM          PIC X(5).
  4856         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4857             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4858         16  FILLER                         PIC X(03).
  4859         16  CF-MP-CHECK-NO-CONTROL.
  4860             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4861                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4862                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  91
* EL130.cbl
  4863                                                ' ' LOW-VALUES.
  4864                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4865                                               VALUE '3'.
  4866         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4867         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4868         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4869             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4870                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4871             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4872                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4873             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4874                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4875             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4876                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4877             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4878                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4879             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4880                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4881         16  CF-MORTG-BILLING-AREA.
  4882             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4883                                            PIC X.
  4884         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4885         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4886         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4887         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4888             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4889             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4890         16  FILLER                         PIC X.
  4891         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4892             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4893             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4894         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4895         16  FILLER                         PIC X(8).
  4896         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4897         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4898         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4899         16  CF-ACH-COMPANY-ID.
  4900             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4901                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4902                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4903                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4904             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4905         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4906             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4907         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4908             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4909             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4910         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4911         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4912         16  FILLER                         PIC X(536).
  4913
  4914****************************************************************
  4915*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4916****************************************************************
  4917
  4918     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4919         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4920             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  92
* EL130.cbl
  4921                 24  CF-FEMALE-FT           PIC 99.
  4922                 24  CF-FEMALE-IN           PIC 99.
  4923             20  CF-FEMALE-MIN-WT           PIC 999.
  4924             20  CF-FEMALE-MAX-WT           PIC 999.
  4925         16  FILLER                         PIC X(428).
  4926
  4927     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4928         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4929             20  CF-MALE-HEIGHT.
  4930                 24  CF-MALE-FT             PIC 99.
  4931                 24  CF-MALE-IN             PIC 99.
  4932             20  CF-MALE-MIN-WT             PIC 999.
  4933             20  CF-MALE-MAX-WT             PIC 999.
  4934         16  FILLER                         PIC X(428).
  4935******************************************************************
  4936*             AUTOMATIC ACTIVITY RECORD                          *
  4937******************************************************************
  4938     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4939         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4940             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4941             20  CF-SYS-LETTER-ID           PIC X(04).
  4942             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4943             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4944             20  CF-SYS-RESET-SW            PIC X(01).
  4945             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4946             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4947
  4948         16  FILLER                         PIC X(50).
  4949
  4950         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4951             20  CF-USER-ACTIVE-SW          PIC X(01).
  4952             20  CF-USER-LETTER-ID          PIC X(04).
  4953             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4954             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4955             20  CF-USER-RESET-SW           PIC X(01).
  4956             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4957             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4958             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4959
  4960         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  93
* EL130.cbl
  4962*    COPY ELCCERT.
  4963******************************************************************
  4964*                                                                *
  4965*                            ELCCERT.                            *
  4966*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4967*                            VMOD=2.013                          *
  4968*                                                                *
  4969*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4970*                                                                *
  4971*   FILE TYPE = VSAM,KSDS                                        *
  4972*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4973*                                                                *
  4974*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4975*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4976*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4977*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4978*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4979*                                                                *
  4980*   LOG = YES                                                    *
  4981*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4982******************************************************************
  4983*                   C H A N G E   L O G
  4984*
  4985* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4986*-----------------------------------------------------------------
  4987*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4988* EFFECTIVE    NUMBER
  4989*-----------------------------------------------------------------
  4990* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4991* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4992* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4993* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4994* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4995* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4996* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4997* 032612  CR2011110200001  PEMA  AHL CHANGES
  4998******************************************************************
  4999
  5000 01  CERTIFICATE-MASTER.
  5001     12  CM-RECORD-ID                      PIC XX.
  5002         88  VALID-CM-ID                      VALUE 'CM'.
  5003
  5004     12  CM-CONTROL-PRIMARY.
  5005         16  CM-COMPANY-CD                 PIC X.
  5006         16  CM-CARRIER                    PIC X.
  5007         16  CM-GROUPING.
  5008             20  CM-GROUPING-PREFIX        PIC X(3).
  5009             20  CM-GROUPING-PRIME         PIC X(3).
  5010         16  CM-STATE                      PIC XX.
  5011         16  CM-ACCOUNT.
  5012             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5013             20  CM-ACCOUNT-PRIME          PIC X(6).
  5014         16  CM-CERT-EFF-DT                PIC XX.
  5015         16  CM-CERT-NO.
  5016             20  CM-CERT-PRIME             PIC X(10).
  5017             20  CM-CERT-SFX               PIC X.
  5018
  5019     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  94
* EL130.cbl
  5020         16  CM-COMPANY-CD-A1              PIC X.
  5021         16  CM-INSURED-LAST-NAME          PIC X(15).
  5022         16  CM-INSURED-INITIALS.
  5023             20  CM-INSURED-INITIAL1       PIC X.
  5024             20  CM-INSURED-INITIAL2       PIC X.
  5025
  5026     12  CM-CONTROL-BY-SSN.
  5027         16  CM-COMPANY-CD-A2              PIC X.
  5028         16  CM-SOC-SEC-NO.
  5029             20  CM-SSN-STATE              PIC XX.
  5030             20  CM-SSN-ACCOUNT            PIC X(6).
  5031             20  CM-SSN-LN3.
  5032                 25  CM-INSURED-INITIALS-A2.
  5033                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5034                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5035                 25 CM-PART-LAST-NAME-A2         PIC X.
  5036
  5037     12  CM-CONTROL-BY-CERT-NO.
  5038         16  CM-COMPANY-CD-A4              PIC X.
  5039         16  CM-CERT-NO-A4                 PIC X(11).
  5040
  5041     12  CM-CONTROL-BY-MEMB.
  5042         16  CM-COMPANY-CD-A5              PIC X.
  5043         16  CM-MEMBER-NO.
  5044             20  CM-MEMB-STATE             PIC XX.
  5045             20  CM-MEMB-ACCOUNT           PIC X(6).
  5046             20  CM-MEMB-LN4.
  5047                 25  CM-INSURED-INITIALS-A5.
  5048                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5049                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5050                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5051
  5052     12  CM-INSURED-PROFILE-DATA.
  5053         16  CM-INSURED-FIRST-NAME.
  5054             20  CM-INSURED-1ST-INIT       PIC X.
  5055             20  FILLER                    PIC X(9).
  5056         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5057         16  CM-INSURED-SEX                PIC X.
  5058             88  CM-SEX-MALE                  VALUE 'M'.
  5059             88  CM-SEX-FEMAL                 VALUE 'F'.
  5060         16  CM-INSURED-JOINT-AGE          PIC 99.
  5061         16  CM-JOINT-INSURED-NAME.
  5062             20  CM-JT-LAST-NAME           PIC X(15).
  5063             20  CM-JT-FIRST-NAME.
  5064                 24  CM-JT-1ST-INIT        PIC X.
  5065                 24  FILLER                PIC X(9).
  5066             20  CM-JT-INITIAL             PIC X.
  5067
  5068     12  CM-LIFE-DATA.
  5069         16  CM-LF-BENEFIT-CD              PIC XX.
  5070         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5071         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5072         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5073         16  CM-LF-DEV-CODE                PIC XXX.
  5074         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5075         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5076         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5077         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  95
* EL130.cbl
  5078         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5079         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5080         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5081         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5082         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5083         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5084         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5085         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5086         16  FILLER                        PIC XX.
  5087
  5088     12  CM-AH-DATA.
  5089         16  CM-AH-BENEFIT-CD              PIC XX.
  5090         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5091         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5092         16  CM-AH-DEV-CODE                PIC XXX.
  5093         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5094         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5095         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5096         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5097         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5098         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5099         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5100         16  CM-AH-PAID-THRU-DT            PIC XX.
  5101             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5102         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5103         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5104         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5105         16  FILLER                        PIC X.
  5106
  5107     12  CM-LOAN-INFORMATION.
  5108         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5109         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5110                                           PIC S9(5)V99  COMP-3.
  5111         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5112         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5113         16  CM-PAY-FREQUENCY              PIC S99.
  5114         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5115         16  CM-RATE-CLASS                 PIC XX.
  5116         16  CM-BENEFICIARY                PIC X(25).
  5117         16  CM-POLICY-FORM-NO             PIC X(12).
  5118         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5119         16  CM-LAST-ADD-ON-DT             PIC XX.
  5120         16  CM-DEDUCTIBLE-AMOUNTS.
  5121             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5122             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5123         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5124             20  CM-RESIDENT-STATE         PIC XX.
  5125             20  CM-RATE-CODE              PIC X(4).
  5126             20  FILLER                    PIC XX.
  5127         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5128             20  CM-LOAN-OFFICER           PIC X(5).
  5129             20  FILLER                    PIC XXX.
  5130         16  CM-CSR-CODE                   PIC XXX.
  5131         16  CM-UNDERWRITING-CODE          PIC X.
  5132             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5133         16  CM-POST-CARD-IND              PIC X.
  5134         16  CM-NH-INTERFACE-SW            PIC X.
  5135         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  96
* EL130.cbl
  5136             88  CM-SING-PRM                  VALUE '1'.
  5137             88  CM-O-B-COVERAGE              VALUE '2'.
  5138             88  CM-OPEN-END                  VALUE '3'.
  5139         16  CM-IND-GRP-TYPE               PIC X.
  5140             88  CM-INDIVIDUAL                VALUE 'I'.
  5141             88  CM-GROUP                     VALUE 'G'.
  5142         16  CM-SKIP-CODE                  PIC X.
  5143             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5144             88  SKIP-JULY                    VALUE '1'.
  5145             88  SKIP-AUGUST                  VALUE '2'.
  5146             88  SKIP-SEPTEMBER               VALUE '3'.
  5147             88  SKIP-JULY-AUG                VALUE '4'.
  5148             88  SKIP-AUG-SEPT                VALUE '5'.
  5149             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5150             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5151             88  SKIP-JUNE                    VALUE '8'.
  5152             88  SKIP-JUNE-JULY               VALUE '9'.
  5153             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5154             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5155         16  CM-PAYMENT-MODE               PIC X.
  5156             88  PAY-MONTHLY                  VALUE SPACE.
  5157             88  PAY-WEEKLY                   VALUE '1'.
  5158             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5159             88  PAY-BI-WEEKLY                VALUE '3'.
  5160             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5161         16  CM-LOAN-NUMBER                PIC X(8).
  5162         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5163         16  CM-OLD-LOF                    PIC XXX.
  5164*        16  CM-LOAN-OFFICER               PIC XXX.
  5165         16  CM-REIN-TABLE                 PIC XXX.
  5166         16  CM-SPECIAL-REIN-CODE          PIC X.
  5167         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5168         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5169         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5170
  5171     12  CM-STATUS-DATA.
  5172         16  CM-ENTRY-STATUS               PIC X.
  5173         16  CM-ENTRY-DT                   PIC XX.
  5174
  5175         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5176         16  CM-LF-CANCEL-DT               PIC XX.
  5177         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5178
  5179         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5180         16  CM-LF-DEATH-DT                PIC XX.
  5181         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5182
  5183         16  CM-LF-CURRENT-STATUS          PIC X.
  5184             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5185                                                'M' '4' '5' '9'.
  5186             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5187             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5188             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5189             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5190             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5191             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5192             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5193             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  97
* EL130.cbl
  5194             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5195             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5196             88  CM-LF-DECLINED               VALUE 'D'.
  5197             88  CM-LF-VOIDED                 VALUE 'V'.
  5198
  5199         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5200         16  CM-AH-CANCEL-DT               PIC XX.
  5201         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5202
  5203         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5204         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5205         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5206
  5207         16  CM-AH-CURRENT-STATUS          PIC X.
  5208             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5209                                                'M' '4' '5' '9'.
  5210             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5211             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5212             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5213             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5214             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5215             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5216             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5217             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5218             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5219             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5220             88  CM-AH-DECLINED               VALUE 'D'.
  5221             88  CM-AH-VOIDED                 VALUE 'V'.
  5222
  5223         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5224             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5225             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5226             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5227         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5228
  5229         16  CM-ENTRY-BATCH                PIC X(6).
  5230         16  CM-LF-EXIT-BATCH              PIC X(6).
  5231         16  CM-AH-EXIT-BATCH              PIC X(6).
  5232         16  CM-LAST-MONTH-END             PIC XX.
  5233
  5234     12  CM-NOTE-SW                        PIC X.
  5235         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5236         88  CERT-NOTES-PRESENT               VALUE '1'.
  5237         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5238         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5239         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5240         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5241         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5242         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5243     12  CM-COMP-EXCP-SW                   PIC X.
  5244         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5245         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5246     12  CM-INSURED-ADDRESS-SW             PIC X.
  5247         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5248         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5249
  5250*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5251     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  98
* EL130.cbl
  5252     12  FILLER                            PIC X.
  5253
  5254*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5255     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5256     12  FILLER                            PIC X.
  5257*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5258     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5259
  5260     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5261         88  CERT-ADDED-BATCH                 VALUE ' '.
  5262         88  CERT-ADDED-ONLINE                VALUE '1'.
  5263         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5264         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5265         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5266     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5267         88  CERT-AS-LOADED                   VALUE ' '.
  5268         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5269         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5270         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5271         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5272         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5273         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5274         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5275
  5276     12  CM-ACCOUNT-COMM-PCTS.
  5277         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5278         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5279
  5280     12  CM-USER-FIELD                     PIC X.
  5281     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5282     12  CM-CLP-STATE                      PIC XX.
  5283     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5284     12  CM-USER-RESERVED                  PIC XXX.
  5285     12  FILLER REDEFINES CM-USER-RESERVED.
  5286         16  CM-AH-CLASS-CD                PIC XX.
  5287         16  F                             PIC X.
  5288******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page  99
* EL130.cbl
  5290*    COPY ERCACCT.
  5291******************************************************************
  5292*                                                                *
  5293*                                                                *
  5294*                            ERCACCT                             *
  5295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5296*                            VMOD=2.031                          *
  5297*                                                                *
  5298*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5299*                                                                *
  5300*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5301*   VSAM ACCOUNT MASTER FILES.                                   *
  5302*                                                                *
  5303*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5304*                                                                *
  5305*   FILE TYPE = VSAM,KSDS                                        *
  5306*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5307*                                                                *
  5308*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5309*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5310*                                                                *
  5311*   LOG = NO                                                     *
  5312*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5313*                                                                *
  5314*                                                                *
  5315******************************************************************
  5316*                   C H A N G E   L O G
  5317*
  5318* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5319*-----------------------------------------------------------------
  5320*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5321* EFFECTIVE    NUMBER
  5322*-----------------------------------------------------------------
  5323* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5324* 092705    2005050300006  PEMA  ADD SPP LEASES
  5325* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5326* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5327* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5328* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5329* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5330******************************************************************
  5331
  5332 01  ACCOUNT-MASTER.
  5333     12  AM-RECORD-ID                      PIC XX.
  5334         88  VALID-AM-ID                      VALUE 'AM'.
  5335
  5336     12  AM-CONTROL-PRIMARY.
  5337         16  AM-COMPANY-CD                 PIC X.
  5338         16  AM-MSTR-CNTRL.
  5339             20  AM-CONTROL-A.
  5340                 24  AM-CARRIER            PIC X.
  5341                 24  AM-GROUPING.
  5342                     28 AM-GROUPING-PREFIX PIC XXX.
  5343                     28 AM-GROUPING-PRIME  PIC XXX.
  5344                 24  AM-STATE              PIC XX.
  5345                 24  AM-ACCOUNT.
  5346                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5347                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 100
* EL130.cbl
  5348             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5349                                           PIC X(19).
  5350             20  AM-CNTRL-B.
  5351                 24  AM-EXPIRATION-DT      PIC XX.
  5352                 24  FILLER                PIC X(4).
  5353             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5354                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5355
  5356     12  AM-CONTROL-BY-VAR-GRP.
  5357         16  AM-COMPANY-CD-A1              PIC X.
  5358         16  AM-VG-CARRIER                 PIC X.
  5359         16  AM-VG-GROUPING                PIC X(6).
  5360         16  AM-VG-STATE                   PIC XX.
  5361         16  AM-VG-ACCOUNT                 PIC X(10).
  5362         16  AM-VG-DATE.
  5363             20  AM-VG-EXPIRATION-DT       PIC XX.
  5364             20  FILLER                    PIC X(4).
  5365         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5366                                           PIC 9(11)      COMP-3.
  5367     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5368         16  FILLER                        PIC X(10).
  5369         16  AM-VG-KEY3.
  5370             20  AM-VG3-ACCOUNT            PIC X(10).
  5371             20  AM-VG3-EXP-DT             PIC XX.
  5372         16  FILLER                        PIC X(4).
  5373     12  AM-MAINT-INFORMATION.
  5374         16  AM-LAST-MAINT-DT              PIC XX.
  5375         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5376         16  AM-LAST-MAINT-USER            PIC X(4).
  5377         16  FILLER                        PIC XX.
  5378
  5379     12  AM-EFFECTIVE-DT                   PIC XX.
  5380     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5381
  5382     12  AM-PREV-DATES  COMP-3.
  5383         16  AM-PREV-EXP-DT                PIC 9(11).
  5384         16  AM-PREV-EFF-DT                PIC 9(11).
  5385
  5386     12  AM-REPORT-CODE-1                  PIC X(10).
  5387     12  AM-REPORT-CODE-2                  PIC X(10).
  5388
  5389     12  AM-CITY-CODE                      PIC X(4).
  5390     12  AM-COUNTY-PARISH                  PIC X(6).
  5391
  5392     12  AM-NAME                           PIC X(30).
  5393     12  AM-PERSON                         PIC X(30).
  5394     12  AM-ADDRS                          PIC X(30).
  5395     12  AM-CITY.
  5396         16  AM-ADDR-CITY                  PIC X(28).
  5397         16  AM-ADDR-STATE                 PIC XX.
  5398     12  AM-ZIP.
  5399         16  AM-ZIP-PRIME.
  5400             20  AM-ZIP-PRI-1ST            PIC X.
  5401                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5402             20  FILLER                    PIC X(4).
  5403         16  AM-ZIP-PLUS4                  PIC X(4).
  5404     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5405         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 101
* EL130.cbl
  5406         16  AM-CAN-POSTAL-2               PIC XXX.
  5407         16  FILLER                        PIC XXX.
  5408     12  AM-TEL-NO.
  5409         16  AM-AREA-CODE                  PIC 999.
  5410         16  AM-TEL-PRE                    PIC 999.
  5411         16  AM-TEL-NBR                    PIC 9(4).
  5412     12  AM-TEL-LOC                        PIC X.
  5413         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5414         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5415
  5416     12  AM-COMM-STRUCTURE.
  5417         16  AM-DEFN-1.
  5418             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5419                 24  AM-AGT.
  5420                     28  AM-AGT-PREFIX     PIC X(4).
  5421                     28  AM-AGT-PRIME      PIC X(6).
  5422                 24  AM-COM-TYP            PIC X.
  5423                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5424                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5425                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5426                 24  AM-RECALC-LV-INDIC    PIC X.
  5427                 24  AM-RETRO-LV-INDIC     PIC X.
  5428                 24  AM-GL-CODES           PIC X.
  5429                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5430                 24  FILLER                PIC X(01).
  5431         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5432             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5433                 24  FILLER                PIC X(11).
  5434                 24  AM-L-COMA             PIC XXX.
  5435                 24  AM-J-COMA             PIC XXX.
  5436                 24  AM-A-COMA             PIC XXX.
  5437                 24  FILLER                PIC X(6).
  5438
  5439     12  AM-COMM-CHANGE-STATUS             PIC X.
  5440         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5441
  5442     12  AM-CSR-CODE                       PIC X(4).
  5443
  5444     12  AM-BILLING-STATUS                 PIC X.
  5445         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5446         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5447     12  AM-AUTO-REFUND-SW                 PIC X.
  5448         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5449         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5450     12  AM-GPCD                           PIC 99.
  5451     12  AM-IG                             PIC X.
  5452         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5453         88  AM-HAS-GROUP                     VALUE '2'.
  5454     12  AM-STATUS                         PIC X.
  5455         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5456         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5457         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5458         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5459         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5460         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5461     12  AM-REMIT-TO                       PIC 99.
  5462     12  AM-ID-NO                          PIC X(11).
  5463
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 102
* EL130.cbl
  5464     12  AM-CAL-TABLE                      PIC XX.
  5465     12  AM-LF-DEVIATION                   PIC XXX.
  5466     12  AM-AH-DEVIATION                   PIC XXX.
  5467     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5468     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5469     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5470     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5471     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5472     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5473
  5474     12  AM-USER-FIELDS.
  5475         16  AM-FLD-1                      PIC XX.
  5476         16  AM-FLD-2                      PIC XX.
  5477         16  AM-FLD-3                      PIC XX.
  5478         16  AM-FLD-4                      PIC XX.
  5479         16  AM-FLD-5                      PIC XX.
  5480
  5481     12  AM-1ST-PROD-DATE.
  5482         16  AM-1ST-PROD-YR                PIC XX.
  5483         16  AM-1ST-PROD-MO                PIC XX.
  5484         16  AM-1ST-PROD-DA                PIC XX.
  5485     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5486     12  AM-CERTS-PURGED-DATE.
  5487         16  AM-PUR-YR                     PIC XX.
  5488         16  AM-PUR-MO                     PIC XX.
  5489         16  AM-PUR-DA                     PIC XX.
  5490     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5491     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5492     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5493     12  AM-INACTIVE-DATE.
  5494         16  AM-INA-MO                     PIC 99.
  5495         16  AM-INA-DA                     PIC 99.
  5496         16  AM-INA-YR                     PIC 99.
  5497     12  AM-AR-HI-CERT-DATE                PIC XX.
  5498
  5499     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5500     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5501
  5502     12  AM-OB-PAYMENT-MODE                PIC X.
  5503         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5504         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5505         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5506         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5507
  5508     12  AM-AH-ONLY-INDICATOR              PIC X.
  5509         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5510         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5511
  5512     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5513
  5514     12  AM-OVER-SHORT.
  5515         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5516         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5517
  5518     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5519     12  AM-DCC-CLP-STATE                  PIC XX.
  5520
  5521     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 103
* EL130.cbl
  5522     12  AM-RECALC-REIN                    PIC X.
  5523
  5524     12  AM-REI-TABLE                      PIC XXX.
  5525     12  AM-REI-ET-LF                      PIC X.
  5526     12  AM-REI-ET-AH                      PIC X.
  5527     12  AM-REI-PE-LF                      PIC X.
  5528     12  AM-REI-PE-AH                      PIC X.
  5529     12  AM-REI-PRT-ST                     PIC X.
  5530     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5531     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5532     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5533     12  AM-REI-GROUP-A                    PIC X(6).
  5534     12  AM-REI-MORT                       PIC X(4).
  5535     12  AM-REI-PRT-OW                     PIC X.
  5536     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5537     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5538     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5539     12  AM-REI-GROUP-B                    PIC X(6).
  5540
  5541     12  AM-TRUST-TYPE                     PIC X(2).
  5542
  5543     12  AM-EMPLOYER-STMT-USED             PIC X.
  5544     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5545
  5546     12  AM-STD-AH-TYPE                    PIC XX.
  5547     12  AM-EARN-METHODS.
  5548         16  AM-EARN-METHOD-R              PIC X.
  5549             88 AM-REF-RL-R78                 VALUE 'R'.
  5550             88 AM-REF-RL-PR                  VALUE 'P'.
  5551             88 AM-REF-RL-MEAN                VALUE 'M'.
  5552             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5553         16  AM-EARN-METHOD-L              PIC X.
  5554             88 AM-REF-LL-R78                 VALUE 'R'.
  5555             88 AM-REF-LL-PR                  VALUE 'P'.
  5556             88 AM-REF-LL-MEAN                VALUE 'M'.
  5557             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5558         16  AM-EARN-METHOD-A              PIC X.
  5559             88 AM-REF-AH-R78                 VALUE 'R'.
  5560             88 AM-REF-AH-PR                  VALUE 'P'.
  5561             88 AM-REF-AH-MEAN                VALUE 'M'.
  5562             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5563             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5564             88 AM-REF-AH-NET                 VALUE 'N'.
  5565
  5566     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5567     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5568     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5569
  5570     12  AM-RET-Y-N                        PIC X.
  5571     12  AM-RET-P-E                        PIC X.
  5572     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5573     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5574     12  AM-RET-GRP                        PIC X(6).
  5575     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5576         16  AM-POOL-PRIME                 PIC XXX.
  5577         16  AM-POOL-SUB                   PIC XXX.
  5578     12  AM-RETRO-EARNINGS.
  5579         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 104
* EL130.cbl
  5580         16  AM-RET-EARN-L                 PIC X.
  5581         16  AM-RET-EARN-A                 PIC X.
  5582     12  AM-RET-ST-TAX-USE                 PIC X.
  5583         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5584         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5585     12  AM-RETRO-BEG-EARNINGS.
  5586         16  AM-RET-BEG-EARN-R             PIC X.
  5587         16  AM-RET-BEG-EARN-L             PIC X.
  5588         16  AM-RET-BEG-EARN-A             PIC X.
  5589     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5590     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5591
  5592     12  AM-USER-SELECT-OPTIONS.
  5593         16  AM-USER-SELECT-1              PIC X(10).
  5594         16  AM-USER-SELECT-2              PIC X(10).
  5595         16  AM-USER-SELECT-3              PIC X(10).
  5596         16  AM-USER-SELECT-4              PIC X(10).
  5597         16  AM-USER-SELECT-5              PIC X(10).
  5598
  5599     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5600
  5601     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5602
  5603     12  AM-RPT045A-SWITCH                 PIC X.
  5604         88  RPT045A-OFF                   VALUE 'N'.
  5605
  5606     12  AM-INSURANCE-LIMITS.
  5607         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5608         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5609
  5610     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5611         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5612
  5613     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5614         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5615         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5616
  5617     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5618
  5619     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5620     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5621     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5622     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5623     12  AM-DCC-UEF-STATE                  PIC XX.
  5624     12  FILLER                            PIC XXX.
  5625     12  AM-REPORT-CODE-3                  PIC X(10).
  5626*    12  FILLER                            PIC X(22).
  5627
  5628     12  AM-RESERVE-DATE.
  5629         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5630         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5631         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5632
  5633     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5634     12  AM-NOTIFICATION-TYPES.
  5635         16  AM-NOTIF-OF-LETTERS           PIC X.
  5636         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5637         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 105
* EL130.cbl
  5638         16  AM-NOTIF-OF-STATUS            PIC X.
  5639
  5640     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5641         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5642         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5643         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5644         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5645
  5646     12  AM-BENEFIT-CONTROLS.
  5647         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5648             20  AM-BENEFIT-CODE           PIC XX.
  5649             20  AM-BENEFIT-TYPE           PIC X.
  5650             20  AM-BENEFIT-REVISION       PIC XXX.
  5651             20  AM-BENEFIT-REM-TERM       PIC X.
  5652             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5653             20  FILLER                    PIC XX.
  5654         16  FILLER                        PIC X(80).
  5655
  5656     12  AM-TRANSFER-DATA.
  5657         16  AM-TRANSFERRED-FROM.
  5658             20  AM-TRNFROM-CARRIER        PIC X.
  5659             20  AM-TRNFROM-GROUPING.
  5660                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5661                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5662             20  AM-TRNFROM-STATE          PIC XX.
  5663             20  AM-TRNFROM-ACCOUNT.
  5664                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5665                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5666             20  AM-TRNFROM-DTE            PIC XX.
  5667         16  AM-TRANSFERRED-TO.
  5668             20  AM-TRNTO-CARRIER          PIC X.
  5669             20  AM-TRNTO-GROUPING.
  5670                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5671                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5672             20  AM-TRNTO-STATE            PIC XX.
  5673             20  AM-TRNTO-ACCOUNT.
  5674                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5675                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5676             20  AM-TRNTO-DTE              PIC XX.
  5677         16  FILLER                        PIC X(10).
  5678
  5679     12  AM-SAVED-REMIT-TO                 PIC 99.
  5680
  5681     12  AM-COMM-STRUCTURE-SAVED.
  5682         16  AM-DEFN-1-SAVED.
  5683             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5684                 24  AM-AGT-SV             PIC X(10).
  5685                 24  AM-COM-TYP-SV         PIC X.
  5686                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5687                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5688                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5689                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5690                 24  FILLER                PIC X.
  5691                 24  AM-GL-CODES-SV        PIC X.
  5692                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5693                 24  FILLER                PIC X.
  5694         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5695             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 106
* EL130.cbl
  5696                 24  FILLER                PIC X(11).
  5697                 24  AM-L-COMA-SV          PIC XXX.
  5698                 24  AM-J-COMA-SV          PIC XXX.
  5699                 24  AM-A-COMA-SV          PIC XXX.
  5700                 24  FILLER                PIC X(6).
  5701
  5702     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5703         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5704            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5705            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5706            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5707
  5708     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5709     12  FILLER                            PIC X(120).
  5710
  5711     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5712         16  AM-CONTROL-NAME               PIC X(30).
  5713         16  AM-EXECUTIVE-ONE.
  5714             20  AM-EXEC1-NAME             PIC X(15).
  5715             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5716                                                          COMP-3.
  5717             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5718                                                          COMP-3.
  5719         16  AM-EXECUTIVE-TWO.
  5720             20  AM-EXEC2-NAME             PIC X(15).
  5721             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5722                                                          COMP-3.
  5723             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5724                                                          COMP-3.
  5725
  5726     12  AM-RETRO-ADDITIONAL-DATA.
  5727         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5728         16  AM-RETRO-PREM-P-E             PIC X.
  5729         16  AM-RETRO-CLMS-P-I             PIC X.
  5730         16  AM-RETRO-RET-BRACKET-LF.
  5731             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5732                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5733                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5734             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5735                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5736                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5737             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5738                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5739                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5740         16  AM-RETRO-RET-BRACKET-AH.
  5741             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5742                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5743                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5744                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5745             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5746                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5747                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5748             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5749                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5750                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5751
  5752     12  AM-COMMENTS.
  5753         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 107
* EL130.cbl
  5754
  5755     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5756         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5757         16  AM-FLI-BILLING-CODE           PIC X.
  5758         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5759         16  AM-FLI-UNITED-IDENT           PIC X.
  5760         16  AM-FLI-INTEREST-LOST-DATA.
  5761             20  AM-FLI-BANK-NO            PIC X(5).
  5762             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5763             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5764             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5765         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5766             20  AM-FLI-AGT                PIC X(9).
  5767             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5768             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5769         16  FILLER                        PIC X(102).
  5770
  5771     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5772         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5773             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5774             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5775             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5776             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5777             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5778         16  FILLER                          PIC X(10).
  5779******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 108
* EL130.cbl
  5781*    COPY ELCTRLR.
  5782******************************************************************
  5783*                                                                *
  5784*                            ELCTRLR.                            *
  5785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5786*                            VMOD=2.014                          *
  5787*                                                                *
  5788*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5789*                                                                *
  5790*   FILE TYPE = VSAM,KSDS                                        *
  5791*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5792*                                                                *
  5793*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5794*       ALTERNATE INDEX = NONE                                   *
  5795*                                                                *
  5796*   LOG = YES                                                    *
  5797*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5798******************************************************************
  5799*                   C H A N G E   L O G
  5800*
  5801* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5802*-----------------------------------------------------------------
  5803*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5804* EFFECTIVE    NUMBER
  5805*-----------------------------------------------------------------
  5806* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5807* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5808* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5809* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5810* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5811* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5812* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5813* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5814* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5815* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5816* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5817* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5818* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5819* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5820* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5821* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5822* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5823* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5824* 040814    2014030500002  AJRA  ADD ICD CODES
  5825******************************************************************
  5826 01  ACTIVITY-TRAILERS.
  5827     12  AT-RECORD-ID                    PIC XX.
  5828         88  VALID-AT-ID                       VALUE 'AT'.
  5829
  5830     12  AT-CONTROL-PRIMARY.
  5831         16  AT-COMPANY-CD               PIC X.
  5832         16  AT-CARRIER                  PIC X.
  5833         16  AT-CLAIM-NO                 PIC X(7).
  5834         16  AT-CERT-NO.
  5835             20  AT-CERT-PRIME           PIC X(10).
  5836             20  AT-CERT-SFX             PIC X.
  5837         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5838             88  AT-1ST-TRL-AVAIL             VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 109
* EL130.cbl
  5839             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5840             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5841             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5842             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5843             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5844             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5845             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5846             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5847             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5848             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5849             88  AT-BENEFICIARY-TRL           VALUE +91.
  5850             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5851             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5852             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5853             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5854
  5855     12  AT-TRAILER-TYPE                 PIC X.
  5856         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5857         88  PAYMENT-TR                       VALUE '2'.
  5858         88  AUTO-PAY-TR                      VALUE '3'.
  5859         88  CORRESPONDENCE-TR                VALUE '4'.
  5860         88  ADDRESS-TR                       VALUE '5'.
  5861         88  GENERAL-INFO-TR                  VALUE '6'.
  5862         88  AUTO-PROMPT-TR                   VALUE '7'.
  5863         88  DENIAL-TR                        VALUE '8'.
  5864         88  INCURRED-CHG-TR                  VALUE '9'.
  5865         88  FORM-CONTROL-TR                  VALUE 'A'.
  5866
  5867     12  AT-RECORDED-DT                  PIC XX.
  5868     12  AT-RECORDED-BY                  PIC X(4).
  5869     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5870
  5871     12  AT-TRAILER-BODY                 PIC X(165).
  5872
  5873     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5874         16  AT-RESERVE-CONTROLS.
  5875             20  AT-MANUAL-SW            PIC X.
  5876                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5877             20  AT-FUTURE-SW            PIC X.
  5878                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5879             20  AT-PTC-SW               PIC X.
  5880                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5881             20  AT-IBNR-SW              PIC X.
  5882                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5883             20  AT-PTC-LF-SW            PIC X.
  5884                 88  AT-LF-PTC-USED          VALUE '1'.
  5885             20  AT-CDT-ACCESS-METHOD    PIC X.
  5886                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5887                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5888                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5889             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5890         16  AT-LAST-COMPUTED-DT         PIC XX.
  5891         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5892         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5893         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5894         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5895         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5896         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 110
* EL130.cbl
  5897         16  AT-EXPENSE-CONTROLS.
  5898             20  AT-EXPENSE-METHOD       PIC X.
  5899                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5900                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5901                 88  PERCENT-OF-PMT           VALUE '3'.
  5902                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5903             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5904             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5905         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5906         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5907
  5908         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5909         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5910
  5911*        16  FILLER                      PIC X(53).
  5912         16  FILLER                      PIC X(47).
  5913
  5914         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5915         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5916
  5917         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5918             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5919             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5920*                    C = CLOSED
  5921*                    O = OPEN
  5922             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5923*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5924
  5925     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5926         16  AT-PAYMENT-TYPE             PIC X.
  5927             88  PARTIAL-PAYMENT                VALUE '1'.
  5928             88  FINAL-PAYMENT                  VALUE '2'.
  5929             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5930             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5931             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5932             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5933             88  VOIDED-PAYMENT                 VALUE '9'.
  5934             88  TRANSFER                       VALUE 'T'.
  5935             88  LIFE-INTEREST                  VALUE 'I'.
  5936
  5937         16  AT-CLAIM-TYPE               PIC X.
  5938             88  PAID-FOR-AH                    VALUE 'A'.
  5939             88  PAID-FOR-LIFE                  VALUE 'L'.
  5940             88  PAID-FOR-IUI                   VALUE 'I'.
  5941             88  PAID-FOR-GAP                   VALUE 'G'.
  5942         16  AT-CLAIM-PREM-TYPE          PIC X.
  5943             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5944             88  AT-O-B-COVERAGE                VALUE '2'.
  5945             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5946         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5947         16  AT-CHECK-NO                 PIC X(7).
  5948         16  AT-PAID-FROM-DT             PIC XX.
  5949         16  AT-PAID-THRU-DT             PIC XX.
  5950         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5951         16  FILLER                      PIC X.
  5952         16  AT-PAYEES-NAME              PIC X(30).
  5953         16  AT-PAYMENT-ORIGIN           PIC X.
  5954             88  ONLINE-MANUAL-PMT              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 111
* EL130.cbl
  5955             88  ONLINE-AUTO-PMT                VALUE '2'.
  5956             88  OFFLINE-PMT                    VALUE '3'.
  5957         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5958         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5959         16  AT-VOID-DATA.
  5960             20  AT-VOID-DT              PIC XX.
  5961*00144       20  AT-VOID-REASON          PIC X(30).
  5962             20  AT-VOID-REASON          PIC X(26).
  5963         16  AT-PMT-APPROVED-BY          PIC X(04).
  5964         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5965         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5966         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5967                                         PIC S99V9(5)  COMP-3.
  5968         16  AT-CREDIT-INTERFACE.
  5969             20  AT-PMT-SELECT-DT        PIC XX.
  5970                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5971             20  AT-PMT-ACCEPT-DT        PIC XX.
  5972                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5973             20  AT-VOID-SELECT-DT       PIC XX.
  5974                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5975             20  AT-VOID-ACCEPT-DT       PIC XX.
  5976                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5977
  5978         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5979                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5980                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5981         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5982
  5983         16  AT-FORCE-CONTROL            PIC X.
  5984             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5985         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5986         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5987         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5988         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5989         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5990         16  AT-BENEFIT-TYPE             PIC X.
  5991
  5992         16  AT-EXPENSE-TYPE             PIC X.
  5993         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5994
  5995         16  AT-PAYEE-TYPE-CD.
  5996             20  AT-PAYEE-TYPE           PIC X.
  5997                 88  INSURED-PAID           VALUE 'I'.
  5998                 88  BENEFICIARY-PAID       VALUE 'B'.
  5999                 88  ACCOUNT-PAID           VALUE 'A'.
  6000                 88  OTHER-1-PAID           VALUE 'O'.
  6001                 88  OTHER-2-PAID           VALUE 'Q'.
  6002                 88  DOCTOR-PAID            VALUE 'P'.
  6003                 88  EMPLOYER-PAID          VALUE 'E'.
  6004             20  AT-PAYEE-SEQ            PIC X.
  6005
  6006         16  AT-CASH-PAYMENT             PIC X.
  6007         16  AT-GROUPED-PAYMENT          PIC X.
  6008         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6009         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6010         16  AT-APPROVED-LEVEL           PIC X.
  6011         16  AT-VOID-TYPE                PIC X.
  6012             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 112
* EL130.cbl
  6013             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6014         16  AT-AIG-UNEMP-IND            PIC X.
  6015             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6016         16  AT-ASSOCIATES               PIC X.
  6017             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6018             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6019
  6020         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6021         16  AT-CV-PMT-CODE              PIC X.
  6022             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6023             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6024             88  FULL-ADD-PAYMENT           VALUE '3'.
  6025             88  HALF-ADD-PAYMENT           VALUE '4'.
  6026             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6027             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6028             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6029             88  ADDL-PAYMENT               VALUE '8'.
  6030
  6031         16  AT-EOB-CODE1                PIC XXX.
  6032         16  AT-EOB-CODE2                PIC XXX.
  6033         16  AT-EOB-CODE3                PIC XXX.
  6034         16  FILLER REDEFINES AT-EOB-CODE3.
  6035             20  AT-PRINT-CLM-FORM       PIC X.
  6036             20  AT-PRINT-SURVEY         PIC X.
  6037             20  AT-SPECIAL-RELEASE      PIC X.
  6038         16  AT-EOB-CODE4                PIC XXX.
  6039         16  FILLER REDEFINES AT-EOB-CODE4.
  6040             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6041             20  FILLER                  PIC X.
  6042         16  AT-EOB-CODE5                PIC XXX.
  6043         16  FILLER REDEFINES AT-EOB-CODE5.
  6044             20  AT-PMT-PROOF-DT         PIC XX.
  6045             20  FILLER                  PIC X.
  6046
  6047         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6048             88  AT-PRINT-EOB            VALUE 'Y'.
  6049
  6050         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6051         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6052
  6053     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6054         16  AT-SCHEDULE-START-DT        PIC XX.
  6055         16  AT-SCHEDULE-END-DT          PIC XX.
  6056         16  AT-TERMINATED-DT            PIC XX.
  6057         16  AT-LAST-PMT-TYPE            PIC X.
  6058             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6059             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6060         16  AT-FIRST-PMT-DATA.
  6061             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6062             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6063             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6064         16  AT-REGULAR-PMT-DATA.
  6065             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6066             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6067             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6068         16  AT-AUTO-PAYEE-CD.
  6069             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6070                 88  INSURED-PAID-AUTO      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 113
* EL130.cbl
  6071                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6072                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6073                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6074                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6075             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6076         16  AT-AUTO-PAY-DAY             PIC 99.
  6077         16  AT-AUTO-CASH                PIC X.
  6078             88  AT-CASH                      VALUE 'Y'.
  6079             88  AT-NON-CASH                  VALUE 'N'.
  6080*        16  FILLER                      PIC X(129).
  6081         16  AT-AUTO-END-LETTER          PIC X(4).
  6082         16  FILLER                      PIC X(125).
  6083
  6084         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6085         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6086
  6087     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6088         16  AT-LETTER-SENT-DT           PIC XX.
  6089         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6090         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6091         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6092         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6093         16  AT-LETTER-ORIGIN            PIC X.
  6094             88  ONLINE-CREATION              VALUE '1' '3'.
  6095             88  OFFLINE-CREATION             VALUE '2' '4'.
  6096             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6097             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6098         16  AT-STD-LETTER-FORM          PIC X(4).
  6099         16  AT-REASON-TEXT              PIC X(70).
  6100         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6101         16  AT-ADDRESEE-TYPE            PIC X.
  6102              88  INSURED-ADDRESEE            VALUE 'I'.
  6103              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6104              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6105              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6106              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6107              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6108              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6109         16  AT-ADDRESSEE-NAME           PIC X(30).
  6110         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6111         16  AT-RESEND-PRINT-DATE        PIC XX.
  6112         16  AT-CORR-SOL-UNSOL           PIC X.
  6113         16  AT-LETTER-PURGED-DT         PIC XX.
  6114*
  6115*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6116*
  6117         16  AT-CSO-REDEFINITION.
  6118             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6119             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6120             20  AT-LETTER-TO-BENE       PIC X(1).
  6121             20  AT-STOP-LETTER-DT       PIC X(2).
  6122             20  FILLER                  PIC X(19).
  6123*             20  FILLER                  PIC X(27).
  6124             20  AT-CSO-LETTER-STATUS    PIC X.
  6125                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6126                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6127                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6128             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 114
* EL130.cbl
  6129             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6130*
  6131*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6132*
  6133*        16  FILLER                      PIC X(26).
  6134*
  6135*        16  AT-DMD-BSR-CODE             PIC X.
  6136*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6137*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6138*
  6139*        16  AT-DMD-LETTER-STATUS        PIC X.
  6140*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6141*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6142*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6143*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6144*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6145
  6146         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6147         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6148
  6149     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6150         16  AT-ADDRESS-TYPE             PIC X.
  6151             88  INSURED-ADDRESS               VALUE 'I'.
  6152             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6153             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6154             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6155             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6156             88  OTHER-ADDRESS-1               VALUE 'O'.
  6157             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6158         16  AT-MAIL-TO-NAME             PIC X(30).
  6159         16  AT-ADDRESS-LINE-1           PIC X(30).
  6160         16  AT-ADDRESS-LINE-2           PIC X(30).
  6161         16  AT-CITY-STATE.
  6162             20  AT-CITY                 PIC X(28).
  6163             20  AT-STATE                PIC XX.
  6164         16  AT-ZIP.
  6165             20  AT-ZIP-CODE.
  6166                 24  AT-ZIP-1ST          PIC X.
  6167                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6168                 24  FILLER              PIC X(4).
  6169             20  AT-ZIP-PLUS4            PIC X(4).
  6170         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6171             20  AT-CAN-POSTAL-1         PIC XXX.
  6172             20  AT-CAN-POSTAL-2         PIC XXX.
  6173             20  FILLER                  PIC XXX.
  6174         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6175*         16  FILLER                      PIC X(23).
  6176         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6177         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6178         16  FILLER                      PIC X(13).
  6179         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6180         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6181
  6182     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6183         16  AT-INFO-LINE-1              PIC X(60).
  6184         16  FILLER REDEFINES AT-INFO-LINE-1.
  6185             20  AT-NOTE-ERROR-NO OCCURS 15
  6186                                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 115
* EL130.cbl
  6187         16  AT-INFO-LINE-2              PIC X(60).
  6188         16  FILLER REDEFINES AT-INFO-LINE-2.
  6189             20  AT-ICD-CODE-1           PIC X(8).
  6190             20  AT-ICD-CODE-2           PIC X(8).
  6191             20  FILLER                  PIC X(44).
  6192         16  AT-INFO-TRAILER-TYPE        PIC X.
  6193             88  AT-ERRORS-NOTE          VALUE 'E'.
  6194             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6195             88  AT-CALL-NOTE            VALUE 'C'.
  6196             88  AT-MAINT-NOTE           VALUE 'M'.
  6197             88  AT-CERT-CHANGE          VALUE 'X'.
  6198             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6199             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6200             88  AT-CERT-CANCELLED       VALUE 'T'.
  6201         16  AT-CALL-TYPE                PIC X.
  6202             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6203             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6204         16  AT-NOTE-CONTINUATION        PIC X.
  6205             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6206         16  AT-EOB-CODES-EXIST          PIC X.
  6207             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6208         16  FILLER                      PIC X(35).
  6209         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6210         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6211
  6212     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6213         16  AT-PROMPT-LINE-1            PIC X(60).
  6214         16  AT-PROMPT-LINE-2            PIC X(60).
  6215         16  AT-PROMPT-START-DT          PIC XX.
  6216         16  AT-PROMPT-END-DT            PIC XX.
  6217         16  FILLER                      PIC X(35).
  6218         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6219         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6220
  6221     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6222         16  AT-DENIAL-INFO-1            PIC X(60).
  6223         16  AT-DENIAL-INFO-2            PIC X(60).
  6224         16  AT-DENIAL-DT                PIC XX.
  6225         16  AT-RETRACTION-DT            PIC XX.
  6226         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6227*         16  FILLER                      PIC X(31).
  6228         16  AT-DENIAL-PROOF-DT          PIC XX.
  6229         16  FILLER                      PIC X(29).
  6230         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6231         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6232
  6233     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6234         16  AT-OLD-INCURRED-DT          PIC XX.
  6235         16  AT-OLD-REPORTED-DT          PIC XX.
  6236         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6237         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6238         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6239         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6240         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6241         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6242         16  FILLER                      PIC X(26).
  6243         16  AT-OLD-DIAG-CODE            PIC X(6).
  6244         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 116
* EL130.cbl
  6245         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6246         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6247         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6248         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6249         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6250         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6251         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6252         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6253         16  FILLER                      PIC X(9).
  6254         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6255
  6256     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6257         16  AT-FORM-SEND-ON-DT          PIC XX.
  6258         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6259         16  AT-FORM-RE-SEND-DT          PIC XX.
  6260         16  AT-FORM-ANSWERED-DT         PIC XX.
  6261         16  AT-FORM-PRINTED-DT          PIC XX.
  6262         16  AT-FORM-REPRINT-DT          PIC XX.
  6263         16  AT-FORM-TYPE                PIC X.
  6264             88  INITIAL-FORM                  VALUE '1'.
  6265             88  PROGRESS-FORM                 VALUE '2'.
  6266         16  AT-INSTRUCT-LN-1            PIC X(28).
  6267         16  AT-INSTRUCT-LN-2            PIC X(28).
  6268         16  AT-INSTRUCT-LN-3            PIC X(28).
  6269         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6270         16  AT-FORM-ADDRESS             PIC X.
  6271             88  FORM-TO-INSURED              VALUE 'I'.
  6272             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6273             88  FORM-TO-OTHER-1              VALUE 'O'.
  6274             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6275         16  AT-RELATED-1.
  6276             20 AT-REL-CARR-1            PIC X.
  6277             20 AT-REL-CLAIM-1           PIC X(7).
  6278             20 AT-REL-CERT-1            PIC X(11).
  6279         16  AT-RELATED-2.
  6280             20 AT-REL-CARR-2            PIC X.
  6281             20 AT-REL-CLAIM-2           PIC X(7).
  6282             20 AT-REL-CERT-2            PIC X(11).
  6283         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6284         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6285         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6286         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6287         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6288         16  AT-STOP-FORM-DT             PIC X(2).
  6289
  6290         16  FILLER                      PIC X(09).
  6291         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6292         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6293******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 117
* EL130.cbl
  6295*    COPY ELCBENE.
  6296******************************************************************
  6297*                                                                *
  6298*                            ELCBENE.                            *
  6299*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6300*                            VMOD=2.006                          *
  6301*                                                                *
  6302*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6303*                                                                *
  6304*   FILE TYPE = VSAM,KSDS                                        *
  6305*   RECORD SIZE = 500   RECFORM = FIX                            *
  6306*                                                                *
  6307*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6308*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6309*                                                                *
  6310*   LOG = YES                                                    *
  6311*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6312*                                                                *
  6313*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6314******************************************************************
  6315
  6316 01  BENEFICIARY-MASTER.
  6317     12  BE-RECORD-ID                PIC XX.
  6318         88  VALID-BE-ID                VALUE 'BE'.
  6319
  6320     12  BE-CONTROL-PRIMARY.
  6321         16  BE-COMPANY-CD           PIC X.
  6322         16  BE-RECORD-TYPE          PIC X.
  6323             88  BENEFICIARY-RECORD  VALUE 'B'.
  6324             88  ADJUSTOR-RECORD     VALUE 'A'.
  6325         16  BE-BENEFICIARY          PIC X(10).
  6326     12  BE-CONTROL-BY-NAME.
  6327         16  BE-COMPANY-CD-A1        PIC X.
  6328         16  BE-RECORD-TYPE-A1       PIC X.
  6329         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6330         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6331
  6332     12  BE-LAST-MAINT-DT            PIC XX.
  6333     12  BE-LAST-MAINT-BY            PIC X(4).
  6334     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6335
  6336     12  BE-ADDRESS-DATA.
  6337         16  BE-MAIL-TO-NAME         PIC X(30).
  6338         16  BE-ADDRESS-LINE-1       PIC X(30).
  6339         16  BE-ADDRESS-LINE-2       PIC X(30).
  6340         16  BE-ADDRESS-LINE-3       PIC X(30).
  6341         16  BE-CITY-STATE.
  6342             20  BE-CITY             PIC X(28).
  6343             20  BE-STATE            PIC XX.
  6344         16  BE-ZIP-CODE.
  6345             20  BE-ZIP-PRIME.
  6346                 24  BE-ZIP-1ST      PIC X.
  6347                     88  BE-CANADIAN-POST-CODE
  6348                                         VALUE 'A' THRU 'Z'.
  6349                 24  FILLER          PIC X(4).
  6350             20  BE-ZIP-PLUS4        PIC X(4).
  6351         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6352             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 118
* EL130.cbl
  6353             20  BE-CAN-POSTAL-2     PIC XXX.
  6354             20  FILLER              PIC XXX.
  6355         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6356         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6357
  6358******************************************************************
  6359*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6360*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6361******************************************************************
  6362     12  BE-CARRIER                  PIC X.
  6363
  6364     12  BE-ADDRESS-DATA2.
  6365         16  BE-MAIL-TO-NAME2        PIC X(30).
  6366         16  BE-ADDRESS-LINE-12      PIC X(30).
  6367         16  BE-ADDRESS-LINE-22      PIC X(30).
  6368         16  BE-ADDRESS-LINE-32      PIC X(30).
  6369         16  BE-CITY-STATE2.
  6370             20  BE-CITY2            PIC X(28).
  6371             20  BE-STATE2           PIC XX.
  6372         16  BE-ZIP-CODE2.
  6373             20  BE-ZIP-PRIME2.
  6374                 24  BE-ZIP-1ST2     PIC X.
  6375                     88  BE-CANADIAN-POST-CODE2
  6376                                         VALUE 'A' THRU 'Z'.
  6377                 24  FILLER          PIC X(4).
  6378             20  BE-ZIP-PLUS42       PIC X(4).
  6379         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6380             20  BE-CAN-POSTAL-12    PIC XXX.
  6381             20  BE-CAN-POSTAL-22    PIC XXX.
  6382             20  FILLER              PIC XXX.
  6383         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6384         16  BE-BILLING-STMT-DATA.
  6385             20  BE-BSR              PIC X.
  6386                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6387                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6388             20  BE-BSR-FROM         PIC X(30).
  6389             20  BE-BSR-DEPT         PIC X(30).
  6390             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6391             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6392             20  BE-OUTPUT-TYPE      PIC X.
  6393                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6394                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6395
  6396     12  FILLER                      PIC X(28).
  6397******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 119
* EL130.cbl
  6399*    COPY ELCDAR.
  6400******************************************************************
  6401*                                                                *
  6402*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6403*   FILE TYPE = VSAM,KSDS                                        *
  6404*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6405*   BASE CLUSTER = DLYACTV                                       *
  6406*   LOG = YES                                                    *
  6407*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6408*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6409*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6410*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6411*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6412*               BY PROGRAM "LGINFCE".                            *
  6413*                                                                *
  6414******************************************************************
  6415 01  DAILY-ACTIVITY-RECORD.
  6416     05  DA-KEY.
  6417         10  DA-COMP-CD          PIC X.
  6418         10  DA-CARRIER          PIC X.
  6419         10  DA-CLAIM-NO         PIC X(7).
  6420         10  DA-CERT-NO.
  6421             15  DA-CERT-PRIME   PIC X(10).
  6422             15  DA-CERT-SFX     PIC X.
  6423     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6424     05  DA-RECORD-TYPE          PIC X.
  6425     05  FILLER                  PIC X(2).
  6426******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 120
* EL130.cbl
  6428*    COPY ELCACTQ.
  6429******************************************************************
  6430*                                                                *
  6431*                            ELCACTQ.                            *
  6432*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6433*                            VMOD=2.004                          *
  6434*                                                                *
  6435*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6436*                                                                *
  6437*   FILE TYPE = VSAM,KSDS                                        *
  6438*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6439*                                                                *
  6440*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6441*       ALTERNATE INDEX = NONE                                   *
  6442*                                                                *
  6443*   LOG = YES                                                    *
  6444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6445*                                                                *
  6446*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6447******************************************************************
  6448
  6449 01  ACTIVITY-QUE.
  6450     12  AQ-RECORD-ID                PIC XX.
  6451         88  VALID-AQ-ID                VALUE 'AQ'.
  6452
  6453     12  AQ-CONTROL-PRIMARY.
  6454         16  AQ-COMPANY-CD           PIC X.
  6455         16  AQ-CARRIER              PIC X.
  6456         16  AQ-CLAIM-NO             PIC X(7).
  6457         16  AQ-CERT-NO.
  6458             20  AQ-CERT-PRIME       PIC X(10).
  6459             20  AQ-CERT-SFX         PIC X.
  6460
  6461     12  AQ-PENDING-ACTIVITY-FLAGS.
  6462         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6463         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6464             88  PENDING-PAYMENTS       VALUE '1'.
  6465         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6466             88  PENDING-FULL-PRINT     VALUE '1'.
  6467             88  PENDING-PART-PRINT     VALUE '2'.
  6468         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6469             88  PENDING-LETTERS        VALUE '1'.
  6470         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6471             88  PENDING-RESTORE        VALUE 'C'.
  6472             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6473
  6474     12  FILLER                      PIC X(20).
  6475
  6476     12  AQ-RESEND-DATE              PIC XX.
  6477     12  AQ-FOLLOWUP-DATE            PIC XX.
  6478     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6479     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6480     12  AQ-AUTO-LETTER              PIC X(4).
  6481     12  FILLER                      PIC XX.
  6482     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6483*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 121
* EL130.cbl
  6485*    COPY ELCARCH.
  6486******************************************************************
  6487*                                                                *
  6488*                            ELCARCH.                            *
  6489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6490*                            VMOD=2.007                          *
  6491*                                                                *
  6492*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6493*                                                                *
  6494*   FILE TYPE = VSAM,KSDS                                        *
  6495*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6496*                                                                *
  6497*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6498*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6499*                                                                *
  6500*   LOG = NO                                                     *
  6501*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6502*                                                                *
  6503*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6504******************************************************************
  6505 01  LETTER-ARCHIVE.
  6506     12  LA-RECORD-ID                PIC XX.
  6507         88  VALID-LA-ID                VALUE 'LA'.
  6508
  6509     12  LA-CONTROL-PRIMARY.
  6510         16  LA-COMPANY-CD           PIC X.
  6511         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6512         16  LA-RECORD-TYPE          PIC X.
  6513             88  LA-HEADER-DATA         VALUE '1'.
  6514             88  LA-ADDRESS-DATA        VALUE '2'.
  6515             88  LA-TEXT-DATA           VALUE '3'.
  6516             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6517         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6518
  6519     12  LA-CONTROL-BY-TYPE.
  6520         16  LA-COMPANY-CD-A1        PIC X.
  6521         16  LA-RECORD-TYPE-A1       PIC X.
  6522         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6523         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6524
  6525     12  LA-TEXT-RECORD.
  6526         16  LA-SKIP-CONTROL         PIC XX.
  6527             88  NO-LINES-SKIPPED       VALUE SPACES.
  6528             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6529         16  LA-TEXT-LINE            PIC X(70).
  6530
  6531     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6532         16  FILLER                  PIC XX.
  6533         16  LA-ADDRESS-LINE         PIC X(30).
  6534         16  FILLER                  PIC X(40).
  6535
  6536     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6537         16  FILLER                  PIC XX.
  6538         16  LA-CARRIER              PIC X.
  6539         16  LA-CLAIM-NO             PIC X(7).
  6540         16  LA-CERT-NO.
  6541             20  LA-CERT-PRIME       PIC X(10).
  6542             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 122
* EL130.cbl
  6543         16  LA-NO-OF-COPIES         PIC S9.
  6544         16  LA-RESEND-DATE          PIC XX.
  6545         16  LA-PROCESSOR-CD         PIC X(4).
  6546         16  LA-CREATION-DT          PIC XX.
  6547         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6548         16  LA-RESEND-PRINT-DATE    PIC XX.
  6549         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6550         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6551*
  6552* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6553*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6554*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6555*   I        20  LA-DMD-RES-ST           PIC XX.
  6556*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6557*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6558*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6559*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6560*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6561*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6562*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6563*   I        20  LA-DMD-UND-CODE         PIC XX.
  6564*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6565*   V    16  FILLER                  PIC X(15).
  6566* -----
  6567*
  6568* REINSERTED  CSO  MODS
  6569*
  6570         16  FILLER.
  6571             20  FILLER                  PIC X(29).
  6572             20  LA-CSO-LETTER-STATUS    PIC X.
  6573                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6574                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6575                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6576             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6577             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6578*
  6579
  6580     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6581         16  FILLER                  PIC XX.
  6582         16  LA4-CARRIER             PIC X.
  6583         16  LA4-CLAIM-NO            PIC X(7).
  6584         16  LA4-CERT-NO.
  6585             20  LA4-CERT-PRIME      PIC X(10).
  6586             20  LA4-CERT-SFX        PIC X.
  6587         16  LA4-NO-OF-COPIES        PIC S9.
  6588         16  LA4-RESEND-DATE         PIC XX.
  6589         16  LA4-PROCESSOR-CD        PIC X(4).
  6590         16  LA4-CREATION-DT         PIC XX.
  6591         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6592         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6593         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6594         16  LA4-FORM-TYPE           PIC X.
  6595             88  LA4-INITIAL-FORM    VALUE '1'.
  6596             88  LA4-PROGRESS-FORM   VALUE '2'.
  6597         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6598         16  LA4-STATE               PIC X(02).
  6599         16  FILLER                  PIC X(31).
  6600******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 123
* EL130.cbl
  6602*    COPY ERCREIN.
  6603******************************************************************
  6604*                                                                *
  6605*                            ERCREIN                             *
  6606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6607*                            VMOD=2.010                          *
  6608*                                                                *
  6609*   ONLINE CREDIT SYSTEM                                         *
  6610*                                                                *
  6611*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6612*                                                                *
  6613*   FILE TYPE = VSAM,KSDS                                        *
  6614*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6615*                                                                *
  6616*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6617*       ALTERNATE PATH = NONE                                    *
  6618*                                                                *
  6619*   LOG = NO                                                     *
  6620*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6621*                                                                *
  6622******************************************************************
  6623*                   C H A N G E   L O G
  6624*
  6625* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6626*-----------------------------------------------------------------
  6627*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6628* EFFECTIVE    NUMBER
  6629*-----------------------------------------------------------------
  6630* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6631* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6632******************************************************************
  6633 01  REINSURANCE-RECORD.
  6634     12  RE-RECORD-ID                      PIC XX.
  6635         88  VALID-RE-ID                      VALUE 'RE'.
  6636
  6637     12  RE-CONTROL-PRIMARY.
  6638         16  RE-COMPANY-CD                 PIC X.
  6639         16  RE-KEY.
  6640             20  RE-CODE                   PIC X.
  6641                 88  RE-TABLE-RECORD          VALUE 'A'.
  6642                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6643             20  RE-TABLE                  PIC XXX.
  6644             20  FILLER                    PIC XXX.
  6645         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6646             20  FILLER                    PIC X.
  6647             20  RE-COMPANY.
  6648                 24  RE-COMP-PRIME         PIC XXX.
  6649                 24  RE-COMP-SUB           PIC XXX.
  6650
  6651     12  RE-MAINT-INFORMATION.
  6652         16  RE-LAST-MAINT-DT              PIC XX.
  6653         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6654         16  RE-LAST-MAINT-USER            PIC X(4).
  6655         16  FILLER                        PIC X(10).
  6656
  6657     12  RE-TABLE-DATA.
  6658         16  RE-100-COMP                   PIC 99.
  6659
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 124
* EL130.cbl
  6660         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6661             20  RE-REI-COMP-NO.
  6662                 24  RE-REI-COMP           PIC XXX.
  6663                 24  RE-REI-COMP-SUB       PIC XXX.
  6664             20  RE-LF-QC                  PIC X.
  6665             20  RE-AH-QC                  PIC X.
  6666             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6667             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6668             20  RE-LFAGE-LO               PIC 99.
  6669             20  RE-LFAGE-HI               PIC 99.
  6670             20  RE-AHAGE-LO               PIC 99.
  6671             20  RE-AHAGE-HI               PIC 99.
  6672             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6673             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6674             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6675             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6676             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6677             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6678             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6679             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6680             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6681             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6682             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6683             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6684             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6685             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6686             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6687             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6688             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6689             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6690             20  RE-LF-BEN-CODE            PIC X.
  6691             20  RE-AH-BEN-CODE            PIC X.
  6692             20  RE-INTERACTIVE            PIC X.
  6693             20  RE-REMAINING              PIC X.
  6694             20  RE-LF-RUNOFF-SW           PIC X.
  6695             20  RE-AH-RUNOFF-SW           PIC X.
  6696             20  FILLER                    PIC X(19).
  6697
  6698         16  RE-COMP-INFO-END              PIC X(6).
  6699         16  RE-NSP-ST-CD-LF               PIC XX.
  6700         16  RE-NSP-ST-CD-AH               PIC XX.
  6701         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6702             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6703
  6704         16  FILLER                        PIC X(27).
  6705
  6706     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6707         16  RE-NAME                       PIC X(30).
  6708         16  RE-LF-PE                      PIC X.
  6709         16  RE-AH-PE                      PIC X.
  6710         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6711         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6712         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6713         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6714         16  RE-PRT-ST                     PIC X.
  6715         16  RE-PRT-OW                     PIC X.
  6716         16  RE-MORT-CODE                  PIC X(4).
  6717         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 125
* EL130.cbl
  6718         16  RE-ZERO-LF-FEE                PIC X.
  6719         16  RE-ZERO-AH-FEE                PIC X.
  6720         16  RE-CEDE-NAME                  PIC X(30).
  6721         16  RE-LF-COMM                    PIC X.
  6722         16  RE-AH-COMM                    PIC X.
  6723         16  RE-LF-TAX                     PIC X.
  6724         16  RE-AH-TAX                     PIC X.
  6725         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6726         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6727         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6728
  6729         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6730             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6731
  6732         16  RE-LF-CEDING-FEE-BRACKETS.
  6733             20  RE-LF-FEE-METHOD          PIC X.
  6734                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6735                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6736                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6737                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6738             20  RE-LF-FEE-BASIS           PIC X.
  6739                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6740                 88  RE-LF-NET-CEDED               VALUE '2'.
  6741                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6742                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6743                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6744                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6745                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6746                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6747             20  FILLER                    PIC XXX.
  6748             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6749                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6750                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6751
  6752         16  RE-AH-CEDING-FEE-BRACKETS.
  6753             20  RE-AH-FEE-METHOD          PIC X.
  6754                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6755                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6756                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6757                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6758             20  RE-AH-FEE-BASIS           PIC X.
  6759                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6760                 88  RE-AH-NET-CEDED               VALUE '2'.
  6761                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6762                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6763                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6764                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6765                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6766                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6767             20  FILLER                    PIC XXX.
  6768             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6769                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6770                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6771
  6772         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6773
  6774         16  RE-OLD-CEDING-STMT            PIC X.
  6775
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 126
* EL130.cbl
  6776         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6777         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6778         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6779         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6780         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6781         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6782         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6783         16  RE-MORT-SW                    PIC X.
  6784         16  RE-CEDING-TYPE-FLAG           PIC X.
  6785             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6786             88  RE-CEDED                          VALUE 'C'.
  6787             88  RE-ASSUMED                        VALUE 'A'.
  6788             88  RE-PHANTOM                        VALUE 'P'.
  6789
  6790         16  RE-CEDING-STMT-OPT-A          PIC X.
  6791             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6792         16  RE-CEDING-STMT-OPT-B          PIC X.
  6793             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6794         16  RE-CEDING-STMT-OPT-C          PIC X.
  6795             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6796         16  RE-CEDING-STMT-OPT-D          PIC X.
  6797             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6798         16  RE-CEDING-STMT-OPT-E          PIC X.
  6799             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6800
  6801         16  RE-PRT-CRSV                   PIC X.
  6802
  6803         16  RE-GL-CENTER                  PIC X(4).
  6804
  6805         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6806
  6807         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6808
  6809         16  RE-EARN-STOP-CODE             PIC X.
  6810             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6811             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6812
  6813         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6814             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6815
  6816         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6817         16  FILLER                        PIC X(2281).
  6818
  6819         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6820
  6821******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 127
* EL130.cbl
  6823*    COPY ERCMAIL.
  6824******************************************************************
  6825*                                                                *
  6826*                                                                *
  6827*                            ERCMAIL                             *
  6828*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6829*                            VMOD=2.003                          *
  6830*                                                                *
  6831*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6832*                                                                *
  6833*   FILE TYPE = VSAM,KSDS                                        *
  6834*   RECORD SIZE = 374   RECFORM = FIX                            *
  6835*                                                                *
  6836*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6837*   ALTERNATE PATH    = NOT USED                                 *
  6838*                                                                *
  6839*   LOG = YES                                                    *
  6840*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6841******************************************************************
  6842*                   C H A N G E   L O G
  6843*
  6844* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6845*-----------------------------------------------------------------
  6846*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6847* EFFECTIVE    NUMBER
  6848*-----------------------------------------------------------------
  6849* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6850* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6851* 111108                   PEMA  ADD CRED BENE ADDR2
  6852******************************************************************
  6853
  6854 01  MAILING-DATA.
  6855     12  MA-RECORD-ID                      PIC XX.
  6856         88  VALID-MA-ID                       VALUE 'MA'.
  6857
  6858     12  MA-CONTROL-PRIMARY.
  6859         16  MA-COMPANY-CD                 PIC X.
  6860         16  MA-CARRIER                    PIC X.
  6861         16  MA-GROUPING.
  6862             20  MA-GROUPING-PREFIX        PIC XXX.
  6863             20  MA-GROUPING-PRIME         PIC XXX.
  6864         16  MA-STATE                      PIC XX.
  6865         16  MA-ACCOUNT.
  6866             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6867             20  MA-ACCOUNT-PRIME          PIC X(6).
  6868         16  MA-CERT-EFF-DT                PIC XX.
  6869         16  MA-CERT-NO.
  6870             20  MA-CERT-PRIME             PIC X(10).
  6871             20  MA-CERT-SFX               PIC X.
  6872
  6873     12  FILLER                            PIC XX.
  6874
  6875     12  MA-ACCESS-CONTROL.
  6876         16  MA-SOURCE-SYSTEM              PIC XX.
  6877             88  MA-FROM-CREDIT                VALUE 'CR'.
  6878             88  MA-FROM-VSI                   VALUE 'VS'.
  6879             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6880             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 128
* EL130.cbl
  6881         16  MA-RECORD-ADD-DT              PIC XX.
  6882         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6883         16  MA-LAST-MAINT-DT              PIC XX.
  6884         16  MA-LAST-MAINT-BY              PIC XXXX.
  6885         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6886
  6887     12  MA-PROFILE-INFO.
  6888         16  MA-QUALIFY-CODE-1             PIC XX.
  6889         16  MA-QUALIFY-CODE-2             PIC XX.
  6890         16  MA-QUALIFY-CODE-3             PIC XX.
  6891         16  MA-QUALIFY-CODE-4             PIC XX.
  6892         16  MA-QUALIFY-CODE-5             PIC XX.
  6893
  6894         16  MA-INSURED-LAST-NAME          PIC X(15).
  6895         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6896         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6897         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6898         16  MA-INSURED-BIRTH-DT           PIC XX.
  6899         16  MA-INSURED-SEX                PIC X.
  6900             88  MA-SEX-MALE                   VALUE 'M'.
  6901             88  MA-SEX-FEMALE                 VALUE 'F'.
  6902         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6903
  6904         16  MA-ADDRESS-CORRECTED          PIC X.
  6905         16  MA-JOINT-BIRTH-DT             PIC XX.
  6906*        16  FILLER                        PIC X(12).
  6907
  6908         16  MA-ADDRESS-LINE-1             PIC X(30).
  6909         16  MA-ADDRESS-LINE-2             PIC X(30).
  6910         16  MA-CITY-STATE.
  6911             20  MA-CITY                   PIC X(28).
  6912             20  MA-ADDR-STATE             PIC XX.
  6913         16  MA-ZIP.
  6914             20  MA-ZIP-CODE.
  6915                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6916                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6917                 24  FILLER                PIC X(4).
  6918             20  MA-ZIP-PLUS4              PIC X(4).
  6919         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6920             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6921             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6922             20  FILLER                    PIC X(3).
  6923
  6924         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6925
  6926         16  FILLER                        PIC XXX.
  6927*        16  FILLER                        PIC X(10).
  6928
  6929     12  MA-CRED-BENE-INFO.
  6930         16  MA-CRED-BENE-NAME                 PIC X(25).
  6931         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6932         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6933         16  MA-CRED-BENE-CTYST.
  6934             20  MA-CRED-BENE-CITY             PIC X(28).
  6935             20  MA-CRED-BENE-STATE            PIC XX.
  6936         16  MA-CRED-BENE-ZIP.
  6937             20  MA-CB-ZIP-CODE.
  6938                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 129
* EL130.cbl
  6939                     88  MA-CB-CANADIAN-POST-CODE
  6940                                           VALUE 'A' THRU 'Z'.
  6941                 24  FILLER                    PIC X(4).
  6942             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6943         16  MA-CB-CANADIAN-POSTAL-CODE
  6944                            REDEFINES MA-CRED-BENE-ZIP.
  6945             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6946             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6947             20  FILLER                        PIC X(3).
  6948     12  MA-POST-CARD-MAIL-DATA.
  6949         16  MA-MAIL-DATA OCCURS 7.
  6950             20  MA-MAIL-TYPE              PIC X.
  6951                 88  MA-12MO-MAILING           VALUE '1'.
  6952                 88  MA-EXP-MAILING            VALUE '2'.
  6953             20  MA-MAIL-STATUS            PIC X.
  6954                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6955                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6956                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6957             20  MA-MAIL-DATE              PIC XX.
  6958     12  FILLER                            PIC XX.
  6959     12  FILLER                            PIC XX.
  6960*    12  FILLER                            PIC X(30).
  6961******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 130
* EL130.cbl
  6963*    COPY ELCCRTT.
  6964******************************************************************
  6965*                                                                *
  6966*                            ELCCRTT.                            *
  6967*                                                                *
  6968*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6969*                                                                *
  6970*   FILE TYPE = VSAM,KSDS                                        *
  6971*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6972*                                                                *
  6973*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6974*                                                                *
  6975*   LOG = YES                                                    *
  6976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6977******************************************************************
  6978*                   C H A N G E   L O G
  6979*
  6980* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6981*-----------------------------------------------------------------
  6982*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6983* EFFECTIVE    NUMBER
  6984*-----------------------------------------------------------------
  6985* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6986* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6987* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6988* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  6989* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6990******************************************************************
  6991
  6992 01  CERTIFICATE-TRAILERS.
  6993     12  CS-RECORD-ID                      PIC XX.
  6994         88  VALID-CS-ID                      VALUE 'CS'.
  6995
  6996     12  CS-CONTROL-PRIMARY.
  6997         16  CS-COMPANY-CD                 PIC X.
  6998         16  CS-CARRIER                    PIC X.
  6999         16  CS-GROUPING                   PIC X(6).
  7000         16  CS-STATE                      PIC XX.
  7001         16  CS-ACCOUNT                    PIC X(10).
  7002         16  CS-CERT-EFF-DT                PIC XX.
  7003         16  CS-CERT-NO.
  7004             20  CS-CERT-PRIME             PIC X(10).
  7005             20  CS-CERT-SFX               PIC X.
  7006         16  CS-TRAILER-TYPE               PIC X.
  7007             88  COMM-TRLR           VALUE 'A'.
  7008             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7009             88  CERT-DATA-TRLR      VALUE 'C'.
  7010
  7011     12  CS-DATA-AREA                      PIC X(516).
  7012
  7013     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7014         16  CS-BANK-COMMISSION-AREA.
  7015             20  CS-BANK-COMMS       OCCURS 10.
  7016                 24  CS-AGT                PIC X(10).
  7017                 24  CS-COM-TYP            PIC X.
  7018                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7019                 24  CS-RECALC-LV-INDIC    PIC X.
  7020                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 131
* EL130.cbl
  7021         16  FILLER                        PIC X(256).
  7022
  7023     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7024****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7025****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7026         16  CS-MB-CLAIM-DATA OCCURS 2.
  7027             20  FILLER OCCURS 10.
  7028                 24  CS-CLAIM-TYPE         PIC X.
  7029                     88  CS-AH-CLM           VALUE 'A'.
  7030                     88  CS-IU-CLM           VALUE 'I'.
  7031                     88  CS-GP-CLM           VALUE 'G'.
  7032                     88  CS-LF-CLM           VALUE 'L'.
  7033                     88  CS-PR-CLM           VALUE 'P'.
  7034                 24  CS-BANK               PIC S999 COMP-3.
  7035                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7036                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7037                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7038         16  FILLER                        PIC X(216).
  7039     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7040         16  CS-VIN-NUMBER                 PIC X(17).
  7041         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7042         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7043         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7044         16  FILLER                        PIC X(496).
  7045******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 132
* EL130.cbl
  7047
  7048 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7049                          CONTROL-FILE CERTIFICATE-MASTER
  7050                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7051                          BENEFICIARY-MASTER
  7052                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7053                          LETTER-ARCHIVE REINSURANCE-RECORD
  7054                          MAILING-DATA CERTIFICATE-TRAILERS.
  7055 0000-DFHEXIT SECTION.
  7056     MOVE '9#                    $   ' TO DFHEIV0.
  7057     MOVE 'EL130' TO DFHEIV1.
  7058     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7059     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7060     MOVE '5'                    TO DC-OPTION-CODE.
  7061     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7062     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7063     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7064
  7065     IF EIBCALEN = ZERO
  7066         GO TO 8800-UNAUTHORIZED-ACCESS
  7067     END-IF.
  7068
  7069     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7070     MOVE EIBTRMID               TO QID-TERM.
  7071     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7072     move spaces                 to emi-error-lines
  7073     MOVE '2'                    TO EMI-SWITCH2.
  7074     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7075     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7076
  7077
  7078* EXEC CICS HANDLE CONDITION
  7079*        QIDERR     (0100-TEST-ENTRY)
  7080*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7081*        PGMIDERR   (9600-PGMID-ERROR)
  7082*        TERMIDERR  (8820-TERM-ERROR)
  7083*        TRANSIDERR (8830-TRAN-ERROR)
  7084*        ERROR      (9990-ABEND)
  7085*    END-EXEC.
  7086*    MOVE '"$N?L[\.              ! " #00007073' TO DFHEIV0
  7087     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7088     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7089     MOVE X'2220233030303037303733' TO DFHEIV0(25:11)
  7090     CALL 'kxdfhei1' USING DFHEIV0
  7091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7092
  7093
  7094     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7095        PI-CALLING-PROGRAM   = XCTL-6592
  7096         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7097     ELSE
  7098         MOVE SPACES             TO RETURNED-FROM
  7099     END-IF.
  7100
  7101     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7102         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7103             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7104             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 133
* EL130.cbl
  7105             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7106             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7107             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7108             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7109             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7110             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7111         ELSE
  7112             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7113             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7114             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7115             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7116             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7117             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7118             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7119             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7120         END-IF
  7121     END-IF.
  7122
  7123     IF EIBTRNID = TRANS-ID
  7124         IF EIBAID = DFHCLEAR
  7125             GO TO 9400-CLEAR
  7126         ELSE
  7127             GO TO 0200-RECEIVE
  7128         END-IF
  7129     END-IF.
  7130
  7131     IF RETURNED-FROM NOT = SPACES
  7132         GO TO 0600-RECOVER-TEMP-STORAGE
  7133     END-IF.
  7134
  7135     MOVE LOW-VALUES TO EL130AO.
  7136     move zeros to pi-dcc-max-amt
  7137                   pi-dcc-max-benefits
  7138
  7139
  7140
  7141* EXEC CICS DELETEQ TS
  7142*         QUEUE   (QID)
  7143*    END-EXEC.
  7144*    MOVE '*&                    #   #00007128' TO DFHEIV0
  7145     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7146     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7147     MOVE X'2020233030303037313238' TO DFHEIV0(25:11)
  7148     CALL 'kxdfhei1' USING DFHEIV0,
  7149           QID,
  7150           DFHEIV99
  7151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7152
  7153
  7154 0100-TEST-ENTRY.
  7155     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7156         GO TO 0650-FROM-EL127
  7157     ELSE
  7158         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7159                                    PI-CERT-PROCESSED
  7160                                    PI-LETTER-ERROR-CODE
  7161     END-IF.
  7162
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 134
* EL130.cbl
  7163     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7164         GO TO 0640-FROM-EL132
  7165     END-IF.
  7166
  7167     GO TO 8100-SEND-INITIAL-MAP.
  7168
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 135
* EL130.cbl
  7170 0200-RECEIVE.
  7171     MOVE LOW-VALUES             TO EL130AI.
  7172
  7173     IF PI-PROCESSOR-ID = 'LGXX'
  7174*        NEXT SENTENCE
  7175         CONTINUE
  7176     ELSE
  7177
  7178* EXEC CICS READQ TS
  7179*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7180*            INTO    (SECURITY-CONTROL)
  7181*            LENGTH  (SC-COMM-LENGTH)
  7182*            ITEM    (SC-ITEM)
  7183*        END-EXEC
  7184*    MOVE '*$II   L              ''   #00007155' TO DFHEIV0
  7185     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7186     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7187     MOVE X'2020233030303037313535' TO DFHEIV0(25:11)
  7188     CALL 'kxdfhei1' USING DFHEIV0,
  7189           PI-SECURITY-TEMP-STORE-ID,
  7190           SECURITY-CONTROL,
  7191           SC-COMM-LENGTH,
  7192           SC-ITEM,
  7193           DFHEIV99,
  7194           DFHEIV99
  7195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7196         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7197         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7198         IF NOT DISPLAY-CAP
  7199             MOVE 'READ'              TO  SM-READ
  7200             PERFORM 9995-SECURITY-VIOLATION
  7201             MOVE ER-0070             TO  EMI-ERROR
  7202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7203             GO TO 8100-SEND-INITIAL-MAP
  7204         END-IF
  7205     END-IF.
  7206
  7207     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7208         MOVE ER-7008 TO EMI-ERROR
  7209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7210         MOVE -1 TO MAINTL
  7211         GO TO 8200-SEND-DATAONLY
  7212     END-IF.
  7213
  7214
  7215
  7216* EXEC CICS RECEIVE
  7217*         MAP     (MAP-NAME)
  7218*         MAPSET  (MAPSET-NAME)
  7219*         INTO    (EL130AI)
  7220*    END-EXEC.
  7221     MOVE LENGTH OF
  7222      EL130AI
  7223       TO DFHEIV11
  7224*    MOVE '8"T I  L              ''   #00007180' TO DFHEIV0
  7225     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7226     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7227     MOVE X'2020233030303037313830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 136
* EL130.cbl
  7228     CALL 'kxdfhei1' USING DFHEIV0,
  7229           MAP-NAME,
  7230           EL130AI,
  7231           DFHEIV11,
  7232           MAPSET-NAME,
  7233           DFHEIV99,
  7234           DFHEIV99
  7235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7236
  7237
  7238     IF NOT PI-NO-CARRIER-SECURITY
  7239        MOVE +1                  TO CLMCARRL
  7240        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7241     END-IF.
  7242
  7243     IF ENTERPFL = ZERO
  7244         GO TO 0300-CHECK-PFKEYS
  7245     END-IF.
  7246
  7247     IF EIBAID NOT = DFHENTER
  7248         MOVE ER-0004            TO EMI-ERROR
  7249         GO TO 0320-INPUT-ERROR
  7250     END-IF.
  7251
  7252     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7253         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7254     ELSE
  7255         MOVE ER-0029            TO EMI-ERROR
  7256         GO TO 0320-INPUT-ERROR
  7257     END-IF.
  7258
  7259 0300-CHECK-PFKEYS.
  7260     IF EIBAID = DFHPF23
  7261         GO TO 8810-PF23
  7262     END-IF.
  7263
  7264     IF EIBAID = DFHPF24
  7265         GO TO 9200-RETURN-MAIN-MENU
  7266     END-IF.
  7267
  7268     IF EIBAID = DFHPF12
  7269         GO TO 9500-PF12
  7270     END-IF.
  7271
  7272     IF EIBAID = DFHPF3
  7273         MOVE SPACES              TO MAINTI
  7274         MOVE ZEROS               TO MAINTL
  7275         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7276         MOVE XCTL-127            TO PGM-NAME
  7277         GO TO 9300-XCTL
  7278     END-IF.
  7279
  7280     IF EIBAID = DFHPF4
  7281         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7282         MOVE XCTL-132            TO PGM-NAME
  7283         GO TO 9300-XCTL
  7284     END-IF.
  7285
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 137
* EL130.cbl
  7286     IF EIBAID = DFHPF13
  7287         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7288             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7289             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7290             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7291             MOVE PI-STATE            TO  PI-CR-STATE
  7292             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7293             MOVE XCTL-650            TO  PGM-NAME
  7294             GO TO 9300-XCTL
  7295         ELSE
  7296             MOVE -1                  TO  ENTERPFL
  7297             MOVE ER-2566             TO  EMI-ERROR
  7298             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7299             GO TO 8100-SEND-INITIAL-MAP
  7300         END-IF
  7301     END-IF.
  7302
  7303     IF EIBAID = DFHPF5
  7304         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7305             ADD +1 TO PI-CERT-PROCESSED
  7306             GO TO 0650-FROM-EL127
  7307         ELSE
  7308             MOVE ER-7686         TO EMI-ERROR
  7309             GO TO 0320-INPUT-ERROR
  7310         END-IF
  7311     END-IF.
  7312
  7313     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7314         GO TO 0800-TEST-PREVIOUS-CONTROL
  7315     END-IF.
  7316
  7317     IF PI-HAS-CLAS-IC-CRDTCRD
  7318         IF EIBAID = DFHPF10
  7319             MOVE XCTL-725          TO PGM-NAME
  7320             GO TO 9300-XCTL
  7321         END-IF
  7322     END-IF.
  7323
  7324     IF EIBAID = DFHPF14
  7325         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7326         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7327         MOVE XCTL-659            TO PGM-NAME
  7328         GO TO 9300-XCTL
  7329     END-IF.
  7330
  7331     IF EIBAID = DFHPF15
  7332         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7333         MOVE XCTL-114            TO PGM-NAME
  7334         GO TO 9300-XCTL
  7335     END-IF.
  7336
  7337     IF EIBAID = DFHPF11
  7338        GO TO 0600-RECOVER-TEMP-STORAGE
  7339     END-IF
  7340     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7341         GO TO 0330-EDIT-DATA
  7342     END-IF.
  7343
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 138
* EL130.cbl
  7344     MOVE ER-0029                TO EMI-ERROR.
  7345
  7346 0320-INPUT-ERROR.
  7347     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7348
  7349     MOVE AL-UNBON               TO ENTERPFA.
  7350
  7351     IF ENTERPFL = ZERO
  7352         MOVE -1                 TO MAINTL
  7353     ELSE
  7354         MOVE -1                 TO ENTERPFL
  7355     END-IF.
  7356
  7357     GO TO 8200-SEND-DATAONLY.
  7358
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 139
* EL130.cbl
  7360 0330-EDIT-DATA.
  7361
  7362     IF MAINTI = 'S'
  7363         IF PRTOPTL GREATER THAN 0
  7364             IF PRTOPTI NOT = 'N' AND 'L'
  7365                 MOVE AL-UABON   TO  PRTOPTA
  7366                 MOVE -1         TO  PRTOPTL
  7367                 MOVE ER-0334    TO  EMI-ERROR
  7368                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7369                 GO TO 8200-SEND-DATAONLY
  7370             ELSE
  7371                 IF PRTOPTI = 'L'
  7372                     GO TO 0400-CREATE-ELACTQ
  7373                 ELSE
  7374                     GO TO 0480-PRINT-NOW
  7375                 END-IF
  7376             END-IF
  7377         ELSE
  7378             GO TO 1000-SHOW-CLAIM
  7379         END-IF
  7380     END-IF.
  7381
  7382     IF NOT MODIFY-CAP
  7383         MOVE 'UPDATE'       TO  SM-READ
  7384         PERFORM 9995-SECURITY-VIOLATION
  7385         MOVE ER-0070        TO  EMI-ERROR
  7386         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7387         GO TO 8100-SEND-INITIAL-MAP
  7388     END-IF.
  7389
  7390     IF MAINTI = 'D'
  7391         GO TO 2000-DELETE-CLAIM
  7392     END-IF.
  7393
  7394     IF MAINTI = 'A'
  7395         GO TO 3000-ADD-CLAIM
  7396     END-IF.
  7397
  7398     IF MAINTI = 'I'
  7399         GO TO 5000-INCURRED-CHANGE
  7400     END-IF.
  7401
  7402     MOVE ER-0023                TO EMI-ERROR.
  7403     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7404     MOVE -1                     TO MAINTL.
  7405     MOVE AL-UABON               TO MAINTA.
  7406
  7407     GO TO 8200-SEND-DATAONLY.
  7408
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 140
* EL130.cbl
  7410 0400-CREATE-ELACTQ.
  7411     IF CLMNOI   = PI-LAST-CLAIM      AND
  7412        CLMCARRI = PI-LAST-CARR       AND
  7413        CERTNOI  = PI-LAST-CERT-PRIME AND
  7414        SUFXI    = PI-LAST-CERT-SUFX
  7415         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7416         MOVE PI-LAST-CARR       TO PI-CARRIER
  7417         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7418     ELSE
  7419         MOVE ER-0207            TO EMI-ERROR
  7420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7421         MOVE -1                 TO MAINTL
  7422         GO TO 8200-SEND-DATAONLY
  7423     END-IF.
  7424
  7425     IF (NOT PI-NO-CARRIER-SECURITY OR
  7426         NOT PI-NO-ACCOUNT-SECURITY)
  7427         MOVE AL-UABON      TO  PRTOPTA
  7428         MOVE -1            TO  PRTOPTL
  7429         MOVE ER-2378       TO  EMI-ERROR
  7430         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7431         GO TO 8200-SEND-DATAONLY
  7432     END-IF.
  7433
  7434     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7435     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7436     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7437     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7438
  7439
  7440
  7441* EXEC CICS HANDLE CONDITION
  7442*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7443*    END-EXEC.
  7444*    MOVE '"$I                   ! # #00007388' TO DFHEIV0
  7445     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7447     MOVE X'2320233030303037333838' TO DFHEIV0(25:11)
  7448     CALL 'kxdfhei1' USING DFHEIV0
  7449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7450
  7451
  7452
  7453
  7454* EXEC CICS READ
  7455*         UPDATE
  7456*         DATASET    (ELACTQ-DSID)
  7457*         SET        (ADDRESS OF ACTIVITY-QUE)
  7458*         RIDFLD     (ELACTQ-KEY)
  7459*    END-EXEC.
  7460*    MOVE '&"S        EU         (   #00007393' TO DFHEIV0
  7461     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7462     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7463     MOVE X'2020233030303037333933' TO DFHEIV0(25:11)
  7464     CALL 'kxdfhei1' USING DFHEIV0,
  7465           ELACTQ-DSID,
  7466           DFHEIV20,
  7467           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 141
* EL130.cbl
  7468           ELACTQ-KEY,
  7469           DFHEIV99,
  7470           DFHEIV99,
  7471           DFHEIV99
  7472     SET ADDRESS OF ACTIVITY-QUE TO
  7473         DFHEIV20
  7474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7475
  7476
  7477     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7478     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7479
  7480
  7481
  7482* EXEC CICS REWRITE
  7483*         DATASET     (ELACTQ-DSID)
  7484*         FROM        (ACTIVITY-QUE)
  7485*    END-EXEC.
  7486     MOVE LENGTH OF
  7487      ACTIVITY-QUE
  7488       TO DFHEIV11
  7489*    MOVE '&& L                  %   #00007404' TO DFHEIV0
  7490     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7491     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7492     MOVE X'2020233030303037343034' TO DFHEIV0(25:11)
  7493     CALL 'kxdfhei1' USING DFHEIV0,
  7494           ELACTQ-DSID,
  7495           ACTIVITY-QUE,
  7496           DFHEIV11,
  7497           DFHEIV99
  7498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7499
  7500
  7501     GO TO 0470-STATUS-FINISH.
  7502
  7503 0450-ADD-ELACTQ-RECORD.
  7504
  7505
  7506* EXEC CICS GETMAIN
  7507*        SET     (ADDRESS OF ACTIVITY-QUE)
  7508*        LENGTH  (ELACTQ-LENGTH)
  7509*        INITIMG (GETMAIN-SPACE)
  7510*    END-EXEC.
  7511*    MOVE ',"IL                  $   #00007413' TO DFHEIV0
  7512     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7514     MOVE X'2020233030303037343133' TO DFHEIV0(25:11)
  7515     CALL 'kxdfhei1' USING DFHEIV0,
  7516           DFHEIV20,
  7517           ELACTQ-LENGTH,
  7518           GETMAIN-SPACE
  7519     SET ADDRESS OF ACTIVITY-QUE TO
  7520         DFHEIV20
  7521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7522
  7523
  7524     MOVE 'AQ'              TO AQ-RECORD-ID.
  7525     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 142
* EL130.cbl
  7526     MOVE +0                TO AQ-PAYMENT-COUNTER
  7527                               AQ-PMT-UNAPPROVED-COUNT.
  7528     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7529                               AQ-FOLLOWUP-DATE.
  7530     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7531     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7532
  7533
  7534
  7535* EXEC CICS WRITE
  7536*         DATASET     (ELACTQ-DSID)
  7537*         FROM        (ACTIVITY-QUE)
  7538*         RIDFLD      (ELACTQ-KEY)
  7539*    END-EXEC.
  7540     MOVE LENGTH OF
  7541      ACTIVITY-QUE
  7542       TO DFHEIV11
  7543*    MOVE '&$ L                  ''   #00007429' TO DFHEIV0
  7544     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7545     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7546     MOVE X'2020233030303037343239' TO DFHEIV0(25:11)
  7547     CALL 'kxdfhei1' USING DFHEIV0,
  7548           ELACTQ-DSID,
  7549           ACTIVITY-QUE,
  7550           DFHEIV11,
  7551           ELACTQ-KEY,
  7552           DFHEIV99,
  7553           DFHEIV99
  7554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7555
  7556
  7557 0470-STATUS-FINISH.
  7558     MOVE AL-UANOF               TO  PRTOPTA
  7559                                     ALTPRTA.
  7560
  7561     MOVE SPACES                 TO  PRTOPTO
  7562                                     ALTPRTO.
  7563
  7564     MOVE ER-0000                TO EMI-ERROR.
  7565     MOVE -1                     TO MAINTL.
  7566     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7567     GO TO 8100-SEND-INITIAL-MAP.
  7568
  7569 0480-PRINT-NOW.
  7570
  7571
  7572* EXEC CICS HANDLE CONDITION
  7573*        TERMIDERR   (8820-TERM-ERROR)
  7574*        TRANSIDERR  (8830-TRAN-ERROR)
  7575*    END-EXEC.
  7576*    MOVE '"$[\                  ! $ #00007449' TO DFHEIV0
  7577     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7579     MOVE X'2420233030303037343439' TO DFHEIV0(25:11)
  7580     CALL 'kxdfhei1' USING DFHEIV0
  7581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7582
  7583
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 143
* EL130.cbl
  7584     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7585     MOVE '1'                    TO  CNTL-REC-TYPE.
  7586     MOVE SPACES                 TO  CNTL-ACCESS.
  7587     MOVE +0                     TO  CNTL-SEQ-NO.
  7588     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7589
  7590     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7591
  7592     IF CF-FORMS-PRINTER-ID = SPACES
  7593         IF ALTPRTL NOT GREATER THAN 0
  7594             MOVE ER-0337        TO  EMI-ERROR
  7595             MOVE -1             TO  ALTPRTL
  7596             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7597             GO TO 8200-SEND-DATAONLY
  7598         END-IF
  7599     END-IF.
  7600
  7601     IF ALTPRTL GREATER THAN 0
  7602         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7603     END-IF.
  7604
  7605     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7606     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7607     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7608
  7609
  7610
  7611* EXEC CICS START
  7612*        TRANSID   (START-TRANS-ID)
  7613*        TERMID    (CF-FORMS-PRINTER-ID)
  7614*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7615*        LENGTH    (PI-COMM-LENGTH)
  7616*    END-EXEC.
  7617*    MOVE '0( LFT                1   #00007480' TO DFHEIV0
  7618     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7619     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7620     MOVE X'2020233030303037343830' TO DFHEIV0(25:11)
  7621     CALL 'kxdfhei1' USING DFHEIV0,
  7622           DFHEIV99,
  7623           START-TRANS-ID,
  7624           DFHEIV99,
  7625           PROGRAM-INTERFACE-BLOCK,
  7626           PI-COMM-LENGTH,
  7627           CF-FORMS-PRINTER-ID,
  7628           DFHEIV99,
  7629           DFHEIV99,
  7630           DFHEIV99,
  7631           DFHEIV99,
  7632           DFHEIV99,
  7633           DFHEIV99,
  7634           DFHEIV99,
  7635           DFHEIV99,
  7636           DFHEIV99,
  7637           DFHEIV99
  7638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7639
  7640
  7641     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 144
* EL130.cbl
  7642                                     ALTPRTA.
  7643
  7644     MOVE SPACES                 TO  PRTOPTO
  7645                                     ALTPRTO.
  7646
  7647     MOVE ER-0000                TO  EMI-ERROR.
  7648     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7649     MOVE -1                     TO  MAINTL.
  7650     GO TO 8100-SEND-INITIAL-MAP.
  7651
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 145
* EL130.cbl
  7653 0500-CREATE-TEMP-STORAGE.
  7654     MOVE EIBCPOSN               TO PI-CURSOR.
  7655
  7656    move emi-line1               to errmsg1o
  7657    move emi-line2               to errmsg2o
  7658    move emi-sub                 to pi-emi-sub
  7659
  7660
  7661* EXEC CICS WRITEQ TS
  7662*        QUEUE   (QID)
  7663*        FROM    (EL130AI)
  7664*        LENGTH  (QID-MAP-LENGTH)
  7665*    END-EXEC.
  7666*    MOVE '*"                    ''   #00007506' TO DFHEIV0
  7667     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7669     MOVE X'2020233030303037353036' TO DFHEIV0(25:11)
  7670     CALL 'kxdfhei1' USING DFHEIV0,
  7671           QID,
  7672           EL130AI,
  7673           QID-MAP-LENGTH,
  7674           DFHEIV99,
  7675           DFHEIV99,
  7676           DFHEIV99
  7677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7678
  7679
  7680
  7681
  7682* EXEC CICS WRITEQ TS
  7683*        QUEUE    (QID)
  7684*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7685*        LENGTH   (PI-COMM-LENGTH)
  7686*    END-EXEC.
  7687*    MOVE '*"                    ''   #00007513' TO DFHEIV0
  7688     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7689     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7690     MOVE X'2020233030303037353133' TO DFHEIV0(25:11)
  7691     CALL 'kxdfhei1' USING DFHEIV0,
  7692           QID,
  7693           PROGRAM-INTERFACE-BLOCK,
  7694           PI-COMM-LENGTH,
  7695           DFHEIV99,
  7696           DFHEIV99,
  7697           DFHEIV99
  7698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7699
  7700
  7701 0599-EXIT.
  7702      EXIT.
  7703
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 146
* EL130.cbl
  7705 0600-RECOVER-TEMP-STORAGE.
  7706     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7707     MOVE PI-EL127-TO-EL130-CNTRL
  7708                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7709     MOVE PI-EL659-TO-EL130-CNTRL
  7710                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7711     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7712     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7713     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7714     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7715     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7716     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7717     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7718     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7719     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7720     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7721     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7722     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7723     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7724     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7725     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7726     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7727                                 TO SAVE-BENEFICIARY
  7728
  7729
  7730
  7731* EXEC CICS HANDLE CONDITION
  7732*        NOTFND  (0660-NOT-FOUND)
  7733*        QIDERR  (0670-QIDERR)
  7734*    END-EXEC.
  7735*    MOVE '"$IN                  ! % #00007548' TO DFHEIV0
  7736     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7738     MOVE X'2520233030303037353438' TO DFHEIV0(25:11)
  7739     CALL 'kxdfhei1' USING DFHEIV0
  7740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7741
  7742
  7743
  7744
  7745* EXEC CICS READQ TS
  7746*        QUEUE    (QID)
  7747*        INTO     (EL130AI)
  7748*        LENGTH   (QID-MAP-LENGTH)
  7749*    END-EXEC.
  7750*    MOVE '*$I    L              ''   #00007554' TO DFHEIV0
  7751     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7752     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7753     MOVE X'2020233030303037353534' TO DFHEIV0(25:11)
  7754     CALL 'kxdfhei1' USING DFHEIV0,
  7755           QID,
  7756           EL130AI,
  7757           QID-MAP-LENGTH,
  7758           DFHEIV99,
  7759           DFHEIV99,
  7760           DFHEIV99
  7761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7762
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 147
* EL130.cbl
  7763
  7764     IF RETURNED-FROM = XCTL-131
  7765        IF CLAIM-DELETED-BY-EL131
  7766            MOVE LOW-VALUES      TO CERTNOI
  7767                                    SUFXI
  7768            MOVE ZEROS           TO CERTNOL
  7769                                    SUFXL
  7770         END-IF
  7771     END-IF.
  7772
  7773     IF RETURNED-FROM = XCTL-131
  7774         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7775         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7776                                    PI-CERT-PROCESSED
  7777     ELSE
  7778
  7779
  7780* EXEC CICS READQ TS
  7781*             QUEUE   (QID)
  7782*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7783*             LENGTH  (PI-COMM-LENGTH)
  7784*        END-EXEC
  7785*    MOVE '*$I    L              ''   #00007575' TO DFHEIV0
  7786     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7787     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7788     MOVE X'2020233030303037353735' TO DFHEIV0(25:11)
  7789     CALL 'kxdfhei1' USING DFHEIV0,
  7790           QID,
  7791           PROGRAM-INTERFACE-BLOCK,
  7792           PI-COMM-LENGTH,
  7793           DFHEIV99,
  7794           DFHEIV99,
  7795           DFHEIV99
  7796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7797     END-IF.
  7798
  7799
  7800* EXEC CICS DELETEQ TS
  7801*        QUEUE   (QID)
  7802*    END-EXEC.
  7803*    MOVE '*&                    #   #00007582' TO DFHEIV0
  7804     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7805     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7806     MOVE X'2020233030303037353832' TO DFHEIV0(25:11)
  7807     CALL 'kxdfhei1' USING DFHEIV0,
  7808           QID,
  7809           DFHEIV99
  7810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7811
  7812
  7813     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7814
  7815     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7816         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7817         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7818         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7819         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7820         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 148
* EL130.cbl
  7821         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7822         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7823         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7824         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7825         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7826         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7827         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7828         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7829         MOVE SAVE-CERT-ACCESS-CONTROL
  7830                                    TO PI-CERT-ACCESS-CONTROL
  7831         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7832                                    TO PI-CARRIER-CONTROL-LEVEL
  7833     END-IF.
  7834
  7835     IF EIBAID = DFHPF11
  7836        move errmsg1i            to emi-line1
  7837        move errmsg2i            to emi-line2
  7838        move pi-emi-sub          to emi-sub
  7839        go to 8200-SEND-DATAONLY
  7840     end-if
  7841     IF RETURNED-FROM = XCTL-127
  7842         MOVE SAVE-EL127-TO-EL130-CNTRL
  7843                                 TO PI-EL127-TO-EL130-CNTRL
  7844     END-IF.
  7845
  7846     IF RETURNED-FROM = XCTL-6592
  7847        MOVE SAVE-EL659-TO-EL130-CNTRL
  7848                                 TO PI-EL659-TO-EL130-CNTRL
  7849     END-IF.
  7850
  7851     IF RETURNED-FROM = XCTL-114
  7852        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7853           MOVE SAVE-BENEFICIARY TO BENECDI
  7854           MOVE +10              TO BENECDL
  7855           MOVE -1               TO BIRTHDTL
  7856        END-IF
  7857     END-IF.
  7858     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7859
  7860     IF MAINTL NOT = ZERO
  7861         MOVE AL-UANON           TO MAINTA
  7862     END-IF.
  7863
  7864     IF ENTERPFL NOT = ZERO
  7865         MOVE AL-UNNON           TO ENTERPFA
  7866     END-IF.
  7867
  7868     IF RETURNED-FROM = XCTL-127
  7869         GO TO 0650-FROM-EL127
  7870     END-IF.
  7871
  7872     IF RETURNED-FROM = XCTL-132
  7873         GO TO 0640-FROM-EL132
  7874     END-IF.
  7875
  7876     IF RETURNED-FROM = XCTL-650
  7877         MOVE AL-SABON           TO PF5A
  7878         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 149
* EL130.cbl
  7879     END-IF.
  7880
  7881     IF RETURNED-FROM = XCTL-6592
  7882         GO TO 0630-FROM-EL6592
  7883     END-IF.
  7884
  7885     IF MAINTI = 'S' OR 'I'
  7886        GO TO 1000-SHOW-CLAIM
  7887     END-IF.
  7888
  7889     GO TO 8100-SEND-INITIAL-MAP.
  7890
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 150
* EL130.cbl
  7892 0630-FROM-EL6592.
  7893     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7894     MOVE PI-EL659-GROUPING      TO GROUPO.
  7895     MOVE PI-EL659-STATE         TO STATEO.
  7896     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7897
  7898     MOVE AL-UANON               TO CRTCARRA
  7899                                    GROUPA
  7900                                    STATEA
  7901                                    ACCOUNTA.
  7902     GO TO 8100-SEND-INITIAL-MAP.
  7903
  7904 0640-FROM-EL132.
  7905     IF PI-CLAIM-NO = SPACES
  7906         GO TO 0645-NO-CLAIM-SELECTED
  7907     END-IF.
  7908
  7909     MOVE LOW-VALUES             TO EL130AI.
  7910     MOVE 'MSTR'                 TO FILE-SWITCH.
  7911     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7912     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7913     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7914                                    CLMNOO.
  7915     MOVE AL-UANON               TO CLMNOA.
  7916     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7917
  7918
  7919
  7920* EXEC CICS HANDLE CONDITION
  7921*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7922*    END-EXEC.
  7923*    MOVE '"$I                   ! & #00007692' TO DFHEIV0
  7924     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7926     MOVE X'2620233030303037363932' TO DFHEIV0(25:11)
  7927     CALL 'kxdfhei1' USING DFHEIV0
  7928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7929
  7930
  7931     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7932     MOVE 'X'                    TO CLAIM-SWITCH.
  7933     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7934     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7935     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  7936     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  7937     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7938     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7939
  7940     MOVE ER-0213                TO EMI-ERROR.
  7941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7942     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7943     GO TO 8100-SEND-INITIAL-MAP.
  7944
  7945 0645-NO-CLAIM-SELECTED.
  7946
  7947     IF MAINTI = 'S' OR 'I'
  7948        GO TO 1000-SHOW-CLAIM
  7949     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 151
* EL130.cbl
  7950
  7951     GO TO 8100-SEND-INITIAL-MAP.
  7952
  7953 0650-FROM-EL127.
  7954
  7955     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7956         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7957                                    PI-CERT-PROCESSED
  7958     END-IF.
  7959
  7960     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7961         MOVE +1                 TO PI-CERT-SELECT-CNT
  7962                                    PI-CERT-PROCESSED
  7963         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7964         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7965         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7966         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7967         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7968         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7969     END-IF.
  7970
  7971     IF PI-CERT-SELECT-CNT = ZERO
  7972         IF CERTNOI NOT = SPACES AND LOW-VALUES
  7973             MOVE CERTNOI        TO PI-CERT-NO
  7974             MOVE SUFXI          TO PI-CERT-SFX
  7975             GO TO 3000-READ-CERT
  7976         ELSE
  7977             GO TO 8100-SEND-INITIAL-MAP
  7978         END-IF
  7979     END-IF.
  7980
  7981     MOVE AL-SABON               TO PF5A.
  7982
  7983     IF PI-CERT-PROCESSED = 1
  7984         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  7985     END-IF.
  7986
  7987     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  7988     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  7989
  7990     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  7991     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  7992                                 TO CERT-CARRIER
  7993                                    PI-CARRIER.
  7994     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  7995                                 TO CERT-GROUPING
  7996                                    PI-GROUPING.
  7997     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  7998                                 TO CERT-STATE
  7999                                    PI-STATE.
  8000     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8001                                 TO CERT-ACCOUNT
  8002                                    PI-ACCOUNT.
  8003     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8004                                 TO CERT-EFF-DT
  8005                                    PI-CERT-EFF-DT.
  8006     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8007                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 152
* EL130.cbl
  8008                                    PI-CERT-NO.
  8009
  8010     MOVE 'CERT'                 TO FILE-SWITCH.
  8011     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8012
  8013     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8014     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8015     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8016
  8017     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8018         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8019         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8020         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8021         IF INCURRED-DATE-MATCH
  8022             MOVE ER-7352        TO EMI-ERROR
  8023             MOVE -1             TO CERTNOL
  8024             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8025         ELSE
  8026             IF NO-CLAIMS-FOR-CERT
  8027                 MOVE ER-7353    TO EMI-ERROR
  8028                 MOVE -1         TO CERTNOL
  8029                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8030             ELSE
  8031                 MOVE ER-0558    TO EMI-ERROR
  8032                 MOVE -1         TO CERTNOL
  8033                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8034             END-IF
  8035         END-IF
  8036     END-IF.
  8037
  8038     MOVE SPACES                 TO PI-PRT-OPT
  8039                                    PI-ALT-PRT.
  8040
  8041     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8042
  8043     IF LSTNMEL NOT GREATER ZERO
  8044        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8045         MOVE CRTLNMEI           TO  LSTNMEO
  8046         MOVE CRTFNMEI           TO  FSTNMEO
  8047         MOVE CRTINITI           TO  INITO
  8048         MOVE AL-UANON           TO  LSTNMEA
  8049                                     FSTNMEA
  8050                                     INITA
  8051     END-IF.
  8052
  8053     IF SSNL GREATER ZERO
  8054         GO TO 0655-SKIP-SOCIAL-SECURITY
  8055     END-IF.
  8056
  8057     IF CRTSSNI = SPACES OR LOW-VALUES
  8058         GO TO 0655-SKIP-SOCIAL-SECURITY
  8059     END-IF.
  8060
  8061     IF CM-SSN-STATE   = CM-STATE AND
  8062        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8063            GO TO 0655-SKIP-SOCIAL-SECURITY
  8064     END-IF.
  8065
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 153
* EL130.cbl
  8066     MOVE CRTSSNI                TO SSNO
  8067     MOVE AL-UANON               TO SSNA.
  8068
  8069 0655-SKIP-SOCIAL-SECURITY.
  8070
  8071     IF CLMCARRL NOT = ZERO  AND
  8072        CLMCARRI NOT = CRTCARRI
  8073        MOVE ER-0562             TO EMI-ERROR
  8074        MOVE AL-UABON            TO CLMCARRA
  8075        MOVE -1                  TO CLMCARRL
  8076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8077     END-IF.
  8078
  8079     IF CLMCARRL = ZERO
  8080        MOVE AL-UANON            TO CLMCARRA
  8081        MOVE CRTCARRI            TO CLMCARRI
  8082     END-IF.
  8083
  8084     MOVE 'A'                    TO MAINTO.
  8085     MOVE AL-UANON               TO MAINTA.
  8086
  8087     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8088        GO TO 8100-SEND-INITIAL-MAP
  8089     ELSE
  8090        GO TO 8150-SEND-MAP-CURSOR
  8091     END-IF.
  8092
  8093 0660-NOT-FOUND.
  8094     MOVE ER-0214                TO EMI-ERROR.
  8095     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8096     GO TO 8100-SEND-INITIAL-MAP.
  8097
  8098 0670-QIDERR.
  8099     MOVE ER-0033                TO EMI-ERROR.
  8100     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8101     GO TO 8100-SEND-INITIAL-MAP.
  8102
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 154
* EL130.cbl
  8104 0680-PLUG-SELECTED-CERTS.
  8105
  8106     MOVE AL-SANON               TO BCERT1A
  8107                                    BSUFX1A
  8108                                    BCERT2A
  8109                                    BSUFX2A
  8110                                    BCERT3A
  8111                                    BSUFX3A
  8112                                    BCERT4A
  8113                                    BSUFX4A
  8114                                    BCERT5A
  8115                                    BSUFX5A.
  8116
  8117     IF PCERTNOO = SPACES OR LOW-VALUES
  8118         MOVE PI-EL127-CERT-PRIME (1)
  8119                                 TO PCERTNOO
  8120         MOVE PI-EL127-CERT-SUFX  (1)
  8121                                 TO PSUFXO
  8122     END-IF.
  8123
  8124     MOVE PI-EL127-CERT-PRIME (1)
  8125                                 TO BCERT1O.
  8126     MOVE PI-EL127-CERT-SUFX  (1)
  8127                                 TO BSUFX1O.
  8128
  8129     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8130         MOVE PI-EL127-CERT-PRIME (2)
  8131                                 TO BCERT2O
  8132         MOVE PI-EL127-CERT-SUFX  (2)
  8133                                 TO BSUFX2O
  8134     ELSE
  8135         MOVE LOW-VALUES         TO BCERT2O
  8136                                    BSUFX2O
  8137     END-IF.
  8138
  8139     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8140         MOVE PI-EL127-CERT-PRIME (3)
  8141                                 TO BCERT3O
  8142         MOVE PI-EL127-CERT-SUFX  (3)
  8143                                 TO BSUFX3O
  8144     ELSE
  8145         MOVE LOW-VALUES         TO BCERT3O
  8146                                    BSUFX3O
  8147     END-IF.
  8148
  8149     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8150         MOVE PI-EL127-CERT-PRIME (4)
  8151                                 TO BCERT4O
  8152         MOVE PI-EL127-CERT-SUFX  (4)
  8153                                 TO BSUFX4O
  8154     ELSE
  8155         MOVE LOW-VALUES         TO BCERT4O
  8156                                    BSUFX4O
  8157     END-IF.
  8158
  8159     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8160         MOVE PI-EL127-CERT-PRIME (5)
  8161                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 155
* EL130.cbl
  8162         MOVE PI-EL127-CERT-SUFX  (5)
  8163                                 TO BSUFX5O
  8164     ELSE
  8165         MOVE LOW-VALUES         TO BCERT5O
  8166                                    BSUFX5O
  8167     END-IF.
  8168
  8169 0680-EXIT.
  8170     EXIT.
  8171
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 156
* EL130.cbl
  8173 0690-HIGHLIGHT-CERTS.
  8174
  8175     MOVE AL-UANON               TO PCERTNOA
  8176                                    PSUFXA.
  8177
  8178     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8179        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8180            MOVE AL-SABON        TO BCERT1A
  8181                                    BSUFX1A
  8182     ELSE
  8183         MOVE AL-SANON           TO BCERT1A
  8184                                    BSUFX1A
  8185     END-IF.
  8186
  8187     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8188        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8189            MOVE AL-SABON        TO BCERT2A
  8190                                    BSUFX2A
  8191     ELSE
  8192         MOVE AL-SANON           TO BCERT2A
  8193                                    BSUFX2A
  8194     END-IF.
  8195
  8196     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8197        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8198            MOVE AL-SABON        TO BCERT3A
  8199                                    BSUFX3A
  8200     ELSE
  8201         MOVE AL-SANON           TO BCERT3A
  8202                                    BSUFX3A
  8203     END-IF.
  8204
  8205     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8206        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8207            MOVE AL-SABON        TO BCERT4A
  8208                                    BSUFX4A
  8209     ELSE
  8210         MOVE AL-SANON           TO BCERT4A
  8211                                    BSUFX4A
  8212     END-IF.
  8213
  8214     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8215        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8216            MOVE AL-SABON        TO BCERT5A
  8217                                    BSUFX5A
  8218     ELSE
  8219         MOVE AL-SANON           TO BCERT5A
  8220                                    BSUFX5A
  8221     END-IF.
  8222
  8223 0690-EXIT.
  8224     EXIT.
  8225
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 157
* EL130.cbl
  8227 0800-TEST-PREVIOUS-CONTROL.
  8228     IF CLMNOI   = PI-LAST-CLAIM       AND
  8229        CLMCARRI = PI-LAST-CARR        AND
  8230        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8231        SUFXI    = PI-LAST-CERT-SUFX
  8232*        NEXT SENTENCE
  8233         CONTINUE
  8234     ELSE
  8235         MOVE ER-0207            TO EMI-ERROR
  8236         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8237         MOVE -1                 TO MAINTL
  8238         GO TO 8200-SEND-DATAONLY
  8239     END-IF.
  8240
  8241     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8242
  8243     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8244     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8245     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8246
  8247     IF EIBAID = DFHPF7
  8248         MOVE XCTL-157           TO PGM-NAME
  8249     END-IF.
  8250
  8251     IF EIBAID = DFHPF8
  8252         MOVE XCTL-141           TO PGM-NAME
  8253     END-IF.
  8254
  8255     IF EIBAID = DFHPF9
  8256        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8257                                    PI-SAVED-PROGRAM-2
  8258                                    PI-SAVED-PROGRAM-3
  8259                                    PI-SAVED-PROGRAM-4
  8260                                    PI-SAVED-PROGRAM-5
  8261                                    PI-SAVED-PROGRAM-6
  8262        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8263        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8264        MOVE XCTL-150            TO PGM-NAME
  8265     END-IF.
  8266
  8267     GO TO 9300-XCTL.
  8268
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 158
* EL130.cbl
  8270 1000-SHOW-CLAIM.
  8271
  8272     IF CLMNOL = ZERO
  8273         MOVE -1                 TO CLMNOL
  8274         MOVE AL-UABON           TO CLMNOA
  8275         MOVE ER-0202            TO EMI-ERROR
  8276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8277     ELSE
  8278         MOVE AL-UANON           TO CLMNOA
  8279     END-IF.
  8280
  8281     IF PI-NO-CARRIER-SECURITY
  8282        IF CLMCARRL = ZERO
  8283             MOVE -1             TO CLMCARRL
  8284             MOVE AL-UABON       TO CLMCARRA
  8285             MOVE ER-0194        TO EMI-ERROR
  8286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8287         ELSE
  8288             MOVE AL-UANON       TO CLMCARRA
  8289         END-IF
  8290     END-IF.
  8291
  8292     IF SUFXL = ZERO
  8293         MOVE SPACES             TO SUFXI
  8294         MOVE AL-UANON           TO SUFXA
  8295     ELSE
  8296         MOVE AL-UANON           TO SUFXA
  8297     END-IF.
  8298
  8299     IF NOT EMI-NO-ERRORS
  8300         GO TO 1050-SEND-CHECK
  8301     END-IF.
  8302
  8303
  8304
  8305* EXEC CICS HANDLE CONDITION
  8306*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8307*    END-EXEC.
  8308*    MOVE '"$I                   ! '' #00008069' TO DFHEIV0
  8309     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8311     MOVE X'2720233030303038303639' TO DFHEIV0(25:11)
  8312     CALL 'kxdfhei1' USING DFHEIV0
  8313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8314
  8315
  8316     MOVE 'MSTR'                 TO FILE-SWITCH
  8317     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8318
  8319     MOVE CLMCARRI               TO MSTR-CARRIER.
  8320     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8321
  8322     IF CERTNOL = ZERO     OR
  8323        CERTNOI = SPACES   OR
  8324        CERTNOI = LOW-VALUES
  8325         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8326         MOVE AL-SANON        TO CERTNOA
  8327                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 159
* EL130.cbl
  8328     ELSE
  8329         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8330     END-IF.
  8331
  8332     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8333     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8334
  8335
  8336
  8337* EXEC CICS HANDLE CONDITION
  8338*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8339*    END-EXEC.
  8340*    MOVE '"$I                   ! ( #00008093' TO DFHEIV0
  8341     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8343     MOVE X'2820233030303038303933' TO DFHEIV0(25:11)
  8344     CALL 'kxdfhei1' USING DFHEIV0
  8345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8346
  8347
  8348     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8349
  8350     IF NOT PI-NO-ACCOUNT-SECURITY
  8351         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8352           MOVE ER-2371          TO EMI-ERROR
  8353           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8354           MOVE -1               TO MAINTL
  8355           GO TO 8200-SEND-DATAONLY
  8356         END-IF
  8357     END-IF.
  8358
  8359
  8360
  8361* EXEC CICS HANDLE CONDITION
  8362*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8363*    END-EXEC.
  8364*    MOVE '"$I                   ! ) #00008109' TO DFHEIV0
  8365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8367     MOVE X'2920233030303038313039' TO DFHEIV0(25:11)
  8368     CALL 'kxdfhei1' USING DFHEIV0
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8370
  8371
  8372     MOVE 'Y'                    TO CLAIM-SWITCH.
  8373     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8374     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8375     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8376     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8377     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8378
  8379 1000-SHOW-END-OF-PERFORM.
  8380
  8381     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8382     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8383     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8384     MOVE CL-CERT-STATE          TO CERT-STATE.
  8385     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 160
* EL130.cbl
  8386     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8387     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8388
  8389     MOVE 'CERT'                 TO FILE-SWITCH.
  8390
  8391     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8392
  8393     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8394     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8395     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8396     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8397     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8398     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8399     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8400     MOVE CLMCARRI               TO PI-LAST-CARR.
  8401
  8402     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8403
  8404     IF MAINTI = 'I'
  8405         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8406                 BIRTHDTA  LSTNMEA   RELCLMA   OCCCDA
  8407                 LOANNOA   LOANBALA  BENECDA
  8408         MOVE AL-SANON TO  SSNA
  8409         MOVE SPACES   TO  INCURI    REPORTI
  8410         MOVE 'Y'      TO PI-INCURR-SW
  8411         MOVE ER-0522  TO EMI-ERROR
  8412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8413     ELSE
  8414         MOVE ' '      TO PI-INCURR-SW
  8415     END-IF.
  8416
  8417     MOVE -1                     TO MAINTL.
  8418     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8419     MOVE CERT-GROUPING          TO PI-GROUPING.
  8420     MOVE CERT-STATE             TO PI-STATE.
  8421     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8422     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8423     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8424     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8425
  8426     IF RETURNED-FROM NOT = SPACES
  8427         GO TO 8100-SEND-INITIAL-MAP
  8428     ELSE
  8429         GO TO 8200-SEND-DATAONLY
  8430     END-IF.
  8431
  8432 1025-SHOW-RECORD-NOT-FOUND.
  8433
  8434     IF FILE-SWITCH = 'MSTR'
  8435         MOVE ER-0204            TO EMI-ERROR
  8436     ELSE
  8437         IF FILE-SWITCH = 'TRLR'
  8438             MOVE ER-0205        TO EMI-ERROR
  8439         ELSE
  8440             MOVE ER-0206        TO EMI-ERROR
  8441         END-IF
  8442     END-IF.
  8443
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 161
* EL130.cbl
  8444     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8445
  8446 1050-SEND-CHECK.
  8447
  8448     IF RETURNED-FROM NOT = SPACES
  8449         GO TO 8100-SEND-INITIAL-MAP
  8450     ELSE
  8451         MOVE -1                 TO MAINTL
  8452         GO TO 8200-SEND-DATAONLY
  8453     END-IF.
  8454
  8455 2000-DELETE-CLAIM.
  8456     IF NOT MODIFY-CAP
  8457         MOVE ER-0070            TO EMI-ERROR
  8458         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8459         MOVE -1                 TO MAINTL
  8460         GO TO 8200-SEND-DATAONLY
  8461     END-IF.
  8462
  8463     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8464        CLMCARRI NOT = PI-LAST-CARR        OR
  8465        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8466        SUFXI    NOT = PI-LAST-CERT-SUFX
  8467         MOVE ER-0207            TO EMI-ERROR
  8468         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8469         MOVE -1                 TO MAINTL
  8470         GO TO 8200-SEND-DATAONLY
  8471     END-IF.
  8472
  8473
  8474
  8475* EXEC CICS HANDLE CONDITION
  8476*        NOTFND   (2050-DELETE-NOT-FOUND)
  8477*    END-EXEC.
  8478*    MOVE '"$I                   ! * #00008215' TO DFHEIV0
  8479     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8481     MOVE X'2A20233030303038323135' TO DFHEIV0(25:11)
  8482     CALL 'kxdfhei1' USING DFHEIV0
  8483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8484
  8485
  8486     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8487
  8488     MOVE CLMCARRI               TO MSTR-CARRIER.
  8489     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8490     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8491     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8492
  8493     MOVE 'MSTR'                 TO FILE-SWITCH.
  8494     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8495
  8496     MOVE 'Y'                    TO CLAIM-SWITCH.
  8497
  8498     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8499        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8500         MOVE ER-0068        TO EMI-ERROR
  8501         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 162
* EL130.cbl
  8502         MOVE -1             TO MAINTL
  8503         GO TO 8200-SEND-DATAONLY
  8504     END-IF.
  8505
  8506     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8507         MOVE ER-0569            TO EMI-ERROR
  8508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8509         MOVE -1                 TO MAINTL
  8510         GO TO 8200-SEND-DATAONLY
  8511     END-IF.
  8512
  8513     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8514         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8515     END-IF.
  8516
  8517     IF CL-PURGED-DT NOT = LOW-VALUES
  8518         MOVE ER-7691            TO EMI-ERROR
  8519         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8520         MOVE -1                 TO MAINTL
  8521         GO TO 8200-SEND-DATAONLY
  8522     END-IF.
  8523
  8524     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8525     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8526     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8527     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8528     MOVE +0                     TO TRLR-SEQ-NO.
  8529     MOVE '1'                    TO TRLR-TYPE.
  8530
  8531     MOVE 'TRLR'                 TO FILE-SWITCH.
  8532
  8533
  8534
  8535* EXEC CICS READ
  8536*        UPDATE
  8537*        DATASET  (ELTRLR-DSID)
  8538*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8539*        RIDFLD   (ELTRLR-KEY)
  8540*    END-EXEC.
  8541*    MOVE '&"S        EU         (   #00008267' TO DFHEIV0
  8542     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8543     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8544     MOVE X'2020233030303038323637' TO DFHEIV0(25:11)
  8545     CALL 'kxdfhei1' USING DFHEIV0,
  8546           ELTRLR-DSID,
  8547           DFHEIV20,
  8548           DFHEIV99,
  8549           ELTRLR-KEY,
  8550           DFHEIV99,
  8551           DFHEIV99,
  8552           DFHEIV99
  8553     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8554         DFHEIV20
  8555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8556
  8557
  8558     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8559        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 163
* EL130.cbl
  8560         MOVE ER-0068        TO EMI-ERROR
  8561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8562         MOVE -1             TO MAINTL
  8563         GO TO 8200-SEND-DATAONLY
  8564     END-IF.
  8565
  8566
  8567
  8568* EXEC CICS DELETE
  8569*        DATASET   (ELTRLR-DSID)
  8570*    END-EXEC.
  8571*    MOVE '&(                    &   #00008283' TO DFHEIV0
  8572     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8573     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8574     MOVE X'2020233030303038323833' TO DFHEIV0(25:11)
  8575     CALL 'kxdfhei1' USING DFHEIV0,
  8576           ELTRLR-DSID,
  8577           DFHEIV99,
  8578           DFHEIV99,
  8579           DFHEIV99,
  8580           DFHEIV99
  8581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8582
  8583
  8584     MOVE +90                    TO TRLR-SEQ-NO.
  8585     MOVE '6'                    TO TRLR-TYPE.
  8586
  8587
  8588
  8589* EXEC CICS READ
  8590*        UPDATE
  8591*        DATASET  (ELTRLR-DSID)
  8592*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8593*        RIDFLD   (ELTRLR-KEY)
  8594*    END-EXEC.
  8595*    MOVE '&"S        EU         (   #00008291' TO DFHEIV0
  8596     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8597     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8598     MOVE X'2020233030303038323931' TO DFHEIV0(25:11)
  8599     CALL 'kxdfhei1' USING DFHEIV0,
  8600           ELTRLR-DSID,
  8601           DFHEIV20,
  8602           DFHEIV99,
  8603           ELTRLR-KEY,
  8604           DFHEIV99,
  8605           DFHEIV99,
  8606           DFHEIV99
  8607     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8608         DFHEIV20
  8609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8610
  8611
  8612
  8613
  8614* EXEC CICS DELETE
  8615*        DATASET   (ELTRLR-DSID)
  8616*    END-EXEC.
  8617*    MOVE '&(                    &   #00008299' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 164
* EL130.cbl
  8618     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8619     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8620     MOVE X'2020233030303038323939' TO DFHEIV0(25:11)
  8621     CALL 'kxdfhei1' USING DFHEIV0,
  8622           ELTRLR-DSID,
  8623           DFHEIV99,
  8624           DFHEIV99,
  8625           DFHEIV99,
  8626           DFHEIV99
  8627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8628
  8629
  8630     MOVE +91                    TO TRLR-SEQ-NO.
  8631     MOVE '6'                    TO TRLR-TYPE.
  8632
  8633
  8634
  8635* EXEC CICS READ
  8636*        UPDATE
  8637*        DATASET  (ELTRLR-DSID)
  8638*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8639*        RIDFLD   (ELTRLR-KEY)
  8640*        RESP     (WS-RESPONSE)
  8641*    END-EXEC
  8642*    MOVE '&"S        EU         (  N#00008307' TO DFHEIV0
  8643     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8644     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8645     MOVE X'204E233030303038333037' TO DFHEIV0(25:11)
  8646     CALL 'kxdfhei1' USING DFHEIV0,
  8647           ELTRLR-DSID,
  8648           DFHEIV20,
  8649           DFHEIV99,
  8650           ELTRLR-KEY,
  8651           DFHEIV99,
  8652           DFHEIV99,
  8653           DFHEIV99
  8654     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8655         DFHEIV20
  8656     MOVE EIBRESP  TO WS-RESPONSE
  8657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8658
  8659     IF WS-RESP-NORMAL
  8660
  8661* EXEC CICS DELETE
  8662*          DATASET   (ELTRLR-DSID)
  8663*       END-EXEC
  8664*    MOVE '&(                    &   #00008316' TO DFHEIV0
  8665     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8666     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8667     MOVE X'2020233030303038333136' TO DFHEIV0(25:11)
  8668     CALL 'kxdfhei1' USING DFHEIV0,
  8669           ELTRLR-DSID,
  8670           DFHEIV99,
  8671           DFHEIV99,
  8672           DFHEIV99,
  8673           DFHEIV99
  8674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8675     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 165
* EL130.cbl
  8676
  8677     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8678     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8679     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8680     MOVE CL-CERT-STATE          TO CERT-STATE.
  8681     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8682     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8683     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8684
  8685     MOVE 'CERT'                 TO FILE-SWITCH.
  8686
  8687     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8688
  8689     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8690
  8691     IF WS-NUM-HOLD NOT = +0
  8692         GO TO 2005-REWRITE-CERT
  8693     END-IF.
  8694
  8695     IF NOT CERT-WAS-CREATED
  8696         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8697         GO TO 2005-REWRITE-CERT
  8698     END-IF.
  8699
  8700
  8701
  8702* EXEC CICS DELETE
  8703*        DATASET   (ELCERT-DSID)
  8704*    END-EXEC.
  8705*    MOVE '&(                    &   #00008345' TO DFHEIV0
  8706     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8707     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8708     MOVE X'2020233030303038333435' TO DFHEIV0(25:11)
  8709     CALL 'kxdfhei1' USING DFHEIV0,
  8710           ELCERT-DSID,
  8711           DFHEIV99,
  8712           DFHEIV99,
  8713           DFHEIV99,
  8714           DFHEIV99
  8715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8716
  8717
  8718     GO TO 2010-DELETE-CL.
  8719
  8720 2005-REWRITE-CERT.
  8721
  8722     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8723
  8724
  8725
  8726* EXEC CICS HANDLE CONDITION
  8727*         DUPKEY   (2010-DELETE-CL)
  8728*    END-EXEC.
  8729*    MOVE '"$$                   ! + #00008356' TO DFHEIV0
  8730     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8732     MOVE X'2B20233030303038333536' TO DFHEIV0(25:11)
  8733     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 166
* EL130.cbl
  8734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8735
  8736
  8737
  8738
  8739* EXEC CICS REWRITE
  8740*        DATASET  (ELCERT-DSID)
  8741*        FROM     (CERTIFICATE-MASTER)
  8742*    END-EXEC.
  8743     MOVE LENGTH OF
  8744      CERTIFICATE-MASTER
  8745       TO DFHEIV11
  8746*    MOVE '&& L                  %   #00008361' TO DFHEIV0
  8747     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8748     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8749     MOVE X'2020233030303038333631' TO DFHEIV0(25:11)
  8750     CALL 'kxdfhei1' USING DFHEIV0,
  8751           ELCERT-DSID,
  8752           CERTIFICATE-MASTER,
  8753           DFHEIV11,
  8754           DFHEIV99
  8755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8756
  8757
  8758 2010-DELETE-CL.
  8759
  8760
  8761
  8762* EXEC CICS DELETE
  8763*        DATASET  (ELMSTR-DSID)
  8764*    END-EXEC.
  8765*    MOVE '&(                    &   #00008369' TO DFHEIV0
  8766     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8767     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8768     MOVE X'2020233030303038333639' TO DFHEIV0(25:11)
  8769     CALL 'kxdfhei1' USING DFHEIV0,
  8770           ELMSTR-DSID,
  8771           DFHEIV99,
  8772           DFHEIV99,
  8773           DFHEIV99,
  8774           DFHEIV99
  8775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8776
  8777
  8778     MOVE -1                     TO ONE-OR-MIN1.
  8779     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8780
  8781     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8782         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8783                                    WS-SAVE-CLAIM-KEY
  8784         MOVE +1                 TO ONE-OR-MIN1
  8785         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8786     END-IF.
  8787
  8788     MOVE ER-0000                TO EMI-ERROR.
  8789     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8790     MOVE LOW-VALUES             TO EL130AO.
  8791     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 167
* EL130.cbl
  8792     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8793     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8794                                    PI-CERT-PROCESSED
  8795                                    PI-LETTER-ERROR-CODE.
  8796     GO TO 8100-SEND-INITIAL-MAP.
  8797
  8798 2050-DELETE-NOT-FOUND.
  8799     IF FILE-SWITCH = 'MSTR'
  8800         MOVE -1                 TO CLMNOL
  8801         MOVE ER-0204            TO EMI-ERROR
  8802     ELSE
  8803         IF FILE-SWITCH = 'TRLR'
  8804             MOVE -1             TO MAINTL
  8805             MOVE ER-0205        TO EMI-ERROR
  8806         ELSE
  8807             MOVE -1             TO CERTNOL
  8808             MOVE ER-0206        TO EMI-ERROR
  8809         END-IF
  8810     END-IF.
  8811
  8812     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8813     GO TO 8200-SEND-DATAONLY.
  8814
  8815 3000-ADD-CLAIM.
  8816     IF NOT MODIFY-CAP
  8817         MOVE ER-0070            TO EMI-ERROR
  8818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8819         MOVE -1                 TO MAINTL
  8820         GO TO 8200-SEND-DATAONLY
  8821     END-IF.
  8822
  8823     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8824
  8825     IF CERTMTI = 'S'
  8826         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8827            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8828            WS-EFFDT = PI-SAVE-EFFDT       AND
  8829            ACCOUNTI = PI-SAVE-ACCOUNT
  8830             IF EMI-ERROR = 0
  8831                 GO TO 3010-TEST-FOR-ERRORS
  8832             ELSE
  8833                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8834                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8835                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8836                 MOVE PI-STATE         TO  CERT-STATE
  8837                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8838                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8839                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8840
  8841
  8842* EXEC CICS HANDLE CONDITION
  8843*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8844*                END-EXEC
  8845*    MOVE '"$I                   ! , #00008436' TO DFHEIV0
  8846     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8848     MOVE X'2C20233030303038343336' TO DFHEIV0(25:11)
  8849     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 168
* EL130.cbl
  8850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8851                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  8852                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8853                 GO TO 3010-TEST-FOR-ERRORS
  8854             END-IF
  8855         END-IF
  8856     END-IF.
  8857
  8858     IF CERTMTI = 'A'
  8859         IF NOT PI-NO-CARRIER-SECURITY OR
  8860             NOT PI-NO-ACCOUNT-SECURITY
  8861             MOVE ER-2370          TO EMI-ERROR
  8862             MOVE -1               TO MAINTL
  8863             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8864             GO TO 8200-SEND-DATAONLY
  8865         ELSE
  8866             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8867             GO TO 3010-TEST-FOR-ERRORS
  8868         END-IF
  8869     END-IF.
  8870
  8871     IF CERTNOL = ZEROS
  8872        GO TO 3010-TEST-FOR-ERRORS
  8873     END-IF.
  8874
  8875 3000-READ-CERT.
  8876
  8877     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8878                                    MSTR5-COMP-CD.
  8879     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8880                                    MSTR5-CERT-NO-PRIME.
  8881     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8882                                    MSTR5-CERT-NO-SUFX.
  8883
  8884
  8885
  8886* EXEC CICS HANDLE CONDITION
  8887*         DUPKEY   (3008-DUP-ERROR)
  8888*         NOTFND   (3009-NOT-FOUND)
  8889*    END-EXEC
  8890*    MOVE '"$$I                  ! - #00008473' TO DFHEIV0
  8891     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8893     MOVE X'2D20233030303038343733' TO DFHEIV0(25:11)
  8894     CALL 'kxdfhei1' USING DFHEIV0
  8895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8896
  8897     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8898
  8899     IF NOT PI-NO-ACCOUNT-SECURITY
  8900         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8901             MOVE ER-2371          TO EMI-ERROR
  8902             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8903             MOVE -1               TO MAINTL
  8904             GO TO 8200-SEND-DATAONLY
  8905         END-IF
  8906     END-IF.
  8907
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 169
* EL130.cbl
  8908     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8909     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  8910     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8911     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8912     MOVE CM-CARRIER             TO PI-CARRIER.
  8913     MOVE CM-GROUPING            TO PI-GROUPING.
  8914     MOVE CM-STATE               TO PI-STATE.
  8915     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8916     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8917     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8918     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8919
  8920     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8921         IF LSTNMEO = SPACES OR LOW-VALUES
  8922             MOVE CRTLNMEI       TO  LSTNMEO
  8923             MOVE AL-UANON       TO  LSTNMEA
  8924         END-IF
  8925     END-IF.
  8926
  8927     MOVE 'S'                    TO CERTMTO.
  8928*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8929     MOVE AL-SANON               TO CERTNOA.
  8930     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8931                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8932     IF EMI-NO-ERRORS
  8933         MOVE -1                  TO MAINTL
  8934     END-IF.
  8935
  8936     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8937         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8938         IF INCURRED-DATE-MATCH
  8939             MOVE ER-7352         TO EMI-ERROR
  8940             MOVE -1              TO CERTNOL
  8941             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8942         ELSE
  8943             IF NO-CLAIMS-FOR-CERT
  8944                 MOVE ER-7353     TO EMI-ERROR
  8945                 MOVE -1          TO CERTNOL
  8946                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8947             ELSE
  8948                 MOVE ER-0558     TO EMI-ERROR
  8949                 MOVE -1          TO CERTNOL
  8950                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8951                 GO TO 3010-TEST-FOR-ERRORS
  8952             END-IF
  8953         END-IF
  8954     END-IF.
  8955
  8956 3007-SEND-SCREEN.
  8957     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8958         GO TO 8150-SEND-MAP-CURSOR
  8959     ELSE
  8960         GO TO 8200-SEND-DATAONLY
  8961     END-IF.
  8962
  8963 3008-DUP-ERROR.
  8964     MOVE ER-0560                TO EMI-ERROR.
  8965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 170
* EL130.cbl
  8966     MOVE -1                     TO CERTNOL.
  8967     GO TO 3007-SEND-SCREEN.
  8968
  8969 3009-NOT-FOUND.
  8970     MOVE ER-0214                TO EMI-ERROR.
  8971     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8972     MOVE -1                     TO CERTNOL.
  8973     GO TO 3007-SEND-SCREEN.
  8974
  8975 3010-TEST-FOR-ERRORS.
  8976
  8977     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  8978     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  8979     if pi-company-id = 'DCC'
  8980        perform 6500-get-acct    thru 6500-exit
  8981     end-if
  8982
  8983     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  8984     move +0                     to e1
  8985     move spaces                 to ws-dcc-error-line
  8986
  8987     IF PI-COMPANY-ID = 'DCC'
  8988        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  8989        IF ERPDEF-FOUND
  8990           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8991           MOVE WS-INCUR         TO DC-BIN-DATE-2
  8992           MOVE '1'              TO DC-OPTION-CODE
  8993           MOVE +0               TO DC-ELAPSED-MONTHS
  8994                                    DC-ELAPSED-DAYS
  8995           PERFORM 9700-LINK-DATE-CONVERT
  8996                                 THRU 9700-EXIT
  8997           IF NO-CONVERSION-ERROR
  8998              MOVE DC-ELAPSED-MONTHS
  8999                                 TO WS-MONTHS-BETWEEN
  9000              IF DC-ELAPSED-DAYS > 1
  9001                 ADD 1 TO WS-MONTHS-BETWEEN
  9002              END-IF
  9003           ELSE
  9004              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9005           END-IF
  9006
  9007           evaluate true
  9008              when (ws-excl-period not = zeros)
  9009                 and (ws-months-between <= ws-excl-period)
  9010                 MOVE -1         TO MAINTL
  9011                 add +1          to e1
  9012                 MOVE ER-1651    TO EMI-ERROR
  9013                                    ws-error-no (e1)
  9014                 PERFORM 9900-ERROR-FORMAT
  9015                                 THRU 9900-EXIT
  9016              when (ws-cov-ends not = zeros)
  9017                 and (ws-months-between > ws-cov-ends)
  9018                 MOVE -1         TO MAINTL
  9019                 add +1          to e1
  9020                 MOVE ER-1653    TO EMI-ERROR
  9021                                    ws-error-no (e1)
  9022                 evaluate true
  9023                    when clmtypei = 'L'
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 171
* EL130.cbl
  9024                       move '  LF  ' to emi-claim-type
  9025                    when clmtypei = 'I'
  9026                       move '  IU  ' to emi-claim-type
  9027                    when other
  9028                       move '  AH  ' to emi-claim-type
  9029                 end-evaluate
  9030                 PERFORM 9900-ERROR-FORMAT
  9031                                 THRU 9900-EXIT
  9032              when (ws-acc-period not = zeros)
  9033                 and (ws-months-between <= ws-acc-period)
  9034                 MOVE -1         TO MAINTL
  9035                 add +1          to e1
  9036                 MOVE ER-1652    TO EMI-ERROR
  9037                                    ws-error-no (e1)
  9038                 PERFORM 9900-ERROR-FORMAT
  9039                                 THRU 9900-EXIT
  9040                 add +1          to e1
  9041                 move er-1655    to emi-error
  9042                                    ws-error-no (e1)
  9043                 PERFORM 9900-ERROR-FORMAT
  9044                                 THRU 9900-EXIT
  9045              when clmtypei = 'I'
  9046                 add +1          to e1
  9047                 move er-1661    to emi-error
  9048                                    ws-error-no (e1)
  9049                 PERFORM 9900-ERROR-FORMAT
  9050                                 THRU 9900-EXIT
  9051           end-evaluate
  9052        END-IF
  9053        perform 3996-read-cert-claim-trailer
  9054                                 thru 3996-exit
  9055     END-IF
  9056     IF CERTMTI NOT = 'A'
  9057         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9058             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9059             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9060             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9061             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9062             IF INCURRED-DATE-MATCH
  9063                 MOVE ER-7352         TO EMI-ERROR
  9064                 MOVE -1              TO CERTNOL
  9065                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9066             ELSE
  9067                 IF NO-CLAIMS-FOR-CERT
  9068                     MOVE ER-7353     TO EMI-ERROR
  9069                     MOVE -1          TO CERTNOL
  9070                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9071                 ELSE
  9072                     MOVE ER-0558     TO EMI-ERROR
  9073                     MOVE -1          TO CERTNOL
  9074                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9075                 END-IF
  9076             END-IF
  9077         END-IF
  9078     END-IF.
  9079
  9080     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9081         MOVE ER-0433             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 172
* EL130.cbl
  9082         MOVE -1                  TO MAINTL
  9083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9084         GO TO 8200-SEND-DATAONLY
  9085     END-IF.
  9086
  9087     IF (EMI-NO-ERRORS)
  9088        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9089         GO TO 3015-TRY-TO-BUILD
  9090     END-IF.
  9091
  9092     IF EIBAID = DFHPF6
  9093         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9094             MOVE ER-0434         TO EMI-ERROR
  9095             MOVE -1              TO MAINTL
  9096             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9097             GO TO 8200-SEND-DATAONLY
  9098         ELSE
  9099             MOVE +1              TO INCURL
  9100             GO TO 3015-TRY-TO-BUILD
  9101         END-IF
  9102     END-IF.
  9103
  9104     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9105         GO TO 8150-SEND-MAP-CURSOR
  9106     ELSE
  9107         GO TO 8200-SEND-DATAONLY
  9108     END-IF.
  9109
  9110 3015-TRY-TO-BUILD.
  9111     IF CLMNOL EQUAL ZERO
  9112         GO TO 3030-BUILD-CONT
  9113     END-IF.
  9114
  9115
  9116
  9117* EXEC CICS HANDLE CONDITION
  9118*        NOTFND   (3030-BUILD-CONT)
  9119*    END-EXEC.
  9120*    MOVE '"$I                   ! . #00008697' TO DFHEIV0
  9121     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9123     MOVE X'2E20233030303038363937' TO DFHEIV0(25:11)
  9124     CALL 'kxdfhei1' USING DFHEIV0
  9125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9126
  9127
  9128     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9129
  9130     MOVE CLMCARRI               TO MSTR-CARRIER.
  9131     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9132     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9133     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9134
  9135     MOVE 'MSTR'                 TO FILE-SWITCH.
  9136
  9137     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9138
  9139     MOVE ER-0221                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 173
* EL130.cbl
  9140
  9141     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9142     MOVE -1                     TO MAINTL.
  9143     GO TO 8200-SEND-DATAONLY.
  9144
  9145 3030-BUILD-CONT.
  9146     IF (CERTMTI NOT = 'A')
  9147        and (pi-company-id not = 'DCC')
  9148         GO TO 3060-BUILD-CONT
  9149     END-IF.
  9150
  9151
  9152
  9153* EXEC CICS HANDLE CONDITION
  9154*        NOTFND   (3033-ACCT-NOT-FOUND)
  9155*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9156*    END-EXEC.
  9157*    MOVE '"$I''                  ! / #00008725' TO DFHEIV0
  9158     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9160     MOVE X'2F20233030303038373235' TO DFHEIV0(25:11)
  9161     CALL 'kxdfhei1' USING DFHEIV0
  9162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9163
  9164
  9165     MOVE SPACES                 TO ERACCT-KEY.
  9166
  9167     IF CARR-GROUP-ST-ACCNT-CNTL
  9168         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9169         MOVE CRTCARRI           TO ACCT-CARRIER
  9170         MOVE GROUPI             TO ACCT-GROUPING
  9171         MOVE STATEI             TO ACCT-STATE
  9172         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9173         GO TO 3031-MOVE-ACCT-KEY
  9174     END-IF.
  9175
  9176     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9177     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9178
  9179     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9180         MOVE STATEI             TO ACCT-STATE
  9181     END-IF.
  9182
  9183     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9184         MOVE CRTCARRI           TO ACCT-CARRIER
  9185     END-IF.
  9186
  9187 3031-MOVE-ACCT-KEY.
  9188     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9189
  9190
  9191
  9192* EXEC CICS STARTBR
  9193*        DATASET     (ERACCT2-DSID)
  9194*        RIDFLD      (SAVE-ERACCT-KEY)
  9195*        GENERIC
  9196*        KEYLENGTH   (20)
  9197*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 174
* EL130.cbl
  9198     MOVE 20
  9199       TO DFHEIV11
  9200     MOVE 0
  9201       TO DFHEIV12
  9202*    MOVE '&,   KG    G          &   #00008756' TO DFHEIV0
  9203     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9204     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9205     MOVE X'2020233030303038373536' TO DFHEIV0(25:11)
  9206     CALL 'kxdfhei1' USING DFHEIV0,
  9207           ERACCT2-DSID,
  9208           SAVE-ERACCT-KEY,
  9209           DFHEIV11,
  9210           DFHEIV12,
  9211           DFHEIV99
  9212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9213
  9214
  9215
  9216
  9217* EXEC CICS HANDLE CONDITION
  9218*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9219*    END-EXEC.
  9220*    MOVE '"$''                   ! 0 #00008764' TO DFHEIV0
  9221     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9223     MOVE X'3020233030303038373634' TO DFHEIV0(25:11)
  9224     CALL 'kxdfhei1' USING DFHEIV0
  9225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9226
  9227
  9228 3031-READ-ACCT-LOOP.
  9229
  9230
  9231* EXEC CICS READNEXT
  9232*        DATASET   (ERACCT2-DSID)
  9233*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9234*        RIDFLD    (SAVE-ERACCT-KEY)
  9235*    END-EXEC.
  9236     MOVE 0
  9237       TO DFHEIV11
  9238*    MOVE '&.S                   )   #00008770' TO DFHEIV0
  9239     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9240     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9241     MOVE X'2020233030303038373730' TO DFHEIV0(25:11)
  9242     CALL 'kxdfhei1' USING DFHEIV0,
  9243           ERACCT2-DSID,
  9244           DFHEIV20,
  9245           DFHEIV99,
  9246           SAVE-ERACCT-KEY,
  9247           DFHEIV99,
  9248           DFHEIV11,
  9249           DFHEIV99,
  9250           DFHEIV99
  9251     SET ADDRESS OF ACCOUNT-MASTER TO
  9252         DFHEIV20
  9253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9254
  9255
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 175
* EL130.cbl
  9256     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9257        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9258        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9259        ACCT-STATE    NOT = AM-VG-STATE       OR
  9260        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9261         GO TO 3033-ACCT-NOT-FOUND
  9262     END-IF.
  9263
  9264     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9265        WS-EFFDT LESS AM-EXPIRATION-DT
  9266         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9267         MOVE AM-CARRIER       TO CERT-CARRIER
  9268         MOVE AM-GROUPING      TO CERT-GROUPING
  9269         MOVE AM-STATE         TO CERT-STATE
  9270         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9271         MOVE WS-EFFDT         TO CERT-EFF-DT
  9272         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9273         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9274         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9275         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9276     END-IF.
  9277
  9278     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9279         GO TO 3031-READ-ACCT-LOOP
  9280     END-IF.
  9281
  9282 3032-NOT-IN-DT-RANGE.
  9283     MOVE ER-0226                TO EMI-ERROR.
  9284     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9285     MOVE -1                     TO EFFDTL.
  9286     GO TO 8200-SEND-DATAONLY.
  9287
  9288 3033-ACCT-NOT-FOUND.
  9289     MOVE ER-0226 TO EMI-ERROR.
  9290     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9291     MOVE -1                     TO ACCOUNTL.
  9292     GO TO 8200-SEND-DATAONLY.
  9293
  9294 3034-CHECK-EMPLOYER-STATEMENT.
  9295
  9296     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9297*        NEXT SENTENCE
  9298         CONTINUE
  9299     ELSE
  9300         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9301     END-IF.
  9302
  9303     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9304     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9305     MOVE '1'                    TO  DC-OPTION-CODE.
  9306     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9307                                     DC-ELAPSED-DAYS.
  9308     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9309
  9310     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9311         DC-ELAPSED-DAYS LESS THAN +31)
  9312                      OR
  9313        (AM-EMPLOYER-STMT-USED = '2' AND
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 176
* EL130.cbl
  9314         DC-ELAPSED-DAYS LESS THAN +61)
  9315                      OR
  9316        (AM-EMPLOYER-STMT-USED = '3' AND
  9317         DC-ELAPSED-DAYS LESS THAN +91)
  9318            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9319     END-IF.
  9320
  9321 3034-CHECK-ACCOUNT-LIMITS.
  9322
  9323     IF CERTMTI NOT = 'A'
  9324         GO TO 3060-BUILD-CONT
  9325     END-IF.
  9326
  9327     IF AM-STATUS NOT = '0'
  9328         MOVE ER-0225                TO EMI-ERROR
  9329         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9330         MOVE -1                     TO ACCOUNTL
  9331     END-IF.
  9332
  9333     IF EIBAID = DFHPF6
  9334         IF EMI-FATAL-CTR NOT = ZERO
  9335             MOVE ER-0434         TO EMI-ERROR
  9336             MOVE -1              TO MAINTL
  9337             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9338             GO TO 8200-SEND-DATAONLY
  9339         END-IF
  9340     END-IF.
  9341
  9342*    IF PI-COMPANY-ID NOT = 'CRI'
  9343*        GO TO 3035-END-BROWSE
  9344*    END-IF.
  9345
  9346 3035-END-BROWSE.
  9347
  9348
  9349* EXEC CICS ENDBR
  9350*        DATASET    (ERACCT2-DSID)
  9351*    END-EXEC.
  9352     MOVE 0
  9353       TO DFHEIV11
  9354*    MOVE '&2                    $   #00008868' TO DFHEIV0
  9355     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9356     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9357     MOVE X'2020233030303038383638' TO DFHEIV0(25:11)
  9358     CALL 'kxdfhei1' USING DFHEIV0,
  9359           ERACCT2-DSID,
  9360           DFHEIV11,
  9361           DFHEIV99
  9362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9363
  9364
  9365 3040-CHECK-CERT-ALREADY-ON.
  9366
  9367
  9368* EXEC CICS HANDLE CONDITION
  9369*        NOTFND   (3070-BUILD-CONT)
  9370*    END-EXEC.
  9371*    MOVE '"$I                   ! 1 #00008874' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 177
* EL130.cbl
  9372     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9373     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9374     MOVE X'3120233030303038383734' TO DFHEIV0(25:11)
  9375     CALL 'kxdfhei1' USING DFHEIV0
  9376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9377
  9378
  9379     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9380
  9381     MOVE ER-0229                TO EMI-ERROR.
  9382     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9383     MOVE -1                     TO MAINTL.
  9384     GO TO 8200-SEND-DATAONLY.
  9385
  9386 3060-BUILD-CONT.
  9387     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9388     MOVE CRTCARRI               TO CERT-CARRIER.
  9389     MOVE GROUPI                 TO CERT-GROUPING.
  9390     MOVE STATEI                 TO CERT-STATE.
  9391     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9392     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9393     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9394     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9395
  9396
  9397
  9398* EXEC CICS HANDLE CONDITION
  9399*        NOTFND  (3065-CERT-NOT-FOUND)
  9400*    END-EXEC.
  9401*    MOVE '"$I                   ! 2 #00008896' TO DFHEIV0
  9402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9404     MOVE X'3220233030303038383936' TO DFHEIV0(25:11)
  9405     CALL 'kxdfhei1' USING DFHEIV0
  9406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9407
  9408
  9409     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9410
  9411     GO TO 3070-BUILD-CONT.
  9412
  9413 3065-CERT-NOT-FOUND.
  9414     MOVE ER-0244                TO EMI-ERROR.
  9415     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9416     MOVE -1                     TO CERTNOL.
  9417     GO TO 8200-SEND-DATAONLY.
  9418
  9419 3070-BUILD-CONT.
  9420     IF CLMNOL NOT = ZERO
  9421         GO TO 3200-BUILD-ZERO-TRAILER
  9422     END-IF.
  9423
  9424     MOVE SPACES                 TO ELCNTL-KEY.
  9425
  9426     IF CONTROL-IS-ACTUAL-CARRIER
  9427         MOVE PI-CARRIER         TO CNTL-CARRIER
  9428     ELSE
  9429         MOVE PI-CARRIER-CONTROL-LEVEL
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 178
* EL130.cbl
  9430                                 TO CNTL-CARRIER
  9431     END-IF.
  9432
  9433     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9434     MOVE '6'                    TO CNTL-REC-TYPE.
  9435     MOVE +0                     TO CNTL-SEQ-NO.
  9436
  9437
  9438
  9439* EXEC CICS HANDLE CONDITION
  9440*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9441*    END-EXEC.
  9442*    MOVE '"$I                   ! 3 #00008929' TO DFHEIV0
  9443     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9445     MOVE X'3320233030303038393239' TO DFHEIV0(25:11)
  9446     CALL 'kxdfhei1' USING DFHEIV0
  9447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9448
  9449
  9450
  9451
  9452* EXEC CICS READ
  9453*        UPDATE
  9454*        DATASET   (ELCNTL-DSID)
  9455*        SET       (ADDRESS OF CONTROL-FILE)
  9456*        RIDFLD    (ELCNTL-KEY)
  9457*    END-EXEC.
  9458*    MOVE '&"S        EU         (   #00008934' TO DFHEIV0
  9459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9461     MOVE X'2020233030303038393334' TO DFHEIV0(25:11)
  9462     CALL 'kxdfhei1' USING DFHEIV0,
  9463           ELCNTL-DSID,
  9464           DFHEIV20,
  9465           DFHEIV99,
  9466           ELCNTL-KEY,
  9467           DFHEIV99,
  9468           DFHEIV99,
  9469           DFHEIV99
  9470     SET ADDRESS OF CONTROL-FILE TO
  9471         DFHEIV20
  9472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9473
  9474
  9475     IF CLAIM-NO-MANUAL
  9476         GO TO 3120-CLAIM-MUST-BE-INPUT
  9477     END-IF.
  9478
  9479     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9480     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9481
  9482     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9483         CONTINUE
  9484     ELSE
  9485         GO TO 3080-ASSIGN-LOOP
  9486     END-IF.
  9487
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 179
* EL130.cbl
  9488
  9489
  9490* EXEC CICS UNLOCK
  9491*        DATASET   (ELCNTL-DSID)
  9492*    END-EXEC.
  9493*    MOVE '&*                    #   #00008955' TO DFHEIV0
  9494     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9495     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9496     MOVE X'2020233030303038393535' TO DFHEIV0(25:11)
  9497     CALL 'kxdfhei1' USING DFHEIV0,
  9498           ELCNTL-DSID,
  9499           DFHEIV99
  9500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9501
  9502
  9503     MOVE '1'                    TO CNTL-REC-TYPE.
  9504     MOVE SPACES                 TO CNTL-ACCESS.
  9505
  9506     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9507
  9508
  9509
  9510* EXEC CICS HANDLE CONDITION
  9511*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9512*    END-EXEC.
  9513*    MOVE '"$I                   ! 4 #00008965' TO DFHEIV0
  9514     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9516     MOVE X'3420233030303038393635' TO DFHEIV0(25:11)
  9517     CALL 'kxdfhei1' USING DFHEIV0
  9518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9519
  9520
  9521     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9522
  9523     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9524
  9525 3080-ASSIGN-LOOP.
  9526     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9527        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9528         MOVE +0                 TO SAVE-COUNTER
  9529     END-IF.
  9530
  9531     ADD +1 TO SAVE-COUNTER.
  9532
  9533     IF SAVE-METHOD  = '3'
  9534         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9535         GO TO 3090-SET-COMP
  9536     END-IF.
  9537
  9538     IF SAVE-METHOD  = '4'
  9539         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9540         MOVE CLMCARRI           TO WS-CN-PRF-A
  9541         GO TO 3090-SET-COMP
  9542     END-IF.
  9543
  9544     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9545     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 180
* EL130.cbl
  9546     MOVE SAVE-DATE              TO CURR-DATE.
  9547
  9548     IF CURR-MM LESS '10'
  9549         MOVE CURR-M2             TO WS-CN-PRF-B
  9550     END-IF.
  9551
  9552     IF CURR-MM = '10'
  9553        MOVE 'A'                 TO WS-CN-PRF-B
  9554     END-IF.
  9555     IF CURR-MM = '11'
  9556        MOVE 'B'                 TO WS-CN-PRF-B
  9557     END-IF.
  9558     IF CURR-MM = '12'
  9559        MOVE 'C'                 TO WS-CN-PRF-B
  9560     END-IF.
  9561
  9562     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9563
  9564 3090-SET-COMP.
  9565
  9566     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9567     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9568                                    CLMNOO.
  9569     MOVE AL-UANON               TO CLMNOA.
  9570     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9571     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9572     MOVE CLMCARRI               TO MSTR-CARRIER.
  9573
  9574
  9575
  9576* EXEC CICS HANDLE CONDITION
  9577*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9578*    END-EXEC.
  9579*    MOVE '"$I                   ! 5 #00009023' TO DFHEIV0
  9580     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9582     MOVE X'3520233030303039303233' TO DFHEIV0(25:11)
  9583     CALL 'kxdfhei1' USING DFHEIV0
  9584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9585
  9586
  9587     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9588
  9589     GO TO 3080-ASSIGN-LOOP.
  9590
  9591 3100-CARRIER-NOT-FOUND.
  9592     MOVE ER-0252                TO EMI-ERROR.
  9593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9594     MOVE -1                     TO CLMCARRL.
  9595     GO TO 8200-SEND-DATAONLY.
  9596
  9597 3110-COMPANY-NOT-FOUND.
  9598     MOVE ER-0254                TO EMI-ERROR.
  9599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9600     MOVE -1                     TO MAINTL.
  9601     GO TO 8200-SEND-DATAONLY.
  9602
  9603 3120-CLAIM-MUST-BE-INPUT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 181
* EL130.cbl
  9604     MOVE ER-0264                TO EMI-ERROR.
  9605     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9606     MOVE -1                     TO CLMNOL.
  9607     GO TO 8200-SEND-DATAONLY.
  9608
  9609 3200-BUILD-ZERO-TRAILER.
  9610
  9611
  9612* EXEC CICS HANDLE CONDITION
  9613*        NOTFND
  9614*    END-EXEC.
  9615*    MOVE '"$                   ! 6 #00009051' TO DFHEIV0
  9616     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9618     MOVE X'3620233030303039303531' TO DFHEIV0(25:11)
  9619     CALL 'kxdfhei1' USING DFHEIV0
  9620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9621
  9622
  9623
  9624
  9625* EXEC CICS GETMAIN
  9626*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9627*        LENGTH  (ELTRLR-LENGTH)
  9628*    END-EXEC.
  9629*    MOVE '," L                  $   #00009056' TO DFHEIV0
  9630     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9631     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9632     MOVE X'2020233030303039303536' TO DFHEIV0(25:11)
  9633     CALL 'kxdfhei1' USING DFHEIV0,
  9634           DFHEIV20,
  9635           ELTRLR-LENGTH,
  9636           DFHEIV99
  9637     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9638         DFHEIV20
  9639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9640
  9641
  9642     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9643     MOVE 'AT'                   TO AT-RECORD-ID.
  9644
  9645     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9646     MOVE CLMCARRI               TO AT-CARRIER.
  9647     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9648     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9649     MOVE +0                     TO AT-SEQUENCE-NO.
  9650     MOVE '1'                    TO AT-TRAILER-TYPE.
  9651
  9652     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9653     MOVE '5'                    TO DC-OPTION-CODE.
  9654     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9655     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9656                                    AT-RESERVES-LAST-MAINT-DT.
  9657
  9658     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9659                                    AT-RESERVES-LAST-UPDATED-BY.
  9660
  9661     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 182
* EL130.cbl
  9662
  9663     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9664
  9665     MOVE +0                     TO AT-FUTURE-RESERVE
  9666                                    AT-IBNR-RESERVE
  9667                                    AT-PAY-CURRENT-RESERVE
  9668                                    AT-INITIAL-MANUAL-RESERVE
  9669                                    AT-CURRENT-MANUAL-RESERVE
  9670                                    AT-ITD-LIFE-REFUNDS
  9671                                    AT-ITD-AH-REFUNDS
  9672                                    AT-ITD-ADDITIONAL-RESERVE.
  9673
  9674     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9675
  9676     IF MANRSVL NOT = ZERO
  9677         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9678                                    AT-CURRENT-MANUAL-RESERVE
  9679     END-IF.
  9680
  9681     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9682
  9683     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9684                                    AT-ITD-CHARGEABLE-EXPENSE.
  9685
  9686     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9687     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9688     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9689
  9690
  9691
  9692* EXEC CICS WRITE
  9693*        DATASET   (ELTRLR-DSID)
  9694*        FROM      (ACTIVITY-TRAILERS)
  9695*        RIDFLD    (AT-CONTROL-PRIMARY)
  9696*    END-EXEC.
  9697     MOVE LENGTH OF
  9698      ACTIVITY-TRAILERS
  9699       TO DFHEIV11
  9700*    MOVE '&$ L                  ''   #00009110' TO DFHEIV0
  9701     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9702     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9703     MOVE X'2020233030303039313130' TO DFHEIV0(25:11)
  9704     CALL 'kxdfhei1' USING DFHEIV0,
  9705           ELTRLR-DSID,
  9706           ACTIVITY-TRAILERS,
  9707           DFHEIV11,
  9708           AT-CONTROL-PRIMARY,
  9709           DFHEIV99,
  9710           DFHEIV99
  9711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9712
  9713
  9714     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9715
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 183
* EL130.cbl
  9717
  9718 3250-BUILD-I1-ADDRESS-TRAILER.
  9719
  9720     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9721     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9722     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9723     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9724     MOVE GROUPI                 TO WS-MA-GROUPING.
  9725     MOVE STATEI                 TO WS-MA-STATE.
  9726     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9727     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9728     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9729     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9730
  9731
  9732* EXEC CICS HANDLE CONDITION
  9733*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9734*    END-EXEC.
  9735*    MOVE '"$I                   ! 7 #00009133' TO DFHEIV0
  9736     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9738     MOVE X'3720233030303039313333' TO DFHEIV0(25:11)
  9739     CALL 'kxdfhei1' USING DFHEIV0
  9740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9741
  9742
  9743
  9744* EXEC CICS READ
  9745*        EQUAL
  9746*        DATASET   (ERMAIL-DSID)
  9747*        SET       (ADDRESS OF MAILING-DATA)
  9748*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9749*    END-EXEC.
  9750*    MOVE '&"S        E          (   #00009137' TO DFHEIV0
  9751     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9753     MOVE X'2020233030303039313337' TO DFHEIV0(25:11)
  9754     CALL 'kxdfhei1' USING DFHEIV0,
  9755           ERMAIL-DSID,
  9756           DFHEIV20,
  9757           DFHEIV99,
  9758           WS-MA-CONTROL-PRIMARY,
  9759           DFHEIV99,
  9760           DFHEIV99,
  9761           DFHEIV99
  9762     SET ADDRESS OF MAILING-DATA TO
  9763         DFHEIV20
  9764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9765
  9766
  9767     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9768         GO TO 3290-NO-INSURED-ADDRESS
  9769     END-IF.
  9770
  9771     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9772     MOVE 'AT'                   TO AT-RECORD-ID.
  9773
  9774     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 184
* EL130.cbl
  9775     MOVE CLMCARRI               TO AT-CARRIER.
  9776     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9777     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9778     MOVE +1                     TO AT-SEQUENCE-NO.
  9779     MOVE '5'                    TO AT-TRAILER-TYPE.
  9780
  9781     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9782     IF MA-INSURED-MIDDLE-INIT > SPACES
  9783        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9784               ' ' DELIMITED BY SIZE
  9785               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9786               ' ' DELIMITED BY SIZE
  9787               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9788        INTO AT-MAIL-TO-NAME
  9789     ELSE
  9790        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9791               ' ' DELIMITED BY SIZE
  9792               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9793        INTO AT-MAIL-TO-NAME
  9794     END-IF.
  9795     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9796     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9797*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9798     MOVE MA-CITY                TO AT-CITY
  9799     MOVE MA-ADDR-STATE          TO AT-STATE
  9800     MOVE MA-ZIP                 TO AT-ZIP
  9801     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9802
  9803     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9804                                    AT-ADDRESS-LAST-MAINT-DT.
  9805
  9806     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9807                                    AT-ADDRESS-LAST-UPDATED-BY.
  9808
  9809     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9810
  9811
  9812* EXEC CICS WRITE
  9813*        DATASET   (ELTRLR-DSID)
  9814*        FROM      (ACTIVITY-TRAILERS)
  9815*        RIDFLD    (AT-CONTROL-PRIMARY)
  9816*    END-EXEC.
  9817     MOVE LENGTH OF
  9818      ACTIVITY-TRAILERS
  9819       TO DFHEIV11
  9820*    MOVE '&$ L                  ''   #00009188' TO DFHEIV0
  9821     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9822     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9823     MOVE X'2020233030303039313838' TO DFHEIV0(25:11)
  9824     CALL 'kxdfhei1' USING DFHEIV0,
  9825           ELTRLR-DSID,
  9826           ACTIVITY-TRAILERS,
  9827           DFHEIV11,
  9828           AT-CONTROL-PRIMARY,
  9829           DFHEIV99,
  9830           DFHEIV99
  9831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9832
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 185
* EL130.cbl
  9833
  9834     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9835     GO TO 3300-BUILD-NINETY-TRAILER.
  9836
  9837 3290-NO-INSURED-ADDRESS.
  9838      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9839
  9840 3300-BUILD-NINETY-TRAILER.
  9841
  9842     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9843     MOVE 'AT'                   TO AT-RECORD-ID.
  9844
  9845     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9846     MOVE CLMCARRI               TO AT-CARRIER.
  9847
  9848     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9849     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9850     MOVE +90                    TO AT-SEQUENCE-NO.
  9851     MOVE '6'                    TO AT-TRAILER-TYPE.
  9852
  9853     IF DIAGL NOT = ZERO
  9854         MOVE DIAGI              TO AT-INFO-LINE-1
  9855     END-IF.
  9856
  9857     IF ICD1L NOT = ZERO
  9858         MOVE ICD1I              TO AT-ICD-CODE-1
  9859     END-IF.
  9860
  9861     IF ICD2L NOT = ZERO
  9862         MOVE ICD2I              TO AT-ICD-CODE-2
  9863     END-IF.
  9864
  9865     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9866                                    AT-GEN-INFO-LAST-MAINT-DT.
  9867
  9868     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9869                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9870     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9871
  9872
  9873
  9874* EXEC CICS WRITE
  9875*        DATASET   (ELTRLR-DSID)
  9876*        FROM      (ACTIVITY-TRAILERS)
  9877*        RIDFLD    (AT-CONTROL-PRIMARY)
  9878*    END-EXEC.
  9879     MOVE LENGTH OF
  9880      ACTIVITY-TRAILERS
  9881       TO DFHEIV11
  9882*    MOVE '&$ L                  ''   #00009233' TO DFHEIV0
  9883     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9884     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9885     MOVE X'2020233030303039323333' TO DFHEIV0(25:11)
  9886     CALL 'kxdfhei1' USING DFHEIV0,
  9887           ELTRLR-DSID,
  9888           ACTIVITY-TRAILERS,
  9889           DFHEIV11,
  9890           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 186
* EL130.cbl
  9891           DFHEIV99,
  9892           DFHEIV99
  9893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9894
  9895
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 187
* EL130.cbl
  9897 3400-CHECK-CERT-MAINT.
  9898
  9899     IF CERTMTI = 'A'
  9900         GO TO 3600-BUILD-NEW-CERT
  9901     END-IF.
  9902
  9903     IF NO-CLAIM-ATTACHED
  9904         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9905     END-IF.
  9906
  9907     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9908
  9909     IF CM-LF-CURRENT-STATUS = '2' OR
  9910        CM-AH-CURRENT-STATUS = '2'
  9911         GO TO 3400-REWRITE-CERT
  9912     END-IF.
  9913
  9914     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9915
  9916 3400-REWRITE-CERT.
  9917
  9918
  9919
  9920* EXEC CICS HANDLE CONDITION
  9921*        DUPKEY (3410-DUP-KEY)
  9922*    END-EXEC.
  9923*    MOVE '"$$                   ! 8 #00009262' TO DFHEIV0
  9924     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9926     MOVE X'3820233030303039323632' TO DFHEIV0(25:11)
  9927     CALL 'kxdfhei1' USING DFHEIV0
  9928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9929
  9930
  9931
  9932
  9933* EXEC CICS REWRITE
  9934*        DATASET   (ELCERT-DSID)
  9935*        FROM      (CERTIFICATE-MASTER)
  9936*    END-EXEC.
  9937     MOVE LENGTH OF
  9938      CERTIFICATE-MASTER
  9939       TO DFHEIV11
  9940*    MOVE '&& L                  %   #00009267' TO DFHEIV0
  9941     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9942     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9943     MOVE X'2020233030303039323637' TO DFHEIV0(25:11)
  9944     CALL 'kxdfhei1' USING DFHEIV0,
  9945           ELCERT-DSID,
  9946           CERTIFICATE-MASTER,
  9947           DFHEIV11,
  9948           DFHEIV99
  9949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9950
  9951
  9952 3410-DUP-KEY.
  9953     GO TO 3800-BUILD-NEW-CLAIM.
  9954
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 188
* EL130.cbl
  9955 3600-BUILD-NEW-CERT.
  9956
  9957
  9958* EXEC CICS GETMAIN
  9959*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9960*        LENGTH   (ELCERT-LENGTH)
  9961*    END-EXEC.
  9962*    MOVE '," L                  $   #00009277' TO DFHEIV0
  9963     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9964     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9965     MOVE X'2020233030303039323737' TO DFHEIV0(25:11)
  9966     CALL 'kxdfhei1' USING DFHEIV0,
  9967           DFHEIV20,
  9968           ELCERT-LENGTH,
  9969           DFHEIV99
  9970     SET ADDRESS OF CERTIFICATE-MASTER TO
  9971         DFHEIV20
  9972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9973
  9974
  9975     MOVE SPACES                 TO CERTIFICATE-MASTER.
  9976
  9977     MOVE 'CM'                   TO CM-RECORD-ID.
  9978
  9979     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
  9980                                    CM-COMPANY-CD-A1
  9981                                    CM-COMPANY-CD-A2
  9982                                    CM-COMPANY-CD-A4
  9983                                    CM-COMPANY-CD-A5.
  9984
  9985     MOVE CERT-CARRIER           TO CM-CARRIER.
  9986     MOVE CERT-GROUPING          TO CM-GROUPING.
  9987     MOVE CERT-STATE             TO CM-STATE.
  9988     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
  9989     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
  9990     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
  9991
  9992     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
  9993                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
  9994                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
  9995                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
  9996                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
  9997                       CM-LIVES              CM-LOAN-TERM
  9998                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
  9999                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10000                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10001                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10002                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10003                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10004                       CM-LF-ALT-PREMIUM-RATE
 10005                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10006                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10007                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10008                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10009                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10010
 10011     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10012                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 189
* EL130.cbl
 10013                                    CM-AH-SETTLEMENT-DT
 10014                                    CM-AH-CANCEL-EXIT-DT
 10015                                    CM-AH-SETTLEMENT-EXIT-DT
 10016                                    CM-LF-LOAN-EXPIRE-DT
 10017                                    CM-LF-CANCEL-DT
 10018                                    CM-LF-DEATH-DT
 10019                                    CM-LF-CANCEL-EXIT-DT
 10020                                    CM-LF-DEATH-EXIT-DT
 10021                                    CM-LAST-ADD-ON-DT
 10022                                    CM-ENTRY-DT.
 10023
 10024     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10025     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10026     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10027
 10028     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10029                                    CM-PART-LAST-NAME-A2
 10030                                    CM-PART-LAST-NAME-A5.
 10031
 10032     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10033                                    CM-INSURED-INITIAL1-A2
 10034                                    CM-INSURED-INITIAL1-A5
 10035                                    CM-INSURED-FIRST-NAME.
 10036
 10037     IF CRTINITL GREATER ZERO
 10038         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10039                                    CM-INSURED-INITIAL2-A2
 10040                                    CM-INSURED-INITIAL2-A5
 10041     ELSE
 10042         MOVE SPACES             TO CM-INSURED-INITIAL2
 10043                                    CM-INSURED-INITIAL2-A2
 10044                                    CM-INSURED-INITIAL2-A5
 10045     END-IF.
 10046
 10047     IF CM-INSURED-INITIALS = SPACES
 10048         MOVE '**'               TO CM-INSURED-INITIALS
 10049     END-IF.
 10050
 10051     IF MEMBERL GREATER ZERO
 10052         MOVE MEMBERI              TO CM-MEMBER-NO
 10053     ELSE
 10054         MOVE CERT-STATE           TO CM-MEMB-STATE
 10055         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10056         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10057         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10058     END-IF.
 10059
 10060     IF JNTLNMEL GREATER ZERO
 10061         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10062     END-IF.
 10063
 10064     IF JNTFNMEL GREATER ZERO
 10065         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10066     END-IF.
 10067
 10068     IF JNTINITL GREATER ZERO
 10069         MOVE JNTINITI           TO CM-JT-INITIAL
 10070     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 190
* EL130.cbl
 10071
 10072     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10073
 10074
 10075
 10076* EXEC CICS HANDLE CONDITION
 10077*        DUPKEY   (3690-CERT-WRITTEN)
 10078*    END-EXEC.
 10079*    MOVE '"$$                   ! 9 #00009382' TO DFHEIV0
 10080     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10082     MOVE X'3920233030303039333832' TO DFHEIV0(25:11)
 10083     CALL 'kxdfhei1' USING DFHEIV0
 10084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10085
 10086
 10087
 10088
 10089* EXEC CICS WRITE
 10090*        DATASET   (ELCERT-DSID)
 10091*        FROM      (CERTIFICATE-MASTER)
 10092*        RIDFLD    (CM-CONTROL-PRIMARY)
 10093*    END-EXEC.
 10094     MOVE LENGTH OF
 10095      CERTIFICATE-MASTER
 10096       TO DFHEIV11
 10097*    MOVE '&$ L                  ''   #00009387' TO DFHEIV0
 10098     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10099     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10100     MOVE X'2020233030303039333837' TO DFHEIV0(25:11)
 10101     CALL 'kxdfhei1' USING DFHEIV0,
 10102           ELCERT-DSID,
 10103           CERTIFICATE-MASTER,
 10104           DFHEIV11,
 10105           CM-CONTROL-PRIMARY,
 10106           DFHEIV99,
 10107           DFHEIV99
 10108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10109
 10110
 10111 3690-CERT-WRITTEN.
 10112
 10113     GO TO 3800-BUILD-NEW-CLAIM.
 10114
 10115 3690-EXIT.
 10116      EXIT.
 10117
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 191
* EL130.cbl
 10119 3700-BUILD-CERT.
 10120
 10121     IF CERTMTI NOT = 'A'
 10122         GO TO 3700-FINISH-CERT-BUILD
 10123     END-IF.
 10124
 10125     IF CERTMTI = 'A'
 10126         IF LCVCDL = ZEROS
 10127             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10128                                    CM-LF-ORIG-TERM
 10129                                    CM-LF-BENEFIT-AMT
 10130                                    CM-LF-PREMIUM-RATE
 10131             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10132         END-IF
 10133     END-IF.
 10134
 10135     IF LCVCDL GREATER ZERO
 10136         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10137     END-IF.
 10138
 10139     IF LCVOTRML GREATER ZERO
 10140         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10141     END-IF.
 10142
 10143     IF LCVBENEL GREATER ZERO
 10144         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10145     END-IF.
 10146
 10147     IF LCVRATEL GREATER ZERO
 10148         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10149     END-IF.
 10150
 10151     IF WS-EXPIRE NOT = LOW-VALUES
 10152         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10153     END-IF.
 10154
 10155     IF LCVFORML GREATER ZERO
 10156         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10157     END-IF.
 10158
 10159     IF LCVCNDTL = ZERO
 10160        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10161     END-IF.
 10162
 10163     IF WS-LCVCNDT NOT = LOW-VALUES
 10164        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10165        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10166        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10167     END-IF.
 10168
 10169     IF CM-LF-CURRENT-STATUS = '7'
 10170        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10171        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10172        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10173                                    CM-LF-DEATH-DT
 10174        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10175     END-IF.
 10176
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 192
* EL130.cbl
 10177     IF CM-LF-CURRENT-STATUS = '8'
 10178        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10179        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10180     END-IF.
 10181
 10182 3700-BUILD-AH-COVERAGE-SIDE.
 10183
 10184     IF CERTMTI = 'A'
 10185         IF ACVCDL = ZEROS
 10186             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10187                                    CM-AH-ORIG-TERM
 10188                                    CM-AH-BENEFIT-AMT
 10189                                    CM-AH-PREMIUM-RATE
 10190             GO TO 3700-COVERAGE-BUILT
 10191         END-IF
 10192     END-IF.
 10193
 10194     IF ACVCDL GREATER ZERO
 10195         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10196     END-IF.
 10197
 10198     IF ACVOTRML GREATER ZERO
 10199         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10200     END-IF.
 10201
 10202     IF ACVBENEL GREATER ZERO
 10203         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10204     END-IF.
 10205
 10206     IF ACVRATEL GREATER ZERO
 10207         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10208     END-IF.
 10209
 10210     IF WS-EXPIRE NOT = LOW-VALUES
 10211         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10212     END-IF.
 10213
 10214     IF ACVFORML GREATER ZERO
 10215         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10216     END-IF.
 10217
 10218     IF ACVCNDTL = ZERO
 10219        GO TO 3700-COVERAGE-BUILT
 10220     END-IF.
 10221
 10222     IF WS-ACVCNDT NOT = LOW-VALUES
 10223        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10224        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10225        GO TO 3700-COVERAGE-BUILT
 10226     END-IF.
 10227
 10228     IF CM-AH-CURRENT-STATUS = '6'
 10229        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10230        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10231        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10232        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10233        GO TO 3700-COVERAGE-BUILT
 10234     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 193
* EL130.cbl
 10235
 10236     IF CM-AH-CURRENT-STATUS = '8'
 10237        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10238        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10239     END-IF.
 10240
 10241 3700-COVERAGE-BUILT.
 10242     IF ISSAGEL GREATER ZERO
 10243         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10244     END-IF.
 10245
 10246     IF JNTAGEL GREATER ZERO
 10247         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10248     END-IF.
 10249
 10250     IF SEXL GREATER ZERO
 10251         MOVE SEXI               TO CM-INSURED-SEX
 10252     END-IF.
 10253
 10254     IF APRL GREATER ZERO
 10255         MOVE WS-APR             TO CM-LOAN-APR
 10256     END-IF.
 10257
 10258     IF PMTFREQL GREATER ZERO
 10259         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10260     END-IF.
 10261
 10262     IF INDGRPL GREATER ZERO
 10263         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10264     END-IF.
 10265
 10266     IF CERTMTI = 'A'
 10267         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10268     END-IF.
 10269
 10270     IF REINCDL GREATER ZERO
 10271         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10272                                    WS-REIN-1
 10273                                    WS-REIN-2
 10274                                    WS-REIN-3
 10275         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10276     END-IF.
 10277
 10278     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10279         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10280     END-IF.
 10281
 10282     IF CRTSSNL GREATER ZERO
 10283         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10284     ELSE
 10285         IF SSNL GREATER ZERO
 10286             MOVE SSNI           TO CM-SOC-SEC-NO
 10287         END-IF
 10288     END-IF.
 10289
 10290     IF CRTSSNL = ZERO AND
 10291        SSNL    = ZERO
 10292         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 194
* EL130.cbl
 10293         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10294         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10295         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10296     END-IF.
 10297
 10298     IF CM-LF-CURRENT-STATUS = SPACES
 10299         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10300     END-IF.
 10301
 10302     IF CM-AH-CURRENT-STATUS = SPACES
 10303         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10304     END-IF.
 10305
 10306     IF CERTMTI = 'A'
 10307         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10308     END-IF.
 10309
 10310 3700-FINISH-CERT-BUILD.
 10311
 10312     IF LOANNOL GREATER ZERO
 10313         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10314     END-IF.
 10315
 10316     IF LOANBALL GREATER ZERO
 10317         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10318     END-IF.
 10319
 10320     IF PREMTYPL GREATER ZERO
 10321         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10322     END-IF.
 10323
 10324 3700-EXIT.
 10325      EXIT.
 10326
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 195
* EL130.cbl
 10328 3800-BUILD-NEW-CLAIM.
 10329
 10330*************************************************************
 10331*****           START OF ACTIVITY FILE PROCESSING          **
 10332*************************************************************
 10333     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10334         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10335                 6700-EXIT
 10336     END-IF.
 10337*************************************************************
 10338*****            END OF ACTIVITY FILE PROCESSING           **
 10339*************************************************************
 10340
 10341
 10342
 10343
 10344* EXEC CICS GETMAIN
 10345*        SET     (ADDRESS OF CLAIM-MASTER)
 10346*        LENGTH  (ELMSTR-LENGTH)
 10347*    END-EXEC.
 10348*    MOVE '," L                  $   #00009625' TO DFHEIV0
 10349     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10350     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10351     MOVE X'2020233030303039363235' TO DFHEIV0(25:11)
 10352     CALL 'kxdfhei1' USING DFHEIV0,
 10353           DFHEIV20,
 10354           ELMSTR-LENGTH,
 10355           DFHEIV99
 10356     SET ADDRESS OF CLAIM-MASTER TO
 10357         DFHEIV20
 10358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10359
 10360
 10361     MOVE SPACES TO CLAIM-MASTER.
 10362
 10363     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10364         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10365         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10366         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10367         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10368         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10369         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10370         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10371         cl-rtw-dt
 10372
 10373     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10374             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10375             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10376             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10377             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10378             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10379             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10380             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10381             CL-FORCEABLE-ERROR-CNT.
 10382
 10383     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10384
 10385     MOVE ZEROS                  TO CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 196
* EL130.cbl
 10386                                    CL-LAPSE-REPORT-CODE
 10387                                    CL-LAG-REPORT-CODE
 10388                                    CL-CRITICAL-PERIOD
 10389                                    CL-CRIT-PER-RTW-MOS
 10390
 10391     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10392     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10393
 10394     IF BENECDL NOT = ZEROS
 10395        MOVE BENECDI             TO CL-BENEFICIARY
 10396     END-IF.
 10397
 10398     MOVE 'CL'                   TO CL-RECORD-ID.
 10399     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10400
 10401     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10402                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10403                             CL-COMPANY-CD-A5.
 10404
 10405     MOVE CLMCARRI               TO CL-CARRIER.
 10406
 10407     IF CLMNOL = ZERO
 10408         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10409     ELSE
 10410         MOVE CLMNOI             TO CL-CLAIM-NO
 10411     END-IF.
 10412
 10413     MOVE CERTNOI                TO CL-CERT-PRIME
 10414                                    CL-CERT-A4-PRIME.
 10415
 10416     MOVE SUFXI                  TO CL-CERT-SFX
 10417                                    CL-CERT-A4-SFX.
 10418
 10419     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10420
 10421     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10422
 10423     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10424
 10425     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10426
 10427     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10428     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10429
 10430     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10431
 10432     IF CERTMTI = 'A'
 10433         MOVE '2'                TO CL-CERT-ORIGIN
 10434     ELSE
 10435         MOVE '1'                TO CL-CERT-ORIGIN
 10436     END-IF.
 10437
 10438     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10439     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10440     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10441     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10442     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10443
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 197
* EL130.cbl
 10444 3820-REWRITE-CONTROL-FILE.
 10445
 10446     IF CLMNOL GREATER ZERO
 10447         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10448     END-IF.
 10449
 10450     IF CF-RECORD-TYPE = '6'
 10451         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10452     ELSE
 10453         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10454     END-IF.
 10455
 10456
 10457
 10458* EXEC CICS REWRITE
 10459*        DATASET   (ELCNTL-DSID)
 10460*        FROM      (CONTROL-FILE)
 10461*    END-EXEC.
 10462     MOVE LENGTH OF
 10463      CONTROL-FILE
 10464       TO DFHEIV11
 10465*    MOVE '&& L                  %   #00009726' TO DFHEIV0
 10466     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10467     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10468     MOVE X'2020233030303039373236' TO DFHEIV0(25:11)
 10469     CALL 'kxdfhei1' USING DFHEIV0,
 10470           ELCNTL-DSID,
 10471           CONTROL-FILE,
 10472           DFHEIV11,
 10473           DFHEIV99
 10474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10475
 10476
 10477 3830-SEQUENCE-CLAIM-RECORDS.
 10478
 10479     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10480     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10481     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10482
 10483     IF WS-ASSOC-CERT-TOTAL = ZERO
 10484         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10485                                    CL-ASSOC-CERT-TOTAL
 10486         GO TO 3840-WRITE-CLAIM-MASTER
 10487     END-IF.
 10488
 10489     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10490         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10491     ELSE
 10492         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10493     END-IF.
 10494
 10495     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10496     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10497     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10498
 10499 3840-WRITE-CLAIM-MASTER.
 10500
 10501     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 198
* EL130.cbl
 10502     IF WS-REC-FOUND-SW = 'Y'
 10503         MOVE 01                 TO  CL-ACTIVITY-CODE
 10504         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10505         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10506     END-IF.
 10507
 10508
 10509
 10510* EXEC CICS HANDLE CONDITION
 10511*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10512*    END-EXEC.
 10513*    MOVE '"$$                   ! : #00009763' TO DFHEIV0
 10514     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10516     MOVE X'3A20233030303039373633' TO DFHEIV0(25:11)
 10517     CALL 'kxdfhei1' USING DFHEIV0
 10518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10519
 10520
 10521** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10522     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10523
 10524
 10525*    DISPLAY ' ABOUT TO WRITE ELMSTR '
 10526*    DISPLAY ' KEY ' CL-CARRIER ' ' CL-CLAIM-NO ' '
 10527*       CL-CERT-NO
 10528*    IF CL-COMPANY-CD = X'04'
 10529*       DISPLAY ' CID COMP CD '
 10530*    ELSE
 10531*       IF CL-COMPANY-CD = X'05'
 10532*          DISPLAY ' DCC COMP CD '
 10533*       ELSE
 10534*          DISPLAY ' UNKNOWN COMP CD '
 10535*       END-IF
 10536*    END-IF
 10537
 10538* EXEC CICS WRITE
 10539*        DATASET   (ELMSTR-DSID)
 10540*        FROM      (CLAIM-MASTER)
 10541*        RIDFLD    (CL-CONTROL-PRIMARY)
 10542*    END-EXEC.
 10543     MOVE LENGTH OF
 10544      CLAIM-MASTER
 10545       TO DFHEIV11
 10546*    MOVE '&$ L                  ''   #00009783' TO DFHEIV0
 10547     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10548     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10549     MOVE X'2020233030303039373833' TO DFHEIV0(25:11)
 10550     CALL 'kxdfhei1' USING DFHEIV0,
 10551           ELMSTR-DSID,
 10552           CLAIM-MASTER,
 10553           DFHEIV11,
 10554           CL-CONTROL-PRIMARY,
 10555           DFHEIV99,
 10556           DFHEIV99
 10557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10558
 10559
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 199
* EL130.cbl
 10560 3850-CLAIM-MSTR-WRITTEN.
 10561
 10562     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10563         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10564     END-IF.
 10565
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 200
* EL130.cbl
 10567 3990-ADD-DONE.
 10568*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10569*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10570*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10571*                                  EMI-ERROR-LINES.
 10572
 10573     IF CLMNOL = ZERO
 10574         move spaces             to emi-claim-no
 10575         MOVE ER-0265            TO EMI-ERROR
 10576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10577         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10578                                    PI-LAST-CLAIM
 10579     ELSE
 10580         MOVE CLMNOI             TO PI-LAST-CLAIM
 10581                                    MSTR-CLAIM-NO
 10582         MOVE ER-0000            TO EMI-ERROR
 10583         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10584     END-IF.
 10585
 10586     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10587       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10588         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10589         MOVE ER-7575            TO EMI-ERROR
 10590         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10591     END-IF.
 10592
 10593     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10594       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10595         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10596         MOVE ER-7582            TO EMI-ERROR
 10597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10598     END-IF.
 10599
 10600     IF WS-NO-INSURED-ADDRESS = 'Y'
 10601         MOVE ER-3548            TO EMI-ERROR
 10602         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10603     END-IF.
 10604
 10605     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10606       (PI-ST-CAUSAL-STATE = 'L' AND
 10607              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10608       (PI-ST-CAUSAL-STATE = 'A' AND
 10609              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10610         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10611         MOVE ER-7577            TO EMI-ERROR
 10612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10613     END-IF.
 10614     if pi-company-id = 'DCC'
 10615        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10616                                 THRU 3994C-EXIT
 10617     end-if
 10618     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10619     MOVE CLMCARRI                   TO  PI-CARRIER.
 10620     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10621     MOVE SUFXI                      TO  PI-CERT-SFX.
 10622
 10623     IF WS-LETTER-SW = 'Y'
 10624         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 201
* EL130.cbl
 10625         IF W-1523-ERROR-CODE NOT = ZEROS
 10626             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10627             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10628         END-IF
 10629     END-IF.
 10630
 10631     perform 3998-update-cert-claim-trailer
 10632                                 thru 3998-exit
 10633     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10634     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10635     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10636     MOVE CLMCARRI               TO PI-LAST-CARR.
 10637
 10638     IF PRTOPTL GREATER THAN 0
 10639         MOVE PRTOPTI            TO PI-PRT-OPT
 10640     END-IF.
 10641     IF ALTPRTL GREATER THAN 0
 10642         MOVE ALTPRTI            TO PI-ALT-PRT
 10643     END-IF.
 10644
 10645     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10646         MOVE LOW-VALUES         TO EL130AI
 10647         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10648         MOVE AL-SANON           TO CERTNOA
 10649         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10650         MOVE AL-SANON           TO SUFXA
 10651         MOVE PI-LAST-CARR       TO CLMCARRO
 10652         MOVE AL-UANON           TO CLMCARRA
 10653         MOVE PI-LAST-CLAIM      TO CLMNOO
 10654         MOVE AL-UANON           TO CLMNOA
 10655         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10656         MOVE AL-UANON           TO CLMTYPEA
 10657     ELSE
 10658         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10659         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10660     END-IF.
 10661
 10662     IF PI-PRT-OPT = 'N' OR 'L'
 10663         MOVE PI-PRT-OPT         TO PRTOPTO
 10664         MOVE 1                  TO PRTOPTL
 10665     END-IF.
 10666
 10667     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10668         MOVE PI-ALT-PRT         TO ALTPRTO
 10669         MOVE 4                  TO ALTPRTL
 10670     END-IF.
 10671
 10672     IF PRTOPTL GREATER THAN 0
 10673         IF PRTOPTI = 'L'
 10674             GO TO 0400-CREATE-ELACTQ
 10675         ELSE
 10676             GO TO 0480-PRINT-NOW
 10677         END-IF
 10678     END-IF.
 10679     move 'S'                    to mainti
 10680     PERFORM 0500-CREATE-TEMP-STORAGE
 10681                                 THRU 0599-EXIT
 10682     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 202
* EL130.cbl
 10683         GO TO 8100-SEND-INITIAL-MAP
 10684     ELSE
 10685         MOVE LOW-VALUES         TO MAINTO
 10686         MOVE -1                 TO MAINTL
 10687         GO TO 8200-SEND-DATAONLY
 10688     END-IF.
 10689
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 203
* EL130.cbl
 10691 3993-MODIFY-SCREEN-ATTRB.
 10692
 10693     IF CERTMTL GREATER ZERO
 10694         MOVE AL-UANON           TO CERTMTA
 10695     END-IF.
 10696
 10697     IF EFFDTL GREATER ZERO
 10698         MOVE AL-UANON           TO EFFDTA
 10699     END-IF.
 10700
 10701     IF ACCOUNTL GREATER ZERO
 10702         MOVE AL-UANON           TO ACCOUNTA
 10703     END-IF.
 10704
 10705     IF STATEL GREATER ZERO
 10706         MOVE AL-UANON           TO STATEA
 10707     END-IF.
 10708
 10709     IF CRTCARRL GREATER ZERO
 10710         MOVE AL-UANON           TO CRTCARRA
 10711     END-IF.
 10712
 10713     IF GROUPL GREATER ZERO
 10714         MOVE AL-UANON           TO GROUPA
 10715     END-IF.
 10716
 10717     IF CRTLNMEL GREATER ZERO
 10718         MOVE AL-UANON           TO CRTLNMEA
 10719     END-IF.
 10720
 10721     IF CRTFNMEL GREATER ZERO
 10722         MOVE AL-UANON           TO CRTFNMEA
 10723     END-IF.
 10724
 10725     IF CRTINITL GREATER ZERO
 10726         MOVE AL-UANON           TO CRTINITA
 10727     END-IF.
 10728
 10729     IF ISSAGEL GREATER ZERO
 10730         MOVE AL-UNNON           TO ISSAGEA
 10731     END-IF.
 10732
 10733     IF JNTLNMEL GREATER ZERO
 10734         MOVE AL-UANON           TO JNTLNMEA
 10735     END-IF.
 10736
 10737     IF JNTFNMEL GREATER ZERO
 10738         MOVE AL-UANON           TO JNTFNMEA
 10739     END-IF.
 10740
 10741     IF JNTINITL GREATER ZERO
 10742         MOVE AL-UANON           TO JNTINITA
 10743     END-IF.
 10744
 10745     IF JNTAGEL GREATER ZERO
 10746         MOVE AL-UNNON           TO JNTAGEA
 10747     END-IF.
 10748
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 204
* EL130.cbl
 10749     IF CRTSSNL GREATER ZERO
 10750         MOVE AL-UANON           TO CRTSSNA
 10751     END-IF.
 10752
 10753     IF ACVDSCRL GREATER ZERO
 10754         MOVE AL-SANON           TO ACVDSCRA
 10755     END-IF.
 10756
 10757     IF ACVKINDL GREATER ZERO
 10758         MOVE AL-SANON           TO ACVKINDA
 10759     END-IF.
 10760
 10761     IF ACVCDL GREATER ZERO
 10762         MOVE AL-UANON           TO ACVCDA
 10763     END-IF.
 10764
 10765     IF ACVOTRML GREATER ZERO
 10766         MOVE AL-UNNON           TO ACVOTRMA
 10767     END-IF.
 10768
 10769     IF ACVRTRML GREATER ZERO
 10770         MOVE AL-UNNON           TO ACVRTRMA
 10771     END-IF.
 10772
 10773     IF ACVRATEL GREATER ZERO
 10774         MOVE AL-UNNON           TO ACVRATEA
 10775     END-IF.
 10776
 10777     IF ACVBENEL GREATER ZERO
 10778         MOVE AL-UNNON           TO ACVBENEA
 10779     END-IF.
 10780
 10781     IF ACVFORML GREATER ZERO
 10782         MOVE AL-UANON           TO ACVFORMA
 10783     END-IF.
 10784
 10785     IF ACVCNDTL GREATER ZERO
 10786         MOVE AL-UANON           TO ACVCNDTA
 10787     END-IF.
 10788
 10789     IF ACVEXITL GREATER ZERO
 10790         MOVE AL-UANON           TO ACVEXITA
 10791     END-IF.
 10792
 10793     IF ACVSTATL GREATER ZERO
 10794         MOVE AL-UANON           TO ACVSTATA
 10795     END-IF.
 10796
 10797     IF LCVDSCRL GREATER ZERO
 10798         MOVE AL-SANON           TO LCVDSCRA
 10799     END-IF.
 10800
 10801     IF LCVKINDL GREATER ZERO
 10802         MOVE AL-SANON           TO LCVKINDA
 10803     END-IF.
 10804
 10805     IF LCVCDL GREATER ZERO
 10806         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 205
* EL130.cbl
 10807     END-IF.
 10808
 10809     IF LCVOTRML GREATER ZERO
 10810         MOVE AL-UNNON           TO LCVOTRMA
 10811     END-IF.
 10812
 10813     IF LCVRTRML GREATER ZERO
 10814         MOVE AL-UNNON           TO LCVRTRMA
 10815     END-IF.
 10816
 10817     IF LCVRATEL GREATER ZERO
 10818         MOVE AL-UNNON           TO LCVRATEA
 10819     END-IF.
 10820
 10821     IF LCVBENEL GREATER ZERO
 10822         MOVE AL-UNNON           TO LCVBENEA
 10823     END-IF.
 10824
 10825     IF LCVFORML GREATER ZERO
 10826         MOVE AL-UANON           TO LCVFORMA
 10827     END-IF.
 10828
 10829     IF LCVCNDTL GREATER ZERO
 10830         MOVE AL-UANON           TO LCVCNDTA
 10831     END-IF.
 10832
 10833     IF LCVEXITL GREATER ZERO
 10834         MOVE AL-UANON           TO LCVEXITA
 10835     END-IF.
 10836
 10837     IF LCVSTATL GREATER ZERO
 10838         MOVE AL-UANON           TO LCVSTATA
 10839     END-IF.
 10840
 10841     IF MEMCAPL GREATER ZERO
 10842         MOVE AL-UANON           TO MEMCAPA
 10843     END-IF.
 10844
 10845     IF APRL GREATER ZERO
 10846         MOVE AL-UNNON           TO APRA
 10847     END-IF.
 10848
 10849     IF PMTFREQL GREATER ZERO
 10850         MOVE AL-UNNON           TO PMTFREQA
 10851     END-IF.
 10852
 10853     IF INDGRPL GREATER ZERO
 10854         MOVE AL-UANON           TO INDGRPA
 10855     END-IF.
 10856
 10857     IF PREMTYPL GREATER ZERO
 10858         MOVE AL-UANON           TO PREMTYPA
 10859     END-IF.
 10860
 10861     IF REINCDL GREATER ZERO
 10862         MOVE AL-UANON           TO REINCDA
 10863     END-IF.
 10864
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 206
* EL130.cbl
 10865     IF ADDONDTL GREATER ZERO
 10866         MOVE AL-UANON           TO ADDONDTA
 10867     END-IF.
 10868
 10869     IF MEMBERL GREATER ZERO
 10870         MOVE AL-UANON           TO MEMBERA
 10871     END-IF.
 10872
 10873     IF BCERT1L GREATER ZERO
 10874         MOVE AL-SANON           TO BCERT1A
 10875                                    BSUFX1A
 10876     END-IF.
 10877
 10878     IF BCERT2L GREATER ZERO
 10879         MOVE AL-SANON           TO BCERT2A
 10880                                    BSUFX2A
 10881     END-IF.
 10882
 10883     IF BCERT3L GREATER ZERO
 10884         MOVE AL-SANON           TO BCERT3A
 10885                                    BSUFX3A
 10886     END-IF.
 10887
 10888     IF BCERT4L GREATER ZERO
 10889         MOVE AL-SANON           TO BCERT4A
 10890                                    BSUFX4A
 10891     END-IF.
 10892
 10893     IF BCERT5L GREATER ZERO
 10894         MOVE AL-SANON           TO BCERT5A
 10895                                    BSUFX5A
 10896     END-IF.
 10897
 10898 3993-MODIFY-CLAIM-ATTRB.
 10899
 10900     IF PCERTNOL GREATER ZERO
 10901         MOVE AL-UANON           TO PCERTNOA
 10902     END-IF.
 10903
 10904     IF PSUFXL GREATER ZERO
 10905         MOVE AL-UANON           TO PSUFXA
 10906     END-IF.
 10907
 10908     IF LSTNMEL GREATER ZERO
 10909         MOVE AL-UANON           TO LSTNMEA
 10910     END-IF.
 10911
 10912     IF FSTNMEL GREATER ZERO
 10913         MOVE AL-UANON           TO FSTNMEA
 10914     END-IF.
 10915
 10916     IF INITL GREATER ZERO
 10917         MOVE AL-UANON           TO INITA
 10918     END-IF.
 10919
 10920     IF SEXL GREATER ZERO
 10921         MOVE AL-UANON           TO SEXA
 10922     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 207
* EL130.cbl
 10923
 10924     IF OCCCDL GREATER ZERO
 10925         MOVE AL-UANON           TO OCCCDA
 10926     END-IF.
 10927
 10928     IF BIRTHDTL GREATER ZERO
 10929         MOVE AL-UANON           TO BIRTHDTA
 10930     END-IF.
 10931
 10932     IF SSNL GREATER ZERO
 10933         MOVE AL-UANON           TO SSNA
 10934     END-IF.
 10935
 10936     IF INCURL GREATER ZERO
 10937         MOVE AL-UANON           TO INCURA
 10938     END-IF.
 10939
 10940     IF REPORTL GREATER ZERO
 10941         MOVE AL-UANON           TO REPORTA
 10942     END-IF.
 10943
 10944*    IF ESTENDL GREATER ZERO
 10945*        MOVE AL-UANON           TO ESTENDA
 10946*    END-IF.
 10947
 10948     IF DIAGL GREATER ZERO
 10949         MOVE AL-UANON           TO DIAGA
 10950     END-IF.
 10951*
 10952     IF ICD1L GREATER ZERO
 10953         MOVE AL-UANON           TO ICD1A
 10954     END-IF.
 10955
 10956     IF ICD2L GREATER ZERO
 10957         MOVE AL-UANON           TO ICD2A
 10958     END-IF.
 10959
 10960*    IF CAUSEL GREATER ZERO
 10961*        MOVE AL-UANON           TO CAUSEA
 10962*    END-IF.
 10963
 10964     IF MANRSVL GREATER ZERO
 10965         MOVE AL-UNNON           TO MANRSVA
 10966     END-IF.
 10967
 10968     IF RELCLML GREATER ZERO
 10969         MOVE AL-UANON           TO RELCLMA
 10970     END-IF.
 10971
 10972     IF LOANNOL GREATER ZERO
 10973         MOVE AL-UANON           TO LOANNOA
 10974     END-IF.
 10975
 10976     IF LOANBALL GREATER ZERO
 10977         MOVE AL-UNNON           TO LOANBALA
 10978     END-IF.
 10979
 10980     IF PROCCDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 208
* EL130.cbl
 10981         MOVE AL-UANON           TO PROCCDA
 10982     END-IF.
 10983
 10984     IF BENECDL GREATER THAN ZERO
 10985         MOVE AL-UANON           TO  BENECDA
 10986     END-IF.
 10987
 10988     IF PRICDL GREATER ZERO
 10989         MOVE AL-UANON           TO PRICDA
 10990     END-IF.
 10991
 10992     IF SUPVL GREATER ZERO
 10993         MOVE AL-UANON           TO SUPVA
 10994     END-IF.
 10995
 10996     IF FILETOL GREATER ZERO
 10997         MOVE AL-UANON           TO FILETOA
 10998     END-IF.
 10999
 11000
 11001 3993-MODIFY-CLAIM-KEY-ATTRB.
 11002
 11003     IF CLMNOL GREATER ZERO
 11004         MOVE AL-UANON           TO CLMNOA
 11005     END-IF.
 11006
 11007     IF CLMCARRL GREATER ZERO
 11008         MOVE AL-UANON           TO CLMCARRA
 11009     END-IF.
 11010
 11011     IF CLMTYPEL GREATER ZERO
 11012         MOVE AL-UANON           TO CLMTYPEA
 11013     END-IF.
 11014
 11015     IF CERTNOL GREATER ZERO
 11016         MOVE AL-SANON           TO CERTNOA
 11017     END-IF.
 11018
 11019     IF SUFXL GREATER ZERO
 11020         MOVE AL-SANON           TO SUFXA
 11021     END-IF.
 11022
 11023 3993-EXIT.
 11024     EXIT.
 11025
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 209
* EL130.cbl
 11027 3994-BUILD-NINETY-THREE-TRAILER.
 11028
 11029     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11030     MOVE 'AT'                   TO AT-RECORD-ID.
 11031
 11032     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11033     MOVE CLMCARRI               TO AT-CARRIER.
 11034
 11035     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11036     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11037     MOVE +93                    TO AT-SEQUENCE-NO.
 11038     MOVE '6'                    TO AT-TRAILER-TYPE.
 11039     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11040
 11041     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11042         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11043     ELSE
 11044         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11045     END-IF
 11046
 11047     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11048                                    AT-GEN-INFO-LAST-MAINT-DT.
 11049
 11050     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11051                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11052     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11053
 11054
 11055
 11056* EXEC CICS WRITE
 11057*        DATASET   (ELTRLR-DSID)
 11058*        FROM      (ACTIVITY-TRAILERS)
 11059*        RIDFLD    (AT-CONTROL-PRIMARY)
 11060*    END-EXEC.
 11061     MOVE LENGTH OF
 11062      ACTIVITY-TRAILERS
 11063       TO DFHEIV11
 11064*    MOVE '&$ L                  ''   #00010284' TO DFHEIV0
 11065     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11067     MOVE X'2020233030303130323834' TO DFHEIV0(25:11)
 11068     CALL 'kxdfhei1' USING DFHEIV0,
 11069           ELTRLR-DSID,
 11070           ACTIVITY-TRAILERS,
 11071           DFHEIV11,
 11072           AT-CONTROL-PRIMARY,
 11073           DFHEIV99,
 11074           DFHEIV99
 11075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11076
 11077
 11078 3994-EXIT.
 11079     EXIT.
 11080
 11081 3994B-BUILD-NINETY-FOUR-TRAILER.
 11082
 11083     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11084     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 210
* EL130.cbl
 11085
 11086     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11087     MOVE CLMCARRI               TO AT-CARRIER.
 11088
 11089     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11090     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11091     MOVE +94                    TO AT-SEQUENCE-NO.
 11092     MOVE '6'                    TO AT-TRAILER-TYPE.
 11093     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11094
 11095     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11096
 11097     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11098                                    AT-GEN-INFO-LAST-MAINT-DT.
 11099
 11100     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11101                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11102     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11103
 11104
 11105
 11106* EXEC CICS WRITE
 11107*        DATASET   (ELTRLR-DSID)
 11108*        FROM      (ACTIVITY-TRAILERS)
 11109*        RIDFLD    (AT-CONTROL-PRIMARY)
 11110*    END-EXEC.
 11111     MOVE LENGTH OF
 11112      ACTIVITY-TRAILERS
 11113       TO DFHEIV11
 11114*    MOVE '&$ L                  ''   #00010317' TO DFHEIV0
 11115     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11116     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11117     MOVE X'2020233030303130333137' TO DFHEIV0(25:11)
 11118     CALL 'kxdfhei1' USING DFHEIV0,
 11119           ELTRLR-DSID,
 11120           ACTIVITY-TRAILERS,
 11121           DFHEIV11,
 11122           AT-CONTROL-PRIMARY,
 11123           DFHEIV99,
 11124           DFHEIV99
 11125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11126
 11127
 11128 3994B-EXIT.
 11129     EXIT.
 11130 3994C-BUILD-NINETY-FIVE-TRAILER.
 11131
 11132     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11133     MOVE 'AT'                   TO AT-RECORD-ID
 11134
 11135     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11136     MOVE CLMCARRI               TO AT-CARRIER
 11137
 11138     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11139     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11140     MOVE +95                    TO AT-SEQUENCE-NO
 11141     MOVE '6'                    TO AT-TRAILER-TYPE
 11142     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 211
* EL130.cbl
 11143
 11144     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11145                                    AT-GEN-INFO-LAST-MAINT-DT
 11146
 11147     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11148                                    AT-GEN-INFO-LAST-UPDATED-BY
 11149     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11150
 11151     perform varying e1 from +1 by +1 until
 11152        ws-error-no (e1) = spaces
 11153        move ws-error-no (e1)    to at-note-error-no (e1)
 11154     end-perform
 11155
 11156     if at-info-line-1 not = spaces
 11157
 11158* EXEC CICS WRITE
 11159*          DATASET  (ELTRLR-DSID)
 11160*          FROM     (ACTIVITY-TRAILERS)
 11161*          RIDFLD   (AT-CONTROL-PRIMARY)
 11162*       END-EXEC
 11163     MOVE LENGTH OF
 11164      ACTIVITY-TRAILERS
 11165       TO DFHEIV11
 11166*    MOVE '&$ L                  ''   #00010352' TO DFHEIV0
 11167     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11168     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11169     MOVE X'2020233030303130333532' TO DFHEIV0(25:11)
 11170     CALL 'kxdfhei1' USING DFHEIV0,
 11171           ELTRLR-DSID,
 11172           ACTIVITY-TRAILERS,
 11173           DFHEIV11,
 11174           AT-CONTROL-PRIMARY,
 11175           DFHEIV99,
 11176           DFHEIV99
 11177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11178     end-if
 11179
 11180     .
 11181 3994C-EXIT.
 11182     EXIT.
 11183 3995-BUILD-CLAIM-RECORD.
 11184     IF PROCCDL GREATER ZERO
 11185         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11186     ELSE
 11187         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11188     END-IF.
 11189
 11190     IF FSTNMEL GREATER ZERO
 11191         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11192     END-IF.
 11193
 11194     IF INITL GREATER ZERO
 11195         MOVE INITI              TO CL-INSURED-MID-INIT
 11196     END-IF.
 11197
 11198     IF BIRTHDTL GREATER ZERO
 11199         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11200     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 212
* EL130.cbl
 11201
 11202     IF SEXL GREATER ZERO
 11203         MOVE SEXI               TO CL-INSURED-SEX-CD
 11204     END-IF.
 11205
 11206     IF OCCCDL GREATER ZERO
 11207         MOVE OCCCDI             TO CL-INSURED-OCC-CD
 11208     END-IF.
 11209
 11210     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11211
 11212*    IF CLMTYPEL GREATER ZERO
 11213     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11214*    END-IF.
 11215
 11216     IF PREMTYPL GREATER ZERO
 11217         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11218     END-IF.
 11219
 11220     IF INCURL GREATER ZERO
 11221         MOVE WS-INCUR           TO CL-INCURRED-DT
 11222     END-IF.
 11223
 11224     IF (PI-COMPANY-ID = 'DCC')
 11225        AND (ERPDEF-FOUND)
 11226        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11227*       MOVE WS-CRIT-PER-RECURRENT
 11228*                                TO CL-CRIT-PER-RECURRENT
 11229*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11230     ELSE
 11231        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11232           MOVE CM-LF-CRITICAL-PERIOD
 11233                                 TO CL-CRITICAL-PERIOD
 11234        ELSE
 11235           MOVE CM-AH-CRITICAL-PERIOD
 11236                                 TO CL-CRITICAL-PERIOD
 11237        END-IF
 11238     END-IF
 11239
 11240     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11241        COMPUTE DC-ELAPSED-MONTHS =
 11242           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11243        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11244        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11245        MOVE '6'                 TO DC-OPTION-CODE
 11246        PERFORM 9700-LINK-DATE-CONVERT
 11247                                 THRU 9700-EXIT
 11248        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11249     END-IF
 11250
 11251     if instypel > zero
 11252        move instypei            to cl-insured-claim
 11253     end-if
 11254     IF REPORTL GREATER ZERO
 11255         MOVE WS-REPORT          TO CL-REPORTED-DT
 11256     END-IF.
 11257
 11258     IF EIBAID = DFHPF6
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 213
* EL130.cbl
 11259         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
 11260             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11261                 IF EMI-FORCABLE-CTR = +1
 11262                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11263                 END-IF
 11264         END-IF
 11265     END-IF.
 11266
 11267*    IF ESTENDL GREATER ZERO
 11268*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11269*    END-IF.
 11270
 11271     IF ADDONDTL GREATER ZERO
 11272         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11273     END-IF.
 11274
 11275*    IF CAUSEL GREATER ZERO
 11276*        MOVE CAUSEI             TO CL-CAUSE-CD
 11277*    END-IF.
 11278
 11279     IF SSNL GREATER ZERO
 11280         MOVE SSNI               TO CL-SOC-SEC-NO
 11281     ELSE
 11282         MOVE CERT-STATE         TO CL-SSN-STATE
 11283         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11284         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11285     END-IF.
 11286
 11287     IF PRICDL GREATER ZERO
 11288         MOVE PRICDI             TO CL-PRIORITY-CD
 11289     END-IF.
 11290
 11291     IF SUPVL GREATER ZERO
 11292         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11293     END-IF.
 11294
 11295     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11296     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11297     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11298
 11299     IF RELCLML GREATER ZERO
 11300         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11301     END-IF.
 11302
 11303     IF FILETOL GREATER ZERO
 11304         MOVE FILETOI            TO CL-FILE-LOCATION
 11305     END-IF.
 11306
 11307 3995-EXIT.
 11308      EXIT.
 11309 3996-read-cert-claim-trailer.
 11310
 11311     move cm-ah-benefit-amt      to ws-monthly-benefit
 11312     if pi-dcc-max-amt < ws-monthly-benefit
 11313        move pi-dcc-max-amt      to ws-monthly-benefit
 11314     end-if
 11315
 11316     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 214
* EL130.cbl
 11317     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11318     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11319     MOVE CM-STATE               TO CTRLR-STATE
 11320     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11321     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11322     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11323     MOVE 'B'                    TO CTRLR-REC-TYPE
 11324
 11325* EXEC CICS READ
 11326*       DATASET  (ELCRTT-DSID)
 11327*       set     (address of CERTIFICATE-TRAILERS)
 11328*       RIDFLD   (ELCRTT-KEY)
 11329*       RESP     (WS-RESPONSE)
 11330*    END-EXEC
 11331*    MOVE '&"S        E          (  N#00010503' TO DFHEIV0
 11332     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11334     MOVE X'204E233030303130353033' TO DFHEIV0(25:11)
 11335     CALL 'kxdfhei1' USING DFHEIV0,
 11336           ELCRTT-DSID,
 11337           DFHEIV20,
 11338           DFHEIV99,
 11339           ELCRTT-KEY,
 11340           DFHEIV99,
 11341           DFHEIV99,
 11342           DFHEIV99
 11343     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11344         DFHEIV20
 11345     MOVE EIBRESP  TO WS-RESPONSE
 11346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11347     IF WS-RESP-NORMAL
 11348*       if instypei = 'P'
 11349*          move +1 to s1
 11350*       else
 11351*          MOVE +2 to s1
 11352*       end-if
 11353
 11354        move +1 to s1
 11355        evaluate clmtypei
 11356           when 'A'
 11357              move +1 to s2
 11358           when 'I'
 11359              move +2 to s2
 11360           when 'G'
 11361              move +3 to s2
 11362           when 'L'
 11363              move +4 to s2
 11364           when 'P'
 11365              move +5 to s2
 11366        end-evaluate
 11367        if cs-claim-type (s1 s2) = clmtypei
 11368           if cs-no-of-claims (s1 s2) > zeros
 11369              move er-1659       to ws-error-no (e1)
 11370           end-if
 11371           compute WS-BENEFITS-PREV-PAID =
 11372              cs-total-paid (s1 s2) / ws-monthly-benefit
 11373           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11374              and (pi-dcc-max-benefits not = zeros)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 215
* EL130.cbl
 11375              add +1             to e1
 11376              MOVE ER-1660       TO EMI-ERROR
 11377                                    ws-error-no (e1)
 11378              PERFORM 9900-ERROR-FORMAT
 11379                                 THRU 9900-EXIT
 11380           end-if
 11381        end-if
 11382     end-if
 11383
 11384     .
 11385 3996-exit.
 11386     exit.
 11387
 11388 3997-GET-ERPDEF.
 11389
 11390     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 11391                                    WS-ERPDEF-SW
 11392     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11393                                    WS-CRIT-PER-RTW-MOS
 11394
 11395     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11396     MOVE CM-STATE            TO ERPDEF-STATE
 11397     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11398     MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11399     MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11400     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11401     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11402
 11403
 11404* EXEC CICS STARTBR
 11405*        DATASET  ('ERPDEF')
 11406*        RIDFLD   (ERPDEF-KEY)
 11407*        GTEQ
 11408*        RESP     (WS-RESPONSE)
 11409*    END-EXEC
 11410     MOVE 'ERPDEF' TO DFHEIV1
 11411     MOVE 0
 11412       TO DFHEIV11
 11413*    MOVE '&,         G          &  N#00010565' TO DFHEIV0
 11414     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11415     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11416     MOVE X'204E233030303130353635' TO DFHEIV0(25:11)
 11417     CALL 'kxdfhei1' USING DFHEIV0,
 11418           DFHEIV1,
 11419           ERPDEF-KEY,
 11420           DFHEIV99,
 11421           DFHEIV11,
 11422           DFHEIV99
 11423     MOVE EIBRESP  TO WS-RESPONSE
 11424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11425
 11426     IF WS-RESP-NORMAL
 11427
 11428* EXEC CICS READNEXT
 11429*          DATASET  ('ERPDEF')
 11430*          INTO     (PRODUCT-MASTER)
 11431*          RIDFLD   (ERPDEF-KEY)
 11432*          RESP     (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 216
* EL130.cbl
 11433*       END-EXEC
 11434     MOVE LENGTH OF
 11435      PRODUCT-MASTER
 11436       TO DFHEIV12
 11437     MOVE 'ERPDEF' TO DFHEIV1
 11438     MOVE 0
 11439       TO DFHEIV11
 11440*    MOVE '&.IL                  )  N#00010573' TO DFHEIV0
 11441     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11442     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11443     MOVE X'204E233030303130353733' TO DFHEIV0(25:11)
 11444     CALL 'kxdfhei1' USING DFHEIV0,
 11445           DFHEIV1,
 11446           PRODUCT-MASTER,
 11447           DFHEIV12,
 11448           ERPDEF-KEY,
 11449           DFHEIV99,
 11450           DFHEIV11,
 11451           DFHEIV99,
 11452           DFHEIV99
 11453     MOVE EIBRESP  TO WS-RESPONSE
 11454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11455
 11456        IF WS-RESP-NORMAL
 11457           IF (ERPDEF-KEY-SAVE (1:16) =
 11458              PD-CONTROL-PRIMARY (1:16))
 11459              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11460
 11461              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11462                 (A1 > +8)
 11463                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11464              END-PERFORM
 11465              IF A1 < +9
 11466
 11467                 SET ERPDEF-FOUND TO TRUE
 11468                 move pd-max-amt (a1)
 11469                              to pi-dcc-max-amt
 11470                 MOVE PD-CRIT-PERIOD (A1)
 11471                              TO WS-MAX-BENEFITS
 11472                                 pi-dcc-max-benefits
 11473                 MOVE PD-REC-CRIT-PERIOD (A1)
 11474                              TO WS-CRIT-PER-RECURRENT
 11475                 IF PD-RTW-MOS (A1) NUMERIC
 11476                    MOVE PD-RTW-MOS (A1)
 11477                              TO WS-CRIT-PER-RTW-MOS
 11478                 ELSE
 11479                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11480                 END-IF
 11481                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11482                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11483                                 TO WS-EXCL-PERIOD
 11484                 END-IF
 11485                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 11486                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11487                                 TO WS-COV-ENDS
 11488                 END-IF
 11489                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11490                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 217
* EL130.cbl
 11491                                 TO WS-ACC-PERIOD
 11492                 END-IF
 11493              END-IF
 11494           END-IF
 11495        END-IF
 11496     END-IF
 11497
 11498     .
 11499 3997-EXIT.
 11500     EXIT.
 11501
 11502 3998-update-cert-claim-trailer.
 11503
 11504
 11505* EXEC CICS GETMAIN
 11506*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11507*       LENGTH   (ELCRTT-LENGTH)
 11508*       INITIMG  (GETMAIN-SPACE)
 11509*    END-EXEC
 11510*    MOVE ',"IL                  $   #00010628' TO DFHEIV0
 11511     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11512     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11513     MOVE X'2020233030303130363238' TO DFHEIV0(25:11)
 11514     CALL 'kxdfhei1' USING DFHEIV0,
 11515           DFHEIV20,
 11516           ELCRTT-LENGTH,
 11517           GETMAIN-SPACE
 11518     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11519         DFHEIV20
 11520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11521
 11522     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11523     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11524     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11525     MOVE CM-STATE         TO CTRLR-STATE
 11526     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11527     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11528     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11529     MOVE 'B'              TO CTRLR-REC-TYPE
 11530
 11531* EXEC CICS READ
 11532*       UPDATE
 11533*       DATASET  (ELCRTT-DSID)
 11534*       into     (CERTIFICATE-TRAILERS)
 11535*       RIDFLD   (ELCRTT-KEY)
 11536*       RESP     (WS-RESPONSE)
 11537*    END-EXEC
 11538     MOVE LENGTH OF
 11539      CERTIFICATE-TRAILERS
 11540       TO DFHEIV11
 11541*    MOVE '&"IL       EU         (  N#00010642' TO DFHEIV0
 11542     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11543     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11544     MOVE X'204E233030303130363432' TO DFHEIV0(25:11)
 11545     CALL 'kxdfhei1' USING DFHEIV0,
 11546           ELCRTT-DSID,
 11547           CERTIFICATE-TRAILERS,
 11548           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 218
* EL130.cbl
 11549           ELCRTT-KEY,
 11550           DFHEIV99,
 11551           DFHEIV99,
 11552           DFHEIV99
 11553     MOVE EIBRESP  TO WS-RESPONSE
 11554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11555     IF WS-RESP-NORMAL
 11556        perform 3999-upd-crt-trlr thru 3999-exit
 11557
 11558* EXEC CICS REWRITE
 11559*          DATASET  (ELCRTT-DSID)
 11560*          from     (CERTIFICATE-TRAILERS)
 11561*          RESP     (WS-RESPONSE)
 11562*       END-EXEC
 11563     MOVE LENGTH OF
 11564      CERTIFICATE-TRAILERS
 11565       TO DFHEIV11
 11566*    MOVE '&& L                  %  N#00010651' TO DFHEIV0
 11567     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11568     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11569     MOVE X'204E233030303130363531' TO DFHEIV0(25:11)
 11570     CALL 'kxdfhei1' USING DFHEIV0,
 11571           ELCRTT-DSID,
 11572           CERTIFICATE-TRAILERS,
 11573           DFHEIV11,
 11574           DFHEIV99
 11575     MOVE EIBRESP  TO WS-RESPONSE
 11576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11577     else
 11578        if ws-resp-notfnd
 11579           move 'CS'             to certificate-trailers
 11580           move cm-control-primary to cs-control-primary
 11581           move 'B'              to cs-trailer-type
 11582           perform varying s1 from +1 by +1 until s1 > +2
 11583              perform varying s2 from +1 by +1 until s2 > +10
 11584                 move zeros      to cs-bank (s1 s2)
 11585                                    cs-no-of-claims (s1 s2)
 11586                                    cs-days-paid (s1 s2)
 11587                                    cs-total-paid (s1 s2)
 11588              end-perform
 11589           end-perform
 11590           perform 3999-upd-crt-trlr
 11591                                 thru 3999-exit
 11592
 11593* EXEC CICS WRITE
 11594*             DATASET  (ELCRTT-DSID)
 11595*             from     (CERTIFICATE-TRAILERS)
 11596*             RIDFLD   (cs-control-primary)
 11597*             RESP     (WS-RESPONSE)
 11598*          END-EXEC
 11599     MOVE LENGTH OF
 11600      CERTIFICATE-TRAILERS
 11601       TO DFHEIV11
 11602*    MOVE '&$ L                  ''  N#00010671' TO DFHEIV0
 11603     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11604     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11605     MOVE X'204E233030303130363731' TO DFHEIV0(25:11)
 11606     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 219
* EL130.cbl
 11607           ELCRTT-DSID,
 11608           CERTIFICATE-TRAILERS,
 11609           DFHEIV11,
 11610           cs-control-primary,
 11611           DFHEIV99,
 11612           DFHEIV99
 11613     MOVE EIBRESP  TO WS-RESPONSE
 11614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11615        end-if
 11616     END-IF
 11617
 11618     .
 11619 3998-exit.
 11620     exit.
 11621
 11622 3999-upd-crt-trlr.
 11623
 11624*    if instypei = 'P'
 11625*       move +1 to s1
 11626*    else
 11627*       MOVE +2 to s1
 11628*    end-if
 11629
 11630     move +1 to s1
 11631     evaluate clmtypei
 11632        when 'A'
 11633           move +1 to s2
 11634        when 'I'
 11635           move +2 to s2
 11636        when 'G'
 11637           move +3 to s2
 11638        when 'L'
 11639           move +4 to s2
 11640        when 'P'
 11641           move +5 to s2
 11642     end-evaluate
 11643
 11644     move clmtypei         to cs-claim-type (s1 s2)
 11645     add +1                to cs-no-of-claims (s1 s2)
 11646
 11647     .
 11648 3999-exit.
 11649     exit.
 11650 4000-CALCULATE-CERT-TERM.
 11651
 11652     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11653
 11654     MOVE N                      TO WS-TERM.
 11655
 11656     IF WS-TERM GREATER 120
 11657         MOVE 120                TO WS-TERM
 11658     END-IF.
 11659
 11660 4000-CALC-TERM-EXIT.
 11661      EXIT.
 11662
 11663 4100-CALC-GROSS-TERM.
 11664     MOVE HOLD-LOAN-BAL           TO L.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 220
* EL130.cbl
 11665     MOVE WS-ACVBENE              TO M.
 11666     COMPUTE N = L / M.
 11667     IF N LESS 1
 11668         MOVE 1  TO N
 11669     END-IF.
 11670
 11671     IF LCVCDL GREATER ZERO
 11672         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11673     ELSE
 11674         MOVE ZEROS               TO WS-LF-RATE
 11675     END-IF.
 11676
 11677     IF ACVCDL GREATER ZERO
 11678         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11679     ELSE
 11680         MOVE ZEROS               TO WS-AH-RATE
 11681     END-IF.
 11682
 11683     COMPUTE I = WS-APR / +1200.
 11684
 11685 4105-LOOP.
 11686     IF N GREATER 240
 11687         GO TO 4200-EXIT
 11688     END-IF.
 11689
 11690     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 11691
 11692     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 11693         ADD 1 TO N
 11694         GO TO 4105-LOOP
 11695     END-IF.
 11696
 11697 4200-EXIT.
 11698      EXIT.
 11699
 11700 4210-CALC-LEFT-RIGHTONE.
 11701      MOVE L         TO LEFT-TOT-1.
 11702      SUBTRACT 1 FROM N.
 11703      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11704      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 11705      ADD 1 TO N.
 11706
 11707 4211-CALC-TERM1.
 11708      MOVE N         TO TERM1.
 11709      MULTIPLY M BY TERM1.
 11710
 11711 4212-LOOP.
 11712      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 11713      ADD 1 TO A-N.
 11714      MULTIPLY A-N BY TERM1.
 11715      SUBTRACT 1 FROM A-N.
 11716      ADD TERM1 TO LEFT-TOT-1.
 11717
 11718 4213-CALC-TERM2.
 11719      MOVE M         TO TERM2.
 11720      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 11721      MULTIPLY IA-N BY TERM2.
 11722      SUBTRACT TERM2 FROM LEFT-TOT-1.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 221
* EL130.cbl
 11723
 11724 4215-CALC-RIGHTONE.
 11725      MOVE M         TO RIGHT-TOT-1.
 11726      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11727      MULTIPLY A-N BY RIGHT-TOT-1.
 11728
 11729 4220-EXIT.
 11730      EXIT.
 11731
 11732 4300-CALC-A-N.
 11733     IF N LESS 1
 11734         MOVE 0     TO A-N
 11735         GO TO 4300-EXIT
 11736     END-IF.
 11737
 11738     IF I = 0
 11739         MOVE .00001 TO I
 11740     END-IF.
 11741
 11742     ADD 1 TO I.
 11743     DIVIDE I INTO 1 GIVING V.
 11744     SUBTRACT 1 FROM I.
 11745     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11746     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 11747     DIVIDE I INTO TERM3 GIVING A-N.
 11748
 11749 4300-EXIT.
 11750      EXIT.
 11751
 11752 4350-CALC-IA-N.
 11753     IF N LESS 1
 11754         MOVE 0      TO IA-N
 11755         GO TO 4400-EXIT
 11756     END-IF.
 11757
 11758     ADD 1 TO N.
 11759     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11760     SUBTRACT 1 FROM N.
 11761     MULTIPLY N BY V-EX-N GIVING TERM3.
 11762     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 11763     SUBTRACT V FROM 1 GIVING TERM4.
 11764     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 11765
 11766 4400-EXIT.
 11767      EXIT.
 11768
 11769 4450-CALC-V-EX-N.
 11770     IF N LESS 1
 11771         MOVE 1    TO V-EX-N
 11772         GO TO 4490-EXIT
 11773     END-IF.
 11774
 11775     MOVE N        TO NV-STORE.
 11776
 11777     IF V-EX-ONETIME = 1  OR
 11778        V NOT = V-EXPONENT (1)
 11779          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 11780     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 222
* EL130.cbl
 11781
 11782 4460-LOOP.
 11783     IF N GREATER 248
 11784         MOVE 248 TO N
 11785     END-IF.
 11786
 11787     IF N = 1
 11788         MOVE V               TO V-EX-N
 11789     ELSE
 11790         MOVE V-EXPONENT (N)  TO V-EX-N
 11791     END-IF.
 11792
 11793     GO TO 4490-EXIT.
 11794
 11795 4470-BUILD-V-EX-TABLE.
 11796     MOVE 2      TO N.
 11797     MOVE V      TO V-EXPONENT (1)
 11798                    V-EX-N.
 11799
 11800 4471-LOOP.
 11801     MULTIPLY V BY V-EX-N.
 11802     MOVE V-EX-N   TO V-EXPONENT (N).
 11803
 11804     ADD 1 TO N.
 11805     IF N LESS 248
 11806         GO TO 4471-LOOP
 11807     END-IF.
 11808
 11809     MOVE NV-STORE     TO N.
 11810     MOVE ZERO         TO V-EX-ONETIME.
 11811
 11812 4480-EXIT.
 11813      EXIT.
 11814
 11815 4490-EXIT.
 11816      EXIT.
 11817
 11818 4500-CALC-NET-TERM.
 11819     MOVE HOLD-LOAN-BAL           TO L.
 11820     MOVE WS-ACVBENE              TO M.
 11821     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 11822
 11823     IF WS-REMAIN GREATER ZERO
 11824         ADD 1 TO N
 11825     END-IF.
 11826
 11827     IF N = 0
 11828         MOVE 1 TO N
 11829     END-IF.
 11830
 11831 4700-EXIT.
 11832      EXIT.
 11833
 11834 4999-CALC-TERM-EXIT.
 11835     EXIT.
 11836
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 223
* EL130.cbl
 11838 5000-INCURRED-CHANGE.
 11839     IF NOT MODIFY-CAP
 11840         MOVE ER-0070            TO EMI-ERROR
 11841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11842         MOVE -1                 TO MAINTL
 11843         GO TO 8200-SEND-DATAONLY
 11844     END-IF.
 11845
 11846     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11847        CLMCARRI     NOT = PI-LAST-CARR        OR
 11848        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11849        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11850        PI-INCURR-SW NOT = 'Y'
 11851          GO TO 1000-SHOW-CLAIM
 11852     END-IF.
 11853
 11854     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11855     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11856     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11857
 11858     IF EMI-NO-ERRORS
 11859         GO TO 5000-TRY-TO-BUILD
 11860     END-IF.
 11861
 11862     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11863        MOVE ER-0433             TO EMI-ERROR
 11864        MOVE -1                  TO MAINTL
 11865        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11866        GO TO 8200-SEND-DATAONLY
 11867     END-IF.
 11868
 11869     IF EIBAID = DFHPF6
 11870         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11871            MOVE ER-0434         TO EMI-ERROR
 11872            MOVE -1              TO MAINTL
 11873            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11874            GO TO 8200-SEND-DATAONLY
 11875         ELSE
 11876            MOVE +1              TO INCURL
 11877            GO TO 5000-TRY-TO-BUILD
 11878         END-IF
 11879     END-IF.
 11880
 11881     GO TO 8200-SEND-DATAONLY.
 11882
 11883 5000-TRY-TO-BUILD.
 11884
 11885     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11886
 11887     MOVE CLMCARRI               TO MSTR-CARRIER.
 11888
 11889     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11890     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11891     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11892
 11893     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11894
 11895     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 224
* EL130.cbl
 11896         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11897     END-IF.
 11898
 11899     IF CL-PURGED-DT NOT = LOW-VALUES
 11900
 11901
 11902* EXEC CICS UNLOCK
 11903*            DATASET   (ELMSTR-DSID)
 11904*        END-EXEC
 11905*    MOVE '&*                    #   #00010963' TO DFHEIV0
 11906     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11907     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11908     MOVE X'2020233030303130393633' TO DFHEIV0(25:11)
 11909     CALL 'kxdfhei1' USING DFHEIV0,
 11910           ELMSTR-DSID,
 11911           DFHEIV99
 11912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11913         MOVE ER-7691            TO EMI-ERROR
 11914         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11915         MOVE -1                 TO MAINTL
 11916         GO TO 8200-SEND-DATAONLY
 11917     END-IF.
 11918
 11919     IF CL-AUTO-PAY-SEQ NOT = ZERO
 11920
 11921
 11922* EXEC CICS UNLOCK
 11923*            DATASET   (ELMSTR-DSID)
 11924*       END-EXEC
 11925*    MOVE '&*                    #   #00010974' TO DFHEIV0
 11926     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11927     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11928     MOVE X'2020233030303130393734' TO DFHEIV0(25:11)
 11929     CALL 'kxdfhei1' USING DFHEIV0,
 11930           ELMSTR-DSID,
 11931           DFHEIV99
 11932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11933         MOVE ER-0523             TO EMI-ERROR
 11934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11935         MOVE -1                  TO MAINTL
 11936         GO TO 8200-SEND-DATAONLY
 11937     END-IF.
 11938
 11939     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 11940
 11941     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 11942     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 11943     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 11944     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 11945     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 11946
 11947     IF MANRSVL GREATER ZERO
 11948        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 11949                                    AT-CURRENT-MANUAL-RESERVE
 11950     END-IF.
 11951     MOVE 1                      TO SUB.
 11952
 11953 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 225
* EL130.cbl
 11954     IF SUB = 1
 11955        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 11956        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 11957        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 11958     ELSE
 11959        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 11960        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 11961                                    AT-OPEN-CLOSE-REASON (SUB)
 11962     END-IF.
 11963
 11964     IF SUB NOT = 6
 11965        ADD 1                    TO SUB
 11966        GO TO 5010-LOOP
 11967     END-IF.
 11968
 11969 5020-UPDATE.
 11970
 11971     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11972
 11973     IF DIAGL = ZERO
 11974       AND ICD1L = ZERO
 11975       AND ICD2L = ZERO
 11976         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 11977         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 11978         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 11979         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 11980         GO TO 5025-BYPASS-UPDATE
 11981     END-IF.
 11982
 11983     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 11984
 11985     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 11986     IF DIAGL NOT = ZERO
 11987         MOVE DIAGI              TO AT-INFO-LINE-1
 11988     END-IF.
 11989
 11990     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 11991     IF ICD1L NOT = ZERO
 11992         MOVE ICD1I              TO AT-ICD-CODE-1
 11993     END-IF.
 11994
 11995     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 11996     IF ICD2L NOT = ZERO
 11997         MOVE ICD2I              TO AT-ICD-CODE-2
 11998     END-IF.
 11999
 12000     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12001
 12002 5025-BYPASS-UPDATE.
 12003
 12004
 12005
 12006* EXEC CICS GETMAIN
 12007*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12008*        LENGTH   (ELTRLR-LENGTH)
 12009*    END-EXEC.
 12010*    MOVE '," L                  $   #00011049' TO DFHEIV0
 12011     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 226
* EL130.cbl
 12012     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12013     MOVE X'2020233030303131303439' TO DFHEIV0(25:11)
 12014     CALL 'kxdfhei1' USING DFHEIV0,
 12015           DFHEIV20,
 12016           ELTRLR-LENGTH,
 12017           DFHEIV99
 12018     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12019         DFHEIV20
 12020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12021
 12022
 12023     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12024     MOVE 'AT'                   TO AT-RECORD-ID.
 12025
 12026     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12027     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12028     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12029     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12030     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12031     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12032     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12033     MOVE '9'                    TO AT-TRAILER-TYPE.
 12034     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12035     MOVE '5'                    TO DC-OPTION-CODE.
 12036     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12037     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12038
 12039     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12040     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12041
 12042     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12043     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12044     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12045     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12046     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12047     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12048     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12049     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12050     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12051     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12052     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12053     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12054
 12055     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12056     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12057     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12058     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12059     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12060
 12061
 12062
 12063* EXEC CICS WRITE
 12064*        DATASET   (ELTRLR-DSID)
 12065*        FROM      (ACTIVITY-TRAILERS)
 12066*        RIDFLD    (AT-CONTROL-PRIMARY)
 12067*    END-EXEC.
 12068     MOVE LENGTH OF
 12069      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 227
* EL130.cbl
 12070       TO DFHEIV11
 12071*    MOVE '&$ L                  ''   #00011093' TO DFHEIV0
 12072     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12073     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12074     MOVE X'2020233030303131303933' TO DFHEIV0(25:11)
 12075     CALL 'kxdfhei1' USING DFHEIV0,
 12076           ELTRLR-DSID,
 12077           ACTIVITY-TRAILERS,
 12078           DFHEIV11,
 12079           AT-CONTROL-PRIMARY,
 12080           DFHEIV99,
 12081           DFHEIV99
 12082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12083
 12084
 12085     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12086     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12087     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12088     MOVE CL-CERT-STATE          TO CERT-STATE.
 12089     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12090     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12091     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12092
 12093
 12094
 12095* EXEC CICS HANDLE CONDITION
 12096*        NOTFND   (5050-CERT-NOT-FOUND)
 12097*    END-EXEC.
 12098*    MOVE '"$I                   ! ; #00011108' TO DFHEIV0
 12099     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12101     MOVE X'3B20233030303131313038' TO DFHEIV0(25:11)
 12102     CALL 'kxdfhei1' USING DFHEIV0
 12103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12104
 12105
 12106     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12107
 12108     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12109
 12110
 12111
 12112* EXEC CICS HANDLE CONDITION
 12113*         DUPKEY   (5030-CERT-WRITTEN)
 12114*    END-EXEC.
 12115*    MOVE '"$$                   ! < #00011117' TO DFHEIV0
 12116     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12117     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12118     MOVE X'3C20233030303131313137' TO DFHEIV0(25:11)
 12119     CALL 'kxdfhei1' USING DFHEIV0
 12120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12121
 12122
 12123
 12124
 12125* EXEC CICS REWRITE
 12126*        DATASET  (ELCERT-DSID)
 12127*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 228
* EL130.cbl
 12128*    END-EXEC.
 12129     MOVE LENGTH OF
 12130      CERTIFICATE-MASTER
 12131       TO DFHEIV11
 12132*    MOVE '&& L                  %   #00011122' TO DFHEIV0
 12133     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12134     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12135     MOVE X'2020233030303131313232' TO DFHEIV0(25:11)
 12136     CALL 'kxdfhei1' USING DFHEIV0,
 12137           ELCERT-DSID,
 12138           CERTIFICATE-MASTER,
 12139           DFHEIV11,
 12140           DFHEIV99
 12141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12142
 12143
 12144 5030-CERT-WRITTEN.
 12145
 12146     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12147                                    CL-INCURRED-DT
 12148                                    CL-REPORTED-DT
 12149                                    CL-EST-END-OF-DISAB-DT
 12150                                    CL-PAID-THRU-DT.
 12151
 12152     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12153                                    CL-NO-OF-PMTS-MADE
 12154                                    CL-NO-OF-DAYS-PAID.
 12155
 12156     IF CLAIM-IS-CLOSED
 12157        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12158        MOVE 'O'                 TO CL-CLAIM-STATUS
 12159     END-IF.
 12160
 12161     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12162     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12163     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12164
 12165
 12166
 12167* EXEC CICS HANDLE CONDITION
 12168*         DUPKEY   (5035-CLAIM-WRITTEN)
 12169*    END-EXEC.
 12170*    MOVE '"$$                   ! = #00011149' TO DFHEIV0
 12171     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12173     MOVE X'3D20233030303131313439' TO DFHEIV0(25:11)
 12174     CALL 'kxdfhei1' USING DFHEIV0
 12175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12176
 12177
 12178
 12179
 12180* EXEC CICS REWRITE
 12181*        DATASET   (ELMSTR-DSID)
 12182*        FROM      (CLAIM-MASTER)
 12183*    END-EXEC.
 12184     MOVE LENGTH OF
 12185      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 229
* EL130.cbl
 12186       TO DFHEIV11
 12187*    MOVE '&& L                  %   #00011154' TO DFHEIV0
 12188     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12189     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12190     MOVE X'2020233030303131313534' TO DFHEIV0(25:11)
 12191     CALL 'kxdfhei1' USING DFHEIV0,
 12192           ELMSTR-DSID,
 12193           CLAIM-MASTER,
 12194           DFHEIV11,
 12195           DFHEIV99
 12196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12197
 12198
 12199 5035-CLAIM-WRITTEN.
 12200
 12201     MOVE ER-0000                TO EMI-ERROR.
 12202     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12203
 12204     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12205     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12206     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12207     MOVE CLMCARRI               TO PI-LAST-CARR.
 12208
 12209     IF PRTOPTL GREATER ZERO
 12210         MOVE PRTOPTI            TO PI-PRT-OPT
 12211     END-IF.
 12212
 12213     IF ALTPRTL GREATER ZERO
 12214         MOVE ALTPRTI            TO PI-ALT-PRT
 12215     END-IF.
 12216
 12217     MOVE LOW-VALUES             TO EL130AI.
 12218
 12219     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12220     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12221     MOVE PI-LAST-CARR           TO CLMCARRO.
 12222     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12223
 12224     IF PI-PRT-OPT = 'N' OR 'L'
 12225         MOVE PI-PRT-OPT         TO PRTOPTO
 12226         MOVE 1                  TO PRTOPTL
 12227     END-IF.
 12228
 12229     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12230         MOVE PI-ALT-PRT         TO ALTPRTO
 12231         MOVE 4                  TO ALTPRTL
 12232     END-IF.
 12233
 12234     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12235     MOVE AL-SANON               TO CERTNOA SUFXA.
 12236
 12237     MOVE SPACES                 TO PI-INCURR-SW.
 12238
 12239     IF PRTOPTL GREATER ZERO
 12240         IF PRTOPTI = 'L'
 12241             GO TO 0400-CREATE-ELACTQ
 12242         ELSE
 12243             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 230
* EL130.cbl
 12244         END-IF
 12245     END-IF.
 12246
 12247     GO TO 8100-SEND-INITIAL-MAP.
 12248
 12249 5050-CERT-NOT-FOUND.
 12250
 12251     MOVE ER-0244                TO EMI-ERROR.
 12252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12253     MOVE -1                     TO CERTNOL.
 12254     GO TO 8200-SEND-DATAONLY.
 12255
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 231
* EL130.cbl
 12257 5500-BUILD-FORM-TRAILER.
 12258*************************************************************
 12259*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12260*************************************************************
 12261
 12262     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12263
 12264     IF  WS-BEN-ALPHA-2 = '30'
 12265         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12266         MOVE '6'                TO DC-OPTION-CODE
 12267         IF CL-CARRIER = 'C'
 12268             MOVE +14            TO DC-ELAPSED-DAYS
 12269             MOVE +0             TO DC-ELAPSED-MONTHS
 12270             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12271             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12272         ELSE
 12273             MOVE +21            TO DC-ELAPSED-DAYS
 12274             MOVE +0             TO DC-ELAPSED-MONTHS
 12275             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12276             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12277         END-IF
 12278     END-IF.
 12279
 12280
 12281
 12282* EXEC CICS GETMAIN
 12283*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12284*         LENGTH   (ELTRLR-LENGTH)
 12285*         INITIMG  (GETMAIN-SPACE)
 12286*    END-EXEC.
 12287*    MOVE ',"IL                  $   #00011241' TO DFHEIV0
 12288     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12289     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12290     MOVE X'2020233030303131323431' TO DFHEIV0(25:11)
 12291     CALL 'kxdfhei1' USING DFHEIV0,
 12292           DFHEIV20,
 12293           ELTRLR-LENGTH,
 12294           GETMAIN-SPACE
 12295     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12296         DFHEIV20
 12297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12298
 12299
 12300     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12301     MOVE 'AT'                   TO AT-RECORD-ID.
 12302
 12303     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12304     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12305     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12306     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12307                                    AT-FORM-LAST-MAINT-DT.
 12308     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12309                                    AT-FORM-LAST-UPDATED-BY.
 12310     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12311     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12312     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12313                                    AT-FORM-RE-SEND-DT
 12314                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 232
* EL130.cbl
 12315                                    AT-EMP-FORM-ANSWERED-DT
 12316                                    AT-PHY-FORM-ANSWERED-DT
 12317                                    AT-EMP-FORM-SEND-ON-DT
 12318                                    AT-FORM-PRINTED-DT
 12319                                    AT-FORM-REPRINT-DT.
 12320     MOVE '1'                    TO AT-FORM-TYPE.
 12321
 12322     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12323                                    AT-INSTRUCT-LN-2
 12324                                    AT-INSTRUCT-LN-3.
 12325
 12326     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12327     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12328
 12329     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12330
 12331     IF AM-EMPLOYER-STMT-USED = 'Y'
 12332        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12333     END-IF.
 12334
 12335
 12336
 12337* EXEC CICS WRITE
 12338*         DATASET  (ELTRLR-DSID)
 12339*         FROM     (ACTIVITY-TRAILERS)
 12340*         RIDFLD   (AT-CONTROL-PRIMARY)
 12341*    END-EXEC.
 12342     MOVE LENGTH OF
 12343      ACTIVITY-TRAILERS
 12344       TO DFHEIV11
 12345*    MOVE '&$ L                  ''   #00011283' TO DFHEIV0
 12346     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12347     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12348     MOVE X'2020233030303131323833' TO DFHEIV0(25:11)
 12349     CALL 'kxdfhei1' USING DFHEIV0,
 12350           ELTRLR-DSID,
 12351           ACTIVITY-TRAILERS,
 12352           DFHEIV11,
 12353           AT-CONTROL-PRIMARY,
 12354           DFHEIV99,
 12355           DFHEIV99
 12356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12357
 12358
 12359 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 233
* EL130.cbl
 12361*************************************************************
 12362*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12363*************************************************************
 12364
 12365 5700-BUILD-ARCHIVE-HEADER.
 12366
 12367     MOVE '1'                    TO CNTL-REC-TYPE.
 12368     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12369     MOVE SPACES                 TO CNTL-ACCESS.
 12370
 12371
 12372
 12373* EXEC CICS READ
 12374*         DATASET  (ELCNTL-DSID)
 12375*         SET      (ADDRESS OF CONTROL-FILE)
 12376*         RIDFLD   (ELCNTL-KEY)
 12377*         UPDATE
 12378*    END-EXEC.
 12379*    MOVE '&"S        EU         (   #00011302' TO DFHEIV0
 12380     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12381     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12382     MOVE X'2020233030303131333032' TO DFHEIV0(25:11)
 12383     CALL 'kxdfhei1' USING DFHEIV0,
 12384           ELCNTL-DSID,
 12385           DFHEIV20,
 12386           DFHEIV99,
 12387           ELCNTL-KEY,
 12388           DFHEIV99,
 12389           DFHEIV99,
 12390           DFHEIV99
 12391     SET ADDRESS OF CONTROL-FILE TO
 12392         DFHEIV20
 12393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12394
 12395
 12396     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12397
 12398     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12399
 12400
 12401
 12402* EXEC CICS REWRITE
 12403*         FROM     (CONTROL-FILE)
 12404*         DATASET  (ELCNTL-DSID)
 12405*    END-EXEC.
 12406     MOVE LENGTH OF
 12407      CONTROL-FILE
 12408       TO DFHEIV11
 12409*    MOVE '&& L                  %   #00011314' TO DFHEIV0
 12410     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12411     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12412     MOVE X'2020233030303131333134' TO DFHEIV0(25:11)
 12413     CALL 'kxdfhei1' USING DFHEIV0,
 12414           ELCNTL-DSID,
 12415           CONTROL-FILE,
 12416           DFHEIV11,
 12417           DFHEIV99
 12418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 234
* EL130.cbl
 12419
 12420
 12421
 12422
 12423* EXEC CICS HANDLE CONDITION
 12424*         NOTOPEN  (9990-ABEND)
 12425*         DUPKEY   (5799-EXIT)
 12426*    END-EXEC.
 12427*    MOVE '"$J$                  ! > #00011320' TO DFHEIV0
 12428     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12430     MOVE X'3E20233030303131333230' TO DFHEIV0(25:11)
 12431     CALL 'kxdfhei1' USING DFHEIV0
 12432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12433
 12434
 12435
 12436
 12437* EXEC CICS GETMAIN
 12438*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12439*         LENGTH  (ELARCH-LENGTH)
 12440*    END-EXEC.
 12441*    MOVE '," L                  $   #00011326' TO DFHEIV0
 12442     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12443     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12444     MOVE X'2020233030303131333236' TO DFHEIV0(25:11)
 12445     CALL 'kxdfhei1' USING DFHEIV0,
 12446           DFHEIV20,
 12447           ELARCH-LENGTH,
 12448           DFHEIV99
 12449     SET ADDRESS OF LETTER-ARCHIVE TO
 12450         DFHEIV20
 12451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12452
 12453
 12454     MOVE SPACES                 TO LETTER-ARCHIVE.
 12455     MOVE 'LA'                   TO LA-RECORD-ID.
 12456     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12457                                    LA-ARCHIVE-NO-A1.
 12458     MOVE '4'                    TO LA-RECORD-TYPE
 12459                                    LA-RECORD-TYPE-A1.
 12460     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12461                                    LA-LINE-SEQ-NO-A1.
 12462     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12463                                    LA-COMPANY-CD-A1.
 12464     MOVE CL-CARRIER             TO LA4-CARRIER.
 12465     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12466     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12467     MOVE CL-CERT-STATE          TO LA4-STATE.
 12468     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12469     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12470     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12471     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12472                                    LA4-RESEND-PRINT-DATE
 12473                                    LA4-FORM-REM-PRINT-DT
 12474                                    LA4-RESEND-DATE.
 12475     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12476     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 235
* EL130.cbl
 12477
 12478
 12479
 12480* EXEC CICS WRITE
 12481*         DATASET  (ELARCH-DSID)
 12482*         FROM     (LETTER-ARCHIVE)
 12483*         RIDFLD   (LA-CONTROL-PRIMARY)
 12484*    END-EXEC.
 12485     MOVE LENGTH OF
 12486      LETTER-ARCHIVE
 12487       TO DFHEIV11
 12488*    MOVE '&$ L                  ''   #00011356' TO DFHEIV0
 12489     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12490     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12491     MOVE X'2020233030303131333536' TO DFHEIV0(25:11)
 12492     CALL 'kxdfhei1' USING DFHEIV0,
 12493           ELARCH-DSID,
 12494           LETTER-ARCHIVE,
 12495           DFHEIV11,
 12496           LA-CONTROL-PRIMARY,
 12497           DFHEIV99,
 12498           DFHEIV99
 12499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12500
 12501
 12502 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 236
* EL130.cbl
 12504 6000-EDIT-CLAIM-DATA.
 12505
 12506     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12507     MOVE '2'                    TO DC-OPTION-CODE.
 12508     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12509     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12510
 12511     IF CLMNOL GREATER ZERO
 12512         IF CLMNOI = SPACES OR LOW-VALUES
 12513             MOVE -1             TO CLMNOL
 12514             MOVE AL-UABON       TO CLMNOA
 12515             MOVE ER-7688        TO EMI-ERROR
 12516             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12517         ELSE
 12518             MOVE AL-UANON       TO CLMNOA
 12519         END-IF
 12520     END-IF.
 12521
 12522     IF CERTNOL = ZERO
 12523         MOVE -1                 TO CERTNOL
 12524         MOVE AL-SABON           TO CERTNOA
 12525         MOVE ER-0203            TO EMI-ERROR
 12526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12527     ELSE
 12528         MOVE AL-SANON           TO CERTNOA
 12529     END-IF.
 12530
 12531     IF SUFXL = ZERO
 12532         MOVE SPACES             TO SUFXI
 12533         MOVE AL-SANON           TO SUFXA
 12534     ELSE
 12535         MOVE AL-SANON           TO SUFXA
 12536     END-IF.
 12537
 12538     IF CLMCARRL = ZERO
 12539         MOVE -1                 TO CLMCARRL
 12540         MOVE ER-0194            TO EMI-ERROR
 12541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12542     ELSE
 12543         MOVE CLMCARRI           TO PI-CARRIER
 12544         IF PI-NO-CARRIER-SECURITY
 12545             MOVE AL-UANON       TO CLMCARRA
 12546         END-IF
 12547     END-IF.
 12548
 12549     IF CLMTYPEL > ZERO
 12550        IF ((PI-COMPANY-ID = 'DCC')
 12551           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12552              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 12553                        OR
 12554           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12555           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12556              AND PI-AH-OVERRIDE-L1))
 12557              MOVE -1             TO CLMTYPEL
 12558              MOVE AL-UABON       TO CLMTYPEA
 12559              MOVE ER-7634        TO EMI-ERROR
 12560              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12561        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 237
* EL130.cbl
 12562           MOVE AL-UANON       TO CLMTYPEA
 12563        END-IF
 12564     ELSE
 12565        IF MAINTI = 'A'
 12566           MOVE -1             TO CLMTYPEL
 12567           MOVE AL-UABON       TO CLMTYPEA
 12568           MOVE ER-0546        TO EMI-ERROR
 12569           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12570        END-IF
 12571     END-IF
 12572*    if instypel > ZERO
 12573*       if instypei = 'P' OR 'S'
 12574*          move al-uanon         to instypea
 12575*       else
 12576*          MOVE -1               TO INSTYPEL
 12577*          MOVE AL-UABON         TO INSTYPEA
 12578*          MOVE ER-1654          TO EMI-ERROR
 12579*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12580*       END-IF
 12581*    ELSE
 12582*       IF MAINTI = 'A'
 12583*          MOVE -1               TO INSTYPEL
 12584*          MOVE AL-UABON         TO INSTYPEA
 12585*          MOVE ER-1654          TO EMI-ERROR
 12586*          PERFORM 9900-ERROR-FORMAT
 12587*                                THRU 9900-EXIT
 12588*       END-IF
 12589*    END-IF
 12590     IF PCERTNOL = ZERO
 12591        MOVE CERTNOI             TO PCERTNOI
 12592        MOVE CERTNOL             TO PCERTNOL
 12593        MOVE AL-UANON            TO PCERTNOA
 12594     ELSE
 12595        MOVE AL-UANON            TO PCERTNOA
 12596     END-IF.
 12597
 12598     IF PSUFXL = ZERO
 12599        MOVE SUFXI               TO PSUFXI
 12600        MOVE SUFXL               TO PSUFXL
 12601        MOVE AL-UANON            TO PSUFXA
 12602     ELSE
 12603        MOVE AL-UANON            TO PSUFXA
 12604     END-IF.
 12605
 12606     IF MAINTI = 'I'
 12607         GO TO 6020-EDIT
 12608     END-IF.
 12609
 12610     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12611         MOVE -1                 TO LSTNMEL
 12612         MOVE ER-0236            TO EMI-ERROR
 12613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12614     ELSE
 12615         MOVE AL-UANON           TO LSTNMEA
 12616     END-IF.
 12617     IF SEXL > ZEROS
 12618        IF SEXI = 'M' OR 'F'
 12619           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 238
* EL130.cbl
 12620        ELSE
 12621           MOVE -1               TO SEXL
 12622           MOVE AL-UABON         TO SEXA
 12623           MOVE ER-0219          TO EMI-ERROR
 12624           PERFORM 9900-ERROR-FORMAT
 12625                                 THRU 9900-EXIT
 12626        END-IF
 12627     ELSE
 12628        IF MAINTI = 'A'
 12629           MOVE -1               TO SEXL
 12630           MOVE AL-UABON         TO SEXA
 12631           MOVE ER-0219          TO EMI-ERROR
 12632           PERFORM 9900-ERROR-FORMAT
 12633                                 THRU 9900-EXIT
 12634        END-IF
 12635     END-IF
 12636     IF SSNL GREATER THAN ZERO
 12637         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12638         IF WS-SOC-SEC-NO NUMERIC AND
 12639           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12640             NEXT SENTENCE
 12641         ELSE
 12642            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12643               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12644               WS-SSN-DASH2 = '-'
 12645                 NEXT SENTENCE
 12646            ELSE
 12647                 MOVE ER-0887        TO  EMI-ERROR
 12648                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12649                 MOVE AL-UABON       TO  SSNA
 12650                 MOVE -1             TO  SSNL
 12651            END-IF
 12652        END-IF
 12653     END-IF.
 12654
 12655     IF BIRTHDTL = ZERO
 12656         GO TO 6020-EDIT
 12657     END-IF.
 12658
 12659     IF BIRTHDTL GREATER ZERO
 12660         MOVE BIRTHDTI           TO DATE-WORK
 12661         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12662         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12663         MOVE '4'                TO DC-OPTION-CODE
 12664         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12665         IF DATE-CONVERSION-ERROR
 12666             MOVE AL-UABON       TO BIRTHDTA
 12667             MOVE -1             TO BIRTHDTL
 12668             MOVE ER-0220        TO EMI-ERROR
 12669             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12670             GO TO 6020-EDIT
 12671         END-IF
 12672     END-IF.
 12673
 12674******************************************************************
 12675**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 12676**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 12677**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 239
* EL130.cbl
 12678******************************************************************
 12679
 12680     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 12681         MOVE BIRTHDTI           TO  DATE-WORK
 12682         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12683         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 12684         MOVE '4'                TO  DC-OPTION-CODE
 12685         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 12686         MOVE +0                 TO  DC-ELAPSED-MONTHS
 12687                                     DC-ELAPSED-DAYS
 12688         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12689         IF DATE-CONVERSION-ERROR
 12690             MOVE AL-UABON       TO  BIRTHDTA
 12691             MOVE -1             TO  BIRTHDTL
 12692             MOVE ER-0220        TO  EMI-ERROR
 12693             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12694             GO TO 6020-EDIT
 12695         END-IF
 12696     END-IF.
 12697
 12698     MOVE AL-UANON               TO  BIRTHDTA.
 12699     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 12700     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 12701     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 12702
 12703 6020-EDIT.
 12704     IF INCURL GREATER ZERO
 12705         MOVE INCURI             TO DATE-WORK
 12706         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12707         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12708         MOVE '4'                TO DC-OPTION-CODE
 12709         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12710         IF DATE-CONVERSION-ERROR
 12711             MOVE AL-UABON       TO INCURA
 12712             MOVE -1             TO INCURL
 12713             MOVE ER-0222        TO EMI-ERROR
 12714             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12715         ELSE
 12716             MOVE AL-UANON       TO INCURA
 12717             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 12718             MOVE DC-BIN-DATE-1  TO WS-INCUR
 12719                                    PI-SAVE-INCUR-DT
 12720             IF WS-INCUR GREATER THAN WS-TODAY-DT
 12721                 MOVE ER-0511     TO EMI-ERROR
 12722                 MOVE -1          TO INCURL
 12723                 MOVE AL-UABON    TO INCURA
 12724                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12725             ELSE
 12726*                NEXT SENTENCE
 12727                 CONTINUE
 12728             END-IF
 12729         END-IF
 12730     ELSE
 12731         MOVE ER-0516         TO EMI-ERROR
 12732         MOVE AL-UABON        TO INCURA
 12733         MOVE -1              TO INCURL
 12734         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12735     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 240
* EL130.cbl
 12736
 12737     IF REPORTL GREATER ZERO
 12738         MOVE REPORTI            TO DATE-WORK
 12739         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12740         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12741         MOVE '4'                TO DC-OPTION-CODE
 12742         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12743         IF DATE-CONVERSION-ERROR
 12744             MOVE AL-UABON       TO REPORTA
 12745             MOVE -1             TO REPORTL
 12746             MOVE ER-0223        TO EMI-ERROR
 12747             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12748         ELSE
 12749             MOVE AL-UANON       TO REPORTA
 12750             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 12751             MOVE DC-BIN-DATE-1  TO WS-REPORT
 12752             IF WS-REPORT GREATER THAN WS-TODAY-DT
 12753                 MOVE ER-0512     TO EMI-ERROR
 12754                 MOVE -1          TO REPORTL
 12755                 MOVE AL-UABON    TO REPORTA
 12756                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12757             ELSE
 12758*                NEXT SENTENCE
 12759                 CONTINUE
 12760             END-IF
 12761         END-IF
 12762     ELSE
 12763         MOVE ER-0517         TO EMI-ERROR
 12764         MOVE -1              TO REPORTL
 12765         MOVE AL-UABON        TO REPORTA
 12766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12767     END-IF.
 12768
 12769     IF WS-REPORT NOT = LOW-VALUES
 12770         IF WS-INCUR GREATER THAN WS-REPORT
 12771             MOVE AL-UABON       TO REPORTA
 12772             MOVE -1             TO REPORTL
 12773             MOVE ER-0509        TO EMI-ERROR
 12774             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12775         END-IF
 12776     END-IF.
 12777
 12778     IF ICD1L GREATER THAN ZERO
 12779         IF (ICD1I GREATER THAN SPACES) AND
 12780            (ICD1I(4:1) NOT = '.')
 12781             IF ICD1I(4:1) = ' '
 12782                 MOVE '.' TO ICD1I(4:1)
 12783             ELSE
 12784                 IF ICD1I(8:1) = ' '
 12785                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 12786                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 12787                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 12788                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 12789                     MOVE '.'        TO ICD1I(4:1)
 12790                 END-IF
 12791             END-IF
 12792         END-IF
 12793         IF (ICD1I GREATER THAN SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 241
* EL130.cbl
 12794            (ICD1I(1:1) NOT > ' ' OR
 12795             ICD1I(2:1) NOT > ' ' OR
 12796             ICD1I(3:1) NOT > ' ' OR
 12797             ICD1I(4:1) NOT = '.')
 12798              MOVE ER-0992        TO  EMI-ERROR
 12799              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12800              MOVE AL-UABON       TO ICD1A
 12801              MOVE -1             TO ICD1L
 12802         END-IF
 12803     END-IF.
 12804
 12805     IF ICD2L GREATER THAN ZERO
 12806         IF (ICD2I GREATER THAN SPACES) AND
 12807            (ICD2I(4:1) NOT = '.')
 12808             IF ICD2I(4:1) = ' '
 12809                 MOVE '.' TO ICD2I(4:1)
 12810             ELSE
 12811                 IF ICD2I(8:1) = ' '
 12812                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 12813                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 12814                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 12815                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 12816                     MOVE '.'        TO ICD2I(4:1)
 12817                 END-IF
 12818             END-IF
 12819         END-IF
 12820         IF (ICD2I GREATER THAN SPACES) AND
 12821            (ICD2I(1:1) NOT > ' ' OR
 12822             ICD2I(2:1) NOT > ' ' OR
 12823             ICD2I(3:1) NOT > ' ' OR
 12824             ICD2I(4:1) NOT = '.')
 12825              MOVE ER-0992        TO  EMI-ERROR
 12826              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12827              MOVE AL-UABON       TO ICD2A
 12828              MOVE -1             TO ICD2L
 12829         END-IF
 12830     END-IF
 12831
 12832*    IF ESTENDL GREATER ZERO
 12833*        MOVE ESTENDI            TO DATE-WORK
 12834*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12835*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12836*        MOVE '4'                TO DC-OPTION-CODE
 12837*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12838*        IF DATE-CONVERSION-ERROR
 12839*            MOVE AL-UABON       TO ESTENDA
 12840*            MOVE -1             TO ESTENDL
 12841*            MOVE ER-0224        TO EMI-ERROR
 12842*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12843*        ELSE
 12844*            MOVE AL-UANON       TO ESTENDA
 12845*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 12846*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 12847*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 12848*               MOVE AL-UABON    TO ESTENDA
 12849*               MOVE -1          TO ESTENDL
 12850*               MOVE ER-0544     TO EMI-ERROR
 12851*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 242
* EL130.cbl
 12852*            END-IF
 12853*        END-IF
 12854*    END-IF.
 12855*
 12856*    IF WS-ESTEND NOT = LOW-VALUES
 12857*        IF WS-INCUR GREATER THAN WS-ESTEND
 12858*            MOVE AL-UABON       TO ESTENDA
 12859*            MOVE -1             TO ESTENDL
 12860*            MOVE ER-0510        TO EMI-ERROR
 12861*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12862*        END-IF
 12863*    END-IF.
 12864
 12865     IF PRTOPTL GREATER ZERO
 12866         IF PRTOPTI NOT = 'N' AND 'L'
 12867             MOVE AL-UABON       TO PRTOPTA
 12868             MOVE -1             TO PRTOPTL
 12869             MOVE ER-0334        TO EMI-ERROR
 12870             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12871         END-IF
 12872     END-IF.
 12873
 12874     IF MANRSVL GREATER ZERO
 12875
 12876* EXEC CICS BIF DEEDIT
 12877*            FIELD   (MANRSVI)
 12878*            LENGTH  (9)
 12879*        END-EXEC
 12880     MOVE 9
 12881       TO DFHEIV11
 12882*    MOVE '@"L                   #   #00011735' TO DFHEIV0
 12883     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12884     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12885     MOVE X'2020233030303131373335' TO DFHEIV0(25:11)
 12886     CALL 'kxdfhei1' USING DFHEIV0,
 12887           MANRSVI,
 12888           DFHEIV11
 12889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12890         IF MANRSVI NOT NUMERIC
 12891             MOVE AL-UNBON       TO MANRSVA
 12892             MOVE -1             TO MANRSVL
 12893             MOVE ER-0489        TO EMI-ERROR
 12894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12895         ELSE
 12896             MOVE AL-UNNON       TO MANRSVA
 12897             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 12898         END-IF
 12899     END-IF.
 12900
 12901     MOVE SPACES                 TO ELCNTL-KEY.
 12902
 12903     IF CONTROL-IS-ACTUAL-CARRIER
 12904         MOVE PI-CARRIER         TO CNTL-CARRIER
 12905     ELSE
 12906         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 12907     END-IF.
 12908
 12909     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 243
* EL130.cbl
 12910     MOVE '6'                    TO CNTL-REC-TYPE.
 12911     MOVE +0                     TO CNTL-SEQ-NO.
 12912
 12913
 12914
 12915* EXEC CICS HANDLE CONDITION
 12916*        NOTFND   (3100-CARRIER-NOT-FOUND)
 12917*    END-EXEC.
 12918*    MOVE '"$I                   ! ? #00011763' TO DFHEIV0
 12919     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12921     MOVE X'3F20233030303131373633' TO DFHEIV0(25:11)
 12922     CALL 'kxdfhei1' USING DFHEIV0
 12923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12924
 12925
 12926     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12927
 12928     IF NOT CF-MANUAL-RESERVES-USED AND
 12929           WS-MANRSV GREATER ZERO
 12930         MOVE ER-0518             TO EMI-ERROR
 12931         MOVE -1                  TO MANRSVL
 12932         MOVE AL-UNBON            TO MANRSVA
 12933         MOVE ZEROS               TO WS-MANRSV
 12934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12935     END-IF.
 12936
 12937     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 12938     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
 12939
 12940     IF SUPVL GREATER ZERO
 12941         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 12942             MOVE -1             TO SUPVL
 12943             MOVE AL-UABON       TO SUPVA
 12944             MOVE ER-0230        TO EMI-ERROR
 12945             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12946         ELSE
 12947             MOVE AL-UANON       TO SUPVA
 12948         END-IF
 12949     END-IF.
 12950
 12951     IF PROCCDL = ZERO
 12952        GO TO 6050-CONTINUE-EDITS
 12953     END-IF.
 12954
 12955     MOVE SPACES                 TO ELCNTL-KEY.
 12956     MOVE PROCCDI                TO CNTL-ACCESS.
 12957
 12958     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12959     MOVE '2'                    TO CNTL-REC-TYPE.
 12960     MOVE +0                     TO CNTL-SEQ-NO.
 12961
 12962
 12963
 12964* EXEC CICS HANDLE CONDITION
 12965*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 12966*    END-EXEC.
 12967*    MOVE '"$I                   ! @ #00011804' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 244
* EL130.cbl
 12968     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12970     MOVE X'4020233030303131383034' TO DFHEIV0(25:11)
 12971     CALL 'kxdfhei1' USING DFHEIV0
 12972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12973
 12974
 12975     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12976
 12977     GO TO 6050-CONTINUE-EDITS.
 12978
 12979 6040-NO-PROCESSOR-RECORD.
 12980     MOVE ER-0019                TO EMI-ERROR.
 12981     MOVE -1                     TO PROCCDL.
 12982     MOVE AL-UABON               TO PROCCDA.
 12983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12984
 12985 6050-CONTINUE-EDITS.
 12986     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 12987           GO TO 6070-CONTINUE-EDITS
 12988     END-IF.
 12989
 12990     MOVE BENECDI                TO BENE-CODE.
 12991     MOVE 'B'                    TO BENE-RCD-TYPE.
 12992     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12993
 12994
 12995
 12996* EXEC CICS HANDLE CONDITION
 12997*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 12998*    END-EXEC.
 12999*    MOVE '"$I                   ! A #00011828' TO DFHEIV0
 13000     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13002     MOVE X'4120233030303131383238' TO DFHEIV0(25:11)
 13003     CALL 'kxdfhei1' USING DFHEIV0
 13004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13005
 13006
 13007
 13008* EXEC CICS READ
 13009*         DATASET   (ELBENE-DSID)
 13010*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13011*         RIDFLD    (ELBENE-KEY)
 13012*    END-EXEC.
 13013*    MOVE '&"S        E          (   #00011832' TO DFHEIV0
 13014     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13015     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13016     MOVE X'2020233030303131383332' TO DFHEIV0(25:11)
 13017     CALL 'kxdfhei1' USING DFHEIV0,
 13018           ELBENE-DSID,
 13019           DFHEIV20,
 13020           DFHEIV99,
 13021           ELBENE-KEY,
 13022           DFHEIV99,
 13023           DFHEIV99,
 13024           DFHEIV99
 13025     SET ADDRESS OF BENEFICIARY-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 245
* EL130.cbl
 13026         DFHEIV20
 13027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13028
 13029
 13030     GO TO 6070-CONTINUE-EDITS.
 13031
 13032 6060-NO-BENEFICIARY-RECORD.
 13033     MOVE ER-0565                TO EMI-ERROR.
 13034     MOVE -1                     TO BENECDL.
 13035     MOVE AL-UABON               TO BENECDA.
 13036     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13037
 13038
 13039 6070-CONTINUE-EDITS.
 13040     IF CERTMTL GREATER ZERO
 13041         IF CERTMTI NOT = 'A' AND 'S'
 13042             MOVE -1             TO CERTMTL
 13043             MOVE AL-UABON       TO CERTMTA
 13044             MOVE ER-0267        TO EMI-ERROR
 13045             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13046         ELSE
 13047             MOVE AL-UANON       TO CERTMTA
 13048         END-IF
 13049     ELSE
 13050         GO TO 6000-EXIT
 13051     END-IF.
 13052
 13053     IF EFFDTL GREATER ZERO
 13054         MOVE EFFDTI             TO DATE-WORK
 13055         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13056         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13057         MOVE '4'                TO DC-OPTION-CODE
 13058         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13059         IF DATE-CONVERSION-ERROR
 13060             MOVE AL-UABON       TO EFFDTA
 13061             MOVE -1             TO EFFDTL
 13062             MOVE ER-0231        TO EMI-ERROR
 13063             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13064         ELSE
 13065             MOVE AL-UANON       TO EFFDTA
 13066             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13067             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13068         END-IF
 13069     ELSE
 13070         MOVE ER-0231            TO EMI-ERROR
 13071         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13072         MOVE -1                 TO EFFDTL
 13073         MOVE AL-UABON           TO EFFDTA
 13074     END-IF.
 13075
 13076     IF ACCOUNTL = ZERO
 13077         MOVE ER-0232            TO EMI-ERROR
 13078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13079         MOVE AL-UABON           TO ACCOUNTA
 13080         MOVE -1                 TO ACCOUNTL
 13081     ELSE
 13082         MOVE AL-UANON           TO ACCOUNTA
 13083     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 246
* EL130.cbl
 13084
 13085     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13086        (STATEL = ZERO)
 13087         MOVE ER-0233        TO EMI-ERROR
 13088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13089         MOVE AL-UABON       TO STATEA
 13090         MOVE -1             TO STATEL
 13091     ELSE
 13092         MOVE AL-UANON       TO STATEA
 13093     END-IF.
 13094
 13095     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13096        (CRTCARRL = ZERO)
 13097         MOVE ER-0234        TO EMI-ERROR
 13098         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13099         MOVE AL-UABON       TO CRTCARRA
 13100         MOVE -1             TO CRTCARRL
 13101     ELSE
 13102         MOVE AL-UANON       TO CRTCARRA
 13103     END-IF.
 13104
 13105     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13106        GROUPL = ZERO
 13107         MOVE ER-0235            TO EMI-ERROR
 13108         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13109         MOVE AL-UABON           TO GROUPA
 13110         MOVE -1                 TO GROUPL
 13111     ELSE
 13112         MOVE AL-UANON           TO GROUPA
 13113     END-IF.
 13114
 13115     IF CRTLNMEL = ZERO
 13116         IF LSTNMEI = SPACES OR LOW-VALUES
 13117             MOVE ER-0236            TO  EMI-ERROR
 13118             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13119             MOVE AL-UABON           TO  CRTLNMEA
 13120             MOVE -1                 TO  CRTLNMEL
 13121         ELSE
 13122             MOVE LSTNMEI            TO  CRTLNMEI
 13123             MOVE AL-UANON           TO  CRTLNMEA
 13124         END-IF
 13125     ELSE
 13126         MOVE AL-UANON               TO  CRTLNMEA
 13127     END-IF.
 13128
 13129     IF CRTFNMEL = ZERO
 13130         IF FSTNMEI = SPACES OR LOW-VALUES
 13131*            NEXT SENTENCE
 13132             CONTINUE
 13133         ELSE
 13134             MOVE FSTNMEI            TO  CRTFNMEI
 13135             MOVE AL-UANON           TO  CRTFNMEA
 13136         END-IF
 13137     END-IF.
 13138
 13139     IF CRTINITL = ZERO
 13140         IF INITI = SPACES OR LOW-VALUES
 13141*            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 247
* EL130.cbl
 13142             CONTINUE
 13143         ELSE
 13144             MOVE INITI              TO  CRTINITI
 13145             MOVE AL-UANON           TO  CRTINITA
 13146         END-IF
 13147     END-IF.
 13148
 13149 6000-EXIT.
 13150     EXIT.
 13151
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 248
* EL130.cbl
 13153 6200-EDIT-CERT-DATA.
 13154     IF ISSAGEL GREATER ZERO
 13155         IF ISSAGEI NOT NUMERIC
 13156             MOVE ER-0237        TO EMI-ERROR
 13157             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13158             MOVE -1             TO ISSAGEL
 13159             MOVE AL-UNBON       TO ISSAGEA
 13160         ELSE
 13161             MOVE AL-UNNON       TO ISSAGEA
 13162         END-IF
 13163     END-IF.
 13164
 13165     IF JNTAGEL GREATER ZERO
 13166         IF JNTAGEI NOT NUMERIC
 13167             MOVE ER-0238        TO EMI-ERROR
 13168             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13169             MOVE -1             TO JNTAGEL
 13170             MOVE AL-UNBON       TO JNTAGEA
 13171         ELSE
 13172             MOVE AL-UNNON       TO JNTAGEA
 13173         END-IF
 13174     END-IF.
 13175
 13176     IF LCVCDL GREATER ZERO
 13177         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13178         IF INVALID-BENEFIT-CODE
 13179             MOVE ER-7635        TO EMI-ERROR
 13180             MOVE -1             TO LCVCDL
 13181             MOVE AL-UABON       TO LCVCDA
 13182             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13183         ELSE
 13184             MOVE LCVCDI         TO WS-BEN-HOLD
 13185             MOVE '4'            TO WS-REC-TYPE
 13186             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13187             IF WS-BEN-ALPHA-HOLD = SPACES
 13188                MOVE ER-7635     TO EMI-ERROR
 13189                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13190                MOVE -1          TO LCVCDL
 13191                MOVE AL-UABON    TO LCVCDA
 13192             ELSE
 13193                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13194                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13195                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13196                MOVE AL-UANON           TO LCVCDA
 13197             END-IF
 13198         END-IF
 13199     END-IF.
 13200
 13201     IF ACVCDL GREATER ZERO
 13202         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13203         IF INVALID-BENEFIT-CODE
 13204             MOVE ER-7635        TO EMI-ERROR
 13205             MOVE -1             TO ACVCDL
 13206             MOVE AL-UABON       TO ACVCDA
 13207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13208         ELSE
 13209             MOVE ACVCDI         TO WS-BEN-HOLD
 13210             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 249
* EL130.cbl
 13211             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13212             IF WS-BEN-ALPHA-HOLD = SPACES
 13213                MOVE ER-7635     TO EMI-ERROR
 13214                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13215                MOVE -1          TO ACVCDL
 13216                MOVE AL-UABON    TO ACVCDA
 13217             ELSE
 13218                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13219                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13220                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13221                MOVE AL-UANON           TO ACVCDA
 13222             END-IF
 13223         END-IF
 13224     END-IF.
 13225
 13226     IF LCVOTRML GREATER ZERO
 13227         IF LCVOTRMI NOT NUMERIC
 13228             MOVE ER-7636        TO EMI-ERROR
 13229             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13230             MOVE -1             TO LCVOTRML
 13231             MOVE AL-UNBON       TO LCVOTRMA
 13232         ELSE
 13233             MOVE AL-UNNON       TO LCVOTRMA
 13234         END-IF
 13235     END-IF.
 13236
 13237     IF ACVOTRML GREATER ZERO
 13238         IF ACVOTRMI NOT NUMERIC
 13239             MOVE ER-7636        TO EMI-ERROR
 13240             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13241             MOVE -1             TO ACVOTRML
 13242             MOVE AL-UNBON       TO ACVOTRMA
 13243         ELSE
 13244             MOVE AL-UNNON       TO ACVOTRMA
 13245         END-IF
 13246     END-IF.
 13247
 13248     IF LCVRATEL GREATER ZERO
 13249
 13250* EXEC CICS BIF DEEDIT
 13251*            FIELD    (LCVRATEI)
 13252*            LENGTH   (06)
 13253*        END-EXEC
 13254     MOVE 06
 13255       TO DFHEIV11
 13256*    MOVE '@"L                   #   #00012057' TO DFHEIV0
 13257     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13258     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13259     MOVE X'2020233030303132303537' TO DFHEIV0(25:11)
 13260     CALL 'kxdfhei1' USING DFHEIV0,
 13261           LCVRATEI,
 13262           DFHEIV11
 13263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13264         IF LCVRATEI NOT NUMERIC
 13265             MOVE AL-UNBON       TO LCVRATEA
 13266             MOVE -1             TO LCVRATEL
 13267             MOVE ER-2280        TO EMI-ERROR
 13268             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 250
* EL130.cbl
 13269         ELSE
 13270             MOVE AL-UNNON       TO LCVRATEA
 13271             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13272         END-IF
 13273     END-IF.
 13274
 13275     IF ACVRATEL GREATER ZERO
 13276
 13277* EXEC CICS BIF DEEDIT
 13278*            FIELD    (ACVRATEI)
 13279*            LENGTH   (06)
 13280*        END-EXEC
 13281     MOVE 06
 13282       TO DFHEIV11
 13283*    MOVE '@"L                   #   #00012073' TO DFHEIV0
 13284     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13285     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13286     MOVE X'2020233030303132303733' TO DFHEIV0(25:11)
 13287     CALL 'kxdfhei1' USING DFHEIV0,
 13288           ACVRATEI,
 13289           DFHEIV11
 13290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13291         IF ACVRATEI NOT NUMERIC
 13292             MOVE AL-UNBON       TO ACVRATEA
 13293             MOVE -1             TO ACVRATEL
 13294             MOVE ER-2280        TO EMI-ERROR
 13295             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13296         ELSE
 13297             MOVE AL-UNNON       TO ACVRATEA
 13298             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13299         END-IF
 13300     END-IF.
 13301
 13302     IF LCVBENEL GREATER ZERO
 13303
 13304* EXEC CICS BIF DEEDIT
 13305*            FIELD    (LCVBENEI)
 13306*            LENGTH   (11)
 13307*        END-EXEC
 13308     MOVE 11
 13309       TO DFHEIV11
 13310*    MOVE '@"L                   #   #00012089' TO DFHEIV0
 13311     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13312     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13313     MOVE X'2020233030303132303839' TO DFHEIV0(25:11)
 13314     CALL 'kxdfhei1' USING DFHEIV0,
 13315           LCVBENEI,
 13316           DFHEIV11
 13317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13318         IF LCVBENEI NOT NUMERIC
 13319             MOVE AL-UNBON       TO LCVBENEA
 13320             MOVE -1             TO LCVBENEL
 13321             MOVE ER-7637        TO EMI-ERROR
 13322             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13323         ELSE
 13324             MOVE AL-UNNON       TO LCVBENEA
 13325             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13326         END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 251
* EL130.cbl
 13327     END-IF.
 13328
 13329     IF ACVBENEL GREATER ZERO
 13330
 13331* EXEC CICS BIF DEEDIT
 13332*            FIELD    (ACVBENEI)
 13333*            LENGTH   (11)
 13334*        END-EXEC
 13335     MOVE 11
 13336       TO DFHEIV11
 13337*    MOVE '@"L                   #   #00012105' TO DFHEIV0
 13338     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13339     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13340     MOVE X'2020233030303132313035' TO DFHEIV0(25:11)
 13341     CALL 'kxdfhei1' USING DFHEIV0,
 13342           ACVBENEI,
 13343           DFHEIV11
 13344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13345         IF ACVBENEI NOT NUMERIC
 13346             MOVE AL-UNBON       TO ACVBENEA
 13347             MOVE -1             TO ACVBENEL
 13348             MOVE ER-7637        TO EMI-ERROR
 13349             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13350         ELSE
 13351             MOVE AL-UNNON       TO ACVBENEA
 13352             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13353         END-IF
 13354     END-IF.
 13355
 13356     IF LCVCNDTL GREATER ZERO
 13357         IF LCVCNDTI NOT = SPACES
 13358             MOVE LCVCNDTI        TO DATE-WORK
 13359             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13360             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13361             MOVE '4'             TO DC-OPTION-CODE
 13362             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13363             IF DATE-CONVERSION-ERROR
 13364                 MOVE AL-UABON    TO LCVCNDTA
 13365                 MOVE -1          TO LCVCNDTL
 13366                 MOVE ER-7638     TO EMI-ERROR
 13367                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13368             ELSE
 13369                 MOVE AL-UANON    TO LCVCNDTA
 13370                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13371                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13372             END-IF
 13373         END-IF
 13374     END-IF.
 13375
 13376     IF ACVCNDTL GREATER ZERO
 13377         IF ACVCNDTI NOT = SPACES
 13378             MOVE ACVCNDTI        TO DATE-WORK
 13379             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13380             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13381             MOVE '4'             TO DC-OPTION-CODE
 13382             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13383             IF DATE-CONVERSION-ERROR
 13384                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 252
* EL130.cbl
 13385                 MOVE -1          TO ACVCNDTL
 13386                 MOVE ER-7638     TO EMI-ERROR
 13387                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13388             ELSE
 13389                 MOVE AL-UANON    TO ACVCNDTA
 13390                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13391                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13392             END-IF
 13393         END-IF
 13394     END-IF.
 13395
 13396     IF ADDONDTL GREATER ZERO
 13397         MOVE ADDONDTI        TO DATE-WORK
 13398         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13399         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13400         MOVE '4'             TO DC-OPTION-CODE
 13401         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13402         IF DATE-CONVERSION-ERROR
 13403             MOVE AL-UABON    TO ADDONDTA
 13404             MOVE -1          TO ADDONDTL
 13405             MOVE ER-7651     TO EMI-ERROR
 13406             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13407         ELSE
 13408             MOVE AL-UANON    TO ADDONDTA
 13409             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13410             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13411         END-IF
 13412     END-IF.
 13413
 13414     IF APRL GREATER ZERO
 13415
 13416* EXEC CICS BIF DEEDIT
 13417*            FIELD    (APRI)
 13418*            LENGTH   (8)
 13419*        END-EXEC
 13420     MOVE 8
 13421       TO DFHEIV11
 13422*    MOVE '@"L                   #   #00012179' TO DFHEIV0
 13423     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13424     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13425     MOVE X'2020233030303132313739' TO DFHEIV0(25:11)
 13426     CALL 'kxdfhei1' USING DFHEIV0,
 13427           APRI,
 13428           DFHEIV11
 13429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13430         IF APRI NOT NUMERIC
 13431             MOVE AL-UNBON       TO APRA
 13432             MOVE -1             TO APRL
 13433             MOVE ER-0248        TO EMI-ERROR
 13434             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13435         ELSE
 13436             MOVE AL-UNNON       TO APRA
 13437             MOVE APRI           TO WS-APR APRO
 13438         END-IF
 13439     END-IF.
 13440
 13441     IF PMTFREQL GREATER ZERO
 13442
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 253
* EL130.cbl
 13443* EXEC CICS BIF DEEDIT
 13444*            FIELD   (PMTFREQI)
 13445*            LENGTH  (2)
 13446*        END-EXEC
 13447     MOVE 2
 13448       TO DFHEIV11
 13449*    MOVE '@"L                   #   #00012195' TO DFHEIV0
 13450     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13451     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13452     MOVE X'2020233030303132313935' TO DFHEIV0(25:11)
 13453     CALL 'kxdfhei1' USING DFHEIV0,
 13454           PMTFREQI,
 13455           DFHEIV11
 13456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13457         IF PMTFREQI NOT NUMERIC
 13458             MOVE -1             TO PMTFREQL
 13459             MOVE AL-UNBON       TO PMTFREQA
 13460             MOVE ER-0258        TO EMI-ERROR
 13461             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13462         ELSE
 13463             MOVE AL-UNNON       TO PMTFREQA
 13464             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13465         END-IF
 13466     END-IF.
 13467
 13468     IF INDGRPL GREATER ZERO
 13469         IF INDGRPI = 'I' OR 'G'
 13470             MOVE AL-UANON       TO INDGRPA
 13471         ELSE
 13472             MOVE -1 TO INDGRPL
 13473             MOVE AL-UABON       TO INDGRPA
 13474             MOVE ER-0260        TO EMI-ERROR
 13475             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13476         END-IF
 13477     END-IF.
 13478
 13479     IF LOANBALL GREATER ZERO
 13480         MOVE LOANBALI           TO DEEDIT-FIELD
 13481
 13482* EXEC CICS BIF DEEDIT
 13483*            FIELD   (DEEDIT-FIELD)
 13484*            LENGTH  (12)
 13485*        END-EXEC
 13486     MOVE 12
 13487       TO DFHEIV11
 13488*    MOVE '@"L                   #   #00012223' TO DFHEIV0
 13489     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13490     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13491     MOVE X'2020233030303132323233' TO DFHEIV0(25:11)
 13492     CALL 'kxdfhei1' USING DFHEIV0,
 13493           DEEDIT-FIELD,
 13494           DFHEIV11
 13495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13496         IF DEEDIT-FIELD NOT NUMERIC
 13497             MOVE AL-UNBON       TO LOANBALA
 13498             MOVE -1             TO LOANBALL
 13499             MOVE ER-0247        TO EMI-ERROR
 13500             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 254
* EL130.cbl
 13501         ELSE
 13502             MOVE AL-UNNON       TO LOANBALA
 13503             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13504         END-IF
 13505     END-IF.
 13506
 13507     IF PREMTYPL GREATER ZERO
 13508         IF (PREMTYPI = '1' OR '2' OR '3')
 13509             MOVE AL-UANON       TO PREMTYPA
 13510         ELSE
 13511             MOVE -1             TO PREMTYPL
 13512             MOVE AL-UABON       TO PREMTYPA
 13513             MOVE ER-0227        TO EMI-ERROR
 13514             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13515         END-IF
 13516     END-IF.
 13517
 13518     IF REINCDL GREATER ZERO
 13519         MOVE LOW-VALUES         TO  ERREIN-KEY
 13520         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13521         MOVE REINCDI            TO  REIN-CODE-1
 13522                                     REIN-CODE-2
 13523                                     REIN-CODE-3
 13524         MOVE 'A'                TO  REIN-TYPE
 13525         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13526         IF REIN-REC-NOT-FOUND
 13527             MOVE ER-0266        TO  EMI-ERROR
 13528             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13529             MOVE -1             TO  REINCDL
 13530             MOVE AL-UABON       TO  REINCDA
 13531         ELSE
 13532             MOVE AL-UANON       TO  REINCDA
 13533         END-IF
 13534     END-IF.
 13535
 13536     IF CERTMTI NOT = 'A'
 13537        GO TO 6200-EXIT
 13538     END-IF.
 13539
 13540     IF PREMTYPI = '1'
 13541         IF LCVCDL GREATER ZERO
 13542             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13543                 MOVE ER-0841        TO  EMI-ERROR
 13544                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13545                 MOVE -1             TO  PREMTYPL
 13546                 MOVE AL-UABON       TO  PREMTYPA
 13547             END-IF
 13548         END-IF
 13549     END-IF.
 13550
 13551     IF PREMTYPI = '1'
 13552         IF ACVCDL GREATER ZERO
 13553             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13554                 MOVE ER-0841        TO  EMI-ERROR
 13555                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13556                 MOVE -1             TO  PREMTYPL
 13557                 MOVE AL-UABON       TO  PREMTYPA
 13558             END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 255
* EL130.cbl
 13559         END-IF
 13560     END-IF.
 13561
 13562     IF PREMTYPI = '2'
 13563         IF LCVCDL GREATER ZERO
 13564             IF (PI-COMPANY-ID = 'HAN') AND
 13565                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13566                        OR
 13567                 WS-LF-SPECIAL-CALC-CD = 'O'
 13568*                NEXT SENTENCE
 13569                 CONTINUE
 13570             ELSE
 13571                 MOVE ER-0840        TO  EMI-ERROR
 13572                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13573                 MOVE -1             TO  PREMTYPL
 13574                 MOVE AL-UABON       TO  PREMTYPA
 13575             END-IF
 13576         END-IF
 13577     END-IF.
 13578
 13579     IF PREMTYPI = '2'
 13580         IF ACVCDL GREATER ZERO
 13581             IF (PI-COMPANY-ID = 'HAN')  AND
 13582                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13583                        OR
 13584                 WS-AH-SPECIAL-CALC-CD = 'O'
 13585*                NEXT SENTENCE
 13586                 CONTINUE
 13587             ELSE
 13588                 MOVE ER-0840        TO  EMI-ERROR
 13589                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13590                 MOVE -1             TO  PREMTYPL
 13591                 MOVE AL-UABON       TO  PREMTYPA
 13592             END-IF
 13593         END-IF
 13594     END-IF.
 13595
 13596     IF LCVCDL = ZEROS
 13597        GO TO 6200-EXIT
 13598     END-IF.
 13599
 13600     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13601         IF PMTFREQI NOT = ZEROS
 13602             MOVE ER-0428        TO EMI-ERROR
 13603             MOVE -1             TO PMTFREQL
 13604             MOVE AL-UNBON       TO PMTFREQA
 13605             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13606             GO TO 6200-CHECK-APR
 13607         END-IF
 13608     END-IF.
 13609
 13610     IF PMTFREQL = ZEROS AND TEX-REG
 13611         MOVE ER-0429            TO EMI-ERROR
 13612         MOVE -1                 TO PMTFREQL
 13613         MOVE AL-UNBON           TO PMTFREQA
 13614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13615         GO TO 6200-CHECK-APR
 13616     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 256
* EL130.cbl
 13617
 13618     IF LCVOTRMI NOT NUMERIC
 13619         GO TO 6200-CHECK-APR
 13620     END-IF.
 13621
 13622     IF WS-PMTFREQ NOT = ZERO
 13623         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13624         GIVING DIVIDE-QUOT
 13625         REMAINDER DIVIDE-REM
 13626         IF DIVIDE-REM GREATER ZERO
 13627             MOVE ER-0430            TO EMI-ERROR
 13628             MOVE -1                 TO PMTFREQL
 13629             MOVE AL-UNBON           TO PMTFREQA
 13630             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13631         END-IF
 13632     END-IF.
 13633
 13634 6200-CHECK-APR.
 13635     IF NET-PAY AND APRL = ZEROS
 13636        MOVE ER-0257             TO EMI-ERROR
 13637        MOVE -1                  TO APRL
 13638        MOVE AL-UABON            TO APRA
 13639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13640     END-IF.
 13641
 13642 6200-EXIT.
 13643     EXIT.
 13644
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 257
* EL130.cbl
 13646 6300-REQUIRED-CERT-EDIT.
 13647
 13648     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13649        GO TO 6300-REQUIRED-AH-EDIT
 13650     END-IF
 13651
 13652     IF LCVCDL = ZERO
 13653        MOVE ER-7639             TO EMI-ERROR
 13654        MOVE -1                  TO LCVCDL
 13655        MOVE AL-UABON            TO LCVCDA
 13656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13657     END-IF.
 13658
 13659     IF LCVOTRML = ZERO
 13660        MOVE ER-7670             TO EMI-ERROR
 13661        MOVE -1                  TO LCVOTRML
 13662        MOVE AL-UNBON            TO LCVOTRMA
 13663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13664     END-IF.
 13665
 13666     IF LCVBENEL = ZERO
 13667        MOVE ER-7671             TO EMI-ERROR
 13668        MOVE -1                  TO LCVBENEL
 13669        MOVE AL-UNBON            TO LCVBENEA
 13670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13671     END-IF.
 13672
 13673     GO TO 6399-EXIT.
 13674
 13675 6300-REQUIRED-AH-EDIT.
 13676
 13677     IF ACVCDL = ZERO
 13678        MOVE ER-7639             TO EMI-ERROR
 13679        MOVE -1                  TO ACVCDL
 13680        MOVE AL-UABON            TO ACVCDA
 13681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13682     END-IF.
 13683
 13684     IF ACVOTRML = ZERO
 13685         MOVE ER-7670             TO EMI-ERROR
 13686         MOVE -1                  TO ACVOTRML
 13687         MOVE AL-UNBON            TO ACVOTRMA
 13688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13689     END-IF.
 13690
 13691     IF ACVBENEL = ZERO
 13692        MOVE ER-7671             TO EMI-ERROR
 13693        MOVE -1                  TO ACVBENEL
 13694        MOVE AL-UNBON            TO ACVBENEA
 13695        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13696     END-IF.
 13697
 13698 6399-EXIT.
 13699      EXIT.
 13700
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 258
* EL130.cbl
 13702 6400-TEST-CLAIM-REASONABILITY.
 13703
 13704     IF WS-INCUR = LOW-VALUES
 13705        GO TO 6499-EXIT
 13706     END-IF.
 13707
 13708     IF WS-EFFDT NOT = LOW-VALUES
 13709         IF WS-INCUR LESS WS-EFFDT
 13710             MOVE ER-0458          TO EMI-ERROR
 13711             MOVE -1               TO INCURL
 13712             MOVE AL-UABON         TO INCURA
 13713             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13714         END-IF
 13715     END-IF.
 13716
 13717     IF CERTMTI = 'A'
 13718        GO TO 6460-TEST-NEW-CERT
 13719     END-IF.
 13720
 13721     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 13722     MOVE CRTCARRI               TO CERT-CARRIER.
 13723     MOVE GROUPI                 TO CERT-GROUPING.
 13724     MOVE STATEI                 TO CERT-STATE.
 13725     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 13726     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 13727     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 13728
 13729
 13730
 13731* EXEC CICS HANDLE CONDITION
 13732*         DUPKEY   (6499-EXIT)
 13733*         NOTFND   (6499-EXIT)
 13734*    END-EXEC.
 13735*    MOVE '"$$I                  ! B #00012461' TO DFHEIV0
 13736     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 13737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13738     MOVE X'4220233030303132343631' TO DFHEIV0(25:11)
 13739     CALL 'kxdfhei1' USING DFHEIV0
 13740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13741
 13742
 13743     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 13744
 13745     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 13746        'I' OR 'G')
 13747        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13748     ELSE
 13749        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13750     END-IF.
 13751
 13752     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13753     MOVE '6'                    TO DC-OPTION-CODE.
 13754     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13755
 13756     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 13757        MOVE ER-0519             TO EMI-ERROR
 13758        MOVE -1                  TO INCURL
 13759        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 259
* EL130.cbl
 13760        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13761     END-IF.
 13762
 13763     IF CLMCARRI NOT = CRTCARRI
 13764        MOVE ER-0562             TO EMI-ERROR
 13765        MOVE AL-UABON            TO CLMCARRA
 13766        MOVE -1                  TO CLMCARRL
 13767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13768     END-IF.
 13769
 13770     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13771        CM-AH-BENEFIT-CD = '00')
 13772                  OR
 13773        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13774        CM-LF-BENEFIT-CD = '00')
 13775         MOVE ER-0521         TO EMI-ERROR
 13776         MOVE AL-UABON        TO CLMTYPEA
 13777         MOVE -1              TO CLMTYPEL
 13778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13779     END-IF.
 13780*    IF CLMTYPEI = 'I' AND
 13781*       CM-AH-CRITICAL-PERIOD = +0
 13782*        MOVE ER-0521         TO EMI-ERROR
 13783*        MOVE AL-UABON        TO CLMTYPEA
 13784*        MOVE -1              TO CLMTYPEL
 13785*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13786*    END-IF
 13787
 13788*    IF PI-COMPANY-ID = 'CRI'
 13789*        IF MAINTI = 'A'
 13790*            IF CERT-PEND-ISSUE-ERROR  OR
 13791*               CERT-PEND-ISSUE-RETURNED
 13792*                MOVE -1                 TO CERTNOL
 13793*                MOVE AL-UABON           TO CERTNOA
 13794*                MOVE ER-7640            TO EMI-ERROR
 13795*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13796*            END-IF
 13797*        END-IF
 13798*    END-IF.
 13799
 13800     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 13801         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13802         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 13803             GO TO 6450-DATE-ERROR
 13804         END-IF
 13805     END-IF.
 13806
 13807     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 13808         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 13809         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 13810             GO TO 6450-DATE-ERROR
 13811         END-IF
 13812     END-IF.
 13813
 13814     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13815         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 13816             GO TO 6450-DATE-ERROR
 13817         END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 260
* EL130.cbl
 13818     END-IF.
 13819
 13820     GO TO 6499-EXIT.
 13821
 13822 6450-DATE-ERROR.
 13823     MOVE ER-0520                TO EMI-ERROR.
 13824     MOVE -1                     TO INCURL.
 13825     MOVE AL-UABON               TO INCURA.
 13826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13827
 13828*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 13829*       (EMI-SEVERITY-SAVE = 'X')
 13830*        ADD 1                TO EMI-FORCABLE-CTR
 13831*        SUBTRACT 1 FROM EMI-FATAL-CTR
 13832*    END-IF.
 13833
 13834     GO TO 6499-EXIT.
 13835
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 261
* EL130.cbl
 13837 6460-TEST-NEW-CERT.
 13838
 13839     IF NOT EMI-NO-ERRORS
 13840        GO TO 6499-EXIT
 13841     END-IF.
 13842
 13843     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 13844
 13845     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13846         ACVOTRML GREATER ZERO)
 13847        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 13848     END-IF.
 13849
 13850     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13851         LCVOTRML GREATER ZERO
 13852        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 13853     END-IF.
 13854
 13855     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 13856
 13857*    IF PI-COMPANY-ID = 'HAN'
 13858*        IF ADDONDTL GREATER ZERO
 13859*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 13860*            IF CLMTYPEI = 'A'
 13861*                IF ACVOTRMI NOT = ZEROS
 13862*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 13863*                ELSE
 13864*                    NEXT SENTENCE
 13865*                    CONTINUE
 13866*                END-IF
 13867*            ELSE
 13868*                IF LCVOTRMI NOT = ZEROS
 13869*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 13870*                END-IF
 13871*            END-IF
 13872*        END-IF
 13873*    END-IF.
 13874
 13875     MOVE '6'                    TO DC-OPTION-CODE.
 13876     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13877
 13878     IF NO-CONVERSION-ERROR
 13879         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 13880     END-IF.
 13881
 13882     IF WS-INCUR GREATER THAN WS-EXPIRE
 13883        MOVE ER-0519             TO EMI-ERROR
 13884        MOVE -1                  TO INCURL
 13885        MOVE AL-UABON            TO INCURA
 13886        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13887     END-IF.
 13888
 13889     IF CLMCARRI NOT = CRTCARRI
 13890        MOVE ER-0562             TO EMI-ERROR
 13891        MOVE AL-UABON            TO CLMCARRA
 13892        MOVE -1                  TO CLMCARRL
 13893        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13894     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 262
* EL130.cbl
 13895
 13896     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13897         ACVCDL = ZEROS)
 13898             MOVE ER-0521        TO EMI-ERROR
 13899             MOVE AL-UABON       TO CLMTYPEA
 13900             MOVE -1             TO CLMTYPEL
 13901             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13902     END-IF.
 13903
 13904     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13905         LCVCDL = ZEROS
 13906             MOVE ER-0521        TO EMI-ERROR
 13907             MOVE AL-UABON       TO CLMTYPEA
 13908             MOVE -1             TO CLMTYPEL
 13909             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13910     END-IF.
 13911
 13912     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13913         IF LCVCNDTL GREATER ZERO
 13914             IF WS-INCUR GREATER THAN WS-LCVCNDT
 13915                 GO TO 6450-DATE-ERROR
 13916             END-IF
 13917         END-IF
 13918     END-IF.
 13919
 13920     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13921         IF ACVCNDTL GREATER ZERO
 13922             IF WS-INCUR GREATER THAN WS-ACVCNDT
 13923                 GO TO 6450-DATE-ERROR
 13924             END-IF
 13925         END-IF
 13926     END-IF.
 13927
 13928 6499-EXIT.
 13929     EXIT.
 13930 6500-get-acct.
 13931
 13932     MOVE SPACES                 TO ERACCT-KEY
 13933                                    ws-dcc-product-code
 13934
 13935     IF CARR-GROUP-ST-ACCNT-CNTL
 13936        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 13937        MOVE CRTCARRI            TO ACCT-CARRIER
 13938        MOVE GROUPI              TO ACCT-GROUPING
 13939        MOVE STATEI              TO ACCT-STATE
 13940        MOVE ACCOUNTI            TO ACCT-ACCOUNT
 13941        GO TO 6500-startbr
 13942     END-IF
 13943
 13944     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 13945     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 13946
 13947     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 13948        MOVE STATEI             TO ACCT-STATE
 13949     END-IF
 13950
 13951     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 13952        MOVE CRTCARRI           TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 263
* EL130.cbl
 13953     END-IF
 13954
 13955     .
 13956 6500-startbr.
 13957
 13958     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 13959
 13960
 13961* EXEC CICS STARTBR
 13962*       DATASET     (ERACCT2-DSID)
 13963*       RIDFLD      (SAVE-ERACCT-KEY)
 13964*       GENERIC
 13965*       KEYLENGTH   (20)
 13966*       resp        (ws-response)
 13967*    END-EXEC
 13968     MOVE 20
 13969       TO DFHEIV11
 13970     MOVE 0
 13971       TO DFHEIV12
 13972*    MOVE '&,   KG    G          &  N#00012683' TO DFHEIV0
 13973     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13974     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13975     MOVE X'204E233030303132363833' TO DFHEIV0(25:11)
 13976     CALL 'kxdfhei1' USING DFHEIV0,
 13977           ERACCT2-DSID,
 13978           SAVE-ERACCT-KEY,
 13979           DFHEIV11,
 13980           DFHEIV12,
 13981           DFHEIV99
 13982     MOVE EIBRESP  TO ws-response
 13983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13984
 13985     if not ws-resp-normal
 13986        go to 6500-exit
 13987     end-if
 13988
 13989     .
 13990 6500-readnext.
 13991
 13992
 13993* EXEC CICS READNEXT
 13994*       DATASET   (ERACCT2-DSID)
 13995*       SET       (ADDRESS OF ACCOUNT-MASTER)
 13996*       RIDFLD    (SAVE-ERACCT-KEY)
 13997*    END-EXEC
 13998     MOVE 0
 13999       TO DFHEIV11
 14000*    MOVE '&.S                   )   #00012698' TO DFHEIV0
 14001     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14002     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14003     MOVE X'2020233030303132363938' TO DFHEIV0(25:11)
 14004     CALL 'kxdfhei1' USING DFHEIV0,
 14005           ERACCT2-DSID,
 14006           DFHEIV20,
 14007           DFHEIV99,
 14008           SAVE-ERACCT-KEY,
 14009           DFHEIV99,
 14010           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 264
* EL130.cbl
 14011           DFHEIV99,
 14012           DFHEIV99
 14013     SET ADDRESS OF ACCOUNT-MASTER TO
 14014         DFHEIV20
 14015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14016
 14017     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14018        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14019        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14020        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14021        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14022        go to 6500-endbr
 14023     END-IF
 14024
 14025     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14026        and (WS-EFFDT < AM-EXPIRATION-DT)
 14027        MOVE AM-dcc-product-code to ws-dcc-product-code
 14028        GO TO 6500-endbr
 14029     END-IF
 14030
 14031     IF WS-EFFDT >= AM-EXPIRATION-DT
 14032         GO TO 6500-readnext
 14033     END-IF
 14034
 14035     .
 14036 6500-endbr.
 14037
 14038
 14039* EXEC CICS ENDBR
 14040*        DATASET    (ERACCT2-DSID)
 14041*    END-EXEC
 14042     MOVE 0
 14043       TO DFHEIV11
 14044*    MOVE '&2                    $   #00012725' TO DFHEIV0
 14045     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14046     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14047     MOVE X'2020233030303132373235' TO DFHEIV0(25:11)
 14048     CALL 'kxdfhei1' USING DFHEIV0,
 14049           ERACCT2-DSID,
 14050           DFHEIV11,
 14051           DFHEIV99
 14052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14053
 14054     .
 14055 6500-exit.
 14056     exit.
 14057 6600-CHECK-AUTO-ACTIVITY.
 14058
 14059
 14060* EXEC CICS HANDLE CONDITION
 14061*        NOTFND   (6600-NOT-FOUND)
 14062*    END-EXEC.
 14063*    MOVE '"$I                   ! C #00012734' TO DFHEIV0
 14064     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14065     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14066     MOVE X'4320233030303132373334' TO DFHEIV0(25:11)
 14067     CALL 'kxdfhei1' USING DFHEIV0
 14068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 265
* EL130.cbl
 14069
 14070
 14071     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14072     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14073     MOVE SPACES                     TO  CNTL-ACCESS.
 14074     MOVE +0                         TO  CNTL-SEQ-NO.
 14075
 14076     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14077
 14078     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14079         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14080                                         WS-LETTER-SW
 14081         GO TO 6600-EXIT
 14082     END-IF.
 14083
 14084     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14085         MOVE 'N'                     TO  WS-LETTER-SW
 14086     ELSE
 14087         MOVE 'Y'                     TO  WS-LETTER-SW
 14088     END-IF.
 14089
 14090     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14091     GO TO 6600-EXIT.
 14092
 14093 6600-START-AUTO-LETTER-WRITER.
 14094
 14095     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14096     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14097
 14098     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14099
 14100     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14101         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14102         MOVE '6'                     TO  DC-OPTION-CODE
 14103         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14104         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14105         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14106         IF NO-CONVERSION-ERROR
 14107             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14108         ELSE
 14109             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14110         END-IF
 14111     END-IF.
 14112
 14113     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 14114         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14115         MOVE '6'                     TO  DC-OPTION-CODE
 14116         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14117         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14118         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14119         IF NO-CONVERSION-ERROR
 14120             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14121         ELSE
 14122             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14123         END-IF
 14124     END-IF.
 14125
 14126
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 266
* EL130.cbl
 14127
 14128* EXEC CICS LINK
 14129*        PROGRAM    (LINK-1523)
 14130*        COMMAREA   (W-1523-LINKDATA)
 14131*        LENGTH     (W-1523-COMM-LENGTH)
 14132*    END-EXEC.
 14133*    MOVE '."C                   (   #00012794' TO DFHEIV0
 14134     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14135     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14136     MOVE X'2020233030303132373934' TO DFHEIV0(25:11)
 14137     CALL 'kxdfhei1' USING DFHEIV0,
 14138           LINK-1523,
 14139           W-1523-LINKDATA,
 14140           W-1523-COMM-LENGTH,
 14141           DFHEIV99,
 14142           DFHEIV99,
 14143           DFHEIV99,
 14144           DFHEIV99
 14145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14146
 14147
 14148     GO TO 6600-EXIT.
 14149
 14150 6600-NOT-FOUND.
 14151     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14152
 14153 6600-EXIT.
 14154     EXIT.
 14155
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 267
* EL130.cbl
 14156/
 14157*************************************************************
 14158*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14159*************************************************************
 14160
 14161 6700-OUTPUT-ACTIVITY-RECORD.
 14162
 14163
 14164
 14165* EXEC CICS GETMAIN
 14166*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14167*        LENGTH (DLYACTV-LENGTH)
 14168*        INITIMG (WS-BLANK)
 14169*    END-EXEC.
 14170*    MOVE ',"IL                  $   #00012816' TO DFHEIV0
 14171     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14172     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14173     MOVE X'2020233030303132383136' TO DFHEIV0(25:11)
 14174     CALL 'kxdfhei1' USING DFHEIV0,
 14175           DFHEIV20,
 14176           DLYACTV-LENGTH,
 14177           WS-BLANK
 14178     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14179         DFHEIV20
 14180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14181
 14182
 14183     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14184     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14185     MOVE CLMCARRI               TO DA-CARRIER.
 14186     IF CLMNOL EQUAL ZERO
 14187         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14188     ELSE
 14189         MOVE CLMNOI             TO DA-CLAIM-NO
 14190     END-IF.
 14191     MOVE CERTNOI                TO DA-CERT-PRIME.
 14192     MOVE SUFXI                  TO DA-CERT-SFX.
 14193     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14194     MOVE 'A'                    TO DA-RECORD-TYPE.
 14195
 14196
 14197* EXEC CICS HANDLE CONDITION
 14198*        NOTOPEN (6700-NOTOPEN-ERROR)
 14199*        DUPREC (6700-EXIT)
 14200*    END-EXEC.
 14201*    MOVE '"$J%                  ! D #00012835' TO DFHEIV0
 14202     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14204     MOVE X'4420233030303132383335' TO DFHEIV0(25:11)
 14205     CALL 'kxdfhei1' USING DFHEIV0
 14206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14207
 14208
 14209
 14210* EXEC CICS WRITE
 14211*        DATASET (DLYACTV-DSID)
 14212*        RIDFLD (DA-KEY)
 14213*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 268
* EL130.cbl
 14214*        LENGTH (DLYACTV-LENGTH)
 14215*    END-EXEC.
 14216*    MOVE '&$ L                  ''   #00012840' TO DFHEIV0
 14217     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14218     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14219     MOVE X'2020233030303132383430' TO DFHEIV0(25:11)
 14220     CALL 'kxdfhei1' USING DFHEIV0,
 14221           DLYACTV-DSID,
 14222           DAILY-ACTIVITY-RECORD,
 14223           DLYACTV-LENGTH,
 14224           DA-KEY,
 14225           DFHEIV99,
 14226           DFHEIV99
 14227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14228
 14229     GO TO 6700-EXIT.
 14230
 14231 6700-NOTOPEN-ERROR.
 14232     MOVE '2955'                 TO EMI-ERROR.
 14233     MOVE -1                     TO MAINTL.
 14234     MOVE AL-UANON               TO MAINTA.
 14235     PERFORM 9900-ERROR-FORMAT THRU
 14236             9900-EXIT.
 14237     GO TO 8200-SEND-DATAONLY.
 14238
 14239 6700-EXIT.
 14240     EXIT.
 14241
 14242*************************************************************
 14243*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14244*************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 269
* EL130.cbl
 14245/
 14246 6990-DEEDIT-DATE.
 14247
 14248
 14249* EXEC CICS BIF DEEDIT
 14250*        FIELD   (DATE-WORK)
 14251*        LENGTH  (8)
 14252*    END-EXEC.
 14253     MOVE 8
 14254       TO DFHEIV11
 14255*    MOVE '@"L                   #   #00012865' TO DFHEIV0
 14256     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14257     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14258     MOVE X'2020233030303132383635' TO DFHEIV0(25:11)
 14259     CALL 'kxdfhei1' USING DFHEIV0,
 14260           DATE-WORK,
 14261           DFHEIV11
 14262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14263
 14264 6990-EXIT.
 14265     EXIT.
 14266
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 270
* EL130.cbl
 14268 7000-BUILD-OUTPUT-MAP.
 14269
 14270     IF CLAIM-SWITCH = 'N'
 14271         GO TO 7050-BUILD-MAP-CERT-DATA
 14272     END-IF.
 14273
 14274     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14275         MOVE SPACES                 TO SEQUO
 14276         MOVE AL-SABOF               TO SEQUA
 14277     ELSE
 14278         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14279         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14280         MOVE WS-CLAIM-SEQU          TO SEQUO
 14281         MOVE AL-SABON               TO SEQUA
 14282     END-IF.
 14283
 14284     MOVE CL-CARRIER             TO CLMCARRO.
 14285     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14286     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14287     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14288     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14289     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14290     MOVE CL-INSURED-MID-INIT    TO INITO.
 14291     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14292     MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14293
 14294     MOVE AL-UANON               TO CLMCARRA
 14295                                    CLMTYPEA
 14296                                    PCERTNOA
 14297                                    PSUFXA
 14298                                    LSTNMEA
 14299                                    FSTNMEA
 14300                                    INITA
 14301                                    SEXA
 14302                                    OCCCDA.
 14303
 14304     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14305
 14306     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14307         MOVE ' '                 TO DC-OPTION-CODE
 14308         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14309         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14310         IF NOT DATE-CONVERSION-ERROR
 14311             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14312             MOVE AL-UANON            TO BIRTHDTA
 14313         END-IF
 14314     END-IF.
 14315
 14316     MOVE CL-SOC-SEC-NO          TO SSNO.
 14317     MOVE AL-UANON               TO SSNA.
 14318
 14319     IF CL-INCURRED-DT NOT = LOW-VALUES
 14320         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14321         MOVE ' '                TO DC-OPTION-CODE
 14322         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14323         IF NOT DATE-CONVERSION-ERROR
 14324             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14325             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 271
* EL130.cbl
 14326         END-IF
 14327     END-IF.
 14328
 14329     IF CL-REPORTED-DT NOT = LOW-VALUES
 14330         MOVE ' '                TO DC-OPTION-CODE
 14331         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14332         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14333         IF NOT DATE-CONVERSION-ERROR
 14334             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14335             MOVE AL-UANON            TO REPORTA
 14336         END-IF
 14337     END-IF.
 14338
 14339*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14340*        MOVE ' '                 TO DC-OPTION-CODE
 14341*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14342*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14343*        IF NOT DATE-CONVERSION-ERROR
 14344*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14345*            MOVE AL-UANON            TO ESTENDA
 14346*        END-IF
 14347*    END-IF.
 14348
 14349     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14350     MOVE WS-ICD-CODE-1          TO ICD1O.
 14351     MOVE WS-ICD-CODE-2          TO ICD2O.
 14352*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14353     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14354     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14355     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14356     MOVE CL-PRIORITY-CD         TO PRICDO.
 14357     MOVE AL-UANON               TO DIAGA
 14358                                    ICD1A
 14359                                    ICD2A
 14360*                                   CAUSEA
 14361                                    RELCLMA
 14362                                    PROCCDA
 14363                                    PRICDA.
 14364     MOVE AL-UNNON               TO MANRSVA.
 14365
 14366*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14367*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14368*        MOVE AL-UANON               TO PRODCDA
 14369*    END-IF.
 14370
 14371     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14372     MOVE CL-FILE-LOCATION       TO FILETOO.
 14373     MOVE CL-BENEFICIARY         TO BENECDO.
 14374     MOVE AL-UANON               TO SUPVA
 14375                                    FILETOA
 14376                                    BENECDA.
 14377
 14378     IF CLAIM-SWITCH = 'X'
 14379         GO TO 7099-EXIT
 14380     END-IF.
 14381
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 272
* EL130.cbl
 14383 7050-BUILD-MAP-CERT-DATA.
 14384     MOVE CM-CERT-PRIME          TO CERTNOO.
 14385     MOVE CM-CERT-SFX            TO SUFXO.
 14386     MOVE AL-SANON               TO CERTNOA
 14387                                    SUFXA.
 14388
 14389     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14390         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14391         MOVE ' '                TO DC-OPTION-CODE
 14392         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14393         IF NOT DATE-CONVERSION-ERROR
 14394             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14395         END-IF
 14396     END-IF.
 14397
 14398     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14399     MOVE CM-STATE               TO STATEO.
 14400     MOVE CM-CARRIER             TO CRTCARRO.
 14401     MOVE CM-GROUPING            TO GROUPO.
 14402     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14403     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14404     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14405     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14406     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14407     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14408     MOVE CM-JT-INITIAL          TO JNTINITO.
 14409     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14410     MOVE AL-UANON               TO ACCOUNTA
 14411                                    STATEA
 14412                                    CRTCARRA
 14413                                    GROUPA
 14414                                    CRTLNMEA
 14415                                    CRTFNMEA
 14416                                    CRTINITA
 14417                                    JNTLNMEA
 14418                                    JNTFNMEA
 14419                                    JNTINITA.
 14420     MOVE AL-UNNON               TO ISSAGEA
 14421                                    JNTAGEA.
 14422
 14423     IF CM-SSN-STATE   = CM-STATE AND
 14424        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14425*        NEXT SENTENCE
 14426         CONTINUE
 14427     ELSE
 14428         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14429     END-IF.
 14430
 14431     MOVE AL-UANON               TO CRTSSNA.
 14432
 14433     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14434     MOVE '2'                    TO DC-OPTION-CODE.
 14435     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14436     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14437
 14438*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14439     MOVE SPACES                 TO ELCNTL-KEY.
 14440     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 273
* EL130.cbl
 14441     MOVE '3'                    TO CNTL-REC-TYPE.
 14442     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14443     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14444
 14445
 14446
 14447* EXEC CICS READ
 14448*        DATASET  (ELCNTL-DSID)
 14449*        SET      (ADDRESS OF CONTROL-FILE)
 14450*        RIDFLD   (ELCNTL-KEY)
 14451*        RESP     (WS-RESPONSE)
 14452*    END-EXEC.
 14453*    MOVE '&"S        E          (  N#00013051' TO DFHEIV0
 14454     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14456     MOVE X'204E233030303133303531' TO DFHEIV0(25:11)
 14457     CALL 'kxdfhei1' USING DFHEIV0,
 14458           ELCNTL-DSID,
 14459           DFHEIV20,
 14460           DFHEIV99,
 14461           ELCNTL-KEY,
 14462           DFHEIV99,
 14463           DFHEIV99,
 14464           DFHEIV99
 14465     SET ADDRESS OF CONTROL-FILE TO
 14466         DFHEIV20
 14467     MOVE EIBRESP  TO WS-RESPONSE
 14468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14469
 14470
 14471     IF WS-RESP-NOTFND
 14472          MOVE ER-2848           TO EMI-ERROR
 14473          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14474          GO TO 8100-SEND-INITIAL-MAP
 14475     END-IF.
 14476
 14477     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14478     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14479     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 274
* EL130.cbl
 14481     IF CM-LF-BENEFIT-CD = '00'
 14482         MOVE ZEROS              TO LCVOTRMO
 14483                                    LCVRTRMO
 14484                                    LCVRATEO
 14485                                    LCVBENEO
 14486         MOVE SPACES             TO LCVDSCRO
 14487                                    LCVCDO
 14488                                    LCVKINDO
 14489                                    LCVFORMO
 14490                                    LCVCNDTO
 14491                                    LCVEXITO
 14492                                    LCVSTATO
 14493         IF CLMTYPEL GREATER THAN ZERO AND
 14494            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14495                MOVE ER-0521     TO EMI-ERROR
 14496                MOVE AL-UABON    TO CLMTYPEA
 14497                MOVE -1          TO CLMTYPEL
 14498                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14499                GO TO 7060-FILL-AH-COVERAGE
 14500         ELSE
 14501             GO TO 7060-FILL-AH-COVERAGE
 14502         END-IF
 14503     END-IF.
 14504
 14505     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14506     MOVE AL-UANON               TO LCVDSCRA.
 14507     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14508     MOVE '4'                    TO WS-REC-TYPE.
 14509     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14510     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14511     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14512     MOVE AL-UANON               TO LCVCDA.
 14513     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14514                                    CP-ORIGINAL-TERM.
 14515     MOVE AL-UNNON               TO LCVOTRMA.
 14516     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14517     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14518     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14519     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14520     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14521     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14522
 14523     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14524     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14525
 14526     IF CM-LF-PREMIUM-RATE NUMERIC
 14527         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14528     ELSE
 14529         MOVE ZEROS              TO LCVRATEO
 14530     END-IF.
 14531
 14532     MOVE AL-UNNON               TO LCVRATEA.
 14533
 14534     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14535         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14536     END-IF.
 14537
 14538     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 275
* EL130.cbl
 14539
 14540     MOVE AL-UNNON               TO LCVBENEA.
 14541
 14542     IF CM-POLICY-FORM-NO NOT = SPACES
 14543         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14544     ELSE
 14545         MOVE WS-FORM-HOLD       TO LCVFORMO
 14546     END-IF.
 14547
 14548     MOVE SPACES                 TO WS-FORM-HOLD.
 14549     MOVE 'L'                    TO WS-REC-TYPE.
 14550     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14551
 14552     IF WS-FORM-HOLD NOT = SPACES
 14553         MOVE WS-FORM-HOLD       TO LCVFORMO
 14554         MOVE AL-UANON           TO LCVFORMA
 14555     END-IF.
 14556
 14557     IF CM-LF-CURRENT-STATUS = '8'
 14558         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14559             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14560             MOVE ' '             TO DC-OPTION-CODE
 14561             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14562             IF NOT DATE-CONVERSION-ERROR
 14563                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14564                 MOVE AL-UANON            TO LCVCNDTA
 14565             END-IF
 14566         END-IF
 14567     END-IF.
 14568
 14569     IF CM-LF-CURRENT-STATUS = '7'
 14570         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14571             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14572             MOVE ' '            TO DC-OPTION-CODE
 14573             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14574             IF NOT DATE-CONVERSION-ERROR
 14575                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14576                 MOVE AL-UANON   TO LCVCNDTA
 14577             END-IF
 14578         END-IF
 14579     END-IF.
 14580
 14581     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14582         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14583             MOVE ' '            TO DC-OPTION-CODE
 14584             MOVE CM-LF-DEATH-EXIT-DT
 14585                                 TO DC-BIN-DATE-1
 14586             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14587             IF NOT DATE-CONVERSION-ERROR
 14588                 MOVE DC-GREG-DATE-1-EDIT
 14589                                 TO LCVEXITO
 14590             END-IF
 14591         END-IF
 14592     END-IF.
 14593
 14594     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14595         IF CP-REMAINING-TERM-3 = ZEROS
 14596             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 276
* EL130.cbl
 14597         ELSE
 14598             MOVE 'ACTIVE'       TO LCVSTATO
 14599         END-IF
 14600     END-IF.
 14601
 14602     IF CM-LF-CURRENT-STATUS = '2'
 14603        MOVE 'PEND  '            TO LCVSTATO
 14604     END-IF.
 14605     IF CM-LF-CURRENT-STATUS = '3'
 14606        MOVE 'RESTORE'           TO LCVSTATO
 14607     END-IF.
 14608     IF CM-LF-CURRENT-STATUS = '5'
 14609        MOVE 'REISSUE'           TO LCVSTATO
 14610     END-IF.
 14611     IF CM-LF-CURRENT-STATUS = '6'
 14612        MOVE 'LMP DIS'           TO LCVSTATO
 14613     END-IF.
 14614     IF CM-LF-CURRENT-STATUS = '7'
 14615        MOVE 'DEATH  '           TO LCVSTATO
 14616     END-IF.
 14617     IF CM-LF-CURRENT-STATUS = '8'
 14618        MOVE 'CANCEL '           TO LCVSTATO
 14619     END-IF.
 14620     IF CM-LF-CURRENT-STATUS = '9'
 14621        MOVE 'RE-ONLY'           TO LCVSTATO
 14622     END-IF.
 14623     IF CM-LF-CURRENT-STATUS = 'V'
 14624        MOVE 'VOID   '           TO LCVSTATO
 14625     END-IF.
 14626     IF CM-LF-CURRENT-STATUS = 'D'
 14627        MOVE 'DECLINE'           TO LCVSTATO
 14628     END-IF.
 14629
 14630     IF PI-COMPANY-ID = 'CID'
 14631         IF CM-LF-BENEFIT-CD >= '2O' AND
 14632            CM-LF-BENEFIT-CD <= '2V'
 14633             MOVE ER-0878       TO EMI-ERROR
 14634             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14635         END-IF
 14636     END-IF.
 14637
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 277
* EL130.cbl
 14639 7060-FILL-AH-COVERAGE.
 14640
 14641     IF CM-AH-BENEFIT-CD = '00'
 14642         MOVE ZEROS              TO ACVOTRMO
 14643                                    ACVRTRMO
 14644                                    ACVRATEO
 14645                                    ACVBENEO
 14646         MOVE SPACES             TO ACVDSCRO
 14647                                    ACVCDO
 14648                                    ACVKINDO
 14649                                    ACVFORMO
 14650                                    ACVCNDTO
 14651                                    ACVEXITO
 14652                                    ACVSTATO
 14653         IF (CLMTYPEL GREATER THAN ZERO AND
 14654             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 14655             MOVE ER-0521     TO EMI-ERROR
 14656             MOVE AL-UABON    TO CLMTYPEA
 14657             MOVE -1          TO CLMTYPEL
 14658             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14659             GO TO 7070-BUILD-MAP-FINISH
 14660         ELSE
 14661             GO TO 7070-BUILD-MAP-FINISH
 14662         END-IF
 14663     END-IF.
 14664
 14665     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14666     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 14667     MOVE AL-UANON               TO ACVDSCRA
 14668                                    ACVCDA.
 14669     MOVE '5'                    TO WS-REC-TYPE.
 14670     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14671     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 14672
 14673     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 14674                                    CP-ORIGINAL-TERM.
 14675     MOVE AL-UNNON               TO ACVOTRMA.
 14676
 14677     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14678     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14679     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14680     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14681     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14682     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14683
 14684     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14685     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14686
 14687     IF CM-AH-PREMIUM-RATE NUMERIC
 14688         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14689     ELSE
 14690         MOVE ZEROS              TO ACVRATEO
 14691     END-IF.
 14692
 14693     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 14694     MOVE AL-UNNON               TO ACVRATEA
 14695                                    ACVBENEA.
 14696
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 278
* EL130.cbl
 14697     IF CM-POLICY-FORM-NO NOT = SPACES
 14698         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 14699     ELSE
 14700         MOVE WS-FORM-HOLD       TO ACVFORMO
 14701         MOVE SPACES TO WS-FORM-HOLD
 14702         MOVE 'A'                TO WS-REC-TYPE
 14703         PERFORM 7400-READ-STATE THRU 7499-EXIT
 14704         IF WS-FORM-HOLD NOT = SPACES
 14705             MOVE WS-FORM-HOLD   TO ACVFORMO
 14706         END-IF
 14707     END-IF.
 14708
 14709     MOVE AL-UANON               TO ACVFORMA.
 14710
 14711     IF CM-AH-CURRENT-STATUS = '8'
 14712         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 14713             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14714             MOVE ' '             TO DC-OPTION-CODE
 14715             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14716             IF NOT DATE-CONVERSION-ERROR
 14717                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14718                MOVE AL-UANON    TO ACVCNDTA
 14719             END-IF
 14720         END-IF
 14721     END-IF.
 14722
 14723     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14724         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14725             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 14726             MOVE ' '             TO DC-OPTION-CODE
 14727             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14728             IF NOT DATE-CONVERSION-ERROR
 14729                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14730                MOVE AL-UANON            TO ACVCNDTA
 14731             END-IF
 14732         END-IF
 14733     END-IF.
 14734
 14735     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14736         MOVE ' '                TO DC-OPTION-CODE
 14737         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14738         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14739         IF NOT DATE-CONVERSION-ERROR
 14740             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 14741         END-IF
 14742     END-IF.
 14743
 14744     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14745         IF CP-REMAINING-TERM-3 = ZEROS
 14746             MOVE 'EXPIRED'      TO ACVSTATO
 14747         ELSE
 14748             MOVE 'ACTIVE'       TO ACVSTATO
 14749         END-IF
 14750     END-IF.
 14751
 14752     IF CM-AH-CURRENT-STATUS = '2'
 14753         MOVE 'PEND  '           TO ACVSTATO
 14754     END-IF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 279
* EL130.cbl
 14755     IF CM-AH-CURRENT-STATUS = '3'
 14756         MOVE 'RESTORE'          TO ACVSTATO
 14757     END-IF.
 14758     IF CM-AH-CURRENT-STATUS = '5'
 14759         MOVE 'REISSUE'          TO ACVSTATO
 14760     END-IF.
 14761     IF CM-AH-CURRENT-STATUS = '6'
 14762         MOVE 'LMP DIS'          TO ACVSTATO
 14763     END-IF.
 14764     IF CM-AH-CURRENT-STATUS = '7'
 14765         MOVE 'DEATH  '          TO ACVSTATO
 14766     END-IF.
 14767     IF CM-AH-CURRENT-STATUS = '8'
 14768         MOVE 'CANCEL '          TO ACVSTATO
 14769     END-IF.
 14770     IF CM-AH-CURRENT-STATUS = '9'
 14771         MOVE 'RE-ONLY'          TO ACVSTATO
 14772     END-IF.
 14773     IF CM-AH-CURRENT-STATUS = 'V'
 14774         MOVE 'VOID   '          TO ACVSTATO
 14775     END-IF.
 14776     IF CM-AH-CURRENT-STATUS = 'D'
 14777         MOVE 'DECLINE'          TO ACVSTATO
 14778     END-IF.
 14779
 14780     IF PI-COMPANY-ID = 'DCC'
 14781        IF CM-ACCOUNT (9:2) = 'BI'
 14782           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 14783           MOVE CM-CARRIER       TO CTRLR-CARRIER
 14784           MOVE CM-GROUPING      TO CTRLR-GROUPING
 14785           MOVE CM-STATE         TO CTRLR-STATE
 14786           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 14787           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 14788           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 14789           MOVE 'C'              TO CTRLR-REC-TYPE
 14790
 14791* EXEC CICS READ
 14792*            DATASET  (ELCRTT-DSID)
 14793*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 14794*            RIDFLD   (ELCRTT-KEY)
 14795*            RESP     (WS-RESPONSE)
 14796*          END-EXEC
 14797*    MOVE '&"S        E          (  N#00013377' TO DFHEIV0
 14798     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14800     MOVE X'204E233030303133333737' TO DFHEIV0(25:11)
 14801     CALL 'kxdfhei1' USING DFHEIV0,
 14802           ELCRTT-DSID,
 14803           DFHEIV20,
 14804           DFHEIV99,
 14805           ELCRTT-KEY,
 14806           DFHEIV99,
 14807           DFHEIV99,
 14808           DFHEIV99
 14809     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 14810         DFHEIV20
 14811     MOVE EIBRESP  TO WS-RESPONSE
 14812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 280
* EL130.cbl
 14813           IF WS-RESP-NORMAL
 14814               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 14815               MOVE WS-DIAG-VIN-MSG TO DIAGO
 14816               MOVE AL-UANON        TO DIAGA
 14817           END-IF
 14818        END-IF
 14819     END-IF.
 14820
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 281
* EL130.cbl
 14822 7070-BUILD-MAP-FINISH.
 14823     MOVE CM-LOAN-APR            TO APRO.
 14824     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14825     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14826     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 14827     MOVE AL-UNNON               TO APRA
 14828                                    PMTFREQA.
 14829     MOVE AL-UANON               TO INDGRPA
 14830                                    PREMTYPA.
 14831
 14832     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 14833         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 14834         MOVE AL-UANON               TO REINCDA
 14835     END-IF.
 14836
 14837     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 14838*        NEXT SENTENCE
 14839         CONTINUE
 14840     ELSE
 14841         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14842         MOVE ' '                TO DC-OPTION-CODE
 14843         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14844         IF NOT DATE-CONVERSION-ERROR
 14845             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 14846             MOVE AL-UANON            TO ADDONDTA
 14847         END-IF
 14848     END-IF.
 14849
 14850     IF CLAIM-SWITCH = 'N'
 14851         IF SEXL = ZEROS
 14852             MOVE CM-INSURED-SEX TO SEXO
 14853*            MOVE AL-UANON       TO SEXA
 14854         END-IF
 14855     END-IF.
 14856
 14857     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 14858         MOVE CM-MEMBER-NO       TO MEMBERO
 14859         MOVE AL-UANON           TO MEMBERA
 14860     END-IF.
 14861
 14862     IF MAINTI = 'A'
 14863         IF (LOANNOL = ZEROS OR
 14864             EIBAID = DFHPF5)
 14865             MOVE CM-LOAN-NUMBER TO LOANNOO
 14866             MOVE AL-UANON       TO LOANNOA
 14867         ELSE
 14868*            NEXT SENTENCE
 14869             CONTINUE
 14870         END-IF
 14871     ELSE
 14872         MOVE CM-LOAN-NUMBER     TO LOANNOO
 14873         MOVE AL-UANON           TO LOANNOA
 14874     END-IF.
 14875
 14876     IF MAINTI = 'A'
 14877         IF (LOANBALL = ZEROS OR
 14878             EIBAID = DFHPF5)
 14879             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 282
* EL130.cbl
 14880             MOVE AL-UNNON       TO LOANBALA
 14881         ELSE
 14882*            NEXT SENTENCE
 14883             CONTINUE
 14884         END-IF
 14885     ELSE
 14886         MOVE CM-LOAN-BALANCE    TO LOANBALO
 14887         MOVE AL-UNNON           TO LOANBALA
 14888     END-IF.
 14889
 14890     IF CM-PREMIUM-TYPE NOT = '3'
 14891         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 14892             PERFORM 7200-PROTECT-CERT-FIELDS
 14893         ELSE
 14894             PERFORM 7300-RESET-KEY-ATTRBS
 14895         END-IF
 14896     ELSE
 14897         PERFORM 7300-RESET-KEY-ATTRBS
 14898     END-IF.
 14899
 14900*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 14901*        NEXT SENTENCE
 14902*        CONTINUE
 14903*    ELSE
 14904         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 14905*    END-IF.
 14906
 14907 7099-EXIT.
 14908     EXIT.
 14909
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 283
* EL130.cbl
 14911 7100-READ-BENEFIT.
 14912
 14913
 14914* EXEC CICS HANDLE CONDITION
 14915*         NOTFND   (7120-NOT-FOUND)
 14916*    END-EXEC.
 14917*    MOVE '"$I                   ! E #00013483' TO DFHEIV0
 14918     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14920     MOVE X'4520233030303133343833' TO DFHEIV0(25:11)
 14921     CALL 'kxdfhei1' USING DFHEIV0
 14922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14923
 14924
 14925     MOVE SPACES                 TO ELCNTL-KEY.
 14926     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 14927     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 14928     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14929     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14930
 14931 7105-READ-FILE.
 14932     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 14933
 14934     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 14935        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 14936          GO TO 7120-NOT-FOUND
 14937     END-IF.
 14938
 14939     MOVE 1                      TO SUB.
 14940 7110-LOOP.
 14941     IF SUB = 9
 14942         GO TO 7120-NOT-FOUND
 14943     END-IF.
 14944
 14945     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 14946         ADD 1                   TO SUB
 14947         GO TO 7110-LOOP
 14948     END-IF.
 14949
 14950     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 14951     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 14952     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 14953
 14954     GO TO 7199-EXIT.
 14955
 14956 7120-NOT-FOUND.
 14957     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 14958                                    WS-FORM-HOLD.
 14959
 14960 7199-EXIT.
 14961      EXIT.
 14962
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 284
* EL130.cbl
 14964 7200-PROTECT-CERT-FIELDS.
 14965     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 14966                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 14967                                LCVFORMA ACVFORMA JNTLNMEA
 14968                                JNTFNMEA JNTINITA.
 14969
 14970     IF CM-LF-CURRENT-STATUS = '2' OR
 14971        CM-AH-CURRENT-STATUS = '2'
 14972         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 14973     END-IF.
 14974
 14975     MOVE AL-SANOF TO
 14976            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 14977            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 14978            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 14979            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 14980            LCVRATEA   ACVRATEA.
 14981
 14982     MOVE 'S'                    TO CERTMTI.
 14983
 14984 7300-RESET-KEY-ATTRBS.
 14985     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 14986                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 14987                                LCVFORMA ACVFORMA JNTLNMEA
 14988                                JNTFNMEA JNTINITA.
 14989
 14990     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 14991         MOVE AL-SANOF           TO REINCDA
 14992     END-IF.
 14993
 14994     MOVE 'S'                    TO CERTMTI.
 14995
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 285
* EL130.cbl
 14997 7400-READ-STATE.
 14998
 14999
 15000* EXEC CICS HANDLE CONDITION
 15001*         NOTFND   (7499-EXIT)
 15002*    END-EXEC.
 15003*    MOVE '"$I                   ! F #00013561' TO DFHEIV0
 15004     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15006     MOVE X'4620233030303133353631' TO DFHEIV0(25:11)
 15007     CALL 'kxdfhei1' USING DFHEIV0
 15008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15009
 15010
 15011     MOVE SPACES                 TO ELCNTL-KEY.
 15012     MOVE CM-STATE               TO CNTL-ACCESS.
 15013     MOVE '3'                    TO CNTL-REC-TYPE.
 15014     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15015     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15016
 15017     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15018
 15019     MOVE 1                      TO SUB.
 15020
 15021 7410-LOOP.
 15022     IF SUB = 21
 15023        GO TO 7499-EXIT
 15024     END-IF.
 15025
 15026*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15027*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15028*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15029*        GO TO 7499-EXIT.
 15030
 15031     ADD 1                       TO SUB.
 15032     GO TO 7410-LOOP.
 15033
 15034 7499-EXIT.
 15035      EXIT.
 15036
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 286
* EL130.cbl
 15038 7500-BROWSE-FOR-DUPLICATE.
 15039
 15040     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15041
 15042
 15043
 15044* EXEC CICS HANDLE CONDITION
 15045*        NOTFND   (7500-EXIT)
 15046*        DUPKEY   (7500-DUPLICATE-KEY)
 15047*        ENDFILE  (7500-EXIT)
 15048*    END-EXEC.
 15049*    MOVE '"$I$''                 ! G #00013597' TO DFHEIV0
 15050     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15052     MOVE X'4720233030303133353937' TO DFHEIV0(25:11)
 15053     CALL 'kxdfhei1' USING DFHEIV0
 15054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15055
 15056
 15057
 15058
 15059* EXEC CICS STARTBR
 15060*        DATASET    (ELMSTR5-DSID)
 15061*        RIDFLD     (ELMSTR5-KEY)
 15062*    END-EXEC.
 15063     MOVE 0
 15064       TO DFHEIV11
 15065*    MOVE '&,         G          &   #00013604' TO DFHEIV0
 15066     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15067     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15068     MOVE X'2020233030303133363034' TO DFHEIV0(25:11)
 15069     CALL 'kxdfhei1' USING DFHEIV0,
 15070           ELMSTR5-DSID,
 15071           ELMSTR5-KEY,
 15072           DFHEIV99,
 15073           DFHEIV11,
 15074           DFHEIV99
 15075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15076
 15077
 15078
 15079
 15080* EXEC CICS HANDLE CONDITION
 15081*        ENDFILE  (7500-END-BROWSE)
 15082*    END-EXEC.
 15083*    MOVE '"$''                   ! H #00013610' TO DFHEIV0
 15084     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15086     MOVE X'4820233030303133363130' TO DFHEIV0(25:11)
 15087     CALL 'kxdfhei1' USING DFHEIV0
 15088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15089
 15090
 15091 7500-READ-CLAIM-LOOP.
 15092
 15093
 15094
 15095* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 287
* EL130.cbl
 15096*        DATASET   (ELMSTR5-DSID)
 15097*        SET       (ADDRESS OF CLAIM-MASTER)
 15098*        RIDFLD    (ELMSTR5-KEY)
 15099*    END-EXEC.
 15100     MOVE 0
 15101       TO DFHEIV11
 15102*    MOVE '&.S                   )   #00013617' TO DFHEIV0
 15103     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15104     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15105     MOVE X'2020233030303133363137' TO DFHEIV0(25:11)
 15106     CALL 'kxdfhei1' USING DFHEIV0,
 15107           ELMSTR5-DSID,
 15108           DFHEIV20,
 15109           DFHEIV99,
 15110           ELMSTR5-KEY,
 15111           DFHEIV99,
 15112           DFHEIV11,
 15113           DFHEIV99,
 15114           DFHEIV99
 15115     SET ADDRESS OF CLAIM-MASTER TO
 15116         DFHEIV20
 15117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15118
 15119
 15120 7500-DUPLICATE-KEY.
 15121
 15122     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15123        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15124        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15125        CL-CERT-STATE     NOT = CM-STATE       OR
 15126        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15127        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15128        CL-CERT-NO        NOT = CM-CERT-NO
 15129           GO TO 7500-CHECK-MATCH-COUNT
 15130     END-IF.
 15131
 15132     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15133
 15134     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15135        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15136        GO TO 7500-END-BROWSE
 15137     ELSE
 15138        GO TO 7500-READ-CLAIM-LOOP
 15139     END-IF.
 15140
 15141 7500-CHECK-MATCH-COUNT.
 15142
 15143     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15144        CL-CERT-NO    = CM-CERT-NO
 15145          GO TO 7500-READ-CLAIM-LOOP
 15146     END-IF.
 15147
 15148 7500-END-BROWSE.
 15149
 15150
 15151
 15152* EXEC CICS ENDBR
 15153*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 288
* EL130.cbl
 15154*    END-EXEC.
 15155     MOVE 0
 15156       TO DFHEIV11
 15157*    MOVE '&2                    $   #00013654' TO DFHEIV0
 15158     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15159     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15160     MOVE X'2020233030303133363534' TO DFHEIV0(25:11)
 15161     CALL 'kxdfhei1' USING DFHEIV0,
 15162           ELMSTR5-DSID,
 15163           DFHEIV11,
 15164           DFHEIV99
 15165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15166
 15167
 15168 7500-EXIT.
 15169     EXIT.
 15170
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 289
* EL130.cbl
 15172 7550-FALL-THRU-PARA.
 15173
 15174
 15175
 15176* EXEC CICS DUMP
 15177*         DUMPCODE ('E130')
 15178*         TASK
 15179*    END-EXEC.
 15180     MOVE 'E130' TO DFHEIV5
 15181*    MOVE '<"   T                $   #00013665' TO DFHEIV0
 15182     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15183     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15184     MOVE X'2020233030303133363635' TO DFHEIV0(25:11)
 15185     CALL 'kxdfhei1' USING DFHEIV0,
 15186           DFHEIV5,
 15187           DFHEIV99,
 15188           DFHEIV99
 15189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15190
 15191
 15192
 15193
 15194* EXEC CICS RETURN
 15195*    END-EXEC.
 15196*    MOVE '.(                    ''   #00013671' TO DFHEIV0
 15197     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15198     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15199     MOVE X'2020233030303133363731' TO DFHEIV0(25:11)
 15200     CALL 'kxdfhei1' USING DFHEIV0,
 15201           DFHEIV99,
 15202           DFHEIV99,
 15203           DFHEIV99,
 15204           DFHEIV99,
 15205           DFHEIV99,
 15206           DFHEIV99
 15207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15208
 15209
 15210 7600-BROWSE-CLAIM.
 15211
 15212
 15213
 15214* EXEC CICS READ
 15215*        DATASET(ELMSTR-DSID)
 15216*        SET    (ADDRESS OF CLAIM-MASTER)
 15217*        RIDFLD (ELMSTR-KEY)
 15218*        GENERIC
 15219*        EQUAL
 15220*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15221*    END-EXEC.
 15222*    MOVE '&"S  KG    E          (   #00013677' TO DFHEIV0
 15223     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15224     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15225     MOVE X'2020233030303133363737' TO DFHEIV0(25:11)
 15226     CALL 'kxdfhei1' USING DFHEIV0,
 15227           ELMSTR-DSID,
 15228           DFHEIV20,
 15229           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 290
* EL130.cbl
 15230           ELMSTR-KEY,
 15231           ELMSTR-GENERIC-LENGTH,
 15232           DFHEIV99,
 15233           DFHEIV99
 15234     SET ADDRESS OF CLAIM-MASTER TO
 15235         DFHEIV20
 15236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15237
 15238
 15239     MOVE CL-CERT-PRIME          TO CERTNOI.
 15240     MOVE CL-CERT-SFX            TO SUFXI.
 15241
 15242 7610-BROWSE-CLAIM-LOOP.
 15243
 15244     MOVE LOW-VALUES             TO BCERT1O
 15245                                    BSUFX1O
 15246                                    BCERT2O
 15247                                    BSUFX2O
 15248                                    BCERT3O
 15249                                    BSUFX3O
 15250                                    BCERT4O
 15251                                    BSUFX4O
 15252                                    BCERT5O
 15253                                    BSUFX5O.
 15254
 15255     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15256
 15257
 15258
 15259* EXEC CICS HANDLE CONDITION
 15260*        ENDFILE  (7630-END-BROWSE)
 15261*    END-EXEC.
 15262*    MOVE '"$''                   ! I #00013705' TO DFHEIV0
 15263     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15265     MOVE X'4920233030303133373035' TO DFHEIV0(25:11)
 15266     CALL 'kxdfhei1' USING DFHEIV0
 15267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15268
 15269
 15270
 15271
 15272* EXEC CICS STARTBR
 15273*        DATASET    (ELMSTR-DSID)
 15274*        RIDFLD     (ELMSTR-KEY)
 15275*    END-EXEC.
 15276     MOVE 0
 15277       TO DFHEIV11
 15278*    MOVE '&,         G          &   #00013710' TO DFHEIV0
 15279     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15280     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15281     MOVE X'2020233030303133373130' TO DFHEIV0(25:11)
 15282     CALL 'kxdfhei1' USING DFHEIV0,
 15283           ELMSTR-DSID,
 15284           ELMSTR-KEY,
 15285           DFHEIV99,
 15286           DFHEIV11,
 15287           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 291
* EL130.cbl
 15288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15289
 15290
 15291     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15292
 15293 7620-READ-CLAIM-LOOP.
 15294
 15295
 15296
 15297* EXEC CICS READNEXT
 15298*        DATASET   (ELMSTR-DSID)
 15299*        SET       (ADDRESS OF CLAIM-MASTER)
 15300*        RIDFLD    (ELMSTR-KEY)
 15301*    END-EXEC.
 15302     MOVE 0
 15303       TO DFHEIV11
 15304*    MOVE '&.S                   )   #00013720' TO DFHEIV0
 15305     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15306     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15307     MOVE X'2020233030303133373230' TO DFHEIV0(25:11)
 15308     CALL 'kxdfhei1' USING DFHEIV0,
 15309           ELMSTR-DSID,
 15310           DFHEIV20,
 15311           DFHEIV99,
 15312           ELMSTR-KEY,
 15313           DFHEIV99,
 15314           DFHEIV11,
 15315           DFHEIV99,
 15316           DFHEIV99
 15317     SET ADDRESS OF CLAIM-MASTER TO
 15318         DFHEIV20
 15319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15320
 15321
 15322     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15323        CL-CARRIER     NOT = CLMCARRI       OR
 15324        CL-CLAIM-NO    NOT = CLMNOI
 15325          GO TO 7630-END-BROWSE
 15326     END-IF.
 15327
 15328     IF WS-ASSOCIATED-CERTS = 1
 15329         MOVE CL-CERT-PRIME      TO BCERT1O
 15330         MOVE CL-CERT-SFX        TO BSUFX1O
 15331     END-IF.
 15332
 15333     IF WS-ASSOCIATED-CERTS = 2
 15334         MOVE CL-CERT-PRIME      TO BCERT2O
 15335         MOVE CL-CERT-SFX        TO BSUFX2O
 15336     END-IF.
 15337
 15338     IF WS-ASSOCIATED-CERTS = 3
 15339         MOVE CL-CERT-PRIME      TO BCERT3O
 15340         MOVE CL-CERT-SFX        TO BSUFX3O
 15341     END-IF.
 15342
 15343     IF WS-ASSOCIATED-CERTS = 4
 15344         MOVE CL-CERT-PRIME      TO BCERT4O
 15345         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 292
* EL130.cbl
 15346     END-IF.
 15347
 15348     IF WS-ASSOCIATED-CERTS = 5
 15349         MOVE CL-CERT-PRIME      TO BCERT5O
 15350         MOVE CL-CERT-SFX        TO BSUFX5O
 15351     ELSE
 15352         ADD +1                  TO WS-ASSOCIATED-CERTS
 15353         GO TO 7620-READ-CLAIM-LOOP
 15354     END-IF.
 15355
 15356 7630-END-BROWSE.
 15357
 15358
 15359
 15360* EXEC CICS ENDBR
 15361*        DATASET   (ELMSTR-DSID)
 15362*    END-EXEC.
 15363     MOVE 0
 15364       TO DFHEIV11
 15365*    MOVE '&2                    $   #00013763' TO DFHEIV0
 15366     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15367     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15368     MOVE X'2020233030303133373633' TO DFHEIV0(25:11)
 15369     CALL 'kxdfhei1' USING DFHEIV0,
 15370           ELMSTR-DSID,
 15371           DFHEIV11,
 15372           DFHEIV99
 15373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15374
 15375
 15376 7640-HIGHLIGHT-CERT-DISPLAYED.
 15377
 15378     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15379     MOVE AL-SANON               TO BCERT1A
 15380                                    BSUFX1A
 15381                                    BCERT2A
 15382                                    BSUFX2A
 15383                                    BCERT3A
 15384                                    BSUFX3A
 15385                                    BCERT4A
 15386                                    BSUFX4A
 15387                                    BCERT5A
 15388                                    BSUFX5A.
 15389
 15390     IF BCERT1O = CERTNOI AND
 15391        BSUFX1O = SUFXI
 15392            MOVE AL-SABON        TO BCERT1A
 15393                                    BSUFX1A
 15394     END-IF.
 15395
 15396     IF BCERT2O = CERTNOI AND
 15397        BSUFX2O = SUFXI
 15398            MOVE AL-SABON        TO BCERT2A
 15399                                    BSUFX2A
 15400     END-IF.
 15401
 15402     IF BCERT3O = CERTNOI AND
 15403        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 293
* EL130.cbl
 15404            MOVE AL-SABON        TO BCERT3A
 15405                                    BSUFX3A
 15406     END-IF.
 15407
 15408     IF BCERT4O = CERTNOI AND
 15409        BSUFX4O = SUFXI
 15410            MOVE AL-SABON        TO BCERT4A
 15411                                    BSUFX4A
 15412     END-IF.
 15413
 15414     IF BCERT5O = CERTNOI AND
 15415        BSUFX5O = SUFXI
 15416            MOVE AL-SABON        TO BCERT5A
 15417                                    BSUFX5A
 15418     END-IF.
 15419
 15420 7699-EXIT.
 15421     EXIT.
 15422
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 294
* EL130.cbl
 15424 7700-CHECK-SEQUENCE.
 15425
 15426
 15427
 15428* EXEC CICS HANDLE CONDITION
 15429*        ENDFILE  (7799-EXIT)
 15430*        NOTFND   (7799-EXIT)
 15431*    END-EXEC.
 15432*    MOVE '"$''I                  ! J #00013818' TO DFHEIV0
 15433     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15435     MOVE X'4A20233030303133383138' TO DFHEIV0(25:11)
 15436     CALL 'kxdfhei1' USING DFHEIV0
 15437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15438
 15439
 15440
 15441
 15442* EXEC CICS READ
 15443*        DATASET(ELMSTR-DSID)
 15444*        SET    (ADDRESS OF CLAIM-MASTER)
 15445*        RIDFLD (ELMSTR-KEY)
 15446*        GENERIC
 15447*        EQUAL
 15448*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15449*    END-EXEC.
 15450*    MOVE '&"S  KG    E          (   #00013824' TO DFHEIV0
 15451     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15453     MOVE X'2020233030303133383234' TO DFHEIV0(25:11)
 15454     CALL 'kxdfhei1' USING DFHEIV0,
 15455           ELMSTR-DSID,
 15456           DFHEIV20,
 15457           DFHEIV99,
 15458           ELMSTR-KEY,
 15459           ELMSTR-GENERIC-LENGTH,
 15460           DFHEIV99,
 15461           DFHEIV99
 15462     SET ADDRESS OF CLAIM-MASTER TO
 15463         DFHEIV20
 15464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15465
 15466
 15467     COMPUTE WS-ASSOC-CERT-TOTAL =
 15468             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15469
 15470     GO TO 7799-EXIT.
 15471
 15472 7710-RESEQUENCE-CLAIMS.
 15473
 15474
 15475
 15476* EXEC CICS HANDLE CONDITION
 15477*        ENDFILE  (7790-END-BROWSE)
 15478*    END-EXEC.
 15479*    MOVE '"$''                   ! K #00013841' TO DFHEIV0
 15480     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 295
* EL130.cbl
 15482     MOVE X'4B20233030303133383431' TO DFHEIV0(25:11)
 15483     CALL 'kxdfhei1' USING DFHEIV0
 15484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15485
 15486
 15487
 15488
 15489* EXEC CICS STARTBR
 15490*        DATASET    (ELMSTR-DSID)
 15491*        RIDFLD     (ELMSTR-KEY)
 15492*    END-EXEC.
 15493     MOVE 0
 15494       TO DFHEIV11
 15495*    MOVE '&,         G          &   #00013846' TO DFHEIV0
 15496     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15497     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15498     MOVE X'2020233030303133383436' TO DFHEIV0(25:11)
 15499     CALL 'kxdfhei1' USING DFHEIV0,
 15500           ELMSTR-DSID,
 15501           ELMSTR-KEY,
 15502           DFHEIV99,
 15503           DFHEIV11,
 15504           DFHEIV99
 15505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15506
 15507
 15508     ADD +1 TO WS-ASSOC-CERT-SEQU
 15509               WS-READNEXT-SWITCH.
 15510
 15511 7720-READ-CLAIM-LOOP.
 15512
 15513
 15514
 15515* EXEC CICS READNEXT
 15516*        DATASET   (ELMSTR-DSID)
 15517*        SET       (ADDRESS OF CLAIM-MASTER)
 15518*        RIDFLD    (ELMSTR-KEY)
 15519*    END-EXEC.
 15520     MOVE 0
 15521       TO DFHEIV11
 15522*    MOVE '&.S                   )   #00013857' TO DFHEIV0
 15523     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15524     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15525     MOVE X'2020233030303133383537' TO DFHEIV0(25:11)
 15526     CALL 'kxdfhei1' USING DFHEIV0,
 15527           ELMSTR-DSID,
 15528           DFHEIV20,
 15529           DFHEIV99,
 15530           ELMSTR-KEY,
 15531           DFHEIV99,
 15532           DFHEIV11,
 15533           DFHEIV99,
 15534           DFHEIV99
 15535     SET ADDRESS OF CLAIM-MASTER TO
 15536         DFHEIV20
 15537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15538
 15539
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 296
* EL130.cbl
 15540     IF WS-READNEXT-SWITCH = 1
 15541         ADD 1 TO WS-READNEXT-SWITCH
 15542         GO TO 7720-READ-CLAIM-LOOP
 15543     END-IF.
 15544
 15545 7730-END-BROWSE.
 15546
 15547
 15548
 15549* EXEC CICS ENDBR
 15550*        DATASET   (ELMSTR-DSID)
 15551*    END-EXEC.
 15552     MOVE 0
 15553       TO DFHEIV11
 15554*    MOVE '&2                    $   #00013871' TO DFHEIV0
 15555     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15556     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15557     MOVE X'2020233030303133383731' TO DFHEIV0(25:11)
 15558     CALL 'kxdfhei1' USING DFHEIV0,
 15559           ELMSTR-DSID,
 15560           DFHEIV11,
 15561           DFHEIV99
 15562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15563
 15564
 15565 7740-READ-CLAIM-UPDATE.
 15566
 15567     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15568        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15569        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15570          GO TO 7799-EXIT
 15571     ELSE
 15572          MOVE ZERO              TO WS-READNEXT-SWITCH
 15573     END-IF.
 15574
 15575
 15576
 15577* EXEC CICS READ
 15578*        DATASET(ELMSTR-DSID)
 15579*        SET    (ADDRESS OF CLAIM-MASTER)
 15580*        RIDFLD (ELMSTR-KEY)
 15581*        UPDATE
 15582*    END-EXEC.
 15583*    MOVE '&"S        EU         (   #00013886' TO DFHEIV0
 15584     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15585     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15586     MOVE X'2020233030303133383836' TO DFHEIV0(25:11)
 15587     CALL 'kxdfhei1' USING DFHEIV0,
 15588           ELMSTR-DSID,
 15589           DFHEIV20,
 15590           DFHEIV99,
 15591           ELMSTR-KEY,
 15592           DFHEIV99,
 15593           DFHEIV99,
 15594           DFHEIV99
 15595     SET ADDRESS OF CLAIM-MASTER TO
 15596         DFHEIV20
 15597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 297
* EL130.cbl
 15598
 15599
 15600     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15601     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15602
 15603
 15604
 15605* EXEC CICS REWRITE
 15606*         DATASET     (ELMSTR-DSID)
 15607*         FROM        (CLAIM-MASTER)
 15608*    END-EXEC.
 15609     MOVE LENGTH OF
 15610      CLAIM-MASTER
 15611       TO DFHEIV11
 15612*    MOVE '&& L                  %   #00013897' TO DFHEIV0
 15613     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15614     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15615     MOVE X'2020233030303133383937' TO DFHEIV0(25:11)
 15616     CALL 'kxdfhei1' USING DFHEIV0,
 15617           ELMSTR-DSID,
 15618           CLAIM-MASTER,
 15619           DFHEIV11,
 15620           DFHEIV99
 15621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15622
 15623
 15624     GO TO 7710-RESEQUENCE-CLAIMS.
 15625
 15626 7790-END-BROWSE.
 15627
 15628
 15629
 15630* EXEC CICS ENDBR
 15631*        DATASET   (ELMSTR-DSID)
 15632*    END-EXEC.
 15633     MOVE 0
 15634       TO DFHEIV11
 15635*    MOVE '&2                    $   #00013907' TO DFHEIV0
 15636     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15637     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15638     MOVE X'2020233030303133393037' TO DFHEIV0(25:11)
 15639     CALL 'kxdfhei1' USING DFHEIV0,
 15640           ELMSTR-DSID,
 15641           DFHEIV11,
 15642           DFHEIV99
 15643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15644
 15645
 15646 7799-EXIT.
 15647     EXIT.
 15648
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 298
* EL130.cbl
 15650************************************************
 15651*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 15652************************************************
 15653
 15654 7900-READ-ACTV-UPDATE.
 15655     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15656     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15657     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15658     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15659     MOVE +0                     TO TRLR-SEQ-NO.
 15660     MOVE '1'                    TO TRLR-TYPE.
 15661     GO TO 7900-READ-TRAILER-UPDATE.
 15662
 15663 7900-READ-NINETY-UPDATE.
 15664     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15665     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15666     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15667     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15668     MOVE +90                    TO TRLR-SEQ-NO.
 15669     MOVE '6'                    TO TRLR-TYPE.
 15670
 15671 7900-READ-TRAILER-UPDATE.
 15672
 15673
 15674* EXEC CICS READ  UPDATE
 15675*        DATASET    (ELTRLR-DSID)
 15676*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 15677*        RIDFLD     (ELTRLR-KEY)
 15678*    END-EXEC.
 15679*    MOVE '&"S        EU         (   #00013938' TO DFHEIV0
 15680     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15681     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15682     MOVE X'2020233030303133393338' TO DFHEIV0(25:11)
 15683     CALL 'kxdfhei1' USING DFHEIV0,
 15684           ELTRLR-DSID,
 15685           DFHEIV20,
 15686           DFHEIV99,
 15687           ELTRLR-KEY,
 15688           DFHEIV99,
 15689           DFHEIV99,
 15690           DFHEIV99
 15691     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15692         DFHEIV20
 15693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15694
 15695
 15696 7900-EXIT.
 15697      EXIT.
 15698
 15699 7910-READ-ACTV.
 15700     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15701     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15702     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15703     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15704     MOVE +0                     TO TRLR-SEQ-NO.
 15705     MOVE '1'                    TO TRLR-TYPE.
 15706     GO TO 7910-READ-TRAILER.
 15707
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 299
* EL130.cbl
 15708 7910-READ-NINETY.
 15709     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15710     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15711     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15712     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15713     MOVE +90                    TO TRLR-SEQ-NO.
 15714     MOVE '6'                    TO TRLR-TYPE.
 15715
 15716 7910-READ-TRAILER.
 15717     MOVE 'TRLR'                 TO FILE-SWITCH.
 15718
 15719
 15720
 15721* EXEC CICS READ
 15722*        DATASET   (ELTRLR-DSID)
 15723*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15724*        RIDFLD    (ELTRLR-KEY)
 15725*    END-EXEC.
 15726*    MOVE '&"S        E          (   #00013968' TO DFHEIV0
 15727     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15729     MOVE X'2020233030303133393638' TO DFHEIV0(25:11)
 15730     CALL 'kxdfhei1' USING DFHEIV0,
 15731           ELTRLR-DSID,
 15732           DFHEIV20,
 15733           DFHEIV99,
 15734           ELTRLR-KEY,
 15735           DFHEIV99,
 15736           DFHEIV99,
 15737           DFHEIV99
 15738     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15739         DFHEIV20
 15740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15741
 15742
 15743 7910-EXIT.
 15744      EXIT.
 15745
 15746 7915-REWRITE-TRAILER.
 15747
 15748
 15749* EXEC CICS REWRITE
 15750*        DATASET   (ELTRLR-DSID)
 15751*        FROM      (ACTIVITY-TRAILERS)
 15752*    END-EXEC.
 15753     MOVE LENGTH OF
 15754      ACTIVITY-TRAILERS
 15755       TO DFHEIV11
 15756*    MOVE '&& L                  %   #00013979' TO DFHEIV0
 15757     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15758     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15759     MOVE X'2020233030303133393739' TO DFHEIV0(25:11)
 15760     CALL 'kxdfhei1' USING DFHEIV0,
 15761           ELTRLR-DSID,
 15762           ACTIVITY-TRAILERS,
 15763           DFHEIV11,
 15764           DFHEIV99
 15765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 300
* EL130.cbl
 15766
 15767
 15768 7915-EXIT.
 15769      EXIT.
 15770
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 301
* EL130.cbl
 15772********************************************
 15773*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 15774********************************************
 15775
 15776 7920-READ-CLAIM-UPDATE.
 15777
 15778
 15779
 15780* EXEC CICS READ
 15781*        UPDATE
 15782*        DATASET   (ELMSTR-DSID)
 15783*        SET       (ADDRESS OF CLAIM-MASTER)
 15784*        RIDFLD    (ELMSTR-KEY)
 15785*    END-EXEC.
 15786*    MOVE '&"S        EU         (   #00013995' TO DFHEIV0
 15787     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15788     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15789     MOVE X'2020233030303133393935' TO DFHEIV0(25:11)
 15790     CALL 'kxdfhei1' USING DFHEIV0,
 15791           ELMSTR-DSID,
 15792           DFHEIV20,
 15793           DFHEIV99,
 15794           ELMSTR-KEY,
 15795           DFHEIV99,
 15796           DFHEIV99,
 15797           DFHEIV99
 15798     SET ADDRESS OF CLAIM-MASTER TO
 15799         DFHEIV20
 15800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15801
 15802
 15803 7920-EXIT.
 15804      EXIT.
 15805
 15806 7950-READ-CLAIM.
 15807
 15808
 15809* EXEC CICS READ
 15810*        DATASET   (ELMSTR-DSID)
 15811*        SET       (ADDRESS OF CLAIM-MASTER)
 15812*        RIDFLD    (ELMSTR-KEY)
 15813*    END-EXEC.
 15814*    MOVE '&"S        E          (   #00014007' TO DFHEIV0
 15815     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15816     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15817     MOVE X'2020233030303134303037' TO DFHEIV0(25:11)
 15818     CALL 'kxdfhei1' USING DFHEIV0,
 15819           ELMSTR-DSID,
 15820           DFHEIV20,
 15821           DFHEIV99,
 15822           ELMSTR-KEY,
 15823           DFHEIV99,
 15824           DFHEIV99,
 15825           DFHEIV99
 15826     SET ADDRESS OF CLAIM-MASTER TO
 15827         DFHEIV20
 15828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15829
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 302
* EL130.cbl
 15830
 15831 7950-EXIT.
 15832      EXIT.
 15833
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 303
* EL130.cbl
 15835***************************************
 15836*  I/O REQUESTS AGAINST CONTROL FILE  *
 15837***************************************
 15838
 15839 7960-READ-CNTL-UPDATE.
 15840
 15841
 15842* EXEC CICS READ
 15843*        UPDATE
 15844*        DATASET  (ELCNTL-DSID)
 15845*        SET      (ADDRESS OF CONTROL-FILE)
 15846*        RIDFLD   (ELCNTL-KEY)
 15847*    END-EXEC.
 15848*    MOVE '&"S        EU         (   #00014023' TO DFHEIV0
 15849     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15850     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15851     MOVE X'2020233030303134303233' TO DFHEIV0(25:11)
 15852     CALL 'kxdfhei1' USING DFHEIV0,
 15853           ELCNTL-DSID,
 15854           DFHEIV20,
 15855           DFHEIV99,
 15856           ELCNTL-KEY,
 15857           DFHEIV99,
 15858           DFHEIV99,
 15859           DFHEIV99
 15860     SET ADDRESS OF CONTROL-FILE TO
 15861         DFHEIV20
 15862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15863
 15864
 15865 7960-EXIT.
 15866      EXIT.
 15867
 15868 7970-READ-CNTL.
 15869
 15870
 15871* EXEC CICS READ
 15872*        DATASET  (ELCNTL-DSID)
 15873*        SET      (ADDRESS OF CONTROL-FILE)
 15874*        RIDFLD   (ELCNTL-KEY)
 15875*    END-EXEC.
 15876*    MOVE '&"S        E          (   #00014035' TO DFHEIV0
 15877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15879     MOVE X'2020233030303134303335' TO DFHEIV0(25:11)
 15880     CALL 'kxdfhei1' USING DFHEIV0,
 15881           ELCNTL-DSID,
 15882           DFHEIV20,
 15883           DFHEIV99,
 15884           ELCNTL-KEY,
 15885           DFHEIV99,
 15886           DFHEIV99,
 15887           DFHEIV99
 15888     SET ADDRESS OF CONTROL-FILE TO
 15889         DFHEIV20
 15890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15891
 15892
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 304
* EL130.cbl
 15893 7970-EXIT.
 15894      EXIT.
 15895
 15896 7975-READ-CNTL-GTEQ.
 15897
 15898
 15899* EXEC CICS READ
 15900*         DATASET   (ELCNTL-DSID)
 15901*         SET       (ADDRESS OF CONTROL-FILE)
 15902*         RIDFLD    (ELCNTL-KEY)
 15903*         GTEQ
 15904*     END-EXEC.
 15905*    MOVE '&"S        G          (   #00014046' TO DFHEIV0
 15906     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15908     MOVE X'2020233030303134303436' TO DFHEIV0(25:11)
 15909     CALL 'kxdfhei1' USING DFHEIV0,
 15910           ELCNTL-DSID,
 15911           DFHEIV20,
 15912           DFHEIV99,
 15913           ELCNTL-KEY,
 15914           DFHEIV99,
 15915           DFHEIV99,
 15916           DFHEIV99
 15917     SET ADDRESS OF CONTROL-FILE TO
 15918         DFHEIV20
 15919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15920
 15921
 15922 7975-EXIT.
 15923      EXIT.
 15924
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 305
* EL130.cbl
 15926**************************************************
 15927*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 15928**************************************************
 15929
 15930 7980-READ-CERT5.
 15931
 15932
 15933* EXEC CICS READ
 15934*         DATASET  (ELCERT5-DSID)
 15935*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15936*         RIDFLD   (ELCERT-KEY-5)
 15937*     END-EXEC.
 15938*    MOVE '&"S        E          (   #00014063' TO DFHEIV0
 15939     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15941     MOVE X'2020233030303134303633' TO DFHEIV0(25:11)
 15942     CALL 'kxdfhei1' USING DFHEIV0,
 15943           ELCERT5-DSID,
 15944           DFHEIV20,
 15945           DFHEIV99,
 15946           ELCERT-KEY-5,
 15947           DFHEIV99,
 15948           DFHEIV99,
 15949           DFHEIV99
 15950     SET ADDRESS OF CERTIFICATE-MASTER TO
 15951         DFHEIV20
 15952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15953
 15954
 15955 7980-EXIT.
 15956      EXIT.
 15957
 15958 7930-READ-CERT-UPDATE.
 15959
 15960
 15961* EXEC CICS READ
 15962*        DATASET  (ELCERT-DSID)
 15963*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 15964*        RIDFLD   (ELCERT-KEY)
 15965*        UPDATE
 15966*    END-EXEC.
 15967*    MOVE '&"S        EU         (   #00014074' TO DFHEIV0
 15968     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15969     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15970     MOVE X'2020233030303134303734' TO DFHEIV0(25:11)
 15971     CALL 'kxdfhei1' USING DFHEIV0,
 15972           ELCERT-DSID,
 15973           DFHEIV20,
 15974           DFHEIV99,
 15975           ELCERT-KEY,
 15976           DFHEIV99,
 15977           DFHEIV99,
 15978           DFHEIV99
 15979     SET ADDRESS OF CERTIFICATE-MASTER TO
 15980         DFHEIV20
 15981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15982
 15983
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 306
* EL130.cbl
 15984 7930-EXIT.
 15985      EXIT.
 15986
 15987 7940-READ-CERT.
 15988
 15989
 15990* EXEC CICS READ
 15991*        DATASET  (ELCERT-DSID)
 15992*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 15993*        RIDFLD   (ELCERT-KEY)
 15994*    END-EXEC.
 15995*    MOVE '&"S        E          (   #00014086' TO DFHEIV0
 15996     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15998     MOVE X'2020233030303134303836' TO DFHEIV0(25:11)
 15999     CALL 'kxdfhei1' USING DFHEIV0,
 16000           ELCERT-DSID,
 16001           DFHEIV20,
 16002           DFHEIV99,
 16003           ELCERT-KEY,
 16004           DFHEIV99,
 16005           DFHEIV99,
 16006           DFHEIV99
 16007     SET ADDRESS OF CERTIFICATE-MASTER TO
 16008         DFHEIV20
 16009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16010
 16011
 16012 7940-EXIT.
 16013      EXIT.
 16014
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 307
* EL130.cbl
 16016**************************************************
 16017*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16018**************************************************
 16019
 16020 7991-READ-BENE.
 16021
 16022
 16023* EXEC CICS READ
 16024*         DATASET   (ELBENE-DSID)
 16025*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16026*         RIDFLD    (ELBENE-KEY)
 16027*     END-EXEC.
 16028*    MOVE '&"S        E          (   #00014102' TO DFHEIV0
 16029     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16031     MOVE X'2020233030303134313032' TO DFHEIV0(25:11)
 16032     CALL 'kxdfhei1' USING DFHEIV0,
 16033           ELBENE-DSID,
 16034           DFHEIV20,
 16035           DFHEIV99,
 16036           ELBENE-KEY,
 16037           DFHEIV99,
 16038           DFHEIV99,
 16039           DFHEIV99
 16040     SET ADDRESS OF BENEFICIARY-MASTER TO
 16041         DFHEIV20
 16042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16043
 16044
 16045 7991-EXIT.
 16046      EXIT.
 16047
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 308
* EL130.cbl
 16049**************************************************
 16050*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16051**************************************************
 16052
 16053 7992-READ-REIN.
 16054
 16055
 16056
 16057* EXEC CICS HANDLE CONDITION
 16058*        NOTFND   (7992-NOT-FOUND)
 16059*    END-EXEC.
 16060*    MOVE '"$I                   ! L #00014119' TO DFHEIV0
 16061     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16063     MOVE X'4C20233030303134313139' TO DFHEIV0(25:11)
 16064     CALL 'kxdfhei1' USING DFHEIV0
 16065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16066
 16067
 16068
 16069
 16070* EXEC CICS READ
 16071*        DATASET   (ERREIN-DSID)
 16072*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16073*        RIDFLD    (ERREIN-KEY)
 16074*    END-EXEC.
 16075*    MOVE '&"S        E          (   #00014124' TO DFHEIV0
 16076     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16077     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16078     MOVE X'2020233030303134313234' TO DFHEIV0(25:11)
 16079     CALL 'kxdfhei1' USING DFHEIV0,
 16080           ERREIN-DSID,
 16081           DFHEIV20,
 16082           DFHEIV99,
 16083           ERREIN-KEY,
 16084           DFHEIV99,
 16085           DFHEIV99,
 16086           DFHEIV99
 16087     SET ADDRESS OF REINSURANCE-RECORD TO
 16088         DFHEIV20
 16089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16090
 16091
 16092     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16093
 16094     GO TO 7992-EXIT.
 16095
 16096 7992-NOT-FOUND.
 16097     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16098
 16099 7992-EXIT.
 16100     EXIT.
 16101
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 309
* EL130.cbl
 16103 8000-LOAD-ERROR-MESSAGES.
 16104     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16105
 16106     IF EMI-NO-ERRORS
 16107         GO TO 8000-EXIT
 16108     END-IF.
 16109
 16110     perform varying e1 from +1 by +1 until e1 > +3
 16111        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16112                                or '1655' or '1660'
 16113           move 'W'              to emi-severity (e1)
 16114        end-if
 16115     end-perform
 16116     IF EMI-NUMBER-OF-LINES = 1
 16117         MOVE EMI-LINE1          TO ERRMSG1O
 16118         GO TO 8000-EXIT
 16119     END-IF.
 16120
 16121     IF EMI-NUMBER-OF-LINES = 2
 16122          MOVE EMI-LINE1         TO ERRMSG1O
 16123          MOVE EMI-LINE2         TO ERRMSG2O
 16124          GO TO 8000-EXIT
 16125     END-IF.
 16126
 16127     MOVE EMI-LINE1              TO ERRMSG1O.
 16128
 16129 8000-EXIT.
 16130     EXIT.
 16131
 16132 8100-SEND-INITIAL-MAP.
 16133     MOVE SAVE-DATE              TO RUNDTEO.
 16134     MOVE EIBTIME                TO TIME-IN.
 16135     MOVE TIME-OUT               TO RUNTIMEO.
 16136     IF RETURNED-FROM = XCTL-114
 16137        CONTINUE
 16138     ELSE
 16139        MOVE -1                  TO MAINTL
 16140     END-IF.
 16141
 16142*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16143         MOVE SPACES             TO PRODO.
 16144         MOVE AL-SANOF           TO PRODCDA.
 16145*    END-IF.
 16146
 16147     MOVE PI-COMPANY-ID          TO COMPO.
 16148     MOVE AL-PABOF               TO COMPA.
 16149     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16150     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16151     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16152
 16153     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16154
 16155     IF NOT PI-NO-CARRIER-SECURITY
 16156        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16157        MOVE AL-SABOF            TO CLMCARRA
 16158     END-IF.
 16159
 16160     IF PI-PROCESSOR-ID = 'PEMA'
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 310
* EL130.cbl
 16161        MOVE AL-UANON            TO CERTNOA
 16162                                    SUFXA
 16163     END-IF.
 16164*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16165*        NEXT SENTENCE
 16166*        CONTINUE
 16167*    ELSE
 16168         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16169*    END-IF.
 16170
 16171
 16172
 16173* EXEC CICS SEND
 16174*        MAP     (MAP-NAME)
 16175*        MAPSET  (MAPSET-NAME)
 16176*        FROM    (EL130AO)
 16177*        ERASE
 16178*        CURSOR
 16179*    END-EXEC.
 16180     MOVE LENGTH OF
 16181      EL130AO
 16182       TO DFHEIV12
 16183     MOVE -1
 16184       TO DFHEIV11
 16185*    MOVE '8$     CT  E    H L F ,   #00014210' TO DFHEIV0
 16186     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16187     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16188     MOVE X'2020233030303134323130' TO DFHEIV0(25:11)
 16189     CALL 'kxdfhei1' USING DFHEIV0,
 16190           MAP-NAME,
 16191           EL130AO,
 16192           DFHEIV12,
 16193           MAPSET-NAME,
 16194           DFHEIV99,
 16195           DFHEIV99,
 16196           DFHEIV99,
 16197           DFHEIV11,
 16198           DFHEIV99,
 16199           DFHEIV99,
 16200           DFHEIV99
 16201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16202
 16203
 16204     GO TO 9100-RETURN-TRAN.
 16205
 16206 8150-SEND-MAP-CURSOR.
 16207     MOVE SAVE-DATE              TO RUNDTEO.
 16208     MOVE EIBTIME                TO TIME-IN.
 16209     MOVE TIME-OUT               TO RUNTIMEO.
 16210     MOVE PI-COMPANY-ID          TO COMPO.
 16211     MOVE AL-PABOF               TO COMPA
 16212     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16213     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16214     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16215
 16216*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16217         MOVE SPACES             TO PRODO.
 16218         MOVE AL-SANOF           TO PRODCDA.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 311
* EL130.cbl
 16219*    END-IF.
 16220
 16221     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16222
 16223     IF NOT PI-NO-CARRIER-SECURITY
 16224         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16225         MOVE AL-SABOF            TO CLMCARRA
 16226     END-IF.
 16227
 16228     IF PI-PROCESSOR-ID = 'PEMA'
 16229        MOVE AL-UANON            TO CERTNOA
 16230                                    SUFXA
 16231     END-IF.
 16232*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16233*        NEXT SENTENCE
 16234*        CONTINUE
 16235*    ELSE
 16236         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16237*    END-IF.
 16238
 16239
 16240
 16241* EXEC CICS SEND
 16242*        MAP      (MAP-NAME)
 16243*        MAPSET   (MAPSET-NAME)
 16244*        FROM     (EL130AO)
 16245*        CURSOR   (PI-CURSOR)
 16246*        ERASE
 16247*    END-EXEC.
 16248     MOVE LENGTH OF
 16249      EL130AO
 16250       TO DFHEIV11
 16251*    MOVE '8$     CT  E    H L F ,   #00014254' TO DFHEIV0
 16252     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16253     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16254     MOVE X'2020233030303134323534' TO DFHEIV0(25:11)
 16255     CALL 'kxdfhei1' USING DFHEIV0,
 16256           MAP-NAME,
 16257           EL130AO,
 16258           DFHEIV11,
 16259           MAPSET-NAME,
 16260           DFHEIV99,
 16261           DFHEIV99,
 16262           DFHEIV99,
 16263           PI-CURSOR,
 16264           DFHEIV99,
 16265           DFHEIV99,
 16266           DFHEIV99
 16267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16268
 16269
 16270     GO TO 9100-RETURN-TRAN.
 16271
 16272 8200-SEND-DATAONLY.
 16273     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16274
 16275     IF EIBAID = DFHPF11
 16276        MOVE 'Y'                 TO EMI-ROLL-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 312
* EL130.cbl
 16277        move pi-last-claim       to emi-claim-no
 16278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16279        go to 8100-send-initial-map
 16280     END-IF.
 16281
 16282 8200-BYPASS-ERROR.
 16283     MOVE SAVE-DATE              TO RUNDTEO.
 16284     MOVE EIBTIME                TO TIME-IN.
 16285     MOVE TIME-OUT               TO RUNTIMEO.
 16286     MOVE PI-COMPANY-ID          TO COMPO.
 16287     MOVE AL-PABOF               TO COMPA
 16288     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16289
 16290*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16291         MOVE SPACES             TO PRODO.
 16292         MOVE AL-SANOF           TO PRODCDA.
 16293*    END-IF.
 16294
 16295     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16296     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16297
 16298     IF PI-PROCESSOR-ID = 'PEMA'
 16299        MOVE AL-UANON            TO CERTNOA
 16300                                    SUFXA
 16301     END-IF.
 16302     IF NOT PI-NO-CARRIER-SECURITY
 16303        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16304        MOVE AL-SABOF            TO CLMCARRA
 16305     END-IF.
 16306
 16307*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16308*        NEXT SENTENCE
 16309*        CONTINUE
 16310*    ELSE
 16311         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16312*    END-IF.
 16313
 16314*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16315         MOVE AL-SANOF           TO PRODCDA.
 16316*    END-IF.
 16317
 16318
 16319
 16320* EXEC CICS SEND
 16321*        MAP      (MAP-NAME)
 16322*        MAPSET   (MAPSET-NAME)
 16323*        FROM     (EL130AO)
 16324*        DATAONLY
 16325*        CURSOR
 16326*    END-EXEC.
 16327     MOVE LENGTH OF
 16328      EL130AO
 16329       TO DFHEIV12
 16330     MOVE -1
 16331       TO DFHEIV11
 16332*    MOVE '8$D    CT       H L F ,   #00014311' TO DFHEIV0
 16333     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16334     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 313
* EL130.cbl
 16335     MOVE X'2020233030303134333131' TO DFHEIV0(25:11)
 16336     CALL 'kxdfhei1' USING DFHEIV0,
 16337           MAP-NAME,
 16338           EL130AO,
 16339           DFHEIV12,
 16340           MAPSET-NAME,
 16341           DFHEIV99,
 16342           DFHEIV99,
 16343           DFHEIV99,
 16344           DFHEIV11,
 16345           DFHEIV99,
 16346           DFHEIV99,
 16347           DFHEIV99
 16348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16349
 16350
 16351     GO TO 9100-RETURN-TRAN.
 16352
 16353 8300-SEND-TEXT.
 16354
 16355
 16356* EXEC CICS SEND TEXT
 16357*        FROM     (LOGOFF-TEXT)
 16358*        LENGTH   (LOGOFF-LENGTH)
 16359*        ERASE
 16360*        FREEKB
 16361*    END-EXEC.
 16362*    MOVE '8&      T  E F  H   F -   #00014323' TO DFHEIV0
 16363     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16364     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16365     MOVE X'2020233030303134333233' TO DFHEIV0(25:11)
 16366     CALL 'kxdfhei1' USING DFHEIV0,
 16367           LOGOFF-TEXT,
 16368           LOGOFF-LENGTH,
 16369           DFHEIV99,
 16370           DFHEIV99,
 16371           DFHEIV99,
 16372           DFHEIV99,
 16373           DFHEIV99,
 16374           DFHEIV99,
 16375           DFHEIV99,
 16376           DFHEIV99,
 16377           DFHEIV99,
 16378           DFHEIV99
 16379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16380
 16381
 16382
 16383
 16384* EXEC CICS RETURN
 16385*    END-EXEC.
 16386*    MOVE '.(                    ''   #00014331' TO DFHEIV0
 16387     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16389     MOVE X'2020233030303134333331' TO DFHEIV0(25:11)
 16390     CALL 'kxdfhei1' USING DFHEIV0,
 16391           DFHEIV99,
 16392           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 314
* EL130.cbl
 16393           DFHEIV99,
 16394           DFHEIV99,
 16395           DFHEIV99,
 16396           DFHEIV99
 16397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16398
 16399
 16400 8800-UNAUTHORIZED-ACCESS.
 16401     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16402     GO TO 8300-SEND-TEXT.
 16403
 16404 8810-PF23.
 16405     MOVE EIBAID TO PI-ENTRY-CD-1.
 16406     MOVE XCTL-005               TO PGM-NAME.
 16407     GO TO 9300-XCTL.
 16408
 16409 8820-TERM-ERROR.
 16410     MOVE ER-0412                TO EMI-ERROR.
 16411     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16412     MOVE -1                     TO MAINTL.
 16413     GO TO 8200-SEND-DATAONLY.
 16414
 16415 8830-TRAN-ERROR.
 16416     MOVE ER-0413                TO EMI-ERROR.
 16417     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16418     MOVE -1                     TO MAINTL.
 16419     GO TO 8200-SEND-DATAONLY.
 16420
 16421 9000-RETURN-CICS.
 16422
 16423
 16424* EXEC CICS RETURN
 16425*    END-EXEC.
 16426*    MOVE '.(                    ''   #00014357' TO DFHEIV0
 16427     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16428     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16429     MOVE X'2020233030303134333537' TO DFHEIV0(25:11)
 16430     CALL 'kxdfhei1' USING DFHEIV0,
 16431           DFHEIV99,
 16432           DFHEIV99,
 16433           DFHEIV99,
 16434           DFHEIV99,
 16435           DFHEIV99,
 16436           DFHEIV99
 16437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16438
 16439
 16440 9100-RETURN-TRAN.
 16441     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16442     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16443
 16444
 16445
 16446* EXEC CICS RETURN
 16447*        TRANSID   (TRANS-ID)
 16448*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16449*        LENGTH    (PI-COMM-LENGTH)
 16450*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 315
* EL130.cbl
 16451*    MOVE '.(CT                  ''   #00014365' TO DFHEIV0
 16452     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16453     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16454     MOVE X'2020233030303134333635' TO DFHEIV0(25:11)
 16455     CALL 'kxdfhei1' USING DFHEIV0,
 16456           TRANS-ID,
 16457           PROGRAM-INTERFACE-BLOCK,
 16458           PI-COMM-LENGTH,
 16459           DFHEIV99,
 16460           DFHEIV99,
 16461           DFHEIV99
 16462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16463
 16464
 16465 9200-RETURN-MAIN-MENU.
 16466     MOVE XCTL-126               TO PGM-NAME.
 16467     GO TO 9300-XCTL.
 16468
 16469 9300-XCTL.
 16470
 16471
 16472* EXEC CICS XCTL
 16473*        PROGRAM   (PGM-NAME)
 16474*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16475*        LENGTH    (PI-COMM-LENGTH)
 16476*    END-EXEC.
 16477*    MOVE '.$C                   %   #00014377' TO DFHEIV0
 16478     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16479     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16480     MOVE X'2020233030303134333737' TO DFHEIV0(25:11)
 16481     CALL 'kxdfhei1' USING DFHEIV0,
 16482           PGM-NAME,
 16483           PROGRAM-INTERFACE-BLOCK,
 16484           PI-COMM-LENGTH,
 16485           DFHEIV99
 16486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16487
 16488
 16489 9400-CLEAR.
 16490     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16491     GO TO 9300-XCTL.
 16492
 16493 9500-PF12.
 16494     MOVE XCTL-010               TO PGM-NAME.
 16495     GO TO 9300-XCTL.
 16496
 16497 9600-PGMID-ERROR.
 16498
 16499
 16500* EXEC CICS HANDLE CONDITION
 16501*        PGMIDERR  (8300-SEND-TEXT)
 16502*    END-EXEC.
 16503*    MOVE '"$L                   ! M #00014393' TO DFHEIV0
 16504     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16506     MOVE X'4D20233030303134333933' TO DFHEIV0(25:11)
 16507     CALL 'kxdfhei1' USING DFHEIV0
 16508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 316
* EL130.cbl
 16509
 16510
 16511     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16512     MOVE ' '                    TO PI-ENTRY-CD-1.
 16513     MOVE XCTL-005               TO PGM-NAME.
 16514     MOVE PGM-NAME               TO LOGOFF-PGM.
 16515     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16516     GO TO 9300-XCTL.
 16517
 16518 9700-LINK-DATE-CONVERT.
 16519     MOVE LINK-ELDATCV           TO PGM-NAME.
 16520
 16521
 16522* EXEC CICS LINK
 16523*        PROGRAM    (PGM-NAME)
 16524*        COMMAREA   (DATE-CONVERSION-DATA)
 16525*        LENGTH     (DC-COMM-LENGTH)
 16526*    END-EXEC.
 16527*    MOVE '."C                   (   #00014407' TO DFHEIV0
 16528     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16530     MOVE X'2020233030303134343037' TO DFHEIV0(25:11)
 16531     CALL 'kxdfhei1' USING DFHEIV0,
 16532           PGM-NAME,
 16533           DATE-CONVERSION-DATA,
 16534           DC-COMM-LENGTH,
 16535           DFHEIV99,
 16536           DFHEIV99,
 16537           DFHEIV99,
 16538           DFHEIV99
 16539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16540
 16541
 16542 9700-EXIT.
 16543     EXIT.
 16544
 16545 9800-LINK-REM-TERM.
 16546     MOVE LINK-ELRTRM            TO PGM-NAME.
 16547
 16548
 16549* EXEC CICS LINK
 16550*        PROGRAM    (PGM-NAME)
 16551*        COMMAREA   (CALCULATION-PASS-AREA)
 16552*        LENGTH     (CP-COMM-LENGTH)
 16553*    END-EXEC.
 16554*    MOVE '."C                   (   #00014419' TO DFHEIV0
 16555     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16557     MOVE X'2020233030303134343139' TO DFHEIV0(25:11)
 16558     CALL 'kxdfhei1' USING DFHEIV0,
 16559           PGM-NAME,
 16560           CALCULATION-PASS-AREA,
 16561           CP-COMM-LENGTH,
 16562           DFHEIV99,
 16563           DFHEIV99,
 16564           DFHEIV99,
 16565           DFHEIV99
 16566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 317
* EL130.cbl
 16567
 16568
 16569 9800-EXIT.
 16570     EXIT.
 16571
 16572 9900-ERROR-FORMAT.
 16573*    if emi-error = 1651 or 1652 or 1653 or 1655
 16574*       display ' 9900 error ' emi-error
 16575*       display emi-message-area (1)
 16576*       display emi-message-area (2)
 16577*       display emi-message-area (3)
 16578*    end-if
 16579     IF NOT EMI-ERRORS-COMPLETE
 16580         MOVE LINK-001           TO PGM-NAME
 16581
 16582* EXEC CICS LINK
 16583*            PROGRAM   (PGM-NAME)
 16584*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16585*            LENGTH    (EMI-COMM-LENGTH)
 16586*        END-EXEC
 16587*    MOVE '."C                   (   #00014437' TO DFHEIV0
 16588     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16590     MOVE X'2020233030303134343337' TO DFHEIV0(25:11)
 16591     CALL 'kxdfhei1' USING DFHEIV0,
 16592           PGM-NAME,
 16593           ERROR-MESSAGE-INTERFACE-BLOCK,
 16594           EMI-COMM-LENGTH,
 16595           DFHEIV99,
 16596           DFHEIV99,
 16597           DFHEIV99,
 16598           DFHEIV99
 16599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16600         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16601            subtract 1 from emi-fatal-ctr
 16602         end-if
 16603     END-IF.
 16604
 16605     .
 16606 9900-EXIT.
 16607     EXIT.
 16608
 16609 9990-ABEND.
 16610     MOVE -1                     TO MAINTL.
 16611     MOVE LINK-004               TO PGM-NAME.
 16612     MOVE DFHEIBLK               TO EMI-LINE1.
 16613
 16614
 16615* EXEC CICS LINK
 16616*        PROGRAM   (PGM-NAME)
 16617*        COMMAREA  (EMI-LINE1)
 16618*        LENGTH    (72)
 16619*    END-EXEC.
 16620     MOVE 72
 16621       TO DFHEIV11
 16622*    MOVE '."C                   (   #00014456' TO DFHEIV0
 16623     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 318
* EL130.cbl
 16625     MOVE X'2020233030303134343536' TO DFHEIV0(25:11)
 16626     CALL 'kxdfhei1' USING DFHEIV0,
 16627           PGM-NAME,
 16628           EMI-LINE1,
 16629           DFHEIV11,
 16630           DFHEIV99,
 16631           DFHEIV99,
 16632           DFHEIV99,
 16633           DFHEIV99
 16634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16635
 16636
 16637     MOVE EMI-LINE1              TO ERRMSG2O.
 16638
 16639     GO TO 8200-BYPASS-ERROR.
 16640
 16641
 16642
 16643* GOBACK.
 16644     MOVE '9%                    "   ' TO DFHEIV0
 16645     MOVE 'EL130' TO DFHEIV1
 16646     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16647     GOBACK.
 16648
 16649 9995-SECURITY-VIOLATION.
 16650*             COPY ELCSCTP.
 16651******************************************************************
 16652*                                                                *
 16653*                            ELCSCTP                             *
 16654*                            VMOD=2.001                          *
 16655*                                                                *
 16656*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16657******************************************************************
 16658
 16659
 16660     MOVE EIBDATE          TO SM-JUL-DATE.
 16661     MOVE EIBTRMID         TO SM-TERMID.
 16662     MOVE THIS-PGM         TO SM-PGM.
 16663     MOVE EIBTIME          TO TIME-IN.
 16664     MOVE TIME-OUT         TO SM-TIME.
 16665     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16666
 16667
 16668* EXEC CICS LINK
 16669*         PROGRAM  ('EL003')
 16670*         COMMAREA (SECURITY-MESSAGE)
 16671*         LENGTH   (80)
 16672*    END-EXEC.
 16673     MOVE 'EL003' TO DFHEIV1
 16674     MOVE 80
 16675       TO DFHEIV11
 16676*    MOVE '."C                   (   #00014487' TO DFHEIV0
 16677     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16678     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16679     MOVE X'2020233030303134343837' TO DFHEIV0(25:11)
 16680     CALL 'kxdfhei1' USING DFHEIV0,
 16681           DFHEIV1,
 16682           SECURITY-MESSAGE,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 319
* EL130.cbl
 16683           DFHEIV11,
 16684           DFHEIV99,
 16685           DFHEIV99,
 16686           DFHEIV99,
 16687           DFHEIV99
 16688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16689
 16690
 16691******************************************************************
 16692
 16693
 16694 9995-EXIT.
 16695     EXIT.
 16696
 16697
 16698 9999-DFHBACK SECTION.
 16699     MOVE '9%                    "   ' TO DFHEIV0
 16700     MOVE 'EL130' TO DFHEIV1
 16701     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16702     GOBACK.
 16703 9999-DFHEXIT.
 16704     IF DFHEIGDJ EQUAL 0001
 16705         NEXT SENTENCE
 16706     ELSE IF DFHEIGDJ EQUAL 2
 16707         GO TO 0100-TEST-ENTRY,
 16708               8100-SEND-INITIAL-MAP,
 16709               9600-PGMID-ERROR,
 16710               8820-TERM-ERROR,
 16711               8830-TRAN-ERROR,
 16712               9990-ABEND
 16713         DEPENDING ON DFHEIGDI
 16714     ELSE IF DFHEIGDJ EQUAL 3
 16715         GO TO 0450-ADD-ELACTQ-RECORD
 16716         DEPENDING ON DFHEIGDI
 16717     ELSE IF DFHEIGDJ EQUAL 4
 16718         GO TO 8820-TERM-ERROR,
 16719               8830-TRAN-ERROR
 16720         DEPENDING ON DFHEIGDI
 16721     ELSE IF DFHEIGDJ EQUAL 5
 16722         GO TO 0660-NOT-FOUND,
 16723               0670-QIDERR
 16724         DEPENDING ON DFHEIGDI
 16725     ELSE IF DFHEIGDJ EQUAL 6
 16726         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16727         DEPENDING ON DFHEIGDI
 16728     ELSE IF DFHEIGDJ EQUAL 7
 16729         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16730         DEPENDING ON DFHEIGDI
 16731     ELSE IF DFHEIGDJ EQUAL 8
 16732         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16733         DEPENDING ON DFHEIGDI
 16734     ELSE IF DFHEIGDJ EQUAL 9
 16735         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16736         DEPENDING ON DFHEIGDI
 16737     ELSE IF DFHEIGDJ EQUAL 10
 16738         GO TO 2050-DELETE-NOT-FOUND
 16739         DEPENDING ON DFHEIGDI
 16740     ELSE IF DFHEIGDJ EQUAL 11
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 320
* EL130.cbl
 16741         GO TO 2010-DELETE-CL
 16742         DEPENDING ON DFHEIGDI
 16743     ELSE IF DFHEIGDJ EQUAL 12
 16744         GO TO 3010-TEST-FOR-ERRORS
 16745         DEPENDING ON DFHEIGDI
 16746     ELSE IF DFHEIGDJ EQUAL 13
 16747         GO TO 3008-DUP-ERROR,
 16748               3009-NOT-FOUND
 16749         DEPENDING ON DFHEIGDI
 16750     ELSE IF DFHEIGDJ EQUAL 14
 16751         GO TO 3030-BUILD-CONT
 16752         DEPENDING ON DFHEIGDI
 16753     ELSE IF DFHEIGDJ EQUAL 15
 16754         GO TO 3033-ACCT-NOT-FOUND,
 16755               3033-ACCT-NOT-FOUND
 16756         DEPENDING ON DFHEIGDI
 16757     ELSE IF DFHEIGDJ EQUAL 16
 16758         GO TO 3032-NOT-IN-DT-RANGE
 16759         DEPENDING ON DFHEIGDI
 16760     ELSE IF DFHEIGDJ EQUAL 17
 16761         GO TO 3070-BUILD-CONT
 16762         DEPENDING ON DFHEIGDI
 16763     ELSE IF DFHEIGDJ EQUAL 18
 16764         GO TO 3065-CERT-NOT-FOUND
 16765         DEPENDING ON DFHEIGDI
 16766     ELSE IF DFHEIGDJ EQUAL 19
 16767         GO TO 3100-CARRIER-NOT-FOUND
 16768         DEPENDING ON DFHEIGDI
 16769     ELSE IF DFHEIGDJ EQUAL 20
 16770         GO TO 3110-COMPANY-NOT-FOUND
 16771         DEPENDING ON DFHEIGDI
 16772     ELSE IF DFHEIGDJ EQUAL 21
 16773         GO TO 3200-BUILD-ZERO-TRAILER
 16774         DEPENDING ON DFHEIGDI
 16775     ELSE IF DFHEIGDJ EQUAL 22
 16776         GO TO 9999-DFHBACK
 16777         DEPENDING ON DFHEIGDI
 16778     ELSE IF DFHEIGDJ EQUAL 23
 16779         GO TO 3290-NO-INSURED-ADDRESS
 16780         DEPENDING ON DFHEIGDI
 16781     ELSE IF DFHEIGDJ EQUAL 24
 16782         GO TO 3410-DUP-KEY
 16783         DEPENDING ON DFHEIGDI
 16784     ELSE IF DFHEIGDJ EQUAL 25
 16785         GO TO 3690-CERT-WRITTEN
 16786         DEPENDING ON DFHEIGDI
 16787     ELSE IF DFHEIGDJ EQUAL 26
 16788         GO TO 3850-CLAIM-MSTR-WRITTEN
 16789         DEPENDING ON DFHEIGDI
 16790     ELSE IF DFHEIGDJ EQUAL 27
 16791         GO TO 5050-CERT-NOT-FOUND
 16792         DEPENDING ON DFHEIGDI
 16793     ELSE IF DFHEIGDJ EQUAL 28
 16794         GO TO 5030-CERT-WRITTEN
 16795         DEPENDING ON DFHEIGDI
 16796     ELSE IF DFHEIGDJ EQUAL 29
 16797         GO TO 5035-CLAIM-WRITTEN
 16798         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 321
* EL130.cbl
 16799     ELSE IF DFHEIGDJ EQUAL 30
 16800         GO TO 9990-ABEND,
 16801               5799-EXIT
 16802         DEPENDING ON DFHEIGDI
 16803     ELSE IF DFHEIGDJ EQUAL 31
 16804         GO TO 3100-CARRIER-NOT-FOUND
 16805         DEPENDING ON DFHEIGDI
 16806     ELSE IF DFHEIGDJ EQUAL 32
 16807         GO TO 6040-NO-PROCESSOR-RECORD
 16808         DEPENDING ON DFHEIGDI
 16809     ELSE IF DFHEIGDJ EQUAL 33
 16810         GO TO 6060-NO-BENEFICIARY-RECORD
 16811         DEPENDING ON DFHEIGDI
 16812     ELSE IF DFHEIGDJ EQUAL 34
 16813         GO TO 6499-EXIT,
 16814               6499-EXIT
 16815         DEPENDING ON DFHEIGDI
 16816     ELSE IF DFHEIGDJ EQUAL 35
 16817         GO TO 6600-NOT-FOUND
 16818         DEPENDING ON DFHEIGDI
 16819     ELSE IF DFHEIGDJ EQUAL 36
 16820         GO TO 6700-NOTOPEN-ERROR,
 16821               6700-EXIT
 16822         DEPENDING ON DFHEIGDI
 16823     ELSE IF DFHEIGDJ EQUAL 37
 16824         GO TO 7120-NOT-FOUND
 16825         DEPENDING ON DFHEIGDI
 16826     ELSE IF DFHEIGDJ EQUAL 38
 16827         GO TO 7499-EXIT
 16828         DEPENDING ON DFHEIGDI
 16829     ELSE IF DFHEIGDJ EQUAL 39
 16830         GO TO 7500-EXIT,
 16831               7500-DUPLICATE-KEY,
 16832               7500-EXIT
 16833         DEPENDING ON DFHEIGDI
 16834     ELSE IF DFHEIGDJ EQUAL 40
 16835         GO TO 7500-END-BROWSE
 16836         DEPENDING ON DFHEIGDI
 16837     ELSE IF DFHEIGDJ EQUAL 41
 16838         GO TO 7630-END-BROWSE
 16839         DEPENDING ON DFHEIGDI
 16840     ELSE IF DFHEIGDJ EQUAL 42
 16841         GO TO 7799-EXIT,
 16842               7799-EXIT
 16843         DEPENDING ON DFHEIGDI
 16844     ELSE IF DFHEIGDJ EQUAL 43
 16845         GO TO 7790-END-BROWSE
 16846         DEPENDING ON DFHEIGDI
 16847     ELSE IF DFHEIGDJ EQUAL 44
 16848         GO TO 7992-NOT-FOUND
 16849         DEPENDING ON DFHEIGDI
 16850     ELSE IF DFHEIGDJ EQUAL 45
 16851         GO TO 8300-SEND-TEXT
 16852         DEPENDING ON DFHEIGDI.
 16853     MOVE '9%                    "   ' TO DFHEIV0
 16854     MOVE 'EL130' TO DFHEIV1
 16855     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16856     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:51 Page 322
* EL130.cbl
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12216     Code:       53264
