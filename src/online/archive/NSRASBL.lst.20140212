* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.   NSRASBL.
     4*AUTHOR.     PABLO
     5*            COLLEYVILLE, TEXAS.
     6*REMARKS.    EXECUTED FROM NSRASLTR
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   2
* NSRASBL.cbl
    14*-----------------------------------------------------------------
    15* 060611    2011022800001  PEMA  NEW PROGRAM
    16* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    17* 071212    2011022800001  AJRA  ADD UNDW ID
    18* 072312    2011022800001  AJRA    ADD NEW FIELDS
    19* 090612  IR2012090600001  AJRA  NAPERSOFT
    20* 091112  IR2012091100002  AJRA  FIX AKA
    21* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    22* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    23* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    24* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    25* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    26* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    27* 110612    2012101700002  AJRA  ADD NEW FIELDS
    28* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    29* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    30* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    31* 091213    2013090300001  AJRA  NAPERSOFT PHASE 2
    32* 123113    2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    33* 011314  IR2014011300001  AJRA  FIX NEXT BUS DT AND ENDORSEMENT A
    34* 011514    2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    35******************************************************************
    36 ENVIRONMENT DIVISION.
    37 DATA DIVISION.
    38 working-storage section.
    39 01  DFH-START PIC X(04).
    40 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    41 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    42 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    43 77  SAVE-BIN-NEXT-BUS-DT        PIC XX      VALUE SPACES.
    44 77  SAVE-NEXT-BUS-DT-EDIT-A     PIC X(10)   VALUE SPACES.
    45 77  SAVE-CYCLE-DAY-OF-WEEK      PIC S9   COMP-3 VALUE +0.
    46 77  S1                          PIC S999 COMP-3 VALUE +0.
    47 77  E1                          PIC S999 COMP-3 VALUE +0.
    48 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    49 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    50 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    51 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    52 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    53 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    54 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    55 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    56 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    57 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    58 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    59 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    60     88  FOUND-BENE                  VALUE 'Y'.
    61 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    62 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    63 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    64 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    65     88  END-OF-ERPNDB              VALUE 'Y'.
    66 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    67     88  ACCT-FOUND                 VALUE 'Y'.
    68 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    69     88  CERT-FOUND                 VALUE 'Y'.
    70     88  CERT-NOT-FOUND             VALUE 'N'.
    71 77  WS-ERENDT-SW                PIC X  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   3
* NSRASBL.cbl
    72     88  ENDT-FOUND                 VALUE 'Y'.
    73     88  ENDT-NOT-FOUND             VALUE 'N'.
    74 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    75     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    76 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    77 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    78 77  WS-LF-EARN                  PIC X     VALUE ' '.
    79 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    80 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    81 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    82 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    83 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    84 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    85 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    86 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    87 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    88 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    89 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    90 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    91 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    92 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    93 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    94 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    95 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    96 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    97     88  PROCESS-ISSUE               VALUE 'I'.
    98     88  PROCESS-CANCEL              VALUE 'C'.
    99 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
   100 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
   101 77  WS-DIFF                     PIC 999 VALUE ZEROS.
   102 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
   103 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
   104 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
   105 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
   106 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
*  107 EXEC SQL
*  108    INCLUDE SQLDA
*  109 END-EXEC
   110 01 SQLDA sync.
   111    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   112    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   113    05 SQLN                  PIC S9(4) COMP-5 value 0.
   114    05 SQLD                  PIC S9(4) COMP-5 value 0.
   115    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   116       10 SQLTYPE            PIC S9(4) COMP-5.
   117       10 SQLLEN             PIC S9(4) COMP-5.
   118$IF P64 SET
   119X      *> For 64-bit environments, ensure that SQLDATA is
   120X      *> aligned on an 8-byte boundary.
   121X      10 FILLER             PIC S9(9) COMP-5.
   122$END
   123       10 SQLDATA            USAGE POINTER.
   124       10 SQLIND             USAGE POINTER.
   125       10 SQLNAME.
   126          15 SQLNAMEL        PIC S9(4) COMP-5.
   127          15 SQLNAMEC        PIC X(30).
   128
   129* Values for SQLTYPE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   4
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130
   131 78  ESQL-DATE-CHAR              VALUE 384.
   132 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   133 78  ESQL-DATE-REC               VALUE 386.
   134 78  ESQL-DATE-REC-NULL          VALUE 387.
   135 78  ESQL-TIME-CHAR              VALUE 388.
   136 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   137 78  ESQL-TIME-REC               VALUE 390.
   138 78  ESQL-TIME-REC-NULL          VALUE 391.
   139 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   140 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   141 78  ESQL-TIMESTAMP-REC          VALUE 394.
   142 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   143 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   144 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   145 78  ESQL-TS-OFFSET-REC          VALUE 398.
   146 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   147 78  ESQL-LONGVARBINARY          VALUE 404.
   148 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   149 78  ESQL-LONGVARCHAR            VALUE 408.
   150 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   151 78  ESQL-BINARY                 VALUE 444.
   152 78  ESQL-BINARY-NULL            VALUE 445.
   153 78  ESQL-VARBINARY              VALUE 446.
   154 78  ESQL-VARBINARY-NULL         VALUE 447.
   155 78  ESQL-VARCHAR                VALUE 448.
   156 78  ESQL-VARCHAR-NULL           VALUE 449.
   157
   158 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   159 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   160
   161 78  ESQL-CHAR                   VALUE 452.
   162 78  ESQL-CHAR-NULL              VALUE 453.
   163
   164 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   165 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   166
   167 78  ESQL-DOUBLE                 VALUE 480.
   168 78  ESQL-DOUBLE-NULL            VALUE 481.
   169 78  ESQL-REAL                   VALUE 482.
   170 78  ESQL-REAL-NULL              VALUE 483.
   171 78  ESQL-DECIMAL                VALUE 484.
   172 78  ESQL-DECIMAL-NULL           VALUE 485.
   173 78  ESQL-INTEGER                VALUE 496.
   174 78  ESQL-INTEGER-NULL           VALUE 497.
   175 78  ESQL-SMALLINT               VALUE 500.
   176 78  ESQL-SMALLINT-NULL          VALUE 501.
   177 78  ESQL-TINYINT                VALUE 502.
   178 78  ESQL-TINYINT-NULL           VALUE 503.
   179
*  180 EXEC SQL
*  181    INCLUDE SQLCA
*  182 END-EXEC
   183 01 SQLCA.
   184     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   185     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   186     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   187     05  SQLERRM.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   5
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         49  SQLERRML    PIC S9(4) COMP-5.
   189         49  SQLERRMC    PIC X(70).
   190     05  SQLERRP         PIC X(8).
   191     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   192     05  SQLWARN.
   193         10  SQLWARN0    PIC X.
   194         10  SQLWARN1    PIC X.
   195         10  SQLWARN2    PIC X.
   196         10  SQLWARN3    PIC X.
   197         10  SQLWARN4    PIC X.
   198         10  SQLWARN5    PIC X.
   199         10  SQLWARN6    PIC X.
   200         10  SQLWARN7    PIC X.
   201     05  SQLEXT.
   202         10  SQLWARN8    PIC X.
   203         10  SQLWARN9    PIC X.
   204         10  SQLWARN10   PIC X.
   205         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   206     05  SQLSTATE    PIC X(5).
   207
   208 EXEC SQL
   209    BEGIN DECLARE SECTION
   210 END-EXEC
   211
   212 01  SQLCMD                      PIC X(1024).
   213 01  SVR                         PIC X(32).
   214 01  USR                         PIC X(32).
   215 01  PASS                        PIC X(32).
   216 01  USR-PASS                    PIC X(64).
   217
   218 01  WS-SQL-DATA.
   219     05  WS-CYCLE-DATE           PIC X(10).
   220     05  WS-NEXT-BUS-DT          PIC X(10).
   221
   222 EXEC SQL
   223    END DECLARE SECTION
   224 END-EXEC
   225
   226
   227 01  P pointer.
   228 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   229 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   230 01  var-ptr pointer.
   231 01  env-var-len                 pic 9(4)  binary.
   232 01  rc                          pic 9(9)  binary.
   233
   234 01  WS-KIXHOST                  PIC X(10).
   235 01  WS-KIXSYS.
   236     05  WS-KIX-FIL1             PIC X(10).
   237     05  WS-KIX-APPS             PIC X(10).
   238     05  WS-KIX-ENV              PIC X(10).
   239     05  WS-KIX-MYENV            PIC X(10).
   240     05  WS-KIX-SYS              PIC X(10).
   241
   242 01  WS-CALC-FIELDS.
   243     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   244     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   245     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   6
* NSRASBL.cbl
   246     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   247     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   248     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   249     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   250     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   251     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   252     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   253     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   254     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   255     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   256     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   257     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   258     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   259     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   260     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   261     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   262     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   263     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   264     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   265     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   266     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   267     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   268     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   269     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   270     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   271     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   272     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   273     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   274     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   275     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   276     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   277     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   278     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   279     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   280     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   281     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   282     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   283     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   284     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   285 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   286 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   287 01 response-code         pic s9(8) comp.
   288 01 display-response      pic 9(8).
   289 01 bl-index              pic 9(8) comp.
   290 01 max-last-name         pic x(18).
   291 01 first-initial         pic x.
   292 01 name-in-range-flag    pic 9.
   293 01 max-entries           pic s9(8) comp value 100.
   294 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   295 01 lower-case    pic x(26) value
   296            "abcdefghijklmnopqrstuvwxyz".
   297 01 upper-case    pic x(26) value
   298            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   299
   300*                                COPY ELCVADS.
   301******************************************************************
   302*                                                                *
   303*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   7
* NSRASBL.cbl
   304*                            ELCVADS.                            *
   305*                                                                *
   306*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   307*   ELVADS                  LENGTH = 350                         *
   308******************************************************************
   309******************************************************************
   310*                   C H A N G E   L O G
   311*
   312* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   313*-----------------------------------------------------------------
   314*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   315* EFFECTIVE    NUMBER
   316*-----------------------------------------------------------------
   317* 100111    2011022800001  AJRA  NAPERSOFT
   318******************************************************************
   319
   320 01  VIRGINIA-DISCLOSURE.
   321     12  VD-COMPANY-CD              PIC X.
   322     12  VD-CARRIER                 PIC X.
   323     12  VD-GROUPING.
   324         20  VD-GROUPING-PREFIX     PIC XXX.
   325         20  VD-GROUPING-PRIME      PIC XXX.
   326     12  VD-STATE                   PIC XX.
   327     12  VD-ACCOUNT.
   328         20  VD-ACCOUNT-PREFIX      PIC X(4).
   329         20  VD-ACCOUNT-PRIME       PIC X(6).
   330     12  VD-CERT-EFF-DT             PIC XX.
   331     12  VD-CERT-NO.
   332         20  VD-CERT-PRIME          PIC X(10).
   333         20  VD-CERT-SFX            PIC X.
   334     12  VD-ENTRY-BATCH             PIC X(6).
   335     12  VD-CSR-ID                  PIC X(4).
   336     12  VD-NAME.
   337         20  VD-INSURED-LAST-NAME   PIC X(15).
   338         20  VD-INSURED-FIRST-NAME.
   339             24  VD-INSURED-1ST-INIT PIC X.
   340             24  FILLER             PIC X(9).
   341         20  VD-INSURED-MIDDLE-INIT PIC X.
   342     12  VD-JOINT-INSURED.
   343         20 VD-JOINT-LAST-NAME      PIC X(15).
   344         20 VD-JOINT-FIRST-NAME.
   345            24  VD-JOINT-FIRST-INIT PIC X.
   346            24  FILLER              PIC X(9).
   347         20 VD-JOINT-MIDDLE-INIT    PIC X.
   348     12  VD-INSURED-ADDRESS-1       PIC X(30).
   349     12  VD-INSURED-ADDRESS-2       PIC X(30).
   350     12  VD-INSURED-CITY-STATE.
   351         20  VD-INSURED-CITY        PIC X(28).
   352         20  VD-INSURED-STATE       PIC XX.
   353     12  VD-INSURED-ZIP-CODE.
   354         20  VD-INSURED-ZIP-PRIME.
   355             24  VD-INSURED-ZIP-1   PIC X.
   356                 88  VD-CANADIAN-POST-CODE
   357                                       VALUE 'A' THRU 'Z'.
   358             24  FILLER             PIC X(4).
   359         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   360     12  VD-BENEFICIARY-NAME        PIC X(30).
   361     12  VD-ACCOUNT-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   8
* NSRASBL.cbl
   362     12  VD-LOAN-TERM               PIC S999   COMP-3.
   363     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   364     12  VD-1ST-PMT-DT              PIC XX.
   365     12  VD-LIFE-BENEFIT-CD         PIC XX.
   366         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   367         88  VD-INVALID-LIFE           VALUE '  ' '00'
   368                                             '90' THRU '99'.
   369     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   370                                    PIC XX.
   371     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   372     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   373     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   374     12  VD-LF-TERM                 PIC S999   COMP-3.
   375     12  VD-AH-BENEFIT-CD           PIC XX.
   376         88  VD-VALID-AH               VALUE '01' THRU '89'.
   377         88  VD-INVALID-AH             VALUE '  ' '00'
   378                                             '90' THRU '99'.
   379     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   380     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   381     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   382     12  VD-AH-TERM                 PIC S999   COMP-3.
   383     12  VD-LETTER-ID               PIC X(4).
   384     12  VD-PROC-ID                 PIC X(4).
   385     12  VD-COMP-ID                 PIC X(3).
   386     12  VD-CURRENT-DATE            PIC XX.
   387     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   388     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   389     12  FILLER                     PIC X(32).
   390 01  WS-PASS-AREA.
   391     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   392     05  WS-PASS-VADS-REC    PIC X(350).
   393
   394*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   395*                         COPY ELCZREC.
   396******************************************************************
   397*                                                                *
   398*                                                                *
   399*                            ELCZREC.                            *
   400*                                                                *
   401*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   402*                                                                *
   403******************************************************************
   404*-----------------------------------------------------------------
   405*                   C H A N G E   L O G
   406*
   407* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   408*-----------------------------------------------------------------
   409*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   410* EFFECTIVE    NUMBER
   411*-----------------------------------------------------------------
   412* 122011    2011022800001  AJRA  NEW FILE
   413* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   414* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   415* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   416* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   417*-----------------------------------------------------------------
   418 01  W-Z-CONTROL-DATA.
   419     05  W-NUMBER-OF-COPIES      PIC  9.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   9
* NSRASBL.cbl
   420     05  FILLER                  PIC  X.
   421     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   422     05  FILLER                  PIC  X.
   423     05  W-DAYS-TO-RESEND        PIC  999.
   424     05  FILLER                  PIC  X.
   425     05  W-FORM-TO-RESEND        PIC  X(4).
   426     05  W-ADD-BAR-CODE          PIC  X.
   427     05  W-PROMPT-LETTER         PIC  X.
   428     05  W-HAS-RETURN-ENV        PIC  X.
   429     05  W-ENCLOSURE-CD          PIC  XXX.
   430     05  W-SIG-FLAG-DEFAULT      PIC  X.
   431     05  W-AUTO-CLOSE-IND        PIC  X.
   432     05  FILLER                  PIC  X.
   433     05  W-LETTER-TO-BENE        PIC  X.
   434     05  FILLER                  PIC  X.
   435     05  W-LETTER-TO-ACCT        PIC  X.
   436     05  FILLER                  PIC  X.
   437     05  W-LETTER-TYPE           PIC  X.
   438     05  FILLER                  PIC  X.
   439     05  W-PRINT-CERTIFICATE     PIC  X.
   440     05  FILLER                  PIC  X.
   441     05  W-REFUND-REQUIRED       PIC  X.
   442     05  FILLER                  PIC  X.
   443     05  W-ONBASE-CODE           PIC  XX.
   444     05  FILLER                  PIC  X.
   445     05  W-ACCT-SUMM             PIC  X.
   446     05  FILLER                  PIC  X.
   447     05  W-CSO-SUMM              PIC  X.
   448     05  FILLER                  PIC  X.
   449     05  W-REASONS-REQUIRED      PIC  X.
   450     05  FILLER                  PIC  X(29).
   451 01  MISC.
   452     12  WS-RESPONSE             PIC S9(8)   COMP.
   453         88  RESP-NORMAL                  VALUE +00.
   454         88  RESP-NOTFND                  VALUE +13.
   455         88  RESP-DUPREC                  VALUE +14.
   456         88  RESP-DUPKEY                  VALUE +15.
   457         88  RESP-NOTOPEN                 VALUE +19.
   458         88  RESP-ENDFILE                 VALUE +20.
   459
   460     12  WS-EDIT-A-DATE.
   461         16  WS-EDIT-A-MM                 PIC X(2).
   462         16  FILLER                       PIC X(1).
   463         16  WS-EDIT-A-DD                 PIC X(2).
   464         16  FILLER                       PIC X(1).
   465         16  WS-EDIT-A-CCYY.
   466             20  WS-EDIT-A-CC             PIC X(2).
   467             20  WS-EDIT-A-YY             PIC X(2).
   468 01  srch-commarea.
   469*                                copy ELCADLTRSPI.
   470******************************************************************
   471*                   C H A N G E   L O G
   472*
   473* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   474*-----------------------------------------------------------------
   475*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   476* EFFECTIVE    NUMBER
   477*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  10
* NSRASBL.cbl
   478* 060611    2011022800001  PEMA  NEW COPYBOOK
   479* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   480* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   481******************************************************************
   482****************************************
   483*  commarea for NaperSoft On Demand Admin services letters
   484*  (business logic input & output)
   485****************************************
   486     03  BL-INPUT.
   487         05  BL-DATA-SRCE        PIC X.
   488         05  BL-LETTER-ID        PIC XXXX.
   489         05  BL-CARRIER          PIC X.
   490         05  BL-GROUP            PIC X(6).
   491         05  BL-STATE            PIC XX.
   492         05  BL-ACCOUNT          PIC X(10).
   493         05  BL-EFF-DT           PIC X(10).
   494         05  BL-CERT-NO          PIC X(11).
   495         05  BL-BATCH-NO         PIC X(6).
   496         05  BL-BATCH-SEQ        PIC 9(8).
   497         05  BL-RESP-NO          PIC X(10).
   498         05  BL-NO-OF-COPIES     PIC 99.
   499         05  BL-PROC-ID          PIC XXXX.
   500         05  BL-COMP-ID          PIC XXX.
   501         05  BL-PRINT-NOW-SW     PIC X.
   502         05  BL-ENC-CD           PIC XXX.
   503         05  BL-RESEND-DT        PIC X(10).
   504         05  BL-FOLLOW-UP-DT     PIC X(10).
   505         05  BL-ARCHIVE-NO       PIC 9(8).
   506         05  BL-FUNC             PIC X(8).
   507         05  BL-COMMENTS         PIC X(100).
   508         05  FILLER REDEFINES BL-COMMENTS.
   509             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   510             10  BL-LETTER-TO-ACCT PIC X.
   511             10  BL-LETTER-TO-BENE PIC X.
   512             10  BL-WRITE-ERARCH   PIC X.
   513                 88  ERARCH-QWS      VALUE 'Q'.
   514                 88  ERARCH-BATCH    VALUE 'B'.
   515                 88  ERARCH-TEMP     VALUE 'T'.
   516             10  BL-PROCESS-TYPE PIC X(07).
   517             10  BL-CERT-FORM-ID PIC X(05).
   518             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   519             10  BL-SOURCE-SCREEN PIC X(8).
   520             10  FILLER          PIC X(25).
   521     03  BL-OUTPUT.
   522         05  BL-STATUS                   PIC X.
   523             88  BL-OK                      VALUE "P".
   524             88  BL-FAIL                  VALUE "F".
   525         05  BL-MESSAGE          PIC X(50).
   526     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   527     03  FILLER                  PIC X(31).
   528 01  filler                      pic x(500).
   529 01  WS-SAVE-CARRIER-INFO.
   530     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   531     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   532     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   533     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   534     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   535     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  11
* NSRASBL.cbl
   536     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   537     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   538 01  WS-SAVE-STATE-INFO.
   539     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   540     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   541 01  WS-SAVE-LFBEN-INFO.
   542     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   543     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   544     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   545 01  WS-SAVE-AHBEN-INFO.
   546     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   547     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   548     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   549     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   550 01  WS-ERPNDB-KEY.
   551     05  WS-ERPNDB-COMPANY-CD    PIC X.
   552     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   553     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   554     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   555 01  WS-ELENCC-KEY.
   556     05  WS-ELENCC-COMPANY-CD    PIC X.
   557     05  WS-ELENCC-REC-TYPE      PIC X.
   558     05  WS-ELENCC-ENC-CODE      PIC X(5).
   559     05  F                       PIC X(9).
   560 01  WS-ELCERT-KEY.
   561     05  WS-ELCERT-COMPANY-CD    PIC X.
   562     05  WS-ELCERT-CARRIER       PIC X.
   563     05  WS-ELCERT-GROUP         PIC X(6).
   564     05  WS-ELCERT-STATE         PIC XX.
   565     05  WS-ELCERT-ACCOUNT       PIC X(10).
   566     05  WS-ELCERT-EFF-DT        PIC XX.
   567     05  WS-ELCERT-CERT-NO       PIC X(11).
   568 01  WS-ELCRTT-KEY.
   569     05  WS-ELCRTT-PRIMARY       PIC X(33).
   570     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   571
   572 01  WS-ERENDT-KEY.
   573     05  WS-ERENDT-COMPANY-CD    PIC X.
   574     05  WS-ERENDT-CARRIER       PIC X.
   575     05  WS-ERENDT-GROUP         PIC X(6).
   576     05  WS-ERENDT-STATE         PIC XX.
   577     05  WS-ERENDT-ACCOUNT       PIC X(10).
   578     05  WS-ERENDT-EFF-DT        PIC XX.
   579     05  WS-ERENDT-CERT-NO       PIC X(11).
   580     05  WS-ERENDT-REC-TYPE      PIC X.
   581     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   582
   583 01  WS-ERENDT-KEY-BY-ARCH.
   584     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   585     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   586 01  WS-ERCOMP-KEY.
   587     05  WS-ERCOMP-COMPANY-CD    PIC X.
   588     05  WS-ERCOMP-CARRIER       PIC X.
   589     05  WS-ERCOMP-GROUP         PIC X(6).
   590     05  WS-ERCOMP-RESP-NO       PIC X(10).
   591     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   592     05  WS-ERCOMP-REC-TYPE      PIC X.
   593 01  WS-ERMAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  12
* NSRASBL.cbl
   594     05  WS-ERMAIL-COMPANY-CD    PIC X.
   595     05  WS-ERMAIL-CARRIER       PIC X.
   596     05  WS-ERMAIL-GROUP         PIC X(6).
   597     05  WS-ERMAIL-STATE         PIC XX.
   598     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   599     05  WS-ERMAIL-EFF-DT        PIC XX.
   600     05  WS-ERMAIL-CERT-NO       PIC X(11).
   601 01  WS-ERACCT-KEY.
   602     05  WS-ERACCT-COMPANY-CD    PIC X.
   603     05  WS-ERACCT-CARRIER       PIC X.
   604     05  WS-ERACCT-GROUP         PIC X(6).
   605     05  WS-ERACCT-STATE         PIC XX.
   606     05  WS-ERACCT-ACCOUNT       PIC X(10).
   607     05  WS-ERACCT-EXP-DT        PIC XX.
   608     05  FILLER                  PIC XXXX.
   609 01  WS-ELLETR-KEY.
   610     05  WS-ELLETR-COMPANY-CD    PIC X.
   611     05  WS-ELLETR-LETTER-ID     PIC X(12).
   612     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   613 01  WS-ELCNTL-KEY.
   614     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   615     05  WS-ELCNTL-REC-TYPE      PIC X.
   616     05  WS-ELCNTL-GENL.
   617         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   618         10  WS-ELCNTL-BEN-CD.
   619             15  F               PIC X.
   620             15  WS-ELCNTL-CARR  PIC X.
   621     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   622*                                COPY ELCDATE.
   623******************************************************************
   624*                                                                *
   625*                                                                *
   626*                            ELCDATE.                            *
   627*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   628*                            VMOD=2.003
   629*                                                                *
   630*                                                                *
   631*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   632*                 LENGTH = 200                                   *
   633******************************************************************
   634
   635 01  DATE-CONVERSION-DATA.
   636     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   637     12  DC-OPTION-CODE                PIC X.
   638         88  BIN-TO-GREG                VALUE ' '.
   639         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   640         88  EDIT-GREG-TO-BIN           VALUE '2'.
   641         88  YMD-GREG-TO-BIN            VALUE '3'.
   642         88  MDY-GREG-TO-BIN            VALUE '4'.
   643         88  JULIAN-TO-BIN              VALUE '5'.
   644         88  BIN-PLUS-ELAPSED           VALUE '6'.
   645         88  FIND-CENTURY               VALUE '7'.
   646         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   647         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   648         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   649         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   650         88  JULIAN-TO-BIN-3            VALUE 'C'.
   651         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  13
* NSRASBL.cbl
   652         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   653         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   654         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   655         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   656         88  CHECK-LEAP-YEAR            VALUE 'H'.
   657         88  BIN-3-TO-GREG              VALUE 'I'.
   658         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   659         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   660         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   661         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   662         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   663         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   664         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   665         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   666         88  THREE-CHARACTER-BIN
   667                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   668         88  GREGORIAN-TO-BIN
   669                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   670         88  BIN-TO-GREGORIAN
   671                  VALUES ' ' '1' 'I' '8' 'G'.
   672         88  JULIAN-TO-BINARY
   673                  VALUES '5' 'C' 'E' 'F'.
   674     12  DC-ERROR-CODE                 PIC X.
   675         88  NO-CONVERSION-ERROR        VALUE ' '.
   676         88  DATE-CONVERSION-ERROR
   677                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   678         88  DATE-IS-ZERO               VALUE '1'.
   679         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   680         88  DATE-IS-INVALID            VALUE '3'.
   681         88  DATE1-GREATER-DATE2        VALUE '4'.
   682         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   683         88  DATE-INVALID-OPTION        VALUE '9'.
   684         88  INVALID-CENTURY            VALUE 'A'.
   685         88  ONLY-CENTURY               VALUE 'B'.
   686         88  ONLY-LEAP-YEAR             VALUE 'C'.
   687         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   688     12  DC-END-OF-MONTH               PIC X.
   689         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   690     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   691         88  USE-NORMAL-PROCESS         VALUE ' '.
   692         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   693         88  ADJUST-UP-100-YRS          VALUE '2'.
   694     12  FILLER                        PIC X.
   695     12  DC-CONVERSION-DATES.
   696         16  DC-BIN-DATE-1             PIC XX.
   697         16  DC-BIN-DATE-2             PIC XX.
   698         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   699         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   700                       DC-GREG-DATE-1-EDIT.
   701             20  DC-EDIT1-MONTH        PIC 99.
   702             20  SLASH1-1              PIC X.
   703             20  DC-EDIT1-DAY          PIC 99.
   704             20  SLASH1-2              PIC X.
   705             20  DC-EDIT1-YEAR         PIC 99.
   706         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   707         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   708                     DC-GREG-DATE-2-EDIT.
   709             20  DC-EDIT2-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  14
* NSRASBL.cbl
   710             20  SLASH2-1              PIC X.
   711             20  DC-EDIT2-DAY          PIC 99.
   712             20  SLASH2-2              PIC X.
   713             20  DC-EDIT2-YEAR         PIC 99.
   714         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   715         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   716                     DC-GREG-DATE-1-YMD.
   717             20  DC-YMD-YEAR           PIC 99.
   718             20  DC-YMD-MONTH          PIC 99.
   719             20  DC-YMD-DAY            PIC 99.
   720         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   721         16  DC-GREG-DATE-1-MDY-R REDEFINES
   722                      DC-GREG-DATE-1-MDY.
   723             20  DC-MDY-MONTH          PIC 99.
   724             20  DC-MDY-DAY            PIC 99.
   725             20  DC-MDY-YEAR           PIC 99.
   726         16  DC-GREG-DATE-1-ALPHA.
   727             20  DC-ALPHA-MONTH        PIC X(10).
   728             20  DC-ALPHA-DAY          PIC 99.
   729             20  FILLER                PIC XX.
   730             20  DC-ALPHA-CENTURY.
   731                 24 DC-ALPHA-CEN-N     PIC 99.
   732             20  DC-ALPHA-YEAR         PIC 99.
   733         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   734         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   735         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   736         16  DC-JULIAN-DATE            PIC 9(05).
   737         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   738                                       PIC 9(05).
   739         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   740             20  DC-JULIAN-YEAR        PIC 99.
   741             20  DC-JULIAN-DAYS        PIC 999.
   742         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   743         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   744         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   745     12  DATE-CONVERSION-VARIBLES.
   746         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   747         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   748             20  FILLER                PIC 9(3).
   749             20  HOLD-CEN-1-CCYY.
   750                 24  HOLD-CEN-1-CC     PIC 99.
   751                 24  HOLD-CEN-1-YY     PIC 99.
   752             20  HOLD-CEN-1-MO         PIC 99.
   753             20  HOLD-CEN-1-DA         PIC 99.
   754         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   755             20  HOLD-CEN-1-R-MO       PIC 99.
   756             20  HOLD-CEN-1-R-DA       PIC 99.
   757             20  HOLD-CEN-1-R-CCYY.
   758                 24  HOLD-CEN-1-R-CC   PIC 99.
   759                 24  HOLD-CEN-1-R-YY   PIC 99.
   760             20  FILLER                PIC 9(3).
   761         16  HOLD-CENTURY-1-X.
   762             20  FILLER                PIC X(3)  VALUE SPACES.
   763             20  HOLD-CEN-1-X-CCYY.
   764                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   765                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   766             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   767             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  15
* NSRASBL.cbl
   768         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   769             20  HOLD-CEN-1-R-X-MO     PIC XX.
   770             20  HOLD-CEN-1-R-X-DA     PIC XX.
   771             20  HOLD-CEN-1-R-X-CCYY.
   772                 24  HOLD-CEN-1-R-X-CC PIC XX.
   773                 24  HOLD-CEN-1-R-X-YY PIC XX.
   774             20  FILLER                PIC XXX.
   775         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   776         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   777         16  DC-JULIAN-DATE-1          PIC 9(07).
   778         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   779             20  DC-JULIAN-1-CCYY.
   780                 24  DC-JULIAN-1-CC    PIC 99.
   781                 24  DC-JULIAN-1-YR    PIC 99.
   782             20  DC-JULIAN-DA-1        PIC 999.
   783         16  DC-JULIAN-DATE-2          PIC 9(07).
   784         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   785             20  DC-JULIAN-2-CCYY.
   786                 24  DC-JULIAN-2-CC    PIC 99.
   787                 24  DC-JULIAN-2-YR    PIC 99.
   788             20  DC-JULIAN-DA-2        PIC 999.
   789         16  DC-GREG-DATE-A-EDIT.
   790             20  DC-EDITA-MONTH        PIC 99.
   791             20  SLASHA-1              PIC X VALUE '/'.
   792             20  DC-EDITA-DAY          PIC 99.
   793             20  SLASHA-2              PIC X VALUE '/'.
   794             20  DC-EDITA-CCYY.
   795                 24  DC-EDITA-CENT     PIC 99.
   796                 24  DC-EDITA-YEAR     PIC 99.
   797         16  DC-GREG-DATE-B-EDIT.
   798             20  DC-EDITB-MONTH        PIC 99.
   799             20  SLASHB-1              PIC X VALUE '/'.
   800             20  DC-EDITB-DAY          PIC 99.
   801             20  SLASHB-2              PIC X VALUE '/'.
   802             20  DC-EDITB-CCYY.
   803                 24  DC-EDITB-CENT     PIC 99.
   804                 24  DC-EDITB-YEAR     PIC 99.
   805         16  DC-GREG-DATE-CYMD         PIC 9(08).
   806         16  DC-GREG-DATE-CYMD-R REDEFINES
   807                              DC-GREG-DATE-CYMD.
   808             20  DC-CYMD-CEN           PIC 99.
   809             20  DC-CYMD-YEAR          PIC 99.
   810             20  DC-CYMD-MONTH         PIC 99.
   811             20  DC-CYMD-DAY           PIC 99.
   812         16  DC-GREG-DATE-MDCY         PIC 9(08).
   813         16  DC-GREG-DATE-MDCY-R REDEFINES
   814                              DC-GREG-DATE-MDCY.
   815             20  DC-MDCY-MONTH         PIC 99.
   816             20  DC-MDCY-DAY           PIC 99.
   817             20  DC-MDCY-CEN           PIC 99.
   818             20  DC-MDCY-YEAR          PIC 99.
   819    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   820        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   821    12  DC-EL310-DATE                  PIC X(21).
   822    12  FILLER                         PIC X(28).
   823*                                COPY NSCASEXTR.
   824******************************************************************
   825*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  16
* NSRASBL.cbl
   826*                                                                *
   827*                            NSCASEXTR.                          *
   828*                            VMOD=2.001                          *
   829*                                                                *
   830*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   831*                                                                *
   832*   FILE TYPE = VSAM,KSDS                                        *
   833*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   834*                                                                *
   835*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   836*                                                                *
   837*   LOG = NO                                                     *
   838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   839******************************************************************
   840*-----------------------------------------------------------------
   841*                   C H A N G E   L O G
   842*
   843* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   844*-----------------------------------------------------------------
   845*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   846* EFFECTIVE    NUMBER
   847*-----------------------------------------------------------------
   848* 072211    2011022800001  PEMA  NEW FILE
   849*-----------------------------------------------------------------
   850 01 NSAS-EXTRACT-RECORD.
   851    05  NSAS-CONTROL-PRIMARY.
   852        10  NSAS-COMPANY-CD      PIC X.
   853        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   854        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   855    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   856    05  FILLER                   PIC X(143).
   857*                                COPY ERCPNDB.
   858******************************************************************
   859*                                                                *
   860*                                                                *
   861*                            ERCPNDB.                            *
   862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   863*                            VMOD=2.025                          *
   864*                                                                *
   865*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   866*                                                                *
   867******************************************************************
   868*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   869*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   870******************************************************************
   871*                                                                *
   872*                                                                *
   873*   FILE TYPE = VSAM,KSDS                                        *
   874*   RECORD SIZE = 585  RECFORM = FIXED                           *
   875*                                                                *
   876*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   877*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   878*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   879*                                                 RKP=13,LEN=36  *
   880*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   881*                                      AND CHG-SEQ.)             *
   882*                                                RKP=49,LEN=11   *
   883*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  17
* NSRASBL.cbl
   884*                                      AND CHG-SEQ.)             *
   885*                                                RKP=60,LEN=15   *
   886*                                                                *
   887*   LOG = NO                                                     *
   888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   889******************************************************************
   890******************************************************************
   891*                   C H A N G E   L O G
   892*
   893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   894*-----------------------------------------------------------------
   895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   896* EFFECTIVE    NUMBER
   897*-----------------------------------------------------------------
   898* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   899* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   900* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   901* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   902* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   903* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   904* 032306                   PEMA  ADD BOW LOAN NUMBER
   905* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   906* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   907* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   908* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   909* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   910* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   911* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   912* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   913******************************************************************
   914
   915 01  PENDING-BUSINESS.
   916     12  PB-RECORD-ID                     PIC XX.
   917         88  VALID-PB-ID                        VALUE 'PB'.
   918
   919     12  PB-CONTROL-PRIMARY.
   920         16  PB-COMPANY-CD                PIC X.
   921         16  PB-ENTRY-BATCH               PIC X(6).
   922         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   923         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   924
   925     12  PB-CONTROL-BY-ACCOUNT.
   926         16  PB-COMPANY-CD-A1             PIC X.
   927         16  PB-CARRIER                   PIC X.
   928         16  PB-GROUPING.
   929             20  PB-GROUPING-PREFIX       PIC XXX.
   930             20  PB-GROUPING-PRIME        PIC XXX.
   931         16  PB-STATE                     PIC XX.
   932         16  PB-ACCOUNT.
   933             20  PB-ACCOUNT-PREFIX        PIC X(4).
   934             20  PB-ACCOUNT-PRIME         PIC X(6).
   935         16  PB-CERT-EFF-DT               PIC XX.
   936         16  PB-CERT-NO.
   937             20  PB-CERT-PRIME            PIC X(10).
   938             20  PB-CERT-SFX              PIC X.
   939         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   940
   941         16  PB-RECORD-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  18
* NSRASBL.cbl
   942             88  PB-MAILING-DATA                VALUE '0'.
   943             88  PB-ISSUE                       VALUE '1'.
   944             88  PB-CANCELLATION                VALUE '2'.
   945             88  PB-BATCH-TRAILER               VALUE '9'.
   946
   947     12  PB-CONTROL-BY-ORIG-BATCH.
   948         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   949         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   950         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   951         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   952
   953     12  PB-CONTROL-BY-CSR.
   954         16  PB-CSR-COMPANY-CD            PIC X.
   955         16  PB-CSR-ID                    PIC X(4).
   956         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   957         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   958         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   959******************************************************************
   960*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   961******************************************************************
   962
   963     12  PB-LAST-MAINT-DT                 PIC XX.
   964     12  PB-LAST-MAINT-BY                 PIC X(4).
   965     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   966
   967     12  PB-RECORD-BODY                   PIC X(375).
   968
   969     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   970         16  PB-CERT-ORIGIN               PIC X.
   971             88  CLASIC-CREATED-CERT         VALUE '1'.
   972         16  PB-I-NAME.
   973             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   974             20  PB-I-INSURED-FIRST-NAME.
   975                 24  PB-I-INSURED-1ST-INIT PIC X.
   976                 24  FILLER                PIC X(9).
   977             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   978         16  PB-I-AGE                     PIC S99   COMP-3.
   979         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   980         16  PB-I-BIRTHDAY                PIC XX.
   981         16  PB-I-INSURED-SEX             PIC X.
   982             88  PB-SEX-MALE     VALUE 'M'.
   983             88  PB-SEX-FEMALE   VALUE 'F'.
   984
   985         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   986         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   987         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   988         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   989         16  PB-I-SKIP-CODE               PIC X.
   990             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   991             88  PB-SKIP-JULY              VALUE '1'.
   992             88  PB-SKIP-AUGUST            VALUE '2'.
   993             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   994             88  PB-SKIP-JULY-AUG          VALUE '4'.
   995             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   996             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   997             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   998             88  PB-SKIP-JUNE              VALUE '8'.
   999             88  PB-SKIP-JUNE-JULY         VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  19
* NSRASBL.cbl
  1000             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1001             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1002         16  PB-I-TERM-TYPE               PIC X.
  1003             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1004             88  PB-PAID-WEEKLY            VALUE 'W'.
  1005             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1006             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1007             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1008         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1009         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1010         16  PB-I-DATA-ENTRY-SW           PIC X.
  1011             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1012             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1013             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1014             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1015         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1016         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1017*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1018         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1019         16  FILLER                       PIC X.
  1020
  1021         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1022             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1023             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1024                                                   '90' THRU '99'.
  1025         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1026                                          PIC XX.
  1027         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1028         16  PB-I-AMOUNT-FINANCED REDEFINES
  1029                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  1030         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1031         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1032                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1033         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1034         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1035         16  PB-I-CLP-AMOUNT REDEFINES
  1036                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1037         16  PB-I-LF-CALC-FLAG            PIC X.
  1038             88 PB-COMP-LF-PREM               VALUE '?'.
  1039         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1040         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1041         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1042         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1043         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1044         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1045         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1046         16  PB-I-LF-ABBR                 PIC XXX.
  1047         16  PB-I-LF-INPUT-CD             PIC XX.
  1048
  1049         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1050             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1051             88  PB-INVALID-AH               VALUE '  ' '00'
  1052                                                   '90' THRU '99'.
  1053         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1054         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1055         16  PB-I-AH-CALC-FLAG            PIC X.
  1056             88 PB-COMP-AH-PREM                  VALUE '?'.
  1057         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  20
* NSRASBL.cbl
  1058         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1059         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1060         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1061         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1062         16  PB-I-AH-ABBR                 PIC XXX.
  1063         16  PB-I-AH-INPUT-CD             PIC XXX.
  1064
  1065         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1066         16  PB-I-REIN-TABLE              PIC XXX.
  1067         16  PB-I-BUSINESS-TYPE           PIC 99.
  1068         16  PB-I-INDV-GRP-CD             PIC X.
  1069         16  PB-I-MORT-CODE.
  1070             20  PB-I-TABLE               PIC X.
  1071             20  PB-I-INTEREST            PIC XX.
  1072             20  PB-I-MORT-TYP            PIC X.
  1073         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1074         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1075         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1076         16  PB-I-INDV-GRP-OVRD           PIC X.
  1077         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1078         16  PB-I-SIG-SW                  PIC X.
  1079             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1080         16  PB-I-RATE-CLASS              PIC XX.
  1081         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1082         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1083         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1084         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1085         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1086         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  1087         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  1088         16  PB-I-BENEFIT-TYPE            PIC XXX.
  1089         16  PB-I-OB-FLAG                 PIC X.
  1090             88  PB-I-OB                      VALUE 'B'.
  1091             88  PB-I-SUMMARY                 VALUE 'Z'.
  1092         16  PB-I-ENTRY-STATUS            PIC X.
  1093             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1094                                              'M' '5' '9' '2'.
  1095             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1096             88  PB-I-POLICY-PENDING          VALUE '2'.
  1097             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1098             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1099             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1100             88  PB-I-REIN-ONLY               VALUE '9'.
  1101             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  1102             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  1103             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1104             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1105         16  PB-I-INT-CODE                PIC X.
  1106             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1107             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  1108         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1109         16  PB-I-SOC-SEC-NO              PIC X(11).
  1110         16  PB-I-MEMBER-NO               PIC X(12).
  1111         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  1112*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1113         16  PB-I-OLD-LOF                 PIC XXX.
  1114         16  PB-I-LF-EXPIRE-DT            PIC XX.
  1115         16  PB-I-AH-EXPIRE-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  21
* NSRASBL.cbl
  1116         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1117         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1118         16  PB-I-LIFE-INDICATOR          PIC X.
  1119             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1120         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1121         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1122                                          PIC S9(5)V99    COMP-3.
  1123         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1124             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1125             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1126         16  PB-I-1ST-PMT-DT              PIC XX.
  1127         16  PB-I-JOINT-INSURED.
  1128             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1129             20 PB-I-JOINT-FIRST-NAME.
  1130                24  PB-I-JOINT-FIRST-INIT PIC X.
  1131                24  FILLER                PIC X(9).
  1132             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1133*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1134         16  PB-I-BENEFICIARY-NAME.
  1135             20  PB-I-BANK-NUMBER         PIC X(10).
  1136             20  FILLER                   PIC X(15).
  1137         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1138         16  PB-I-REFERENCE               PIC X(12).
  1139         16  FILLER REDEFINES PB-I-REFERENCE.
  1140             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1141             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1142             20  PB-I-CLP-STATE           PIC XX.
  1143         16  PB-I-UNDERWRITING-STATUS     PIC X.
  1144             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  1145             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1146             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  1147         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1148         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1149         16  PB-I-RESIDENT-STATE          PIC XX.
  1150         16  PB-I-RATE-CODE               PIC X(4).
  1151         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1152         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1153         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1154         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1155         16  PB-I-BANK-NOCHRGB            PIC 99.
  1156         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1157         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1158
  1159     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1160         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1161             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1162         16  PB-C-CANCEL-ORIGIN           PIC X.
  1163             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1164         16  PB-C-LF-CANCEL-DT            PIC XX.
  1165         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1166         16  PB-C-LF-CALC-REQ             PIC X.
  1167             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1168         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1169         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1170         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1171             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1172         16  PB-C-AH-CANCEL-DT            PIC XX.
  1173         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  22
* NSRASBL.cbl
  1174         16  PB-C-AH-CALC-REQ             PIC X.
  1175             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1176         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1177         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1178         16  PB-C-LAST-NAME               PIC X(15).
  1179         16  PB-C-REFUND-SW               PIC X.
  1180             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1181             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1182         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1183         16  PB-C-PAYEE-CODE              PIC X(6).
  1184         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1185         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1186         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1187         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1188         16  PB-C-REFERENCE               PIC X(12).
  1189         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1190         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1191         16  PB-C-POST-CARD-IND           PIC X.
  1192         16  PB-C-CANCEL-REASON           PIC X.
  1193         16  PB-C-REF-INTERFACE-SW        PIC X.
  1194         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1195         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1196         16  FILLER                       PIC X(01).
  1197*        16  FILLER                       PIC X(18).
  1198         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1199*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1200         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1201         16  PB-CANCELED-CERT-DATA.
  1202             20  PB-CI-INSURED-NAME.
  1203                 24  PB-CI-LAST-NAME      PIC X(15).
  1204                 24  PB-CI-INITIALS       PIC XX.
  1205             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1206             20  PB-CI-INSURED-SEX        PIC X.
  1207             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1208             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1209             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1210             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1211             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1212             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1213             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1214             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1215             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1216             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1217             20  PB-CI-RATE-CLASS         PIC XX.
  1218             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1219             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1220             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1221             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1222             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1223             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1224             20  PB-CI-LF-ABBR            PIC X(3).
  1225             20  PB-CI-AH-ABBR            PIC X(3).
  1226             20  PB-CI-OB-FLAG            PIC X.
  1227                 88  PB-CI-OB                VALUE 'B'.
  1228             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1229                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1230                                           'M' '4' '5' '9' '2'.
  1231                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  23
* NSRASBL.cbl
  1232                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1233                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1234                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1235                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1236                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1237                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1238                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1239                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1240                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1241                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1242                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1243             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1244                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1245                                           'M' '4' '5' '9' '2'.
  1246                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1247                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1248                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1249                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1250                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1251                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1252                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1253                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1254                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1255                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1256                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1257                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1258             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1259             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1260             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1261             20  PB-CI-MEMBER-NO          PIC X(12).
  1262             20  PB-CI-INT-CODE           PIC X.
  1263                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1264                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1265             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1266             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1267             20  PB-CI-COMP-EXCP-SW       PIC X.
  1268                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1269                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1270             20  PB-CI-ENTRY-STATUS       PIC X.
  1271             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1272             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1273             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1274             20  PB-CI-DEATH-DT           PIC XX.
  1275             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1276             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1277             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1278             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1279             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1280             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1281             20  PB-CI-ENTRY-DT              PIC XX.
  1282             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1283             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1284             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1285             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1286             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1287             20  PB-CI-OLD-LOF               PIC XXX.
  1288*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1289             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  24
* NSRASBL.cbl
  1290             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1291             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1292             20  PB-CI-INDV-GRP-CD           PIC X.
  1293             20  PB-CI-BENEFICIARY-NAME.
  1294                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1295                 24  FILLER                  PIC X(15).
  1296             20  PB-CI-NOTE-SW               PIC X.
  1297             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1298             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1299             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1300             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1301             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1302             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1303             20  PB-CI-FIRST-NAME            PIC X(10).
  1304             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1305
  1306         16  FILLER                       PIC X(13).
  1307*032306  16  FILLER                       PIC X(27).
  1308*        16  FILLER                       PIC X(46).
  1309
  1310     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1311         16  FILLER                       PIC X(10).
  1312         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1313         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1314         16  PB-M-INSURED-MID-INIT        PIC X.
  1315         16  PB-M-INSURED-AGE             PIC 99.
  1316         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1317         16  PB-M-INSURED-SEX             PIC X.
  1318         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1319         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1320         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1321         16  PB-M-INSURED-CITY-STATE.
  1322             20  PB-M-INSURED-CITY        PIC X(28).
  1323             20  PB-M-INSURED-STATE       PIC XX.
  1324         16  PB-M-INSURED-ZIP-CODE.
  1325             20  PB-M-INSURED-ZIP-PRIME.
  1326                 24  PB-M-INSURED-ZIP-1   PIC X.
  1327                     88  PB-M-CANADIAN-POST-CODE
  1328                                             VALUE 'A' THRU 'Z'.
  1329                 24  FILLER               PIC X(4).
  1330             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1331         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1332                                        PB-M-INSURED-ZIP-CODE.
  1333             20  PM-M-INS-CAN-POST1       PIC XXX.
  1334             20  PM-M-INS-CAN-POST2       PIC XXX.
  1335             20  FILLER                   PIC XXX.
  1336         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1337         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1338         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1339         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1340         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1341         16  PB-M-CRED-BENE-CITYST.
  1342             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1343             20  PB-M-CRED-BENE-STATE     PIC XX.
  1344         16  FILLER                       PIC X(92).
  1345
  1346     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1347         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  25
* NSRASBL.cbl
  1348         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1349         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1350         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1351         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1352         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1353         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1354         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1355         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1356         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1357         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1358         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1359         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1360         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1361         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1362         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1363         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1364         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1365         16  PB-ACCOUNT-NAME              PIC X(30).
  1366         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1367         16  PB-REFERENCE                 PIC X(12).
  1368         16  PB-B-RECEIVED-DT             PIC XX.
  1369         16  FILLER                       PIC X(234).
  1370
  1371     12  PB-RECORD-STATUS.
  1372         16  PB-CREDIT-SELECT-DT          PIC XX.
  1373         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1374         16  PB-BILLED-DT                 PIC XX.
  1375         16  PB-BILLING-STATUS            PIC X.
  1376             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1377             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1378             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1379         16  PB-RECORD-BILL               PIC X.
  1380             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1381             88  PB-RECORD-RETURNED           VALUE 'R'.
  1382             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1383             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1384             88  PB-OVERRIDE-AH               VALUE 'A'.
  1385             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1386         16  PB-BATCH-ENTRY               PIC X.
  1387             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1388             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1389             88  PB-REISSUED-CERT             VALUE 'E'.
  1390             88  PB-MONTHLY-CERT              VALUE 'M'.
  1391             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1392             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1393             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1394         16  PB-FORCE-CODE                PIC X.
  1395             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1396             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1397             88  PB-CANCEL-FORCE              VALUE '8'.
  1398             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1399             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1400             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1401             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1402             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1403             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1404             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1405         16  PB-FATAL-FLAG                PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  26
* NSRASBL.cbl
  1406             88  PB-FATAL-ERRORS              VALUE 'X'.
  1407         16  PB-FORCE-ER-CD               PIC X.
  1408             88  PB-FORCE-ERRORS              VALUE 'F'.
  1409             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1410         16  PB-WARN-ER-CD                PIC X.
  1411             88  PB-WARNING-ERRORS            VALUE 'W'.
  1412         16  FILLER                       PIC X.
  1413         16  PB-OUT-BAL-CD                PIC X.
  1414             88  PB-OUT-OF-BAL                VALUE 'O'.
  1415         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1416         16  PB-AH-OVERRIDE-L1            PIC X.
  1417         16  PB-INPUT-DT                  PIC XX.
  1418         16  PB-INPUT-BY                  PIC X(4).
  1419         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1420         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1421         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1422         16  PB-LF-EARNING-METHOD         PIC X.
  1423         16  PB-AH-EARNING-METHOD         PIC X.
  1424         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1425         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1426         16  PB-REIN-CD                   PIC XXX.
  1427         16  PB-LF-REFUND-TYPE            PIC X.
  1428         16  PB-AH-REFUND-TYPE            PIC X.
  1429         16  PB-ACCT-EFF-DT               PIC XX.
  1430         16  PB-ACCT-EXP-DT               PIC XX.
  1431         16  PB-COMPANY-ID                PIC X(3).
  1432         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1433         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1434         16  PB-SV-CARRIER                PIC X.
  1435         16  PB-SV-GROUPING               PIC X(6).
  1436         16  PB-SV-STATE                  PIC XX.
  1437         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1438         16  PB-GA-BILLING-INFO.
  1439             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1440                                          PIC XX.
  1441         16  PB-SV-REMIT-TO  REDEFINES
  1442             PB-GA-BILLING-INFO           PIC X(10).
  1443         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1444         16  PB-I-LOAN-OFFICER            PIC X(5).
  1445         16  PB-I-VIN                     PIC X(17).
  1446
  1447         16  FILLER                       PIC X(04).
  1448         16  IMNET-BYPASS-SW              PIC X.
  1449
  1450******************************************************************
  1451*                COMMON EDIT ERRORS                              *
  1452******************************************************************
  1453
  1454     12  PB-COMMON-ERRORS.
  1455         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1456                                           PIC S9(4)     COMP.
  1457
  1458******************************************************************
  1459*                                COPY ERCENDT.
  1460******************************************************************
  1461*                                                                *
  1462*                                                                *
  1463*                            ERCENDT.                            *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  27
* NSRASBL.cbl
  1464*                            VMOD=2.001                          *
  1465*                                                                *
  1466*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1467*                                                                *
  1468*   FILE TYPE = VSAM,KSDS                                        *
  1469*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1470*                                                                *
  1471*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1472*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1473*                                                                *
  1474*   LOG = NO                                                     *
  1475*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1476******************************************************************
  1477*-----------------------------------------------------------------
  1478*                   C H A N G E   L O G
  1479*
  1480* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1481*-----------------------------------------------------------------
  1482*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1483* EFFECTIVE    NUMBER
  1484*-----------------------------------------------------------------
  1485* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1486*                                WITH OPEN CLAIMS
  1487* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1488* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1489* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1490*-----------------------------------------------------------------
  1491 01  ENDORSEMENT-RECORD.
  1492     12  EN-RECORD-ID                PIC XX.
  1493         88  VALID-EN-ID                VALUE 'EN'.
  1494     12  EN-CONTROL-PRIMARY.
  1495         16  EN-COMPANY-CD           PIC X.
  1496         16  EN-CARRIER              PIC X.
  1497         16  EN-GROUPING             PIC X(6).
  1498         16  EN-STATE                PIC XX.
  1499         16  EN-ACCOUNT              PIC X(10).
  1500         16  EN-CERT-EFF-DT          PIC XX.
  1501         16  EN-CERT-NO.
  1502             20  EN-CERT-PRIME       PIC X(10).
  1503             20  EN-CERT-SFX         PIC X.
  1504         16  EN-REC-TYPE             PIC X.
  1505             88  EN-ISSUE               VALUE 'I'.
  1506             88  EN-CANCELLATION        VALUE 'C'.
  1507         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1508     12  EN-CONTROL-BY-ARCH-NO.
  1509         16  EN-COMPANY-CD-A1              PIC X.
  1510         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1511     12  EN-LAST-MAINT-DT            PIC XX.
  1512     12  EN-LAST-MAINT-BY            PIC X(4).
  1513     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1514     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1515     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1516         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1517         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1518         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1519         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1520         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1521         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  28
* NSRASBL.cbl
  1522         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1523         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1524         16  EN-LF-ORIG-BENCD        PIC XX.
  1525         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1526         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1527         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1528         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1529         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1530         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1531*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1532         16  EN-ORIG-CRED-BENE       PIC X(25).
  1533         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1534         16  FILLER                  PIC X.
  1535         16  EN-AH-ORIG-BENCD        PIC XX.
  1536         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1537         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1538         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1539         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1540*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1541*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1542         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1543         16  F                       PIC X(09).
  1544         16  EN-AH-ORIG-CP           PIC 99.
  1545         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1546         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1547         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1548         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1549         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1550         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1551         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1552         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1553         16  EN-LF-NEW-BENCD         PIC XX.
  1554         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1555         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1556         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1557         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1558         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1559         16  EN-LF-NEW-EXP-DT        PIC XX.
  1560         16  EN-NEW-CRED-BENE        PIC X(25).
  1561         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1562         16  FILLER                  PIC X.
  1563         16  EN-AH-NEW-BENCD         PIC XX.
  1564         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1565         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1566         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1567         16  EN-AH-NEW-EXP-DT        PIC XX.
  1568*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1569*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1570*        16  F                       PIC X(12).
  1571         16  EN-AH-NEW-CP            PIC 99.
  1572         16  EN-SIG-SW               PIC X.
  1573         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1574         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1575         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1576         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1577         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1578         16  FILLER                  PIC X(33).
  1579     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  29
* NSRASBL.cbl
  1580         16  EN-LF-ORIG-REF-DT       PIC XX.
  1581         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1582         16  EN-AH-ORIG-REF-DT       PIC XX.
  1583         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1584         16  EN-LF-NEW-REF-DT        PIC XX.
  1585         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1586         16  EN-AH-NEW-REF-DT        PIC XX.
  1587         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1588         16  EN-FLAG-CERT            PIC X.
  1589         16  EN-INS-LAST-NAME        PIC X(15).
  1590         16  EN-INS-FIRST-NAME       PIC X(10).
  1591         16  EN-INS-MIDDLE-INIT      PIC X.
  1592         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1593         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1594         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1595         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1596         16  FILLER                  PIC X(262).
  1597     12  EN-MONEY-SW             PIC X.
  1598     12  EN-HEALTH-APP           PIC X.
  1599     12  EN-VOUCHER-SW           PIC X.
  1600     12  EN-PAYEE                PIC X(14).
  1601     12  EN-INPUT-DT             PIC XX.
  1602     12  EN-PROCESS-DT           PIC XX.
  1603     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1604     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1605     12  EN-REASON-CODES.
  1606         16  F OCCURS 12.
  1607             20  EN-REASON-CODE  PIC X(4).
  1608     12  EN-TEMPLATE-USED        PIC X(8).
  1609     12  EN-DOCU-TYPE            PIC X.
  1610         88  EN-VERI-DOCU          VALUE 'V'.
  1611         88  EN-GCE-DOCU           VALUE 'G'.
  1612         88  EN-CANC-DOCU          VALUE 'C'.
  1613     12  EN-COMMENTS1            PIC X(13).
  1614     12  EN-COMMENTS2            PIC X(70).
  1615     12  EN-COMM-CHGBK           PIC X.
  1616         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1617         88  EN-CHG-ACCT           VALUE 'Y'.
  1618     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1619     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1620     12  EN-BATCH-NUMBER         PIC X(6).
  1621     12  EN-ACCT-SUMM            PIC X.
  1622     12  EN-CSO-SUMM             PIC X.
  1623     12  FILLER                  PIC X(13).
  1624******************************************************************
  1625*                                COPY ERCMAIL.
  1626******************************************************************
  1627*                                                                *
  1628*                                                                *
  1629*                            ERCMAIL                             *
  1630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1631*                            VMOD=2.003                          *
  1632*                                                                *
  1633*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1634*                                                                *
  1635*   FILE TYPE = VSAM,KSDS                                        *
  1636*   RECORD SIZE = 374   RECFORM = FIX                            *
  1637*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  30
* NSRASBL.cbl
  1638*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1639*   ALTERNATE PATH    = NOT USED                                 *
  1640*                                                                *
  1641*   LOG = YES                                                    *
  1642*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1643******************************************************************
  1644*                   C H A N G E   L O G
  1645*
  1646* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1647*-----------------------------------------------------------------
  1648*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1649* EFFECTIVE    NUMBER
  1650*-----------------------------------------------------------------
  1651* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1652* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1653* 111108                   PEMA  ADD CRED BENE ADDR2
  1654******************************************************************
  1655
  1656 01  MAILING-DATA.
  1657     12  MA-RECORD-ID                      PIC XX.
  1658         88  VALID-MA-ID                       VALUE 'MA'.
  1659
  1660     12  MA-CONTROL-PRIMARY.
  1661         16  MA-COMPANY-CD                 PIC X.
  1662         16  MA-CARRIER                    PIC X.
  1663         16  MA-GROUPING.
  1664             20  MA-GROUPING-PREFIX        PIC XXX.
  1665             20  MA-GROUPING-PRIME         PIC XXX.
  1666         16  MA-STATE                      PIC XX.
  1667         16  MA-ACCOUNT.
  1668             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1669             20  MA-ACCOUNT-PRIME          PIC X(6).
  1670         16  MA-CERT-EFF-DT                PIC XX.
  1671         16  MA-CERT-NO.
  1672             20  MA-CERT-PRIME             PIC X(10).
  1673             20  MA-CERT-SFX               PIC X.
  1674
  1675     12  FILLER                            PIC XX.
  1676
  1677     12  MA-ACCESS-CONTROL.
  1678         16  MA-SOURCE-SYSTEM              PIC XX.
  1679             88  MA-FROM-CREDIT                VALUE 'CR'.
  1680             88  MA-FROM-VSI                   VALUE 'VS'.
  1681             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1682             88  MA-FROM-OTHER                 VALUE 'OT'.
  1683         16  MA-RECORD-ADD-DT              PIC XX.
  1684         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1685         16  MA-LAST-MAINT-DT              PIC XX.
  1686         16  MA-LAST-MAINT-BY              PIC XXXX.
  1687         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1688
  1689     12  MA-PROFILE-INFO.
  1690         16  MA-QUALIFY-CODE-1             PIC XX.
  1691         16  MA-QUALIFY-CODE-2             PIC XX.
  1692         16  MA-QUALIFY-CODE-3             PIC XX.
  1693         16  MA-QUALIFY-CODE-4             PIC XX.
  1694         16  MA-QUALIFY-CODE-5             PIC XX.
  1695
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  31
* NSRASBL.cbl
  1696         16  MA-INSURED-LAST-NAME          PIC X(15).
  1697         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1698         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1699         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1700         16  MA-INSURED-BIRTH-DT           PIC XX.
  1701         16  MA-INSURED-SEX                PIC X.
  1702             88  MA-SEX-MALE                   VALUE 'M'.
  1703             88  MA-SEX-FEMALE                 VALUE 'F'.
  1704         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1705
  1706         16  MA-ADDRESS-CORRECTED          PIC X.
  1707         16  MA-JOINT-BIRTH-DT             PIC XX.
  1708*        16  FILLER                        PIC X(12).
  1709
  1710         16  MA-ADDRESS-LINE-1             PIC X(30).
  1711         16  MA-ADDRESS-LINE-2             PIC X(30).
  1712         16  MA-CITY-STATE.
  1713             20  MA-CITY                   PIC X(28).
  1714             20  MA-ADDR-STATE             PIC XX.
  1715         16  MA-ZIP.
  1716             20  MA-ZIP-CODE.
  1717                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1718                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1719                 24  FILLER                PIC X(4).
  1720             20  MA-ZIP-PLUS4              PIC X(4).
  1721         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1722             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1723             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1724             20  FILLER                    PIC X(3).
  1725
  1726         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1727
  1728         16  FILLER                        PIC XXX.
  1729*        16  FILLER                        PIC X(10).
  1730
  1731     12  MA-CRED-BENE-INFO.
  1732         16  MA-CRED-BENE-NAME                 PIC X(25).
  1733         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1734         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1735         16  MA-CRED-BENE-CTYST.
  1736             20  MA-CRED-BENE-CITY             PIC X(28).
  1737             20  MA-CRED-BENE-STATE            PIC XX.
  1738         16  MA-CRED-BENE-ZIP.
  1739             20  MA-CB-ZIP-CODE.
  1740                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1741                     88  MA-CB-CANADIAN-POST-CODE
  1742                                           VALUE 'A' THRU 'Z'.
  1743                 24  FILLER                    PIC X(4).
  1744             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1745         16  MA-CB-CANADIAN-POSTAL-CODE
  1746                            REDEFINES MA-CRED-BENE-ZIP.
  1747             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1748             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1749             20  FILLER                        PIC X(3).
  1750     12  MA-POST-CARD-MAIL-DATA.
  1751         16  MA-MAIL-DATA OCCURS 7.
  1752             20  MA-MAIL-TYPE              PIC X.
  1753                 88  MA-12MO-MAILING           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  32
* NSRASBL.cbl
  1754                 88  MA-EXP-MAILING            VALUE '2'.
  1755             20  MA-MAIL-STATUS            PIC X.
  1756                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1757                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1758                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1759             20  MA-MAIL-DATE              PIC XX.
  1760     12  FILLER                            PIC XX.
  1761     12  FILLER                            PIC XX.
  1762*    12  FILLER                            PIC X(30).
  1763******************************************************************
  1764*                                COPY ERCCOMP.
  1765******************************************************************
  1766*                                                                *
  1767*                                                                *
  1768*                            ERCCOMP                             *
  1769*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1770*                            VMOD=2.019                          *
  1771*                                                                *
  1772*   ONLINE CREDIT SYSTEM                                         *
  1773*                                                                *
  1774*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1775*                                                                *
  1776*   FILE TYPE = VSAM,KSDS                                        *
  1777*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1778*                                                                *
  1779*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1780*       ALTERNATE PATH = NONE                                    *
  1781*                                                                *
  1782*   LOG = NO                                                     *
  1783*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1784*                                                                *
  1785******************************************************************
  1786*                   C H A N G E   L O G
  1787*
  1788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1789*-----------------------------------------------------------------
  1790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1791* EFFECTIVE    NUMBER
  1792*-----------------------------------------------------------------
  1793* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1794* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1795* 092205    2005050300006  PEMA  ADD LEASE FEE
  1796* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1797* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1798* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1799* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1800* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1801* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1802******************************************************************
  1803
  1804 01  COMPENSATION-MASTER.
  1805     12  CO-RECORD-ID                          PIC XX.
  1806         88  VALID-CO-ID                          VALUE 'CO'.
  1807
  1808     12  CO-CONTROL-PRIMARY.
  1809         16  CO-COMPANY-CD                     PIC X.
  1810         16  CO-CONTROL.
  1811             20  CO-CTL-1.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  33
* NSRASBL.cbl
  1812                 24  CO-CARR-GROUP.
  1813                     28  CO-CARRIER            PIC X.
  1814                     28  CO-GROUPING.
  1815                         32  CO-GROUP-PREFIX   PIC XXX.
  1816                         32  CO-GROUP-PRIME    PIC XXX.
  1817                 24  CO-RESP-NO.
  1818                     28  CO-RESP-PREFIX        PIC X(4).
  1819                     28  CO-RESP-PRIME         PIC X(6).
  1820             20  CO-CTL-2.
  1821                 24  CO-ACCOUNT.
  1822                     28  CO-ACCT-PREFIX        PIC X(4).
  1823                     28  CO-ACCT-PRIME         PIC X(6).
  1824         16  CO-TYPE                           PIC X.
  1825             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1826             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1827             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1828
  1829     12  CO-MAINT-INFORMATION.
  1830         16  CO-LAST-MAINT-DT                  PIC XX.
  1831         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1832         16  CO-LAST-MAINT-USER                PIC X(4).
  1833     12  FILLER                                PIC XX.
  1834     12  CO-STMT-TYPE                          PIC XXX.
  1835     12  CO-COMP-TYPE                          PIC X.
  1836         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1837     12  CO-STMT-OWNER                         PIC X(4).
  1838     12  CO-BALANCE-CONTROL                    PIC X.
  1839         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1840         88  CO-NO-BALANCE                        VALUE 'N'.
  1841
  1842     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1843         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1844         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1845         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1846
  1847     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1848         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1849         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1850
  1851     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1852     12  CO-GA-DIRECT-DEP                      PIC X.
  1853     12  CO-FUTURE-SPACE                       PIC X.
  1854         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1855
  1856     12  CO-ACCT-NAME                          PIC X(30).
  1857     12  CO-MAIL-NAME                          PIC X(30).
  1858     12  CO-ADDR-1                             PIC X(30).
  1859     12  CO-ADDR-2                             PIC X(30).
  1860     12  CO-ADDR-3.
  1861         16  CO-ADDR-CITY                      PIC X(27).
  1862         16  CO-ADDR-STATE                     PIC XX.
  1863     12  CO-CSO-1099                           PIC X.
  1864     12  CO-ZIP.
  1865         16  CO-ZIP-PRIME.
  1866             20  CO-ZIP-PRI-1ST                PIC X.
  1867                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1868             20  FILLER                        PIC X(4).
  1869         16  CO-ZIP-PLUS4                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  34
* NSRASBL.cbl
  1870     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1871         16  CO-CAN-POSTAL-1                   PIC XXX.
  1872         16  CO-CAN-POSTAL-2                   PIC XXX.
  1873         16  FILLER                            PIC XXX.
  1874     12  CO-SOC-SEC                            PIC X(13).
  1875     12  CO-TELEPHONE.
  1876         16  CO-AREA-CODE                      PIC XXX.
  1877         16  CO-PREFIX                         PIC XXX.
  1878         16  CO-PHONE                          PIC X(4).
  1879
  1880     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1881
  1882     12  CO-AR-BAL-LEVEL                       PIC X.
  1883         88  CO-AR-REF-LVL                        VALUE '1'.
  1884         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1885         88  CO-AR-BILL-LVL                       VALUE '2'.
  1886         88  CO-AR-AGT-LVL                        VALUE '3'.
  1887         88  CO-AR-FR-LVL                         VALUE '4'.
  1888
  1889     12  CO-AR-NORMAL-PRINT                    PIC X.
  1890         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1891         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1892
  1893     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1894
  1895     12  CO-AR-REPORTING                       PIC X.
  1896         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1897         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1898
  1899     12  CO-AR-PULL-CHECK                      PIC X.
  1900         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1901         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1902
  1903     12  CO-AR-BALANCE-PRINT                   PIC X.
  1904         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1905
  1906     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1907         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1908         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1909         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1910
  1911     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1912
  1913     12  CO-USER-CODE                          PIC X.
  1914     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1915
  1916******************************************************************
  1917*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1918*    THE LAST MONTH END RUN.
  1919******************************************************************
  1920
  1921     12  CO-LAST-ACTIVITY-DATE.
  1922         16  CO-ACT-YEAR                       PIC 99.
  1923         16  CO-ACT-MONTH                      PIC 99.
  1924         16  CO-ACT-DAY                        PIC 99.
  1925
  1926     12  CO-LAST-STMT-DT.
  1927         16  CO-LAST-STMT-YEAR                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  35
* NSRASBL.cbl
  1928         16  CO-LAST-STMT-MONTH                PIC 99.
  1929         16  CO-LAST-STMT-DAY                  PIC 99.
  1930
  1931     12  CO-MO-END-TOTALS.
  1932         16  CO-MONTHLY-TOTALS.
  1933             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1934             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1935             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1936             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1937             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1938
  1939         16  CO-AGING-TOTALS.
  1940             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1941             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1942             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1943             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1944
  1945         16  CO-YTD-TOTALS.
  1946             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1947             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1948
  1949         16  CO-OVER-UNDER-TOTALS.
  1950             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1951             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1952
  1953     12  CO-MISCELLANEOUS-TOTALS.
  1954         16  CO-FICA-TOTALS.
  1955             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1956             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1957
  1958         16  CO-CLAIM-TOTALS.
  1959             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1960             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1961
  1962******************************************************************
  1963*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1964*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1965******************************************************************
  1966
  1967     12  CO-CURRENT-TOTALS.
  1968         16  CO-CURRENT-LAST-STMT-DT.
  1969             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1970             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1971             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1972
  1973         16  CO-CURRENT-MONTHLY-TOTALS.
  1974             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1975             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1976             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1977             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1978             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1979
  1980         16  CO-CURRENT-AGING-TOTALS.
  1981             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1982             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1983             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1984             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1985
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  36
* NSRASBL.cbl
  1986         16  CO-CURRENT-YTD-TOTALS.
  1987             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1988             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1989
  1990     12  CO-PAID-COMM-TOTALS.
  1991         16  CO-YTD-PAID-COMMS.
  1992             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1993             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1994
  1995     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1996         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1997         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1998
  1999     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2000         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2001         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2002         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2003         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2004         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2005         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2006         88  CO-FINAL-LETTER                  VALUE 'F'.
  2007         88  CO-RECONCILING                   VALUE 'R'.
  2008         88  CO-PHONE-CALL                    VALUE 'P'.
  2009         88  CO-LEGAL                         VALUE 'L'.
  2010         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2011         88  CO-WRITE-OFF                     VALUE 'W'.
  2012         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2013
  2014     12  CO-CSR-CODE                       PIC X(4).
  2015
  2016     12  CO-GA-STATUS-INFO.
  2017         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2018         16  CO-GA-TERMINATION-DT          PIC XX.
  2019         16  CO-GA-STATUS-CODE             PIC X.
  2020             88  CO-GA-ACTIVE                 VALUE 'A'.
  2021             88  CO-GA-INACTIVE               VALUE 'I'.
  2022             88  CO-GA-PENDING                VALUE 'P'.
  2023         16  CO-GA-COMMENTS.
  2024             20  CO-GA-COMMENT-1           PIC X(40).
  2025             20  CO-GA-COMMENT-2           PIC X(40).
  2026             20  CO-GA-COMMENT-3           PIC X(40).
  2027             20  CO-GA-COMMENT-4           PIC X(40).
  2028
  2029     12  CO-RPTCD2                         PIC X(10).
  2030     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2031         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2032         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2033
  2034     12  CO-TYPE-AGENT                     PIC X(01).
  2035         88  CO-CORPORATION                   VALUE 'C'.
  2036         88  CO-PARTNERSHIP                   VALUE 'P'.
  2037         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2038         88  CO-TRUST                         VALUE 'T'.
  2039         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2040
  2041     12  CO-FAXNO.
  2042         16  CO-FAX-AREA-CODE                  PIC XXX.
  2043         16  CO-FAX-PREFIX                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  37
* NSRASBL.cbl
  2044         16  CO-FAX-PHONE                      PIC X(4).
  2045
  2046     12  CO-BANK-INFORMATION.
  2047         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2048         16  CO-BANK-TRANSIT-NON REDEFINES
  2049             CO-BANK-TRANSIT-NO                PIC 9(8).
  2050
  2051         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2052     12  CO-MISC-DEDUCT-INFO REDEFINES
  2053                  CO-BANK-INFORMATION.
  2054         16  CO-MD-GL-ACCT                     PIC X(10).
  2055         16  CO-MD-DIV                         PIC XX.
  2056         16  CO-MD-CENTER                      PIC X(4).
  2057         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2058         16  CO-CREATE-AP-CHECK                PIC X.
  2059         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2060         16  FILLER                            PIC XXX.
  2061     12  CO-ACH-STATUS                         PIC X.
  2062         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2063         88  CO-ACH-PENDING                        VALUE 'P'.
  2064
  2065     12  CO-BILL-SW                            PIC X.
  2066     12  CO-CONTROL-NAME                       PIC X(30).
  2067     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2068     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2069     12  CO-CLP-STATE                          PIC XX.
  2070     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2071     12  CO-SPP-REFUND-EDIT                    PIC X.
  2072
  2073******************************************************************
  2074*                                COPY ELCCERT.
  2075******************************************************************
  2076*                                                                *
  2077*                            ELCCERT.                            *
  2078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2079*                            VMOD=2.013                          *
  2080*                                                                *
  2081*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2082*                                                                *
  2083*   FILE TYPE = VSAM,KSDS                                        *
  2084*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2085*                                                                *
  2086*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2087*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2088*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2089*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2090*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2091*                                                                *
  2092*   LOG = YES                                                    *
  2093*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2094******************************************************************
  2095*                   C H A N G E   L O G
  2096*
  2097* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2098*-----------------------------------------------------------------
  2099*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2100* EFFECTIVE    NUMBER
  2101*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  38
* NSRASBL.cbl
  2102* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2103* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2104* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2105* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2106* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2107* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2109* 032612  CR2011110200001  PEMA  AHL CHANGES
  2110******************************************************************
  2111
  2112 01  CERTIFICATE-MASTER.
  2113     12  CM-RECORD-ID                      PIC XX.
  2114         88  VALID-CM-ID                      VALUE 'CM'.
  2115
  2116     12  CM-CONTROL-PRIMARY.
  2117         16  CM-COMPANY-CD                 PIC X.
  2118         16  CM-CARRIER                    PIC X.
  2119         16  CM-GROUPING.
  2120             20  CM-GROUPING-PREFIX        PIC X(3).
  2121             20  CM-GROUPING-PRIME         PIC X(3).
  2122         16  CM-STATE                      PIC XX.
  2123         16  CM-ACCOUNT.
  2124             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2125             20  CM-ACCOUNT-PRIME          PIC X(6).
  2126         16  CM-CERT-EFF-DT                PIC XX.
  2127         16  CM-CERT-NO.
  2128             20  CM-CERT-PRIME             PIC X(10).
  2129             20  CM-CERT-SFX               PIC X.
  2130
  2131     12  CM-CONTROL-BY-NAME.
  2132         16  CM-COMPANY-CD-A1              PIC X.
  2133         16  CM-INSURED-LAST-NAME          PIC X(15).
  2134         16  CM-INSURED-INITIALS.
  2135             20  CM-INSURED-INITIAL1       PIC X.
  2136             20  CM-INSURED-INITIAL2       PIC X.
  2137
  2138     12  CM-CONTROL-BY-SSN.
  2139         16  CM-COMPANY-CD-A2              PIC X.
  2140         16  CM-SOC-SEC-NO.
  2141             20  CM-SSN-STATE              PIC XX.
  2142             20  CM-SSN-ACCOUNT            PIC X(6).
  2143             20  CM-SSN-LN3.
  2144                 25  CM-INSURED-INITIALS-A2.
  2145                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2146                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2147                 25 CM-PART-LAST-NAME-A2         PIC X.
  2148
  2149     12  CM-CONTROL-BY-CERT-NO.
  2150         16  CM-COMPANY-CD-A4              PIC X.
  2151         16  CM-CERT-NO-A4                 PIC X(11).
  2152
  2153     12  CM-CONTROL-BY-MEMB.
  2154         16  CM-COMPANY-CD-A5              PIC X.
  2155         16  CM-MEMBER-NO.
  2156             20  CM-MEMB-STATE             PIC XX.
  2157             20  CM-MEMB-ACCOUNT           PIC X(6).
  2158             20  CM-MEMB-LN4.
  2159                 25  CM-INSURED-INITIALS-A5.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  39
* NSRASBL.cbl
  2160                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2161                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2162                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2163
  2164     12  CM-INSURED-PROFILE-DATA.
  2165         16  CM-INSURED-FIRST-NAME.
  2166             20  CM-INSURED-1ST-INIT       PIC X.
  2167             20  FILLER                    PIC X(9).
  2168         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2169         16  CM-INSURED-SEX                PIC X.
  2170             88  CM-SEX-MALE                  VALUE 'M'.
  2171             88  CM-SEX-FEMAL                 VALUE 'F'.
  2172         16  CM-INSURED-JOINT-AGE          PIC 99.
  2173         16  CM-JOINT-INSURED-NAME.
  2174             20  CM-JT-LAST-NAME           PIC X(15).
  2175             20  CM-JT-FIRST-NAME.
  2176                 24  CM-JT-1ST-INIT        PIC X.
  2177                 24  FILLER                PIC X(9).
  2178             20  CM-JT-INITIAL             PIC X.
  2179
  2180     12  CM-LIFE-DATA.
  2181         16  CM-LF-BENEFIT-CD              PIC XX.
  2182         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2183         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2184         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2185         16  CM-LF-DEV-CODE                PIC XXX.
  2186         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2187         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2188         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2189         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2190         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2191         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2192         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2193         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2194         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2195         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2196         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2197         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2198         16  FILLER                        PIC XX.
  2199
  2200     12  CM-AH-DATA.
  2201         16  CM-AH-BENEFIT-CD              PIC XX.
  2202         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2203         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2204         16  CM-AH-DEV-CODE                PIC XXX.
  2205         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2206         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2207         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2208         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2209         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2210         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2211         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2212         16  CM-AH-PAID-THRU-DT            PIC XX.
  2213             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2214         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2215         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2216         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2217         16  FILLER                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  40
* NSRASBL.cbl
  2218
  2219     12  CM-LOAN-INFORMATION.
  2220         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2221         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2222                                           PIC S9(5)V99  COMP-3.
  2223         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2224         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2225         16  CM-PAY-FREQUENCY              PIC S99.
  2226         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2227         16  CM-RATE-CLASS                 PIC XX.
  2228         16  CM-BENEFICIARY                PIC X(25).
  2229         16  CM-POLICY-FORM-NO             PIC X(12).
  2230         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2231         16  CM-LAST-ADD-ON-DT             PIC XX.
  2232         16  CM-DEDUCTIBLE-AMOUNTS.
  2233             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2234             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2235         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2236             20  CM-RESIDENT-STATE         PIC XX.
  2237             20  CM-RATE-CODE              PIC X(4).
  2238             20  FILLER                    PIC XX.
  2239         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2240             20  CM-LOAN-OFFICER           PIC X(5).
  2241             20  FILLER                    PIC XXX.
  2242         16  CM-CSR-CODE                   PIC XXX.
  2243         16  CM-UNDERWRITING-CODE          PIC X.
  2244             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2245         16  CM-POST-CARD-IND              PIC X.
  2246         16  CM-NH-INTERFACE-SW            PIC X.
  2247         16  CM-PREMIUM-TYPE               PIC X.
  2248             88  CM-SING-PRM                  VALUE '1'.
  2249             88  CM-O-B-COVERAGE              VALUE '2'.
  2250             88  CM-OPEN-END                  VALUE '3'.
  2251         16  CM-IND-GRP-TYPE               PIC X.
  2252             88  CM-INDIVIDUAL                VALUE 'I'.
  2253             88  CM-GROUP                     VALUE 'G'.
  2254         16  CM-SKIP-CODE                  PIC X.
  2255             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2256             88  SKIP-JULY                    VALUE '1'.
  2257             88  SKIP-AUGUST                  VALUE '2'.
  2258             88  SKIP-SEPTEMBER               VALUE '3'.
  2259             88  SKIP-JULY-AUG                VALUE '4'.
  2260             88  SKIP-AUG-SEPT                VALUE '5'.
  2261             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2262             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2263             88  SKIP-JUNE                    VALUE '8'.
  2264             88  SKIP-JUNE-JULY               VALUE '9'.
  2265             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2266             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2267         16  CM-PAYMENT-MODE               PIC X.
  2268             88  PAY-MONTHLY                  VALUE SPACE.
  2269             88  PAY-WEEKLY                   VALUE '1'.
  2270             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2271             88  PAY-BI-WEEKLY                VALUE '3'.
  2272             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2273         16  CM-LOAN-NUMBER                PIC X(8).
  2274         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2275         16  CM-OLD-LOF                    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  41
* NSRASBL.cbl
  2276*        16  CM-LOAN-OFFICER               PIC XXX.
  2277         16  CM-REIN-TABLE                 PIC XXX.
  2278         16  CM-SPECIAL-REIN-CODE          PIC X.
  2279         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2280         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2281         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2282
  2283     12  CM-STATUS-DATA.
  2284         16  CM-ENTRY-STATUS               PIC X.
  2285         16  CM-ENTRY-DT                   PIC XX.
  2286
  2287         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2288         16  CM-LF-CANCEL-DT               PIC XX.
  2289         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2290
  2291         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2292         16  CM-LF-DEATH-DT                PIC XX.
  2293         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2294
  2295         16  CM-LF-CURRENT-STATUS          PIC X.
  2296             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2297                                                'M' '4' '5' '9'.
  2298             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2299             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2300             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2301             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2302             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2303             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2304             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2305             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2306             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2307             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2308             88  CM-LF-DECLINED               VALUE 'D'.
  2309             88  CM-LF-VOIDED                 VALUE 'V'.
  2310
  2311         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2312         16  CM-AH-CANCEL-DT               PIC XX.
  2313         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2314
  2315         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2316         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2317         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2318
  2319         16  CM-AH-CURRENT-STATUS          PIC X.
  2320             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2321                                                'M' '4' '5' '9'.
  2322             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2323             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2324             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2325             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2326             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2327             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2328             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2329             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2330             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2331             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2332             88  CM-AH-DECLINED               VALUE 'D'.
  2333             88  CM-AH-VOIDED                 VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  42
* NSRASBL.cbl
  2334
  2335         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2336             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2337             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2338             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2339         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2340
  2341         16  CM-ENTRY-BATCH                PIC X(6).
  2342         16  CM-LF-EXIT-BATCH              PIC X(6).
  2343         16  CM-AH-EXIT-BATCH              PIC X(6).
  2344         16  CM-LAST-MONTH-END             PIC XX.
  2345
  2346     12  CM-NOTE-SW                        PIC X.
  2347         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2348         88  CERT-NOTES-PRESENT               VALUE '1'.
  2349         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2350         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2351         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2352         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2353         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2354         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2355     12  CM-COMP-EXCP-SW                   PIC X.
  2356         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2357         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2358     12  CM-INSURED-ADDRESS-SW             PIC X.
  2359         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2360         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2361
  2362*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2363     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2364     12  FILLER                            PIC X.
  2365
  2366*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2367     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2368     12  FILLER                            PIC X.
  2369*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2370     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2371
  2372     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2373         88  CERT-ADDED-BATCH                 VALUE ' '.
  2374         88  CERT-ADDED-ONLINE                VALUE '1'.
  2375         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2376         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2377         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2378     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2379         88  CERT-AS-LOADED                   VALUE ' '.
  2380         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2381         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2382         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2383         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2384         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2385         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2386         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2387
  2388     12  CM-ACCOUNT-COMM-PCTS.
  2389         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2390         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2391
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  43
* NSRASBL.cbl
  2392     12  CM-USER-FIELD                     PIC X.
  2393     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2394     12  CM-CLP-STATE                      PIC XX.
  2395     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2396     12  CM-USER-RESERVED                  PIC XXX.
  2397     12  FILLER REDEFINES CM-USER-RESERVED.
  2398         16  CM-AH-CLASS-CD                PIC XX.
  2399         16  F                             PIC X.
  2400******************************************************************
  2401*                                COPY ELCCRTO.
  2402******************************************************************
  2403*                                                                *
  2404*                            ELCCRTO.                            *
  2405*                                                                *
  2406*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2407*                                                                *
  2408*   FILE TYPE = VSAM,KSDS                                        *
  2409*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2410*                                                                *
  2411*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2412*                                                                *
  2413*   LOG = YES                                                    *
  2414*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2415******************************************************************
  2416*                   C H A N G E   L O G
  2417*
  2418* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2419*-----------------------------------------------------------------
  2420*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2421* EFFECTIVE    NUMBER
  2422*-----------------------------------------------------------------
  2423* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2424* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2425* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2426* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2427* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2428******************************************************************
  2429 01  ORIGINAL-CERTIFICATE.
  2430     12  OC-RECORD-ID                      PIC XX.
  2431         88  VALID-OC-ID                      VALUE 'OC'.
  2432     12  OC-CONTROL-PRIMARY.
  2433         16  OC-COMPANY-CD                 PIC X.
  2434         16  OC-CARRIER                    PIC X.
  2435         16  OC-GROUPING                   PIC X(6).
  2436         16  OC-STATE                      PIC XX.
  2437         16  OC-ACCOUNT                    PIC X(10).
  2438         16  OC-CERT-EFF-DT                PIC XX.
  2439         16  OC-CERT-NO.
  2440             20  OC-CERT-PRIME             PIC X(10).
  2441             20  OC-CERT-SFX               PIC X.
  2442         16  OC-RECORD-TYPE                PIC X.
  2443         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2444     12  OC-LAST-MAINT-DT                  PIC XX.
  2445     12  OC-LAST-MAINT-BY                  PIC X(4).
  2446     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2447     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2448     12  FILLER                            PIC X(49).
  2449     12  OC-ORIG-REC.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  44
* NSRASBL.cbl
  2450         16  OC-INS-LAST-NAME              PIC X(15).
  2451         16  OC-INS-FIRST-NAME             PIC X(10).
  2452         16  OC-INS-MIDDLE-INIT            PIC X.
  2453         16  OC-INS-AGE                    PIC S999     COMP-3.
  2454         16  OC-JNT-LAST-NAME              PIC X(15).
  2455         16  OC-JNT-FIRST-NAME             PIC X(10).
  2456         16  OC-JNT-MIDDLE-INIT            PIC X.
  2457         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2458         16  OC-LF-BENCD                   PIC XX.
  2459         16  OC-LF-TERM                    PIC S999      COMP-3.
  2460         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2461         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2462         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2463         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2464         16  OC-LF-EXP-DT                  PIC XX.
  2465         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2466         16  OC-LF-CANCEL-DT               PIC XX.
  2467         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2468         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2469         16  OC-AH-BENCD                   PIC XX.
  2470         16  OC-AH-TERM                    PIC S999      COMP-3.
  2471         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2472         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2473         16  OC-AH-EXP-DT                  PIC XX.
  2474         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2475         16  OC-AH-CP                      PIC 99.
  2476         16  OC-AH-CANCEL-DT               PIC XX.
  2477         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2478         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2479         16  OC-CRED-BENE-NAME             PIC X(25).
  2480         16  OC-1ST-PMT-DT                 PIC XX.
  2481         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  2482         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2483         16  OC-ISSUE-TRAN-IND             PIC X.
  2484         16  OC-CANCEL-TRAN-IND            PIC X.
  2485         16  FILLER                        PIC X(211).
  2486
  2487     12  FILLER                            PIC X(50).
  2488******************************************************************
  2489*                                COPY ERCACCT.
  2490******************************************************************
  2491*                                                                *
  2492*                                                                *
  2493*                            ERCACCT                             *
  2494*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2495*                            VMOD=2.031                          *
  2496*                                                                *
  2497*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2498*                                                                *
  2499*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2500*   VSAM ACCOUNT MASTER FILES.                                   *
  2501*                                                                *
  2502*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2503*                                                                *
  2504*   FILE TYPE = VSAM,KSDS                                        *
  2505*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2506*                                                                *
  2507*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  45
* NSRASBL.cbl
  2508*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2509*                                                                *
  2510*   LOG = NO                                                     *
  2511*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2512*                                                                *
  2513*                                                                *
  2514******************************************************************
  2515*                   C H A N G E   L O G
  2516*
  2517* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2518*-----------------------------------------------------------------
  2519*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2520* EFFECTIVE    NUMBER
  2521*-----------------------------------------------------------------
  2522* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2523* 092705    2005050300006  PEMA  ADD SPP LEASES
  2524* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2525* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2526* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2527* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2528* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2529******************************************************************
  2530
  2531 01  ACCOUNT-MASTER.
  2532     12  AM-RECORD-ID                      PIC XX.
  2533         88  VALID-AM-ID                      VALUE 'AM'.
  2534
  2535     12  AM-CONTROL-PRIMARY.
  2536         16  AM-COMPANY-CD                 PIC X.
  2537         16  AM-MSTR-CNTRL.
  2538             20  AM-CONTROL-A.
  2539                 24  AM-CARRIER            PIC X.
  2540                 24  AM-GROUPING.
  2541                     28 AM-GROUPING-PREFIX PIC XXX.
  2542                     28 AM-GROUPING-PRIME  PIC XXX.
  2543                 24  AM-STATE              PIC XX.
  2544                 24  AM-ACCOUNT.
  2545                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2546                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2547             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2548                                           PIC X(19).
  2549             20  AM-CNTRL-B.
  2550                 24  AM-EXPIRATION-DT      PIC XX.
  2551                 24  FILLER                PIC X(4).
  2552             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2553                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2554
  2555     12  AM-CONTROL-BY-VAR-GRP.
  2556         16  AM-COMPANY-CD-A1              PIC X.
  2557         16  AM-VG-CARRIER                 PIC X.
  2558         16  AM-VG-GROUPING                PIC X(6).
  2559         16  AM-VG-STATE                   PIC XX.
  2560         16  AM-VG-ACCOUNT                 PIC X(10).
  2561         16  AM-VG-DATE.
  2562             20  AM-VG-EXPIRATION-DT       PIC XX.
  2563             20  FILLER                    PIC X(4).
  2564         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2565                                           PIC 9(11)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  46
* NSRASBL.cbl
  2566     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2567         16  FILLER                        PIC X(10).
  2568         16  AM-VG-KEY3.
  2569             20  AM-VG3-ACCOUNT            PIC X(10).
  2570             20  AM-VG3-EXP-DT             PIC XX.
  2571         16  FILLER                        PIC X(4).
  2572     12  AM-MAINT-INFORMATION.
  2573         16  AM-LAST-MAINT-DT              PIC XX.
  2574         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2575         16  AM-LAST-MAINT-USER            PIC X(4).
  2576         16  FILLER                        PIC XX.
  2577
  2578     12  AM-EFFECTIVE-DT                   PIC XX.
  2579     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2580
  2581     12  AM-PREV-DATES  COMP-3.
  2582         16  AM-PREV-EXP-DT                PIC 9(11).
  2583         16  AM-PREV-EFF-DT                PIC 9(11).
  2584
  2585     12  AM-REPORT-CODE-1                  PIC X(10).
  2586     12  AM-REPORT-CODE-2                  PIC X(10).
  2587
  2588     12  AM-CITY-CODE                      PIC X(4).
  2589     12  AM-COUNTY-PARISH                  PIC X(6).
  2590
  2591     12  AM-NAME                           PIC X(30).
  2592     12  AM-PERSON                         PIC X(30).
  2593     12  AM-ADDRS                          PIC X(30).
  2594     12  AM-CITY.
  2595         16  AM-ADDR-CITY                  PIC X(28).
  2596         16  AM-ADDR-STATE                 PIC XX.
  2597     12  AM-ZIP.
  2598         16  AM-ZIP-PRIME.
  2599             20  AM-ZIP-PRI-1ST            PIC X.
  2600                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2601             20  FILLER                    PIC X(4).
  2602         16  AM-ZIP-PLUS4                  PIC X(4).
  2603     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2604         16  AM-CAN-POSTAL-1               PIC XXX.
  2605         16  AM-CAN-POSTAL-2               PIC XXX.
  2606         16  FILLER                        PIC XXX.
  2607     12  AM-TEL-NO.
  2608         16  AM-AREA-CODE                  PIC 999.
  2609         16  AM-TEL-PRE                    PIC 999.
  2610         16  AM-TEL-NBR                    PIC 9(4).
  2611     12  AM-TEL-LOC                        PIC X.
  2612         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2613         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2614
  2615     12  AM-COMM-STRUCTURE.
  2616         16  AM-DEFN-1.
  2617             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2618                 24  AM-AGT.
  2619                     28  AM-AGT-PREFIX     PIC X(4).
  2620                     28  AM-AGT-PRIME      PIC X(6).
  2621                 24  AM-COM-TYP            PIC X.
  2622                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2623                 24  AM-J-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  47
* NSRASBL.cbl
  2624                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2625                 24  AM-RECALC-LV-INDIC    PIC X.
  2626                 24  AM-RETRO-LV-INDIC     PIC X.
  2627                 24  AM-GL-CODES           PIC X.
  2628                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2629                 24  FILLER                PIC X(01).
  2630         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2631             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2632                 24  FILLER                PIC X(11).
  2633                 24  AM-L-COMA             PIC XXX.
  2634                 24  AM-J-COMA             PIC XXX.
  2635                 24  AM-A-COMA             PIC XXX.
  2636                 24  FILLER                PIC X(6).
  2637
  2638     12  AM-COMM-CHANGE-STATUS             PIC X.
  2639         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2640
  2641     12  AM-CSR-CODE                       PIC X(4).
  2642
  2643     12  AM-BILLING-STATUS                 PIC X.
  2644         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2645         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2646     12  AM-AUTO-REFUND-SW                 PIC X.
  2647         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2648         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2649     12  AM-GPCD                           PIC 99.
  2650     12  AM-IG                             PIC X.
  2651         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2652         88  AM-HAS-GROUP                     VALUE '2'.
  2653     12  AM-STATUS                         PIC X.
  2654         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2655         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2656         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2657         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2658         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2659         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2660     12  AM-REMIT-TO                       PIC 99.
  2661     12  AM-ID-NO                          PIC X(11).
  2662
  2663     12  AM-CAL-TABLE                      PIC XX.
  2664     12  AM-LF-DEVIATION                   PIC XXX.
  2665     12  AM-AH-DEVIATION                   PIC XXX.
  2666     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2667     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2668     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2669     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2670     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2671     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2672
  2673     12  AM-USER-FIELDS.
  2674         16  AM-FLD-1                      PIC XX.
  2675         16  AM-FLD-2                      PIC XX.
  2676         16  AM-FLD-3                      PIC XX.
  2677         16  AM-FLD-4                      PIC XX.
  2678         16  AM-FLD-5                      PIC XX.
  2679
  2680     12  AM-1ST-PROD-DATE.
  2681         16  AM-1ST-PROD-YR                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  48
* NSRASBL.cbl
  2682         16  AM-1ST-PROD-MO                PIC XX.
  2683         16  AM-1ST-PROD-DA                PIC XX.
  2684     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2685     12  AM-CERTS-PURGED-DATE.
  2686         16  AM-PUR-YR                     PIC XX.
  2687         16  AM-PUR-MO                     PIC XX.
  2688         16  AM-PUR-DA                     PIC XX.
  2689     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2690     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2691     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2692     12  AM-INACTIVE-DATE.
  2693         16  AM-INA-MO                     PIC 99.
  2694         16  AM-INA-DA                     PIC 99.
  2695         16  AM-INA-YR                     PIC 99.
  2696     12  AM-AR-HI-CERT-DATE                PIC XX.
  2697
  2698     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2699     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2700
  2701     12  AM-OB-PAYMENT-MODE                PIC X.
  2702         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2703         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2704         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2705         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2706
  2707     12  AM-AH-ONLY-INDICATOR              PIC X.
  2708         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2709         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2710
  2711     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2712
  2713     12  AM-OVER-SHORT.
  2714         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2715         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2716
  2717     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2718     12  AM-DCC-CLP-STATE                  PIC XX.
  2719
  2720     12  AM-RECALC-COMM                    PIC X.
  2721     12  AM-RECALC-REIN                    PIC X.
  2722
  2723     12  AM-REI-TABLE                      PIC XXX.
  2724     12  AM-REI-ET-LF                      PIC X.
  2725     12  AM-REI-ET-AH                      PIC X.
  2726     12  AM-REI-PE-LF                      PIC X.
  2727     12  AM-REI-PE-AH                      PIC X.
  2728     12  AM-REI-PRT-ST                     PIC X.
  2729     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2730     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2731     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2732     12  AM-REI-GROUP-A                    PIC X(6).
  2733     12  AM-REI-MORT                       PIC X(4).
  2734     12  AM-REI-PRT-OW                     PIC X.
  2735     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2736     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2737     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2738     12  AM-REI-GROUP-B                    PIC X(6).
  2739
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  49
* NSRASBL.cbl
  2740     12  AM-TRUST-TYPE                     PIC X(2).
  2741
  2742     12  AM-EMPLOYER-STMT-USED             PIC X.
  2743     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2744
  2745     12  AM-STD-AH-TYPE                    PIC XX.
  2746     12  AM-EARN-METHODS.
  2747         16  AM-EARN-METHOD-R              PIC X.
  2748             88 AM-REF-RL-R78                 VALUE 'R'.
  2749             88 AM-REF-RL-PR                  VALUE 'P'.
  2750             88 AM-REF-RL-MEAN                VALUE 'M'.
  2751             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2752         16  AM-EARN-METHOD-L              PIC X.
  2753             88 AM-REF-LL-R78                 VALUE 'R'.
  2754             88 AM-REF-LL-PR                  VALUE 'P'.
  2755             88 AM-REF-LL-MEAN                VALUE 'M'.
  2756             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2757         16  AM-EARN-METHOD-A              PIC X.
  2758             88 AM-REF-AH-R78                 VALUE 'R'.
  2759             88 AM-REF-AH-PR                  VALUE 'P'.
  2760             88 AM-REF-AH-MEAN                VALUE 'M'.
  2761             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2762             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2763             88 AM-REF-AH-NET                 VALUE 'N'.
  2764
  2765     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2766     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2767     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2768
  2769     12  AM-RET-Y-N                        PIC X.
  2770     12  AM-RET-P-E                        PIC X.
  2771     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2772     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2773     12  AM-RET-GRP                        PIC X(6).
  2774     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2775         16  AM-POOL-PRIME                 PIC XXX.
  2776         16  AM-POOL-SUB                   PIC XXX.
  2777     12  AM-RETRO-EARNINGS.
  2778         16  AM-RET-EARN-R                 PIC X.
  2779         16  AM-RET-EARN-L                 PIC X.
  2780         16  AM-RET-EARN-A                 PIC X.
  2781     12  AM-RET-ST-TAX-USE                 PIC X.
  2782         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2783         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2784     12  AM-RETRO-BEG-EARNINGS.
  2785         16  AM-RET-BEG-EARN-R             PIC X.
  2786         16  AM-RET-BEG-EARN-L             PIC X.
  2787         16  AM-RET-BEG-EARN-A             PIC X.
  2788     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2789     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2790
  2791     12  AM-USER-SELECT-OPTIONS.
  2792         16  AM-USER-SELECT-1              PIC X(10).
  2793         16  AM-USER-SELECT-2              PIC X(10).
  2794         16  AM-USER-SELECT-3              PIC X(10).
  2795         16  AM-USER-SELECT-4              PIC X(10).
  2796         16  AM-USER-SELECT-5              PIC X(10).
  2797
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  50
* NSRASBL.cbl
  2798     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2799
  2800     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2801
  2802     12  AM-RPT045A-SWITCH                 PIC X.
  2803         88  RPT045A-OFF                   VALUE 'N'.
  2804
  2805     12  AM-INSURANCE-LIMITS.
  2806         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2807         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2808
  2809     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2810         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2811
  2812     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2813         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2814         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2815
  2816     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2817
  2818     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2819     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2820     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2821     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2822     12  AM-DCC-UEF-STATE                  PIC XX.
  2823     12  FILLER                            PIC XXX.
  2824     12  AM-REPORT-CODE-3                  PIC X(10).
  2825*    12  FILLER                            PIC X(22).
  2826
  2827     12  AM-RESERVE-DATE.
  2828         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2829         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2830         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2831
  2832     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2833     12  AM-NOTIFICATION-TYPES.
  2834         16  AM-NOTIF-OF-LETTERS           PIC X.
  2835         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2836         16  AM-NOTIF-OF-REPORTS           PIC X.
  2837         16  AM-NOTIF-OF-STATUS            PIC X.
  2838
  2839     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2840         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2841         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2842         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2843         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2844
  2845     12  AM-BENEFIT-CONTROLS.
  2846         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2847             20  AM-BENEFIT-CODE           PIC XX.
  2848             20  AM-BENEFIT-TYPE           PIC X.
  2849             20  AM-BENEFIT-REVISION       PIC XXX.
  2850             20  AM-BENEFIT-REM-TERM       PIC X.
  2851             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2852             20  FILLER                    PIC XX.
  2853         16  FILLER                        PIC X(80).
  2854
  2855     12  AM-TRANSFER-DATA.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  51
* NSRASBL.cbl
  2856         16  AM-TRANSFERRED-FROM.
  2857             20  AM-TRNFROM-CARRIER        PIC X.
  2858             20  AM-TRNFROM-GROUPING.
  2859                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2860                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2861             20  AM-TRNFROM-STATE          PIC XX.
  2862             20  AM-TRNFROM-ACCOUNT.
  2863                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2864                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2865             20  AM-TRNFROM-DTE            PIC XX.
  2866         16  AM-TRANSFERRED-TO.
  2867             20  AM-TRNTO-CARRIER          PIC X.
  2868             20  AM-TRNTO-GROUPING.
  2869                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2870                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2871             20  AM-TRNTO-STATE            PIC XX.
  2872             20  AM-TRNTO-ACCOUNT.
  2873                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2874                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2875             20  AM-TRNTO-DTE              PIC XX.
  2876         16  FILLER                        PIC X(10).
  2877
  2878     12  AM-SAVED-REMIT-TO                 PIC 99.
  2879
  2880     12  AM-COMM-STRUCTURE-SAVED.
  2881         16  AM-DEFN-1-SAVED.
  2882             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2883                 24  AM-AGT-SV             PIC X(10).
  2884                 24  AM-COM-TYP-SV         PIC X.
  2885                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2886                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2887                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2888                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2889                 24  FILLER                PIC X.
  2890                 24  AM-GL-CODES-SV        PIC X.
  2891                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2892                 24  FILLER                PIC X.
  2893         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2894             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2895                 24  FILLER                PIC X(11).
  2896                 24  AM-L-COMA-SV          PIC XXX.
  2897                 24  AM-J-COMA-SV          PIC XXX.
  2898                 24  AM-A-COMA-SV          PIC XXX.
  2899                 24  FILLER                PIC X(6).
  2900
  2901     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2902         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2903            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2904            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2905            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2906
  2907     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2908     12  FILLER                            PIC X(120).
  2909
  2910     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2911         16  AM-CONTROL-NAME               PIC X(30).
  2912         16  AM-EXECUTIVE-ONE.
  2913             20  AM-EXEC1-NAME             PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  52
* NSRASBL.cbl
  2914             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2915                                                          COMP-3.
  2916             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2917                                                          COMP-3.
  2918         16  AM-EXECUTIVE-TWO.
  2919             20  AM-EXEC2-NAME             PIC X(15).
  2920             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2921                                                          COMP-3.
  2922             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2923                                                          COMP-3.
  2924
  2925     12  AM-RETRO-ADDITIONAL-DATA.
  2926         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2927         16  AM-RETRO-PREM-P-E             PIC X.
  2928         16  AM-RETRO-CLMS-P-I             PIC X.
  2929         16  AM-RETRO-RET-BRACKET-LF.
  2930             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2931                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2932                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2933             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2934                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2935                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2936             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2937                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2938                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2939         16  AM-RETRO-RET-BRACKET-AH.
  2940             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2941                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2942                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2943                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2944             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2945                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2946                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2947             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2948                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2949                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2950
  2951     12  AM-COMMENTS.
  2952         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2953
  2954     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2955         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2956         16  AM-FLI-BILLING-CODE           PIC X.
  2957         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2958         16  AM-FLI-UNITED-IDENT           PIC X.
  2959         16  AM-FLI-INTEREST-LOST-DATA.
  2960             20  AM-FLI-BANK-NO            PIC X(5).
  2961             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2962             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2963             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2964         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2965             20  AM-FLI-AGT                PIC X(9).
  2966             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2967             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2968         16  FILLER                        PIC X(102).
  2969
  2970     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2971         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  53
* NSRASBL.cbl
  2972             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2973             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2974             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2975             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2976             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2977         16  FILLER                          PIC X(10).
  2978******************************************************************
  2979*                                COPY ELCTEXT.
  2980******************************************************************
  2981*                                                                *
  2982*                                                                *
  2983*                            ELCTEXT.                            *
  2984*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2985*                            VMOD=2.008                          *
  2986*                                                                *
  2987*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2988*                                     FORM LETTERS,              *
  2989*                                     CERT FORM DISPLAY.
  2990*                                                                *
  2991*   FILE TYPE = VSAM,KSDS                                        *
  2992*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2993*                                                                *
  2994*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2995*       ALTERNATE INDEX = NONE                                   *
  2996*                                                                *
  2997*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2998*       ALTERNATE INDEX = NONE                                   *
  2999*                                                                *
  3000*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3001*       ALTERNATE INDEX = NONE                                   *
  3002*                                                                *
  3003*   LOG = NO                                                     *
  3004*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3005******************************************************************
  3006 01  TEXT-FILES.
  3007     12  TEXT-FILE-ID                PIC XX.
  3008         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3009         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3010         88  HELP-FILE-TEXT             VALUE 'TH'.
  3011
  3012     12  TX-CONTROL-PRIMARY.
  3013         16  TX-COMPANY-CD           PIC X.
  3014             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3015         16  TX-ACCESS-CD-GENL       PIC X(12).
  3016
  3017         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3018             20  TX-LETTER-NO        PIC X(4).
  3019             20  FILLER              PIC X(8).
  3020
  3021         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3022             20  TX-FORM-NO          PIC X(12).
  3023
  3024         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3025             20  TX-HELP-TYPE        PIC X.
  3026                 88  HELP-FOR-GENERAL   VALUE ' '.
  3027                 88  HELP-BY-SCREEN     VALUE 'S'.
  3028                 88  HELP-BY-ERROR      VALUE 'E'.
  3029             20  TX-SCREEN-OR-ERROR  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  54
* NSRASBL.cbl
  3030                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3031             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3032                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3033             20  FILLER              PIC X(4).
  3034
  3035         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3036
  3037     12  TX-PROCESS-CONTROL          PIC XX.
  3038         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3039
  3040     12  TX-TEXT-LINE                PIC X(70).
  3041
  3042     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3043         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3044         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3045         88  TX-VALID-FORM-SQUEEZE-VALUE
  3046                                        VALUE 'Y' ' '.
  3047
  3048     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3049         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3050         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3051         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3052         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3053         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3054         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3055         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3056                                              'K' 'N' ' '
  3057                                              'Z'.
  3058
  3059     12  TX-ARCHIVE-SW               PIC X.
  3060         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3061         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3062         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3063
  3064     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3065     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3066
  3067     12  TX-BSR-CODE                 PIC X.
  3068         88  TX-BSR-LETTER              VALUE 'B'.
  3069         88  TX-NON-BSR-LETTER          VALUE ' '.
  3070
  3071     12  FILLER                      PIC X.
  3072*****************************************************************
  3073*                                COPY ELCCNTL.
  3074******************************************************************
  3075*                                                                *
  3076*                                                                *
  3077*                            ELCCNTL.                            *
  3078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3079*                            VMOD=2.059                          *
  3080*                                                                *
  3081*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3082*                                                                *
  3083*   FILE TYPE = VSAM,KSDS                                        *
  3084*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3085*                                                                *
  3086*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3087*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  55
* NSRASBL.cbl
  3088*                                                                *
  3089*   LOG = YES                                                    *
  3090*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3091******************************************************************
  3092*                   C H A N G E   L O G
  3093*
  3094* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3095*-----------------------------------------------------------------
  3096*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3097* EFFECTIVE    NUMBER
  3098*-----------------------------------------------------------------
  3099* 082503                   PEMA  ADD BENEFIT GROUP
  3100* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3101* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3102* 092705    2005050300006  PEMA  ADD SPP LEASES
  3103* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3104* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3105* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3106* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3107* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3108* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3109* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3110* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3111* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3112******************************************************************
  3113*
  3114 01  CONTROL-FILE.
  3115     12  CF-RECORD-ID                       PIC XX.
  3116         88  VALID-CF-ID                        VALUE 'CF'.
  3117
  3118     12  CF-CONTROL-PRIMARY.
  3119         16  CF-COMPANY-ID                  PIC XXX.
  3120         16  CF-RECORD-TYPE                 PIC X.
  3121             88  CF-COMPANY-MASTER              VALUE '1'.
  3122             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3123             88  CF-STATE-MASTER                VALUE '3'.
  3124             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3125             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3126             88  CF-CARRIER-MASTER              VALUE '6'.
  3127             88  CF-MORTALITY-MASTER            VALUE '7'.
  3128             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3129             88  CF-TERMINAL-MASTER             VALUE '9'.
  3130             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3131             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3132             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3133             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3134             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3135             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3136             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3137             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3138             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3139         16  CF-ACCESS-CD-GENL              PIC X(4).
  3140         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3141             20  CF-PROCESSOR               PIC X(4).
  3142         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3143             20  CF-STATE-CODE              PIC XX.
  3144             20  FILLER                     PIC XX.
  3145         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  56
* NSRASBL.cbl
  3146             20  FILLER                     PIC XX.
  3147             20  CF-HI-BEN-IN-REC           PIC XX.
  3148         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3149             20  FILLER                     PIC XXX.
  3150             20  CF-CARRIER-CNTL            PIC X.
  3151         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3152             20  FILLER                     PIC XX.
  3153             20  CF-HI-TYPE-IN-REC          PIC 99.
  3154         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3155             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3156                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3157             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3158             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3159         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3160             20  FILLER                     PIC X.
  3161             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3162         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3163             20  FILLER                     PIC XX.
  3164             20  CF-MORTGAGE-PLAN           PIC XX.
  3165         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3166
  3167     12  CF-LAST-MAINT-DT                   PIC XX.
  3168     12  CF-LAST-MAINT-BY                   PIC X(4).
  3169     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3170
  3171     12  CF-RECORD-BODY                     PIC X(728).
  3172
  3173
  3174****************************************************************
  3175*             COMPANY MASTER RECORD                            *
  3176****************************************************************
  3177
  3178     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3179         16  CF-COMPANY-ADDRESS.
  3180             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3181             20  CF-CL-IN-CARE-OF           PIC X(30).
  3182             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3183             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3184             20  CF-CL-CITY-STATE           PIC X(30).
  3185             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3186             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3187         16  CF-COMPANY-CD                  PIC X.
  3188         16  CF-COMPANY-PASSWORD            PIC X(8).
  3189         16  CF-SECURITY-OPTION             PIC X.
  3190             88  ALL-SECURITY                   VALUE '1'.
  3191             88  COMPANY-VERIFY                 VALUE '2'.
  3192             88  PROCESSOR-VERIFY               VALUE '3'.
  3193             88  NO-SECURITY                    VALUE '4'.
  3194             88  ALL-BUT-TERM                   VALUE '5'.
  3195         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3196             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3197         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3198             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3199         16  CF-INFORCE-LOCATION            PIC X.
  3200             88  CERTS-ARE-ONLINE               VALUE '1'.
  3201             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3202             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3203         16  CF-LOWER-CASE-LETTERS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  57
* NSRASBL.cbl
  3204         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3205             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3206             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3207             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3208             88  CF-ACCNT-CNTL                  VALUE '3'.
  3209             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3210
  3211         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3212         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3213
  3214         16  CF-LGX-CREDIT-USER             PIC X.
  3215             88  CO-IS-NOT-USER                 VALUE 'N'.
  3216             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3217
  3218         16 CF-CREDIT-CALC-CODES.
  3219             20  CF-CR-REM-TERM-CALC PIC X.
  3220               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3221               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3222               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3223               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3224               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3225               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3226               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3227             20  CF-CR-R78-METHOD           PIC X.
  3228               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3229               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3230
  3231         16  CF-CLAIM-CONTROL-COUNTS.
  3232             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3233                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3234
  3235             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3236                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3237
  3238             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3239                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3240
  3241             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3242                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3243
  3244         16  CF-CURRENT-MONTH-END           PIC XX.
  3245
  3246         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3247             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3248             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3249             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3250             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3251                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3252                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3253             20  CF-CO-PREM-REJECT-SW       PIC X.
  3254                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3255                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3256             20  CF-CO-REF-REJECT-SW        PIC X.
  3257                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3258                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3259
  3260         16  CF-CO-REPORTING-DT             PIC XX.
  3261         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  58
* NSRASBL.cbl
  3262         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3263           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3264           88  CF-CO-MONTH-END                  VALUE '1'.
  3265
  3266         16  CF-LGX-CLAIM-USER              PIC X.
  3267             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3268             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3269
  3270         16  CF-CREDIT-EDIT-CONTROLS.
  3271             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3272             20  CF-MIN-AGE                 PIC 99.
  3273             20  CF-DEFAULT-AGE             PIC 99.
  3274             20  CF-MIN-TERM                PIC S999      COMP-3.
  3275             20  CF-MAX-TERM                PIC S999      COMP-3.
  3276             20  CF-DEFAULT-SEX             PIC X.
  3277             20  CF-JOINT-AGE-INPUT         PIC X.
  3278                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3279             20  CF-BIRTH-DATE-INPUT        PIC X.
  3280                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3281             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3282                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3283                 88  CF-ZERO-CARRIER            VALUE '1'.
  3284                 88  CF-ZERO-GROUPING           VALUE '2'.
  3285                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3286             20  CF-EDIT-SW                 PIC X.
  3287                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3288             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3289             20  CF-CR-PR-METHOD            PIC X.
  3290               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3291               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3292             20  FILLER                     PIC X.
  3293
  3294         16  CF-CREDIT-MISC-CONTROLS.
  3295             20  CF-REIN-TABLE-SW           PIC X.
  3296                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3297             20  CF-COMP-TABLE-SW           PIC X.
  3298                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3299             20  CF-EXPERIENCE-RETENTION-AGE
  3300                                            PIC S9        COMP-3.
  3301             20  CF-CONVERSION-DT           PIC XX.
  3302             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3303             20  CF-RUN-FREQUENCY-SW        PIC X.
  3304                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3305                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3306
  3307             20  CF-CR-CHECK-NO-CONTROL.
  3308                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3309                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3310                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3311                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3312                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3313                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3314
  3315                 24  CF-CR-CHECK-COUNT       REDEFINES
  3316                     CF-CR-CHECK-COUNTER      PIC X(4).
  3317
  3318                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3319                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  59
* NSRASBL.cbl
  3320
  3321                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3322                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3323                 24  CF-MAIL-PROCESSING       PIC X.
  3324                     88  MAIL-PROCESSING          VALUE 'Y'.
  3325
  3326         16  CF-MISC-SYSTEM-CONTROL.
  3327             20  CF-SYSTEM-C                 PIC X.
  3328                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3329             20  CF-SYSTEM-D                 PIC X.
  3330                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3331             20  CF-SOC-SEC-NO-SW            PIC X.
  3332                 88  SOC-SEC-NO-USED             VALUE '1'.
  3333             20  CF-MEMBER-NO-SW             PIC X.
  3334                 88  MEMBER-NO-USED              VALUE '1'.
  3335             20  CF-TAX-ID-NUMBER            PIC X(11).
  3336             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3337             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3338                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3339                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3340                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3341                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3342             20  CF-SYSTEM-E                 PIC X.
  3343                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3344
  3345         16  CF-LGX-LIFE-USER               PIC X.
  3346             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3347             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3348
  3349         16  CF-CR-MONTH-END-DT             PIC XX.
  3350
  3351         16  CF-FILE-MAINT-DATES.
  3352             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3353                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3354             20  CF-LAST-BATCH       REDEFINES
  3355                 CF-LAST-BATCH-NO               PIC X(4).
  3356             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3357             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3358             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3359             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3360             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3361             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3362             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3363             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3364             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3365             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3366
  3367         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3368         16  FILLER                         PIC X.
  3369
  3370         16  CF-ALT-MORT-CODE               PIC X(4).
  3371         16  CF-MEMBER-CAPTION              PIC X(10).
  3372
  3373         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3374             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3375             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3376             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3377             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  60
* NSRASBL.cbl
  3378             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3379
  3380         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3381
  3382         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3383         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3384         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3385         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3386
  3387         16  CF-AH-OVERRIDE-L1              PIC X.
  3388         16  CF-AH-OVERRIDE-L2              PIC XX.
  3389         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3390         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3391
  3392         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3393         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3394
  3395         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3396         16  CF-AR-LAST-EL860-DT            PIC XX.
  3397         16  CF-MP-MONTH-END-DT             PIC XX.
  3398
  3399         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3400         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3401             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3402
  3403         16  CF-AR-MONTH-END-DT             PIC XX.
  3404
  3405         16  CF-CRDTCRD-USER                PIC X.
  3406             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3407             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3408
  3409         16  CF-CC-MONTH-END-DT             PIC XX.
  3410
  3411         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3412
  3413         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3414             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3415             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3416             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3417         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3418         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3419         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3420         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3421             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3422             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3423         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3424         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3425         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3426             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3427         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3428
  3429         16  CF-CL-ZIP-CODE.
  3430             20  CF-CL-ZIP-PRIME.
  3431                 24  CF-CL-ZIP-1ST          PIC X.
  3432                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3433                 24  FILLER                 PIC X(4).
  3434             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3435         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  61
* NSRASBL.cbl
  3436             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3437             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3438             20  FILLER                     PIC XXX.
  3439
  3440         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3441         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3442         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3443         16  CF-CO-OPTION-START-DATE        PIC XX.
  3444         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3445           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3446                                                      '3' '4'.
  3447           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3448           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3449           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3450           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3451           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3452           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3453
  3454         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3455
  3456         16  CF-PAYMENT-APPROVAL-LEVELS.
  3457             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3458             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3459             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3460             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3461             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3462             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3463
  3464         16  CF-END-USER-REPORTING-USER     PIC X.
  3465             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3466             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3467
  3468         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3469             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3470             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3471
  3472         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3473
  3474         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3475         16  FILLER                         PIC X.
  3476
  3477         16  CF-CREDIT-ARCHIVE-CNTL.
  3478             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3479             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3480             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3481
  3482         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3483
  3484         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3485             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3486             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3487
  3488         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3489             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3490             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3491
  3492         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3493
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  62
* NSRASBL.cbl
  3494         16  CF-CO-ACH-ID-CODE              PIC  X.
  3495             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3496             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3497             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3498         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3499         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3500         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3501         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3502         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3503         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3504         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3505         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3506         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3507                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3508         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3509                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3510
  3511         16  CF-CO-OVER-SHORT.
  3512             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3513             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3514
  3515*         16  FILLER                         PIC X(102).
  3516         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3517             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3518             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3519
  3520         16  CF-AH-APPROVAL-DAYS.
  3521             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3522             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3523             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3524             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3525
  3526         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3527
  3528         16  CF-APPROV-LEV-5.
  3529             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3530             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3531             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3532
  3533         16  FILLER                         PIC X(68).
  3534****************************************************************
  3535*             PROCESSOR/USER RECORD                            *
  3536****************************************************************
  3537
  3538     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3539         16  CF-PROCESSOR-NAME              PIC X(30).
  3540         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3541         16  CF-PROCESSOR-TITLE             PIC X(26).
  3542         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3543                 88  MESSAGE-YES                VALUE 'Y'.
  3544                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3545
  3546*****************************************************
  3547****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3548****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3549****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3550****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3551*****************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  63
* NSRASBL.cbl
  3552
  3553         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3554             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3555             20  CF-APPLICATION-FORCE       PIC X.
  3556             20  CF-INDIVIDUAL-APP.
  3557                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3558                     28  CF-BROWSE-APP      PIC X.
  3559                     28  CF-UPDATE-APP      PIC X.
  3560
  3561         16  CF-CURRENT-TERM-ON             PIC X(4).
  3562         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3563             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3564             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3565             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3566             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3567             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3568             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3569             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3570         16  CF-PROCESSOR-CARRIER           PIC X.
  3571             88  NO-CARRIER-SECURITY            VALUE ' '.
  3572         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3573             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3574         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3575             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3576         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3577             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3578
  3579         16  CF-PROC-SYS-ACCESS-SW.
  3580             20  CF-PROC-CREDIT-CLAIMS-SW.
  3581                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3582                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3583                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3584                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3585             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3586                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3587                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3588             20  CF-PROC-LIFE-GNRLDGR-SW.
  3589                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3590                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3591                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3592                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3593             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3594                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3595                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3596         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3597             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3598             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3599         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3600
  3601         16  CF-APPROVAL-LEVEL                  PIC X.
  3602             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3603             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3604             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3605             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3606             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3607
  3608         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3609
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  64
* NSRASBL.cbl
  3610         16  CF-LANGUAGE-TYPE                   PIC X.
  3611             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3612             88  CF-LANG-IS-FR                      VALUE 'F'.
  3613
  3614         16  CF-CSR-IND                         PIC X.
  3615         16  FILLER                             PIC X(239).
  3616
  3617****************************************************************
  3618*             PROCESSOR/REMINDERS RECORD                       *
  3619****************************************************************
  3620
  3621     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3622         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3623             20  CF-START-REMIND-DT         PIC XX.
  3624             20  CF-END-REMIND-DT           PIC XX.
  3625             20  CF-REMINDER-TEXT           PIC X(50).
  3626         16  FILLER                         PIC X(296).
  3627
  3628
  3629****************************************************************
  3630*             STATE MASTER RECORD                              *
  3631****************************************************************
  3632
  3633     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3634         16  CF-STATE-ABBREVIATION          PIC XX.
  3635         16  CF-STATE-NAME                  PIC X(25).
  3636         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3637         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3638             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3639             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3640             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3641             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3642                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3643                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3644             20  CF-ST-PREM-REJECT-SW       PIC X.
  3645                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3646                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3647             20  CF-ST-REF-REJECT-SW        PIC X.
  3648                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3649                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3650         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3651         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3652         16  CF-ST-REFUND-RULES.
  3653             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3654             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3655             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3656         16  CF-ST-FST-PMT-EXTENSION.
  3657             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3658             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3659                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3660                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3661                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3662                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3663         16  CF-ST-STATE-CALL.
  3664             20  CF-ST-CALL-UNEARNED        PIC X.
  3665             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3666             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3667         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  65
* NSRASBL.cbl
  3668             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3669             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3670         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3671         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3672         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3673         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3674         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3675         16  FILLER                         PIC X.
  3676         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3677             20  CF-ST-BENEFIT-CD           PIC XX.
  3678             20  CF-ST-BENEFIT-KIND         PIC X.
  3679                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3680                 88  CF-ST-AH-KIND              VALUE 'A'.
  3681             20  CF-ST-REM-TERM-CALC        PIC X.
  3682                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3683                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3684                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3685                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3686                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3687                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3688                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3689                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3690
  3691             20  CF-ST-REFUND-CALC          PIC X.
  3692                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3693                 88  ST-REFD-BY-R78             VALUE '1'.
  3694                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3695                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3696                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3697                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3698                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3699                 88  ST-REFD-UTAH               VALUE '7'.
  3700                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3701                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3702                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3703
  3704             20  CF-ST-EARNING-CALC         PIC X.
  3705                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3706                 88  ST-EARN-BY-R78             VALUE '1'.
  3707                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3708                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3709                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3710                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3711                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3712                 88  ST-EARN-MEAN               VALUE '8'.
  3713                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3714
  3715             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3716                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3717                 88  ST-OVRD-BY-R78             VALUE '1'.
  3718                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3719                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3720                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3721                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3722                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3723                 88  ST-OVRD-MEAN               VALUE '8'.
  3724                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3725             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  66
* NSRASBL.cbl
  3726
  3727         16  CF-ST-COMMISSION-CAPS.
  3728             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3729             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3730             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3731             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3732         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3733                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3734
  3735         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3736
  3737         16  CF-ST-STATUTORY-INTEREST.
  3738             20  CF-ST-STAT-DATE-FROM       PIC X.
  3739                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3740                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3741             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3742             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3743             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3744             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3745             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3746
  3747         16  CF-ST-OVER-SHORT.
  3748             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3749             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3750
  3751         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3752
  3753         16  CF-ST-RT-CALC                  PIC X.
  3754
  3755         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3756         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3757         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3758         16  CF-ST-RF-LR-CALC               PIC X.
  3759         16  CF-ST-RF-LL-CALC               PIC X.
  3760         16  CF-ST-RF-LN-CALC               PIC X.
  3761         16  CF-ST-RF-AH-CALC               PIC X.
  3762         16  CF-ST-RF-CP-CALC               PIC X.
  3763*        16  FILLER                         PIC X(206).
  3764*CIDMOD         16  FILLER                         PIC X(192).
  3765         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3766             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3767         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3768         16  CF-ST-VFY-2ND-BENE             PIC X.
  3769         16  CF-ST-CAUSAL-STATE             PIC X.
  3770         16  FILLER                         PIC X(185).
  3771
  3772****************************************************************
  3773*             BENEFIT MASTER RECORD                            *
  3774****************************************************************
  3775
  3776     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3777         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3778             20  CF-BENEFIT-CODE            PIC XX.
  3779             20  CF-BENEFIT-NUMERIC  REDEFINES
  3780                 CF-BENEFIT-CODE            PIC XX.
  3781             20  CF-BENEFIT-ALPHA           PIC XXX.
  3782             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3783             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  67
* NSRASBL.cbl
  3784
  3785             20  CF-LF-COVERAGE-TYPE        PIC X.
  3786                 88  CF-REDUCING                VALUE 'R'.
  3787                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3788
  3789             20  CF-SPECIAL-CALC-CD         PIC X.
  3790                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3791                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3792                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3793                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3794                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3795                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3796                 88  CF-FARM-PLAN               VALUE 'F'.
  3797                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3798                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3799                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3800                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3801                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3802                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3803                 88  CF-PRUDENTIAL              VALUE 'P'.
  3804                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3805                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3806                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3807                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3808                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3809                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3810
  3811             20  CF-JOINT-INDICATOR         PIC X.
  3812                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3813
  3814*            20  FILLER                     PIC X(12).
  3815             20  FILLER                     PIC X(11).
  3816             20  CF-BENEFIT-CATEGORY        PIC X.
  3817             20  CF-LOAN-TYPE               PIC X(8).
  3818
  3819             20  CF-CO-REM-TERM-CALC        PIC X.
  3820                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3821                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3822                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3823                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3824                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3825
  3826             20  CF-CO-EARNINGS-CALC        PIC X.
  3827                 88  CO-EARN-BY-R78             VALUE '1'.
  3828                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3829                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3830                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3831                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3832                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3833                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3834                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3835
  3836             20  CF-CO-REFUND-CALC          PIC X.
  3837                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3838                 88  CO-REFD-BY-R78             VALUE '1'.
  3839                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3840                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3841                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  68
* NSRASBL.cbl
  3842                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3843                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3844                 88  CO-REFD-MEAN               VALUE '8'.
  3845                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3846                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3847                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3848
  3849             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3850                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3851                 88  CO-OVRD-BY-R78             VALUE '1'.
  3852                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3853                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3854                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3855                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3856                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3857                 88  CO-OVRD-MEAN               VALUE '8'.
  3858                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3859
  3860             20  CF-CO-BEN-I-G-CD           PIC X.
  3861                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3862                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3863                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3864
  3865         16  FILLER                         PIC X(304).
  3866
  3867
  3868****************************************************************
  3869*             CARRIER MASTER RECORD                            *
  3870****************************************************************
  3871
  3872     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3873         16  CF-ADDRESS-DATA.
  3874             20  CF-MAIL-TO-NAME            PIC X(30).
  3875             20  CF-IN-CARE-OF              PIC X(30).
  3876             20  CF-ADDRESS-LINE-1          PIC X(30).
  3877             20  CF-ADDRESS-LINE-2          PIC X(30).
  3878             20  CF-CITY-STATE              PIC X(30).
  3879             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3880             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3881
  3882         16  CF-CLAIM-NO-CONTROL.
  3883             20  CF-CLAIM-NO-METHOD         PIC X.
  3884                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3885                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3886                 88  CLAIM-NO-SEQ               VALUE '3'.
  3887                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3888             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3889                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3890                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3891                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3892
  3893         16  CF-CHECK-NO-CONTROL.
  3894             20  CF-CHECK-NO-METHOD         PIC X.
  3895                 88  CHECK-NO-MANUAL            VALUE '1'.
  3896                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3897                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3898                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3899             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  69
* NSRASBL.cbl
  3900                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3901
  3902         16  CF-DOMICILE-STATE              PIC XX.
  3903
  3904         16  CF-EXPENSE-CONTROLS.
  3905             20  CF-EXPENSE-METHOD          PIC X.
  3906                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3907                 88  DOLLARS-PER-PMT            VALUE '2'.
  3908                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3909                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3910             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3911             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3912
  3913         16  CF-CORRESPONDENCE-CONTROL.
  3914             20  CF-LETTER-RESEND-OPT       PIC X.
  3915                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3916                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3917             20  FILLER                     PIC X(4).
  3918
  3919         16  CF-RESERVE-CONTROLS.
  3920             20  CF-MANUAL-SW               PIC X.
  3921                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3922             20  CF-FUTURE-SW               PIC X.
  3923                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3924             20  CF-PTC-SW                  PIC X.
  3925                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3926             20  CF-IBNR-SW                 PIC X.
  3927                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3928             20  CF-PTC-LF-SW               PIC X.
  3929                 88  CF-LF-PTC-USED             VALUE '1'.
  3930             20  CF-CDT-ACCESS-METHOD       PIC X.
  3931                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3932                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3933                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3934             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3935
  3936         16  CF-CLAIM-CALC-METHOD           PIC X.
  3937             88  360-PLUS-MONTHS                VALUE '1'.
  3938             88  365-PLUS-MONTHS                VALUE '2'.
  3939             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3940             88  360-DAILY                      VALUE '4'.
  3941             88  365-DAILY                      VALUE '5'.
  3942
  3943         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3944         16  FILLER                         PIC X(11).
  3945
  3946         16  CF-LIMIT-AMOUNTS.
  3947             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3948             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3949             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3950             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3951             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3952             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3953             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3954             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3955             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3956             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3957
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  70
* NSRASBL.cbl
  3958         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3959         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3960         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3961
  3962         16  CF-ZIP-CODE.
  3963             20  CF-ZIP-PRIME.
  3964                 24  CF-ZIP-1ST             PIC X.
  3965                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3966                 24  FILLER                 PIC X(4).
  3967             20  CF-ZIP-PLUS4               PIC X(4).
  3968         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3969             20  CF-CAN-POSTAL-1            PIC XXX.
  3970             20  CF-CAN-POSTAL-2            PIC XXX.
  3971             20  FILLER                     PIC XXX.
  3972
  3973         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3974         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3975         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3976
  3977         16  CF-RATING-SWITCH               PIC X.
  3978             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3979             88  CF-NO-RATING                   VALUE 'N'.
  3980
  3981         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3982
  3983         16  CF-CARRIER-OVER-SHORT.
  3984             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3985             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3986
  3987         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3988         16  CF-SECPAY-SWITCH               PIC X.
  3989             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3990             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3991         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3992         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3993         16  FILLER                         PIC X(444).
  3994*        16  FILLER                         PIC X(452).
  3995
  3996
  3997****************************************************************
  3998*             MORTALITY MASTER RECORD                          *
  3999****************************************************************
  4000
  4001     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4002         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4003                                INDEXED BY CF-MORT-NDX.
  4004             20  CF-MORT-TABLE              PIC X(5).
  4005             20  CF-MORT-TABLE-TYPE         PIC X.
  4006                 88  CF-MORT-JOINT              VALUE 'J'.
  4007                 88  CF-MORT-SINGLE             VALUE 'S'.
  4008                 88  CF-MORT-COMBINED           VALUE 'C'.
  4009                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4010                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4011             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4012             20  CF-MORT-AGE-METHOD         PIC XX.
  4013                 88  CF-AGE-LAST                VALUE 'AL'.
  4014                 88  CF-AGE-NEAR                VALUE 'AN'.
  4015             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  71
* NSRASBL.cbl
  4016             20  CF-MORT-ADJUSTMENT-DIRECTION
  4017                                            PIC X.
  4018                 88  CF-MINUS                   VALUE '-'.
  4019                 88  CF-PLUS                    VALUE '+'.
  4020             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4021             20  CF-MORT-JOINT-CODE         PIC X.
  4022                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4023             20  CF-MORT-PC-Q               PIC X.
  4024                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4025             20  CF-MORT-TABLE-CODE         PIC X(4).
  4026             20  CF-MORT-COMMENTS           PIC X(15).
  4027             20  FILLER                     PIC X(14).
  4028
  4029         16  FILLER                         PIC X(251).
  4030
  4031
  4032****************************************************************
  4033*             BUSSINESS TYPE MASTER RECORD                     *
  4034****************************************************************
  4035
  4036     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4037* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4038* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4039* AND RECORD 05 IS TYPES 81-99
  4040         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4041             20  CF-BUSINESS-TITLE          PIC  X(19).
  4042             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4043                                            PIC S9V9(4) COMP-3.
  4044             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4045             20  FILLER                     PIC  X.
  4046         16  FILLER                         PIC  X(248).
  4047
  4048
  4049****************************************************************
  4050*             TERMINAL MASTER RECORD                           *
  4051****************************************************************
  4052
  4053     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4054
  4055         16  CF-COMPANY-TERMINALS.
  4056             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4057                                  PIC X(4).
  4058         16  FILLER               PIC X(248).
  4059
  4060
  4061****************************************************************
  4062*             LIFE EDIT MASTER RECORD                          *
  4063****************************************************************
  4064
  4065     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4066         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4067             20  CF-LIFE-CODE-IN            PIC XX.
  4068             20  CF-LIFE-CODE-OUT           PIC XX.
  4069         16  FILLER                         PIC X(248).
  4070
  4071
  4072****************************************************************
  4073*             AH EDIT MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  72
* NSRASBL.cbl
  4074****************************************************************
  4075
  4076     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4077         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4078             20  CF-AH-CODE-IN              PIC XXX.
  4079             20  CF-AH-CODE-OUT             PIC XX.
  4080         16  FILLER                         PIC X(248).
  4081
  4082
  4083****************************************************************
  4084*             CREDIBILITY TABLES                               *
  4085****************************************************************
  4086
  4087     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4088         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4089                             INDEXED BY CF-CRDB-NDX.
  4090             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4091             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4092             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4093         16  FILLER                         PIC  X(332).
  4094
  4095
  4096****************************************************************
  4097*             REPORT CUSTOMIZATION RECORD                      *
  4098****************************************************************
  4099
  4100     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4101         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4102             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4103             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4104             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4105**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4106****       A T-TRANSFER.                                   ****
  4107             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4108
  4109         16  FILLER                         PIC XX.
  4110
  4111         16  CF-CARRIER-CNTL-OPT.
  4112             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4113                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4114                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4115             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4116                                            PIC X.
  4117         16  CF-GROUP-CNTL-OPT.
  4118             20  CF-GROUP-OPT-SEQ           PIC 9.
  4119                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4120                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4121             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4122                                            PIC X(6).
  4123         16  CF-STATE-CNTL-OPT.
  4124             20  CF-STATE-OPT-SEQ           PIC 9.
  4125                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4126                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4127             20  CF-STATE-SELECT OCCURS 3 TIMES
  4128                                            PIC XX.
  4129         16  CF-ACCOUNT-CNTL-OPT.
  4130             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4131                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  73
* NSRASBL.cbl
  4132                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4133             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4134                                            PIC X(10).
  4135         16  CF-BUS-TYP-CNTL-OPT.
  4136             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4137                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4138                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4139             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4140                                            PIC XX.
  4141         16  CF-LF-TYP-CNTL-OPT.
  4142             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4143                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4144                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4145             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4146                                            PIC XX.
  4147         16  CF-AH-TYP-CNTL-OPT.
  4148             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4149                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4150                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4151             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4152                                            PIC XX.
  4153         16  CF-REPTCD1-CNTL-OPT.
  4154             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4155                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4156                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4157             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4158                                            PIC X(10).
  4159         16  CF-REPTCD2-CNTL-OPT.
  4160             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4161                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4162                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4163             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4164                                            PIC X(10).
  4165         16  CF-USER1-CNTL-OPT.
  4166             20  CF-USER1-OPT-SEQ           PIC 9.
  4167                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4168                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4169             20  CF-USER1-SELECT OCCURS 3 TIMES
  4170                                            PIC X(10).
  4171         16  CF-USER2-CNTL-OPT.
  4172             20  CF-USER2-OPT-SEQ           PIC 9.
  4173                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4174                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4175             20  CF-USER2-SELECT OCCURS 3 TIMES
  4176                                            PIC X(10).
  4177         16  CF-USER3-CNTL-OPT.
  4178             20  CF-USER3-OPT-SEQ           PIC 9.
  4179                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4180                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4181             20  CF-USER3-SELECT OCCURS 3 TIMES
  4182                                            PIC X(10).
  4183         16  CF-USER4-CNTL-OPT.
  4184             20  CF-USER4-OPT-SEQ           PIC 9.
  4185                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4186                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4187             20  CF-USER4-SELECT OCCURS 3 TIMES
  4188                                            PIC X(10).
  4189         16  CF-USER5-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  74
* NSRASBL.cbl
  4190             20  CF-USER5-OPT-SEQ           PIC 9.
  4191                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4192                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4193             20  CF-USER5-SELECT OCCURS 3 TIMES
  4194                                            PIC X(10).
  4195         16  CF-REINS-CNTL-OPT.
  4196             20  CF-REINS-OPT-SEQ           PIC 9.
  4197                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4198                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4199             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4200                 24  CF-REINS-PRIME         PIC XXX.
  4201                 24  CF-REINS-SUB           PIC XXX.
  4202
  4203         16  CF-AGENT-CNTL-OPT.
  4204             20  CF-AGENT-OPT-SEQ           PIC 9.
  4205                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4206                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4207             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4208                                            PIC X(10).
  4209
  4210         16  FILLER                         PIC X(43).
  4211
  4212         16  CF-LOSS-RATIO-SELECT.
  4213             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4214             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4215         16  CF-ENTRY-DATE-SELECT.
  4216             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4217             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4218         16  CF-EFFECTIVE-DATE-SELECT.
  4219             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4220             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4221
  4222         16  CF-EXCEPTION-LIST-IND          PIC X.
  4223             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4224
  4225         16  FILLER                         PIC X(318).
  4226
  4227****************************************************************
  4228*                  EXCEPTION REPORTING RECORD                  *
  4229****************************************************************
  4230
  4231     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4232         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4233             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4234
  4235         16  CF-COMBINED-LIFE-AH-OPT.
  4236             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4237             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4238             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4239             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4240
  4241         16  CF-LIFE-OPT.
  4242             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4243             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4244             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4245             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4246             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4247             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  75
* NSRASBL.cbl
  4248             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4249             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4250             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4251             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4252
  4253         16  CF-AH-OPT.
  4254             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4255             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4256             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4257             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4258             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4259             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4260             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4261             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4262             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4263             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4264
  4265         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4266             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4267             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4268             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4269
  4270         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4271
  4272         16  FILLER                         PIC X(673).
  4273
  4274
  4275****************************************************************
  4276*             MORTGAGE SYSTEM PLAN RECORD                      *
  4277****************************************************************
  4278
  4279     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4280         16  CF-PLAN-TYPE                   PIC X.
  4281             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4282             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4283             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4284         16  CF-PLAN-ABBREV                 PIC XXX.
  4285         16  CF-PLAN-DESCRIPT               PIC X(10).
  4286         16  CF-PLAN-NOTES                  PIC X(20).
  4287         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4288         16  CF-PLAN-UNDERWRITING.
  4289             20  CF-PLAN-TERM-DATA.
  4290                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4291                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4292             20  CF-PLAN-AGE-DATA.
  4293                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4294                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4295                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4296             20  CF-PLAN-BENEFIT-DATA.
  4297                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4298                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4299                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4300                                            PIC S9(7)V99  COMP-3.
  4301         16  CF-PLAN-POLICY-FORMS.
  4302             20  CF-POLICY-FORM             PIC X(12).
  4303             20  CF-MASTER-APPLICATION      PIC X(12).
  4304             20  CF-MASTER-POLICY           PIC X(12).
  4305         16  CF-PLAN-RATING.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  76
* NSRASBL.cbl
  4306             20  CF-RATE-CODE               PIC X(5).
  4307             20  CF-SEX-RATING              PIC X.
  4308                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4309                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4310             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4311             20  CF-SUB-STD-TYPE            PIC X.
  4312                 88  CF-PCT-OF-PREM            VALUE '1'.
  4313                 88  CF-PCT-OF-BENE            VALUE '2'.
  4314         16  CF-PLAN-PREM-TOLERANCES.
  4315             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4316             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4317         16  CF-PLAN-PYMT-TOLERANCES.
  4318             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4319             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4320         16  CF-PLAN-MISC-DATA.
  4321             20  FILLER                     PIC X.
  4322             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4323             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4324         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4325         16  CF-PLAN-IND-GRP                PIC X.
  4326             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4327                                                     '1'.
  4328             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4329                                                     '2'.
  4330         16  CF-MIB-SEARCH-SW               PIC X.
  4331             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4332             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4333             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4334             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4335         16  CF-ALPHA-SEARCH-SW             PIC X.
  4336             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4337             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4338             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4339             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4340             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4341             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4342             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4343             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4344             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4345             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4346                                                     'A' 'B' 'C'
  4347                                                     'X' 'Y' 'Z'.
  4348         16  CF-EFF-DT-RULE-SW              PIC X.
  4349             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4350             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4351             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4352             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4353             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4354         16  FILLER                         PIC X(4).
  4355         16  CF-HEALTH-QUESTIONS            PIC X.
  4356             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4357         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4358         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4359         16  CF-PLAN-SNGL-JNT               PIC X.
  4360             88  CF-COMBINED-PLAN              VALUE 'C'.
  4361             88  CF-JNT-PLAN                   VALUE 'J'.
  4362             88  CF-SNGL-PLAN                  VALUE 'S'.
  4363         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  77
* NSRASBL.cbl
  4364         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4365         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4366         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4367         16  CF-RERATE-CNTL                 PIC  X.
  4368             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4369             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4370             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4371             88  CF-AUTO-RECALC                 VALUE '4'.
  4372         16  CF-BENEFIT-TYPE                PIC  X.
  4373             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4374             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4375         16  CF-POLICY-FEE                  PIC S999V99
  4376                                                    COMP-3.
  4377         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4378         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4379         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4380         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4381         16  FILLER                         PIC  X(32).
  4382         16  CF-TERMINATION-FORM            PIC  X(04).
  4383         16  FILLER                         PIC  X(08).
  4384         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4385                                                       COMP-3.
  4386         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4387         16  CF-ISSUE-LETTER                PIC  X(4).
  4388         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4389         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4390             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4391             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4392         16  CF-MP-REFUND-CALC              PIC X.
  4393             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4394             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4395             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4396             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4397             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4398             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4399             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4400             88  CF-MP-REFD-MEAN                VALUE '8'.
  4401         16  CF-ALT-RATE-CODE               PIC  X(5).
  4402
  4403
  4404         16  FILLER                         PIC X(498).
  4405****************************************************************
  4406*             MORTGAGE COMPANY MASTER RECORD                   *
  4407****************************************************************
  4408
  4409     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4410         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4411         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4412             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4413             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4414             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4415             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4416             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4417
  4418         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4419         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4420         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4421         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  78
* NSRASBL.cbl
  4422         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4423
  4424         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4425             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4426         16  CF-MP-RECON-USE-IND            PIC X(1).
  4427             88  CF-MP-USE-RECON             VALUE 'Y'.
  4428         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4429             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4430         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4431             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4432             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4433         16  FILLER                         PIC X(1).
  4434         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4435             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4436         16  CF-MORTG-MIB-VERSION           PIC X.
  4437             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4438             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4439             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4440         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4441             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4442                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4443             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4444                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4445             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4446                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4447             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4448                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4449             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4450                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4451             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4452                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4453         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4454         16  FILLER                         PIC X(7).
  4455         16  CF-MORTG-DESTINATION-SYMBOL.
  4456             20  CF-MORTG-MIB-COMM          PIC X(5).
  4457             20  CF-MORTG-MIB-TERM          PIC X(5).
  4458         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4459             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4460         16  FILLER                         PIC X(03).
  4461         16  CF-MP-CHECK-NO-CONTROL.
  4462             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4463                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4464                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4465                                                ' ' LOW-VALUES.
  4466                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4467                                               VALUE '3'.
  4468         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4469         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4470         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4471             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4472                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4473             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4474                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4475             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4476                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4477             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4478                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4479             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  79
* NSRASBL.cbl
  4480                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4481             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4482                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4483         16  CF-MORTG-BILLING-AREA.
  4484             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4485                                            PIC X.
  4486         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4487         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4488         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4489         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4490             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4491             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4492         16  FILLER                         PIC X.
  4493         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4494             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4495             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4496         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4497         16  FILLER                         PIC X(8).
  4498         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4499         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4500         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4501         16  CF-ACH-COMPANY-ID.
  4502             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4503                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4504                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4505                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4506             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4507         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4508             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4509         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4510             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4511             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4512         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4513         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4514         16  FILLER                         PIC X(536).
  4515
  4516****************************************************************
  4517*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4518****************************************************************
  4519
  4520     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4521         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4522             20  CF-FEMALE-HEIGHT.
  4523                 24  CF-FEMALE-FT           PIC 99.
  4524                 24  CF-FEMALE-IN           PIC 99.
  4525             20  CF-FEMALE-MIN-WT           PIC 999.
  4526             20  CF-FEMALE-MAX-WT           PIC 999.
  4527         16  FILLER                         PIC X(428).
  4528
  4529     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4530         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4531             20  CF-MALE-HEIGHT.
  4532                 24  CF-MALE-FT             PIC 99.
  4533                 24  CF-MALE-IN             PIC 99.
  4534             20  CF-MALE-MIN-WT             PIC 999.
  4535             20  CF-MALE-MAX-WT             PIC 999.
  4536         16  FILLER                         PIC X(428).
  4537******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  80
* NSRASBL.cbl
  4538*             AUTOMATIC ACTIVITY RECORD                          *
  4539******************************************************************
  4540     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4541         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4542             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4543             20  CF-SYS-LETTER-ID           PIC X(04).
  4544             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4545             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4546             20  CF-SYS-RESET-SW            PIC X(01).
  4547             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4548             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4549
  4550         16  FILLER                         PIC X(50).
  4551
  4552         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4553             20  CF-USER-ACTIVE-SW          PIC X(01).
  4554             20  CF-USER-LETTER-ID          PIC X(04).
  4555             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4556             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4557             20  CF-USER-RESET-SW           PIC X(01).
  4558             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4559             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4560             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4561
  4562         16  FILLER                         PIC X(246).
  4563*                                COPY NSCASVARS.
  4564******************************************************************
  4565*                   C H A N G E   L O G
  4566*
  4567*        CURRENT SIZE - 6150
  4568*
  4569* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4570*-----------------------------------------------------------------
  4571*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4572* EFFECTIVE    NUMBER
  4573*-----------------------------------------------------------------
  4574* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4575* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4576* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
  4577******************************************************************
  4578 01 NAPER-OUTPUT-DATA.
  4579    05  F                       PIC X(07) VALUE "LETTER=".
  4580    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4581    05  F                       PIC X(08) VALUE "~PROCID=".
  4582    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4583    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4584    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4585    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4586    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4587    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4588    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4589    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4590    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4591    05  F                       PIC X(06) VALUE "~CARR=".
  4592    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4593    05  F                       PIC X(10) VALUE "~GROUPING=".
  4594    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4595    05  F                       PIC X(08) VALUE "~CERTST=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  81
* NSRASBL.cbl
  4596    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4597    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4598    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4599    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4600    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4601    05  F                       PIC X(07) VALUE "~CRTNO=".
  4602    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4603    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4604    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4605    05  F                       PIC X(08) VALUE "~ILNAME=".
  4606    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4607    05  F                       PIC X(08) VALUE "~IFNAME=".
  4608    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4609    05  F                       PIC X(08) VALUE "~IFINIT=".
  4610    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4611    05  F                       PIC X(08) VALUE "~IMINIT=".
  4612    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4613    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4614    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4615    05  F                       PIC X(06) VALUE "~ISEX=".
  4616    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4617    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4618    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4619    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4620    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4621    05  F                       PIC X(09) VALUE "~INSCITY=".
  4622    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4623    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4624    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4625    05  F                       PIC X(08) VALUE "~INSZIP=".
  4626    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4627    05  F                       PIC X(05) VALUE "~SSN=".
  4628    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4629    05  F                       PIC X(07) VALUE "~MEMNO=".
  4630    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4631    05  F                       PIC X(08) VALUE "~JLNAME=".
  4632    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4633    05  F                       PIC X(08) VALUE "~JFNAME=".
  4634    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4635    05  F                       PIC X(08) VALUE "~JMINIT=".
  4636    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4637    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4638    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4639    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4640    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4641    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4642    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4643    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4644    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4645    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4646    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4647    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4648    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4649    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4650    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4651    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4652    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4653    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  82
* NSRASBL.cbl
  4654    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4655    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4656    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4657    05  F                       PIC X(10) VALUE "~BENENAME=".
  4658    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4659    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4660    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4661    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4662    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4663    05  F                       PIC X(10) VALUE "~BENECITY=".
  4664    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4665    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4666    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4667    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4668    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4669    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4670    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4671    05  F                       PIC X(08) VALUE "~RESPNO=".
  4672    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4673    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4674    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4675    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4676    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4677    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4678    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4679    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4680    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4681    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4682    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4683    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4684    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4685    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4686    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4687    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4688    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4689    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4690    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4691    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4692    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4693    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4694    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4695    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4696    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4697    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4698    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4699    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4700    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4701    05  F                       PIC X(07) VALUE "~BATCH=".
  4702    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4703    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4704    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4705    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4706    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4707    05  F                       PIC X(05) VALUE "~APR=".
  4708    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4709    05  F                       PIC X(08) VALUE "~LNTERM=".
  4710    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4711    05  F                       PIC X(11) VALUE "~RATECLASS=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  83
* NSRASBL.cbl
  4712    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4713    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4714    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4715    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4716    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4717    05  F                       PIC X(07) VALUE "~UCODE=".
  4718    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4719    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4720    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4721    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4722    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4723    05  F                       PIC X(06) VALUE "~SKIP=".
  4724    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4725    05  F                       PIC X(06) VALUE "~MODE=".
  4726    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4727    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4728    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4729    05  F                       PIC X(06) VALUE "~RTBL=".
  4730    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4731    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4732    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4733    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4734    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4735    05  F                       PIC X(08) VALUE "~LFTERM=".
  4736    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4737    05  F                       PIC X(07) VALUE "~LFDEV=".
  4738    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4739    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4740    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4741    05  F                       PIC X(07) VALUE "~LFBEN=".
  4742    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4743    05  F                       PIC X(08) VALUE "~LFPREM=".
  4744    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4745    05  F                       PIC X(08) VALUE "~LFABEN=".
  4746    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4747    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4748    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4749    05  F                       PIC X(07) VALUE "~LFNSP=".
  4750    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4751    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4752    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4753    05  F                       PIC X(07) VALUE "~LFCAN=".
  4754    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4755    05  F                       PIC X(07) VALUE "~LFDTH=".
  4756    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4757    05  F                       PIC X(08) VALUE "~LFRATE=".
  4758    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4759    05  F                       PIC X(09) VALUE "~LFARATE=".
  4760    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4761    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4762    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4763    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4764    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4765    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4766    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4767    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4768    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4769    05  F                       PIC X(07) VALUE "~DTHDT=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  84
* NSRASBL.cbl
  4770    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4771    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4772    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4773    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4774    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4775    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4776    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4777    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4778    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4779    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4780    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4781    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4782    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4783    05  F                       PIC X(08) VALUE "~AHTERM=".
  4784    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4785    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4786    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4787    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4788    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4789    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4790    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4791    05  F                       PIC X(07) VALUE "~AHBEN=".
  4792    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4793    05  F                       PIC X(08) VALUE "~AHPREM=".
  4794    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4795    05  F                       PIC X(07) VALUE "~AHNSP=".
  4796    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4797    05  F                       PIC X(07) VALUE "~AHCAN=".
  4798    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4799    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4800    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4801    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4802    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4803    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4804    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4805    05  F                       PIC X(08) VALUE "~AHRATE=".
  4806    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4807    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4808    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4809    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4810    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4811    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4812    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4813    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4814    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4815    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4816    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4817    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4818    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4819    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4820    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4821    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4822    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4823    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4824    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4825    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4826    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4827    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  85
* NSRASBL.cbl
  4828    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4829    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4830                                PIC X(2).
  4831    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4832    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4833    05  F                       PIC X(08) VALUE "~TOTREF=".
  4834    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4835    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4836    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4837    05  F                       PIC X(07) VALUE "~STERM=".
  4838    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4839    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4840    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4841    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4842    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4843    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4844    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4845    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4846    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4847    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4848    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4849    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4850    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4851    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4852    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4853    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4854    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4855    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4856    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4857    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4858    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4859    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4860    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4861    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4862                                PIC X(12).
  4863    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4864    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4865    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4866                                PIC X(12).
  4867    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4868    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4869    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4870    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4871    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4872    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4873    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4874    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4875    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4876                                PIC X(12).
  4877    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4878    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4879    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4880                                PIC X(10).
  4881    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4882    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4883    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4884    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4885    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  86
* NSRASBL.cbl
  4886    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4887    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4888    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4889    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4890    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4891    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4892    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4893    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4894                                PIC X(10).
  4895    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4896    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4897    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4898                                PIC X(10).
  4899    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4900    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4901    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4902    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4903    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4904    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4905    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4906    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4907    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4908    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4909    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4910    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4911    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4912    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4913    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4914    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4915    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4916    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4917    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4918                                PIC X(2).
  4919    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4920    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4921    05  F                       PIC X(08) VALUE "~OSTERM=".
  4922    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4923    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4924    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4925    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4926    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4927    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4928    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4929    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4930    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4931    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4932                                PIC X(09).
  4933    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4934    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4935    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4936    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4937    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4938    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4939    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4940    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4941    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4942                                PIC X(09).
  4943    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  87
* NSRASBL.cbl
  4944    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4945    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4946    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4947    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4948                                PIC X(09).
  4949    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4950    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4951    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4952                                PIC X(12).
  4953    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4954    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4955    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4956                                PIC X(10).
  4957    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4958    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4959    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4960    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4961    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4962                                PIC X(12).
  4963    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4964    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4965    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4966                                PIC X(10).
  4967    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4968    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4969    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4970    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4971    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4972    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4973    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4974    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4975    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  4976                                PIC X(09).
  4977    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  4978    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  4979    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  4980                                PIC X(09).
  4981    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  4982    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  4983    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  4984                                PIC X(10).
  4985    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  4986    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  4987    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  4988                                PIC X(10).
  4989    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  4990    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  4991    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  4992    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  4993    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  4994    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  4995    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  4996    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  4997    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  4998    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  4999    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  5000    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  5001    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  88
* NSRASBL.cbl
  5002    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  5003    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  5004                                PIC X(09).
  5005    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  5006    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  5007    05  F                       PIC X(08) VALUE "~NSTERM=".
  5008    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  5009    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  5010                                PIC X(09).
  5011    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  5012    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  5013    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  5014    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  5015    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  5016    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  5017    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  5018    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  5019    05  F                       PIC X(09) VALUE "~BALLOON=".
  5020    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  5021    05  F                       PIC X(10) VALUE "~LEASEIND=".
  5022    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  5023    05  F                       PIC X(09) VALUE "~RESCIND=".
  5024    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  5025    05  F                       PIC X(07) VALUE "~RCD01=".
  5026    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  5027    05  F                       PIC X(07) VALUE "~RCD02=".
  5028    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  5029    05  F                       PIC X(07) VALUE "~RCD03=".
  5030    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  5031    05  F                       PIC X(07) VALUE "~RCD04=".
  5032    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  5033    05  F                       PIC X(07) VALUE "~RCD05=".
  5034    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  5035    05  F                       PIC X(07) VALUE "~RCD06=".
  5036    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  5037    05  F                       PIC X(07) VALUE "~RCD07=".
  5038    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  5039    05  F                       PIC X(07) VALUE "~RCD08=".
  5040    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  5041    05  F                       PIC X(07) VALUE "~RCD09=".
  5042    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  5043    05  F                       PIC X(07) VALUE "~RCD10=".
  5044    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  5045    05  F                       PIC X(07) VALUE "~RCD11=".
  5046    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  5047    05  F                       PIC X(07) VALUE "~RCD12=".
  5048    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  5049    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  5050    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  5051    05  F                       PIC X(08) VALUE "~ARCHNO=".
  5052    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  5053    05  F                       PIC X(06) VALUE "~FORM=".
  5054    05  OUT-FORM                PIC X(03) VALUE SPACES.
  5055    05  F                       PIC X(09) VALUE "~ENCLINE=".
  5056    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  5057    05  F                       PIC X(08) VALUE "~ATTACH=".
  5058    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  5059    05  F                       PIC X(10) VALUE "~OUTSTACK=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  89
* NSRASBL.cbl
  5060    05  OUT-STACK               PIC X(10) VALUE SPACES.
  5061    05  F                       PIC X(11) VALUE "~STATENAME=".
  5062    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  5063    05  F                       PIC X(08) VALUE "~PRTNOW=".
  5064    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  5065    05  F                       PIC X(05) VALUE "~NCB=".
  5066    05  OUT-CHGBACK             PIC X     VALUE ' '.
  5067    05  F                       PIC X(8) VALUE "~CSOAMT=".
  5068    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  5069    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  5070    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  5071    05  F                       PIC X(09) VALUE "~LETRTYP=".
  5072    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  5073    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  5074    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  5075    05  F                       PIC X(08) VALUE "~INSBDT=".
  5076    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  5077    05  F                       PIC X(08) VALUE "~JNTBDT=".
  5078    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  5079    05  F                       PIC X(08) VALUE "~TOTINT=".
  5080    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  5081    05  F                       PIC X(8) VALUE "~TOPREM=".
  5082    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  5083    05  F                       PIC X(7) VALUE "~TOREF=".
  5084    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  5085    05  F                       PIC X(7) VALUE "~CANDT=".
  5086    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  5087    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  5088    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  5089    05  F                       PIC X(08) VALUE "~CERTID=".
  5090    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  5091    05  F                       PIC X(08) VALUE "~UNDWID=".
  5092    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  5093    05  F                       PIC X(8) VALUE "~TNPREM=".
  5094    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  5095    05  F                       PIC X(7) VALUE "~TNREF=".
  5096    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  5097    05  F                       PIC X(8)  VALUE "~COVIND=".
  5098    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  5099    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  5100    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  5101    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  5102    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  5103    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  5104    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  5105    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  5106    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  5107    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  5108    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  5109    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  5110                                PIC X(10).
  5111    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  5112    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5113    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  5114    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5115    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  5116    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5117    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  90
* NSRASBL.cbl
  5118    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5119    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  5120    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5121    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  5122    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5123    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  5124    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  5125    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  5126    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5127    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  5128    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5129    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  5130    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  5131    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  5132    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  5133    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  5134    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5135    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  5136    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5137    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  5138    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  5139    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  5140    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  5141    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  5142    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5143    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  5144    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5145    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  5146    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  5147    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  5148    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  5149    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  5150    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5151    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  5152    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5153    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  5154    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5155    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  5156    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5157    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  5158    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  5159    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  5160    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5161    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  5162    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5163    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5164    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5165    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  5166    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5167    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5168    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5169    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5170    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5171    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5172    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5173    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5174    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5175    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  91
* NSRASBL.cbl
  5176    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5177    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5178    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5179    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5180    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5181    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5182    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5183    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5184    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5185    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5186    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5187    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5188    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5189    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5190    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5191    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5192    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5193    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5194    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5195    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5196    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5197    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5198    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5199    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5200    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5201    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5202    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5203    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5204    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5205    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5206    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5207    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5208    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5209    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5210    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5211    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5212    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5213    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  5214    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  5215    05  F                       PIC X(11) VALUE 'EndOfString'.
  5216    05  f                       pic x(2) value spaces.
  5217*                                COPY ERCARCH.
  5218******************************************************************
  5219*                                                                *
  5220*                            ERCARCH.                            *
  5221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5222*                            VMOD=2.002                          *
  5223*                                                                *
  5224*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5225*                                                                *
  5226*   FILE TYPE = VSAM,KSDS                                        *
  5227*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5228*                                                                *
  5229*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5230*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5231*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5232*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5233*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  92
* NSRASBL.cbl
  5234*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5235*                                                                *
  5236*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5237******************************************************************
  5238*                   C H A N G E   L O G
  5239*
  5240* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5241*-----------------------------------------------------------------
  5242*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5243* EFFECTIVE    NUMBER
  5244*-----------------------------------------------------------------
  5245* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5246* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5247* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5248******************************************************************
  5249 01  LETTER-ARCHIVE.
  5250     12  LA-RECORD-ID                PIC  X(02).
  5251         88  LA-VALID-ID                VALUE 'LA'.
  5252
  5253     12  LA-CONTROL-PRIMARY.
  5254         16  LA-COMPANY-CD           PIC  X(01).
  5255         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5256
  5257     12  LA-CONTROL-BY-CERT-RESP.
  5258         16  LA-COMPANY-CD-A2        PIC  X(01).
  5259         16  LA-CERT-NO-A2.
  5260             20  LA-CERT-PRIME-A2    PIC  X(10).
  5261             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5262         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5263             20  LA-RESP-PERSON-A2   PIC  X(10).
  5264             20  LA-TYPE-A2          PIC  X(01).
  5265         16  LA-CARRIER-A2           PIC  X(01).
  5266         16  LA-GROUPING-A2          PIC  X(06).
  5267         16  LA-STATE-A2             PIC  X(02).
  5268         16  LA-ACCOUNT-A2           PIC  X(10).
  5269         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5270         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5271
  5272     12  LA-CONTROL-BY-FORM.
  5273         16  LA-COMPANY-CD-A3        PIC  X(01).
  5274         16  LA-FORM-A3              PIC  X(04).
  5275         16  LA-CARRIER-A3           PIC  X(01).
  5276         16  LA-GROUPING-A3          PIC  X(06).
  5277         16  LA-STATE-A3             PIC  X(02).
  5278         16  LA-ACCOUNT-A3           PIC  X(10).
  5279         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5280
  5281     12  LA-CONTROL-BY-PROCESSOR.
  5282         16  LA-COMPANY-CD-A4        PIC  X(01).
  5283         16  LA-PROCESSOR-CD         PIC  X(04).
  5284         16  LA-CARRIER-A4           PIC  X(01).
  5285         16  LA-GROUPING-A4          PIC  X(06).
  5286         16  LA-STATE-A4             PIC  X(02).
  5287         16  LA-ACCOUNT-A4           PIC  X(10).
  5288         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5289
  5290     12  LA-CONTROL-BY-KEY-FIELDS.
  5291         16  LA-COMPANY-CD-A5        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  93
* NSRASBL.cbl
  5292         16  LA-CARRIER-A5           PIC  X(01).
  5293         16  LA-GROUPING-A5          PIC  X(06).
  5294         16  LA-STATE-A5             PIC  X(02).
  5295         16  LA-ACCOUNT-A5           PIC  X(10).
  5296         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5297
  5298     12  LA-CONTROL-BY-GROUP-CODE.
  5299         16  LA-COMPANY-CD-A6        PIC  X(01).
  5300         16  LA-ENTRY-A6.
  5301             20  LA-FILLER           PIC  X(02).
  5302             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5303         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5304
  5305     12  FILLER                      PIC  X(09).
  5306
  5307     12  LA-HEADER-RECORD.
  5308         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5309         16  LA-CREATION-DATE        PIC  X(02).
  5310         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5311         16  LA-FINAL-ACT-DATE       REDEFINES
  5312               LA-FOLLOW-UP-DATE     PIC  X(02).
  5313         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5314         16  LA-NO-OF-COPIES         PIC S9(01).
  5315         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5316         16  LA-REPLY-DATE           PIC  X(02).
  5317         16  LA-RESEND-DATES.
  5318             20  LA-RESEND-DATE      PIC  X(02).
  5319             20  LA-SENT-DATE        PIC  X(02).
  5320             20  FILLER              PIC  X(08).
  5321         16  LA-SOURCE-INFORMATION.
  5322             20  LA-DATA-SOURCE      PIC  X(01).
  5323             20  LA-ADDR-SOURCE      PIC  X(01).
  5324         16  LA-STATUS               PIC  X(01).
  5325             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5326             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5327             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5328             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5329             88  LA-STATUS-PURGED         VALUE 'P'.
  5330             88  LA-STATUS-VOIDED         VALUE 'V'.
  5331         16  LA-LAST-RESENT-PRINT-DATE
  5332                                     PIC  X(02).
  5333         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5334             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5335                                          VALUE 'C'.
  5336             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5337                                          VALUE 'F'.
  5338             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5339                                          VALUE 'P'.
  5340         16  LA-PURGED-DATE          PIC  X(02).
  5341         16  LA-VOIDED-DATE          PIC  X(02).
  5342         16  LA-RESEND-LETR          PIC  X(4).
  5343         16  FILLER                  PIC  X(08).
  5344*        16  LA-RESEND-LETR-2        PIC  X(4).
  5345*        16  LA-RESEND-LETR-3        PIC  X(4).
  5346*        16  FILLER                  PIC  X(59).
  5347         16  LA-ARCHIVE-STATUS       PIC  X.
  5348             88  LA-TEMP                VALUE 'T'.
  5349             88  LA-QWS                 VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  94
* NSRASBL.cbl
  5350             88  LA-BATCH               VALUE 'B'.
  5351         16  LA-FINAL-ACT-IND        PIC  X(1).
  5352         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5353         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5354         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5355                                     PIC X(4).
  5356         16  FILLER                  PIC  X(42).
  5357*        16  FILLER                  PIC  X(71).
  5358         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5359         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5360         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5361                                     PIC  X(4).
  5362         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5363
  5364******************************************************************
  5365*                                COPY ELCCRTT.
  5366******************************************************************
  5367*                                                                *
  5368*                            ELCCRTT.                            *
  5369*                                                                *
  5370*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5371*                                                                *
  5372*   FILE TYPE = VSAM,KSDS                                        *
  5373*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5374*                                                                *
  5375*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5376*                                                                *
  5377*   LOG = YES                                                    *
  5378*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5379******************************************************************
  5380*                   C H A N G E   L O G
  5381*
  5382* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5383*-----------------------------------------------------------------
  5384*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5385* EFFECTIVE    NUMBER
  5386*-----------------------------------------------------------------
  5387* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5388* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5389* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5390* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5391* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5392******************************************************************
  5393
  5394 01  CERTIFICATE-TRAILERS.
  5395     12  CS-RECORD-ID                      PIC XX.
  5396         88  VALID-CS-ID                      VALUE 'CS'.
  5397
  5398     12  CS-CONTROL-PRIMARY.
  5399         16  CS-COMPANY-CD                 PIC X.
  5400         16  CS-CARRIER                    PIC X.
  5401         16  CS-GROUPING                   PIC X(6).
  5402         16  CS-STATE                      PIC XX.
  5403         16  CS-ACCOUNT                    PIC X(10).
  5404         16  CS-CERT-EFF-DT                PIC XX.
  5405         16  CS-CERT-NO.
  5406             20  CS-CERT-PRIME             PIC X(10).
  5407             20  CS-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  95
* NSRASBL.cbl
  5408         16  CS-TRAILER-TYPE               PIC X.
  5409             88  COMM-TRLR           VALUE 'A'.
  5410             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5411             88  CERT-DATA-TRLR      VALUE 'C'.
  5412
  5413     12  CS-DATA-AREA                      PIC X(516).
  5414
  5415     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5416         16  CS-BANK-COMMISSION-AREA.
  5417             20  CS-BANK-COMMS       OCCURS 10.
  5418                 24  CS-AGT                PIC X(10).
  5419                 24  CS-COM-TYP            PIC X.
  5420                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5421                 24  CS-RECALC-LV-INDIC    PIC X.
  5422                 24  FILLER                PIC X(10).
  5423         16  FILLER                        PIC X(256).
  5424
  5425     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5426****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5427****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5428         16  CS-MB-CLAIM-DATA OCCURS 2.
  5429             20  FILLER OCCURS 10.
  5430                 24  CS-CLAIM-TYPE         PIC X.
  5431                     88  CS-AH-CLM           VALUE 'A'.
  5432                     88  CS-IU-CLM           VALUE 'I'.
  5433                     88  CS-GP-CLM           VALUE 'G'.
  5434                     88  CS-LF-CLM           VALUE 'L'.
  5435                     88  CS-PR-CLM           VALUE 'P'.
  5436                 24  CS-BANK               PIC S999 COMP-3.
  5437                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5438                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5439                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5440         16  FILLER                        PIC X(216).
  5441     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5442         16  CS-VIN-NUMBER                 PIC X(17).
  5443         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5444         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5445         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5446         16  FILLER                        PIC X(496).
  5447******************************************************************
  5448 01  FILLER                      PIC X(500)  VALUE SPACES.
  5449*                                COPY ELCENCC.
  5450******************************************************************
  5451*                                                                *
  5452*                                                                *
  5453*                            ELCENCC                             *
  5454*                            VMOD=2.001                          *
  5455*                                                                *
  5456*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5457*                                                                *
  5458*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5459*   A NAPERSOFT DOCUMENT                                         *
  5460*                                                                *
  5461*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5462*                                                                *
  5463*   FILE TYPE = VSAM,KSDS                                        *
  5464*   RECORD SIZE = 400   RECFORM = FIX                            *
  5465*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  96
* NSRASBL.cbl
  5466*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5467*                                                                *
  5468*   LOG = NO                                                     *
  5469*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5470*                                                                *
  5471*                                                                *
  5472******************************************************************
  5473*                   C H A N G E   L O G
  5474*
  5475* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5476*-----------------------------------------------------------------
  5477*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5478* EFFECTIVE    NUMBER
  5479*-----------------------------------------------------------------
  5480* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5481******************************************************************
  5482 01  ENCLOSURE-CODES.
  5483     12  NC-RECORD-ID                      PIC XX.
  5484         88  VALID-NC-ID                      VALUE 'NC'.
  5485     12  NC-CONTROL-PRIMARY.
  5486         16  NC-COMPANY-CD                 PIC X.
  5487         16  NC-REC-TYPE                   PIC X.
  5488             88  NC-CLAIMS                   VALUE '1'.
  5489             88  NC-ADMIN                    VALUE '2'.
  5490         16  NC-ENC-CODE                   PIC X(5).
  5491         16  FILLER                        PIC X(09).
  5492     12  NC-MAINT-INFORMATION.
  5493         16  NC-LAST-MAINT-DT              PIC XX.
  5494         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5495         16  NC-LAST-MAINT-USER            PIC X(4).
  5496         16  FILLER                        PIC XX.
  5497     12  NC-OUTPUT-STACK                   PIC XXX.
  5498     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5499     12  NC-ATTACHMENTS                    PIC X(100).
  5500     12  NC-FUTURE                         PIC X(50).
  5501     12  FILLER                            PIC X(117).
  5502******************************************************************
  5503****************************************************************
  5504*
  5505* Copyright (c) 2007 by Clerity Solutions, Inc.
  5506* All rights reserved.
  5507*
  5508****************************************************************
  5509 01  DFHEIV.
  5510   02  DFHEIV0               PIC X(35).
  5511   02  DFHEIV1               PIC X(08).
  5512   02  DFHEIV2               PIC X(08).
  5513   02  DFHEIV3               PIC X(08).
  5514   02  DFHEIV4               PIC X(06).
  5515   02  DFHEIV5               PIC X(04).
  5516   02  DFHEIV6               PIC X(04).
  5517   02  DFHEIV7               PIC X(02).
  5518   02  DFHEIV8               PIC X(02).
  5519   02  DFHEIV9               PIC X(01).
  5520   02  DFHEIV10              PIC S9(7) COMP-3.
  5521   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5522   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5523   02  DFHEIV13              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  97
* NSRASBL.cbl
  5524   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5525   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5526   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5527   02  DFHEIV17              PIC X(04).
  5528   02  DFHEIV18              PIC X(04).
  5529   02  DFHEIV19              PIC X(04).
  5530   02  DFHEIV20              USAGE IS POINTER.
  5531   02  DFHEIV21              USAGE IS POINTER.
  5532   02  DFHEIV22              USAGE IS POINTER.
  5533   02  DFHEIV23              USAGE IS POINTER.
  5534   02  DFHEIV24              USAGE IS POINTER.
  5535   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5536   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5537   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5538   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5539   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5540   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5541   02  FILLER                PIC X(02).
  5542   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5543   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5544   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5545   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5546   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5547 LINKAGE  SECTION.
  5548*****************************************************************
  5549*                                                               *
  5550* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5551* All rights reserved.                                          *
  5552*                                                               *
  5553*****************************************************************
  5554 01  dfheiblk.
  5555     02  eibtime          pic s9(7) comp-3.
  5556     02  eibdate          pic s9(7) comp-3.
  5557     02  eibtrnid         pic x(4).
  5558     02  eibtaskn         pic s9(7) comp-3.
  5559     02  eibtrmid         pic x(4).
  5560     02  dfheigdi         pic s9(4) comp.
  5561     02  eibcposn         pic s9(4) comp.
  5562     02  eibcalen         pic s9(4) comp.
  5563     02  eibaid           pic x(1).
  5564     02  eibfiller1       pic x(1).
  5565     02  eibfn            pic x(2).
  5566     02  eibfiller2       pic x(2).
  5567     02  eibrcode         pic x(6).
  5568     02  eibfiller3       pic x(2).
  5569     02  eibds            pic x(8).
  5570     02  eibreqid         pic x(8).
  5571     02  eibrsrce         pic x(8).
  5572     02  eibsync          pic x(1).
  5573     02  eibfree          pic x(1).
  5574     02  eibrecv          pic x(1).
  5575     02  eibsend          pic x(1).
  5576     02  eibatt           pic x(1).
  5577     02  eibeoc           pic x(1).
  5578     02  eibfmh           pic x(1).
  5579     02  eibcompl         pic x(1).
  5580     02  eibsig           pic x(1).
  5581     02  eibconf          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  98
* NSRASBL.cbl
  5582     02  eiberr           pic x(1).
  5583     02  eibrldbk         pic x(1).
  5584     02  eiberrcd         pic x(4).
  5585     02  eibsynrb         pic x(1).
  5586     02  eibnodat         pic x(1).
  5587     02  eibfiller5       pic x(2).
  5588     02  eibresp          pic 9(09) comp.
  5589     02  eibresp2         pic 9(09) comp.
  5590     02  dfheigdj         pic s9(4) comp.
  5591     02  dfheigdk         pic s9(4) comp.
  5592 01 dfhcommarea                  PIC X(6500).
  5593
  5594 01  var  pic x(30).
  5595 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  5596 0000-DFHEXIT SECTION.
  5597     MOVE '9#                    $   ' TO DFHEIV0.
  5598     MOVE 'NSRASBL' TO DFHEIV1.
  5599     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5600     display ' entering pgm nsrasbl '
  5601     display ' commarea ' dfhcommarea
  5602     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5603     MOVE '5'                    TO DC-OPTION-CODE
  5604     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5605     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5606     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5607     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5608     MOVE DC-DAY-OF-WEEK         TO SAVE-CYCLE-DAY-OF-WEEK
  5609     move dfhcommarea            to srch-commarea
  5610*****************************************************
  5611* The full       key has been established and passed
  5612* to this program via NSRASLTR
  5613*****************************************************
  5614     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5615     display ' input data ' bl-carrier ' ' bl-group ' '
  5616        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5617     MOVE BL-LETTER-ID           TO OUT-LETTER
  5618     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5619     MOVE BL-CARRIER             TO OUT-CARRIER
  5620     MOVE BL-GROUP               TO OUT-GROUPING
  5621     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5622     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5623     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5624     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5625     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5626        DC-EDITA-DAY  DELIMITED BY SIZE
  5627        INTO OUT-CYCLE-DT
  5628     END-STRING
  5629
  5630     set P to address of KIXSYS
  5631     CALL "getenv" using by value P returning var-ptr
  5632     if var-ptr = null then
  5633        display ' kixsys not set '
  5634     else
  5635        set address of var to var-ptr
  5636        move 0 to env-var-len
  5637        inspect var tallying env-var-len
  5638          for characters before X'00'
  5639        unstring var (1:env-var-len) delimited by '/'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  99
* NSRASBL.cbl
  5640        into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5641              WS-KIX-SYS
  5642        end-unstring
  5643     end-if
  5644
  5645     set P to address of KIXHOST
  5646     CALL "getenv" using by value P returning var-ptr
  5647     if var-ptr = null then
  5648        display ' kixhost not set '
  5649     else
  5650        set address of var to var-ptr
  5651        move 0 to env-var-len
  5652        inspect var tallying env-var-len
  5653          for characters before X'00'
  5654        MOVE var(1:env-var-len)  to ws-kixhost
  5655        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  5656     end-if
  5657
  5658**** This routine will connect to the Logic Database on SQL Server
  5659**** and call a stored procedure to determine the next business da
  5660
  5661     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  5662     IF SQLCODE = 0
  5663        PERFORM 4200-GET-NEXT-BUS-DT  THRU 4200-EXIT
  5664        IF SQLCODE = 0
  5665            MOVE WS-NEXT-BUS-DT TO SAVE-NEXT-BUS-DT-EDIT-A
  5666                                   WS-EDIT-A-DATE
  5667            MOVE WS-EDIT-A-YY   TO DC-YMD-YEAR
  5668            MOVE WS-EDIT-A-MM   TO DC-YMD-MONTH
  5669            MOVE WS-EDIT-A-DD   TO DC-YMD-DAY
  5670            MOVE '3'            TO DC-OPTION-CODE
  5671            PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5672            IF NO-CONVERSION-ERROR
  5673               MOVE DC-BIN-DATE-1 TO SAVE-BIN-NEXT-BUS-DT
  5674            ELSE
  5675               MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5676               MOVE '6'         TO DC-OPTION-CODE
  5677               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5678               IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5679                  MOVE 3        TO DC-ELAPSED-DAYS
  5680               ELSE
  5681                 IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5682                    MOVE 2     TO DC-ELAPSED-DAYS
  5683                 ELSE
  5684                    MOVE 1     TO DC-ELAPSED-DAYS
  5685                 END-IF
  5686               END-IF
  5687               PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5688               IF NO-CONVERSION-ERROR
  5689                   MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5690                   MOVE DC-GREG-DATE-A-EDIT TO
  5691                                SAVE-NEXT-BUS-DT-EDIT-A
  5692               ELSE
  5693                   MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5694                   MOVE WS-SAVE-EDIT-A-DATE TO
  5695                                SAVE-NEXT-BUS-DT-EDIT-A
  5696               END-IF
  5697            END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 100
* NSRASBL.cbl
  5698        ELSE
  5699            MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5700            MOVE '6'         TO DC-OPTION-CODE
  5701            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5702            IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5703               MOVE 3        TO DC-ELAPSED-DAYS
  5704            ELSE
  5705              IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5706                 MOVE 2     TO DC-ELAPSED-DAYS
  5707              ELSE
  5708                 MOVE 1     TO DC-ELAPSED-DAYS
  5709              END-IF
  5710            END-IF
  5711            PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5712            IF NO-CONVERSION-ERROR
  5713                MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5714                MOVE DC-GREG-DATE-A-EDIT TO
  5715                                SAVE-NEXT-BUS-DT-EDIT-A
  5716            ELSE
  5717                MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5718                MOVE WS-SAVE-EDIT-A-DATE TO
  5719                                SAVE-NEXT-BUS-DT-EDIT-A
  5720            END-IF
  5721        END-IF
  5722     ELSE
  5723        MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5724        MOVE '6'         TO DC-OPTION-CODE
  5725        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5726        IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5727           MOVE 3        TO DC-ELAPSED-DAYS
  5728        ELSE
  5729          IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5730             MOVE 2     TO DC-ELAPSED-DAYS
  5731          ELSE
  5732             MOVE 1     TO DC-ELAPSED-DAYS
  5733          END-IF
  5734        END-IF
  5735        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5736        IF NO-CONVERSION-ERROR
  5737            MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5738            MOVE DC-GREG-DATE-A-EDIT TO
  5739                                SAVE-NEXT-BUS-DT-EDIT-A
  5740        ELSE
  5741            MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5742            MOVE WS-SAVE-EDIT-A-DATE TO
  5743                                SAVE-NEXT-BUS-DT-EDIT-A
  5744        END-IF
  5745     END-IF
  5746
  5747     MOVE SAVE-NEXT-BUS-DT-EDIT-A  TO WS-EDIT-A-DATE
  5748     STRING WS-EDIT-A-CCYY '-' WS-EDIT-A-MM '-'
  5749           WS-EDIT-A-DD ' 00:00:00.0' DELIMITED BY SIZE
  5750              INTO OUT-NEXT-BUS-DT
  5751     END-STRING
  5752     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5753        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5754     ELSE
  5755        IF BL-EFF-DT = SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 101
* NSRASBL.cbl
  5756           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5757        ELSE
  5758           IF BL-EFF-DT (9:2) = SPACES
  5759              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5760                     BL-EFF-DT (4:2)
  5761                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5762              END-STRING
  5763           ELSE
  5764              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5765                     BL-EFF-DT (4:2)
  5766                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5767              END-STRING
  5768           END-IF
  5769           MOVE '3'              TO DC-OPTION-CODE
  5770           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5771           IF NO-CONVERSION-ERROR
  5772              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5773           ELSE
  5774              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5775              SET BL-FAIL TO TRUE
  5776              GO TO 0000-RETURN
  5777           END-IF
  5778        END-IF
  5779     END-IF
  5780     perform 0800-init-out-data  thru 0800-exit
  5781     SET BL-FAIL TO TRUE
  5782******************************************************************
  5783* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5784*    1) FROM ACCT MAINT
  5785*    2) FROM CERT UPDATE
  5786*    3) FROM COMP MAINT
  5787*    4) FROM REVIEW AND CORRECTIONS
  5788******************************************************************
  5789     EVALUATE BL-DATA-SRCE
  5790        WHEN '1'
  5791           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5792        WHEN '2'
  5793           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5794        WHEN '3'
  5795           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5796        WHEN '4'
  5797           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5798        WHEN OTHER
  5799           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5800     END-EVALUATE
  5801     IF BL-OK
  5802        display ' bl write erarch ' bl-write-erarch
  5803        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5804        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5805        IF BL-ARCHIVE-NO = ZEROS
  5806           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5807           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5808           display ' arch zeros, new arch ' bl-archive-no
  5809        END-IF
  5810        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5811        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5812        display ' bl write erarch ' bl-write-erarch
  5813        IF BL-WRITE-ERARCH = 'T' OR 'B'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 102
* NSRASBL.cbl
  5814           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5815           IF BL-FAIL
  5816              GO TO 0000-RETURN
  5817           END-IF
  5818        END-IF
  5819        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5820        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5821     END-IF
  5822     .
  5823 0000-RETURN.
  5824     move srch-commarea          to dfhcommarea
  5825
  5826* exec cics
  5827*       return
  5828*    end-exec
  5829*    MOVE '.(                    ''   #00005728' TO DFHEIV0
  5830     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5831     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5832     MOVE X'2020233030303035373238' TO DFHEIV0(25:11)
  5833     CALL 'kxdfhei1' USING DFHEIV0,
  5834           DFHEIV99,
  5835           DFHEIV99,
  5836           DFHEIV99,
  5837           DFHEIV99,
  5838           DFHEIV99,
  5839           DFHEIV99
  5840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5841     .
  5842 0100-DATA-SRCE-1.
  5843     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5844     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5845     MOVE ' '                    TO WS-ERACCT-SW
  5846     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5847     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5848     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5849     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5850     MOVE BL-STATE               TO WS-ERACCT-STATE
  5851     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5852     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5853                                    WS-CERT-EFF-DT
  5854     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5855     IF ACCT-FOUND
  5856        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5857        PERFORM 1025-GET-CSR-INFO
  5858                                 THRU 1025-EXIT
  5859        PERFORM 1300-DETERMINE-COMM
  5860                                 THRU 1300-EXIT
  5861        SET BL-OK TO TRUE
  5862     ELSE
  5863        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5864        SET BL-FAIL TO TRUE
  5865     END-IF
  5866     .
  5867 0100-EXIT.
  5868     EXIT.
  5869 0200-DATA-SRCE-2.
  5870     display ' made it to data srce 2 '
  5871     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 103
* NSRASBL.cbl
  5872     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5873     MOVE ' '                    TO WS-ELCERT-SW
  5874     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5875     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5876     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5877     MOVE BL-STATE               TO WS-ELCERT-STATE
  5878     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5879     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5880                                    WS-CERT-EFF-DT
  5881     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5882
  5883     MOVE ' '                 TO WS-ERACCT-SW
  5884     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5885     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5886     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5887     IF ACCT-FOUND
  5888        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5889        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5890     END-IF
  5891     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5892     IF CERT-FOUND
  5893        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5894        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5895        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5896        IF WS-LF-EARN = 'B'
  5897           MOVE 'B'              TO OUT-BALLOON-IND
  5898        END-IF
  5899        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5900        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5901        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5902        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5903
  5904        IF BL-ENDT-ARCH-NO > ZERO
  5905           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5906           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5907           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5908        ELSE
  5909           IF BL-ARCHIVE-NO > ZERO
  5910              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5911              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5912              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5913           END-IF
  5914        END-IF
  5915
  5916        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5917           AND (OUT-BALLOON-IND = 'B')
  5918           MOVE 'B'              TO OUT-FORM (3:1)
  5919        END-IF
  5920        SET BL-OK TO TRUE
  5921     ELSE
  5922        display ' cert not found ' ws-elcert-cert-no
  5923        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5924        SET BL-FAIL TO TRUE
  5925     END-IF
  5926     .
  5927 0200-EXIT.
  5928     EXIT.
  5929 0300-DATA-SRCE-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 104
* NSRASBL.cbl
  5930     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5931     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5932     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5933     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5934     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5935     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5936     IF WS-ERCOMP-ACCOUNT = SPACES
  5937        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5938        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5939     ELSE
  5940        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5941     END-IF
  5942     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5943     IF RESP-NORMAL
  5944        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5945        PERFORM 1025-GET-CSR-INFO
  5946                                 THRU 1025-EXIT
  5947        SET BL-OK TO TRUE
  5948     ELSE
  5949        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5950        SET BL-FAIL TO TRUE
  5951     END-IF
  5952     .
  5953 0300-EXIT.
  5954     EXIT.
  5955 0400-DATA-SRCE-4.
  5956     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  5957     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  5958     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  5959     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  5960     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  5961                                    WS-ELCERT-SW WS-ERENDT-SW
  5962
  5963* EXEC CICS READ
  5964*         DATASET    ('ERPNDB')
  5965*         INTO       (PENDING-BUSINESS)
  5966*         RIDFLD     (WS-ERPNDB-KEY)
  5967*         RESP       (WS-RESPONSE)
  5968*    END-EXEC
  5969     MOVE LENGTH OF
  5970      PENDING-BUSINESS
  5971       TO DFHEIV11
  5972     MOVE 'ERPNDB' TO DFHEIV1
  5973*    MOVE '&"IL       E          (  N#00005852' TO DFHEIV0
  5974     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5976     MOVE X'204E233030303035383532' TO DFHEIV0(25:11)
  5977     CALL 'kxdfhei1' USING DFHEIV0,
  5978           DFHEIV1,
  5979           PENDING-BUSINESS,
  5980           DFHEIV11,
  5981           WS-ERPNDB-KEY,
  5982           DFHEIV99,
  5983           DFHEIV99,
  5984           DFHEIV99
  5985     MOVE EIBRESP  TO WS-RESPONSE
  5986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5987     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 105
* NSRASBL.cbl
  5988        IF PB-RECORD-TYPE = '1' OR '2'
  5989           MOVE PB-CARRIER       TO BL-CARRIER
  5990           MOVE PB-GROUPING      TO BL-GROUP
  5991           MOVE PB-STATE         TO BL-STATE
  5992           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  5993           MOVE PB-CERT-NO       TO BL-CERT-NO
  5994           MOVE PB-CSR-ID        TO WS-CSR-ID
  5995           IF PB-ISSUE
  5996              SET PROCESS-ISSUE TO TRUE
  5997              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  5998              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  5999              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  6000              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  6001           ELSE
  6002              SET PROCESS-CANCEL TO TRUE
  6003              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  6004              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  6005              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  6006              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  6007           END-IF
  6008           PERFORM 1120-MATCH-CARRIER
  6009                                 THRU 1120-EXIT
  6010           PERFORM 1125-MATCH-STATE
  6011                                 THRU 1125-EXIT
  6012           PERFORM 1130-MATCH-BENCDS
  6013                                 THRU 1130-EXIT
  6014           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  6015           MOVE WS-LF-DESC       TO OUT-LF-DESC
  6016                                    OUT-ORIG-LF-DESC
  6017           IF WS-LF-EARN = 'B'
  6018              MOVE 'B'           TO OUT-BALLOON-IND
  6019           END-IF
  6020           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  6021                                    OUT-ORIG-WAIT-PER
  6022           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  6023                                    OUT-ORIG-RET-ELIM
  6024           MOVE WS-AH-DESC       TO OUT-AH-DESC
  6025                                    OUT-ORIG-AH-DESC
  6026           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  6027                                    OUT-ORIG-BEN-DAYS
  6028           PERFORM 1025-GET-CSR-INFO
  6029                                 THRU 1025-EXIT
  6030
  6031           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  6032           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  6033                                 TO WS-ERACCT-KEY (1:22)
  6034           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  6035           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  6036           IF ACCT-FOUND
  6037              MOVE AM-CSR-CODE      TO WS-CSR-ID
  6038              PERFORM 1025-GET-CSR-INFO
  6039                                    THRU 1025-EXIT
  6040              PERFORM 1300-DETERMINE-COMM
  6041                                    THRU 1300-EXIT
  6042           END-IF
  6043
  6044           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  6045                                 TO WS-ELCERT-KEY
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 106
* NSRASBL.cbl
  6046           PERFORM 1100-GET-ELCERT
  6047                                 THRU 1100-EXIT
  6048
  6049           IF BL-ENDT-ARCH-NO > ZERO
  6050              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  6051              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  6052              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6053           ELSE
  6054              IF BL-ARCHIVE-NO > ZERO
  6055                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  6056                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  6057                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6058              END-IF
  6059           END-IF
  6060
  6061           SET BL-OK TO TRUE
  6062           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
  6063              AND (OUT-BALLOON-IND = 'B')
  6064              MOVE 'B'           TO OUT-FORM (3:1)
  6065           END-IF
  6066        END-IF
  6067     END-IF
  6068     .
  6069 0400-EXIT.
  6070     EXIT.
  6071 0500-SCRUB-DATA.
  6072*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  6073*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  6074*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  6075*   TO A HEX 26 TO GET BY THE DECODER
  6076     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  6077                                 TO M1
  6078     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  6079     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6080        (A1 > M1)
  6081        OR (WS-WORK-FIELD (A1:1) = '*')
  6082        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6083        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6084     END-PERFORM
  6085     IF A1 > M1
  6086        CONTINUE
  6087     ELSE
  6088        MOVE WS-WORK-FIELD (1:A1 - 1)
  6089                                 TO OUT-ACCT-NAME
  6090     END-IF
  6091     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  6092                                 TO M1
  6093     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  6094     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6095        (A1 > M1)
  6096        OR (WS-WORK-FIELD (A1:1) = '*')
  6097        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6098        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6099     END-PERFORM
  6100     IF A1 > M1
  6101        CONTINUE
  6102     ELSE
  6103        MOVE WS-WORK-FIELD (1:A1 - 1)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 107
* NSRASBL.cbl
  6104                                 TO OUT-BENE-NAME
  6105     END-IF
  6106     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  6107         MOVE '0000000000 '  TO OUT-CERT-NO
  6108     END-IF
  6109     MOVE +1 TO M1
  6110     MOVE SPACES TO BL-RECORD-PASSED-DATA
  6111     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  6112                                 TO NS-LEN
  6113     display ' naper output data length ' ns-len
  6114     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6115        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  6116        OR (A1 > NS-LEN)
  6117        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  6118           CONTINUE
  6119        ELSE
  6120           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  6121              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  6122              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  6123              ADD +1 TO M1
  6124           ELSE
  6125              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  6126                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  6127                 ADD +3 TO M1
  6128              ELSE
  6129                 MOVE NAPER-OUTPUT-DATA (A1:1)
  6130                                 TO BL-RECORD-PASSED-DATA (M1:1)
  6131                 ADD +1 TO M1
  6132              END-IF
  6133           END-IF
  6134        END-IF
  6135     END-PERFORM
  6136     .
  6137 0500-EXIT.
  6138     EXIT.
  6139 0600-GET-ERENDT.
  6140
  6141* EXEC CICS READ
  6142*         DATASET    ('ERENDT2')
  6143*         INTO       (ENDORSEMENT-RECORD)
  6144*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  6145*         RESP       (WS-RESPONSE)
  6146*    END-EXEC
  6147     MOVE LENGTH OF
  6148      ENDORSEMENT-RECORD
  6149       TO DFHEIV11
  6150     MOVE 'ERENDT2' TO DFHEIV1
  6151*    MOVE '&"IL       E          (  N#00006011' TO DFHEIV0
  6152     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6154     MOVE X'204E233030303036303131' TO DFHEIV0(25:11)
  6155     CALL 'kxdfhei1' USING DFHEIV0,
  6156           DFHEIV1,
  6157           ENDORSEMENT-RECORD,
  6158           DFHEIV11,
  6159           WS-ERENDT-KEY-BY-ARCH,
  6160           DFHEIV99,
  6161           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 108
* NSRASBL.cbl
  6162           DFHEIV99
  6163     MOVE EIBRESP  TO WS-RESPONSE
  6164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6165     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  6166         WS-ERENDT-ARCHIVE
  6167     IF (RESP-NORMAL)
  6168        SET ENDT-FOUND TO TRUE
  6169        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  6170        PERFORM 0650-PROCESS-NO-Change
  6171                                 THRU 0650-EXIT
  6172     END-IF
  6173     .
  6174 0600-EXIT.
  6175     EXIT.
  6176 0620-BUILD-ENDT.
  6177     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  6178                                    OUT-NEW-LF-CAN-DT
  6179                                    OUT-ORIG-AH-CAN-DT
  6180                                    OUT-NEW-AH-CAN-DT
  6181                                    OUT-ORIG-CAN-DT
  6182                                    OUT-NEW-CAN-DT
  6183     IF EN-REC-TYPE = 'C'
  6184        GO TO 0620-PROCESS-CANCEL
  6185     END-IF
  6186     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  6187     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  6188     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6189     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  6190     IF WS-LF-EARN = 'B'
  6191        MOVE 'B'                 TO OUT-BALLOON-IND
  6192     END-IF
  6193     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  6194     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  6195     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  6196     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  6197     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  6198     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  6199     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  6200     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  6201         MOVE ZERO                 TO OUT-ORIG-IAGE
  6202     ELSE
  6203         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  6204     END-IF
  6205     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  6206     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  6207     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  6208     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  6209         MOVE ZERO                 TO OUT-ORIG-JAGE
  6210     ELSE
  6211         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  6212     END-IF
  6213     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  6214     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  6215     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  6216     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  6217     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  6218     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  6219     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 109
* NSRASBL.cbl
  6220                             EN-LF-ORIG-ALT-PRM-AMT
  6221     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  6222     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  6223         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  6224                                    OUT-ORIG-LF-PRM-A
  6225                                    OUT-ORIG-LF-ALT-BEN-A
  6226                                    OUT-ORIG-LF-ALT-PRM-A
  6227                                    OUT-ORIG-COVERAGE-IND
  6228     ELSE
  6229         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  6230         IF EN-LF-ORIG-PRM-AMT = .01
  6231             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  6232         END-IF
  6233         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  6234             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  6235         END-IF
  6236         IF EN-LF-ORIG-ALT-PRM-AMT = .01
  6237             MOVE SPACES         TO OUT-ORIG-LF-ALT-PRM-A
  6238         END-IF
  6239         IF EN-LF-ORIG-ALT-BEN-AMT = 999999999.99
  6240             MOVE SPACES         TO OUT-ORIG-LF-ALT-BEN-A
  6241         END-IF
  6242     END-IF
  6243     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6244     MOVE ' '                    TO DC-OPTION-CODE
  6245     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6246     IF NO-CONVERSION-ERROR
  6247        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6248           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6249              INTO OUT-ORIG-LF-EXP-DT
  6250        END-STRING
  6251     END-IF
  6252     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  6253     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  6254     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  6255     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  6256     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6257         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  6258                                    OUT-ORIG-AH-PRM-A
  6259     ELSE
  6260        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  6261            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  6262        ELSE
  6263            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  6264        END-IF
  6265        IF EN-AH-ORIG-PRM-AMT = .01
  6266            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  6267        END-IF
  6268        IF EN-AH-ORIG-BEN-AMT = 9999999.99
  6269            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  6270        END-IF
  6271     END-IF
  6272     COMPUTE WS-WORK-PREM =
  6273        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  6274           + EN-AH-ORIG-PRM-AMT
  6275     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  6276     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6277     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 110
* NSRASBL.cbl
  6278     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6279     IF NO-CONVERSION-ERROR
  6280        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6281           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6282              INTO OUT-ORIG-AH-EXP-DT
  6283        END-STRING
  6284     END-IF
  6285     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  6286                                    OUT-ORIG-MAX-PMTS
  6287     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6288         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  6289     END-IF
  6290     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  6291     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  6292     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  6293     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  6294         MOVE ZERO                TO OUT-NEW-IAGE
  6295     ELSE
  6296         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  6297     END-IF
  6298     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  6299     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  6300     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  6301     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  6302         MOVE ZERO                TO OUT-NEW-JAGE
  6303     ELSE
  6304         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  6305     END-IF
  6306     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  6307     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  6308     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6309     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  6310     IF WS-LF-EARN = 'B'
  6311        MOVE 'B'                 TO OUT-BALLOON-IND
  6312     END-IF
  6313     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  6314     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6315     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6316     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6317     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6318     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6319     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6320     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6321     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6322     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6323     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6324                             EN-LF-NEW-ALT-PRM-AMT
  6325     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6326     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6327         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6328                                    OUT-NEW-LF-PRM-A
  6329                                    OUT-NEW-LF-ALT-BEN-A
  6330                                    OUT-NEW-LF-ALT-PRM-A
  6331                                    OUT-NEW-LF-CMB-PREM-A
  6332                                    OUT-NEW-COVERAGE-IND
  6333     ELSE
  6334         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6335     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 111
* NSRASBL.cbl
  6336    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  6337     MOVE ' '                     TO DC-OPTION-CODE
  6338     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6339     IF NO-CONVERSION-ERROR
  6340        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6341           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6342              INTO OUT-NEW-LF-EXP-DT
  6343        END-STRING
  6344     END-IF
  6345     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6346     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6347     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6348     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6349     COMPUTE WS-WORK-PREM =
  6350        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6351           + EN-AH-NEW-PRM-AMT
  6352     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6353     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6354         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6355                                    OUT-NEW-AH-PRM-A
  6356     ELSE
  6357        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6358            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6359        ELSE
  6360            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6361        END-IF
  6362     END-IF
  6363     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6364     MOVE ' '                     TO DC-OPTION-CODE
  6365     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6366     IF NO-CONVERSION-ERROR
  6367        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6368           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6369              INTO OUT-NEW-AH-EXP-DT
  6370        END-STRING
  6371     END-IF
  6372     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6373                                     OUT-NEW-MAX-PMTS
  6374     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6375         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6376     END-IF
  6377     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6378        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6379     ELSE
  6380        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6381     END-IF
  6382     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6383        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6384     ELSE
  6385        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6386     END-IF
  6387     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6388        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6389     ELSE
  6390        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6391     END-IF
  6392     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6393        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 112
* NSRASBL.cbl
  6394     ELSE
  6395        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6396     END-IF
  6397     COMPUTE WS-WORK-PREM =
  6398        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6399        EN-AH-NEW-PRM-AMT) -
  6400        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6401        EN-AH-ORIG-PRM-AMT)
  6402     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6403     IF EN-CSO-PORTION NOT NUMERIC
  6404        MOVE ZEROS               TO EN-CSO-PORTION
  6405     END-IF
  6406     IF EN-ACCT-PORTION NOT NUMERIC
  6407        MOVE ZERO                TO EN-ACCT-PORTION
  6408     END-IF
  6409*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6410*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6411     IF WS-WORK-PREM > +0
  6412        MOVE 'CSO'               TO OUT-PAYEE
  6413     ELSE
  6414      IF WS-WORK-PREM = +0
  6415         MOVE 'ZERO'             TO OUT-PAYEE
  6416      ELSE
  6417         MOVE 'ACCT'             TO OUT-PAYEE
  6418      END-IF
  6419     END-IF
  6420     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6421        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6422     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6423     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6424        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6425     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6426     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6427        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6428        * EN-LF-ORIG-COMM-PCT
  6429     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6430     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6431        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6432     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6433     COMPUTE WS-ACCT-ORIG-PORTION =
  6434        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6435     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6436
  6437     COMPUTE WS-CSO-ORIG-LF-PORT =
  6438       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6439     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6440     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6441       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6442     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6443     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6444       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6445        WS-ACCT-ORIG-CMB-LF-PORT
  6446     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6447     COMPUTE WS-CSO-ORIG-AH-PORT =
  6448        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6449     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6450     COMPUTE WS-CSO-ORIG-PORTION =
  6451        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 113
* NSRASBL.cbl
  6452     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6453     COMPUTE WS-ACCT-NEW-LF-PORT =
  6454        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6455     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6456     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6457        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6458     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6459     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6460        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6461        * EN-LF-NEW-COMM-PCT
  6462     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6463     COMPUTE WS-ACCT-NEW-AH-PORT =
  6464        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6465     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6466     COMPUTE WS-ACCT-NEW-PORTION =
  6467        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6468     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6469
  6470     COMPUTE WS-CSO-NEW-LF-PORT =
  6471       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6472     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6473     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6474       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6475     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6476     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6477       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6478        WS-ACCT-NEW-CMB-LF-PORT
  6479     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6480     COMPUTE WS-CSO-NEW-AH-PORT =
  6481        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6482     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6483     COMPUTE WS-CSO-NEW-PORTION =
  6484        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6485     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6486
  6487     COMPUTE WS-ACCT-LF-PORT-CHG =
  6488        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6489     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6490     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6491        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6492     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6493     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6494        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6495     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6496     COMPUTE WS-ACCT-AH-PORT-CHG =
  6497        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6498     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6499     COMPUTE WS-ACCT-PORTION-CHG =
  6500        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6501     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6502
  6503     COMPUTE WS-CSO-LF-PORT-CHG =
  6504        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6505     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6506     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6507        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6508     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6509     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 114
* NSRASBL.cbl
  6510        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6511     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6512     COMPUTE WS-CSO-AH-PORT-CHG =
  6513        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6514     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6515     COMPUTE WS-CSO-PORTION-CHG =
  6516        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6517     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6518
  6519     COMPUTE WS-WORK-PREM =
  6520         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6521     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6522     COMPUTE WS-WORK-PREM =
  6523         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6524     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6525     COMPUTE WS-WORK-PREM =
  6526        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6527        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6528     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6529     COMPUTE WS-WORK-PREM =
  6530        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6531     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6532
  6533     move en-sig-sw              to out-sig-sw
  6534     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6535     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6536     GO TO 0620-CONTINUE
  6537     .
  6538 0620-PROCESS-CANCEL.
  6539     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6540        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6541        MOVE ' '                 TO DC-OPTION-CODE
  6542        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6543        IF NO-CONVERSION-ERROR
  6544           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6545              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6546                 INTO OUT-ORIG-LF-CAN-DT
  6547           END-STRING
  6548        END-IF
  6549        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6550     END-IF
  6551
  6552     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6553        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6554        MOVE ' '                 TO DC-OPTION-CODE
  6555        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6556        IF NO-CONVERSION-ERROR
  6557           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6558              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6559                 INTO OUT-NEW-LF-CAN-DT
  6560           END-STRING
  6561        END-IF
  6562        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6563     END-IF
  6564
  6565     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6566        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6567        MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 115
* NSRASBL.cbl
  6568        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6569        IF NO-CONVERSION-ERROR
  6570           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6571              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6572                 INTO OUT-ORIG-AH-CAN-DT
  6573           END-STRING
  6574        END-IF
  6575        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6576           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6577        END-IF
  6578     END-IF
  6579
  6580     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6581        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6582        MOVE ' '                    TO DC-OPTION-CODE
  6583        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6584        IF NO-CONVERSION-ERROR
  6585           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6586              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6587                 INTO OUT-NEW-AH-CAN-DT
  6588           END-STRING
  6589        END-IF
  6590        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6591           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6592        END-IF
  6593     END-IF
  6594     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6595     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6596     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6597     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6598     COMPUTE WS-WORK-PREM =
  6599        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6600     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6601     COMPUTE WS-WORK-PREM =
  6602        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6603     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6604     COMPUTE WS-WORK-PREM =
  6605        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6606        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6607     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6608
  6609     COMPUTE WS-WORK-PREM =
  6610        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6611     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6612     COMPUTE WS-WORK-PREM =
  6613        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6614     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6615
  6616*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6617*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6618     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6619
  6620     IF EN-COMM-CHGBK = 'N'
  6621         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6622                                   OUT-CSO-ORIG-ALT-LF-PORT
  6623         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6624         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6625         COMPUTE WS-CSO-ORIG-PORTION =
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 116
* NSRASBL.cbl
  6626             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6627         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6628         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6629                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6630                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6631                                   OUT-ACCT-ORIG-AH-PORT
  6632                                   OUT-ACCT-ORIG-PORTION
  6633
  6634         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6635                                   OUT-CSO-NEW-ALT-LF-PORT
  6636         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6637         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6638         COMPUTE WS-CSO-NEW-PORTION =
  6639             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6640         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6641         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6642                                   OUT-ACCT-NEW-ALT-LF-PORT
  6643                                   OUT-ACCT-NEW-CMB-LF-PORT
  6644                                   OUT-ACCT-NEW-AH-PORT
  6645                                   OUT-ACCT-NEW-PORTION
  6646
  6647         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6648                                   OUT-CSO-ALT-LF-PORT-CHG
  6649         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6650           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6651         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6652         COMPUTE WS-CSO-AH-PORT-CHG =
  6653           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6654         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6655         COMPUTE WS-CSO-PORTION-CHG =
  6656           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6657           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6658         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6659         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6660                                   OUT-ACCT-ALT-LF-PORT-CHG
  6661                                   OUT-ACCT-CMB-LF-PORT-CHG
  6662                                   OUT-ACCT-AH-PORT-CHG
  6663                                   OUT-ACCT-PORTION-CHG
  6664     ELSE
  6665         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6666                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6667         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6668           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6669         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6670                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6671         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6672           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6673         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6674         COMPUTE WS-ACCT-ORIG-PORTION =
  6675            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6676         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6677
  6678         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6679                                   OUT-CSO-ORIG-ALT-LF-PORT
  6680         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6681           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6682         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6683         COMPUTE WS-CSO-ORIG-AH-PORT =
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 117
* NSRASBL.cbl
  6684           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6685         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6686         COMPUTE WS-CSO-ORIG-PORTION =
  6687            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6688         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6689
  6690         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6691                                   OUT-ACCT-NEW-ALT-LF-PORT
  6692         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6693           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6694         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6695         COMPUTE WS-ACCT-NEW-AH-PORT =
  6696           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6697         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6698         COMPUTE WS-ACCT-NEW-PORTION =
  6699            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6700         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6701
  6702         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6703                                   OUT-CSO-NEW-ALT-LF-PORT
  6704         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6705           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6706         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6707         COMPUTE WS-CSO-NEW-AH-PORT =
  6708           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6709         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6710         COMPUTE WS-CSO-NEW-PORTION =
  6711            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6712         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6713
  6714         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6715                                    OUT-ACCT-ALT-LF-PORT-CHG
  6716         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6717            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6718         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6719         COMPUTE WS-ACCT-AH-PORT-CHG =
  6720            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6721         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6722         COMPUTE WS-ACCT-PORTION-CHG =
  6723            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6724         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6725
  6726         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6727                                    OUT-CSO-ALT-LF-PORT-CHG
  6728         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6729            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6730         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6731         COMPUTE WS-CSO-AH-PORT-CHG =
  6732            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6733         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6734         COMPUTE WS-CSO-PORTION-CHG =
  6735            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6736         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6737
  6738     END-IF
  6739     .
  6740 0620-CONTINUE.
  6741     display ' about to bld reason codes ' en-reason-code (1)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 118
* NSRASBL.cbl
  6742     move en-reason-code (1)     to out-rea-cd1
  6743     move en-reason-code (2)     to out-rea-cd2
  6744     move en-reason-code (3)     to out-rea-cd3
  6745     move en-reason-code (4)     to out-rea-cd4
  6746     move en-reason-code (5)     to out-rea-cd5
  6747     move en-reason-code (6)     to out-rea-cd6
  6748     move en-reason-code (7)     to out-rea-cd7
  6749     move en-reason-code (8)     to out-rea-cd8
  6750     move en-reason-code (9)     to out-rea-cd9
  6751     move en-reason-code (10)    to out-rea-cd10
  6752     move en-reason-code (11)    to out-rea-cd11
  6753     move en-reason-code (12)    to out-rea-cd12
  6754*    PERFORM 1300-DETERMINE-COMM
  6755*                                THRU 1300-EXIT
  6756     .
  6757 0620-EXIT.
  6758     EXIT.
  6759 0650-PROCESS-NO-Change.
  6760     IF EN-REC-TYPE = 'C'
  6761        GO TO 0650-PROCESS-CANCEL
  6762     END-IF
  6763     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6764        AND (OUT-NEW-ILNAME NOT = SPACES))
  6765                      AND
  6766        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6767        AND (OUT-NEW-IFNAME NOT = SPACES))
  6768                      AND
  6769        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6770        AND (OUT-NEW-IFNAME NOT = SPACES))
  6771        move 'No Change'         to out-new-Ifname
  6772        MOVE SPACES              TO OUT-NEW-IMINIT
  6773        move spaces              to out-new-Ilname
  6774     ELSE
  6775         IF OUT-NEW-ILNAME = SPACES
  6776           AND OUT-NEW-IFNAME = SPACES
  6777           AND OUT-NEW-IMINIT = SPACES
  6778           AND OUT-ORIG-ILNAME NOT = SPACES
  6779            MOVE 'None'          TO OUT-NEW-IFNAME
  6780            MOVE SPACES          TO OUT-NEW-IMINIT
  6781            MOVE SPACES          TO OUT-NEW-ILNAME
  6782         END-IF
  6783     END-IF
  6784     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6785        AND (OUT-NEW-JLNAME NOT = SPACES))
  6786                    AND
  6787        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6788        AND (OUT-NEW-JFNAME NOT = SPACES))
  6789                    AND
  6790        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6791        AND (OUT-NEW-JFNAME NOT = SPACES))
  6792        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6793        MOVE SPACES              TO OUT-NEW-JMINIT
  6794        MOVE SPACES              TO OUT-NEW-JLNAME
  6795     ELSE
  6796         IF OUT-NEW-JLNAME = SPACES
  6797           AND OUT-NEW-JFNAME = SPACES
  6798           AND OUT-NEW-JMINIT = SPACES
  6799           AND OUT-ORIG-JLNAME NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 119
* NSRASBL.cbl
  6800            MOVE 'None'          TO OUT-NEW-JFNAME
  6801            MOVE SPACES          TO OUT-NEW-JMINIT
  6802            MOVE SPACES          TO OUT-NEW-JLNAME
  6803         END-IF
  6804     END-IF
  6805     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6806        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6807        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6808     ELSE
  6809         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6810           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6811             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6812         END-IF
  6813     END-IF
  6814     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6815        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6816        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6817     ELSE
  6818         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6819           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6820             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6821         END-IF
  6822     END-IF
  6823     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6824        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6825        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6826     ELSE
  6827         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6828           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6829             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6830         END-IF
  6831     END-IF
  6832     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6833        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6834        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6835     ELSE
  6836         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6837           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6838             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6839         END-IF
  6840     END-IF
  6841
  6842     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6843                              EN-LF-ORIG-ALT-PRM-AMT
  6844     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6845                               EN-LF-NEW-ALT-PRM-AMT
  6846     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6847        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6848        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6849     ELSE
  6850         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6851           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6852            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6853         END-IF
  6854     END-IF
  6855     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6856        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6857     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 120
* NSRASBL.cbl
  6858     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6859        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6860        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6861     END-IF
  6862     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6863        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6864        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6865     ELSE
  6866        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6867          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6868            MOVE 'None'          TO OUT-NEW-LF-DESC
  6869        END-IF
  6870     end-if
  6871     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6872       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6873        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6874     END-IF
  6875     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6876        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6877        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6878     ELSE
  6879         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6880           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6881             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6882         END-IF
  6883     END-IF
  6884     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6885        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6886        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6887     ELSE
  6888         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6889           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6890             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6891         END-IF
  6892     END-IF
  6893     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6894        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6895        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6896     ELSE
  6897         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6898           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6899             MOVE 'None'         TO OUT-NEW-AH-DESC
  6900         END-IF
  6901     END-IF
  6902     IF EN-INS-ORIG-AGE-DEF-FLAG <> 'Y'
  6903         MOVE 'N' TO EN-INS-ORIG-AGE-DEF-FLAG
  6904     END-IF
  6905     IF EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6906         MOVE 'N' TO EN-INS-NEW-AGE-DEF-FLAG
  6907     END-IF
  6908     IF EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y'
  6909         MOVE 'N' TO EN-JNT-ORIG-AGE-DEF-FLAG
  6910     END-IF
  6911     IF EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6912         MOVE 'N' TO EN-JNT-NEW-AGE-DEF-FLAG
  6913     END-IF
  6914
  6915     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 121
* NSRASBL.cbl
  6916       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  6917       AND EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6918       AND EN-INS-NEW-LAST-NAME = EN-INS-ORIG-LAST-NAME
  6919       AND EN-INS-NEW-FIRST-NAME = EN-INS-ORIG-FIRST-NAME
  6920       AND EN-INS-NEW-MIDDLE-INIT = EN-INS-ORIG-MIDDLE-INIT
  6921        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6922     END-IF
  6923     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6924        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6925        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  6926        AND EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6927        AND EN-JNT-NEW-LAST-NAME = EN-JNT-ORIG-LAST-NAME
  6928        AND EN-JNT-NEW-FIRST-NAME = EN-JNT-ORIG-FIRST-NAME
  6929        AND EN-JNT-NEW-MIDDLE-INIT = EN-JNT-ORIG-MIDDLE-INIT
  6930        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6931     ELSE
  6932         IF (EN-JNT-ORIG-AGE > ZEROS)
  6933           AND (EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y')
  6934           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6935             MOVE 'None'         TO OUT-NEW-JAGE-A
  6936         END-IF
  6937     END-IF
  6938     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6939        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6940        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6941     ELSE
  6942         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6943           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6944             MOVE ZEROS          TO OUT-NEW-LF-TERM
  6945         END-IF
  6946     END-IF
  6947     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  6948        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  6949        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  6950     ELSE
  6951         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6952           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6953             MOVE ZEROS          TO OUT-NEW-AH-TERM
  6954         END-IF
  6955     END-IF
  6956     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  6957        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6958        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  6959                                    OUT-NEW-MAX-PMTS-A
  6960     ELSE
  6961         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6962           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6963             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  6964                                    OUT-NEW-MAX-PMTS-A
  6965         END-IF
  6966     END-IF
  6967     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  6968        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  6969     END-IF
  6970     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  6971       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  6972         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  6973     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 122
* NSRASBL.cbl
  6974         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6975           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6976             MOVE 'None'         TO OUT-NEW-WAIT-PER
  6977         END-IF
  6978     END-IF
  6979     .
  6980 0650-PROCESS-CANCEL.
  6981     .
  6982 0650-EXIT.
  6983     EXIT.
  6984 0700-WRITE-EXTR.
  6985     display ' made it to 0700 '
  6986     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  6987     IF BL-FAIL
  6988        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  6989        GO TO 0700-EXIT
  6990     END-IF
  6991     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  6992     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  6993     MOVE +0                     TO NSAS-SEQ-NO
  6994     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  6995     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  6996     IF BL-FAIL
  6997        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  6998        GO TO 0700-EXIT
  6999     END-IF
  7000     IF W-LETTER-TO-ACCT NOT = SPACES
  7001        display ' acct ne spaces ' bl-archive-no
  7002        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  7003        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7004        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7005        MOVE +1                  TO NSAS-SEQ-NO
  7006        PERFORM 0720-WRITE-NSASEXTR
  7007                                 THRU 0720-EXIT
  7008        IF BL-FAIL
  7009           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  7010           GO TO 0700-EXIT
  7011        END-IF
  7012     END-IF
  7013     IF W-LETTER-TO-BENE NOT = SPACES
  7014        display ' bene ne spaces ' bl-archive-no
  7015        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  7016        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7017        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7018        MOVE +2                  TO NSAS-SEQ-NO
  7019        PERFORM 0720-WRITE-NSASEXTR
  7020                                 THRU 0720-EXIT
  7021        IF BL-FAIL
  7022           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  7023        END-IF
  7024     END-IF
  7025     IF W-PRINT-CERTIFICATE = 'Y' AND
  7026        BL-STATE = 'VA'
  7027           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  7028           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  7029           MOVE BL-CARRIER          TO VD-CARRIER
  7030           MOVE BL-GROUP            TO VD-GROUPING
  7031           MOVE BL-STATE            TO VD-STATE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 123
* NSRASBL.cbl
  7032           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  7033           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  7034           MOVE BL-CERT-NO          TO VD-CERT-NO
  7035           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  7036           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  7037           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  7038           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  7039           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  7040           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  7041           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  7042           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  7043           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  7044           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  7045           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  7046           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  7047           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  7048           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  7049           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  7050           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  7051           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  7052           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  7053           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  7054           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  7055           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  7056           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  7057           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  7058           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  7059           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  7060           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  7061           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  7062           MOVE 'VADS'              TO VD-LETTER-ID
  7063           MOVE OUT-PROC-ID         TO VD-PROC-ID
  7064           MOVE BL-COMP-ID          TO VD-COMP-ID
  7065           MOVE EIBTIME             TO VD-CURRENT-TIME
  7066           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  7067           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  7068           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  7069
  7070* EXEC CICS LINK
  7071*              PROGRAM    (LINK-ELVADS)
  7072*              COMMAREA   (WS-PASS-AREA)
  7073*              LENGTH     (WS-PASS-AREA-LENGTH)
  7074*          END-EXEC
  7075*    MOVE '."C                   (   #00006921' TO DFHEIV0
  7076     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7077     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7078     MOVE X'2020233030303036393231' TO DFHEIV0(25:11)
  7079     CALL 'kxdfhei1' USING DFHEIV0,
  7080           LINK-ELVADS,
  7081           WS-PASS-AREA,
  7082           WS-PASS-AREA-LENGTH,
  7083           DFHEIV99,
  7084           DFHEIV99,
  7085           DFHEIV99,
  7086           DFHEIV99
  7087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7088     END-IF
  7089     .
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 124
* NSRASBL.cbl
  7090 0700-EXIT.
  7091     EXIT.
  7092  0710-BUILD-NSASEXTR.
  7093***  i added the extra space in front of the 1st ~
  7094***  only because there may be a letter to acct or bene
  7095     STRING
  7096         OUT-LETTER             ' ~'
  7097         OUT-PROC-ID            '~'
  7098         OUT-PROC-NAME          '~'
  7099         OUT-PROC-TITLE         '~'
  7100         OUT-CSR-NAME           '~'
  7101         OUT-CSR-TITLE          '~'
  7102         OUT-CARRIER            '~'
  7103         OUT-GROUPING           '~'
  7104         OUT-STATE              '~'
  7105         OUT-ACCOUNT            '~'
  7106         OUT-CERT-EFF-DT        '~'
  7107         OUT-CERT-NO            '~'
  7108         OUT-CERT-SFX           '~'
  7109         OUT-ILNAME             '~'
  7110         OUT-IFNAME             '~'
  7111         OUT-IFINIT             '~'
  7112         OUT-IMINIT             '~'
  7113         OUT-IAGE               '~'
  7114         OUT-ISEX               '~'
  7115         OUT-INS-ADDR1          '~'
  7116         OUT-INS-ADDR2          '~'
  7117         OUT-INS-CITY           '~'
  7118         OUT-INS-STATE          '~'
  7119         OUT-INS-ZIP            '~'
  7120         OUT-SOC-SEC-NO         '~'
  7121         OUT-MEMBER-NO          '~'
  7122         OUT-JLNAME             '~'
  7123         OUT-JFNAME             '~'
  7124         OUT-JMINIT             '~'
  7125         OUT-JAGE               '~'
  7126         OUT-ACCT-NAME          '~'
  7127         OUT-ACCT-ADDR1         '~'
  7128         OUT-ACCT-ADDR2         '~'
  7129         OUT-ACCT-CITY          '~'
  7130         OUT-ACCT-STATE         '~'
  7131         OUT-ACCT-ZIP           '~'
  7132         OUT-ACCT-PHONE         '~'
  7133         OUT-ACCT-CNTRL-NAME    '~'
  7134         OUT-ACCT-BUS-TYPE      '~'
  7135         OUT-BENE-NAME          '~'
  7136         OUT-BENE-ADDR1         '~'
  7137         OUT-BENE-ADDR2         '~'
  7138         OUT-BENE-CITY          '~'
  7139         OUT-BENE-STATE         '~'
  7140         OUT-BENE-ZIP           '~'
  7141         OUT-CARR-NAME          '~'
  7142         OUT-RESP-NO            '~'
  7143         OUT-COMP-NAME          '~'
  7144         OUT-COMP-MAIL-TO       '~'
  7145         OUT-COMP-ADDR1         '~'
  7146         OUT-COMP-ADDR2         '~'
  7147         OUT-COMP-CITY          '~'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 125
* NSRASBL.cbl
  7148         OUT-COMP-STATE         '~'
  7149         OUT-COMP-ZIP           '~'
  7150         OUT-COMP-PHONE         '~'
  7151         OUT-COMP-FAX           '~'
  7152         OUT-COMP-STATUS        '~'
  7153         OUT-BILL-SW            '~'
  7154         OUT-RPT-CD1            '~'
  7155         OUT-RPT-CD2            '~'
  7156         OUT-ENTRY-DT           '~'
  7157         OUT-ENTRY-BATCH        '~'
  7158         OUT-ENTRY-STATUS       '~'
  7159         OUT-1ST-PMT-DT         '~'
  7160         OUT-LOAN-APR           '~'
  7161         OUT-LOAN-TERM          '~'
  7162         OUT-RATE-CLASS         '~'
  7163         OUT-EXT-DAYS           '~'
  7164         OUT-CSR-CODE           '~'
  7165         OUT-UCODE              '~'
  7166         OUT-PREM-TYPE          '~'
  7167         OUT-IND-GRP            '~'
  7168         OUT-SKIP-CD            '~'
  7169         OUT-PMT-MODE           '~'
  7170         OUT-LOAN-OFF           '~'
  7171         OUT-REIN-TABLE         '~'
  7172         OUT-SPEC-REIN          '~'
  7173         OUT-LF-BENCD           '~'
  7174         OUT-LF-TERM            '~'
  7175         OUT-LF-DEV-CD          '~'
  7176         OUT-LF-DEV-PCT         '~'
  7177         OUT-LF-BEN             '~'
  7178         OUT-LF-PRM             '~'
  7179         OUT-LF-ALT-BEN         '~'
  7180         OUT-LF-ALT-PRM         '~'
  7181         OUT-LF-NSP             '~'
  7182         OUT-LF-REM-BEN         '~'
  7183         OUT-LF-REF             '~'
  7184         OUT-LF-DTH             '~'
  7185         OUT-LF-RATE            '~'
  7186         OUT-LF-ALT-RATE        '~'
  7187         OUT-LF-EXP-DT          '~'
  7188         OUT-LF-CUR-STATUS      '~'
  7189         OUT-LF-CAN-DT          '~'
  7190         OUT-LF-CAN-EXIT-DT     '~'
  7191         OUT-LF-DTH-DT          '~'
  7192         OUT-LF-DTH-EXIT-DT     '~'
  7193         OUT-LF-EXIT-BATCH      '~'
  7194         OUT-LF-COMM-PCT        '~'
  7195         OUT-LF-DESC            '~'
  7196         OUT-LF-ABBRV           '~'
  7197         OUT-AH-BENCD           '~'
  7198         OUT-AH-TERM            '~'
  7199         OUT-CRIT-PER           '~'
  7200         OUT-AH-DEV-CD          '~'
  7201         OUT-AH-DEV-PCT         '~'
  7202         OUT-AH-BEN             '~'
  7203         OUT-AH-PRM             '~'
  7204         OUT-AH-NSP             '~'
  7205         OUT-AH-REF             '~'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 126
* NSRASBL.cbl
  7206         OUT-AH-CLM             '~'
  7207         OUT-AH-TOT-BEN         '~'
  7208         OUT-AH-PDTHRU-DT       '~'
  7209         OUT-AH-RATE            '~'
  7210         OUT-AH-EXP-DT          '~'
  7211         OUT-AH-CUR-STATUS      '~'
  7212         OUT-AH-CAN-DT          '~'
  7213         OUT-AH-CAN-EXIT-DT     '~'
  7214         OUT-AH-EXIT-BATCH      '~'
  7215         OUT-AH-COMM-PCT        '~'
  7216         OUT-AH-DESC            '~'
  7217         OUT-RET-ELIM           '~'
  7218         OUT-BEN-DAYS           '~'
  7219         OUT-WAIT-PER           '~'
  7220         OUT-MAX-PMTS           '~'
  7221         OUT-TOT-PRM            '~'
  7222         OUT-TOT-REF            '~'
  7223         OUT-SCHED-EXP-DT       '~'
  7224         OUT-SCHED-TERM         '~'
  7225         OUT-ORIG-ILNAME        '~'
  7226         OUT-ORIG-IFNAME        '~'
  7227         OUT-ORIG-MINIT         '~'
  7228         OUT-ORIG-IAGE          '~'
  7229         OUT-ORIG-JLNAME        '~'
  7230         OUT-ORIG-JFNAME        '~'
  7231         OUT-ORIG-JMINIT        '~'
  7232         OUT-ORIG-JAGE          '~'
  7233         OUT-ORIG-LF-BENCD      '~'
  7234         OUT-ORIG-LF-TERM       '~'
  7235         OUT-ORIG-LF-BEN        '~'
  7236         OUT-ORIG-LF-PRM        '~'
  7237         OUT-LF-CALC-PRM        '~'
  7238         OUT-ORIG-LF-REF        '~'
  7239         OUT-LF-CALC-REF        '~'
  7240         OUT-ORIG-LF-ALT-BEN    '~'
  7241         OUT-ORIG-LF-ALT-PRM    '~'
  7242         OUT-ORIG-LF-EXP-DT     '~'
  7243         OUT-ORIG-LF-DESC       '~'
  7244         OUT-ORIG-AH-BENCD      '~'
  7245         OUT-ORIG-AH-TERM       '~'
  7246         OUT-ORIG-CRIT-PER      '~'
  7247         OUT-ORIG-AH-BEN        '~'
  7248         OUT-ORIG-AH-PRM        '~'
  7249         OUT-AH-CALC-PRM        '~'
  7250         OUT-ORIG-AH-REF        '~'
  7251         OUT-AH-CALC-REF        '~'
  7252         OUT-ORIG-AH-EXP-DT     '~'
  7253         OUT-ORIG-AH-DESC       '~'
  7254         OUT-ORIG-RET-ELIM      '~'
  7255         OUT-ORIG-BEN-DAYS      '~'
  7256         OUT-ORIG-WAIT-PER      '~'
  7257         OUT-ORIG-MAX-PMTS      '~'
  7258         OUT-ORIG-SCHED-EXP-DT  '~'
  7259         OUT-ORIG-SCHED-TERM    '~'
  7260         OUT-NEW-ILNAME         '~'
  7261         OUT-NEW-IFNAME         '~'
  7262         OUT-NEW-IMINIT         '~'
  7263         OUT-NEW-IAGE           '~'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 127
* NSRASBL.cbl
  7264         OUT-NEW-JLNAME         '~'
  7265         OUT-NEW-JFNAME         '~'
  7266         OUT-NEW-JMINIT         '~'
  7267         OUT-NEW-JAGE           '~'
  7268         OUT-NEW-LF-BENCD       '~'
  7269         OUT-NEW-LF-TERM        '~'
  7270         OUT-NEW-LF-BEN         '~'
  7271         OUT-NEW-LF-PRM         '~'
  7272         OUT-NEW-LF-REF         '~'
  7273         OUT-NEW-LF-ALT-BEN     '~'
  7274         OUT-NEW-LF-ALT-PRM     '~'
  7275         OUT-NEW-LF-EXP-DT      '~'
  7276         OUT-NEW-LF-DESC        '~'
  7277         OUT-NEW-AH-BENCD       '~'
  7278         OUT-NEW-AH-TERM        '~'
  7279         OUT-NEW-CRIT-PER       '~'
  7280         OUT-NEW-AH-BEN         '~'
  7281         OUT-NEW-AH-PRM         '~'
  7282         OUT-NEW-AH-REF         '~'
  7283         OUT-NEW-AH-EXP-DT      '~'
  7284         OUT-NEW-AH-DESC        '~'
  7285         OUT-NEW-RET-ELIM       '~'
  7286         OUT-NEW-BEN-DAYS       '~'
  7287         OUT-NEW-WAIT-PER       '~'
  7288         OUT-NEW-MAX-PMTS       '~'
  7289         OUT-NEW-SCHED-EXP-DT   '~'
  7290         OUT-NEW-SCHED-TERM     '~'
  7291         OUT-TOT-PRM-CHG        '~'
  7292         OUT-TOT-REF-CHG        '~'
  7293         OUT-PAYEE              '~'
  7294         OUT-SIG-SW             '~'
  7295         OUT-BALLOON-IND        '~'
  7296         OUT-LEASE-IND          '~'
  7297         OUT-RESCIND            '~'
  7298         OUT-REA-CD1            '~'
  7299         OUT-REA-CD2            '~'
  7300         OUT-REA-CD3            '~'
  7301         OUT-REA-CD4            '~'
  7302         OUT-REA-CD5            '~'
  7303         OUT-REA-CD6            '~'
  7304         OUT-REA-CD7            '~'
  7305         OUT-REA-CD8            '~'
  7306         OUT-REA-CD9            '~'
  7307         OUT-REA-CD10           '~'
  7308         OUT-REA-CD11           '~'
  7309         OUT-REA-CD12           '~'
  7310         OUT-CYCLE-DT           '~'
  7311         OUT-ARCH-NO            '~'
  7312         OUT-FORM               '~'
  7313         OUT-ENC-LINE           '~'
  7314         OUT-ATTACH             '~'
  7315         OUT-STACK              '~'
  7316         OUT-STATE-NAME         '~'
  7317         OUT-PRINT-NOW          '~'
  7318         OUT-CHGBACK            '~'
  7319         OUT-CSO-PORTION        '~'
  7320         OUT-ACCT-PORTION       '~'
  7321         OUT-LETTER-TYPE        '~'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 128
* NSRASBL.cbl
  7322         OUT-PRINT-CERTIFICATE  '~'
  7323         OUT-INS-BIRTHDATE      '~'
  7324         OUT-JNT-BIRTHDATE      '~'
  7325         OUT-TOT-INTEREST       '~'
  7326         OUT-ORIG-TOT-PREM      '~'
  7327         OUT-ORIG-TOT-REF       '~'
  7328         OUT-CANCEL-DT          '~'
  7329         OUT-HEALTH-APP         '~'
  7330         OUT-CERTIFICATE-ID     '~'
  7331         OUT-UNDW-ID            '~'
  7332         OUT-NEW-TOT-PREM       '~'
  7333         OUT-NEW-TOT-REF        '~'
  7334         OUT-COVERAGE-IND       '~'
  7335         OUT-ORIG-COVERAGE-IND  '~'
  7336         OUT-NEW-COVERAGE-IND   '~'
  7337         OUT-LF-CMB-PREM        '~'
  7338         OUT-ORIG-LF-CMB-PREM   '~'
  7339         OUT-NEW-LF-CMB-PREM    '~'
  7340         OUT-LF-PREM-CHG        '~'
  7341         OUT-LF-ALT-PREM-CHG    '~'
  7342         OUT-LF-CMB-PREM-CHG    '~'
  7343         OUT-AH-PREM-CHG        '~'
  7344         OUT-LF-REF-CHG         '~'
  7345         OUT-AH-REF-CHG         '~'
  7346         OUT-ACCT-LF-PORTION    '~'
  7347         OUT-ACCT-ALT-LF-PORT   '~'
  7348         OUT-ACCT-CMB-LF-PORT   '~'
  7349         OUT-ACCT-AH-PORTION    '~'
  7350         OUT-CSO-LF-PORTION     '~'
  7351         OUT-CSO-ALT-LF-PORT    '~'
  7352         OUT-CSO-CMB-LF-PORT    '~'
  7353         OUT-CSO-AH-PORTION     '~'
  7354         OUT-ACCT-ORIG-LF-PORT  '~'
  7355         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7356         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7357         OUT-ACCT-ORIG-AH-PORT  '~'
  7358         OUT-ACCT-ORIG-PORTION  '~'
  7359         OUT-CSO-ORIG-LF-PORT   '~'
  7360         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7361         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7362         OUT-CSO-ORIG-AH-PORT   '~'
  7363         OUT-CSO-ORIG-PORTION   '~'
  7364         OUT-ACCT-NEW-LF-PORT   '~'
  7365         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7366         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7367         OUT-ACCT-NEW-AH-PORT   '~'
  7368         OUT-ACCT-NEW-PORTION   '~'
  7369         OUT-CSO-NEW-LF-PORT    '~'
  7370         OUT-CSO-NEW-ALT-LF-PORT '~'
  7371         OUT-CSO-NEW-CMB-LF-PORT '~'
  7372         OUT-CSO-NEW-AH-PORT    '~'
  7373         OUT-CSO-NEW-PORTION    '~'
  7374         OUT-ACCT-LF-PORT-CHG   '~'
  7375         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7376         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7377         OUT-ACCT-AH-PORT-CHG   '~'
  7378         OUT-ACCT-PORTION-CHG   '~'
  7379         OUT-CSO-LF-PORT-CHG    '~'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 129
* NSRASBL.cbl
  7380         OUT-CSO-ALT-LF-PORT-CHG '~'
  7381         OUT-CSO-CMB-LF-PORT-CHG '~'
  7382         OUT-CSO-AH-PORT-CHG    '~'
  7383         OUT-CSO-PORTION-CHG    '~'
  7384         OUT-ORIG-LF-CAN-DT     '~'
  7385         OUT-NEW-LF-CAN-DT      '~'
  7386         OUT-ORIG-AH-CAN-DT     '~'
  7387         OUT-NEW-AH-CAN-DT      '~'
  7388         OUT-ORIG-CAN-DT        '~'
  7389         OUT-NEW-CAN-DT         '~'
  7390         OUT-SCREEN-ID          '~'
  7391         OUT-NEXT-BUS-DT        '~'
  7392            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7393     END-STRING
  7394     .
  7395 0710-exit.
  7396     EXIT.
  7397 0720-WRITE-NSASEXTR.
  7398
  7399* EXEC CICS WRITE
  7400*       DATASET    ('NSASEXTR')
  7401*       FROM       (NSAS-EXTRACT-RECORD)
  7402*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7403*       RESP       (WS-RESPONSE)
  7404*    END-EXEC
  7405     MOVE LENGTH OF
  7406      NSAS-EXTRACT-RECORD
  7407       TO DFHEIV11
  7408     MOVE 'NSASEXTR' TO DFHEIV1
  7409*    MOVE '&$ L                  ''  N#00007236' TO DFHEIV0
  7410     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7411     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7412     MOVE X'204E233030303037323336' TO DFHEIV0(25:11)
  7413     CALL 'kxdfhei1' USING DFHEIV0,
  7414           DFHEIV1,
  7415           NSAS-EXTRACT-RECORD,
  7416           DFHEIV11,
  7417           NSAS-CONTROL-PRIMARY,
  7418           DFHEIV99,
  7419           DFHEIV99
  7420     MOVE EIBRESP  TO WS-RESPONSE
  7421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7422     IF NOT RESP-NORMAL
  7423        display ' bad write nsasextr ' ws-response
  7424        SET BL-FAIL TO TRUE
  7425     END-IF
  7426     .
  7427 0720-EXIT.
  7428     EXIT.
  7429 0800-init-out-data.
  7430     MOVE ZEROS                  TO OUT-IAGE
  7431                                    OUT-JAGE
  7432                                    OUT-LOAN-APR
  7433                                    OUT-LOAN-TERM
  7434                                    OUT-EXT-DAYS
  7435                                    OUT-LF-TERM
  7436                                    OUT-AH-TERM
  7437                                    OUT-LF-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 130
* NSRASBL.cbl
  7438                                    OUT-AH-DEV-PCT
  7439                                    OUT-LF-BEN
  7440                                    OUT-AH-BEN
  7441                                    OUT-CRIT-PER
  7442                                    OUT-MAX-PMTS
  7443                                    OUT-SCHED-TERM
  7444                                    OUT-ORIG-IAGE
  7445                                    OUT-ORIG-JAGE
  7446                                    OUT-NEW-IAGE
  7447                                    OUT-NEW-JAGE
  7448                                    OUT-ORIG-LF-TERM
  7449                                    OUT-ORIG-AH-TERM
  7450                                    OUT-NEW-LF-TERM
  7451                                    OUT-NEW-AH-TERM
  7452                                    OUT-ORIG-CRIT-PER
  7453                                    OUT-ORIG-MAX-PMTS
  7454                                    OUT-ORIG-SCHED-TERM
  7455                                    OUT-NEW-SCHED-TERM
  7456                                    OUT-NEW-CRIT-PER
  7457                                    OUT-NEW-MAX-PMTS
  7458                                    OUT-CSO-PORTION
  7459                                    OUT-CSO-LF-PORTION
  7460                                    OUT-CSO-ALT-LF-PORT
  7461                                    OUT-CSO-CMB-LF-PORT
  7462                                    OUT-CSO-AH-PORTION
  7463                                    OUT-ACCT-PORTION
  7464                                    OUT-ACCT-LF-PORTION
  7465                                    OUT-ACCT-ALT-LF-PORT
  7466                                    OUT-ACCT-CMB-LF-PORT
  7467                                    OUT-ACCT-AH-PORTION
  7468                                    OUT-LF-PREM-CHG
  7469                                    OUT-LF-ALT-PREM-CHG
  7470                                    OUT-LF-CMB-PREM-CHG
  7471                                    OUT-AH-PREM-CHG
  7472                                    OUT-LF-REF-CHG
  7473                                    OUT-AH-REF-CHG
  7474     .
  7475 0800-exit.
  7476     exit.
  7477 1000-BUILD-ERARCH.
  7478* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7479*    1) FROM ACCT MAINT
  7480*    2) FROM CERT UPDATE
  7481*    3) FROM COMP MAINT
  7482*    4) FROM REVIEW AND CORRECTIONS
  7483******************************************************************
  7484     MOVE 'LA'                   TO LETTER-ARCHIVE
  7485     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7486                                    LA-ARCHIVE-NO-A2
  7487                                    LA-ARCHIVE-NO-A3
  7488                                    LA-ARCHIVE-NO-A4
  7489                                    LA-ARCHIVE-NO-A5
  7490                                    LA-ARCHIVE-NO-A6
  7491     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7492                                    LA-COMPANY-CD-A2
  7493                                    LA-COMPANY-CD-A3
  7494                                    LA-COMPANY-CD-A4
  7495                                    LA-COMPANY-CD-A5
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 131
* NSRASBL.cbl
  7496                                    LA-COMPANY-CD-A6
  7497     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7498                                    LA-CARRIER-A3
  7499                                    LA-CARRIER-A4
  7500                                    LA-CARRIER-A5
  7501     MOVE BL-GROUP               TO LA-GROUPING-A2
  7502                                    LA-GROUPING-A3
  7503                                    LA-GROUPING-A4
  7504                                    LA-GROUPING-A5
  7505     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7506                                    LA-ACCOUNT-A3
  7507                                    LA-ACCOUNT-A4
  7508                                    LA-ACCOUNT-A5
  7509     MOVE BL-STATE               TO LA-STATE-A2
  7510                                    LA-STATE-A3
  7511                                    LA-STATE-A4
  7512                                    LA-STATE-A5
  7513     IF BL-DATA-SRCE = '2' OR '4'
  7514        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7515        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7516     ELSE
  7517        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7518     END-IF
  7519     IF BL-DATA-SRCE = '4'
  7520        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7521     END-IF
  7522     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7523                                    LA-LAST-UPDATED-BY
  7524     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7525                                    LA-INITIAL-PRINT-DATE
  7526                                    LA-SENT-DATE
  7527                                    LA-REPLY-DATE
  7528                                    LA-RESEND-DATE
  7529                                    LA-FOLLOW-UP-DATE
  7530     MOVE 'A'                    TO LA-STATUS
  7531     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7532     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7533     IF W-DAYS-TO-RESEND NOT NUMERIC
  7534        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7535     END-IF
  7536     IF W-DAYS-TO-RESEND > ZEROS
  7537        MOVE SAVE-BIN-NEXT-BUS-DT TO DC-BIN-DATE-1
  7538        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7539        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7540        MOVE '6'                 TO DC-OPTION-CODE
  7541        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7542        IF NO-CONVERSION-ERROR
  7543           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7544        END-IF
  7545     END-IF
  7546     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7547        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7548        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7549        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7550        MOVE '6'                 TO DC-OPTION-CODE
  7551        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7552        IF NO-CONVERSION-ERROR
  7553           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 132
* NSRASBL.cbl
  7554        END-IF
  7555     END-IF
  7556
  7557     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7558     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7559     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7560     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7561     IF BL-ENDT-ARCH-NO > ZEROS
  7562        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7563     ELSE
  7564        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7565     END-IF
  7566     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7567                                    LA-LAST-MAINT-DATE
  7568     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7569                                    LA-NO-OF-TEXT-RECORDS
  7570     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7571
  7572* EXEC CICS WRITE
  7573*         DATASET   ('ERARCH')
  7574*         FROM      (LETTER-ARCHIVE)
  7575*         RIDFLD    (LA-CONTROL-PRIMARY)
  7576*         RESP      (WS-RESPONSE)
  7577*    END-EXEC
  7578     MOVE LENGTH OF
  7579      LETTER-ARCHIVE
  7580       TO DFHEIV11
  7581     MOVE 'ERARCH' TO DFHEIV1
  7582*    MOVE '&$ L                  ''  N#00007391' TO DFHEIV0
  7583     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7584     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7585     MOVE X'204E233030303037333931' TO DFHEIV0(25:11)
  7586     CALL 'kxdfhei1' USING DFHEIV0,
  7587           DFHEIV1,
  7588           LETTER-ARCHIVE,
  7589           DFHEIV11,
  7590           LA-CONTROL-PRIMARY,
  7591           DFHEIV99,
  7592           DFHEIV99
  7593     MOVE EIBRESP  TO WS-RESPONSE
  7594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7595     IF NOT RESP-NORMAL
  7596        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7597        la-archive-no
  7598        SET BL-FAIL TO TRUE
  7599     END-IF
  7600     .
  7601 1000-EXIT.
  7602     EXIT.
  7603 1025-GET-CSR-INFO.
  7604     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7605                                    OUT-CSR-TITLE
  7606                                    OUT-PROC-TITLE
  7607                                    OUT-UNDW-ID
  7608     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7609     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7610     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7611     MOVE +0                     TO WS-ELCNTL-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 133
* NSRASBL.cbl
  7612
  7613* EXEC CICS READ
  7614*       INTO    (CONTROL-FILE)
  7615*       DATASET ('ELCNTL')
  7616*       RIDFLD  (WS-ELCNTL-KEY)
  7617*       RESP    (WS-RESPONSE)
  7618*    END-EXEC
  7619     MOVE LENGTH OF
  7620      CONTROL-FILE
  7621       TO DFHEIV11
  7622     MOVE 'ELCNTL' TO DFHEIV1
  7623*    MOVE '&"IL       E          (  N#00007414' TO DFHEIV0
  7624     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7626     MOVE X'204E233030303037343134' TO DFHEIV0(25:11)
  7627     CALL 'kxdfhei1' USING DFHEIV0,
  7628           DFHEIV1,
  7629           CONTROL-FILE,
  7630           DFHEIV11,
  7631           WS-ELCNTL-KEY,
  7632           DFHEIV99,
  7633           DFHEIV99,
  7634           DFHEIV99
  7635     MOVE EIBRESP  TO WS-RESPONSE
  7636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7637     IF RESP-NORMAL
  7638        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7639                                    OUT-PROC-NAME
  7640*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7641*                                   OUT-PROC-TITLE
  7642     END-IF
  7643     IF BL-PROC-ID NOT = PB-CSR-ID
  7644        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7645        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7646        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7647                                    OUT-PROC-TITLE
  7648        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7649
  7650* EXEC CICS READ
  7651*          INTO    (CONTROL-FILE)
  7652*          DATASET ('ELCNTL')
  7653*          RIDFLD  (WS-ELCNTL-KEY)
  7654*          RESP    (WS-RESPONSE)
  7655*       END-EXEC
  7656     MOVE LENGTH OF
  7657      CONTROL-FILE
  7658       TO DFHEIV11
  7659     MOVE 'ELCNTL' TO DFHEIV1
  7660*    MOVE '&"IL       E          (  N#00007432' TO DFHEIV0
  7661     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7663     MOVE X'204E233030303037343332' TO DFHEIV0(25:11)
  7664     CALL 'kxdfhei1' USING DFHEIV0,
  7665           DFHEIV1,
  7666           CONTROL-FILE,
  7667           DFHEIV11,
  7668           WS-ELCNTL-KEY,
  7669           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 134
* NSRASBL.cbl
  7670           DFHEIV99,
  7671           DFHEIV99
  7672     MOVE EIBRESP  TO WS-RESPONSE
  7673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7674        IF RESP-NORMAL
  7675           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7676*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7677        END-IF
  7678     END-IF
  7679     .
  7680 1025-EXIT.
  7681     EXIT.
  7682 1050-GET-ERMAIL.
  7683     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7684
  7685* EXEC CICS READ
  7686*         DATASET    ('ERMAIL')
  7687*         INTO       (MAILING-DATA)
  7688*         RIDFLD     (WS-ERMAIL-KEY)
  7689*         RESP       (WS-RESPONSE)
  7690*    END-EXEC
  7691     MOVE LENGTH OF
  7692      MAILING-DATA
  7693       TO DFHEIV11
  7694     MOVE 'ERMAIL' TO DFHEIV1
  7695*    MOVE '&"IL       E          (  N#00007448' TO DFHEIV0
  7696     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7697     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7698     MOVE X'204E233030303037343438' TO DFHEIV0(25:11)
  7699     CALL 'kxdfhei1' USING DFHEIV0,
  7700           DFHEIV1,
  7701           MAILING-DATA,
  7702           DFHEIV11,
  7703           WS-ERMAIL-KEY,
  7704           DFHEIV99,
  7705           DFHEIV99,
  7706           DFHEIV99
  7707     MOVE EIBRESP  TO WS-RESPONSE
  7708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7709     IF RESP-NORMAL
  7710        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7711        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7712        MOVE MA-CITY             TO OUT-INS-CITY
  7713        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7714        MOVE MA-ZIP              TO OUT-INS-ZIP
  7715        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7716        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7717        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7718        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7719        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7720        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7721        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7722           MOVE MA-INSURED-BIRTH-DT
  7723                                 TO DC-BIN-DATE-1
  7724           MOVE ' '              TO DC-OPTION-CODE
  7725           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7726           IF NO-CONVERSION-ERROR
  7727              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 135
* NSRASBL.cbl
  7728                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7729                INTO OUT-INS-BIRTHDATE
  7730              END-STRING
  7731           END-IF
  7732        END-IF
  7733        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7734           MOVE MA-JOINT-BIRTH-DT
  7735                                 TO DC-BIN-DATE-1
  7736           MOVE ' '              TO DC-OPTION-CODE
  7737           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7738           IF NO-CONVERSION-ERROR
  7739              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7740                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7741                INTO OUT-JNT-BIRTHDATE
  7742              END-STRING
  7743           END-IF
  7744        END-IF
  7745     END-IF
  7746     .
  7747 1050-EXIT.
  7748     EXIT.
  7749 1100-GET-ELCERT.
  7750
  7751* EXEC CICS READ
  7752*         DATASET    ('ELCERT')
  7753*         INTO       (CERTIFICATE-MASTER)
  7754*         RIDFLD     (WS-ELCERT-KEY)
  7755*         RESP       (WS-RESPONSE)
  7756*    END-EXEC.
  7757     MOVE LENGTH OF
  7758      CERTIFICATE-MASTER
  7759       TO DFHEIV11
  7760     MOVE 'ELCERT' TO DFHEIV1
  7761*    MOVE '&"IL       E          (  N#00007495' TO DFHEIV0
  7762     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7764     MOVE X'204E233030303037343935' TO DFHEIV0(25:11)
  7765     CALL 'kxdfhei1' USING DFHEIV0,
  7766           DFHEIV1,
  7767           CERTIFICATE-MASTER,
  7768           DFHEIV11,
  7769           WS-ELCERT-KEY,
  7770           DFHEIV99,
  7771           DFHEIV99,
  7772           DFHEIV99
  7773     MOVE EIBRESP  TO WS-RESPONSE
  7774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7775
  7776     IF RESP-NORMAL
  7777        SET CERT-FOUND TO TRUE
  7778        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7779        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7780     END-IF
  7781     .
  7782 1100-EXIT.
  7783     EXIT.
  7784 1110-BUILD-CERT.
  7785     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 136
* NSRASBL.cbl
  7786     MOVE SPACES                 TO OUT-COVERAGE-IND
  7787     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7788     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7789     MOVE CM-CARRIER             TO OUT-CARRIER
  7790     MOVE CM-GROUPING            TO OUT-GROUPING
  7791     MOVE CM-STATE               TO OUT-STATE
  7792     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7793     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7794     MOVE ' '                    TO DC-OPTION-CODE
  7795     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7796     IF NO-CONVERSION-ERROR
  7797        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7798           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7799              INTO OUT-CERT-EFF-DT
  7800        END-STRING
  7801     END-IF
  7802     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7803     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7804                                    OUT-ORIG-ILNAME
  7805     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7806     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7807                                    OUT-ORIG-MINIT
  7808     IF (CM-SSN-STATE = CM-STATE)
  7809        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7810        MOVE SPACES              TO OUT-SOC-SEC-NO
  7811     ELSE
  7812        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7813     END-IF
  7814     IF (CM-MEMB-STATE = CM-STATE)
  7815        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7816        MOVE SPACES              TO OUT-MEMBER-NO
  7817     ELSE
  7818        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7819     END-IF
  7820     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7821                                    OUT-ORIG-IFNAME
  7822     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7823                                    OUT-ORIG-IAGE
  7824     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7825     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7826                                    OUT-ORIG-JAGE
  7827     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7828                                    OUT-ORIG-JLNAME
  7829     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7830                                    OUT-ORIG-JFNAME
  7831     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7832                                    OUT-ORIG-JMINIT
  7833     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7834                                    OUT-ORIG-LF-BENCD
  7835     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7836                                    OUT-ORIG-LF-TERM
  7837     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7838     IF CM-LF-DEV-PCT NOT NUMERIC
  7839        MOVE ZEROS               TO CM-LF-DEV-PCT
  7840     END-IF
  7841     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7842     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7843     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 137
* NSRASBL.cbl
  7844         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7845             MOVE ZERO           TO OUT-IAGE
  7846                                    OUT-ORIG-IAGE
  7847         END-IF
  7848         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7849             MOVE ZERO           TO OUT-JAGE
  7850                                    OUT-ORIG-JAGE
  7851         END-IF
  7852     END-IF
  7853
  7854     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7855        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7856          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7857           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7858             MOVE SPACES          TO OUT-LF-BENCD
  7859                                     WS-LF-BENCD
  7860                                     OUT-LF-CAN-DT
  7861             MOVE ZEROS           TO OUT-LF-TERM
  7862                                     OUT-LF-BEN
  7863                                     OUT-LF-PRM
  7864                                     OUT-LF-ALT-BEN
  7865                                     OUT-LF-ALT-PRM
  7866                                     OUT-LF-COMM-PCT
  7867                                     OUT-LF-NSP
  7868                                     OUT-LF-REM-BEN
  7869                                     WS-WORK-LF-PREM
  7870                                     WS-WORK-ALT-LF-PREM
  7871                                     WS-WORK-CMB-LF-PREM
  7872                                     OUT-LF-REF
  7873                                     OUT-ORIG-LF-REF
  7874                                     WS-WORK-LF-REF
  7875             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7876             GO TO 1100-LF-CONT
  7877        END-IF
  7878     END-IF
  7879
  7880     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7881        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7882             MOVE SPACES          TO OUT-LF-BENCD
  7883                                     WS-LF-BENCD
  7884                                     OUT-LF-CAN-DT
  7885             MOVE ZEROS           TO OUT-LF-TERM
  7886                                     OUT-LF-BEN
  7887                                     OUT-LF-PRM
  7888                                     OUT-LF-ALT-BEN
  7889                                     OUT-LF-ALT-PRM
  7890                                     OUT-LF-COMM-PCT
  7891                                     OUT-LF-NSP
  7892                                     OUT-LF-REM-BEN
  7893                                     WS-WORK-LF-PREM
  7894                                     WS-WORK-ALT-LF-PREM
  7895                                     WS-WORK-CMB-LF-PREM
  7896                                     OUT-LF-REF
  7897                                     OUT-ORIG-LF-REF
  7898                                     WS-WORK-LF-REF
  7899             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7900             GO TO 1100-LF-CONT
  7901        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 138
* NSRASBL.cbl
  7902     END-IF
  7903     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7904         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7905                                    OUT-ORIG-COVERAGE-IND
  7906     END-IF
  7907
  7908     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7909     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7910                                    OUT-ORIG-LF-BEN
  7911     IF CM-LF-BENEFIT-AMT = 999999999.99
  7912        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  7913     END-IF
  7914     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7915                                    OUT-ORIG-LF-PRM
  7916                                    WS-WORK-LF-PREM
  7917     IF CM-LF-PREMIUM-AMT = .01
  7918         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  7919     END-IF
  7920     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7921        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7922     END-IF
  7923     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7924                                    OUT-ORIG-LF-ALT-BEN
  7925     IF CM-LF-ALT-BENEFIT-AMT = 999999999.99
  7926        MOVE SPACES              TO OUT-ORIG-LF-ALT-BEN-A
  7927     END-IF
  7928     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7929        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7930     END-IF
  7931     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7932                                    OUT-ORIG-LF-ALT-PRM
  7933                                    WS-WORK-ALT-LF-PREM
  7934     IF CM-LF-ALT-PREMIUM-AMT = .01
  7935         MOVE SPACES             TO OUT-ORIG-LF-ALT-PRM-A
  7936     END-IF
  7937     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7938                             CM-LF-ALT-PREMIUM-AMT
  7939     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7940                                 OUT-ORIG-LF-CMB-PREM
  7941                                 WS-WORK-CMB-LF-PREM
  7942     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  7943        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  7944     END-IF
  7945     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  7946     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  7947     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  7948                                    OUT-ORIG-LF-REF
  7949                                    WS-WORK-LF-REF
  7950     IF CM-LF-DEATH-CLAIM-APPLIED
  7951        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7952            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  7953                                    OUT-ORIG-LF-REF
  7954                                    WS-WORK-LF-REF
  7955     END-IF
  7956     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  7957     MOVE ' '                    TO DC-OPTION-CODE
  7958     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7959     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 139
* NSRASBL.cbl
  7960        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7961           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7962              INTO OUT-LF-CAN-DT
  7963        END-STRING
  7964     END-IF
  7965
  7966     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7967         MOVE ZEROS          TO WS-WORK-LF-PREM
  7968                                WS-WORK-ALT-LF-PREM
  7969                                WS-WORK-CMB-LF-PREM
  7970     END-IF
  7971
  7972      .
  7973 1100-LF-CONT.
  7974
  7975     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  7976     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  7977        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  7978     END-IF
  7979     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  7980     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  7981        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  7982     END-IF
  7983     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  7984     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7985        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7986          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7987              MOVE SPACES              TO OUT-AH-BENCD
  7988                                          WS-AH-BENCD
  7989                                          OUT-AH-CAN-DT
  7990              MOVE ZEROS               TO OUT-AH-TERM
  7991                                          OUT-AH-BEN
  7992                                          OUT-AH-PRM
  7993                                          OUT-AH-NSP
  7994                                          OUT-AH-COMM-PCT
  7995                                          OUT-CRIT-PER
  7996                                          WS-WORK-AH-PREM
  7997                                          OUT-AH-REF
  7998                                          OUT-ORIG-AH-REF
  7999                                          WS-WORK-AH-REF
  8000              MOVE SPACES              TO OUT-MAX-PMTS-A
  8001                                          OUT-WAIT-PER
  8002                                          OUT-RET-ELIM
  8003                                          OUT-AH-DESC
  8004                                          OUT-BEN-DAYS
  8005              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8006             GO TO 1100-AH-CONT
  8007        END-IF
  8008     END-IF
  8009
  8010     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  8011        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8012              MOVE SPACES              TO OUT-AH-BENCD
  8013                                          WS-AH-BENCD
  8014                                          OUT-AH-CAN-DT
  8015              MOVE ZEROS               TO OUT-AH-TERM
  8016                                          OUT-AH-BEN
  8017                                          OUT-AH-PRM
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 140
* NSRASBL.cbl
  8018                                          OUT-AH-NSP
  8019                                          OUT-AH-COMM-PCT
  8020                                          OUT-CRIT-PER
  8021                                          WS-WORK-AH-PREM
  8022                                          OUT-AH-REF
  8023                                          OUT-ORIG-AH-REF
  8024                                          WS-WORK-AH-REF
  8025              MOVE SPACES              TO OUT-MAX-PMTS-A
  8026                                          OUT-WAIT-PER
  8027                                          OUT-RET-ELIM
  8028                                          OUT-AH-DESC
  8029                                          OUT-BEN-DAYS
  8030              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8031             GO TO 1100-AH-CONT
  8032        END-IF
  8033     END-IF
  8034     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  8035     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  8036                                    OUT-ORIG-AH-BENCD
  8037     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  8038        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  8039           CM-AH-BENEFIT-AMT
  8040        IF OUT-COVERAGE-IND = 'LIFE'
  8041            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  8042                                    OUT-ORIG-COVERAGE-IND
  8043        ELSE
  8044            MOVE 'AH  '          TO OUT-COVERAGE-IND
  8045                                    OUT-ORIG-COVERAGE-IND
  8046        END-IF
  8047     ELSE
  8048        MOVE ZEROS               TO OUT-AH-TOT-BEN
  8049     END-IF
  8050     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  8051                                    OUT-ORIG-AH-TERM
  8052     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  8053                                    OUT-ORIG-CRIT-PER
  8054                                    OUT-MAX-PMTS
  8055                                    OUT-ORIG-MAX-PMTS
  8056     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  8057         MOVE SPACES             TO OUT-MAX-PMTS-A
  8058     END-IF
  8059     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  8060     IF CM-AH-DEV-PCT NOT NUMERIC
  8061        MOVE ZEROS               TO CM-AH-DEV-PCT
  8062     END-IF
  8063     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  8064     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  8065                                    OUT-ORIG-AH-BEN
  8066     IF CM-AH-BENEFIT-AMT = 9999999.99
  8067        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  8068     END-IF
  8069     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  8070                                    OUT-ORIG-AH-PRM
  8071                                    WS-WORK-AH-PREM
  8072     IF CM-AH-PREMIUM-AMT = .01
  8073         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  8074     END-IF
  8075     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 141
* NSRASBL.cbl
  8076     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  8077                                    OUT-ORIG-AH-REF
  8078                                    WS-WORK-AH-REF
  8079     IF CM-AH-DEATH-CLAIM-APPLIED
  8080        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8081            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  8082                                    OUT-ORIG-AH-REF
  8083                                    WS-WORK-AH-REF
  8084     END-IF
  8085     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8086     MOVE ' '                    TO DC-OPTION-CODE
  8087     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8088     IF NO-CONVERSION-ERROR
  8089        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8090           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8091              INTO OUT-AH-CAN-DT
  8092        END-STRING
  8093     END-IF
  8094
  8095     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8096         MOVE ZEROS          TO WS-WORK-AH-PREM
  8097     END-IF
  8098
  8099      .
  8100 1100-AH-CONT.
  8101
  8102     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  8103     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  8104     MOVE ' '                    TO DC-OPTION-CODE
  8105     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8106     IF NO-CONVERSION-ERROR
  8107        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8108           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8109              INTO OUT-AH-PDTHRU-DT
  8110        END-STRING
  8111     END-IF
  8112     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  8113        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  8114     END-IF
  8115     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  8116     IF CM-LOAN-APR NOT NUMERIC
  8117        MOVE ZEROS               TO CM-LOAN-APR
  8118     END-IF
  8119     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  8120     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  8121     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  8122     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  8123     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  8124     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  8125     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  8126     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  8127     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  8128     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  8129     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8130     MOVE ' '                    TO DC-OPTION-CODE
  8131     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8132     IF NO-CONVERSION-ERROR
  8133        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 142
* NSRASBL.cbl
  8134           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8135              INTO OUT-LF-EXP-DT
  8136        END-STRING
  8137     END-IF
  8138     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  8139     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8140     MOVE ' '                    TO DC-OPTION-CODE
  8141     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8142     IF NO-CONVERSION-ERROR
  8143        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8144           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8145              INTO OUT-AH-EXP-DT
  8146        END-STRING
  8147     END-IF
  8148     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  8149     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  8150     MOVE ' '                    TO DC-OPTION-CODE
  8151     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8152     IF NO-CONVERSION-ERROR
  8153        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8154           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8155              INTO OUT-1ST-PMT-DT
  8156        END-STRING
  8157     END-IF
  8158     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  8159     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  8160     MOVE ' '                    TO DC-OPTION-CODE
  8161     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8162     IF NO-CONVERSION-ERROR
  8163        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8164           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8165              INTO OUT-ENTRY-DT
  8166        END-STRING
  8167     END-IF
  8168     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8169     MOVE ' '                    TO DC-OPTION-CODE
  8170     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8171     IF NO-CONVERSION-ERROR
  8172        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8173           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8174              INTO OUT-LF-CAN-EXIT-DT
  8175        END-STRING
  8176     END-IF
  8177     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  8178     MOVE ' '                    TO DC-OPTION-CODE
  8179     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8180     IF NO-CONVERSION-ERROR
  8181        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8182           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8183              INTO OUT-LF-DTH-DT
  8184        END-STRING
  8185     END-IF
  8186     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  8187     MOVE ' '                    TO DC-OPTION-CODE
  8188     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8189     IF NO-CONVERSION-ERROR
  8190        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8191           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 143
* NSRASBL.cbl
  8192              INTO OUT-LF-DTH-EXIT-DT
  8193        END-STRING
  8194     END-IF
  8195     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  8196     IF OUT-AH-CAN-DT NOT = SPACES
  8197        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  8198     ELSE
  8199        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  8200     END-IF
  8201     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8202     MOVE ' '                    TO DC-OPTION-CODE
  8203     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8204     IF NO-CONVERSION-ERROR
  8205        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8206           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8207              INTO OUT-AH-CAN-EXIT-DT
  8208        END-STRING
  8209     END-IF
  8210     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  8211     IF CM-ENTRY-BATCH = LOW-VALUES
  8212        MOVE SPACES              TO CM-ENTRY-BATCH
  8213     END-IF
  8214     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  8215     IF CM-LF-EXIT-BATCH = LOW-VALUES
  8216        MOVE SPACES              TO CM-LF-EXIT-BATCH
  8217     END-IF
  8218     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  8219     IF CM-AH-EXIT-BATCH = LOW-VALUES
  8220        MOVE SPACES              TO CM-AH-EXIT-BATCH
  8221     END-IF
  8222     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  8223     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  8224     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  8225     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  8226     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  8227     COMPUTE WS-WORK-PREM =
  8228        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  8229           + CM-AH-PREMIUM-AMT)
  8230     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  8231                                    OUT-ORIG-TOT-PREM
  8232     COMPUTE WS-WORK-REF =
  8233        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  8234     MOVE WS-WORK-REF            TO OUT-TOT-REF
  8235                                    OUT-ORIG-TOT-REF
  8236     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  8237        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  8238     ELSE
  8239        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  8240     END-IF
  8241     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  8242     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  8243        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  8244     ELSE
  8245        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  8246     END-IF
  8247     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  8248     IF CM-NH-INT-ON-REFS NUMERIC
  8249        IF CM-NH-INT-ON-REFS NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 144
* NSRASBL.cbl
  8250           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  8251        END-IF
  8252     END-IF
  8253
  8254     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8255        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8256            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8257        END-IF
  8258        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8259            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8260        END-IF
  8261     END-IF
  8262*
  8263*     IF BL-DATA-SRCE = '2'
  8264*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8265*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8266*        END-IF
  8267*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8268*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8269*        END-IF
  8270*     END-IF
  8271
  8272     COMPUTE WS-ACCT-LF-PORTION =
  8273        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  8274     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  8275                                OUT-ACCT-ORIG-LF-PORT
  8276     COMPUTE WS-ACCT-ALT-LF-PORTION =
  8277        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  8278     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  8279                                OUT-ACCT-ORIG-ALT-LF-PORT
  8280     COMPUTE WS-ACCT-CMB-LF-PORTION =
  8281        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  8282     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  8283                                OUT-ACCT-ORIG-CMB-LF-PORT
  8284     COMPUTE WS-ACCT-AH-PORTION =
  8285        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  8286     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  8287                                OUT-ACCT-ORIG-AH-PORT
  8288     COMPUTE WS-ACCT-PORTION =
  8289        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  8290     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  8291                                OUT-ACCT-ORIG-PORTION
  8292
  8293     COMPUTE WS-CSO-LF-PORTION =
  8294       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  8295     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  8296                               OUT-CSO-ORIG-LF-PORT
  8297     COMPUTE WS-CSO-ALT-LF-PORTION =
  8298       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  8299     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  8300                                   OUT-CSO-ORIG-ALT-LF-PORT
  8301     COMPUTE WS-CSO-CMB-LF-PORTION =
  8302       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  8303     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  8304                                   OUT-CSO-ORIG-CMB-LF-PORT
  8305     COMPUTE WS-CSO-AH-PORTION =
  8306        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  8307     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 145
* NSRASBL.cbl
  8308                               OUT-CSO-ORIG-AH-PORT
  8309     COMPUTE WS-CSO-PORTION =
  8310        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  8311     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  8312                            OUT-CSO-ORIG-PORTION
  8313     .
  8314 1110-EXIT.
  8315     EXIT.
  8316 1115-MATCH-COMPANY.
  8317     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8318     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8319     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8320
  8321* EXEC CICS READ
  8322*       INTO    (CONTROL-FILE)
  8323*       DATASET ('ELCNTL')
  8324*       RIDFLD  (WS-ELCNTL-KEY)
  8325*       RESP    (WS-RESPONSE)
  8326*    END-EXEC
  8327     MOVE LENGTH OF
  8328      CONTROL-FILE
  8329       TO DFHEIV11
  8330     MOVE 'ELCNTL' TO DFHEIV1
  8331*    MOVE '&"IL       E          (  N#00008045' TO DFHEIV0
  8332     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8334     MOVE X'204E233030303038303435' TO DFHEIV0(25:11)
  8335     CALL 'kxdfhei1' USING DFHEIV0,
  8336           DFHEIV1,
  8337           CONTROL-FILE,
  8338           DFHEIV11,
  8339           WS-ELCNTL-KEY,
  8340           DFHEIV99,
  8341           DFHEIV99,
  8342           DFHEIV99
  8343     MOVE EIBRESP  TO WS-RESPONSE
  8344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8345     IF RESP-NORMAL
  8346        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8347     END-IF
  8348     .
  8349 1115-EXIT.
  8350     EXIT.
  8351 1120-MATCH-CARRIER.
  8352     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8353     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8354     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8355     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8356
  8357* EXEC CICS READ
  8358*       INTO    (CONTROL-FILE)
  8359*       DATASET ('ELCNTL')
  8360*       RIDFLD  (WS-ELCNTL-KEY)
  8361*       RESP    (WS-RESPONSE)
  8362*    END-EXEC
  8363     MOVE LENGTH OF
  8364      CONTROL-FILE
  8365       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 146
* NSRASBL.cbl
  8366     MOVE 'ELCNTL' TO DFHEIV1
  8367*    MOVE '&"IL       E          (  N#00008062' TO DFHEIV0
  8368     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8370     MOVE X'204E233030303038303632' TO DFHEIV0(25:11)
  8371     CALL 'kxdfhei1' USING DFHEIV0,
  8372           DFHEIV1,
  8373           CONTROL-FILE,
  8374           DFHEIV11,
  8375           WS-ELCNTL-KEY,
  8376           DFHEIV99,
  8377           DFHEIV99,
  8378           DFHEIV99
  8379     MOVE EIBRESP  TO WS-RESPONSE
  8380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8381     IF RESP-NORMAL
  8382        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8383     ELSE
  8384        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8385     END-IF
  8386     .
  8387 1120-EXIT.
  8388     EXIT.
  8389 1125-MATCH-STATE.
  8390     MOVE BL-STATE               TO OUT-STATE
  8391     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8392     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8393     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8394     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8395
  8396* EXEC CICS READ
  8397*       INTO    (CONTROL-FILE)
  8398*       DATASET ('ELCNTL')
  8399*       RIDFLD  (WS-ELCNTL-KEY)
  8400*       RESP    (WS-RESPONSE)
  8401*    END-EXEC
  8402     MOVE LENGTH OF
  8403      CONTROL-FILE
  8404       TO DFHEIV11
  8405     MOVE 'ELCNTL' TO DFHEIV1
  8406*    MOVE '&"IL       E          (  N#00008082' TO DFHEIV0
  8407     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8408     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8409     MOVE X'204E233030303038303832' TO DFHEIV0(25:11)
  8410     CALL 'kxdfhei1' USING DFHEIV0,
  8411           DFHEIV1,
  8412           CONTROL-FILE,
  8413           DFHEIV11,
  8414           WS-ELCNTL-KEY,
  8415           DFHEIV99,
  8416           DFHEIV99,
  8417           DFHEIV99
  8418     MOVE EIBRESP  TO WS-RESPONSE
  8419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8420     IF RESP-NORMAL
  8421        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8422     ELSE
  8423        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 147
* NSRASBL.cbl
  8424     END-IF
  8425     .
  8426 1125-EXIT.
  8427     EXIT.
  8428 1130-MATCH-BENCDS.
  8429     MOVE SPACES                 TO WS-LF-ABBRV
  8430                                    WS-LF-DESC
  8431                                    WS-LF-EARN
  8432                                    WS-WAIT-PER
  8433                                    WS-RET-ELIM
  8434                                    WS-AH-DESC
  8435                                    WS-BEN-DAYS
  8436     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8437        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8438     END-IF
  8439     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8440        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8441     END-IF
  8442     .
  8443 1130-EXIT.
  8444     EXIT.
  8445 1140-MATCH-LFBEN.
  8446     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8447     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8448     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8449     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8450
  8451* EXEC CICS READ
  8452*       INTO    (CONTROL-FILE)
  8453*       DATASET ('ELCNTL')
  8454*       RIDFLD  (WS-ELCNTL-KEY)
  8455*       GTEQ
  8456*       RESP    (WS-RESPONSE)
  8457*    END-EXEC
  8458     MOVE LENGTH OF
  8459      CONTROL-FILE
  8460       TO DFHEIV11
  8461     MOVE 'ELCNTL' TO DFHEIV1
  8462*    MOVE '&"IL       G          (  N#00008118' TO DFHEIV0
  8463     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8464     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8465     MOVE X'204E233030303038313138' TO DFHEIV0(25:11)
  8466     CALL 'kxdfhei1' USING DFHEIV0,
  8467           DFHEIV1,
  8468           CONTROL-FILE,
  8469           DFHEIV11,
  8470           WS-ELCNTL-KEY,
  8471           DFHEIV99,
  8472           DFHEIV99,
  8473           DFHEIV99
  8474     MOVE EIBRESP  TO WS-RESPONSE
  8475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8476     IF RESP-NORMAL
  8477        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8478           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8479           OR (S1 > +8)
  8480        END-PERFORM
  8481        IF S1 < + 9
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 148
* NSRASBL.cbl
  8482           MOVE CF-BENEFIT-ALPHA (S1)
  8483                                 TO WS-LF-ABBRV
  8484           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8485           MOVE CF-CO-EARNINGS-CALC (S1)
  8486                                 TO WS-LF-EARN
  8487        ELSE
  8488           MOVE 'XX'             TO WS-LF-DESC
  8489           MOVE 'XXX'            TO WS-LF-ABBRV
  8490        END-IF
  8491     ELSE
  8492        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8493     END-IF
  8494     .
  8495 1140-EXIT.
  8496     EXIT.
  8497 1150-MATCH-AHBEN.
  8498     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8499     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8500     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8501     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8502
  8503* EXEC CICS READ
  8504*       INTO    (CONTROL-FILE)
  8505*       DATASET ('ELCNTL')
  8506*       RIDFLD  (WS-ELCNTL-KEY)
  8507*       GTEQ
  8508*       RESP    (WS-RESPONSE)
  8509*    END-EXEC
  8510     MOVE LENGTH OF
  8511      CONTROL-FILE
  8512       TO DFHEIV11
  8513     MOVE 'ELCNTL' TO DFHEIV1
  8514*    MOVE '&"IL       G          (  N#00008151' TO DFHEIV0
  8515     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8517     MOVE X'204E233030303038313531' TO DFHEIV0(25:11)
  8518     CALL 'kxdfhei1' USING DFHEIV0,
  8519           DFHEIV1,
  8520           CONTROL-FILE,
  8521           DFHEIV11,
  8522           WS-ELCNTL-KEY,
  8523           DFHEIV99,
  8524           DFHEIV99,
  8525           DFHEIV99
  8526     MOVE EIBRESP  TO WS-RESPONSE
  8527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8528     IF RESP-NORMAL
  8529        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8530           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8531           OR (S1 > +8)
  8532        END-PERFORM
  8533        IF S1 < + 9
  8534           MOVE CF-BENEFIT-ALPHA (S1)
  8535                                 TO WS-WAIT-PER
  8536           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8537                                 TO WS-RET-ELIM
  8538           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8539                                 TO WS-BEN-DAYS
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 149
* NSRASBL.cbl
  8540           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8541              IF CF-JOINT-INDICATOR (S1) = 'J'
  8542                 MOVE 'Joint Critical Period Disability'
  8543                                 TO WS-AH-DESC
  8544              ELSE
  8545                 MOVE 'Single Critical Period-Primary Only'
  8546                                 TO WS-AH-DESC
  8547              END-IF
  8548           ELSE
  8549              IF CF-JOINT-INDICATOR (S1) = 'J'
  8550                 MOVE 'Joint Disability'
  8551                                 TO WS-AH-DESC
  8552              ELSE
  8553                 MOVE 'Single Disability (Primary Only)'
  8554                                 TO WS-AH-DESC
  8555              END-IF
  8556           END-IF
  8557        ELSE
  8558           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8559        END-IF
  8560     ELSE
  8561        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8562     END-IF
  8563     .
  8564 1150-EXIT.
  8565     EXIT.
  8566
  8567 1160-READ-CERT-TRAILER.
  8568
  8569     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8570     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8571     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8572
  8573
  8574* EXEC CICS HANDLE CONDITION
  8575*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8576*    END-EXEC.
  8577*    MOVE '"$I                   ! " #00008203' TO DFHEIV0
  8578     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8579     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8580     MOVE X'2220233030303038323033' TO DFHEIV0(25:11)
  8581     CALL 'kxdfhei1' USING DFHEIV0
  8582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8583
  8584
  8585
  8586* EXEC CICS READ
  8587*        DATASET  ('ELCRTT')
  8588*        RIDFLD   (WS-ELCRTT-KEY)
  8589*        INTO     (CERTIFICATE-TRAILERS)
  8590*    END-EXEC.
  8591     MOVE LENGTH OF
  8592      CERTIFICATE-TRAILERS
  8593       TO DFHEIV11
  8594     MOVE 'ELCRTT' TO DFHEIV1
  8595*    MOVE '&"IL       E          (   #00008207' TO DFHEIV0
  8596     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8597     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 150
* NSRASBL.cbl
  8598     MOVE X'2020233030303038323037' TO DFHEIV0(25:11)
  8599     CALL 'kxdfhei1' USING DFHEIV0,
  8600           DFHEIV1,
  8601           CERTIFICATE-TRAILERS,
  8602           DFHEIV11,
  8603           WS-ELCRTT-KEY,
  8604           DFHEIV99,
  8605           DFHEIV99,
  8606           DFHEIV99
  8607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8608
  8609
  8610     GO TO 1160-EXIT.
  8611
  8612 1160-CERT-TRL-REC-NOTFND.
  8613     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8614
  8615 1160-EXIT.
  8616     EXIT.
  8617 1200-GET-ERACCT.
  8618     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8619     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8620                                    OUT-ACCT-ADDR1
  8621                                    OUT-ACCT-ADDR2
  8622                                    OUT-ACCT-CITY
  8623     MOVE ZEROS                  TO WS-CHGBACK
  8624
  8625* EXEC CICS STARTBR
  8626*        DATASET   ('ERACCT')
  8627*        RIDFLD    (WS-ERACCT-KEY)
  8628*        GTEQ
  8629*        RESP      (WS-RESPONSE)
  8630*    END-EXEC
  8631     MOVE 'ERACCT' TO DFHEIV1
  8632     MOVE 0
  8633       TO DFHEIV11
  8634*    MOVE '&,         G          &  N#00008227' TO DFHEIV0
  8635     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8636     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8637     MOVE X'204E233030303038323237' TO DFHEIV0(25:11)
  8638     CALL 'kxdfhei1' USING DFHEIV0,
  8639           DFHEIV1,
  8640           WS-ERACCT-KEY,
  8641           DFHEIV99,
  8642           DFHEIV11,
  8643           DFHEIV99
  8644     MOVE EIBRESP  TO WS-RESPONSE
  8645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8646     IF RESP-NORMAL
  8647
  8648* EXEC CICS READNEXT
  8649*          INTO    (ACCOUNT-MASTER)
  8650*          DATASET ('ERACCT')
  8651*          RIDFLD  (WS-ERACCT-KEY)
  8652*          RESP    (WS-RESPONSE)
  8653*       END-EXEC
  8654     MOVE LENGTH OF
  8655      ACCOUNT-MASTER
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 151
* NSRASBL.cbl
  8656       TO DFHEIV12
  8657     MOVE 'ERACCT' TO DFHEIV1
  8658     MOVE 0
  8659       TO DFHEIV11
  8660*    MOVE '&.IL                  )  N#00008234' TO DFHEIV0
  8661     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8662     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8663     MOVE X'204E233030303038323334' TO DFHEIV0(25:11)
  8664     CALL 'kxdfhei1' USING DFHEIV0,
  8665           DFHEIV1,
  8666           ACCOUNT-MASTER,
  8667           DFHEIV12,
  8668           WS-ERACCT-KEY,
  8669           DFHEIV99,
  8670           DFHEIV11,
  8671           DFHEIV99,
  8672           DFHEIV99
  8673     MOVE EIBRESP  TO WS-RESPONSE
  8674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8675     END-IF
  8676     IF RESP-NORMAL
  8677        PERFORM UNTIL
  8678           NOT (RESP-NORMAL)
  8679           OR (WS-SAVE-ERACCT-KEY NOT =
  8680                        AM-CONTROL-PRIMARY (1:20))
  8681           IF BL-DATA-SRCE = '4' OR '2'
  8682              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8683                 AND >= AM-EFFECTIVE-DT)
  8684                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8685                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8686                    OR (S1 > +10)
  8687                 END-PERFORM
  8688                 IF S1 < +11
  8689                    MOVE AM-COMM-CHARGEBACK (S1)
  8690                                 TO WS-CHGBACK
  8691                 END-IF
  8692              END-IF
  8693           END-IF
  8694           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8695
  8696* EXEC CICS READNEXT
  8697*             INTO    (ACCOUNT-MASTER)
  8698*             DATASET ('ERACCT')
  8699*             RIDFLD  (WS-ERACCT-KEY)
  8700*             RESP    (WS-RESPONSE)
  8701*          END-EXEC
  8702     MOVE LENGTH OF
  8703      ACCOUNT-MASTER
  8704       TO DFHEIV12
  8705     MOVE 'ERACCT' TO DFHEIV1
  8706     MOVE 0
  8707       TO DFHEIV11
  8708*    MOVE '&.IL                  )  N#00008260' TO DFHEIV0
  8709     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8711     MOVE X'204E233030303038323630' TO DFHEIV0(25:11)
  8712     CALL 'kxdfhei1' USING DFHEIV0,
  8713           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 152
* NSRASBL.cbl
  8714           ACCOUNT-MASTER,
  8715           DFHEIV12,
  8716           WS-ERACCT-KEY,
  8717           DFHEIV99,
  8718           DFHEIV11,
  8719           DFHEIV99,
  8720           DFHEIV99
  8721     MOVE EIBRESP  TO WS-RESPONSE
  8722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8723        END-PERFORM
  8724        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8725        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8726           SET ACCT-FOUND TO TRUE
  8727           MOVE AM-NAME          TO OUT-ACCT-NAME
  8728           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8729           MOVE SPACES           TO OUT-ACCT-ADDR2
  8730           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8731           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8732           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8733           MOVE AM-CONTROL-NAME  TO OUT-ACCT-CNTRL-NAME
  8734           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8735           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8736           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8737              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8738                 INTO OUT-ACCT-ZIP (6:5)
  8739              END-STRING
  8740           END-IF
  8741           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8742           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8743           MOVE AM-STATE         TO OUT-FORM
  8744           IF AM-ACCOUNT (10:1) = 'L'
  8745              MOVE 'L'           TO OUT-FORM (3:1)
  8746                                    OUT-LEASE-IND
  8747           END-IF
  8748           MOVE AM-CONTROL-PRIMARY (1:8)
  8749                                 TO WS-ERCOMP-KEY
  8750           IF AM-REMIT-TO NOT NUMERIC
  8751              MOVE 01            TO AM-REMIT-TO
  8752           END-IF
  8753           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8754           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8755              (AM-COM-TYP (S1) = 'C' OR 'D')
  8756              OR (S1 > +10)
  8757           END-PERFORM
  8758           IF S1 < +11
  8759              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8760           END-IF
  8761           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8762           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8763        END-IF
  8764     END-IF
  8765
  8766* EXEC CICS ENDBR
  8767*        DATASET   ('ERACCT')
  8768*    END-EXEC
  8769     MOVE 'ERACCT' TO DFHEIV1
  8770     MOVE 0
  8771       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 153
* NSRASBL.cbl
  8772*    MOVE '&2                    $   #00008308' TO DFHEIV0
  8773     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8774     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8775     MOVE X'2020233030303038333038' TO DFHEIV0(25:11)
  8776     CALL 'kxdfhei1' USING DFHEIV0,
  8777           DFHEIV1,
  8778           DFHEIV11,
  8779           DFHEIV99
  8780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8781    .
  8782 1200-EXIT.
  8783     EXIT.
  8784 1225-GET-ERCOMP.
  8785
  8786* EXEC CICS READ
  8787*       INTO    (COMPENSATION-MASTER)
  8788*       DATASET ('ERCOMP')
  8789*       RIDFLD  (WS-ERCOMP-KEY)
  8790*       RESP    (WS-RESPONSE)
  8791*    END-EXEC
  8792     MOVE LENGTH OF
  8793      COMPENSATION-MASTER
  8794       TO DFHEIV11
  8795     MOVE 'ERCOMP' TO DFHEIV1
  8796*    MOVE '&"IL       E          (  N#00008315' TO DFHEIV0
  8797     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8799     MOVE X'204E233030303038333135' TO DFHEIV0(25:11)
  8800     CALL 'kxdfhei1' USING DFHEIV0,
  8801           DFHEIV1,
  8802           COMPENSATION-MASTER,
  8803           DFHEIV11,
  8804           WS-ERCOMP-KEY,
  8805           DFHEIV99,
  8806           DFHEIV99,
  8807           DFHEIV99
  8808     MOVE EIBRESP  TO WS-RESPONSE
  8809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8810     IF RESP-NORMAL
  8811        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8812        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8813        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8814        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8815        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8816        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8817        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8818        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8819        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8820        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8821        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8822        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8823     END-IF
  8824     .
  8825 1225-EXIT.
  8826     EXIT.
  8827 1250-GET-ELLETR.
  8828     display ' made it to 1250 '
  8829     move spaces                 to W-Z-CONTROL-DATA
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 154
* NSRASBL.cbl
  8830     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8831     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8832     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8833
  8834* EXEC CICS READ
  8835*         DATASET    ('ELLETR')
  8836*         INTO       (TEXT-FILES)
  8837*         RIDFLD     (WS-ELLETR-KEY)
  8838*         RESP       (WS-RESPONSE)
  8839*         GTEQ
  8840*    END-EXEC
  8841     MOVE LENGTH OF
  8842      TEXT-FILES
  8843       TO DFHEIV11
  8844     MOVE 'ELLETR' TO DFHEIV1
  8845*    MOVE '&"IL       G          (  N#00008344' TO DFHEIV0
  8846     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8847     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8848     MOVE X'204E233030303038333434' TO DFHEIV0(25:11)
  8849     CALL 'kxdfhei1' USING DFHEIV0,
  8850           DFHEIV1,
  8851           TEXT-FILES,
  8852           DFHEIV11,
  8853           WS-ELLETR-KEY,
  8854           DFHEIV99,
  8855           DFHEIV99,
  8856           DFHEIV99
  8857     MOVE EIBRESP  TO WS-RESPONSE
  8858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8859     IF RESP-NORMAL
  8860        IF (LETTER-FILE-TEXT)
  8861           AND (BL-LETTER-ID = TX-LETTER-NO)
  8862           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8863           display ' found good z record '
  8864           PERFORM 1280-PROCESS-Z-CONTROLS
  8865                                 THRU 1280-EXIT
  8866        END-IF
  8867     END-IF
  8868     .
  8869 1250-EXIT.
  8870     EXIT.
  8871 1280-PROCESS-Z-CONTROLS.
  8872     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8873*    IF W-FORM-TO-RESEND > SPACES
  8874*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8875*    ELSE
  8876*       MOVE SPACES              TO OUT-FORM
  8877*    END-IF
  8878     IF BL-ENC-CD = SPACES OR LOW-VALUES
  8879        MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8880     END-IF
  8881     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8882     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8883     .
  8884 1280-EXIT.
  8885     EXIT.
  8886 1300-DETERMINE-COMM.
  8887******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 155
* NSRASBL.cbl
  8888* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8889*    1) FROM ACCT MAINT
  8890*    2) FROM CERT UPDATE
  8891*    3) FROM COMP MAINT
  8892*    4) FROM REVIEW AND CORRECTIONS
  8893******************************************************************
  8894     MOVE 'Y'                    TO OUT-CHGBACK
  8895     MOVE ZEROS                  TO WS-DIFF
  8896                                    WS-CHGBK-LIFE-PCT
  8897                                    WS-CHGBK-AH-PCT
  8898     IF BL-DATA-SRCE = '4'
  8899        IF PB-CANCELLATION
  8900           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8901           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8902           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8903           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8904           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8905              MOVE PB-C-LF-CANCEL-DT
  8906                                 TO DC-BIN-DATE-2
  8907           END-IF
  8908           MOVE '1'              TO DC-OPTION-CODE
  8909           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8910           IF NO-CONVERSION-ERROR
  8911              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8912              IF DC-ODD-DAYS-OVER > +1
  8913                 ADD +1          TO WS-DIFF
  8914              END-IF
  8915              IF (WS-CHGBACK = 99)
  8916                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8917                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8918                                WS-CHGBK-AH-PCT
  8919                   MOVE 'N'  TO OUT-CHGBACK
  8920              END-IF
  8921           END-IF
  8922        ELSE
  8923           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8924           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8925        END-IF
  8926     ELSE
  8927        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8928        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8929        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8930           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8931           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8932           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8933           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8934              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8935           END-IF
  8936           MOVE '1'              TO DC-OPTION-CODE
  8937           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8938           IF NO-CONVERSION-ERROR
  8939              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8940              IF DC-ODD-DAYS-OVER > +1
  8941                 ADD +1          TO WS-DIFF
  8942              END-IF
  8943              IF (WS-CHGBACK = 99)
  8944                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8945                   MOVE +0   TO WS-CHGBK-LIFE-PCT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 156
* NSRASBL.cbl
  8946                                WS-CHGBK-AH-PCT
  8947                   MOVE 'N'  TO OUT-CHGBACK
  8948              END-IF
  8949           END-IF
  8950        END-IF
  8951     END-IF
  8952     .
  8953 1300-EXIT.
  8954     EXIT.
  8955 1500-GET-ARCH-NO.
  8956     DISPLAY ' MADE IT TO 1500 '
  8957     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  8958     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8959     MOVE SPACES                 TO WS-ELCNTL-GENL
  8960     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8961
  8962* EXEC CICS READ
  8963*       INTO    (CONTROL-FILE)
  8964*       DATASET ('ELCNTL')
  8965*       RIDFLD  (WS-ELCNTL-KEY)
  8966*       UPDATE
  8967*       RESP    (WS-RESPONSE)
  8968*    END-EXEC
  8969     MOVE LENGTH OF
  8970      CONTROL-FILE
  8971       TO DFHEIV11
  8972     MOVE 'ELCNTL' TO DFHEIV1
  8973*    MOVE '&"IL       EU         (  N#00008453' TO DFHEIV0
  8974     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8975     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8976     MOVE X'204E233030303038343533' TO DFHEIV0(25:11)
  8977     CALL 'kxdfhei1' USING DFHEIV0,
  8978           DFHEIV1,
  8979           CONTROL-FILE,
  8980           DFHEIV11,
  8981           WS-ELCNTL-KEY,
  8982           DFHEIV99,
  8983           DFHEIV99,
  8984           DFHEIV99
  8985     MOVE EIBRESP  TO WS-RESPONSE
  8986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8987     IF RESP-NORMAL
  8988        AND (CF-COMPANY-ID  = BL-COMP-ID)
  8989        AND (CF-RECORD-TYPE = '1')
  8990        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  8991        MOVE CF-CREDIT-LAST-ARCH-NUM
  8992                                 TO WS-ARCHIVE-NO
  8993
  8994* EXEC CICS REWRITE
  8995*          FROM    (CONTROL-FILE)
  8996*          DATASET ('ELCNTL')
  8997*       END-EXEC
  8998     MOVE LENGTH OF
  8999      CONTROL-FILE
  9000       TO DFHEIV11
  9001     MOVE 'ELCNTL' TO DFHEIV1
  9002*    MOVE '&& L                  %   #00008466' TO DFHEIV0
  9003     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 157
* NSRASBL.cbl
  9004     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9005     MOVE X'2020233030303038343636' TO DFHEIV0(25:11)
  9006     CALL 'kxdfhei1' USING DFHEIV0,
  9007           DFHEIV1,
  9008           CONTROL-FILE,
  9009           DFHEIV11,
  9010           DFHEIV99
  9011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9012     ELSE
  9013        MOVE +0                  TO WS-ARCHIVE-NO
  9014     END-IF
  9015    .
  9016 1500-EXIT.
  9017     EXIT.
  9018 1700-GET-ELENCC.
  9019     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  9020     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  9021     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  9022     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  9023        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  9024        OR (E1 > +5)
  9025     END-PERFORM
  9026     IF E1 < +5
  9027        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  9028     END-IF
  9029
  9030* EXEC CICS READ
  9031*        DATASET   ('ELENCC')
  9032*        INTO      (ENCLOSURE-CODES)
  9033*        RIDFLD    (WS-ELENCC-KEY)
  9034*        RESP      (WS-RESPONSE)
  9035*    END-EXEC
  9036     MOVE LENGTH OF
  9037      ENCLOSURE-CODES
  9038       TO DFHEIV11
  9039     MOVE 'ELENCC' TO DFHEIV1
  9040*    MOVE '&"IL       E          (  N#00008487' TO DFHEIV0
  9041     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9043     MOVE X'204E233030303038343837' TO DFHEIV0(25:11)
  9044     CALL 'kxdfhei1' USING DFHEIV0,
  9045           DFHEIV1,
  9046           ENCLOSURE-CODES,
  9047           DFHEIV11,
  9048           WS-ELENCC-KEY,
  9049           DFHEIV99,
  9050           DFHEIV99,
  9051           DFHEIV99
  9052     MOVE EIBRESP  TO WS-RESPONSE
  9053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9054     IF NOT RESP-NORMAL
  9055        display ' elencc resp not normal ' ws-response
  9056        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  9057
  9058* EXEC CICS READ
  9059*           DATASET   ('ELENCC')
  9060*           INTO      (ENCLOSURE-CODES)
  9061*           RIDFLD    (WS-ELENCC-KEY)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 158
* NSRASBL.cbl
  9062*           RESP      (WS-RESPONSE)
  9063*       END-EXEC
  9064     MOVE LENGTH OF
  9065      ENCLOSURE-CODES
  9066       TO DFHEIV11
  9067     MOVE 'ELENCC' TO DFHEIV1
  9068*    MOVE '&"IL       E          (  N#00008496' TO DFHEIV0
  9069     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9071     MOVE X'204E233030303038343936' TO DFHEIV0(25:11)
  9072     CALL 'kxdfhei1' USING DFHEIV0,
  9073           DFHEIV1,
  9074           ENCLOSURE-CODES,
  9075           DFHEIV11,
  9076           WS-ELENCC-KEY,
  9077           DFHEIV99,
  9078           DFHEIV99,
  9079           DFHEIV99
  9080     MOVE EIBRESP  TO WS-RESPONSE
  9081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9082     END-IF
  9083     IF RESP-NORMAL
  9084        display ' elencc resp normal ' ws-response
  9085        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  9086        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  9087        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  9088     END-IF
  9089     .
  9090 1700-EXIT.
  9091     EXIT.
  9092
  9093
  9094 4100-CONNECT-TO-DB.
  9095
  9096     MOVE 'NTCSO2_LOGIC'         TO SVR
  9097     MOVE 'sa'                   TO USR
  9098     MOVE 'ntcso2'               TO PASS
  9099
  9100     STRING
  9101         USR DELIMITED SPACE
  9102         "." DELIMITED SIZE
  9103         PASS DELIMITED SPACE INTO USR-PASS
  9104     END-STRING
  9105
  9106     EXEC SQL
  9107        CONNECT TO :SVR USER :USR-PASS
  9108     END-EXEC
  9109
  9110     IF SQLCODE NOT = 0
  9111        DISPLAY "ERROR: CANNOT CONNECT "
  9112        DISPLAY SQLCODE
  9113        DISPLAY SQLERRMC
  9114        GO TO 4100-EXIT
  9115     END-IF
  9116
  9117     .
  9118 4100-EXIT.
  9119     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 159
* NSRASBL.cbl
  9120
  9121
  9122
  9123 4200-GET-NEXT-BUS-DT.
  9124
  9125     MOVE WS-SAVE-EDIT-A-DATE    TO WS-CYCLE-DATE
  9126     MOVE SPACES                 TO WS-NEXT-BUS-DT
  9127
  9128     IF WS-KIXHOST = 'logictest'
  9129        EXEC SQL
  9130          CALL NaperTestCalcNextBusDt
  9131                        @cycledate = :WS-CYCLE-DATE,
  9132                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9133        END-EXEC
  9134     ELSE
  9135        EXEC SQL
  9136          CALL NaperProdCalcNextBusDt
  9137                        @cycledate = :WS-CYCLE-DATE,
  9138                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9139        END-EXEC
  9140     END-IF
  9141
  9142     IF SQLCODE NOT = 0
  9143        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
  9144        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9145        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9146        GO TO 4200-EXIT
  9147     END-IF
  9148
  9149     .
  9150 4200-EXIT.
  9151     EXIT.
  9152
  9153
  9154 9700-DATE-LINK.
  9155
  9156* EXEC CICS LINK
  9157*        PROGRAM   ('ELDATCV')
  9158*        COMMAREA  (DATE-CONVERSION-DATA)
  9159*        LENGTH    (DC-COMM-LENGTH)
  9160*    END-EXEC.
  9161     MOVE 'ELDATCV' TO DFHEIV1
  9162*    MOVE '."C                   (   #00008575' TO DFHEIV0
  9163     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9165     MOVE X'2020233030303038353735' TO DFHEIV0(25:11)
  9166     CALL 'kxdfhei1' USING DFHEIV0,
  9167           DFHEIV1,
  9168           DATE-CONVERSION-DATA,
  9169           DC-COMM-LENGTH,
  9170           DFHEIV99,
  9171           DFHEIV99,
  9172           DFHEIV99,
  9173           DFHEIV99
  9174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9175
  9176 9700-EXIT.
  9177      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 160
* NSRASBL.cbl
  9178
  9179 9999-DFHBACK SECTION.
  9180     MOVE '9%                    "   ' TO DFHEIV0
  9181     MOVE 'NSRASBL' TO DFHEIV1
  9182     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9183     GOBACK.
  9184 9999-DFHEXIT.
  9185     IF DFHEIGDJ EQUAL 0001
  9186         NEXT SENTENCE
  9187     ELSE IF DFHEIGDJ EQUAL 2
  9188         GO TO 1160-CERT-TRL-REC-NOTFND
  9189         DEPENDING ON DFHEIGDI.
  9190     MOVE '9%                    "   ' TO DFHEIV0
  9191     MOVE 'NSRASBL' TO DFHEIV1
  9192     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9193     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      168468     Code:       57263
