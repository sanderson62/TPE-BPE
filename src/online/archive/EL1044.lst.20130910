* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   1
* EL1044.cbl
* Options: int("EL1044.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1044.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1044.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1044.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1044.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   2
* EL1044.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS FOR ACCOUNT SERVICES
    19*    SCREENS     - EL1044Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31******************************************************************
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 122011    2011022800001  AJRA  ADD ELCZREC COPYBOOK
    40* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    41* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
    42******************************************************************
    43 ENVIRONMENT DIVISION.
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*   EL1044 WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    50 77  M1                          PIC S999 COMP-3 VALUE +0.
    51 77  M2                          PIC S999 COMP-3 VALUE +0.
    52 77  WS-STOP-SW                  PIC X  VALUE ' '.
    53     88  I-SAY-TO-STOP              VALUE 'Y'.
    54 77  WS-FIND-SW                  PIC X  VALUE ' '.
    55     88  WE-FOUND-IT                VALUE 'Y'.
    56 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    57 01  ACCESS-KEYS.
    58     12  ELLETR-KEY.
    59         16  ELLETR-COMPANY-CD   PIC X.
    60         16  ELLETR-ACCESS-CD    PIC X(12).
    61         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    62 01  WS-DATE-AREA.
    63     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    64     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    65 01  MISC-WORK-AREAS.
    66     12  WS-RESPONSE             PIC S9(8)   COMP.
    67         88  RESP-NORMAL              VALUE +00.
    68         88  RESP-ERROR               VALUE +01.
    69         88  RESP-NOTFND              VALUE +13.
    70         88  RESP-NOTOPEN             VALUE +19.
    71         88  RESP-ENDFILE             VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   3
* EL1044.cbl
    72     12  WS-NUMVAL.
    73         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    74         16  WS-9V999-OF-DEEDIT REDEFINES
    75             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    76     12  DEEDIT-FIELD                PIC X(11).
    77     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    78                                     PIC S9(11).
    79     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    80                                     PIC S9(09)V99.
    81 01  STANDARD-AREAS.
    82     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
    83     12  TRANS-ID                    PIC X(04)   VALUE 'EX1F'.
    84     12  PGM-NAME                    PIC X(08).
    85     12  TIME-IN                     PIC S9(07).
    86     12  TIME-OUT-R  REDEFINES TIME-IN.
    87         16  FILLER                  PIC X(01).
    88         16  TIME-OUT                PIC 99V99.
    89         16  FILLER                  PIC X(02).
    90     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
    91     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
    92     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
    93     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
    94     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
    95     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
    96     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
    97     12  THIS-PGM                    PIC X(08)   VALUE 'EL1044'.
    98     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
    99     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   100     12  SUB                         PIC 9(02).
   101     12  SUB-1                       PIC 9(02).
   102     12  SUB2                        PIC 9(02).
   103     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   104     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1044S'.
   105     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL1044Z'.
   106     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   107****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   108*                                    COPY ELCZREC.
   109******************************************************************
   110*                                                                *
   111*                                                                *
   112*                            ELCZREC.                            *
   113*                                                                *
   114*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   115*                                                                *
   116******************************************************************
   117*-----------------------------------------------------------------
   118*                   C H A N G E   L O G
   119*
   120* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   121*-----------------------------------------------------------------
   122*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   123* EFFECTIVE    NUMBER
   124*-----------------------------------------------------------------
   125* 122011    2011022800001  AJRA  NEW FILE
   126* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   127* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   128*-----------------------------------------------------------------
   129 01  W-Z-CONTROL-DATA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   4
* EL1044.cbl
   130     05  W-NUMBER-OF-COPIES      PIC  9.
   131     05  FILLER                  PIC  X.
   132     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   133     05  FILLER                  PIC  X.
   134     05  W-DAYS-TO-RESEND        PIC  999.
   135     05  FILLER                  PIC  X.
   136     05  W-FORM-TO-RESEND        PIC  X(4).
   137     05  FILLER                  PIC  X.
   138     05  W-PROMPT-LETTER         PIC  X.
   139     05  FILLER                  PIC  X.
   140     05  W-ENCLOSURE-CD          PIC  XXX.
   141     05  FILLER                  PIC  X.
   142     05  W-AUTO-CLOSE-IND        PIC  X.
   143     05  FILLER                  PIC  X.
   144     05  W-LETTER-TO-BENE        PIC  X.
   145     05  FILLER                  PIC  X.
   146     05  W-LETTER-TO-ACCT        PIC  X.
   147     05  FILLER                  PIC  X.
   148     05  W-LETTER-TYPE           PIC  X.
   149     05  FILLER                  PIC  X.
   150     05  W-PRINT-CERTIFICATE     PIC  X.
   151     05  FILLER                  PIC  X.
   152     05  W-REFUND-REQUIRED       PIC  X.
   153     05  FILLER                  PIC  X.
   154     05  W-ONBASE-CODE           PIC  XX.
   155     05  FILLER                  PIC  X.
   156     05  W-ACCT-SUMM             PIC  X.
   157     05  FILLER                  PIC  X.
   158     05  W-CSO-SUMM              PIC  X.
   159     05  FILLER                  PIC  X.
   160     05  W-REASONS-REQUIRED      PIC  X.
   161     05  FILLER                  PIC  X(29).
   162*                                    COPY ELCSCTM.
   163******************************************************************
   164*                                                                *
   165*                                                                *
   166*                            ELCSCTM                             *
   167*                            VMOD=2.001                          *
   168*                                                                *
   169*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   170*                                                                *
   171******************************************************************
   172 01  SECURITY-MESSAGE.
   173     12  FILLER                          PIC X(30)
   174            VALUE '** LOGIC SECURITY VIOLATION -'.
   175     12  SM-READ                         PIC X(6).
   176     12  FILLER                          PIC X(5)
   177            VALUE ' PGM='.
   178     12  SM-PGM                          PIC X(6).
   179     12  FILLER                          PIC X(5)
   180            VALUE ' OPR='.
   181     12  SM-PROCESSOR-ID                 PIC X(4).
   182     12  FILLER                          PIC X(6)
   183            VALUE ' TERM='.
   184     12  SM-TERMID                       PIC X(4).
   185     12  FILLER                          PIC XX   VALUE SPACE.
   186     12  SM-JUL-DATE                     PIC 9(5).
   187     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   5
* EL1044.cbl
   188     12  SM-TIME                         PIC 99.99.
   189
   190*                                    COPY ELCSCRTY.
   191******************************************************************
   192*                                                                *
   193*                                                                *
   194*                            ELCSCRTY                            *
   195*                            VMOD=2.001                          *
   196*                                                                *
   197*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   198*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   199*        SAVED IN PI-SECURITY-ADDRESS.                           *
   200*                                                                *
   201******************************************************************
   202 01  SECURITY-CONTROL.
   203     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   204     12  FILLER                       PIC XX    VALUE 'SC'.
   205     12  SC-CREDIT-CODES.
   206         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   207             20  SC-CREDIT-DISPLAY    PIC X.
   208             20  SC-CREDIT-UPDATE     PIC X.
   209     12  SC-CLAIMS-CODES.
   210         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   211             20  SC-CLAIMS-DISPLAY    PIC X.
   212             20  SC-CLAIMS-UPDATE     PIC X.
   213 01  ERROR-MESSAGES.
   214     12  ER-0000                     PIC X(04)   VALUE '0000'.
   215     12  ER-0005                     PIC X(04)   VALUE '0005'.
   216     12  ER-0023                     PIC X(04)   VALUE '0023'.
   217     12  ER-0029                     PIC X(04)   VALUE '0029'.
   218     12  ER-0050                     PIC X(04)   VALUE '0050'.
   219     12  ER-0068                     PIC X(04)   VALUE '0068'.
   220     12  ER-0070                     PIC X(04)   VALUE '0070'.
   221     12  ER-0130                     PIC X(04)   VALUE '0130'.
   222     12  ER-0131                     PIC X(04)   VALUE '0131'.
   223     12  ER-0132                     PIC X(04)   VALUE '0132'.
   224     12  ER-0138                     PIC X(04)   VALUE '0138'.
   225     12  ER-0144                     PIC X(04)   VALUE '0144'.
   226     12  ER-0145                     PIC X(04)   VALUE '0145'.
   227     12  ER-0184                     PIC X(04)   VALUE '0184'.
   228     12  ER-0418                     PIC X(04)   VALUE '0418'.
   229     12  ER-0491                     PIC X(04)   VALUE '0491'.
   230     12  ER-0582                     PIC X(04)   VALUE '0582'.
   231     12  ER-0627                     PIC X(04)   VALUE '0627'.
   232     12  ER-0701                     PIC X(04)   VALUE '0701'.
   233     12  ER-0702                     PIC X(04)   VALUE '0702'.
   234     12  ER-0703                     PIC X(04)   VALUE '0703'.
   235     12  ER-0704                     PIC X(04)   VALUE '0704'.
   236     12  ER-0705                     PIC X(04)   VALUE '0705'.
   237     12  ER-0706                     PIC X(04)   VALUE '0706'.
   238     12  ER-0707                     PIC X(04)   VALUE '0707'.
   239     12  ER-0708                     PIC X(04)   VALUE '0708'.
   240     12  ER-0709                     PIC X(04)   VALUE '0709'.
   241     12  ER-0710                     PIC X(04)   VALUE '0710'.
   242     12  ER-0711                     PIC X(04)   VALUE '0711'.
   243     12  ER-0712                     PIC X(04)   VALUE '0712'.
   244     12  ER-0713                     PIC X(04)   VALUE '0713'.
   245     12  ER-0717                     PIC X(04)   VALUE '0717'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   6
* EL1044.cbl
   246     12  ER-0718                     PIC X(04)   VALUE '0718'.
   247     12  ER-0719                     PIC X(04)   VALUE '0719'.
   248     12  ER-0720                     PIC X(04)   VALUE '0720'.
   249     12  ER-0721                     PIC X(04)   VALUE '0721'.
   250     12  ER-0722                     PIC X(04)   VALUE '0722'.
   251     12  ER-0723                     PIC X(04)   VALUE '0723'.
   252     12  ER-0724                     PIC X(04)   VALUE '0724'.
   253     12  ER-0725                     PIC X(04)   VALUE '0725'.
   254     12  ER-0726                     PIC X(04)   VALUE '0726'.
   255     12  ER-0727                     PIC X(04)   VALUE '0727'.
   256     12  ER-0729                     PIC X(04)   VALUE '0729'.
   257     12  ER-0754                     PIC X(04)   VALUE '0754'.
   258     12  ER-1560                     PIC X(04)   VALUE '1560'.
   259     12  ER-1562                     PIC X(04)   VALUE '1562'.
   260     12  ER-1564                     PIC X(04)   VALUE '1564'.
   261     12  ER-2241                     PIC X(04)   VALUE '2241'.
   262     12  ER-2276                     PIC X(04)   VALUE '2276'.
   263     12  ER-3804                     PIC X(04)   VALUE '3804'.
   264     12  ER-3820                     PIC X(04)   VALUE '3820'.
   265     12  ER-3821                     PIC X(04)   VALUE '3821'.
   266     12  ER-7008                     PIC X(04)   VALUE '7008'.
   267     12  ER-7031                     PIC X(04)   VALUE '7031'.
   268     12  ER-7123                     PIC X(04)   VALUE '7123'.
   269     12  ER-8150                     PIC X(04)   VALUE '8150'.
   270     12  ER-9999                     PIC XXXX    VALUE '9999'.
   271*                                    COPY ELCDATE.
   272******************************************************************
   273*                                                                *
   274*                                                                *
   275*                            ELCDATE.                            *
   276*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   277*                            VMOD=2.003
   278*                                                                *
   279*                                                                *
   280*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   281*                 LENGTH = 200                                   *
   282******************************************************************
   283
   284 01  DATE-CONVERSION-DATA.
   285     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   286     12  DC-OPTION-CODE                PIC X.
   287         88  BIN-TO-GREG                VALUE ' '.
   288         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   289         88  EDIT-GREG-TO-BIN           VALUE '2'.
   290         88  YMD-GREG-TO-BIN            VALUE '3'.
   291         88  MDY-GREG-TO-BIN            VALUE '4'.
   292         88  JULIAN-TO-BIN              VALUE '5'.
   293         88  BIN-PLUS-ELAPSED           VALUE '6'.
   294         88  FIND-CENTURY               VALUE '7'.
   295         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   296         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   297         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   298         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   299         88  JULIAN-TO-BIN-3            VALUE 'C'.
   300         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   301         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   302         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   303         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   7
* EL1044.cbl
   304         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   305         88  CHECK-LEAP-YEAR            VALUE 'H'.
   306         88  BIN-3-TO-GREG              VALUE 'I'.
   307         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   308         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   309         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   310         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   311         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   312         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   313         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   314         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   315         88  THREE-CHARACTER-BIN
   316                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   317         88  GREGORIAN-TO-BIN
   318                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   319         88  BIN-TO-GREGORIAN
   320                  VALUES ' ' '1' 'I' '8' 'G'.
   321         88  JULIAN-TO-BINARY
   322                  VALUES '5' 'C' 'E' 'F'.
   323     12  DC-ERROR-CODE                 PIC X.
   324         88  NO-CONVERSION-ERROR        VALUE ' '.
   325         88  DATE-CONVERSION-ERROR
   326                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   327         88  DATE-IS-ZERO               VALUE '1'.
   328         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   329         88  DATE-IS-INVALID            VALUE '3'.
   330         88  DATE1-GREATER-DATE2        VALUE '4'.
   331         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   332         88  DATE-INVALID-OPTION        VALUE '9'.
   333         88  INVALID-CENTURY            VALUE 'A'.
   334         88  ONLY-CENTURY               VALUE 'B'.
   335         88  ONLY-LEAP-YEAR             VALUE 'C'.
   336         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   337     12  DC-END-OF-MONTH               PIC X.
   338         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   339     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   340         88  USE-NORMAL-PROCESS         VALUE ' '.
   341         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   342         88  ADJUST-UP-100-YRS          VALUE '2'.
   343     12  FILLER                        PIC X.
   344     12  DC-CONVERSION-DATES.
   345         16  DC-BIN-DATE-1             PIC XX.
   346         16  DC-BIN-DATE-2             PIC XX.
   347         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   348         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   349                       DC-GREG-DATE-1-EDIT.
   350             20  DC-EDIT1-MONTH        PIC 99.
   351             20  SLASH1-1              PIC X.
   352             20  DC-EDIT1-DAY          PIC 99.
   353             20  SLASH1-2              PIC X.
   354             20  DC-EDIT1-YEAR         PIC 99.
   355         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   356         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   357                     DC-GREG-DATE-2-EDIT.
   358             20  DC-EDIT2-MONTH        PIC 99.
   359             20  SLASH2-1              PIC X.
   360             20  DC-EDIT2-DAY          PIC 99.
   361             20  SLASH2-2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   8
* EL1044.cbl
   362             20  DC-EDIT2-YEAR         PIC 99.
   363         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   364         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   365                     DC-GREG-DATE-1-YMD.
   366             20  DC-YMD-YEAR           PIC 99.
   367             20  DC-YMD-MONTH          PIC 99.
   368             20  DC-YMD-DAY            PIC 99.
   369         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   370         16  DC-GREG-DATE-1-MDY-R REDEFINES
   371                      DC-GREG-DATE-1-MDY.
   372             20  DC-MDY-MONTH          PIC 99.
   373             20  DC-MDY-DAY            PIC 99.
   374             20  DC-MDY-YEAR           PIC 99.
   375         16  DC-GREG-DATE-1-ALPHA.
   376             20  DC-ALPHA-MONTH        PIC X(10).
   377             20  DC-ALPHA-DAY          PIC 99.
   378             20  FILLER                PIC XX.
   379             20  DC-ALPHA-CENTURY.
   380                 24 DC-ALPHA-CEN-N     PIC 99.
   381             20  DC-ALPHA-YEAR         PIC 99.
   382         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   383         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   384         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   385         16  DC-JULIAN-DATE            PIC 9(05).
   386         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   387                                       PIC 9(05).
   388         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   389             20  DC-JULIAN-YEAR        PIC 99.
   390             20  DC-JULIAN-DAYS        PIC 999.
   391         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   392         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   393         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   394     12  DATE-CONVERSION-VARIBLES.
   395         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   396         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   397             20  FILLER                PIC 9(3).
   398             20  HOLD-CEN-1-CCYY.
   399                 24  HOLD-CEN-1-CC     PIC 99.
   400                 24  HOLD-CEN-1-YY     PIC 99.
   401             20  HOLD-CEN-1-MO         PIC 99.
   402             20  HOLD-CEN-1-DA         PIC 99.
   403         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   404             20  HOLD-CEN-1-R-MO       PIC 99.
   405             20  HOLD-CEN-1-R-DA       PIC 99.
   406             20  HOLD-CEN-1-R-CCYY.
   407                 24  HOLD-CEN-1-R-CC   PIC 99.
   408                 24  HOLD-CEN-1-R-YY   PIC 99.
   409             20  FILLER                PIC 9(3).
   410         16  HOLD-CENTURY-1-X.
   411             20  FILLER                PIC X(3)  VALUE SPACES.
   412             20  HOLD-CEN-1-X-CCYY.
   413                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   414                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   415             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   416             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   417         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   418             20  HOLD-CEN-1-R-X-MO     PIC XX.
   419             20  HOLD-CEN-1-R-X-DA     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   9
* EL1044.cbl
   420             20  HOLD-CEN-1-R-X-CCYY.
   421                 24  HOLD-CEN-1-R-X-CC PIC XX.
   422                 24  HOLD-CEN-1-R-X-YY PIC XX.
   423             20  FILLER                PIC XXX.
   424         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   425         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   426         16  DC-JULIAN-DATE-1          PIC 9(07).
   427         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   428             20  DC-JULIAN-1-CCYY.
   429                 24  DC-JULIAN-1-CC    PIC 99.
   430                 24  DC-JULIAN-1-YR    PIC 99.
   431             20  DC-JULIAN-DA-1        PIC 999.
   432         16  DC-JULIAN-DATE-2          PIC 9(07).
   433         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   434             20  DC-JULIAN-2-CCYY.
   435                 24  DC-JULIAN-2-CC    PIC 99.
   436                 24  DC-JULIAN-2-YR    PIC 99.
   437             20  DC-JULIAN-DA-2        PIC 999.
   438         16  DC-GREG-DATE-A-EDIT.
   439             20  DC-EDITA-MONTH        PIC 99.
   440             20  SLASHA-1              PIC X VALUE '/'.
   441             20  DC-EDITA-DAY          PIC 99.
   442             20  SLASHA-2              PIC X VALUE '/'.
   443             20  DC-EDITA-CCYY.
   444                 24  DC-EDITA-CENT     PIC 99.
   445                 24  DC-EDITA-YEAR     PIC 99.
   446         16  DC-GREG-DATE-B-EDIT.
   447             20  DC-EDITB-MONTH        PIC 99.
   448             20  SLASHB-1              PIC X VALUE '/'.
   449             20  DC-EDITB-DAY          PIC 99.
   450             20  SLASHB-2              PIC X VALUE '/'.
   451             20  DC-EDITB-CCYY.
   452                 24  DC-EDITB-CENT     PIC 99.
   453                 24  DC-EDITB-YEAR     PIC 99.
   454         16  DC-GREG-DATE-CYMD         PIC 9(08).
   455         16  DC-GREG-DATE-CYMD-R REDEFINES
   456                              DC-GREG-DATE-CYMD.
   457             20  DC-CYMD-CEN           PIC 99.
   458             20  DC-CYMD-YEAR          PIC 99.
   459             20  DC-CYMD-MONTH         PIC 99.
   460             20  DC-CYMD-DAY           PIC 99.
   461         16  DC-GREG-DATE-MDCY         PIC 9(08).
   462         16  DC-GREG-DATE-MDCY-R REDEFINES
   463                              DC-GREG-DATE-MDCY.
   464             20  DC-MDCY-MONTH         PIC 99.
   465             20  DC-MDCY-DAY           PIC 99.
   466             20  DC-MDCY-CEN           PIC 99.
   467             20  DC-MDCY-YEAR          PIC 99.
   468    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   469        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   470    12  DC-EL310-DATE                  PIC X(21).
   471    12  FILLER                         PIC X(28).
   472*                                    COPY ELCLOGOF.
   473******************************************************************
   474*                                                                *
   475*                                                                *
   476*                            ELCLOGOF.                           *
   477*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  10
* EL1044.cbl
   478*                                                                *
   479*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   480*                                                                *
   481******************************************************************
   482 01  CLASIC-LOGOFF.
   483     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   484     12  LOGOFF-TEXT.
   485         16  FILLER          PIC X(5)    VALUE SPACES.
   486         16  LOGOFF-MSG.
   487             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   488             20  FILLER      PIC X       VALUE SPACES.
   489             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   490         16  FILLER          PIC X(80)
   491           VALUE '* YOU ARE NOW LOGGED OFF'.
   492         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   493         16  FILLER          PIC X       VALUE QUOTE.
   494         16  LOGOFF-SYS-MSG  PIC X(17)
   495           VALUE 'S CLAS-IC SYSTEM '.
   496     12  TEXT-MESSAGES.
   497         16  UNACCESS-MSG    PIC X(29)
   498             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   499         16  PGMIDERR-MSG    PIC X(17)
   500             VALUE 'PROGRAM NOT FOUND'.
   501*                                    COPY ELCATTR.
   502******************************************************************
   503*                                                                *
   504*                            ELCATTR.                            *
   505*                            VMOD=2.001                          *
   506*                                                                *
   507*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   508*                                                                *
   509*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   510*                                                                *
   511*                   POS 1   P=PROTECTED                          *
   512*                           U=UNPROTECTED                        *
   513*                           S=ASKIP                              *
   514*                   POS 2   A=ALPHA/NUMERIC                      *
   515*                           N=NUMERIC                            *
   516*                   POS 3   N=NORMAL                             *
   517*                           B=BRIGHT                             *
   518*                           D=DARK                               *
   519*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   520*                           OF=MODIFIED DATA TAG OFF             *
   521*                                                                *
   522*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   523******************************************************************
   524 01  ATTRIBUTE-LIST.
   525     12  AL-PABOF            PIC X       VALUE 'Y'.
   526     12  AL-PABON            PIC X       VALUE 'Z'.
   527     12  AL-PADOF            PIC X       VALUE '%'.
   528     12  AL-PADON            PIC X       VALUE '_'.
   529     12  AL-PANOF            PIC X       VALUE '-'.
   530     12  AL-PANON            PIC X       VALUE '/'.
   531     12  AL-SABOF            PIC X       VALUE '8'.
   532     12  AL-SABON            PIC X       VALUE '9'.
   533     12  AL-SADOF            PIC X       VALUE '@'.
   534     12  AL-SADON            PIC X       VALUE QUOTE.
   535     12  AL-SANOF            PIC X       VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  11
* EL1044.cbl
   536     12  AL-SANON            PIC X       VALUE '1'.
   537     12  AL-UABOF            PIC X       VALUE 'H'.
   538     12  AL-UABON            PIC X       VALUE 'I'.
   539     12  AL-UADOF            PIC X       VALUE '<'.
   540     12  AL-UADON            PIC X       VALUE '('.
   541     12  AL-UANOF            PIC X       VALUE ' '.
   542     12  AL-UANON            PIC X       VALUE 'A'.
   543     12  AL-UNBOF            PIC X       VALUE 'Q'.
   544     12  AL-UNBON            PIC X       VALUE 'R'.
   545     12  AL-UNDOF            PIC X       VALUE '*'.
   546     12  AL-UNDON            PIC X       VALUE ')'.
   547     12  AL-UNNOF            PIC X       VALUE '&'.
   548     12  AL-UNNON            PIC X       VALUE 'J'.
   549*                                    COPY ELCEMIB.
   550******************************************************************
   551*                                                                *
   552*                                                                *
   553*                            ELCEMIB.                            *
   554*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   555*                            VMOD=2.005                          *
   556*                                                                *
   557*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   558*                                                                *
   559******************************************************************
   560 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   561     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   562     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   563     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   564     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   565     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   566     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   567     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   568     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   569     12  EMI-SWITCH1             PIC X        VALUE '1'.
   570         88  EMI-NO-ERRORS                    VALUE '1'.
   571         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   572         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   573     12  EMI-SWITCH2             PIC X        VALUE '1'.
   574         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   575     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   576         88  EMI-AREA1-EMPTY                  VALUE '1'.
   577         88  EMI-AREA1-FULL                   VALUE '2'.
   578     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   579         88  EMI-AREA2-EMPTY                  VALUE '1'.
   580         88  EMI-AREA2-FULL                   VALUE '2'.
   581     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   582         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   583         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   584         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   585         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   586         88  EMI-BYPASS-FATALS                VALUE 'X'.
   587     12  EMI-ERROR-LINES.
   588         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   589         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   590         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   591         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   592             20  EMI-ERR-CODES OCCURS 10 TIMES.
   593                 24  EMI-ERR-NUM         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  12
* EL1044.cbl
   594                 24  EMI-FILLER          PIC X.
   595                 24  EMI-SEV             PIC X.
   596                 24  FILLER              PIC X.
   597             20  FILLER                  PIC X(02).
   598     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   599         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   600             20  EMI-ERROR-NUMBER    PIC X(4).
   601             20  EMI-FILL            PIC X.
   602             20  EMI-SEVERITY        PIC X.
   603             20  FILLER              PIC X.
   604             20  EMI-ERROR-TEXT.
   605                 24  EMI-TEXT-VARIABLE   PIC X(10).
   606                 24  FILLER          PIC X(55).
   607     12  EMI-SEVERITY-SAVE           PIC X.
   608         88  EMI-NOTE                    VALUE 'N'.
   609         88  EMI-WARNING                 VALUE 'W'.
   610         88  EMI-FORCABLE                VALUE 'F'.
   611         88  EMI-FATAL                   VALUE 'X'.
   612     12  EMI-MESSAGE-FLAG            PIC X.
   613         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   614         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   615     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   616     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   617         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   618         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   619         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   620     12  FILLER                      PIC X(137)  VALUE SPACES.
   621     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   622     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   623     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   624     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   625*                                    COPY ELCJPFX.
   626******************************************************************
   627*                                                                *
   628*                                                                *
   629*                            ELCJPFX.                            *
   630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   631*                            VMOD=2.002                          *
   632*                                                                *
   633*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   634*                                                                *
   635*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   636*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   637*        ELCNTL - CONTROL FILE                                   *
   638*        ELMSTR - CLAIM MASTERS                                  *
   639*        ELTRLR - ACTIVITY TRAILERS                              *
   640*        ELCHKQ - CHECK QUE                                      *
   641******************************************************************
   642 01  JOURNAL-RECORD.
   643     12  JP-USER-ID                  PIC X(4).
   644     12  JP-FILE-ID                  PIC X(8).
   645     12  JP-PROGRAM-ID               PIC X(8).
   646     12  JP-RECORD-TYPE              PIC X.
   647         88 JP-ADD              VALUE 'A'.
   648         88 JP-BEFORE-CHANGE    VALUE 'B'.
   649         88 JP-AFTER-CHANGE     VALUE 'C'.
   650         88 JP-DELETE           VALUE 'D'.
   651         88 JP-GENERIC-DELETE   VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  13
* EL1044.cbl
   652         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   653         88 JP-KEY-CHG-ADD      VALUE 'N'.
   654     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   655     12  JP-RECORD-AREA
   656
   657
   658                                     PIC X(530).
   659*                                    COPY ELCINTF.
   660******************************************************************
   661*                                                                *
   662*                                                                *
   663*                            ELCINTF.                            *
   664*                            VMOD=2.017                          *
   665*                                                                *
   666*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   667*                                                                *
   668*       LENGTH = 1024                                            *
   669*                                                                *
   670******************************************************************
   671*                   C H A N G E   L O G
   672*
   673* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   674*-----------------------------------------------------------------
   675*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   676* EFFECTIVE    NUMBER
   677*-----------------------------------------------------------------
   678* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   679******************************************************************
   680 01  PROGRAM-INTERFACE-BLOCK.
   681     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   682     12  PI-CALLING-PROGRAM              PIC X(8).
   683     12  PI-SAVED-PROGRAM-1              PIC X(8).
   684     12  PI-SAVED-PROGRAM-2              PIC X(8).
   685     12  PI-SAVED-PROGRAM-3              PIC X(8).
   686     12  PI-SAVED-PROGRAM-4              PIC X(8).
   687     12  PI-SAVED-PROGRAM-5              PIC X(8).
   688     12  PI-SAVED-PROGRAM-6              PIC X(8).
   689     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   690     12  PI-COMPANY-ID                   PIC XXX.
   691     12  PI-COMPANY-CD                   PIC X.
   692
   693     12  PI-COMPANY-PASSWORD             PIC X(8).
   694
   695     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   696
   697     12  PI-CONTROL-IN-PROGRESS.
   698         16  PI-CARRIER                  PIC X.
   699         16  PI-GROUPING                 PIC X(6).
   700         16  PI-STATE                    PIC XX.
   701         16  PI-ACCOUNT                  PIC X(10).
   702         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   703                                         PIC X(10).
   704         16  PI-CLAIM-CERT-GRP.
   705             20  PI-CLAIM-NO             PIC X(7).
   706             20  PI-CERT-NO.
   707                 25  PI-CERT-PRIME       PIC X(10).
   708                 25  PI-CERT-SFX         PIC X.
   709             20  PI-CERT-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  14
* EL1044.cbl
   710         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   711             20  PI-PLAN-CODE            PIC X(2).
   712             20  PI-REVISION-NUMBER      PIC X(3).
   713             20  PI-PLAN-EFF-DT          PIC X(2).
   714             20  PI-PLAN-EXP-DT          PIC X(2).
   715             20  FILLER                  PIC X(11).
   716         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   717             20  PI-OE-REFERENCE-1.
   718                 25  PI-OE-REF-1-PRIME   PIC X(18).
   719                 25  PI-OE-REF-1-SUFF    PIC XX.
   720
   721     12  PI-SESSION-IN-PROGRESS          PIC X.
   722         88  CLAIM-SESSION                   VALUE '1'.
   723         88  CREDIT-SESSION                  VALUE '2'.
   724         88  WARRANTY-SESSION                VALUE '3'.
   725         88  MORTGAGE-SESSION                VALUE '4'.
   726         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   727
   728
   729*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   730
   731     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   732     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   733
   734     12  PI-CREDIT-USER                  PIC X.
   735         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   736         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   737
   738     12  PI-CLAIM-USER                   PIC X.
   739         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   740         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   741
   742     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   743         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   744         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   745         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   746         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   747         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   748
   749     12  PI-PROCESSOR-ID                 PIC X(4).
   750
   751     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   752
   753     12  PI-MEMBER-CAPTION               PIC X(10).
   754
   755     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   756         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   757
   758     12  PI-LIFE-OVERRIDE-L1             PIC X.
   759     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   760     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   761     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   762
   763     12  PI-AH-OVERRIDE-L1               PIC X.
   764     12  PI-AH-OVERRIDE-L2               PIC XX.
   765     12  PI-AH-OVERRIDE-L6               PIC X(6).
   766     12  PI-AH-OVERRIDE-L12              PIC X(12).
   767
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  15
* EL1044.cbl
   768     12  PI-NEW-SYSTEM                   PIC X(2).
   769
   770     12  PI-PRIMARY-CERT-NO              PIC X(11).
   771     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   772         88  PI-USES-PAID-TO                 VALUE '1'.
   773     12  PI-CRDTCRD-SYSTEM.
   774         16  PI-CRDTCRD-USER             PIC X.
   775             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   776             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   777         16  PI-CC-MONTH-END-DT          PIC XX.
   778     12  PI-PROCESSOR-PRINTER            PIC X(4).
   779
   780     12  PI-OE-REFERENCE-2.
   781         16  PI-OE-REF-2-PRIME           PIC X(10).
   782         16  PI-OE-REF-2-SUFF            PIC X.
   783
   784     12  PI-REM-TRM-CALC-OPTION          PIC X.
   785
   786     12  PI-LANGUAGE-TYPE                PIC X.
   787             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   788             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   789             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   790
   791     12  PI-POLICY-LINKAGE-IND           PIC X.
   792         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   793         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   794                                                   LOW-VALUES.
   795
   796     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   797     12  PI-CLAIM-PW-SESSION             PIC X(1).
   798         88  PI-CLAIM-CREDIT                 VALUE '1'.
   799         88  PI-CLAIM-CONVEN                 VALUE '2'.
   800
   801     12  PI-PROCESSOR-CSR-IND            PIC X.
   802         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   803         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   804
   805     12  FILLER                          PIC X(3).
   806
   807     12  PI-SYSTEM-LEVEL                 PIC X(145).
   808
   809     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   810         PI-SYSTEM-LEVEL.
   811
   812         16  PI-ENTRY-CODES.
   813             20  PI-ENTRY-CD-1           PIC X.
   814             20  PI-ENTRY-CD-2           PIC X.
   815
   816         16  PI-RETURN-CODES.
   817             20  PI-RETURN-CD-1          PIC X.
   818             20  PI-RETURN-CD-2          PIC X.
   819
   820         16  PI-UPDATE-STATUS-SAVE.
   821             20  PI-UPDATE-BY            PIC X(4).
   822             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   823
   824         16  PI-LOWER-CASE-LETTERS       PIC X.
   825             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  16
* EL1044.cbl
   826
   827*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   828*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   829*            88  CARRIER-CLM-CNTL            VALUE '2'.
   830
   831         16  PI-CERT-ACCESS-CONTROL      PIC X.
   832             88  ST-ACCNT-CNTL               VALUE ' '.
   833             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   834             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   835             88  ACCNT-CNTL                  VALUE '3'.
   836             88  CARR-ACCNT-CNTL             VALUE '4'.
   837
   838         16  PI-PROCESSOR-CAP-LIST.
   839             20  PI-SYSTEM-CONTROLS.
   840                24 PI-SYSTEM-DISPLAY     PIC X.
   841                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   842                24 PI-SYSTEM-MODIFY      PIC X.
   843                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   844             20  FILLER                  PIC XX.
   845             20  PI-DISPLAY-CAP          PIC X.
   846                 88  DISPLAY-CAP             VALUE 'Y'.
   847             20  PI-MODIFY-CAP           PIC X.
   848                 88  MODIFY-CAP              VALUE 'Y'.
   849             20  PI-MSG-AT-LOGON-CAP     PIC X.
   850                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   851             20  PI-FORCE-CAP            PIC X.
   852                 88  FORCE-CAP               VALUE 'Y'.
   853
   854         16  PI-PROGRAM-CONTROLS.
   855             20  PI-PGM-PRINT-OPT        PIC X.
   856             20  PI-PGM-FORMAT-OPT       PIC X.
   857             20  PI-PGM-PROCESS-OPT      PIC X.
   858             20  PI-PGM-TOTALS-OPT       PIC X.
   859
   860         16  PI-HELP-INTERFACE.
   861             20  PI-LAST-ERROR-NO        PIC X(4).
   862             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   863
   864         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   865             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   866
   867         16  PI-CR-CONTROL-IN-PROGRESS.
   868             20  PI-CR-CARRIER           PIC X.
   869             20  PI-CR-GROUPING          PIC X(6).
   870             20  PI-CR-STATE             PIC XX.
   871             20  PI-CR-ACCOUNT           PIC X(10).
   872             20  PI-CR-FIN-RESP          PIC X(10).
   873             20  PI-CR-TYPE              PIC X.
   874
   875         16  PI-CR-BATCH-NUMBER          PIC X(6).
   876
   877         16  PI-CR-MONTH-END-DT          PIC XX.
   878
   879         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   880             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   881             88  PI-ZERO-CARRIER             VALUE '1'.
   882             88  PI-ZERO-GROUPING            VALUE '2'.
   883             88  PI-ZERO-CAR-GROUP           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  17
* EL1044.cbl
   884
   885         16  PI-CARRIER-SECURITY         PIC X.
   886             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   887
   888         16  PI-ACCOUNT-SECURITY         PIC X(10).
   889             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   890             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   891
   892         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   893             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   894                                         INDEXED BY PI-ACCESS-NDX
   895                                         PIC X.
   896
   897         16  PI-GA-BILLING-CONTROL       PIC X.
   898             88  PI-GA-BILLING               VALUE '1'.
   899
   900         16  PI-MAIL-PROCESSING          PIC X.
   901             88  PI-MAIL-YES                 VALUE 'Y'.
   902
   903         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   904
   905         16  PI-AR-SYSTEM.
   906             20  PI-AR-PROCESSING-CNTL   PIC X.
   907                 88  PI-AR-PROCESSING        VALUE 'Y'.
   908             20  PI-AR-SUMMARY-CODE      PIC X(6).
   909             20  PI-AR-MONTH-END-DT      PIC XX.
   910
   911         16  PI-MP-SYSTEM.
   912             20  PI-MORTGAGE-USER            PIC X.
   913                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   914                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   915             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   916                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   917                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   918                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   919                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   920                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   921             20  PI-MP-MONTH-END-DT          PIC XX.
   922             20  PI-MP-REFERENCE-NO.
   923                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   924                 24  PI-MP-REFERENCE-SFX     PIC XX.
   925
   926         16  PI-LABEL-CONTROL            PIC X(01).
   927             88  PI-CREATE-LABELS                    VALUE 'Y'.
   928             88  PI-BYPASS-LABELS                    VALUE 'N'.
   929
   930         16  PI-BILL-GROUPING-CODE       PIC X(01).
   931             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   932
   933         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   934             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   935             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   936
   937         16  FILLER                      PIC X(14).
   938
   939     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   940******************************************************************
   941     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  18
* EL1044.cbl
   942*                                    COPY ELC1042.
   943******************************************************************
   944*                                                                *
   945*                                                                *
   946*                           ELC1042                              *
   947*                            VMOD=2.002                          *
   948*                                                                *
   949*    NOTE                                                        *
   950*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   951*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   952*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   953*        TO THESE PROGRAMS.                                      *
   954*                                                                *
   955*    NOTE                                                        *
   956*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   957*        USE ONLY!                                               *
   958*                                                                *
   959******************************************************************
   960
   961         16  PI-1042-WA.
   962             20  PI-ACTION       PIC  X(01).
   963                 88 PI-SHOW-MODE           VALUE '1'.
   964                 88 PI-CLEAR-MODE          VALUE '2'.
   965                 88 PI-CREATE-MODE         VALUE '3'.
   966             20  PI-COMM-CONTROL PIC  X(12).
   967             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   968             20  PI-EOF-SW       PIC  X(01).
   969                 88  PI-FILE-EOF           VALUE 'Y'.
   970             20  PI-FILETYP      PIC  X(01).
   971             20  PI-FORM-SQUEEZE-CONTROL
   972                                 PIC  X(01).
   973                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   974                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   975             20  PI-LAST-CONTROL PIC  X(12).
   976             20  PI-TEMP-STOR-ITEMS
   977                                 PIC S9(04) COMP.
   978             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   979             20  PI-UPDATE-SW    PIC  9(01).
   980                 88 ANY-UPDATES            VALUE 1.
   981             20  PI-104-SCREEN-SENT-IND
   982                                 PIC  X(01).
   983                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   984                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   985             20  PI-1042-SCREEN-SENT-IND
   986                                 PIC  X(01).
   987                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   988                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   989             20  PI-1042-ARCHIVE-IND
   990                                 PIC  X(01).
   991                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   992             20  FILLER          PIC  X(29).
   993         16  PI-PREV-LETR-KEY        PIC X(15).
   994         16  PI-CURR-LETR-KEY        PIC X(15).
   995         16  PI-UPDATE-DT            PIC XX.
   996         16  FILLER                  PIC X(556).
   997*                                    COPY ELCAID.
   998******************************************************************
   999*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  19
* EL1044.cbl
  1000*                            ELCAID.                             *
  1001*                            VMOD=2.001                          *
  1002*                                                                *
  1003*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1004*                                                                *
  1005*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1006*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1007******************************************************************
  1008
  1009 01  DFHAID.
  1010   02  DFHNULL   PIC  X  VALUE  ' '.
  1011   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1012   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1013   02  DFHPEN    PIC  X  VALUE  '='.
  1014   02  DFHOPID   PIC  X  VALUE  'W'.
  1015   02  DFHPA1    PIC  X  VALUE  '%'.
  1016   02  DFHPA2    PIC  X  VALUE  '>'.
  1017   02  DFHPA3    PIC  X  VALUE  ','.
  1018   02  DFHPF1    PIC  X  VALUE  '1'.
  1019   02  DFHPF2    PIC  X  VALUE  '2'.
  1020   02  DFHPF3    PIC  X  VALUE  '3'.
  1021   02  DFHPF4    PIC  X  VALUE  '4'.
  1022   02  DFHPF5    PIC  X  VALUE  '5'.
  1023   02  DFHPF6    PIC  X  VALUE  '6'.
  1024   02  DFHPF7    PIC  X  VALUE  '7'.
  1025   02  DFHPF8    PIC  X  VALUE  '8'.
  1026   02  DFHPF9    PIC  X  VALUE  '9'.
  1027   02  DFHPF10   PIC  X  VALUE  ':'.
  1028   02  DFHPF11   PIC  X  VALUE  '#'.
  1029   02  DFHPF12   PIC  X  VALUE  '@'.
  1030   02  DFHPF13   PIC  X  VALUE  'A'.
  1031   02  DFHPF14   PIC  X  VALUE  'B'.
  1032   02  DFHPF15   PIC  X  VALUE  'C'.
  1033   02  DFHPF16   PIC  X  VALUE  'D'.
  1034   02  DFHPF17   PIC  X  VALUE  'E'.
  1035   02  DFHPF18   PIC  X  VALUE  'F'.
  1036   02  DFHPF19   PIC  X  VALUE  'G'.
  1037   02  DFHPF20   PIC  X  VALUE  'H'.
  1038   02  DFHPF21   PIC  X  VALUE  'I'.
  1039*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1040   02  DFHPF22   PIC  X  VALUE  '['.
  1041   02  DFHPF23   PIC  X  VALUE  '.'.
  1042   02  DFHPF24   PIC  X  VALUE  '<'.
  1043   02  DFHMSRE   PIC  X  VALUE  'X'.
  1044   02  DFHSTRF   PIC  X  VALUE  'h'.
  1045   02  DFHTRIG   PIC  X  VALUE  '"'.
  1046 01  FILLER    REDEFINES DFHAID.
  1047     12  FILLER                      PIC X(08).
  1048     12  PF-VALUES                   PIC X         OCCURS 24.
  1049*                                    COPY EL1044S.
  1050 01  EL1044ZI.
  1051     05  FILLER            PIC  X(0012).
  1052*    -------------------------------
  1053     05  DATEL PIC S9(0004) COMP.
  1054     05  DATEF PIC  X(0001).
  1055     05  FILLER REDEFINES DATEF.
  1056         10  DATEA PIC  X(0001).
  1057     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  20
* EL1044.cbl
  1058     05  DATEI PIC  X(0008).
  1059*    -------------------------------
  1060     05  TIMEL PIC S9(0004) COMP.
  1061     05  TIMEF PIC  X(0001).
  1062     05  FILLER REDEFINES TIMEF.
  1063         10  TIMEA PIC  X(0001).
  1064     05  FILLER            PIC  X(3).
  1065     05  TIMEI PIC  X(0005).
  1066*    -------------------------------
  1067     05  CMPNYIDL PIC S9(0004) COMP.
  1068     05  CMPNYIDF PIC  X(0001).
  1069     05  FILLER REDEFINES CMPNYIDF.
  1070         10  CMPNYIDA PIC  X(0001).
  1071     05  FILLER            PIC  X(3).
  1072     05  CMPNYIDI PIC  X(0003).
  1073*    -------------------------------
  1074     05  USERIDL PIC S9(0004) COMP.
  1075     05  USERIDF PIC  X(0001).
  1076     05  FILLER REDEFINES USERIDF.
  1077         10  USERIDA PIC  X(0001).
  1078     05  FILLER            PIC  X(3).
  1079     05  USERIDI PIC  X(0004).
  1080*    -------------------------------
  1081     05  MAINTL PIC S9(0004) COMP.
  1082     05  MAINTF PIC  X(0001).
  1083     05  FILLER REDEFINES MAINTF.
  1084         10  MAINTA PIC  X(0001).
  1085     05  FILLER            PIC  X(3).
  1086     05  MAINTI PIC  X(0001).
  1087*    -------------------------------
  1088     05  LSTUSRL PIC S9(0004) COMP.
  1089     05  LSTUSRF PIC  X(0001).
  1090     05  FILLER REDEFINES LSTUSRF.
  1091         10  LSTUSRA PIC  X(0001).
  1092     05  FILLER            PIC  X(3).
  1093     05  LSTUSRI PIC  X(0004).
  1094*    -------------------------------
  1095     05  LSTDTEL PIC S9(0004) COMP.
  1096     05  LSTDTEF PIC  X(0001).
  1097     05  FILLER REDEFINES LSTDTEF.
  1098         10  LSTDTEA PIC  X(0001).
  1099     05  FILLER            PIC  X(3).
  1100     05  LSTDTEI PIC  X(0008).
  1101*    -------------------------------
  1102     05  ZLETRL PIC S9(0004) COMP.
  1103     05  ZLETRF PIC  X(0001).
  1104     05  FILLER REDEFINES ZLETRF.
  1105         10  ZLETRA PIC  X(0001).
  1106     05  FILLER            PIC  X(3).
  1107     05  ZLETRI PIC  X(0004).
  1108*    -------------------------------
  1109     05  ZCOPIESL PIC S9(0004) COMP.
  1110     05  ZCOPIESF PIC  X(0001).
  1111     05  FILLER REDEFINES ZCOPIESF.
  1112         10  ZCOPIESA PIC  X(0001).
  1113     05  FILLER            PIC  X(3).
  1114     05  ZCOPIESI PIC  X(0001).
  1115*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  21
* EL1044.cbl
  1116     05  ZPROMPTL PIC S9(0004) COMP.
  1117     05  ZPROMPTF PIC  X(0001).
  1118     05  FILLER REDEFINES ZPROMPTF.
  1119         10  ZPROMPTA PIC  X(0001).
  1120     05  FILLER            PIC  X(3).
  1121     05  ZPROMPTI PIC  X(0001).
  1122*    -------------------------------
  1123     05  ZENCCDL PIC S9(0004) COMP.
  1124     05  ZENCCDF PIC  X(0001).
  1125     05  FILLER REDEFINES ZENCCDF.
  1126         10  ZENCCDA PIC  X(0001).
  1127     05  FILLER            PIC  X(3).
  1128     05  ZENCCDI PIC  X(0003).
  1129*    -------------------------------
  1130     05  ZRDAYSL PIC S9(0004) COMP.
  1131     05  ZRDAYSF PIC  X(0001).
  1132     05  FILLER REDEFINES ZRDAYSF.
  1133         10  ZRDAYSA PIC  X(0001).
  1134     05  FILLER            PIC  X(3).
  1135     05  ZRDAYSI PIC  X(0003).
  1136*    -------------------------------
  1137     05  ZFORML PIC S9(0004) COMP.
  1138     05  ZFORMF PIC  X(0001).
  1139     05  FILLER REDEFINES ZFORMF.
  1140         10  ZFORMA PIC  X(0001).
  1141     05  FILLER            PIC  X(3).
  1142     05  ZFORMI PIC  X(0004).
  1143*    -------------------------------
  1144     05  ZBENEL PIC S9(0004) COMP.
  1145     05  ZBENEF PIC  X(0001).
  1146     05  FILLER REDEFINES ZBENEF.
  1147         10  ZBENEA PIC  X(0001).
  1148     05  FILLER            PIC  X(3).
  1149     05  ZBENEI PIC  X(0001).
  1150*    -------------------------------
  1151     05  ZACCTL PIC S9(0004) COMP.
  1152     05  ZACCTF PIC  X(0001).
  1153     05  FILLER REDEFINES ZACCTF.
  1154         10  ZACCTA PIC  X(0001).
  1155     05  FILLER            PIC  X(3).
  1156     05  ZACCTI PIC  X(0001).
  1157*    -------------------------------
  1158     05  ZTYPEL PIC S9(0004) COMP.
  1159     05  ZTYPEF PIC  X(0001).
  1160     05  FILLER REDEFINES ZTYPEF.
  1161         10  ZTYPEA PIC  X(0001).
  1162     05  FILLER            PIC  X(3).
  1163     05  ZTYPEI PIC  X(0001).
  1164*    -------------------------------
  1165     05  ZPRTCRTL PIC S9(0004) COMP.
  1166     05  ZPRTCRTF PIC  X(0001).
  1167     05  FILLER REDEFINES ZPRTCRTF.
  1168         10  ZPRTCRTA PIC  X(0001).
  1169     05  FILLER            PIC  X(3).
  1170     05  ZPRTCRTI PIC  X(0001).
  1171*    -------------------------------
  1172     05  ZREFREQL PIC S9(0004) COMP.
  1173     05  ZREFREQF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  22
* EL1044.cbl
  1174     05  FILLER REDEFINES ZREFREQF.
  1175         10  ZREFREQA PIC  X(0001).
  1176     05  FILLER            PIC  X(3).
  1177     05  ZREFREQI PIC  X(0001).
  1178*    -------------------------------
  1179     05  ZONBASEL PIC S9(0004) COMP.
  1180     05  ZONBASEF PIC  X(0001).
  1181     05  FILLER REDEFINES ZONBASEF.
  1182         10  ZONBASEA PIC  X(0001).
  1183     05  FILLER            PIC  X(3).
  1184     05  ZONBASEI PIC  X(0002).
  1185*    -------------------------------
  1186     05  ZACTSUML PIC S9(0004) COMP.
  1187     05  ZACTSUMF PIC  X(0001).
  1188     05  FILLER REDEFINES ZACTSUMF.
  1189         10  ZACTSUMA PIC  X(0001).
  1190     05  FILLER            PIC  X(3).
  1191     05  ZACTSUMI PIC  X(0001).
  1192*    -------------------------------
  1193     05  ZCSOSUML PIC S9(0004) COMP.
  1194     05  ZCSOSUMF PIC  X(0001).
  1195     05  FILLER REDEFINES ZCSOSUMF.
  1196         10  ZCSOSUMA PIC  X(0001).
  1197     05  FILLER            PIC  X(3).
  1198     05  ZCSOSUMI PIC  X(0001).
  1199*    -------------------------------
  1200     05  ZREASONL PIC S9(0004) COMP.
  1201     05  ZREASONF PIC  X(0001).
  1202     05  FILLER REDEFINES ZREASONF.
  1203         10  ZREASONA PIC  X(0001).
  1204     05  FILLER            PIC  X(3).
  1205     05  ZREASONI PIC  X(0001).
  1206*    -------------------------------
  1207     05  ZFADAYSL PIC S9(0004) COMP.
  1208     05  ZFADAYSF PIC  X(0001).
  1209     05  FILLER REDEFINES ZFADAYSF.
  1210         10  ZFADAYSA PIC  X(0001).
  1211     05  FILLER            PIC  X(3).
  1212     05  ZFADAYSI PIC  X(0003).
  1213*    -------------------------------
  1214     05  ZACLOSEL PIC S9(0004) COMP.
  1215     05  ZACLOSEF PIC  X(0001).
  1216     05  FILLER REDEFINES ZACLOSEF.
  1217         10  ZACLOSEA PIC  X(0001).
  1218     05  FILLER            PIC  X(3).
  1219     05  ZACLOSEI PIC  X(0001).
  1220*    -------------------------------
  1221     05  ERRMSGL PIC S9(0004) COMP.
  1222     05  ERRMSGF PIC  X(0001).
  1223     05  FILLER REDEFINES ERRMSGF.
  1224         10  ERRMSGA PIC  X(0001).
  1225     05  FILLER            PIC  X(3).
  1226     05  ERRMSGI PIC  X(0072).
  1227*    -------------------------------
  1228     05  PFKEYL PIC S9(0004) COMP.
  1229     05  PFKEYF PIC  X(0001).
  1230     05  FILLER REDEFINES PFKEYF.
  1231         10  PFKEYA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  23
* EL1044.cbl
  1232     05  FILLER            PIC  X(3).
  1233     05  PFKEYI PIC  99.
  1234 01  EL1044ZO REDEFINES EL1044ZI.
  1235     05  FILLER            PIC  X(0012).
  1236*    -------------------------------
  1237     05  FILLER            PIC  X(3).
  1238     05  DATEC PIC  X(0001).
  1239     05  DATEH PIC  X(0001).
  1240     05  DATEU PIC  X(0001).
  1241     05  DATEO PIC  X(0008).
  1242*    -------------------------------
  1243     05  FILLER            PIC  X(3).
  1244     05  TIMEC PIC  X(0001).
  1245     05  TIMEH PIC  X(0001).
  1246     05  TIMEU PIC  X(0001).
  1247     05  TIMEO PIC  99.99.
  1248*    -------------------------------
  1249     05  FILLER            PIC  X(3).
  1250     05  CMPNYIDC PIC  X(0001).
  1251     05  CMPNYIDH PIC  X(0001).
  1252     05  CMPNYIDU PIC  X(0001).
  1253     05  CMPNYIDO PIC  X(0003).
  1254*    -------------------------------
  1255     05  FILLER            PIC  X(3).
  1256     05  USERIDC PIC  X(0001).
  1257     05  USERIDH PIC  X(0001).
  1258     05  USERIDU PIC  X(0001).
  1259     05  USERIDO PIC  X(0004).
  1260*    -------------------------------
  1261     05  FILLER            PIC  X(3).
  1262     05  MAINTC PIC  X(0001).
  1263     05  MAINTH PIC  X(0001).
  1264     05  MAINTU PIC  X(0001).
  1265     05  MAINTO PIC  X(0001).
  1266*    -------------------------------
  1267     05  FILLER            PIC  X(3).
  1268     05  LSTUSRC PIC  X(0001).
  1269     05  LSTUSRH PIC  X(0001).
  1270     05  LSTUSRU PIC  X(0001).
  1271     05  LSTUSRO PIC  X(0004).
  1272*    -------------------------------
  1273     05  FILLER            PIC  X(3).
  1274     05  LSTDTEC PIC  X(0001).
  1275     05  LSTDTEH PIC  X(0001).
  1276     05  LSTDTEU PIC  X(0001).
  1277     05  LSTDTEO PIC  X(0008).
  1278*    -------------------------------
  1279     05  FILLER            PIC  X(3).
  1280     05  ZLETRC PIC  X(0001).
  1281     05  ZLETRH PIC  X(0001).
  1282     05  ZLETRU PIC  X(0001).
  1283     05  ZLETRO PIC  X(0004).
  1284*    -------------------------------
  1285     05  FILLER            PIC  X(3).
  1286     05  ZCOPIESC PIC  X(0001).
  1287     05  ZCOPIESH PIC  X(0001).
  1288     05  ZCOPIESU PIC  X(0001).
  1289     05  ZCOPIESO PIC  9.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  24
* EL1044.cbl
  1290*    -------------------------------
  1291     05  FILLER            PIC  X(3).
  1292     05  ZPROMPTC PIC  X(0001).
  1293     05  ZPROMPTH PIC  X(0001).
  1294     05  ZPROMPTU PIC  X(0001).
  1295     05  ZPROMPTO PIC  X(0001).
  1296*    -------------------------------
  1297     05  FILLER            PIC  X(3).
  1298     05  ZENCCDC PIC  X(0001).
  1299     05  ZENCCDH PIC  X(0001).
  1300     05  ZENCCDU PIC  X(0001).
  1301     05  ZENCCDO PIC  X(0003).
  1302*    -------------------------------
  1303     05  FILLER            PIC  X(3).
  1304     05  ZRDAYSC PIC  X(0001).
  1305     05  ZRDAYSH PIC  X(0001).
  1306     05  ZRDAYSU PIC  X(0001).
  1307     05  ZRDAYSO PIC  999.
  1308*    -------------------------------
  1309     05  FILLER            PIC  X(3).
  1310     05  ZFORMC PIC  X(0001).
  1311     05  ZFORMH PIC  X(0001).
  1312     05  ZFORMU PIC  X(0001).
  1313     05  ZFORMO PIC  X(0004).
  1314*    -------------------------------
  1315     05  FILLER            PIC  X(3).
  1316     05  ZBENEC PIC  X(0001).
  1317     05  ZBENEH PIC  X(0001).
  1318     05  ZBENEU PIC  X(0001).
  1319     05  ZBENEO PIC  X(0001).
  1320*    -------------------------------
  1321     05  FILLER            PIC  X(3).
  1322     05  ZACCTC PIC  X(0001).
  1323     05  ZACCTH PIC  X(0001).
  1324     05  ZACCTU PIC  X(0001).
  1325     05  ZACCTO PIC  X(0001).
  1326*    -------------------------------
  1327     05  FILLER            PIC  X(3).
  1328     05  ZTYPEC PIC  X(0001).
  1329     05  ZTYPEH PIC  X(0001).
  1330     05  ZTYPEU PIC  X(0001).
  1331     05  ZTYPEO PIC  X(0001).
  1332*    -------------------------------
  1333     05  FILLER            PIC  X(3).
  1334     05  ZPRTCRTC PIC  X(0001).
  1335     05  ZPRTCRTH PIC  X(0001).
  1336     05  ZPRTCRTU PIC  X(0001).
  1337     05  ZPRTCRTO PIC  X(0001).
  1338*    -------------------------------
  1339     05  FILLER            PIC  X(3).
  1340     05  ZREFREQC PIC  X(0001).
  1341     05  ZREFREQH PIC  X(0001).
  1342     05  ZREFREQU PIC  X(0001).
  1343     05  ZREFREQO PIC  X(0001).
  1344*    -------------------------------
  1345     05  FILLER            PIC  X(3).
  1346     05  ZONBASEC PIC  X(0001).
  1347     05  ZONBASEH PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  25
* EL1044.cbl
  1348     05  ZONBASEU PIC  X(0001).
  1349     05  ZONBASEO PIC  X(0002).
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(3).
  1352     05  ZACTSUMC PIC  X(0001).
  1353     05  ZACTSUMH PIC  X(0001).
  1354     05  ZACTSUMU PIC  X(0001).
  1355     05  ZACTSUMO PIC  X(0001).
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(3).
  1358     05  ZCSOSUMC PIC  X(0001).
  1359     05  ZCSOSUMH PIC  X(0001).
  1360     05  ZCSOSUMU PIC  X(0001).
  1361     05  ZCSOSUMO PIC  X(0001).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(3).
  1364     05  ZREASONC PIC  X(0001).
  1365     05  ZREASONH PIC  X(0001).
  1366     05  ZREASONU PIC  X(0001).
  1367     05  ZREASONO PIC  X(0001).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(3).
  1370     05  ZFADAYSC PIC  X(0001).
  1371     05  ZFADAYSH PIC  X(0001).
  1372     05  ZFADAYSU PIC  X(0001).
  1373     05  ZFADAYSO PIC  999.
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(3).
  1376     05  ZACLOSEC PIC  X(0001).
  1377     05  ZACLOSEH PIC  X(0001).
  1378     05  ZACLOSEU PIC  X(0001).
  1379     05  ZACLOSEO PIC  X(0001).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(3).
  1382     05  ERRMSGC PIC  X(0001).
  1383     05  ERRMSGH PIC  X(0001).
  1384     05  ERRMSGU PIC  X(0001).
  1385     05  ERRMSGO PIC  X(0072).
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(3).
  1388     05  PFKEYC PIC  X(0001).
  1389     05  PFKEYH PIC  X(0001).
  1390     05  PFKEYU PIC  X(0001).
  1391     05  PFKEYO PIC  99.
  1392*    -------------------------------
  1393****************************************************************
  1394*
  1395* Copyright (c) 2007 by Clerity Solutions, Inc.
  1396* All rights reserved.
  1397*
  1398****************************************************************
  1399 01  DFHEIV.
  1400   02  DFHEIV0               PIC X(35).
  1401   02  DFHEIV1               PIC X(08).
  1402   02  DFHEIV2               PIC X(08).
  1403   02  DFHEIV3               PIC X(08).
  1404   02  DFHEIV4               PIC X(06).
  1405   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  26
* EL1044.cbl
  1406   02  DFHEIV6               PIC X(04).
  1407   02  DFHEIV7               PIC X(02).
  1408   02  DFHEIV8               PIC X(02).
  1409   02  DFHEIV9               PIC X(01).
  1410   02  DFHEIV10              PIC S9(7) COMP-3.
  1411   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1412   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1413   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1414   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1415   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1416   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1417   02  DFHEIV17              PIC X(04).
  1418   02  DFHEIV18              PIC X(04).
  1419   02  DFHEIV19              PIC X(04).
  1420   02  DFHEIV20              USAGE IS POINTER.
  1421   02  DFHEIV21              USAGE IS POINTER.
  1422   02  DFHEIV22              USAGE IS POINTER.
  1423   02  DFHEIV23              USAGE IS POINTER.
  1424   02  DFHEIV24              USAGE IS POINTER.
  1425   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1426   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1427   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1428   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1429   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1430   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1431   02  FILLER                PIC X(02).
  1432   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1433   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1434   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1435   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1436   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1437 LINKAGE  SECTION.
  1438*****************************************************************
  1439*                                                               *
  1440* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1441* All rights reserved.                                          *
  1442*                                                               *
  1443*****************************************************************
  1444 01  dfheiblk.
  1445     02  eibtime          pic s9(7) comp-3.
  1446     02  eibdate          pic s9(7) comp-3.
  1447     02  eibtrnid         pic x(4).
  1448     02  eibtaskn         pic s9(7) comp-3.
  1449     02  eibtrmid         pic x(4).
  1450     02  dfheigdi         pic s9(4) comp.
  1451     02  eibcposn         pic s9(4) comp.
  1452     02  eibcalen         pic s9(4) comp.
  1453     02  eibaid           pic x(1).
  1454     02  eibfiller1       pic x(1).
  1455     02  eibfn            pic x(2).
  1456     02  eibfiller2       pic x(2).
  1457     02  eibrcode         pic x(6).
  1458     02  eibfiller3       pic x(2).
  1459     02  eibds            pic x(8).
  1460     02  eibreqid         pic x(8).
  1461     02  eibrsrce         pic x(8).
  1462     02  eibsync          pic x(1).
  1463     02  eibfree          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  27
* EL1044.cbl
  1464     02  eibrecv          pic x(1).
  1465     02  eibsend          pic x(1).
  1466     02  eibatt           pic x(1).
  1467     02  eibeoc           pic x(1).
  1468     02  eibfmh           pic x(1).
  1469     02  eibcompl         pic x(1).
  1470     02  eibsig           pic x(1).
  1471     02  eibconf          pic x(1).
  1472     02  eiberr           pic x(1).
  1473     02  eibrldbk         pic x(1).
  1474     02  eiberrcd         pic x(4).
  1475     02  eibsynrb         pic x(1).
  1476     02  eibnodat         pic x(1).
  1477     02  eibfiller5       pic x(2).
  1478     02  eibresp          pic 9(09) comp.
  1479     02  eibresp2         pic 9(09) comp.
  1480     02  dfheigdj         pic s9(4) comp.
  1481     02  dfheigdk         pic s9(4) comp.
  1482 01  DFHCOMMAREA                     PIC X(1024).
  1483*                                    COPY ELCTEXT.
  1484******************************************************************
  1485*                                                                *
  1486*                                                                *
  1487*                            ELCTEXT.                            *
  1488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1489*                            VMOD=2.008                          *
  1490*                                                                *
  1491*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1492*                                     FORM LETTERS,              *
  1493*                                     CERT FORM DISPLAY.
  1494*                                                                *
  1495*   FILE TYPE = VSAM,KSDS                                        *
  1496*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1497*                                                                *
  1498*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1499*       ALTERNATE INDEX = NONE                                   *
  1500*                                                                *
  1501*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1502*       ALTERNATE INDEX = NONE                                   *
  1503*                                                                *
  1504*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1505*       ALTERNATE INDEX = NONE                                   *
  1506*                                                                *
  1507*   LOG = NO                                                     *
  1508*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1509******************************************************************
  1510 01  TEXT-FILES.
  1511     12  TEXT-FILE-ID                PIC XX.
  1512         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1513         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1514         88  HELP-FILE-TEXT             VALUE 'TH'.
  1515
  1516     12  TX-CONTROL-PRIMARY.
  1517         16  TX-COMPANY-CD           PIC X.
  1518             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1519         16  TX-ACCESS-CD-GENL       PIC X(12).
  1520
  1521         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  28
* EL1044.cbl
  1522             20  TX-LETTER-NO        PIC X(4).
  1523             20  FILLER              PIC X(8).
  1524
  1525         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1526             20  TX-FORM-NO          PIC X(12).
  1527
  1528         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1529             20  TX-HELP-TYPE        PIC X.
  1530                 88  HELP-FOR-GENERAL   VALUE ' '.
  1531                 88  HELP-BY-SCREEN     VALUE 'S'.
  1532                 88  HELP-BY-ERROR      VALUE 'E'.
  1533             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1534                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1535             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1536                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1537             20  FILLER              PIC X(4).
  1538
  1539         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1540
  1541     12  TX-PROCESS-CONTROL          PIC XX.
  1542         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1543
  1544     12  TX-TEXT-LINE                PIC X(70).
  1545
  1546     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1547         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1548         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1549         88  TX-VALID-FORM-SQUEEZE-VALUE
  1550                                        VALUE 'Y' ' '.
  1551
  1552     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1553         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1554         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1555         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1556         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1557         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1558         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1559         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1560                                              'K' 'N' ' '
  1561                                              'Z'.
  1562
  1563     12  TX-ARCHIVE-SW               PIC X.
  1564         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1565         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1566         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1567
  1568     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1569     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1570
  1571     12  TX-BSR-CODE                 PIC X.
  1572         88  TX-BSR-LETTER              VALUE 'B'.
  1573         88  TX-NON-BSR-LETTER          VALUE ' '.
  1574
  1575     12  FILLER                      PIC X.
  1576*****************************************************************
  1577 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES.
  1578 0000-DFHEXIT SECTION.
  1579     MOVE '9#                    $   ' TO DFHEIV0.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  29
* EL1044.cbl
  1580     MOVE 'EL1044' TO DFHEIV1.
  1581     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1582     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1583     MOVE '5'                    TO DC-OPTION-CODE
  1584     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1585     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1586     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1587     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1588     IF EIBCALEN = 0
  1589        GO TO 8800-UNAUTHORIZED-ACCESS.
  1590     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1591     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1592     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1593
  1594* EXEC CICS HANDLE CONDITION
  1595*        DUPREC     (8850-DUPREC)
  1596*        NOTOPEN    (8870-NOTOPEN)
  1597*        NOTFND     (8880-NOT-FOUND)
  1598*        PGMIDERR   (9600-PGMID-ERROR)
  1599*        ERROR      (9990-ABEND)
  1600*    END-EXEC.
  1601*    MOVE '"$%JIL.               ! " #00001589' TO DFHEIV0
  1602     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1604     MOVE X'2220233030303031353839' TO DFHEIV0(25:11)
  1605     CALL 'kxdfhei1' USING DFHEIV0
  1606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1607
  1608     .
  1609 0150-SET-PROGRAM-SAVES.
  1610     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1611         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1612             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1613             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1614             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1615             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1616             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1617             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1618             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1619             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1620         ELSE
  1621             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1622             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1623             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1624             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1625             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1626             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1627             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1628             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1629     ELSE
  1630         GO TO 0200-RECEIVE.
  1631*    DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1632     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1633     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1634     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1635     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1636                                    PI-PREV-LETR-KEY
  1637     GO TO 1000-SHOW-LETR-RECORD
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  30
* EL1044.cbl
  1638     .
  1639 0200-RECEIVE.
  1640     IF EIBAID = DFHCLEAR
  1641        GO TO 9400-CLEAR.
  1642     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1643         MOVE LOW-VALUES             TO  EL1044ZI
  1644         MOVE ER-7008                TO  EMI-ERROR
  1645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1646         MOVE -1                     TO  MAINTL
  1647         GO TO 8200-SEND-DATAONLY.
  1648     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1649         NEXT SENTENCE
  1650     ELSE
  1651
  1652* EXEC CICS READQ TS
  1653*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1654*            INTO   (SECURITY-CONTROL)
  1655*            LENGTH (SC-COMM-LENGTH)
  1656*            ITEM   (SC-ITEM)
  1657*        END-EXEC
  1658*    MOVE '*$II   L              ''   #00001639' TO DFHEIV0
  1659     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1660     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1661     MOVE X'2020233030303031363339' TO DFHEIV0(25:11)
  1662     CALL 'kxdfhei1' USING DFHEIV0,
  1663           PI-SECURITY-TEMP-STORE-ID,
  1664           SECURITY-CONTROL,
  1665           SC-COMM-LENGTH,
  1666           SC-ITEM,
  1667           DFHEIV99,
  1668           DFHEIV99
  1669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1670         MOVE SC-CREDIT-DISPLAY (3)  TO  PI-DISPLAY-CAP
  1671         MOVE SC-CREDIT-UPDATE  (3)  TO  PI-MODIFY-CAP.
  1672
  1673* EXEC CICS RECEIVE
  1674*        MAP      (WS-MAP-NAME)
  1675*        MAPSET   (MAPSET-NAME)
  1676*        INTO     (EL1044ZI)
  1677*    END-EXEC
  1678     MOVE LENGTH OF
  1679      EL1044ZI
  1680       TO DFHEIV11
  1681*    MOVE '8"T I  L              ''   #00001647' TO DFHEIV0
  1682     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1683     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1684     MOVE X'2020233030303031363437' TO DFHEIV0(25:11)
  1685     CALL 'kxdfhei1' USING DFHEIV0,
  1686           WS-MAP-NAME,
  1687           EL1044ZI,
  1688           DFHEIV11,
  1689           MAPSET-NAME,
  1690           DFHEIV99,
  1691           DFHEIV99
  1692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1693     IF PFKEYL = +0
  1694         GO TO 0300-CHECK-PFKEYS.
  1695     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  31
* EL1044.cbl
  1696         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1697     ELSE
  1698         MOVE ER-0029                TO  EMI-ERROR
  1699         GO TO 0320-INPUT-ERROR.
  1700 0300-CHECK-PFKEYS.
  1701*    DISPLAY ' MADE IT TO 0300 '
  1702     IF EIBAID EQUAL DFHPF23
  1703         GO TO 8810-PF23.
  1704     IF EIBAID EQUAL DFHPF24
  1705         GO TO 9200-RETURN-MAIN-MENU.
  1706     IF EIBAID EQUAL DFHPF12
  1707         GO TO 9500-PF12.
  1708     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1709         MOVE ER-0050            TO EMI-ERROR
  1710         GO TO 0320-INPUT-ERROR.
  1711     IF EIBAID EQUAL DFHENTER
  1712         GO TO 0330-EDIT-DATA.
  1713     MOVE ER-0029                    TO  EMI-ERROR.
  1714 0320-INPUT-ERROR.
  1715*    DISPLAY ' MADE IT TO 0320 '
  1716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1717     MOVE AL-UNBON                   TO  PFKEYA.
  1718     MOVE -1                         TO  PFKEYL.
  1719     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  32
* EL1044.cbl
  1721 0330-EDIT-DATA.
  1722     IF NOT DISPLAY-CAP
  1723         MOVE 'READ'                 TO  SM-READ
  1724         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1725         MOVE ER-0070                TO  EMI-ERROR
  1726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1727         MOVE -1                     TO  MAINTL
  1728         GO TO 8100-SEND-INITIAL-MAP.
  1729     IF MAINTI EQUAL 'S'
  1730        GO TO 1000-SHOW-LETR-RECORD.
  1731     IF MAINTI = 'C' OR 'A'
  1732        IF NOT MODIFY-CAP
  1733           PERFORM 9995-SECURITY-VIOLATION
  1734                                 THRU 9995-EXIT
  1735           MOVE ER-0070          TO EMI-ERROR
  1736           PERFORM 9900-ERROR-FORMAT
  1737                                 THRU 9900-EXIT
  1738           MOVE LOW-VALUES       TO EL1044ZO
  1739           MOVE -1               TO MAINTL
  1740           GO TO 8100-SEND-INITIAL-MAP
  1741        END-IF
  1742     END-IF
  1743     IF MAINTI = 'C'
  1744        GO TO 2000-CHANGE-LETR-RECORD
  1745     END-IF
  1746     IF MAINTI = 'A'
  1747        GO TO 3000-ADD-LETR-RECORD
  1748     END-IF
  1749     MOVE ER-0023                    TO  EMI-ERROR.
  1750     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1751     MOVE -1                         TO  MAINTL.
  1752     MOVE AL-UABON                   TO  MAINTA.
  1753     GO TO 8200-SEND-DATAONLY.
  1754 1000-SHOW-LETR-RECORD.
  1755     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1756
  1757* EXEC CICS STARTBR
  1758*        DATASET   (ELLETR-FILE-ID)
  1759*        RIDFLD    (ELLETR-KEY)
  1760*        GTEQ
  1761*        RESP      (WS-RESPONSE)
  1762*    END-EXEC
  1763     MOVE 0
  1764       TO DFHEIV11
  1765*    MOVE '&,         G          &  N#00001715' TO DFHEIV0
  1766     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1767     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1768     MOVE X'204E233030303031373135' TO DFHEIV0(25:11)
  1769     CALL 'kxdfhei1' USING DFHEIV0,
  1770           ELLETR-FILE-ID,
  1771           ELLETR-KEY,
  1772           DFHEIV99,
  1773           DFHEIV11,
  1774           DFHEIV99
  1775     MOVE EIBRESP  TO WS-RESPONSE
  1776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1777     IF RESP-NORMAL
  1778        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  33
* EL1044.cbl
  1779           OR WE-FOUND-IT
  1780
  1781* EXEC CICS READNEXT
  1782*              DATASET    (ELLETR-FILE-ID)
  1783*              SET        (ADDRESS OF TEXT-FILES)
  1784*              RIDFLD     (ELLETR-KEY)
  1785*              RESP       (WS-RESPONSE)
  1786*          END-EXEC
  1787     MOVE 0
  1788       TO DFHEIV11
  1789*    MOVE '&.S                   )  N#00001724' TO DFHEIV0
  1790     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1791     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1792     MOVE X'204E233030303031373234' TO DFHEIV0(25:11)
  1793     CALL 'kxdfhei1' USING DFHEIV0,
  1794           ELLETR-FILE-ID,
  1795           DFHEIV20,
  1796           DFHEIV99,
  1797           ELLETR-KEY,
  1798           DFHEIV99,
  1799           DFHEIV11,
  1800           DFHEIV99,
  1801           DFHEIV99
  1802     SET ADDRESS OF TEXT-FILES TO
  1803         DFHEIV20
  1804     MOVE EIBRESP  TO WS-RESPONSE
  1805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1806           IF (RESP-NORMAL)
  1807              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1808              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1809                 SET WE-FOUND-IT   TO TRUE
  1810              END-IF
  1811           ELSE
  1812              SET I-SAY-TO-STOP  TO TRUE
  1813           END-IF
  1814        END-PERFORM
  1815     END-IF
  1816     IF WE-FOUND-IT
  1817        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1818                                    PI-PREV-LETR-KEY
  1819        GO TO 7000-BUILD-OUTPUT-MAP
  1820     END-IF
  1821     MOVE ER-0418                TO EMI-ERROR.
  1822     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1823     MOVE -1                     TO MAINTL
  1824     MOVE 'A'                    TO MAINTI
  1825     MOVE AL-UANON               TO MAINTA
  1826     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1827     MOVE +4                     TO ZLETRL
  1828     MOVE AL-UANON               TO ZLETRA
  1829     GO TO 8100-SEND-INITIAL-MAP
  1830     .
  1831 2000-CHANGE-LETR-RECORD.
  1832*    display ' made it to 2000 '
  1833*    display ' curr   ' pi-curr-letr-key
  1834*    display ' prev   ' pi-prev-letr-key
  1835     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1836        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  34
* EL1044.cbl
  1837        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1838        MOVE -1                  TO MAINTL
  1839        GO TO 8200-SEND-DATAONLY
  1840     END-IF
  1841     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1842     IF NOT EMI-NO-ERRORS
  1843         GO TO 8200-SEND-DATAONLY.
  1844     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1845     .
  1846 2000-CHANGE-CONTINUE.
  1847
  1848* EXEC CICS READ
  1849*        DATASET    (ELLETR-FILE-ID)
  1850*        SET        (ADDRESS OF TEXT-FILES)
  1851*        RIDFLD     (ELLETR-KEY)
  1852*        UPDATE
  1853*        RESP       (WS-RESPONSE)
  1854*    END-EXEC
  1855*    MOVE '&"S        EU         (  N#00001771' TO DFHEIV0
  1856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1857     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1858     MOVE X'204E233030303031373731' TO DFHEIV0(25:11)
  1859     CALL 'kxdfhei1' USING DFHEIV0,
  1860           ELLETR-FILE-ID,
  1861           DFHEIV20,
  1862           DFHEIV99,
  1863           ELLETR-KEY,
  1864           DFHEIV99,
  1865           DFHEIV99,
  1866           DFHEIV99
  1867     SET ADDRESS OF TEXT-FILES TO
  1868         DFHEIV20
  1869     MOVE EIBRESP  TO WS-RESPONSE
  1870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1871     IF RESP-NOTFND
  1872        IF ELLETR-SEQ-NO = +0
  1873           GO TO 2000-CONTINUE-CHANGE
  1874        END-IF
  1875     END-IF
  1876     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  1877        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  1878
  1879* EXEC CICS UNLOCK
  1880*            DATASET   (ELLETR-FILE-ID)
  1881*        END-EXEC
  1882*    MOVE '&*                    #   #00001785' TO DFHEIV0
  1883     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1884     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1885     MOVE X'2020233030303031373835' TO DFHEIV0(25:11)
  1886     CALL 'kxdfhei1' USING DFHEIV0,
  1887           ELLETR-FILE-ID,
  1888           DFHEIV99
  1889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1890         MOVE ER-0068                TO  EMI-ERROR
  1891         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1892         GO TO 1000-SHOW-LETR-RECORD.
  1893     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1894     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  35
* EL1044.cbl
  1895     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  1896     IF ZCOPIESL > +0
  1897        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1898     END-IF
  1899     IF ZFADAYSL > +0
  1900        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1901     END-IF
  1902     IF ZRDAYSL > +0
  1903        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  1904     END-IF
  1905     IF ZFORML > +0
  1906        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1907     END-IF
  1908     IF ZPROMPTL > +0
  1909        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1910     END-IF
  1911     IF ZENCCDL > +0
  1912        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1913     END-IF
  1914     IF ZACLOSEL > +0
  1915        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1916     END-IF
  1917     IF ZBENEL > +0
  1918        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1919     END-IF
  1920     IF ZACCTL > +0
  1921        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  1922     END-IF
  1923     IF ZTYPEL > +0
  1924        MOVE ZTYPEI              TO W-LETTER-TYPE
  1925     END-IF
  1926     IF ZPRTCRTL > +0
  1927        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  1928     END-IF
  1929     IF ZREFREQL > +0
  1930        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  1931     END-IF
  1932     IF ZONBASEL > +0
  1933         MOVE ZONBASEI           TO W-ONBASE-CODE
  1934     END-IF
  1935
  1936     IF ZACTSUML > +0
  1937         MOVE ZACTSUMI           TO W-ACCT-SUMM
  1938     END-IF
  1939
  1940     IF ZCSOSUML > +0
  1941         MOVE ZCSOSUMI           TO W-CSO-SUMM
  1942     END-IF
  1943
  1944     IF ZREASONL > +0
  1945        MOVE ZREASONI            TO W-REASONS-REQUIRED
  1946     END-IF
  1947     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  1948     .
  1949 2000-CONTINUE-CHANGE.
  1950*    DISPLAY ' ABOUT TO REWRITE '
  1951
  1952* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  36
* EL1044.cbl
  1953*        DATASET   (ELLETR-FILE-ID)
  1954*        FROM      (TEXT-FILES)
  1955*    END-EXEC.
  1956     MOVE LENGTH OF
  1957      TEXT-FILES
  1958       TO DFHEIV11
  1959*    MOVE '&& L                  %   #00001849' TO DFHEIV0
  1960     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1961     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1962     MOVE X'2020233030303031383439' TO DFHEIV0(25:11)
  1963     CALL 'kxdfhei1' USING DFHEIV0,
  1964           ELLETR-FILE-ID,
  1965           TEXT-FILES,
  1966           DFHEIV11,
  1967           DFHEIV99
  1968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1969
  1970     MOVE ER-0000                    TO  EMI-ERROR.
  1971     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1972     GO TO 1000-SHOW-LETR-RECORD
  1973     .
  1974 3000-ADD-LETR-RECORD.
  1975*    display ' made it to 3000 '
  1976*    display ' curr   ' pi-curr-letr-key
  1977*    display ' prev   ' pi-prev-letr-key
  1978     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1979     .
  1980 3000-CONTINUE-ADD.
  1981     IF NOT EMI-NO-ERRORS
  1982        GO TO 8200-SEND-DATAONLY
  1983     END-IF
  1984     MOVE SPACES                 TO ELLETR-KEY
  1985     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  1986     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  1987     MOVE +0                     TO ELLETR-SEQ-NO
  1988
  1989* EXEC CICS READ
  1990*        DATASET    (ELLETR-FILE-ID)
  1991*        SET        (ADDRESS OF TEXT-FILES)
  1992*        RIDFLD     (ELLETR-KEY)
  1993*        GTEQ
  1994*        RESP       (WS-RESPONSE)
  1995*    END-EXEC
  1996*    MOVE '&"S        G          (  N#00001871' TO DFHEIV0
  1997     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  1998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1999     MOVE X'204E233030303031383731' TO DFHEIV0(25:11)
  2000     CALL 'kxdfhei1' USING DFHEIV0,
  2001           ELLETR-FILE-ID,
  2002           DFHEIV20,
  2003           DFHEIV99,
  2004           ELLETR-KEY,
  2005           DFHEIV99,
  2006           DFHEIV99,
  2007           DFHEIV99
  2008     SET ADDRESS OF TEXT-FILES TO
  2009         DFHEIV20
  2010     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  37
* EL1044.cbl
  2011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2012     IF RESP-NORMAL
  2013        IF TX-LETTER-NO = ZLETRI
  2014           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  2015              MOVE ER-0132       TO EMI-ERROR
  2016              PERFORM 9900-ERROR-FORMAT
  2017                                 THRU 9900-EXIT
  2018              MOVE -1            TO ZLETRL
  2019              MOVE AL-UABON      TO ZLETRA
  2020              GO TO 8200-SEND-DATAONLY
  2021           ELSE
  2022              MOVE +0            TO WS-SEQ-NO-TO-USE
  2023           END-IF
  2024        ELSE
  2025           MOVE +1               TO WS-SEQ-NO-TO-USE
  2026        END-IF
  2027     ELSE
  2028        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2029     END-IF
  2030
  2031* EXEC CICS GETMAIN
  2032*       SET(ADDRESS OF TEXT-FILES)
  2033*       LENGTH(ELLETR-LENGTH)
  2034*    END-EXEC
  2035*    MOVE '," L                  $   #00001896' TO DFHEIV0
  2036     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2037     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2038     MOVE X'2020233030303031383936' TO DFHEIV0(25:11)
  2039     CALL 'kxdfhei1' USING DFHEIV0,
  2040           DFHEIV20,
  2041           ELLETR-LENGTH,
  2042           DFHEIV99
  2043     SET ADDRESS OF TEXT-FILES TO
  2044         DFHEIV20
  2045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2046     MOVE SPACES                 TO TEXT-FILES
  2047     MOVE 'TL'                   TO TEXT-FILE-ID
  2048     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2049     MOVE ZLETRI                 TO TX-LETTER-NO
  2050     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2051     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2052     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2053     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2054     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2055     IF ZCOPIESL > +0
  2056        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2057     ELSE
  2058        MOVE 1                   TO W-NUMBER-OF-COPIES
  2059     END-IF
  2060     IF ZFADAYSL > +0
  2061        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2062     END-IF
  2063     IF ZRDAYSL > +0
  2064        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2065     ELSE
  2066        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2067     END-IF
  2068     IF ZFORML > +0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  38
* EL1044.cbl
  2069        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2070     END-IF
  2071     IF ZPROMPTL > +0
  2072        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2073     END-IF
  2074     IF ZENCCDL > +0
  2075        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2076     END-IF
  2077     IF ZACLOSEL > +0
  2078        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2079     END-IF
  2080     IF ZBENEL > +0
  2081        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2082     END-IF
  2083     IF ZACCTL > +0
  2084        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2085     END-IF
  2086     IF ZTYPEL > +0
  2087        MOVE ZTYPEI              TO W-LETTER-TYPE
  2088     END-IF
  2089     IF ZPRTCRTL > +0
  2090        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2091     END-IF
  2092     IF ZREFREQL > +0
  2093        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2094     END-IF
  2095     IF ZONBASEL > +0
  2096        MOVE ZONBASEI            TO W-ONBASE-CODE
  2097     END-IF
  2098
  2099     IF ZACTSUML > +0
  2100         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2101     END-IF
  2102
  2103     IF ZCSOSUML > +0
  2104         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2105     END-IF
  2106
  2107     IF ZREASONL > +0
  2108        MOVE ZREASONI            TO W-REASONS-REQUIRED
  2109     END-IF
  2110     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2111*    DISPLAY ' ABOUT TO WRITE '
  2112     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2113                                    PI-CURR-LETR-KEY
  2114                                    PI-PREV-LETR-KEY
  2115
  2116* EXEC CICS WRITE
  2117*       DATASET (ELLETR-FILE-ID)
  2118*       FROM    (TEXT-FILES)
  2119*       RIDFLD  (ELLETR-KEY)
  2120*    END-EXEC
  2121     MOVE LENGTH OF
  2122      TEXT-FILES
  2123       TO DFHEIV11
  2124*    MOVE '&$ L                  ''   #00001969' TO DFHEIV0
  2125     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2126     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  39
* EL1044.cbl
  2127     MOVE X'2020233030303031393639' TO DFHEIV0(25:11)
  2128     CALL 'kxdfhei1' USING DFHEIV0,
  2129           ELLETR-FILE-ID,
  2130           TEXT-FILES,
  2131           DFHEIV11,
  2132           ELLETR-KEY,
  2133           DFHEIV99,
  2134           DFHEIV99
  2135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2136     MOVE ER-0000                    TO  EMI-ERROR.
  2137     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2138     GO TO 1000-SHOW-LETR-RECORD
  2139     .
  2140 5000-FIND-NEXT-PROD-RECORD.
  2141*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2142*
  2143*    EXEC CICS STARTBR
  2144*        DATASET   (ELLETR-FILE-ID)
  2145*        RIDFLD    (ELLETR-KEY)
  2146*        GTEQ
  2147*        RESP      (WS-RESPONSE)
  2148*    END-EXEC
  2149*
  2150*    IF NOT RESP-NORMAL
  2151*       MOVE -1                  TO PFKEYL
  2152*       MOVE ER-0130             TO EMI-ERROR
  2153*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2154*       GO TO 8200-SEND-DATAONLY
  2155*    END-IF
  2156     .
  2157 5000-READNEXT-LOOP.
  2158*    EXEC CICS READNEXT
  2159*        DATASET   (ELLETR-FILE-ID)
  2160*        SET       (ADDRESS OF PRODUCT-MASTER)
  2161*        RIDFLD    (ELLETR-KEY)
  2162*        RESP      (WS-RESPONSE)
  2163*    END-EXEC
  2164*
  2165*    IF (NOT RESP-NORMAL)
  2166*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2167*       PERFORM 5000-END-BROWSE
  2168*       MOVE -1                  TO PFKEYL
  2169*       MOVE ER-0130             TO EMI-ERROR
  2170*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2171*       GO TO 1000-SHOW-LETR-RECORD
  2172*    END-IF
  2173*
  2174*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2175*       GO TO 5000-READNEXT-LOOP
  2176*    END-IF
  2177*
  2178*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2179*
  2180*    PERFORM 5000-END-BROWSE
  2181*    GO TO 7000-BUILD-OUTPUT-MAP
  2182     .
  2183 5000-END-BROWSE.
  2184*    EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  40
* EL1044.cbl
  2185*        DATASET   (ELLETR-FILE-ID)
  2186*    END-EXEC
  2187     .
  2188 5100-FIND-PREV-PROD-RECORD.
  2189*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2190*    IF STATEL > +0
  2191*       MOVE STATEI              TO ELLETR-STATE
  2192*    END-IF
  2193*    IF PRODCDL > +0
  2194*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2195*    END-IF
  2196*    IF BENTYPL > +0
  2197*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2198*    IF BENCODEL > +0
  2199*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2200*    IF EXPDTL IS GREATER THAN +0
  2201*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2202*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2203*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2204*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2205*        ELSE
  2206*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2207*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2208*          END-STRING
  2209*           MOVE 'L'                    TO  DC-OPTION-CODE
  2210*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2211*            IF NO-CONVERSION-ERROR
  2212*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2213*            ELSE
  2214*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2215*
  2216*    EXEC CICS HANDLE CONDITION
  2217*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2218*    END-EXEC.
  2219*
  2220*    EXEC CICS STARTBR
  2221*        DATASET   (ELLETR-FILE-ID)
  2222*        RIDFLD    (ELLETR-KEY)
  2223*        GTEQ
  2224*    END-EXEC.
  2225 5100-READPREV-LOOP.
  2226*    EXEC CICS READPREV
  2227*        DATASET   (ELLETR-FILE-ID)
  2228*        SET       (ADDRESS OF PRODUCT-MASTER)
  2229*        RIDFLD    (ELLETR-KEY)
  2230*    END-EXEC.
  2231*
  2232*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2233*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2234*
  2235*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2236*        GO TO 5100-READPREV-LOOP.
  2237*
  2238*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2239*
  2240*    GO TO 7000-BUILD-OUTPUT-MAP.
  2241 5100-END-BROWSE.
  2242*    EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  41
* EL1044.cbl
  2243*        DATASET   (ELLETR-FILE-ID)
  2244*    END-EXEC.
  2245 5100-UNSUCCESSFUL-SEARCH.
  2246     PERFORM 5100-END-BROWSE.
  2247     MOVE ER-0131                    TO  EMI-ERROR.
  2248     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2249     GO TO 1000-SHOW-LETR-RECORD.
  2250     .
  2251 6000-EDIT-INPUT-DATA.
  2252     IF MAINTI = 'A'
  2253        IF ZLETRL > +0
  2254           AND ZLETRI NOT = SPACES
  2255           CONTINUE
  2256        ELSE
  2257           MOVE AL-UNBON         TO ZCOPIESA
  2258           MOVE -1               TO ZCOPIESL
  2259           MOVE ER-0005          TO EMI-ERROR
  2260           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2261        END-IF
  2262     END-IF
  2263     IF ZCOPIESL > +0
  2264        IF ZCOPIESI NUMERIC
  2265           CONTINUE
  2266        ELSE
  2267           MOVE AL-UNBON         TO ZCOPIESA
  2268           MOVE -1               TO ZCOPIESL
  2269           MOVE ER-0184          TO EMI-ERROR
  2270           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2271        END-IF
  2272     END-IF
  2273     IF ZFADAYSL > +0
  2274       IF ZFADAYSI NOT EQUAL SPACES
  2275          IF ZFADAYSI NUMERIC
  2276             CONTINUE
  2277          ELSE
  2278             MOVE AL-UNBON         TO ZFADAYSA
  2279             MOVE -1               TO ZFADAYSL
  2280             MOVE ER-0491          TO EMI-ERROR
  2281             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2282          END-IF
  2283       END-IF
  2284     END-IF
  2285     IF ZRDAYSL > +0
  2286       IF ZRDAYSI NOT EQUAL SPACES
  2287          IF ZRDAYSI NUMERIC
  2288             CONTINUE
  2289          ELSE
  2290             MOVE AL-UNBON         TO ZRDAYSA
  2291             MOVE -1               TO ZRDAYSL
  2292             MOVE ER-0491          TO EMI-ERROR
  2293             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2294          END-IF
  2295       END-IF
  2296     END-IF
  2297     IF ZPROMPTL > +0
  2298        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2299           CONTINUE
  2300        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  42
* EL1044.cbl
  2301           MOVE AL-UABON         TO ZPROMPTA
  2302           MOVE -1               TO ZPROMPTL
  2303           MOVE ER-0627          TO EMI-ERROR
  2304           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2305        END-IF
  2306     END-IF
  2307     IF MAINTI = 'A'
  2308        AND ZENCCDL <= 0
  2309        MOVE AL-UABON            TO ZENCCDA
  2310        MOVE -1                  TO ZENCCDL
  2311        MOVE ER-1560             TO EMI-ERROR
  2312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2313     END-IF
  2314     IF ZENCCDL > +0
  2315        IF ZENCCDI = 'E' OR 'ENV' OR '0' OR '@'
  2316                  OR 'A' OR 'C' OR 'CLM'
  2317                  OR 'RE'
  2318                  OR '1' OR '2' OR '3' OR 'B' OR 'D'
  2319           CONTINUE
  2320        ELSE
  2321           MOVE AL-UABON         TO ZENCCDA
  2322           MOVE -1               TO ZENCCDL
  2323           MOVE ER-1560          TO EMI-ERROR
  2324           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2325        END-IF
  2326     END-IF
  2327     IF MAINTI = 'A'
  2328        AND ZTYPEL <= 0
  2329        MOVE AL-UABON            TO ZTYPEA
  2330        MOVE -1                  TO ZTYPEL
  2331        MOVE ER-1564             TO EMI-ERROR
  2332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2333     END-IF
  2334     IF ZTYPEL > +0
  2335        IF ZTYPEI = 'C' OR 'P' OR 'U'
  2336           CONTINUE
  2337        ELSE
  2338           MOVE -1               TO ZTYPEL
  2339           MOVE AL-UABON         TO ZTYPEA
  2340           MOVE ER-1564          TO EMI-ERROR
  2341           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2342        END-IF
  2343     END-IF
  2344     IF ZACLOSEL > +0
  2345        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2346           CONTINUE
  2347        ELSE
  2348           MOVE -1               TO ZACLOSEL
  2349           MOVE AL-UABON         TO ZACLOSEA
  2350           MOVE ER-1562          TO EMI-ERROR
  2351           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2352        END-IF
  2353     END-IF
  2354     IF ZPRTCRTL > +0
  2355        IF ZPRTCRTI = 'Y' OR 'N' OR ' '
  2356           CONTINUE
  2357        ELSE
  2358           MOVE AL-UABON         TO ZPRTCRTA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  43
* EL1044.cbl
  2359           MOVE -1               TO ZPRTCRTL
  2360           MOVE ER-0627          TO EMI-ERROR
  2361           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2362        END-IF
  2363     END-IF
  2364     IF ZREFREQL > +0
  2365        IF ZREFREQI = 'Y' OR 'N' OR ' '
  2366           CONTINUE
  2367        ELSE
  2368           MOVE AL-UABON         TO ZREFREQA
  2369           MOVE -1               TO ZREFREQL
  2370           MOVE ER-0627          TO EMI-ERROR
  2371           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2372        END-IF
  2373     END-IF
  2374     IF MAINTI = 'A'
  2375        AND ZONBASEL <= 0
  2376        MOVE AL-UABON            TO ZONBASEA
  2377        MOVE -1                  TO ZONBASEL
  2378        MOVE ER-3804             TO EMI-ERROR
  2379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2380     END-IF
  2381     IF ZONBASEL > +0
  2382        IF ZONBASEI = ' '
  2383           MOVE AL-UABON            TO ZONBASEA
  2384           MOVE -1                  TO ZONBASEL
  2385           MOVE ER-3804             TO EMI-ERROR
  2386           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2387        END-IF
  2388     END-IF
  2389
  2390     IF ZACTSUML > +0
  2391        IF ZACTSUMI = '1' OR '2' OR ' '
  2392           CONTINUE
  2393        ELSE
  2394           MOVE AL-UABON         TO ZACTSUMA
  2395           MOVE -1               TO ZACTSUML
  2396           MOVE ER-3820          TO EMI-ERROR
  2397           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2398        END-IF
  2399     END-IF
  2400
  2401     IF ZCSOSUML > +0
  2402        IF ZCSOSUMI = '3' OR '4' OR ' '
  2403           CONTINUE
  2404        ELSE
  2405           MOVE AL-UABON         TO ZCSOSUMA
  2406           MOVE -1               TO ZCSOSUML
  2407           MOVE ER-3821          TO EMI-ERROR
  2408           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2409        END-IF
  2410     END-IF
  2411
  2412     IF ZREASONL > +0
  2413        IF ZREASONI = 'Y' OR 'N' OR ' '
  2414           CONTINUE
  2415        ELSE
  2416           MOVE AL-UABON         TO ZREASONA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  44
* EL1044.cbl
  2417           MOVE -1               TO ZREASONL
  2418           MOVE ER-0627          TO EMI-ERROR
  2419           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2420        END-IF
  2421     END-IF
  2422
  2423     .
  2424 6000-EXIT.
  2425     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  45
* EL1044.cbl
  2427 7000-BUILD-OUTPUT-MAP.
  2428     MOVE LOW-VALUES             TO EL1044ZO
  2429     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2430     MOVE TX-LETTER-NO           TO ZLETRO
  2431     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2432     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2433     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2434     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2435     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2436     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2437     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2438     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2439     MOVE W-LETTER-TO-ACCT       TO ZACCTO
  2440     MOVE W-LETTER-TYPE          TO ZTYPEO
  2441     MOVE W-PRINT-CERTIFICATE    TO ZPRTCRTO
  2442     MOVE W-REFUND-REQUIRED      TO ZREFREQO
  2443     MOVE W-ONBASE-CODE          TO ZONBASEO
  2444     MOVE W-ACCT-SUMM            TO ZACTSUMO
  2445     MOVE W-CSO-SUMM             TO ZCSOSUMO
  2446     MOVE W-REASONS-REQUIRED     TO ZREASONO
  2447     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2448                                    PI-UPDATE-BY
  2449     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2450                                    DC-BIN-DATE-1
  2451     MOVE ' '                    TO DC-OPTION-CODE
  2452     MOVE +0                     TO DC-ELAPSED-DAYS
  2453                                     DC-ELAPSED-MONTHS.
  2454     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2455     IF NO-CONVERSION-ERROR
  2456        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2457     ELSE
  2458        MOVE LOW-VALUES          TO LSTDTEO
  2459     END-IF
  2460     MOVE -1                     TO MAINTL
  2461     .
  2462 8100-SEND-INITIAL-MAP.
  2463     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2464     MOVE EIBTIME                    TO  TIME-IN.
  2465     MOVE SAVE-DATE                  TO  DATEO.
  2466     MOVE TIME-OUT                   TO  TIMEO
  2467     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2468     MOVE PI-PROCESSOR-ID        TO USERIDO
  2469
  2470* EXEC CICS SEND
  2471*        MAP      (WS-MAP-NAME)
  2472*        MAPSET   (MAPSET-NAME)
  2473*        FROM     (EL1044ZO)
  2474*        ERASE
  2475*        CURSOR
  2476*    END-EXEC.
  2477     MOVE LENGTH OF
  2478      EL1044ZO
  2479       TO DFHEIV12
  2480     MOVE -1
  2481       TO DFHEIV11
  2482*    MOVE '8$     CT  E    H L F ,   #00002307' TO DFHEIV0
  2483     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2484     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  46
* EL1044.cbl
  2485     MOVE X'2020233030303032333037' TO DFHEIV0(25:11)
  2486     CALL 'kxdfhei1' USING DFHEIV0,
  2487           WS-MAP-NAME,
  2488           EL1044ZO,
  2489           DFHEIV12,
  2490           MAPSET-NAME,
  2491           DFHEIV99,
  2492           DFHEIV99,
  2493           DFHEIV99,
  2494           DFHEIV11,
  2495           DFHEIV99,
  2496           DFHEIV99,
  2497           DFHEIV99
  2498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2499
  2500     MOVE '044Z'                 TO PI-CURRENT-SCREEN-NO
  2501     GO TO 9100-RETURN-TRAN
  2502     .
  2503 8200-SEND-DATAONLY.
  2504*    DISPLAY ' MADE IT TO 8200 '
  2505     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2506     MOVE EIBTIME                    TO  TIME-IN.
  2507     MOVE SAVE-DATE                  TO  DATEO.
  2508     MOVE TIME-OUT                   TO  TIMEO.
  2509     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2510     MOVE PI-PROCESSOR-ID        TO USERIDO
  2511
  2512* EXEC CICS SEND
  2513*        MAP      (WS-MAP-NAME)
  2514*        MAPSET   (MAPSET-NAME)
  2515*        FROM     (EL1044ZO)
  2516*        DATAONLY
  2517*        CURSOR
  2518*    END-EXEC.
  2519     MOVE LENGTH OF
  2520      EL1044ZO
  2521       TO DFHEIV12
  2522     MOVE -1
  2523       TO DFHEIV11
  2524*    MOVE '8$D    CT       H L F ,   #00002325' TO DFHEIV0
  2525     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2526     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2527     MOVE X'2020233030303032333235' TO DFHEIV0(25:11)
  2528     CALL 'kxdfhei1' USING DFHEIV0,
  2529           WS-MAP-NAME,
  2530           EL1044ZO,
  2531           DFHEIV12,
  2532           MAPSET-NAME,
  2533           DFHEIV99,
  2534           DFHEIV99,
  2535           DFHEIV99,
  2536           DFHEIV11,
  2537           DFHEIV99,
  2538           DFHEIV99,
  2539           DFHEIV99
  2540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2541
  2542     GO TO 9100-RETURN-TRAN
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  47
* EL1044.cbl
  2543     .
  2544 8300-SEND-TEXT.
  2545
  2546* EXEC CICS SEND TEXT
  2547*        FROM  (LOGOFF-TEXT)
  2548*        LENGTH(LOGOFF-LENGTH)
  2549*        ERASE
  2550*        FREEKB
  2551*    END-EXEC.
  2552*    MOVE '8&      T  E F  H   F -   #00002335' TO DFHEIV0
  2553     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2554     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2555     MOVE X'2020233030303032333335' TO DFHEIV0(25:11)
  2556     CALL 'kxdfhei1' USING DFHEIV0,
  2557           LOGOFF-TEXT,
  2558           LOGOFF-LENGTH,
  2559           DFHEIV99,
  2560           DFHEIV99,
  2561           DFHEIV99,
  2562           DFHEIV99,
  2563           DFHEIV99,
  2564           DFHEIV99,
  2565           DFHEIV99,
  2566           DFHEIV99,
  2567           DFHEIV99,
  2568           DFHEIV99
  2569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2570
  2571
  2572* EXEC CICS RETURN
  2573*        END-EXEC.
  2574*    MOVE '.(                    ''   #00002341' TO DFHEIV0
  2575     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2576     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2577     MOVE X'2020233030303032333431' TO DFHEIV0(25:11)
  2578     CALL 'kxdfhei1' USING DFHEIV0,
  2579           DFHEIV99,
  2580           DFHEIV99,
  2581           DFHEIV99,
  2582           DFHEIV99,
  2583           DFHEIV99,
  2584           DFHEIV99
  2585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2586
  2587     .
  2588 8500-DEEDIT.
  2589     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2590                                 TO WS-9V999-OF-DEEDIT
  2591     .
  2592 8500-EXIT.
  2593     EXIT.
  2594 8600-DEEDIT.
  2595     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2596                                 TO WS-NUMVAL-OF-DEEDIT
  2597     .
  2598 8600-EXIT.
  2599     EXIT.
  2600 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  48
* EL1044.cbl
  2601     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2602     GO TO 8300-SEND-TEXT.
  2603 8810-PF23.
  2604     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2605     MOVE XCTL-005                   TO  PGM-NAME.
  2606     GO TO 9300-XCTL.
  2607 8850-DUPREC.
  2608     MOVE ER-0132                    TO  EMI-ERROR.
  2609     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2610     MOVE -1                         TO  MAINTL
  2611     MOVE AL-UABON                   TO  ZLETRA
  2612     GO TO 8100-SEND-INITIAL-MAP.
  2613 8870-NOTOPEN.
  2614     MOVE LOW-VALUES                 TO  EL1044ZO.
  2615     MOVE -1                         TO  MAINTL.
  2616     MOVE ER-0701                    TO  EMI-ERROR.
  2617     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2618     GO TO 8100-SEND-INITIAL-MAP.
  2619 8880-NOT-FOUND.
  2620     MOVE ER-0702                    TO  EMI-ERROR.
  2621     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2622     MOVE -1                         TO  MAINTL
  2623     MOVE AL-UABON                   TO  ZLETRA
  2624     GO TO 8100-SEND-INITIAL-MAP.
  2625     .
  2626 9100-RETURN-TRAN.
  2627     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2628
  2629* EXEC CICS RETURN
  2630*        TRANSID    (TRANS-ID)
  2631*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2632*        LENGTH     (PI-COMM-LENGTH)
  2633*    END-EXEC.
  2634*    MOVE '.(CT                  ''   #00002384' TO DFHEIV0
  2635     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2636     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2637     MOVE X'2020233030303032333834' TO DFHEIV0(25:11)
  2638     CALL 'kxdfhei1' USING DFHEIV0,
  2639           TRANS-ID,
  2640           PROGRAM-INTERFACE-BLOCK,
  2641           PI-COMM-LENGTH,
  2642           DFHEIV99,
  2643           DFHEIV99,
  2644           DFHEIV99
  2645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2646
  2647 9200-RETURN-MAIN-MENU.
  2648     MOVE XCTL-626                   TO  PGM-NAME.
  2649     GO TO 9300-XCTL.
  2650 9300-XCTL.
  2651
  2652* EXEC CICS XCTL
  2653*        PROGRAM    (PGM-NAME)
  2654*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2655*        LENGTH     (PI-COMM-LENGTH)
  2656*    END-EXEC.
  2657*    MOVE '.$C                   %   #00002393' TO DFHEIV0
  2658     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  49
* EL1044.cbl
  2659     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2660     MOVE X'2020233030303032333933' TO DFHEIV0(25:11)
  2661     CALL 'kxdfhei1' USING DFHEIV0,
  2662           PGM-NAME,
  2663           PROGRAM-INTERFACE-BLOCK,
  2664           PI-COMM-LENGTH,
  2665           DFHEIV99
  2666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2667
  2668 9400-CLEAR.
  2669     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  2670     GO TO 9300-XCTL.
  2671 9500-PF12.
  2672     MOVE XCTL-010                   TO  PGM-NAME.
  2673     GO TO 9300-XCTL.
  2674 9600-PGMID-ERROR.
  2675
  2676* EXEC CICS HANDLE CONDITION
  2677*        PGMIDERR   (8300-SEND-TEXT)
  2678*    END-EXEC.
  2679*    MOVE '"$L                   ! # #00002405' TO DFHEIV0
  2680     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2682     MOVE X'2320233030303032343035' TO DFHEIV0(25:11)
  2683     CALL 'kxdfhei1' USING DFHEIV0
  2684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2685
  2686     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  2687     MOVE ' '                        TO  PI-ENTRY-CD-1.
  2688     MOVE XCTL-005                   TO  PGM-NAME.
  2689     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  2690     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  2691     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  50
* EL1044.cbl
  2693 9700-LINK-DATE-CONVERT.
  2694
  2695* EXEC CICS LINK
  2696*        PROGRAM    ('ELDATCV')
  2697*        COMMAREA   (DATE-CONVERSION-DATA)
  2698*        LENGTH     (DC-COMM-LENGTH)
  2699*    END-EXEC.
  2700     MOVE 'ELDATCV' TO DFHEIV1
  2701*    MOVE '."C                   (   #00002416' TO DFHEIV0
  2702     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2704     MOVE X'2020233030303032343136' TO DFHEIV0(25:11)
  2705     CALL 'kxdfhei1' USING DFHEIV0,
  2706           DFHEIV1,
  2707           DATE-CONVERSION-DATA,
  2708           DC-COMM-LENGTH,
  2709           DFHEIV99,
  2710           DFHEIV99,
  2711           DFHEIV99,
  2712           DFHEIV99
  2713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2714
  2715 9700-EXIT.
  2716     EXIT.
  2717 9900-ERROR-FORMAT.
  2718     IF NOT EMI-ERRORS-COMPLETE
  2719         MOVE LINK-001               TO  PGM-NAME
  2720
  2721* EXEC CICS LINK
  2722*            PROGRAM    (PGM-NAME)
  2723*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2724*            LENGTH     (EMI-COMM-LENGTH)
  2725*        END-EXEC.
  2726*    MOVE '."C                   (   #00002426' TO DFHEIV0
  2727     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2729     MOVE X'2020233030303032343236' TO DFHEIV0(25:11)
  2730     CALL 'kxdfhei1' USING DFHEIV0,
  2731           PGM-NAME,
  2732           ERROR-MESSAGE-INTERFACE-BLOCK,
  2733           EMI-COMM-LENGTH,
  2734           DFHEIV99,
  2735           DFHEIV99,
  2736           DFHEIV99,
  2737           DFHEIV99
  2738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2739
  2740 9900-EXIT.
  2741     EXIT.
  2742 9990-ABEND.
  2743     MOVE LINK-004                   TO  PGM-NAME.
  2744     MOVE DFHEIBLK                   TO  EMI-LINE1.
  2745
  2746* EXEC CICS LINK
  2747*        PROGRAM   (PGM-NAME)
  2748*        COMMAREA  (EMI-LINE1)
  2749*        LENGTH    (72)
  2750*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  51
* EL1044.cbl
  2751     MOVE 72
  2752       TO DFHEIV11
  2753*    MOVE '."C                   (   #00002436' TO DFHEIV0
  2754     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2756     MOVE X'2020233030303032343336' TO DFHEIV0(25:11)
  2757     CALL 'kxdfhei1' USING DFHEIV0,
  2758           PGM-NAME,
  2759           EMI-LINE1,
  2760           DFHEIV11,
  2761           DFHEIV99,
  2762           DFHEIV99,
  2763           DFHEIV99,
  2764           DFHEIV99
  2765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2766
  2767     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  52
* EL1044.cbl
  2769 9995-SECURITY-VIOLATION.
  2770*                            COPY ELCSCTP.
  2771******************************************************************
  2772*                                                                *
  2773*                            ELCSCTP                             *
  2774*                            VMOD=2.001                          *
  2775*                                                                *
  2776*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2777******************************************************************
  2778
  2779
  2780     MOVE EIBDATE          TO SM-JUL-DATE.
  2781     MOVE EIBTRMID         TO SM-TERMID.
  2782     MOVE THIS-PGM         TO SM-PGM.
  2783     MOVE EIBTIME          TO TIME-IN.
  2784     MOVE TIME-OUT         TO SM-TIME.
  2785     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2786
  2787
  2788* EXEC CICS LINK
  2789*         PROGRAM  ('EL003')
  2790*         COMMAREA (SECURITY-MESSAGE)
  2791*         LENGTH   (80)
  2792*    END-EXEC.
  2793     MOVE 'EL003' TO DFHEIV1
  2794     MOVE 80
  2795       TO DFHEIV11
  2796*    MOVE '."C                   (   #00002461' TO DFHEIV0
  2797     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2799     MOVE X'2020233030303032343631' TO DFHEIV0(25:11)
  2800     CALL 'kxdfhei1' USING DFHEIV0,
  2801           DFHEIV1,
  2802           SECURITY-MESSAGE,
  2803           DFHEIV11,
  2804           DFHEIV99,
  2805           DFHEIV99,
  2806           DFHEIV99,
  2807           DFHEIV99
  2808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2809
  2810
  2811******************************************************************
  2812
  2813 9995-EXIT.
  2814     EXIT.
  2815
  2816 9999-DFHBACK SECTION.
  2817     MOVE '9%                    "   ' TO DFHEIV0
  2818     MOVE 'EL1044' TO DFHEIV1
  2819     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2820     GOBACK.
  2821 9999-DFHEXIT.
  2822     IF DFHEIGDJ EQUAL 0001
  2823         NEXT SENTENCE
  2824     ELSE IF DFHEIGDJ EQUAL 2
  2825         GO TO 8850-DUPREC,
  2826               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  53
* EL1044.cbl
  2827               8880-NOT-FOUND,
  2828               9600-PGMID-ERROR,
  2829               9990-ABEND
  2830         DEPENDING ON DFHEIGDI
  2831     ELSE IF DFHEIGDJ EQUAL 3
  2832         GO TO 8300-SEND-TEXT
  2833         DEPENDING ON DFHEIGDI.
  2834     MOVE '9%                    "   ' TO DFHEIV0
  2835     MOVE 'EL1044' TO DFHEIV1
  2836     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2837     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4624     Code:        6917
