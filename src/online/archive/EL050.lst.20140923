* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51******************************************************************
    52 ENVIRONMENT DIVISION.
    53
    54 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page   3
* EL050.cbl
    56 WORKING-STORAGE SECTION.
    57 01  DFH-START PIC X(04).
    58
    59 77  FILLER   PIC X(32) VALUE '********************************'.
    60 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    61 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    62
    63 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    64 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    65                                   USAGE POINTER.
    66 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    67 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    69                                   USAGE IS POINTER.
    70 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    72                                   USAGE IS POINTER.
    73 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    75                                   USAGE IS POINTER.
    76
    77 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    79                                   USAGE IS POINTER.
    80
    81*    COPY ELC50WS.
    82*****************************************************************
    83*                                                               *
    84*                            ELC50WS.                           *
    85*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    86*                            VMOD=2.061.                        *
    87*                                                               *
    88*   THIS IS THE WORKING STORAGE FOR EL050                       *
    89*                                   EL517                       *
    90*****************************************************************
    91******************************************************************
    92*                   C H A N G E   L O G
    93*
    94* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    95*-----------------------------------------------------------------
    96*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    97* EFFECTIVE    NUMBER
    98*-----------------------------------------------------------------
    99* 123102                   PEMA  ADD DCC PROCESSING
   100* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   101* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   102* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   103* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   104* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   105* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   106* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   107* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   108* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   109* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   110* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   111* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   112* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   113* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page   4
* EL050.cbl
   114* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   115* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   116* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   117* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   118* 030309  CR2009021700001  PEMA  ADD ER-2883
   119* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   120* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   121* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   122* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   123* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   124* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   125* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   126* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   127* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   128* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   129* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   130* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   131* 061412  CR2011022800001  AJRA  NAPERSOFT
   132* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   133* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   134* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   135* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   136* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   137* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   138* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   139* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   140* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   141*-----------------------------------------------------------------
   142
   143 01  WORK-AREAS.
   144
   145*****************************************************************
   146*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   147*****************************************************************
   148
   149     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   150     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   151     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   152     12  WS-NAME-EDIT-WORK-AREA.
   153         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   154         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   155             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   156         16  WS-WORK-NAME.
   157             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   158             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   159             20  FILLER           PIC X(10)     VALUE SPACES.
   160         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   161             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   162
   163*****************************************************************
   164*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   165*****************************************************************
   166
   167     12  WS-ERRESC-KEY.
   168         16 WS-ERRESC-SEARCH-KEY.
   169             20  WS-ERRESC-COMPANY-CD PIC  X.
   170             20  WS-ERRESC-CARRIER    PIC  X.
   171             20  WS-ERRESC-GROUP      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page   5
* EL050.cbl
   172             20  WS-ERRESC-STATE      PIC XX.
   173             20  WS-ERRESC-ACCOUNT    PIC X(10).
   174         16 WS-ERRESC-RESIDUAL-KEY.
   175             20  WS-ERRESC-AGENT      PIC X(10).
   176             20  WS-ERRESC-RES-STATE  PIC XX.
   177             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   178*                                          YYYYMMDD
   179     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   180     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   181
   182*RESIDENT STATE TAX MASTER(ERRESS)
   183*
   184     12  WS-ERRESS-KEY.
   185         16  WS-ERRESS-COMPANY-CD      PIC  X.
   186         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   187         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   188         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   189*                                          YYYYMMDD
   190
   191     12  WS-CONTRACT-DATE              PIC 9(8).
   192*                                          YYYYMMDD
   193     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   194     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   195         16 WS-YEAR-YY                 PIC   9999.
   196         16 FILLER                     PIC 9(4).
   197*                                          YYYYMMDD
   198     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   199     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   200     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   201     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   202
   203     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   204         88  DPRB-1ST-TIME                      VALUE ' '.
   205
   206*****************************************************************
   207*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   208*****************************************************************
   209
   210     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   211     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   212     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   213     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   214     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   215     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   216     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   217     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   218     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   219     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   220     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   221         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   222         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   223     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   224         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   225         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   226     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   227
   228     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   229     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page   6
* EL050.cbl
   230
   231     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   232     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   237     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   238     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   243     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   244     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   245     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   246     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   262     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   263     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   264     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   267     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   268     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   269     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   270     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   271     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   272     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   273     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   274     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   275     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   279     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   280     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   281     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   282     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   283     12  WS-2671-SW               PIC X         VALUE SPACE.
   284     12  WS-2672-SW               PIC X         VALUE SPACE.
   285     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   286         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   287     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page   7
* EL050.cbl
   288         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   289     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   290
   291     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   292         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   293         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   294         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   295         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   296
   297     12  WS-CREDIT-EDIT-CONTROLS.
   298         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   299         16  WS-MIN-AGE           PIC 99                VALUE  0.
   300         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   301         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   302         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   303         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   304
   305     12  WS-AGE-FIELDS.
   306         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   307         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   308         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   309         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   310
   311     12  WS-SAVE-ALLOWABLE-BENEFIT.
   312         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   313         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   314         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   315         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   316         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   317         16  FILLER                      PIC XX.
   318
   319     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   320     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   321     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   322     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   323     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   324     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   325     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   326     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   327     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   328     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   329
   330     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   331     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   332     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   333     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   334     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   335     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   336     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   337     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   338         88  WS-REDUCING              VALUE 'R'.
   339         88  WS-LEVEL                 VALUE 'L' 'P'.
   340     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   341
   342     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   343     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   344     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   345     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page   8
* EL050.cbl
   346     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   347     12  ws-ah-max-bens           pic 99        value zeros.
   348     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   349     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   350     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   351     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   352
   353     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   354     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   355     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   356     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   357     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   358     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   359     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   360     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   361     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   362     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   363     12  WS-ACCT-SIG-SW.
   364         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   365         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   366     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   367     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   368     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   369     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   370     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   371     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   372     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   373     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   374     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  WS-INITIALS.
   376         16  WS-INIT-1            PIC X         VALUE SPACES.
   377         16  WS-INIT-2            PIC X         VALUE SPACES.
   378
   379     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   380     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   381     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   382     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   383     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   384*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   385     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   386     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   387     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   388     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   389     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   390     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   391     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   392     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   393     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   395     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   396     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   397     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   398     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   399     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   400     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   401     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   402     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   403     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page   9
* EL050.cbl
   404     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   405     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   406     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   407******** FLA
   408     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   409     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   410     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   411     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   412     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   413********
   414     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   415     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   416     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   417     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   418     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   419     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   420     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   421     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   422     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   423     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   424
   425     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   426         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   427                                         '0' THRU '9'.
   428
   429     12  NUMBER-OF-MONTHS.
   430         16  SK-MO OCCURS 12 TIMES PIC X.
   431
   432     12  WS-WORK-DATE.
   433         16  WS-YEAR            PIC 99    VALUE 00.
   434         16  WS-MONTH           PIC 99    VALUE 00.
   435         16  WS-DAY             PIC 99    VALUE 00.
   436
   437     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   438     12  WS-WORK-CRIT-DEV       REDEFINES
   439         WS-WORK-LF-CRIT-PER    PIC X(03).
   440
   441     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   442     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   443
   444     12  WS-WORK-DATE-FROM.
   445         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   446         16  FILLER             PIC X  VALUE SPACE.
   447         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   448         16  FILLER             PIC X         VALUE SPACE.
   449         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   450
   451     12  WS-WORK-DATE-THRU.
   452         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   453         16  FILLER             PIC X         VALUE SPACE.
   454         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   455         16  FILLER             PIC X         VALUE SPACE.
   456         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   457
   458     12  WS-LF-INPUT-CD.
   459         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   460         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   461
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  10
* EL050.cbl
   462     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   463     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   464         16  WS-AH-INPUT-CD-1   PIC X.
   465         16  WS-AH-INPUT-CD-2-3 PIC XX.
   466
   467     12  WS-SWITCHES.
   468         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   469         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   470             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   471         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   472             88  BANK-ACCT-FOUND          VALUE 'Y'.
   473         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   474             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   475         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   476             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   477         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   478             88  COMP-MASTER-FOUND        VALUE 'Y'.
   479         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   480             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   481         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   482             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   483         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   484             88  STAT-MASTER-FOUND        VALUE 'Y'.
   485         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   486             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   487         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   488             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   489         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   490             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   491         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   492             88  FORM-MASTER-FOUND        VALUE 'Y'.
   493         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   494             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   495         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   496             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   497         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   498             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   499         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   500             88  NO-BENEFIT-FOUND         VALUE 'N'.
   501         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   502             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   503         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   504             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   505         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   506             88  AH-BENEFIT-FOUND         VALUE ' '.
   507             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   508         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   509             88  LF-BENEFIT-FOUND         VALUE ' '.
   510             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   511         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   512             88  NO-STATE-RECORD          VALUE '1'.
   513         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   514             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   515         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   516             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   517         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   518             88  CERT-WAS-FOUND           VALUE ' '.
   519             88  CERT-WAS-NOT-FOUND       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  11
* EL050.cbl
   520         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   521             88  BROWSE-STARTED           VALUE 'Y'.
   522         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   523             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   524         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   525             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   526         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   527             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   528         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   529             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   530         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   531             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   532         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   533             88  APP-CERT-USED            VALUE 'Y' 'A'.
   534         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   535             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   536             88  FIRST-TIME-THROUGH       VALUE '1'.
   537             88  CTBL-NOT-FOUND           VALUE '2'.
   538
   539         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   540             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   541
   542         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   543             88  DLO-ERROR-FOUND          VALUE 'Y'.
   544
   545********FLA
   546     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   547     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   548********
   549     12  RC-SW-1                  PIC X           VALUE '0'.
   550     12  RC-SW-2                  PIC X           VALUE '0'.
   551     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   552     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   553     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   554     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   555     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   556     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   557     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   558     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   559     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   560     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   561     12  LIT-SPACES               PIC X           VALUE SPACES.
   562     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   563     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   564     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   565     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   566     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   567     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   568     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   569         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   570         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   571     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   572         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   573
   574 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   575     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   576     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   577 01  WS-CRI-SSN-WORK-AREA.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  12
* EL050.cbl
   578     05  WS-CRI-SOC-SEC-NO.
   579         10  WS-SS-REPT-CD       PIC X(5).
   580         10  WS-SS-LAST-NAME     PIC X(5).
   581         10  WS-SS-INITIAL       PIC X.
   582
   583     05  WS-CRI-REPORT-CODE.
   584         10  FILLER              PIC X(5).
   585         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   586
   587     05  WS-CRI-LAST-NAME.
   588         10  WS-CRI-NAME-MOVE    PIC X(5).
   589         10  FILLER              PIC X(10).
   590
   591 01  WS-NUM-TABLE                PIC X(26)  VALUE
   592     '12345678012345070923456789'.
   593 01  FILLER REDEFINES WS-NUM-TABLE.
   594     05  WS-NUM OCCURS 26        PIC 9.
   595 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   596 01  V1                          PIC S999 COMP-3.
   597 01  V2                          PIC S999 COMP-3.
   598 01  V3                          PIC S999 COMP-3.
   599 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   600 01  FILLER REDEFINES WS-WORK-VIN.
   601     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   602 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   603 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   604 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   605 01  WS-HEX-WORK.
   606     05  FILLER                  PIC X  VALUE LOW-VALUES.
   607     05  WS-HEX-BYTE             PIC X.
   608 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   609 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   610 01  WS-WORK-HIN-ROW-B.
   611     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   612
   613 01  ws-benefit-cd-chg-sw      pic x value spaces.
   614     88  benefit-code-chg           value 'Y'.
   615 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   616 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   617     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   618 01  WS-ROW-D-TABLE.
   619     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   620
   621 01  WS-HIN-TABLE-B.
   622     05  F                       PIC XX VALUE 'A2'.
   623     05  F                       PIC XX VALUE 'B3'.
   624     05  F                       PIC XX VALUE 'C4'.
   625     05  F                       PIC XX VALUE 'D5'.
   626     05  F                       PIC XX VALUE 'E6'.
   627     05  F                       PIC XX VALUE 'F7'.
   628     05  F                       PIC XX VALUE 'G8'.
   629     05  F                       PIC XX VALUE 'H9'.
   630     05  F                       PIC XX VALUE 'I1'.
   631     05  F                       PIC XX VALUE 'J2'.
   632     05  F                       PIC XX VALUE 'K3'.
   633     05  F                       PIC XX VALUE 'L4'.
   634     05  F                       PIC XX VALUE 'M5'.
   635     05  F                       PIC XX VALUE 'N6'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  13
* EL050.cbl
   636     05  F                       PIC XX VALUE 'O0'.
   637     05  F                       PIC XX VALUE 'P7'.
   638     05  F                       PIC XX VALUE 'Q0'.
   639     05  F                       PIC XX VALUE 'R8'.
   640     05  F                       PIC XX VALUE 'S9'.
   641     05  F                       PIC XX VALUE 'T2'.
   642     05  F                       PIC XX VALUE 'U3'.
   643     05  F                       PIC XX VALUE 'V4'.
   644     05  F                       PIC XX VALUE 'W5'.
   645     05  F                       PIC XX VALUE 'X6'.
   646     05  F                       PIC XX VALUE 'Y7'.
   647     05  F                       PIC XX VALUE 'Z8'.
   648 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   649     05  WS-VAL-IN               PIC X.
   650     05  WS-VAL-OUT              PIC 9.
   651 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   652 01  WS-COMPARE-BINARY-DATES.
   653     05  WS-971231                PIC XX VALUE X'92FF'.
   654     05  WS-931231                PIC XX VALUE X'8CFF'.
   655     05  WS-791231                PIC XX VALUE X'77FF'.
   656     05  WS-771001                PIC XX VALUE X'74A1'.
   657     05  WS-820301                PIC XX VALUE X'7B41'.
   658     05  WS-831031                PIC XX VALUE X'7DBF'.
   659     05  WS-831231                PIC XX VALUE X'7DFF'.
   660     05  WS-810831                PIC XX VALUE X'7A7F'.
   661     05  WS-830901                PIC XX VALUE X'7D81'.
   662
   663 01  FILE-ACCESS-IDS.
   664     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   665     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   666     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   667     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   668     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   669     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   670     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   671     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   672     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   673     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   674     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   675     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   676     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   677     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   678     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   679     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   680     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   681 01  DD-IU-SW                    PIC X   VALUE ' '.
   682     88  DD-IU-PRESENT                 VALUE 'Y'.
   683
   684 01  ACCESS-KEYS.
   685     12  ELMSTR-KEY.
   686         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   687         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   688     12  W-CLAIM-KEY.
   689         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   690         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   691
   692     12  ELCNTL-KEY.
   693         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  14
* EL050.cbl
   694         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   695         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   696         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   697
   698     12  ELCERT-KEY.
   699         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  CERT-CARRIER         PIC X       VALUE SPACE.
   701         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   702         16  CERT-STATE           PIC XX      VALUE SPACES.
   703         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   704         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   705         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   706
   707     12  ELCERT2-KEY.
   708         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   709         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   710
   711     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   712
   713     12  ELCERT-SAVE.
   714         16  FILLER                      PIC XX    VALUE SPACES.
   715
   716         16  WCS-CONTROL-PRIMARY.
   717             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   718             20  WCS-CARRIER             PIC X     VALUE SPACE.
   719             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   720             20  WCS-STATE               PIC XX    VALUE SPACES.
   721             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   722             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   723             20  WCS-CERT-NO.
   724                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   725                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   726
   727         16  CS-CONTROL-BY-NAME.
   728             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   729             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   730             20  CS-INSURED-INITIALS.
   731                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   732                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   733
   734         16  CS-CONTROL-BY-SSN.
   735             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   736             20  CS-SOC-SEC-NO.
   737                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   738                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   739                 24  CS-SSN-LN3.
   740                     28 CS-INSURED-INITIALS-A2   PIC XX
   741                                     VALUE SPACES.
   742                     28 CS-PART-LAST-NAME-A2     PIC X
   743                                     VALUE SPACE.
   744
   745         16  CS-CONTROL-BY-CERT-NO.
   746             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   747             20  CS-CERT-NO-A4           PIC X(11)
   748                                     VALUE SPACES.
   749
   750         16  CS-CONTROL-BY-MEMB.
   751             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  15
* EL050.cbl
   752             20  CS-MEMBER-NO.
   753                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   754                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   755                 24  CS-MEMB-LN4.
   756                     28 CS-INSURED-INITIALS-A5   PIC XX
   757                                      VALUE SPACES.
   758                     28 CS-PART-LAST-NAME-A5     PIC XX
   759                                      VALUE SPACES.
   760
   761         16  FILLER              PIC X(360) VALUE SPACES.
   762
   763     12  ERACCT-KEY.
   764         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   765         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   766         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   767         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   768         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   769         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   770
   771     12  ERCOMP-KEY.
   772         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   773         16  COMP-CARRIER         PIC X     VALUE SPACES.
   774         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   775         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   776         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   777         16  COMP-TYPE            PIC X     VALUE SPACES.
   778
   779     12  ERLOFC-KEY.
   780         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   782         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   783         16  LOFC-STATE           PIC XX    VALUE SPACES.
   784         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   785         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   786
   787     12  WS-ELCRTT-KEY.
   788         16  WS-ELCRTT-PRIMARY       PIC X(33).
   789         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   790
   791     12  ERBXRF-KEY.
   792         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   793         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   794         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   795         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   796
   797     12  ERAGTC-KEY.
   798         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   799         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   800         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   801         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   802         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   803         16  AGTC-TYPE            PIC X     VALUE SPACES.
   804
   805     12  ERPLAN-KEY.
   806         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   807         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   808         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   809         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  16
* EL050.cbl
   810         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   811         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   812         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   813         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   814
   815     12  ERFORM-KEY.
   816         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   817         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   818         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   819         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   820
   821     12  ERREIN-KEY.
   822         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   823         16  REIN-TYPE            PIC X     VALUE SPACES.
   824         16  REIN-TABLE-CO.
   825             20  REIN-CODE-1      PIC X     VALUE SPACE.
   826             20  REIN-CODE-2      PIC X     VALUE SPACE.
   827             20  REIN-CODE-3      PIC X     VALUE SPACE.
   828         16  FILLER               PIC X(3)  VALUE SPACES.
   829
   830     12  ERCTBL-KEY.
   831         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   832         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   833         16  CTBL-CNTRL-2.
   834             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   835             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   836
   837     12  ELCRTO-KEY.
   838         16  ELCRTO-COMPANY-CD       PIC X.
   839         16  ELCRTO-CARRIER          PIC X.
   840         16  ELCRTO-GROUPING         PIC X(6).
   841         16  ELCRTO-STATE            PIC XX.
   842         16  ELCRTO-ACCOUNT          PIC X(10).
   843         16  ELCRTO-CERT-EFF-DT      PIC XX.
   844         16  ELCRTO-CERT-NO.
   845             20  ELCRTO-CERT-PRIME   PIC X(10).
   846             20  ELCRTO-CERT-SFX     PIC X.
   847         16  ELCRTO-RECORD-TYPE      PIC X.
   848         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   849
   850
   851     12  WS-ACCESS.
   852         16  FILLER               PIC XX    VALUE SPACES.
   853         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   854
   855     12  WS-CARR-ACCESS.
   856         16  FILLER               PIC X(3)  VALUE SPACES.
   857         16  WS-CARR              PIC X     VALUE SPACE.
   858*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   859*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   860     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   861         88  WS-DMD-LF-RATING   VALUE 'Y'.
   862         88  WS-DMD-AH-RATING   VALUE 'Y'.
   863         88  WS-DMD-NO-RATING   VALUE 'N'.
   864
   865     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   866         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   867                                         'NJ' 'NL'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  17
* EL050.cbl
   868                                         'PJ' 'PL'
   869                                         'SJ' 'SL'.
   870     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   871         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   872                                         'NI' 'NJ' 'NL' 'NU'
   873                                         'PJ' 'PL' 'PI' 'PU'
   874                                         'SI' 'SJ' 'SL' 'SU'
   875                                         'MX' 'MY' 'MZ'.
   876 01  ERPDEF-KEY-SAVE             PIC X(18).
   877 01  ERPDEF-KEY.
   878     12  ERPDEF-COMPANY-CD       PIC X.
   879     12  ERPDEF-STATE            PIC XX.
   880     12  ERPDEF-PROD-CD          PIC XXX.
   881     12  F                       PIC X(7).
   882     12  ERPDEF-BEN-TYPE         PIC X.
   883     12  ERPDEF-BEN-CODE         PIC XX.
   884     12  ERPDEF-EXP-DT           PIC XX.
   885
   886 01  ELSTAT-KEY-SAVE             PIC X(20).
   887 01  ELSTAT-KEY.
   888     12  ELSTAT-COMPANY-ID       PIC XXX.
   889     12  ELSTAT-CARRIER          PIC X.
   890     12  ELSTAT-GROUP            PIC X(6).
   891     12  ELSTAT-STATE            PIC XX.
   892     12  ELSTAT-EXP-DT           PIC 9(8).
   893 01  WS-ERROR-VALUES.
   894     12  ER-1570                     PIC S9(4)   VALUE +1570.
   895     12  ER-1571                     PIC S9(4)   VALUE +1571.
   896     12  er-1572                     pic s9(4)   value +1572.
   897     12  er-1573                     pic s9(4)   value +1573.
   898     12  er-1574                     pic s9(4)   value +1574.
   899     12  ER-1575                     PIC S9(4)   VALUE +1575.
   900     12  er-1576                     pic s9(4)   value +1576.
   901     12  ER-1891                     PIC S9(4)   VALUE +1891.
   902     12  ER-1892                     PIC S9(4)   VALUE +1892.
   903     12  ER-1893                     PIC S9(4)   VALUE +1893.
   904     12  ER-1894                     PIC S9(4)   VALUE +1894.
   905     12  ER-1895                     PIC S9(4)   VALUE +1895.
   906     12  ER-1896                     PIC S9(4)   VALUE +1896.
   907     12  ER-1897                     PIC S9(4)   VALUE +1897.
   908     12  ER-1898                     PIC S9(4)   VALUE +1898.
   909     12  ER-1899                     PIC S9(4)   VALUE +1899.
   910     12  ER-1900                     PIC S9(4)   VALUE +1900.
   911     12  ER-1901                     PIC S9(4)   VALUE +1901.
   912     12  ER-1902                     PIC S9(4)   VALUE +1902.
   913     12  ER-1903                     PIC S9(4)   VALUE +1903.
   914     12  ER-1904                     PIC S9(4)   VALUE +1904.
   915     12  ER-1905                     PIC S9(4)   VALUE +1905.
   916     12  ER-1906                     PIC S9(4)   VALUE +1906.
   917     12  ER-1907                     PIC S9(4)   VALUE +1907.
   918     12  ER-1909                     PIC S9(4)   VALUE +1909.
   919     12  ER-1910                     PIC S9(4)   VALUE +1910.
   920     12  ER-1911                     PIC S9(4)   VALUE +1911.
   921     12  ER-1912                     PIC S9(4)   VALUE +1912.
   922     12  ER-1913                     PIC S9(4)   VALUE +1913.
   923     12  ER-1914                     PIC S9(4)   VALUE +1914.
   924     12  ER-1915                     PIC S9(4)   VALUE +1915.
   925     12  ER-1916                     PIC S9(4)   VALUE +1916.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  18
* EL050.cbl
   926     12  ER-1917                     PIC S9(4)   VALUE +1917.
   927     12  ER-1918                     PIC S9(4)   VALUE +1918.
   928     12  ER-1919                     PIC S9(4)   VALUE +1919.
   929     12  ER-1920                     PIC S9(4)   VALUE +1920.
   930     12  ER-1921                     PIC S9(4)   VALUE +1921.
   931     12  ER-1922                     PIC S9(4)   VALUE +1922.
   932     12  ER-1923                     PIC S9(4)   VALUE +1923.
   933     12  ER-1924                     PIC S9(4)   VALUE +1924.
   934     12  ER-1925                     PIC S9(4)   VALUE +1925.
   935     12  ER-1926                     PIC S9(4)   VALUE +1926.
   936     12  ER-1927                     PIC S9(4)   VALUE +1927.
   937     12  ER-2393                     PIC S9(4)   VALUE +2393.
   938     12  ER-2600                     PIC S9(4)   VALUE +2600.
   939     12  ER-2601                     PIC S9(4)   VALUE +2601.
   940     12  ER-2602                     PIC S9(4)   VALUE +2602.
   941     12  ER-2603                     PIC S9(4)   VALUE +2603.
   942     12  ER-2604                     PIC S9(4)   VALUE +2604.
   943     12  ER-2605                     PIC S9(4)   VALUE +2605.
   944     12  ER-2606                     PIC S9(4)   VALUE +2606.
   945     12  ER-2607                     PIC S9(4)   VALUE +2607.
   946     12  ER-2608                     PIC S9(4)   VALUE +2608.
   947     12  ER-2609                     PIC S9(4)   VALUE +2609.
   948     12  ER-2610                     PIC S9(4)   VALUE +2610.
   949     12  ER-2611                     PIC S9(4)   VALUE +2611.
   950     12  ER-2612                     PIC S9(4)   VALUE +2612.
   951     12  ER-2613                     PIC S9(4)   VALUE +2613.
   952     12  ER-2614                     PIC S9(4)   VALUE +2614.
   953     12  ER-2615                     PIC S9(4)   VALUE +2615.
   954     12  ER-2616                     PIC S9(4)   VALUE +2616.
   955     12  ER-2617                     PIC S9(4)   VALUE +2617.
   956     12  ER-2618                     PIC S9(4)   VALUE +2618.
   957     12  ER-2619                     PIC S9(4)   VALUE +2619.
   958     12  ER-2620                     PIC S9(4)   VALUE +2620.
   959     12  ER-2621                     PIC S9(4)   VALUE +2621.
   960     12  ER-2622                     PIC S9(4)   VALUE +2622.
   961     12  ER-2623                     PIC S9(4)   VALUE +2623.
   962     12  ER-2624                     PIC S9(4)   VALUE +2624.
   963     12  ER-2625                     PIC S9(4)   VALUE +2625.
   964     12  ER-2626                     PIC S9(4)   VALUE +2626.
   965     12  ER-2627                     PIC S9(4)   VALUE +2627.
   966     12  ER-2628                     PIC S9(4)   VALUE +2628.
   967     12  ER-2629                     PIC S9(4)   VALUE +2629.
   968     12  ER-2630                     PIC S9(4)   VALUE +2630.
   969     12  ER-2631                     PIC S9(4)   VALUE +2631.
   970     12  ER-2632                     PIC S9(4)   VALUE +2632.
   971     12  ER-2633                     PIC S9(4)   VALUE +2633.
   972     12  ER-2634                     PIC S9(4)   VALUE +2634.
   973     12  ER-2635                     PIC S9(4)   VALUE +2635.
   974     12  ER-2636                     PIC S9(4)   VALUE +2636.
   975     12  ER-2637                     PIC S9(4)   VALUE +2637.
   976     12  ER-2638                     PIC S9(4)   VALUE +2638.
   977     12  ER-2639                     PIC S9(4)   VALUE +2639.
   978     12  ER-2640                     PIC S9(4)   VALUE +2640.
   979     12  ER-2641                     PIC S9(4)   VALUE +2641.
   980     12  ER-2642                     PIC S9(4)   VALUE +2642.
   981     12  ER-2643                     PIC S9(4)   VALUE +2643.
   982     12  ER-2644                     PIC S9(4)   VALUE +2644.
   983     12  ER-2645                     PIC S9(4)   VALUE +2645.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  19
* EL050.cbl
   984     12  ER-2646                     PIC S9(4)   VALUE +2646.
   985     12  ER-2647                     PIC S9(4)   VALUE +2647.
   986     12  ER-2648                     PIC S9(4)   VALUE +2648.
   987     12  ER-2649                     PIC S9(4)   VALUE +2649.
   988     12  ER-2650                     PIC S9(4)   VALUE +2650.
   989     12  ER-2651                     PIC S9(4)   VALUE +2651.
   990     12  ER-2652                     PIC S9(4)   VALUE +2652.
   991     12  ER-2653                     PIC S9(4)   VALUE +2653.
   992     12  ER-2654                     PIC S9(4)   VALUE +2654.
   993     12  ER-2655                     PIC S9(4)   VALUE +2655.
   994     12  ER-2656                     PIC S9(4)   VALUE +2656.
   995     12  ER-2657                     PIC S9(4)   VALUE +2657.
   996     12  ER-2658                     PIC S9(4)   VALUE +2658.
   997     12  ER-2659                     PIC S9(4)   VALUE +2659.
   998     12  ER-2660                     PIC S9(4)   VALUE +2660.
   999     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1000     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1001     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1002     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1003     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1004     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1005     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1006     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1007     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1008     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1009     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1010     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1011     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1012     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1013     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1014     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1015     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1016     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1017     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1018     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1019     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1020     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1021     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1022     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1023     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1024     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1025     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1026     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1027     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1028     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1029     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1030     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1031     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1032     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1033     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1034     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1035     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1036     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1037     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1038     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1039     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1040     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1041     12  ER-2703                     PIC S9(4)   VALUE +2703.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  20
* EL050.cbl
  1042     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1043     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1044     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1045     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1046     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1047     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1048     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1049     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1050     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1051     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1052     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1053     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1054     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1055     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1056     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1057     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1058     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1059     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1060     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1061     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1062     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1063     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1064     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1065     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1066     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1067     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1068     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1069     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1070     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1071     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1072     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1073     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1074     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1075     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1076     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1077     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1078     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1079     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1080     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1081     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1082     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1083     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1084     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1085     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1086     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1087     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1088     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1089     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1090     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1091     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1092     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1093     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1094     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1095     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1096     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1097     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1098     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1099     12  ER-2771                     PIC S9(4)   VALUE +2771.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  21
* EL050.cbl
  1100     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1101     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1102     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1103     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1104     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1105     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1106     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1107     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1108     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1109     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1110     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1111     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1112     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1113     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1114     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1115     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1116     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1117     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1118     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1119     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1120     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1121     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1122     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1123     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1124     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1125     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1126     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1127     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1128     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1129     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1130     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1131     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1132     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1133     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1134     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1135     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1136     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1137     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1138     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1139     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1140     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1141     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1142     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1143     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1144     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1145     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1146     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1147     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1148     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1149     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1150     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1151     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1152     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1153     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1154     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1155     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1156     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1157     12  ER-3843                     PIC S9(4)   VALUE +3843.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  22
* EL050.cbl
  1158     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1159     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1160     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1161     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1162     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1163     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1164     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1165     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1166     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1167     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1168     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1169     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1170     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1171     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1172     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1173     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1174     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1175     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1176     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1177     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1178     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1179     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1180     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1181     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1182     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1183     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1184     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1185     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1186     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1187     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1188     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1189     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1190     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1191     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1192     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1193     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1194     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1195     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1196     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1197     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1198     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1199     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1200     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1201     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1202     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1203     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1204     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1205     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1206     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1207     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1208     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1209     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1210     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1211     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1212     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1213     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1214     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1215     12  ER-8109                     PIC S9(4)   VALUE +8109.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  23
* EL050.cbl
  1216     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1217     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1218     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1219     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1220     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1221     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1222     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1223     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1224     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1225     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1226     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1227     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1228     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1229     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1230     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1231     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1232     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1233     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1234     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1235     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1236     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1237     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1238     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1239     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1240     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1241     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1242******************************************************************
  1243***************   END OF ELC50WS     ****************************
  1244******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  24
* EL050.cbl
  1247 01  WORKING-STORAGE-WORK-AREAS.
  1248     12  WS-RESPONSE             PIC S9(8)  COMP.
  1249         88  WS-RESP-NORMAL           VALUE +00.
  1250         88  WS-RESP-ERROR            VALUE +01.
  1251         88  WS-RESP-NOTFND           VALUE +13.
  1252         88  WS-RESP-DUPREC           VALUE +14.
  1253         88  WS-RESP-ENDFILE          VALUE +20.
  1254     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1255     12  WORK-AREAS.
  1256         16  WK-CONV-GREG.
  1257             24  WCG-CENT             PIC XX.
  1258             24  WCG-REST             PIC X(4).
  1259         16  WORK-GREGORIAN-DATE.
  1260             24  WK-GREG-CENT         PIC XX.
  1261             24  WK-GREG-DATE-YYMMDD.
  1262                 28  WK-GREG-YYMM     PIC X(4).
  1263                 28  WK-GREG-DD       PIC XX.
  1264
  1265         16  WORK-SELECT-DATE.
  1266             24  WK-SELECT-CENT            PIC XX.
  1267             24  WK-SELECT-DATE-YYMMDD.
  1268                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1269                 28  FILLER                PIC XX.
  1270
  1271         16  WK-FORM-NO.
  1272             24  WK-FORM-BANK-ID       PIC X(5).
  1273             24  WK-FORM-UNDRWRTR      PIC X(1).
  1274             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1275
  1276         16  WK-MEMBER-NO.
  1277             24  WK-MEMBER-1-6        PIC X(6).
  1278             24  WK-MEMBER-7-12       PIC X(6).
  1279
  1280         16  WK-FULL-CERT-NO.
  1281             24  WK-CERT-POS-1-2      PIC X(2).
  1282             24  WK-CERT-POS-3        PIC X(1).
  1283             24  WK-CERT-POS-4        PIC X(1).
  1284             24  WK-CERT-POS-5-6      PIC X(2).
  1285             24  WK-CERT-POS-7        PIC X(1).
  1286             24  WK-CERT-POS-8-11     PIC X(4).
  1287
  1288         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1289             88  VALID-RATE-CODE        VALUE 'Y'.
  1290             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1291
  1292         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1293         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1294         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1295         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1296         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1297         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1298         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1299         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1300         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1301         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1302
  1303* DLO001
  1304 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  25
* EL050.cbl
  1305     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1306     12  DMPF-RETURN-CODE          PIC XX.
  1307         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1308         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1309         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1310         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1311         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1312         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1313
  1314* DLO002
  1315 01  WS-DLO-INTERNAL-POLICY-FORM.
  1316     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1317     12  DIPF-RETURN-CODE          PIC XX.
  1318         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1319         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1320         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1321         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1322         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1323         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1324
  1325* DLO003
  1326 01  WS-DLO-VALID-BANK-ID.
  1327     12  DVBI-BANK-ID              PIC X(5).
  1328     12  DVBI-BANK-ID-TYPE         PIC X.
  1329         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1330         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1331         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1332         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1333         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1334     12  DVBI-RETURN-CODE          PIC XX.
  1335         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1336         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1337         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1338         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1339         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1340         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1341         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1342         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1343         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1344
  1345* DLO007
  1346 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1347     12  DCUA-RES-STATE            PIC XX.
  1348     12  DCUA-BEN-TYPE             PIC XX.
  1349     12  DCUA-SYS-IDENT            PIC X.
  1350         88  DCUA-CLAIM                        VALUE 'C'.
  1351         88  DCUA-PREMIUM                      VALUE 'P'.
  1352     12  DCUA-COVERAGE-RULE        PIC X.
  1353     12  DCUA-CLIENT-ID            PIC X(10).
  1354     12  DCUA-EFF-DATE             PIC X(8).
  1355     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1356     12  DCUA-RETURN-CODE          PIC XX.
  1357         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1358     12  DCUA-CERT-NUMBER          PIC X(11).
  1359     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1360     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1361
  1362* DLO011
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  26
* EL050.cbl
  1363 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1364     12  DPRB-RATE-CODE            PIC X(4).
  1365     12  DPRB-COVERAGE-CATEG       PIC X.
  1366     12  DPRB-RETURN-CODE          PIC XX.
  1367         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1368         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1369         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1370         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1371         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1372         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1373         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1374         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1375         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1376     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1377     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1378     12  DPRB-BEN-TYPE             PIC XX.
  1379
  1380* DLO017
  1381 01  WS-DLO-VALID-RATE-CODE.
  1382     12  DVRC-RATE-CODE            PIC X(4).
  1383     12  DVRC-RETURN-CODE          PIC XX.
  1384         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1385         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1386         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1387         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1388         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1389         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1390
  1391* DLO019
  1392 01  WS-DLO-ORIG-COV-CAT.
  1393     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1394     12  DOCC-RETURN-CODE          PIC XX.
  1395     12  DOCC-ORIG-COV-CAT         PIC X.
  1396     12  DOCC-UNDERWITER           PIC XX.
  1397     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1398     12  DOCC-FILLER               PIC X(6).
  1399
  1400* DLO021
  1401 01  WS-DLO-VALID-LOAN-OFFICER.
  1402     12  DVLO-LOAN-OFFICER.
  1403         16  DVLO-BILL-TYPE        PIC X.
  1404         16  DVLO-BILL-SOURCE      PIC X.
  1405         16  DVLO-BATCH-TYPE       PIC X.
  1406     12  DVLO-RETURN-CODE          PIC XX.
  1407         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1408         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1409         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1410         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1411         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1412         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1413
  1414* DLO022
  1415 01  WS-DLO-VALID-STATE-CODE.
  1416     12  DVSC-STATE-CODE           PIC XX.
  1417     12  DVSC-RETURN-CODE          PIC XX.
  1418         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1419
  1420* DLO023
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  27
* EL050.cbl
  1421 01  WS-DLO-VALID-CODE-VALUES.
  1422     12  DVCV-SYSTEM-ID            PIC XX.
  1423         88  DVCV-CLAIMS                       VALUE 'CL'.
  1424         88  DVCV-CREDIT                       VALUE 'CR'.
  1425     12  DVCV-RECORD-TYPE          PIC XX.
  1426         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1427         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1428         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1429         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1430         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1431         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1432         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1433         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1434     12  DVCV-RECORD-KEY           PIC X(6).
  1435     12  DVCV-RETURN-CODE          PIC XX.
  1436         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1437         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1438         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1439         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1440         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1441         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1442         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1443     12  DVCV-CODE-DESC            PIC X(60).
  1444     12  DVCV-GEN-DESC-1           PIC X(20).
  1445     12  DVCV-GEN-DESC-2           PIC X(20).
  1446     12  DVCV-GEN-DESC-3           PIC X(20).
  1447
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  28
* EL050.cbl
  1449*    COPY ERCBXRF.
  1450******************************************************************
  1451*                                                                *
  1452*                                                                *
  1453*                            ERCBXRF                             *
  1454*                                                                *
  1455*   ONLINE CREDIT SYSTEM                                         *
  1456*                                                                *
  1457*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1458*                                                                *
  1459*   FILE TYPE = VSAM,KSDS                                        *
  1460*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1461*                                                                *
  1462*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1463*       ALTERNATE PATH = NONE                                    *
  1464*                                                                *
  1465*   LOG = NO                                                     *
  1466*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1467*                                                                *
  1468******************************************************************
  1469
  1470 01  BANK-CROSS-REFERENCE.
  1471     12  BK-RECORD-ID                PIC XX.
  1472         88  VALID-BK-ID             VALUE 'BK'.
  1473
  1474     12  BK-CONTROL-PRIMARY.
  1475         16  BK-COMPANY-CD           PIC X.
  1476         16  BK-CARRIER              PIC X.
  1477         16  BK-GROUPING             PIC X(6).
  1478         16  BK-BANK-NO              PIC X(10).
  1479
  1480     12  BK-MAINT-INFORMATION.
  1481         16  BK-LAST-MAINT-DT        PIC XX.
  1482         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1483         16  BK-LAST-MAINT-USER      PIC X(4).
  1484         16  FILLER                  PIC X(9).
  1485
  1486     12  FILLER                      PIC X(37).
  1487
  1488     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1489
  1490     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1491                            DEPENDING ON BK-BANK-POINTER-CNT.
  1492         16  BK-AM-ACCOUNT           PIC X(10).
  1493         16  BK-AM-EXP-DT            PIC XX.
  1494         16  BK-AM-EFF-DT            PIC XX.
  1495         16  BK-AM-STATE             PIC XX.
  1496         16  FILLER                  PIC X(20).
  1497
  1498******************************************************************
  1499
  1500*    COPY ERCCOMP.
  1501******************************************************************
  1502*                                                                *
  1503*                                                                *
  1504*                            ERCCOMP                             *
  1505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1506*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  29
* EL050.cbl
  1507*                                                                *
  1508*   ONLINE CREDIT SYSTEM                                         *
  1509*                                                                *
  1510*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1511*                                                                *
  1512*   FILE TYPE = VSAM,KSDS                                        *
  1513*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1514*                                                                *
  1515*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1516*       ALTERNATE PATH = NONE                                    *
  1517*                                                                *
  1518*   LOG = NO                                                     *
  1519*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1520*                                                                *
  1521******************************************************************
  1522*                   C H A N G E   L O G
  1523*
  1524* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1525*-----------------------------------------------------------------
  1526*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1527* EFFECTIVE    NUMBER
  1528*-----------------------------------------------------------------
  1529* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1530* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1531* 092205    2005050300006  PEMA  ADD LEASE FEE
  1532* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1533* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1534* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1535* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1536* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1537* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1538******************************************************************
  1539
  1540 01  COMPENSATION-MASTER.
  1541     12  CO-RECORD-ID                          PIC XX.
  1542         88  VALID-CO-ID                          VALUE 'CO'.
  1543
  1544     12  CO-CONTROL-PRIMARY.
  1545         16  CO-COMPANY-CD                     PIC X.
  1546         16  CO-CONTROL.
  1547             20  CO-CTL-1.
  1548                 24  CO-CARR-GROUP.
  1549                     28  CO-CARRIER            PIC X.
  1550                     28  CO-GROUPING.
  1551                         32  CO-GROUP-PREFIX   PIC XXX.
  1552                         32  CO-GROUP-PRIME    PIC XXX.
  1553                 24  CO-RESP-NO.
  1554                     28  CO-RESP-PREFIX        PIC X(4).
  1555                     28  CO-RESP-PRIME         PIC X(6).
  1556             20  CO-CTL-2.
  1557                 24  CO-ACCOUNT.
  1558                     28  CO-ACCT-PREFIX        PIC X(4).
  1559                     28  CO-ACCT-PRIME         PIC X(6).
  1560         16  CO-TYPE                           PIC X.
  1561             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1562             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1563             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1564
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  30
* EL050.cbl
  1565     12  CO-MAINT-INFORMATION.
  1566         16  CO-LAST-MAINT-DT                  PIC XX.
  1567         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1568         16  CO-LAST-MAINT-USER                PIC X(4).
  1569     12  FILLER                                PIC XX.
  1570     12  CO-STMT-TYPE                          PIC XXX.
  1571     12  CO-COMP-TYPE                          PIC X.
  1572         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1573     12  CO-STMT-OWNER                         PIC X(4).
  1574     12  CO-BALANCE-CONTROL                    PIC X.
  1575         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1576         88  CO-NO-BALANCE                        VALUE 'N'.
  1577
  1578     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1579         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1580         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1581         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1582
  1583     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1584         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1585         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1586
  1587     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1588     12  CO-GA-DIRECT-DEP                      PIC X.
  1589     12  CO-FUTURE-SPACE                       PIC X.
  1590         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1591
  1592     12  CO-ACCT-NAME                          PIC X(30).
  1593     12  CO-MAIL-NAME                          PIC X(30).
  1594     12  CO-ADDR-1                             PIC X(30).
  1595     12  CO-ADDR-2                             PIC X(30).
  1596     12  CO-ADDR-3.
  1597         16  CO-ADDR-CITY                      PIC X(27).
  1598         16  CO-ADDR-STATE                     PIC XX.
  1599     12  CO-CSO-1099                           PIC X.
  1600     12  CO-ZIP.
  1601         16  CO-ZIP-PRIME.
  1602             20  CO-ZIP-PRI-1ST                PIC X.
  1603                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1604             20  FILLER                        PIC X(4).
  1605         16  CO-ZIP-PLUS4                      PIC X(4).
  1606     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1607         16  CO-CAN-POSTAL-1                   PIC XXX.
  1608         16  CO-CAN-POSTAL-2                   PIC XXX.
  1609         16  FILLER                            PIC XXX.
  1610     12  CO-SOC-SEC                            PIC X(13).
  1611     12  CO-TELEPHONE.
  1612         16  CO-AREA-CODE                      PIC XXX.
  1613         16  CO-PREFIX                         PIC XXX.
  1614         16  CO-PHONE                          PIC X(4).
  1615
  1616     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1617
  1618     12  CO-AR-BAL-LEVEL                       PIC X.
  1619         88  CO-AR-REF-LVL                        VALUE '1'.
  1620         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1621         88  CO-AR-BILL-LVL                       VALUE '2'.
  1622         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  31
* EL050.cbl
  1623         88  CO-AR-FR-LVL                         VALUE '4'.
  1624
  1625     12  CO-AR-NORMAL-PRINT                    PIC X.
  1626         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1627         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1628
  1629     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1630
  1631     12  CO-AR-REPORTING                       PIC X.
  1632         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1633         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1634
  1635     12  CO-AR-PULL-CHECK                      PIC X.
  1636         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1637         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1638
  1639     12  CO-AR-BALANCE-PRINT                   PIC X.
  1640         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1641
  1642     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1643         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1644         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1645         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1646
  1647     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1648
  1649     12  CO-USER-CODE                          PIC X.
  1650     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1651
  1652******************************************************************
  1653*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1654*    THE LAST MONTH END RUN.
  1655******************************************************************
  1656
  1657     12  CO-LAST-ACTIVITY-DATE.
  1658         16  CO-ACT-YEAR                       PIC 99.
  1659         16  CO-ACT-MONTH                      PIC 99.
  1660         16  CO-ACT-DAY                        PIC 99.
  1661
  1662     12  CO-LAST-STMT-DT.
  1663         16  CO-LAST-STMT-YEAR                 PIC 99.
  1664         16  CO-LAST-STMT-MONTH                PIC 99.
  1665         16  CO-LAST-STMT-DAY                  PIC 99.
  1666
  1667     12  CO-MO-END-TOTALS.
  1668         16  CO-MONTHLY-TOTALS.
  1669             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1670             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1671             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1672             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1673             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1674
  1675         16  CO-AGING-TOTALS.
  1676             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1677             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1678             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1679             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1680
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  32
* EL050.cbl
  1681         16  CO-YTD-TOTALS.
  1682             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1683             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1684
  1685         16  CO-OVER-UNDER-TOTALS.
  1686             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1687             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1688
  1689     12  CO-MISCELLANEOUS-TOTALS.
  1690         16  CO-FICA-TOTALS.
  1691             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1692             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1693
  1694         16  CO-CLAIM-TOTALS.
  1695             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1696             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1697
  1698******************************************************************
  1699*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1700*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1701******************************************************************
  1702
  1703     12  CO-CURRENT-TOTALS.
  1704         16  CO-CURRENT-LAST-STMT-DT.
  1705             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1706             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1707             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1708
  1709         16  CO-CURRENT-MONTHLY-TOTALS.
  1710             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1711             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1712             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1713             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1714             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1715
  1716         16  CO-CURRENT-AGING-TOTALS.
  1717             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1718             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1719             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1720             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1721
  1722         16  CO-CURRENT-YTD-TOTALS.
  1723             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1724             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1725
  1726     12  CO-PAID-COMM-TOTALS.
  1727         16  CO-YTD-PAID-COMMS.
  1728             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1729             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1730
  1731     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1732         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1733         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1734
  1735     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1736         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1737         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1738         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  33
* EL050.cbl
  1739         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1740         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1741         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1742         88  CO-FINAL-LETTER                  VALUE 'F'.
  1743         88  CO-RECONCILING                   VALUE 'R'.
  1744         88  CO-PHONE-CALL                    VALUE 'P'.
  1745         88  CO-LEGAL                         VALUE 'L'.
  1746         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1747         88  CO-WRITE-OFF                     VALUE 'W'.
  1748         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1749
  1750     12  CO-CSR-CODE                       PIC X(4).
  1751
  1752     12  CO-GA-STATUS-INFO.
  1753         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1754         16  CO-GA-TERMINATION-DT          PIC XX.
  1755         16  CO-GA-STATUS-CODE             PIC X.
  1756             88  CO-GA-ACTIVE                 VALUE 'A'.
  1757             88  CO-GA-INACTIVE               VALUE 'I'.
  1758             88  CO-GA-PENDING                VALUE 'P'.
  1759         16  CO-GA-COMMENTS.
  1760             20  CO-GA-COMMENT-1           PIC X(40).
  1761             20  CO-GA-COMMENT-2           PIC X(40).
  1762             20  CO-GA-COMMENT-3           PIC X(40).
  1763             20  CO-GA-COMMENT-4           PIC X(40).
  1764
  1765     12  CO-RPTCD2                         PIC X(10).
  1766     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1767         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1768         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1769
  1770     12  CO-TYPE-AGENT                     PIC X(01).
  1771         88  CO-CORPORATION                   VALUE 'C'.
  1772         88  CO-PARTNERSHIP                   VALUE 'P'.
  1773         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1774         88  CO-TRUST                         VALUE 'T'.
  1775         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1776
  1777     12  CO-FAXNO.
  1778         16  CO-FAX-AREA-CODE                  PIC XXX.
  1779         16  CO-FAX-PREFIX                     PIC XXX.
  1780         16  CO-FAX-PHONE                      PIC X(4).
  1781
  1782     12  CO-BANK-INFORMATION.
  1783         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1784         16  CO-BANK-TRANSIT-NON REDEFINES
  1785             CO-BANK-TRANSIT-NO                PIC 9(8).
  1786
  1787         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1788     12  CO-MISC-DEDUCT-INFO REDEFINES
  1789                  CO-BANK-INFORMATION.
  1790         16  CO-MD-GL-ACCT                     PIC X(10).
  1791         16  CO-MD-DIV                         PIC XX.
  1792         16  CO-MD-CENTER                      PIC X(4).
  1793         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1794         16  CO-CREATE-AP-CHECK                PIC X.
  1795         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1796         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  34
* EL050.cbl
  1797     12  CO-ACH-STATUS                         PIC X.
  1798         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1799         88  CO-ACH-PENDING                        VALUE 'P'.
  1800
  1801     12  CO-BILL-SW                            PIC X.
  1802     12  CO-CONTROL-NAME                       PIC X(30).
  1803     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1804     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1805     12  CO-CLP-STATE                          PIC XX.
  1806     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1807     12  CO-SPP-REFUND-EDIT                    PIC X.
  1808
  1809******************************************************************
  1810
  1811*    COPY ERCAGTC.
  1812******************************************************************
  1813*                                                                *
  1814*                                                                *
  1815*                            ERCAGTC                             *
  1816*                            VMOD=2.001                          *
  1817*                                                                *
  1818*   ONLINE CREDIT SYSTEM                                         *
  1819*                                                                *
  1820*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1821*                                                                *
  1822*   FILE TYPE = VSAM,KSDS                                        *
  1823*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1824*                                                                *
  1825*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1826*       ALTERNATE PATH = NONE                                    *
  1827*                                                                *
  1828*   LOG = NO                                                     *
  1829*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1830*                                                                *
  1831******************************************************************
  1832*                   C H A N G E   L O G
  1833*
  1834* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1835*-----------------------------------------------------------------
  1836*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1837* EFFECTIVE    NUMBER
  1838*-----------------------------------------------------------------
  1839* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1840* 111004                         NEW FILE AND COPYBOOK
  1841* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1842******************************************************************
  1843 01  AGENT-COMMISSIONS.
  1844     12  AG-RECORD-ID                          PIC XX.
  1845         88  VALID-CO-ID                          VALUE 'AG'.
  1846     12  AG-CONTROL-PRIMARY.
  1847         16  AG-COMPANY-CD                     PIC X.
  1848         16  AG-CONTROL.
  1849             20  AG-CTL-1.
  1850                 24  AG-CARR-GROUP.
  1851                     28  AG-CARRIER            PIC X.
  1852                     28  AG-GROUPING           PIC X(6).
  1853                 24  AG-BANK                   PIC X(10).
  1854             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  35
* EL050.cbl
  1855                 24  AG-EXP-DT                 PIC XX.
  1856         16  AG-TYPE                           PIC X.
  1857             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1858             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1859     12  AG-MAINT-INFORMATION.
  1860         16  AG-LAST-MAINT-DT                  PIC XX.
  1861         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1862         16  AG-LAST-MAINT-USER                PIC X(4).
  1863         16  FILLER                            PIC X(10).
  1864     12  AG-EFF-DT                             PIC XX.
  1865     12  AG-COMM-STRUCTURE.
  1866         16  AG-AGT-COMMS OCCURS 10.
  1867             20  AG-AGT                PIC X(10).
  1868             20  AG-COM-TYP            PIC X.
  1869             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1870             20  AG-RECALC-LV-INDIC    PIC X.
  1871             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1872             20  AG-LRCALC-LV-INDIC    PIC X.
  1873             20  FILLER                PIC X(05).
  1874     12  FILLER                  PIC X(145).
  1875******************************************************************
  1876*    COPY ERCRESS.
  1877******************************************************************
  1878*                                                                *
  1879*                            ERCRESS                             *
  1880*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1881*                            VMOD=2.002                          *
  1882*                                                                *
  1883*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1884*                                                                *
  1885*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1886*   VSAM RESIDENT STATE TAX MASTER                              *
  1887*                                                                *
  1888*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1889*                                                                *
  1890*   FILE TYPE = VSAM,KSDS                                        *
  1891*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1892*                                                                *
  1893*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1894*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1895*                                                                *
  1896*   LOG = NO                                                     *
  1897*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1898*                                                                *
  1899*                                                                *
  1900******************************************************************
  1901
  1902 01  RESIDENT-STATE-TAX-MASTER.
  1903
  1904     10  ERRESS-PRIMARY-KEY.
  1905         15  RES-COMPANY-CD        PIC X.
  1906         15  RES-RESIDENT-STATE    PIC XX.
  1907         15  RES-COVERAGE-CATEGORY PIC X.
  1908         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1909*                                      YYYYMMDD
  1910*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1911
  1912     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  36
* EL050.cbl
  1913
  1914         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1915         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1916         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1917         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1918
  1919     10 RES-RECALC-SW              PIC   X.
  1920         88 RECALC                VALUE 'Y'.
  1921         88 NO-RECALC             VALUE 'N'.
  1922     10  RES-MAINT-BY              PIC X(4).
  1923     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1924     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1925*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  37
* EL050.cbl
  1927*    COPY ERCRESC.
  1928******************************************************************
  1929*                                                                *
  1930*                            ERCRESC                             *
  1931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1932*                            VMOD=2.003                          *
  1933*                                                                *
  1934*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1935*                                                                *
  1936*   FILE TYPE = VSAM,KSDS                                        *
  1937*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1938*                                                                *
  1939*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1940*       ALTERNATE PATH1 = NONE                                   *
  1941*                                                                *
  1942*   LOG = NO                                                     *
  1943*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1944*                                                                *
  1945******************************************************************
  1946
  1947 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1948
  1949     10  ERRESC-RECORD-KEY.
  1950         15  RESC-COMPANY-CD           PIC   X.
  1951         15  RESC-CARRIER              PIC   X.
  1952         15  RESC-GROUP                PIC   X(6).
  1953         15  RESC-STATE                PIC   XX.
  1954         15  RESC-ACCOUNT              PIC   X(10).
  1955         15  RESC-AGENT                PIC   X(10).
  1956         15  RESC-RESIDENT-STATE       PIC   XX.
  1957         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1958*                                           YYYYMMDD
  1959     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1960
  1961     10  RESC-COMM-RECORD-DATA.
  1962         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1963             20 RESC-COVERAGE-CAT      PIC    X.
  1964             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1965             20 RESC-COMMISSION-TAB REDEFINES
  1966                RESC-COMMISSION-PER    PIC  XXX.
  1967
  1968     10  RESC-MAINT-BY                 PIC X(4).
  1969     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1970     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1971*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  38
* EL050.cbl
  1973*    COPY ERCPLAN.
  1974******************************************************************
  1975*                                                                *
  1976*                                                                *
  1977*                            ERCPLAN                             *
  1978*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1979*                            VMOD=2.003                          *
  1980*                                                                *
  1981*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1982*                                                                *
  1983*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1984*   PLAN MASTER                                                  *
  1985*                                                                *
  1986*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1987*                                                                *
  1988*   FILE TYPE = VSAM,KSDS                                        *
  1989*   RECORD SIZE = 420   RECFORM = FIX                            *
  1990*                                                                *
  1991*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1992*       ALTERNATE PATH1 = N/A                                    *
  1993*                                                                *
  1994*   LOG = NO                                                     *
  1995*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1996*                                                                *
  1997*                                                                *
  1998******************************************************************
  1999
  2000 01  PLAN-MASTER.
  2001     12  PL-RECORD-ID                      PIC XX.
  2002         88  VALID-PL-ID                      VALUE 'PL'.
  2003
  2004     12  PL-CONTROL-PRIMARY.
  2005         16  PL-COMPANY-CD                 PIC X.
  2006         16  PL-MSTR-CNTRL.
  2007             20  PL-CONTROL-A.
  2008                 24  PL-CARRIER            PIC X.
  2009                 24  PL-GROUPING           PIC X(6).
  2010                 24  PL-STATE              PIC XX.
  2011                 24  PL-ACCOUNT            PIC X(10).
  2012             20  PL-BENEFIT-TYPE           PIC X.
  2013             20  PL-BENEFIT-CODE           PIC XX.
  2014             20  PL-REVISION-NO            PIC X(3).
  2015
  2016     12  PL-CONTROL-BY-VAR-GRP.
  2017         16  PL-COMPANY-CD-A1              PIC X.
  2018         16  PL-VG-CARRIER                 PIC X.
  2019         16  PL-VG-GROUPING                PIC X(6).
  2020         16  PL-VG-STATE                   PIC XX.
  2021         16  PL-VG-ACCOUNT                 PIC X(10).
  2022         16  PL-BENEFIT-TYPE-A1            PIC X.
  2023         16  PL-BENEFIT-CODE-A1            PIC XX.
  2024         16  PL-REVISION-NO-A1             PIC 999.
  2025
  2026     12  PL-MAINT-INFORMATION.
  2027         16  PL-LAST-MAINT-DT              PIC XX.
  2028         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2029         16  PL-LAST-MAINT-USER            PIC X(4).
  2030         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  39
* EL050.cbl
  2031
  2032     12  PL-LIABILITY-LIMITS.
  2033         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2034         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2035             20  PL-LM-AGE                 PIC S99        COMP-3.
  2036             20  PL-LM-DUR                 PIC S999       COMP-3.
  2037             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2038             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2039
  2040     12  FILLER                            PIC X(30).
  2041
  2042     12  PL-GL-ACCOUNT-NOS.
  2043         16  PL-PREMIUM-GL                 PIC X(8).
  2044         16  PL-COMM-GL                    PIC X(8).
  2045         16  PL-CLAIM-GL                   PIC X(8).
  2046     12  FILLER                            PIC X(24).
  2047     12  PL-TOLERANCES.
  2048         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2049         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2050         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2051         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2052         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2053         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2054     12  PL-OVER-SHORT.
  2055         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2056         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2057     12  FILLER                            PIC X(24).
  2058     12  PLAN-MISC.
  2059         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2060         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2061         16  PL-IG                         PIC X.
  2062         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2063         16  PL-POLICY-FORM                PIC X(12).
  2064         16  PL-EDIT-FOR-FORM              PIC X(01).
  2065         16  PL-DEV-CODE                   PIC XXX.
  2066         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2067         16  PL-CALC-METHOD                PIC X.
  2068         16  PL-BENEFIT-GROUP              PIC X(05).
  2069         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2070
  2071         16  FILLER                        PIC X(99).
  2072******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  40
* EL050.cbl
  2074*    COPY ELCCERT.
  2075******************************************************************
  2076*                                                                *
  2077*                            ELCCERT.                            *
  2078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2079*                            VMOD=2.013                          *
  2080*                                                                *
  2081*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2082*                                                                *
  2083*   FILE TYPE = VSAM,KSDS                                        *
  2084*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2085*                                                                *
  2086*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2087*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2088*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2089*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2090*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2091*                                                                *
  2092*   LOG = YES                                                    *
  2093*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2094******************************************************************
  2095*                   C H A N G E   L O G
  2096*
  2097* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2098*-----------------------------------------------------------------
  2099*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2100* EFFECTIVE    NUMBER
  2101*-----------------------------------------------------------------
  2102* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2103* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2104* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2105* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2106* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2107* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2109* 032612  CR2011110200001  PEMA  AHL CHANGES
  2110******************************************************************
  2111
  2112 01  CERTIFICATE-MASTER.
  2113     12  CM-RECORD-ID                      PIC XX.
  2114         88  VALID-CM-ID                      VALUE 'CM'.
  2115
  2116     12  CM-CONTROL-PRIMARY.
  2117         16  CM-COMPANY-CD                 PIC X.
  2118         16  CM-CARRIER                    PIC X.
  2119         16  CM-GROUPING.
  2120             20  CM-GROUPING-PREFIX        PIC X(3).
  2121             20  CM-GROUPING-PRIME         PIC X(3).
  2122         16  CM-STATE                      PIC XX.
  2123         16  CM-ACCOUNT.
  2124             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2125             20  CM-ACCOUNT-PRIME          PIC X(6).
  2126         16  CM-CERT-EFF-DT                PIC XX.
  2127         16  CM-CERT-NO.
  2128             20  CM-CERT-PRIME             PIC X(10).
  2129             20  CM-CERT-SFX               PIC X.
  2130
  2131     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  41
* EL050.cbl
  2132         16  CM-COMPANY-CD-A1              PIC X.
  2133         16  CM-INSURED-LAST-NAME          PIC X(15).
  2134         16  CM-INSURED-INITIALS.
  2135             20  CM-INSURED-INITIAL1       PIC X.
  2136             20  CM-INSURED-INITIAL2       PIC X.
  2137
  2138     12  CM-CONTROL-BY-SSN.
  2139         16  CM-COMPANY-CD-A2              PIC X.
  2140         16  CM-SOC-SEC-NO.
  2141             20  CM-SSN-STATE              PIC XX.
  2142             20  CM-SSN-ACCOUNT            PIC X(6).
  2143             20  CM-SSN-LN3.
  2144                 25  CM-INSURED-INITIALS-A2.
  2145                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2146                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2147                 25 CM-PART-LAST-NAME-A2         PIC X.
  2148
  2149     12  CM-CONTROL-BY-CERT-NO.
  2150         16  CM-COMPANY-CD-A4              PIC X.
  2151         16  CM-CERT-NO-A4                 PIC X(11).
  2152
  2153     12  CM-CONTROL-BY-MEMB.
  2154         16  CM-COMPANY-CD-A5              PIC X.
  2155         16  CM-MEMBER-NO.
  2156             20  CM-MEMB-STATE             PIC XX.
  2157             20  CM-MEMB-ACCOUNT           PIC X(6).
  2158             20  CM-MEMB-LN4.
  2159                 25  CM-INSURED-INITIALS-A5.
  2160                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2161                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2162                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2163
  2164     12  CM-INSURED-PROFILE-DATA.
  2165         16  CM-INSURED-FIRST-NAME.
  2166             20  CM-INSURED-1ST-INIT       PIC X.
  2167             20  FILLER                    PIC X(9).
  2168         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2169         16  CM-INSURED-SEX                PIC X.
  2170             88  CM-SEX-MALE                  VALUE 'M'.
  2171             88  CM-SEX-FEMAL                 VALUE 'F'.
  2172         16  CM-INSURED-JOINT-AGE          PIC 99.
  2173         16  CM-JOINT-INSURED-NAME.
  2174             20  CM-JT-LAST-NAME           PIC X(15).
  2175             20  CM-JT-FIRST-NAME.
  2176                 24  CM-JT-1ST-INIT        PIC X.
  2177                 24  FILLER                PIC X(9).
  2178             20  CM-JT-INITIAL             PIC X.
  2179
  2180     12  CM-LIFE-DATA.
  2181         16  CM-LF-BENEFIT-CD              PIC XX.
  2182         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2183         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2184         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2185         16  CM-LF-DEV-CODE                PIC XXX.
  2186         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2187         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2188         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2189         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  42
* EL050.cbl
  2190         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2191         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2192         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2193         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2194         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2195         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2196         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2197         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2198         16  cm-temp-epiq                  pic xx.
  2199             88  EPIQ-CLASS                  value 'EQ'.
  2200*        16  FILLER                        PIC XX.
  2201
  2202     12  CM-AH-DATA.
  2203         16  CM-AH-BENEFIT-CD              PIC XX.
  2204         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2205         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2206         16  CM-AH-DEV-CODE                PIC XXX.
  2207         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2208         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2209         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2210         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2211         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2212         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2213         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2214         16  CM-AH-PAID-THRU-DT            PIC XX.
  2215             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2216         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2217         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2218         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2219         16  FILLER                        PIC X.
  2220
  2221     12  CM-LOAN-INFORMATION.
  2222         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2223         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2224                                           PIC S9(5)V99  COMP-3.
  2225         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2226         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2227         16  CM-PAY-FREQUENCY              PIC S99.
  2228         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2229         16  CM-RATE-CLASS                 PIC XX.
  2230         16  CM-BENEFICIARY                PIC X(25).
  2231         16  CM-POLICY-FORM-NO             PIC X(12).
  2232         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2233         16  CM-LAST-ADD-ON-DT             PIC XX.
  2234         16  CM-DEDUCTIBLE-AMOUNTS.
  2235             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2236             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2237         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2238             20  CM-RESIDENT-STATE         PIC XX.
  2239             20  CM-RATE-CODE              PIC X(4).
  2240             20  FILLER                    PIC XX.
  2241         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2242             20  CM-LOAN-OFFICER           PIC X(5).
  2243             20  FILLER                    PIC XXX.
  2244         16  CM-CSR-CODE                   PIC XXX.
  2245         16  CM-UNDERWRITING-CODE          PIC X.
  2246             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2247         16  CM-POST-CARD-IND              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  43
* EL050.cbl
  2248         16  CM-NH-INTERFACE-SW            PIC X.
  2249         16  CM-PREMIUM-TYPE               PIC X.
  2250             88  CM-SING-PRM                  VALUE '1'.
  2251             88  CM-O-B-COVERAGE              VALUE '2'.
  2252             88  CM-OPEN-END                  VALUE '3'.
  2253         16  CM-IND-GRP-TYPE               PIC X.
  2254             88  CM-INDIVIDUAL                VALUE 'I'.
  2255             88  CM-GROUP                     VALUE 'G'.
  2256         16  CM-SKIP-CODE                  PIC X.
  2257             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2258             88  SKIP-JULY                    VALUE '1'.
  2259             88  SKIP-AUGUST                  VALUE '2'.
  2260             88  SKIP-SEPTEMBER               VALUE '3'.
  2261             88  SKIP-JULY-AUG                VALUE '4'.
  2262             88  SKIP-AUG-SEPT                VALUE '5'.
  2263             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2264             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2265             88  SKIP-JUNE                    VALUE '8'.
  2266             88  SKIP-JUNE-JULY               VALUE '9'.
  2267             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2268             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2269         16  CM-PAYMENT-MODE               PIC X.
  2270             88  PAY-MONTHLY                  VALUE SPACE.
  2271             88  PAY-WEEKLY                   VALUE '1'.
  2272             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2273             88  PAY-BI-WEEKLY                VALUE '3'.
  2274             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2275         16  CM-LOAN-NUMBER                PIC X(8).
  2276         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2277         16  CM-OLD-LOF                    PIC XXX.
  2278*        16  CM-LOAN-OFFICER               PIC XXX.
  2279         16  CM-REIN-TABLE                 PIC XXX.
  2280         16  CM-SPECIAL-REIN-CODE          PIC X.
  2281         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2282         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2283         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2284
  2285     12  CM-STATUS-DATA.
  2286         16  CM-ENTRY-STATUS               PIC X.
  2287         16  CM-ENTRY-DT                   PIC XX.
  2288
  2289         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2290         16  CM-LF-CANCEL-DT               PIC XX.
  2291         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2292
  2293         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2294         16  CM-LF-DEATH-DT                PIC XX.
  2295         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2296
  2297         16  CM-LF-CURRENT-STATUS          PIC X.
  2298             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2299                                                'M' '4' '5' '9'.
  2300             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2301             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2302             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2303             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2304             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2305             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  44
* EL050.cbl
  2306             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2307             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2308             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2309             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2310             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2311             88  CM-LF-DECLINED               VALUE 'D'.
  2312             88  CM-LF-VOIDED                 VALUE 'V'.
  2313
  2314         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2315         16  CM-AH-CANCEL-DT               PIC XX.
  2316         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2317
  2318         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2319         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2320         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2321
  2322         16  CM-AH-CURRENT-STATUS          PIC X.
  2323             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2324                                                'M' '4' '5' '9'.
  2325             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2326             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2327             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2328             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2329             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2330             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2331             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2332             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2333             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2334             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2335             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2336             88  CM-AH-DECLINED               VALUE 'D'.
  2337             88  CM-AH-VOIDED                 VALUE 'V'.
  2338
  2339         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2340             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2341             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2342             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2343         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2344
  2345         16  CM-ENTRY-BATCH                PIC X(6).
  2346         16  CM-LF-EXIT-BATCH              PIC X(6).
  2347         16  CM-AH-EXIT-BATCH              PIC X(6).
  2348         16  CM-LAST-MONTH-END             PIC XX.
  2349
  2350     12  CM-NOTE-SW                        PIC X.
  2351         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2352         88  CERT-NOTES-PRESENT               VALUE '1'.
  2353         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2354         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2355         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2356         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2357         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2358         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2359     12  CM-COMP-EXCP-SW                   PIC X.
  2360         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2361         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2362     12  CM-INSURED-ADDRESS-SW             PIC X.
  2363         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  45
* EL050.cbl
  2364         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2365
  2366*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2367     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2368     12  FILLER                            PIC X.
  2369
  2370*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2371     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2372     12  FILLER                            PIC X.
  2373*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2374     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2375
  2376     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2377         88  CERT-ADDED-BATCH                 VALUE ' '.
  2378         88  CERT-ADDED-ONLINE                VALUE '1'.
  2379         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2380         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2381         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2382     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2383         88  CERT-AS-LOADED                   VALUE ' '.
  2384         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2385         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2386         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2387         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2388         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2389         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2390         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2391
  2392     12  CM-ACCOUNT-COMM-PCTS.
  2393         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2394         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2395
  2396     12  CM-USER-FIELD                     PIC X.
  2397     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2398     12  CM-CLP-STATE                      PIC XX.
  2399     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2400     12  CM-USER-RESERVED                  PIC XXX.
  2401     12  FILLER REDEFINES CM-USER-RESERVED.
  2402         16  CM-AH-CLASS-CD                PIC XX.
  2403         16  F                             PIC X.
  2404******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  46
* EL050.cbl
  2406*    COPY ERCMAIL.
  2407******************************************************************
  2408*                                                                *
  2409*                                                                *
  2410*                            ERCMAIL                             *
  2411*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2412*                            VMOD=2.003                          *
  2413*                                                                *
  2414*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2415*                                                                *
  2416*   FILE TYPE = VSAM,KSDS                                        *
  2417*   RECORD SIZE = 374   RECFORM = FIX                            *
  2418*                                                                *
  2419*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2420*   ALTERNATE PATH    = NOT USED                                 *
  2421*                                                                *
  2422*   LOG = YES                                                    *
  2423*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2424******************************************************************
  2425*                   C H A N G E   L O G
  2426*
  2427* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2428*-----------------------------------------------------------------
  2429*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2430* EFFECTIVE    NUMBER
  2431*-----------------------------------------------------------------
  2432* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2433* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2434* 111108                   PEMA  ADD CRED BENE ADDR2
  2435******************************************************************
  2436
  2437 01  MAILING-DATA.
  2438     12  MA-RECORD-ID                      PIC XX.
  2439         88  VALID-MA-ID                       VALUE 'MA'.
  2440
  2441     12  MA-CONTROL-PRIMARY.
  2442         16  MA-COMPANY-CD                 PIC X.
  2443         16  MA-CARRIER                    PIC X.
  2444         16  MA-GROUPING.
  2445             20  MA-GROUPING-PREFIX        PIC XXX.
  2446             20  MA-GROUPING-PRIME         PIC XXX.
  2447         16  MA-STATE                      PIC XX.
  2448         16  MA-ACCOUNT.
  2449             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2450             20  MA-ACCOUNT-PRIME          PIC X(6).
  2451         16  MA-CERT-EFF-DT                PIC XX.
  2452         16  MA-CERT-NO.
  2453             20  MA-CERT-PRIME             PIC X(10).
  2454             20  MA-CERT-SFX               PIC X.
  2455
  2456     12  FILLER                            PIC XX.
  2457
  2458     12  MA-ACCESS-CONTROL.
  2459         16  MA-SOURCE-SYSTEM              PIC XX.
  2460             88  MA-FROM-CREDIT                VALUE 'CR'.
  2461             88  MA-FROM-VSI                   VALUE 'VS'.
  2462             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2463             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  47
* EL050.cbl
  2464         16  MA-RECORD-ADD-DT              PIC XX.
  2465         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2466         16  MA-LAST-MAINT-DT              PIC XX.
  2467         16  MA-LAST-MAINT-BY              PIC XXXX.
  2468         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2469
  2470     12  MA-PROFILE-INFO.
  2471         16  MA-QUALIFY-CODE-1             PIC XX.
  2472         16  MA-QUALIFY-CODE-2             PIC XX.
  2473         16  MA-QUALIFY-CODE-3             PIC XX.
  2474         16  MA-QUALIFY-CODE-4             PIC XX.
  2475         16  MA-QUALIFY-CODE-5             PIC XX.
  2476
  2477         16  MA-INSURED-LAST-NAME          PIC X(15).
  2478         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2479         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2480         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2481         16  MA-INSURED-BIRTH-DT           PIC XX.
  2482         16  MA-INSURED-SEX                PIC X.
  2483             88  MA-SEX-MALE                   VALUE 'M'.
  2484             88  MA-SEX-FEMALE                 VALUE 'F'.
  2485         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2486
  2487         16  MA-ADDRESS-CORRECTED          PIC X.
  2488         16  MA-JOINT-BIRTH-DT             PIC XX.
  2489*        16  FILLER                        PIC X(12).
  2490
  2491         16  MA-ADDRESS-LINE-1             PIC X(30).
  2492         16  MA-ADDRESS-LINE-2             PIC X(30).
  2493         16  MA-CITY-STATE.
  2494             20  MA-CITY                   PIC X(28).
  2495             20  MA-ADDR-STATE             PIC XX.
  2496         16  MA-ZIP.
  2497             20  MA-ZIP-CODE.
  2498                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2499                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2500                 24  FILLER                PIC X(4).
  2501             20  MA-ZIP-PLUS4              PIC X(4).
  2502         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2503             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2504             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2505             20  FILLER                    PIC X(3).
  2506
  2507         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2508
  2509         16  FILLER                        PIC XXX.
  2510*        16  FILLER                        PIC X(10).
  2511
  2512     12  MA-CRED-BENE-INFO.
  2513         16  MA-CRED-BENE-NAME                 PIC X(25).
  2514         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2515         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2516         16  MA-CRED-BENE-CTYST.
  2517             20  MA-CRED-BENE-CITY             PIC X(28).
  2518             20  MA-CRED-BENE-STATE            PIC XX.
  2519         16  MA-CRED-BENE-ZIP.
  2520             20  MA-CB-ZIP-CODE.
  2521                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  48
* EL050.cbl
  2522                     88  MA-CB-CANADIAN-POST-CODE
  2523                                           VALUE 'A' THRU 'Z'.
  2524                 24  FILLER                    PIC X(4).
  2525             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2526         16  MA-CB-CANADIAN-POSTAL-CODE
  2527                            REDEFINES MA-CRED-BENE-ZIP.
  2528             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2529             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2530             20  FILLER                        PIC X(3).
  2531     12  MA-POST-CARD-MAIL-DATA.
  2532         16  MA-MAIL-DATA OCCURS 7.
  2533             20  MA-MAIL-TYPE              PIC X.
  2534                 88  MA-12MO-MAILING           VALUE '1'.
  2535                 88  MA-EXP-MAILING            VALUE '2'.
  2536             20  MA-MAIL-STATUS            PIC X.
  2537                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2538                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2539                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2540             20  MA-MAIL-DATE              PIC XX.
  2541     12  FILLER                            PIC XX.
  2542     12  FILLER                            PIC XX.
  2543*    12  FILLER                            PIC X(30).
  2544******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  49
* EL050.cbl
  2546*    COPY ERCPNDM.
  2547******************************************************************
  2548*                                                                *
  2549*                                                                *
  2550*                            ERCPNDM                             *
  2551*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2552*                            VMOD=2.003                          *
  2553*                                                                *
  2554*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2555*                                                                *
  2556*   FILE TYPE = VSAM,KSDS                                        *
  2557*   RECORD SIZE = 374   RECFORM = FIX                            *
  2558*                                                                *
  2559*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2560*   ALTERNATE PATH    = NOT USED                                 *
  2561*                                                                *
  2562*   LOG = YES                                                    *
  2563*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2564******************************************************************
  2565*                   C H A N G E   L O G
  2566*
  2567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2568*-----------------------------------------------------------------
  2569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2570* EFFECTIVE    NUMBER
  2571*-----------------------------------------------------------------
  2572* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2573* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2574* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2575******************************************************************
  2576
  2577 01  PENDING-MAILING-DATA.
  2578     12  PM-RECORD-ID                      PIC XX.
  2579         88  VALID-MA-ID                       VALUE 'PM'.
  2580
  2581     12  PM-CONTROL-PRIMARY.
  2582         16  PM-COMPANY-CD                 PIC X.
  2583         16  PM-ENTRY-BATCH                PIC X(6).
  2584         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2585         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2586
  2587     12  FILLER                            PIC X(14).
  2588
  2589     12  PM-ACCESS-CONTROL.
  2590         16  PM-SOURCE-SYSTEM              PIC XX.
  2591             88  PM-FROM-CREDIT                VALUE 'CR'.
  2592             88  PM-FROM-VSI                   VALUE 'VS'.
  2593             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2594             88  PM-FROM-OTHER                 VALUE 'OT'.
  2595         16  PM-RECORD-ADD-DT              PIC XX.
  2596         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2597         16  PM-LAST-MAINT-DT              PIC XX.
  2598         16  PM-LAST-MAINT-BY              PIC XXXX.
  2599         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2600
  2601     12  PM-PROFILE-INFO.
  2602         16  PM-QUALIFY-CODE-1             PIC XX.
  2603         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  50
* EL050.cbl
  2604         16  PM-QUALIFY-CODE-3             PIC XX.
  2605         16  PM-QUALIFY-CODE-4             PIC XX.
  2606         16  PM-QUALIFY-CODE-5             PIC XX.
  2607
  2608         16  PM-INSURED-LAST-NAME          PIC X(15).
  2609         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2610         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2611         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2612         16  PM-INSURED-BIRTH-DT           PIC XX.
  2613         16  PM-INSURED-SEX                PIC X.
  2614             88  PM-SEX-MALE                   VALUE 'M'.
  2615             88  PM-SEX-FEMALE                 VALUE 'F'.
  2616         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2617
  2618         16  PM-ADDRESS-CORRECTED          PIC X.
  2619         16  PM-JOINT-BIRTH-DT             PIC XX.
  2620*        16  FILLER                        PIC X(12).
  2621
  2622         16  PM-ADDRESS-LINE-1             PIC X(30).
  2623         16  PM-ADDRESS-LINE-2             PIC X(30).
  2624         16  PM-CITY-STATE.
  2625             20  PM-CITY                   PIC X(28).
  2626             20  PM-STATE                  PIC XX.
  2627         16  PM-ZIP.
  2628             20  PM-ZIP-CODE.
  2629                 24  PM-ZIP-1              PIC X.
  2630                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2631                 24  FILLER                PIC X(4).
  2632             20  PM-ZIP-PLUS4              PIC X(4).
  2633         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2634             20  PM-CAN-POST1              PIC XXX.
  2635             20  PM-CAN-POST2              PIC XXX.
  2636             20  FILLER                    PIC XXX.
  2637
  2638         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2639
  2640         16  FILLER                        PIC X(03).
  2641
  2642     12  PM-CRED-BENE-INFO.
  2643         16  PM-CRED-BENE-NAME             PIC X(25).
  2644         16  PM-CRED-BENE-ADDR             PIC X(30).
  2645         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2646         16  PM-CRED-BENE-CTYST.
  2647             20  PM-CRED-BENE-CITY         PIC X(28).
  2648             20  PM-CRED-BENE-STATE        PIC XX.
  2649         16  PM-CRED-BENE-ZIP.
  2650             20  PM-CB-ZIP-CODE.
  2651                 24  PM-CB-ZIP-1           PIC X.
  2652                     88  PM-CB-CANADIAN-POST-CODE
  2653                                  VALUE 'A' THRU 'Z'.
  2654                 24  FILLER                PIC X(4).
  2655             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2656         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2657             20  PM-CB-CAN-POST1           PIC XXX.
  2658             20  PM-CB-CAN-POST2           PIC XXX.
  2659             20  FILLER                    PIC XXX.
  2660     12  PM-POST-CARD-MAIL-DATA.
  2661         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  51
* EL050.cbl
  2662             20  PM-MAIL-TYPE              PIC X.
  2663                 88  PM-12MO-MAILING           VALUE '1'.
  2664                 88  PM-EXP-MAILING            VALUE '2'.
  2665             20  PM-MAIL-STATUS            PIC X.
  2666                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2667                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2668                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2669             20  PM-MAIL-DATE              PIC XX.
  2670     12  FILLER                            PIC XX.
  2671     12  FILLER                            PIC X(12).
  2672*    12  FILLER                            PIC X(30).
  2673
  2674******************************************************************
  2675*                                COPY ERCLOFC.
  2676******************************************************************
  2677*                                                                *
  2678*                                                                *
  2679*                            ERCLOFC                             *
  2680*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2681*                            VMOD=2.003                          *
  2682*                                                                *
  2683*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2684*                                                                *
  2685*   FILE TYPE = VSAM,KSDS                                        *
  2686*   RECORD SIZE = 670   RECFORM = FIX                            *
  2687*                                                                *
  2688*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2689*                                                                *
  2690*   LOG = YES                                                    *
  2691*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2692*                                                                *
  2693******************************************************************
  2694
  2695 01  LOAN-OFFICER-MASTER.
  2696     12  LO-RECORD-ID                PIC XX.
  2697         88  VALID-LO-ID                VALUE 'LO'.
  2698
  2699     12  LO-CONTROL-PRIMARY.
  2700         16  LO-COMPANY-CD           PIC X.
  2701         16  LO-CARRIER              PIC X.
  2702         16  LO-GROUPING.
  2703             20  LO-GROUPING-PREFIX  PIC XXX.
  2704             20  LO-GROUPING-PRIME   PIC XXX.
  2705         16  LO-STATE                PIC XX.
  2706         16  LO-ACCOUNT.
  2707             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2708             20  LO-ACCOUNT-PRIME    PIC X(6).
  2709         16  LO-OFFICER-CODE         PIC X(5).
  2710
  2711     12  LO-OFFICER-NAME             PIC X(30).
  2712
  2713     12  LO-LAST-MAINT-DT            PIC XX.
  2714     12  LO-LAST-USER                PIC X(4).
  2715     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2716
  2717     12  LO-COMP-CONTROL             PIC X.
  2718             88  LO-SHOW-COMP           VALUE 'Y'.
  2719             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  52
* EL050.cbl
  2720     12  LO-DETAIL-CONTROL           PIC X.
  2721             88  LO-PRINT-DETAIL        VALUE 'D'.
  2722             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2723
  2724     12  LO-SV-CARRIER               PIC X.
  2725     12  LO-SV-GROUPING              PIC X(6).
  2726     12  LO-SV-STATE                 PIC XX.
  2727
  2728     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2729     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2730
  2731     12  LO-OFFICER-INFO.
  2732         16  FILLER OCCURS 12 TIMES.
  2733             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2734             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2735             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2736             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2737             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2738             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2739             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2740             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2741     12  FILLER                      PIC X(198).
  2742******************************************************************
  2743*                                COPY ERCPDEF.
  2744******************************************************************
  2745*                                                                *
  2746*                                                                *
  2747*                            ERCPDEF.                            *
  2748*                                                                *
  2749*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2750*                                                                *
  2751*    FILE TYPE = VSAM,KSDS                                       *
  2752*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2753*                                                                *
  2754*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2755*                                                                *
  2756*    LOG = YES                                                   *
  2757*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2758******************************************************************
  2759*                   C H A N G E   L O G
  2760*
  2761* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2762*-----------------------------------------------------------------
  2763*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2764* EFFECTIVE    NUMBER
  2765*-----------------------------------------------------------------
  2766* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2767* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2768******************************************************************
  2769 01  PRODUCT-MASTER.
  2770    12  PD-RECORD-ID                 PIC X(02).
  2771        88  VALID-PD-ID                  VALUE 'PD'.
  2772    12  PD-CONTROL-PRIMARY.
  2773        16  PD-COMPANY-CD            PIC X.
  2774        16  PD-STATE                 PIC XX.
  2775        16  PD-PRODUCT-CD            PIC XXX.
  2776        16  PD-FILLER                PIC X(7).
  2777        16  PD-BEN-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  53
* EL050.cbl
  2778        16  PD-BEN-CODE              PIC XX.
  2779        16  PD-PROD-EXP-DT           PIC XX.
  2780    12  FILLER                       PIC X(50).
  2781    12  PD-PRODUCT-DATA OCCURS 8.
  2782        16  PD-PROD-CODE             PIC X.
  2783            88  PD-PROD-LIFE           VALUE 'L'.
  2784            88  PD-PROD-PROP           VALUE 'P'.
  2785            88  PD-PROD-AH             VALUE 'A'.
  2786            88  PD-PROD-IU             VALUE 'I'.
  2787            88  PD-PROD-GAP            VALUE 'G'.
  2788            88  PD-PROD-FAML           VALUE 'F'.
  2789        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2790        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2791        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2792        16  PD-MAX-TERM              PIC S999        COMP-3.
  2793        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2794        16  FILLER                   PIC X.
  2795        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2796        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2797        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2798        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2799        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2800        16  PD-REC-CRIT-PERIOD       PIC 99.
  2801        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2802            20  PD-RECURRING-YN      PIC X.
  2803            20  FILLER               PIC X.
  2804        16  PD-RTW-MOS               PIC 99.
  2805        16  PD-MAX-EXTENSION         PIC 99.
  2806        16  FILLER                   PIC XX.
  2807    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2808    12  PD-TERM-LIMITS OCCURS 15.
  2809        16  PD-LOW-TERM              PIC S999        COMP-3.
  2810        16  PD-HI-TERM               PIC S999        COMP-3.
  2811*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2812    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2813        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2814        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2815    12  PD-EARN-FACTORS.
  2816        16  FILLER OCCURS 15.
  2817            20  FILLER OCCURS 15.
  2818                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2819    12  PD-PRODUCT-DESC              PIC X(80).
  2820    12  PD-TRUNCATED                 PIC X.
  2821    12  FILLER                       PIC X(59).
  2822    12  PD-MAINT-INFORMATION.
  2823        16  PD-LAST-MAINT-DT         PIC X(02).
  2824        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2825        16  PD-LAST-MAINT-BY         PIC X(04).
  2826*                                COPY ELCSTATE.
  2827******************************************************************
  2828*                                                                *
  2829*                                                                *
  2830*                            ELCSTATE.                           *
  2831*                                                                *
  2832*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2833*                                                                *
  2834*   FILE TYPE = VSAM,KSDS                                        *
  2835*   RECORD SIZE = 250  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  54
* EL050.cbl
  2836*                                                                *
  2837*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2838*       ALTERNATE INDEX = NONE                                   *
  2839*                                                                *
  2840*   LOG = YES                                                    *
  2841*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2842******************************************************************
  2843*                   C H A N G E   L O G
  2844*
  2845* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2846*-----------------------------------------------------------------
  2847*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2848* EFFECTIVE    NUMBER
  2849*-----------------------------------------------------------------
  2850* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2851******************************************************************
  2852*
  2853 01  STATE-FILE.
  2854     12  SF-RECORD-ID                       PIC XX.
  2855         88  VALID-CF-ID                        VALUE 'SF'.
  2856     12  SF-CONTROL-PRIMARY.
  2857         16  SF-COMPANY-ID                  PIC XXX.
  2858         16  SF-CARRIER-CODE                PIC X.
  2859         16  SF-GROUPING                    PIC X(6).
  2860         16  SF-STATE-CODE                  PIC XX.
  2861         16  SF-EXPIRE-DATE                 PIC 9(8).
  2862****************************************************************
  2863*             STATE CONTROLS
  2864****************************************************************
  2865     12  SF-LAST-MAINT-DT                   PIC XX.
  2866     12  SF-LAST-MAINT-BY                   PIC X(4).
  2867     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2868     12  SF-STATE-RT-CONTROLS.
  2869         16  SF-ST-RT-CALC                  PIC X.
  2870     12  SF-ST-TAX-CONTROLS.
  2871         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2872         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2873         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2874     12  SF-ST-REFUND-OPTIONS.
  2875         16  SF-ST-RF-LR-CALC               PIC X.
  2876         16  SF-ST-RF-LL-CALC               PIC X.
  2877         16  SF-ST-RF-LN-CALC               PIC X.
  2878         16  SF-ST-RF-AH-CALC               PIC X.
  2879         16  SF-ST-RF-CP-CALC               PIC X.
  2880     12  SF-ST-UNEARN-PREM-OPTIONS.
  2881         16  SF-ST-LUEP-R78                 PIC X.
  2882         16  SF-ST-LUEP-PRO                 PIC X.
  2883         16  SF-ST-LUEP-ST                  PIC X.
  2884         16  SF-ST-LUEP-DOM                 PIC X.
  2885         16  SF-ST-AUEP-R78                 PIC X.
  2886         16  SF-ST-AUEP-PRO                 PIC X.
  2887         16  SF-ST-AUEP-ST                  PIC X.
  2888         16  SF-ST-AUEP-DOM                 PIC X.
  2889         16  SF-ST-CUEP-R78                 PIC X.
  2890         16  SF-ST-CUEP-PRO                 PIC X.
  2891         16  SF-ST-CUEP-ST                  PIC X.
  2892         16  SF-ST-CUEP-DOM                 PIC X.
  2893     12  SF-ST-EARN-PREM-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  55
* EL050.cbl
  2894         16  SF-ST-LEP-R78                  PIC X.
  2895         16  SF-ST-LEP-PRO                  PIC X.
  2896         16  SF-ST-LEP-ST                   PIC X.
  2897         16  SF-ST-LEP-DOM                  PIC X.
  2898         16  SF-ST-AEP-R78                  PIC X.
  2899         16  SF-ST-AEP-PRO                  PIC X.
  2900         16  SF-ST-AEP-ST                   PIC X.
  2901         16  SF-ST-AEP-DOM                  PIC X.
  2902         16  SF-ST-CEP-R78                  PIC X.
  2903         16  SF-ST-CEP-PRO                  PIC X.
  2904         16  SF-ST-CEP-ST                   PIC X.
  2905         16  SF-ST-CEP-DOM                  PIC X.
  2906     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  56
* EL050.cbl
  2908*    COPY ELCCRTT.
  2909******************************************************************
  2910*                                                                *
  2911*                            ELCCRTT.                            *
  2912*                                                                *
  2913*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2914*                                                                *
  2915*   FILE TYPE = VSAM,KSDS                                        *
  2916*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2917*                                                                *
  2918*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2919*                                                                *
  2920*   LOG = YES                                                    *
  2921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2922******************************************************************
  2923*                   C H A N G E   L O G
  2924*
  2925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2926*-----------------------------------------------------------------
  2927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2928* EFFECTIVE    NUMBER
  2929*-----------------------------------------------------------------
  2930* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2931* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2932* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2933* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2934* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2935* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2936* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2937******************************************************************
  2938
  2939 01  CERTIFICATE-TRAILERS.
  2940     12  CS-RECORD-ID                      PIC XX.
  2941         88  VALID-CS-ID                      VALUE 'CS'.
  2942
  2943     12  CS-CONTROL-PRIMARY.
  2944         16  CS-COMPANY-CD                 PIC X.
  2945         16  CS-CARRIER                    PIC X.
  2946         16  CS-GROUPING                   PIC X(6).
  2947         16  CS-STATE                      PIC XX.
  2948         16  CS-ACCOUNT                    PIC X(10).
  2949         16  CS-CERT-EFF-DT                PIC XX.
  2950         16  CS-CERT-NO.
  2951             20  CS-CERT-PRIME             PIC X(10).
  2952             20  CS-CERT-SFX               PIC X.
  2953         16  CS-TRAILER-TYPE               PIC X.
  2954             88  COMM-TRLR           VALUE 'A'.
  2955             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2956             88  CERT-DATA-TRLR      VALUE 'C'.
  2957
  2958     12  CS-DATA-AREA                      PIC X(516).
  2959
  2960     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2961         16  CS-BANK-COMMISSION-AREA.
  2962             20  CS-BANK-COMMS       OCCURS 10.
  2963                 24  CS-AGT                PIC X(10).
  2964                 24  CS-COM-TYP            PIC X.
  2965                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  57
* EL050.cbl
  2966                 24  CS-RECALC-LV-INDIC    PIC X.
  2967                 24  FILLER                PIC X(10).
  2968         16  FILLER                        PIC X(256).
  2969
  2970     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2971****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2972         16  CS-MB-CLAIM-DATA OCCURS 24.
  2973             20  CS-CLAIM-NO               PIC X(7).
  2974             20  CS-CLAIM-TYPE             PIC X.
  2975                 88  CS-AH-CLM               VALUE 'A'.
  2976                 88  CS-IU-CLM               VALUE 'I'.
  2977                 88  CS-GP-CLM               VALUE 'G'.
  2978                 88  CS-LF-CLM               VALUE 'L'.
  2979                 88  CS-PR-CLM               VALUE 'P'.
  2980                 88  CS-FL-CLM               VALUE 'F'.
  2981             20  CS-INSURED-TYPE           PIC X.
  2982                 88  CS-PRIM-INSURED          VALUE 'P'.
  2983                 88  CS-CO-BORROWER           VALUE 'C'.
  2984             20  CS-BENEFIT-PERIOD         PIC 99.
  2985             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2986             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2987             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2988         16  FILLER                        PIC X(12).
  2989     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2990         16  CS-VIN-NUMBER                 PIC X(17).
  2991         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2992         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2993         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2994         16  FILLER                        PIC X(496).
  2995*    COPY ELCCRTO.
  2996******************************************************************
  2997*                                                                *
  2998*                            ELCCRTO.                            *
  2999*                                                                *
  3000*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3001*                                                                *
  3002*   FILE TYPE = VSAM,KSDS                                        *
  3003*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3004*                                                                *
  3005*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3006*                                                                *
  3007*   LOG = YES                                                    *
  3008*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3009******************************************************************
  3010*                   C H A N G E   L O G
  3011*
  3012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3013*-----------------------------------------------------------------
  3014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3015* EFFECTIVE    NUMBER
  3016*-----------------------------------------------------------------
  3017* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3018* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3019* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3020* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3021* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3022******************************************************************
  3023 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  58
* EL050.cbl
  3024     12  OC-RECORD-ID                      PIC XX.
  3025         88  VALID-OC-ID                      VALUE 'OC'.
  3026     12  OC-CONTROL-PRIMARY.
  3027         16  OC-COMPANY-CD                 PIC X.
  3028         16  OC-CARRIER                    PIC X.
  3029         16  OC-GROUPING                   PIC X(6).
  3030         16  OC-STATE                      PIC XX.
  3031         16  OC-ACCOUNT                    PIC X(10).
  3032         16  OC-CERT-EFF-DT                PIC XX.
  3033         16  OC-CERT-NO.
  3034             20  OC-CERT-PRIME             PIC X(10).
  3035             20  OC-CERT-SFX               PIC X.
  3036         16  OC-RECORD-TYPE                PIC X.
  3037         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3038     12  OC-LAST-MAINT-DT                  PIC XX.
  3039     12  OC-LAST-MAINT-BY                  PIC X(4).
  3040     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3041     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3042     12  FILLER                            PIC X(49).
  3043     12  OC-ORIG-REC.
  3044         16  OC-INS-LAST-NAME              PIC X(15).
  3045         16  OC-INS-FIRST-NAME             PIC X(10).
  3046         16  OC-INS-MIDDLE-INIT            PIC X.
  3047         16  OC-INS-AGE                    PIC S999     COMP-3.
  3048         16  OC-JNT-LAST-NAME              PIC X(15).
  3049         16  OC-JNT-FIRST-NAME             PIC X(10).
  3050         16  OC-JNT-MIDDLE-INIT            PIC X.
  3051         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3052         16  OC-LF-BENCD                   PIC XX.
  3053         16  OC-LF-TERM                    PIC S999      COMP-3.
  3054         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3055         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3056         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3057         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3058         16  OC-LF-EXP-DT                  PIC XX.
  3059         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3060         16  OC-LF-CANCEL-DT               PIC XX.
  3061         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3062         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3063         16  OC-AH-BENCD                   PIC XX.
  3064         16  OC-AH-TERM                    PIC S999      COMP-3.
  3065         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3066         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3067         16  OC-AH-EXP-DT                  PIC XX.
  3068         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3069         16  OC-AH-CP                      PIC 99.
  3070         16  OC-AH-CANCEL-DT               PIC XX.
  3071         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3072         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3073         16  OC-CRED-BENE-NAME             PIC X(25).
  3074         16  OC-1ST-PMT-DT                 PIC XX.
  3075         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3076         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3077         16  OC-ISSUE-TRAN-IND             PIC X.
  3078         16  OC-CANCEL-TRAN-IND            PIC X.
  3079         16  FILLER                        PIC X(211).
  3080
  3081     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  59
* EL050.cbl
  3082******************************************************************
  3083
  3084*    COPY ELCDATE.
  3085******************************************************************
  3086*                                                                *
  3087*                                                                *
  3088*                            ELCDATE.                            *
  3089*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3090*                            VMOD=2.003
  3091*                                                                *
  3092*                                                                *
  3093*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3094*                 LENGTH = 200                                   *
  3095******************************************************************
  3096
  3097 01  DATE-CONVERSION-DATA.
  3098     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3099     12  DC-OPTION-CODE                PIC X.
  3100         88  BIN-TO-GREG                VALUE ' '.
  3101         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3102         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3103         88  YMD-GREG-TO-BIN            VALUE '3'.
  3104         88  MDY-GREG-TO-BIN            VALUE '4'.
  3105         88  JULIAN-TO-BIN              VALUE '5'.
  3106         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3107         88  FIND-CENTURY               VALUE '7'.
  3108         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3109         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3110         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3111         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3112         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3113         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3114         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3115         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3116         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3117         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3118         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3119         88  BIN-3-TO-GREG              VALUE 'I'.
  3120         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3121         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3122         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3123         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3124         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3125         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3126         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3127         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3128         88  THREE-CHARACTER-BIN
  3129                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3130         88  GREGORIAN-TO-BIN
  3131                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3132         88  BIN-TO-GREGORIAN
  3133                  VALUES ' ' '1' 'I' '8' 'G'.
  3134         88  JULIAN-TO-BINARY
  3135                  VALUES '5' 'C' 'E' 'F'.
  3136     12  DC-ERROR-CODE                 PIC X.
  3137         88  NO-CONVERSION-ERROR        VALUE ' '.
  3138         88  DATE-CONVERSION-ERROR
  3139                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  60
* EL050.cbl
  3140         88  DATE-IS-ZERO               VALUE '1'.
  3141         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3142         88  DATE-IS-INVALID            VALUE '3'.
  3143         88  DATE1-GREATER-DATE2        VALUE '4'.
  3144         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3145         88  DATE-INVALID-OPTION        VALUE '9'.
  3146         88  INVALID-CENTURY            VALUE 'A'.
  3147         88  ONLY-CENTURY               VALUE 'B'.
  3148         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3149         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3150     12  DC-END-OF-MONTH               PIC X.
  3151         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3152     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3153         88  USE-NORMAL-PROCESS         VALUE ' '.
  3154         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3155         88  ADJUST-UP-100-YRS          VALUE '2'.
  3156     12  FILLER                        PIC X.
  3157     12  DC-CONVERSION-DATES.
  3158         16  DC-BIN-DATE-1             PIC XX.
  3159         16  DC-BIN-DATE-2             PIC XX.
  3160         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3161         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3162                       DC-GREG-DATE-1-EDIT.
  3163             20  DC-EDIT1-MONTH        PIC 99.
  3164             20  SLASH1-1              PIC X.
  3165             20  DC-EDIT1-DAY          PIC 99.
  3166             20  SLASH1-2              PIC X.
  3167             20  DC-EDIT1-YEAR         PIC 99.
  3168         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3169         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3170                     DC-GREG-DATE-2-EDIT.
  3171             20  DC-EDIT2-MONTH        PIC 99.
  3172             20  SLASH2-1              PIC X.
  3173             20  DC-EDIT2-DAY          PIC 99.
  3174             20  SLASH2-2              PIC X.
  3175             20  DC-EDIT2-YEAR         PIC 99.
  3176         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3177         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3178                     DC-GREG-DATE-1-YMD.
  3179             20  DC-YMD-YEAR           PIC 99.
  3180             20  DC-YMD-MONTH          PIC 99.
  3181             20  DC-YMD-DAY            PIC 99.
  3182         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3183         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3184                      DC-GREG-DATE-1-MDY.
  3185             20  DC-MDY-MONTH          PIC 99.
  3186             20  DC-MDY-DAY            PIC 99.
  3187             20  DC-MDY-YEAR           PIC 99.
  3188         16  DC-GREG-DATE-1-ALPHA.
  3189             20  DC-ALPHA-MONTH        PIC X(10).
  3190             20  DC-ALPHA-DAY          PIC 99.
  3191             20  FILLER                PIC XX.
  3192             20  DC-ALPHA-CENTURY.
  3193                 24 DC-ALPHA-CEN-N     PIC 99.
  3194             20  DC-ALPHA-YEAR         PIC 99.
  3195         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3196         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3197         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  61
* EL050.cbl
  3198         16  DC-JULIAN-DATE            PIC 9(05).
  3199         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3200                                       PIC 9(05).
  3201         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3202             20  DC-JULIAN-YEAR        PIC 99.
  3203             20  DC-JULIAN-DAYS        PIC 999.
  3204         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3205         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3206         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3207     12  DATE-CONVERSION-VARIBLES.
  3208         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3209         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3210             20  FILLER                PIC 9(3).
  3211             20  HOLD-CEN-1-CCYY.
  3212                 24  HOLD-CEN-1-CC     PIC 99.
  3213                 24  HOLD-CEN-1-YY     PIC 99.
  3214             20  HOLD-CEN-1-MO         PIC 99.
  3215             20  HOLD-CEN-1-DA         PIC 99.
  3216         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3217             20  HOLD-CEN-1-R-MO       PIC 99.
  3218             20  HOLD-CEN-1-R-DA       PIC 99.
  3219             20  HOLD-CEN-1-R-CCYY.
  3220                 24  HOLD-CEN-1-R-CC   PIC 99.
  3221                 24  HOLD-CEN-1-R-YY   PIC 99.
  3222             20  FILLER                PIC 9(3).
  3223         16  HOLD-CENTURY-1-X.
  3224             20  FILLER                PIC X(3)  VALUE SPACES.
  3225             20  HOLD-CEN-1-X-CCYY.
  3226                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3227                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3228             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3229             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3230         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3231             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3232             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3233             20  HOLD-CEN-1-R-X-CCYY.
  3234                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3235                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3236             20  FILLER                PIC XXX.
  3237         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3238         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3239         16  DC-JULIAN-DATE-1          PIC 9(07).
  3240         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3241             20  DC-JULIAN-1-CCYY.
  3242                 24  DC-JULIAN-1-CC    PIC 99.
  3243                 24  DC-JULIAN-1-YR    PIC 99.
  3244             20  DC-JULIAN-DA-1        PIC 999.
  3245         16  DC-JULIAN-DATE-2          PIC 9(07).
  3246         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3247             20  DC-JULIAN-2-CCYY.
  3248                 24  DC-JULIAN-2-CC    PIC 99.
  3249                 24  DC-JULIAN-2-YR    PIC 99.
  3250             20  DC-JULIAN-DA-2        PIC 999.
  3251         16  DC-GREG-DATE-A-EDIT.
  3252             20  DC-EDITA-MONTH        PIC 99.
  3253             20  SLASHA-1              PIC X VALUE '/'.
  3254             20  DC-EDITA-DAY          PIC 99.
  3255             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  62
* EL050.cbl
  3256             20  DC-EDITA-CCYY.
  3257                 24  DC-EDITA-CENT     PIC 99.
  3258                 24  DC-EDITA-YEAR     PIC 99.
  3259         16  DC-GREG-DATE-B-EDIT.
  3260             20  DC-EDITB-MONTH        PIC 99.
  3261             20  SLASHB-1              PIC X VALUE '/'.
  3262             20  DC-EDITB-DAY          PIC 99.
  3263             20  SLASHB-2              PIC X VALUE '/'.
  3264             20  DC-EDITB-CCYY.
  3265                 24  DC-EDITB-CENT     PIC 99.
  3266                 24  DC-EDITB-YEAR     PIC 99.
  3267         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3268         16  DC-GREG-DATE-CYMD-R REDEFINES
  3269                              DC-GREG-DATE-CYMD.
  3270             20  DC-CYMD-CEN           PIC 99.
  3271             20  DC-CYMD-YEAR          PIC 99.
  3272             20  DC-CYMD-MONTH         PIC 99.
  3273             20  DC-CYMD-DAY           PIC 99.
  3274         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3275         16  DC-GREG-DATE-MDCY-R REDEFINES
  3276                              DC-GREG-DATE-MDCY.
  3277             20  DC-MDCY-MONTH         PIC 99.
  3278             20  DC-MDCY-DAY           PIC 99.
  3279             20  DC-MDCY-CEN           PIC 99.
  3280             20  DC-MDCY-YEAR          PIC 99.
  3281    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3282        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3283    12  DC-EL310-DATE                  PIC X(21).
  3284    12  FILLER                         PIC X(28).
  3285
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  63
* EL050.cbl
  3287*    COPY ELCCALC.
  3288******************************************************************
  3289*                                                                *
  3290*                           ELCCALC.                            *
  3291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3292*                            VMOD=2.025                          *
  3293*                                                                *
  3294*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3295*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3296*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3297*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3298*                                                                *
  3299*  PASSED TO ELRTRM                                              *
  3300*  -----------------                                             *
  3301*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3302*  ORIGINAL TERM                                                 *
  3303*  BEGINNING DATE                                                *
  3304*  ENDING DATE                                                   *
  3305*  COMPANY I.D.                                                  *
  3306*  ACCOUNT MASTER USER FIELD                                     *
  3307*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3308*  FREE LOOK DAYS                                                *
  3309*                                                                *
  3310*  RETURNED FROM ELRTRM                                          *
  3311*  ---------------------                                         *
  3312*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3313*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3314*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3315*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3316*----------------------------------------------------------------*
  3317*  PASSED TO ELRAMT                                              *
  3318*  ----------------                                              *
  3319*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3320*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3321*  ORIGINAL AMOUNT                                               *
  3322*  ALTERNATE BENEFIT (BALLON)                                    *
  3323*  A.P.R. - NET PAY ONLY                                         *
  3324*  METHOD
  3325*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3326*  COMPANY I.D.                                                  *
  3327*  BENEFIT TYPE                                                  *
  3328*                                                                *
  3329*  RETURNED FROM ELRAMT                                          *
  3330*  --------------------                                          *
  3331*  REMAINING AMOUNT 1 - CURRENT                                  *
  3332*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3333*  REMAINING AMOUNT FACTOR
  3334*----------------------------------------------------------------*
  3335*  PASSED TO ELRESV                                              *
  3336*  -----------------                                             *
  3337*  CERTIFICATE EFFECTIVE DATE                                    *
  3338*  VALUATION DATE                                                *
  3339*  PAID THRU DATE                                                *
  3340*  BENEFIT                                                       *
  3341*  INCURRED DATE                                                 *
  3342*  REPORTED DATE                                                 *
  3343*  ISSUE AGE                                                     *
  3344*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  64
* EL050.cbl
  3345*  CDT PERCENT                                                   *
  3346*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3347* *CLAIM TYPE (LIFE, A/H)                                        *
  3348* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3349* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3350*                                                                *
  3351*  RETURNED FROM ELRESV                                          *
  3352*  --------------------                                          *
  3353*  CDT TABLE USED                                                *
  3354*  CDT FACTOR USED                                               *
  3355*  PAY TO CURRENT RESERVE                                        *
  3356*  I.B.N.R. - A/H ONLY                                           *
  3357*  FUTURE (ACCRUED) AH ONLY                                      *
  3358*----------------------------------------------------------------*
  3359*  PASSED TO ELRATE                                              *
  3360*  ----------------                                              *
  3361*  CERT ISSUE DATE                                               *
  3362*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3363*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3364*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3365*  STATE CODE (CLIENT DEFINED)                                   *
  3366*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3367*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3368*  DEVIATION CODE                                                *
  3369*  ISSUE AGE                                                     *
  3370*  ORIGINAL BENEFIT AMOUNT                                       *
  3371*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3372*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3373*  BENEFIT KIND (LIFE OR A/H)                                    *
  3374*  A.P.R.                                                        *
  3375*  METHOD
  3376*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3377*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3378*  COMPANY I.D. (3 CHARACTER)                                    *
  3379*  BENEFIT CODE                                                  *
  3380*  BENEFIT OVERRIDE CODE                                         *
  3381*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3382*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3383*  JOINT INDICATOR (CSL ONLY)                                    *
  3384*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3385*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3386*                                                                *
  3387*  RETURNED FROM ELRATE                                          *
  3388*  --------------------                                          *
  3389*  CALCULATED PREMIUM                                            *
  3390*  PREMIUM RATE                                                  *
  3391*  MORTALITY CODE                                                *
  3392*  MAX ATTAINED AGE                                              *
  3393*  MAX AGE                                                       *
  3394*  MAX TERM                                                      *
  3395*  MAX MONTHLY BENEFIT                                           *
  3396*  MAX TOTAL BENIFIT                                             *
  3397*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3398*----------------------------------------------------------------*
  3399*  PASSED TO ELRFND                                              *
  3400*  ----------------                                              *
  3401*  CERT ISSUE DATE                                               *
  3402*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  65
* EL050.cbl
  3403*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3404*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3405*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3406*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3407*  STATE CODE (CLIENT DEFINED)                                   *
  3408*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3409*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3410*  DEVIATION CODE                                                *
  3411*  ISSUE AGE                                                     *
  3412*  ORIGINAL BENEFIT AMOUNT                                       *
  3413*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3414*  PROCESS TYPE (CANCEL)                                         *
  3415*  BENEFIT KIND (LIFE OR A/H)                                    *
  3416*  A.P.R.                                                        *
  3417*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3418*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3419*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3420*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3421*  COMPANY I.D. (3 CHARACTER)                                    *
  3422*  BENEFIT CODE                                                  *
  3423*  BENEFIT OVERRIDE CODE                                         *
  3424*                                                                *
  3425*  RETURNED FROM ELRFND                                          *
  3426*  --------------------                                          *
  3427*  CALCULATED REFUND                                             *
  3428*----------------------------------------------------------------*
  3429*  PASSED TO ELEARN                                              *
  3430*  ----------------                                              *
  3431*  CERT ISSUE DATE                                               *
  3432*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3433*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3434*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3435*  STATE CODE (CLIENT DEFINED)                                   *
  3436*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3437*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3438*  DEVIATION CODE                                                *
  3439*  ISSUE AGE                                                     *
  3440*  ORIGINAL BENEFIT AMOUNT                                       *
  3441*  BENEFIT KIND (LIFE OR A/H)                                    *
  3442*  A.P.R.                                                        *
  3443*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3444*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3445*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3446*  COMPANY I.D. (3 CHARACTER)                                    *
  3447*  BENEFIT CODE                                                  *
  3448*  BENEFIT OVERRIDE CODE                                         *
  3449*                                                                *
  3450*  RETURNED FROM ELEARN                                          *
  3451*  --------------------                                          *
  3452*  INDICATED  EARNINGS                                           *
  3453*----------------------------------------------------------------*
  3454*                 LENGTH = 450                                   *
  3455*                                                                *
  3456******************************************************************
  3457******************************************************************
  3458*                   C H A N G E   L O G
  3459*
  3460* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  66
* EL050.cbl
  3461*-----------------------------------------------------------------
  3462*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3463* EFFECTIVE    NUMBER
  3464*-----------------------------------------------------------------
  3465* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3466* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3467* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3468* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3469* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3470* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3471* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3472* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3473* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3474******************************************************************
  3475
  3476 01  CALCULATION-PASS-AREA.
  3477     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3478                                     COMP.
  3479
  3480     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3481       88  NO-CP-ERROR                             VALUE ZERO.
  3482       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3483                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3484       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3485       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3486       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3487       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3488       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3489       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3490       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3491       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3492       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3493       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3494       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3495       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3496       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3497       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3498       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3499       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3500       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3501
  3502     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3503       88  NO-CP-ERROR-2                           VALUE ZERO.
  3504***********************  INPUT AREAS ****************************
  3505
  3506     12  CP-CALCULATION-AREA.
  3507         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3508         16  CP-CERT-EFF-DT        PIC XX.
  3509         16  CP-VALUATION-DT       PIC XX.
  3510         16  CP-PAID-THRU-DT       PIC XX.
  3511         16  CP-BENEFIT-TYPE       PIC X.
  3512           88  CP-AH                               VALUE 'A' 'D'
  3513                                                   'I' 'U'.
  3514           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3515           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3516         16  CP-INCURRED-DT        PIC XX.
  3517         16  CP-REPORTED-DT        PIC XX.
  3518         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  67
* EL050.cbl
  3519         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3520         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3521                                     COMP-3.
  3522         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3523                                     COMP-3.
  3524         16  CP-CDT-METHOD         PIC X.
  3525           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3526           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3527           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3528         16  CP-CLAIM-TYPE         PIC X.
  3529           88  CP-AH-CLAIM                         VALUE 'A'.
  3530           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3531         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3532                                     COMP-3.
  3533         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3534                                     COMP-3.
  3535         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3536                                     COMP-3.
  3537         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3538                                     COMP-3.
  3539         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3540                                     COMP-3.
  3541         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3542                                     COMP-3.
  3543         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3544                                     COMP-3.
  3545         16  CP-REM-TERM-METHOD    PIC X.
  3546           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3547           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3548           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3549           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3550           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3551           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3552           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3553         16  CP-EARNING-METHOD     PIC X.
  3554           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3555           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3556           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3557           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3558           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3559           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3560           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3561           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3562           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3563           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3564           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3565           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3566           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3567           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3568         16  CP-PROCESS-TYPE       PIC X.
  3569           88  CP-CLAIM                            VALUE '1'.
  3570           88  CP-CANCEL                           VALUE '2'.
  3571           88  CP-ISSUE                            VALUE '3'.
  3572         16  CP-SPECIAL-CALC-CD    PIC X.
  3573           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3574           88  CP-1-MTH-INTEREST               VALUE ' '.
  3575           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3576           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  68
* EL050.cbl
  3577           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3578           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3579           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3580           88  CP-FARM-PLAN                    VALUE 'F'.
  3581           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3582           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3583           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3584           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3585           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3586           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3587           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3588           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3589           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3590           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3591                                                     'W' 'X'.
  3592           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3593           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3594           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3595           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3596           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3597           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3598           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3599           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3600           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3601           88  CP-CSL-METH-1                   VALUE '5'.
  3602           88  CP-CSL-METH-2                   VALUE '6'.
  3603           88  CP-CSL-METH-3                   VALUE '7'.
  3604           88  CP-CSL-METH-4                   VALUE '8'.
  3605
  3606         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3607                                     COMP-3.
  3608         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3609         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3610         16  CP-STATE              PIC XX          VALUE SPACE.
  3611         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3612         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3613           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3614               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3615         16  CP-R78-OPTION         PIC X.
  3616           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3617           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3618
  3619         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3620         16  CP-IBNR-RESERVE-SW    PIC X.
  3621         16  CP-CLAIM-STATUS       PIC X.
  3622         16  CP-RATE-FILE          PIC X.
  3623         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3624                                     COMP-3.
  3625
  3626         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3627         16  CP-AH-OVERRIDE-CODE   PIC X.
  3628
  3629         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3630                                     COMP-3.
  3631         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3632                                   PIC S9(5)V99 COMP-3.
  3633         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3634                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  69
* EL050.cbl
  3635         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3636                                     COMP-3.
  3637         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3638                                     COMP-3.
  3639         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3640                                  PIC S9(7)V99 COMP-3.
  3641
  3642         16  CP-PAID-FROM-DATE     PIC X(02).
  3643         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3644         16  CP-EXT-DAYS-CALC      PIC X.
  3645           88  CP-EXT-NO-CHG                   VALUE ' '.
  3646           88  CP-EXT-CHG-LF                   VALUE '1'.
  3647           88  CP-EXT-CHG-AH                   VALUE '2'.
  3648           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3649         16  CP-DOMICILE-STATE     PIC XX.
  3650         16  CP-CARRIER            PIC X.
  3651         16  CP-REIN-FLAG          PIC X.
  3652         16  CP-REM-TRM-CALC-OPTION PIC X.
  3653           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3654                      '2' '3' '4' '5'.
  3655           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3656           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3657           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3658           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3659           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3660           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3661           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3662           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3663         16  CP-SIG-SWITCH         PIC X.
  3664         16  CP-RATING-METHOD      PIC X.
  3665           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3666           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3667           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3668           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3669           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3670           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3671           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3672           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3673           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3674         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3675                                     COMP-3.
  3676         16  CP-BEN-CATEGORY       PIC X.
  3677         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3678         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3679                                   PIC S99V9(5) COMP-3.
  3680         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3681         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3682                                   PIC S99V9(5) COMP-3.
  3683         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3684         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3685         16  CP-EXPIRE-DT          PIC XX.
  3686         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3687         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3688         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3689         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3690         16  CP-DDF-SPEC-CALC      PIC X.
  3691             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3692             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  70
* EL050.cbl
  3693         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3694         16  CP-CANCEL-REASON      PIC X.
  3695         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3696         16  CP-PMT-MODE           PIC X.
  3697         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3698         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3699         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3700         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3701         16  FILLER                PIC X.
  3702
  3703***************    OUTPUT FROM ELRESV   ************************
  3704
  3705         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3706
  3707         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3712                                     COMP-3.
  3713         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3714                                     COMP-3.
  3715         16  FILLER                PIC X(09).
  3716***************    OUTPUT FROM ELRTRM   *************************
  3717
  3718         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3719                                     COMP-3.
  3720         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3721                                     COMP-3.
  3722         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3725                                     COMP-3.
  3726         16  FILLER                PIC X(12).
  3727
  3728***************    OUTPUT FROM ELRAMT   *************************
  3729
  3730         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3733                                     COMP-3.
  3734         16  FILLER                PIC X(12).
  3735
  3736***************    OUTPUT FROM ELRATE   *************************
  3737
  3738         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3739                                     COMP-3.
  3740         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-MORTALITY-CODE     PIC X(4).
  3743         16  CP-RATE-EDIT-FLAG     PIC X.
  3744             88  CP-RATES-NEED-APR                  VALUE '1'.
  3745         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3748         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3749         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3750                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  71
* EL050.cbl
  3751         16  FILLER                PIC X(07).
  3752
  3753***************    OUTPUT FROM ELRFND   *************************
  3754
  3755         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3756                                     COMP-3.
  3757         16  CP-REFUND-TYPE-USED   PIC X.
  3758           88  CP-R-AS-R78                         VALUE '1'.
  3759           88  CP-R-AS-PRORATA                     VALUE '2'.
  3760           88  CP-R-AS-CALIF                       VALUE '3'.
  3761           88  CP-R-AS-TEXAS                       VALUE '4'.
  3762           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3763           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3764           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3765           88  CP-R-AS-MEAN                        VALUE '8'.
  3766           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3767           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3768           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3769           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3770           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3771           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3772         16  FILLER                PIC X(12).
  3773
  3774***************    OUTPUT FROM ELEARN   *************************
  3775
  3776         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3783                                     COMP-3.
  3784         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3785                                     COMP-3.
  3786         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3787                                     COMP-3.
  3788         16  CP-EARNING-TYPE-USED  PIC X.
  3789           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3790           88  CP-E-AS-R78                         VALUE '1'.
  3791           88  CP-E-AS-PRORATA                     VALUE '2'.
  3792           88  CP-E-AS-TEXAS                       VALUE '4'.
  3793           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3794           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3795           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3796           88  CP-E-AS-MEAN                        VALUE '8'.
  3797           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3798         16  FILLER                PIC X(12).
  3799
  3800***************    OUTPUT FROM ELPMNT   *************************
  3801
  3802         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3803                                     COMP-3.
  3804         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3805                                     COMP-3.
  3806         16  FILLER                PIC X(12).
  3807
  3808***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  72
* EL050.cbl
  3809         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3814                                     COMP-3.
  3815         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3816                                     COMP-3.
  3817         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3818                                     COMP-3.
  3819         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3820                                     COMP-3.
  3821         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3822             88  OPEN-RATE-FILE                   VALUE 'O'.
  3823             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3824             88  IO-ERROR                         VALUE 'E'.
  3825
  3826         16  CP-FIRST-PAY-DATE     PIC XX.
  3827
  3828         16  CP-JOINT-INDICATOR    PIC X.
  3829
  3830         16  CP-RESERVE-REMAINING-TERM
  3831                                   PIC S9(4)V9    VALUE ZERO
  3832                                     COMP-3.
  3833
  3834         16  CP-INSURED-BIRTH-DT   PIC XX.
  3835
  3836         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3837                                     COMP-3.
  3838
  3839         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3840                                     COMP-3.
  3841
  3842         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3843                                     COMP-3.
  3844
  3845         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3846                                     COMP-3.
  3847
  3848         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3849                                     COMP-3.
  3850
  3851         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3852                                     COMP-3.
  3853
  3854         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3855                                     COMP-3.
  3856
  3857         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3858             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3859
  3860         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3861                                     COMP-3.
  3862         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3863                                     COMP-3.
  3864         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3865         16  FILLER                PIC X(15).
  3866******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  73
* EL050.cbl
  3868******************************************************************
  3869*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3870*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3871*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3872*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3873*** MODIFICATION.                                              ***
  3874*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3875*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3876******************************************************************
  3877*    COPY ERCPNDB.
  3878******************************************************************
  3879*                                                                *
  3880*                                                                *
  3881*                            ERCPNDB.                            *
  3882*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3883*                            VMOD=2.025                          *
  3884*                                                                *
  3885*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3886*                                                                *
  3887******************************************************************
  3888*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3889*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3890******************************************************************
  3891*                                                                *
  3892*                                                                *
  3893*   FILE TYPE = VSAM,KSDS                                        *
  3894*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3895*                                                                *
  3896*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3897*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3898*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3899*                                                 RKP=13,LEN=36  *
  3900*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3901*                                      AND CHG-SEQ.)             *
  3902*                                                RKP=49,LEN=11   *
  3903*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3904*                                      AND CHG-SEQ.)             *
  3905*                                                RKP=60,LEN=15   *
  3906*                                                                *
  3907*   LOG = NO                                                     *
  3908*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3909******************************************************************
  3910******************************************************************
  3911*                   C H A N G E   L O G
  3912*
  3913* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3914*-----------------------------------------------------------------
  3915*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3916* EFFECTIVE    NUMBER
  3917*-----------------------------------------------------------------
  3918* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3919* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3920* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3921* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3922* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3923* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3924* 032306                   PEMA  ADD BOW LOAN NUMBER
  3925* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  74
* EL050.cbl
  3926* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3927* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3928* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3929* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3930* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3931* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3932* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3933* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3934******************************************************************
  3935
  3936 01  PENDING-BUSINESS.
  3937     12  PB-RECORD-ID                     PIC XX.
  3938         88  VALID-PB-ID                        VALUE 'PB'.
  3939
  3940     12  PB-CONTROL-PRIMARY.
  3941         16  PB-COMPANY-CD                PIC X.
  3942         16  PB-ENTRY-BATCH               PIC X(6).
  3943         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3944         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3945
  3946     12  PB-CONTROL-BY-ACCOUNT.
  3947         16  PB-COMPANY-CD-A1             PIC X.
  3948         16  PB-CARRIER                   PIC X.
  3949         16  PB-GROUPING.
  3950             20  PB-GROUPING-PREFIX       PIC XXX.
  3951             20  PB-GROUPING-PRIME        PIC XXX.
  3952         16  PB-STATE                     PIC XX.
  3953         16  PB-ACCOUNT.
  3954             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3955             20  PB-ACCOUNT-PRIME         PIC X(6).
  3956         16  PB-CERT-EFF-DT               PIC XX.
  3957         16  PB-CERT-NO.
  3958             20  PB-CERT-PRIME            PIC X(10).
  3959             20  PB-CERT-SFX              PIC X.
  3960         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3961
  3962         16  PB-RECORD-TYPE               PIC X.
  3963             88  PB-MAILING-DATA                VALUE '0'.
  3964             88  PB-ISSUE                       VALUE '1'.
  3965             88  PB-CANCELLATION                VALUE '2'.
  3966             88  PB-BATCH-TRAILER               VALUE '9'.
  3967
  3968     12  PB-CONTROL-BY-ORIG-BATCH.
  3969         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3970         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3971         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3972         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3973
  3974     12  PB-CONTROL-BY-CSR.
  3975         16  PB-CSR-COMPANY-CD            PIC X.
  3976         16  PB-CSR-ID                    PIC X(4).
  3977         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3978         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3979         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3980******************************************************************
  3981*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3982******************************************************************
  3983
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  75
* EL050.cbl
  3984     12  PB-LAST-MAINT-DT                 PIC XX.
  3985     12  PB-LAST-MAINT-BY                 PIC X(4).
  3986     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3987
  3988     12  PB-RECORD-BODY                   PIC X(375).
  3989
  3990     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3991         16  PB-CERT-ORIGIN               PIC X.
  3992             88  CLASIC-CREATED-CERT         VALUE '1'.
  3993         16  PB-I-NAME.
  3994             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3995             20  PB-I-INSURED-FIRST-NAME.
  3996                 24  PB-I-INSURED-1ST-INIT PIC X.
  3997                 24  FILLER                PIC X(9).
  3998             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3999         16  PB-I-AGE                     PIC S99   COMP-3.
  4000         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4001         16  PB-I-BIRTHDAY                PIC XX.
  4002         16  PB-I-INSURED-SEX             PIC X.
  4003             88  PB-SEX-MALE     VALUE 'M'.
  4004             88  PB-SEX-FEMALE   VALUE 'F'.
  4005
  4006         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4007         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4008         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4009         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4010         16  PB-I-SKIP-CODE               PIC X.
  4011             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4012             88  PB-SKIP-JULY              VALUE '1'.
  4013             88  PB-SKIP-AUGUST            VALUE '2'.
  4014             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4015             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4016             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4017             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4018             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4019             88  PB-SKIP-JUNE              VALUE '8'.
  4020             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4021             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4022             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4023         16  PB-I-TERM-TYPE               PIC X.
  4024             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4025             88  PB-PAID-WEEKLY            VALUE 'W'.
  4026             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4027             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4028             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4029         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4030         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4031         16  PB-I-DATA-ENTRY-SW           PIC X.
  4032             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4033             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4034             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4035             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4036         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4037         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4038*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4039         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4040         16  FILLER                       PIC X.
  4041
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  76
* EL050.cbl
  4042         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4043             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4044             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4045                                                   '90' THRU '99'.
  4046         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4047                                          PIC XX.
  4048         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4049         16  PB-I-AMOUNT-FINANCED REDEFINES
  4050                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4051         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4052         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4053                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4054         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4055         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4056         16  PB-I-CLP-AMOUNT REDEFINES
  4057                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4058         16  PB-I-LF-CALC-FLAG            PIC X.
  4059             88 PB-COMP-LF-PREM               VALUE '?'.
  4060         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4061         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4062         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4063         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4064         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4065         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4066         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4067         16  PB-I-LF-ABBR                 PIC XXX.
  4068         16  PB-I-LF-INPUT-CD             PIC XX.
  4069
  4070         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4071             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4072             88  PB-INVALID-AH               VALUE '  ' '00'
  4073                                                   '90' THRU '99'.
  4074         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4075         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4076         16  PB-I-AH-CALC-FLAG            PIC X.
  4077             88 PB-COMP-AH-PREM                  VALUE '?'.
  4078         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4079         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4080         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4081         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4082         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4083         16  PB-I-AH-ABBR                 PIC XXX.
  4084         16  PB-I-AH-INPUT-CD             PIC XXX.
  4085
  4086         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4087         16  PB-I-REIN-TABLE              PIC XXX.
  4088         16  PB-I-BUSINESS-TYPE           PIC 99.
  4089         16  PB-I-INDV-GRP-CD             PIC X.
  4090         16  PB-I-MORT-CODE.
  4091             20  PB-I-TABLE               PIC X.
  4092             20  PB-I-INTEREST            PIC XX.
  4093             20  PB-I-MORT-TYP            PIC X.
  4094         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4095         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4096         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4097         16  PB-I-INDV-GRP-OVRD           PIC X.
  4098         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4099         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  77
* EL050.cbl
  4100             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4101         16  PB-I-RATE-CLASS              PIC XX.
  4102         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4103         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4104         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4105         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4106         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4107         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4108         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4109         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4110         16  PB-I-OB-FLAG                 PIC X.
  4111             88  PB-I-OB                      VALUE 'B'.
  4112             88  PB-I-SUMMARY                 VALUE 'Z'.
  4113         16  PB-I-ENTRY-STATUS            PIC X.
  4114             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4115                                              'M' '5' '9' '2'.
  4116             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4117             88  PB-I-POLICY-PENDING          VALUE '2'.
  4118             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4119             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4120             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4121             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4122             88  PB-I-REIN-ONLY               VALUE '9'.
  4123             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4124             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4125             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4126             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4127         16  PB-I-INT-CODE                PIC X.
  4128             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4129             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4130         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4131         16  PB-I-SOC-SEC-NO              PIC X(11).
  4132         16  PB-I-MEMBER-NO               PIC X(12).
  4133         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4134*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4135         16  PB-I-OLD-LOF                 PIC XXX.
  4136         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4137         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4138         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4139         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4140         16  PB-I-LIFE-INDICATOR          PIC X.
  4141             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4142         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4143         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4144                                          PIC S9(5)V99    COMP-3.
  4145         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4146             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4147             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4148         16  PB-I-1ST-PMT-DT              PIC XX.
  4149         16  PB-I-JOINT-INSURED.
  4150             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4151             20 PB-I-JOINT-FIRST-NAME.
  4152                24  PB-I-JOINT-FIRST-INIT PIC X.
  4153                24  FILLER                PIC X(9).
  4154             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4155*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4156         16  PB-I-BENEFICIARY-NAME.
  4157             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  78
* EL050.cbl
  4158             20  FILLER                   PIC X(15).
  4159         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4160         16  PB-I-REFERENCE               PIC X(12).
  4161         16  FILLER REDEFINES PB-I-REFERENCE.
  4162             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4163             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4164             20  PB-I-CLP-STATE           PIC XX.
  4165         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4166             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4167             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4168             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4169         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4170         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4171         16  PB-I-RESIDENT-STATE          PIC XX.
  4172         16  PB-I-RATE-CODE               PIC X(4).
  4173         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4174         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4175         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4176         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4177         16  PB-I-BANK-NOCHRGB            PIC 99.
  4178         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4179         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4180
  4181     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4182         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4183             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4184         16  PB-C-CANCEL-ORIGIN           PIC X.
  4185             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4186         16  PB-C-LF-CANCEL-DT            PIC XX.
  4187         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4188         16  PB-C-LF-CALC-REQ             PIC X.
  4189             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4190         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4191         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4192         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4193             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4194         16  PB-C-AH-CANCEL-DT            PIC XX.
  4195         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4196         16  PB-C-AH-CALC-REQ             PIC X.
  4197             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4198         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4199         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4200         16  PB-C-LAST-NAME               PIC X(15).
  4201         16  PB-C-REFUND-SW               PIC X.
  4202             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4203             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4204         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4205         16  PB-C-PAYEE-CODE              PIC X(6).
  4206         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4207         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4208         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4209         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4210         16  PB-C-REFERENCE               PIC X(12).
  4211         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4212         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4213         16  PB-C-POST-CARD-IND           PIC X.
  4214         16  PB-C-CANCEL-REASON           PIC X.
  4215         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  79
* EL050.cbl
  4216         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4217         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4218         16  FILLER                       PIC X(01).
  4219*        16  FILLER                       PIC X(18).
  4220         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4221*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4222         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4223         16  PB-CANCELED-CERT-DATA.
  4224             20  PB-CI-INSURED-NAME.
  4225                 24  PB-CI-LAST-NAME      PIC X(15).
  4226                 24  PB-CI-INITIALS       PIC XX.
  4227             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4228             20  PB-CI-INSURED-SEX        PIC X.
  4229             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4230             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4231             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4232             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4233             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4234             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4235             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4236             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4237             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4238             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4239             20  PB-CI-RATE-CLASS         PIC XX.
  4240             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4241             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4242             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4243             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4244             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4245             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4246             20  PB-CI-LF-ABBR            PIC X(3).
  4247             20  PB-CI-AH-ABBR            PIC X(3).
  4248             20  PB-CI-OB-FLAG            PIC X.
  4249                 88  PB-CI-OB                VALUE 'B'.
  4250             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4251                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4252                                           'M' '4' '5' '9' '2'.
  4253                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4254                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4255                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4256                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4257                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4258                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4259                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4260                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4261                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4262                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4263                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4264                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4265                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4266             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4267                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4268                                           'M' '4' '5' '9' '2'.
  4269                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4270                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4271                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4272                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4273                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  80
* EL050.cbl
  4274                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4275                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4276                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4277                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4278                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4279                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4280                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4281                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4282             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4283             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4284             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4285             20  PB-CI-MEMBER-NO          PIC X(12).
  4286             20  PB-CI-INT-CODE           PIC X.
  4287                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4288                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4289             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4290             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4291             20  PB-CI-COMP-EXCP-SW       PIC X.
  4292                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4293                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4294             20  PB-CI-ENTRY-STATUS       PIC X.
  4295             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4296             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4297             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4298             20  PB-CI-DEATH-DT           PIC XX.
  4299             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4300             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4301             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4302             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4303             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4304             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4305             20  PB-CI-ENTRY-DT              PIC XX.
  4306             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4307             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4308             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4309             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4310             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4311             20  PB-CI-OLD-LOF               PIC XXX.
  4312*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4313             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4314             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4315             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4316             20  PB-CI-INDV-GRP-CD           PIC X.
  4317             20  PB-CI-BENEFICIARY-NAME.
  4318                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4319                 24  FILLER                  PIC X(15).
  4320             20  PB-CI-NOTE-SW               PIC X.
  4321             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4322             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4323             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4324             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4325             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4326             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4327             20  PB-CI-FIRST-NAME            PIC X(10).
  4328             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4329
  4330         16  FILLER                       PIC X(13).
  4331*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  81
* EL050.cbl
  4332*        16  FILLER                       PIC X(46).
  4333
  4334     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4335         16  FILLER                       PIC X(10).
  4336         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4337         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4338         16  PB-M-INSURED-MID-INIT        PIC X.
  4339         16  PB-M-INSURED-AGE             PIC 99.
  4340         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4341         16  PB-M-INSURED-SEX             PIC X.
  4342         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4343         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4344         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4345         16  PB-M-INSURED-CITY-STATE.
  4346             20  PB-M-INSURED-CITY        PIC X(28).
  4347             20  PB-M-INSURED-STATE       PIC XX.
  4348         16  PB-M-INSURED-ZIP-CODE.
  4349             20  PB-M-INSURED-ZIP-PRIME.
  4350                 24  PB-M-INSURED-ZIP-1   PIC X.
  4351                     88  PB-M-CANADIAN-POST-CODE
  4352                                             VALUE 'A' THRU 'Z'.
  4353                 24  FILLER               PIC X(4).
  4354             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4355         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4356                                        PB-M-INSURED-ZIP-CODE.
  4357             20  PM-M-INS-CAN-POST1       PIC XXX.
  4358             20  PM-M-INS-CAN-POST2       PIC XXX.
  4359             20  FILLER                   PIC XXX.
  4360         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4361         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4362         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4363         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4364         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4365         16  PB-M-CRED-BENE-CITYST.
  4366             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4367             20  PB-M-CRED-BENE-STATE     PIC XX.
  4368         16  FILLER                       PIC X(92).
  4369
  4370     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4371         16  FILLER                       PIC X(10).
  4372         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4373         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4374         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4375         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4376         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4377         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4378         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4379         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4380         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4381         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4382         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4383         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4384         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4385         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4386         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4387         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4388         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4389         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  82
* EL050.cbl
  4390         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4391         16  PB-REFERENCE                 PIC X(12).
  4392         16  PB-B-RECEIVED-DT             PIC XX.
  4393         16  FILLER                       PIC X(234).
  4394
  4395     12  PB-RECORD-STATUS.
  4396         16  PB-CREDIT-SELECT-DT          PIC XX.
  4397         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4398         16  PB-BILLED-DT                 PIC XX.
  4399         16  PB-BILLING-STATUS            PIC X.
  4400             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4401             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4402             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4403         16  PB-RECORD-BILL               PIC X.
  4404             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4405             88  PB-RECORD-RETURNED           VALUE 'R'.
  4406             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4407             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4408             88  PB-OVERRIDE-AH               VALUE 'A'.
  4409             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4410         16  PB-BATCH-ENTRY               PIC X.
  4411             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4412             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4413             88  PB-REISSUED-CERT             VALUE 'E'.
  4414             88  PB-CASH-CERT                 VALUE 'C'.
  4415             88  PB-MONTHLY-CERT              VALUE 'M'.
  4416             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4417             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4418             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4419         16  PB-FORCE-CODE                PIC X.
  4420             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4421             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4422             88  PB-CANCEL-FORCE              VALUE '8'.
  4423             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4424             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4425             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4426             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4427             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4428             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4429             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4430         16  PB-FATAL-FLAG                PIC X.
  4431             88  PB-FATAL-ERRORS              VALUE 'X'.
  4432         16  PB-FORCE-ER-CD               PIC X.
  4433             88  PB-FORCE-ERRORS              VALUE 'F'.
  4434             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4435         16  PB-WARN-ER-CD                PIC X.
  4436             88  PB-WARNING-ERRORS            VALUE 'W'.
  4437         16  FILLER                       PIC X.
  4438         16  PB-OUT-BAL-CD                PIC X.
  4439             88  PB-OUT-OF-BAL                VALUE 'O'.
  4440         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4441         16  PB-AH-OVERRIDE-L1            PIC X.
  4442         16  PB-INPUT-DT                  PIC XX.
  4443         16  PB-INPUT-BY                  PIC X(4).
  4444         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4445         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4446         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4447         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  83
* EL050.cbl
  4448         16  PB-AH-EARNING-METHOD         PIC X.
  4449         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4450         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4451         16  PB-REIN-CD                   PIC XXX.
  4452         16  PB-LF-REFUND-TYPE            PIC X.
  4453         16  PB-AH-REFUND-TYPE            PIC X.
  4454         16  PB-ACCT-EFF-DT               PIC XX.
  4455         16  PB-ACCT-EXP-DT               PIC XX.
  4456         16  PB-COMPANY-ID                PIC X(3).
  4457         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4458         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4459         16  PB-SV-CARRIER                PIC X.
  4460         16  PB-SV-GROUPING               PIC X(6).
  4461         16  PB-SV-STATE                  PIC XX.
  4462         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4463         16  PB-GA-BILLING-INFO.
  4464             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4465                                          PIC XX.
  4466         16  PB-SV-REMIT-TO  REDEFINES
  4467             PB-GA-BILLING-INFO           PIC X(10).
  4468         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4469         16  PB-I-LOAN-OFFICER            PIC X(5).
  4470         16  PB-I-VIN                     PIC X(17).
  4471
  4472         16  FILLER                       PIC X(04).
  4473         16  IMNET-BYPASS-SW              PIC X.
  4474
  4475******************************************************************
  4476*                COMMON EDIT ERRORS                              *
  4477******************************************************************
  4478
  4479     12  PB-COMMON-ERRORS.
  4480         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4481                                           PIC S9(4)     COMP.
  4482
  4483******************************************************************
  4484
  4485* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4486*    COPY ELC50W1.
  4487******************************************************************
  4488*                                                                *
  4489*                                                                *
  4490*                             ELC50W1                            *
  4491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4492*                            VMOD=2.004                          *
  4493*                                                                *
  4494*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4495*                                                                *
  4496*                                                                *
  4497******************************************************************
  4498
  4499     12  WK-WORK-AREA.
  4500         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4501         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4502         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4503         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4504         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4505         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  84
* EL050.cbl
  4506         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4507         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4508         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4509         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4510         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4511         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4512         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4513         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4514         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4515         16  WK-CREDIT-EDIT-CONTROLS.
  4516             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4517             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4518             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4519             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4520             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4521             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4522         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4523         16  WK-SAVE-REIN-DATA.
  4524             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4525             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4526             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4527         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4528             88  ENTRY-FROM-EL6311       VALUE '6'.
  4529         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4530         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4531     12  WK-RECORD-ADDRESSES.
  4532         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4533         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4534         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4535         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4536         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4537         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4538         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4539         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4540     12  WK-OVER-SHORT-AREA.
  4541         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4542         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4543         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4544             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4545         16  FILLER                   PIC X(5) VALUE SPACES.
  4546
  4547*    COPY ELCEDITC.
  4548******************************************************************
  4549*                                                                *
  4550*                                                                *
  4551*                            ELCEDITC                            *
  4552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4553*                            VMOD=2.012                          *
  4554*                                                                *
  4555*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4556*                     EL6313, EL050 AND EL517.                   *
  4557*                                                                *
  4558******************************************************************
  4559******************************************************************
  4560*                   C H A N G E   L O G
  4561*
  4562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4563*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  85
* EL050.cbl
  4564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4565* EFFECTIVE    NUMBER
  4566*-----------------------------------------------------------------
  4567* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4568******************************************************************
  4569
  4570     12  EDIT-CRITERIA-DATA.
  4571         16  EC-CO-MONTH-END-DT       PIC XX.
  4572         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4573         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4574         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4575         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4576         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4577         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4578         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4579         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4580         16  EC-CO-REM-TERM-CALC      PIC X.
  4581               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4582               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4583               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4584               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4585
  4586         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4587               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4588               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4589               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4590               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4591               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4592               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4593               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4594               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4595               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4596               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4597
  4598         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4599               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4600               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4601               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4602               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4603               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4604               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4605               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4606               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4607
  4608         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4609                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4610                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4611
  4612         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4613                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4614                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4615                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4616                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4617                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4618                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4619                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4620                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4621
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  86
* EL050.cbl
  4622         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4623               88  EC-BR-REDUCING                   VALUE 'R'.
  4624               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4625
  4626         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4627         16  EC-BR-LF-DESC             PIC X(10).
  4628         16  EC-BR-AH-DESC             PIC X(10).
  4629         16  EC-BR-LF-COMMENT          PIC X(10).
  4630         16  EC-BR-AH-COMMENT          PIC X(10).
  4631
  4632         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4633               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4634               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4635               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4636               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4637
  4638         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4639               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4640               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4641               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4642               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4643
  4644         16  EC-BR-LF-REFUND-CALC      PIC X.
  4645                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4646                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4647                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4648                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4649                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4650                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4651                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4652
  4653         16  EC-BR-AH-REFUND-CALC      PIC X.
  4654                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4655                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4656                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4657                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4658                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4659                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4660                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4661                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4662
  4663         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4664                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4665                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4666                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4667
  4668         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4669                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4670                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4671                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4672
  4673         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4674         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4675         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4676         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4677
  4678         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4679         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  87
* EL050.cbl
  4680                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4681                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4682                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4683                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4684
  4685         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4686               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4687               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4688               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4689               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4690               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4691
  4692         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4693               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4694               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4695               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4696               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4697               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4698
  4699         16  EC-ST-LF-REFUND-CALC      PIC X.
  4700                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4701                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4702                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4703                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4704                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4705                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4706                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4707                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4708
  4709         16  EC-ST-AH-REFUND-CALC      PIC X.
  4710                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4711                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4712                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4713                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4714                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4715                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4716                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4717                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4718
  4719         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4720         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4721         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4722         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4723         16  EC-AM-EXPIRATION-DT       PIC XX.
  4724         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4725         16  EC-AM-CLASS-CD            PIC XX.
  4726         16  EC-AM-LF-DEVIATION        PIC XXX.
  4727         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4728         16  EC-AM-AH-DEVIATION        PIC XXX.
  4729         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4730         16  EC-AM-PHONE-NO            PIC X(10).
  4731
  4732         16  EC-AM-LF-REFUND-CALC      PIC X.
  4733                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4734                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4735                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4736                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4737                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  88
* EL050.cbl
  4738                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4739                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4740
  4741         16  EC-AM-AH-REFUND-CALC      PIC X.
  4742                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4743                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4744                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4745                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4746                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4747                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4748                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4749
  4750         16  EC-AM-BEN-I-G-CD          PIC X.
  4751                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4752                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4753                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4754
  4755         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4756         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4757         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4758         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4759         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4760         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4761         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4762         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4763         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4764
  4765         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4766         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4767         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4768         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4769         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4770         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4771         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4772         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4773         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4774         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4775         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4776         16  EC-RT-LF-NSP-ST           PIC XX.
  4777         16  EC-RT-AH-NSP-ST           PIC XX.
  4778         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4779         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4780
  4781         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4782             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4783                                             'M' '5' '9' '2'.
  4784             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4785             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4786             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4787             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4788             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4789             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4790             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4791             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4792             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4793             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4794
  4795         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  89
* EL050.cbl
  4796             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4797                                             'M' '5' '9' '2'.
  4798             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4799             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4800             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4801             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4802             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4803             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4804             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4805             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4806             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4807             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4808
  4809         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4810         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4811         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4812         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4813         16  EC-CM-DEATH-DT            PIC XX.
  4814
  4815*DMD CUSTOM CODING FIELDS BELOW
  4816*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4817         16  EC-BR-DMD-RATING-SW       PIC X.
  4818                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4819                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4820                 88  NO-DMD-RATING               VALUE 'N'.
  4821
  4822         16  EC-NEW-CERT               PIC X(11).
  4823         16  EC-NEW-STATE              PIC XX.
  4824         16  FILLER                    PIC X.
  4825*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4826         16  OVER-SHORT-EDIT-FIELDS.
  4827             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4828             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4829             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4830             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4831             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4832             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4833             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4834             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4835             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4836         16  FILLER                    PIC X(71).
  4837******************************************************************
  4838
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  90
* EL050.cbl
  4840*    COPY ELCDIFRD.
  4841******************************************************************
  4842*                                                                *
  4843*                                                                *
  4844*                            ELCDIFRD.                           *
  4845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4846*                            VMOD=2.004                          *
  4847*                                                                *
  4848*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4849*                                                                *
  4850******************************************************************
  4851*
  4852  01  WS-DIFFERENCE-CALCULATION.
  4853        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4854        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4855        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4856        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4857        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4858        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4859        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4860        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4861        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4862        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4863        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4864
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  91
* EL050.cbl
  4866****************************************************************
  4867*
  4868* Copyright (c) 2007 by Clerity Solutions, Inc.
  4869* All rights reserved.
  4870*
  4871****************************************************************
  4872 01  DFHEIV.
  4873   02  DFHEIV0               PIC X(35).
  4874   02  DFHEIV1               PIC X(08).
  4875   02  DFHEIV2               PIC X(08).
  4876   02  DFHEIV3               PIC X(08).
  4877   02  DFHEIV4               PIC X(06).
  4878   02  DFHEIV5               PIC X(04).
  4879   02  DFHEIV6               PIC X(04).
  4880   02  DFHEIV7               PIC X(02).
  4881   02  DFHEIV8               PIC X(02).
  4882   02  DFHEIV9               PIC X(01).
  4883   02  DFHEIV10              PIC S9(7) COMP-3.
  4884   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4885   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4886   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4887   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4888   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4889   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4890   02  DFHEIV17              PIC X(04).
  4891   02  DFHEIV18              PIC X(04).
  4892   02  DFHEIV19              PIC X(04).
  4893   02  DFHEIV20              USAGE IS POINTER.
  4894   02  DFHEIV21              USAGE IS POINTER.
  4895   02  DFHEIV22              USAGE IS POINTER.
  4896   02  DFHEIV23              USAGE IS POINTER.
  4897   02  DFHEIV24              USAGE IS POINTER.
  4898   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4899   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4900   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4901   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4902   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4903   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4904   02  FILLER                PIC X(02).
  4905   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4906   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4907   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4908   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4909   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4910 LINKAGE  SECTION.
  4911*****************************************************************
  4912*                                                               *
  4913* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4914* All rights reserved.                                          *
  4915*                                                               *
  4916*****************************************************************
  4917 01  dfheiblk.
  4918     02  eibtime          pic s9(7) comp-3.
  4919     02  eibdate          pic s9(7) comp-3.
  4920     02  eibtrnid         pic x(4).
  4921     02  eibtaskn         pic s9(7) comp-3.
  4922     02  eibtrmid         pic x(4).
  4923     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  92
* EL050.cbl
  4924     02  eibcposn         pic s9(4) comp.
  4925     02  eibcalen         pic s9(4) comp.
  4926     02  eibaid           pic x(1).
  4927     02  eibfiller1       pic x(1).
  4928     02  eibfn            pic x(2).
  4929     02  eibfiller2       pic x(2).
  4930     02  eibrcode         pic x(6).
  4931     02  eibfiller3       pic x(2).
  4932     02  eibds            pic x(8).
  4933     02  eibreqid         pic x(8).
  4934     02  eibrsrce         pic x(8).
  4935     02  eibsync          pic x(1).
  4936     02  eibfree          pic x(1).
  4937     02  eibrecv          pic x(1).
  4938     02  eibsend          pic x(1).
  4939     02  eibatt           pic x(1).
  4940     02  eibeoc           pic x(1).
  4941     02  eibfmh           pic x(1).
  4942     02  eibcompl         pic x(1).
  4943     02  eibsig           pic x(1).
  4944     02  eibconf          pic x(1).
  4945     02  eiberr           pic x(1).
  4946     02  eibrldbk         pic x(1).
  4947     02  eiberrcd         pic x(4).
  4948     02  eibsynrb         pic x(1).
  4949     02  eibnodat         pic x(1).
  4950     02  eibfiller5       pic x(2).
  4951     02  eibresp          pic 9(09) comp.
  4952     02  eibresp2         pic 9(09) comp.
  4953     02  dfheigdj         pic s9(4) comp.
  4954     02  dfheigdk         pic s9(4) comp.
  4955
  4956 01  DFHCOMMAREA                   PIC X(1036).
  4957
  4958*01 PARMLIST .
  4959*    02  FILLER                    PIC S9(8)   COMP.
  4960*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4961*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4962*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4963*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4964*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4965*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4966*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4967
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  93
* EL050.cbl
  4969*    COPY ELCCNTL.
  4970******************************************************************
  4971*                                                                *
  4972*                                                                *
  4973*                            ELCCNTL.                            *
  4974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4975*                            VMOD=2.059                          *
  4976*                                                                *
  4977*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4978*                                                                *
  4979*   FILE TYPE = VSAM,KSDS                                        *
  4980*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4981*                                                                *
  4982*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4983*       ALTERNATE INDEX = NONE                                   *
  4984*                                                                *
  4985*   LOG = YES                                                    *
  4986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4987******************************************************************
  4988*                   C H A N G E   L O G
  4989*
  4990* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4991*-----------------------------------------------------------------
  4992*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4993* EFFECTIVE    NUMBER
  4994*-----------------------------------------------------------------
  4995* 082503                   PEMA  ADD BENEFIT GROUP
  4996* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4997* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4998* 092705    2005050300006  PEMA  ADD SPP LEASES
  4999* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5000* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5001* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5002* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5003* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5004* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5005* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5006* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5007* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5008* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5009******************************************************************
  5010*
  5011 01  CONTROL-FILE.
  5012     12  CF-RECORD-ID                       PIC XX.
  5013         88  VALID-CF-ID                        VALUE 'CF'.
  5014
  5015     12  CF-CONTROL-PRIMARY.
  5016         16  CF-COMPANY-ID                  PIC XXX.
  5017         16  CF-RECORD-TYPE                 PIC X.
  5018             88  CF-COMPANY-MASTER              VALUE '1'.
  5019             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5020             88  CF-STATE-MASTER                VALUE '3'.
  5021             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5022             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5023             88  CF-CARRIER-MASTER              VALUE '6'.
  5024             88  CF-MORTALITY-MASTER            VALUE '7'.
  5025             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5026             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  94
* EL050.cbl
  5027             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5028             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5029             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5030             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5031             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5032             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5033             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5034             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5035             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5036         16  CF-ACCESS-CD-GENL              PIC X(4).
  5037         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5038             20  CF-PROCESSOR               PIC X(4).
  5039         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5040             20  CF-STATE-CODE              PIC XX.
  5041             20  FILLER                     PIC XX.
  5042         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5043             20  FILLER                     PIC XX.
  5044             20  CF-HI-BEN-IN-REC           PIC XX.
  5045         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5046             20  FILLER                     PIC XXX.
  5047             20  CF-CARRIER-CNTL            PIC X.
  5048         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5049             20  FILLER                     PIC XX.
  5050             20  CF-HI-TYPE-IN-REC          PIC 99.
  5051         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5052             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5053                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5054             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5055             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5056         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5057             20  FILLER                     PIC X.
  5058             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5059         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5060             20  FILLER                     PIC XX.
  5061             20  CF-MORTGAGE-PLAN           PIC XX.
  5062         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5063
  5064     12  CF-LAST-MAINT-DT                   PIC XX.
  5065     12  CF-LAST-MAINT-BY                   PIC X(4).
  5066     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5067
  5068     12  CF-RECORD-BODY                     PIC X(728).
  5069
  5070
  5071****************************************************************
  5072*             COMPANY MASTER RECORD                            *
  5073****************************************************************
  5074
  5075     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5076         16  CF-COMPANY-ADDRESS.
  5077             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5078             20  CF-CL-IN-CARE-OF           PIC X(30).
  5079             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5080             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5081             20  CF-CL-CITY-STATE           PIC X(30).
  5082             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5083             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5084         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  95
* EL050.cbl
  5085         16  CF-COMPANY-PASSWORD            PIC X(8).
  5086         16  CF-SECURITY-OPTION             PIC X.
  5087             88  ALL-SECURITY                   VALUE '1'.
  5088             88  COMPANY-VERIFY                 VALUE '2'.
  5089             88  PROCESSOR-VERIFY               VALUE '3'.
  5090             88  NO-SECURITY                    VALUE '4'.
  5091             88  ALL-BUT-TERM                   VALUE '5'.
  5092         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5093             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5094         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5095             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5096         16  CF-INFORCE-LOCATION            PIC X.
  5097             88  CERTS-ARE-ONLINE               VALUE '1'.
  5098             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5099             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5100         16  CF-LOWER-CASE-LETTERS          PIC X.
  5101         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5102             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5103             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5104             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5105             88  CF-ACCNT-CNTL                  VALUE '3'.
  5106             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5107
  5108         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5109         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5110
  5111         16  CF-LGX-CREDIT-USER             PIC X.
  5112             88  CO-IS-NOT-USER                 VALUE 'N'.
  5113             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5114
  5115         16 CF-CREDIT-CALC-CODES.
  5116             20  CF-CR-REM-TERM-CALC PIC X.
  5117               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5118               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5119               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5120               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5121               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5122               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5123               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5124             20  CF-CR-R78-METHOD           PIC X.
  5125               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5126               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5127
  5128         16  CF-CLAIM-CONTROL-COUNTS.
  5129             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5130                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5131
  5132             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5133                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5134
  5135             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5136                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5137
  5138             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5139                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5140
  5141         16  CF-CURRENT-MONTH-END           PIC XX.
  5142
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  96
* EL050.cbl
  5143         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5144             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5145             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5146             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5147             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5148                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5149                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5150             20  CF-CO-PREM-REJECT-SW       PIC X.
  5151                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5152                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5153             20  CF-CO-REF-REJECT-SW        PIC X.
  5154                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5155                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5156
  5157         16  CF-CO-REPORTING-DT             PIC XX.
  5158         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5159         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5160           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5161           88  CF-CO-MONTH-END                  VALUE '1'.
  5162
  5163         16  CF-LGX-CLAIM-USER              PIC X.
  5164             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5165             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5166
  5167         16  CF-CREDIT-EDIT-CONTROLS.
  5168             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5169             20  CF-MIN-AGE                 PIC 99.
  5170             20  CF-DEFAULT-AGE             PIC 99.
  5171             20  CF-MIN-TERM                PIC S999      COMP-3.
  5172             20  CF-MAX-TERM                PIC S999      COMP-3.
  5173             20  CF-DEFAULT-SEX             PIC X.
  5174             20  CF-JOINT-AGE-INPUT         PIC X.
  5175                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5176             20  CF-BIRTH-DATE-INPUT        PIC X.
  5177                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5178             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5179                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5180                 88  CF-ZERO-CARRIER            VALUE '1'.
  5181                 88  CF-ZERO-GROUPING           VALUE '2'.
  5182                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5183             20  CF-EDIT-SW                 PIC X.
  5184                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5185             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5186             20  CF-CR-PR-METHOD            PIC X.
  5187               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5188               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5189             20  FILLER                     PIC X.
  5190
  5191         16  CF-CREDIT-MISC-CONTROLS.
  5192             20  CF-REIN-TABLE-SW           PIC X.
  5193                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5194             20  CF-COMP-TABLE-SW           PIC X.
  5195                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5196             20  CF-EXPERIENCE-RETENTION-AGE
  5197                                            PIC S9        COMP-3.
  5198             20  CF-CONVERSION-DT           PIC XX.
  5199             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5200             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  97
* EL050.cbl
  5201                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5202                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5203
  5204             20  CF-CR-CHECK-NO-CONTROL.
  5205                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5206                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5207                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5208                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5209                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5210                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5211
  5212                 24  CF-CR-CHECK-COUNT       REDEFINES
  5213                     CF-CR-CHECK-COUNTER      PIC X(4).
  5214
  5215                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5216                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5217
  5218                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5219                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5220                 24  CF-MAIL-PROCESSING       PIC X.
  5221                     88  MAIL-PROCESSING          VALUE 'Y'.
  5222
  5223         16  CF-MISC-SYSTEM-CONTROL.
  5224             20  CF-SYSTEM-C                 PIC X.
  5225                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5226             20  CF-SYSTEM-D                 PIC X.
  5227                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5228             20  CF-SOC-SEC-NO-SW            PIC X.
  5229                 88  SOC-SEC-NO-USED             VALUE '1'.
  5230             20  CF-MEMBER-NO-SW             PIC X.
  5231                 88  MEMBER-NO-USED              VALUE '1'.
  5232             20  CF-TAX-ID-NUMBER            PIC X(11).
  5233             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5234             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5235                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5236                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5237                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5238                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5239             20  CF-SYSTEM-E                 PIC X.
  5240                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5241
  5242         16  CF-LGX-LIFE-USER               PIC X.
  5243             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5244             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5245
  5246         16  CF-CR-MONTH-END-DT             PIC XX.
  5247
  5248         16  CF-FILE-MAINT-DATES.
  5249             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5250                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5251             20  CF-LAST-BATCH       REDEFINES
  5252                 CF-LAST-BATCH-NO               PIC X(4).
  5253             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5254             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5255             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5256             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5257             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5258             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  98
* EL050.cbl
  5259             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5260             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5261             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5262             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5263
  5264         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5265         16  FILLER                         PIC X.
  5266
  5267         16  CF-ALT-MORT-CODE               PIC X(4).
  5268         16  CF-MEMBER-CAPTION              PIC X(10).
  5269
  5270         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5271             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5272             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5273             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5274             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5275             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5276
  5277         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5278
  5279         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5280         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5281         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5282         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5283
  5284         16  CF-AH-OVERRIDE-L1              PIC X.
  5285         16  CF-AH-OVERRIDE-L2              PIC XX.
  5286         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5287         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5288
  5289         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5290         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5291
  5292         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5293         16  CF-AR-LAST-EL860-DT            PIC XX.
  5294         16  CF-MP-MONTH-END-DT             PIC XX.
  5295
  5296         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5297         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5298             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5299
  5300         16  CF-AR-MONTH-END-DT             PIC XX.
  5301
  5302         16  CF-CRDTCRD-USER                PIC X.
  5303             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5304             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5305
  5306         16  CF-CC-MONTH-END-DT             PIC XX.
  5307
  5308         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5309
  5310         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5311             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5312             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5313             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5314         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5315         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5316         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page  99
* EL050.cbl
  5317         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5318             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5319             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5320         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5321         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5322         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5323             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5324         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5325
  5326         16  CF-CL-ZIP-CODE.
  5327             20  CF-CL-ZIP-PRIME.
  5328                 24  CF-CL-ZIP-1ST          PIC X.
  5329                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5330                 24  FILLER                 PIC X(4).
  5331             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5332         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5333             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5334             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5335             20  FILLER                     PIC XXX.
  5336
  5337         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5338         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5339         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5340         16  CF-CO-OPTION-START-DATE        PIC XX.
  5341         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5342           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5343                                                      '3' '4'.
  5344           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5345           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5346           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5347           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5348           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5349           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5350
  5351         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5352
  5353         16  CF-PAYMENT-APPROVAL-LEVELS.
  5354             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5355             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5356             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5357             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5358             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5359             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5360
  5361         16  CF-END-USER-REPORTING-USER     PIC X.
  5362             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5363             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5364
  5365         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5366             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5367             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5368
  5369         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5370
  5371         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5372         16  FILLER                         PIC X.
  5373
  5374         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 100
* EL050.cbl
  5375             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5376             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5377             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5378
  5379         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5380
  5381         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5382             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5383             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5384
  5385         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5386             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5387             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5388
  5389         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5390
  5391         16  CF-CO-ACH-ID-CODE              PIC  X.
  5392             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5393             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5394             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5395         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5396         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5397         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5398         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5399         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5400         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5401         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5402         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5403         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5404                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5405         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5406                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5407
  5408         16  CF-CO-OVER-SHORT.
  5409             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5410             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5411
  5412*         16  FILLER                         PIC X(102).
  5413         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5414             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5415             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5416
  5417         16  CF-AH-APPROVAL-DAYS.
  5418             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5419             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5420             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5421             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5422
  5423         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5424
  5425         16  CF-APPROV-LEV-5.
  5426             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5427             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5428             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5429
  5430         16  FILLER                         PIC X(68).
  5431****************************************************************
  5432*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 101
* EL050.cbl
  5433****************************************************************
  5434
  5435     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5436         16  CF-PROCESSOR-NAME              PIC X(30).
  5437         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5438         16  CF-PROCESSOR-TITLE             PIC X(26).
  5439         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5440                 88  MESSAGE-YES                VALUE 'Y'.
  5441                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5442
  5443*****************************************************
  5444****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5445****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5446****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5447****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5448*****************************************************
  5449
  5450         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5451             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5452             20  CF-APPLICATION-FORCE       PIC X.
  5453             20  CF-INDIVIDUAL-APP.
  5454                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5455                     28  CF-BROWSE-APP      PIC X.
  5456                     28  CF-UPDATE-APP      PIC X.
  5457
  5458         16  CF-CURRENT-TERM-ON             PIC X(4).
  5459         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5460             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5461             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5462             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5463             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5464             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5465             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5466             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5467         16  CF-PROCESSOR-CARRIER           PIC X.
  5468             88  NO-CARRIER-SECURITY            VALUE ' '.
  5469         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5470             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5471         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5472             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5473         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5474             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5475
  5476         16  CF-PROC-SYS-ACCESS-SW.
  5477             20  CF-PROC-CREDIT-CLAIMS-SW.
  5478                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5479                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5480                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5481                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5482             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5483                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5484                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5485             20  CF-PROC-LIFE-GNRLDGR-SW.
  5486                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5487                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5488                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5489                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5490             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 102
* EL050.cbl
  5491                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5492                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5493         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5494             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5495             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5496         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5497
  5498         16  CF-APPROVAL-LEVEL                  PIC X.
  5499             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5500             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5501             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5502             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5503             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5504
  5505         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5506
  5507         16  CF-LANGUAGE-TYPE                   PIC X.
  5508             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5509             88  CF-LANG-IS-FR                      VALUE 'F'.
  5510
  5511         16  CF-CSR-IND                         PIC X.
  5512         16  FILLER                             PIC X(239).
  5513
  5514****************************************************************
  5515*             PROCESSOR/REMINDERS RECORD                       *
  5516****************************************************************
  5517
  5518     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5519         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5520             20  CF-START-REMIND-DT         PIC XX.
  5521             20  CF-END-REMIND-DT           PIC XX.
  5522             20  CF-REMINDER-TEXT           PIC X(50).
  5523         16  FILLER                         PIC X(296).
  5524
  5525
  5526****************************************************************
  5527*             STATE MASTER RECORD                              *
  5528****************************************************************
  5529
  5530     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5531         16  CF-STATE-ABBREVIATION          PIC XX.
  5532         16  CF-STATE-NAME                  PIC X(25).
  5533         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5534         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5535             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5536             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5537             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5538             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5539                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5540                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5541             20  CF-ST-PREM-REJECT-SW       PIC X.
  5542                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5543                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5544             20  CF-ST-REF-REJECT-SW        PIC X.
  5545                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5546                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5547         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5548         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 103
* EL050.cbl
  5549         16  CF-ST-REFUND-RULES.
  5550             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5551             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5552             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5553         16  CF-ST-FST-PMT-EXTENSION.
  5554             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5555             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5556                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5557                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5558                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5559                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5560         16  CF-ST-STATE-CALL.
  5561             20  CF-ST-CALL-UNEARNED        PIC X.
  5562             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5563             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5564         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5565             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5566             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5567         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5568         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5569         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5570         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5571         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5572         16  FILLER                         PIC X.
  5573         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5574             20  CF-ST-BENEFIT-CD           PIC XX.
  5575             20  CF-ST-BENEFIT-KIND         PIC X.
  5576                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5577                 88  CF-ST-AH-KIND              VALUE 'A'.
  5578             20  CF-ST-REM-TERM-CALC        PIC X.
  5579                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5580                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5581                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5582                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5583                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5584                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5585                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5586                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5587
  5588             20  CF-ST-REFUND-CALC          PIC X.
  5589                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5590                 88  ST-REFD-BY-R78             VALUE '1'.
  5591                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5592                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5593                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5594                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5595                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5596                 88  ST-REFD-UTAH               VALUE '7'.
  5597                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5598                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5599                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5600
  5601             20  CF-ST-EARNING-CALC         PIC X.
  5602                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5603                 88  ST-EARN-BY-R78             VALUE '1'.
  5604                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5605                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5606                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 104
* EL050.cbl
  5607                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5608                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5609                 88  ST-EARN-MEAN               VALUE '8'.
  5610                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5611
  5612             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5613                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5614                 88  ST-OVRD-BY-R78             VALUE '1'.
  5615                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5616                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5617                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5618                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5619                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5620                 88  ST-OVRD-MEAN               VALUE '8'.
  5621                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5622             20  FILLER                     PIC X.
  5623
  5624         16  CF-ST-COMMISSION-CAPS.
  5625             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5626             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5627             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5628             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5629         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5630                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5631
  5632         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5633
  5634         16  CF-ST-STATUTORY-INTEREST.
  5635             20  CF-ST-STAT-DATE-FROM       PIC X.
  5636                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5637                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5638             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5639             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5640             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5641             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5642             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5643
  5644         16  CF-ST-OVER-SHORT.
  5645             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5646             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5647
  5648         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5649
  5650         16  CF-ST-RT-CALC                  PIC X.
  5651
  5652         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5653         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5654         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5655         16  CF-ST-RF-LR-CALC               PIC X.
  5656         16  CF-ST-RF-LL-CALC               PIC X.
  5657         16  CF-ST-RF-LN-CALC               PIC X.
  5658         16  CF-ST-RF-AH-CALC               PIC X.
  5659         16  CF-ST-RF-CP-CALC               PIC X.
  5660*        16  FILLER                         PIC X(206).
  5661*CIDMOD         16  FILLER                         PIC X(192).
  5662         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5663             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5664         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 105
* EL050.cbl
  5665         16  CF-ST-VFY-2ND-BENE             PIC X.
  5666         16  CF-ST-CAUSAL-STATE             PIC X.
  5667         16  FILLER                         PIC X(185).
  5668
  5669****************************************************************
  5670*             BENEFIT MASTER RECORD                            *
  5671****************************************************************
  5672
  5673     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5674         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5675             20  CF-BENEFIT-CODE            PIC XX.
  5676             20  CF-BENEFIT-NUMERIC  REDEFINES
  5677                 CF-BENEFIT-CODE            PIC XX.
  5678             20  CF-BENEFIT-ALPHA           PIC XXX.
  5679             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5680             20  CF-BENEFIT-COMMENT         PIC X(10).
  5681
  5682             20  CF-LF-COVERAGE-TYPE        PIC X.
  5683                 88  CF-REDUCING                VALUE 'R'.
  5684                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5685
  5686             20  CF-SPECIAL-CALC-CD         PIC X.
  5687                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5688                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5689                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5690                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5691                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5692                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5693                 88  CF-FARM-PLAN               VALUE 'F'.
  5694                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5695                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5696                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5697                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5698                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5699                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5700                 88  CF-PRUDENTIAL              VALUE 'P'.
  5701                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5702                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5703                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5704                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5705                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5706                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5707
  5708             20  CF-JOINT-INDICATOR         PIC X.
  5709                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5710
  5711*            20  FILLER                     PIC X(12).
  5712             20  cf-maximum-benefits        pic s999 comp-3.
  5713             20  FILLER                     PIC X(09).
  5714             20  CF-BENEFIT-CATEGORY        PIC X.
  5715             20  CF-LOAN-TYPE               PIC X(8).
  5716
  5717             20  CF-CO-REM-TERM-CALC        PIC X.
  5718                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5719                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5720                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5721                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5722                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 106
* EL050.cbl
  5723
  5724             20  CF-CO-EARNINGS-CALC        PIC X.
  5725                 88  CO-EARN-BY-R78             VALUE '1'.
  5726                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5727                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5728                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5729                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5730                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5731                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5732                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5733
  5734             20  CF-CO-REFUND-CALC          PIC X.
  5735                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5736                 88  CO-REFD-BY-R78             VALUE '1'.
  5737                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5738                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5739                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5740                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5741                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5742                 88  CO-REFD-MEAN               VALUE '8'.
  5743                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5744                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5745                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5746
  5747             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5748                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5749                 88  CO-OVRD-BY-R78             VALUE '1'.
  5750                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5751                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5752                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5753                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5754                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5755                 88  CO-OVRD-MEAN               VALUE '8'.
  5756                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5757
  5758             20  CF-CO-BEN-I-G-CD           PIC X.
  5759                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5760                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5761                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5762
  5763         16  FILLER                         PIC X(304).
  5764
  5765
  5766****************************************************************
  5767*             CARRIER MASTER RECORD                            *
  5768****************************************************************
  5769
  5770     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5771         16  CF-ADDRESS-DATA.
  5772             20  CF-MAIL-TO-NAME            PIC X(30).
  5773             20  CF-IN-CARE-OF              PIC X(30).
  5774             20  CF-ADDRESS-LINE-1          PIC X(30).
  5775             20  CF-ADDRESS-LINE-2          PIC X(30).
  5776             20  CF-CITY-STATE              PIC X(30).
  5777             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5778             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5779
  5780         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 107
* EL050.cbl
  5781             20  CF-CLAIM-NO-METHOD         PIC X.
  5782                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5783                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5784                 88  CLAIM-NO-SEQ               VALUE '3'.
  5785                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5786             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5787                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5788                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5789                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5790
  5791         16  CF-CHECK-NO-CONTROL.
  5792             20  CF-CHECK-NO-METHOD         PIC X.
  5793                 88  CHECK-NO-MANUAL            VALUE '1'.
  5794                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5795                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5796                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5797             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5798                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5799
  5800         16  CF-DOMICILE-STATE              PIC XX.
  5801
  5802         16  CF-EXPENSE-CONTROLS.
  5803             20  CF-EXPENSE-METHOD          PIC X.
  5804                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5805                 88  DOLLARS-PER-PMT            VALUE '2'.
  5806                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5807                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5808             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5809             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5810
  5811         16  CF-CORRESPONDENCE-CONTROL.
  5812             20  CF-LETTER-RESEND-OPT       PIC X.
  5813                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5814                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5815             20  FILLER                     PIC X(4).
  5816
  5817         16  CF-RESERVE-CONTROLS.
  5818             20  CF-MANUAL-SW               PIC X.
  5819                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5820             20  CF-FUTURE-SW               PIC X.
  5821                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5822             20  CF-PTC-SW                  PIC X.
  5823                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5824             20  CF-IBNR-SW                 PIC X.
  5825                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5826             20  CF-PTC-LF-SW               PIC X.
  5827                 88  CF-LF-PTC-USED             VALUE '1'.
  5828             20  CF-CDT-ACCESS-METHOD       PIC X.
  5829                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5830                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5831                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5832             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5833
  5834         16  CF-CLAIM-CALC-METHOD           PIC X.
  5835             88  360-PLUS-MONTHS                VALUE '1'.
  5836             88  365-PLUS-MONTHS                VALUE '2'.
  5837             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5838             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 108
* EL050.cbl
  5839             88  365-DAILY                      VALUE '5'.
  5840
  5841         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5842         16  FILLER                         PIC X(11).
  5843
  5844         16  CF-LIMIT-AMOUNTS.
  5845             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5846             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5847             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5848             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5849             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5850             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5851             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5852             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5853             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5854             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5855
  5856         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5857         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5858         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5859
  5860         16  CF-ZIP-CODE.
  5861             20  CF-ZIP-PRIME.
  5862                 24  CF-ZIP-1ST             PIC X.
  5863                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5864                 24  FILLER                 PIC X(4).
  5865             20  CF-ZIP-PLUS4               PIC X(4).
  5866         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5867             20  CF-CAN-POSTAL-1            PIC XXX.
  5868             20  CF-CAN-POSTAL-2            PIC XXX.
  5869             20  FILLER                     PIC XXX.
  5870
  5871         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5872         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5873         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5874
  5875         16  CF-RATING-SWITCH               PIC X.
  5876             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5877             88  CF-NO-RATING                   VALUE 'N'.
  5878
  5879         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5880
  5881         16  CF-CARRIER-OVER-SHORT.
  5882             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5883             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5884
  5885         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5886         16  CF-SECPAY-SWITCH               PIC X.
  5887             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5888             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5889         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5890         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5891         16  FILLER                         PIC X(444).
  5892*        16  FILLER                         PIC X(452).
  5893
  5894
  5895****************************************************************
  5896*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 109
* EL050.cbl
  5897****************************************************************
  5898
  5899     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5900         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5901                                INDEXED BY CF-MORT-NDX.
  5902             20  CF-MORT-TABLE              PIC X(5).
  5903             20  CF-MORT-TABLE-TYPE         PIC X.
  5904                 88  CF-MORT-JOINT              VALUE 'J'.
  5905                 88  CF-MORT-SINGLE             VALUE 'S'.
  5906                 88  CF-MORT-COMBINED           VALUE 'C'.
  5907                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5908                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5909             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5910             20  CF-MORT-AGE-METHOD         PIC XX.
  5911                 88  CF-AGE-LAST                VALUE 'AL'.
  5912                 88  CF-AGE-NEAR                VALUE 'AN'.
  5913             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5914             20  CF-MORT-ADJUSTMENT-DIRECTION
  5915                                            PIC X.
  5916                 88  CF-MINUS                   VALUE '-'.
  5917                 88  CF-PLUS                    VALUE '+'.
  5918             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5919             20  CF-MORT-JOINT-CODE         PIC X.
  5920                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5921             20  CF-MORT-PC-Q               PIC X.
  5922                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5923             20  CF-MORT-TABLE-CODE         PIC X(4).
  5924             20  CF-MORT-COMMENTS           PIC X(15).
  5925             20  FILLER                     PIC X(14).
  5926
  5927         16  FILLER                         PIC X(251).
  5928
  5929
  5930****************************************************************
  5931*             BUSSINESS TYPE MASTER RECORD                     *
  5932****************************************************************
  5933
  5934     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5935* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5936* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5937* AND RECORD 05 IS TYPES 81-99
  5938         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5939             20  CF-BUSINESS-TITLE          PIC  X(19).
  5940             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5941                                            PIC S9V9(4) COMP-3.
  5942             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5943             20  FILLER                     PIC  X.
  5944         16  FILLER                         PIC  X(248).
  5945
  5946
  5947****************************************************************
  5948*             TERMINAL MASTER RECORD                           *
  5949****************************************************************
  5950
  5951     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5952
  5953         16  CF-COMPANY-TERMINALS.
  5954             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 110
* EL050.cbl
  5955                                  PIC X(4).
  5956         16  FILLER               PIC X(248).
  5957
  5958
  5959****************************************************************
  5960*             LIFE EDIT MASTER RECORD                          *
  5961****************************************************************
  5962
  5963     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5964         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5965             20  CF-LIFE-CODE-IN            PIC XX.
  5966             20  CF-LIFE-CODE-OUT           PIC XX.
  5967         16  FILLER                         PIC X(248).
  5968
  5969
  5970****************************************************************
  5971*             AH EDIT MASTER RECORD                            *
  5972****************************************************************
  5973
  5974     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5975         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5976             20  CF-AH-CODE-IN              PIC XXX.
  5977             20  CF-AH-CODE-OUT             PIC XX.
  5978         16  FILLER                         PIC X(248).
  5979
  5980
  5981****************************************************************
  5982*             CREDIBILITY TABLES                               *
  5983****************************************************************
  5984
  5985     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5986         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5987                             INDEXED BY CF-CRDB-NDX.
  5988             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5989             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5990             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5991         16  FILLER                         PIC  X(332).
  5992
  5993
  5994****************************************************************
  5995*             REPORT CUSTOMIZATION RECORD                      *
  5996****************************************************************
  5997
  5998     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5999         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6000             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6001             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6002             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6003**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6004****       A T-TRANSFER.                                   ****
  6005             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6006
  6007         16  FILLER                         PIC XX.
  6008
  6009         16  CF-CARRIER-CNTL-OPT.
  6010             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6011                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6012                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 111
* EL050.cbl
  6013             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6014                                            PIC X.
  6015         16  CF-GROUP-CNTL-OPT.
  6016             20  CF-GROUP-OPT-SEQ           PIC 9.
  6017                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6018                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6019             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6020                                            PIC X(6).
  6021         16  CF-STATE-CNTL-OPT.
  6022             20  CF-STATE-OPT-SEQ           PIC 9.
  6023                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6024                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6025             20  CF-STATE-SELECT OCCURS 3 TIMES
  6026                                            PIC XX.
  6027         16  CF-ACCOUNT-CNTL-OPT.
  6028             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6029                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6030                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6031             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6032                                            PIC X(10).
  6033         16  CF-BUS-TYP-CNTL-OPT.
  6034             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6035                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6036                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6037             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6038                                            PIC XX.
  6039         16  CF-LF-TYP-CNTL-OPT.
  6040             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6041                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6042                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6043             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6044                                            PIC XX.
  6045         16  CF-AH-TYP-CNTL-OPT.
  6046             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6047                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6048                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6049             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6050                                            PIC XX.
  6051         16  CF-REPTCD1-CNTL-OPT.
  6052             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6053                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6054                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6055             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6056                                            PIC X(10).
  6057         16  CF-REPTCD2-CNTL-OPT.
  6058             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6059                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6060                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6061             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6062                                            PIC X(10).
  6063         16  CF-USER1-CNTL-OPT.
  6064             20  CF-USER1-OPT-SEQ           PIC 9.
  6065                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6066                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6067             20  CF-USER1-SELECT OCCURS 3 TIMES
  6068                                            PIC X(10).
  6069         16  CF-USER2-CNTL-OPT.
  6070             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 112
* EL050.cbl
  6071                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6072                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6073             20  CF-USER2-SELECT OCCURS 3 TIMES
  6074                                            PIC X(10).
  6075         16  CF-USER3-CNTL-OPT.
  6076             20  CF-USER3-OPT-SEQ           PIC 9.
  6077                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6078                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6079             20  CF-USER3-SELECT OCCURS 3 TIMES
  6080                                            PIC X(10).
  6081         16  CF-USER4-CNTL-OPT.
  6082             20  CF-USER4-OPT-SEQ           PIC 9.
  6083                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6084                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6085             20  CF-USER4-SELECT OCCURS 3 TIMES
  6086                                            PIC X(10).
  6087         16  CF-USER5-CNTL-OPT.
  6088             20  CF-USER5-OPT-SEQ           PIC 9.
  6089                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6090                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6091             20  CF-USER5-SELECT OCCURS 3 TIMES
  6092                                            PIC X(10).
  6093         16  CF-REINS-CNTL-OPT.
  6094             20  CF-REINS-OPT-SEQ           PIC 9.
  6095                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6096                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6097             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6098                 24  CF-REINS-PRIME         PIC XXX.
  6099                 24  CF-REINS-SUB           PIC XXX.
  6100
  6101         16  CF-AGENT-CNTL-OPT.
  6102             20  CF-AGENT-OPT-SEQ           PIC 9.
  6103                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6104                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6105             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6106                                            PIC X(10).
  6107
  6108         16  FILLER                         PIC X(43).
  6109
  6110         16  CF-LOSS-RATIO-SELECT.
  6111             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6112             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6113         16  CF-ENTRY-DATE-SELECT.
  6114             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6115             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6116         16  CF-EFFECTIVE-DATE-SELECT.
  6117             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6118             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6119
  6120         16  CF-EXCEPTION-LIST-IND          PIC X.
  6121             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6122
  6123         16  FILLER                         PIC X(318).
  6124
  6125****************************************************************
  6126*                  EXCEPTION REPORTING RECORD                  *
  6127****************************************************************
  6128
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 113
* EL050.cbl
  6129     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6130         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6131             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6132
  6133         16  CF-COMBINED-LIFE-AH-OPT.
  6134             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6135             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6136             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6137             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6138
  6139         16  CF-LIFE-OPT.
  6140             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6141             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6142             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6143             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6144             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6145             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6146             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6147             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6148             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6149             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6150
  6151         16  CF-AH-OPT.
  6152             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6153             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6154             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6155             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6156             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6157             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6158             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6159             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6160             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6161             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6162
  6163         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6164             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6165             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6166             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6167
  6168         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6169
  6170         16  FILLER                         PIC X(673).
  6171
  6172
  6173****************************************************************
  6174*             MORTGAGE SYSTEM PLAN RECORD                      *
  6175****************************************************************
  6176
  6177     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6178         16  CF-PLAN-TYPE                   PIC X.
  6179             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6180             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6181             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6182         16  CF-PLAN-ABBREV                 PIC XXX.
  6183         16  CF-PLAN-DESCRIPT               PIC X(10).
  6184         16  CF-PLAN-NOTES                  PIC X(20).
  6185         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6186         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 114
* EL050.cbl
  6187             20  CF-PLAN-TERM-DATA.
  6188                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6189                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6190             20  CF-PLAN-AGE-DATA.
  6191                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6192                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6193                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6194             20  CF-PLAN-BENEFIT-DATA.
  6195                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6196                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6197                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6198                                            PIC S9(7)V99  COMP-3.
  6199         16  CF-PLAN-POLICY-FORMS.
  6200             20  CF-POLICY-FORM             PIC X(12).
  6201             20  CF-MASTER-APPLICATION      PIC X(12).
  6202             20  CF-MASTER-POLICY           PIC X(12).
  6203         16  CF-PLAN-RATING.
  6204             20  CF-RATE-CODE               PIC X(5).
  6205             20  CF-SEX-RATING              PIC X.
  6206                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6207                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6208             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6209             20  CF-SUB-STD-TYPE            PIC X.
  6210                 88  CF-PCT-OF-PREM            VALUE '1'.
  6211                 88  CF-PCT-OF-BENE            VALUE '2'.
  6212         16  CF-PLAN-PREM-TOLERANCES.
  6213             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6214             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6215         16  CF-PLAN-PYMT-TOLERANCES.
  6216             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6217             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6218         16  CF-PLAN-MISC-DATA.
  6219             20  FILLER                     PIC X.
  6220             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6221             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6222         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6223         16  CF-PLAN-IND-GRP                PIC X.
  6224             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6225                                                     '1'.
  6226             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6227                                                     '2'.
  6228         16  CF-MIB-SEARCH-SW               PIC X.
  6229             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6230             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6231             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6232             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6233         16  CF-ALPHA-SEARCH-SW             PIC X.
  6234             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6235             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6236             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6237             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6238             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6239             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6240             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6241             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6242             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6243             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6244                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 115
* EL050.cbl
  6245                                                     'X' 'Y' 'Z'.
  6246         16  CF-EFF-DT-RULE-SW              PIC X.
  6247             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6248             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6249             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6250             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6251             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6252         16  FILLER                         PIC X(4).
  6253         16  CF-HEALTH-QUESTIONS            PIC X.
  6254             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6255         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6256         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6257         16  CF-PLAN-SNGL-JNT               PIC X.
  6258             88  CF-COMBINED-PLAN              VALUE 'C'.
  6259             88  CF-JNT-PLAN                   VALUE 'J'.
  6260             88  CF-SNGL-PLAN                  VALUE 'S'.
  6261         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6262         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6263         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6264         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6265         16  CF-RERATE-CNTL                 PIC  X.
  6266             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6267             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6268             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6269             88  CF-AUTO-RECALC                 VALUE '4'.
  6270         16  CF-BENEFIT-TYPE                PIC  X.
  6271             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6272             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6273         16  CF-POLICY-FEE                  PIC S999V99
  6274                                                    COMP-3.
  6275         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6276         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6277         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6278         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6279         16  FILLER                         PIC  X(32).
  6280         16  CF-TERMINATION-FORM            PIC  X(04).
  6281         16  FILLER                         PIC  X(08).
  6282         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6283                                                       COMP-3.
  6284         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6285         16  CF-ISSUE-LETTER                PIC  X(4).
  6286         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6287         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6288             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6289             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6290         16  CF-MP-REFUND-CALC              PIC X.
  6291             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6292             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6293             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6294             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6295             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6296             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6297             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6298             88  CF-MP-REFD-MEAN                VALUE '8'.
  6299         16  CF-ALT-RATE-CODE               PIC  X(5).
  6300
  6301
  6302         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 116
* EL050.cbl
  6303****************************************************************
  6304*             MORTGAGE COMPANY MASTER RECORD                   *
  6305****************************************************************
  6306
  6307     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6308         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6309         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6310             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6311             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6312             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6313             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6314             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6315
  6316         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6317         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6318         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6319         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6320         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6321
  6322         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6323             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6324         16  CF-MP-RECON-USE-IND            PIC X(1).
  6325             88  CF-MP-USE-RECON             VALUE 'Y'.
  6326         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6327             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6328         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6329             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6330             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6331         16  FILLER                         PIC X(1).
  6332         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6333             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6334         16  CF-MORTG-MIB-VERSION           PIC X.
  6335             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6336             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6337             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6338         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6339             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6340                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6341             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6342                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6343             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6344                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6345             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6346                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6347             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6348                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6349             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6350                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6351         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6352         16  FILLER                         PIC X(7).
  6353         16  CF-MORTG-DESTINATION-SYMBOL.
  6354             20  CF-MORTG-MIB-COMM          PIC X(5).
  6355             20  CF-MORTG-MIB-TERM          PIC X(5).
  6356         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6357             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6358         16  FILLER                         PIC X(03).
  6359         16  CF-MP-CHECK-NO-CONTROL.
  6360             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 117
* EL050.cbl
  6361                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6362                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6363                                                ' ' LOW-VALUES.
  6364                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6365                                               VALUE '3'.
  6366         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6367         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6368         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6369             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6370                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6371             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6372                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6373             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6374                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6375             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6376                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6377             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6378                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6379             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6380                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6381         16  CF-MORTG-BILLING-AREA.
  6382             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6383                                            PIC X.
  6384         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6385         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6386         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6387         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6388             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6389             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6390         16  FILLER                         PIC X.
  6391         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6392             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6393             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6394         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6395         16  FILLER                         PIC X(8).
  6396         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6397         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6398         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6399         16  CF-ACH-COMPANY-ID.
  6400             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6401                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6402                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6403                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6404             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6405         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6406             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6407         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6408             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6409             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6410         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6411         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6412         16  FILLER                         PIC X(536).
  6413
  6414****************************************************************
  6415*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6416****************************************************************
  6417
  6418     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 118
* EL050.cbl
  6419         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6420             20  CF-FEMALE-HEIGHT.
  6421                 24  CF-FEMALE-FT           PIC 99.
  6422                 24  CF-FEMALE-IN           PIC 99.
  6423             20  CF-FEMALE-MIN-WT           PIC 999.
  6424             20  CF-FEMALE-MAX-WT           PIC 999.
  6425         16  FILLER                         PIC X(428).
  6426
  6427     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6428         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6429             20  CF-MALE-HEIGHT.
  6430                 24  CF-MALE-FT             PIC 99.
  6431                 24  CF-MALE-IN             PIC 99.
  6432             20  CF-MALE-MIN-WT             PIC 999.
  6433             20  CF-MALE-MAX-WT             PIC 999.
  6434         16  FILLER                         PIC X(428).
  6435******************************************************************
  6436*             AUTOMATIC ACTIVITY RECORD                          *
  6437******************************************************************
  6438     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6439         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6440             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6441             20  CF-SYS-LETTER-ID           PIC X(04).
  6442             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6443             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6444             20  CF-SYS-RESET-SW            PIC X(01).
  6445             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6446             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6447
  6448         16  FILLER                         PIC X(50).
  6449
  6450         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6451             20  CF-USER-ACTIVE-SW          PIC X(01).
  6452             20  CF-USER-LETTER-ID          PIC X(04).
  6453             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6454             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6455             20  CF-USER-RESET-SW           PIC X(01).
  6456             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6457             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6458             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6459
  6460         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 119
* EL050.cbl
  6462*    COPY ERCACCT.
  6463******************************************************************
  6464*                                                                *
  6465*                                                                *
  6466*                            ERCACCT                             *
  6467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6468*                            VMOD=2.031                          *
  6469*                                                                *
  6470*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6471*                                                                *
  6472*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6473*   VSAM ACCOUNT MASTER FILES.                                   *
  6474*                                                                *
  6475*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6476*                                                                *
  6477*   FILE TYPE = VSAM,KSDS                                        *
  6478*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6479*                                                                *
  6480*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6481*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6482*                                                                *
  6483*   LOG = NO                                                     *
  6484*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6485*                                                                *
  6486*                                                                *
  6487******************************************************************
  6488*                   C H A N G E   L O G
  6489*
  6490* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6491*-----------------------------------------------------------------
  6492*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6493* EFFECTIVE    NUMBER
  6494*-----------------------------------------------------------------
  6495* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6496* 092705    2005050300006  PEMA  ADD SPP LEASES
  6497* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6498* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6499* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6500* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6501* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6502******************************************************************
  6503
  6504 01  ACCOUNT-MASTER.
  6505     12  AM-RECORD-ID                      PIC XX.
  6506         88  VALID-AM-ID                      VALUE 'AM'.
  6507
  6508     12  AM-CONTROL-PRIMARY.
  6509         16  AM-COMPANY-CD                 PIC X.
  6510         16  AM-MSTR-CNTRL.
  6511             20  AM-CONTROL-A.
  6512                 24  AM-CARRIER            PIC X.
  6513                 24  AM-GROUPING.
  6514                     28 AM-GROUPING-PREFIX PIC XXX.
  6515                     28 AM-GROUPING-PRIME  PIC XXX.
  6516                 24  AM-STATE              PIC XX.
  6517                 24  AM-ACCOUNT.
  6518                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6519                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 120
* EL050.cbl
  6520             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6521                                           PIC X(19).
  6522             20  AM-CNTRL-B.
  6523                 24  AM-EXPIRATION-DT      PIC XX.
  6524                 24  FILLER                PIC X(4).
  6525             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6526                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6527
  6528     12  AM-CONTROL-BY-VAR-GRP.
  6529         16  AM-COMPANY-CD-A1              PIC X.
  6530         16  AM-VG-CARRIER                 PIC X.
  6531         16  AM-VG-GROUPING                PIC X(6).
  6532         16  AM-VG-STATE                   PIC XX.
  6533         16  AM-VG-ACCOUNT                 PIC X(10).
  6534         16  AM-VG-DATE.
  6535             20  AM-VG-EXPIRATION-DT       PIC XX.
  6536             20  FILLER                    PIC X(4).
  6537         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6538                                           PIC 9(11)      COMP-3.
  6539     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6540         16  FILLER                        PIC X(10).
  6541         16  AM-VG-KEY3.
  6542             20  AM-VG3-ACCOUNT            PIC X(10).
  6543             20  AM-VG3-EXP-DT             PIC XX.
  6544         16  FILLER                        PIC X(4).
  6545     12  AM-MAINT-INFORMATION.
  6546         16  AM-LAST-MAINT-DT              PIC XX.
  6547         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6548         16  AM-LAST-MAINT-USER            PIC X(4).
  6549         16  FILLER                        PIC XX.
  6550
  6551     12  AM-EFFECTIVE-DT                   PIC XX.
  6552     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6553
  6554     12  AM-PREV-DATES  COMP-3.
  6555         16  AM-PREV-EXP-DT                PIC 9(11).
  6556         16  AM-PREV-EFF-DT                PIC 9(11).
  6557
  6558     12  AM-REPORT-CODE-1                  PIC X(10).
  6559     12  AM-REPORT-CODE-2                  PIC X(10).
  6560
  6561     12  AM-CITY-CODE                      PIC X(4).
  6562     12  AM-COUNTY-PARISH                  PIC X(6).
  6563
  6564     12  AM-NAME                           PIC X(30).
  6565     12  AM-PERSON                         PIC X(30).
  6566     12  AM-ADDRS                          PIC X(30).
  6567     12  AM-CITY.
  6568         16  AM-ADDR-CITY                  PIC X(28).
  6569         16  AM-ADDR-STATE                 PIC XX.
  6570     12  AM-ZIP.
  6571         16  AM-ZIP-PRIME.
  6572             20  AM-ZIP-PRI-1ST            PIC X.
  6573                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6574             20  FILLER                    PIC X(4).
  6575         16  AM-ZIP-PLUS4                  PIC X(4).
  6576     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6577         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 121
* EL050.cbl
  6578         16  AM-CAN-POSTAL-2               PIC XXX.
  6579         16  FILLER                        PIC XXX.
  6580     12  AM-TEL-NO.
  6581         16  AM-AREA-CODE                  PIC 999.
  6582         16  AM-TEL-PRE                    PIC 999.
  6583         16  AM-TEL-NBR                    PIC 9(4).
  6584     12  AM-TEL-LOC                        PIC X.
  6585         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6586         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6587
  6588     12  AM-COMM-STRUCTURE.
  6589         16  AM-DEFN-1.
  6590             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6591                 24  AM-AGT.
  6592                     28  AM-AGT-PREFIX     PIC X(4).
  6593                     28  AM-AGT-PRIME      PIC X(6).
  6594                 24  AM-COM-TYP            PIC X.
  6595                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6596                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6597                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6598                 24  AM-RECALC-LV-INDIC    PIC X.
  6599                 24  AM-RETRO-LV-INDIC     PIC X.
  6600                 24  AM-GL-CODES           PIC X.
  6601                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6602                 24  FILLER                PIC X(01).
  6603         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6604             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6605                 24  FILLER                PIC X(11).
  6606                 24  AM-L-COMA             PIC XXX.
  6607                 24  AM-J-COMA             PIC XXX.
  6608                 24  AM-A-COMA             PIC XXX.
  6609                 24  FILLER                PIC X(6).
  6610
  6611     12  AM-COMM-CHANGE-STATUS             PIC X.
  6612         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6613
  6614     12  AM-CSR-CODE                       PIC X(4).
  6615
  6616     12  AM-BILLING-STATUS                 PIC X.
  6617         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6618         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6619     12  AM-AUTO-REFUND-SW                 PIC X.
  6620         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6621         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6622     12  AM-GPCD                           PIC 99.
  6623     12  AM-IG                             PIC X.
  6624         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6625         88  AM-HAS-GROUP                     VALUE '2'.
  6626     12  AM-STATUS                         PIC X.
  6627         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6628         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6629         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6630         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6631         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6632         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6633     12  AM-REMIT-TO                       PIC 99.
  6634     12  AM-ID-NO                          PIC X(11).
  6635
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 122
* EL050.cbl
  6636     12  AM-CAL-TABLE                      PIC XX.
  6637     12  AM-LF-DEVIATION                   PIC XXX.
  6638     12  AM-AH-DEVIATION                   PIC XXX.
  6639     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6640     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6641     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6642     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6643     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6644     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6645
  6646     12  AM-USER-FIELDS.
  6647         16  AM-FLD-1                      PIC XX.
  6648         16  AM-FLD-2                      PIC XX.
  6649         16  AM-FLD-3                      PIC XX.
  6650         16  AM-FLD-4                      PIC XX.
  6651         16  AM-FLD-5                      PIC XX.
  6652
  6653     12  AM-1ST-PROD-DATE.
  6654         16  AM-1ST-PROD-YR                PIC XX.
  6655         16  AM-1ST-PROD-MO                PIC XX.
  6656         16  AM-1ST-PROD-DA                PIC XX.
  6657     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6658     12  AM-CERTS-PURGED-DATE.
  6659         16  AM-PUR-YR                     PIC XX.
  6660         16  AM-PUR-MO                     PIC XX.
  6661         16  AM-PUR-DA                     PIC XX.
  6662     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6663     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6664     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6665     12  AM-INACTIVE-DATE.
  6666         16  AM-INA-MO                     PIC 99.
  6667         16  AM-INA-DA                     PIC 99.
  6668         16  AM-INA-YR                     PIC 99.
  6669     12  AM-AR-HI-CERT-DATE                PIC XX.
  6670
  6671     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6672     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6673
  6674     12  AM-OB-PAYMENT-MODE                PIC X.
  6675         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6676         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6677         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6678         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6679
  6680     12  AM-AH-ONLY-INDICATOR              PIC X.
  6681         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6682         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6683
  6684     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6685
  6686     12  AM-OVER-SHORT.
  6687         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6688         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6689
  6690     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6691     12  AM-DCC-CLP-STATE                  PIC XX.
  6692
  6693     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 123
* EL050.cbl
  6694     12  AM-RECALC-REIN                    PIC X.
  6695
  6696     12  AM-REI-TABLE                      PIC XXX.
  6697     12  AM-REI-ET-LF                      PIC X.
  6698     12  AM-REI-ET-AH                      PIC X.
  6699     12  AM-REI-PE-LF                      PIC X.
  6700     12  AM-REI-PE-AH                      PIC X.
  6701     12  AM-REI-PRT-ST                     PIC X.
  6702     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6703     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6704     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6705     12  AM-REI-GROUP-A                    PIC X(6).
  6706     12  AM-REI-MORT                       PIC X(4).
  6707     12  AM-REI-PRT-OW                     PIC X.
  6708     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6709     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6710     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6711     12  AM-REI-GROUP-B                    PIC X(6).
  6712
  6713     12  AM-TRUST-TYPE                     PIC X(2).
  6714
  6715     12  AM-EMPLOYER-STMT-USED             PIC X.
  6716     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6717
  6718     12  AM-STD-AH-TYPE                    PIC XX.
  6719     12  AM-EARN-METHODS.
  6720         16  AM-EARN-METHOD-R              PIC X.
  6721             88 AM-REF-RL-R78                 VALUE 'R'.
  6722             88 AM-REF-RL-PR                  VALUE 'P'.
  6723             88 AM-REF-RL-MEAN                VALUE 'M'.
  6724             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6725         16  AM-EARN-METHOD-L              PIC X.
  6726             88 AM-REF-LL-R78                 VALUE 'R'.
  6727             88 AM-REF-LL-PR                  VALUE 'P'.
  6728             88 AM-REF-LL-MEAN                VALUE 'M'.
  6729             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6730         16  AM-EARN-METHOD-A              PIC X.
  6731             88 AM-REF-AH-R78                 VALUE 'R'.
  6732             88 AM-REF-AH-PR                  VALUE 'P'.
  6733             88 AM-REF-AH-MEAN                VALUE 'M'.
  6734             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6735             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6736             88 AM-REF-AH-NET                 VALUE 'N'.
  6737
  6738     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6739     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6740     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6741
  6742     12  AM-RET-Y-N                        PIC X.
  6743     12  AM-RET-P-E                        PIC X.
  6744     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6745     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6746     12  AM-RET-GRP                        PIC X(6).
  6747     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6748         16  AM-POOL-PRIME                 PIC XXX.
  6749         16  AM-POOL-SUB                   PIC XXX.
  6750     12  AM-RETRO-EARNINGS.
  6751         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 124
* EL050.cbl
  6752         16  AM-RET-EARN-L                 PIC X.
  6753         16  AM-RET-EARN-A                 PIC X.
  6754     12  AM-RET-ST-TAX-USE                 PIC X.
  6755         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6756         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6757     12  AM-RETRO-BEG-EARNINGS.
  6758         16  AM-RET-BEG-EARN-R             PIC X.
  6759         16  AM-RET-BEG-EARN-L             PIC X.
  6760         16  AM-RET-BEG-EARN-A             PIC X.
  6761     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6762     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6763
  6764     12  AM-USER-SELECT-OPTIONS.
  6765         16  AM-USER-SELECT-1              PIC X(10).
  6766         16  AM-USER-SELECT-2              PIC X(10).
  6767         16  AM-USER-SELECT-3              PIC X(10).
  6768         16  AM-USER-SELECT-4              PIC X(10).
  6769         16  AM-USER-SELECT-5              PIC X(10).
  6770
  6771     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6772
  6773     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6774
  6775     12  AM-RPT045A-SWITCH                 PIC X.
  6776         88  RPT045A-OFF                   VALUE 'N'.
  6777
  6778     12  AM-INSURANCE-LIMITS.
  6779         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6780         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6781
  6782     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6783         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6784
  6785     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6786         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6787         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6788
  6789     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6790
  6791     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6792     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6793     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6794     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6795     12  AM-DCC-UEF-STATE                  PIC XX.
  6796     12  FILLER                            PIC XXX.
  6797     12  AM-REPORT-CODE-3                  PIC X(10).
  6798*    12  FILLER                            PIC X(22).
  6799
  6800     12  AM-RESERVE-DATE.
  6801         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6802         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6803         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6804
  6805     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6806     12  AM-NOTIFICATION-TYPES.
  6807         16  AM-NOTIF-OF-LETTERS           PIC X.
  6808         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6809         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 125
* EL050.cbl
  6810         16  AM-NOTIF-OF-STATUS            PIC X.
  6811
  6812     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6813         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6814         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6815         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6816         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6817
  6818     12  AM-BENEFIT-CONTROLS.
  6819         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6820             20  AM-BENEFIT-CODE           PIC XX.
  6821             20  AM-BENEFIT-TYPE           PIC X.
  6822             20  AM-BENEFIT-REVISION       PIC XXX.
  6823             20  AM-BENEFIT-REM-TERM       PIC X.
  6824             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6825             20  FILLER                    PIC XX.
  6826         16  FILLER                        PIC X(80).
  6827
  6828     12  AM-TRANSFER-DATA.
  6829         16  AM-TRANSFERRED-FROM.
  6830             20  AM-TRNFROM-CARRIER        PIC X.
  6831             20  AM-TRNFROM-GROUPING.
  6832                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6833                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6834             20  AM-TRNFROM-STATE          PIC XX.
  6835             20  AM-TRNFROM-ACCOUNT.
  6836                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6837                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6838             20  AM-TRNFROM-DTE            PIC XX.
  6839         16  AM-TRANSFERRED-TO.
  6840             20  AM-TRNTO-CARRIER          PIC X.
  6841             20  AM-TRNTO-GROUPING.
  6842                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6843                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6844             20  AM-TRNTO-STATE            PIC XX.
  6845             20  AM-TRNTO-ACCOUNT.
  6846                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6847                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6848             20  AM-TRNTO-DTE              PIC XX.
  6849         16  FILLER                        PIC X(10).
  6850
  6851     12  AM-SAVED-REMIT-TO                 PIC 99.
  6852
  6853     12  AM-COMM-STRUCTURE-SAVED.
  6854         16  AM-DEFN-1-SAVED.
  6855             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6856                 24  AM-AGT-SV             PIC X(10).
  6857                 24  AM-COM-TYP-SV         PIC X.
  6858                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6859                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6860                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6861                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6862                 24  FILLER                PIC X.
  6863                 24  AM-GL-CODES-SV        PIC X.
  6864                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6865                 24  FILLER                PIC X.
  6866         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6867             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 126
* EL050.cbl
  6868                 24  FILLER                PIC X(11).
  6869                 24  AM-L-COMA-SV          PIC XXX.
  6870                 24  AM-J-COMA-SV          PIC XXX.
  6871                 24  AM-A-COMA-SV          PIC XXX.
  6872                 24  FILLER                PIC X(6).
  6873
  6874     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6875         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6876            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6877            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6878            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6879
  6880     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6881     12  FILLER                            PIC X(120).
  6882
  6883     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6884         16  AM-CONTROL-NAME               PIC X(30).
  6885         16  AM-EXECUTIVE-ONE.
  6886             20  AM-EXEC1-NAME             PIC X(15).
  6887             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6888                                                          COMP-3.
  6889             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6890                                                          COMP-3.
  6891         16  AM-EXECUTIVE-TWO.
  6892             20  AM-EXEC2-NAME             PIC X(15).
  6893             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6894                                                          COMP-3.
  6895             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6896                                                          COMP-3.
  6897
  6898     12  AM-RETRO-ADDITIONAL-DATA.
  6899         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6900         16  AM-RETRO-PREM-P-E             PIC X.
  6901         16  AM-RETRO-CLMS-P-I             PIC X.
  6902         16  AM-RETRO-RET-BRACKET-LF.
  6903             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6904                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6905                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6906             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6907                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6908                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6909             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6910                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6911                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6912         16  AM-RETRO-RET-BRACKET-AH.
  6913             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6914                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6915                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6916                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6917             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6918                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6919                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6920             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6921                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6922                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6923
  6924     12  AM-COMMENTS.
  6925         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 127
* EL050.cbl
  6926
  6927     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6928         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6929         16  AM-FLI-BILLING-CODE           PIC X.
  6930         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6931         16  AM-FLI-UNITED-IDENT           PIC X.
  6932         16  AM-FLI-INTEREST-LOST-DATA.
  6933             20  AM-FLI-BANK-NO            PIC X(5).
  6934             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6935             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6936             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6937         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6938             20  AM-FLI-AGT                PIC X(9).
  6939             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6940             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6941         16  FILLER                        PIC X(102).
  6942
  6943     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6944         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6945             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6946             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6947             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6948             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6949             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6950         16  FILLER                          PIC X(10).
  6951******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 128
* EL050.cbl
  6953*    COPY ERCREIN.
  6954******************************************************************
  6955*                                                                *
  6956*                            ERCREIN                             *
  6957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6958*                            VMOD=2.010                          *
  6959*                                                                *
  6960*   ONLINE CREDIT SYSTEM                                         *
  6961*                                                                *
  6962*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6963*                                                                *
  6964*   FILE TYPE = VSAM,KSDS                                        *
  6965*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6966*                                                                *
  6967*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6968*       ALTERNATE PATH = NONE                                    *
  6969*                                                                *
  6970*   LOG = NO                                                     *
  6971*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6972*                                                                *
  6973******************************************************************
  6974*                   C H A N G E   L O G
  6975*
  6976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6977*-----------------------------------------------------------------
  6978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6979* EFFECTIVE    NUMBER
  6980*-----------------------------------------------------------------
  6981* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6982* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6983******************************************************************
  6984 01  REINSURANCE-RECORD.
  6985     12  RE-RECORD-ID                      PIC XX.
  6986         88  VALID-RE-ID                      VALUE 'RE'.
  6987
  6988     12  RE-CONTROL-PRIMARY.
  6989         16  RE-COMPANY-CD                 PIC X.
  6990         16  RE-KEY.
  6991             20  RE-CODE                   PIC X.
  6992                 88  RE-TABLE-RECORD          VALUE 'A'.
  6993                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6994             20  RE-TABLE                  PIC XXX.
  6995             20  FILLER                    PIC XXX.
  6996         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6997             20  FILLER                    PIC X.
  6998             20  RE-COMPANY.
  6999                 24  RE-COMP-PRIME         PIC XXX.
  7000                 24  RE-COMP-SUB           PIC XXX.
  7001
  7002     12  RE-MAINT-INFORMATION.
  7003         16  RE-LAST-MAINT-DT              PIC XX.
  7004         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7005         16  RE-LAST-MAINT-USER            PIC X(4).
  7006         16  FILLER                        PIC X(10).
  7007
  7008     12  RE-TABLE-DATA.
  7009         16  RE-100-COMP                   PIC 99.
  7010
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 129
* EL050.cbl
  7011         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7012             20  RE-REI-COMP-NO.
  7013                 24  RE-REI-COMP           PIC XXX.
  7014                 24  RE-REI-COMP-SUB       PIC XXX.
  7015             20  RE-LF-QC                  PIC X.
  7016             20  RE-AH-QC                  PIC X.
  7017             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7018             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7019             20  RE-LFAGE-LO               PIC 99.
  7020             20  RE-LFAGE-HI               PIC 99.
  7021             20  RE-AHAGE-LO               PIC 99.
  7022             20  RE-AHAGE-HI               PIC 99.
  7023             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7024             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7025             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7026             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7027             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7028             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7029             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7030             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7031             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7032             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7033             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7034             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7035             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7036             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7037             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7038             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7039             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7040             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7041             20  RE-LF-BEN-CODE            PIC X.
  7042             20  RE-AH-BEN-CODE            PIC X.
  7043             20  RE-INTERACTIVE            PIC X.
  7044             20  RE-REMAINING              PIC X.
  7045             20  RE-LF-RUNOFF-SW           PIC X.
  7046             20  RE-AH-RUNOFF-SW           PIC X.
  7047             20  FILLER                    PIC X(19).
  7048
  7049         16  RE-COMP-INFO-END              PIC X(6).
  7050         16  RE-NSP-ST-CD-LF               PIC XX.
  7051         16  RE-NSP-ST-CD-AH               PIC XX.
  7052         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7053             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7054
  7055         16  FILLER                        PIC X(27).
  7056
  7057     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7058         16  RE-NAME                       PIC X(30).
  7059         16  RE-LF-PE                      PIC X.
  7060         16  RE-AH-PE                      PIC X.
  7061         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7062         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7063         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7064         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7065         16  RE-PRT-ST                     PIC X.
  7066         16  RE-PRT-OW                     PIC X.
  7067         16  RE-MORT-CODE                  PIC X(4).
  7068         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 130
* EL050.cbl
  7069         16  RE-ZERO-LF-FEE                PIC X.
  7070         16  RE-ZERO-AH-FEE                PIC X.
  7071         16  RE-CEDE-NAME                  PIC X(30).
  7072         16  RE-LF-COMM                    PIC X.
  7073         16  RE-AH-COMM                    PIC X.
  7074         16  RE-LF-TAX                     PIC X.
  7075         16  RE-AH-TAX                     PIC X.
  7076         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7077         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7078         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7079
  7080         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7081             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7082
  7083         16  RE-LF-CEDING-FEE-BRACKETS.
  7084             20  RE-LF-FEE-METHOD          PIC X.
  7085                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7086                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7087                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7088                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7089             20  RE-LF-FEE-BASIS           PIC X.
  7090                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7091                 88  RE-LF-NET-CEDED               VALUE '2'.
  7092                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7093                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7094                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7095                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7096                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7097                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7098             20  FILLER                    PIC XXX.
  7099             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7100                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7101                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7102
  7103         16  RE-AH-CEDING-FEE-BRACKETS.
  7104             20  RE-AH-FEE-METHOD          PIC X.
  7105                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7106                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7107                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7108                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7109             20  RE-AH-FEE-BASIS           PIC X.
  7110                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7111                 88  RE-AH-NET-CEDED               VALUE '2'.
  7112                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7113                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7114                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7115                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7116                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7117                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7118             20  FILLER                    PIC XXX.
  7119             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7120                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7121                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7122
  7123         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7124
  7125         16  RE-OLD-CEDING-STMT            PIC X.
  7126
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 131
* EL050.cbl
  7127         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7128         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7129         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7130         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7131         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7132         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7133         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7134         16  RE-MORT-SW                    PIC X.
  7135         16  RE-CEDING-TYPE-FLAG           PIC X.
  7136             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7137             88  RE-CEDED                          VALUE 'C'.
  7138             88  RE-ASSUMED                        VALUE 'A'.
  7139             88  RE-PHANTOM                        VALUE 'P'.
  7140
  7141         16  RE-CEDING-STMT-OPT-A          PIC X.
  7142             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7143         16  RE-CEDING-STMT-OPT-B          PIC X.
  7144             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7145         16  RE-CEDING-STMT-OPT-C          PIC X.
  7146             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7147         16  RE-CEDING-STMT-OPT-D          PIC X.
  7148             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7149         16  RE-CEDING-STMT-OPT-E          PIC X.
  7150             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7151
  7152         16  RE-PRT-CRSV                   PIC X.
  7153
  7154         16  RE-GL-CENTER                  PIC X(4).
  7155
  7156         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7157
  7158         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7159
  7160         16  RE-EARN-STOP-CODE             PIC X.
  7161             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7162             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7163
  7164         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7165             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7166
  7167         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7168         16  FILLER                        PIC X(2281).
  7169
  7170         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7171
  7172******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 132
* EL050.cbl
  7174*    COPY ERCCTBL.
  7175******************************************************************
  7176*                                                                *
  7177*                                                                *
  7178*                            ERCCTBL                             *
  7179*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7180*                            VMOD=2.003
  7181*                                                                *
  7182*   ONLINE CREDIT SYSTEM                                         *
  7183*                                                                *
  7184*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7185*                                                                *
  7186*   FILE TYPE = VSAM,KSDS                                        *
  7187*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7188*                                                                *
  7189*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7190*       ALTERNATE PATH = NONE                                    *
  7191*                                                                *
  7192*   LOG = NO                                                     *
  7193*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7194*                                                                *
  7195*                                                                *
  7196******************************************************************
  7197
  7198 01  COMM-TABLE-RECORD.
  7199     12  CT-RECORD-ID                      PIC XX.
  7200         88  VALID-CT-ID                      VALUE 'CT'.
  7201
  7202     12  CT-CONTROL-PRIMARY.
  7203         16  CT-COMPANY-CD                 PIC X.
  7204         16  CT-TABLE                      PIC XXX.
  7205         16  CT-CNTRL-2.
  7206             20  CT-BEN-TYPE               PIC X.
  7207             20  CT-BEN-CODE               PIC XX.
  7208
  7209     12  CT-MAINT-INFORMATION.
  7210         16  CT-LAST-MAINT-DT              PIC XX.
  7211         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7212         16  CT-LAST-MAINT-USER            PIC X(4).
  7213         16  FILLER                        PIC X(31).
  7214
  7215     12  CT-LIMITS.
  7216         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7217
  7218         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7219
  7220         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7221
  7222     12  CT-RATES.
  7223         16  CT-RTX          OCCURS 27 TIMES.
  7224             20  CT-RT                     PIC SV9(5)     COMP-3.
  7225             20  CT-RT-R   REDEFINES
  7226                 CT-RT                     PIC XXX.
  7227
  7228     12  FILLER                            PIC  X(42).
  7229
  7230******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 133
* EL050.cbl
  7232*    COPY ERCFORM.
  7233******************************************************************
  7234*                                                                *
  7235*                                                                *
  7236*                            ERCFORM.                            *
  7237*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7238*                            VMOD=2.003                          *
  7239*                                                                *
  7240*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7241*                                                                *
  7242*    FILE TYPE = VSAM,KSDS                                       *
  7243*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7244*                                                                *
  7245*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7246*                                                                *
  7247*    LOG = YES                                                   *
  7248*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7249******************************************************************
  7250 01  FORM-MASTER.
  7251    12  FO-RECORD-ID                 PIC X(02).
  7252        88  VALID-FO-ID                  VALUE 'FO'.
  7253
  7254    12  FO-CONTROL-PRIMARY.
  7255        16  FO-COMPANY-CD            PIC X(01).
  7256        16  FO-STATE                 PIC X(02).
  7257        16  FO-FORM-ID               PIC X(12).
  7258        16  FO-FORM-EXP-DT           PIC X(02).
  7259
  7260    12  FO-POLICY-FORM-DATA.
  7261        16  FO-IND-GRP-CD            PIC X(01).
  7262        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7263        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7264        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7265        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7266        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7267        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7268        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7269        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7270        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7271        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7272        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7273        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7274        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7275        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7276        16  FO-APP-CERT-USE-CD       PIC X(01).
  7277
  7278    12  FILLER                       PIC X(29).
  7279
  7280    12  FO-FORM-PLAN-TABLE.
  7281        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7282            20  FO-PLAN-TYPE         PIC X(01).
  7283            20  FO-PLAN-ID           PIC X(02).
  7284            20  FO-PLAN-TERM         PIC 9(03).
  7285            20  FO-PLAN-REFUND-METHOD
  7286                                     PIC X.
  7287
  7288    12  FILLER                       PIC X(30).
  7289
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 134
* EL050.cbl
  7290    12  FO-COMMENTS-AREA.
  7291        16  FO-COMMENT-LINE-1        PIC X(78).
  7292
  7293    12  FILLER                       PIC X(20).
  7294
  7295    12  FO-MAINT-INFORMATION.
  7296        16  FO-LAST-MAINT-DT         PIC X(02).
  7297        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7298        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 135
* EL050.cbl
  7300*    COPY ELCMSTR.
  7301******************************************************************
  7302*                                                                *
  7303*                            ELCMSTR.                            *
  7304*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7305*                            VMOD=2.012                          *
  7306*                                                                *
  7307*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7308*                                                                *
  7309*   FILE TYPE = VSAM,KSDS                                        *
  7310*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7311*                                                                *
  7312*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7313*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7314*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7315*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7316*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7317*                                                 RKP=75,LEN=21  *
  7318*                                                                *
  7319*   **** NOTE ****                                               *
  7320*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7321*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7322*                                                                *
  7323*   LOG = YES                                                    *
  7324*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7325******************************************************************
  7326*                   C H A N G E   L O G
  7327*
  7328* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7329*-----------------------------------------------------------------
  7330*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7331* EFFECTIVE    NUMBER
  7332*-----------------------------------------------------------------
  7333* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7334* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7335* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7336* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7337* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7338******************************************************************
  7339 01  CLAIM-MASTER.
  7340     12  CL-RECORD-ID                PIC XX.
  7341         88  VALID-CL-ID         VALUE 'CL'.
  7342
  7343     12  CL-CONTROL-PRIMARY.
  7344         16  CL-COMPANY-CD           PIC X.
  7345         16  CL-CARRIER              PIC X.
  7346         16  CL-CLAIM-NO             PIC X(7).
  7347         16  CL-CERT-NO.
  7348             20  CL-CERT-PRIME       PIC X(10).
  7349             20  CL-CERT-SFX         PIC X.
  7350
  7351     12  CL-CONTROL-BY-NAME.
  7352         16  CL-COMPANY-CD-A1        PIC X.
  7353         16  CL-INSURED-LAST-NAME    PIC X(15).
  7354         16  CL-INSURED-NAME.
  7355             20  CL-INSURED-1ST-NAME PIC X(12).
  7356             20  CL-INSURED-MID-INIT PIC X.
  7357
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 136
* EL050.cbl
  7358     12  CL-CONTROL-BY-SSN.
  7359         16  CL-COMPANY-CD-A2        PIC X.
  7360         16  CL-SOC-SEC-NO.
  7361             20  CL-SSN-STATE        PIC XX.
  7362             20  CL-SSN-ACCOUNT      PIC X(6).
  7363             20  CL-SSN-LN3          PIC X(3).
  7364
  7365     12  CL-CONTROL-BY-CERT-NO.
  7366         16  CL-COMPANY-CD-A4        PIC X.
  7367         16  CL-CERT-NO-A4.
  7368             20  CL-CERT-A4-PRIME    PIC X(10).
  7369             20  CL-CERT-A4-SFX      PIC X.
  7370
  7371     12  CL-CONTROL-BY-CCN.
  7372         16  CL-COMPANY-CD-A5        PIC X.
  7373         16  CL-CCN-A5.
  7374             20  CL-CCN.
  7375                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7376                 24  CL-CCN-PRIME-A5 PIC X(12).
  7377             20  CL-CCN-FILLER-A5    PIC X(4).
  7378
  7379     12  CL-INSURED-PROFILE-DATA.
  7380         16  CL-INSURED-BIRTH-DT     PIC XX.
  7381         16  CL-INSURED-SEX-CD       PIC X.
  7382             88  INSURED-IS-MALE        VALUE 'M'.
  7383             88  INSURED-IS-FEMALE      VALUE 'F'.
  7384             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7385         16  CL-INSURED-OCC-CD       PIC X(6).
  7386         16  FILLER                  PIC X(5).
  7387
  7388     12  CL-PROCESSING-INFO.
  7389         16  CL-PROCESSOR-ID         PIC X(4).
  7390         16  CL-CLAIM-STATUS         PIC X.
  7391             88  CLAIM-IS-OPEN          VALUE 'O'.
  7392             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7393         16  CL-CLAIM-TYPE           PIC X.
  7394*            88  AH-CLAIM               VALUE 'A'.
  7395*            88  LIFE-CLAIM             VALUE 'L'.
  7396*            88  PROPERTY-CLAIM         VALUE 'P'.
  7397*            88  IUI-CLAIM              VALUE 'I'.
  7398*            88  GAP-CLAIM              VALUE 'G'.
  7399*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7400         16  CL-CLAIM-PREM-TYPE      PIC X.
  7401             88  SINGLE-PREMIUM         VALUE '1'.
  7402             88  O-B-COVERAGE           VALUE '2'.
  7403             88  OPEN-END-COVERAGE      VALUE '3'.
  7404         16  CL-INCURRED-DT          PIC XX.
  7405         16  CL-REPORTED-DT          PIC XX.
  7406         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7407         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7408         16  CL-LAST-PMT-DT          PIC XX.
  7409         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7410         16  CL-PAID-THRU-DT         PIC XX.
  7411         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7412         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7413         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7414         16  CL-PMT-CALC-METHOD      PIC X.
  7415             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 137
* EL050.cbl
  7416             88  CL-365-DAY-YR          VALUE '2'.
  7417             88  CL-FULL-MONTHS         VALUE '3'.
  7418         16  CL-CAUSE-CD             PIC X(6).
  7419
  7420         16  CL-PRIME-CERT-NO.
  7421             20  CL-PRIME-CERT-PRIME PIC X(10).
  7422             20  CL-PRIME-CERT-SFX   PIC X.
  7423
  7424         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7425             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7426             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7427
  7428         16  CL-MICROFILM-NO         PIC X(10).
  7429         16  FILLER REDEFINES CL-MICROFILM-NO.
  7430             20  CL-BENEFIT-PERIOD   PIC 99.
  7431             20  FILLER              PIC X(8).
  7432         16  CL-PROG-FORM-TYPE       PIC X.
  7433         16  CL-LAST-ADD-ON-DT       PIC XX.
  7434
  7435         16  CL-LAST-REOPEN-DT       PIC XX.
  7436         16  CL-LAST-CLOSE-DT        PIC XX.
  7437         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7438             88  FINAL-PAID             VALUE '1'.
  7439             88  CLAIM-DENIED           VALUE '2'.
  7440             88  AUTO-CLOSE             VALUE '3'.
  7441             88  MANUAL-CLOSE           VALUE '4'.
  7442             88  BENEFITS-CHANGED       VALUE 'C'.
  7443             88  SETUP-ERRORS           VALUE 'E'.
  7444         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7445         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7446         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7447             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7448         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7449         16  FILLER                  PIC X.
  7450
  7451     12  CL-CERTIFICATE-DATA.
  7452         16  CL-CERT-ORIGIN          PIC X.
  7453             88  CERT-WAS-ONLINE        VALUE '1'.
  7454             88  CERT-WAS-CREATED       VALUE '2'.
  7455             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7456         16  CL-CERT-KEY-DATA.
  7457             20  CL-CERT-CARRIER     PIC X.
  7458             20  CL-CERT-GROUPING    PIC X(6).
  7459             20  CL-CERT-STATE       PIC XX.
  7460             20  CL-CERT-ACCOUNT.
  7461                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7462                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7463             20  CL-CERT-EFF-DT      PIC XX.
  7464
  7465     12  CL-STATUS-CONTROLS.
  7466         16  CL-PRIORITY-CD          PIC X.
  7467             88  CONFIDENTIAL-DATA      VALUE '8'.
  7468             88  HIGHEST-PRIORITY       VALUE '9'.
  7469         16  CL-SUPV-ATTN-CD         PIC X.
  7470             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7471             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7472         16  CL-PURGED-DT            PIC XX.
  7473         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 138
* EL050.cbl
  7474         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7475         16  CL-NEXT-RESEND-DT       PIC XX.
  7476         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7477         16  CL-CRITICAL-PERIOD      PIC 99.
  7478*        16  FILLER                  PIC XX.
  7479         16  CL-LAST-MAINT-DT        PIC XX.
  7480         16  CL-LAST-MAINT-USER      PIC X(4).
  7481         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7482         16  CL-LAST-MAINT-TYPE      PIC X.
  7483             88  CLAIM-SET-UP           VALUE ' '.
  7484             88  PAYMENT-MADE           VALUE '1'.
  7485             88  LETTER-SENT            VALUE '2'.
  7486             88  MASTER-WAS-ALTERED     VALUE '3'.
  7487             88  MASTER-WAS-RESTORED    VALUE '4'.
  7488             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7489             88  FILE-CONVERTED         VALUE '6'.
  7490             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7491             88  ERROR-CORRECTION       VALUE 'E'.
  7492         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7493         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7494         16  CL-BENEFICIARY          PIC X(10).
  7495         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7496         16  CL-DENIAL-TYPE          PIC X.
  7497             88  CL-TYPE-DENIAL          VALUE '1'.
  7498             88  CL-TYPE-RESCISSION      VALUE '2'.
  7499             88  CL-TYPE-REFORMATION     VALUE '3'.
  7500             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7501             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7502         16  filler                  pic x(5).
  7503*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7504*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7505*        16  CL-RTW-DT               PIC XX.
  7506
  7507     12  CL-TRAILER-CONTROLS.
  7508         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7509             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7510             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7511             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7512         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7513         16  FILLER                  PIC XX.
  7514         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7515         16  CL-ADDRESS-TRAILER-CNT.
  7516             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7517                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7518             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7519                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7520             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7521                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7522             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7523                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7524             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7525                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7526             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7527                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7528             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7529                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7530
  7531     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 139
* EL050.cbl
  7532         16  CL-CV-REFNO-PRIME       PIC X(18).
  7533         16  CL-CV-REFNO-SFX         PIC XX.
  7534
  7535     12  CL-FILE-LOCATION            PIC X(4).
  7536
  7537     12  CL-PROCESS-ERRORS.
  7538         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7539             88  NO-FATAL-ERRORS        VALUE ZERO.
  7540         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7541             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7542
  7543     12  CL-PRODUCT-CD               PIC X.
  7544
  7545     12  CL-CURRENT-KEY-DATA.
  7546         16  CL-CURRENT-CARRIER      PIC X.
  7547         16  CL-CURRENT-GROUPING     PIC X(6).
  7548         16  CL-CURRENT-STATE        PIC XX.
  7549         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7550
  7551     12  CL-ASSOCIATES               PIC X.
  7552         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7553         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7554         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7555         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7556
  7557     12  CL-ACTIVITY-CODE            PIC 99.
  7558     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7559     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7560
  7561     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7562     12  CL-LAG-REPORT-CODE          PIC 9.
  7563     12  CL-LOAN-TYPE                PIC XX.
  7564     12  CL-LEGAL-STATE              PIC XX.
  7565
  7566     12  CL-YESNOSW                  PIC X.
  7567     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7568         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7569         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7570         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7571     12  cl-insured-type             pic x.
  7572         88  cl-claim-on-primary         value 'P'.
  7573         88  cl-claim-on-co-borrower     value 'C'.
  7574     12  cl-benefit-expiration-dt    PIC XX.
  7575
  7576 01  PLAN-RECORDS.
  7577     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7578     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7579
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 140
* EL050.cbl
  7581 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7582                          ACCOUNT-MASTER REINSURANCE-RECORD
  7583                          COMM-TABLE-RECORD FORM-MASTER
  7584                          CLAIM-MASTER PLAN-RECORDS.
  7585 0000-DFHEXIT SECTION.
  7586     MOVE '9#                    $   ' TO DFHEIV0.
  7587     MOVE 'EL050' TO DFHEIV1.
  7588     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7589
  7590     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7591
  7592
  7593* EXEC CICS  HANDLE CONDITION
  7594*           ERROR    (9300-ABEND)
  7595*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7596*    END-EXEC.
  7597*    MOVE '"$.J                  ! " #00007588' TO DFHEIV0
  7598     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7600     MOVE X'2220233030303037353838' TO DFHEIV0(25:11)
  7601     CALL 'kxdfhei1' USING DFHEIV0
  7602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7603
  7604
  7605 0000-COPY-PROCEDURE-DIV.
  7606*                          COPY ELC50PD.
  7607******************************************************************
  7608*                                                                *
  7609*                            ELC50PD                             *
  7610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7611*                            VMOD=2.188                          *
  7612*                                                                *
  7613******************************************************************
  7614*                   C H A N G E   L O G
  7615*
  7616* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7617*-----------------------------------------------------------------
  7618*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7619* EFFECTIVE    NUMBER
  7620*-----------------------------------------------------------------
  7621* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7622* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7623* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7624*                             2709 AND 2718
  7625* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7626* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7627* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7628* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7629* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7630*                                IS OPEN OR CNC DT < PD THRU
  7631* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7632* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7633* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7634* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7635* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7636* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7637* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7638* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 141
* EL050.cbl
  7639* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7640* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7641* 020906                   PEMA  EXPAND LOAN OFFICER
  7642* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7643* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7644* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7645* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7646* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7647* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7648* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7649* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7650* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7651* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7652* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7653* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7654* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7655* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7656* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7657* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7658* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7659* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7660* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7661* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7662* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7663* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7664* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7665* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7666* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7667*                                UPDATE VIN ON CERT TRAILER
  7668* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7669* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7670* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7671* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7672* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7673* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7674* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7675* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7676* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7677* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7678* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7679* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7680* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7681* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7682* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7683* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7684* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7685* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7686* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7687* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7688* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7689* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7690* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7691* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7692* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7693* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7694* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7695* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7696* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 142
* EL050.cbl
  7697* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7698* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7699* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7700* 032912  CR2011110200001  PEMA  AHL CHANGES
  7701* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7702* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7703* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7704* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7705* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7706* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7707* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7708* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7709* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7710* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7711* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7712* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7713* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7714* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7715* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7716* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7717* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7718* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7719* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7720* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7721* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7722* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7723* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7724* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7725* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7726* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7727******************************************************************
  7728************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7729******************************************************************
  7730
  7731     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7732
  7733     MOVE SPACES                 TO PB-FATAL-FLAG
  7734                                    PB-FORCE-ER-CD
  7735                                    PB-WARN-ER-CD
  7736                                    PB-OUT-BAL-CD.
  7737
  7738     MOVE SPACE                  TO WS-IG-OVRD-AH
  7739                                    WS-IG-OVRD-LF
  7740                                    WS-IG-OVRD-AM
  7741                                    WS-IG-OVRD
  7742                                    WS-IG-OVRD-AH-PL
  7743                                    WS-IG-OVRD-LF-PL
  7744                                    WS-IG-OVRD-AH-BEN
  7745                                    WS-IG-OVRD-LF-BEN.
  7746
  7747******************************************************************
  7748*************       INITIALIZE COMMON ERRORS       ***************
  7749******************************************************************
  7750
  7751     MOVE +0                     TO PB-NO-OF-ERRORS.
  7752     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7753
  7754******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 143
* EL050.cbl
  7755
  7756     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7757     SET JULIAN-TO-BIN           TO TRUE.
  7758*    MOVE 5                      TO DC-OPTION-CODE.
  7759     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7760     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7761
  7762     MOVE ZERO                   TO  SUB4.
  7763
  7764 0040-INITIALIZE-GA-BILL-DT.
  7765
  7766     ADD +1                      TO  SUB4.
  7767
  7768     IF  SUB4 GREATER THAN +5
  7769         GO TO 0050-CHECK-CNTL-FOUND.
  7770
  7771     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7772         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7773
  7774     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7775
  7776 0050-CHECK-CNTL-FOUND.
  7777
  7778     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7779        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7780                                         WS-AH-REM-TERM-CALC
  7781                                         EC-CO-REM-TERM-CALC
  7782        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7783        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7784        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7785                                         WS-TOL-AH-CLAIM
  7786        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7787                                         WS-TOL-AH-PREM
  7788                                         EC-CO-TOL-PREM
  7789        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7790                                         WS-TOL-AH-REFUND
  7791                                         EC-CO-TOL-REFUND
  7792        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7793                                         WS-AH-REFUND-OVS-AMT
  7794                                         EC-CO-OVR-SHT-AMT
  7795        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7796                                         WS-TOL-AH-PREM-PCT
  7797                                         EC-CO-TOL-PREM-PCT
  7798        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7799                                         WS-TOL-AH-REFUND-PCT
  7800                                         EC-CO-TOL-REFUND-PCT
  7801        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7802                                         WS-AH-REFUND-OVS-PCT
  7803                                         EC-CO-OVR-SHT-PCT
  7804        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7805        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7806        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7807        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7808        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7809        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7810        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7811        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7812        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 144
* EL050.cbl
  7813        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7814        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7815        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7816                                         EC-CO-MONTH-END-DT
  7817        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7818          GO TO 0100-READ-ACCT.
  7819
  7820     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7821     MOVE SPACES                 TO CNTL-ACCESS.
  7822     MOVE '1'                    TO CNTL-REC-TYPE.
  7823     MOVE +0                     TO CNTL-SEQ-NO.
  7824
  7825     MOVE '1' TO RC-SW-1.
  7826     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7827     IF NOT CF-COMPANY-MASTER
  7828         MOVE ZEROS             TO WK-CO-TOL-PREM
  7829                                   WK-CO-TOL-CLAIM
  7830                                   WK-CO-TOL-REFUND
  7831                                   WK-REFUND-OVS-AMT
  7832                                   WK-REFUND-OVS-PCT
  7833                                   WK-CO-TOL-PREM-PCT
  7834                                   WK-CO-TOL-REFUND-PCT
  7835                                   WK-DEFAULT-APR
  7836                                   WK-CO-MAX-CAP
  7837        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7838                                   WK-CR-R78-METHOD
  7839                                   WK-CO-REF-REJECT-SW
  7840                                   WK-CO-PREM-REJECT-SW
  7841                                   WK-REM-TRM-CALC-OPTION
  7842                                   WK-BIRTH-DATE-INPUT
  7843                                   WK-JOINT-AGE-INPUT
  7844        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7845        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7846        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7847        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7848          GO TO 0099-COMPANY-NOT-FOUND.
  7849
  7850     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7851        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7852     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7853        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7854     IF CF-CO-TOL-CAP NOT NUMERIC
  7855        MOVE +0                    TO CF-CO-TOL-CAP.
  7856     IF CF-DEFAULT-APR NOT NUMERIC
  7857        MOVE +0                    TO CF-DEFAULT-APR.
  7858
  7859     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7860     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7861     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7862     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7863     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7864     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7865     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7866     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7867     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7868     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7869     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7870     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 145
* EL050.cbl
  7871
  7872     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7873          CF-CO-OVR-SHT-AMT > +0
  7874        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7875
  7876     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7877          CF-CO-OVR-SHT-PCT > +0
  7878        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7879
  7880     IF CF-VALID-REM-TRM-OPTION
  7881         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7882     ELSE
  7883         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7884
  7885     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7886     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7887     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7888     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7889
  7890     GO TO 0050-CHECK-CNTL-FOUND.
  7891
  7892 0099-COMPANY-NOT-FOUND.
  7893
  7894     MOVE ER-2616                TO WS-ERROR.
  7895     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7896
  7897 0100-READ-ACCT.
  7898
  7899     MOVE SPACES                 TO DATE-RANGE-SW.
  7900
  7901     IF WK-ACCT-ADDR = ZEROS
  7902        GO TO 0102-ACCT-GETMAIN.
  7903
  7904     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7905     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7906     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7907
  7908     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7909        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7910        GO TO 0105-READ-ACCT
  7911     END-IF
  7912
  7913     IF PB-CARRIER NOT = SPACES
  7914        IF PB-CARRIER NOT = AM-VG-CARRIER
  7915           GO TO 0105-READ-ACCT.
  7916
  7917     IF PB-STATE NOT = SPACES
  7918        IF PB-STATE NOT = AM-VG-STATE
  7919           GO TO 0105-READ-ACCT.
  7920
  7921     IF PB-GROUPING NOT = SPACES
  7922        IF PB-GROUPING NOT = AM-VG-GROUPING
  7923           GO TO 0105-READ-ACCT.
  7924
  7925     MOVE 'X'                 TO DATE-RANGE-SW.
  7926
  7927     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7928        MOVE 'X'                 TO DATE-RANGE-SW
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 146
* EL050.cbl
  7929        GO TO 0105-READ-ACCT.
  7930
  7931     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7932        GO TO 0105-READ-ACCT.
  7933
  7934     GO TO 0180-ACCOUNT-FOUND.
  7935
  7936 0102-ACCT-GETMAIN.
  7937     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7938     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7939
  7940 0105-READ-ACCT.
  7941     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7942     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7943     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7944     MOVE PB-STATE               TO ACCT-STATE.
  7945     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7946     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7947
  7948     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7949
  7950     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7951
  7952 0110-FIND-ACCT-TOLERANCES-LOOP.
  7953     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7954
  7955     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7956        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7957        GO TO 0199-ACCT-NOT-FOUND
  7958     END-IF
  7959     IF PB-CARRIER NOT = SPACES
  7960        IF PB-CARRIER NOT = AM-VG-CARRIER
  7961           GO TO 0199-ACCT-NOT-FOUND.
  7962
  7963     IF PB-STATE NOT = SPACES
  7964        IF PB-STATE NOT = AM-VG-STATE
  7965           GO TO 0199-ACCT-NOT-FOUND.
  7966
  7967     IF PB-GROUPING NOT = SPACES
  7968        IF PB-GROUPING NOT = AM-VG-GROUPING
  7969           GO TO 0199-ACCT-NOT-FOUND.
  7970
  7971     MOVE 'X'                    TO DATE-RANGE-SW.
  7972
  7973     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7974        MOVE 'X'                 TO DATE-RANGE-SW
  7975        GO TO 0199-ACCT-NOT-FOUND.
  7976
  7977     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7978        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7979
  7980 0180-ACCOUNT-FOUND.
  7981     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7982     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7983     MOVE AM-STATE               TO PB-SV-STATE.
  7984     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7985
  7986     IF AM-CANCEL-FEE  NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 147
* EL050.cbl
  7987        MOVE ZEROS TO AM-CANCEL-FEE.
  7988
  7989     IF AM-MAX-MON-BEN NOT NUMERIC
  7990        MOVE ZEROS TO AM-MAX-MON-BEN.
  7991
  7992     IF AM-MAX-TOT-BEN NOT NUMERIC
  7993        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7994
  7995     IF AM-CLP-TOL-PCT NOT NUMERIC
  7996        MOVE +0                  TO AM-CLP-TOL-PCT
  7997     END-IF
  7998     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7999        MOVE +0                  TO AM-SPP-LEASE-COMM
  8000     END-IF
  8001     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8002        MOVE ER-2611             TO   WS-ERROR
  8003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8004
  8005     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8006        MOVE ER-2621             TO   WS-ERROR
  8007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8008
  8009     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8010        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8011        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8012        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8013         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8014
  8015     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8016     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8017     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8018     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8019     IF AM-CLP-TOL-PCT NOT = ZEROS
  8020        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8021     END-IF
  8022     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8023        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8024     END-IF
  8025*    IF PB-COMPANY-ID = 'DCC'
  8026*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8027*                                   WS-ADMIN-FEES
  8028*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8029*          (SUB5 > +10)
  8030*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8031*             AND (AM-A-COM (SUB5) NUMERIC)
  8032*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8033*                + (AM-A-COM (SUB5) * 1000)
  8034*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8035*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8036*                + (AM-A-COM (SUB5) * 1000)
  8037*             END-IF
  8038*             IF AM-COM-TYP (SUB5) = 'N'
  8039*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8040*                + (AM-A-COM (SUB5) * 1000)
  8041*             END-IF
  8042*          END-IF
  8043*       END-PERFORM
  8044*    END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 148
* EL050.cbl
  8045     IF (PB-COMPANY-ID = 'DCC')
  8046        AND (PB-ISSUE)
  8047        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8048                                    ws-cred-union-fees
  8049        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8050           (SUB5 > +10)
  8051           MOVE +0 TO WS-WK-RATE
  8052           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8053                                   'O' OR 'S')
  8054              IF (AM-A-COM (SUB5) NUMERIC)
  8055                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8056                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8057              ELSE
  8058                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8059                 IF PB-ISSUE
  8060                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8061                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8062                 ELSE
  8063                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8064                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8065                 END-IF
  8066                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8067                 MOVE ZEROS             TO WS-SUB1
  8068                                           WS-COMMISSION
  8069                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8070                 MOVE '0530'               TO CTBL-SW
  8071                 MOVE ' '                  TO WS-CTBL-READ-SW
  8072                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8073                 IF FIRST-TIME-THROUGH
  8074                    MOVE 'AA'              TO CTBL-BEN-CODE
  8075                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8076                 END-IF
  8077                 IF CTBL-TABLE-FOUND
  8078                    IF PB-ISSUE
  8079                       COMPUTE WS-COMM-CK-AMT =
  8080                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8081                    ELSE
  8082                       COMPUTE WS-COMM-CK-AMT =
  8083                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8084                    END-IF
  8085                    PERFORM 8800-GET-COMP-RATE
  8086                              THRU 8800-EXIT
  8087                 END-IF
  8088              END-IF
  8089              if am-com-typ (sub5) = 'O' or 'S'
  8090                 compute ws-cred-union-fees rounded =
  8091                    ws-cred-union-fees +
  8092                    (pb-i-ah-premium-amt * ws-wk-rate)
  8093              else
  8094                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8095                + (WS-WK-RATE * 1000)
  8096              end-if
  8097           END-IF
  8098        END-PERFORM
  8099     END-IF
  8100     IF PB-COMPANY-ID EQUAL 'CRI'
  8101         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8102
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 149
* EL050.cbl
  8103     IF PB-COMPANY-ID EQUAL 'NCL'
  8104         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8105     END-IF
  8106
  8107     GO TO 0200-READ-CERT.
  8108
  8109 0199-ACCT-NOT-FOUND.
  8110
  8111     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8112
  8113     IF DATE-RANGE-SW NOT = SPACES
  8114        MOVE ER-2601             TO WS-ERROR
  8115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8116     ELSE
  8117        MOVE ER-2619             TO WS-ERROR
  8118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8119
  8120     GO TO 9990-RETURN.
  8121
  8122 0200-READ-CERT.
  8123
  8124     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8125     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8126     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8127     MOVE PB-SV-STATE            TO CERT-STATE.
  8128     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8129     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8130     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8131
  8132     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8133
  8134     IF CERT-WAS-NOT-FOUND
  8135        GO TO 0299-CERT-NOT-FOUND.
  8136
  8137     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8138        MOVE ER-2759             TO WS-ERROR
  8139        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8140        GO TO 0298-UNLOCK-RETURN.
  8141
  8142     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8143         MOVE ER-2758            TO WS-ERROR
  8144         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8145         GO TO 0298-UNLOCK-RETURN.
  8146
  8147     IF PB-ISSUE
  8148        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8149           IF CERT-WAS-CREATED-FOR-CLAIM
  8150              NEXT SENTENCE
  8151            ELSE
  8152              MOVE ER-2626       TO WS-ERROR
  8153              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8154              GO TO 0298-UNLOCK-RETURN.
  8155
  8156     IF NOT PB-CANCELLATION
  8157        GO TO 0300-CONTINUE-EDIT.
  8158
  8159     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8160     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 150
* EL050.cbl
  8161     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8162     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8163     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8164     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8165
  8166     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8167     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8168     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8169     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8170     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8171     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8172     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8173     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8174     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8175
  8176     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8177     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8178     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8179     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8180     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8181     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8182     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8183
  8184     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8185     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8186
  8187     MOVE CM-CREDIT-INTERFACE-SW-1
  8188                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8189     MOVE CM-CREDIT-INTERFACE-SW-2
  8190                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8191
  8192     IF CM-O-B-COVERAGE
  8193         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8194
  8195     IF CM-LIVES NOT NUMERIC
  8196         MOVE ZERO                TO CM-LIVES.
  8197
  8198     IF CM-BILLED NOT NUMERIC
  8199         MOVE ZERO                TO CM-BILLED.
  8200
  8201     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8202         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8203         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8204         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8205         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8206         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8207         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8208         MOVE CM-LIVES             TO PB-CI-LIVES
  8209*The next line causes a problem with my change  I dont think it is
  8210*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8211
  8212     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8213     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8214     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8215     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8216     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8217     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8218
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 151
* EL050.cbl
  8219     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8220     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8221     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8222     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8223
  8224     IF CM-LIFE-COMM-PCT NUMERIC
  8225         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8226     ELSE
  8227         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8228
  8229     IF CM-AH-COMM-PCT NUMERIC
  8230         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8231     ELSE
  8232         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8233
  8234     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8235
  8236     IF CM-LOAN-APR       NOT NUMERIC
  8237           MOVE ZERO               TO CM-LOAN-APR.
  8238
  8239     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8240           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8241
  8242     IF CM-LOAN-TERM      NOT NUMERIC
  8243           MOVE ZERO               TO CM-LOAN-TERM.
  8244
  8245     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8246           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8247
  8248     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8249           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8250
  8251     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8252     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8253     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8254     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8255     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8256     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8257     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8258     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8259     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8260     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8261     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8262     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8263
  8264     IF CM-STATE = CM-SSN-STATE
  8265         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8266
  8267     IF CM-STATE NOT = CM-MEMB-STATE
  8268         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8269
  8270     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8271
  8272     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8273        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8274        IF CM-ADDL-CLP NOT NUMERIC
  8275           MOVE +0               TO CM-ADDL-CLP
  8276        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 152
* EL050.cbl
  8277        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8278        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8279           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8280        END-IF
  8281     END-IF
  8282     IF PB-COMPANY-ID = 'DCC'
  8283        MOVE +0                  TO WS-ADMIN-FEES
  8284                                    WS-CSO-ADMIN-FEE
  8285                                    WS-COMM-AND-MFEE
  8286                                    WS-1ST-YR-ALLOW
  8287        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8288           (SUB5 > +10)
  8289           MOVE +0 TO WS-WK-RATE
  8290           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8291              IF (AM-A-COM (SUB5) NUMERIC)
  8292                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8293                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8294              ELSE
  8295                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8296                 IF PB-ISSUE
  8297                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8298                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8299                 ELSE
  8300                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8301                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8302                 END-IF
  8303                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8304                 MOVE ZEROS             TO WS-SUB1
  8305                                           WS-COMMISSION
  8306                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8307                 MOVE '0530'               TO CTBL-SW
  8308                 MOVE ' '                  TO WS-CTBL-READ-SW
  8309                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8310                 IF FIRST-TIME-THROUGH
  8311                    MOVE 'AA'              TO CTBL-BEN-CODE
  8312                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8313                 END-IF
  8314                 IF CTBL-TABLE-FOUND
  8315                    IF PB-ISSUE
  8316                       COMPUTE WS-COMM-CK-AMT =
  8317                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8318                    ELSE
  8319                       COMPUTE WS-COMM-CK-AMT =
  8320                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8321                    END-IF
  8322                    PERFORM 8800-GET-COMP-RATE
  8323                              THRU 8800-EXIT
  8324                 END-IF
  8325              END-IF
  8326              IF AM-COM-TYP (SUB5) = 'I'
  8327                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8328                   + (WS-WK-RATE * 1000)
  8329              END-IF
  8330              IF AM-COM-TYP (SUB5) = 'N'
  8331                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8332                   + (WS-WK-RATE * 1000)
  8333              END-IF
  8334              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 153
* EL050.cbl
  8335                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8336                   + (WS-WK-RATE * 1000)
  8337              END-IF
  8338              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8339                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8340                   + (WS-WK-RATE * 1000)
  8341              END-IF
  8342           END-IF
  8343        END-PERFORM
  8344     END-IF
  8345     GO TO 0300-CONTINUE-EDIT.
  8346
  8347 0298-UNLOCK-RETURN.
  8348      PERFORM 9250-UNLOCK-RETURN
  8349      GO TO 9990-RETURN.
  8350
  8351 0299-CERT-NOT-FOUND.
  8352
  8353     MOVE '1'                     TO CERT-STATUS-SW.
  8354
  8355     IF PB-COMPANY-ID = 'UCL'
  8356         IF WS-ERROR = ER-2799
  8357             GO TO 3000-CONTINUE-EDIT.
  8358
  8359     IF NOT PB-CANCELLATION
  8360         GO TO 0300-CONTINUE-EDIT.
  8361
  8362     MOVE ER-2726                  TO  WS-ERROR.
  8363     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8364     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8365     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8366                                    PB-CI-LF-TERM
  8367                                    PB-C-LF-REM-TERM
  8368                                    PB-CI-AH-TERM
  8369                                    PB-C-AH-REM-TERM
  8370                                    PB-CI-LF-BENEFIT-CD
  8371                                    PB-CI-LF-BENEFIT-AMT
  8372                                    PB-CI-LF-ALT-BENEFIT-AMT
  8373                                    PB-CI-LF-PREMIUM-AMT
  8374                                    PB-CI-LF-ALT-PREMIUM-AMT
  8375                                    PB-CI-AH-BENEFIT-CD
  8376                                    PB-CI-AH-BENEFIT-AMT
  8377                                    PB-CI-AH-PREMIUM-AMT
  8378                                    PB-CI-PAY-FREQUENCY
  8379                                    PB-CI-LOAN-APR
  8380                                    PB-CI-LOAN-TERM
  8381                                    PB-CI-LIFE-COMMISSION
  8382                                    PB-CI-AH-COMMISSION
  8383                                    PB-CI-CURR-SEQ
  8384                                    PB-CI-AH-CANCEL-AMT
  8385                                    PB-CI-LF-CANCEL-AMT
  8386                                    PB-CI-RATE-DEV-PCT-LF
  8387                                    PB-CI-RATE-DEV-PCT-AH
  8388                                    PB-CI-EXTENTION-DAYS
  8389                                    PB-CI-TERM-IN-DAYS
  8390                                    PB-CI-LIVES
  8391                                    PB-CI-LF-CRIT-PER
  8392                                    PB-CI-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 154
* EL050.cbl
  8393                                    PB-CI-ADDL-CLP
  8394                                    PB-CI-DDF-IU-RATE-UP.
  8395
  8396     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8397                                    PB-CI-AH-SETTLEMENT-DT
  8398                                    PB-CI-DEATH-DT
  8399                                    PB-CI-LF-PRIOR-CANCEL-DT
  8400                                    PB-CI-AH-PRIOR-CANCEL-DT
  8401                                    PB-CI-ENTRY-DT
  8402                                    PB-CI-LF-EXPIRE-DT
  8403                                    PB-CI-AH-EXPIRE-DT
  8404                                    PB-CI-LOAN-1ST-PMT-DT.
  8405
  8406     IF ACCOUNT-MAST-FOUND
  8407        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8408        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8409
  8410
  8411 0300-CONTINUE-EDIT.
  8412
  8413     IF PB-ISSUE
  8414        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8415            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8416
  8417     IF PB-ISSUE
  8418        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8419            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8420
  8421     IF PB-ISSUE
  8422       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8423          (AM-NO-AH-ONLY)
  8424           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8425               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8426                   MOVE ER-2679 TO WS-ERROR
  8427                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8428
  8429     IF PB-ISSUE
  8430        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8431        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8432        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8433     ELSE
  8434        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8435        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8436        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8437
  8438     MOVE 'N'                    TO PLAN-MASTER-SW
  8439                                    PLAN-MASTER-LIFE-SW
  8440                                    FORM-MASTER-SW
  8441                                    WS-APP-CERT-SW.
  8442
  8443     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8444                                    WS-PL-TOL-LF-REFUND
  8445                                    WS-PL-REF-OVS-AMT
  8446                                    WS-PL-TOL-LF-PREM-PCT
  8447                                    WS-PL-TOL-LF-REFUND-PCT
  8448                                    WS-PL-REF-OVS-PCT
  8449                                    WS-PL-TOL-LF-CLAIM.
  8450
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 155
* EL050.cbl
  8451     IF PB-COMPANY-ID = 'NCL'
  8452       IF PB-ISSUE
  8453         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8454             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8455             IF FORM-MASTER-FOUND
  8456                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8457
  8458     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8459        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8460
  8461********************** MON CODE **********************
  8462     IF PB-COMPANY-ID = 'MON'
  8463     IF PB-ISSUE
  8464     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8465        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8466             PB-I-LOAN-APR = ZERO)
  8467               MOVE 14.0         TO PB-I-LOAN-APR.
  8468******************************************************
  8469
  8470     IF PB-COMPANY-ID = 'NCL'
  8471       IF PB-ISSUE
  8472           IF FORM-MASTER-FOUND
  8473             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8474                AM-DISMBR-COVERAGE
  8475                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8476                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8477                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8478                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8479                                           PB-I-LIFE-BENEFIT-CD.
  8480
  8481     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8482
  8483     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8484         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8485         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8486         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8487         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8488         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8489           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8490             GO TO 0301-LIFE-BENEFIT-SEARCH
  8491         ELSE
  8492             NEXT SENTENCE
  8493     ELSE
  8494         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8495
  8496     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8497     MOVE '4'                    TO CNTL-REC-TYPE.
  8498     MOVE +0                     TO CNTL-SEQ-NO.
  8499     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8500
  8501     MOVE '1' TO RC-SW-2.
  8502     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8503
  8504     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8505        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8506         GO TO 0305-BENEFIT-NOT-FOUND.
  8507
  8508     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 156
* EL050.cbl
  8509
  8510 0301-LIFE-BENEFIT-SEARCH.
  8511
  8512     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8513
  8514     IF NO-BENEFIT-FOUND
  8515        GO TO 0305-BENEFIT-NOT-FOUND.
  8516
  8517     IF WS-BEN-CD = '99'
  8518        GO TO 0305-BENEFIT-NOT-FOUND.
  8519
  8520     IF PB-COMPANY-ID = 'NCL'
  8521         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8522             GO TO 0304-LIFE-BENEFIT-FOUND.
  8523
  8524     MOVE +1                     TO SUB5.
  8525     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8526
  8527* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8528* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8529     IF PB-COMPANY-ID = 'DMD'
  8530         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8531
  8532 0302-EDIT-ACCT-LF-BENEFITS.
  8533
  8534     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8535        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8536           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8537                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8538           GO TO 03XX-GET-LIFE-ERPLAN.
  8539
  8540     IF SUB5 LESS THAN +20
  8541        ADD +1                   TO SUB5
  8542        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8543
  8544     MOVE +1                     TO SUB5.
  8545
  8546     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8547        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8548
  8549 0303-EDIT-DMD-EXTRA-BENEFITS.
  8550
  8551     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8552        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8553           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8554                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8555           GO TO 03XX-GET-LIFE-ERPLAN.
  8556
  8557     IF SUB5 LESS THAN +30
  8558        ADD +1                   TO SUB5
  8559        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8560
  8561     MOVE +1                     TO SUB5.
  8562
  8563 03XX-EDIT-FOR-NINETY-LF.
  8564
  8565***************************************************************
  8566*                                                             *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 157
* EL050.cbl
  8567*    NINETY BENEFIT PLAN TYPES:                               *
  8568*                                                             *
  8569*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8570*      92 = ALL GROUP REDUCING BENEFITS                       *
  8571*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8572*      94 = ALL GROUP LEVEL BENEFITS                          *
  8573*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8574*           BENEFIT CONTROLS.                                 *
  8575*      99 = ALL BENEFITS                                      *
  8576*                                                             *
  8577***************************************************************
  8578
  8579     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8580                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8581
  8582     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8583       AND
  8584        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8585        GO TO 03XX-GET-LIFE-ERPLAN.
  8586
  8587     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8588       AND
  8589        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8590        IF CF-REDUCING (SUB3)
  8591           IF (PB-I-INDV-GRP-OVRD = 'I')
  8592              OR
  8593           ((AM-IG = '1') AND
  8594           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8595              OR
  8596           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8597           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8598           (AM-IG NOT = '2'))
  8599              GO TO 03XX-GET-LIFE-ERPLAN.
  8600
  8601     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8602       AND
  8603        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8604        IF CF-REDUCING (SUB3)
  8605           IF (PB-I-INDV-GRP-OVRD = 'G')
  8606              OR
  8607           ((AM-IG = '2') AND
  8608           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8609              OR
  8610           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8611           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8612           (AM-IG NOT = '1'))
  8613              GO TO 03XX-GET-LIFE-ERPLAN.
  8614
  8615     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8616       AND
  8617        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8618        IF CF-LEVEL    (SUB3)
  8619           IF (PB-I-INDV-GRP-OVRD = 'I')
  8620              OR
  8621           ((AM-IG = '1') AND
  8622           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8623              OR
  8624           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 158
* EL050.cbl
  8625           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8626            (AM-IG NOT = '2'))
  8627              GO TO 03XX-GET-LIFE-ERPLAN.
  8628
  8629     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8630       AND
  8631        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8632        IF CF-LEVEL    (SUB3)
  8633           IF (PB-I-INDV-GRP-OVRD = 'G')
  8634              OR
  8635           ((AM-IG = '2') AND
  8636           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8637              OR
  8638           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8639           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8640           (AM-IG NOT = '1'))
  8641              GO TO 03XX-GET-LIFE-ERPLAN.
  8642
  8643     IF SUB5 LESS THAN +20
  8644        ADD +1                   TO SUB5
  8645        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8646
  8647     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8648
  8649     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8650        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8651
  8652     MOVE +1                     TO SUB5.
  8653
  8654 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8655
  8656     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8657                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8658
  8659     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8660       AND
  8661        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8662        GO TO 03XX-GET-LIFE-ERPLAN.
  8663
  8664     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8665       AND
  8666        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8667        IF CF-REDUCING (SUB3)
  8668           IF (PB-I-INDV-GRP-OVRD = 'I')
  8669              OR
  8670           ((AM-IG = '1') AND
  8671           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8672              OR
  8673           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8674           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8675           (AM-IG NOT = '2'))
  8676              GO TO 03XX-GET-LIFE-ERPLAN.
  8677
  8678     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8679       AND
  8680        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8681        IF CF-REDUCING (SUB3)
  8682           IF (PB-I-INDV-GRP-OVRD = 'G')
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 159
* EL050.cbl
  8683              OR
  8684           ((AM-IG = '2') AND
  8685           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8686              OR
  8687           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8688           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8689           (AM-IG NOT = '1'))
  8690              GO TO 03XX-GET-LIFE-ERPLAN.
  8691
  8692     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8693       AND
  8694        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8695        IF CF-LEVEL    (SUB3)
  8696           IF (PB-I-INDV-GRP-OVRD = 'I')
  8697              OR
  8698           ((AM-IG = '1') AND
  8699           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8700              OR
  8701           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8702           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8703            (AM-IG NOT = '2'))
  8704              GO TO 03XX-GET-LIFE-ERPLAN.
  8705
  8706     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8707       AND
  8708        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8709        IF CF-LEVEL    (SUB3)
  8710           IF (PB-I-INDV-GRP-OVRD = 'G')
  8711              OR
  8712           ((AM-IG = '2') AND
  8713           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8714              OR
  8715           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8716           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8717           (AM-IG NOT = '1'))
  8718              GO TO 03XX-GET-LIFE-ERPLAN.
  8719
  8720     IF SUB5 LESS THAN +30
  8721        ADD +1                   TO SUB5
  8722        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8723
  8724     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8725
  8726 03XX-EDIT-FOR-NINETY-LF-CONT.
  8727
  8728     MOVE +99                    TO SUB5.
  8729
  8730     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8731        IF PB-ISSUE
  8732           MOVE ER-1924          TO  WS-ERROR
  8733           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8734
  8735     GO TO 0304-LIFE-BENEFIT-FOUND.
  8736
  8737 03XX-GET-LIFE-ERPLAN.
  8738
  8739     IF WK-PLAN-ADDR EQUAL +0
  8740        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 160
* EL050.cbl
  8741
  8742     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8743     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8744     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8745     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8746     MOVE 'Y'                    TO PLAN-MASTER-SW
  8747                                    PLAN-MASTER-LIFE-SW.
  8748     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8749
  8750 03XX-ERPLAN-LIFE-GETMAIN.
  8751
  8752     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8753     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8754
  8755 03XX-ERPLAN-LIFE-READ.
  8756
  8757     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8758     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8759     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8760     MOVE PB-SV-STATE            TO PLAN-STATE.
  8761     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8762     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8763     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8764     MOVE WS-SAVE-BENEFIT-REVISION
  8765                                 TO PLAN-REVISION-NO.
  8766
  8767     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8768     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8769
  8770     IF PB-COMPANY-ID = 'NCL'
  8771       IF NOT LF-PLAN-MASTER-FOUND
  8772         IF NOT PB-POLICY-IS-DECLINED  AND
  8773            NOT PB-POLICY-IS-VOIDED
  8774             MOVE  ER-1921         TO  WS-ERROR
  8775             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8776             GO TO 0304-LIFE-BENEFIT-FOUND.
  8777
  8778     IF NOT LF-PLAN-MASTER-FOUND
  8779        GO TO 0304-LIFE-BENEFIT-FOUND.
  8780
  8781 XXXX-CHECK-LF-PLAN-KEY.
  8782
  8783     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8784        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8785        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8786        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8787        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8788        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8789        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8790        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8791        MOVE 'N'                 TO PLAN-MASTER-SW
  8792          GO TO 03XX-ERPLAN-LIFE-READ.
  8793
  8794     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8795
  8796     IF  PB-CANCELLATION
  8797         GO TO  0303-LF-ACCT-BEN-FOUND.
  8798
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 161
* EL050.cbl
  8799     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8800        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8801           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8802           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8803              MOVE ER-2644             TO WS-ERROR
  8804              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8805           ELSE
  8806              NEXT SENTENCE
  8807        ELSE
  8808           IF PB-COMPANY-ID NOT = 'NCL'
  8809              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8810                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8811
  8812 0303-LF-ACCT-BEN-FOUND.
  8813
  8814     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8815
  8816     IF PL-DEV-CODE NOT = SPACES
  8817        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8818
  8819     IF PL-DEV-PCT NUMERIC AND
  8820        PL-DEV-PCT NOT = ZEROS
  8821        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8822
  8823     IF PL-TOL-PREM-AMT GREATER THAN +0
  8824        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8825
  8826     IF PL-TOL-REF-AMT GREATER THAN +0
  8827        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8828
  8829     IF PL-TOL-PREM-PCT GREATER THAN +0
  8830        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8831
  8832     IF PL-TOL-REF-PCT GREATER THAN +0
  8833        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8834
  8835     IF PL-TOL-CLM-AMT GREATER THAN +0
  8836        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8837
  8838     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8839                          PL-OVER-SHORT-AMT > +0
  8840        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8841
  8842     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8843                          PL-OVER-SHORT-PCT > +0
  8844        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8845
  8846     IF PL-SALES-TAX NUMERIC AND
  8847                          PL-SALES-TAX > +0
  8848         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8849
  8850     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8851        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8852                                    WS-IG-OVRD-AM.
  8853
  8854 0304-LIFE-BENEFIT-FOUND.
  8855
  8856     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 162
* EL050.cbl
  8857
  8858     IF PB-ISSUE
  8859        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8860     ELSE
  8861        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8862
  8863     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8864     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8865     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8866     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8867     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8868                                         WS-LF-REFUND-CALC.
  8869     if (ws-lf-earnings-calc = '5')
  8870        and (pb-i-loan-apr = zeros)
  8871        and (benefit-code-chg)
  8872        move +99.9999 to pb-i-loan-apr
  8873     end-if
  8874
  8875     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8876        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8877
  8878     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8879        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8880     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8881
  8882     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8883     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8884     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8885     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8886     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8887     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8888
  8889     IF PB-COMPANY-ID = 'NCL'  AND
  8890        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8891         NEXT SENTENCE
  8892     ELSE
  8893         IF SUB5 NOT GREATER THAN +20
  8894            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8895               MOVE WS-SAVE-BENEFIT-REM-TERM
  8896                                      TO WS-AM-LF-BENE-REM-TERM
  8897                                         EC-BR-LF-REM-TERM-CALC.
  8898
  8899     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8900     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8901
  8902     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8903
  8904 0305-BENEFIT-NOT-FOUND.
  8905
  8906     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8907     MOVE ER-2604                TO WS-ERROR.
  8908     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8909
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 163
* EL050.cbl
  8911
  8912 0310-FIND-AH-BENEFIT-RECORD.
  8913
  8914     MOVE 'N'                    TO PLAN-MASTER-SW
  8915                                    PLAN-MASTER-AH-SW.
  8916
  8917     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8918                                    WS-PL-TOL-AH-REFUND
  8919                                    WS-AH-PL-REF-OVS-AMT
  8920                                    WS-PL-TOL-AH-PREM-PCT
  8921                                    WS-PL-TOL-AH-REFUND-PCT
  8922                                    WS-AH-PL-REF-OVS-PCT
  8923                                    WS-PL-TOL-AH-CLAIM.
  8924     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8925
  8926
  8927     if pb-issue
  8928        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8929           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8930        end-if
  8931        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8932           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8933           GO TO 0399-BENEFIT-NOT-FOUND
  8934        end-if
  8935     end-if
  8936
  8937     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8938        GO TO 0400-FIND-CARRIER.
  8939
  8940     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8941
  8942     IF WK-AH-BEN-ADDR NOT = ZEROS
  8943         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8944         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8945         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8946         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8947           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8948             GO TO 0311-AH-BENEFIT-SEARCH
  8949         ELSE
  8950             NEXT SENTENCE
  8951     ELSE
  8952         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8953
  8954     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8955     MOVE '5'                    TO CNTL-REC-TYPE.
  8956     MOVE +0                     TO CNTL-SEQ-NO.
  8957     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8958
  8959     MOVE '2' TO RC-SW-2.
  8960     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8961
  8962     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8963        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8964          GO TO 0399-BENEFIT-NOT-FOUND.
  8965
  8966     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8967
  8968 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 164
* EL050.cbl
  8969
  8970     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8971
  8972     IF NO-BENEFIT-FOUND
  8973         GO TO 0399-BENEFIT-NOT-FOUND.
  8974
  8975     IF WS-BEN-CD = '99'
  8976        GO TO 0399-BENEFIT-NOT-FOUND.
  8977
  8978     IF PB-COMPANY-ID  =  'NCL'
  8979         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8980             GO TO 0314-A-H-BENEFIT-FOUND.
  8981
  8982     MOVE +1                     TO SUB5.
  8983     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8984
  8985* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8986* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8987     IF PB-COMPANY-ID = 'DMD'
  8988         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8989
  8990 0312-EDIT-ACCT-AH-BENEFITS.
  8991
  8992     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8993        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8994           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8995                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8996           GO TO 03XX-GET-AH-ERPLAN.
  8997
  8998     IF SUB5 LESS THAN +20
  8999        ADD +1                   TO SUB5
  9000        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9001
  9002     MOVE +1                     TO SUB5.
  9003
  9004     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9005        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9006
  9007 0313-EDIT-DMD-EXTRA-BENEFITS.
  9008
  9009     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9010        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9011           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9012                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9013           GO TO 03XX-GET-AH-ERPLAN.
  9014
  9015     IF SUB5 LESS THAN +30
  9016        ADD +1                   TO SUB5
  9017        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9018
  9019     MOVE +1                     TO SUB5.
  9020
  9021 03XX-EDIT-FOR-NINETY-AH.
  9022
  9023***************************************************************
  9024*                                                             *
  9025*    NINETY BENEFIT PLAN TYPES:                               *
  9026*                                                             *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 165
* EL050.cbl
  9027*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9028*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9029*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9030*           BENEFIT CONTROLS.                                 *
  9031*      99 = ALL BENEFITS.                                     *
  9032*                                                             *
  9033***************************************************************
  9034
  9035     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9036                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9037
  9038     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9039       AND
  9040        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9041        GO TO 03XX-GET-AH-ERPLAN.
  9042
  9043     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9044       AND
  9045        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9046           IF (PB-I-INDV-GRP-OVRD = 'I')
  9047              OR
  9048           ((AM-IG = '1') AND
  9049           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9050              OR
  9051           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9052           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9053           (AM-IG NOT = '2'))
  9054              GO TO 03XX-GET-AH-ERPLAN.
  9055
  9056     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9057       AND
  9058        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9059           IF (PB-I-INDV-GRP-OVRD = 'G')
  9060              OR
  9061           ((AM-IG = '2') AND
  9062           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9063              OR
  9064           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9065           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9066           (AM-IG NOT = '1'))
  9067              GO TO 03XX-GET-AH-ERPLAN.
  9068
  9069     IF SUB5 LESS THAN +20
  9070        ADD +1                   TO SUB5
  9071        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9072
  9073     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9074        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9075
  9076     MOVE +1                    TO SUB5.
  9077
  9078 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9079
  9080     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9081                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9082
  9083     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9084       AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 166
* EL050.cbl
  9085        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9086        GO TO 03XX-GET-AH-ERPLAN.
  9087
  9088     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9089       AND
  9090        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9091           IF (PB-I-INDV-GRP-OVRD = 'I')
  9092              OR
  9093           ((AM-IG = '1') AND
  9094           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9095              OR
  9096           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9097           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9098           (AM-IG NOT = '2'))
  9099              GO TO 03XX-GET-AH-ERPLAN.
  9100
  9101     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9102       AND
  9103        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9104           IF (PB-I-INDV-GRP-OVRD = 'G')
  9105              OR
  9106           ((AM-IG = '2') AND
  9107           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9108              OR
  9109           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9110           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9111           (AM-IG NOT = '1'))
  9112              GO TO 03XX-GET-AH-ERPLAN.
  9113
  9114     IF SUB5 LESS THAN +30
  9115        ADD +1                   TO SUB5
  9116        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9117
  9118 03XX-EDIT-FOR-NINETY-AH-CONT.
  9119
  9120     MOVE +99                    TO SUB5.
  9121
  9122     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9123
  9124     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9125        IF PB-ISSUE
  9126           MOVE ER-1925          TO  WS-ERROR
  9127           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9128
  9129     GO TO 0314-A-H-BENEFIT-FOUND.
  9130
  9131 03XX-GET-AH-ERPLAN.
  9132
  9133     IF WK-PLAN-ADDR EQUAL +0
  9134         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9135
  9136     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9137     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9138     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9139     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9140     MOVE 'Y'                    TO PLAN-MASTER-SW
  9141                                    PLAN-MASTER-AH-SW.
  9142*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 167
* EL050.cbl
  9143     GO TO 03XX-ERPLAN-AH-READ.
  9144
  9145 03XX-ERPLAN-AH-GETMAIN.
  9146
  9147     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9148     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9149
  9150 03XX-ERPLAN-AH-READ.
  9151
  9152     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9153     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9154     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9155     MOVE PB-SV-STATE            TO PLAN-STATE.
  9156     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9157     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9158     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9159     MOVE WS-SAVE-BENEFIT-REVISION
  9160                                 TO PLAN-REVISION-NO.
  9161
  9162     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9163     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9164
  9165     IF PB-COMPANY-ID = 'NCL'
  9166       IF NOT AH-PLAN-MASTER-FOUND
  9167         IF NOT PB-POLICY-IS-DECLINED  AND
  9168            NOT PB-POLICY-IS-VOIDED
  9169             MOVE  ER-1922         TO  WS-ERROR
  9170             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9171             GO TO 0314-A-H-BENEFIT-FOUND.
  9172
  9173     IF NOT AH-PLAN-MASTER-FOUND
  9174        GO TO 0314-A-H-BENEFIT-FOUND.
  9175
  9176 XXXX-CHECK-AH-PLAN-KEY.
  9177
  9178     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9179        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9180        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9181        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9182        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9183        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9184        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9185        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9186        MOVE 'N'                 TO PLAN-MASTER-SW
  9187          GO TO 03XX-ERPLAN-AH-READ.
  9188
  9189     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9190
  9191     IF  PB-CANCELLATION
  9192         GO TO  0313-AH-ACCT-BEN-FOUND.
  9193
  9194     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9195       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9196          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9197          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9198             MOVE ER-2644             TO WS-ERROR
  9199             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9200          ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 168
* EL050.cbl
  9201             NEXT SENTENCE
  9202       ELSE
  9203          IF PB-COMPANY-ID NOT = 'NCL'
  9204             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9205                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9206
  9207 0313-AH-ACCT-BEN-FOUND.
  9208
  9209     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9210
  9211     IF PL-DEV-CODE NOT = SPACES
  9212        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9213
  9214     IF PL-DEV-PCT NUMERIC AND
  9215        PL-DEV-PCT NOT = ZEROS
  9216        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9217
  9218     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9219        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9220
  9221     IF PL-TOL-REF-AMT NOT EQUAL +0
  9222        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9223
  9224     IF PL-TOL-PREM-PCT GREATER THAN +0
  9225        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9226
  9227     IF PL-TOL-REF-PCT GREATER THAN +0
  9228        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9229
  9230     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9231        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9232
  9233     IF PL-OVER-SHORT-AMT NUMERIC AND
  9234                          PL-OVER-SHORT-AMT > +0
  9235        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9236
  9237     IF PL-OVER-SHORT-PCT NUMERIC AND
  9238                          PL-OVER-SHORT-PCT > +0
  9239        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9240
  9241     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9242        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9243        IF WS-IG-OVRD-AM EQUAL SPACES
  9244            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9245
  9246 0314-A-H-BENEFIT-FOUND.
  9247
  9248     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9249
  9250     IF PB-ISSUE
  9251        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9252       ELSE
  9253        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9254
  9255     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9256     if cf-maximum-benefits (sub3) numeric
  9257        move cf-maximum-benefits (sub3)
  9258                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 169
* EL050.cbl
  9259     else
  9260        move zeros               to ws-ah-max-bens
  9261     end-if
  9262     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9263     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9264     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9265                                         WS-AH-REFUND-CALC.
  9266
  9267     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9268        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9269
  9270     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9271        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9272     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9273
  9274     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9275     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9276     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9277     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9278     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9279     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9280
  9281     IF PB-COMPANY-ID = 'NCL'  AND
  9282        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9283         NEXT SENTENCE
  9284     ELSE
  9285         IF SUB5 NOT GREATER THAN +20
  9286            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9287                MOVE WS-SAVE-BENEFIT-REM-TERM
  9288                                      TO WS-AM-AH-BENE-REM-TERM
  9289                                         EC-BR-AH-REM-TERM-CALC.
  9290
  9291     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9292     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9293
  9294     GO TO 0400-FIND-CARRIER.
  9295
  9296 0399-BENEFIT-NOT-FOUND.
  9297
  9298     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9299     MOVE ER-2605                TO WS-ERROR.
  9300     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9301
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 170
* EL050.cbl
  9303
  9304 0400-FIND-CARRIER.
  9305
  9306     MOVE PB-SV-CARRIER          TO WS-CARR.
  9307
  9308     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9309     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9310     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9311     MOVE '6'                    TO CNTL-REC-TYPE.
  9312
  9313*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9314     MOVE SPACE                  TO WS-DMD-RATING-SW
  9315                                    EC-BR-DMD-RATING-SW.
  9316
  9317     MOVE '2'                    TO RC-SW-1.
  9318     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9319
  9320     IF NOT CF-CARRIER-MASTER
  9321        GO TO 0400-CARRIER-NOT-FOUND.
  9322
  9323 0400-BUILD-CARR-TOL.
  9324
  9325     IF CF-CR-TOL-PREM NUMERIC AND
  9326        CF-CR-TOL-PREM GREATER THAN +0
  9327        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9328                                    WS-TOL-AH-PREM.
  9329
  9330     IF CF-CR-TOL-REFUND NUMERIC AND
  9331        CF-CR-TOL-REFUND GREATER THAN +0
  9332        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9333                                    WS-TOL-AH-REFUND.
  9334
  9335     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9336        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9337        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9338                                    WS-AH-REFUND-OVS-AMT.
  9339
  9340     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9341        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9342        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9343                                    WS-AH-REFUND-OVS-PCT.
  9344
  9345     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9346        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9347        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9348                                    WS-TOL-AH-PREM-PCT.
  9349
  9350     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9351        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9352        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9353                                     WS-TOL-AH-REFUND-PCT.
  9354
  9355     IF CF-COMPANY-ID EQUAL 'DMD'
  9356         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9357                                    EC-BR-DMD-RATING-SW.
  9358
  9359     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9360     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 171
* EL050.cbl
  9361        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9362     END-IF
  9363     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9364        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9365     END-IF
  9366     IF WS-TOL-CLP-PCT = ZEROS
  9367        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9368     END-IF
  9369
  9370     IF WS-SPP-LEASE-COMM = ZEROS
  9371        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9372     END-IF
  9373     GO TO 0400-FIND-ERPDEF.
  9374
  9375 0400-CARRIER-NOT-FOUND.
  9376
  9377     MOVE ER-2602                TO WS-ERROR.
  9378     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9379
  9380 0400-FIND-ERPDEF.
  9381     IF PB-COMPANY-ID = 'DCC'
  9382        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9383        CONTINUE
  9384     ELSE
  9385        GO TO 0400-FIND-ERCOMP
  9386     END-IF
  9387     MOVE ' '                    TO PDEF-MASTER-SW
  9388     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9389     MOVE PB-STATE               TO ERPDEF-STATE
  9390     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9391     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9392     IF PB-ISSUE
  9393        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9394     ELSE
  9395        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9396     END-IF
  9397     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9398     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9399     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9400     IF PDEF-MASTER-FOUND
  9401        MOVE 'N'                 TO PDEF-MASTER-SW
  9402        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9403        IF PDEF-MASTER-FOUND
  9404           IF (ERPDEF-KEY-SAVE (1:16) =
  9405                        PD-CONTROL-PRIMARY (1:16))
  9406              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9407              CONTINUE
  9408           ELSE
  9409              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9410              IF (ERPDEF-KEY-SAVE (1:16) =
  9411                        PD-CONTROL-PRIMARY (1:16))
  9412                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9413                 CONTINUE
  9414              ELSE
  9415                 MOVE 'N'        TO PDEF-MASTER-SW
  9416              END-IF
  9417           END-IF
  9418        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 172
* EL050.cbl
  9419        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9420     END-IF
  9421     IF PDEF-MASTER-FOUND
  9422        IF PD-TRUNCATED = 'Y'
  9423           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9424        END-IF
  9425     END-IF
  9426     .
  9427 0400-FIND-ERCOMP.
  9428     IF PB-COMPANY-ID = 'DCC'
  9429        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9430           (WS-SUB1 > +10)
  9431           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9432                 OR 'A' OR 'N'
  9433              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9434              MOVE PB-CARRIER    TO COMP-CARRIER
  9435              MOVE PB-GROUPING   TO COMP-GROUPING
  9436              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9437              MOVE AM-AGT (WS-SUB1)
  9438                                 TO COMP-FIN-RESP
  9439              MOVE 'G'           TO COMP-TYPE
  9440              PERFORM 8582-READ-COMPENSATION-MASTER
  9441                                 THRU 8582-EXIT
  9442              IF COMP-MASTER-FOUND
  9443                 IF CO-GA-INACTIVE
  9444                    MOVE ER-2763 TO WS-ERROR
  9445                    PERFORM 9900-ERROR-FORMAT
  9446                                 THRU 9900-EXIT
  9447                    MOVE +11     TO WS-SUB1
  9448                 END-IF
  9449                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9450                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9451                    MOVE ER-2788 TO WS-ERROR
  9452                    PERFORM 9900-ERROR-FORMAT
  9453                                 THRU 9900-EXIT
  9454                    MOVE +11     TO WS-SUB1
  9455                 END-IF
  9456              END-IF
  9457           END-IF
  9458        END-PERFORM
  9459     END-IF
  9460     IF PB-COMPANY-ID = 'DCC'
  9461        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9462           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9463                                    WS-CLP-STATE
  9464        ELSE
  9465           MOVE SPACES           TO PB-I-CLP-STATE
  9466                                    WS-CLP-STATE
  9467        END-IF
  9468     END-IF
  9469
  9470     IF (PB-COMPANY-ID = 'DCC')
  9471        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9472        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9473        CONTINUE
  9474     ELSE
  9475        GO TO 0400-FIND-STATE-RECORD
  9476     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 173
* EL050.cbl
  9477     MOVE SPACES                 TO WS-CLP-STATE
  9478     MOVE +0                     TO WS-BANK-FEE
  9479                                    WS-BANK-LFEE
  9480                                    WS-BANK-NOCHRGB
  9481
  9482     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9483     IF (PB-ISSUE)
  9484        AND (PB-I-BANK-NUMBER NOT =
  9485            SPACES AND ZEROS AND LOW-VALUES)
  9486        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9487     ELSE
  9488        IF (PB-CANCELLATION)
  9489           AND (PB-CI-BANK-NUMBER NOT =
  9490                SPACES AND ZEROS AND LOW-VALUES)
  9491           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9492        END-IF
  9493     END-IF
  9494     IF COMP-FIN-RESP NOT = LOW-VALUES
  9495        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9496        MOVE PB-CARRIER          TO COMP-CARRIER
  9497        MOVE PB-GROUPING         TO COMP-GROUPING
  9498        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9499        MOVE 'B'                 TO COMP-TYPE
  9500        PERFORM 8582-READ-COMPENSATION-MASTER
  9501                                 THRU 8582-EXIT
  9502        IF COMP-MASTER-FOUND
  9503           IF CO-MAX-BANK-FEE NOT NUMERIC
  9504              MOVE +0            TO CO-MAX-BANK-FEE
  9505           END-IF
  9506           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9507              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9508           END-IF
  9509           IF CO-GA-INACTIVE
  9510              MOVE ER-2763       TO WS-ERROR
  9511              PERFORM 9900-ERROR-FORMAT
  9512                                 THRU 9900-EXIT
  9513           END-IF
  9514           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9515              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9516              MOVE ER-2788 TO WS-ERROR
  9517              PERFORM 9900-ERROR-FORMAT
  9518                                 THRU 9900-EXIT
  9519              MOVE +11     TO WS-SUB1
  9520           END-IF
  9521           IF WS-AH-BEN-CATEGORY = 'G'
  9522              MOVE CO-MAX-BANK-FEE
  9523                                 TO WS-BANK-FEE
  9524                                    PB-I-BANK-FEE
  9525           ELSE
  9526              MOVE CO-MAX-BANK-FEE-LEASE
  9527                                 TO WS-BANK-LFEE
  9528                                    PB-I-BANK-FEE
  9529           END-IF
  9530           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9531              AND (WS-AH-REFUND-CALC = 'G'))
  9532                        OR
  9533              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9534              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 174
* EL050.cbl
  9535              CONTINUE
  9536           ELSE
  9537              MOVE ER-2789 TO WS-ERROR
  9538              PERFORM 9900-ERROR-FORMAT
  9539                                 THRU 9900-EXIT
  9540           END-IF
  9541           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9542                                    PB-I-CLP-STATE
  9543           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9544           MOVE CO-CARRIER       TO BXRF-CARRIER
  9545           MOVE CO-GROUPING      TO BXRF-GROUPING
  9546           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9547           MOVE BXRF-MAX-REC-LENGTH
  9548                                 TO BXRF-REC-LENGTH
  9549           PERFORM 8584-READ-BANK-CROSS-REF
  9550                                 THRU 8584-EXIT
  9551           IF BXRF-MASTER-FOUND
  9552              MOVE ' '           TO BANK-ACCT-SW
  9553              MOVE BK-BANK-POINTER-CNT
  9554                                 TO BK-BANK-POINTER-CNT
  9555              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9556                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9557                 OR (BANK-ACCT-FOUND)
  9558                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9559                    AND (BK-AM-EXP-DT (WS-SUB1)
  9560                                 > PB-CERT-EFF-DT)
  9561                    AND (BK-AM-EFF-DT (WS-SUB1)
  9562                                 NOT > PB-CERT-EFF-DT)
  9563                    SET BANK-ACCT-FOUND TO TRUE
  9564                 END-IF
  9565              END-PERFORM
  9566              IF NOT BANK-ACCT-FOUND
  9567                 MOVE ZEROS      TO WS-BANK-FEE
  9568                                    WS-BANK-LFEE
  9569                 MOVE ER-2869    TO WS-ERROR
  9570                 PERFORM 9900-ERROR-FORMAT
  9571                                 THRU 9900-EXIT
  9572              ELSE
  9573                 PERFORM 5000-PROCESS-REPS
  9574                                 THRU 5000-EXIT
  9575                 IF AGENT-MASTER-FOUND
  9576                    MOVE +0      TO WS-BANK-FEE
  9577                                    WS-BANK-LFEE
  9578*                   MOVE AG-SPP-FEES (1)
  9579*                                TO PB-I-BANK-FEE
  9580*                                   WS-BANK-FEE
  9581                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9582                       (WS-SUB1 > +10)
  9583                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9584                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9585                       END-IF
  9586                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9587                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9588                       END-IF
  9589                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9590                          AG-SPP-FEES (WS-SUB1)
  9591                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9592                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 175
* EL050.cbl
  9593                    END-PERFORM
  9594                    IF WS-AH-BEN-CATEGORY = 'G'
  9595                       MOVE WS-BANK-FEE
  9596                                 TO PB-I-BANK-FEE
  9597                    ELSE
  9598                       MOVE WS-BANK-LFEE
  9599                                 TO PB-I-BANK-FEE
  9600                    END-IF
  9601                 END-IF
  9602              END-IF
  9603           END-IF
  9604        ELSE
  9605           MOVE ER-2879          TO WS-ERROR
  9606           PERFORM 9900-ERROR-FORMAT
  9607                                 THRU 9900-EXIT
  9608        END-IF
  9609     ELSE
  9610        MOVE ER-2879             TO WS-ERROR
  9611        PERFORM 9900-ERROR-FORMAT
  9612                                 THRU 9900-EXIT
  9613     END-IF
  9614     IF WS-AH-BEN-CATEGORY = 'G'
  9615        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9616        + WS-BANK-FEE
  9617     ELSE
  9618        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9619        + WS-BANK-LFEE
  9620     END-IF
  9621     .
  9622 0400-FIND-STATE-RECORD.
  9623
  9624     IF WK-STATE-ADDR NOT = ZEROS
  9625         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9626         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9627         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9628         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9629         IF PB-SV-STATE = CF-STATE-CODE
  9630             GO TO 0405-CONTINUE-EDIT
  9631         ELSE
  9632             NEXT SENTENCE
  9633     ELSE
  9634         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9635
  9636     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9637     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9638     MOVE '3'                    TO CNTL-REC-TYPE.
  9639     MOVE +0                     TO CNTL-SEQ-NO.
  9640
  9641     MOVE '3'                    TO RC-SW-2.
  9642     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9643
  9644     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9645        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9646        PB-SV-STATE   NOT = CF-STATE-CODE)
  9647        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9648                                    WS-TOL-AH-CLAIM
  9649                                    WS-MINIMUM-REFUND
  9650                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 176
* EL050.cbl
  9651                                    WS-TOL-AH-PREM
  9652                                    WS-TOL-LF-REFUND
  9653                                    WS-TOL-AH-REFUND
  9654                                    EC-ST-TOL-PREM-PCT
  9655                                    WS-TOL-LF-PREM-PCT
  9656                                    WS-TOL-AH-PREM-PCT
  9657                                    EC-ST-TOL-REFUND-PCT
  9658                                    WS-TOL-LF-REFUND-PCT
  9659                                    WS-TOL-AH-REFUND-PCT
  9660                                    EC-ST-TOL-PREM
  9661                                    EC-ST-TOL-REFUND
  9662                                    EC-ST-FST-PMT-DAYS-MAX
  9663                                    WS-FREE-LOOK-PERIOD
  9664                                    WS-ST-LF-PREM-TAX
  9665                                    WS-ST-AH-PREM-TAX-I
  9666                                    WS-ST-AH-PREM-TAX-G
  9667                                    WS-BANK-FEE
  9668                                    WS-BANK-LFEE
  9669                                    WS-TOL-CLP-PCT
  9670                                    WS-SPP-LEASE-COMM
  9671        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9672                                    EC-ST-FST-PMT-DAYS-CHG
  9673                                    WS-LF-REM-TERM-CALC
  9674                                    WS-LF-REFUND-CALC
  9675                                    EC-ST-LF-REM-TERM-CALC
  9676                                    EC-ST-LF-REFUND-CALC
  9677                                    WS-AH-REM-TERM-CALC
  9678                                    WS-AH-REFUND-CALC
  9679                                    WS-LF-BEN-CATEGORY
  9680                                    WS-AH-BEN-CATEGORY
  9681                                    WS-CLP-STATE
  9682                                    WS-ST-REFUND-CLAIM-FLAG
  9683                                    WS-ST-CAUSAL-STATE
  9684                                    EC-ST-AH-REM-TERM-CALC
  9685                                    EC-ST-AH-REFUND-CALC
  9686          GO TO 0499-STATE-NOT-FOUND.
  9687
  9688     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9689
  9690 0405-CONTINUE-EDIT.
  9691
  9692     if pb-company-id = 'AHL'
  9693        continue
  9694     else
  9695        IF PB-CERT-PRIME NOT NUMERIC
  9696           MOVE ER-2722          TO WS-ERROR
  9697           PERFORM 9900-ERROR-FORMAT
  9698                                 THRU 9900-EXIT
  9699        end-if
  9700     END-IF
  9701*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9702*       MOVE +0                  TO SUB3
  9703*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9704*       IF SUB3 > +0
  9705*          MOVE ER-2722          TO WS-ERROR
  9706*          PERFORM 9900-ERROR-FORMAT
  9707*                                THRU 9900-EXIT
  9708*       END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 177
* EL050.cbl
  9709*    END-IF
  9710*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9711*       IF PB-CERT-PRIME NOT NUMERIC
  9712*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9713*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9714*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9715*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9716*
  9717*          MOVE ER-2722          TO WS-ERROR
  9718*          PERFORM 9900-ERROR-FORMAT
  9719*                                THRU 9900-EXIT
  9720*       END-IF
  9721*    END-IF
  9722
  9723     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9724
  9725     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9726        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9727                                    WS-TOL-AH-CLAIM.
  9728
  9729     IF CF-ST-REFUND-MIN NOT NUMERIC
  9730        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9731
  9732     IF CF-ST-REFUND-MIN NOT = ZEROS
  9733        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9734
  9735     IF CF-ST-TOL-PREM  NOT = ZEROS
  9736        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9737                                    WS-TOL-AH-PREM
  9738        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9739
  9740     IF CF-ST-TOL-REFUND NOT = ZEROS
  9741        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9742                                    WS-TOL-AH-REFUND
  9743        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9744
  9745     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9746        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9747        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9748                                    WS-AH-REFUND-OVS-AMT
  9749                                    EC-ST-OVR-SHT-AMT.
  9750
  9751     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9752        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9753        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9754                                    WS-TOL-LF-PREM-PCT
  9755                                    WS-TOL-AH-PREM-PCT.
  9756
  9757     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9758        CF-ST-TOL-REF-PCT GREATER THAN +0
  9759        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9760                                    WS-TOL-LF-REFUND-PCT
  9761                                    WS-TOL-AH-REFUND-PCT.
  9762
  9763     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9764        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9765        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9766                                    WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 178
* EL050.cbl
  9767                                    EC-ST-OVR-SHT-PCT.
  9768
  9769     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9770     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9771
  9772     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9773          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9774
  9775     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9776     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9777     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9778
  9779     IF CF-ST-LF-PREM-TAX NUMERIC
  9780        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9781     END-IF
  9782     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9783        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9784     END-IF
  9785     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9786        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9787     END-IF
  9788
  9789     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9790         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9791     END-IF.
  9792
  9793     IF CF-ST-CAUSAL-STATE > SPACES
  9794         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9795     END-IF.
  9796
  9797     IF WS-LF-BENEFIT-CD = ZEROS
  9798        GO TO 0410-CHECK-AH.
  9799
  9800     IF CF-ST-RT-CALC NOT = SPACES
  9801        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9802                                    EC-ST-LF-REM-TERM-CALC
  9803     END-IF
  9804
  9805     IF WS-LF-COVERAGE-TYPE = 'R'
  9806        IF WS-LF-EARNINGS-CALC = '5'
  9807           IF CF-ST-RF-LN-CALC > '0'
  9808              MOVE CF-ST-RF-LN-CALC
  9809                                 TO WS-LF-REFUND-CALC
  9810                                    EC-ST-LF-REFUND-CALC
  9811           END-IF
  9812        ELSE
  9813           IF CF-ST-RF-LR-CALC > '0'
  9814              MOVE CF-ST-RF-LR-CALC
  9815                                 TO WS-LF-REFUND-CALC
  9816                                    EC-ST-LF-REFUND-CALC
  9817           END-IF
  9818        END-IF
  9819     ELSE
  9820        IF CF-ST-RF-LL-CALC > '0'
  9821           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9822                                    EC-ST-LF-REFUND-CALC
  9823        END-IF
  9824     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 179
* EL050.cbl
  9825
  9826     IF CF-ST-RT-CALC NOT = SPACES
  9827        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9828                                    EC-ST-LF-REM-TERM-CALC
  9829     END-IF
  9830
  9831     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9832     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9833
  9834     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9835
  9836     IF NO-BENEFIT-FOUND
  9837        GO TO 0410-CHECK-AH.
  9838
  9839     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9840        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9841                                 TO EC-ST-LF-REM-TERM-CALC
  9842                                    WS-LF-REM-TERM-CALC
  9843     END-IF
  9844
  9845     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9846        MOVE CF-ST-REFUND-CALC (SUB3)
  9847                                 TO WS-LF-REFUND-CALC
  9848                                    EC-ST-LF-REFUND-CALC
  9849     END-IF
  9850*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9851
  9852     .
  9853 0410-CHECK-AH.
  9854
  9855     IF WS-AH-BENEFIT-CD = ZEROS
  9856        GO TO 0500-SET-ACCOUNT.
  9857
  9858     IF CF-ST-RT-CALC NOT = SPACES
  9859        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9860                                    EC-ST-AH-REM-TERM-CALC
  9861     END-IF
  9862
  9863     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9864        IF CF-ST-RF-CP-CALC > '0'
  9865           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9866                                    EC-ST-AH-REFUND-CALC
  9867        END-IF
  9868     ELSE
  9869        IF CF-ST-RF-AH-CALC > '0'
  9870           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9871                                    EC-ST-AH-REFUND-CALC
  9872        END-IF
  9873     END-IF
  9874     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9875     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9876
  9877     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9878
  9879     IF NO-BENEFIT-FOUND
  9880        GO TO 0500-SET-ACCOUNT.
  9881
  9882     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 180
* EL050.cbl
  9883        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9884                                 TO WS-AH-REM-TERM-CALC
  9885                                    EC-ST-AH-REM-TERM-CALC
  9886     END-IF
  9887
  9888     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9889        MOVE CF-ST-REFUND-CALC (SUB3)
  9890                                 TO WS-AH-REFUND-CALC
  9891                                    EC-ST-AH-REFUND-CALC
  9892     END-IF
  9893
  9894*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9895
  9896     GO TO 0500-SET-ACCOUNT.
  9897
  9898 0499-STATE-NOT-FOUND.
  9899
  9900     MOVE ER-2603                TO WS-ERROR.
  9901     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9902
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 181
* EL050.cbl
  9904
  9905 0500-SET-ACCOUNT.
  9906*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9907     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9908        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9909        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9910        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9911        MOVE '3'                 TO CNTL-REC-TYPE
  9912        MOVE +0                  TO CNTL-SEQ-NO
  9913
  9914        MOVE '3'                 TO RC-SW-2
  9915        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9916
  9917        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9918           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9919           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9920           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9921                                    WS-ST-AH-PREM-TAX-I
  9922                                    WS-ST-AH-PREM-TAX-G
  9923        ELSE
  9924           IF CF-ST-LF-PREM-TAX NUMERIC
  9925              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9926           END-IF
  9927           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9928              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9929           END-IF
  9930           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9931              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9932           END-IF
  9933        END-IF
  9934        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9935     END-IF
  9936*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9937*  FOR DCC ONLY
  9938     IF PB-COMPANY-ID = 'DCC'
  9939
  9940     MOVE ' '                    TO STAT-MASTER-SW
  9941     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9942     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9943     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9944     MOVE PB-STATE               TO ELSTAT-STATE
  9945     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9946        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9947     END-IF
  9948
  9949     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9950     SET BIN-TO-GREG             TO TRUE
  9951     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9952     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9953     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9954
  9955     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9956     IF STAT-MASTER-FOUND
  9957        MOVE 'N'                 TO STAT-MASTER-SW
  9958        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9959        IF STAT-MASTER-FOUND
  9960           IF (ELSTAT-KEY-SAVE (1:12) =
  9961                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 182
* EL050.cbl
  9962              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9963                 MOVE 'F'        TO STAT-MASTER-SW
  9964              ELSE
  9965                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9966                 IF (STAT-MASTER-FOUND)
  9967                    AND (ELSTAT-KEY-SAVE (1:12) =
  9968                        SF-CONTROL-PRIMARY (1:12))
  9969                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9970                    MOVE 'F'     TO STAT-MASTER-SW
  9971                 END-IF
  9972              END-IF
  9973           END-IF
  9974        END-IF
  9975     END-IF
  9976
  9977     IF STAT-MASTER-SW = 'F'
  9978        IF SF-ST-LF-PREM-TAX NUMERIC
  9979           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9980        END-IF
  9981        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9982           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9983        END-IF
  9984        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9985           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9986        END-IF
  9987     END-IF
  9988
  9989     END-IF
  9990     IF (PB-COMPANY-ID = 'DCC')
  9991        AND (PB-ISSUE)
  9992        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9993        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9994        AND (AM-GPCD = 06)
  9995        MOVE 'Y'                 TO WS-GOOD-HIN
  9996        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9997           MOVE PB-I-VIN         TO WS-WORK-VIN
  9998           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9999              (V1 > 16)
 10000              IF WS-WORK-VIN (V1:1) NUMERIC
 10001                 MOVE WS-WORK-VIN-N (V1)
 10002                                 TO WS-ROW-B-VAL (V1)
 10003              ELSE
 10004                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10005                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10006                    OR (V2 > 26)
 10007                 END-PERFORM
 10008                 IF V2 < 27
 10009                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10010                 ELSE
 10011                    MOVE 'N'     TO WS-GOOD-HIN
 10012                 END-IF
 10013              END-IF
 10014              COMPUTE WS-ROW-D-VAL (V1) =
 10015                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10016              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10017                 WS-ROW-D-VAL (V1)
 10018           END-PERFORM
 10019           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 183
* EL050.cbl
 10020           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10021             REMAINDER WS-VIN-REMAINDER
 10022           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10023              CONTINUE
 10024           ELSE
 10025              MOVE 'N'           TO WS-GOOD-HIN
 10026           END-IF
 10027        ELSE
 10028           MOVE 'N'              TO WS-GOOD-HIN
 10029        END-IF
 10030        IF WS-GOOD-HIN NOT = 'Y'
 10031           MOVE ER-3826           TO WS-ERROR
 10032           PERFORM 9900-ERROR-FORMAT
 10033                                 THRU 9900-EXIT
 10034        END-IF
 10035     END-IF
 10036     IF (PB-COMPANY-ID = 'DCC')
 10037        AND (PB-ISSUE)
 10038        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10039        AND (AM-GPCD NOT = 06)
 10040        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10041          MOVE PB-I-VIN          TO WS-WORK-VIN
 10042          MOVE +8                TO V2
 10043          MOVE ZEROS             TO WS-VIN-TOTAL
 10044          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10045           (V1 > 17)
 10046             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10047                MOVE ER-3825     TO WS-ERROR
 10048                PERFORM 9900-ERROR-FORMAT
 10049                                 THRU 9900-EXIT
 10050             ELSE
 10051                IF V1 = 8
 10052                   MOVE 10       TO V2
 10053                END-IF
 10054                IF V1 = 9
 10055                   MOVE 0        TO V2
 10056                END-IF
 10057                IF V1 = 10
 10058                   MOVE 9        TO V2
 10059                END-IF
 10060                IF WS-WORK-VIN (V1:1) NUMERIC
 10061                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10062                    + (WS-WORK-VIN-N (V1) * V2)
 10063                ELSE
 10064                   MOVE WS-WORK-VIN (V1:1)
 10065                                 TO WS-HEX-BYTE
 10066                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10067                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10068                    + (WS-NUM (V3) * V2)
 10069                END-IF
 10070                COMPUTE V2 = V2 - 1
 10071             END-IF
 10072          END-PERFORM
 10073          MOVE ZEROS TO WS-VIN-REMAINDER
 10074          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10075             REMAINDER WS-VIN-REMAINDER
 10076          IF ((WS-WORK-VIN (9:1) = 'X')
 10077             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 184
* EL050.cbl
 10078                     OR
 10079             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10080             CONTINUE
 10081          ELSE
 10082             MOVE ER-3826        TO WS-ERROR
 10083             PERFORM 9900-ERROR-FORMAT
 10084                                 THRU 9900-EXIT
 10085          END-IF
 10086        ELSE
 10087          MOVE ER-3826           TO WS-ERROR
 10088          PERFORM 9900-ERROR-FORMAT
 10089                                 THRU 9900-EXIT
 10090        END-IF
 10091     END-IF
 10092******************************************************************
 10093******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10094******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10095******* METHODS.
 10096******************************************************************
 10097     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10098        IF PB-CANCELLATION
 10099           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10100              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10101                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10102                IF FORM-MASTER-FOUND
 10103                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10104******************************************************************
 10105
 10106     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10107     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10108
 10109     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10110     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10111     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10112     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10113
 10114
 10115     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10116     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10117     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10118
 10119     IF AM-LF-OB-RATE NOT NUMERIC
 10120         MOVE ZERO               TO AM-LF-OB-RATE.
 10121
 10122     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10123         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10124
 10125     IF AM-AH-OB-RATE NOT NUMERIC
 10126         MOVE ZERO               TO AM-AH-OB-RATE.
 10127
 10128     IF WS-LF-JOINT-INDICATOR = 'J'
 10129         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10130     ELSE
 10131         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10132
 10133     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10134
 10135     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 185
* EL050.cbl
 10136         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10137
 10138     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10139         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10140                                       WS-IG-OVRD
 10141     ELSE
 10142         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10143             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10144                                       WS-IG-OVRD
 10145         ELSE
 10146             MOVE AM-IG             TO WS-IG-OVRD-AH
 10147                                       WS-IG-OVRD.
 10148
 10149     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10150         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10151                                       WS-IG-OVRD
 10152     ELSE
 10153         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10154             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10155                                       WS-IG-OVRD
 10156         ELSE
 10157             MOVE AM-IG             TO WS-IG-OVRD-LF
 10158                                       WS-IG-OVRD.
 10159
 10160     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10161     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10162     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10163     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10164     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10165
 10166     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10167     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10168     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10169     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10170
 10171     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10172     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10173     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10174     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10175     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10176     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10177     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10178
 10179     IF WS-ACCT-AH-DEV-PCT > +0
 10180        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10181     ELSE
 10182        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10183
 10184     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10185        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10186     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10187        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10188
 10189        IF AM-EARN-METHOD-L = 'S'
 10190            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10191                                        WS-LF-REFUND-CALC.
 10192
 10193        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 186
* EL050.cbl
 10194            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10195                                        WS-LF-REFUND-CALC.
 10196
 10197     IF WS-LF-COVERAGE-TYPE = 'R'
 10198         IF AM-EARN-METHOD-R = 'R'
 10199            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10200                                    WS-LF-REFUND-CALC.
 10201     IF WS-LF-COVERAGE-TYPE = 'R'
 10202         IF AM-EARN-METHOD-R = 'P'
 10203            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10204                                    WS-LF-REFUND-CALC.
 10205     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10206         IF AM-EARN-METHOD-L = 'R'
 10207            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10208                                    WS-LF-REFUND-CALC.
 10209     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10210         IF AM-EARN-METHOD-L = 'P'
 10211            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10212                                    WS-LF-REFUND-CALC.
 10213     IF WS-LF-COVERAGE-TYPE = 'R'
 10214         IF AM-EARN-METHOD-R = 'A'
 10215            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10216                                    WS-LF-REFUND-CALC.
 10217     IF WS-LF-COVERAGE-TYPE = 'R'
 10218         IF AM-EARN-METHOD-R = 'M'
 10219            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10220                                    WS-LF-REFUND-CALC.
 10221     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10222         IF AM-EARN-METHOD-L = 'A'
 10223            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10224                                    WS-LF-REFUND-CALC.
 10225     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10226         IF AM-EARN-METHOD-L = 'M'
 10227            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10228                                    WS-LF-REFUND-CALC.
 10229
 10230     IF AM-EARN-METHOD-A = 'R'
 10231        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10232                                    WS-AH-REFUND-CALC.
 10233     IF AM-EARN-METHOD-A = 'P'
 10234        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10235                                    WS-AH-REFUND-CALC.
 10236     IF AM-EARN-METHOD-A = 'C'
 10237        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10238                                    WS-AH-REFUND-CALC.
 10239     IF AM-EARN-METHOD-A = 'A'
 10240        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10241                                    WS-AH-REFUND-CALC.
 10242     IF AM-EARN-METHOD-A = 'M'
 10243        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10244                                    WS-AH-REFUND-CALC.
 10245     IF AM-EARN-METHOD-A = 'N'
 10246        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10247                                    WS-AH-REFUND-CALC.
 10248     IF AM-EARN-METHOD-A = 'S'
 10249        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10250                                    WS-AH-REFUND-CALC.
 10251
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 187
* EL050.cbl
 10252     IF AM-TOL-PREM NOT = ZEROS
 10253        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10254                                    WS-TOL-AH-PREM.
 10255
 10256     IF AM-OVR-SHT-AMT NUMERIC AND
 10257                  AM-OVR-SHT-AMT > 0
 10258        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10259                                    EC-AM-LF-OVR-SHT-AMT
 10260                                    WS-AH-REFUND-OVS-AMT
 10261                                    EC-AM-AH-OVR-SHT-AMT.
 10262
 10263     IF AM-OVR-SHT-PCT NUMERIC AND
 10264                    AM-OVR-SHT-PCT > 0
 10265        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10266                                    EC-AM-LF-OVR-SHT-PCT
 10267                                    WS-AH-REFUND-OVS-PCT
 10268                                    EC-AM-AH-OVR-SHT-PCT.
 10269
 10270     IF AM-TOL-REF-PCT NUMERIC AND
 10271                  AM-TOL-REF-PCT > 0
 10272        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10273                                    WS-TOL-AH-REFUND-PCT.
 10274
 10275     IF AM-TOL-REF  NOT = ZEROS  AND
 10276                  AM-TOL-REF NUMERIC
 10277        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10278                                    EC-AM-LF-TOL-REFUND
 10279                                    WS-TOL-AH-REFUND
 10280                                    EC-AM-AH-TOL-REFUND.
 10281
 10282     IF AM-TOL-CLM  NOT = ZEROS
 10283        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10284                                    WS-TOL-AH-CLAIM.
 10285
 10286     IF AM-CLP-TOL-PCT NOT NUMERIC
 10287        MOVE +0                  TO AM-CLP-TOL-PCT
 10288     END-IF
 10289
 10290     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10291        MOVE +0                  TO AM-SPP-LEASE-COMM
 10292     END-IF
 10293     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10294        MOVE WS-PL-TOL-LF-PREM-PCT
 10295                                 TO WS-TOL-LF-PREM-PCT.
 10296
 10297     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10298        MOVE WS-PL-TOL-AH-PREM-PCT
 10299                                 TO WS-TOL-AH-PREM-PCT.
 10300
 10301     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10302        MOVE WS-PL-TOL-LF-REFUND-PCT
 10303                                 TO WS-TOL-LF-REFUND-PCT.
 10304
 10305     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10306        MOVE WS-PL-TOL-AH-REFUND-PCT
 10307                                 TO WS-TOL-AH-REFUND-PCT.
 10308
 10309     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 188
* EL050.cbl
 10310        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10311
 10312     IF WS-PL-REF-OVS-PCT > +0
 10313        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10314
 10315     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10316        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10317     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10318        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10319     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10320        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10321     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10322        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10323     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10324        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10325     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10326        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10327
 10328     IF WS-AH-PL-REF-OVS-AMT > +0
 10329        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10330
 10331     IF WS-AH-PL-REF-OVS-PCT > +0
 10332        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10333
 10334     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10335     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10336
 10337     IF PB-CANCELLATION
 10338        GO TO 3000-CONTINUE-EDIT.
 10339
 10340     MOVE +1 TO SUB1.
 10341     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10342     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10343
 10344     IF CF-COMPANY-ID = 'DMD'
 10345       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10346         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10347        ELSE
 10348         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10349
 10350  0525-FIND-ACCT-COMM.
 10351     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10352        NEXT SENTENCE
 10353      ELSE
 10354         ADD +1 TO SUB1
 10355         IF SUB1 LESS +11
 10356            GO TO 0525-FIND-ACCT-COMM
 10357          ELSE
 10358             GO TO 0560-EDIT-CONTINUE.
 10359
 10360     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10361     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10362                                    PB-I-LIFE-COMMISSION.
 10363***  IF PB-COMPANY-ID = 'CRI'
 10364     IF PB-PREM-ACCTNG-ONLY
 10365         GO TO 0560-EDIT-CONTINUE.
 10366
 10367     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 189
* EL050.cbl
 10368     MOVE ' '    TO WS-CTBL-READ-SW.
 10369
 10370
 10371 0530-GET-AH-COMP.
 10372     IF NO-AH-COVERAGE  OR
 10373        NO-AH-BENEFIT-MATCH
 10374           GO TO 0540-NEXT-READ-STEP.
 10375
 10376     IF AM-A-COM (SUB1) NUMERIC
 10377        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10378         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10379         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10380         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10381         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10382     ELSE
 10383          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10384          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10385          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10386          MOVE ZEROS             TO WS-SUB1
 10387                                    WS-COMMISSION
 10388          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10389          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10390          IF WS-COMMISSION > ZEROS
 10391             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10392             GO TO 0540-NEXT-READ-STEP
 10393          END-IF
 10394          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10395          IF CTBL-TABLE-FOUND
 10396             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10397                                        PB-I-AH-TERM
 10398             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10399             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10400             GO TO 0540-NEXT-READ-STEP
 10401          ELSE
 10402             IF FIRST-TIME-THROUGH
 10403                 GO TO 0530-GET-AH-COMP
 10404             ELSE
 10405                 MOVE ER-2609                TO WS-ERROR
 10406                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10407
 10408 0540-NEXT-READ-STEP.
 10409     MOVE '0540' TO CTBL-SW.
 10410     MOVE ' '    TO WS-CTBL-READ-SW.
 10411
 10412 0540-GET-LF-COMP.
 10413     IF NO-LIFE-COVERAGE  OR
 10414        NO-LF-BENEFIT-MATCH
 10415           GO TO 0560-EDIT-CONTINUE.
 10416
 10417     IF WS-LF-JOINT-INDICATOR = 'J'
 10418        IF AM-J-COM (SUB1) NUMERIC
 10419           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10420           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10421           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10422           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10423           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10424        ELSE
 10425           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 190
* EL050.cbl
 10426           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10427           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10428           MOVE ZEROS                TO WS-SUB1
 10429                                        WS-COMMISSION
 10430           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10431           IF WS-COMMISSION > ZEROS
 10432              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10433              GO TO 0560-EDIT-CONTINUE
 10434           END-IF
 10435           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10436           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10437           IF CTBL-TABLE-FOUND
 10438              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10439              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10440              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10441              GO TO 0560-EDIT-CONTINUE
 10442           ELSE
 10443              IF FIRST-TIME-THROUGH
 10444                  GO TO 0540-GET-LF-COMP
 10445              ELSE
 10446                  MOVE ER-2609                TO WS-ERROR
 10447                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10448                  GO TO 0560-EDIT-CONTINUE.
 10449
 10450     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10451        IF AM-L-COM (SUB1) NUMERIC
 10452           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10453           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10454           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10455           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10456           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10457        ELSE
 10458           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10459           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10460           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10461           MOVE ZEROS                TO WS-SUB1
 10462                                        WS-COMMISSION
 10463           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10464           IF WS-COMMISSION IS GREATER THAN ZEROS
 10465              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10466              GO TO 0560-EDIT-CONTINUE
 10467           END-IF
 10468           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10469           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10470           IF CTBL-TABLE-FOUND
 10471              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10472              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10473              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10474              GO TO 0560-EDIT-CONTINUE
 10475           ELSE
 10476              IF FIRST-TIME-THROUGH
 10477                  GO TO 0540-GET-LF-COMP
 10478              ELSE
 10479                  MOVE ER-2609                TO WS-ERROR
 10480                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10481
 10482*    GO TO 0560-EDIT-CONTINUE.
 10483
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 191
* EL050.cbl
 10484 0560-EDIT-CONTINUE.
 10485     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10486                                    WS-AH-PMF-COMM
 10487*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10488*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10489     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10490        (SUB1 > +10)
 10491        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10492           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10493           MOVE '0530'           TO CTBL-SW
 10494           MOVE ' '              TO WS-CTBL-READ-SW
 10495           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10496           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10497           MOVE '0540'           TO CTBL-SW
 10498           MOVE ' '              TO WS-CTBL-READ-SW
 10499           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10500        END-IF
 10501     END-PERFORM
 10502     GO TO 0564-EDIT-CONTINUE
 10503     .
 10504 0561-CHECK-AH.
 10505     IF (NO-AH-COVERAGE)
 10506        OR (NO-AH-BENEFIT-MATCH)
 10507        CONTINUE
 10508     ELSE
 10509        IF (AM-A-COM (SUB1) NUMERIC)
 10510           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10511           IF (AM-COM-TYP (SUB1) = 'A')
 10512              AND (WS-AH-PMF-COMM = ZEROS)
 10513              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10514           END-IF
 10515           CONTINUE
 10516        ELSE
 10517           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10518           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10519           MOVE PB-AH-OVERRIDE-L1
 10520                                 TO CTBL-BEN-TYPE
 10521           MOVE ZEROS            TO WS-SUB1
 10522                                    WS-COMMISSION
 10523           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10524           PERFORM 8300-READ-CTBL-TABLE
 10525                                 THRU 8300-EXIT
 10526           IF CTBL-TABLE-FOUND
 10527              IF (AM-COM-TYP (SUB1) = 'A')
 10528                 AND (WS-AH-PMF-COMM = ZEROS)
 10529                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10530                                        PB-I-AH-TERM
 10531                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10532                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10533              END-IF
 10534              CONTINUE
 10535           ELSE
 10536              IF FIRST-TIME-THROUGH
 10537                 GO TO 0561-CHECK-AH
 10538              ELSE
 10539                 MOVE ER-2609    TO WS-ERROR
 10540                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10541              END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 192
* EL050.cbl
 10542           END-IF
 10543        END-IF
 10544     END-IF
 10545     .
 10546 0561-EXIT.
 10547     EXIT.
 10548 0563-CHECK-LF.
 10549     IF (NO-LIFE-COVERAGE)
 10550        OR (NO-LF-BENEFIT-MATCH)
 10551        CONTINUE
 10552     ELSE
 10553        IF WS-LF-JOINT-INDICATOR = 'J'
 10554           IF AM-J-COM (SUB1) NUMERIC
 10555              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10556              IF (AM-COM-TYP (SUB1) = 'A')
 10557                 AND (WS-LF-PMF-COMM = ZEROS)
 10558                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10559              END-IF
 10560              CONTINUE
 10561           ELSE
 10562              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10563              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10564              MOVE PB-LIFE-OVERRIDE-L1
 10565                                 TO CTBL-BEN-TYPE
 10566              MOVE ZEROS         TO WS-SUB1
 10567                                    WS-COMMISSION
 10568              MOVE AM-J-COMA (SUB1)
 10569                                 TO CTBL-TABLE
 10570              PERFORM 8300-READ-CTBL-TABLE
 10571                                 THRU 8300-EXIT
 10572              IF CTBL-TABLE-FOUND
 10573                 IF (AM-COM-TYP (SUB1) = 'A')
 10574                    AND (WS-LF-PMF-COMM = ZEROS)
 10575                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10576                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10577                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10578                 END-IF
 10579                 CONTINUE
 10580              ELSE
 10581                 IF FIRST-TIME-THROUGH
 10582                    GO TO 0563-CHECK-LF
 10583                 ELSE
 10584                    MOVE ER-2609 TO WS-ERROR
 10585                    PERFORM 9900-ERROR-FORMAT
 10586                                 THRU 9900-EXIT
 10587*                   GO TO 0560-EDIT-CONTINUE
 10588                 END-IF
 10589              END-IF
 10590           END-IF
 10591        ELSE
 10592           IF AM-L-COM (SUB1) NUMERIC
 10593              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10594              IF (AM-COM-TYP (SUB1) = 'A')
 10595                 AND (WS-LF-PMF-COMM = ZEROS)
 10596                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10597              END-IF
 10598              CONTINUE
 10599           ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 193
* EL050.cbl
 10600              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10601              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10602              MOVE PB-LIFE-OVERRIDE-L1
 10603                                 TO CTBL-BEN-TYPE
 10604              MOVE ZEROS         TO WS-SUB1
 10605                                    WS-COMMISSION
 10606              MOVE AM-L-COMA (SUB1)
 10607                                 TO CTBL-TABLE
 10608              PERFORM 8300-READ-CTBL-TABLE
 10609                                 THRU 8300-EXIT
 10610              IF CTBL-TABLE-FOUND
 10611                 CONTINUE
 10612              ELSE
 10613                 IF FIRST-TIME-THROUGH
 10614                    GO TO 0563-CHECK-LF
 10615                 ELSE
 10616                    MOVE ER-2609 TO WS-ERROR
 10617                    PERFORM 9900-ERROR-FORMAT
 10618                                 THRU 9900-EXIT
 10619                 END-IF
 10620              END-IF
 10621           END-IF
 10622        END-IF
 10623     END-IF
 10624     .
 10625 0563-EXIT.
 10626     EXIT.
 10627 0564-EDIT-CONTINUE.
 10628
 10629     IF  PB-COMPANY-ID EQUAL 'DMD'
 10630         IF PB-I-NUM-BILLED EQUAL ZEROS
 10631            MOVE ER-8148       TO WS-ERROR
 10632            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10633
 10634*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10635*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10636*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10637*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10638*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10639*         IF NO-CONVERSION-ERROR
 10640*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10641*         ELSE
 10642*             IF PB-COMPANY-ID EQUAL 'HAN'
 10643*                 MOVE ZEROS     TO PB-I-AGE.
 10644     IF PB-I-BIRTHDAY > LOW-VALUES
 10645        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10646        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10647        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10648        PERFORM 8500-DATE-CONVERT
 10649                                 THRU 8500-EXIT
 10650        IF NO-CONVERSION-ERROR
 10651           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10652           IF PB-I-AGE > ZEROS
 10653              IF WS-WORK-AGE NOT = PB-I-AGE
 10654                 MOVE ER-9501    TO WS-ERROR
 10655                 PERFORM 9900-ERROR-FORMAT
 10656                                 THRU 9900-EXIT
 10657              END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 194
* EL050.cbl
 10658           ELSE
 10659              MOVE WS-WORK-AGE   TO PB-I-AGE
 10660           END-IF
 10661        END-IF
 10662     END-IF
 10663     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10664                                   WS-INS-AGE-SET
 10665     IF PB-I-AGE = ZEROS
 10666        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10667           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10668                                   WS-INS-AGE-SET
 10669           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10670
 10671     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10672                                   WS-AH-EDIT-AGE.
 10673
 10674     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10675        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10676        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10677        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10678        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10679        IF NO-CONVERSION-ERROR
 10680           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10681           IF PB-I-JOINT-AGE > 0
 10682              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10683                 MOVE ER-9503    TO WS-ERROR
 10684                 PERFORM 9900-ERROR-FORMAT
 10685                                 THRU 9900-EXIT
 10686              END-IF
 10687           ELSE
 10688              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10689           END-IF
 10690        ELSE
 10691           MOVE ZEROS            TO PB-I-JOINT-AGE
 10692        END-IF
 10693     END-IF
 10694     IF PB-I-JOINT-AGE NOT NUMERIC
 10695        MOVE ZERO               TO PB-I-JOINT-AGE.
 10696
 10697     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10698                                   WS-JNT-AGE-SET
 10699     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10700        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10701           (WS-AH-JOINT-INDICATOR = 'J')
 10702           IF PB-I-JOINT-AGE = ZEROS
 10703               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10704                                          WS-JNT-AGE-SET
 10705               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10706           END-IF
 10707        END-IF
 10708     END-IF
 10709
 10710     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10711     IF WS-LF-JOINT-INDICATOR = 'J'
 10712        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10713        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10714            IF  PB-I-JOINT-AGE = ZERO
 10715                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 195
* EL050.cbl
 10716                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10717            ELSE
 10718                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10719                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10720                    IF PB-COMPANY-ID NOT = 'LBL'
 10721                        MOVE ER-2685    TO WS-ERROR
 10722                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10723
 10724     IF WS-AH-JOINT-INDICATOR = 'J'
 10725        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10726            IF  PB-I-JOINT-AGE = ZERO
 10727                MOVE ER-2686       TO WS-ERROR
 10728                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10729            ELSE
 10730                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10731                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10732                                           WS-EDIT-AGE
 10733                    IF PB-COMPANY-ID NOT = 'LBL'
 10734                        MOVE ER-2685    TO WS-ERROR
 10735                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10736
 10737******************************************************************
 10738*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10739******************************************************************
 10740
 10741     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10742        (WS-AH-SPECIAL-CALC-CD = 'O')
 10743        NEXT SENTENCE
 10744     ELSE
 10745        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10746          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10747           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10748            WS-AH-JOINT-INDICATOR = 'J')  AND
 10749           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10750            MOVE ER-2627             TO WS-ERROR
 10751            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10752
 10753     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10754        (WS-AH-SPECIAL-CALC-CD = 'O')
 10755         NEXT SENTENCE
 10756     ELSE
 10757         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10758            WS-AH-JOINT-INDICATOR = 'J'
 10759             IF PB-I-JOINT-INSURED = SPACES
 10760                 IF PB-COMPANY-ID NOT = 'JAL'
 10761                     MOVE ER-2696    TO WS-ERROR
 10762                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10763
 10764     IF PB-COMPANY-ID NOT = 'BOA'
 10765        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10766           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10767           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10768               PB-I-JOINT-INSURED NOT = SPACES)
 10769                MOVE ER-2691         TO WS-ERROR
 10770                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10771
 10772     IF PB-COMPANY-ID = 'BOA'
 10773        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 196
* EL050.cbl
 10774           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10775            IF PB-I-JOINT-AGE NOT = ZEROS
 10776                MOVE ER-2691         TO WS-ERROR
 10777                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10778
 10779     IF PB-COMPANY-ID = 'CRI'
 10780        IF PB-I-SIG-SW = 'J'
 10781           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10782              WS-AH-JOINT-INDICATOR NOT = 'J'
 10783              MOVE ER-2675       TO WS-ERROR
 10784              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10785
 10786     IF PB-COMPANY-ID = 'CRI'
 10787        IF PB-I-SIG-SW = 'S'
 10788           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10789              WS-AH-JOINT-INDICATOR = 'J'
 10790              MOVE ER-2676       TO WS-ERROR
 10791              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10792
 10793     IF PB-COMPANY-ID = 'CVL'
 10794         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10795            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10796              MOVE ER-2783           TO WS-ERROR
 10797              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10798     IF (WS-LF-JOINT-INDICATOR = 'J')
 10799        AND (WS-AH-JOINT-INDICATOR = 'J')
 10800        AND (PB-I-LF-TERM > 120)
 10801        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10802        MOVE ER-2783             TO WS-ERROR
 10803        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10804     END-IF
 10805     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10806
 10807     IF PB-I-INDV-GRP-OVRD = 'I'
 10808        MOVE ER-2666             TO WS-ERROR
 10809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10810        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10811
 10812     IF PB-I-INDV-GRP-OVRD = 'G'
 10813        MOVE ER-2666             TO WS-ERROR
 10814        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10815        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10816
 10817     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10818        NEXT SENTENCE
 10819     ELSE
 10820        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10821
 10822     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10823        IF WS-ERROR = ER-2666
 10824           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10825           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10826
 10827     IF PB-COMPANY-ID = 'CID'
 10828        IF PB-STATE = 'UT' OR 'MO'
 10829           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10830                 OR '76' OR '77')
 10831                      OR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 197
* EL050.cbl
 10832               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10833                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10834                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10835                   OR '2K' OR '2L'))
 10836              AND PB-I-INDV-GRP-CD = 'I'
 10837              MOVE ER-2721             TO WS-ERROR
 10838              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10839           END-IF
 10840        END-IF
 10841     END-IF
 10842
 10843     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10844     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10845        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10846     ELSE
 10847        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10848     END-IF
 10849
 10850*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10851*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10852     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10853                                    ACCOUNT-AH-CK-SW.
 10854
 10855     IF PB-REISSUED-CERT       OR
 10856        PB-REIN-ONLY-CERT      OR
 10857        PB-POLICY-IS-DECLINED  OR
 10858        PB-POLICY-IS-VOIDED
 10859*       OR PB-MONTHLY-CERT
 10860         GO TO 3000-CONTINUE-EDIT.
 10861
 10862     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10863        IF WS-EDIT-AGE           > +65
 10864           MOVE ER-2709          TO WS-ERROR
 10865           PERFORM 9900-ERROR-FORMAT
 10866                                 THRU 9900-EXIT
 10867        ELSE
 10868           IF WS-EDIT-AGE        > +55
 10869              MOVE ER-2718       TO WS-ERROR
 10870              PERFORM 9900-ERROR-FORMAT
 10871                                 THRU 9900-EXIT
 10872           END-IF
 10873        END-IF
 10874     IF PB-COMPANY-ID = 'DCC'
 10875        IF WS-EDIT-AGE           > +65
 10876           MOVE ER-2709          TO WS-ERROR
 10877           PERFORM 9900-ERROR-FORMAT
 10878                                 THRU 9900-EXIT
 10879        END-IF
 10880     END-IF
 10881     .
 10882
 10883 0565-LIFE-PLAN-LIMIT-EDITS.
 10884
 10885     IF NOT LF-PLAN-MASTER-FOUND
 10886        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10887                                    EC-AM-LF-MAX-TOT-BEN
 10888        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10889
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 198
* EL050.cbl
 10890     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10891
 10892     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10893         IF PL-LM-AGE (1) = ZEROS
 10894             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10895
 10896     IF NO-LF-BENEFIT-MATCH          OR
 10897        WS-LF-BENEFIT-CD = ZEROS     OR
 10898        WS-LF-SPECIAL-CALC-CD = 'M'
 10899        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10900
 10901     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10902     MOVE +1                     TO SUB2.
 10903
 10904     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10905        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10906           MOVE +5   TO SUB2
 10907           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10908              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10909              (PL-LM-AGE (SUB2) EQUAL +0)
 10910              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10911              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10912
 10913     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10914
 10915     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10916                               + PB-I-LF-ALT-BENEFIT-AMT.
 10917
 10918 0568-CHECK-LIFE-ATT-AGE.
 10919
 10920     IF PL-ATT-AGE NUMERIC AND
 10921        PL-ATT-AGE > +0
 10922        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10923     END-IF
 10924*    IF PL-ATT-AGE NUMERIC AND
 10925*       PL-ATT-AGE > +0
 10926*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10927*       IF PB-I-BIRTHDAY > LOW-VALUES
 10928*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10929*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10930*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10931*          SET BIN-PLUS-ELAPSED  TO TRUE
 10932*          PERFORM 8500-DATE-CONVERT
 10933*                                THRU 8500-EXIT
 10934*          IF NO-CONVERSION-ERROR
 10935*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10936*             MOVE ER-2669       TO WS-ERROR
 10937*             PERFORM 9900-ERROR-FORMAT
 10938*                                THRU 9900-EXIT
 10939*          END-IF
 10940*       ELSE
 10941*          IF WS-ATT-AGE >= PL-ATT-AGE
 10942*             MOVE ER-2669       TO WS-ERROR
 10943*             PERFORM 9900-ERROR-FORMAT
 10944*                                THRU 9900-EXIT
 10945*          END-IF
 10946*       END-IF
 10947*    END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 199
* EL050.cbl
 10948     .
 10949 0570-CHECK-LIFE-LIMITS.
 10950
 10951     IF PB-COMPANY-ID EQUAL 'CRI'
 10952        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10953           IF SUB2 GREATER THAN +4
 10954              MOVE ER-2637 TO WS-ERROR
 10955              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10956              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10957
 10958     IF PB-COMPANY-ID  =  'NCL'
 10959        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10960            SUB2 GREATER THAN +8
 10961             MOVE 'U'         TO PB-BATCH-ENTRY
 10962             MOVE ER-2637     TO WS-ERROR
 10963             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10964             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10965
 10966     IF SUB2 > +8
 10967        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10968           AND (PB-I-SIG-SW = 'Y')
 10969           CONTINUE
 10970        ELSE
 10971           MOVE ER-2637          TO WS-ERROR
 10972           PERFORM 9900-ERROR-FORMAT
 10973                                 THRU 9900-EXIT
 10974        END-IF
 10975        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10976     END-IF
 10977     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10978     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10979     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10980
 10981     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10982        ADD +1  TO SUB2
 10983        GO TO 0570-CHECK-LIFE-LIMITS.
 10984
 10985     IF PB-COMPANY-ID = 'NCL'
 10986         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10987
 10988     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10989        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10990        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10991           AND (PB-I-SIG-SW = 'Y')
 10992           CONTINUE
 10993        ELSE
 10994           MOVE ER-2637          TO WS-ERROR
 10995           PERFORM 9900-ERROR-FORMAT
 10996                                 THRU 9900-EXIT
 10997        END-IF
 10998     END-IF
 10999     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11000
 11001
 11002 0570-CHECK-NCL-LIFE-LIMITS.
 11003
 11004     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11005        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 200
* EL050.cbl
 11006         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11007
 11008     IF APP-CERT-USED
 11009         IF SUB2  LESS THAN  +5
 11010             MOVE +5          TO SUB2
 11011             GO TO 0570-CHECK-LIFE-LIMITS.
 11012
 11013     MOVE ER-2637             TO WS-ERROR.
 11014     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11015
 11016     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11017
 11018 0575-CHECK-NCL-SIG-SWITCH.
 11019
 11020     IF NOT APP-CERT-USED
 11021         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11022
 11023     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11024        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11025        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11026        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11027         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11028
 11029     IF SUB2 GREATER THAN +4
 11030         IF PL-LM-AGE (5) = ZEROS  AND
 11031            PL-LM-AGE (6) = ZEROS  AND
 11032            PL-LM-AGE (7) = ZEROS  AND
 11033            PL-LM-AGE (8) = ZEROS
 11034             MOVE  ER-1927        TO WS-ERROR
 11035             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11036             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11037         ELSE
 11038             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11039                 MOVE  ER-1920    TO WS-ERROR
 11040                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11041
 11042     IF PB-I-SIG-SW  = 'Y'
 11043       IF NOT PB-I-POLICY-ACCEPTED  AND
 11044          NOT PB-I-POLICY-DECLINED
 11045           MOVE 'U'               TO PB-BATCH-ENTRY
 11046           MOVE  ER-1926          TO WS-ERROR
 11047           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11048
 11049
 11050 0580-AH-PLAN-LIMIT-EDITS.
 11051
 11052     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11053        IF PB-I-AH-BENEFIT-AMT > +1250
 11054           MOVE ER-2702          TO WS-ERROR
 11055           PERFORM 9900-ERROR-FORMAT
 11056                                 THRU 9900-EXIT
 11057        END-IF
 11058     END-IF
 11059
 11060     IF (PB-COMPANY-ID = 'DCC')
 11061        AND (PB-MONTHLY-CERT)
 11062        IF PB-I-AH-BENEFIT-AMT > +3000
 11063           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 201
* EL050.cbl
 11064           PERFORM 9900-ERROR-FORMAT
 11065                                 THRU 9900-EXIT
 11066        END-IF
 11067     END-IF
 11068     IF NOT AH-PLAN-MASTER-FOUND
 11069        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11070        GO TO 3000-CONTINUE-EDIT.
 11071
 11072     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11073
 11074     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11075         IF PL-LM-AGE (1) = ZEROS
 11076             GO TO 3000-CONTINUE-EDIT.
 11077
 11078     IF NO-AH-BENEFIT-MATCH          OR
 11079        WS-AH-BENEFIT-CD = ZEROS     OR
 11080        WS-AH-SPECIAL-CALC-CD = 'M'
 11081        GO TO 3000-CONTINUE-EDIT.
 11082
 11083     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11084     MOVE +1                     TO SUB2.
 11085
 11086     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11087        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11088           MOVE +5 TO SUB2
 11089           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11090              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11091              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11092              (PL-LM-AGE (SUB2) EQUAL +0)
 11093              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11094              GO TO 3000-CONTINUE-EDIT.
 11095
 11096     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11097
 11098 0590-CHECK-AH-ATT-AGE.
 11099
 11100     IF PL-ATT-AGE NUMERIC AND
 11101        PL-ATT-AGE GREATER THAN +0
 11102        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11103     END-IF
 11104*       IF WS-ATT-AGE >= PL-ATT-AGE
 11105*          MOVE ER-3054          TO WS-ERROR
 11106*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11107     .
 11108 0597-CHECK-AH-LIMITS.
 11109
 11110     IF PB-COMPANY-ID EQUAL 'CRI'
 11111        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11112           IF SUB2 GREATER THAN +4
 11113              MOVE ER-2638       TO WS-ERROR
 11114              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11115              GO TO 3000-CONTINUE-EDIT.
 11116
 11117     IF PB-COMPANY-ID  =  'NCL'
 11118        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11119            SUB2 GREATER THAN +8
 11120             MOVE 'U'            TO PB-BATCH-ENTRY
 11121             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 202
* EL050.cbl
 11122             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11123             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11124
 11125     IF SUB2 > +8
 11126        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11127           AND (PB-I-SIG-SW = 'Y')
 11128           CONTINUE
 11129        ELSE
 11130           MOVE ER-2638          TO WS-ERROR
 11131           PERFORM 9900-ERROR-FORMAT
 11132                                 THRU 9900-EXIT
 11133        END-IF
 11134        GO TO 3000-CONTINUE-EDIT
 11135     END-IF
 11136
 11137     IF PB-COMPANY-ID = 'CRI'
 11138        IF WS-ERROR = ER-2638
 11139           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11140
 11141     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11142     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11143     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11144     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11145
 11146     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11147        ADD +1                   TO SUB2
 11148        GO TO 0597-CHECK-AH-LIMITS.
 11149
 11150     IF PB-COMPANY-ID = 'NCL'
 11151         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11152
 11153     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11154        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11155        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11156                                 > PL-LM-AMT (SUB2))
 11157        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11158           AND (PB-I-SIG-SW = 'Y')
 11159           CONTINUE
 11160        ELSE
 11161           MOVE ER-2638          TO WS-ERROR
 11162           PERFORM 9900-ERROR-FORMAT
 11163                                 THRU 9900-EXIT
 11164        END-IF
 11165     END-IF
 11166
 11167     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11168         IF  WS-ERROR    EQUAL    ER-2638
 11169             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11170                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11171                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11172                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11173                MOVE  ER-1910    TO  WS-ERROR
 11174                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11175
 11176     IF PB-COMPANY-ID = 'CRI'
 11177        IF WS-ERROR = ER-2638
 11178            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11179            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 203
* EL050.cbl
 11180            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11181
 11182     GO TO 3000-CONTINUE-EDIT.
 11183
 11184 0597-CHECK-NCL-AH-LIMITS.
 11185
 11186     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11187        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11188        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11189                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11190         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11191
 11192     IF APP-CERT-USED
 11193         IF SUB2  LESS THAN  +5
 11194             MOVE +5             TO SUB2
 11195             GO TO 0597-CHECK-AH-LIMITS.
 11196
 11197     MOVE ER-2638                TO WS-ERROR.
 11198     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11199
 11200     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11201
 11202 0599-CHECK-NCL-SIG-SWITCH.
 11203
 11204     IF NOT APP-CERT-USED
 11205         GO TO 3000-CONTINUE-EDIT.
 11206
 11207     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11208        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11209        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11210        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11211         GO TO 3000-CONTINUE-EDIT.
 11212
 11213     IF SUB2 GREATER THAN +4
 11214         IF PL-LM-AGE (5) = ZEROS  AND
 11215            PL-LM-AGE (6) = ZEROS  AND
 11216            PL-LM-AGE (7) = ZEROS  AND
 11217            PL-LM-AGE (8) = ZEROS
 11218             MOVE  ER-1927        TO WS-ERROR
 11219             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11220             GO TO 3000-CONTINUE-EDIT
 11221         ELSE
 11222             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11223                 MOVE  ER-1920    TO WS-ERROR
 11224                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11225
 11226     IF PB-I-SIG-SW  = 'Y'
 11227       IF NOT PB-I-POLICY-ACCEPTED  AND
 11228          NOT PB-I-POLICY-DECLINED
 11229           MOVE 'U'               TO PB-BATCH-ENTRY
 11230           MOVE  ER-1926          TO WS-ERROR
 11231           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11232
 11233******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 204
* EL050.cbl
 11235
 11236 3000-CONTINUE-EDIT.
 11237
 11238     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11239     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11240     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11241     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11242     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11243
 11244     IF BROWSE-STARTED
 11245        PERFORM 9990-RETURN THRU 9990-EXIT
 11246        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11247
 11248     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11249        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11250        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11251        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11252*       MOVE 1                   TO DC-OPTION-CODE
 11253        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11254        IF DATE-CONVERSION-ERROR
 11255           MOVE ER-2622          TO WS-ERROR
 11256           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11257        ELSE
 11258           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11259              MOVE ER-2623       TO WS-ERROR
 11260              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11261           ELSE
 11262              MOVE ER-2622       TO WS-ERROR
 11263              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11264
 11265     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11266     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11267     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11268*    MOVE 1                      TO DC-OPTION-CODE.
 11269     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11270     IF DATE-CONVERSION-ERROR
 11271        GO TO 3005-EDIT-CONTINUE
 11272     ELSE
 11273        IF DC-ELAPSED-DAYS GREATER +180
 11274           MOVE ER-2613          TO WS-ERROR
 11275           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11276        ELSE
 11277           IF DC-ELAPSED-DAYS GREATER +90
 11278              MOVE ER-2612       TO WS-ERROR
 11279              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11280           ELSE
 11281             IF DC-ELAPSED-DAYS GREATER +60
 11282                MOVE ER-2614     TO WS-ERROR
 11283                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11284
 11285 3005-EDIT-CONTINUE.
 11286
 11287     IF PB-CANCELLATION
 11288         GO TO 3700-EDIT-CANCEL.
 11289
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 205
* EL050.cbl
 11291******************************************************************
 11292*                  E D I T   I S S U E                           *
 11293******************************************************************
 11294
 11295 3020-EDIT-ISSUE.
 11296
 11297      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11298      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11299      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11300      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11301      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11302
 11303     IF PB-ISSUE-FORCE
 11304        OR PB-ISSUE-DATE-FORCED
 11305        OR PB-FORCE-OFF
 11306        OR PB-OVERCHARGE-FORCE
 11307        CONTINUE
 11308     ELSE
 11309        MOVE ER-2670             TO WS-ERROR
 11310        PERFORM 9900-ERROR-FORMAT
 11311                                 THRU 9900-EXIT
 11312     END-IF
 11313     .
 11314 3022-SET-POLICY-STATUS.
 11315
 11316     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11317
 11318     IF (PB-REISSUED-CERT)
 11319             OR
 11320        ((PB-COMPANY-ID NOT = 'DCC')
 11321         AND (PB-MONTHLY-CERT))
 11322         MOVE '5'                TO PB-I-ENTRY-STATUS
 11323         MOVE 'E'                TO PB-BATCH-ENTRY
 11324     END-IF
 11325
 11326     IF PB-COMPANY-ID = 'DCC'
 11327        IF PB-MONTHLY-CERT
 11328           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11329        END-IF
 11330        IF PB-CASH-CERT
 11331           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11332        END-IF
 11333     END-IF
 11334     IF PB-POLICY-IS-DECLINED
 11335         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11336     IF PB-POLICY-IS-VOIDED
 11337         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11338     IF PB-NEEDS-UNDERWRITING
 11339         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11340     IF PB-REIN-ONLY-CERT
 11341         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11342     IF PB-PREM-ACCTNG-ONLY
 11343         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11344
 11345     MOVE SPACE                  TO PB-I-OB-FLAG.
 11346
 11347     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11348         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 206
* EL050.cbl
 11349         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11350         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11351
 11352     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11353        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11354           MOVE 'Z'             TO PB-I-OB-FLAG.
 11355
 11356     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11357        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11358           MOVE 'Z'             TO PB-I-OB-FLAG.
 11359
 11360     IF ACCOUNT-MAST-FOUND
 11361         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11362         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11363         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11364         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11365         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11366         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11367         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11368     END-IF
 11369
 11370     IF ACCOUNT-MAST-FOUND
 11371        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11372         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11373
 11374     IF (ACCOUNT-MAST-FOUND)
 11375        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11376        IF PB-REISSUED-CERT
 11377           CONTINUE
 11378        ELSE
 11379           MOVE ER-2608          TO WS-ERROR
 11380           PERFORM 9900-ERROR-FORMAT
 11381                                 THRU 9900-EXIT
 11382         END-IF
 11383     END-IF
 11384
 11385     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11386        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11387        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11388
 11389**********   DMD CUSTOM CODE FOLLOWS  **********
 11390 3024-EDIT-DMD-FIELDS.
 11391     IF PB-COMPANY-ID NOT = 'DMD'
 11392        GO TO 3025-EDIT-REINSURANCE.
 11393
 11394*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11395*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11396*** ERROR IF THEY ARE NOT EQUAL.
 11397
 11398     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11399     SET BIN-TO-GREG               TO TRUE.
 11400     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11401     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11402**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11403
 11404     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11405     SET BIN-TO-GREG               TO TRUE.
 11406     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 207
* EL050.cbl
 11407     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11408**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11409
 11410     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11411        MOVE ER-8116               TO WS-ERROR
 11412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11413
 11414     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11415
 11416     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11417                                      WK-FULL-CERT-NO.
 11418     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11419
 11420     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11421
 11422     IF PB-VALID-LIFE
 11423        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11424     ELSE
 11425        IF PB-VALID-AH
 11426          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11427
 11428
 11429     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11430     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11431     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11432                                      DCUA-UNDRWRTR-CODE
 11433                                      DCUA-UNDRWRTR-GROUP-CODE
 11434                                      DCUA-RETURN-CODE.
 11435
 11436****************************************************************
 11437*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11438***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11439***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11440***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11441***   TO THIS RECORD.                                        ***
 11442****************************************************************
 11443     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11444     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11445     IF DCUA-SUCCESSFUL-PROCESS
 11446        GO TO 3024-EDIT-DL7-CONT.
 11447
 11448     IF DCUA-RETURN-CODE EQUAL '01'
 11449        MOVE ER-8110               TO WS-ERROR
 11450        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11451        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11452        GO TO 3024-EDIT-DL7-CONT.
 11453
 11454     IF DCUA-RETURN-CODE EQUAL '02'
 11455        MOVE ER-8111               TO WS-ERROR
 11456        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11458        GO TO 3024-EDIT-DL7-CONT.
 11459
 11460     IF DCUA-RETURN-CODE EQUAL '03'
 11461        MOVE ER-8074               TO WS-ERROR
 11462        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11463        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11464        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 208
* EL050.cbl
 11465
 11466     IF DCUA-RETURN-CODE EQUAL '04'
 11467        MOVE ER-8075               TO WS-ERROR
 11468        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11469        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11470        GO TO 3024-EDIT-DL7-CONT.
 11471
 11472     IF DCUA-RETURN-CODE EQUAL '05'
 11473        MOVE ER-8076               TO WS-ERROR
 11474        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11475        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11476        GO TO 3024-EDIT-DL7-CONT.
 11477
 11478     IF DCUA-RETURN-CODE EQUAL '06'
 11479        MOVE ER-8077               TO WS-ERROR
 11480        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11482        GO TO 3024-EDIT-DL7-CONT.
 11483
 11484     IF DCUA-RETURN-CODE EQUAL '07'
 11485        MOVE ER-8078               TO WS-ERROR
 11486        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11488        GO TO 3024-EDIT-DL7-CONT.
 11489
 11490     IF DCUA-RETURN-CODE EQUAL 'E1'
 11491        MOVE ER-8079               TO WS-ERROR
 11492        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11493        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11494        GO TO 3024-EDIT-DL7-CONT.
 11495
 11496     IF DCUA-RETURN-CODE EQUAL 'E2'
 11497        MOVE ER-8080               TO WS-ERROR
 11498        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11499        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11500        GO TO 3024-EDIT-DL7-CONT.
 11501
 11502     IF DCUA-RETURN-CODE EQUAL 'E3'
 11503        MOVE ER-8098               TO WS-ERROR
 11504        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11506        GO TO 3024-EDIT-DL7-CONT.
 11507
 11508     IF DCUA-RETURN-CODE EQUAL 'C1'
 11509        MOVE ER-8099               TO WS-ERROR
 11510        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11512        GO TO 3024-EDIT-DL7-CONT.
 11513
 11514     IF DCUA-RETURN-CODE EQUAL 'U1'
 11515        MOVE ER-8109               TO WS-ERROR
 11516        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11518        GO TO 3024-EDIT-DL7-CONT.
 11519
 11520     IF DCUA-RETURN-CODE EQUAL 'N1'
 11521        MOVE ER-8112               TO WS-ERROR
 11522        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 209
* EL050.cbl
 11523        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11524        GO TO 3024-EDIT-DL7-CONT.
 11525
 11526     IF DCUA-RETURN-CODE EQUAL 'N2'
 11527        MOVE ER-8113               TO WS-ERROR
 11528        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11530        GO TO 3024-EDIT-DL7-CONT.
 11531
 11532     IF DCUA-RETURN-CODE EQUAL 'N3'
 11533        MOVE ER-8114               TO WS-ERROR
 11534        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL7-CONT.
 11537
 11538     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11539     MOVE ER-8097                  TO WS-ERROR.
 11540     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11541     GO TO 3024-EDIT-DL7-CONT.
 11542
 11543 3024-EDIT-DL7-CONT.
 11544
 11545     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11546     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11547     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11548        NEXT SENTENCE
 11549     ELSE
 11550        MOVE ER-9263               TO WS-ERROR
 11551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11552
 11553******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11554******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11555     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11556        NEXT SENTENCE
 11557     ELSE
 11558        MOVE ER-8039               TO WS-ERROR
 11559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11560
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 210
* EL050.cbl
 11562****************************************************************
 11563*** VALIDATE STATE  : DLO022                                 ***
 11564****************************************************************
 11565     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11566     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11567
 11568     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11569     IF DVSC-SUCCESSFUL-EDIT
 11570        GO TO 3024-EDIT-DL22-CONT.
 11571
 11572     IF DVSC-RETURN-CODE EQUAL '01'
 11573        MOVE ER-8300               TO WS-ERROR
 11574        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11575        GO TO 3024-EDIT-DL22-CONT.
 11576
 11577     IF DVSC-RETURN-CODE EQUAL '02'
 11578        MOVE ER-8301               TO WS-ERROR
 11579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11580        GO TO 3024-EDIT-DL22-CONT.
 11581
 11582     IF DVSC-RETURN-CODE EQUAL '03'
 11583        MOVE ER-8302               TO WS-ERROR
 11584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11585        GO TO 3024-EDIT-DL22-CONT.
 11586
 11587     IF DVSC-RETURN-CODE EQUAL 'N1'
 11588        MOVE ER-8304               TO WS-ERROR
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590        GO TO 3024-EDIT-DL22-CONT.
 11591
 11592     MOVE ER-8303                  TO WS-ERROR
 11593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11594
 11595 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 211
* EL050.cbl
 11597****************************************************************
 11598*** VALIDATE LOAN OFFICER : DLO021                           ***
 11599****************************************************************
 11600
 11601     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11602     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11603     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11604     IF DVLO-SUCCESSFUL-EDIT
 11605        GO TO 3024-EDIT-DL21-CONT.
 11606
 11607     IF DVLO-RETURN-CODE EQUAL '01'
 11608        MOVE ER-8081               TO WS-ERROR
 11609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11610        GO TO 3024-EDIT-DL21-CONT.
 11611
 11612     IF DVLO-RETURN-CODE EQUAL '02'
 11613        MOVE ER-8082               TO WS-ERROR
 11614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615        GO TO 3024-EDIT-DL21-CONT.
 11616
 11617     IF DVLO-RETURN-CODE EQUAL '03'
 11618        MOVE ER-8083               TO WS-ERROR
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL21-CONT.
 11621
 11622     IF DVLO-RETURN-CODE EQUAL '04'
 11623        MOVE ER-8084               TO WS-ERROR
 11624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625        GO TO 3024-EDIT-DL21-CONT.
 11626
 11627     IF DVLO-RETURN-CODE EQUAL '05'
 11628        MOVE ER-8085               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630        GO TO 3024-EDIT-DL21-CONT.
 11631
 11632     MOVE ER-7825                  TO WS-ERROR
 11633     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11634     GO TO 3024-EDIT-DL21-CONT.
 11635
 11636 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 212
* EL050.cbl
 11638
 11639****************************************************************
 11640*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11641****************************************************************
 11642
 11643     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11644     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11645     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11646     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11647     IF DIPF-SUCCESSFUL-EDIT
 11648        GO TO 3024-EDIT-DL02-CONT.
 11649
 11650     IF DIPF-RETURN-CODE EQUAL '01'
 11651        MOVE ER-8086               TO WS-ERROR
 11652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11653        GO TO 3024-EDIT-DL02-CONT.
 11654
 11655     IF DIPF-RETURN-CODE EQUAL '02'
 11656        MOVE ER-8087               TO WS-ERROR
 11657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658        GO TO 3024-EDIT-DL02-CONT.
 11659
 11660     IF DIPF-RETURN-CODE EQUAL '03'
 11661        MOVE ER-8088               TO WS-ERROR
 11662        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11663        GO TO 3024-EDIT-DL02-CONT.
 11664
 11665     MOVE ER-8095                  TO WS-ERROR
 11666     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11667     GO TO 3024-EDIT-DL02-CONT.
 11668
 11669 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 213
* EL050.cbl
 11671
 11672****************************************************************
 11673*** VALIDATE BANK ID : DLO003                                ***
 11674****************************************************************
 11675
 11676     MOVE WK-GREG-CENT           TO WCG-CENT.
 11677     MOVE WK-GREG-YYMM           TO WCG-REST.
 11678     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11679        MOVE ER-8040               TO WS-ERROR
 11680        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11681
 11682     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11683     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11684     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11685     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11686     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11687     IF DVBI-SUCCESSFUL-EDIT
 11688        GO TO 3024-EDIT-DL03-CONT.
 11689
 11690     IF DVBI-RETURN-CODE EQUAL '01'
 11691        MOVE ER-8089               TO WS-ERROR
 11692        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11693        GO TO 3024-EDIT-DL03-CONT.
 11694
 11695     IF DVBI-RETURN-CODE EQUAL '02'
 11696        MOVE ER-8090               TO WS-ERROR
 11697        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11698        GO TO 3024-EDIT-DL03-CONT.
 11699
 11700     IF DVBI-RETURN-CODE EQUAL '03'
 11701        MOVE ER-8091               TO WS-ERROR
 11702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11703        GO TO 3024-EDIT-DL03-CONT.
 11704
 11705     IF DVBI-RETURN-CODE EQUAL '04'
 11706        MOVE ER-8092               TO WS-ERROR
 11707        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11708        GO TO 3024-EDIT-DL03-CONT.
 11709
 11710     IF DVBI-RETURN-CODE EQUAL '05'
 11711        MOVE ER-8093               TO WS-ERROR
 11712        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11713        GO TO 3024-EDIT-DL03-CONT.
 11714
 11715     IF DVBI-RETURN-CODE EQUAL '06'
 11716        MOVE ER-8094               TO WS-ERROR
 11717        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11718        GO TO 3024-EDIT-DL03-CONT.
 11719
 11720     MOVE ER-8096                  TO WS-ERROR
 11721     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11722     GO TO 3024-EDIT-DL03-CONT.
 11723
 11724 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 214
* EL050.cbl
 11726
 11727     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11728        NEXT SENTENCE
 11729     ELSE
 11730        MOVE ER-8042               TO WS-ERROR
 11731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11732
 11733     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11734     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11735     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11736
 11737     IF DMPF-RETURN-CODE = '01'
 11738        MOVE ER-8067               TO WS-ERROR
 11739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11740        GO TO 3024-EDIT-DL01-CONT.
 11741
 11742     IF DMPF-RETURN-CODE = '02'
 11743        MOVE ER-8068               TO WS-ERROR
 11744        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11745        GO TO 3024-EDIT-DL01-CONT.
 11746
 11747     IF DMPF-RETURN-CODE = '03'
 11748        MOVE ER-8069               TO WS-ERROR
 11749        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11750        GO TO 3024-EDIT-DL01-CONT.
 11751
 11752     IF DMPF-RETURN-CODE = 'E1'
 11753        MOVE ER-8070               TO WS-ERROR
 11754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11755        GO TO 3024-EDIT-DL01-CONT.
 11756
 11757     IF DMPF-RETURN-CODE = 'N1'
 11758        MOVE ER-8071               TO WS-ERROR
 11759        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11760        GO TO 3024-EDIT-DL01-CONT.
 11761
 11762     IF DMPF-RETURN-CODE NOT = 'OK'
 11763        MOVE ER-8072               TO WS-ERROR
 11764        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11765
 11766 3024-EDIT-DL01-CONT.
 11767******************************************************************
 11768***  VALIDATES RATE CODES : DLO017                             ***
 11769******************************************************************
 11770
 11771      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11772      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11773      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11774      IF DVRC-SUCCESSFUL-EDIT
 11775        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11776        GO TO 3024-CHECK-VALID-RATE.
 11777
 11778      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11779
 11780      IF DVRC-RETURN-CODE EQUAL '01'
 11781         MOVE ER-7817                   TO WS-ERROR
 11782         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11783         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 215
* EL050.cbl
 11784
 11785      IF DVRC-RETURN-CODE EQUAL '02'
 11786         MOVE ER-7818                   TO WS-ERROR
 11787         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11788         GO TO 3025-EDIT-REINSURANCE.
 11789
 11790      IF DVRC-RETURN-CODE EQUAL '03'
 11791         MOVE ER-7819                   TO WS-ERROR
 11792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11793         GO TO 3025-EDIT-REINSURANCE.
 11794
 11795       MOVE ER-7820                     TO WS-ERROR.
 11796       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11797       GO TO 3025-EDIT-REINSURANCE.
 11798
 11799******************************************************************
 11800***  GET PREMIUM RATES : DLO011                                ***
 11801******************************************************************
 11802
 11803 3024-CHECK-VALID-RATE.
 11804
 11805     IF VALID-RATE-CODE
 11806        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11807        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11808        MOVE SPACES                TO DPRB-RETURN-CODE
 11809        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11810     ELSE
 11811         GO TO 3025-EDIT-REINSURANCE.
 11812
 11813      IF DPRB-SUCCESSFUL-PROCESS
 11814         IF PB-VALID-LIFE
 11815             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11816             GO TO 3025-EDIT-REINSURANCE
 11817         ELSE
 11818             IF PB-VALID-AH
 11819                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11820                 GO TO 3025-EDIT-REINSURANCE.
 11821
 11822      IF DPRB-RETURN-CODE EQUAL '01'
 11823         MOVE ER-7812                   TO WS-ERROR
 11824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11825         GO TO 3025-EDIT-REINSURANCE.
 11826
 11827      IF DPRB-RETURN-CODE EQUAL '02'
 11828         MOVE ER-7813                   TO WS-ERROR
 11829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11830         GO TO 3025-EDIT-REINSURANCE.
 11831
 11832      IF DPRB-RETURN-CODE EQUAL '03'
 11833         MOVE ER-7814                   TO WS-ERROR
 11834         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11835         GO TO 3025-EDIT-REINSURANCE.
 11836
 11837      IF DPRB-RETURN-CODE EQUAL '04'
 11838         IF NOT DPRB-1ST-TIME
 11839            MOVE ER-7815                   TO WS-ERROR
 11840            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11841            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 216
* EL050.cbl
 11842          ELSE
 11843         IF PB-VALID-LIFE
 11844            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11845          ELSE
 11846            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11847         END-IF
 11848         MOVE SPACES                TO DOCC-RETURN-CODE
 11849         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11850         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11851         IF DOCC-RETURN-CODE = 'OK'
 11852             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11853             GO TO 3024-CHECK-VALID-RATE
 11854           ELSE
 11855             MOVE ER-7823               TO WS-ERROR
 11856             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11857             GO TO 3025-EDIT-REINSURANCE.
 11858
 11859       MOVE ER-7816                     TO WS-ERROR.
 11860       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11861       GO TO 3025-EDIT-REINSURANCE.
 11862
 11863**********   DMD CUSTOM CODE ABOVE    **********
 11864
 11865 3025-EDIT-REINSURANCE.
 11866     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11867         GO TO 3027-EDIT-CONTINUE.
 11868
 11869     MOVE LOW-VALUES               TO ERREIN-KEY.
 11870     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11871     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11872                                      REIN-CODE-2
 11873                                      REIN-CODE-3.
 11874     MOVE 'A'                      TO REIN-TYPE.
 11875
 11876     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11877
 11878     MOVE '3026' TO REIN-SW.
 11879     MOVE ' '                   TO WS-REIN-READ-SW.
 11880
 11881     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11882     IF REIN-TABLE-NOT-FOUND
 11883         GO TO 3026-NO-SPEC-TABLE.
 11884
 11885     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11886     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11887                                   WS-NSP-ST-CD-LF.
 11888     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11889                                   WS-NSP-ST-CD-AH.
 11890
 11891     GO TO 3040-EDIT-CONTINUE.
 11892
 11893 3026-NO-SPEC-TABLE.
 11894
 11895     MOVE ER-2664                TO WS-ERROR.
 11896     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11897     GO TO 3040-EDIT-CONTINUE.
 11898
 11899 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 217
* EL050.cbl
 11900
 11901     IF PB-I-REIN-TABLE = SPACES
 11902       GO TO 3040-EDIT-CONTINUE.
 11903
 11904     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11905          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11906          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11907           GO TO 3040-EDIT-CONTINUE.
 11908
 11909     MOVE LOW-VALUES            TO ERREIN-KEY.
 11910     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11911     MOVE 'A'                   TO REIN-TYPE.
 11912     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11913
 11914     MOVE '3028'                TO REIN-SW.
 11915     MOVE ' '                   TO WS-REIN-READ-SW.
 11916
 11917     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11918     IF REIN-TABLE-NOT-FOUND
 11919         GO TO 3028-NO-REIN-TABLE.
 11920
 11921     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11922     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11923                                   WS-NSP-ST-CD-LF.
 11924     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11925                                   WS-NSP-ST-CD-AH.
 11926
 11927     GO TO 3040-EDIT-CONTINUE.
 11928
 11929 3028-NO-REIN-TABLE.
 11930
 11931     MOVE ER-2615                TO WS-ERROR.
 11932     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11933     GO TO 3040-EDIT-CONTINUE.
 11934
 11935 3040-EDIT-CONTINUE.
 11936
 11937     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11938         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11939
 11940     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11941         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11942
 11943     IF (NOT PB-REISSUED-CERT)
 11944        AND (NOT PB-MONTHLY-CERT)
 11945        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11946            MOVE '001'           TO PB-I-LF-TERM
 11947            MOVE 'M'             TO PB-I-INSURED-SEX.
 11948
 11949     IF (NOT PB-REISSUED-CERT)
 11950        AND (NOT PB-MONTHLY-CERT)
 11951        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11952            MOVE '001'           TO PB-I-AH-TERM
 11953            MOVE 'M'             TO PB-I-INSURED-SEX.
 11954
 11955 3040-EDIT-1ST-PMT-DT.
 11956     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11957     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 218
* EL050.cbl
 11958         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11959
 11960******************************************************************
 11961*                                                                *
 11962*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11963*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11964*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11965*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11966*                                                                *
 11967******************************************************************
 11968
 11969     IF PB-EFF-DT-PROCESSING
 11970        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11971                                    PB-I-LF-EXPIRE-DT
 11972                                    PB-I-AH-EXPIRE-DT
 11973        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11974        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11975        MOVE ZERO                TO DC-ELAPSED-DAYS
 11976        MOVE +1                  TO DC-ELAPSED-MONTHS
 11977        SET BIN-PLUS-ELAPSED     TO TRUE
 11978*       MOVE 6                   TO DC-OPTION-CODE
 11979        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11980        IF NO-CONVERSION-ERROR
 11981           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11982
 11983******************************************************************
 11984*                                                                *
 11985*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11986*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11987*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11988*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11989*                                                                *
 11990******************************************************************
 11991
 11992     IF PB-EXT-DAYS-PROCESSING
 11993          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11994                                         PB-I-LF-EXPIRE-DT
 11995                                         PB-I-AH-EXPIRE-DT
 11996          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11997          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11998          MOVE +1                     TO DC-ELAPSED-MONTHS
 11999          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12000          SET BIN-PLUS-ELAPSED        TO TRUE
 12001*         MOVE 6                      TO DC-OPTION-CODE
 12002          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12003          IF NO-CONVERSION-ERROR
 12004             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12005
 12006******************************************************************
 12007*                                                                *
 12008*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12009*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12010*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12011*        (EXPIRE DATE - (TERM -1))  *  -1.
 12012*                                                                *
 12013******************************************************************
 12014
 12015     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 219
* EL050.cbl
 12016        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12017           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12018              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12019              MOVE PB-I-AH-TERM      TO WS-TERM
 12020           ELSE
 12021              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12022              MOVE PB-I-LF-TERM      TO WS-TERM
 12023        ELSE
 12024           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12025              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12026              MOVE PB-I-LF-TERM      TO WS-TERM
 12027           ELSE
 12028              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12029              MOVE PB-I-AH-TERM      TO WS-TERM.
 12030
 12031     IF PB-EXPIRE-DT-PROCESSING
 12032        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12033        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12034        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12035        MOVE ZERO                TO DC-ELAPSED-DAYS
 12036                                    DC-ODD-DAYS-OVER
 12037          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12038          SET BIN-PLUS-ELAPSED    TO TRUE
 12039*         MOVE 6                  TO DC-OPTION-CODE
 12040          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12041          IF NO-CONVERSION-ERROR
 12042             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12043
 12044******************************************************************
 12045*                                                                *
 12046*            1ST PAYMENT DATE PROCESSING                         *
 12047*                                                                *
 12048******************************************************************
 12049
 12050     IF PB-1ST-PMT-DT-PROCESSING
 12051        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12052                                    PB-I-AH-EXPIRE-DT
 12053        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12054
 12055     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12056         NEXT SENTENCE
 12057     ELSE
 12058         MOVE ER-2680                 TO WS-ERROR
 12059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12060         GO TO 3060-ORIG-TERM-CHECK.
 12061
 12062     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12063     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12064     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12065*    MOVE 1                      TO DC-OPTION-CODE.
 12066     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12067                                    DC-ELAPSED-DAYS
 12068                                    DC-ODD-DAYS-OVER.
 12069
 12070     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12071
 12072     IF DATE-CONVERSION-ERROR
 12073        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 220
* EL050.cbl
 12074
 12075     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12076     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12077        AND (WS-LF-COVERAGE-TYPE = 'L')
 12078        IF (DC-ELAPSED-MONTHS > 1)
 12079                      OR
 12080           ((DC-ELAPSED-MONTHS = 1)
 12081           AND (DC-ODD-DAYS-OVER > 0))
 12082           MOVE ER-2882          TO WS-ERROR
 12083           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12084        END-IF
 12085     END-IF
 12086     if dc-elapsed-months > 0
 12087        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12088        + dc-odd-days-over
 12089     end-if
 12090     IF PB-EXT-DAYS-PROCESSING
 12091        CONTINUE
 12092     ELSE
 12093        IF DC-ELAPSED-MONTHS = +0
 12094           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12095        ELSE
 12096           IF (WS-LF-EARNINGS-CALC = '4')
 12097              AND (DC-ELAPSED-MONTHS > ZERO)
 12098              AND (DC-ELAPSED-DAYS > ZERO)
 12099              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12100           ELSE
 12101              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12102                                 THRU 6499-EXIT
 12103              MOVE WS-ODD-DAYS-OVER
 12104                                 TO PB-I-EXTENTION-DAYS
 12105           END-IF
 12106        END-IF
 12107     END-IF
 12108******************************************************************
 12109*                                                                *
 12110*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12111*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12112*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12113*            AND ANY ODD DAYS.                                   *
 12114*                                                                *
 12115******************************************************************
 12116
 12117     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12118                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12119     IF WS-LF-EARNINGS-CALC NOT = '4'
 12120        IF DC-ELAPSED-DAYS > ZEROS
 12121           MOVE ER-2681          TO WS-ERROR
 12122           PERFORM 9900-ERROR-FORMAT
 12123                                 THRU 9900-EXIT
 12124        END-IF
 12125     END-IF
 12126
 12127     IF WS-LF-EARNINGS-CALC NOT = '4'
 12128        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12129           MOVE ER-2681          TO WS-ERROR
 12130           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12131
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 221
* EL050.cbl
 12132     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12133        (PB-I-LF-TERM NOT = ZERO) AND
 12134         NOT NO-LIFE-COVERAGE
 12135          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12136          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12137          IF WS-LF-EARNINGS-CALC = '4'
 12138             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12139             PB-I-PAY-FREQUENCY
 12140          END-IF
 12141          MOVE ZERO              TO DC-ELAPSED-DAYS
 12142                                    DC-ODD-DAYS-OVER
 12143          MOVE 1                 TO DC-END-OF-MONTH
 12144          SET BIN-PLUS-ELAPSED        TO TRUE
 12145*         MOVE 6                 TO DC-OPTION-CODE
 12146          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12147          IF NO-CONVERSION-ERROR
 12148             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12149             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12150                (WS-LF-SPECIAL-CALC-CD = 'L')
 12151                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12152                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12153                  MOVE +1             TO DC-ELAPSED-MONTHS
 12154                  SET BIN-PLUS-ELAPSED  TO TRUE
 12155*                 MOVE 6              TO DC-OPTION-CODE
 12156                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12157                  IF NO-CONVERSION-ERROR
 12158                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12159
 12160* okay, i had to move the new att age edit down here because the
 12161* expiration date could get recalculated and i need the exp date
 12162     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12163        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12164        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12165        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12166           AND ZEROS
 12167           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12168           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12169           SET ELAPSED-BETWEEN-BIN TO TRUE
 12170           PERFORM 8500-DATE-CONVERT
 12171                                 THRU 8500-EXIT
 12172           IF NO-CONVERSION-ERROR
 12173              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12174                 MOVE ER-2669       TO WS-ERROR
 12175*                PERFORM 9900-ERROR-FORMAT
 12176*                                THRU 9900-EXIT
 12177              END-IF
 12178           END-IF
 12179        ELSE
 12180           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12181           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12182              MOVE ER-2669       TO WS-ERROR
 12183*             PERFORM 9900-ERROR-FORMAT
 12184*                                THRU 9900-EXIT
 12185           ELSE
 12186              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12187                 MOVE ER-1570    TO WS-ERROR
 12188                 PERFORM 9900-ERROR-FORMAT
 12189                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 222
* EL050.cbl
 12190              END-IF
 12191           END-IF
 12192        END-IF
 12193        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12194           AND ZEROS
 12195           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12196           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12197           SET ELAPSED-BETWEEN-BIN TO TRUE
 12198           PERFORM 8500-DATE-CONVERT
 12199                                 THRU 8500-EXIT
 12200           IF NO-CONVERSION-ERROR
 12201              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12202                 MOVE ER-2669       TO WS-ERROR
 12203*                PERFORM 9900-ERROR-FORMAT
 12204*                                THRU 9900-EXIT
 12205              END-IF
 12206           END-IF
 12207        ELSE
 12208           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12209             (PB-I-LF-TERM / 12)
 12210           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12211              MOVE ER-2669       TO WS-ERROR
 12212*             PERFORM 9900-ERROR-FORMAT
 12213*                                THRU 9900-EXIT
 12214           ELSE
 12215              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12216                 MOVE ER-1571    TO WS-ERROR
 12217                 PERFORM 9900-ERROR-FORMAT
 12218                                 THRU 9900-EXIT
 12219              END-IF
 12220           END-IF
 12221        END-IF
 12222        IF WS-ERROR = ER-2669
 12223           PERFORM 9900-ERROR-FORMAT
 12224                                 THRU 9900-EXIT
 12225        END-IF
 12226     END-IF
 12227     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12228        (PB-I-AH-TERM NOT = ZERO) AND
 12229         NOT NO-AH-COVERAGE
 12230          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12231             AND (PB-COMPANY-ID = 'DCC')
 12232             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12233             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12234          ELSE
 12235             IF WS-LF-EARNINGS-CALC = '4'
 12236                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12237                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12238                PB-I-PAY-FREQUENCY
 12239             ELSE
 12240                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12241                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12242             END-IF
 12243          END-IF
 12244          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12245                                         DC-ODD-DAYS-OVER
 12246          MOVE 1                      TO DC-END-OF-MONTH
 12247          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 223
* EL050.cbl
 12248*         MOVE 6                      TO DC-OPTION-CODE
 12249          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12250          IF NO-CONVERSION-ERROR
 12251             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12252     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12253        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12254        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12255        IF PB-I-BIRTHDAY > LOW-VALUES
 12256           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12257           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12258           SET ELAPSED-BETWEEN-BIN TO TRUE
 12259           PERFORM 8500-DATE-CONVERT
 12260                                 THRU 8500-EXIT
 12261           IF NO-CONVERSION-ERROR
 12262              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12263                 MOVE ER-3054       TO WS-ERROR
 12264*                PERFORM 9900-ERROR-FORMAT
 12265*                                THRU 9900-EXIT
 12266              END-IF
 12267           END-IF
 12268        ELSE
 12269           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12270           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12271              MOVE ER-3054       TO WS-ERROR
 12272*             PERFORM 9900-ERROR-FORMAT
 12273*                                THRU 9900-EXIT
 12274           END-IF
 12275        END-IF
 12276        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12277           AND ZEROS
 12278           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12279           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12280           SET ELAPSED-BETWEEN-BIN TO TRUE
 12281           PERFORM 8500-DATE-CONVERT
 12282                                 THRU 8500-EXIT
 12283           IF NO-CONVERSION-ERROR
 12284              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12285                 MOVE ER-3054       TO WS-ERROR
 12286*                PERFORM 9900-ERROR-FORMAT
 12287*                                THRU 9900-EXIT
 12288              END-IF
 12289           END-IF
 12290        ELSE
 12291           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12292             (PB-I-AH-TERM / 12)
 12293           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12294              MOVE ER-3054       TO WS-ERROR
 12295*             PERFORM 9900-ERROR-FORMAT
 12296*                                THRU 9900-EXIT
 12297           END-IF
 12298        END-IF
 12299        IF WS-ERROR = ER-3054
 12300           PERFORM 9900-ERROR-FORMAT
 12301                                 THRU 9900-EXIT
 12302        END-IF
 12303     END-IF
 12304     MOVE SPACE                       TO DC-END-OF-MONTH.
 12305
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 224
* EL050.cbl
 12306     IF PB-COMPANY-ID = 'NCB'
 12307        GO TO 3040-EDIT-EXTENSION-DAYS.
 12308
 12309     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12310       AND
 12311        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12312        NEXT SENTENCE
 12313     ELSE
 12314        GO TO 3040-EDIT-EXTENSION-DAYS.
 12315
 12316     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12317        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12318        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12319     ELSE
 12320        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12321        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12322
 12323     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12324*    MOVE '1'      TO DC-OPTION-CODE
 12325     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12326     IF (NO-CONVERSION-ERROR)
 12327        AND (DC-ELAPSED-MONTHS > +1)
 12328        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12329        MOVE ER-2668   TO WS-ERROR
 12330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12331
 12332 3040-EDIT-EXTENSION-DAYS.
 12333
 12334     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12335        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12336         GO TO 3050-EDIT-TERM-IN-DAYS
 12337     ELSE
 12338         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12339
 12340     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12341         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12342     ELSE
 12343        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12344           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12345           MOVE ER-2681         TO WS-ERROR
 12346           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12347
 12348     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12349        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12350        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12351         GO TO 3060-ORIG-TERM-CHECK.
 12352
 12353     GO TO 3060-ORIG-TERM-CHECK.
 12354
 12355 3050-EDIT-TERM-IN-DAYS.
 12356
 12357     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12358
 12359     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12360         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12361     ELSE
 12362         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12363            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 225
* EL050.cbl
 12364            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12365
 12366     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12367                                       REMAINDER WS-WORK-TERM.
 12368     IF WS-WORK-TERM GREATER THAN ZERO
 12369         ADD +1 TO PB-I-LF-TERM.
 12370
 12371     IF NOT NO-AH-COVERAGE
 12372         MOVE ER-2684            TO WS-ERROR
 12373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12374
 12375
 12376 3060-ORIG-TERM-CHECK.
 12377
 12378******************************************************************
 12379*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12380******************************************************************
 12381
 12382     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12383        NEXT SENTENCE
 12384     ELSE
 12385        IF NOT NO-LIFE-COVERAGE
 12386           IF PB-I-LF-TERM NUMERIC
 12387              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12388              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12389              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12390                  NEXT SENTENCE
 12391           ELSE
 12392              MOVE ER-2647       TO WS-ERROR
 12393              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12394
 12395     IF NOT NO-AH-COVERAGE
 12396         IF PB-I-AH-TERM NUMERIC
 12397            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12398            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12399            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12400             NEXT SENTENCE
 12401          ELSE
 12402              MOVE ER-2658       TO WS-ERROR
 12403              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12404
 12405     IF PB-COMPANY-ID = 'NCB'
 12406        GO TO 3070-LOAN-TERM-CHECK.
 12407
 12408     IF POLICY-HAS-AH
 12409       AND
 12410        POLICY-HAS-LIFE
 12411       AND
 12412        PB-I-LF-TERM NUMERIC
 12413       AND
 12414        PB-I-AH-TERM NUMERIC
 12415        NEXT SENTENCE
 12416     ELSE
 12417        GO TO 3070-LOAN-TERM-CHECK.
 12418
 12419     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12420     IF WS-TEX-FACT-2 LESS THAN +0
 12421        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 226
* EL050.cbl
 12422
 12423     IF WS-TEX-FACT-2 GREATER THAN +1
 12424        MOVE ER-2668             TO WS-ERROR
 12425        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12426
 12427 3070-LOAN-TERM-CHECK.
 12428
 12429     IF (WS-LF-BENEFIT-CD = ZERO)
 12430         OR (NO-LF-BENEFIT-MATCH)
 12431            GO TO 3125-EDIT-PMT-FREQ.
 12432*    IF PB-COMPANY-ID NOT = 'DCC'
 12433*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12434*          AND 'V' AND 'W' AND 'X'
 12435*          GO TO 3125-EDIT-PMT-FREQ
 12436*       END-IF
 12437*    ELSE
 12438*       IF WS-AH-DCC-TRUNC = 'T'
 12439*          CONTINUE
 12440*       ELSE
 12441*          GO TO 3125-EDIT-PMT-FREQ
 12442*       END-IF
 12443*    END-IF
 12444     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12445                    OR
 12446        ((PB-COMPANY-ID = 'DCC')
 12447        AND (WS-AH-DCC-TRUNC = 'T'))
 12448        CONTINUE
 12449     ELSE
 12450        GO TO 3125-EDIT-PMT-FREQ
 12451     END-IF
 12452     IF PB-I-LOAN-TERM NOT NUMERIC
 12453         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12454
 12455     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12456        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12457*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12458        PB-I-LOAN-TERM NOT GREATER THAN +360
 12459         NEXT SENTENCE
 12460     ELSE
 12461         MOVE ER-2648            TO WS-ERROR
 12462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12463
 12464     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12465        MOVE ER-3058             TO WS-ERROR
 12466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12467     end-if
 12468
 12469     IF WS-STATE-ABBREVIATION = 'NC'
 12470        IF PB-I-LOAN-TERM > +59
 12471           CONTINUE
 12472        ELSE
 12473           MOVE ER-2792          TO WS-ERROR
 12474           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12475        END-IF
 12476     END-IF
 12477
 12478     .
 12479 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 227
* EL050.cbl
 12480     IF (WS-LF-BENEFIT-CD = ZERO)
 12481         OR (NO-LF-BENEFIT-MATCH)
 12482            GO TO 3127-EDIT-LOAN-OFFICER.
 12483     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12484                    OR
 12485        ((PB-COMPANY-ID = 'DCC')
 12486        AND (WS-AH-DCC-TRUNC = 'T'))
 12487                    OR
 12488         (PB-COMPANY-ID = 'AHL')
 12489        CONTINUE
 12490     ELSE
 12491        IF (PB-I-LOAN-TERM > ZEROS)
 12492           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12493           MOVE ER-1575          TO WS-ERROR
 12494           PERFORM 9900-ERROR-FORMAT
 12495                                 THRU 9900-EXIT
 12496        END-IF
 12497     END-IF
 12498     IF WS-LF-EARNINGS-CALC NOT = '4'
 12499         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12500            MOVE ER-2653         TO WS-ERROR
 12501            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12502            GO TO 3127-EDIT-LOAN-OFFICER
 12503         ELSE
 12504            GO TO 3127-EDIT-LOAN-OFFICER.
 12505
 12506     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12507         MOVE ER-2655            TO WS-ERROR
 12508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12509         GO TO 3127-EDIT-LOAN-OFFICER.
 12510
 12511     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12512         MOVE ER-2654            TO WS-ERROR
 12513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12514         GO TO 3127-EDIT-LOAN-OFFICER.
 12515
 12516     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12517         GIVING WS-TEX-FACT-2
 12518             REMAINDER WS-TEX-FACT-3.
 12519
 12520*    IF WS-TEX-FACT-3 NOT = ZERO
 12521*       MOVE ER-2654             TO WS-ERROR
 12522*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12523
 12524
 12525 3127-EDIT-LOAN-OFFICER.
 12526
 12527     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12528        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12529           MOVE ER-2690          TO WS-ERROR
 12530           PERFORM 9900-ERROR-FORMAT
 12531                                 THRU 9900-EXIT
 12532        ELSE
 12533           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12534           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12535           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12536           MOVE PB-SV-STATE      TO LOFC-STATE
 12537           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 228
* EL050.cbl
 12538           MOVE PB-I-LOAN-OFFICER
 12539                                 TO LOFC-CODE
 12540           PERFORM 8586-READ-LOAN-OFFICER
 12541                                 THRU 8586-EXIT
 12542           IF (NOT LOFC-MASTER-FOUND)
 12543              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12544              MOVE ER-3006       TO WS-ERROR
 12545              PERFORM 9900-ERROR-FORMAT
 12546                                 THRU 9900-EXIT
 12547           END-IF
 12548        END-IF
 12549     END-IF
 12550     .
 12551 3129-EDIT-APR.
 12552
 12553     IF (WS-LF-BENEFIT-CD = ZERO)
 12554        OR (NO-LF-BENEFIT-MATCH)
 12555        IF PB-COMPANY-ID NOT = 'DCC'
 12556           GO TO 3130-EDIT-AGE
 12557*       ELSE
 12558*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12559*             GO TO 3130-EDIT-AGE
 12560*          END-IF
 12561        END-IF
 12562     END-IF
 12563
 12564     IF (WS-STATE-ABBREVIATION = 'OH')
 12565         AND (PB-I-RATE-CLASS NOT = 'L ')
 12566         AND (PB-I-LF-TERM GREATER THAN 60)
 12567         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12568         GO TO 3129-APR-CONT.
 12569
 12570     IF (WS-STATE-ABBREVIATION = 'RI')
 12571         AND (PB-I-LF-TERM GREATER THAN 60)
 12572         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12573         GO TO 3129-APR-CONT.
 12574
 12575     IF (WS-STATE-ABBREVIATION = 'UT')
 12576         AND (PB-I-LF-TERM GREATER THAN 62)
 12577         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12578         AND (PB-CERT-EFF-DT LESS WS-830901)
 12579         GO TO 3129-APR-CONT.
 12580
 12581     IF PB-COMPANY-ID = 'LAP'
 12582        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12583           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12584              MOVE ER-2656         TO WS-ERROR
 12585              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12586              GO TO 3130-EDIT-AGE.
 12587
 12588     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12589        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12590        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12591        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12592        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12593        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12594         GO TO 3130-EDIT-AGE.
 12595
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 229
* EL050.cbl
 12596 3129-APR-CONT.
 12597     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12598         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12599         GO TO 3130-EDIT-AGE.
 12600
 12601     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12602         WS-AH-BENEFIT-CD (1:1) = 'S')
 12603        AND (PB-COMPANY-ID = 'DCC')
 12604        AND (PB-I-LOAN-APR = ZERO)
 12605        MOVE ER-2657             TO WS-ERROR
 12606        PERFORM 9900-ERROR-FORMAT
 12607                                 THRU 9900-EXIT
 12608        GO TO 3130-EDIT-AGE
 12609     END-IF
 12610*    IF PB-I-LOAN-APR = ZERO
 12611*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12612*    END-IF
 12613
 12614     if pb-i-loan-apr = +99.9999
 12615        move er-2656             to ws-error
 12616        PERFORM 9900-ERROR-FORMAT
 12617                                 THRU 9900-EXIT
 12618        GO TO 3130-EDIT-AGE
 12619     end-if
 12620*    IF PB-I-LOAN-APR = ZERO
 12621*       MOVE ER-2656             TO WS-ERROR
 12622*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12623*       GO TO 3130-EDIT-AGE.
 12624
 12625*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12626     if pb-i-loan-apr not = +99.9999
 12627        IF PB-I-LOAN-APR > +30.000
 12628           MOVE ER-2657          TO WS-ERROR
 12629           PERFORM 9900-ERROR-FORMAT
 12630                                 THRU 9900-EXIT
 12631        end-if
 12632     end-if
 12633     .
 12634 3130-EDIT-AGE.
 12635
 12636******************************************************************
 12637*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12638******************************************************************
 12639
 12640     IF NOT NO-LIFE-COVERAGE
 12641        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12642           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12643               MOVE ER-2628             TO WS-ERROR
 12644               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12645
 12646     IF NOT NO-AH-COVERAGE
 12647        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12648           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12649               MOVE ER-2628         TO WS-ERROR
 12650               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12651
 12652 3133-SEX-CODE.
 12653     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 230
* EL050.cbl
 12654         IF WS-DEFAULT-SEX = 'M'
 12655             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12656          ELSE
 12657             IF WS-DEFAULT-SEX = 'F'
 12658             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12659
 12660     IF PB-I-INSURED-SEX = '1'
 12661         MOVE 'M' TO PB-I-INSURED-SEX.
 12662
 12663     IF PB-I-INSURED-SEX = '2'
 12664         MOVE 'F' TO PB-I-INSURED-SEX.
 12665
 12666 3134-SIG-SW-EDIT.
 12667     IF PB-I-SIG-SW = SPACE
 12668         MOVE 'N'                TO  PB-I-SIG-SW.
 12669
 12670     IF PB-COMPANY-ID = 'NCL'
 12671         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12672             NEXT SENTENCE
 12673         ELSE
 12674             MOVE ER-1923        TO  WS-ERROR
 12675             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12676     ELSE
 12677     IF PB-COMPANY-ID = 'CRI'
 12678         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12679             NEXT SENTENCE
 12680         ELSE
 12681             MOVE ER-2606        TO  WS-ERROR
 12682             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12683     ELSE
 12684     IF PB-COMPANY-ID = 'TMS'
 12685         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12686             NEXT SENTENCE
 12687         ELSE
 12688             MOVE ER-2689        TO  WS-ERROR
 12689             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12690     ELSE
 12691         IF PB-I-SIG-SW = 'Y' OR 'N'
 12692             NEXT SENTENCE
 12693         ELSE
 12694             MOVE ER-2651        TO  WS-ERROR
 12695             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12696
 12697     IF PB-COMPANY-ID = 'FLA'
 12698         IF (WS-EDIT-AGE GREATER 54  OR
 12699             WS-AH-EDIT-AGE GREATER 54)  AND
 12700            PB-I-SIG-SW = 'N'
 12701            MOVE ER-2651         TO  WS-ERROR
 12702            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12703
 12704 3135-NAME-EDIT.
 12705
 12706     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12707        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12708        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12709           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12710                                 TO PB-I-JOINT-FIRST-NAME
 12711        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 231
* EL050.cbl
 12712     END-IF
 12713     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12714        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12715        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12716           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12717                                 TO PB-I-JOINT-LAST-NAME
 12718        END-PERFORM
 12719     END-IF
 12720     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12721        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12722        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12723           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12724                                 TO PB-I-INSURED-FIRST-NAME
 12725        END-PERFORM
 12726     END-IF
 12727     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12728        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12729        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12730           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12731                                 TO PB-I-INSURED-LAST-NAME
 12732        END-PERFORM
 12733     END-IF
 12734     IF PB-I-INSURED-LAST-NAME = SPACES
 12735       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12736       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12737           MOVE ER-2660    TO WS-ERROR
 12738           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12739
 12740 3136-EDIT-SEX.
 12741
 12742******************************************************************
 12743*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12744******************************************************************
 12745
 12746     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12747        (WS-AH-SPECIAL-CALC-CD = 'O')
 12748        NEXT SENTENCE
 12749     ELSE
 12750        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12751           NEXT SENTENCE
 12752        ELSE
 12753           MOVE ER-2629            TO WS-ERROR
 12754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12755
 12756 3137-EDIT-EFF-DATE.
 12757
 12758     IF PB-REISSUED-CERT       OR
 12759        PB-POLICY-IS-DECLINED  OR
 12760        PB-POLICY-IS-VOIDED
 12761         GO TO 3139-EDIT-COVERAGE-CODES.
 12762
 12763     MOVE SPACE                  TO WS-2671-SW
 12764                                    WS-2672-SW.
 12765
 12766     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12767         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12768             MOVE ER-2703        TO WS-ERROR
 12769             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 232
* EL050.cbl
 12770             GO TO 3139-EDIT-COVERAGE-CODES.
 12771
 12772     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12773         GO TO 3139-EDIT-COVERAGE-CODES.
 12774
 12775     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12776     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12777*    MOVE '1'                    TO DC-OPTION-CODE.
 12778     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12779     MOVE +0                     TO DC-ELAPSED-MONTHS
 12780                                    DC-ELAPSED-DAYS.
 12781     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12782
 12783     IF DATE-CONVERSION-ERROR
 12784         GO TO 3139-EDIT-COVERAGE-CODES.
 12785
 12786     IF DC-ELAPSED-DAYS GREATER +180
 12787         MOVE ER-2672            TO WS-ERROR
 12788         MOVE 'Y'                TO WS-2672-SW
 12789         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12790     END-IF
 12791
 12792     IF WS-ERROR = ER-2671  AND
 12793        PB-COMPANY-ID  = 'LBL'
 12794        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12795        MOVE SPACE               TO WS-2671-SW
 12796        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12797
 12798     IF PB-ISSUE-DATE-FORCED  AND
 12799      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12800         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12801         MOVE ER-2673            TO WS-ERROR
 12802         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12803         MOVE SPACE              TO WS-2671-SW
 12804                                    WS-2672-SW.
 12805
 12806     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12807         IF PB-ISSUE-DATE-FORCED
 12808             MOVE ER-2600          TO  WS-ERROR
 12809             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12810         ELSE
 12811             MOVE ER-2692          TO  WS-ERROR
 12812             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12813
 12814
 12815 3139-EDIT-COVERAGE-CODES.
 12816
 12817     if pb-company-id not = 'AHL'
 12818        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12819           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12820           MOVE ER-2787          TO WS-ERROR
 12821           PERFORM 9900-ERROR-FORMAT
 12822                                 THRU 9900-EXIT
 12823        END-IF
 12824     end-if
 12825     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12826        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12827                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 233
* EL050.cbl
 12828           MOVE ER-2719          TO WS-ERROR
 12829           PERFORM 9900-ERROR-FORMAT
 12830                                 THRU 9900-EXIT
 12831        END-IF
 12832     END-IF
 12833
 12834     IF PB-POLICY-IS-DECLINED  OR
 12835        PB-POLICY-IS-VOIDED
 12836         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12837
 12838     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12839        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12840         MOVE ER-2630                TO WS-ERROR
 12841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12842
 12843     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12844        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12845        PB-I-LF-PREMIUM-AMT = ZERO
 12846         GO TO 3140-CHECK-AH-FOR-ZERO.
 12847
 12848     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12849        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12850        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12851         GO TO 3140-CHECK-AH-FOR-ZERO.
 12852
 12853     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12854        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12855        MOVE ER-2631             TO WS-ERROR
 12856        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12857     END-IF
 12858
 12859
 12860******************************************************************
 12861*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12862******************************************************************
 12863
 12864     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12865        NEXT SENTENCE
 12866     ELSE
 12867        IF PB-I-LF-BENEFIT-AMT = ZERO
 12868           MOVE ER-2632             TO WS-ERROR
 12869           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12870
 12871
 12872******************************************************************
 12873*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12874******************************************************************
 12875
 12876     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12877        CONTINUE
 12878     ELSE
 12879        IF PB-I-LF-PREMIUM-AMT = ZERO
 12880           IF (NOT PB-COMP-LF-PREM)
 12881              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12882              and (ws-lf-ben-category not = 'C')
 12883              MOVE ER-2633       TO WS-ERROR
 12884              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12885           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 234
* EL050.cbl
 12886        END-IF
 12887     END-IF
 12888     .
 12889 3140-CHECK-AH-FOR-ZERO.
 12890
 12891     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12892        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12893        PB-I-AH-PREMIUM-AMT = ZERO
 12894         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12895
 12896     IF PB-COMPANY-ID = 'CSL'  AND
 12897        PB-I-AH-BENEFIT-CD = ZERO  AND
 12898        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12899        PB-I-AH-PREMIUM-AMT = ZERO
 12900         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12901
 12902     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12903        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12904        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12905         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12906
 12907     IF PB-I-AH-BENEFIT-CD = ZERO
 12908         MOVE ER-2634            TO WS-ERROR
 12909         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12910
 12911******************************************************************
 12912*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12913******************************************************************
 12914
 12915     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12916        NEXT SENTENCE
 12917     ELSE
 12918        IF PB-I-AH-BENEFIT-AMT = ZERO
 12919           MOVE ER-2635             TO WS-ERROR
 12920           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12921
 12922******************************************************************
 12923*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12924******************************************************************
 12925
 12926     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12927        NEXT SENTENCE
 12928     ELSE
 12929        IF PB-I-AH-PREMIUM-AMT = ZERO
 12930            IF NOT PB-COMP-AH-PREM
 12931                MOVE ER-2636    TO WS-ERROR
 12932                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12933
 12934
 12935 3140-EDIT-MAX-AMT-SIZES.
 12936* CUSTOM CODE FOR CLIENT    'DMD'
 12937     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12938                                     WS-RES-MUNI-TAX
 12939                                     PB-I-STATE-TAX
 12940                                     PB-I-MUNI-TAX.
 12941
 12942     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12943
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 235
* EL050.cbl
 12944     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12945        GO TO 3150-RATE-OUTSTAND-BAL.
 12946
 12947     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12948        GO TO 3150-RATE-OUTSTAND-BAL.
 12949
 12950     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12951        GO TO 3150-RATE-OUTSTAND-BAL.
 12952
 12953     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12954                             OR 'RIC')
 12955        GO TO 3150-RATE-OUTSTAND-BAL.
 12956
 12957     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12958        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12959            GO TO 3150-RATE-OUTSTAND-BAL
 12960        ELSE
 12961           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12962               GO TO 3150-RATE-OUTSTAND-BAL.
 12963
 12964     IF NOT PB-NO-MONTHS-SKIPPED
 12965        GO TO 3150-RATE-OUTSTAND-BAL.
 12966
 12967     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12968        GO TO 3150-RATE-OUTSTAND-BAL.
 12969
 12970     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12971        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12972           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12973             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12974           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12975           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12976              MOVE ER-2693     TO WS-ERROR
 12977              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12978              GO TO 3150-RATE-OUTSTAND-BAL
 12979           ELSE
 12980              GO TO 3150-RATE-OUTSTAND-BAL.
 12981
 12982 3150-RATE-OUTSTAND-BAL.
 12983
 12984* DMD RATING TEST
 12985     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12986         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12987         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12988         MOVE ER-2687                 TO WS-ERROR
 12989         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12990         MOVE 'B'                     TO PB-I-OB-FLAG
 12991         GO TO 3260-EDIT-CONTINUE.
 12992
 12993     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12994         IF  WS-ERROR    EQUAL    ER-2693
 12995             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12996                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12997                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12998                 MOVE  +0            TO  WS-ERROR.
 12999
 13000     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13001         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 236
* EL050.cbl
 13002             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13003                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13004                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13005                 MOVE  +0            TO  WS-ERROR.
 13006
 13007     IF PLAN-MASTER-AH-SW = 'Y'
 13008        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13009            IF  WS-ERROR    EQUAL    ER-2693
 13010              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13011                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13012                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13013                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13014                 MOVE  ER-1910           TO  WS-ERROR
 13015                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13016
 13017     IF PLAN-MASTER-AH-SW = 'Y'
 13018        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13019            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13020               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13021               MOVE  ER-1910           TO  WS-ERROR
 13022               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13023
 13024     IF PLAN-MASTER-AH-SW = 'Y'
 13025        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13026            IF  WS-ERROR    EQUAL    ER-2693
 13027                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13028                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13029                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13030                 MOVE  +0       TO  WS-ERROR.
 13031
 13032     IF WS-ERROR = ER-2693
 13033        IF PB-COMPANY-ID = 'JAL' AND
 13034           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13035           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13036           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13037
 13038     IF WS-ERROR = ER-2693
 13039        IF PB-COMPANY-ID = 'NCL'  AND
 13040           PB-I-AH-BENEFIT-CD = 'OA'
 13041           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13042           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13043
 13044     IF WS-ERROR = ER-2693
 13045        IF PB-COMPANY-ID = 'CNL' AND
 13046           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13047           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13048           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13049
 13050     IF WS-ERROR = ER-2693
 13051        IF PB-COMPANY-ID = 'HER'
 13052           IF WS-LEVEL
 13053              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13054              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13055
 13056     IF ((LF-BENEFIT-FOUND) AND
 13057         (NOT NO-LIFE-COVERAGE)  AND
 13058         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13059       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 237
* EL050.cbl
 13060             (NOT NO-AH-COVERAGE)    AND
 13061             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13062         NEXT SENTENCE
 13063     ELSE
 13064         GO TO 3215-EDIT-RATES.
 13065
 13066     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13067        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13068           MOVE ER-2674          TO WS-ERROR
 13069           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13070           GO TO 3215-EDIT-RATES.
 13071
 13072     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13073        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13074           MOVE ER-2674          TO WS-ERROR
 13075           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13076           GO TO 3215-EDIT-RATES.
 13077
 13078     MOVE 'B'                    TO PB-I-OB-FLAG.
 13079
 13080     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13081         NEXT SENTENCE
 13082     ELSE
 13083         IF NOT NO-LIFE-COVERAGE
 13084             IF WS-ACCT-LF-OB-RT = ZERO
 13085                MOVE ER-2641    TO WS-ERROR
 13086                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13087
 13088     IF PB-COMPANY-ID = 'CRI'
 13089       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13090         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13091         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13092         IF WS-ERROR = ER-2675
 13093            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13094            MOVE ER-2687              TO WS-ERROR
 13095            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13096         ELSE
 13097            MOVE ER-2687              TO WS-ERROR
 13098            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13099
 13100
 13101     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13102         NEXT SENTENCE
 13103     ELSE
 13104       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13105            NEXT SENTENCE
 13106       ELSE
 13107         IF NOT NO-AH-COVERAGE
 13108             IF WS-ACCT-AH-OB-RT = ZERO
 13109                MOVE ER-2642    TO WS-ERROR
 13110                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13111
 13112     IF PB-COMPANY-ID = 'CRI'
 13113       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13114         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13115         IF WS-ERROR = ER-2676
 13116            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13117            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 238
* EL050.cbl
 13118            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13119         ELSE
 13120            MOVE ER-2687              TO WS-ERROR
 13121            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13122
 13123     IF PB-COMPANY-ID NOT = 'GIC'
 13124         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13125            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13126     ELSE
 13127         IF PB-I-LF-PREM-CALC = ZEROS
 13128             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13129                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13130
 13131     IF PB-COMPANY-ID NOT = 'GIC'
 13132         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13133            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13134     ELSE
 13135         IF PB-I-AH-PREM-CALC = ZEROS
 13136             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13137                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13138
 13139     MOVE ZEROS TO PB-I-MORT-CODE.
 13140
 13141     GO TO 3260-EDIT-CONTINUE.
 13142
 13143
 13144 3215-EDIT-RATES.
 13145     IF ACCOUNT-MAST-FOUND
 13146         NEXT SENTENCE
 13147     ELSE
 13148         GO TO 3999-END-EDIT.
 13149
 13150 3220-CHECK-LF-RATES.
 13151
 13152     IF PB-COMPANY-ID = 'DCC'
 13153        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13154        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13155        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13156           AND (NOT WS-LF-CASH))
 13157                           OR
 13158           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13159           AND (NOT WS-AH-CASH)))
 13160                       AND
 13161           (PB-I-ENTRY-STATUS NOT = '5')
 13162           MOVE 'M'              TO PB-BATCH-ENTRY
 13163                                    PB-I-ENTRY-STATUS
 13164        END-IF
 13165     END-IF
 13166     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13167                                    PB-I-AH-PREM-CALC
 13168                                    PB-I-LF-ALT-PREM-CALC
 13169                                    PB-I-LF-ALT-RATE
 13170                                    PB-I-LF-REI-RATE
 13171                                    PB-I-LF-ALT-REI-RATE
 13172                                    PB-I-AH-REI-RATE
 13173                                    PB-I-TOT-FEES-CALC.
 13174
 13175     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 239
* EL050.cbl
 13176        NEXT SENTENCE
 13177     ELSE
 13178        MOVE ZEROS               TO PB-I-LF-RATE
 13179                                    PB-I-AH-RATE.
 13180
 13181     IF PB-I-TOT-FEES NOT NUMERIC
 13182        MOVE ZEROS               TO PB-I-TOT-FEES
 13183     END-IF
 13184     IF PB-I-LIVES NOT NUMERIC
 13185         MOVE ZERO               TO PB-I-LIVES.
 13186
 13187     IF PB-I-NUM-BILLED NOT NUMERIC
 13188         MOVE ZERO               TO PB-I-NUM-BILLED.
 13189
 13190     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13191        MOVE +0                  TO PB-I-LF-PREM-TAX
 13192     END-IF
 13193
 13194     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13195        MOVE +0                  TO PB-I-AH-PREM-TAX
 13196     END-IF
 13197
 13198     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13199        PB-I-PAY-FREQUENCY = ZEROS
 13200            MOVE 12 TO CP-PAY-FREQUENCY
 13201     ELSE
 13202            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13203
 13204     IF PB-I-STATE-TAX NOT NUMERIC
 13205         MOVE ZEROS               TO PB-I-STATE-TAX.
 13206
 13207     IF PB-I-MUNI-TAX NOT NUMERIC
 13208         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13209
 13210     MOVE SPACES                 TO CP-BEN-CATEGORY
 13211     IF PB-COMPANY-ID  = 'CSL'  AND
 13212        PB-I-LF-TERM NOT = ZERO
 13213        COMPUTE WS-PAYMENT-AMT =
 13214             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13215        COMPUTE WS-CSL-AMT1 =
 13216             PB-I-LF-TERM * AM-MAX-MON-BEN
 13217        COMPUTE WS-CSL-AMT2 =
 13218             WS-PAYMENT-AMT * PB-I-LF-TERM
 13219        IF CP-PAY-FREQUENCY NOT = 12
 13220           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13221           MOVE '8' TO WS-CSL-CALC-CD
 13222        ELSE
 13223           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13224              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13225               AM-MAX-TOT-BEN
 13226               MOVE '6' TO WS-CSL-CALC-CD
 13227           ELSE
 13228              IF (WS-CSL-AMT1  GREATER THAN
 13229                 AM-MAX-TOT-BEN) AND
 13230                 (WS-CSL-AMT2  GREATER THAN
 13231                 AM-MAX-TOT-BEN)
 13232                 MOVE '7' TO WS-CSL-CALC-CD
 13233              ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 240
* EL050.cbl
 13234                 MOVE '5' TO WS-CSL-CALC-CD.
 13235
 13236     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13237         NEXT SENTENCE
 13238     ELSE
 13239         GO TO 3300-CHECK-AH-RATES.
 13240
 13241*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13242
 13243     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13244        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13245              OR
 13246           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13247           MOVE ER-2618          TO WS-ERROR
 13248           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13249           GO TO 3300-CHECK-AH-RATES.
 13250
 13251     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13252           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13253                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13254
 13255     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13256         MOVE ER-2687             TO WS-ERROR
 13257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13258         MOVE 'Z000'              TO PB-I-MORT-CODE
 13259         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13260         GO TO 3300-CHECK-AH-RATES.
 13261
 13262     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13263        IF PB-I-LIVES = ZERO
 13264           MOVE ER-2688          TO WS-ERROR
 13265           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13266
 13267     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13268
 13269     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13270     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13271     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13272     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13273     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13274     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13275     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13276     MOVE '3'                    TO CP-PROCESS-TYPE.
 13277     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13278     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13279
 13280******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13281     IF PB-COMPANY-ID EQUAL 'CDL'
 13282         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13283            CP-EARN-AS-NET-PAY)
 13284             IF PB-CERT-EFF-DT GREATER  WS-931231
 13285                 MOVE '1'        TO CP-EARNING-METHOD.
 13286*******
 13287
 13288     MOVE PB-SV-STATE            TO CP-STATE.
 13289     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13290     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13291     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 241
* EL050.cbl
 13292     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13293     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13294                                    CP-RATING-BENEFIT-AMT.
 13295     IF CP-STATE-STD-ABBRV = 'OR'
 13296         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13297                                         PB-I-LF-ALT-BENEFIT-AMT.
 13298     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13299     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13300     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13301     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13302     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13303     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13304     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13305     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13306     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13307                                    CP-REMAINING-TERM
 13308                                    CP-LOAN-TERM.
 13309
 13310     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13311         NEXT SENTENCE
 13312     ELSE
 13313         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13314             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13315                                           PB-I-LF-PREMIUM-AMT.
 13316
 13317     IF PB-COMPANY-ID EQUAL 'CSL'
 13318        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13319           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13320                                         PB-I-LF-PREMIUM-AMT.
 13321
 13322     IF PB-COMPANY-ID EQUAL 'NCB'
 13323         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13324            CP-EARN-AS-NET-PAY
 13325             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13326                 PB-I-LF-PREMIUM-AMT.
 13327
 13328     IF (CP-TRUNCATED-LIFE)
 13329        or ((pb-company-id = 'AHL')
 13330           and (pb-i-loan-term > pb-i-lf-term))
 13331        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13332
 13333     IF PB-COMPANY-ID EQUAL 'CRI'
 13334        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13335
 13336     IF CP-TERM-IS-DAYS
 13337         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13338     ELSE
 13339         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13340     IF PB-COMPANY-ID = 'DCC'
 13341        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13342        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13343        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13344        IF WS-LF-BEN-CATEGORY = 'D'
 13345           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13346           MOVE PB-I-LIFE-COMMISSION
 13347                                 TO CP-DCC-ACT-COMM
 13348           MOVE WS-LF-BEN-CATEGORY
 13349                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 242
* EL050.cbl
 13350        END-IF
 13351        IF (CP-BENEFIT-CD (1:1) = 'P')
 13352           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13353           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13354           add pb-i-ah-premium-amt to cp-original-premium
 13355        END-IF
 13356     END-IF
 13357     IF PB-COMPANY-ID = 'CSL'
 13358         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13359         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13360         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13361
 13362     IF PB-COMPANY-ID = 'CSL'
 13363        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13364
 13365     IF (CP-SPECIAL-CALC-CD = 'H')
 13366        OR (PB-COMPANY-ID = 'DCC')
 13367         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13368                                    TO CP-ALTERNATE-BENEFIT
 13369         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13370
 13371     IF (PB-COMPANY-ID = 'CID')
 13372        AND (WS-LF-EARNINGS-CALC = 'B')
 13373        AND (CP-STATE-STD-ABBRV = 'MN')
 13374        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13375                                 TO CP-ALTERNATE-BENEFIT
 13376        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13377     END-IF
 13378     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13379     MOVE 'R'                   TO CP-RATE-FILE.
 13380     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13381
 13382     IF CP-ERROR-RATE-NOT-FOUND
 13383        MOVE ER-2641            TO WS-ERROR
 13384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13385        GO TO 3300-CHECK-AH-RATES.
 13386
 13387     IF PB-COMPANY-ID EQUAL 'CRI'
 13388        IF CP-ERROR-NO-LIMITS-CRI
 13389           IF NOT ACCOUNT-LIFE-CHECKED
 13390              MOVE ER-2607      TO WS-ERROR
 13391              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13392
 13393******************************************************************
 13394*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13395*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13396******************************************************************
 13397
 13398* CALC LIFE AGE AT EXPIRATION.
 13399
 13400     COMPUTE WS-AGE-AT-EXPIRE =
 13401          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13402
 13403*    IF PB-STATE = 'CO' OR 'UT'
 13404*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13405*        MOVE 'F'            TO PB-FATAL-FLAG
 13406*        MOVE ER-2709        TO WS-ERROR
 13407*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 243
* EL050.cbl
 13408*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13409
 13410*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13411*        MOVE 'X'            TO PB-FATAL-FLAG
 13412*        MOVE ER-2718        TO WS-ERROR
 13413*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13414*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13415
 13416* CALC A & H AGE AT EXPIRATION.
 13417
 13418     COMPUTE WS-AGE-AT-EXPIRE =
 13419          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13420
 13421*    IF PB-STATE = 'CO' OR 'UT'
 13422*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13423*        MOVE 'F'            TO PB-FATAL-FLAG
 13424*        MOVE ER-2709        TO WS-ERROR
 13425*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13426*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13427
 13428*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13429*        MOVE 'X'            TO PB-FATAL-FLAG
 13430*        MOVE ER-2718        TO WS-ERROR
 13431*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13432*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13433
 13434     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13435        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13436
 13437     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13438        and (not pb-monthly-cert)
 13439        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13440     end-if
 13441
 13442     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13443        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13444
 13445     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13446         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13447         MOVE ER-2639        TO WS-ERROR
 13448         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13449
 13450
 13451******************************************************************
 13452*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13453******************************************************************
 13454
 13455 PREMIUM-EDITING-IS-BYPASSED.
 13456     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13457        AND (CP-R-MAX-ATT-AGE > +0)
 13458        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13459        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13460           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13461           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13462           MOVE '1'              TO DC-OPTION-CODE
 13463           PERFORM 8500-DATE-CONVERT
 13464                                 THRU 8500-EXIT
 13465           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 244
* EL050.cbl
 13466              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13467                 MOVE ER-2661       TO WS-ERROR
 13468*                PERFORM 9900-ERROR-FORMAT
 13469*                                THRU 9900-EXIT
 13470              END-IF
 13471           END-IF
 13472        ELSE
 13473           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13474           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13475              MOVE ER-2661       TO WS-ERROR
 13476*             PERFORM 9900-ERROR-FORMAT
 13477*                                THRU 9900-EXIT
 13478           ELSE
 13479              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13480                 MOVE ER-1570    TO WS-ERROR
 13481                 PERFORM 9900-ERROR-FORMAT
 13482                                 THRU 9900-EXIT
 13483              END-IF
 13484           END-IF
 13485        END-IF
 13486        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13487           MOVE PB-I-JOINT-BIRTHDAY
 13488                                 TO DC-BIN-DATE-1
 13489           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13490           MOVE '1'              TO DC-OPTION-CODE
 13491           PERFORM 8500-DATE-CONVERT
 13492                                 THRU 8500-EXIT
 13493           IF NO-CONVERSION-ERROR
 13494              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13495                 MOVE ER-2661       TO WS-ERROR
 13496*                PERFORM 9900-ERROR-FORMAT
 13497*                                THRU 9900-EXIT
 13498              END-IF
 13499           ELSE
 13500              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13501           END-IF
 13502        ELSE
 13503           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13504             (PB-I-LF-TERM / 12)
 13505           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13506              MOVE ER-2661       TO WS-ERROR
 13507*             PERFORM 9900-ERROR-FORMAT
 13508*                                THRU 9900-EXIT
 13509           ELSE
 13510              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13511                 MOVE ER-1571    TO WS-ERROR
 13512                 PERFORM 9900-ERROR-FORMAT
 13513                                 THRU 9900-EXIT
 13514              END-IF
 13515           END-IF
 13516        END-IF
 13517        IF WS-ERROR = ER-2661
 13518           PERFORM 9900-ERROR-FORMAT
 13519                                 THRU 9900-EXIT
 13520        END-IF
 13521     END-IF
 13522*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13523*       MOVE ER-2661             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 245
* EL050.cbl
 13524*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13525
 13526     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13527        MOVE ER-2662             TO WS-ERROR
 13528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13529
 13530     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13531        MOVE ER-2677             TO WS-ERROR
 13532        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13533
 13534     IF CP-ERROR-LOAN-TERM
 13535        MOVE ER-2648             TO WS-ERROR
 13536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13537
 13538 3221-CHECK-ERROR-RATE-OPEN.
 13539
 13540     IF CP-ERROR-RATE-FILE-NOTOPEN
 13541         GO TO 3990-FILES-NOT-OPEN.
 13542
 13543     IF PB-COMPANY-ID NOT = 'DMD'
 13544        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13545     END-IF
 13546     .
 13547 3221-CONTINUE.
 13548     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13549                                    WS-DCC-AH-RATE
 13550     IF PB-COMPANY-ID = 'DCC'
 13551        IF WS-LF-BEN-CATEGORY = 'D'
 13552           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13553              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13554        END-IF
 13555     END-IF
 13556     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13557*   X'A4FF' = 12/31/2009
 13558     IF (PB-COMPANY-ID = 'CID')
 13559        AND (WS-LF-EARNINGS-CALC = 'B')
 13560        AND (CP-STATE-STD-ABBRV = 'MN')
 13561        AND (PB-CERT-EFF-DT > X'A4FF')
 13562        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13563     END-IF
 13564     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13565
 13566     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13567     IF (PB-COMPANY-ID = 'DCC')
 13568        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13569        AND (PB-I-POLICY-IS-MONTHLY)
 13570        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13571        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13572     END-IF
 13573     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13574     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13575     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13576     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13577     IF (PB-COMPANY-ID = 'DCC')
 13578        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13579        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13580        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13581        MOVE ER-2786             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 246
* EL050.cbl
 13582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13583     END-IF
 13584
 13585     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13586
 13587******************************************************************
 13588*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13589******************************************************************
 13590     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13591        and ((not pb-monthly-cert)
 13592        or (ws-lf-ben-category = 'C'))
 13593        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13594
 13595     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13596        GO TO 3225-CHECK-ALT-LIFE-RATE
 13597     ELSE
 13598       IF PB-I-LF-RATE = ZERO
 13599          MOVE ER-2641          TO WS-ERROR
 13600          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13601
 13602 3225-CHECK-ALT-LIFE-RATE.
 13603
 13604     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13605        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13606        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13607         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13608
 13609     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13610         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13611             AND PB-COMPANY-ID NOT = 'DCC')
 13612                   OR
 13613              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13614              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13615              AND PB-COMPANY-ID NOT = 'DCC')
 13616             MOVE ER-2720        TO  WS-ERROR
 13617             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13618             GO TO 3225-RATING-CONT
 13619         ELSE
 13620             GO TO 3225-RATING-CONT.
 13621     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13622        AND (AM-GPCD = 01 OR 06 OR 15)
 13623        MOVE ER-2798             TO WS-ERROR
 13624        PERFORM 9900-ERROR-FORMAT
 13625                                 THRU 9900-EXIT
 13626*       GO TO 3225-RATING-CONT
 13627     END-IF
 13628     IF (PB-COMPANY-ID = 'CID')
 13629        AND (WS-LF-EARNINGS-CALC = 'B')
 13630        AND (CP-STATE-STD-ABBRV = 'MN')
 13631        AND (PB-CERT-EFF-DT > X'A4FF')
 13632        GO TO 3225-RATING-CONT
 13633     END-IF
 13634     IF PB-COMPANY-ID = 'DCC'
 13635        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13636           AND (PB-I-POLICY-IS-MONTHLY)
 13637           GO TO 3225-RATING-CONT
 13638        END-IF
 13639     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 247
* EL050.cbl
 13640
 13641     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13642        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13643        CP-EARN-AS-REG-BALLOON
 13644        NEXT SENTENCE
 13645     ELSE
 13646        MOVE '2'                 TO CP-EARNING-METHOD.
 13647
 13648 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13649
 13650     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13651
 13652     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13653        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13654        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13655         NEXT SENTENCE
 13656     ELSE
 13657         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13658
 13659     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13660     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13661     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13662                                     CP-RATING-BENEFIT-AMT.
 13663     IF CP-STATE-STD-ABBRV = 'OR'
 13664         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13665                                         PB-I-LF-ALT-BENEFIT-AMT.
 13666     IF PB-COMPANY-ID = 'DCC'
 13667        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13668     END-IF
 13669     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13670     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13671     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13672                                    CP-REMAINING-TERM
 13673                                    CP-LOAN-TERM.
 13674     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13675        ADD +1                   TO CP-ORIGINAL-TERM
 13676                                    CP-REMAINING-TERM
 13677                                    CP-LOAN-TERM.
 13678
 13679     MOVE 'R'                   TO CP-RATE-FILE.
 13680     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13681
 13682     IF CP-ERROR-RATE-NOT-FOUND
 13683         MOVE ER-2641            TO WS-ERROR
 13684         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13685         GO TO 3300-CHECK-AH-RATES.
 13686
 13687     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13688     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13689
 13690     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13691         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13692
 13693     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13694                               + PB-I-LF-ALT-BENEFIT-AMT.
 13695
 13696     IF ACCOUNT-LIFE-CHECKED  OR
 13697        PB-POLICY-IS-VOIDED   OR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 248
* EL050.cbl
 13698        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13699        and (not pb-monthly-cert))
 13700        GO TO 3225-CONTINUE.
 13701
 13702     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13703        GO TO 3225-CONTINUE.
 13704
 13705     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13706                             EC-RT-LF-MAX-TOT-BEN
 13707        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13708        MOVE ER-2639       TO WS-ERROR
 13709        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13710
 13711 3225-CONTINUE.
 13712     IF PB-I-LF-ALT-RATE = ZERO
 13713         MOVE ER-2659            TO WS-ERROR
 13714         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13715
 13716     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13717        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13718        MOVE ER-2698             TO WS-ERROR
 13719        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13720
 13721 3225-RATING-CONT.
 13722
 13723     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13724        and (not pb-monthly-cert)
 13725         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13726         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13727         IF (PB-COMPANY-ID = 'DCC')
 13728            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13729            CONTINUE
 13730         ELSE
 13731            MOVE ER-2687         TO WS-ERROR
 13732            PERFORM 9900-ERROR-FORMAT
 13733                                 THRU 9900-EXIT
 13734         END-IF
 13735         GO TO 3290-EDIT-LF-REIN-RATE
 13736     END-IF
 13737
 13738* DMD RATING TEST
 13739     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13740         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13741         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13742         MOVE ER-2687                 TO WS-ERROR
 13743         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13744         GO TO 3290-EDIT-LF-REIN-RATE.
 13745
 13746 3230-CLIENT-MORT-CD-SPECIALS.
 13747
 13748     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13749     SET BIN-TO-GREG          TO TRUE.
 13750*    MOVE ' '                 TO DC-OPTION-CODE.
 13751     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13752     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13753
 13754 C-POS-3230-MORT-CD.
 13755     IF PB-COMPANY-ID = 'POS' AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 249
* EL050.cbl
 13756        PB-SV-CARRIER = '2'
 13757         NEXT SENTENCE
 13758     ELSE
 13759         GO TO C-POS-3240-MORT-CD.
 13760
 13761     IF PB-SV-GROUPING = '030'
 13762        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13763         MOVE '2350' TO PB-I-MORT-CODE
 13764      ELSE
 13765         MOVE '3300' TO PB-I-MORT-CODE.
 13766
 13767
 13768 C-POS-3240-MORT-CD.
 13769     IF PB-COMPANY-ID = 'POS' AND
 13770        PB-SV-CARRIER = '1'
 13771         NEXT SENTENCE
 13772     ELSE
 13773         GO TO 3230-CONTINUE.
 13774
 13775     IF PB-SV-STATE = '45' OR '47'
 13776        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13777         MOVE '5200' TO PB-I-MORT-CODE
 13778     ELSE
 13779         MOVE '8300' TO PB-I-MORT-CODE.
 13780
 13781 3230-CONTINUE.
 13782
 13783     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13784        GO TO 3240-CONTINUE
 13785     END-IF
 13786
 13787     IF PB-CERT-EFF-DT > WS-971231
 13788        GO TO 3240-CONTINUE
 13789     END-IF
 13790
 13791     IF LF-BENEFIT-FOUND AND
 13792        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13793         MOVE 'F250'       TO PB-I-MORT-CODE
 13794     ELSE
 13795         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13796             MOVE '7250'   TO PB-I-MORT-CODE
 13797         ELSE
 13798             MOVE '4251'   TO PB-I-MORT-CODE
 13799         END-IF
 13800     END-IF
 13801
 13802     .
 13803 3240-CONTINUE.
 13804
 13805     IF PB-COMPANY-ID NOT = 'GNL'
 13806         GO TO 3256-CONTINUE.
 13807
 13808     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13809         MOVE 'A300' TO PB-I-MORT-CODE
 13810     ELSE
 13811         MOVE '8350' TO PB-I-MORT-CODE.
 13812
 13813 3256-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 250
* EL050.cbl
 13814     IF PB-COMPANY-ID NOT = 'ABL'
 13815         GO TO 3260-EDIT-CONTINUE.
 13816
 13817     IF PB-I-LF-TERM GREATER THAN 59
 13818         MOVE 'F550' TO PB-I-MORT-CODE
 13819     ELSE
 13820         MOVE 'E550' TO PB-I-MORT-CODE.
 13821
 13822 3260-EDIT-CONTINUE.
 13823     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13824
 13825 3290-EDIT-LF-REIN-RATE.
 13826     IF LF-REIN-NSP-NOT-USED
 13827         GO TO 3290-RATING-CONT.
 13828
 13829     IF PB-COMPANY-ID = 'DCC'
 13830        GO TO 3290-RATING-CONT.
 13831     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13832     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13833     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13834     MOVE '3'                   TO CP-PROCESS-TYPE.
 13835     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13836
 13837******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13838     IF PB-COMPANY-ID EQUAL 'CDL'
 13839         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13840            CP-EARN-AS-NET-PAY)
 13841             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13842*            MOVE SPACE          TO DC-OPTION-CODE
 13843             SET BIN-TO-GREG     TO TRUE
 13844             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13845***  Y2K PROJ 7744
 13846             IF DC-GREG-DATE-CYMD GREATER 19931231
 13847                 MOVE '1'        TO CP-EARNING-METHOD.
 13848***  Y2K PROJ 7744
 13849*******
 13850
 13851     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13852     MOVE PB-SV-STATE           TO CP-STATE.
 13853     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13854     MOVE ZERO                  TO CP-DEVIATION-CODE
 13855                                   CP-RATE-DEV-PCT.
 13856     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13857     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13858                                   CP-RATING-BENEFIT-AMT.
 13859
 13860************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13861     IF PB-COMPANY-ID EQUAL 'NCB'
 13862         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13863            CP-EARN-AS-NET-PAY
 13864             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13865                 PB-I-LF-PREMIUM-AMT.
 13866************
 13867
 13868     IF CP-STATE-STD-ABBRV = 'OR'
 13869         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13870                                         PB-I-LF-ALT-BENEFIT-AMT.
 13871     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 251
* EL050.cbl
 13872     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13873     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13874     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13875     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13876     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13877     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13878     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13879                                   CP-REMAINING-TERM
 13880                                   CP-LOAN-TERM.
 13881     IF CP-TRUNCATED-LIFE
 13882        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13883
 13884     IF CP-TERM-IS-DAYS
 13885         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13886     ELSE
 13887         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13888
 13889     IF PB-COMPANY-ID = 'DCC'
 13890        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13891     END-IF
 13892     IF PB-COMPANY-ID NOT = 'TIC'
 13893          MOVE ZERO          TO CP-CLASS-CODE.
 13894
 13895     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13896
 13897     MOVE 'R'                   TO CP-RATE-FILE.
 13898     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13899
 13900     IF CP-ERROR-RATE-NOT-FOUND
 13901        IF PB-I-OB
 13902           MOVE ER-2625      TO WS-ERROR
 13903           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13904           GO TO 3299-EDIT-CONTINUE
 13905        ELSE
 13906           MOVE ER-2643      TO WS-ERROR
 13907           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13908           GO TO 3299-EDIT-CONTINUE.
 13909
 13910     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13911
 13912     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13913     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13914
 13915     IF PB-I-LF-REI-RATE = ZERO
 13916         MOVE ER-2643        TO WS-ERROR
 13917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13918
 13919 3290-CHECK-ALT-REIN-RATE.
 13920
 13921     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13922        GO TO 3290-RATING-CONT.
 13923
 13924     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13925     MOVE '2'                    TO CP-EARNING-METHOD.
 13926     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13927     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13928     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13929     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 252
* EL050.cbl
 13930                                     CP-RATING-BENEFIT-AMT.
 13931     IF CP-STATE-STD-ABBRV = 'OR'
 13932         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13933                                         PB-I-LF-ALT-BENEFIT-AMT.
 13934     IF PB-COMPANY-ID = 'DCC'
 13935        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13936     END-IF
 13937     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13938     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13939     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13940                                    CP-REMAINING-TERM
 13941                                    CP-LOAN-TERM.
 13942     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13943        ADD +1                   TO CP-ORIGINAL-TERM
 13944                                    CP-REMAINING-TERM
 13945                                    CP-LOAN-TERM.
 13946
 13947     MOVE 'R'                   TO CP-RATE-FILE.
 13948     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13949
 13950     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13951
 13952     IF PB-I-LF-ALT-REI-RATE = ZERO
 13953         MOVE ER-2643            TO WS-ERROR
 13954         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13955
 13956 3290-RATING-CONT.
 13957
 13958     IF PB-I-OB
 13959*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13960        GO TO 3300-CHECK-AH-RATES.
 13961
 13962 3299-EDIT-CONTINUE.
 13963
 13964     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13965         NEXT SENTENCE
 13966     ELSE
 13967         MOVE ER-2620           TO WS-ERROR
 13968         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13969
 13970 3300-CHECK-AH-RATES.
 13971     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13972         NEXT SENTENCE
 13973     ELSE
 13974         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13975
 13976     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 13977        and (not pb-monthly-cert))
 13978                  or
 13979        ((CF-COMPANY-ID = 'DMD') AND
 13980                (NO-DMD-RATING))
 13981         IF (PB-COMPANY-ID = 'DCC')
 13982            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13983            CONTINUE
 13984         ELSE
 13985            MOVE ER-2687         TO WS-ERROR
 13986            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13987         END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 253
* EL050.cbl
 13988         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13989         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13990     END-IF
 13991
 13992     IF PB-I-OB
 13993        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13994
 13995     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13996         MOVE ER-2687             TO WS-ERROR
 13997         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13998         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13999         GO TO 3999-END-EDIT.
 14000
 14001*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14002     if pb-company-id = 'AHL'
 14003        go to 3300-skip-crit-per
 14004     end-if
 14005     if (pb-i-ah-crit-per not = zeros)
 14006        and (ws-ah-special-calc-cd not = 'C')
 14007        MOVE ER-1572             TO WS-ERROR
 14008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14009        go to 3300-skip-crit-per
 14010     END-IF
 14011     if (pb-company-id = 'DCC')
 14012        and (am-dcc-product-code not = spaces)
 14013        go to 3300-skip-crit-per
 14014     end-if
 14015     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14016        IF PB-I-AH-CRIT-PER = ZERO
 14017           move ws-ah-max-bens   to pb-i-ah-crit-per
 14018*          MOVE ER-2618       TO WS-ERROR
 14019*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14020*          GO TO 3999-END-EDIT
 14021        END-IF
 14022     END-IF
 14023     if (ws-ah-special-calc-cd = 'C')
 14024        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14025        MOVE ER-1576             TO WS-ERROR
 14026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14027     end-if
 14028
 14029     .
 14030 3300-skip-crit-per.
 14031     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14032     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14033     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14034     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14035     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14036     MOVE PB-SV-STATE            TO CP-STATE.
 14037     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14038     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14039     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14040*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14041     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14042     MOVE '3'                    TO CP-PROCESS-TYPE.
 14043     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14044     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14045                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 254
* EL050.cbl
 14046     IF PB-COMPANY-ID = 'CID'
 14047               OR
 14048        CP-STATE-STD-ABBRV = 'OR'
 14049         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14050                                         PB-I-AH-TERM.
 14051     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14052        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14053           AND (PB-I-POLICY-IS-MONTHLY)
 14054           MOVE PB-I-LF-BENEFIT-AMT
 14055                                 TO CP-NET-BENEFIT-AMT
 14056           move pb-i-ah-premium-amt to cp-original-premium
 14057           add pb-i-lf-premium-amt to cp-original-premium
 14058        END-IF
 14059     END-IF
 14060     MOVE SPACES                 TO CP-BEN-CATEGORY
 14061     IF PB-COMPANY-ID = 'DCC'
 14062        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14063        EVALUATE TRUE
 14064           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14065              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14066              MOVE PB-I-LF-BENEFIT-AMT
 14067                                 TO CP-RATING-BENEFIT-AMT
 14068              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14069           WHEN WS-AH-BEN-CATEGORY = 'G'
 14070              MOVE PB-I-UNPAID-CASH-PRICE
 14071                                 TO CP-RATING-BENEFIT-AMT
 14072           WHEN WS-AH-BEN-CATEGORY = 'D'
 14073              MOVE WS-AH-PMF-COMM
 14074                                 TO CP-DCC-PMF-COMM
 14075              MOVE PB-I-AH-COMMISSION
 14076                                 TO CP-DCC-ACT-COMM
 14077        END-EVALUATE
 14078     END-IF
 14079     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14080     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14081     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14082     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14083     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14084     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14085     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14086                                    CP-REMAINING-TERM
 14087                                    WS-WORK-TERM.
 14088     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14089
 14090     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14091     SET BIN-TO-GREG             TO TRUE.
 14092*    MOVE ' '                    TO DC-OPTION-CODE.
 14093     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14094     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14095
 14096     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14097     IF NOT VALID-SKIP-CODE
 14098         MOVE ER-2683            TO WS-ERROR
 14099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14100         GO TO 3320-RATE-CONTINUE.
 14101
 14102     IF PB-NO-MONTHS-SKIPPED
 14103         GO TO 3320-RATE-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 255
* EL050.cbl
 14104
 14105     MOVE SPACE TO NUMBER-OF-MONTHS.
 14106
 14107     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14108         MOVE 'S'                TO SK-MO (6).
 14109     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14110         MOVE 'S'                TO SK-MO (7).
 14111     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14112         MOVE 'S'                TO SK-MO (8).
 14113     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14114         MOVE 'S'                TO SK-MO (9).
 14115     IF PB-I-SKIP-CODE = 'A'
 14116         MOVE 'S'                TO SK-MO (10).
 14117
 14118     MOVE 1                      TO SUB2.
 14119     MOVE PB-I-AH-TERM           TO SUB3.
 14120     MOVE WS-MONTH               TO SUB1.
 14121     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14122     GO TO 3320-RATE-CONTINUE.
 14123
 14124 3310-GET-SKIP-MO.
 14125     IF SUB1 = 13
 14126         MOVE 1                  TO SUB1.
 14127
 14128     IF SK-MO (SUB1) = 'S'
 14129         SUBTRACT 1 FROM WS-WORK-TERM.
 14130
 14131     ADD 1 TO SUB2
 14132              SUB1.
 14133
 14134 3320-RATE-CONTINUE.
 14135
 14136     IF WS-WORK-TERM = ZERO
 14137         MOVE 1                  TO WS-WORK-TERM.
 14138
 14139     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14140                                    CP-LOAN-TERM.
 14141
 14142     IF PB-COMPANY-ID EQUAL 'DMD'
 14143         NEXT SENTENCE
 14144     ELSE
 14145         MOVE ZERO               TO PB-I-AH-RATE
 14146                                    PB-I-AH-REI-RATE.
 14147
 14148
 14149     IF PB-COMPANY-ID EQUAL 'CRI'
 14150        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14151
 14152     IF PB-COMPANY-ID = 'CSL'
 14153         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14154         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14155         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14156         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14157
 14158     IF PB-COMPANY-ID = 'DCC'
 14159        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14160           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14161              PB-I-RATE-DEV-PCT-LF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 256
* EL050.cbl
 14162        END-IF
 14163        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14164                                 TO CP-ALTERNATE-BENEFIT
 14165        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14166        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14167        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14168     END-IF
 14169     IF (PB-COMPANY-ID = 'CID')
 14170        AND (WS-LF-EARNINGS-CALC = 'B')
 14171        AND (CP-STATE-STD-ABBRV = 'MN')
 14172        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14173     ELSE
 14174        MOVE ' '                 TO CP-AH-BALLOON-SW
 14175     END-IF
 14176     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14177     MOVE 'R'                   TO CP-RATE-FILE.
 14178     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14179
 14180     IF (CP-ERROR-RATE-NOT-FOUND)
 14181        and (not pb-monthly-cert)
 14182        IF PB-I-OB
 14183           MOVE ER-2624          TO WS-ERROR
 14184           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14185           GO TO 3340-CALCULATE-PREMIUM-AMT
 14186        ELSE
 14187          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14188              NEXT SENTENCE
 14189          ELSE
 14190           MOVE ER-2642          TO WS-ERROR
 14191           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14192           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14193
 14194     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14195        CP-ERROR-DIV-BY-ZERO
 14196           MOVE ER-3782          TO WS-ERROR
 14197           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14198
 14199     IF PB-COMPANY-ID EQUAL 'CRI'
 14200        IF CP-ERROR-NO-LIMITS-CRI
 14201           IF NOT ACCOUNT-AH-CHECKED
 14202              MOVE ER-2607          TO WS-ERROR
 14203              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14204
 14205     IF ACCOUNT-AH-CHECKED
 14206        NEXT SENTENCE
 14207     ELSE
 14208       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14209          MOVE ER-2640           TO WS-ERROR
 14210          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14211
 14212     IF PB-COMPANY-ID = 'CRI'
 14213         IF WS-ERROR = ER-2640
 14214             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14215     IF ACCOUNT-AH-CHECKED
 14216        CONTINUE
 14217     ELSE
 14218        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14219           AND (CP-R-MAX-ATT-AGE > +0)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 257
* EL050.cbl
 14220           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14221           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14222              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14223              MOVE PB-I-AH-EXPIRE-DT
 14224                                 TO DC-BIN-DATE-2
 14225              MOVE '1'           TO DC-OPTION-CODE
 14226              PERFORM 8500-DATE-CONVERT
 14227                                 THRU 8500-EXIT
 14228              IF NO-CONVERSION-ERROR
 14229                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14230                    MOVE ER-2661       TO WS-ERROR
 14231*                   PERFORM 9900-ERROR-FORMAT
 14232*                                THRU 9900-EXIT
 14233                 END-IF
 14234              END-IF
 14235           ELSE
 14236              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14237              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14238                 MOVE ER-2661    TO WS-ERROR
 14239*                PERFORM 9900-ERROR-FORMAT
 14240*                                THRU 9900-EXIT
 14241              ELSE
 14242                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14243                    MOVE ER-1570 TO WS-ERROR
 14244                    PERFORM 9900-ERROR-FORMAT
 14245                                 THRU 9900-EXIT
 14246                 END-IF
 14247              END-IF
 14248           END-IF
 14249           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14250              MOVE PB-I-JOINT-BIRTHDAY
 14251                                    TO DC-BIN-DATE-1
 14252              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14253              MOVE '1'              TO DC-OPTION-CODE
 14254              PERFORM 8500-DATE-CONVERT
 14255                                    THRU 8500-EXIT
 14256              IF NO-CONVERSION-ERROR
 14257                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14258                    MOVE ER-2661       TO WS-ERROR
 14259*                   PERFORM 9900-ERROR-FORMAT
 14260*                                   THRU 9900-EXIT
 14261                 END-IF
 14262              END-IF
 14263           ELSE
 14264              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14265                (PB-I-AH-TERM / 12)
 14266              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14267                 MOVE ER-2661       TO WS-ERROR
 14268*                PERFORM 9900-ERROR-FORMAT
 14269*                                   THRU 9900-EXIT
 14270              ELSE
 14271                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14272                    MOVE ER-1571 TO WS-ERROR
 14273                    PERFORM 9900-ERROR-FORMAT
 14274                                 THRU 9900-EXIT
 14275                 END-IF
 14276              END-IF
 14277           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 258
* EL050.cbl
 14278           IF WS-ERROR = ER-2661
 14279              PERFORM 9900-ERROR-FORMAT
 14280                                    THRU 9900-EXIT
 14281           END-IF
 14282        END-IF
 14283     END-IF
 14284*    IF ACCOUNT-AH-CHECKED
 14285*       NEXT SENTENCE
 14286*    ELSE
 14287*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14288*          MOVE ER-2661          TO WS-ERROR
 14289*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14290
 14291     IF ACCOUNT-AH-CHECKED
 14292        NEXT SENTENCE
 14293     ELSE
 14294        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14295           MOVE ER-2663          TO WS-ERROR
 14296           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14297
 14298     IF ACCOUNT-AH-CHECKED OR
 14299        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14300         PB-POLICY-IS-VOIDED
 14301        NEXT SENTENCE
 14302     ELSE
 14303        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14304           MOVE ER-2667            TO WS-ERROR
 14305           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14306
 14307     IF PB-COMPANY-ID = 'CRI'
 14308         IF WS-ERROR = ER-2667
 14309             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14310
 14311     IF ACCOUNT-AH-CHECKED
 14312        NEXT SENTENCE
 14313     ELSE
 14314        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14315           MOVE ER-2678            TO WS-ERROR
 14316           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14317
 14318     IF CP-ERROR-RATE-FILE-NOTOPEN
 14319         GO TO 3990-FILES-NOT-OPEN.
 14320
 14321 3321-CONTINUE.
 14322     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14323     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14324     IF (PB-COMPANY-ID = 'DCC')
 14325        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14326        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14327                                    PB-I-LF-ALT-PREM-CALC
 14328        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14329        IF WS-AH-BEN-CATEGORY = 'G'
 14330           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14331           + PB-I-ADDL-CLP)
 14332           * (1 + WS-TOL-CLP-PCT)
 14333*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14334        ELSE
 14335           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 259
* EL050.cbl
 14336           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14337*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14338        END-IF
 14339        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14340                                 TO PB-I-AH-PREM-CALC
 14341        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14342           MOVE ER-8152          TO WS-ERROR
 14343           PERFORM 9900-ERROR-FORMAT
 14344                                 THRU 9900-EXIT
 14345        ELSE
 14346           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14347                 PB-I-ADDL-CLP)
 14348              MOVE ER-8148       TO WS-ERROR
 14349              PERFORM 9900-ERROR-FORMAT
 14350                                 THRU 9900-EXIT
 14351           END-IF
 14352        END-IF
 14353     END-IF
 14354     IF (PB-COMPANY-ID = 'DCC')
 14355        AND (PB-I-POLICY-IS-MONTHLY)
 14356        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14357        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14358        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14359           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14360        END-IF
 14361     END-IF
 14362     IF (PB-COMPANY-ID = 'DCC')
 14363        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14364        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14365        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14366        MOVE ER-2786             TO WS-ERROR
 14367        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14368     END-IF
 14369     MOVE +0                     TO PB-I-AH-CLP
 14370     IF PB-COMPANY-ID = 'DCC'
 14371        evaluate true
 14372           when WS-AH-BEN-CATEGORY = 'D'
 14373              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14374                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14375           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14376              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14377           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14378              COMPUTE PB-I-AH-CLP ROUNDED =
 14379                 PB-I-AH-PREMIUM-AMT * (1 - pb-i-ah-commission)
 14380                    - ws-cred-union-fees
 14381        end-evaluate
 14382     END-IF
 14383     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14384
 14385     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14386         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14387
 14388     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14389         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14390
 14391     if (ws-ah-special-calc-cd = 'E')
 14392        and (pb-monthly-cert)
 14393        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 260
* EL050.cbl
 14394     end-if
 14395     IF PB-COMPANY-ID = 'CRI'
 14396         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14397            PB-I-PAYMENT-AMOUNT = ZERO
 14398             NEXT SENTENCE
 14399         ELSE
 14400             COMPUTE PB-I-AH-PREM-CALC =
 14401                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14402                 (CP-PREMIUM-RATE / 100)
 14403             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14404                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14405                                             PB-I-RATE-DEV-PCT-AH.
 14406
 14407     IF (PB-I-AH-RATE  = ZERO)
 14408        and (not pb-monthly-cert)
 14409       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14410           NEXT SENTENCE
 14411       ELSE
 14412         MOVE ER-2642            TO WS-ERROR
 14413         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14414
 14415     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14416     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14417     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14418     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14419     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14420     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14421
 14422     IF (PB-COMPANY-ID = 'DCC')
 14423        AND (WS-AH-BEN-CATEGORY = 'G')
 14424        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14425        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14426        IF CP-DEVIATION-CODE NOT = '000'
 14427           MOVE '000'            TO CP-DEVIATION-CODE
 14428           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14429           IF NO-CP-ERROR
 14430              COMPUTE PB-I-DDF-IU-RATE-UP =
 14431              PB-I-AH-CLP - CP-CALC-PREMIUM
 14432           ELSE
 14433              MOVE ER-3057        TO WS-ERROR
 14434              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14435           END-IF
 14436        END-IF
 14437     END-IF
 14438     .
 14439 3335-EDIT-AH-REIN-NSP-RATE.
 14440     IF PB-COMPANY-ID = 'DCC'
 14441        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14442              COMPUTE PB-I-AH-CLP ROUNDED =
 14443                 PB-I-AH-PREMIUM-AMT * (1 - pb-i-ah-commission)
 14444                    - ws-cred-union-fees
 14445        end-if
 14446     END-IF
 14447     IF AH-REIN-NSP-NOT-USED
 14448         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14449
 14450     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14451     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 261
* EL050.cbl
 14452         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14453     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14454     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14455     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14456     MOVE PB-SV-STATE            TO CP-STATE.
 14457     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14458     MOVE ZERO                   TO CP-DEVIATION-CODE
 14459                                    CP-RATE-DEV-PCT.
 14460*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14461     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14462     MOVE '3'                    TO CP-PROCESS-TYPE.
 14463     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14464     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14465                                    CP-RATING-BENEFIT-AMT.
 14466     IF CP-STATE-STD-ABBRV = 'OR'
 14467         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14468                                         PB-I-AH-TERM.
 14469     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14470     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14471     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14472     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14473     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14474     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14475                                    CP-REMAINING-TERM
 14476                                    WS-WORK-TERM.
 14477     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14478     IF PB-COMPANY-ID = 'DCC'
 14479        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14480     END-IF
 14481     IF  PB-COMPANY-ID = 'TIC'
 14482         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14483            MOVE ZERO TO CP-CLASS-CODE.
 14484
 14485     IF PB-COMPANY-ID NOT = 'TIC'
 14486          MOVE ZERO          TO CP-CLASS-CODE.
 14487
 14488     MOVE ZERO               TO CP-DEVIATION-CODE.
 14489
 14490     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14491
 14492     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14493
 14494     MOVE 'R'                   TO CP-RATE-FILE.
 14495     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14496
 14497     IF CP-ERROR-RATE-NOT-FOUND
 14498         MOVE ER-2645        TO WS-ERROR
 14499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14500         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14501
 14502     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14503
 14504     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14505     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14506
 14507     IF PB-I-AH-REI-RATE = ZERO
 14508         MOVE ER-2645        TO WS-ERROR
 14509         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 262
* EL050.cbl
 14510
 14511
 14512 3340-CALCULATE-PREMIUM-AMT.
 14513
 14514     IF PB-COMPANY-ID = 'NCL'
 14515         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14516             WS-AH-SPECIAL-CALC-CD = 'O')
 14517             GO TO 3999-END-EDIT.
 14518
 14519     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14520                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14521                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14522                         OR 'AHL'
 14523         NEXT SENTENCE
 14524     ELSE
 14525         IF WS-STATE-ABBREVIATION = 'CT'
 14526             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14527                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14528                 COMPUTE PB-I-LF-PREM-CALC =
 14529                                     PB-I-LF-PREM-CALC * .90
 14530                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14531                                     PB-I-LF-ALT-PREM-CALC * .90
 14532                 COMPUTE PB-I-AH-PREM-CALC =
 14533                                     PB-I-AH-PREM-CALC * .90.
 14534
 14535     IF PB-COMP-LF-PREM
 14536        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14537        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14538
 14539     IF PB-COMP-AH-PREM
 14540        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14541
 14542 3340-CHECK-DCC-TOT-FEES.
 14543     IF (PB-COMPANY-ID = 'DCC')
 14544        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14545        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14546        AND (PB-I-POLICY-IS-MONTHLY)
 14547        CONTINUE
 14548     ELSE
 14549        GO TO 3340-EDIT-LF-AH-TOL
 14550     END-IF
 14551     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14552     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14553     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14554        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14555           PB-I-RATE-DEV-PCT-LF
 14556     END-IF
 14557     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14558        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14559           PB-I-RATE-DEV-PCT-AH
 14560     END-IF
 14561     MOVE 'N'                    TO CP-BEN-CATEGORY
 14562     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14563
 14564     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14565     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14566     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14567     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 263
* EL050.cbl
 14568     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14569     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14570     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14571     MOVE '3'                    TO CP-PROCESS-TYPE.
 14572     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14573     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14574
 14575     MOVE PB-SV-STATE            TO CP-STATE.
 14576     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14577     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14578     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14579     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14580     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14581                                    CP-RATING-BENEFIT-AMT.
 14582     IF CP-STATE-STD-ABBRV = 'OR'
 14583         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14584                                         PB-I-LF-ALT-BENEFIT-AMT.
 14585     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14586     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14587     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14588     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14589     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14590     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14591     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14592     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14593     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14594                                    CP-REMAINING-TERM
 14595                                    CP-LOAN-TERM.
 14596     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14597        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14598           PB-I-LF-PREMIUM-AMT
 14599     end-if
 14600
 14601     IF CP-TRUNCATED-LIFE
 14602        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14603
 14604     IF CP-TERM-IS-DAYS
 14605         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14606     ELSE
 14607         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14608
 14609     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14610     IF CP-SPECIAL-CALC-CD = 'H'
 14611         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14612                                    TO CP-ALTERNATE-BENEFIT
 14613         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14614     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14615     MOVE 'R'                    TO CP-RATE-FILE
 14616     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14617     IF NOT CP-ERROR-RATE-NOT-FOUND
 14618        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14619        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14620           AND (CP-BENEFIT-CD (1:1) = 'S')
 14621           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14622                                    PB-I-LF-PREMIUM-AMT
 14623        END-IF
 14624     ELSE
 14625        MOVE +0                  TO PB-I-TOT-FEES-CALC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 264
* EL050.cbl
 14626     END-IF
 14627     .
 14628 3340-EDIT-LF-AH-TOL.
 14629
 14630***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14631***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14632***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14633***
 14634     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14635         PB-I-AH-PREMIUM-AMT
 14636          GIVING WS-CALC-WORK.
 14637
 14638     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14639        AND WS-CALC-WORK NOT = ZERO
 14640         MOVE ER-2649            TO WS-ERROR
 14641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14642
 14643     SUBTRACT PB-I-LF-PREM-CALC
 14644             FROM PB-I-LF-PREMIUM-AMT
 14645                 GIVING WS-UNSIGN-WRK1.
 14646
 14647     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14648             FROM PB-I-LF-ALT-PREMIUM-AMT
 14649                 GIVING WS-UNSIGN-WRK4.
 14650
 14651     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14652                                + WS-UNSIGN-WRK4.
 14653
 14654     SUBTRACT PB-I-AH-PREM-CALC
 14655             FROM PB-I-AH-PREMIUM-AMT
 14656                 GIVING WS-UNSIGN-WRK2.
 14657
 14658******************************************************************
 14659*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14660******************************************************************
 14661
 14662     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14663         MOVE ZERO TO WS-UNSIGN-WRK1.
 14664
 14665     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14666         MOVE ZERO TO WS-UNSIGN-WRK2.
 14667
 14668     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14669             GIVING WS-UNSIGN-WRK3.
 14670
 14671 3342-CONTINUE.
 14672
 14673     IF (PB-I-LF-RATE = ZERO  AND
 14674         PB-I-AH-RATE = ZERO)
 14675         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14676            WS-AH-SPECIAL-CALC-CD = 'O'
 14677              NEXT SENTENCE
 14678         ELSE
 14679             GO TO 3345-EDIT-CONTINUE.
 14680
 14681     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14682         NEXT SENTENCE
 14683     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 265
* EL050.cbl
 14684     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14685        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14686           IF (PB-REISSUED-CERT         OR
 14687               PB-POLICY-IS-DECLINED    OR
 14688               PB-POLICY-IS-VOIDED)
 14689              NEXT SENTENCE
 14690           ELSE
 14691              IF WS-PREM-REJECT-SW = SPACE
 14692                 MOVE ER-2652    TO WS-ERROR
 14693                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14694                 GO TO 3344-CHECK-AH
 14695              ELSE
 14696                 MOVE ER-2650    TO WS-ERROR
 14697                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14698                 GO TO 3344-CHECK-AH.
 14699
 14700***
 14701***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14702***
 14703
 14704     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14705         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14706            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14707             (1 + WS-TOL-LF-PREM-PCT)
 14708         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14709            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14710             (1 - WS-TOL-LF-PREM-PCT)
 14711     ELSE
 14712         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14713         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14714
 14715***
 14716***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14717***
 14718
 14719     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14720         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14721          WS-TOL-LF-PREM.
 14722
 14723     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14724         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14725          WS-TOL-LF-PREM.
 14726
 14727     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14728        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14729
 14730     IF PB-REISSUED-CERT
 14731        or PB-POLICY-IS-DECLINED
 14732        or PB-POLICY-IS-VOIDED
 14733        continue
 14734     ELSE
 14735        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14736              > WS-TOL-LF-HIGH-PREM-AMT)
 14737           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14738              < WS-TOL-LF-LOW-PREM-AMT))
 14739                      or
 14740           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14741              > WS-TOL-LF-HIGH-PREM-PCT)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 266
* EL050.cbl
 14742           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14743              < WS-TOL-LF-LOW-PREM-PCT))
 14744           IF WS-PREM-REJECT-SW = SPACE
 14745              MOVE ER-2652       TO WS-ERROR
 14746              PERFORM 9900-ERROR-FORMAT
 14747                                 THRU 9900-EXIT
 14748           ELSE
 14749              MOVE ER-2650       TO WS-ERROR
 14750              PERFORM 9900-ERROR-FORMAT
 14751                                 THRU 9900-EXIT
 14752           end-if
 14753        end-if
 14754     end-if
 14755
 14756*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14757*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14758*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14759*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14760
 14761     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14762        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14763                      OR
 14764           ((PB-COMPANY-ID = 'DCC')
 14765           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14766           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14767           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14768        END-IF
 14769     END-IF
 14770
 14771     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14772        IF WS-COMP-MAX-CAP GREATER THAN +0
 14773           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14774              IF (PB-REISSUED-CERT         OR
 14775                  PB-POLICY-IS-DECLINED    OR
 14776                  PB-POLICY-IS-VOIDED)
 14777                 NEXT SENTENCE
 14778              ELSE
 14779                  MOVE ER-2646   TO  WS-ERROR
 14780                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14781
 14782 3344-CVL-TOLERANCE-CHECK.
 14783
 14784      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14785          GO TO 3344-CHECK-AH.
 14786
 14787      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14788          GO TO 3344-CHECK-AH.
 14789
 14790      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14791                                     WS-UNSIGN-WRK6.
 14792
 14793      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14794          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14795                                 + PB-I-LF-PREMIUM-AMT
 14796                                 - PB-I-LF-PREM-CALC.
 14797
 14798      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14799          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 267
* EL050.cbl
 14800                                 + PB-I-LF-ALT-PREMIUM-AMT
 14801                                 - PB-I-LF-ALT-PREM-CALC.
 14802
 14803      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14804          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14805              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14806                 MOVE ER-2652    TO  WS-ERROR
 14807                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14808              ELSE
 14809                 MOVE ER-2650    TO  WS-ERROR
 14810                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14811
 14812      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14813          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14814              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14815                 MOVE ER-2652    TO  WS-ERROR
 14816                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14817              ELSE
 14818                 MOVE ER-2650    TO  WS-ERROR
 14819                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14820
 14821 3344-CHECK-AH.
 14822
 14823****************************************************************
 14824***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14825***
 14826
 14827     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14828         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14829             (1 + WS-TOL-AH-PREM-PCT)
 14830         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14831             (1 - WS-TOL-AH-PREM-PCT)
 14832     ELSE
 14833         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14834         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14835
 14836***
 14837***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14838***
 14839
 14840     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14841         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14842
 14843     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14844         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14845
 14846     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14847        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14848
 14849     IF (PB-REISSUED-CERT)
 14850        OR (PB-POLICY-IS-DECLINED)
 14851        OR (PB-POLICY-IS-VOIDED)
 14852        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14853        CONTINUE
 14854     ELSE
 14855        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14856              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14857                          or
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 268
* EL050.cbl
 14858           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14859              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14860           IF WS-PREM-REJECT-SW = SPACE
 14861              MOVE ER-3052       TO WS-ERROR
 14862              PERFORM 9900-ERROR-FORMAT
 14863                                 THRU 9900-EXIT
 14864           ELSE
 14865              MOVE ER-3050       TO WS-ERROR
 14866              PERFORM 9900-ERROR-FORMAT
 14867                                 THRU 9900-EXIT
 14868           END-IF
 14869        END-IF
 14870     END-IF
 14871     if (pb-company-id = 'DCC')
 14872        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14873        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14874        and (pb-i-policy-is-monthly)
 14875        compute ws-tol-ah-high-prem-amt =
 14876           pb-i-tot-fees-calc + ws-tol-ah-prem
 14877        compute ws-tol-ah-low-prem-amt =
 14878           pb-i-tot-fees-calc - ws-tol-ah-prem
 14879        if ws-tol-ah-prem-pct > zeros
 14880           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14881              (1 + ws-tol-ah-prem-pct)
 14882           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14883              (1 - ws-tol-ah-prem-pct)
 14884        else
 14885           move +9999999.99      to ws-tol-ah-high-prem-pct
 14886           move +0               to ws-tol-ah-low-prem-pct
 14887        end-if
 14888        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14889            or
 14890           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14891                          or
 14892           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14893           or
 14894           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14895            move er-3049         to ws-error
 14896           perform 9900-error-format
 14897                                 thru 9900-exit
 14898
 14899        end-if
 14900     end-if
 14901     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14902         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14903             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14904             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14905
 14906     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14907        IF WS-COMP-MAX-CAP GREATER THAN +0
 14908           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14909              IF (PB-REISSUED-CERT         OR
 14910                  PB-POLICY-IS-DECLINED    OR
 14911                  PB-POLICY-IS-VOIDED)
 14912                 NEXT SENTENCE
 14913              ELSE
 14914                  MOVE ER-2646   TO  WS-ERROR
 14915                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 269
* EL050.cbl
 14916
 14917     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14918        (WS-COMP-MAX-CAP EQUAL +0)
 14919           GO TO 3345-EDIT-CONTINUE.
 14920
 14921     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14922        GREATER THAN WS-COMP-MAX-CAP
 14923           MOVE ER-2646          TO  WS-ERROR
 14924           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14925
 14926 3345-EDIT-CONTINUE.
 14927
 14928*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14929*       IF PB-ENTRY-BATCH   NUMERIC
 14930*          IF PB-ISSUE
 14931*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14932*          ELSE
 14933*              IF PB-CANCELLATION
 14934*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14935
 14936*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14937*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14938*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14939*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14940*        ELSE
 14941*            MOVE  ER-1909            TO  WS-ERROR
 14942*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14943
 14944     IF PB-I-POLICY-ACCEPTED
 14945        IF PB-POLICY-IS-DECLINED  OR
 14946           PB-REISSUED-CERT  OR
 14947           PB-REIN-ONLY-CERT  OR
 14948           PB-POLICY-IS-VOIDED
 14949            MOVE  ER-1891         TO  WS-ERROR
 14950            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14951        ELSE
 14952            MOVE SPACE            TO  PB-BATCH-ENTRY
 14953            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14954
 14955     IF PB-I-POLICY-DECLINED
 14956        IF PB-REISSUED-CERT  OR
 14957           PB-REIN-ONLY-CERT  OR
 14958           PB-POLICY-IS-VOIDED
 14959            MOVE  ER-1906         TO  WS-ERROR
 14960            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14961        ELSE
 14962            MOVE  'D'             TO  PB-BATCH-ENTRY
 14963                                      PB-I-ENTRY-STATUS.
 14964
 14965     IF PB-I-NEEDS-UNDERWRITING
 14966        IF PB-POLICY-IS-DECLINED OR
 14967           PB-REISSUED-CERT  OR
 14968           PB-REIN-ONLY-CERT  OR
 14969           PB-POLICY-IS-VOIDED
 14970            MOVE  ER-1907         TO  WS-ERROR
 14971            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14972        ELSE
 14973            MOVE 'U'              TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 270
* EL050.cbl
 14974                                      PB-I-ENTRY-STATUS.
 14975
 14976     IF PB-NEEDS-UNDERWRITING
 14977        MOVE  ER-1901             TO  WS-ERROR
 14978        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14979     IF PB-COMPANY-ID = 'DCC'
 14980        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14981        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14982        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14983           AND (NOT WS-LF-CASH))
 14984                           OR
 14985           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14986           AND (NOT WS-AH-CASH)))
 14987                       AND
 14988           (PB-I-ENTRY-STATUS NOT = '5')
 14989           MOVE 'M'              TO PB-BATCH-ENTRY
 14990                                    PB-I-ENTRY-STATUS
 14991        END-IF
 14992     END-IF
 14993     IF  PB-COMPANY-ID NOT = 'NCL'
 14994         GO TO 3999-END-EDIT.
 14995
 14996     IF PB-REISSUED-CERT  OR
 14997        PB-POLICY-IS-DECLINED  OR
 14998        PB-POLICY-IS-VOIDED  OR
 14999        PB-I-OB
 15000         GO TO 3999-END-EDIT.
 15001
 15002     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15003         MOVE  ER-2644            TO  WS-ERROR
 15004         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15005         GO TO 3999-END-EDIT.
 15006
 15007     MOVE 'N'                     TO  FORM-MASTER-SW.
 15008     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15009
 15010     IF NOT FORM-MASTER-FOUND
 15011         GO TO 3999-END-EDIT.
 15012
 15013     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15014                                      FORM-MASTER-AH-SW.
 15015
 15016     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15017         MOVE  +1                 TO SUB6
 15018         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15019
 15020     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15021         MOVE  +1                 TO SUB6
 15022         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15023
 15024     IF LF-FORM-MASTER-FOUND  OR
 15025        AH-FORM-MASTER-FOUND
 15026         GO TO 3360-CHECK-FORM-LIMITS
 15027     ELSE
 15028         GO TO 3999-END-EDIT.
 15029
 15030******************************************************************
 15031*                  3350-GET-ERFORM                               *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 271
* EL050.cbl
 15032*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15033*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15034******************************************************************
 15035
 15036 3350-GET-ERFORM.
 15037
 15038     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15039         GO TO  3350-ERFORM-GETMAIN.
 15040
 15041     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15042     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15043     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15044     MOVE 'Y'                     TO FORM-MASTER-SW.
 15045
 15046     IF PB-CANCELLATION
 15047         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15048            PB-SV-STATE          EQUAL   FO-STATE       AND
 15049            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15050              GO TO 3350-EXIT
 15051         ELSE
 15052             NEXT SENTENCE
 15053     ELSE
 15054         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15055            PB-SV-STATE          EQUAL   FO-STATE       AND
 15056            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15057              GO TO 3350-EXIT.
 15058
 15059 3350-ERFORM-GETMAIN.
 15060
 15061     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15062     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15063
 15064 3350-ERFORM-READ.
 15065
 15066     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15067     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15068     IF PB-CANCELLATION
 15069         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15070     ELSE
 15071         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15072     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15073
 15074     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15075
 15076     IF FORM-MASTER-FOUND
 15077       IF PB-CANCELLATION
 15078          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15079             PB-SV-STATE          EQUAL   FO-STATE       AND
 15080             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15081              GO  TO 3350-EXIT
 15082          ELSE
 15083              NEXT SENTENCE
 15084       ELSE
 15085          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15086             PB-SV-STATE          EQUAL   FO-STATE       AND
 15087             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15088              GO  TO 3350-EXIT.
 15089
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 272
* EL050.cbl
 15090     MOVE  'N'                    TO  FORM-MASTER-SW.
 15091     MOVE  ER-1895                TO  WS-ERROR.
 15092     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15093
 15094 3350-EXIT.
 15095      EXIT.
 15096
 15097******************************************************************
 15098*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15099*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15100*   VALID FOR THE POLICY FORM USED.                              *
 15101******************************************************************
 15102
 15103 3355-EDIT-FORM-LF-BENEFITS.
 15104
 15105     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15106        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15107         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15108         GO TO   3355-EXIT.
 15109
 15110     IF  SUB6    LESS THAN   +40
 15111         ADD  +1      TO  SUB6
 15112         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15113
 15114     MOVE  ER-1896         TO  WS-ERROR.
 15115     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15116
 15117 3355-EXIT.
 15118      EXIT.
 15119
 15120******************************************************************
 15121*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15122*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15123*   VALID FOR THE POLICY FORM USED.                              *
 15124******************************************************************
 15125
 15126 3356-EDIT-FORM-AH-BENEFITS.
 15127
 15128     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15129        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15130         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15131         GO TO  3356-EXIT.
 15132
 15133      IF  SUB6    LESS THAN     +40
 15134          ADD  +1      TO  SUB6
 15135          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15136
 15137     MOVE  ER-1897         TO  WS-ERROR.
 15138     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15139
 15140 3356-EXIT.
 15141      EXIT.
 15142
 15143******************************************************************
 15144*                  3357-BENEFIT-SEARCH                           *
 15145*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15146*   CANCELLATIONS ONLY.                                          *
 15147******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 273
* EL050.cbl
 15148 3357-BENEFIT-SEARCH.
 15149     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15150         MOVE +1                          TO SUB6
 15151         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15152
 15153     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15154         MOVE +1                          TO SUB6
 15155         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15156
 15157 3357-EXIT.
 15158     EXIT.
 15159
 15160******************************************************************
 15161*                  3358-BENEFIT-LIFE-SEARCH                      *
 15162*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15163*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15164*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15165******************************************************************
 15166 3358-BENEFIT-LIFE-SEARCH.
 15167     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15168       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15169         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15170           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15171              IF FO-PLAN-REFUND-METHOD (SUB6)
 15172                     IS GREATER THAN SPACES
 15173                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15174                                          WS-LF-REFUND-CALC
 15175                 GO TO 3358-EXIT.
 15176
 15177     IF SUB6 LESS THAN +40
 15178         ADD +1                 TO SUB6
 15179         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15180
 15181 3358-EXIT.
 15182     EXIT.
 15183******************************************************************
 15184*                  3359-BENEFIT-AH-SEARCH                        *
 15185*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15186*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15187*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15188******************************************************************
 15189 3359-BENEFIT-AH-SEARCH.
 15190     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15191       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15192         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15193           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15194              IF FO-PLAN-REFUND-METHOD (SUB6)
 15195                      IS GREATER THAN SPACES
 15196                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15197                                          WS-AH-REFUND-CALC
 15198                 GO TO 3359-EXIT.
 15199
 15200     IF SUB6 LESS THAN +40
 15201         ADD +1                 TO SUB6
 15202         GO TO 3359-BENEFIT-AH-SEARCH.
 15203
 15204 3359-EXIT.
 15205     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 274
* EL050.cbl
 15206
 15207******************************************************************
 15208*                  3360-CHECK-FORM-LIMITS                        *
 15209*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15210*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15211******************************************************************
 15212
 15213 3360-CHECK-FORM-LIMITS.
 15214
 15215     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15216         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15217
 15218     IF NOT LF-FORM-MASTER-FOUND
 15219         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15220
 15221 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15222
 15223     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15224       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15225        WS-LF-JOINT-INDICATOR = 'J'  AND
 15226        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15227         IF PB-COMPANY-ID = 'NCL'
 15228            MOVE  ER-1911          TO  WS-ERROR
 15229            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15230         ELSE
 15231            MOVE  ER-1892          TO  WS-ERROR
 15232            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15233
 15234 3360-CHECK-FORM-LF-ATT-AGE.
 15235
 15236     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15237
 15238     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15239         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15240         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15241            IF PB-COMPANY-ID = 'NCL'
 15242                MOVE  ER-1913      TO  WS-ERROR
 15243                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15244            ELSE
 15245                MOVE  ER-1894      TO  WS-ERROR
 15246                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15247
 15248 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15249
 15250     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15251         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15252         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15253            IF PB-COMPANY-ID = 'NCL'
 15254                MOVE  ER-1914      TO  WS-ERROR
 15255                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15256            ELSE
 15257                MOVE  ER-1899      TO  WS-ERROR
 15258                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15259
 15260 3360-CHECK-FORM-LF-TERM-BAMT.
 15261
 15262     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15263         FO-LF-MAX-TERM   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 275
* EL050.cbl
 15264         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15265           IF  PB-COMPANY-ID = 'NCL'
 15266               MOVE  ER-1916       TO  WS-ERROR
 15267               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15268           ELSE
 15269               MOVE  ER-1902       TO  WS-ERROR
 15270               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15271
 15272     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15273                                    PB-I-LF-ALT-BENEFIT-AMT.
 15274
 15275     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15276         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15277         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15278             IF  PB-COMPANY-ID = 'NCL'
 15279                 MOVE  ER-1918     TO  WS-ERROR
 15280                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15281             ELSE
 15282                 MOVE  ER-1904     TO  WS-ERROR
 15283                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15284
 15285******************************************************************
 15286*                  3360-CHECK-FORM-AH-LIMITS                     *
 15287*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15288*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15289******************************************************************
 15290
 15291 3360-CHECK-FORM-AH-LIMITS.
 15292
 15293     IF NOT AH-FORM-MASTER-FOUND
 15294         GO TO 3999-END-EDIT.
 15295
 15296 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15297
 15298     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15299       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15300        WS-AH-JOINT-INDICATOR = 'J'  AND
 15301        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15302         IF PB-COMPANY-ID = 'NCL'
 15303            MOVE  ER-1912          TO  WS-ERROR
 15304            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15305         ELSE
 15306            MOVE  ER-1893          TO  WS-ERROR
 15307            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15308
 15309 3360-CHECK-FORM-AH-ATT-AGE.
 15310
 15311     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15312
 15313     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15314         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15315         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15316            IF PB-COMPANY-ID = 'NCL'
 15317                MOVE  ER-1913      TO  WS-ERROR
 15318                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15319            ELSE
 15320                MOVE  ER-1894      TO  WS-ERROR
 15321                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 276
* EL050.cbl
 15322
 15323 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15324
 15325     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15326         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15327         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15328            IF PB-COMPANY-ID = 'NCL'
 15329                MOVE  ER-1915      TO  WS-ERROR
 15330                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15331            ELSE
 15332                MOVE  ER-1900      TO  WS-ERROR
 15333                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15334
 15335 3360-CHECK-FORM-AH-TERM-BAMT.
 15336
 15337     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15338         FO-AH-MAX-TERM    GREATER THAN  +0
 15339         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15340             IF  PB-COMPANY-ID = 'NCL'
 15341                 MOVE  ER-1917     TO  WS-ERROR
 15342                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15343             ELSE
 15344                  MOVE  ER-1903    TO  WS-ERROR
 15345                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15346
 15347     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15348         FO-MAX-AH-AMT    GREATER THAN  +0
 15349         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15350             IF  PB-COMPANY-ID = 'NCL'
 15351                 MOVE  ER-1919     TO  WS-ERROR
 15352                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15353             ELSE
 15354                 MOVE  ER-1905     TO  WS-ERROR
 15355                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15356
 15357     GO TO 3999-END-EDIT.
 15358
 15359******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 277
* EL050.cbl
 15361******************************************************************
 15362*                  E D I T   C A N C E L                         *
 15363******************************************************************
 15364
 15365 3700-EDIT-CANCEL.
 15366     IF PB-COMPANY-ID = 'DMD'
 15367         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15368                                         WS-RES-MUNI-TAX
 15369                                         PB-CI-STATE-TAX
 15370                                         PB-CI-MUNI-TAX
 15371         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15372
 15373*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15374*       IF PB-ENTRY-BATCH  NUMERIC
 15375*          IF PB-CANCELLATION
 15376*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15377*          ELSE
 15378*             IF PB-ISSUE
 15379*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15380
 15381     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15382        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15383     END-IF
 15384*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15385*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15386
 15387     IF CM-ENTRY-STATUS = 'V'
 15388        MOVE ER-2780             TO WS-ERROR
 15389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15390        GO TO 3999-END-EDIT.
 15391
 15392     IF CM-ENTRY-STATUS = 'D'
 15393        MOVE ER-2781             TO WS-ERROR
 15394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15395        GO TO 3999-END-EDIT.
 15396
 15397     IF CM-ENTRY-STATUS = 'U'
 15398        MOVE ER-2782             TO WS-ERROR
 15399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15400
 15401***************************************************************
 15402*                                                             *
 15403*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15404*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15405*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15406*   OF ANOTHER COVERAGE.                                      *
 15407*                                                             *
 15408***************************************************************
 15409
 15410     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15411                                    PB-C-AH-CANCEL-VOID-SW.
 15412
 15413     IF PB-C-LF-CANCEL-AMT = ZERO
 15414        NEXT SENTENCE
 15415     ELSE
 15416        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15417           AND
 15418           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 278
* EL050.cbl
 15419               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15420               MOVE ER-2745           TO WS-ERROR
 15421               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15422
 15423     IF PB-C-AH-CANCEL-AMT = ZERO
 15424        NEXT SENTENCE
 15425     ELSE
 15426        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15427           AND
 15428           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15429               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15430               MOVE ER-2745           TO WS-ERROR
 15431               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15432
 15433     IF WS-LF-EARNINGS-CALC = '4'
 15434        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15435
 15436     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15437     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15438     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15439     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15440     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15441     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15442
 15443     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15444                                      PB-C-AH-REF-CALC.
 15445     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15446
 15447******************************************************************
 15448*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15449*             TO VALIDATE COVERAGE.                              *
 15450******************************************************************
 15451
 15452     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15453        PB-C-LF-CANCEL-AMT = ZEROS
 15454          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15455      ELSE
 15456          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15457
 15458     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15459        PB-C-AH-CANCEL-AMT = ZEROS
 15460          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15461      ELSE
 15462          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15463
 15464     EVALUATE TRUE
 15465         WHEN PB-CANCEL-FORCE             OR
 15466              PB-CANCEL-DATE-FORCED       OR
 15467              PB-FORCE-OFF
 15468                  IF PB-COMPANY-ID = 'ACE'
 15469                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15470                  END-IF
 15471         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15472               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15473              (PB-COMPANY-ID = 'ACE' )
 15474                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15475         WHEN OTHER
 15476              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 279
* EL050.cbl
 15477                 MOVE ER-2794              TO WS-ERROR
 15478              ELSE
 15479                 MOVE ER-2749              TO WS-ERROR
 15480              END-IF
 15481              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15482     END-EVALUATE.
 15483
 15484
 15485*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15486*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15487*            MOVE  ER-1909            TO  WS-ERROR
 15488*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15489*        ELSE
 15490*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15491
 15492     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15493     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15494        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15495     ELSE
 15496        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15497     END-IF
 15498     .
 15499 3705-EDIT-CANCEL-DT.
 15500
 15501     IF LF-COVERAGE-CANCELLED
 15502        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15503         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15504         MOVE WS-CURRENT-MONTH-END
 15505                                 TO DC-BIN-DATE-2
 15506         SET ELAPSED-BETWEEN-BIN TO TRUE
 15507*        MOVE 1                  TO DC-OPTION-CODE
 15508         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15509         IF DATE-CONVERSION-ERROR
 15510            NEXT SENTENCE
 15511          ELSE
 15512             IF DC-ELAPSED-DAYS GREATER +180
 15513                IF PB-CANCEL-DATE-FORCED  OR
 15514                   PB-CANCEL-DATE-FORCED-NO-FEE
 15515                      MOVE ER-2751  TO WS-ERROR
 15516                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15517                 ELSE
 15518                   MOVE ER-2752  TO WS-ERROR
 15519                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15520
 15521     IF AH-COVERAGE-CANCELLED
 15522        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15523         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15524         MOVE WS-CURRENT-MONTH-END
 15525                                 TO DC-BIN-DATE-2
 15526         SET ELAPSED-BETWEEN-BIN TO TRUE
 15527*        MOVE 1                  TO DC-OPTION-CODE
 15528         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15529         IF DATE-CONVERSION-ERROR
 15530            NEXT SENTENCE
 15531          ELSE
 15532             IF DC-ELAPSED-DAYS GREATER +180
 15533                IF PB-CANCEL-DATE-FORCED OR
 15534                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 280
* EL050.cbl
 15535                      MOVE ER-2751  TO WS-ERROR
 15536                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15537                 ELSE
 15538                   MOVE ER-2752  TO WS-ERROR
 15539                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15540
 15541     IF WS-ERROR = ER-2752
 15542        AND (PB-COMPANY-ID = 'ABL'
 15543         OR  PB-COMPANY-ID = 'FGL'
 15544         OR  PB-COMPANY-ID = 'IST'
 15545         OR  PB-COMPANY-ID = 'JHL'
 15546         OR  PB-COMPANY-ID = 'LAP'
 15547         OR  PB-COMPANY-ID = 'LBL'
 15548         OR  PB-COMPANY-ID = 'NCB'
 15549         OR  PB-COMPANY-ID = 'NLI'
 15550         OR  PB-COMPANY-ID = 'OFI'
 15551         OR  PB-COMPANY-ID = 'PLI'
 15552         OR  PB-COMPANY-ID = 'TAO'
 15553         OR  PB-COMPANY-ID = 'TIC'
 15554         OR  PB-COMPANY-ID = 'HER'
 15555         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15556         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15557            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15558            MOVE ER-2762     TO WS-ERROR
 15559            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15560
 15561     IF LF-COVERAGE-CANCELLED
 15562        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15563        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15564             MOVE ER-2733         TO WS-ERROR
 15565             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15566
 15567     IF AH-COVERAGE-CANCELLED
 15568        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15569        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15570              MOVE ER-2733        TO WS-ERROR
 15571              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15572
 15573     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15574        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15575        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15576           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15577            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15578              IF PB-COMPANY-ID NOT = 'LAP'
 15579               MOVE ER-2704            TO WS-ERROR
 15580               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15581
 15582     IF CERT-WAS-NOT-FOUND
 15583         GO TO 3999-END-EDIT.
 15584
 15585     IF PB-COMPANY-ID EQUAL 'CDC'
 15586        IF LF-COVERAGE-CANCELLED
 15587           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15588            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15589            MOVE PB-C-LF-CANCEL-DT
 15590                                 TO DC-BIN-DATE-2
 15591            SET ELAPSED-BETWEEN-BIN TO TRUE
 15592*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 281
* EL050.cbl
 15593            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15594            IF DATE-CONVERSION-ERROR
 15595               NEXT SENTENCE
 15596             ELSE
 15597                IF DC-ELAPSED-DAYS GREATER +60
 15598                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15599
 15600     IF PB-COMPANY-ID EQUAL 'CDC'
 15601        IF AH-COVERAGE-CANCELLED
 15602           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15603            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15604            MOVE PB-C-AH-CANCEL-DT
 15605                                 TO DC-BIN-DATE-2
 15606            MOVE +0              TO DC-ELAPSED-DAYS
 15607                                    DC-ELAPSED-MONTHS
 15608            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15609*           MOVE 1               TO DC-OPTION-CODE
 15610            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15611            IF DATE-CONVERSION-ERROR
 15612               NEXT SENTENCE
 15613             ELSE
 15614                IF DC-ELAPSED-DAYS GREATER +60
 15615                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15616
 15617     MOVE +0                     TO DC-ELAPSED-DAYS
 15618                                    DC-ELAPSED-MONTHS.
 15619
 15620     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15621        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15622          MOVE 'Z'                TO PB-CI-OB-FLAG
 15623          MOVE ER-2767            TO WS-ERROR
 15624          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15625          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15626          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15627          GO TO 3775-OVER-REF-CHK
 15628        ELSE
 15629          MOVE ZEROS              TO PB-CI-LIVES
 15630                                     PB-C-LIVES
 15631          IF PB-CI-OB-FLAG NOT = 'B'
 15632             MOVE SPACE           TO PB-CI-OB-FLAG.
 15633
 15634     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15635         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15636     ELSE
 15637         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15638
 15639     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15640        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15641            MOVE ER-2760         TO WS-ERROR
 15642            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15643
 15644     IF LF-COVERAGE-CANCELLED
 15645        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15646         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15647            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15648               MOVE ER-2774       TO WS-ERROR
 15649               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15650
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 282
* EL050.cbl
 15651     IF AH-COVERAGE-CANCELLED
 15652        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15653         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15654            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15655               MOVE ER-2775       TO WS-ERROR
 15656               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15657
 15658     IF LF-COVERAGE-CANCELLED
 15659        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15660         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15661            MOVE ER-2776         TO WS-ERROR
 15662            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15663
 15664     IF AH-COVERAGE-CANCELLED
 15665        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15666         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15667            MOVE ER-2777         TO WS-ERROR
 15668            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15669
 15670     IF LF-COVERAGE-CANCELLED
 15671        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15672        if pb-ci-lf-expire-dt = low-values or spaces
 15673           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15674           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15675           MOVE PB-CI-EXTENTION-DAYS
 15676                                 TO DC-ELAPSED-DAYS
 15677           SET BIN-PLUS-ELAPSED  TO TRUE
 15678           PERFORM 8500-DATE-CONVERT
 15679                                 THRU 8500-EXIT
 15680           IF DATE-CONVERSION-ERROR
 15681              move low-values    to dc-bin-date-2
 15682           end-if
 15683        else
 15684           move pb-ci-lf-expire-dt
 15685                                 to dc-bin-date-2
 15686        end-if
 15687        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15688           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15689                             OR  'FIA'
 15690              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15691           ELSE
 15692              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15693              MOVE ER-2731       TO WS-ERROR
 15694              PERFORM 9900-ERROR-FORMAT
 15695                                 THRU 9900-EXIT
 15696           end-if
 15697        end-if
 15698     end-if
 15699*    IF LF-COVERAGE-CANCELLED
 15700*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15701*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15702*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15703*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15704*        SET BIN-PLUS-ELAPSED      TO TRUE
 15705*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15706*        IF DATE-CONVERSION-ERROR
 15707*           NEXT SENTENCE
 15708*         ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 283
* EL050.cbl
 15709*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15710*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15711*                            OR  'FIA'
 15712*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15713*              ELSE
 15714*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15715*               MOVE ER-2731       TO WS-ERROR
 15716*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15717     .
 15718 3705-EDIT-AH-CANCEL-DT.
 15719     IF AH-COVERAGE-CANCELLED
 15720        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15721        if pb-ci-AH-expire-dt = low-values or spaces
 15722           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15723           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15724           MOVE PB-CI-EXTENTION-DAYS
 15725                                 TO DC-ELAPSED-DAYS
 15726           SET BIN-PLUS-ELAPSED  TO TRUE
 15727           PERFORM 8500-DATE-CONVERT
 15728                                 THRU 8500-EXIT
 15729           IF DATE-CONVERSION-ERROR
 15730              move low-values    to dc-bin-date-2
 15731           end-if
 15732        else
 15733           move pb-ci-ah-expire-dt
 15734                                 to dc-bin-date-2
 15735        end-if
 15736        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15737           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15738                             OR  'FIA'
 15739              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15740           ELSE
 15741              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15742              MOVE ER-2771       TO WS-ERROR
 15743              PERFORM 9900-ERROR-FORMAT
 15744                                 THRU 9900-EXIT
 15745           end-if
 15746        end-if
 15747     end-if
 15748*    IF AH-COVERAGE-CANCELLED
 15749*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15750*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15751*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15752*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15753**       MOVE 6                    TO DC-OPTION-CODE
 15754*        SET BIN-PLUS-ELAPSED      TO TRUE
 15755*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15756*        IF DATE-CONVERSION-ERROR
 15757*           NEXT SENTENCE
 15758*         ELSE
 15759*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15760*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15761*                             OR 'FIA'
 15762*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15763*             ELSE
 15764*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15765*              MOVE ER-2771       TO WS-ERROR
 15766*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 284
* EL050.cbl
 15767     .
 15768 3705-EDIT-CONTINUED.
 15769
 15770*    IF LF-COVERAGE-CANCELLED
 15771*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15772*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15773*            MOVE ER-2727         TO WS-ERROR
 15774*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15775*
 15776*    IF AH-COVERAGE-CANCELLED
 15777*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15778*        IF PB-COMPANY-ID = 'ACE'
 15779*           MOVE ER-2727        TO WS-ERROR
 15780*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15781*        ELSE
 15782*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15783*              MOVE ER-2727     TO WS-ERROR
 15784*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15785
 15786     IF PB-COMPANY-ID = 'ACE'
 15787       IF AH-COVERAGE-CANCELLED
 15788         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15789           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15790              MOVE ER-2732      TO WS-ERROR
 15791              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15792
 15793     IF PB-COMPANY-ID      EQUAL   'HER'
 15794        IF WS-ERROR        EQUAL   ER-2727
 15795            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15796            MOVE  ER-2725          TO  WS-ERROR
 15797            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15798
 15799     IF PB-C-CLAIM-CREATED-CANCEL
 15800            MOVE ER-2748         TO WS-ERROR
 15801            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15802
 15803     IF PB-C-LAST-NAME NOT = SPACES
 15804         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15805            MOVE ER-2747         TO WS-ERROR
 15806            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15807
 15808 3710-EDIT-LUMP-SUM-PRIOR.
 15809
 15810     IF AH-COVERAGE-CANCELLED
 15811         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15812             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15813                MOVE ER-2735    TO WS-ERROR
 15814                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15815
 15816     IF LF-COVERAGE-CANCELLED
 15817         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15818             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15819                MOVE ER-2735    TO WS-ERROR
 15820                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15821
 15822 3710-EDIT-PRIOR-DEATH.
 15823
 15824*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 285
* EL050.cbl
 15825*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15826*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15827*           (NOT PB-CI-OB)
 15828*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15829*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15830*                   MOVE ER-2732  TO WS-ERROR
 15831*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15832*
 15833*    IF AH-COVERAGE-CANCELLED
 15834*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15835*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15836*           (NOT PB-CI-OB)
 15837*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15838*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15839*                   MOVE ER-2732  TO WS-ERROR
 15840*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15841
 15842     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15843         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15844            (NOT PB-COMP-LF-CANCEL)
 15845             NEXT SENTENCE
 15846         ELSE
 15847           IF PB-C-LF-CANCEL-VOIDED
 15848              NEXT SENTENCE
 15849           ELSE
 15850              MOVE ER-2753      TO WS-ERROR
 15851              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15852
 15853     IF CANCEL-FUTURE-DT
 15854         GO TO 3999-END-EDIT.
 15855
 15856 3715-GET-REMAIN-TERM-LF.
 15857
 15858     IF NO-LF-BENEFIT-MATCH  OR
 15859        WS-LF-BENEFIT-CD = ZEROS
 15860        GO TO 3730-GET-AH-REMAIN-TERM.
 15861
 15862     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15863     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15864     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15865     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15866     MOVE PB-SV-STATE            TO CP-STATE.
 15867     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15868     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15869     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15870     MOVE '2'                    TO CP-PROCESS-TYPE.
 15871     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15872     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15873     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15874     IF (PB-COMPANY-ID = 'CID')
 15875        AND (CP-STATE-STD-ABBRV = 'WI')
 15876        MOVE '7'                 TO CP-REM-TERM-METHOD
 15877        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15878     ELSE
 15879        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15880        MOVE WS-REM-TRM-CALC-OPTION
 15881                                 TO CP-REM-TRM-CALC-OPTION
 15882     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 286
* EL050.cbl
 15883**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15884     IF (PB-COMPANY-ID = 'CID')
 15885        AND (CP-STATE-STD-ABBRV = 'MO')
 15886        AND (PB-CERT-EFF-DT >= X'9B41')
 15887        AND (PB-CERT-EFF-DT <= X'A2FB')
 15888        MOVE '7'                 TO CP-REM-TERM-METHOD
 15889        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15890     END-IF
 15891     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15892                                    CP-LOAN-TERM.
 15893     IF CP-TRUNCATED-LIFE
 15894        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15895
 15896     IF CP-TERM-IS-DAYS
 15897         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15898     ELSE
 15899         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15900
 15901     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15902
 15903     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15904
 15905     IF LF-COVERAGE-CANCELLED
 15906        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15907        NEXT SENTENCE
 15908      ELSE
 15909          GO TO 3730-GET-AH-REMAIN-TERM.
 15910
 15911 3720-GET-LF-REFUND.
 15912
 15913     IF PB-C-LF-CANCEL-VOIDED
 15914        GO TO 3730-GET-AH-REMAIN-TERM
 15915     end-if
 15916
 15917     IF PB-COMPANY-ID EQUAL 'BOA'
 15918         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15919         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15920         GO TO 3730-GET-AH-REMAIN-TERM.
 15921
 15922     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15923        (WS-AH-SPECIAL-CALC-CD = 'M')
 15924         MOVE ER-2767            TO WS-ERROR
 15925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15926         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15927         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15928         GO TO 3780-UPDATE-CANCEL-CERT.
 15929
 15930*    if (ws-lf-earnings-calc = '6')
 15931*       or (pb-c-lf-refund-override = '6')
 15932*       move cp-remaining-term-1 to cp-remaining-term-2
 15933*    end-if
 15934     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15935
 15936     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15937     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15938     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15939     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15940     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 287
* EL050.cbl
 15941     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15942     IF (PB-COMPANY-ID = 'DCC')
 15943        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15944        IF PDEF-MASTER-FOUND
 15945           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15946              (V1 > +8)
 15947              OR (PD-PROD-CODE (V1) = 'L')
 15948           END-PERFORM
 15949           IF V1 < +9
 15950              MOVE PD-MAX-AMT (V1)
 15951                           TO CP-R-MAX-TOT-BEN
 15952                              EC-AM-LF-MAX-TOT-BEN
 15953           END-IF
 15954        ELSE
 15955        MOVE ' '                 TO PDEF-MASTER-SW
 15956        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15957        MOVE PB-STATE            TO ERPDEF-STATE
 15958        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15959        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15960        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15961        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15962        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15963        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15964        IF PDEF-MASTER-FOUND
 15965           MOVE 'N'              TO PDEF-MASTER-SW
 15966           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15967           IF PDEF-MASTER-FOUND
 15968              IF (ERPDEF-KEY-SAVE (1:16) =
 15969                           PD-CONTROL-PRIMARY (1:16))
 15970                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15971                 CONTINUE
 15972              ELSE
 15973                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15974                 IF (ERPDEF-KEY-SAVE (1:16) =
 15975                           PD-CONTROL-PRIMARY (1:16))
 15976                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15977                    CONTINUE
 15978                 ELSE
 15979                    MOVE 'N'     TO PDEF-MASTER-SW
 15980                 END-IF
 15981              END-IF
 15982
 15983              IF PDEF-MASTER-FOUND
 15984                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15985                    (V1 > +8)
 15986                    OR (PD-PROD-CODE (V1) = 'L')
 15987                 END-PERFORM
 15988                 IF V1 < +9
 15989                    MOVE PD-MAX-AMT (V1)
 15990                                 TO CP-R-MAX-TOT-BEN
 15991                                    EC-AM-LF-MAX-TOT-BEN
 15992                 END-IF
 15993              END-IF
 15994           END-IF
 15995           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15996        END-IF
 15997        END-IF
 15998     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 288
* EL050.cbl
 15999     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16000
 16001     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16002
 16003     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16004                                    PB-C-LF-REM-TERM.
 16005
 16006     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16007     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16008
 16009     IF PB-COMPANY-ID EQUAL 'FLC'
 16010        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16011           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16012           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16013                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16014                    - CM-LF-ITD-DEATH-AMT
 16015           IF PB-C-LF-REF-CALC LESS THAN +0
 16016              MOVE +0            TO PB-C-LF-REF-CALC
 16017              GO TO 3730-GET-AH-REMAIN-TERM
 16018           ELSE
 16019              GO TO 3730-GET-AH-REMAIN-TERM.
 16020
 16021     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16022                            OR '4' OR '5' OR '6' OR '8'
 16023                            OR '9' OR 'G'
 16024        MOVE PB-C-LF-REFUND-OVERRIDE
 16025                                 TO CP-EARNING-METHOD.
 16026
 16027     if pb-company-id = 'AHL'
 16028        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16029        if cp-class-code = spaces
 16030           move zeros            to cp-class-code
 16031        end-if
 16032     ELSE
 16033        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16034     END-IF
 16035*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16036     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16037     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16038                                    CP-RATING-BENEFIT-AMT.
 16039     IF CP-STATE-STD-ABBRV = 'OR'
 16040         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16041                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16042     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16043     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16044     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16045     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16046     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16047     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16048     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16049     IF WS-DEFAULT-APR NOT NUMERIC
 16050         MOVE ZEROS TO WS-DEFAULT-APR.
 16051****   N O T E   ****
 16052*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16053*      THE OH HARD CODING IN ELCRFNDP
 16054
 16055     IF PB-COMPANY-ID = 'CID'
 16056        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 289
* EL050.cbl
 16057           MOVE WS-LF-EARNINGS-CALC
 16058                                 TO CP-EARNING-METHOD
 16059        END-IF
 16060     END-IF
 16061
 16062****   N O T E   ****
 16063
 16064     IF CP-EARN-AS-NET-PAY
 16065         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16066            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16067                MOVE WS-DEFAULT-APR
 16068                                 TO  CP-LOAN-APR
 16069                MOVE ER-3780     TO  WS-ERROR
 16070                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16071            ELSE
 16072                MOVE ER-3781     TO  WS-ERROR
 16073                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16074*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16075     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16076
 16077     IF CP-REFUND-TYPE-USED NOT = SPACE
 16078         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16079
 16080     IF CP-ERROR-RATE-IS-ZERO OR
 16081        CP-ERROR-RATE-NOT-FOUND
 16082        MOVE ER-2740             TO WS-ERROR
 16083        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16084
 16085     IF CP-ERROR-RATE-FILE-NOTOPEN
 16086        MOVE ER-2617             TO WS-ERROR
 16087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16088
 16089     IF PB-COMPANY-ID = 'DCC'
 16090        AND PB-CI-ENTRY-STATUS = 'M'
 16091        MOVE +0                  TO PB-C-LF-REF-CALC
 16092     ELSE
 16093        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16094     END-IF
 16095
 16096     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16097         GO TO 3730-GET-AH-REMAIN-TERM.
 16098
 16099*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16100*       ADD +1                   TO PB-C-LF-REM-TERM
 16101*                                   CP-REMAINING-TERM
 16102*                                   CP-ORIGINAL-TERM.
 16103
 16104     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16105     MOVE '2'                    TO CP-EARNING-METHOD
 16106                                    CP-RATING-METHOD.
 16107     IF PB-COMPANY-ID = 'CID'
 16108        IF (CP-STATE-STD-ABBRV = 'MN')
 16109           AND (PB-CERT-EFF-DT > X'A4FF')
 16110           AND (WS-LF-EARNINGS-CALC = 'B')
 16111           MOVE '5'              TO CP-EARNING-METHOD
 16112           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16113        END-IF
 16114     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 290
* EL050.cbl
 16115     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16116                                        CP-REMAINING-BENEFIT
 16117                                        CP-RATING-BENEFIT-AMT.
 16118     IF CP-STATE-STD-ABBRV = 'OR'
 16119         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16120                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16121     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16122     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16123
 16124     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16125
 16126     IF CP-ERROR-RATE-IS-ZERO OR
 16127        CP-ERROR-RATE-NOT-FOUND
 16128        MOVE ER-2740             TO WS-ERROR
 16129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16130
 16131     IF CP-ERROR-RATE-FILE-NOTOPEN
 16132        MOVE ER-2617             TO WS-ERROR
 16133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16134
 16135     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16136
 16137******************************************************************
 16138
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 291
* EL050.cbl
 16140 3730-GET-AH-REMAIN-TERM.
 16141     IF NO-AH-BENEFIT-MATCH  OR
 16142        WS-AH-BENEFIT-CD = ZEROS
 16143         GO TO 3770-CHECK-REFUNDS.
 16144
 16145     IF PB-CI-AH-LUMP-SUM-DISAB
 16146         IF  PB-C-AH-CANCEL-AMT = ZERO
 16147            IF NOT PB-COMP-AH-CANCEL
 16148             GO TO 3770-CHECK-REFUNDS.
 16149
 16150     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16151     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16152     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16153     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16154     MOVE PB-SV-STATE            TO CP-STATE.
 16155     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16156     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16157     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16158     MOVE '2'                    TO CP-PROCESS-TYPE.
 16159     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16160     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16161     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16162     IF (PB-COMPANY-ID = 'CID')
 16163        AND (CP-STATE-STD-ABBRV = 'WI')
 16164        MOVE '7'                 TO CP-REM-TERM-METHOD
 16165        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16166     ELSE
 16167        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16168        MOVE WS-REM-TRM-CALC-OPTION
 16169                                 TO CP-REM-TRM-CALC-OPTION
 16170     END-IF
 16171     IF (PB-COMPANY-ID = 'CID')
 16172        AND (CP-STATE-STD-ABBRV = 'MO')
 16173        AND (PB-CERT-EFF-DT >= X'9B41')
 16174        AND (PB-CERT-EFF-DT <= X'A2FB')
 16175        MOVE '7'                 TO CP-REM-TERM-METHOD
 16176        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16177     END-IF
 16178     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16179                                    CP-LOAN-TERM.
 16180     IF NOT CP-TERM-IS-DAYS
 16181         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16182
 16183     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16184
 16185     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16186
 16187     IF AH-COVERAGE-CANCELLED
 16188        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16189        NEXT SENTENCE
 16190      ELSE
 16191         GO TO 3770-CHECK-REFUNDS.
 16192
 16193 3740-GET-AH-REFUND.
 16194
 16195     IF PB-C-AH-CANCEL-VOIDED
 16196        GO TO 3780-UPDATE-CANCEL-CERT
 16197     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 292
* EL050.cbl
 16198
 16199     IF PB-COMPANY-ID = 'BOA'
 16200         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16201         GO TO 3770-CHECK-REFUNDS.
 16202
 16203     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16204*    MOVE ' '                    TO DC-OPTION-CODE
 16205     SET BIN-TO-GREG             TO TRUE
 16206     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16207     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16208                                    PB-C-AH-REM-TERM.
 16209     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16210     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16211
 16212     IF PB-COMPANY-ID EQUAL 'FLC'
 16213        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16214           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16215           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16216                    - CM-AH-ITD-AH-PMT)
 16217           IF PB-C-AH-REF-CALC LESS THAN +0
 16218              MOVE +0            TO PB-C-AH-REF-CALC
 16219              GO TO 3770-CHECK-REFUNDS
 16220           ELSE
 16221              GO TO 3770-CHECK-REFUNDS.
 16222
 16223     IF PB-COMPANY-ID = 'DCC'
 16224        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16225            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16226           MOVE 'S'              TO CP-EARNING-METHOD
 16227        END-IF
 16228     END-IF
 16229     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16230                            OR '4' OR '5' OR '6' OR '8'
 16231                            OR '9' OR 'G' OR 'S'
 16232        MOVE PB-C-AH-REFUND-OVERRIDE
 16233                                 TO CP-EARNING-METHOD.
 16234
 16235     if pb-company-id = 'AHL'
 16236        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16237        if cp-class-code = spaces
 16238           move zeros            to cp-class-code
 16239        end-if
 16240     ELSE
 16241        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16242     END-IF
 16243*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16244     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16245     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16246                                    CP-RATING-BENEFIT-AMT.
 16247     IF CP-STATE-STD-ABBRV = 'OR'
 16248         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16249                                         PB-CI-AH-TERM.
 16250     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16251     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16252     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16253     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16254     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16255     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 293
* EL050.cbl
 16256
 16257     IF CP-STATE-STD-ABBRV = 'OH'
 16258        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16259                                AND 'CID' AND 'DCC' AND 'AHL')
 16260           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16261              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16262              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16263              MOVE '6' TO CP-EARNING-METHOD
 16264           END-IF
 16265        END-IF
 16266        IF PB-COMPANY-ID = 'CID'
 16267           IF NO-LIFE-COVERAGE
 16268              IF CP-CRITICAL-PERIOD
 16269                 MOVE '2'       TO CP-EARNING-METHOD
 16270              ELSE
 16271                 MOVE '6'       TO CP-EARNING-METHOD
 16272              END-IF
 16273           ELSE
 16274              IF WS-LF-COVERAGE-TYPE = 'L'
 16275                 MOVE '2'       TO CP-EARNING-METHOD
 16276              ELSE
 16277                 IF (PB-CI-LF-TERM > +60) OR
 16278                    (WS-LF-EARNINGS-CALC = '5')
 16279                    IF CP-CRITICAL-PERIOD
 16280                       MOVE '2'  TO CP-EARNING-METHOD
 16281                    ELSE
 16282                       MOVE '6'  TO CP-EARNING-METHOD
 16283                    END-IF
 16284                 ELSE
 16285                    MOVE '1'     TO CP-EARNING-METHOD
 16286                 END-IF
 16287              END-IF
 16288           END-IF
 16289        END-IF
 16290     END-IF
 16291
 16292*    IF CP-STATE-STD-ABBRV = 'VA'
 16293*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16294*          IF CP-ORIGINAL-TERM GREATER 61
 16295*             MOVE '6' TO CP-EARNING-METHOD
 16296*          ELSE
 16297*             MOVE '1' TO CP-EARNING-METHOD.
 16298
 16299     IF WS-DEFAULT-APR NOT NUMERIC
 16300         MOVE ZEROS TO WS-DEFAULT-APR.
 16301     IF CP-EARN-AS-NET-PAY
 16302         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16303            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16304                MOVE WS-DEFAULT-APR
 16305                                 TO  CP-LOAN-APR
 16306                MOVE ER-3780     TO  WS-ERROR
 16307                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16308            ELSE
 16309                MOVE ER-3781     TO  WS-ERROR
 16310                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16311     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16312     IF PB-COMPANY-ID = 'DCC'
 16313        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 294
* EL050.cbl
 16314        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16315        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16316     END-IF
 16317     IF PB-COMPANY-ID = 'DCC'
 16318        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16319        AND (CP-EARNING-METHOD = 'D')
 16320        AND (CP-CANCEL-REASON NOT = 'R')
 16321        CONTINUE
 16322     ELSE
 16323        GO TO 3750-CONTINUE
 16324     END-IF
 16325     MOVE ' '                    TO DD-IU-SW
 16326     IF NOT PDEF-MASTER-FOUND
 16327        MOVE ' '                 TO PDEF-MASTER-SW
 16328        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16329        MOVE PB-STATE            TO ERPDEF-STATE
 16330        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16331        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16332        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16333        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16334        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16335        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16336        IF PDEF-MASTER-FOUND
 16337           MOVE 'N'              TO PDEF-MASTER-SW
 16338           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16339           IF PDEF-MASTER-FOUND
 16340              IF (ERPDEF-KEY-SAVE (1:16) =
 16341                           PD-CONTROL-PRIMARY (1:16))
 16342                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16343                 CONTINUE
 16344              ELSE
 16345                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16346                 IF (ERPDEF-KEY-SAVE (1:16) =
 16347                           PD-CONTROL-PRIMARY (1:16))
 16348                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16349                    CONTINUE
 16350                 ELSE
 16351                    MOVE ER-2740 TO WS-ERROR
 16352                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16353                    GO TO 3770-CHECK-REFUNDS
 16354                 END-IF
 16355              END-IF
 16356           END-IF
 16357           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16358        END-IF
 16359     END-IF
 16360     IF PDEF-MASTER-FOUND
 16361        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16362           (V1 > +8)
 16363           OR (PD-PROD-CODE (V1) = 'I')
 16364        END-PERFORM
 16365        IF V1 < +9
 16366           SET DD-IU-PRESENT        TO TRUE
 16367        END-IF
 16368        IF WS-AH-DCC-TRUNC = 'T'
 16369           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16370        ELSE
 16371           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 295
* EL050.cbl
 16372        END-IF
 16373        EVALUATE TRUE
 16374           WHEN WS-TERM > +168
 16375              MOVE 15               TO V1
 16376           WHEN WS-TERM > +156
 16377              MOVE 14               TO V1
 16378           WHEN WS-TERM > +144
 16379              MOVE 13               TO V1
 16380           WHEN WS-TERM > +132
 16381              MOVE 12               TO V1
 16382           WHEN WS-TERM > +120
 16383              MOVE 11               TO V1
 16384           WHEN WS-TERM > +108
 16385              MOVE 10               TO V1
 16386           WHEN WS-TERM > +96
 16387              MOVE 9                TO V1
 16388           WHEN WS-TERM > +84
 16389              MOVE 8                TO V1
 16390           WHEN WS-TERM > +72
 16391              MOVE 7                TO V1
 16392           WHEN WS-TERM > +60
 16393              MOVE 6                TO V1
 16394           WHEN WS-TERM > +48
 16395              MOVE 5                TO V1
 16396           WHEN WS-TERM > +36
 16397              MOVE 4                TO V1
 16398           WHEN WS-TERM > +24
 16399              MOVE 3                TO V1
 16400           WHEN WS-TERM > +12
 16401              MOVE 2                TO V1
 16402           WHEN OTHER
 16403              MOVE 1                TO V1
 16404        END-EVALUATE
 16405
 16406        EVALUATE TRUE
 16407*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16408*             < +13)
 16409*             AND (DD-IU-PRESENT)
 16410*             MOVE 2                TO V2
 16411*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16412*             MOVE 1                TO V2
 16413           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16414              MOVE 2                TO V2
 16415           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16416              MOVE 3                TO V2
 16417           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16418              MOVE 4                TO V2
 16419           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16420              MOVE 5                TO V2
 16421           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16422              MOVE 6                TO V2
 16423           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16424              MOVE 7                TO V2
 16425           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16426              MOVE 8                TO V2
 16427           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16428              MOVE 9                TO V2
 16429           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 296
* EL050.cbl
 16430              MOVE 10               TO V2
 16431           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16432              MOVE 11               TO V2
 16433           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16434              MOVE 12               TO V2
 16435           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16436              MOVE 13               TO V2
 16437           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16438              MOVE 14               TO V2
 16439           WHEN OTHER
 16440              MOVE 15               TO V2
 16441        END-EVALUATE
 16442
 16443        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16444                                 TO CP-DDF-LO-FACT
 16445        MOVE PD-UEP-FACTOR (V1 V2)
 16446                                 TO CP-DDF-HI-FACT
 16447
 16448        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16449        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16450        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16451           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16452        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16453        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16454        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16455           + PD-1ST-YR-ADMIN-ALLOW
 16456
 16457        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16458*       IF PI-CLP-YN = 'Y'
 16459*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16460*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16461*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16462*       END-IF
 16463
 16464        IF DD-IU-PRESENT
 16465           MOVE 'I'              TO CP-EARNING-METHOD
 16466        END-IF
 16467        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16468                                     CP-CLP-RATE-UP
 16469        IF CP-IU-RATE-UP NOT = ZEROS
 16470           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16471              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16472           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16473              / (1 - WS-WORK-FACT)
 16474        END-IF
 16475     END-IF
 16476     .
 16477 3750-CONTINUE.
 16478     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16479
 16480     IF CP-REFUND-TYPE-USED NOT = SPACE
 16481         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16482
 16483     IF CP-ERROR-RATE-IS-ZERO OR
 16484        CP-ERROR-RATE-NOT-FOUND
 16485        MOVE ER-2740             TO WS-ERROR
 16486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16487
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 297
* EL050.cbl
 16488     IF CP-ERROR-RATE-FILE-NOTOPEN
 16489        MOVE ER-2617             TO WS-ERROR
 16490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16491     IF PB-COMPANY-ID = 'DCC'
 16492        AND PB-CI-ENTRY-STATUS = 'M'
 16493        MOVE +0                  TO PB-C-AH-REF-CALC
 16494     ELSE
 16495        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16496     END-IF
 16497     IF PB-COMPANY-ID = 'DCC'
 16498        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16499        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16500        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16501        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16502        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16503        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16504        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16505        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16506*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16507     END-IF
 16508     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 298
* EL050.cbl
 16510
 16511 3770-CHECK-REFUNDS.
 16512
 16513     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16514        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16515           MOVE ER-2766          TO WS-ERROR
 16516           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16517           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16518           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16519              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16520
 16521     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16522        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16523           MOVE ER-2766          TO WS-ERROR
 16524           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16525           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16526           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16527              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16528
 16529     IF PB-COMP-LF-CANCEL
 16530        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16531        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16532           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16533              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16534
 16535     IF PB-COMP-AH-CANCEL
 16536        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16537        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16538           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16539              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16540
 16541     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16542             GIVING WS-UNSIGN-WRK1
 16543     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16544             GIVING WS-UNSIGN-WRK2.
 16545
 16546     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16547         MOVE ZERO TO WS-UNSIGN-WRK1.
 16548
 16549     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16550         MOVE ZERO TO WS-UNSIGN-WRK2.
 16551
 16552     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16553
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 299
* EL050.cbl
 16555
 16556 3772-CONTINUE.
 16557
 16558**********************************
 16559*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16560*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16561*** DOUBLES THE TOLERANCE AMOUNT.
 16562***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16563**********************************
 16564     IF PB-COMPANY-ID = 'MON'
 16565     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16566         IF WS-REF-REJECT-SW = SPACE
 16567             MOVE ER-2754        TO WS-ERROR
 16568             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16569           ELSE
 16570             MOVE ER-2736        TO WS-ERROR
 16571             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16572**********************************
 16573
 16574 3773-CONTINUE.
 16575
 16576     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16577        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16578           MOVE ER-2723          TO WS-ERROR
 16579           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16580
 16581     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16582        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16583           MOVE ER-2724          TO WS-ERROR
 16584           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16585
 16586     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16587         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16588             (1 + WS-LF-REFUND-OVS-PCT)
 16589     ELSE
 16590         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16591
 16592     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16593         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16594             (1 - WS-TOL-LF-REFUND-PCT)
 16595     ELSE
 16596         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16597
 16598     IF (PB-COMPANY-ID = 'DCC')
 16599        AND (PB-CI-ENTRY-STATUS = 'M')
 16600        AND (PB-C-LF-CANCEL-AMT > +0)
 16601        MOVE ER-3843             TO WS-ERROR
 16602        PERFORM 9900-ERROR-FORMAT
 16603                                 THRU 9900-EXIT
 16604     END-IF
 16605     EVALUATE TRUE
 16606        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16607           CONTINUE
 16608        WHEN PB-C-LF-CANCEL-AMT = +0
 16609                 AND PB-C-LF-REF-CALC > +0
 16610           CONTINUE
 16611        WHEN WS-LF-REFUND-OVS-AMT = 0
 16612                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 300
* EL050.cbl
 16613           CONTINUE
 16614        WHEN OTHER
 16615           IF WS-TOL-LF-REFUND  = +0
 16616              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16617           END-IF
 16618           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16619                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16620                          (PB-C-LF-CANCEL-AMT))
 16621              CONTINUE
 16622           ELSE
 16623              IF WS-LF-REFUND-OVS-AMT = +0
 16624                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16625              END-IF
 16626              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16627                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16628                                       PB-C-LF-CANCEL-AMT)
 16629                 CONTINUE
 16630              ELSE
 16631                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16632                   MOVE ER-2754   TO  WS-ERROR
 16633                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16634                 ELSE
 16635                    MOVE ER-2736   TO  WS-ERROR
 16636                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16637                 END-IF
 16638              END-IF
 16639           END-IF
 16640     END-EVALUATE.
 16641
 16642     EVALUATE TRUE
 16643        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16644           CONTINUE
 16645        WHEN PB-C-LF-CANCEL-AMT = +0
 16646                 AND PB-C-LF-REF-CALC > +0
 16647           CONTINUE
 16648        WHEN OTHER
 16649           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16650               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16651              CONTINUE
 16652           ELSE
 16653              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16654               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16655                CONTINUE
 16656              ELSE
 16657                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16658                     MOVE ER-2754   TO  WS-ERROR
 16659                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16660                 ELSE
 16661                     MOVE ER-2736   TO  WS-ERROR
 16662                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16663                 END-IF
 16664              END-IF
 16665           END-IF
 16666     END-EVALUATE.
 16667
 16668     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16669         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16670             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 301
* EL050.cbl
 16671     ELSE
 16672         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16673
 16674     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16675         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16676             (1 - WS-TOL-AH-REFUND-PCT)
 16677     ELSE
 16678         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16679
 16680     IF (PB-COMPANY-ID = 'DCC')
 16681        AND (PB-CI-ENTRY-STATUS = 'M')
 16682        AND (PB-C-AH-CANCEL-AMT > +0)
 16683        MOVE ER-3843             TO WS-ERROR
 16684        PERFORM 9900-ERROR-FORMAT
 16685                                 THRU 9900-EXIT
 16686     END-IF
 16687     EVALUATE TRUE
 16688        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16689           CONTINUE
 16690*       WHEN PB-C-AH-REF-CALC = +0 AND
 16691*                  PB-C-AH-CANCEL-AMT > +0
 16692        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16693                   PB-C-AH-REF-CALC > +0
 16694           CONTINUE
 16695        WHEN WS-AH-REFUND-OVS-AMT = +0
 16696                AND WS-TOL-AH-REFUND = +0
 16697           CONTINUE
 16698        WHEN OTHER
 16699           IF WS-TOL-AH-REFUND = +0
 16700              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16701           END-IF
 16702           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16703               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16704                                         PB-C-AH-CANCEL-AMT)
 16705              CONTINUE
 16706           ELSE
 16707              IF WS-AH-REFUND-OVS-AMT = +0
 16708                 MOVE +9999999.99 TO
 16709                         WS-AH-REFUND-OVS-AMT
 16710              END-IF
 16711              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16712                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16713                                         PB-C-AH-CANCEL-AMT)
 16714                 CONTINUE
 16715              ELSE
 16716                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16717                    MOVE ER-2754   TO  WS-ERROR
 16718                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16719                 ELSE
 16720                    MOVE ER-2736   TO  WS-ERROR
 16721                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16722                 END-IF
 16723              END-IF
 16724           END-IF
 16725     END-EVALUATE.
 16726
 16727     EVALUATE TRUE
 16728        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 302
* EL050.cbl
 16729           CONTINUE
 16730*       WHEN PB-C-AH-REF-CALC > +0 AND
 16731*                  PB-C-AH-CANCEL-AMT = +0
 16732        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16733                   PB-C-AH-REF-CALC = +0
 16734           CONTINUE
 16735        WHEN OTHER
 16736           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16737               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16738              CONTINUE
 16739           ELSE
 16740              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16741                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16742                 CONTINUE
 16743              ELSE
 16744                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16745                     MOVE ER-2754   TO  WS-ERROR
 16746                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16747                 ELSE
 16748                     MOVE ER-2736   TO  WS-ERROR
 16749                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16750                 END-IF
 16751              END-IF
 16752           END-IF
 16753     END-EVALUATE.
 16754
 16755     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16756        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16757        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16758           AND  PB-C-LF-REF-CALC < +1.00
 16759           AND  PB-C-AH-REF-CALC < +1.00
 16760           CONTINUE
 16761        ELSE
 16762           IF (PB-COMPANY-ID = 'DCC')
 16763              AND (PB-CI-ENTRY-STATUS = 'M')
 16764              CONTINUE
 16765           ELSE
 16766              MOVE ER-2741       TO WS-ERROR
 16767              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16768           END-IF
 16769        END-IF
 16770     END-IF
 16771
 16772     IF (PB-C-LF-CANCEL-AMT = ZERO
 16773        AND WS-LF-BENEFIT-CD NOT = ZERO
 16774        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16775        AND PB-C-LF-REF-CALC NOT = ZERO)
 16776        OR
 16777        (PB-C-LF-CANCEL-AMT = ZERO
 16778        AND WS-LF-BENEFIT-CD NOT = ZERO
 16779        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16780             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16781                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16782                NEXT SENTENCE
 16783             ELSE
 16784                MOVE ER-2739        TO WS-ERROR
 16785                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16786
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 303
* EL050.cbl
 16787     IF (PB-C-AH-CANCEL-AMT = ZERO
 16788        AND WS-AH-BENEFIT-CD NOT = ZERO
 16789        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16790        AND PB-C-AH-REF-CALC NOT = ZERO)
 16791        OR
 16792        (PB-C-AH-CANCEL-AMT = ZERO
 16793        AND WS-AH-BENEFIT-CD NOT = ZERO
 16794        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16795             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16796                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16797                NEXT SENTENCE
 16798             ELSE
 16799                MOVE ER-2738        TO WS-ERROR
 16800                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16801
 16802 3775-OVER-REF-CHK.
 16803
 16804     IF PB-CI-ENTRY-STATUS = '5'
 16805        GO TO 3780-UPDATE-CANCEL-CERT.
 16806
 16807     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16808                              PB-CI-LF-ALT-PREMIUM-AMT.
 16809
 16810     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16811        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16812                                 PB-C-LF-REF-CALC
 16813      ELSE
 16814        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16815                                 PB-C-LF-CANCEL-AMT.
 16816
 16817     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16818        MOVE ER-2755             TO WS-ERROR
 16819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16820
 16821     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16822
 16823     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16824        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16825                                 PB-C-AH-REF-CALC
 16826      ELSE
 16827        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16828                                 PB-C-AH-CANCEL-AMT.
 16829
 16830     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16831        MOVE ER-2778             TO WS-ERROR
 16832        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16833
 16834     IF PB-CI-OB-FLAG NOT = 'Z'
 16835        NEXT SENTENCE
 16836       ELSE
 16837         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16838            MOVE ER-2757           TO WS-ERROR
 16839            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16840
 16841 3780-UPDATE-CANCEL-CERT.
 16842
 16843     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16844        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 304
* EL050.cbl
 16845        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16846
 16847     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16848         MOVE ER-2729              TO WS-ERROR
 16849         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16850
 16851     IF PB-CI-LF-BENEFIT-CD = ZERO
 16852         GO TO 3780-UPDATE-CONT-1.
 16853
 16854     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16855         GO TO 3780-UPDATE-CONT-1.
 16856
 16857     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16858       AND
 16859        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16860       AND
 16861        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16862       AND
 16863        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16864            NEXT SENTENCE
 16865       ELSE
 16866        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16867          AND
 16868***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16869***       AND
 16870           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16871            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16872               MOVE ER-2730      TO WS-ERROR
 16873               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16874               GO TO 3999-END-EDIT
 16875            ELSE
 16876               GO TO 3999-END-EDIT
 16877        ELSE
 16878            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16879               MOVE ER-2765           TO WS-ERROR
 16880               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16881               GO TO 3785-CHECK-NH.
 16882*              GO TO 3999-END-EDIT.
 16883
 16884 3780-UPDATE-CONT-1.
 16885     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16886
 16887     IF PB-CI-AH-BENEFIT-CD = ZERO
 16888         GO TO 3780-UPDATE-CONT-2.
 16889
 16890     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16891         GO TO 3780-UPDATE-CONT-2.
 16892
 16893     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16894
 16895     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16896       AND
 16897        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16898       AND
 16899        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16900       AND
 16901        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16902            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 305
* EL050.cbl
 16903       ELSE
 16904        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16905          AND
 16906***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16907***       AND
 16908           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16909           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16910            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16911               MOVE ER-2773      TO WS-ERROR
 16912               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16913               GO TO 3999-END-EDIT
 16914            ELSE
 16915               GO TO 3999-END-EDIT
 16916            END-IF
 16917           ELSE
 16918             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16919                MOVE ER-2890 TO WS-ERROR
 16920                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16921                GO TO 3999-END-EDIT
 16922             ELSE
 16923                GO TO 3785-CHECK-NH
 16924             END-IF
 16925           END-IF
 16926          ELSE
 16927            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16928              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16929                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16930                   MOVE ER-2890 TO WS-ERROR
 16931                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16932                   GO TO 3999-END-EDIT
 16933                ELSE
 16934                   MOVE ER-2765 TO WS-ERROR
 16935                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16936                   GO TO 3785-CHECK-NH
 16937                END-IF
 16938              ELSE
 16939               MOVE ER-2765      TO WS-ERROR
 16940               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16941               GO TO 3785-CHECK-NH.
 16942*              GO TO 3999-END-EDIT.
 16943
 16944 3780-UPDATE-CONT-2.
 16945
 16946     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16947        AND WS-LF-BENEFIT-CD = ZERO
 16948           MOVE ER-2743           TO WS-ERROR
 16949           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16950
 16951     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16952        AND WS-AH-BENEFIT-CD = ZERO
 16953           MOVE ER-2744           TO WS-ERROR
 16954           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16955
 16956     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16957        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16958        AND
 16959        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16960         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 306
* EL050.cbl
 16961           MOVE ER-2746           TO WS-ERROR
 16962           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16963
 16964     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16965       AND
 16966        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16967             MOVE ER-2737        TO WS-ERROR
 16968             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16969
 16970     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16971       AND
 16972        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16973             MOVE ER-2737        TO WS-ERROR
 16974             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16975
 16976     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16977         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16978             OR 'CID' OR 'DCC' OR 'AHL'
 16979             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16980         ELSE
 16981             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16982                 MOVE ER-2768    TO WS-ERROR
 16983                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16984             ELSE
 16985                 MOVE ER-2756    TO WS-ERROR
 16986                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16987
 16988     IF CERT-PEND-ISSUE-RETURNED
 16989        MOVE ER-2772             TO WS-ERROR
 16990        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16991 3785-CHECK-NH.
 16992     IF PB-STATE NOT = 'NH'
 16993        GO TO 3999-END-EDIT
 16994     END-IF
 16995
 16996     MOVE ER-2796                TO WS-ERROR
 16997     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16998     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16999        OR (CM-NH-INTERFACE-SW = 'Y')
 17000        MOVE ER-2793             TO WS-ERROR
 17001        PERFORM 9900-ERROR-FORMAT
 17002                                 THRU 9900-EXIT
 17003     END-IF
 17004     MOVE +0                     TO WS-PAYMENT-AMT
 17005     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17006        GO TO 3999-END-EDIT
 17007     END-IF
 17008     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17009        GO TO 3999-END-EDIT
 17010     END-IF
 17011     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17012     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17013     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17014        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17015     END-IF
 17016     MOVE '1'                    TO DC-OPTION-CODE
 17017     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17018     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 307
* EL050.cbl
 17019        IF DC-ELAPSED-DAYS < +16
 17020           GO TO 3999-END-EDIT
 17021        END-IF
 17022     END-IF
 17023     MOVE +0                     TO DC-ELAPSED-DAYS
 17024     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17025     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17026     MOVE '1'                    TO DC-OPTION-CODE
 17027     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17028     IF NO-CONVERSION-ERROR
 17029        IF DC-ELAPSED-DAYS > +30
 17030           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17031        ELSE
 17032           GO TO 3999-END-EDIT
 17033        END-IF
 17034     ELSE
 17035        GO TO 3999-END-EDIT
 17036     END-IF
 17037     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17038        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17039           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17040     IF WS-PAYMENT-AMT < 600.00
 17041        GO TO 3999-END-EDIT
 17042     END-IF
 17043     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17044
 17045     IF (ERMAIL-FOUND = ' ')
 17046         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17047         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17048        GO TO 3999-END-EDIT
 17049     END-IF
 17050     MOVE ER-2795                TO WS-ERROR
 17051     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17052
 17053     GO TO 3999-END-EDIT.
 17054******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 308
* EL050.cbl
 17056 3990-FILES-NOT-OPEN.
 17057
 17058     MOVE ER-2617                TO WS-ERROR.
 17059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17060     GO TO 9990-RETURN.
 17061
 17062 3999-END-EDIT.
 17063
 17064     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17065
 17066     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17067         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17068         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17069             PERFORM 9250-UNLOCK-RETURN
 17070             GO TO 9990-RETURN
 17071          ELSE
 17072             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17073             GO TO 9990-RETURN.
 17074
 17075     IF PB-CANCELLATION
 17076          GO TO 9990-RETURN.
 17077
 17078     IF CERT-WAS-NOT-FOUND
 17079        MOVE SPACES              TO CERTIFICATE-MASTER.
 17080
 17081     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17082
 17083     IF CERT-WAS-FOUND
 17084         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17085             PERFORM 9250-UNLOCK-RETURN
 17086          ELSE
 17087            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17088      ELSE
 17089         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17090
 17091     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17092        IF PB-COMPANY-ID = 'DCC' AND
 17093           (PB-CARRIER = '2' OR '4' OR '6')
 17094              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17095        END-IF
 17096     END-IF.
 17097
 17098     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17099         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17100     END-IF.
 17101     move ' '                    to ws-ins-age-defaulted
 17102     perform 8150-read-elcrtt    thru 8150-exit
 17103     if ws-ins-age-defaulted = 'Y'
 17104        move er-1573             to ws-error
 17105        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17106     end-if
 17107
 17108     if ws-jnt-age-defaulted = 'Y'
 17109        move er-1574             to ws-error
 17110        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17111     end-if
 17112
 17113     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 309
* EL050.cbl
 17114     IF ((PB-COMPANY-ID = 'DCC')
 17115        AND (WS-NO-SECURE-PAY))
 17116                  OR
 17117        (WS-LF-SPECIAL-CALC-CD = 'O'
 17118        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17119        SET SKIP-ADDR-EDIT       TO TRUE
 17120     END-IF
 17121     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17122        AND (NOT SKIP-ADDR-EDIT)
 17123        MOVE ER-2963             TO WS-ERROR
 17124        PERFORM 9900-ERROR-FORMAT
 17125                                 THRU 9900-EXIT
 17126        GO TO 9990-RETURN
 17127     END-IF
 17128     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17129     IF ERPNDM-FOUND NOT = 'X'
 17130        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17131           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17132           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17133           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17134           AND (NOT SKIP-ADDR-EDIT)
 17135           MOVE ER-2694          TO WS-ERROR
 17136           PERFORM 9900-ERROR-FORMAT
 17137                                 THRU 9900-EXIT
 17138        END-IF
 17139        MOVE ' '                 TO STATE-RECORD-ERROR
 17140        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17141        MOVE PM-STATE            TO CNTL-ACCESS
 17142        MOVE '3'                 TO CNTL-REC-TYPE
 17143        MOVE +0                  TO CNTL-SEQ-NO
 17144        MOVE '0'                 TO RC-SW-2
 17145        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17146        IF (NO-STATE-RECORD)
 17147           OR (CF-RECORD-TYPE NOT = '3')
 17148           OR (PM-STATE NOT = CF-STATE-CODE)
 17149           IF (PM-STATE = SPACES)
 17150              AND (SKIP-ADDR-EDIT)
 17151              CONTINUE
 17152           ELSE
 17153              MOVE ER-2963       TO WS-ERROR
 17154              PERFORM 9900-ERROR-FORMAT
 17155                                 THRU 9900-EXIT
 17156           END-IF
 17157        END-IF
 17158        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17159           MOVE ER-2883          TO WS-ERROR
 17160           PERFORM 9900-ERROR-FORMAT
 17161                                 THRU 9900-EXIT
 17162        END-IF
 17163        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17164           MOVE ' '                 TO STATE-RECORD-ERROR
 17165           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17166           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17167           MOVE '3'                 TO CNTL-REC-TYPE
 17168           MOVE +0                  TO CNTL-SEQ-NO
 17169           MOVE '0'                 TO RC-SW-2
 17170           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17171           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 310
* EL050.cbl
 17172              OR (CF-RECORD-TYPE NOT = '3')
 17173              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17174              MOVE ER-2964          TO WS-ERROR
 17175              PERFORM 9900-ERROR-FORMAT
 17176                                    THRU 9900-EXIT
 17177           END-IF
 17178        END-IF
 17179     ELSE
 17180        IF NOT SKIP-ADDR-EDIT
 17181           MOVE ER-2393          TO WS-ERROR
 17182           PERFORM 9900-ERROR-FORMAT
 17183                                 THRU 9900-EXIT
 17184        END-IF
 17185     END-IF
 17186
 17187     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17188
 17189     IF (ERMAIL-FOUND = ' ' AND
 17190        ERPNDM-FOUND = ' ')
 17191        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17192           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17193           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17194          OR
 17195           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17196          OR
 17197           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17198           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17199           GO TO 3999-UNLOCK-ERMAIL.
 17200
 17201     IF ERPNDM-FOUND = 'X'
 17202        GO TO 3999-UNLOCK-ERMAIL.
 17203
 17204     IF PM-INSURED-LAST-NAME      = SPACES
 17205        AND PM-INSURED-FIRST-NAME = SPACES
 17206        AND PM-ADDRESS-LINE-1     = SPACES
 17207        AND PM-ADDRESS-LINE-2     = SPACES
 17208        AND PM-CITY-STATE         = SPACES
 17209        AND PM-CRED-BENE-NAME     = SPACES
 17210        AND PM-CRED-BENE-ADDR     = SPACES
 17211        AND PM-CRED-BENE-CTYST    = SPACES
 17212        GO TO 3999-UNLOCK-ERMAIL
 17213     END-IF
 17214
 17215     MOVE SPACES                 TO MAILING-DATA.
 17216
 17217     MOVE 'MA'                   TO MA-RECORD-ID.
 17218     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17219     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17220     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17221     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17222     MOVE PB-SV-STATE            TO MA-STATE.
 17223     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17224     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17225
 17226     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17227     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17228
 17229     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 311
* EL050.cbl
 17230        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17231     ELSE
 17232        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17233        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17234        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17235
 17236     GO TO 9990-RETURN.
 17237
 17238 3999-UNLOCK-ERMAIL.
 17239     IF ERMAIL-FOUND = ' '
 17240        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17241
 17242     GO TO 9990-RETURN.
 17243******************************************************************
 17244
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 312
* EL050.cbl
 17246 4000-UPDATE-CANCELLED-CERT.
 17247     IF CERT-WAS-NOT-FOUND
 17248        GO TO 4299-EXIT.
 17249
 17250*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17251     IF PB-C-NH-INT-ON-REFS > ZEROS
 17252        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17253     END-IF
 17254     IF PB-C-REF-INTERFACE-SW = 'Y'
 17255        MOVE PB-C-REF-INTERFACE-SW
 17256                                 TO CM-NH-INTERFACE-SW
 17257     END-IF
 17258     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17259     IF ERMAIL-FOUND = 'X'
 17260        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17261        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17262        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17263        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17264           MOVE ER-2694          TO WS-ERROR
 17265           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17266     END-IF
 17267
 17268     IF PB-C-POST-CARD-IND = 'Y'
 17269        MOVE +8                  TO SUB
 17270*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17271        IF ERMAIL-FOUND = ' '
 17272           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17273              (SUB > +7)
 17274              OR (MA-MAIL-STATUS (SUB) = '1')
 17275           END-PERFORM
 17276        END-IF
 17277        IF (SUB > +7)
 17278           OR (ERMAIL-FOUND = 'X')
 17279           MOVE ER-3789          TO WS-ERROR
 17280           PERFORM 9900-ERROR-FORMAT
 17281                                 THRU 9900-EXIT
 17282        END-IF
 17283     ELSE
 17284        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17285     END-IF
 17286
 17287     IF ERMAIL-FOUND = ' '
 17288        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17289     END-IF.
 17290
 17291     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17292
 17293     IF PB-CI-OB-FLAG = 'Z'
 17294        GO TO 4150-SUMMARY-CERT-CANCEL.
 17295
 17296     IF PB-C-LF-CANCEL-VOIDED
 17297         PERFORM 4200-REVERSE-LF-CANCEL.
 17298     IF PB-C-AH-CANCEL-VOIDED
 17299         PERFORM 4200-REVERSE-AH-CANCEL.
 17300
 17301 4100-APPLY-LF-CANCEL.
 17302
 17303     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 313
* EL050.cbl
 17304
 17305 4100-CHECK-LF-ERRORS.
 17306
 17307     ADD +1                       TO WS-SUB.
 17308
 17309     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17310        IF LF-COVERAGE-CANCELLED
 17311           GO TO 4100-LF-CANCEL-CONT
 17312        ELSE
 17313           GO TO 4100-UPDATE-LF-COVERAGE.
 17314
 17315     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17316                                   ER-2729 OR
 17317                                   ER-2730 OR
 17318                                   ER-2731 OR
 17319                                   ER-2732 OR
 17320                                   ER-2737 OR
 17321                                   ER-2740 OR
 17322                                   ER-2743 OR
 17323                                   ER-2749 OR
 17324                                   ER-2750 OR
 17325                                   ER-2755 OR
 17326                                   ER-2757 OR
 17327                                   ER-2760 OR
 17328                                   ER-2772 OR
 17329                                   ER-2774 OR
 17330                                   ER-2776 OR
 17331                                   ER-2794
 17332        GO TO 4100-UPDATE-LF-COVERAGE.
 17333
 17334     GO TO 4100-CHECK-LF-ERRORS.
 17335
 17336 4100-UPDATE-LF-COVERAGE.
 17337
 17338     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17339     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17340     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17341        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17342     END-IF
 17343     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17344                                      TO CM-CREDIT-INTERFACE-SW-2.
 17345     IF CM-LF-CANCEL-DT = LOW-VALUE
 17346         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17347
 17348     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17349         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17350                                         CM-LF-STATUS-AT-CANCEL.
 17351
 17352     GO TO 4100-APPLY-AH-CANCEL.
 17353
 17354 4100-LF-CANCEL-CONT.
 17355     IF PB-C-LF-CANCEL-VOIDED
 17356         GO TO 4100-APPLY-AH-CANCEL.
 17357
 17358     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17359         GO TO 4100-APPLY-AH-CANCEL.
 17360
 17361     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 314
* EL050.cbl
 17362        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17363           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17364        ELSE
 17365           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17366
 17367     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17368     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17369
 17370     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17371         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17372
 17373     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17374        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17375         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17376         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17377
 17378     IF PB-RECORD-RETURNED
 17379        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17380      ELSE
 17381        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17382
 17383 4100-APPLY-AH-CANCEL.
 17384
 17385     MOVE +0                      TO WS-SUB.
 17386
 17387 4100-CHECK-AH-ERRORS.
 17388
 17389     ADD +1                       TO WS-SUB.
 17390
 17391     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17392        IF AH-COVERAGE-CANCELLED
 17393           GO TO 4100-AH-CANCEL-CONT
 17394        ELSE
 17395           GO TO 4100-UPDATE-AH-COVERAGE.
 17396
 17397     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17398                                   ER-2729 OR
 17399                                   ER-2732 OR
 17400                                   ER-2737 OR
 17401                                   ER-2740 OR
 17402                                   ER-2744 OR
 17403                                   ER-2749 OR
 17404                                   ER-2750 OR
 17405                                   ER-2755 OR
 17406                                   ER-2757 OR
 17407                                   ER-2760 OR
 17408                                   ER-2771 OR
 17409                                   ER-2772 OR
 17410                                   ER-2773 OR
 17411                                   ER-2775 OR
 17412                                   ER-2777 OR
 17413                                   ER-2778 OR
 17414                                   ER-2794
 17415        GO TO 4100-UPDATE-AH-COVERAGE.
 17416
 17417     GO TO 4100-CHECK-AH-ERRORS.
 17418
 17419 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 315
* EL050.cbl
 17420
 17421     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17422     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17423     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17424     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17425                                      TO CM-CREDIT-INTERFACE-SW-2.
 17426     IF CM-AH-CANCEL-DT = LOW-VALUE
 17427         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17428
 17429     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17430         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17431                                         CM-AH-STATUS-AT-CANCEL.
 17432
 17433     IF LF-COVERAGE-CANCELLED
 17434         IF PB-RECORD-RETURNED
 17435              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17436          ELSE
 17437              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17438
 17439     GO TO 4299-EXIT.
 17440
 17441 4100-AH-CANCEL-CONT.
 17442     IF PB-C-AH-CANCEL-VOIDED
 17443         GO TO 4299-EXIT.
 17444
 17445     if cm-credit-interface-sw-2 = ' '
 17446        if pb-fatal-errors or pb-unforced-errors
 17447           move '4'              to cm-credit-interface-sw-2
 17448        else
 17449           move '1'              to cm-credit-interface-sw-2
 17450        end-if
 17451     end-if
 17452     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17453         GO TO 4299-EXIT.
 17454
 17455     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17456        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17457           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17458        ELSE
 17459           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17460
 17461     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17462     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17463
 17464     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17465         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17466
 17467     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17468         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17469         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17470
 17471     IF PB-RECORD-RETURNED
 17472        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17473      ELSE
 17474        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17475
 17476     GO TO 4299-EXIT.
 17477
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 316
* EL050.cbl
 17478 4150-SUMMARY-CERT-CANCEL.
 17479     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17480
 17481     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17482        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17483                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17484     ELSE
 17485        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17486                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17487
 17488     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17489        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17490                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17491     ELSE
 17492        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17493                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17494
 17495     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17496        NEXT SENTENCE
 17497     ELSE
 17498        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17499
 17500     GO TO 4299-EXIT.
 17501
 17502 4200-REVERSE-LF-CANCEL.
 17503     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17504
 17505     IF CM-LF-CANCEL-APPLIED
 17506        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17507        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17508        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17509
 17510     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17511
 17512     IF PB-RECORD-RETURNED
 17513        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17514       ELSE
 17515        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17516
 17517 4200-REVERSE-LF-EXIT.
 17518       EXIT.
 17519
 17520 4200-REVERSE-AH-CANCEL.
 17521     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17522
 17523     IF CM-AH-CANCEL-APPLIED
 17524        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17525        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17526        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17527
 17528     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17529
 17530     IF PB-RECORD-RETURNED
 17531        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17532       ELSE
 17533        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17534
 17535 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 317
* EL050.cbl
 17536       EXIT.
 17537
 17538 4299-EXIT.
 17539       EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 318
* EL050.cbl
 17541
 17542 4500-UPDATE-NEW-CERT.
 17543     IF CERT-WAS-FOUND
 17544         NEXT SENTENCE
 17545       ELSE
 17546         GO TO 4520-BUILD-NEW-KEY.
 17547
 17548     IF  CLASIC-CREATED-CERT
 17549         GO TO 4999-EXIT.
 17550
 17551     IF  CERT-WAS-CREATED-FOR-CLAIM
 17552         GO TO 4520-BUILD-NEW-KEY.
 17553
 17554     IF CERT-ADDED-BATCH
 17555        IF CM-RECORD-ID = 'CM'
 17556            GO TO 4999-EXIT.
 17557
 17558 4520-BUILD-NEW-KEY.
 17559* BUILD CONTROL PRIMARY
 17560
 17561     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17562                                       CM-COMPANY-CD-A1
 17563                                       CM-COMPANY-CD-A2
 17564                                       CM-COMPANY-CD-A4
 17565                                       CM-COMPANY-CD-A5.
 17566
 17567     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17568     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17569     MOVE PB-SV-STATE               TO CM-STATE.
 17570     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17571     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17572     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17573     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17574
 17575     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17576
 17577     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17578     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17579     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17580     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17581
 17582     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17583        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17584
 17585     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17586         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17587         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17588         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17589         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17590     ELSE
 17591         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17592
 17593     IF PB-COMPANY-ID   EQUAL  'CRI'
 17594         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17595         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17596         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17597         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17598         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 319
* EL050.cbl
 17599
 17600     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17601        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17602         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17603
 17604     IF PB-COMPANY-ID  = 'LBL'
 17605        IF PB-I-JOINT-COVERAGE
 17606            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17607                                           PB-I-MEMBER-NO
 17608            GO TO 4550-CONT-CERT-PROCESS.
 17609
 17610     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17611        NEXT SENTENCE
 17612     ELSE
 17613        GO TO 4540-BUILD-MEMBER-NO.
 17614
 17615******************************************************************
 17616*                                                                *
 17617*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17618*    FOR 'MON'.                                                  *
 17619*                                                                *
 17620******************************************************************
 17621
 17622     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17623     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17624     MOVE +1                     TO WS-SUB1
 17625                                    WS-SUB2.
 17626
 17627 4530-EDIT-MEMB-NAME.
 17628
 17629     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17630        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17631        ADD +1                       TO WS-SUB2.
 17632
 17633     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17634        ADD +1                       TO WS-SUB1
 17635        GO TO 4530-EDIT-MEMB-NAME.
 17636
 17637     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17638     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17639     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17640*    MOVE SPACE                      TO DC-OPTION-CODE.
 17641     SET  BIN-TO-GREG                TO TRUE.
 17642     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17643     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17644
 17645     GO TO 4550-CONT-CERT-PROCESS.
 17646
 17647******************************************************************
 17648*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17649******************************************************************
 17650
 17651 4540-BUILD-MEMBER-NO.
 17652
 17653     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17654         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17655         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17656         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 320
* EL050.cbl
 17657         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17658     ELSE
 17659         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17660
 17661     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17662        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17663         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17664
 17665 4550-CONT-CERT-PROCESS.
 17666
 17667*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17668*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17669*    ELSE
 17670*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17671
 17672     IF CERT-WAS-CREATED-FOR-CLAIM
 17673        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17674        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17675
 17676     IF CERT-AND-CLAIM-ONLINE
 17677        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17678        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17679
 17680     MOVE 'CM'                     TO CM-RECORD-ID.
 17681     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17682
 17683     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17684        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17685        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17686     ELSE
 17687        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17688        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17689
 17690     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17691     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17692     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17693     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17694     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17695     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17696     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17697                                      CM-LF-ITD-CANCEL-AMT
 17698                                      CM-LF-ITD-DEATH-AMT
 17699                                      CM-AH-ITD-AH-PMT
 17700                                      CM-AH-ITD-LUMP-PMT
 17701                                      CM-AH-ITD-CANCEL-AMT
 17702                                      CM-LF-NSP-PREMIUM-AMT
 17703                                      CM-AH-NSP-PREMIUM-AMT.
 17704*                                     CM-CLAIM-DEDUCT-WITHHELD
 17705*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17706     if pb-i-loan-apr = +99.9999
 17707        move zeros                 to cm-loan-apr
 17708     else
 17709        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17710     end-if
 17711     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17712     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17713     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17714     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 321
* EL050.cbl
 17715     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17716     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17717     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17718     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17719     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17720     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17721     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17722
 17723     IF PB-I-LIVES NOT NUMERIC
 17724         MOVE ZERO                 TO PB-I-LIVES.
 17725
 17726     IF PB-I-NUM-BILLED NOT NUMERIC
 17727         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17728
 17729     MOVE PB-I-LIVES               TO CM-LIVES.
 17730     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17731
 17732     IF PB-COMPANY-ID EQUAL  'DMD'
 17733         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17734         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17735
 17736     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17737     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17738     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17739     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17740     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17741     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17742
 17743     IF PB-I-LF-POLICY-FEE NUMERIC
 17744        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17745     ELSE
 17746        MOVE +0                    TO CM-LF-POLICY-FEE.
 17747
 17748     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17749        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17750        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17751     ELSE
 17752        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17753
 17754     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17755     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17756     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17757     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17758     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17759     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17760     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17761     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17762     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17763
 17764     IF PB-I-AH-POLICY-FEE NUMERIC
 17765        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17766     ELSE
 17767        MOVE +0                    TO CM-AH-POLICY-FEE.
 17768
 17769     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17770        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17771     ELSE
 17772        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 322
* EL050.cbl
 17773
 17774     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17775     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17776
 17777     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17778                                      CM-LF-DEATH-EXIT-DT
 17779                                      CM-AH-SETTLEMENT-EXIT-DT.
 17780
 17781*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17782*                       'TIH' OR 'OFL' OR 'FLA' OR
 17783*                       'TII' OR 'TMS' OR 'CRI' OR
 17784*                       'NCL'
 17785     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17786
 17787     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17788         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17789            MOVE '2'                TO CM-PREMIUM-TYPE.
 17790
 17791     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17792         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17793            MOVE '2'                TO CM-PREMIUM-TYPE.
 17794
 17795     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17796         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17797     ELSE
 17798         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17799         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17800
 17801     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17802     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17803     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17804     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17805     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17806     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17807     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17808     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17809
 17810     IF PB-NO-MONTHS-SKIPPED
 17811         MOVE SPACE                 TO CM-SKIP-CODE
 17812     ELSE
 17813         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17814
 17815     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17816     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17817                                       CM-LF-STATUS-AT-CANCEL.
 17818
 17819     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17820     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17821                                       CM-AH-STATUS-AT-CANCEL.
 17822
 17823     MOVE '1'                       TO CM-ENTRY-STATUS.
 17824
 17825     IF PB-REISSUED-CERT
 17826        MOVE '5'                    TO CM-ENTRY-STATUS.
 17827
 17828     IF PB-MONTHLY-CERT
 17829        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17830
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 323
* EL050.cbl
 17831     IF PB-CASH-CERT
 17832        MOVE 'C'                    TO CM-ENTRY-STATUS.
 17833
 17834     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17835     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17836     IF PB-POLICY-IS-DECLINED
 17837        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17838
 17839     IF PB-POLICY-IS-VOIDED
 17840        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17841
 17842     IF PB-NEEDS-UNDERWRITING
 17843        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17844
 17845     IF PB-REIN-ONLY-CERT
 17846        MOVE '9'                    TO CM-ENTRY-STATUS.
 17847
 17848     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17849         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17850     ELSE
 17851         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17852
 17853     IF PB-RECORD-RETURNED
 17854        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17855      ELSE
 17856        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17857
 17858     IF PB-I-MAIL-ADDRS-PRESENT
 17859        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17860
 17861     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17862                                       CM-ENTRY-DT.
 17863
 17864 4999-EXIT.
 17865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 324
* EL050.cbl
 17867
 17868 5000-PROCESS-REPS.
 17869     MOVE ' '                    TO AGTC-MASTER-SW
 17870     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17871     MOVE CO-TYPE                TO AGTC-TYPE
 17872     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17873     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17874     IF (AGTC-MASTER-SW NOT = 'N')
 17875        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17876        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17877        PERFORM 8583-READ-ERAGTC-NEXT
 17878                                 THRU 8583-EXIT
 17879     END-IF
 17880     IF AGTC-MASTER-SW = 'N'
 17881        CONTINUE
 17882     ELSE
 17883        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17884           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17885              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17886              MOVE 'Y'           TO AGTC-MASTER-SW
 17887           END-IF
 17888        END-IF
 17889     END-IF
 17890     .
 17891 5000-EXIT.
 17892     EXIT.
 17893 6370-EDIT-INPUT-LF-CODE.
 17894     move ' ' to ws-benefit-cd-chg-sw
 17895     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17896        MOVE +1                  TO SUB
 17897        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17898        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17899        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17900        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17901        GO TO 6370-SEARCH-LOOP.
 17902
 17903     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17904
 17905     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17906     MOVE SPACES                 TO CNTL-ACCESS.
 17907*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17908     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17909     MOVE +0                     TO CNTL-SEQ-NO.
 17910     MOVE '4' TO RC-SW-2.
 17911     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17912
 17913     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17914        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17915        GO TO 6370-NO-LF-FOUND.
 17916
 17917     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17918     MOVE +1                     TO SUB.
 17919
 17920 6370-SEARCH-LOOP.
 17921     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17922         GO TO 6370-NO-LF-FOUND.
 17923
 17924     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 325
* EL050.cbl
 17925        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17926           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17927           set benefit-code-chg to true
 17928        end-if
 17929        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17930        GO TO 6370-HER-NET-PAY-CHECK.
 17931
 17932     ADD 1   TO SUB.
 17933*    IF SUB GREATER 120
 17934     IF SUB GREATER 200
 17935         GO TO 6370-NO-LF-FOUND.
 17936
 17937     GO TO 6370-SEARCH-LOOP.
 17938
 17939 6370-NO-LF-FOUND.
 17940
 17941     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17942        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17943        set benefit-code-chg to true
 17944     end-if
 17945     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17946
 17947 6370-HER-NET-PAY-CHECK.
 17948
 17949     IF PB-COMPANY-ID = 'CID'
 17950        IF PB-SV-STATE = 'CA' OR 'MN'
 17951           IF PB-I-LF-BENEFIT-CD = '02'
 17952              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17953           ELSE
 17954              IF PB-I-LF-BENEFIT-CD = '04'
 17955                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17956              END-IF
 17957           END-IF
 17958        END-IF
 17959     END-IF
 17960
 17961     IF PB-COMPANY-ID NOT = 'HER'
 17962         GO TO 6370-EXIT.
 17963
 17964     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17965         GO TO 6370-EXIT.
 17966
 17967     IF PB-I-LF-TERM NOT NUMERIC
 17968         MOVE ZEROS              TO PB-I-LF-TERM.
 17969
 17970     IF PB-I-LOAN-TERM NOT NUMERIC
 17971         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17972
 17973     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17974         GO TO 6370-EXIT.
 17975
 17976     IF PB-I-LF-BENEFIT-CD = '33'
 17977         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17978
 17979     IF PB-I-LF-BENEFIT-CD = '34'
 17980         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17981
 17982 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 326
* EL050.cbl
 17983     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 327
* EL050.cbl
 17985
 17986 6380-EDIT-INPUT-AH-CODE.
 17987     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17988        MOVE +1                  TO SUB
 17989        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17990        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17991        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17992        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17993        GO TO 6380-SEARCH-LOOP.
 17994
 17995     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17996
 17997     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17998     MOVE SPACES                 TO CNTL-ACCESS.
 17999     MOVE 'A'                    TO CNTL-REC-TYPE.
 18000*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18001     MOVE +0                     TO CNTL-SEQ-NO.
 18002     MOVE '5' TO RC-SW-2.
 18003     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18004
 18005     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18006        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18007        GO TO 6380-NO-AH-FOUND.
 18008
 18009     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18010     MOVE +1 TO SUB.
 18011
 18012 6380-SEARCH-LOOP.
 18013     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18014         GO TO 6380-NO-AH-FOUND.
 18015
 18016     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18017         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18018         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18019
 18020     ADD 1   TO SUB.
 18021     IF SUB GREATER THAN 96
 18022*    IF SUB GREATER THAN 300
 18023         GO TO 6380-NO-AH-FOUND.
 18024
 18025     GO TO 6380-SEARCH-LOOP.
 18026
 18027 6380-NO-AH-FOUND.
 18028
 18029     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18030
 18031     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18032         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18033     ELSE
 18034         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18035
 18036 6380-CSO-AH-ONLY-CHECKS.
 18037
 18038     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18039        NEXT SENTENCE
 18040      ELSE
 18041        GO TO 6380-EXIT.
 18042
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 328
* EL050.cbl
 18043     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18044         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18045
 18046
 18047     GO TO 6380-EXIT
 18048     .
 18049 6380-CSO-LIFE-WITH-AH-CHECKS.
 18050
 18051
 18052     .
 18053 6380-EXIT.
 18054     EXIT.
 18055
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 329
* EL050.cbl
 18057
 18058 6400-COMPUTE-EXTENSION-DAYS.
 18059
 18060******************************************************************
 18061*                                                                *
 18062*                   COMPUTE EXTENSION DAYS                       *
 18063*                                                                *
 18064*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18065*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18066*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18067*    THE EXTENSION DAYS.                                         *
 18068*                                                                *
 18069******************************************************************
 18070
 18071     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18072     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18073
 18074******************************************************************
 18075*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18076*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18077******************************************************************
 18078
 18079     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18080        COMPUTE WS-ODD-DAYS-OVER =
 18081               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18082     ELSE
 18083        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18084
 18085     IF WS-ODD-DAYS-OVER = ZEROS
 18086           GO TO 6499-EXIT
 18087     ELSE
 18088        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18089           IF WS-WDF-MONTH = 02
 18090              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18091              ADD 2       TO  WS-ODD-DAYS-OVER
 18092              GO TO 6499-EXIT
 18093           ELSE
 18094              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18095                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18096                 GO TO 6499-EXIT
 18097               ELSE
 18098                 GO TO 6499-EXIT
 18099        ELSE
 18100           GO TO 6499-EXIT.
 18101
 18102 6412-CHECK-TO-DAY.
 18103
 18104        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18105           IF WS-WDT-DAY = 28
 18106              ADD 2              TO WS-ODD-DAYS-OVER
 18107           ELSE
 18108              IF WS-WDT-DAY = 29
 18109                 ADD 1           TO WS-ODD-DAYS-OVER
 18110              ELSE
 18111                 NEXT SENTENCE
 18112        ELSE
 18113           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18114              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 330
* EL050.cbl
 18115
 18116     GO TO 6499-EXIT.
 18117
 18118
 18119 6415-CHECK-LEAP-YEAR.
 18120
 18121     IF DC-DAYS-IN-MONTH = 29
 18122        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18123
 18124 6415-EXIT.
 18125     EXIT.
 18126
 18127 6499-EXIT.
 18128      EXIT.
 18129
 18130 6500-END.
 18131     EXIT.
 18132
 18133
 18134******************************************************************
 18135************* PROCEDURE DIVISION FOR EL050 ***********************
 18136********************** ELC50PD END *******************************
 18137
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 331
* EL050.cbl
 18139
 18140**START***********************************************************
 18141*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18142*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18143******************************************************************
 18144*
 18145 6600-GET-STATE-MUNICIPAL-TAX.
 18146
 18147     IF PB-COMPANY-ID NOT = 'DMD'
 18148         GO TO 6640-EXIT.
 18149
 18150     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18151     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18152     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18153*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18154*
 18155***  Y2K PROJ 7744
 18156     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18157     SET BIN-TO-GREG          TO TRUE.
 18158     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18159
 18160     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18161
 18162     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18163     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18164
 18165
 18166* EXEC CICS HANDLE CONDITION
 18167*        INVREQ    (6610-START-BROWSE)
 18168*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18169*        NOTFND    (6630-END-OF-FILE)
 18170*    END-EXEC.
 18171*    MOVE '"$8JI                 ! # #00018153' TO DFHEIV0
 18172     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18174     MOVE X'2320233030303138313533' TO DFHEIV0(25:11)
 18175     CALL 'kxdfhei1' USING DFHEIV0
 18176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18177
 18178
 18179 6610-START-BROWSE.
 18180
 18181
 18182* EXEC CICS HANDLE CONDITION
 18183*        NOTFND    (6630-END-OF-FILE)
 18184*        DISABLED  (6630-ERRESS-PROBLEM)
 18185*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18186*        ENDFILE   (6630-END-OF-FILE)
 18187*    END-EXEC.
 18188*    MOVE '"$IcJ''                ! $ #00018161' TO DFHEIV0
 18189     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18191     MOVE X'2420233030303138313631' TO DFHEIV0(25:11)
 18192     CALL 'kxdfhei1' USING DFHEIV0
 18193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18194
 18195
 18196
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 332
* EL050.cbl
 18197* EXEC CICS STARTBR
 18198*        DATASET (FILE-ID-ERRESS)
 18199*        RIDFLD  (WS-ERRESS-KEY)
 18200*        GTEQ
 18201*    END-EXEC.
 18202     MOVE 0
 18203       TO DFHEIV11
 18204*    MOVE '&,         G          &   #00018168' TO DFHEIV0
 18205     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18206     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18207     MOVE X'2020233030303138313638' TO DFHEIV0(25:11)
 18208     CALL 'kxdfhei1' USING DFHEIV0,
 18209           FILE-ID-ERRESS,
 18210           WS-ERRESS-KEY,
 18211           DFHEIV99,
 18212           DFHEIV11,
 18213           DFHEIV99
 18214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18215
 18216
 18217 6620-READ-NEXT-ERRESS-MASTER.
 18218
 18219
 18220* EXEC CICS HANDLE CONDITION
 18221*        NOTFND    (6630-END-OF-FILE)
 18222*        ENDFILE   (6630-END-OF-FILE)
 18223*        DISABLED  (6630-ERRESS-PROBLEM)
 18224*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18225*    END-EXEC.
 18226*    MOVE '"$I''cJ                ! % #00018176' TO DFHEIV0
 18227     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18229     MOVE X'2520233030303138313736' TO DFHEIV0(25:11)
 18230     CALL 'kxdfhei1' USING DFHEIV0
 18231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18232
 18233
 18234
 18235* EXEC CICS READNEXT
 18236*        DATASET (FILE-ID-ERRESS)
 18237*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18238*        RIDFLD  (WS-ERRESS-KEY)
 18239*    END-EXEC.
 18240     MOVE LENGTH OF
 18241      RESIDENT-STATE-TAX-MASTER
 18242       TO DFHEIV12
 18243     MOVE 0
 18244       TO DFHEIV11
 18245*    MOVE '&.IL                  )   #00018183' TO DFHEIV0
 18246     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18247     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18248     MOVE X'2020233030303138313833' TO DFHEIV0(25:11)
 18249     CALL 'kxdfhei1' USING DFHEIV0,
 18250           FILE-ID-ERRESS,
 18251           RESIDENT-STATE-TAX-MASTER,
 18252           DFHEIV12,
 18253           WS-ERRESS-KEY,
 18254           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 333
* EL050.cbl
 18255           DFHEIV11,
 18256           DFHEIV99,
 18257           DFHEIV99
 18258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18259
 18260
 18261     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18262
 18263* EXEC CICS ENDBR
 18264*            DATASET (FILE-ID-ERRESS)
 18265*       END-EXEC
 18266     MOVE 0
 18267       TO DFHEIV11
 18268*    MOVE '&2                    $   #00018190' TO DFHEIV0
 18269     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18270     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18271     MOVE X'2020233030303138313930' TO DFHEIV0(25:11)
 18272     CALL 'kxdfhei1' USING DFHEIV0,
 18273           FILE-ID-ERRESS,
 18274           DFHEIV11,
 18275           DFHEIV99
 18276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18277        GO TO 6630-END-OF-FILE.
 18278
 18279     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18280        NEXT SENTENCE
 18281      ELSE
 18282        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18283
 18284*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18285*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18286*
 18287     MOVE +2                     TO WS-SUB1.
 18288
 18289     IF PB-ISSUE
 18290     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18291        MOVE +1                  TO WS-SUB1.
 18292
 18293     IF PB-CANCELLATION
 18294     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18295        MOVE +1                  TO WS-SUB1.
 18296*
 18297*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18298*
 18299***  Y2K PROJ 7744
 18300     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18301***  Y2K PROJ 7744
 18302
 18303*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18304* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18305* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18306
 18307     ADD 1                    TO WS-YEAR-YY.
 18308
 18309     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18310         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18311                              TO WS-RES-STATE-TAX
 18312         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 334
* EL050.cbl
 18313                              TO WS-RES-MUNI-TAX
 18314     ELSE
 18315         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18316                              TO WS-RES-STATE-TAX
 18317         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18318                              TO WS-RES-MUNI-TAX.
 18319
 18320*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18321
 18322     IF PB-CANCELLATION
 18323         GO TO 6640-CANCEL-TAX.
 18324
 18325     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18326         COMPUTE PB-I-STATE-TAX ROUNDED =
 18327                                   PB-I-LF-PREMIUM-AMT
 18328                                 * WS-RES-STATE-TAX
 18329         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18330                                   PB-I-LF-PREMIUM-AMT
 18331                                 * WS-RES-MUNI-TAX
 18332     ELSE
 18333     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18334         COMPUTE PB-I-STATE-TAX ROUNDED =
 18335                                   PB-I-AH-PREMIUM-AMT
 18336                                 * WS-RES-STATE-TAX
 18337         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18338                                   PB-I-AH-PREMIUM-AMT
 18339                                 * WS-RES-MUNI-TAX.
 18340
 18341
 18342* EXEC CICS ENDBR
 18343*         DATASET (FILE-ID-ERRESS)
 18344*    END-EXEC.
 18345     MOVE 0
 18346       TO DFHEIV11
 18347*    MOVE '&2                    $   #00018257' TO DFHEIV0
 18348     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18350     MOVE X'2020233030303138323537' TO DFHEIV0(25:11)
 18351     CALL 'kxdfhei1' USING DFHEIV0,
 18352           FILE-ID-ERRESS,
 18353           DFHEIV11,
 18354           DFHEIV99
 18355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18356
 18357
 18358     GO TO 6640-EXIT.
 18359
 18360 6640-CANCEL-TAX.
 18361     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18362
 18363     IF PB-C-LF-CANCEL-AMT > ZEROS
 18364         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18365                                   PB-C-LF-CANCEL-AMT
 18366                                 * WS-RES-STATE-TAX
 18367         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18368                                   PB-C-LF-CANCEL-AMT
 18369                                *  WS-RES-MUNI-TAX
 18370     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 335
* EL050.cbl
 18371     IF PB-C-AH-CANCEL-AMT > ZEROS
 18372         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18373                                   PB-C-AH-CANCEL-AMT
 18374                                 * WS-RES-STATE-TAX
 18375         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18376                                   PB-C-AH-CANCEL-AMT
 18377                                *  WS-RES-MUNI-TAX.
 18378
 18379
 18380* EXEC CICS ENDBR
 18381*         DATASET (FILE-ID-ERRESS)
 18382*    END-EXEC.
 18383     MOVE 0
 18384       TO DFHEIV11
 18385*    MOVE '&2                    $   #00018282' TO DFHEIV0
 18386     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18387     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18388     MOVE X'2020233030303138323832' TO DFHEIV0(25:11)
 18389     CALL 'kxdfhei1' USING DFHEIV0,
 18390           FILE-ID-ERRESS,
 18391           DFHEIV11,
 18392           DFHEIV99
 18393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18394
 18395
 18396     GO TO 6640-EXIT.
 18397
 18398 6630-END-OF-FILE.
 18399     MOVE ER-8002              TO WS-ERROR.
 18400     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18401
 18402     GO TO 6640-EXIT.
 18403
 18404 6630-ERRESS-PROBLEM.
 18405     MOVE ER-8044              TO WS-ERROR.
 18406     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18407
 18408 6640-EXIT.
 18409     EXIT.
 18410
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 336
* EL050.cbl
 18412 6650-GET-RES-STATE-COMM.
 18413
 18414     IF PB-COMPANY-ID NOT = 'DMD'
 18415         GO TO 6700-COMM-EXIT.
 18416
 18417     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18418     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18419     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18420     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18421     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18422     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18423     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18424
 18425*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18426*
 18427***  Y2K PROJ 7744
 18428     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18429     SET BIN-TO-GREG          TO TRUE.
 18430     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18431
 18432     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18433***  Y2K PROJ 7744
 18434
 18435     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18436
 18437
 18438* EXEC CICS HANDLE CONDITION
 18439*        INVREQ    (6660-START-BROWSE)
 18440*        DISABLED  (6690-ERRESC-PROBLEM)
 18441*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18442*        NOTFND    (6690-END-OF-FILE)
 18443*    END-EXEC.
 18444*    MOVE '"$8cJI                ! & #00018327' TO DFHEIV0
 18445     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18447     MOVE X'2620233030303138333237' TO DFHEIV0(25:11)
 18448     CALL 'kxdfhei1' USING DFHEIV0
 18449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18450
 18451
 18452
 18453* EXEC CICS RESETBR
 18454*        DATASET (FILE-ID-ERRESC)
 18455*        RIDFLD  (WS-ERRESC-KEY)
 18456*    END-EXEC.
 18457     MOVE 0
 18458       TO DFHEIV11
 18459*    MOVE '&4         G          &   #00018334' TO DFHEIV0
 18460     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18461     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18462     MOVE X'2020233030303138333334' TO DFHEIV0(25:11)
 18463     CALL 'kxdfhei1' USING DFHEIV0,
 18464           FILE-ID-ERRESC,
 18465           WS-ERRESC-KEY,
 18466           DFHEIV99,
 18467           DFHEIV11,
 18468           DFHEIV99
 18469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 337
* EL050.cbl
 18470
 18471
 18472 6660-START-BROWSE.
 18473
 18474
 18475* EXEC CICS HANDLE CONDITION
 18476*        NOTFND    (6690-END-OF-FILE)
 18477*        DISABLED  (6690-ERRESC-PROBLEM)
 18478*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18479*        ENDFILE   (6690-END-OF-FILE)
 18480*    END-EXEC.
 18481*    MOVE '"$IcJ''                ! '' #00018341' TO DFHEIV0
 18482     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18484     MOVE X'2720233030303138333431' TO DFHEIV0(25:11)
 18485     CALL 'kxdfhei1' USING DFHEIV0
 18486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18487
 18488
 18489
 18490* EXEC CICS STARTBR
 18491*        DATASET (FILE-ID-ERRESC)
 18492*        RIDFLD  (WS-ERRESC-KEY)
 18493*        GTEQ
 18494*    END-EXEC.
 18495     MOVE 0
 18496       TO DFHEIV11
 18497*    MOVE '&,         G          &   #00018348' TO DFHEIV0
 18498     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18499     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18500     MOVE X'2020233030303138333438' TO DFHEIV0(25:11)
 18501     CALL 'kxdfhei1' USING DFHEIV0,
 18502           FILE-ID-ERRESC,
 18503           WS-ERRESC-KEY,
 18504           DFHEIV99,
 18505           DFHEIV11,
 18506           DFHEIV99
 18507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18508
 18509
 18510     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18511
 18512 6670-READ-NEXT-ERRESC-MASTER.
 18513
 18514
 18515* EXEC CICS HANDLE CONDITION
 18516*        NOTFND    (6690-END-OF-FILE)
 18517*        DISABLED  (6690-ERRESC-PROBLEM)
 18518*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18519*        ENDFILE   (6690-END-OF-FILE)
 18520*    END-EXEC.
 18521*    MOVE '"$IcJ''                ! ( #00018358' TO DFHEIV0
 18522     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18523     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18524     MOVE X'2820233030303138333538' TO DFHEIV0(25:11)
 18525     CALL 'kxdfhei1' USING DFHEIV0
 18526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18527
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 338
* EL050.cbl
 18528
 18529
 18530* EXEC CICS READNEXT
 18531*        DATASET (FILE-ID-ERRESC)
 18532*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18533*        RIDFLD  (ERRESC-RECORD-KEY)
 18534*    END-EXEC.
 18535     MOVE LENGTH OF
 18536      ACCOUNT-RESIDENT-ST-COMMISSION
 18537       TO DFHEIV12
 18538     MOVE 0
 18539       TO DFHEIV11
 18540*    MOVE '&.IL                  )   #00018365' TO DFHEIV0
 18541     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18542     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18543     MOVE X'2020233030303138333635' TO DFHEIV0(25:11)
 18544     CALL 'kxdfhei1' USING DFHEIV0,
 18545           FILE-ID-ERRESC,
 18546           ACCOUNT-RESIDENT-ST-COMMISSION,
 18547           DFHEIV12,
 18548           ERRESC-RECORD-KEY,
 18549           DFHEIV99,
 18550           DFHEIV11,
 18551           DFHEIV99,
 18552           DFHEIV99
 18553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18554
 18555
 18556     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18557        NEXT SENTENCE
 18558     ELSE
 18559
 18560* EXEC CICS ENDBR
 18561*            DATASET (FILE-ID-ERRESC)
 18562*       END-EXEC
 18563     MOVE 0
 18564       TO DFHEIV11
 18565*    MOVE '&2                    $   #00018374' TO DFHEIV0
 18566     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18567     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18568     MOVE X'2020233030303138333734' TO DFHEIV0(25:11)
 18569     CALL 'kxdfhei1' USING DFHEIV0,
 18570           FILE-ID-ERRESC,
 18571           DFHEIV11,
 18572           DFHEIV99
 18573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18574        GO TO 6690-END-OF-FILE.
 18575
 18576     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18577
 18578* EXEC CICS ENDBR
 18579*            DATASET (FILE-ID-ERRESC)
 18580*       END-EXEC
 18581     MOVE 0
 18582       TO DFHEIV11
 18583*    MOVE '&2                    $   #00018380' TO DFHEIV0
 18584     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18585     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 339
* EL050.cbl
 18586     MOVE X'2020233030303138333830' TO DFHEIV0(25:11)
 18587     CALL 'kxdfhei1' USING DFHEIV0,
 18588           FILE-ID-ERRESC,
 18589           DFHEIV11,
 18590           DFHEIV99
 18591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18592        GO TO 6690-END-OF-FILE.
 18593
 18594     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18595        NEXT SENTENCE
 18596      ELSE
 18597        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18598
 18599* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18600*
 18601     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18602
 18603     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18604
 18605     IF WS-SUB1 > ZERO
 18606         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18607             PERFORM 6680-SET-COMMISSION
 18608         ELSE
 18609             PERFORM 6680-SET-TABLE-CODE.
 18610
 18611
 18612* EXEC CICS ENDBR
 18613*         DATASET (FILE-ID-ERRESC)
 18614*    END-EXEC.
 18615     MOVE 0
 18616       TO DFHEIV11
 18617*    MOVE '&2                    $   #00018402' TO DFHEIV0
 18618     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18619     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18620     MOVE X'2020233030303138343032' TO DFHEIV0(25:11)
 18621     CALL 'kxdfhei1' USING DFHEIV0,
 18622           FILE-ID-ERRESC,
 18623           DFHEIV11,
 18624           DFHEIV99
 18625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18626
 18627
 18628     GO TO 6700-COMM-EXIT.
 18629
 18630 6680-SET-TABLE-CODE.
 18631     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18632        MOVE ZEROS             TO WS-SUB1
 18633     ELSE
 18634* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18635* TO COMPUTE AH COMMISSION.
 18636        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18637        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18638        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18639        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18640        PERFORM 6680-READ-CTBL-TABLE
 18641        IF WS-CTBL-READ-SW NOT = 'Y'
 18642           MOVE ZEROS          TO WS-SUB1.
 18643
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 340
* EL050.cbl
 18644 6680-READ-CTBL-TABLE.
 18645*
 18646* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18647* TO COMPUTE LIFE COMMISSION
 18648
 18649     IF CTBL-SW = '0540'
 18650        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18651        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18652        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18653
 18654     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18655
 18656     IF CTBL-TABLE-FOUND
 18657        IF CTBL-SW = '0530'
 18658             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18659                                    * PB-I-AH-TERM
 18660             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18661             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18662        ELSE
 18663             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18664             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18665             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18666     ELSE
 18667        IF FIRST-TIME-THROUGH
 18668            GO TO 6680-READ-CTBL-TABLE
 18669        ELSE
 18670            MOVE ZEROS         TO WS-SUB1.
 18671
 18672 6680-SET-COMMISSION.
 18673     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18674           MOVE ZEROS          TO WS-SUB1
 18675       ELSE
 18676           MOVE RESC-COMMISSION-PER (WS-SUB)
 18677                               TO WS-COMMISSION
 18678           IF CTBL-SW = '0530'
 18679               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18680           ELSE
 18681               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18682
 18683 6680-SEARCH-CATEGORY.
 18684     ADD +1                   TO WS-SUB.
 18685     IF WS-SUB > +12
 18686         GO TO 6680-EXIT.
 18687
 18688     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18689          MOVE WS-SUB         TO WS-SUB1
 18690          GO TO 6680-EXIT.
 18691
 18692     GO TO 6680-SEARCH-CATEGORY.
 18693
 18694 6680-EXIT.
 18695     EXIT.
 18696
 18697 6690-END-OF-FILE.
 18698     GO TO 6700-COMM-EXIT.
 18699
 18700 6690-ERRESC-PROBLEM.
 18701      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 341
* EL050.cbl
 18702      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18703
 18704      GO TO 6700-COMM-EXIT.
 18705
 18706 6700-COMM-EXIT.
 18707     EXIT.
 18708
 18709 7000-GET-RATE.
 18710
 18711* EXEC CICS LINK
 18712*        PROGRAM    ('ELRATE')
 18713*        COMMAREA   (CALCULATION-PASS-AREA)
 18714*        LENGTH     (CP-COMM-LENGTH)
 18715*    END-EXEC.
 18716     MOVE 'ELRATE' TO DFHEIV1
 18717*    MOVE '."C                   (   #00018488' TO DFHEIV0
 18718     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18719     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18720     MOVE X'2020233030303138343838' TO DFHEIV0(25:11)
 18721     CALL 'kxdfhei1' USING DFHEIV0,
 18722           DFHEIV1,
 18723           CALCULATION-PASS-AREA,
 18724           CP-COMM-LENGTH,
 18725           DFHEIV99,
 18726           DFHEIV99,
 18727           DFHEIV99,
 18728           DFHEIV99
 18729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18730
 18731
 18732 7000-EXIT.
 18733     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 342
* EL050.cbl
 18735 7100-FIND-BENEFIT-IN-STATE.
 18736     MOVE 'N'                    TO BEN-SEARCH-SW.
 18737
 18738     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18739         VARYING SUB3 FROM 1 BY 1 UNTIL
 18740            ((SUB3 GREATER 50) OR
 18741              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18742               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18743
 18744     IF SUB3 NOT = 51
 18745         MOVE 'Y'                TO BEN-SEARCH-SW.
 18746
 18747     GO TO 7199-EXIT.
 18748
 18749 7100-BENEFIT-DUMMY.
 18750
 18751 7100-DUMMY-EXIT.
 18752     EXIT.
 18753
 18754 7199-EXIT.
 18755     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 343
* EL050.cbl
 18757 7200-FIND-BENEFIT.
 18758     MOVE 'N'                    TO BEN-SEARCH-SW.
 18759
 18760     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18761         VARYING SUB3 FROM 1 BY 1 UNTIL
 18762            ((SUB3 GREATER 8) OR
 18763            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18764
 18765     IF SUB3 NOT = 9
 18766         MOVE 'Y'                TO BEN-SEARCH-SW.
 18767
 18768     GO TO 7200-EXIT.
 18769
 18770 7200-BENEFIT-DUMMY.
 18771
 18772 7200-DUMMY-EXIT.
 18773     EXIT.
 18774
 18775 7200-EXIT.
 18776     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 344
* EL050.cbl
 18778 7250-LOOK-FOR-RESCINDED-CLAIM.
 18779     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18780                                    W-CL-COMP-CD.
 18781     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18782                                    W-CL-CERT-NO.
 18783
 18784
 18785* EXEC CICS HANDLE CONDITION
 18786*        NOTFND  (7250-CONTINUE)
 18787*        ENDFILE (7250-CONTINUE)
 18788*    END-EXEC.
 18789*    MOVE '"$I''                  ! ) #00018546' TO DFHEIV0
 18790     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18792     MOVE X'2920233030303138353436' TO DFHEIV0(25:11)
 18793     CALL 'kxdfhei1' USING DFHEIV0
 18794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18795
 18796
 18797
 18798* EXEC CICS IGNORE CONDITION
 18799*        DUPKEY
 18800*    END-EXEC.
 18801*    MOVE '"*$                   !   #00018551' TO DFHEIV0
 18802     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18804     MOVE X'2020233030303138353531' TO DFHEIV0(25:11)
 18805     CALL 'kxdfhei1' USING DFHEIV0
 18806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18807
 18808
 18809
 18810* EXEC CICS STARTBR
 18811*        DATASET   (CLMS-ID)
 18812*        RIDFLD    (ELMSTR-KEY)
 18813*        GENERIC   EQUAL
 18814*        KEYLENGTH (ELMSTR-LENGTH)
 18815*    END-EXEC.
 18816     MOVE 0
 18817       TO DFHEIV11
 18818*    MOVE '&,   KG    E          &   #00018555' TO DFHEIV0
 18819     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18820     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18821     MOVE X'2020233030303138353535' TO DFHEIV0(25:11)
 18822     CALL 'kxdfhei1' USING DFHEIV0,
 18823           CLMS-ID,
 18824           ELMSTR-KEY,
 18825           ELMSTR-LENGTH,
 18826           DFHEIV11,
 18827           DFHEIV99
 18828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18829
 18830
 18831     MOVE 'Y'                    TO W-BROWSE-SW.
 18832
 18833 7250-NEXT-CLAIM.
 18834
 18835
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 345
* EL050.cbl
 18836* EXEC CICS READNEXT
 18837*        DATASET   (CLMS-ID)
 18838*        RIDFLD    (ELMSTR-KEY)
 18839*        SET       (ADDRESS OF CLAIM-MASTER)
 18840*    END-EXEC.
 18841     MOVE 0
 18842       TO DFHEIV11
 18843*    MOVE '&.S                   )   #00018566' TO DFHEIV0
 18844     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18845     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18846     MOVE X'2020233030303138353636' TO DFHEIV0(25:11)
 18847     CALL 'kxdfhei1' USING DFHEIV0,
 18848           CLMS-ID,
 18849           DFHEIV20,
 18850           DFHEIV99,
 18851           ELMSTR-KEY,
 18852           DFHEIV99,
 18853           DFHEIV11,
 18854           DFHEIV99,
 18855           DFHEIV99
 18856     SET ADDRESS OF CLAIM-MASTER TO
 18857         DFHEIV20
 18858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18859
 18860
 18861     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18862        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18863         GO TO 7250-CONTINUE
 18864     END-IF.
 18865
 18866     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18867        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18868        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18869        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18870        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18871         GO TO 7250-NEXT-CLAIM
 18872     END-IF.
 18873
 18874     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18875        OR (CL-CLAIM-TYPE = 'I')
 18876        OR (CL-CLAIM-TYPE = 'G')
 18877        OR (CL-CLAIM-TYPE = 'F')
 18878          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18879              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18880              GO TO 7250-CONTINUE
 18881          END-IF
 18882     END-IF.
 18883
 18884     GO TO 7250-NEXT-CLAIM.
 18885
 18886 7250-CONTINUE.
 18887
 18888     IF W-BROWSE-SW = 'Y'
 18889
 18890* EXEC CICS ENDBR
 18891*            DATASET   (CLMS-ID)
 18892*        END-EXEC
 18893     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 346
* EL050.cbl
 18894       TO DFHEIV11
 18895*    MOVE '&2                    $   #00018600' TO DFHEIV0
 18896     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18897     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18898     MOVE X'2020233030303138363030' TO DFHEIV0(25:11)
 18899     CALL 'kxdfhei1' USING DFHEIV0,
 18900           CLMS-ID,
 18901           DFHEIV11,
 18902           DFHEIV99
 18903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18904         MOVE 'N' TO W-BROWSE-SW
 18905     END-IF.
 18906
 18907 7250-EXIT.
 18908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 347
* EL050.cbl
 18910 7300-CHECK-FOR-OPEN-CLMS.
 18911
 18912*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18913*    MOVE SPACES                 TO CNTL-ACCESS.
 18914*    MOVE '1'                    TO CNTL-REC-TYPE.
 18915*    MOVE +0                     TO CNTL-SEQ-NO.
 18916
 18917*    MOVE '3'                    TO RC-SW-1.
 18918*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18919
 18920*    IF NOT CF-COMPANY-MASTER
 18921*         PERFORM 0099-COMPANY-NOT-FOUND
 18922*         GO TO 7300-EXIT.
 18923
 18924     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18925                                    W-CL-COMP-CD.
 18926     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18927                                    W-CL-CERT-NO.
 18928
 18929
 18930* EXEC CICS HANDLE CONDITION
 18931*        NOTFND  (7300-CONTINUE)
 18932*        ENDFILE (7300-CONTINUE)
 18933*    END-EXEC.
 18934*    MOVE '"$I''                  ! * #00018628' TO DFHEIV0
 18935     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18937     MOVE X'2A20233030303138363238' TO DFHEIV0(25:11)
 18938     CALL 'kxdfhei1' USING DFHEIV0
 18939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18940
 18941
 18942
 18943* EXEC CICS IGNORE CONDITION
 18944*        DUPKEY
 18945*    END-EXEC.
 18946*    MOVE '"*$                   !   #00018633' TO DFHEIV0
 18947     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18949     MOVE X'2020233030303138363333' TO DFHEIV0(25:11)
 18950     CALL 'kxdfhei1' USING DFHEIV0
 18951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18952
 18953
 18954
 18955* EXEC CICS STARTBR
 18956*        DATASET   (CLMS-ID)
 18957*        RIDFLD    (ELMSTR-KEY)
 18958*        GENERIC   EQUAL
 18959*        KEYLENGTH (ELMSTR-LENGTH)
 18960*    END-EXEC.
 18961     MOVE 0
 18962       TO DFHEIV11
 18963*    MOVE '&,   KG    E          &   #00018637' TO DFHEIV0
 18964     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18965     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18966     MOVE X'2020233030303138363337' TO DFHEIV0(25:11)
 18967     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 348
* EL050.cbl
 18968           CLMS-ID,
 18969           ELMSTR-KEY,
 18970           ELMSTR-LENGTH,
 18971           DFHEIV11,
 18972           DFHEIV99
 18973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18974
 18975
 18976     MOVE 'Y'                    TO W-BROWSE-SW.
 18977
 18978 7300-NEXT-CLAIM.
 18979
 18980
 18981* EXEC CICS READNEXT
 18982*        DATASET   (CLMS-ID)
 18983*        RIDFLD    (ELMSTR-KEY)
 18984*        SET       (ADDRESS OF CLAIM-MASTER)
 18985*    END-EXEC.
 18986     MOVE 0
 18987       TO DFHEIV11
 18988*    MOVE '&.S                   )   #00018648' TO DFHEIV0
 18989     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18990     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18991     MOVE X'2020233030303138363438' TO DFHEIV0(25:11)
 18992     CALL 'kxdfhei1' USING DFHEIV0,
 18993           CLMS-ID,
 18994           DFHEIV20,
 18995           DFHEIV99,
 18996           ELMSTR-KEY,
 18997           DFHEIV99,
 18998           DFHEIV11,
 18999           DFHEIV99,
 19000           DFHEIV99
 19001     SET ADDRESS OF CLAIM-MASTER TO
 19002         DFHEIV20
 19003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19004
 19005
 19006     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19007        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19008         GO TO 7300-CONTINUE.
 19009
 19010     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19011        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19012        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19013        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19014        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19015         GO TO 7300-NEXT-CLAIM.
 19016
 19017*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19018     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19019        OR (CL-CLAIM-TYPE = 'I')
 19020        OR (CL-CLAIM-TYPE = 'G')
 19021        OR (CL-CLAIM-TYPE = 'F')
 19022        IF CLAIM-IS-OPEN
 19023           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19024             AND PB-C-AH-CANCEL-DT > SPACES
 19025              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 349
* EL050.cbl
 19026              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19027           END-IF
 19028           EVALUATE TRUE
 19029             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19030                 MOVE ER-2884      TO WS-ERROR
 19031             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19032                 MOVE ER-2887      TO WS-ERROR
 19033             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19034                 MOVE ER-2886      TO WS-ERROR
 19035             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19036                 MOVE ER-2888      TO WS-ERROR
 19037             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19038                 MOVE ER-2885      TO WS-ERROR
 19039             WHEN OTHER
 19040                 MOVE ER-2768      TO WS-ERROR
 19041           END-EVALUATE
 19042           IF PB-C-AH-CANCEL-VOIDED OR
 19043              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19044                NOT AH-COVERAGE-CANCELLED)
 19045               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19046               MOVE ER-2768      TO WS-ERROR
 19047           END-IF
 19048           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19049           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19050              PB-FORCE-CODE NOT EQUAL '8'
 19051               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19052           END-IF
 19053           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19054           GO TO 7300-NEXT-CLAIM
 19055        ELSE
 19056           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19057*****THIS IS A RESCISSION OR REFORMATION
 19058              IF AH-COVERAGE-CANCELLED
 19059                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19060                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19061                    MOVE 1                   TO DC-ELAPSED-DAYS
 19062                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19063                    SET BIN-PLUS-ELAPSED     TO TRUE
 19064                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19065                    IF NO-CONVERSION-ERROR
 19066                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19067                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19068                          MOVE ER-2897 TO WS-ERROR
 19069                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19070                          GO TO 7300-NEXT-CLAIM
 19071                       END-IF
 19072                    END-IF
 19073                 ELSE
 19074                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19075                     MOVE ER-2890 TO WS-ERROR
 19076                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19077                     GO TO 7300-NEXT-CLAIM
 19078                   END-IF
 19079                 END-IF
 19080              END-IF
 19081           ELSE
 19082              IF CL-DENIAL-TYPE = '1'  AND
 19083                 CL-TOTAL-PAID-AMT = 0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 350
* EL050.cbl
 19084                    GO TO 7300-NEXT-CLAIM
 19085              END-IF
 19086              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19087               AND PB-C-AH-CANCEL-DT > SPACES
 19088                 MOVE ER-2756        TO WS-ERROR
 19089                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19090                 GO TO 7300-NEXT-CLAIM
 19091              END-IF
 19092           END-IF
 19093        END-IF
 19094     ELSE
 19095*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19096        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19097           IF CLAIM-IS-OPEN
 19098              MOVE ER-2889      TO WS-ERROR
 19099              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19100              GO TO 7300-NEXT-CLAIM
 19101           ELSE
 19102              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19103*****THIS IS A RESCISSION OR REFORMATION
 19104                 IF (LF-COVERAGE-CANCELLED AND
 19105                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19106                       MOVE ER-2890 TO WS-ERROR
 19107                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19108                       GO TO 7300-NEXT-CLAIM
 19109                 END-IF
 19110              ELSE
 19111                 IF CL-DENIAL-TYPE = '1'  AND
 19112                    CL-TOTAL-PAID-AMT = 0
 19113                       GO TO 7300-NEXT-CLAIM
 19114                 END-IF
 19115                 IF (AH-COVERAGE-CANCELLED AND
 19116                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 19117                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 19118                    (LF-COVERAGE-CANCELLED AND
 19119                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 19120                     WS-ST-REFUND-CLAIM-FLAG = '4')
 19121                       MOVE ER-2965 TO WS-ERROR
 19122                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19123                       GO TO 7300-NEXT-CLAIM
 19124                 END-IF
 19125                 IF LF-COVERAGE-CANCELLED
 19126                  IF CL-TOTAL-PAID-AMT > 0
 19127                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19128                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19129                        MOVE ER-2891 TO WS-ERROR
 19130                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19131                        GO TO 7300-NEXT-CLAIM
 19132                      END-IF
 19133                    ELSE
 19134****only show this error if cert num matches exactly
 19135                      IF PB-CERT-NO = CL-CERT-NO
 19136                         MOVE ER-2892 TO WS-ERROR
 19137                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19138                         GO TO 7300-NEXT-CLAIM
 19139                      END-IF
 19140                    END-IF
 19141                  END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 351
* EL050.cbl
 19142                 END-IF
 19143              END-IF
 19144           END-IF
 19145        END-IF
 19146     END-IF
 19147
 19148     GO TO 7300-NEXT-CLAIM.
 19149
 19150 7300-CONTINUE.
 19151
 19152     IF W-BROWSE-SW = 'Y'
 19153
 19154* EXEC CICS ENDBR
 19155*            DATASET   (CLMS-ID)
 19156*        END-EXEC.
 19157     MOVE 0
 19158       TO DFHEIV11
 19159*    MOVE '&2                    $   #00018801' TO DFHEIV0
 19160     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19161     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19162     MOVE X'2020233030303138383031' TO DFHEIV0(25:11)
 19163     CALL 'kxdfhei1' USING DFHEIV0,
 19164           CLMS-ID,
 19165           DFHEIV11,
 19166           DFHEIV99
 19167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19168
 19169
 19170 7300-EXIT.
 19171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 352
* EL050.cbl
 19173
 19174 7400-GET-REMAIN-TERM.
 19175
 19176* EXEC CICS LINK
 19177*        PROGRAM    ('ELRTRM')
 19178*        COMMAREA   (CALCULATION-PASS-AREA)
 19179*        LENGTH     (CP-COMM-LENGTH)
 19180*    END-EXEC.
 19181     MOVE 'ELRTRM' TO DFHEIV1
 19182*    MOVE '."C                   (   #00018810' TO DFHEIV0
 19183     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19184     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19185     MOVE X'2020233030303138383130' TO DFHEIV0(25:11)
 19186     CALL 'kxdfhei1' USING DFHEIV0,
 19187           DFHEIV1,
 19188           CALCULATION-PASS-AREA,
 19189           CP-COMM-LENGTH,
 19190           DFHEIV99,
 19191           DFHEIV99,
 19192           DFHEIV99,
 19193           DFHEIV99
 19194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19195
 19196
 19197 7400-EXIT.
 19198     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 353
* EL050.cbl
 19200
 19201 7500-GET-REMAIN-AMOUNT.
 19202
 19203* EXEC CICS LINK
 19204*        PROGRAM    ('ELRAMT')
 19205*        COMMAREA   (CALCULATION-PASS-AREA)
 19206*        LENGTH     (CP-COMM-LENGTH)
 19207*    END-EXEC.
 19208     MOVE 'ELRAMT' TO DFHEIV1
 19209*    MOVE '."C                   (   #00018821' TO DFHEIV0
 19210     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19212     MOVE X'2020233030303138383231' TO DFHEIV0(25:11)
 19213     CALL 'kxdfhei1' USING DFHEIV0,
 19214           DFHEIV1,
 19215           CALCULATION-PASS-AREA,
 19216           CP-COMM-LENGTH,
 19217           DFHEIV99,
 19218           DFHEIV99,
 19219           DFHEIV99,
 19220           DFHEIV99
 19221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19222
 19223
 19224 7500-EXIT.
 19225     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 354
* EL050.cbl
 19227
 19228 7600-GET-REFUND.
 19229
 19230* EXEC CICS LINK
 19231*        PROGRAM    ('ELRFND')
 19232*        COMMAREA   (CALCULATION-PASS-AREA)
 19233*        LENGTH     (CP-COMM-LENGTH)
 19234*    END-EXEC.
 19235     MOVE 'ELRFND' TO DFHEIV1
 19236*    MOVE '."C                   (   #00018832' TO DFHEIV0
 19237     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19239     MOVE X'2020233030303138383332' TO DFHEIV0(25:11)
 19240     CALL 'kxdfhei1' USING DFHEIV0,
 19241           DFHEIV1,
 19242           CALCULATION-PASS-AREA,
 19243           CP-COMM-LENGTH,
 19244           DFHEIV99,
 19245           DFHEIV99,
 19246           DFHEIV99,
 19247           DFHEIV99
 19248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19249
 19250
 19251 7600-EXIT.
 19252     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 355
* EL050.cbl
 19254 7700-CALL-DL1.
 19255
 19256* EXEC CICS LINK
 19257*        PROGRAM    ('DLO001')
 19258*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19259*        LENGTH     (DLO001-COMM-LENGTH)
 19260*    END-EXEC.
 19261     MOVE 'DLO001' TO DFHEIV1
 19262*    MOVE '."C                   (   #00018842' TO DFHEIV0
 19263     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19265     MOVE X'2020233030303138383432' TO DFHEIV0(25:11)
 19266     CALL 'kxdfhei1' USING DFHEIV0,
 19267           DFHEIV1,
 19268           WS-DLO-MASTER-POLICY-FORM,
 19269           DLO001-COMM-LENGTH,
 19270           DFHEIV99,
 19271           DFHEIV99,
 19272           DFHEIV99,
 19273           DFHEIV99
 19274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19275
 19276
 19277 7700-EXIT.
 19278     EXIT.
 19279
 19280 7710-CALL-DL2.
 19281
 19282* EXEC CICS LINK
 19283*        PROGRAM    ('DLO002')
 19284*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19285*        LENGTH     (DLO002-COMM-LENGTH)
 19286*    END-EXEC.
 19287     MOVE 'DLO002' TO DFHEIV1
 19288*    MOVE '."C                   (   #00018852' TO DFHEIV0
 19289     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19290     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19291     MOVE X'2020233030303138383532' TO DFHEIV0(25:11)
 19292     CALL 'kxdfhei1' USING DFHEIV0,
 19293           DFHEIV1,
 19294           WS-DLO-INTERNAL-POLICY-FORM,
 19295           DLO002-COMM-LENGTH,
 19296           DFHEIV99,
 19297           DFHEIV99,
 19298           DFHEIV99,
 19299           DFHEIV99
 19300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19301
 19302
 19303 7710-EXIT.
 19304     EXIT.
 19305
 19306 7720-CALL-DL3.
 19307
 19308* EXEC CICS LINK
 19309*        PROGRAM    ('DLO003')
 19310*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19311*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 356
* EL050.cbl
 19312*    END-EXEC.
 19313     MOVE 'DLO003' TO DFHEIV1
 19314*    MOVE '."C                   (   #00018862' TO DFHEIV0
 19315     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19317     MOVE X'2020233030303138383632' TO DFHEIV0(25:11)
 19318     CALL 'kxdfhei1' USING DFHEIV0,
 19319           DFHEIV1,
 19320           WS-DLO-VALID-BANK-ID,
 19321           DLO003-COMM-LENGTH,
 19322           DFHEIV99,
 19323           DFHEIV99,
 19324           DFHEIV99,
 19325           DFHEIV99
 19326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19327
 19328
 19329 7720-EXIT.
 19330     EXIT.
 19331
 19332 7730-CALL-DL7.
 19333
 19334* EXEC CICS LINK
 19335*        PROGRAM    ('DLO007')
 19336*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19337*        LENGTH     (DLO007-COMM-LENGTH)
 19338*    END-EXEC.
 19339     MOVE 'DLO007' TO DFHEIV1
 19340*    MOVE '."C                   (   #00018872' TO DFHEIV0
 19341     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19343     MOVE X'2020233030303138383732' TO DFHEIV0(25:11)
 19344     CALL 'kxdfhei1' USING DFHEIV0,
 19345           DFHEIV1,
 19346           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19347           DLO007-COMM-LENGTH,
 19348           DFHEIV99,
 19349           DFHEIV99,
 19350           DFHEIV99,
 19351           DFHEIV99
 19352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19353
 19354
 19355 7730-EXIT.
 19356     EXIT.
 19357
 19358 7740-CALL-DL11.
 19359
 19360* EXEC CICS LINK
 19361*        PROGRAM    ('DLO011')
 19362*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19363*        LENGTH     (DLO011-COMM-LENGTH)
 19364*    END-EXEC.
 19365     MOVE 'DLO011' TO DFHEIV1
 19366*    MOVE '."C                   (   #00018882' TO DFHEIV0
 19367     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19369     MOVE X'2020233030303138383832' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 357
* EL050.cbl
 19370     CALL 'kxdfhei1' USING DFHEIV0,
 19371           DFHEIV1,
 19372           WS-DLO-PREM-RATES-BEN-TYPE,
 19373           DLO011-COMM-LENGTH,
 19374           DFHEIV99,
 19375           DFHEIV99,
 19376           DFHEIV99,
 19377           DFHEIV99
 19378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19379
 19380
 19381 7740-EXIT.
 19382     EXIT.
 19383
 19384 7750-CALL-DL17.
 19385
 19386* EXEC CICS LINK
 19387*        PROGRAM    ('DLO017')
 19388*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19389*        LENGTH     (DLO017-COMM-LENGTH)
 19390*    END-EXEC.
 19391     MOVE 'DLO017' TO DFHEIV1
 19392*    MOVE '."C                   (   #00018892' TO DFHEIV0
 19393     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19395     MOVE X'2020233030303138383932' TO DFHEIV0(25:11)
 19396     CALL 'kxdfhei1' USING DFHEIV0,
 19397           DFHEIV1,
 19398           WS-DLO-VALID-RATE-CODE,
 19399           DLO017-COMM-LENGTH,
 19400           DFHEIV99,
 19401           DFHEIV99,
 19402           DFHEIV99,
 19403           DFHEIV99
 19404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19405
 19406
 19407 7750-EXIT.
 19408     EXIT.
 19409
 19410 7755-CALL-DL19.
 19411
 19412* EXEC CICS LINK
 19413*        PROGRAM    ('DLO019')
 19414*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19415*        LENGTH     (DLO019-COMM-LENGTH)
 19416*    END-EXEC.
 19417     MOVE 'DLO019' TO DFHEIV1
 19418*    MOVE '."C                   (   #00018902' TO DFHEIV0
 19419     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19421     MOVE X'2020233030303138393032' TO DFHEIV0(25:11)
 19422     CALL 'kxdfhei1' USING DFHEIV0,
 19423           DFHEIV1,
 19424           WS-DLO-ORIG-COV-CAT,
 19425           DLO019-COMM-LENGTH,
 19426           DFHEIV99,
 19427           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 358
* EL050.cbl
 19428           DFHEIV99,
 19429           DFHEIV99
 19430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19431
 19432
 19433 7755-EXIT.
 19434     EXIT.
 19435
 19436 7760-CALL-DL21.
 19437
 19438* EXEC CICS LINK
 19439*        PROGRAM    ('DLO021')
 19440*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19441*        LENGTH     (DLO021-COMM-LENGTH)
 19442*    END-EXEC.
 19443     MOVE 'DLO021' TO DFHEIV1
 19444*    MOVE '."C                   (   #00018912' TO DFHEIV0
 19445     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19446     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19447     MOVE X'2020233030303138393132' TO DFHEIV0(25:11)
 19448     CALL 'kxdfhei1' USING DFHEIV0,
 19449           DFHEIV1,
 19450           WS-DLO-VALID-LOAN-OFFICER,
 19451           DLO021-COMM-LENGTH,
 19452           DFHEIV99,
 19453           DFHEIV99,
 19454           DFHEIV99,
 19455           DFHEIV99
 19456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19457
 19458
 19459 7760-EXIT.
 19460     EXIT.
 19461
 19462 7770-CALL-DL22.
 19463
 19464* EXEC CICS LINK
 19465*        PROGRAM    ('DLO022')
 19466*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19467*        LENGTH     (DLO022-COMM-LENGTH)
 19468*    END-EXEC.
 19469     MOVE 'DLO022' TO DFHEIV1
 19470*    MOVE '."C                   (   #00018922' TO DFHEIV0
 19471     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19473     MOVE X'2020233030303138393232' TO DFHEIV0(25:11)
 19474     CALL 'kxdfhei1' USING DFHEIV0,
 19475           DFHEIV1,
 19476           WS-DLO-VALID-STATE-CODE,
 19477           DLO022-COMM-LENGTH,
 19478           DFHEIV99,
 19479           DFHEIV99,
 19480           DFHEIV99,
 19481           DFHEIV99
 19482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19483
 19484
 19485 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 359
* EL050.cbl
 19486     EXIT.
 19487
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 360
* EL050.cbl
 19489
 19490 7800-REWRITE-CERT.
 19491******************************************************************
 19492*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19493*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19494******************************************************************
 19495
 19496     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19497        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19498        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19499        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19500
 19501* EXEC CICS REWRITE
 19502*                  DATASET (CERT-ID)
 19503*                  FROM    (CERTIFICATE-MASTER)
 19504*              END-EXEC
 19505     MOVE LENGTH OF
 19506      CERTIFICATE-MASTER
 19507       TO DFHEIV11
 19508*    MOVE '&& L                  %   #00018943' TO DFHEIV0
 19509     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19510     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19511     MOVE X'2020233030303138393433' TO DFHEIV0(25:11)
 19512     CALL 'kxdfhei1' USING DFHEIV0,
 19513           CERT-ID,
 19514           CERTIFICATE-MASTER,
 19515           DFHEIV11,
 19516           DFHEIV99
 19517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19518        GO TO 7800-EXIT.
 19519
 19520       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19521       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19522
 19523 7800-EXIT.
 19524      EXIT.
 19525
 19526 7900-DELETE-CERT.
 19527
 19528* EXEC CICS DELETE
 19529*        DATASET (CERT-ID)
 19530*    END-EXEC.
 19531*    MOVE '&(                    &   #00018956' TO DFHEIV0
 19532     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19533     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19534     MOVE X'2020233030303138393536' TO DFHEIV0(25:11)
 19535     CALL 'kxdfhei1' USING DFHEIV0,
 19536           CERT-ID,
 19537           DFHEIV99,
 19538           DFHEIV99,
 19539           DFHEIV99,
 19540           DFHEIV99
 19541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19542
 19543
 19544 7900-EXIT.
 19545     EXIT.
 19546
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 361
* EL050.cbl
 19547 8000-WRITE-CERT.
 19548
 19549* EXEC CICS HANDLE CONDITION
 19550*        DUPKEY    (8000-FREE-MAIN)
 19551*    END-EXEC.
 19552*    MOVE '"$$                   ! + #00018964' TO DFHEIV0
 19553     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19555     MOVE X'2B20233030303138393634' TO DFHEIV0(25:11)
 19556     CALL 'kxdfhei1' USING DFHEIV0
 19557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19558
 19559
 19560
 19561* EXEC CICS WRITE
 19562*        DATASET     (CERT-ID)
 19563*        FROM        (CERTIFICATE-MASTER)
 19564*        RIDFLD      (ELCERT-KEY)
 19565*    END-EXEC.
 19566     MOVE LENGTH OF
 19567      CERTIFICATE-MASTER
 19568       TO DFHEIV11
 19569*    MOVE '&$ L                  ''   #00018968' TO DFHEIV0
 19570     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19571     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19572     MOVE X'2020233030303138393638' TO DFHEIV0(25:11)
 19573     CALL 'kxdfhei1' USING DFHEIV0,
 19574           CERT-ID,
 19575           CERTIFICATE-MASTER,
 19576           DFHEIV11,
 19577           ELCERT-KEY,
 19578           DFHEIV99,
 19579           DFHEIV99
 19580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19581
 19582
 19583 8000-FREE-MAIN.
 19584
 19585 8000-EXIT.
 19586      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 362
* EL050.cbl
 19588
 19589 8100-READ-ERPNDM.
 19590
 19591* EXEC CICS HANDLE CONDITION
 19592*         NOTFND     (8100-NOTFND)
 19593*         ENDFILE    (8100-NOTFND)
 19594*    END-EXEC.
 19595*    MOVE '"$I''                  ! , #00018981' TO DFHEIV0
 19596     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19597     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19598     MOVE X'2C20233030303138393831' TO DFHEIV0(25:11)
 19599     CALL 'kxdfhei1' USING DFHEIV0
 19600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19601
 19602
 19603     MOVE SPACES                 TO ERPNDM-FOUND.
 19604     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19605
 19606
 19607* EXEC CICS READ
 19608*         DATASET   (FILE-ERPNDM)
 19609*         RIDFLD    (PM-CONTROL-PRIMARY)
 19610*         INTO      (PENDING-MAILING-DATA)
 19611*    END-EXEC.
 19612     MOVE LENGTH OF
 19613      PENDING-MAILING-DATA
 19614       TO DFHEIV11
 19615*    MOVE '&"IL       E          (   #00018989' TO DFHEIV0
 19616     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19617     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19618     MOVE X'2020233030303138393839' TO DFHEIV0(25:11)
 19619     CALL 'kxdfhei1' USING DFHEIV0,
 19620           FILE-ERPNDM,
 19621           PENDING-MAILING-DATA,
 19622           DFHEIV11,
 19623           PM-CONTROL-PRIMARY,
 19624           DFHEIV99,
 19625           DFHEIV99,
 19626           DFHEIV99
 19627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19628
 19629
 19630     GO TO 8100-EXIT.
 19631
 19632 8100-NOTFND.
 19633
 19634     MOVE 'X'                    TO ERPNDM-FOUND.
 19635     MOVE ER-2694                TO WS-ERROR.
 19636     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19637     MOVE ER-2883                TO WS-ERROR
 19638     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19639     .
 19640 8100-EXIT.
 19641     EXIT.
 19642
 19643 8110-READ-ERMAIL.
 19644
 19645* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 363
* EL050.cbl
 19646*         NOTFND     (8110-NOTFND)
 19647*         ENDFILE    (8110-NOTFND)
 19648*    END-EXEC.
 19649*    MOVE '"$I''                  ! - #00019009' TO DFHEIV0
 19650     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19652     MOVE X'2D20233030303139303039' TO DFHEIV0(25:11)
 19653     CALL 'kxdfhei1' USING DFHEIV0
 19654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19655
 19656
 19657     MOVE SPACES                 TO ERMAIL-FOUND.
 19658     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19659     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19660     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19661     MOVE PB-SV-STATE            TO MA-STATE.
 19662
 19663
 19664* EXEC CICS READ
 19665*         UPDATE
 19666*         DATASET   (FILE-ERMAIL)
 19667*         RIDFLD    (MA-CONTROL-PRIMARY)
 19668*         INTO      (MAILING-DATA)
 19669*    END-EXEC.
 19670     MOVE LENGTH OF
 19671      MAILING-DATA
 19672       TO DFHEIV11
 19673*    MOVE '&"IL       EU         (   #00019020' TO DFHEIV0
 19674     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19675     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19676     MOVE X'2020233030303139303230' TO DFHEIV0(25:11)
 19677     CALL 'kxdfhei1' USING DFHEIV0,
 19678           FILE-ERMAIL,
 19679           MAILING-DATA,
 19680           DFHEIV11,
 19681           MA-CONTROL-PRIMARY,
 19682           DFHEIV99,
 19683           DFHEIV99,
 19684           DFHEIV99
 19685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19686
 19687
 19688     GO TO 8110-EXIT.
 19689
 19690 8110-NOTFND.
 19691     MOVE 'X'                    TO ERMAIL-FOUND.
 19692
 19693 8110-EXIT.
 19694     EXIT.
 19695
 19696 8120-REWRITE-ERMAIL.
 19697
 19698* EXEC CICS REWRITE
 19699*         DATASET    (FILE-ERMAIL)
 19700*         FROM       (MAILING-DATA)
 19701*    END-EXEC.
 19702     MOVE LENGTH OF
 19703      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 364
* EL050.cbl
 19704       TO DFHEIV11
 19705*    MOVE '&& L                  %   #00019036' TO DFHEIV0
 19706     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19707     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19708     MOVE X'2020233030303139303336' TO DFHEIV0(25:11)
 19709     CALL 'kxdfhei1' USING DFHEIV0,
 19710           FILE-ERMAIL,
 19711           MAILING-DATA,
 19712           DFHEIV11,
 19713           DFHEIV99
 19714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19715
 19716
 19717 8120-EXIT.
 19718     EXIT.
 19719
 19720 8130-WRITE-ERMAIL.
 19721
 19722* EXEC CICS HANDLE CONDITION
 19723*         DUPKEY   (8130-EXIT)
 19724*    END-EXEC.
 19725*    MOVE '"$$                   ! . #00019045' TO DFHEIV0
 19726     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19728     MOVE X'2E20233030303139303435' TO DFHEIV0(25:11)
 19729     CALL 'kxdfhei1' USING DFHEIV0
 19730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19731
 19732
 19733
 19734* EXEC CICS WRITE
 19735*         DATASET     (FILE-ERMAIL)
 19736*         RIDFLD      (MA-CONTROL-PRIMARY)
 19737*         FROM        (MAILING-DATA)
 19738*    END-EXEC.
 19739     MOVE LENGTH OF
 19740      MAILING-DATA
 19741       TO DFHEIV11
 19742*    MOVE '&$ L                  ''   #00019049' TO DFHEIV0
 19743     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19744     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19745     MOVE X'2020233030303139303439' TO DFHEIV0(25:11)
 19746     CALL 'kxdfhei1' USING DFHEIV0,
 19747           FILE-ERMAIL,
 19748           MAILING-DATA,
 19749           DFHEIV11,
 19750           MA-CONTROL-PRIMARY,
 19751           DFHEIV99,
 19752           DFHEIV99
 19753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19754
 19755
 19756 8130-EXIT.
 19757     EXIT.
 19758
 19759 8140-UNLOCK-ERMAIL.
 19760
 19761* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 365
* EL050.cbl
 19762*         DATASET   (FILE-ERMAIL)
 19763*    END-EXEC.
 19764*    MOVE '&*                    #   #00019059' TO DFHEIV0
 19765     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19766     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19767     MOVE X'2020233030303139303539' TO DFHEIV0(25:11)
 19768     CALL 'kxdfhei1' USING DFHEIV0,
 19769           FILE-ERMAIL,
 19770           DFHEIV99
 19771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19772
 19773
 19774 8140-EXIT.
 19775     EXIT.
 19776
 19777 8150-read-elcrtt.
 19778
 19779
 19780* EXEC CICS HANDLE CONDITION
 19781*        NOTFND   (8150-exit)
 19782*    END-EXEC
 19783*    MOVE '"$I                   ! / #00019068' TO DFHEIV0
 19784     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19786     MOVE X'2F20233030303139303638' TO DFHEIV0(25:11)
 19787     CALL 'kxdfhei1' USING DFHEIV0
 19788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19789
 19790     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19791     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19792
 19793
 19794* EXEC CICS READ
 19795*        DATASET  (CRTT-ID)
 19796*        RIDFLD   (WS-ELCRTT-KEY)
 19797*        INTO     (CERTIFICATE-TRAILERS)
 19798*    END-EXEC
 19799     MOVE LENGTH OF
 19800      CERTIFICATE-TRAILERS
 19801       TO DFHEIV11
 19802*    MOVE '&"IL       E          (   #00019075' TO DFHEIV0
 19803     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19805     MOVE X'2020233030303139303735' TO DFHEIV0(25:11)
 19806     CALL 'kxdfhei1' USING DFHEIV0,
 19807           CRTT-ID,
 19808           CERTIFICATE-TRAILERS,
 19809           DFHEIV11,
 19810           WS-ELCRTT-KEY,
 19811           DFHEIV99,
 19812           DFHEIV99,
 19813           DFHEIV99
 19814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19815
 19816     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19817     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19818
 19819     .
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 366
* EL050.cbl
 19820 8150-exit.
 19821     exit.
 19822 8180-UPDATE-VIN-NUMBER.
 19823
 19824* EXEC CICS HANDLE CONDITION
 19825*        NOTFND   (8180-NOTFND)
 19826*    END-EXEC.
 19827*    MOVE '"$I                   ! 0 #00019088' TO DFHEIV0
 19828     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19830     MOVE X'3020233030303139303838' TO DFHEIV0(25:11)
 19831     CALL 'kxdfhei1' USING DFHEIV0
 19832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19833
 19834
 19835     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19836     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19837
 19838
 19839* EXEC CICS READ
 19840*        UPDATE
 19841*        DATASET  (CRTT-ID)
 19842*        RIDFLD   (WS-ELCRTT-KEY)
 19843*        INTO     (CERTIFICATE-TRAILERS)
 19844*    END-EXEC.
 19845     MOVE LENGTH OF
 19846      CERTIFICATE-TRAILERS
 19847       TO DFHEIV11
 19848*    MOVE '&"IL       EU         (   #00019095' TO DFHEIV0
 19849     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19850     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19851     MOVE X'2020233030303139303935' TO DFHEIV0(25:11)
 19852     CALL 'kxdfhei1' USING DFHEIV0,
 19853           CRTT-ID,
 19854           CERTIFICATE-TRAILERS,
 19855           DFHEIV11,
 19856           WS-ELCRTT-KEY,
 19857           DFHEIV99,
 19858           DFHEIV99,
 19859           DFHEIV99
 19860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19861
 19862
 19863     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19864         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19865
 19866* EXEC CICS REWRITE
 19867*           DATASET  (CRTT-ID)
 19868*           FROM     (CERTIFICATE-TRAILERS)
 19869*        END-EXEC
 19870     MOVE LENGTH OF
 19871      CERTIFICATE-TRAILERS
 19872       TO DFHEIV11
 19873*    MOVE '&& L                  %   #00019104' TO DFHEIV0
 19874     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19875     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19876     MOVE X'2020233030303139313034' TO DFHEIV0(25:11)
 19877     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 367
* EL050.cbl
 19878           CRTT-ID,
 19879           CERTIFICATE-TRAILERS,
 19880           DFHEIV11,
 19881           DFHEIV99
 19882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19883     ELSE
 19884
 19885* EXEC CICS UNLOCK
 19886*          DATASET  (CRTT-ID)
 19887*       END-EXEC
 19888*    MOVE '&*                    #   #00019109' TO DFHEIV0
 19889     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19890     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19891     MOVE X'2020233030303139313039' TO DFHEIV0(25:11)
 19892     CALL 'kxdfhei1' USING DFHEIV0,
 19893           CRTT-ID,
 19894           DFHEIV99
 19895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19896     END-IF.
 19897
 19898     GO TO 8180-EXIT.
 19899
 19900 8180-NOTFND.
 19901
 19902     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19903     MOVE 'CS'         TO CS-RECORD-ID.
 19904     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19905     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19906     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19907     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19908
 19909* EXEC CICS WRITE
 19910*       DATASET  (CRTT-ID)
 19911*       RIDFLD   (WS-ELCRTT-KEY)
 19912*       FROM     (CERTIFICATE-TRAILERS)
 19913*    END-EXEC.
 19914     MOVE LENGTH OF
 19915      CERTIFICATE-TRAILERS
 19916       TO DFHEIV11
 19917*    MOVE '&$ L                  ''   #00019124' TO DFHEIV0
 19918     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19919     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19920     MOVE X'2020233030303139313234' TO DFHEIV0(25:11)
 19921     CALL 'kxdfhei1' USING DFHEIV0,
 19922           CRTT-ID,
 19923           CERTIFICATE-TRAILERS,
 19924           DFHEIV11,
 19925           WS-ELCRTT-KEY,
 19926           DFHEIV99,
 19927           DFHEIV99
 19928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19929
 19930
 19931 8180-EXIT.
 19932     EXIT.
 19933
 19934 8190-UPDATE-REFUND-CLAIM-FLAG.
 19935
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 368
* EL050.cbl
 19936* EXEC CICS HANDLE CONDITION
 19937*        NOTFND   (8190-NOTFND)
 19938*    END-EXEC.
 19939*    MOVE '"$I                   ! 1 #00019134' TO DFHEIV0
 19940     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19941     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19942     MOVE X'3120233030303139313334' TO DFHEIV0(25:11)
 19943     CALL 'kxdfhei1' USING DFHEIV0
 19944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19945
 19946
 19947     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19948     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19949
 19950
 19951* EXEC CICS READ
 19952*        UPDATE
 19953*        DATASET  (CRTT-ID)
 19954*        RIDFLD   (WS-ELCRTT-KEY)
 19955*        INTO     (CERTIFICATE-TRAILERS)
 19956*    END-EXEC.
 19957     MOVE LENGTH OF
 19958      CERTIFICATE-TRAILERS
 19959       TO DFHEIV11
 19960*    MOVE '&"IL       EU         (   #00019141' TO DFHEIV0
 19961     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19962     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19963     MOVE X'2020233030303139313431' TO DFHEIV0(25:11)
 19964     CALL 'kxdfhei1' USING DFHEIV0,
 19965           CRTT-ID,
 19966           CERTIFICATE-TRAILERS,
 19967           DFHEIV11,
 19968           WS-ELCRTT-KEY,
 19969           DFHEIV99,
 19970           DFHEIV99,
 19971           DFHEIV99
 19972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19973
 19974
 19975     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19976
 19977* EXEC CICS REWRITE
 19978*       DATASET  (CRTT-ID)
 19979*       FROM     (CERTIFICATE-TRAILERS)
 19980*    END-EXEC.
 19981     MOVE LENGTH OF
 19982      CERTIFICATE-TRAILERS
 19983       TO DFHEIV11
 19984*    MOVE '&& L                  %   #00019149' TO DFHEIV0
 19985     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19986     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19987     MOVE X'2020233030303139313439' TO DFHEIV0(25:11)
 19988     CALL 'kxdfhei1' USING DFHEIV0,
 19989           CRTT-ID,
 19990           CERTIFICATE-TRAILERS,
 19991           DFHEIV11,
 19992           DFHEIV99
 19993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 369
* EL050.cbl
 19994
 19995
 19996     GO TO 8190-EXIT.
 19997
 19998 8190-NOTFND.
 19999
 20000     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20001     MOVE 'CS'         TO CS-RECORD-ID.
 20002     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20003     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20004     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20005     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20006
 20007* EXEC CICS WRITE
 20008*       DATASET  (CRTT-ID)
 20009*       RIDFLD   (WS-ELCRTT-KEY)
 20010*       FROM     (CERTIFICATE-TRAILERS)
 20011*    END-EXEC.
 20012     MOVE LENGTH OF
 20013      CERTIFICATE-TRAILERS
 20014       TO DFHEIV11
 20015*    MOVE '&$ L                  ''   #00019164' TO DFHEIV0
 20016     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20017     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20018     MOVE X'2020233030303139313634' TO DFHEIV0(25:11)
 20019     CALL 'kxdfhei1' USING DFHEIV0,
 20020           CRTT-ID,
 20021           CERTIFICATE-TRAILERS,
 20022           DFHEIV11,
 20023           WS-ELCRTT-KEY,
 20024           DFHEIV99,
 20025           DFHEIV99
 20026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20027
 20028
 20029 8190-EXIT.
 20030     EXIT.
 20031
 20032 8195-UPDATE-AGE-FLAGS.
 20033
 20034* EXEC CICS HANDLE CONDITION
 20035*        NOTFND   (8195-NOTFND)
 20036*    END-EXEC.
 20037*    MOVE '"$I                   ! 2 #00019174' TO DFHEIV0
 20038     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20040     MOVE X'3220233030303139313734' TO DFHEIV0(25:11)
 20041     CALL 'kxdfhei1' USING DFHEIV0
 20042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20043
 20044
 20045     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20046     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20047
 20048
 20049* EXEC CICS READ
 20050*        UPDATE
 20051*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 370
* EL050.cbl
 20052*        RIDFLD   (WS-ELCRTT-KEY)
 20053*        INTO     (CERTIFICATE-TRAILERS)
 20054*    END-EXEC.
 20055     MOVE LENGTH OF
 20056      CERTIFICATE-TRAILERS
 20057       TO DFHEIV11
 20058*    MOVE '&"IL       EU         (   #00019181' TO DFHEIV0
 20059     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20060     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20061     MOVE X'2020233030303139313831' TO DFHEIV0(25:11)
 20062     CALL 'kxdfhei1' USING DFHEIV0,
 20063           CRTT-ID,
 20064           CERTIFICATE-TRAILERS,
 20065           DFHEIV11,
 20066           WS-ELCRTT-KEY,
 20067           DFHEIV99,
 20068           DFHEIV99,
 20069           DFHEIV99
 20070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20071
 20072
 20073     IF WS-INS-AGE-SET = 'Y'
 20074        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20075     END-IF
 20076     IF WS-JNT-AGE-SET = 'Y'
 20077        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20078     END-IF
 20079
 20080
 20081* EXEC CICS REWRITE
 20082*       DATASET  (CRTT-ID)
 20083*       FROM     (CERTIFICATE-TRAILERS)
 20084*    END-EXEC.
 20085     MOVE LENGTH OF
 20086      CERTIFICATE-TRAILERS
 20087       TO DFHEIV11
 20088*    MOVE '&& L                  %   #00019195' TO DFHEIV0
 20089     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20090     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20091     MOVE X'2020233030303139313935' TO DFHEIV0(25:11)
 20092     CALL 'kxdfhei1' USING DFHEIV0,
 20093           CRTT-ID,
 20094           CERTIFICATE-TRAILERS,
 20095           DFHEIV11,
 20096           DFHEIV99
 20097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20098
 20099
 20100     GO TO 8195-EXIT.
 20101
 20102 8195-NOTFND.
 20103
 20104     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20105     MOVE 'CS'         TO CS-RECORD-ID.
 20106     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20107     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20108     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20109     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 371
* EL050.cbl
 20110     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20111
 20112* EXEC CICS WRITE
 20113*       DATASET  (CRTT-ID)
 20114*       RIDFLD   (WS-ELCRTT-KEY)
 20115*       FROM     (CERTIFICATE-TRAILERS)
 20116*    END-EXEC.
 20117     MOVE LENGTH OF
 20118      CERTIFICATE-TRAILERS
 20119       TO DFHEIV11
 20120*    MOVE '&$ L                  ''   #00019211' TO DFHEIV0
 20121     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20122     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20123     MOVE X'2020233030303139323131' TO DFHEIV0(25:11)
 20124     CALL 'kxdfhei1' USING DFHEIV0,
 20125           CRTT-ID,
 20126           CERTIFICATE-TRAILERS,
 20127           DFHEIV11,
 20128           WS-ELCRTT-KEY,
 20129           DFHEIV99,
 20130           DFHEIV99
 20131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20132
 20133
 20134 8195-EXIT.
 20135     EXIT.
 20136
 20137 8200-READ-REIN-TABLE.
 20138
 20139* EXEC CICS HANDLE CONDITION
 20140*         NOTFND   (8200-NOTFND)
 20141*    END-EXEC.
 20142*    MOVE '"$I                   ! 3 #00019221' TO DFHEIV0
 20143     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20145     MOVE X'3320233030303139323231' TO DFHEIV0(25:11)
 20146     CALL 'kxdfhei1' USING DFHEIV0
 20147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20148
 20149
 20150
 20151* EXEC CICS READ
 20152*        DATASET     (REIN-ID)
 20153*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20154*        RIDFLD      (ERREIN-KEY)
 20155*    END-EXEC.
 20156*    MOVE '&"S        E          (   #00019225' TO DFHEIV0
 20157     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20159     MOVE X'2020233030303139323235' TO DFHEIV0(25:11)
 20160     CALL 'kxdfhei1' USING DFHEIV0,
 20161           REIN-ID,
 20162           DFHEIV20,
 20163           DFHEIV99,
 20164           ERREIN-KEY,
 20165           DFHEIV99,
 20166           DFHEIV99,
 20167           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 372
* EL050.cbl
 20168     SET ADDRESS OF REINSURANCE-RECORD TO
 20169         DFHEIV20
 20170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20171
 20172
 20173     GO TO 8200-EXIT.
 20174
 20175 8200-NOTFND.
 20176     MOVE 'N'             TO WS-REIN-READ-SW.
 20177
 20178 8200-EXIT.
 20179      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 373
* EL050.cbl
 20181
 20182 8300-READ-CTBL-TABLE.
 20183
 20184* EXEC CICS HANDLE CONDITION
 20185*        NOTFND    (8300-NOTFND)
 20186*        DISABLED  (8300-ERRESS-PROBLEM)
 20187*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20188*        ENDFILE   (8300-NOTFND)
 20189*    END-EXEC.
 20190*    MOVE '"$IcJ''                ! 4 #00019241' TO DFHEIV0
 20191     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20193     MOVE X'3420233030303139323431' TO DFHEIV0(25:11)
 20194     CALL 'kxdfhei1' USING DFHEIV0
 20195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20196
 20197
 20198
 20199* EXEC CICS READ
 20200*        DATASET     (CTBL-ID)
 20201*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20202*        RIDFLD      (ERCTBL-KEY)
 20203*    END-EXEC.
 20204*    MOVE '&"S        E          (   #00019248' TO DFHEIV0
 20205     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20207     MOVE X'2020233030303139323438' TO DFHEIV0(25:11)
 20208     CALL 'kxdfhei1' USING DFHEIV0,
 20209           CTBL-ID,
 20210           DFHEIV20,
 20211           DFHEIV99,
 20212           ERCTBL-KEY,
 20213           DFHEIV99,
 20214           DFHEIV99,
 20215           DFHEIV99
 20216     SET ADDRESS OF COMM-TABLE-RECORD TO
 20217         DFHEIV20
 20218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20219
 20220
 20221     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20222
 20223     GO TO 8300-EXIT.
 20224
 20225 8300-NOTFND.
 20226
 20227     IF CTBL-SW = '0530'
 20228         MOVE 'AA'                     TO WS-AH-COMP-CD
 20229         MOVE '0550'                   TO CTBL-SW
 20230         MOVE '1'                      TO WS-CTBL-READ-SW
 20231         GO TO 8300-EXIT.
 20232
 20233     IF CTBL-SW = '0540'
 20234         MOVE 'AA'                     TO WS-LF-COMP-CD
 20235         MOVE '0550'                   TO CTBL-SW
 20236         MOVE '1'                      TO WS-CTBL-READ-SW
 20237         GO TO 8300-EXIT.
 20238
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 374
* EL050.cbl
 20239     IF CTBL-SW = '0550'
 20240         MOVE '2'                      TO WS-CTBL-READ-SW
 20241         GO TO 8300-EXIT.
 20242
 20243     GO TO 8300-EXIT.
 20244
 20245 8300-ERRESS-PROBLEM.
 20246
 20247      MOVE ER-8050              TO WS-ERROR.
 20248      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20249
 20250     GO TO 8300-EXIT.
 20251
 20252 8300-EXIT.
 20253      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 375
* EL050.cbl
 20255
 20256
 20257 8400-GETMAIN-ERFORM.
 20258
 20259
 20260* EXEC CICS   GETMAIN
 20261*        LENGTH  (500)
 20262*        SET     (ADDRESS OF FORM-MASTER)
 20263*    END-EXEC.
 20264     MOVE 500
 20265       TO DFHEIV11
 20266*    MOVE '," L                  $   #00019292' TO DFHEIV0
 20267     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20269     MOVE X'2020233030303139323932' TO DFHEIV0(25:11)
 20270     CALL 'kxdfhei1' USING DFHEIV0,
 20271           DFHEIV20,
 20272           DFHEIV11,
 20273           DFHEIV99
 20274     SET ADDRESS OF FORM-MASTER TO
 20275         DFHEIV20
 20276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20277
 20278
 20279     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20280
 20281 8400-EXIT.
 20282      EXIT.
 20283
 20284 8450-READ-FORM-MASTER.
 20285
 20286
 20287* EXEC CICS  HANDLE CONDITION
 20288*        NOTFND   (8450-FORM-NOT-FOUND)
 20289*        ENDFILE  (8450-FORM-NOT-FOUND)
 20290*    END-EXEC.
 20291*    MOVE '"$I''                  ! 5 #00019304' TO DFHEIV0
 20292     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20294     MOVE X'3520233030303139333034' TO DFHEIV0(25:11)
 20295     CALL 'kxdfhei1' USING DFHEIV0
 20296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20297
 20298
 20299
 20300* EXEC CICS   READ
 20301*        DATASET   (FORM-ID)
 20302*        RIDFLD    (ERFORM-KEY)
 20303*        INTO      (FORM-MASTER)
 20304*        GTEQ
 20305*    END-EXEC.
 20306     MOVE LENGTH OF
 20307      FORM-MASTER
 20308       TO DFHEIV11
 20309*    MOVE '&"IL       G          (   #00019309' TO DFHEIV0
 20310     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20311     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20312     MOVE X'2020233030303139333039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 376
* EL050.cbl
 20313     CALL 'kxdfhei1' USING DFHEIV0,
 20314           FORM-ID,
 20315           FORM-MASTER,
 20316           DFHEIV11,
 20317           ERFORM-KEY,
 20318           DFHEIV99,
 20319           DFHEIV99,
 20320           DFHEIV99
 20321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20322
 20323
 20324     MOVE  'Y'           TO  FORM-MASTER-SW.
 20325
 20326     GO TO  8450-EXIT.
 20327
 20328 8450-FORM-NOT-FOUND.
 20329
 20330     MOVE  'N'           TO  FORM-MASTER-SW.
 20331
 20332 8450-EXIT.
 20333      EXIT.
 20334
 20335 8500-DATE-CONVERT.
 20336
 20337* EXEC CICS LINK
 20338*        PROGRAM    ('ELDATCV')
 20339*        COMMAREA   (DATE-CONVERSION-DATA)
 20340*        LENGTH     (DC-COMM-LENGTH)
 20341*    END-EXEC.
 20342     MOVE 'ELDATCV' TO DFHEIV1
 20343*    MOVE '."C                   (   #00019328' TO DFHEIV0
 20344     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20346     MOVE X'2020233030303139333238' TO DFHEIV0(25:11)
 20347     CALL 'kxdfhei1' USING DFHEIV0,
 20348           DFHEIV1,
 20349           DATE-CONVERSION-DATA,
 20350           DC-COMM-LENGTH,
 20351           DFHEIV99,
 20352           DFHEIV99,
 20353           DFHEIV99,
 20354           DFHEIV99
 20355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20356
 20357
 20358 8500-EXIT.
 20359     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 377
* EL050.cbl
 20361
 20362 8555-RELOAD-CONTROL-FILE.
 20363     CONTINUE.
 20364
 20365 8555-EXIT.
 20366     EXIT.
 20367
 20368 8557-GETMAIN-ERPLAN.
 20369
 20370
 20371* EXEC CICS GETMAIN
 20372*        LENGTH    (840)
 20373*        SET       (ADDRESS OF PLAN-RECORDS)
 20374*    END-EXEC.
 20375     MOVE 840
 20376       TO DFHEIV11
 20377*    MOVE '," L                  $   #00019346' TO DFHEIV0
 20378     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20379     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20380     MOVE X'2020233030303139333436' TO DFHEIV0(25:11)
 20381     CALL 'kxdfhei1' USING DFHEIV0,
 20382           DFHEIV20,
 20383           DFHEIV11,
 20384           DFHEIV99
 20385     SET ADDRESS OF PLAN-RECORDS TO
 20386         DFHEIV20
 20387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20388
 20389
 20390     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20391
 20392 8557-EXIT.
 20393     EXIT.
 20394
 20395 8560-GETMAIN.
 20396
 20397* EXEC CICS GETMAIN
 20398*        LENGTH    (2000)
 20399*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20400*    END-EXEC.
 20401     MOVE 2000
 20402       TO DFHEIV11
 20403*    MOVE '," L                  $   #00019357' TO DFHEIV0
 20404     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20405     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20406     MOVE X'2020233030303139333537' TO DFHEIV0(25:11)
 20407     CALL 'kxdfhei1' USING DFHEIV0,
 20408           DFHEIV20,
 20409           DFHEIV11,
 20410           DFHEIV99
 20411     SET ADDRESS OF ACCOUNT-MASTER TO
 20412         DFHEIV20
 20413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20414
 20415
 20416     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20417
 20418 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 378
* EL050.cbl
 20419     EXIT.
 20420
 20421 8570-START-ACCOUNT-MASTER.
 20422
 20423* EXEC CICS HANDLE CONDITION
 20424*        NOTFND    (0199-ACCT-NOT-FOUND)
 20425*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20426*    END-EXEC.
 20427*    MOVE '"$I''                  ! 6 #00019368' TO DFHEIV0
 20428     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20430     MOVE X'3620233030303139333638' TO DFHEIV0(25:11)
 20431     CALL 'kxdfhei1' USING DFHEIV0
 20432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20433
 20434
 20435
 20436* EXEC CICS STARTBR
 20437*        DATASET    (ACCT-ID)
 20438*        RIDFLD     (ERACCT-KEY)
 20439*        GTEQ
 20440*    END-EXEC.
 20441     MOVE 0
 20442       TO DFHEIV11
 20443*    MOVE '&,         G          &   #00019373' TO DFHEIV0
 20444     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20446     MOVE X'2020233030303139333733' TO DFHEIV0(25:11)
 20447     CALL 'kxdfhei1' USING DFHEIV0,
 20448           ACCT-ID,
 20449           ERACCT-KEY,
 20450           DFHEIV99,
 20451           DFHEIV11,
 20452           DFHEIV99
 20453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20454
 20455
 20456 8570-EXIT.
 20457     EXIT.
 20458
 20459 8580-READ-ACCOUNT-MASTER.
 20460
 20461* EXEC CICS HANDLE CONDITION
 20462*        NOTFND    (0199-ACCT-NOT-FOUND)
 20463*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20464*    END-EXEC.
 20465*    MOVE '"$I''                  ! 7 #00019383' TO DFHEIV0
 20466     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20468     MOVE X'3720233030303139333833' TO DFHEIV0(25:11)
 20469     CALL 'kxdfhei1' USING DFHEIV0
 20470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20471
 20472
 20473
 20474* EXEC CICS READNEXT
 20475*        DATASET     (ACCT-ID)
 20476*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 379
* EL050.cbl
 20477*        RIDFLD      (ERACCT-KEY)
 20478*    END-EXEC.
 20479     MOVE LENGTH OF
 20480      ACCOUNT-MASTER
 20481       TO DFHEIV12
 20482     MOVE 0
 20483       TO DFHEIV11
 20484*    MOVE '&.IL                  )   #00019388' TO DFHEIV0
 20485     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20486     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20487     MOVE X'2020233030303139333838' TO DFHEIV0(25:11)
 20488     CALL 'kxdfhei1' USING DFHEIV0,
 20489           ACCT-ID,
 20490           ACCOUNT-MASTER,
 20491           DFHEIV12,
 20492           ERACCT-KEY,
 20493           DFHEIV99,
 20494           DFHEIV11,
 20495           DFHEIV99,
 20496           DFHEIV99
 20497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20498
 20499
 20500 8580-EXIT.
 20501     EXIT.
 20502
 20503 8582-READ-COMPENSATION-MASTER.
 20504
 20505* EXEC CICS HANDLE CONDITION
 20506*        NOTFND    (8582-COMP-NOT-FOUND)
 20507*        ENDFILE   (8582-COMP-NOT-FOUND)
 20508*    END-EXEC.
 20509*    MOVE '"$I''                  ! 8 #00019398' TO DFHEIV0
 20510     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20512     MOVE X'3820233030303139333938' TO DFHEIV0(25:11)
 20513     CALL 'kxdfhei1' USING DFHEIV0
 20514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20515
 20516
 20517
 20518* EXEC CICS READ
 20519*        DATASET     (COMP-ID)
 20520*        INTO        (COMPENSATION-MASTER)
 20521*        RIDFLD      (ERCOMP-KEY)
 20522*    END-EXEC.
 20523     MOVE LENGTH OF
 20524      COMPENSATION-MASTER
 20525       TO DFHEIV11
 20526*    MOVE '&"IL       E          (   #00019403' TO DFHEIV0
 20527     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20529     MOVE X'2020233030303139343033' TO DFHEIV0(25:11)
 20530     CALL 'kxdfhei1' USING DFHEIV0,
 20531           COMP-ID,
 20532           COMPENSATION-MASTER,
 20533           DFHEIV11,
 20534           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 380
* EL050.cbl
 20535           DFHEIV99,
 20536           DFHEIV99,
 20537           DFHEIV99
 20538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20539
 20540
 20541     MOVE 'Y'                    TO COMP-MASTER-SW
 20542
 20543     GO TO 8582-EXIT
 20544     .
 20545 8582-COMP-NOT-FOUND.
 20546
 20547     MOVE 'N'                    TO COMP-MASTER-SW.
 20548
 20549 8582-EXIT.
 20550     EXIT.
 20551
 20552 8583-READ-ERAGTC.
 20553
 20554* EXEC CICS HANDLE CONDITION
 20555*        NOTFND    (8583-AGTC-NOT-FOUND)
 20556*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20557*    END-EXEC.
 20558*    MOVE '"$I''                  ! 9 #00019421' TO DFHEIV0
 20559     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20561     MOVE X'3920233030303139343231' TO DFHEIV0(25:11)
 20562     CALL 'kxdfhei1' USING DFHEIV0
 20563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20564
 20565
 20566
 20567* EXEC CICS STARTBR
 20568*        DATASET    (AGTC-ID)
 20569*        RIDFLD     (ERAGTC-KEY)
 20570*        GTEQ
 20571*    END-EXEC.
 20572     MOVE 0
 20573       TO DFHEIV11
 20574*    MOVE '&,         G          &   #00019426' TO DFHEIV0
 20575     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20576     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20577     MOVE X'2020233030303139343236' TO DFHEIV0(25:11)
 20578     CALL 'kxdfhei1' USING DFHEIV0,
 20579           AGTC-ID,
 20580           ERAGTC-KEY,
 20581           DFHEIV99,
 20582           DFHEIV11,
 20583           DFHEIV99
 20584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20585
 20586
 20587 8583-READ-ERAGTC-NEXT.
 20588
 20589* EXEC CICS READNEXT
 20590*        DATASET     (AGTC-ID)
 20591*        INTO        (AGENT-COMMISSIONS)
 20592*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 381
* EL050.cbl
 20593*    END-EXEC.
 20594     MOVE LENGTH OF
 20595      AGENT-COMMISSIONS
 20596       TO DFHEIV12
 20597     MOVE 0
 20598       TO DFHEIV11
 20599*    MOVE '&.IL                  )   #00019433' TO DFHEIV0
 20600     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20601     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20602     MOVE X'2020233030303139343333' TO DFHEIV0(25:11)
 20603     CALL 'kxdfhei1' USING DFHEIV0,
 20604           AGTC-ID,
 20605           AGENT-COMMISSIONS,
 20606           DFHEIV12,
 20607           ERAGTC-KEY,
 20608           DFHEIV99,
 20609           DFHEIV11,
 20610           DFHEIV99,
 20611           DFHEIV99
 20612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20613
 20614
 20615*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20616
 20617     GO TO 8583-EXIT
 20618     .
 20619 8583-AGTC-NOT-FOUND.
 20620
 20621     MOVE 'N'                    TO AGTC-MASTER-SW.
 20622
 20623 8583-EXIT.
 20624     EXIT.
 20625
 20626 8584-READ-BANK-CROSS-REF.
 20627
 20628* EXEC CICS HANDLE CONDITION
 20629*        NOTFND    (8584-BXRF-NOT-FOUND)
 20630*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20631*    END-EXEC.
 20632*    MOVE '"$I''                  ! : #00019451' TO DFHEIV0
 20633     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20635     MOVE X'3A20233030303139343531' TO DFHEIV0(25:11)
 20636     CALL 'kxdfhei1' USING DFHEIV0
 20637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20638
 20639
 20640
 20641* EXEC CICS READ
 20642*        DATASET     (BXRF-ID)
 20643*        INTO        (BANK-CROSS-REFERENCE)
 20644*        RIDFLD      (ERBXRF-KEY)
 20645*        LENGTH      (BXRF-REC-LENGTH)
 20646*    END-EXEC.
 20647*    MOVE '&"IL       E          (   #00019456' TO DFHEIV0
 20648     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20649     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20650     MOVE X'2020233030303139343536' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 382
* EL050.cbl
 20651     CALL 'kxdfhei1' USING DFHEIV0,
 20652           BXRF-ID,
 20653           BANK-CROSS-REFERENCE,
 20654           BXRF-REC-LENGTH,
 20655           ERBXRF-KEY,
 20656           DFHEIV99,
 20657           DFHEIV99,
 20658           DFHEIV99
 20659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20660
 20661
 20662     MOVE 'Y'                    TO BXRF-MASTER-SW
 20663
 20664     GO TO 8584-EXIT
 20665     .
 20666 8584-BXRF-NOT-FOUND.
 20667
 20668     MOVE 'N'                    TO BXRF-MASTER-SW.
 20669
 20670 8584-EXIT.
 20671     EXIT.
 20672
 20673 8585-READ-PLAN-MASTER.
 20674
 20675
 20676* EXEC CICS HANDLE CONDITION
 20677*        NOTFND    (8585-PLAN-NOT-FOUND)
 20678*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20679*    END-EXEC.
 20680*    MOVE '"$I''                  ! ; #00019476' TO DFHEIV0
 20681     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20683     MOVE X'3B20233030303139343736' TO DFHEIV0(25:11)
 20684     CALL 'kxdfhei1' USING DFHEIV0
 20685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20686
 20687
 20688
 20689* EXEC CICS READ
 20690*        DATASET     (PLAN-ID)
 20691*        INTO        (PLAN-MASTER)
 20692*        RIDFLD      (ERPLAN-KEY)
 20693*    END-EXEC.
 20694     MOVE LENGTH OF
 20695      PLAN-MASTER
 20696       TO DFHEIV11
 20697*    MOVE '&"IL       E          (   #00019481' TO DFHEIV0
 20698     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20700     MOVE X'2020233030303139343831' TO DFHEIV0(25:11)
 20701     CALL 'kxdfhei1' USING DFHEIV0,
 20702           PLAN-ID,
 20703           PLAN-MASTER,
 20704           DFHEIV11,
 20705           ERPLAN-KEY,
 20706           DFHEIV99,
 20707           DFHEIV99,
 20708           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 383
* EL050.cbl
 20709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20710
 20711
 20712     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20713
 20714     GO TO 8585-EXIT.
 20715
 20716 8585-PLAN-NOT-FOUND.
 20717
 20718     MOVE 'N'                    TO PLAN-MASTER-SW.
 20719
 20720 8585-EXIT.
 20721     EXIT.
 20722
 20723 8586-READ-LOAN-OFFICER.
 20724
 20725* EXEC CICS READ
 20726*        DATASET     (LOFC-ID)
 20727*        INTO        (LOAN-OFFICER-MASTER)
 20728*        RIDFLD      (ERLOFC-KEY)
 20729*        RESP        (WS-RESPONSE)
 20730*    END-EXEC
 20731     MOVE LENGTH OF
 20732      LOAN-OFFICER-MASTER
 20733       TO DFHEIV11
 20734*    MOVE '&"IL       E          (  N#00019499' TO DFHEIV0
 20735     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20737     MOVE X'204E233030303139343939' TO DFHEIV0(25:11)
 20738     CALL 'kxdfhei1' USING DFHEIV0,
 20739           LOFC-ID,
 20740           LOAN-OFFICER-MASTER,
 20741           DFHEIV11,
 20742           ERLOFC-KEY,
 20743           DFHEIV99,
 20744           DFHEIV99,
 20745           DFHEIV99
 20746     MOVE EIBRESP  TO WS-RESPONSE
 20747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20748
 20749     IF WS-RESP-NORMAL
 20750        MOVE 'Y'                 TO LOFC-MASTER-SW
 20751     ELSE
 20752        MOVE 'N'                 TO LOFC-MASTER-SW
 20753     END-IF
 20754     .
 20755 8586-EXIT.
 20756     EXIT.
 20757 8587-START-ERPDEF.
 20758
 20759* EXEC CICS STARTBR
 20760*       DATASET   (PDEF-ID)
 20761*       RIDFLD    (ERPDEF-KEY)
 20762*       GTEQ
 20763*       RESP      (WS-RESPONSE)
 20764*    END-EXEC
 20765     MOVE 0
 20766       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 384
* EL050.cbl
 20767*    MOVE '&,         G          &  N#00019515' TO DFHEIV0
 20768     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20769     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20770     MOVE X'204E233030303139353135' TO DFHEIV0(25:11)
 20771     CALL 'kxdfhei1' USING DFHEIV0,
 20772           PDEF-ID,
 20773           ERPDEF-KEY,
 20774           DFHEIV99,
 20775           DFHEIV11,
 20776           DFHEIV99
 20777     MOVE EIBRESP  TO WS-RESPONSE
 20778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20779     IF WS-RESP-NORMAL
 20780        MOVE 'Y'                 TO PDEF-MASTER-SW
 20781     ELSE
 20782        MOVE 'N'                 TO PDEF-MASTER-SW
 20783     END-IF
 20784     .
 20785 8587-EXIT.
 20786     EXIT.
 20787 8588-READ-ERPDEF.
 20788
 20789* EXEC CICS READNEXT
 20790*       DATASET   (PDEF-ID)
 20791*       RIDFLD    (ERPDEF-KEY)
 20792*       INTO      (PRODUCT-MASTER)
 20793*       RESP      (WS-RESPONSE)
 20794*    END-EXEC
 20795     MOVE LENGTH OF
 20796      PRODUCT-MASTER
 20797       TO DFHEIV12
 20798     MOVE 0
 20799       TO DFHEIV11
 20800*    MOVE '&.IL                  )  N#00019530' TO DFHEIV0
 20801     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20802     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20803     MOVE X'204E233030303139353330' TO DFHEIV0(25:11)
 20804     CALL 'kxdfhei1' USING DFHEIV0,
 20805           PDEF-ID,
 20806           PRODUCT-MASTER,
 20807           DFHEIV12,
 20808           ERPDEF-KEY,
 20809           DFHEIV99,
 20810           DFHEIV11,
 20811           DFHEIV99,
 20812           DFHEIV99
 20813     MOVE EIBRESP  TO WS-RESPONSE
 20814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20815     IF WS-RESP-NORMAL
 20816        MOVE 'Y'                 TO PDEF-MASTER-SW
 20817     ELSE
 20818        MOVE 'N'                 TO PDEF-MASTER-SW
 20819     END-IF
 20820     .
 20821 8588-EXIT.
 20822     EXIT.
 20823 8589-ENDBR-ERPDEF.
 20824
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 385
* EL050.cbl
 20825* EXEC CICS ENDBR
 20826*       DATASET   (PDEF-ID)
 20827*    END-EXEC
 20828     MOVE 0
 20829       TO DFHEIV11
 20830*    MOVE '&2                    $   #00019545' TO DFHEIV0
 20831     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20832     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20833     MOVE X'2020233030303139353435' TO DFHEIV0(25:11)
 20834     CALL 'kxdfhei1' USING DFHEIV0,
 20835           PDEF-ID,
 20836           DFHEIV11,
 20837           DFHEIV99
 20838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20839     .
 20840 8589-EXIT.
 20841     EXIT.
 20842 8590-READ-CERT-MASTER.
 20843     IF PB-COMPANY-ID = 'UCL'
 20844         GO TO 8690-READ-CERT-MASTER-UCL.
 20845
 20846
 20847* EXEC CICS HANDLE CONDITION
 20848*         NOTFND    (0299-CERT-NOT-FOUND)
 20849*    END-EXEC.
 20850*    MOVE '"$I                   ! < #00019555' TO DFHEIV0
 20851     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20853     MOVE X'3C20233030303139353535' TO DFHEIV0(25:11)
 20854     CALL 'kxdfhei1' USING DFHEIV0
 20855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20856
 20857
 20858
 20859* EXEC CICS READ
 20860*        DATASET     (CERT-ID)
 20861*        INTO        (CERTIFICATE-MASTER)
 20862*        RIDFLD      (ELCERT-KEY)
 20863*        UPDATE
 20864*    END-EXEC.
 20865     MOVE LENGTH OF
 20866      CERTIFICATE-MASTER
 20867       TO DFHEIV11
 20868*    MOVE '&"IL       EU         (   #00019559' TO DFHEIV0
 20869     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20870     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20871     MOVE X'2020233030303139353539' TO DFHEIV0(25:11)
 20872     CALL 'kxdfhei1' USING DFHEIV0,
 20873           CERT-ID,
 20874           CERTIFICATE-MASTER,
 20875           DFHEIV11,
 20876           ELCERT-KEY,
 20877           DFHEIV99,
 20878           DFHEIV99,
 20879           DFHEIV99
 20880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20881
 20882
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 386
* EL050.cbl
 20883 8590-EXIT.
 20884     EXIT.
 20885
 20886 8690-READ-CERT-MASTER-UCL.
 20887
 20888* EXEC CICS HANDLE CONDITION
 20889*         NOTFND    (8700-READ-CERT-MASTER)
 20890*    END-EXEC.
 20891*    MOVE '"$I                   ! = #00019570' TO DFHEIV0
 20892     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20893     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20894     MOVE X'3D20233030303139353730' TO DFHEIV0(25:11)
 20895     CALL 'kxdfhei1' USING DFHEIV0
 20896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20897
 20898
 20899 8690-READ-CERT-CONT.
 20900
 20901* EXEC CICS READ
 20902*        DATASET     (CERT-ID)
 20903*        INTO        (CERTIFICATE-MASTER)
 20904*        RIDFLD      (ELCERT-KEY)
 20905*        UPDATE
 20906*    END-EXEC.
 20907     MOVE LENGTH OF
 20908      CERTIFICATE-MASTER
 20909       TO DFHEIV11
 20910*    MOVE '&"IL       EU         (   #00019575' TO DFHEIV0
 20911     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20912     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20913     MOVE X'2020233030303139353735' TO DFHEIV0(25:11)
 20914     CALL 'kxdfhei1' USING DFHEIV0,
 20915           CERT-ID,
 20916           CERTIFICATE-MASTER,
 20917           DFHEIV11,
 20918           ELCERT-KEY,
 20919           DFHEIV99,
 20920           DFHEIV99,
 20921           DFHEIV99
 20922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20923
 20924
 20925     GO TO 8590-EXIT.
 20926
 20927 8700-READ-CERT-MASTER.
 20928     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20929     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20930
 20931* EXEC CICS HANDLE CONDITION
 20932*         DUPKEY    (8720-COMP-ACCOUNTS)
 20933*         ENDFILE   (8730-END-BROWSE)
 20934*         NOTFND    (8740-NOT-FOUND)
 20935*    END-EXEC.
 20936*    MOVE '"$$''I                 ! > #00019587' TO DFHEIV0
 20937     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20939     MOVE X'3E20233030303139353837' TO DFHEIV0(25:11)
 20940     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 387
* EL050.cbl
 20941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20942
 20943
 20944
 20945* EXEC CICS STARTBR
 20946*        DATASET     ('ELCERT5')
 20947*        RIDFLD      (ELCERT2-KEY)
 20948*        EQUAL
 20949*    END-EXEC.
 20950     MOVE 'ELCERT5' TO DFHEIV1
 20951     MOVE 0
 20952       TO DFHEIV11
 20953*    MOVE '&,         E          &   #00019593' TO DFHEIV0
 20954     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20955     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20956     MOVE X'2020233030303139353933' TO DFHEIV0(25:11)
 20957     CALL 'kxdfhei1' USING DFHEIV0,
 20958           DFHEIV1,
 20959           ELCERT2-KEY,
 20960           DFHEIV99,
 20961           DFHEIV11,
 20962           DFHEIV99
 20963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20964
 20965
 20966 8710-READ-NEXT.
 20967
 20968* EXEC CICS READNEXT
 20969*        DATASET     ('ELCERT5')
 20970*        INTO        (CERTIFICATE-MASTER)
 20971*        RIDFLD      (ELCERT2-KEY)
 20972*    END-EXEC.
 20973     MOVE LENGTH OF
 20974      CERTIFICATE-MASTER
 20975       TO DFHEIV12
 20976     MOVE 'ELCERT5' TO DFHEIV1
 20977     MOVE 0
 20978       TO DFHEIV11
 20979*    MOVE '&.IL                  )   #00019600' TO DFHEIV0
 20980     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20981     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20982     MOVE X'2020233030303139363030' TO DFHEIV0(25:11)
 20983     CALL 'kxdfhei1' USING DFHEIV0,
 20984           DFHEIV1,
 20985           CERTIFICATE-MASTER,
 20986           DFHEIV12,
 20987           ELCERT2-KEY,
 20988           DFHEIV99,
 20989           DFHEIV11,
 20990           DFHEIV99,
 20991           DFHEIV99
 20992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20993
 20994
 20995 8720-COMP-ACCOUNTS.
 20996
 20997* EXEC CICS ENTER
 20998*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 388
* EL050.cbl
 20999*         FROM (PB-C-LAST-NAME)
 21000*    END-EXEC.
 21001     MOVE 001
 21002       TO DFHEIV11
 21003*    MOVE ':$F                   %   #00019607' TO DFHEIV0
 21004     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21005     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21006     MOVE X'2020233030303139363037' TO DFHEIV0(25:11)
 21007     CALL 'kxdfhei1' USING DFHEIV0,
 21008           DFHEIV11,
 21009           PB-C-LAST-NAME,
 21010           DFHEIV99,
 21011           DFHEIV99
 21012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21013
 21014
 21015
 21016* EXEC CICS ENTER
 21017*         TRACEID (002)
 21018*         FROM (CM-INSURED-LAST-NAME)
 21019*    END-EXEC.
 21020     MOVE 002
 21021       TO DFHEIV11
 21022*    MOVE ':$F                   %   #00019612' TO DFHEIV0
 21023     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21024     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21025     MOVE X'2020233030303139363132' TO DFHEIV0(25:11)
 21026     CALL 'kxdfhei1' USING DFHEIV0,
 21027           DFHEIV11,
 21028           CM-INSURED-LAST-NAME,
 21029           DFHEIV99,
 21030           DFHEIV99
 21031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21032
 21033
 21034     IF PB-CERT-NO NOT = CM-CERT-NO
 21035         GO TO 8730-END-BROWSE.
 21036
 21037     IF PB-ACCOUNT = CM-ACCOUNT
 21038         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21039             MOVE ER-2799        TO WS-ERROR
 21040             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21041             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21042             GO TO 8730-END-BROWSE.
 21043
 21044     GO TO 8710-READ-NEXT.
 21045
 21046 8730-END-BROWSE.
 21047
 21048* EXEC CICS ENDBR
 21049*         DATASET    ('ELCERT5')
 21050*    END-EXEC.
 21051     MOVE 'ELCERT5' TO DFHEIV1
 21052     MOVE 0
 21053       TO DFHEIV11
 21054*    MOVE '&2                    $   #00019630' TO DFHEIV0
 21055     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21056     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 389
* EL050.cbl
 21057     MOVE X'2020233030303139363330' TO DFHEIV0(25:11)
 21058     CALL 'kxdfhei1' USING DFHEIV0,
 21059           DFHEIV1,
 21060           DFHEIV11,
 21061           DFHEIV99
 21062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21063
 21064
 21065 8740-NOT-FOUND.
 21066     GO TO 0299-CERT-NOT-FOUND.
 21067
 21068 8750-START-ELSTAT.
 21069
 21070* EXEC CICS STARTBR
 21071*       DATASET   (STAT-ID)
 21072*       RIDFLD    (ELSTAT-KEY)
 21073*       GTEQ
 21074*       RESP      (WS-RESPONSE)
 21075*    END-EXEC
 21076     MOVE 0
 21077       TO DFHEIV11
 21078*    MOVE '&,         G          &  N#00019638' TO DFHEIV0
 21079     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21080     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21081     MOVE X'204E233030303139363338' TO DFHEIV0(25:11)
 21082     CALL 'kxdfhei1' USING DFHEIV0,
 21083           STAT-ID,
 21084           ELSTAT-KEY,
 21085           DFHEIV99,
 21086           DFHEIV11,
 21087           DFHEIV99
 21088     MOVE EIBRESP  TO WS-RESPONSE
 21089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21090     IF WS-RESP-NORMAL
 21091        MOVE 'Y'                 TO STAT-MASTER-SW
 21092     ELSE
 21093        MOVE 'N'                 TO STAT-MASTER-SW
 21094     END-IF
 21095     .
 21096 8750-EXIT.
 21097     EXIT.
 21098 8752-READ-ELSTAT.
 21099
 21100* EXEC CICS READNEXT
 21101*       DATASET   (STAT-ID)
 21102*       RIDFLD    (ELSTAT-KEY)
 21103*       INTO      (STATE-FILE)
 21104*       RESP      (WS-RESPONSE)
 21105*    END-EXEC
 21106     MOVE LENGTH OF
 21107      STATE-FILE
 21108       TO DFHEIV12
 21109     MOVE 0
 21110       TO DFHEIV11
 21111*    MOVE '&.IL                  )  N#00019653' TO DFHEIV0
 21112     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21113     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21114     MOVE X'204E233030303139363533' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 390
* EL050.cbl
 21115     CALL 'kxdfhei1' USING DFHEIV0,
 21116           STAT-ID,
 21117           STATE-FILE,
 21118           DFHEIV12,
 21119           ELSTAT-KEY,
 21120           DFHEIV99,
 21121           DFHEIV11,
 21122           DFHEIV99,
 21123           DFHEIV99
 21124     MOVE EIBRESP  TO WS-RESPONSE
 21125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21126     IF WS-RESP-NORMAL
 21127        MOVE 'Y'                 TO STAT-MASTER-SW
 21128     ELSE
 21129        MOVE 'N'                 TO STAT-MASTER-SW
 21130     END-IF
 21131     .
 21132 8752-EXIT.
 21133     EXIT.
 21134 8800-GET-COMP-RATE.
 21135     MOVE +1 TO IB.
 21136     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21137         ADD +9 TO IB
 21138         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21139             ADD +9 TO IB
 21140             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21141                MOVE ZEROS       TO WS-WK-RATE
 21142                GO TO 8800-EXIT.
 21143
 21144     IF PB-I-AGE GREATER CT-AGE (1)
 21145         ADD +3 TO IB
 21146         IF PB-I-AGE GREATER CT-AGE (2)
 21147             ADD +3 TO IB
 21148             IF PB-I-AGE GREATER CT-AGE (3)
 21149                MOVE ZEROS       TO WS-WK-RATE
 21150                GO TO 8800-EXIT.
 21151
 21152     IF WS-WORK-TERM GREATER CT-TRM (1)
 21153         ADD +1 TO IB
 21154         IF WS-WORK-TERM GREATER CT-TRM (2)
 21155             ADD +1 TO IB
 21156             IF WS-WORK-TERM GREATER CT-TRM (3)
 21157                MOVE ZEROS       TO WS-WK-RATE
 21158                GO TO 8800-EXIT.
 21159
 21160     IF CT-RT (IB) NOT NUMERIC
 21161         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21162         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21163         GO TO 8800-GET-COMP-RATE.
 21164
 21165     MOVE CT-RT (IB) TO WS-WK-RATE.
 21166
 21167 8800-EXIT.
 21168     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 391
* EL050.cbl
 21170 8900-ADDRESS-FILE.
 21171     IF ERACCT-FILE-ADDRESSED
 21172         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21173         GO TO 8900-ADDRESS-EXIT.
 21174
 21175     IF ELCNTL-FILE-ADDRESSED
 21176         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21177         GO TO 8900-ADDRESS-EXIT.
 21178
 21179     IF ERPLAN-FILE-ADDRESSED
 21180         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21181         GO TO 8900-ADDRESS-EXIT.
 21182
 21183     IF ERFORM-FILE-ADDRESSED
 21184         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21185         GO TO 8900-ADDRESS-EXIT.
 21186
 21187 8900-ADDRESS-EXIT.
 21188     EXIT.
 21189
 21190 9000-READ-CONTROL.
 21191
 21192* EXEC CICS HANDLE CONDITION
 21193*        NOTFND    (9000-NOTFND)
 21194*    END-EXEC.
 21195*    MOVE '"$I                   ! ? #00019724' TO DFHEIV0
 21196     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21198     MOVE X'3F20233030303139373234' TO DFHEIV0(25:11)
 21199     CALL 'kxdfhei1' USING DFHEIV0
 21200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21201
 21202
 21203
 21204* EXEC CICS READ
 21205*        DATASET     (CNTL-ID)
 21206*        SET         (ADDRESS OF CONTROL-FILE)
 21207*        RIDFLD      (ELCNTL-KEY)
 21208*        GTEQ
 21209*    END-EXEC.
 21210*    MOVE '&"S        G          (   #00019728' TO DFHEIV0
 21211     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21213     MOVE X'2020233030303139373238' TO DFHEIV0(25:11)
 21214     CALL 'kxdfhei1' USING DFHEIV0,
 21215           CNTL-ID,
 21216           DFHEIV20,
 21217           DFHEIV99,
 21218           ELCNTL-KEY,
 21219           DFHEIV99,
 21220           DFHEIV99,
 21221           DFHEIV99
 21222     SET ADDRESS OF CONTROL-FILE TO
 21223         DFHEIV20
 21224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21225
 21226
 21227     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 392
* EL050.cbl
 21228
 21229 9000-NOTFND.
 21230     IF RC-SW-1 = '1'
 21231        MOVE ER-2616              TO WS-ERROR
 21232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21233        GO TO 9000-EXIT.
 21234
 21235     IF RC-SW-1 = '2'
 21236        MOVE ER-2602              TO WS-ERROR
 21237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21238
 21239 9000-EXIT.
 21240      EXIT.
 21241
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 393
* EL050.cbl
 21243 9100-READ-CONTROL.
 21244
 21245* EXEC CICS HANDLE CONDITION
 21246*        NOTFND  (9100-NOTFND)
 21247*        ENDFILE (9100-NOTFND)
 21248*    END-EXEC.
 21249*    MOVE '"$I''                  ! @ #00019752' TO DFHEIV0
 21250     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21252     MOVE X'4020233030303139373532' TO DFHEIV0(25:11)
 21253     CALL 'kxdfhei1' USING DFHEIV0
 21254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21255
 21256
 21257
 21258* EXEC CICS READ
 21259*        DATASET     (CNTL-ID)
 21260*        INTO        (CONTROL-FILE)
 21261*        RIDFLD      (ELCNTL-KEY)
 21262*        GTEQ
 21263*    END-EXEC.
 21264     MOVE LENGTH OF
 21265      CONTROL-FILE
 21266       TO DFHEIV11
 21267*    MOVE '&"IL       G          (   #00019757' TO DFHEIV0
 21268     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21269     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21270     MOVE X'2020233030303139373537' TO DFHEIV0(25:11)
 21271     CALL 'kxdfhei1' USING DFHEIV0,
 21272           CNTL-ID,
 21273           CONTROL-FILE,
 21274           DFHEIV11,
 21275           ELCNTL-KEY,
 21276           DFHEIV99,
 21277           DFHEIV99,
 21278           DFHEIV99
 21279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21280
 21281
 21282     GO TO 9100-EXIT.
 21283
 21284 9100-NOTFND.
 21285     IF RC-SW-2 = '0'
 21286        MOVE '1'                  TO STATE-RECORD-ERROR
 21287        GO TO 9100-EXIT
 21288     END-IF
 21289     IF RC-SW-2 = '1'
 21290        MOVE '1'                  TO LF-BENEFIT-ERROR
 21291        MOVE ER-2604              TO WS-ERROR
 21292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21293        GO TO 9100-EXIT.
 21294
 21295     IF RC-SW-2 = '2'
 21296        MOVE '1'                  TO AH-BENEFIT-ERROR
 21297        MOVE ER-2605              TO WS-ERROR
 21298        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21299        GO TO 9100-EXIT.
 21300
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 394
* EL050.cbl
 21301     IF RC-SW-2 = '3'
 21302         MOVE ER-2603           TO WS-ERROR
 21303         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21304         GO TO 9100-EXIT.
 21305
 21306     IF RC-SW-2 = '4'
 21307         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21308         GO TO 9100-EXIT.
 21309
 21310     IF RC-SW-2 = '5'
 21311         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21312         IF WS-AH-INPUT-CD-1 = SPACE
 21313             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21314         ELSE
 21315             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21316
 21317 9100-EXIT.
 21318      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 395
* EL050.cbl
 21320 9200-CONTROL-GETMAIN.
 21321
 21322* EXEC CICS GETMAIN
 21323*         LENGTH   (750)
 21324*         SET      (ADDRESS OF CONTROL-FILE)
 21325*    END-EXEC.
 21326     MOVE 750
 21327       TO DFHEIV11
 21328*    MOVE '," L                  $   #00019803' TO DFHEIV0
 21329     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21330     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21331     MOVE X'2020233030303139383033' TO DFHEIV0(25:11)
 21332     CALL 'kxdfhei1' USING DFHEIV0,
 21333           DFHEIV20,
 21334           DFHEIV11,
 21335           DFHEIV99
 21336     SET ADDRESS OF CONTROL-FILE TO
 21337         DFHEIV20
 21338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21339
 21340
 21341     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21342
 21343 9200-EXIT.
 21344     EXIT.
 21345
 21346 9250-UNLOCK-RETURN.
 21347
 21348* EXEC CICS UNLOCK
 21349*        DATASET   (CERT-ID)
 21350*    END-EXEC.
 21351*    MOVE '&*                    #   #00019814' TO DFHEIV0
 21352     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21353     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21354     MOVE X'2020233030303139383134' TO DFHEIV0(25:11)
 21355     CALL 'kxdfhei1' USING DFHEIV0,
 21356           CERT-ID,
 21357           DFHEIV99
 21358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21359
 21360
 21361 9300-ABEND.
 21362     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21363
 21364
 21365* EXEC CICS LINK
 21366*        PROGRAM   ('EL004')
 21367*        COMMAREA  (WS-ERROR-LINE)
 21368*        LENGTH    (72)
 21369*    END-EXEC.
 21370     MOVE 'EL004' TO DFHEIV1
 21371     MOVE 72
 21372       TO DFHEIV11
 21373*    MOVE '."C                   (   #00019821' TO DFHEIV0
 21374     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21376     MOVE X'2020233030303139383231' TO DFHEIV0(25:11)
 21377     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 396
* EL050.cbl
 21378           DFHEIV1,
 21379           WS-ERROR-LINE,
 21380           DFHEIV11,
 21381           DFHEIV99,
 21382           DFHEIV99,
 21383           DFHEIV99,
 21384           DFHEIV99
 21385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21386
 21387
 21388     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21389
 21390
 21391* EXEC CICS ABEND
 21392*        ABCODE ('EL50')
 21393*    END-EXEC.
 21394     MOVE 'EL50' TO DFHEIV5
 21395*    MOVE '.,A                   "   #00019829' TO DFHEIV0
 21396     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21397     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21398     MOVE X'2020233030303139383239' TO DFHEIV0(25:11)
 21399     CALL 'kxdfhei1' USING DFHEIV0,
 21400           DFHEIV5
 21401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21402
 21403
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 397
* EL050.cbl
 21405
 21406******************************************************************
 21407*                                                                *
 21408*            E R R O R   F O R M A T   R O U T I N E             *
 21409*                                                                *
 21410******************************************************************
 21411
 21412 9900-ERROR-FORMAT.
 21413
 21414     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21415                    PB-COMMON-ERROR (2) OR
 21416                    PB-COMMON-ERROR (3) OR
 21417                    PB-COMMON-ERROR (4) OR
 21418                    PB-COMMON-ERROR (5) OR
 21419                    PB-COMMON-ERROR (6) OR
 21420                    PB-COMMON-ERROR (7) OR
 21421                    PB-COMMON-ERROR (8) OR
 21422                    PB-COMMON-ERROR (9) OR
 21423                    PB-COMMON-ERROR (10)
 21424        GO TO 9900-EXIT.
 21425
 21426     IF PB-NO-OF-ERRORS = +10
 21427        GO TO 9900-EXIT.
 21428
 21429     ADD +1  TO PB-NO-OF-ERRORS.
 21430     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21431                                       (PB-NO-OF-ERRORS).
 21432 9900-EXIT.
 21433     EXIT.
 21434
 21435 9990-RETURN.
 21436     IF BROWSE-STARTED
 21437
 21438* EXEC CICS ENDBR
 21439*            DATASET  (ACCT-ID)
 21440*       END-EXEC.
 21441     MOVE 0
 21442       TO DFHEIV11
 21443*    MOVE '&2                    $   #00019866' TO DFHEIV0
 21444     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21445     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21446     MOVE X'2020233030303139383636' TO DFHEIV0(25:11)
 21447     CALL 'kxdfhei1' USING DFHEIV0,
 21448           ACCT-ID,
 21449           DFHEIV11,
 21450           DFHEIV99
 21451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21452
 21453
 21454 9990-EXIT.
 21455     EXIT.
 21456
 21457
 21458****Check for CRTO record, add one if not found.
 21459 9991-CHECK-FOR-ELCRTO.
 21460
 21461* EXEC CICS HANDLE CONDITION
 21462*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 398
* EL050.cbl
 21463*         ENDFILE (9991-CRTO-NOT-FOUND)
 21464*     END-EXEC.
 21465*    MOVE '"$I''                  ! A #00019876' TO DFHEIV0
 21466     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21468     MOVE X'4120233030303139383736' TO DFHEIV0(25:11)
 21469     CALL 'kxdfhei1' USING DFHEIV0
 21470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21471
 21472     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21473     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21474     MOVE +0                     TO ELCRTO-SEQ-NO
 21475
 21476
 21477* EXEC CICS READ
 21478*       DATASET   ('ELCRTO')
 21479*       INTO      (ORIGINAL-CERTIFICATE)
 21480*       RIDFLD    (ELCRTO-KEY)
 21481*       GTEQ
 21482*       RESP      (WS-RESPONSE)
 21483*    END-EXEC
 21484     MOVE LENGTH OF
 21485      ORIGINAL-CERTIFICATE
 21486       TO DFHEIV11
 21487     MOVE 'ELCRTO' TO DFHEIV1
 21488*    MOVE '&"IL       G          (  N#00019884' TO DFHEIV0
 21489     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21491     MOVE X'204E233030303139383834' TO DFHEIV0(25:11)
 21492     CALL 'kxdfhei1' USING DFHEIV0,
 21493           DFHEIV1,
 21494           ORIGINAL-CERTIFICATE,
 21495           DFHEIV11,
 21496           ELCRTO-KEY,
 21497           DFHEIV99,
 21498           DFHEIV99,
 21499           DFHEIV99
 21500     MOVE EIBRESP  TO WS-RESPONSE
 21501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21502
 21503     IF WS-RESP-NORMAL
 21504        AND (OC-CONTROL-PRIMARY (1:33) =
 21505                 PB-CONTROL-BY-ACCOUNT (1:33))
 21506        AND (OC-RECORD-TYPE =  'I')
 21507           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21508               GO TO 9991-CHECK-INDICATORS
 21509           ELSE
 21510               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21511               GO TO 9991-CRTO-ADD-REC
 21512           END-IF
 21513     END-IF.
 21514
 21515 9991-CRTO-NOT-FOUND.
 21516
 21517     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21518     MOVE 'OC'                TO OC-RECORD-ID
 21519     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21520                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 399
* EL050.cbl
 21521     MOVE +4096               TO OC-KEY-SEQ-NO.
 21522
 21523 9991-CRTO-ADD-REC.
 21524
 21525     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21526     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21527     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21528     MOVE 'I'                 TO OC-RECORD-TYPE
 21529     IF PB-ISSUE
 21530         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21531         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21532         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21533         MOVE PB-I-AGE               TO OC-INS-AGE
 21534         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21535         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21536         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21537         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21538         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21539         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21540         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21541         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21542         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21543         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21544         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21545         IF PB-I-JOINT-COMMISSION > +0
 21546             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21547         ELSE
 21548             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21549         END-IF
 21550         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21551         MOVE +0                     TO OC-LF-CANCEL-AMT
 21552                                        OC-LF-ITD-CANCEL-AMT
 21553         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21554         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21555         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21556         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21557         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21558         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21559         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21560         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21561         MOVE +0                     TO OC-AH-CANCEL-AMT
 21562                                        OC-AH-ITD-CANCEL-AMT
 21563         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21564         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21565         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21566     ELSE
 21567         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21568         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21569         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21570         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21571         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21572         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21573         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21574         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21575         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21576          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21577             MOVE SPACES             TO OC-LF-BENCD
 21578             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 400
* EL050.cbl
 21579                                        OC-LF-BEN-AMT
 21580                                        OC-LF-PRM-AMT
 21581                                        OC-LF-ALT-BEN-AMT
 21582                                        OC-LF-ALT-PRM-AMT
 21583                                        OC-LF-COMM-PCT
 21584                                        OC-LF-CANCEL-AMT
 21585             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21586             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21587         ELSE
 21588             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21589             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21590             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21591             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21592             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21593             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21594             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21595             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21596             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21597             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21598         END-IF
 21599         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21600         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21601          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21602             MOVE SPACES             TO OC-AH-BENCD
 21603             MOVE ZEROS              TO OC-AH-TERM
 21604                                        OC-AH-BEN-AMT
 21605                                        OC-AH-PRM-AMT
 21606                                        OC-AH-COMM-PCT
 21607                                        OC-AH-CANCEL-AMT
 21608                                        OC-AH-CP
 21609             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21610             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21611         ELSE
 21612             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21613             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21614             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21615             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21616             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21617             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21618             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21619             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21620             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21621         END-IF
 21622         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21623         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21624         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21625         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21626     END-IF
 21627     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21628
 21629     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21630
 21631
 21632* EXEC CICS READ
 21633*         DATASET   (FILE-ERMAIL)
 21634*         RIDFLD    (MA-CONTROL-PRIMARY)
 21635*         INTO      (MAILING-DATA)
 21636*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 401
* EL050.cbl
 21637*    END-EXEC
 21638     MOVE LENGTH OF
 21639      MAILING-DATA
 21640       TO DFHEIV11
 21641*    MOVE '&"IL       E          (  N#00020020' TO DFHEIV0
 21642     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21643     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21644     MOVE X'204E233030303230303230' TO DFHEIV0(25:11)
 21645     CALL 'kxdfhei1' USING DFHEIV0,
 21646           FILE-ERMAIL,
 21647           MAILING-DATA,
 21648           DFHEIV11,
 21649           MA-CONTROL-PRIMARY,
 21650           DFHEIV99,
 21651           DFHEIV99,
 21652           DFHEIV99
 21653     MOVE EIBRESP  TO WS-RESPONSE
 21654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21655
 21656     IF WS-RESP-NORMAL
 21657         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21658     END-IF.
 21659
 21660     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21661     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21662
 21663
 21664* EXEC CICS READ
 21665*         DATASET  (CRTT-ID)
 21666*         RIDFLD   (WS-ELCRTT-KEY)
 21667*         INTO     (CERTIFICATE-TRAILERS)
 21668*         RESP     (WS-RESPONSE)
 21669*    END-EXEC
 21670     MOVE LENGTH OF
 21671      CERTIFICATE-TRAILERS
 21672       TO DFHEIV11
 21673*    MOVE '&"IL       E          (  N#00020034' TO DFHEIV0
 21674     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21675     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21676     MOVE X'204E233030303230303334' TO DFHEIV0(25:11)
 21677     CALL 'kxdfhei1' USING DFHEIV0,
 21678           CRTT-ID,
 21679           CERTIFICATE-TRAILERS,
 21680           DFHEIV11,
 21681           WS-ELCRTT-KEY,
 21682           DFHEIV99,
 21683           DFHEIV99,
 21684           DFHEIV99
 21685     MOVE EIBRESP  TO WS-RESPONSE
 21686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21687
 21688     IF WS-RESP-NORMAL
 21689         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21690         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21691     END-IF.
 21692
 21693
 21694* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 402
* EL050.cbl
 21695*       DATASET   ('ELCRTO')
 21696*       FROM      (ORIGINAL-CERTIFICATE)
 21697*       RIDFLD    (OC-CONTROL-PRIMARY)
 21698*       RESP      (WS-RESPONSE)
 21699*    END-EXEC.
 21700     MOVE LENGTH OF
 21701      ORIGINAL-CERTIFICATE
 21702       TO DFHEIV11
 21703     MOVE 'ELCRTO' TO DFHEIV1
 21704*    MOVE '&$ L                  ''  N#00020046' TO DFHEIV0
 21705     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21707     MOVE X'204E233030303230303436' TO DFHEIV0(25:11)
 21708     CALL 'kxdfhei1' USING DFHEIV0,
 21709           DFHEIV1,
 21710           ORIGINAL-CERTIFICATE,
 21711           DFHEIV11,
 21712           OC-CONTROL-PRIMARY,
 21713           DFHEIV99,
 21714           DFHEIV99
 21715     MOVE EIBRESP  TO WS-RESPONSE
 21716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21717
 21718
 21719     GO TO 9991-EXIT.
 21720
 21721 9991-CHECK-INDICATORS.
 21722
 21723     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21724         GO TO 9991-EXIT
 21725     END-IF.
 21726
 21727     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21728         GO TO 9991-EXIT
 21729     END-IF.
 21730
 21731
 21732* EXEC CICS READ
 21733*       DATASET   ('ELCRTO')
 21734*       INTO      (ORIGINAL-CERTIFICATE)
 21735*       RIDFLD    (OC-CONTROL-PRIMARY)
 21736*       UPDATE
 21737*       RESP      (WS-RESPONSE)
 21738*    END-EXEC
 21739     MOVE LENGTH OF
 21740      ORIGINAL-CERTIFICATE
 21741       TO DFHEIV11
 21742     MOVE 'ELCRTO' TO DFHEIV1
 21743*    MOVE '&"IL       EU         (  N#00020065' TO DFHEIV0
 21744     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21745     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21746     MOVE X'204E233030303230303635' TO DFHEIV0(25:11)
 21747     CALL 'kxdfhei1' USING DFHEIV0,
 21748           DFHEIV1,
 21749           ORIGINAL-CERTIFICATE,
 21750           DFHEIV11,
 21751           OC-CONTROL-PRIMARY,
 21752           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 403
* EL050.cbl
 21753           DFHEIV99,
 21754           DFHEIV99
 21755     MOVE EIBRESP  TO WS-RESPONSE
 21756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21757     IF WS-RESP-NORMAL
 21758        IF PB-ISSUE
 21759          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21760          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21761          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21762          MOVE PB-I-AGE               TO OC-INS-AGE
 21763          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21764          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21765          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21766          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21767          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21768          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21769          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21770          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21771          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21772          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21773          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21774          IF PB-I-JOINT-COMMISSION > +0
 21775              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21776          ELSE
 21777              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21778          END-IF
 21779          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21780          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21781          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21782          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21783          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21784          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21785          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21786          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21787          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21788
 21789          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21790
 21791* EXEC CICS READ
 21792*             DATASET   (FILE-ERMAIL)
 21793*             RIDFLD    (MA-CONTROL-PRIMARY)
 21794*             INTO      (MAILING-DATA)
 21795*             RESP      (WS-RESPONSE)
 21796*         END-EXEC
 21797     MOVE LENGTH OF
 21798      MAILING-DATA
 21799       TO DFHEIV11
 21800*    MOVE '&"IL       E          (  N#00020105' TO DFHEIV0
 21801     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21803     MOVE X'204E233030303230313035' TO DFHEIV0(25:11)
 21804     CALL 'kxdfhei1' USING DFHEIV0,
 21805           FILE-ERMAIL,
 21806           MAILING-DATA,
 21807           DFHEIV11,
 21808           MA-CONTROL-PRIMARY,
 21809           DFHEIV99,
 21810           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 404
* EL050.cbl
 21811           DFHEIV99
 21812     MOVE EIBRESP  TO WS-RESPONSE
 21813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21814          IF WS-RESP-NORMAL
 21815             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21816          END-IF
 21817
 21818          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21819          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21820
 21821* EXEC CICS READ
 21822*             DATASET  (CRTT-ID)
 21823*             RIDFLD   (WS-ELCRTT-KEY)
 21824*             INTO     (CERTIFICATE-TRAILERS)
 21825*             RESP     (WS-RESPONSE)
 21826*         END-EXEC
 21827     MOVE LENGTH OF
 21828      CERTIFICATE-TRAILERS
 21829       TO DFHEIV11
 21830*    MOVE '&"IL       E          (  N#00020117' TO DFHEIV0
 21831     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21832     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21833     MOVE X'204E233030303230313137' TO DFHEIV0(25:11)
 21834     CALL 'kxdfhei1' USING DFHEIV0,
 21835           CRTT-ID,
 21836           CERTIFICATE-TRAILERS,
 21837           DFHEIV11,
 21838           WS-ELCRTT-KEY,
 21839           DFHEIV99,
 21840           DFHEIV99,
 21841           DFHEIV99
 21842     MOVE EIBRESP  TO WS-RESPONSE
 21843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21844          IF WS-RESP-NORMAL
 21845             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21846                               OC-INS-AGE-DEFAULT-FLAG
 21847             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21848                               OC-JNT-AGE-DEFAULT-FLAG
 21849          END-IF
 21850
 21851        ELSE
 21852          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21853             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21854             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21855             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21856          END-IF
 21857          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21858             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21859             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21860             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21861          END-IF
 21862          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21863        END-IF
 21864
 21865* EXEC CICS REWRITE
 21866*          DATASET   ('ELCRTO')
 21867*          FROM      (ORIGINAL-CERTIFICATE)
 21868*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 405
* EL050.cbl
 21869*       END-EXEC
 21870     MOVE LENGTH OF
 21871      ORIGINAL-CERTIFICATE
 21872       TO DFHEIV11
 21873     MOVE 'ELCRTO' TO DFHEIV1
 21874*    MOVE '&& L                  %  N#00020143' TO DFHEIV0
 21875     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21876     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21877     MOVE X'204E233030303230313433' TO DFHEIV0(25:11)
 21878     CALL 'kxdfhei1' USING DFHEIV0,
 21879           DFHEIV1,
 21880           ORIGINAL-CERTIFICATE,
 21881           DFHEIV11,
 21882           DFHEIV99
 21883     MOVE EIBRESP  TO WS-RESPONSE
 21884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21885     END-IF.
 21886
 21887 9991-EXIT.
 21888     EXIT.
 21889
 21890
 21891 9999-RETURN.
 21892     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21893
 21894
 21895* EXEC CICS RETURN
 21896*    END-EXEC.
 21897*    MOVE '.(                    ''   #00020157' TO DFHEIV0
 21898     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21899     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21900     MOVE X'2020233030303230313537' TO DFHEIV0(25:11)
 21901     CALL 'kxdfhei1' USING DFHEIV0,
 21902           DFHEIV99,
 21903           DFHEIV99,
 21904           DFHEIV99,
 21905           DFHEIV99,
 21906           DFHEIV99,
 21907           DFHEIV99
 21908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21909
 21910
 21911
 21912* GOBACK.
 21913     MOVE '9%                    "   ' TO DFHEIV0
 21914     MOVE 'EL050' TO DFHEIV1
 21915     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21916     GOBACK.
 21917
 21918 9999-DFHBACK SECTION.
 21919     MOVE '9%                    "   ' TO DFHEIV0
 21920     MOVE 'EL050' TO DFHEIV1
 21921     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21922     GOBACK.
 21923 9999-DFHEXIT.
 21924     IF DFHEIGDJ EQUAL 0001
 21925         NEXT SENTENCE
 21926     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 406
* EL050.cbl
 21927         GO TO 9300-ABEND,
 21928               3990-FILES-NOT-OPEN
 21929         DEPENDING ON DFHEIGDI
 21930     ELSE IF DFHEIGDJ EQUAL 3
 21931         GO TO 6610-START-BROWSE,
 21932               6630-ERRESS-PROBLEM,
 21933               6630-END-OF-FILE
 21934         DEPENDING ON DFHEIGDI
 21935     ELSE IF DFHEIGDJ EQUAL 4
 21936         GO TO 6630-END-OF-FILE,
 21937               6630-ERRESS-PROBLEM,
 21938               6630-ERRESS-PROBLEM,
 21939               6630-END-OF-FILE
 21940         DEPENDING ON DFHEIGDI
 21941     ELSE IF DFHEIGDJ EQUAL 5
 21942         GO TO 6630-END-OF-FILE,
 21943               6630-END-OF-FILE,
 21944               6630-ERRESS-PROBLEM,
 21945               6630-ERRESS-PROBLEM
 21946         DEPENDING ON DFHEIGDI
 21947     ELSE IF DFHEIGDJ EQUAL 6
 21948         GO TO 6660-START-BROWSE,
 21949               6690-ERRESC-PROBLEM,
 21950               6690-ERRESC-PROBLEM,
 21951               6690-END-OF-FILE
 21952         DEPENDING ON DFHEIGDI
 21953     ELSE IF DFHEIGDJ EQUAL 7
 21954         GO TO 6690-END-OF-FILE,
 21955               6690-ERRESC-PROBLEM,
 21956               6690-ERRESC-PROBLEM,
 21957               6690-END-OF-FILE
 21958         DEPENDING ON DFHEIGDI
 21959     ELSE IF DFHEIGDJ EQUAL 8
 21960         GO TO 6690-END-OF-FILE,
 21961               6690-ERRESC-PROBLEM,
 21962               6690-ERRESC-PROBLEM,
 21963               6690-END-OF-FILE
 21964         DEPENDING ON DFHEIGDI
 21965     ELSE IF DFHEIGDJ EQUAL 9
 21966         GO TO 7250-CONTINUE,
 21967               7250-CONTINUE
 21968         DEPENDING ON DFHEIGDI
 21969     ELSE IF DFHEIGDJ EQUAL 10
 21970         GO TO 7300-CONTINUE,
 21971               7300-CONTINUE
 21972         DEPENDING ON DFHEIGDI
 21973     ELSE IF DFHEIGDJ EQUAL 11
 21974         GO TO 8000-FREE-MAIN
 21975         DEPENDING ON DFHEIGDI
 21976     ELSE IF DFHEIGDJ EQUAL 12
 21977         GO TO 8100-NOTFND,
 21978               8100-NOTFND
 21979         DEPENDING ON DFHEIGDI
 21980     ELSE IF DFHEIGDJ EQUAL 13
 21981         GO TO 8110-NOTFND,
 21982               8110-NOTFND
 21983         DEPENDING ON DFHEIGDI
 21984     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 407
* EL050.cbl
 21985         GO TO 8130-EXIT
 21986         DEPENDING ON DFHEIGDI
 21987     ELSE IF DFHEIGDJ EQUAL 15
 21988         GO TO 8150-exit
 21989         DEPENDING ON DFHEIGDI
 21990     ELSE IF DFHEIGDJ EQUAL 16
 21991         GO TO 8180-NOTFND
 21992         DEPENDING ON DFHEIGDI
 21993     ELSE IF DFHEIGDJ EQUAL 17
 21994         GO TO 8190-NOTFND
 21995         DEPENDING ON DFHEIGDI
 21996     ELSE IF DFHEIGDJ EQUAL 18
 21997         GO TO 8195-NOTFND
 21998         DEPENDING ON DFHEIGDI
 21999     ELSE IF DFHEIGDJ EQUAL 19
 22000         GO TO 8200-NOTFND
 22001         DEPENDING ON DFHEIGDI
 22002     ELSE IF DFHEIGDJ EQUAL 20
 22003         GO TO 8300-NOTFND,
 22004               8300-ERRESS-PROBLEM,
 22005               8300-ERRESS-PROBLEM,
 22006               8300-NOTFND
 22007         DEPENDING ON DFHEIGDI
 22008     ELSE IF DFHEIGDJ EQUAL 21
 22009         GO TO 8450-FORM-NOT-FOUND,
 22010               8450-FORM-NOT-FOUND
 22011         DEPENDING ON DFHEIGDI
 22012     ELSE IF DFHEIGDJ EQUAL 22
 22013         GO TO 0199-ACCT-NOT-FOUND,
 22014               0199-ACCT-NOT-FOUND
 22015         DEPENDING ON DFHEIGDI
 22016     ELSE IF DFHEIGDJ EQUAL 23
 22017         GO TO 0199-ACCT-NOT-FOUND,
 22018               0199-ACCT-NOT-FOUND
 22019         DEPENDING ON DFHEIGDI
 22020     ELSE IF DFHEIGDJ EQUAL 24
 22021         GO TO 8582-COMP-NOT-FOUND,
 22022               8582-COMP-NOT-FOUND
 22023         DEPENDING ON DFHEIGDI
 22024     ELSE IF DFHEIGDJ EQUAL 25
 22025         GO TO 8583-AGTC-NOT-FOUND,
 22026               8583-AGTC-NOT-FOUND
 22027         DEPENDING ON DFHEIGDI
 22028     ELSE IF DFHEIGDJ EQUAL 26
 22029         GO TO 8584-BXRF-NOT-FOUND,
 22030               8584-BXRF-NOT-FOUND
 22031         DEPENDING ON DFHEIGDI
 22032     ELSE IF DFHEIGDJ EQUAL 27
 22033         GO TO 8585-PLAN-NOT-FOUND,
 22034               8585-PLAN-NOT-FOUND
 22035         DEPENDING ON DFHEIGDI
 22036     ELSE IF DFHEIGDJ EQUAL 28
 22037         GO TO 0299-CERT-NOT-FOUND
 22038         DEPENDING ON DFHEIGDI
 22039     ELSE IF DFHEIGDJ EQUAL 29
 22040         GO TO 8700-READ-CERT-MASTER
 22041         DEPENDING ON DFHEIGDI
 22042     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 11:11 Page 408
* EL050.cbl
 22043         GO TO 8720-COMP-ACCOUNTS,
 22044               8730-END-BROWSE,
 22045               8740-NOT-FOUND
 22046         DEPENDING ON DFHEIGDI
 22047     ELSE IF DFHEIGDJ EQUAL 31
 22048         GO TO 9000-NOTFND
 22049         DEPENDING ON DFHEIGDI
 22050     ELSE IF DFHEIGDJ EQUAL 32
 22051         GO TO 9100-NOTFND,
 22052               9100-NOTFND
 22053         DEPENDING ON DFHEIGDI
 22054     ELSE IF DFHEIGDJ EQUAL 33
 22055         GO TO 9991-CRTO-NOT-FOUND,
 22056               9991-CRTO-NOT-FOUND
 22057         DEPENDING ON DFHEIGDI.
 22058     MOVE '9%                    "   ' TO DFHEIV0
 22059     MOVE 'EL050' TO DFHEIV1
 22060     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22061     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40032     Code:       88945
