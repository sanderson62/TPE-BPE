* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40******************************************************************
    41
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   3
* EL131.cbl
    43 ENVIRONMENT DIVISION.
    44
    45 DATA DIVISION.
    46
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    53 77  s1                          pic s999 comp-3 value+0.
    54 77  s2                          pic s999 comp-3 value+0.
    55 77  a1                          pic s999 comp-3 value+0.
    56 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    57 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    58 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    59 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    60 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    61 77  ws-max-extension            pic s999 comp-3 value +0.
    62 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    63 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    64 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    65     88  ERPDEF-FOUND                 VALUE 'Y'.
    66 77  ws-eracct-sw                pic x  value ' '.
    67     88  acct-found                value 'Y'.
    68 77  ws-benper-sw                pic x   value ' '.
    69     88  good-benper               value 'Y'.
    70 77  ws-claim-type               pic x value ' '.
    71 77  ws-ben-per                  pic 99 value 00.
    72 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    73 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    74 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    75 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    76
    77 01  LCP-TIME-OF-DAY-XX.
    78     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    79     05  FILLER                    PIC 99.
    80 01  LCP-CICS-TIME                 PIC 9(15).
    81*                            COPY ELCSCTM.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCSCTM                             *
    86*                            VMOD=2.001                          *
    87*                                                                *
    88*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    89*                                                                *
    90******************************************************************
    91 01  SECURITY-MESSAGE.
    92     12  FILLER                          PIC X(30)
    93            VALUE '** LOGIC SECURITY VIOLATION -'.
    94     12  SM-READ                         PIC X(6).
    95     12  FILLER                          PIC X(5)
    96            VALUE ' PGM='.
    97     12  SM-PGM                          PIC X(6).
    98     12  FILLER                          PIC X(5)
    99            VALUE ' OPR='.
   100     12  SM-PROCESSOR-ID                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   4
* EL131.cbl
   101     12  FILLER                          PIC X(6)
   102            VALUE ' TERM='.
   103     12  SM-TERMID                       PIC X(4).
   104     12  FILLER                          PIC XX   VALUE SPACE.
   105     12  SM-JUL-DATE                     PIC 9(5).
   106     12  FILLER                          PIC X    VALUE SPACE.
   107     12  SM-TIME                         PIC 99.99.
   108
   109
   110*                            COPY ELCSCRTY.
   111******************************************************************
   112*                                                                *
   113*                                                                *
   114*                            ELCSCRTY                            *
   115*                            VMOD=2.001                          *
   116*                                                                *
   117*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   118*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   119*        SAVED IN PI-SECURITY-ADDRESS.                           *
   120*                                                                *
   121******************************************************************
   122 01  SECURITY-CONTROL.
   123     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   124     12  FILLER                       PIC XX    VALUE 'SC'.
   125     12  SC-CREDIT-CODES.
   126         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   127             20  SC-CREDIT-DISPLAY    PIC X.
   128             20  SC-CREDIT-UPDATE     PIC X.
   129     12  SC-CLAIMS-CODES.
   130         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   131             20  SC-CLAIMS-DISPLAY    PIC X.
   132             20  SC-CLAIMS-UPDATE     PIC X.
   133
   134*                            COPY ELCNWA.
   135*****************************************************************
   136*                                                               *
   137*                                                               *
   138*                            ELCNWA.                            *
   139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   140*                            VMOD=2.003                         *
   141*                                                               *
   142*            M O V E   N A M E   W O R K   A R E A.             *
   143*                                                               *
   144*****************************************************************.
   145
   146 01  WS-NAME-WORK-AREA.
   147     05  WS-INSURED-LAST-NAME        PIC X(15).
   148     05  WS-INSURED-1ST-NAME         PIC X(12).
   149     05  WS-INSURED-MID-INIT         PIC X.
   150
   151     05  WS-NAME-WORK.
   152         10  WS-NW                   PIC X
   153             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   154
   155     05  WS-NAME-WORK2.
   156         10  WS-NW2                  PIC X
   157             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   158                                        NWA-INDEX0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   5
* EL131.cbl
   159
   160     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   161                                     COMP-3.
   162
   163
   164 01  ws-dcc-error-line.
   165     05  filler occurs 15.
   166         10  ws-error-no        pic x(4).
   167 01  WS-DATE-AREA.
   168     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   169     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   170     12  SAVE-DATE-CCYYMMDD.
   171         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   172         16  SAVE-DATE-YMD.
   173             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   174             20  FILLER         PIC X(4)    VALUE SPACES.
   175
   176 01  WS-BLANK                   PIC X       VALUE ' '.
   177
   178 01  CSO-WORK-FIELDS.
   179     05  WS-HOLD-CLAIM-STATUS    PIC X.
   180     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   181     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   182         10  WS-RECURRENT-YN     PIC X.
   183         10  FILLER              PIC X.
   184
   185 01  LITERALS-NUMBERS.
   186     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   187     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   188     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   189     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   190     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   191     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   192     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   193     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   194
   195     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   196     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   197     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   198     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   199     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   200     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   201     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   202     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   203     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   204     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   205
   206     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   207
   208     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   209
   210     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   211     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   212     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   213     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   214     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   215     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   216     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   6
* EL131.cbl
   217     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   218     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   219     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   220     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   221
   222     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   223     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   224     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   225     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   226         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   227     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   228     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   229     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   230     12  WS-ICD-CODE-1           PIC X(8).
   231     12  WS-ICD-CODE-2           PIC X(8).
   232     12  WS-CLAIM-SEQU.
   233         16  FILLER              PIC X VALUE '('.
   234         16  WS-CURRENT-SEQU     PIC Z9.
   235         16  FILLER              PIC X(04) VALUE ' OF '.
   236         16  WS-OF-SEQU          PIC Z9.
   237         16  FILLER              PIC X VALUE ')'.
   238     12  WS-EDIT-BEN-CODE        PIC XX.
   239         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   240                                          '90' THRU '99'.
   241
   242     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   243     12  WS-EDIT-NUMBER          PIC ZZZ9.
   244
   245     12  WS-RESPONSE             PIC S9(8)   COMP.
   246         88  WS-RESP-NORMAL              VALUE +00.
   247         88  WS-RESP-ERROR               VALUE +01.
   248         88  WS-RESP-NOTFND              VALUE +13.
   249         88  WS-RESP-DUPKEY              VALUE +15.
   250         88  WS-RESP-NOTOPEN             VALUE +19.
   251         88  WS-RESP-ENDFILE             VALUE +20.
   252
   253     12  WS-MOS-PAID             PIC 999.
   254     12  WS-ODD-DAYS             PIC 99.
   255     12  WS-REM-MOS              PIC 999.
   256     12  WS-REM-DAYS             PIC 99.
   257     12  WS-TERM-IN-DAYS         PIC 9(4).
   258     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   259
   260     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   261     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   262     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   263     12  WS-RESET-SW             PIC X       VALUE 'N'.
   264     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   265     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   266     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   267
   268 01  DMD-DATE-YYYYMMDD.
   269     12  DMD-DECADE          PIC XX      VALUE SPACES.
   270     12  DMD-YYMMDD.
   271         16  DMD-YY          PIC XX      VALUE SPACES.
   272         16  DMD-MM          PIC XX      VALUE SPACES.
   273         16  DMD-DD          PIC XX      VALUE SPACES.
   274
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   7
* EL131.cbl
   275 01  DMD-DATE-MMDDYYYY.
   276     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   277     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   278     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   279     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   280     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   281     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   282
   283 01  WS-MAIL-CODE.
   284     12  FILLER              PIC X.
   285     12  DMD-MAIL-CODE.
   286         16  WS-MAIL-4       PIC X(4).
   287         16  WS-MAIL-5       PIC X.
   288     12  FILLER              PIC X(4).
   289
   290     12  W-NAME-LAST             PIC  X(15).
   291     12  W-NAME-FIRST            PIC  X(15).
   292     12  W-NAME-MIDDLE.
   293         16  FILLER              PIC  X.
   294         16  W-NAME-MIDDLE-2     PIC  X.
   295         16  FILLER              PIC  X(13).
   296
   297*    COPY ELCDCTB.
   298******************************************************************
   299*                                                                *
   300*                                                                *
   301*                            ELCDCTB.                            *
   302*                            VMOD=2.002                          *
   303*                                                                *
   304*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   305*       COMMUNICATIONS AREA                                      *
   306*                                                                *
   307******************************************************************
   308 01  DCT-COMMUNICATION-AREA.
   309     12  DCT-BILLING-BANK-ID      PIC  X(05).
   310     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   311     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   312     12  DCT-PRODUCT-CODE         PIC  X(02).
   313     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   314     12  DCT-RETURN-CODE          PIC  X(02).
   315     12  DCT-MAIL-CODE            PIC  X(05).
   316     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   317     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   8
* EL131.cbl
   319 01  ERROR-SWITCHES.
   320     12  ERROR-SWITCH            PIC X.
   321         88  SCREEN-ERROR                    VALUE 'X'.
   322     12  MSTR-KEY-SWITCH         PIC X.
   323         88  MSTR-KEY-CHANGED                VALUE 'X'.
   324     12  CERT-KEY-SWITCH         PIC X.
   325*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   326         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   327*********SET TO Y IF PRIMARY KEY WILL CHANGE
   328         88  CERT-KEY-CHANGED                VALUE 'Y'.
   329     12  MSTR-SWITCH             PIC X.
   330         88  MSTR-UPDATES                    VALUE 'X'.
   331     12  crtt-switch             pic x value spaces.
   332         88  crtt-update             value 'X'.
   333     12  CERT-SWITCH             PIC X.
   334         88  CERT-UPDATES                    VALUE 'X'.
   335     12  UPDATE-SWITCH           PIC X.
   336         88  UPDATES-PRESENT                 VALUE 'X'.
   337     12  TRLR-SWITCH             PIC X.
   338         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   339         88  UPDATE-MADE                     VALUE 'Y'.
   340     12  NINETY-TRLR-SWITCH      PIC X.
   341         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   342     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   343         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   344     12  EARNINGS-CALC-SWITCH    PIC X.
   345         88  TEX-REG                         VALUE '4'.
   346         88  NET-PAY                         VALUE '5'.
   347     12  DLYACTV-SW              PIC X       VALUE 'N'.
   348         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   9
* EL131.cbl
   350 01  EDIT-WORK-AREA.
   351     12  COUNT-2                 PIC 9.
   352     12  CALL-PGM                PIC X(8).
   353     12  TRANS-ID                PIC X(4).
   354     12  CHECK-PFKEYS            PIC 99.
   355     12  CHECK-MAINT             PIC X.
   356         88  ADD-ALPHA-RECORD                VALUE 'A'.
   357         88  CHANGE-CLAIM                    VALUE 'C'.
   358         88  DELETE-CLAIM                    VALUE 'D'.
   359         88  CHANGE-NAME                     VALUE 'N'.
   360         88  VALID-OPTIONS                   VALUE 'A' 'C'
   361                                                   'D' 'N'.
   362
   363     12  HOLD-BENEFIT            PIC XX.
   364     12  HOLD-FREQ               PIC XX.
   365     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   366     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   367     12  HOLD-PDTHRU             PIC XX.
   368     12  HOLD-ADDON              PIC XX.
   369     12  HOLD-NODAYS             PIC 9(4).
   370     12  HOLD-NOPMTS             PIC 9(3).
   371     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   372     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   373     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   374     12  HOLD-BIRTH              PIC XX.
   375     12  HOLD-END                PIC XX.
   376     12  HOLD-EFF                PIC XX.
   377     12  HOLD-ENTRY              PIC XX.
   378     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   379     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   380     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   381     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   382     12  HOLD-LF-CV-CAN          PIC XX.
   383     12  HOLD-AH-CV-CAN          PIC XX.
   384     12  DIVIDE-QUOT             PIC 9(3).
   385     12  DIVIDE-REM              PIC 9(3).
   386
   387     12  WS-ALPHA-DATE.
   388         16  WS-ALPHA-YEAR.
   389             20  WS-ALPHA-YY-1   PIC 99.
   390             20  WS-ALPHA-YY-2   PIC 99.
   391         16  WS-ALPHA-MM         PIC 99.
   392         16  WS-ALPHA-DD         PIC 99.
   393
   394     12  BUILD-VALID-DATE.
   395         16  BUILD-MONTH         PIC 99.
   396         16  BUILD-DAY           PIC 99.
   397         16  BUILD-YEAR          PIC 99.
   398     12  DEEDIT-MMYY-INPUT.
   399         16  FILLER              PIC X.
   400         16  DEEDIT-MONTH        PIC XX.
   401         16  DEEDIT-YEAR         PIC XX.
   402     12  DEEDIT-BEN              PIC 9(9)V99.
   403     12  DEEDIT-DATE-INPUT.
   404         16  FILLER              PIC XX.
   405         16  DEEDIT-DATE         PIC X(6).
   406     12  WORK-DATE-MDY.
   407         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  10
* EL131.cbl
   408         16  FILLER              PIC X(4).
   409         16  YEAR-WORK           PIC XX.
   410     12  WORK-DATE-MY.
   411         16  WORK-MONTH          PIC XX.
   412         16  WORK-SLASH          PIC X       VALUE '/'.
   413         16  WORK-YEAR           PIC XX.
   414     12  HOLD-DATE.
   415         16  HOLD-MONTH          PIC 99.
   416         16  FILLER              PIC X(4).
   417         16  HOLD-YEAR           PIC 99.
   418     12  SPLIT-INFO-LINE-1.
   419         16  SPLIT-INFO-DESC     PIC X(15).
   420         16  FILLER              PIC X(5)    VALUE ' OLD='.
   421         16  SPLIT-INFO-OLD      PIC X(40).
   422     12  EFF-TERM-MO             PIC 9(4).
   423     12  CURR-MO                 PIC 9(4).
   424     12  WS-BIN-CURRENT-DT       PIC XX.
   425     12  WS-CALC-METHOD          PIC X.
   426     12  WS-INITIALS.
   427         16  WS-INIT-1           PIC X.
   428         16  WS-INIT-2           PIC X.
   429     12  WS-REIN-TABLE.
   430         16  WS-REIN-1           PIC X.
   431         16  WS-REIN-2           PIC X.
   432         16  WS-REIN-3           PIC X.
   433     12  PI-KEY.
   434         16  PI-TERM             PIC X(4).
   435         16  PI-QUAL             PIC X(4).
   436     12  CHECK-KEY               PIC X(20).
   437     12  SAVE-ACCT-KEY           PIC X(20).
   438     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   439     12  WS-SOC-SEC-NUMBER.
   440         16  WS-SOC-SEC-NO       PIC 9(9).
   441         16  WS-SOC-SEC-BLANK    PIC X(2).
   442     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   443         16  WS-SSN-1-3          PIC 9(3).
   444         16  WS-SSN-DASH1        PIC X(1).
   445         16  WS-SSN-4-5          PIC 9(2).
   446         16  WS-SSN-DASH2        PIC X(1).
   447         16  WS-SSN-6-9          PIC 9(4).
   448     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   449     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   450
   451 01  WS-SAVE-FIELDS.
   452     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   453     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   454     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   455     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   456     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   457     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   458     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   459     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   460     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   461     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   462     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   463     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   464     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   465     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  11
* EL131.cbl
   466     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   467     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   468     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   469     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   470     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   471     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   472     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   473     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   474     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   475     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   476     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   477     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   478     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   479     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   480     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   481     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   482     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   483     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   484     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   485     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   486     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   487     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   488     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   489     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   490     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   491     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   492     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   493     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   494     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   495     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   496     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   497     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   498     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   499     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   500     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   501     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   502     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   503     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   504     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   505     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   506     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   507
   508 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   509     12  M                   PIC S9(7)V99           VALUE ZEROS.
   510     12  L                   PIC S9(7)V99           VALUE ZEROS.
   511     12  N                   PIC S9(3)              VALUE ZEROS.
   512     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   513     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   514     12  I                   PIC S99V9(5)           VALUE ZEROS.
   515     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   516     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   517     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   518     12  R                   PIC S9(3)              VALUE ZEROS.
   519     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   520     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   521     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   522     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   523     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  12
* EL131.cbl
   524     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   525     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   526     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   527     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   528
   529 01  TERM-CALC-WORK-AREA.
   530     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   531     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   532     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   533     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   534     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   535     12  V-EXPONENTS.
   536        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   537     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   538
   539 01  TIME-IN.
   540     12  UN-HOURS                PIC XX.
   541     12  UN-MINUTES              PIC XX.
   542     12  FILLER                  PIC XX.
   543
   544 01  TIME-OUT.
   545     12  FOR-HOURS               PIC XX.
   546     12  FILLER                  PIC X       VALUE '.'.
   547     12  FOR-MINUTES             PIC XX.
   548
   549 01  ERROR-NUMBERS.
   550     12  ER-0000                 PIC X(4)    VALUE '0000'.
   551     12  ER-0004                 PIC X(4)    VALUE '0004'.
   552     12  ER-0008                 PIC X(4)    VALUE '0008'.
   553     12  ER-0023                 PIC X(4)    VALUE '0023'.
   554     12  ER-0029                 PIC X(4)    VALUE '0029'.
   555     12  ER-0068                 PIC X(4)    VALUE '0068'.
   556     12  ER-0070                 PIC X(4)    VALUE '0070'.
   557     12  ER-0149                 PIC X(4)    VALUE '0149'.
   558     12  ER-0154                 PIC X(4)    VALUE '0154'.
   559     12  ER-0169                 PIC X(4)    VALUE '0169'.
   560     12  ER-0192                 PIC X(4)    VALUE '0192'.
   561     12  ER-0199                 PIC X(4)    VALUE '0199'.
   562     12  ER-0203                 PIC X(4)    VALUE '0203'.
   563     12  ER-0204                 PIC X(4)    VALUE '0204'.
   564     12  ER-0205                 PIC X(4)    VALUE '0205'.
   565     12  ER-0206                 PIC X(4)    VALUE '0206'.
   566     12  ER-0208                 PIC X(4)    VALUE '0208'.
   567     12  ER-0210                 PIC X(4)    VALUE '0210'.
   568     12  ER-0215                 PIC X(4)    VALUE '0215'.
   569     12  ER-0219                 PIC X(4)    VALUE '0219'.
   570     12  ER-0220                 PIC X(4)    VALUE '0220'.
   571     12  ER-0222                 PIC X(4)    VALUE '0222'.
   572     12  ER-0223                 PIC X(4)    VALUE '0223'.
   573     12  ER-0224                 PIC X(4)    VALUE '0224'.
   574     12  ER-0227                 PIC X(4)    VALUE '0227'.
   575     12  ER-0230                 PIC X(4)    VALUE '0230'.
   576     12  ER-0232                 PIC X(4)    VALUE '0232'.
   577     12  ER-0233                 PIC X(4)    VALUE '0233'.
   578     12  ER-0236                 PIC X(4)    VALUE '0236'.
   579     12  ER-0237                 PIC X(4)    VALUE '0237'.
   580     12  ER-0238                 PIC X(4)    VALUE '0238'.
   581     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  13
* EL131.cbl
   582     12  ER-0241                 PIC X(4)    VALUE '0241'.
   583     12  ER-0243                 PIC X(4)    VALUE '0243'.
   584     12  ER-0244                 PIC X(4)    VALUE '0244'.
   585     12  ER-0246                 PIC X(4)    VALUE '0246'.
   586     12  ER-0247                 PIC X(4)    VALUE '0247'.
   587     12  ER-0248                 PIC X(4)    VALUE '0248'.
   588     12  ER-0250                 PIC X(4)    VALUE '0250'.
   589     12  ER-0251                 PIC X(4)    VALUE '0251'.
   590     12  ER-0253                 PIC X(4)    VALUE '0253'.
   591     12  ER-0256                 PIC X(4)    VALUE '0256'.
   592     12  ER-0257                 PIC X(4)    VALUE '0257'.
   593     12  ER-0258                 PIC X(4)    VALUE '0258'.
   594     12  ER-0259                 PIC X(4)    VALUE '0259'.
   595     12  ER-0260                 PIC X(4)    VALUE '0260'.
   596     12  ER-0261                 PIC X(4)    VALUE '0261'.
   597     12  ER-0262                 PIC X(4)    VALUE '0262'.
   598     12  ER-0263                 PIC X(4)    VALUE '0263'.
   599     12  ER-0273                 PIC X(4)    VALUE '0273'.
   600     12  ER-0274                 PIC X(4)    VALUE '0274'.
   601     12  ER-0276                 PIC X(4)    VALUE '0276'.
   602     12  ER-0282                 PIC X(4)    VALUE '0282'.
   603     12  ER-0283                 PIC X(4)    VALUE '0283'.
   604     12  ER-0309                 PIC X(4)    VALUE '0309'.
   605     12  ER-0310                 PIC X(4)    VALUE '0310'.
   606     12  ER-0311                 PIC X(4)    VALUE '0311'.
   607     12  ER-0333                 PIC X(4)    VALUE '0333'.
   608     12  ER-0360                 PIC X(4)    VALUE '0360'.
   609     12  ER-0377                 PIC X(4)    VALUE '0377'.
   610     12  ER-0402                 PIC X(4)    VALUE '0402'.
   611     12  ER-0416                 PIC X(4)    VALUE '0416'.
   612     12  ER-0426                 PIC X(4)    VALUE '0426'.
   613     12  ER-0427                 PIC X(4)    VALUE '0427'.
   614     12  ER-0428                 PIC X(4)    VALUE '0428'.
   615     12  ER-0429                 PIC X(4)    VALUE '0429'.
   616     12  ER-0430                 PIC X(4)    VALUE '0430'.
   617     12  ER-0458                 PIC X(4)    VALUE '0458'.
   618     12  ER-0475                 PIC X(4)    VALUE '0475'.
   619     12  ER-0491                 PIC X(4)    VALUE '0491'.
   620     12  ER-0509                 PIC X(4)    VALUE '0509'.
   621     12  ER-0510                 PIC X(4)    VALUE '0510'.
   622     12  ER-0511                 PIC X(4)    VALUE '0511'.
   623     12  ER-0512                 PIC X(4)    VALUE '0512'.
   624     12  ER-0519                 PIC X(4)    VALUE '0519'.
   625     12  ER-0520                 PIC X(4)    VALUE '0520'.
   626     12  ER-0521                 PIC X(4)    VALUE '0521'.
   627     12  ER-0547                 PIC X(4)    VALUE '0547'.
   628     12  ER-0548                 PIC X(4)    VALUE '0548'.
   629     12  ER-0549                 PIC X(4)    VALUE '0549'.
   630     12  ER-0565                 PIC X(4)    VALUE '0565'.
   631     12  ER-0598                 PIC X(4)    VALUE '0598'.
   632     12  ER-0639                 PIC X(4)    VALUE '0639'.
   633     12  ER-0797                 PIC X(4)    VALUE '0797'.
   634     12  ER-0802                 PIC X(4)    VALUE '0802'.
   635     12  ER-0803                 PIC X(4)    VALUE '0803'.
   636     12  ER-0849                 PIC X(4)    VALUE '0849'.
   637     12  ER-0885                 PIC X(4)    VALUE '0885'.
   638     12  ER-0887                 PIC X(4)    VALUE '0887'.
   639     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  14
* EL131.cbl
   640     12  ER-0921                 PIC X(4)    VALUE '0921'.
   641     12  ER-0938                 PIC X(4)    VALUE '0938'.
   642     12  ER-0946                 PIC X(4)    VALUE '0946'.
   643     12  ER-0947                 PIC X(4)    VALUE '0947'.
   644     12  ER-0948                 PIC X(4)    VALUE '0948'.
   645     12  ER-0949                 PIC X(4)    VALUE '0949'.
   646     12  ER-0950                 PIC X(4)    VALUE '0950'.
   647     12  ER-0951                 PIC X(4)    VALUE '0951'.
   648     12  ER-0954                 PIC X(4)    VALUE '0954'.
   649     12  ER-0974                 PIC X(4)    VALUE '0974'.
   650     12  ER-0975                 PIC X(4)    VALUE '0975'.
   651     12  ER-0992                 PIC X(4)    VALUE '0992'.
   652     12  ER-1651                 PIC X(4)    VALUE '1651'.
   653     12  ER-1652                 PIC X(4)    VALUE '1652'.
   654     12  ER-1653                 PIC X(4)    VALUE '1653'.
   655     12  ER-1654                 PIC X(4)    VALUE '1654'.
   656     12  ER-1655                 PIC X(4)    VALUE '1655'.
   657     12  er-1656                 pic x(4)    value '1656'.
   658     12  ER-1661                 PIC X(4)    VALUE '1661'.
   659     12  ER-1662                 PIC X(4)    VALUE '1662'.
   660     12  ER-1663                 PIC X(4)    VALUE '1663'.
   661     12  er-1664                 pic x(4)    value '1664'.
   662     12  er-1665                 pic x(4)    value '1665'.
   663     12  er-1666                 pic x(4)    value '1666'.
   664     12  er-1668                 pic x(4)    value '1668'.
   665     12  er-1669                 pic x(4)    value '1669'.
   666     12  er-1676                 pic x(4)    value '1676'.
   667     12  ER-1773                 PIC X(4)    VALUE '1773'.
   668     12  ER-2280                 PIC X(4)    VALUE '2280'.
   669     12  ER-2878                 PIC X(4)    VALUE '2878'.
   670     12  ER-7641                 PIC X(4)    VALUE '7641'.
   671     12  ER-7642                 PIC X(4)    VALUE '7642'.
   672     12  ER-7650                 PIC X(4)    VALUE '7650'.
   673     12  ER-7651                 PIC X(4)    VALUE '7651'.
   674     12  ER-7687                 PIC X(4)    VALUE '7687'.
   675     12  ER-7689                 PIC X(4)    VALUE '7689'.
   676     12  ER-7690                 PIC X(4)    VALUE '7690'.
   677     12  ER-7691                 PIC X(4)    VALUE '7691'.
   678     12  ER-8003                 PIC X(4)    VALUE '8003'.
   679     12  ER-8051                 PIC X(4)    VALUE '8051'.
   680     12  ER-8052                 PIC X(4)    VALUE '8052'.
   681     12  ER-8053                 PIC X(4)    VALUE '8053'.
   682     12  ER-8054                 PIC X(4)    VALUE '8054'.
   683     12  ER-8055                 PIC X(4)    VALUE '8055'.
   684     12  ER-8056                 PIC X(4)    VALUE '8056'.
   685     12  ER-8057                 PIC X(4)    VALUE '8057'.
   686     12  ER-8058                 PIC X(4)    VALUE '8058'.
   687     12  ER-8059                 PIC X(4)    VALUE '8059'.
   688     12  ER-8060                 PIC X(4)    VALUE '8060'.
   689     12  ER-8061                 PIC X(4)    VALUE '8061'.
   690     12  ER-8062                 PIC X(4)    VALUE '8062'.
   691     12  ER-8063                 PIC X(4)    VALUE '8063'.
   692     12  ER-8064                 PIC X(4)    VALUE '8064'.
   693     12  ER-8065                 PIC X(4)    VALUE '8065'.
   694     12  ER-8066                 PIC X(4)    VALUE '8066'.
   695     12  ER-8152                 PIC X(4)    VALUE '8152'.
   696     12  ER-8153                 PIC X(4)    VALUE '8153'.
   697     12  ER-8154                 PIC X(4)    VALUE '8154'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  15
* EL131.cbl
   698     12  ER-8155                 PIC X(4)    VALUE '8155'.
   699 01  ERPDEF-KEY-SAVE             PIC X(18).
   700 01  ERPDEF-KEY.
   701     12  ERPDEF-COMPANY-CD       PIC X.
   702     12  ERPDEF-STATE            PIC XX.
   703     12  ERPDEF-PROD-CD          PIC XXX.
   704     12  F                       PIC X(7).
   705     12  ERPDEF-BEN-TYPE         PIC X.
   706     12  ERPDEF-BEN-CODE         PIC XX.
   707     12  ERPDEF-EXP-DT           PIC XX.
   708 01  MSTR-KEY.
   709     12  COMPANY-CODE            PIC X.
   710     12  CARRIER-CODE            PIC X.
   711     12  CLAIM-NO                PIC X(7).
   712     12  CERT-NO.
   713         16  CERT-NO-PRIME       PIC X(10).
   714         16  CERT-NO-SUFX        PIC X.
   715
   716 01  WS-SAVE-CLAIM-KEY.
   717     12  WS-SAVE-COMPANY-CD      PIC X.
   718     12  WS-SAVE-CARRIER         PIC X.
   719     12  WS-SAVE-CLAIM-NO        PIC X(7).
   720     12  WS-SAVE-CERT-NO.
   721         16  WS-CERT-NO-PRIME    PIC X(10).
   722         16  WS-CERT-NO-SUFX     PIC X.
   723
   724 01  CERT-KEY.
   725     12  CERT-COMPANY-CODE       PIC X.
   726     12  CERT-CARRIER            PIC X.
   727     12  CERT-GROUP              PIC X(6).
   728     12  CERT-STATE              PIC XX.
   729     12  CERT-ACCOUNT            PIC X(10).
   730     12  CERT-DATE               PIC XX.
   731     12  CERT-CERT.
   732         16  CERT-CERT-PRIME     PIC X(10).
   733         16  CERT-CERT-SUFX      PIC X.
   734
   735 01  ELCRTT-KEY.
   736     05  CTRLR-COMP-CD       PIC X.
   737     05  CTRLR-CARRIER       PIC X.
   738     05  CTRLR-GROUPING      PIC X(6).
   739     05  CTRLR-STATE         PIC X(2).
   740     05  CTRLR-ACCOUNT       PIC X(10).
   741     05  CTRLR-EFF-DT        PIC XX.
   742     05  CTRLR-CERT-NO       PIC X(11).
   743     05  CTRLR-REC-TYPE      PIC X.
   744 01  NOTE-KEY.
   745     12  NOTE-COMP-CD            PIC X.
   746     12  NOTE-CERT-KEY.
   747         16  NOTE-CARRIER        PIC X.
   748         16  NOTE-GROUP          PIC X(6).
   749         16  NOTE-STATE          PIC XX.
   750         16  NOTE-ACCOUNT        PIC X(10).
   751         16  NOTE-DATE           PIC XX.
   752         16  NOTE-CERT-NO        PIC X(11).
   753
   754 01  TRLR-KEY.
   755     12  TRLR-MAIN-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  16
* EL131.cbl
   756         16  TRLR-COMPANY-CD     PIC X.
   757         16  TRLR-CARRIER        PIC X.
   758         16  TRLR-CLAIM-NO       PIC X(07).
   759         16  TRLR-CERT-NO        PIC X(11).
   760     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   761
   762 01  BENEFIT-KEY.
   763     12  BEN-CO-ID               PIC X(3).
   764     12  BEN-REC-TYPE            PIC X.
   765     12  FILLER                  PIC XX.
   766     12  BEN-ACC-CD              PIC XX.
   767     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   768
   769 01  CNTL-KEY.
   770     12  CNTL-CO-ID              PIC X(3).
   771     12  CNTL-REC-TYPE           PIC X.
   772     12  CNTL-PROC-ID            PIC X(4).
   773     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   774         16  CNTL-STATE-NUMBER   PIC XX.
   775         16  FILLER              PIC XX.
   776     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   777         16  FILLER              PIC X(3).
   778         16  CNTL-CARRIER        PIC X.
   779     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   780
   781 01  ACTQ-KEY                    PIC X(20).
   782
   783 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   784
   785 01  CHKQ-KEY.
   786     12  CHKQ-COMPANY-CODE       PIC X.
   787     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   788     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   789
   790 01  ARCH-KEY.
   791     12  ARCH-COMPANY-CODE       PIC X.
   792     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   793     12  ARCH-RECORD-TYPE        PIC X.
   794     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   795
   796 01  ACCT-KEY.
   797     05  ACCT-PARTIAL-KEY.
   798         12  ACCT-COMPANY-CODE   PIC X.
   799         12  ACCT-CARRIER        PIC X.
   800         12  ACCT-GROUP          PIC X(6).
   801         12  ACCT-STATE          PIC XX.
   802         12  ACCT-ACCOUNT        PIC X(10).
   803     05  ACCT-DATE               PIC XX.
   804
   805 01  WS-ELBENE-KEY.
   806     12  WS-ELBENE-COMPANY-CD    PIC X.
   807     12  WS-ELBENE-RECORD-TYPE   PIC X.
   808     12  WS-ELBENE-ID            PIC X(10).
   809
   810 01  ELALPH-KEY.
   811     12  ELALPH-COMPANY-CD       PIC X.
   812     12  ELALPH-SOURCE           PIC X.
   813     12  ELALPH-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  17
* EL131.cbl
   814         16  ELALPH-LAST-NAME    PIC X(15).
   815         16  ELALPH-FIRST-NAME.
   816             20  ELALPH-FIRST-INIT   PIC X.
   817             20  FILLER              PIC X(11).
   818         16  ELALPH-MIDDLE-INIT  PIC X.
   819     12  ELALPH-DATE             PIC X(08).
   820     12  ELALPH-TIME             PIC S9(04)    COMP.
   821
   822 01  COMP-LENGTHS.
   823     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   824     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   825     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   826     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   827     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   828     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   829     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   830     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   831     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   832     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   833     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   834     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   835     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   836     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  18
* EL131.cbl
   838*                                COPY ELCLNKLT.
   839******************************************************************
   840*                                                                *
   841*                                                                *
   842*                           ELCLNKLT                             *
   843*                            VMOD=2.003                          *
   844*                                                                *
   845*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   846*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   847*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   848*                                                                *
   849*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   850*   COMPLETING THE REQUIRED FIELDS.                              *
   851*                                                                *
   852*   THE CALLING PROGRAM SHOULD CHECK:                            *
   853*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   854*                              9999 INDICATES AN UNKNOWN ABEND   *
   855*                                   WAS DETECTED.                *
   856*                              ALL OTHER VALUES ARE NORMAL ERROR *
   857*                              CODES FOUND IN THE ERROR FILE.    *
   858******************************************************************
   859 01  W-1523-LINKDATA.
   860     12  W-1523-COMMON-PI-DATA.
   861         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   862         16  FILLER              PIC  X(67).
   863         16  W-1523-COMPANY-CD   PIC  X(01).
   864         16  FILLER              PIC  X(10).
   865         16  W-1523-CONTROL-IN-PROGRESS.
   866             20  W-1523-CARRIER  PIC  X(01).
   867             20  W-1523-GROUPING PIC  X(06).
   868             20  W-1523-STATE    PIC  X(02).
   869             20  W-1523-ACCOUNT  PIC  X(10).
   870             20  W-1523-CLAIM-CERT-GRP.
   871                 24  W-1523-CLAIM-NO
   872                                 PIC  X(07).
   873                 24  W-1523-CERT-NO.
   874                     28  W-1523-CERT-PRIME
   875                                 PIC  X(10).
   876                     28  W-1523-CERT-SFX
   877                                 PIC  X(01).
   878                 24  W-1523-CERT-EFF-DT
   879                                 PIC  X(02).
   880         16  FILLER              PIC X(265).
   881
   882     12  W-1523-WORK-AREA.
   883         16  W-1523-FORM-NUMBER  PIC  X(04).
   884         16  W-1523-NUMBER-COPIES
   885                                 PIC  9(01).
   886         16  W-1523-ADDR-TYPE    PIC  X(02).
   887         16  W-1523-FOLLOW-UP-DATE
   888                                 PIC  X(02).
   889         16  W-1523-RESEND-DATE  PIC  X(02).
   890         16  W-1523-ERROR-CODE   PIC  9(04).
   891             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   892             88  W-1523-FATAL-ERROR
   893                                    VALUES  0006 0013 0042
   894                                            0154 0168 0169
   895                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  19
* EL131.cbl
   896                                            0179 0186 0281
   897                                            0332 2055 3697
   898                                            3698 3699 3770
   899                                            3771 3772 7675
   900                                            9106 9808 9883
   901                                            9887.
   902             88  W-1523-STOP-ERRORS
   903                                    VALUES  0013 0042 0154
   904                                            0168 0169 0172
   905                                            0281 0332 2055
   906                                            3698 3699 7675
   907                                            9106 9808 9883
   908                                            9999.
   909         16  W-1523-REASON       PIC  X(70).
   910         16  W-1523-ARCHIVE-NUMBER
   911                                 PIC  9(08).
   912     12  W-1523-POINTER-AREA.
   913         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   914         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   915         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   916         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   917         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  20
* EL131.cbl
   919*                                COPY ELCINTF.
   920******************************************************************
   921*                                                                *
   922*                                                                *
   923*                            ELCINTF.                            *
   924*                            VMOD=2.017                          *
   925*                                                                *
   926*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   927*                                                                *
   928*       LENGTH = 1024                                            *
   929*                                                                *
   930******************************************************************
   931*                   C H A N G E   L O G
   932*
   933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   934*-----------------------------------------------------------------
   935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   936* EFFECTIVE    NUMBER
   937*-----------------------------------------------------------------
   938* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   939******************************************************************
   940 01  PROGRAM-INTERFACE-BLOCK.
   941     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   942     12  PI-CALLING-PROGRAM              PIC X(8).
   943     12  PI-SAVED-PROGRAM-1              PIC X(8).
   944     12  PI-SAVED-PROGRAM-2              PIC X(8).
   945     12  PI-SAVED-PROGRAM-3              PIC X(8).
   946     12  PI-SAVED-PROGRAM-4              PIC X(8).
   947     12  PI-SAVED-PROGRAM-5              PIC X(8).
   948     12  PI-SAVED-PROGRAM-6              PIC X(8).
   949     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   950     12  PI-COMPANY-ID                   PIC XXX.
   951     12  PI-COMPANY-CD                   PIC X.
   952
   953     12  PI-COMPANY-PASSWORD             PIC X(8).
   954
   955     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   956
   957     12  PI-CONTROL-IN-PROGRESS.
   958         16  PI-CARRIER                  PIC X.
   959         16  PI-GROUPING                 PIC X(6).
   960         16  PI-STATE                    PIC XX.
   961         16  PI-ACCOUNT                  PIC X(10).
   962         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   963                                         PIC X(10).
   964         16  PI-CLAIM-CERT-GRP.
   965             20  PI-CLAIM-NO             PIC X(7).
   966             20  PI-CERT-NO.
   967                 25  PI-CERT-PRIME       PIC X(10).
   968                 25  PI-CERT-SFX         PIC X.
   969             20  PI-CERT-EFF-DT          PIC XX.
   970         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   971             20  PI-PLAN-CODE            PIC X(2).
   972             20  PI-REVISION-NUMBER      PIC X(3).
   973             20  PI-PLAN-EFF-DT          PIC X(2).
   974             20  PI-PLAN-EXP-DT          PIC X(2).
   975             20  FILLER                  PIC X(11).
   976         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  21
* EL131.cbl
   977             20  PI-OE-REFERENCE-1.
   978                 25  PI-OE-REF-1-PRIME   PIC X(18).
   979                 25  PI-OE-REF-1-SUFF    PIC XX.
   980
   981     12  PI-SESSION-IN-PROGRESS          PIC X.
   982         88  CLAIM-SESSION                   VALUE '1'.
   983         88  CREDIT-SESSION                  VALUE '2'.
   984         88  WARRANTY-SESSION                VALUE '3'.
   985         88  MORTGAGE-SESSION                VALUE '4'.
   986         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   987
   988
   989*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   990
   991     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   992     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   993
   994     12  PI-CREDIT-USER                  PIC X.
   995         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   996         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   997
   998     12  PI-CLAIM-USER                   PIC X.
   999         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1000         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1001
  1002     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1003         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1004         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1005         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1006         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1007         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1008
  1009     12  PI-PROCESSOR-ID                 PIC X(4).
  1010
  1011     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1012
  1013     12  PI-MEMBER-CAPTION               PIC X(10).
  1014
  1015     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1016         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1017
  1018     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1019     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1020     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1021     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1022
  1023     12  PI-AH-OVERRIDE-L1               PIC X.
  1024     12  PI-AH-OVERRIDE-L2               PIC XX.
  1025     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1026     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1027
  1028     12  PI-NEW-SYSTEM                   PIC X(2).
  1029
  1030     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1031     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1032         88  PI-USES-PAID-TO                 VALUE '1'.
  1033     12  PI-CRDTCRD-SYSTEM.
  1034         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  22
* EL131.cbl
  1035             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1036             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1037         16  PI-CC-MONTH-END-DT          PIC XX.
  1038     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1039
  1040     12  PI-OE-REFERENCE-2.
  1041         16  PI-OE-REF-2-PRIME           PIC X(10).
  1042         16  PI-OE-REF-2-SUFF            PIC X.
  1043
  1044     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1045
  1046     12  PI-LANGUAGE-TYPE                PIC X.
  1047             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1048             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1049             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1050
  1051     12  PI-POLICY-LINKAGE-IND           PIC X.
  1052         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1053         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1054                                                   LOW-VALUES.
  1055
  1056     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1057     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1058         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1059         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1060
  1061     12  PI-PROCESSOR-CSR-IND            PIC X.
  1062         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1063         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1064
  1065     12  FILLER                          PIC X(3).
  1066
  1067     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1068
  1069     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1070         PI-SYSTEM-LEVEL.
  1071
  1072         16  PI-ENTRY-CODES.
  1073             20  PI-ENTRY-CD-1           PIC X.
  1074             20  PI-ENTRY-CD-2           PIC X.
  1075
  1076         16  PI-RETURN-CODES.
  1077             20  PI-RETURN-CD-1          PIC X.
  1078             20  PI-RETURN-CD-2          PIC X.
  1079
  1080         16  PI-UPDATE-STATUS-SAVE.
  1081             20  PI-UPDATE-BY            PIC X(4).
  1082             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1083
  1084         16  PI-LOWER-CASE-LETTERS       PIC X.
  1085             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1086
  1087*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1088*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1089*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1090
  1091         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1092             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  23
* EL131.cbl
  1093             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1094             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1095             88  ACCNT-CNTL                  VALUE '3'.
  1096             88  CARR-ACCNT-CNTL             VALUE '4'.
  1097
  1098         16  PI-PROCESSOR-CAP-LIST.
  1099             20  PI-SYSTEM-CONTROLS.
  1100                24 PI-SYSTEM-DISPLAY     PIC X.
  1101                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1102                24 PI-SYSTEM-MODIFY      PIC X.
  1103                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1104             20  FILLER                  PIC XX.
  1105             20  PI-DISPLAY-CAP          PIC X.
  1106                 88  DISPLAY-CAP             VALUE 'Y'.
  1107             20  PI-MODIFY-CAP           PIC X.
  1108                 88  MODIFY-CAP              VALUE 'Y'.
  1109             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1110                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1111             20  PI-FORCE-CAP            PIC X.
  1112                 88  FORCE-CAP               VALUE 'Y'.
  1113
  1114         16  PI-PROGRAM-CONTROLS.
  1115             20  PI-PGM-PRINT-OPT        PIC X.
  1116             20  PI-PGM-FORMAT-OPT       PIC X.
  1117             20  PI-PGM-PROCESS-OPT      PIC X.
  1118             20  PI-PGM-TOTALS-OPT       PIC X.
  1119
  1120         16  PI-HELP-INTERFACE.
  1121             20  PI-LAST-ERROR-NO        PIC X(4).
  1122             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1123
  1124         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1125             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1126
  1127         16  PI-CR-CONTROL-IN-PROGRESS.
  1128             20  PI-CR-CARRIER           PIC X.
  1129             20  PI-CR-GROUPING          PIC X(6).
  1130             20  PI-CR-STATE             PIC XX.
  1131             20  PI-CR-ACCOUNT           PIC X(10).
  1132             20  PI-CR-FIN-RESP          PIC X(10).
  1133             20  PI-CR-TYPE              PIC X.
  1134
  1135         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1136
  1137         16  PI-CR-MONTH-END-DT          PIC XX.
  1138
  1139         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1140             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1141             88  PI-ZERO-CARRIER             VALUE '1'.
  1142             88  PI-ZERO-GROUPING            VALUE '2'.
  1143             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1144
  1145         16  PI-CARRIER-SECURITY         PIC X.
  1146             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1147
  1148         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1149             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1150             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  24
* EL131.cbl
  1151
  1152         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1153             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1154                                         INDEXED BY PI-ACCESS-NDX
  1155                                         PIC X.
  1156
  1157         16  PI-GA-BILLING-CONTROL       PIC X.
  1158             88  PI-GA-BILLING               VALUE '1'.
  1159
  1160         16  PI-MAIL-PROCESSING          PIC X.
  1161             88  PI-MAIL-YES                 VALUE 'Y'.
  1162
  1163         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1164
  1165         16  PI-AR-SYSTEM.
  1166             20  PI-AR-PROCESSING-CNTL   PIC X.
  1167                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1168             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1169             20  PI-AR-MONTH-END-DT      PIC XX.
  1170
  1171         16  PI-MP-SYSTEM.
  1172             20  PI-MORTGAGE-USER            PIC X.
  1173                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1174                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1175             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1176                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1177                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1178                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1179                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1180                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1181             20  PI-MP-MONTH-END-DT          PIC XX.
  1182             20  PI-MP-REFERENCE-NO.
  1183                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1184                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1185
  1186         16  PI-LABEL-CONTROL            PIC X(01).
  1187             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1188             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1189
  1190         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1191             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1192
  1193         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1194             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1195             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1196
  1197         16  FILLER                      PIC X(14).
  1198
  1199     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1200******************************************************************
  1201     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1202         16  PI-NO-PMTS                    PIC 9(4).
  1203         16  PI-CERT-SWITCH                PIC X.
  1204             88  CREATED-CERT              VALUE '2'.
  1205         16  PI-PREM-TYPE                  PIC X.
  1206         16  PI-SAVE-CERT-NO.
  1207             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1208             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  25
* EL131.cbl
  1209         16  FILLER                        PIC X(46).
  1210         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1211         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1212         16  PI-REC-FOUND-SW               PIC X.
  1213         16  PI-LETTER-SW                  PIC X.
  1214         16  PI-PREV-TRLR-KEY              PIC X(22).
  1215         16  pi-claim-type                 pic x.
  1216         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1217         16  pi-approval-level             pic x.
  1218         16  FILLER                        PIC X(543).
  1219
  1220 01  SAVE-RECORD                 PIC X(450).
  1221
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  26
* EL131.cbl
  1223*                                COPY ELCLOGOF SUPPRESS.
  1224******************************************************************
  1225*                                                                *
  1226*                                                                *
  1227*                            ELCLOGOF.                           *
  1228*                            VMOD=2.001                          *
  1229*                                                                *
  1230*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1231*                                                                *
  1232******************************************************************
  1233 01  CLASIC-LOGOFF.
  1234     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1235     12  LOGOFF-TEXT.
  1236         16  FILLER          PIC X(5)    VALUE SPACES.
  1237         16  LOGOFF-MSG.
  1238             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1239             20  FILLER      PIC X       VALUE SPACES.
  1240             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1241         16  FILLER          PIC X(80)
  1242           VALUE '* YOU ARE NOW LOGGED OFF'.
  1243         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1244         16  FILLER          PIC X       VALUE QUOTE.
  1245         16  LOGOFF-SYS-MSG  PIC X(17)
  1246           VALUE 'S CLAS-IC SYSTEM '.
  1247     12  TEXT-MESSAGES.
  1248         16  UNACCESS-MSG    PIC X(29)
  1249             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1250         16  PGMIDERR-MSG    PIC X(17)
  1251             VALUE 'PROGRAM NOT FOUND'.
  1252
  1253*                                COPY ELCATTR SUPPRESS.
  1254******************************************************************
  1255*                                                                *
  1256*                            ELCATTR.                            *
  1257*                            VMOD=2.001                          *
  1258*                                                                *
  1259*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1260*                                                                *
  1261*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1262*                                                                *
  1263*                   POS 1   P=PROTECTED                          *
  1264*                           U=UNPROTECTED                        *
  1265*                           S=ASKIP                              *
  1266*                   POS 2   A=ALPHA/NUMERIC                      *
  1267*                           N=NUMERIC                            *
  1268*                   POS 3   N=NORMAL                             *
  1269*                           B=BRIGHT                             *
  1270*                           D=DARK                               *
  1271*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1272*                           OF=MODIFIED DATA TAG OFF             *
  1273*                                                                *
  1274*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1275******************************************************************
  1276 01  ATTRIBUTE-LIST.
  1277     12  AL-PABOF            PIC X       VALUE 'Y'.
  1278     12  AL-PABON            PIC X       VALUE 'Z'.
  1279     12  AL-PADOF            PIC X       VALUE '%'.
  1280     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  27
* EL131.cbl
  1281     12  AL-PANOF            PIC X       VALUE '-'.
  1282     12  AL-PANON            PIC X       VALUE '/'.
  1283     12  AL-SABOF            PIC X       VALUE '8'.
  1284     12  AL-SABON            PIC X       VALUE '9'.
  1285     12  AL-SADOF            PIC X       VALUE '@'.
  1286     12  AL-SADON            PIC X       VALUE QUOTE.
  1287     12  AL-SANOF            PIC X       VALUE '0'.
  1288     12  AL-SANON            PIC X       VALUE '1'.
  1289     12  AL-UABOF            PIC X       VALUE 'H'.
  1290     12  AL-UABON            PIC X       VALUE 'I'.
  1291     12  AL-UADOF            PIC X       VALUE '<'.
  1292     12  AL-UADON            PIC X       VALUE '('.
  1293     12  AL-UANOF            PIC X       VALUE ' '.
  1294     12  AL-UANON            PIC X       VALUE 'A'.
  1295     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1296     12  AL-UNBON            PIC X       VALUE 'R'.
  1297     12  AL-UNDOF            PIC X       VALUE '*'.
  1298     12  AL-UNDON            PIC X       VALUE ')'.
  1299     12  AL-UNNOF            PIC X       VALUE '&'.
  1300     12  AL-UNNON            PIC X       VALUE 'J'.
  1301
  1302*                                COPY ELCAID SUPPRESS.
  1303******************************************************************
  1304*                                                                *
  1305*                            ELCAID.                             *
  1306*                            VMOD=2.001                          *
  1307*                                                                *
  1308*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1309*                                                                *
  1310*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1311*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1312******************************************************************
  1313
  1314 01  DFHAID.
  1315   02  DFHNULL   PIC  X  VALUE  ' '.
  1316   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1317   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1318   02  DFHPEN    PIC  X  VALUE  '='.
  1319   02  DFHOPID   PIC  X  VALUE  'W'.
  1320   02  DFHPA1    PIC  X  VALUE  '%'.
  1321   02  DFHPA2    PIC  X  VALUE  '>'.
  1322   02  DFHPA3    PIC  X  VALUE  ','.
  1323   02  DFHPF1    PIC  X  VALUE  '1'.
  1324   02  DFHPF2    PIC  X  VALUE  '2'.
  1325   02  DFHPF3    PIC  X  VALUE  '3'.
  1326   02  DFHPF4    PIC  X  VALUE  '4'.
  1327   02  DFHPF5    PIC  X  VALUE  '5'.
  1328   02  DFHPF6    PIC  X  VALUE  '6'.
  1329   02  DFHPF7    PIC  X  VALUE  '7'.
  1330   02  DFHPF8    PIC  X  VALUE  '8'.
  1331   02  DFHPF9    PIC  X  VALUE  '9'.
  1332   02  DFHPF10   PIC  X  VALUE  ':'.
  1333   02  DFHPF11   PIC  X  VALUE  '#'.
  1334   02  DFHPF12   PIC  X  VALUE  '@'.
  1335   02  DFHPF13   PIC  X  VALUE  'A'.
  1336   02  DFHPF14   PIC  X  VALUE  'B'.
  1337   02  DFHPF15   PIC  X  VALUE  'C'.
  1338   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  28
* EL131.cbl
  1339   02  DFHPF17   PIC  X  VALUE  'E'.
  1340   02  DFHPF18   PIC  X  VALUE  'F'.
  1341   02  DFHPF19   PIC  X  VALUE  'G'.
  1342   02  DFHPF20   PIC  X  VALUE  'H'.
  1343   02  DFHPF21   PIC  X  VALUE  'I'.
  1344*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1345   02  DFHPF22   PIC  X  VALUE  '['.
  1346   02  DFHPF23   PIC  X  VALUE  '.'.
  1347   02  DFHPF24   PIC  X  VALUE  '<'.
  1348   02  DFHMSRE   PIC  X  VALUE  'X'.
  1349   02  DFHSTRF   PIC  X  VALUE  'h'.
  1350   02  DFHTRIG   PIC  X  VALUE  '"'.
  1351 01  FILLER REDEFINES DFHAID.
  1352     12  FILLER                  PIC X(8).
  1353     12  AID-KEYS OCCURS 24 TIMES.
  1354         16  FILLER              PIC X.
  1355
  1356*                                COPY EL131S.
  1357 01  EL131AI.
  1358     05  FILLER            PIC  X(0012).
  1359*    -------------------------------
  1360     05  DATEL PIC S9(0004) COMP.
  1361     05  DATEF PIC  X(0001).
  1362     05  FILLER REDEFINES DATEF.
  1363         10  DATEA PIC  X(0001).
  1364     05  DATEI PIC  X(0008).
  1365*    -------------------------------
  1366     05  TIMEL PIC S9(0004) COMP.
  1367     05  TIMEF PIC  X(0001).
  1368     05  FILLER REDEFINES TIMEF.
  1369         10  TIMEA PIC  X(0001).
  1370     05  TIMEI PIC  X(0005).
  1371*    -------------------------------
  1372     05  SEQUL PIC S9(0004) COMP.
  1373     05  SEQUF PIC  X(0001).
  1374     05  FILLER REDEFINES SEQUF.
  1375         10  SEQUA PIC  X(0001).
  1376     05  SEQUI PIC  X(0010).
  1377*    -------------------------------
  1378     05  COMPL PIC S9(0004) COMP.
  1379     05  COMPF PIC  X(0001).
  1380     05  FILLER REDEFINES COMPF.
  1381         10  COMPA PIC  X(0001).
  1382     05  COMPI PIC  X(0003).
  1383*    -------------------------------
  1384     05  USERIDL PIC S9(0004) COMP.
  1385     05  USERIDF PIC  X(0001).
  1386     05  FILLER REDEFINES USERIDF.
  1387         10  USERIDA PIC  X(0001).
  1388     05  USERIDI PIC  X(0004).
  1389*    -------------------------------
  1390     05  LABEL1L PIC S9(0004) COMP.
  1391     05  LABEL1F PIC  X(0001).
  1392     05  FILLER REDEFINES LABEL1F.
  1393         10  LABEL1A PIC  X(0001).
  1394     05  LABEL1I PIC  X(0011).
  1395*    -------------------------------
  1396     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  29
* EL131.cbl
  1397     05  PCERTNOF PIC  X(0001).
  1398     05  FILLER REDEFINES PCERTNOF.
  1399         10  PCERTNOA PIC  X(0001).
  1400     05  PCERTNOI PIC  X(0010).
  1401*    -------------------------------
  1402     05  PSUFXL PIC S9(0004) COMP.
  1403     05  PSUFXF PIC  X(0001).
  1404     05  FILLER REDEFINES PSUFXF.
  1405         10  PSUFXA PIC  X(0001).
  1406     05  PSUFXI PIC  X(0001).
  1407*    -------------------------------
  1408     05  CCNOL PIC S9(0004) COMP.
  1409     05  CCNOF PIC  X(0001).
  1410     05  FILLER REDEFINES CCNOF.
  1411         10  CCNOA PIC  X(0001).
  1412     05  CCNOI PIC  X(0016).
  1413*    -------------------------------
  1414     05  MAINTL PIC S9(0004) COMP.
  1415     05  MAINTF PIC  X(0001).
  1416     05  FILLER REDEFINES MAINTF.
  1417         10  MAINTA PIC  X(0001).
  1418     05  MAINTI PIC  X(0001).
  1419*    -------------------------------
  1420     05  CLAIML PIC S9(0004) COMP.
  1421     05  CLAIMF PIC  X(0001).
  1422     05  FILLER REDEFINES CLAIMF.
  1423         10  CLAIMA PIC  X(0001).
  1424     05  CLAIMI PIC  X(0007).
  1425*    -------------------------------
  1426     05  CARRL PIC S9(0004) COMP.
  1427     05  CARRF PIC  X(0001).
  1428     05  FILLER REDEFINES CARRF.
  1429         10  CARRA PIC  X(0001).
  1430     05  CARRI PIC  X(0001).
  1431*    -------------------------------
  1432     05  CERTL PIC S9(0004) COMP.
  1433     05  CERTF PIC  X(0001).
  1434     05  FILLER REDEFINES CERTF.
  1435         10  CERTA PIC  X(0001).
  1436     05  CERTI PIC  X(0010).
  1437*    -------------------------------
  1438     05  SUFXL PIC S9(0004) COMP.
  1439     05  SUFXF PIC  X(0001).
  1440     05  FILLER REDEFINES SUFXF.
  1441         10  SUFXA PIC  X(0001).
  1442     05  SUFXI PIC  X(0001).
  1443*    -------------------------------
  1444     05  TYPEL PIC S9(0004) COMP.
  1445     05  TYPEF PIC  X(0001).
  1446     05  FILLER REDEFINES TYPEF.
  1447         10  TYPEA PIC  X(0001).
  1448     05  TYPEI PIC  X(0001).
  1449*    -------------------------------
  1450     05  BENPERL PIC S9(0004) COMP.
  1451     05  BENPERF PIC  X(0001).
  1452     05  FILLER REDEFINES BENPERF.
  1453         10  BENPERA PIC  X(0001).
  1454     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  30
* EL131.cbl
  1455*    -------------------------------
  1456     05  INSTYPEL PIC S9(0004) COMP.
  1457     05  INSTYPEF PIC  X(0001).
  1458     05  FILLER REDEFINES INSTYPEF.
  1459         10  INSTYPEA PIC  X(0001).
  1460     05  INSTYPEI PIC  X(0001).
  1461*    -------------------------------
  1462     05  STATUSL PIC S9(0004) COMP.
  1463     05  STATUSF PIC  X(0001).
  1464     05  FILLER REDEFINES STATUSF.
  1465         10  STATUSA PIC  X(0001).
  1466     05  STATUSI PIC  X(0006).
  1467*    -------------------------------
  1468     05  INCL PIC S9(0004) COMP.
  1469     05  INCF PIC  X(0001).
  1470     05  FILLER REDEFINES INCF.
  1471         10  INCA PIC  X(0001).
  1472     05  INCI PIC  X(0008).
  1473*    -------------------------------
  1474     05  REPL PIC S9(0004) COMP.
  1475     05  REPF PIC  X(0001).
  1476     05  FILLER REDEFINES REPF.
  1477         10  REPA PIC  X(0001).
  1478     05  REPI PIC  X(0008).
  1479*    -------------------------------
  1480     05  ICD1L PIC S9(0004) COMP.
  1481     05  ICD1F PIC  X(0001).
  1482     05  FILLER REDEFINES ICD1F.
  1483         10  ICD1A PIC  X(0001).
  1484     05  ICD1I PIC  X(0008).
  1485*    -------------------------------
  1486     05  ICD2L PIC S9(0004) COMP.
  1487     05  ICD2F PIC  X(0001).
  1488     05  FILLER REDEFINES ICD2F.
  1489         10  ICD2A PIC  X(0001).
  1490     05  ICD2I PIC  X(0008).
  1491*    -------------------------------
  1492     05  DIAGL PIC S9(0004) COMP.
  1493     05  DIAGF PIC  X(0001).
  1494     05  FILLER REDEFINES DIAGF.
  1495         10  DIAGA PIC  X(0001).
  1496     05  DIAGI PIC  X(0060).
  1497*    -------------------------------
  1498     05  ACCSWL PIC S9(0004) COMP.
  1499     05  ACCSWF PIC  X(0001).
  1500     05  FILLER REDEFINES ACCSWF.
  1501         10  ACCSWA PIC  X(0001).
  1502     05  ACCSWI PIC  X(0001).
  1503*    -------------------------------
  1504     05  BENEL PIC S9(0004) COMP.
  1505     05  BENEF PIC  X(0001).
  1506     05  FILLER REDEFINES BENEF.
  1507         10  BENEA PIC  X(0001).
  1508     05  BENEI PIC  X(0010).
  1509*    -------------------------------
  1510     05  BIRTHL PIC S9(0004) COMP.
  1511     05  BIRTHF PIC  X(0001).
  1512     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  31
* EL131.cbl
  1513         10  BIRTHA PIC  X(0001).
  1514     05  BIRTHI PIC  X(0008).
  1515*    -------------------------------
  1516     05  SOCIALL PIC S9(0004) COMP.
  1517     05  SOCIALF PIC  X(0001).
  1518     05  FILLER REDEFINES SOCIALF.
  1519         10  SOCIALA PIC  X(0001).
  1520     05  SOCIALI PIC  X(0011).
  1521*    -------------------------------
  1522     05  SEXL PIC S9(0004) COMP.
  1523     05  SEXF PIC  X(0001).
  1524     05  FILLER REDEFINES SEXF.
  1525         10  SEXA PIC  X(0001).
  1526     05  SEXI PIC  X(0001).
  1527*    -------------------------------
  1528     05  MLNAMEL PIC S9(0004) COMP.
  1529     05  MLNAMEF PIC  X(0001).
  1530     05  FILLER REDEFINES MLNAMEF.
  1531         10  MLNAMEA PIC  X(0001).
  1532     05  MLNAMEI PIC  X(0015).
  1533*    -------------------------------
  1534     05  MFNAMEL PIC S9(0004) COMP.
  1535     05  MFNAMEF PIC  X(0001).
  1536     05  FILLER REDEFINES MFNAMEF.
  1537         10  MFNAMEA PIC  X(0001).
  1538     05  MFNAMEI PIC  X(0012).
  1539*    -------------------------------
  1540     05  MMINITL PIC S9(0004) COMP.
  1541     05  MMINITF PIC  X(0001).
  1542     05  FILLER REDEFINES MMINITF.
  1543         10  MMINITA PIC  X(0001).
  1544     05  MMINITI PIC  X(0001).
  1545*    -------------------------------
  1546     05  LOANNOL PIC S9(0004) COMP.
  1547     05  LOANNOF PIC  X(0001).
  1548     05  FILLER REDEFINES LOANNOF.
  1549         10  LOANNOA PIC  X(0001).
  1550     05  LOANNOI PIC  X(0008).
  1551*    -------------------------------
  1552     05  CRTLNMEL PIC S9(0004) COMP.
  1553     05  CRTLNMEF PIC  X(0001).
  1554     05  FILLER REDEFINES CRTLNMEF.
  1555         10  CRTLNMEA PIC  X(0001).
  1556     05  CRTLNMEI PIC  X(0015).
  1557*    -------------------------------
  1558     05  CRTFNMEL PIC S9(0004) COMP.
  1559     05  CRTFNMEF PIC  X(0001).
  1560     05  FILLER REDEFINES CRTFNMEF.
  1561         10  CRTFNMEA PIC  X(0001).
  1562     05  CRTFNMEI PIC  X(0012).
  1563*    -------------------------------
  1564     05  CRTINITL PIC S9(0004) COMP.
  1565     05  CRTINITF PIC  X(0001).
  1566     05  FILLER REDEFINES CRTINITF.
  1567         10  CRTINITA PIC  X(0001).
  1568     05  CRTINITI PIC  X(0001).
  1569*    -------------------------------
  1570     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  32
* EL131.cbl
  1571     05  LOANBALF PIC  X(0001).
  1572     05  FILLER REDEFINES LOANBALF.
  1573         10  LOANBALA PIC  X(0001).
  1574     05  LOANBALI PIC  9(7)V99.
  1575*    -------------------------------
  1576     05  PROCL PIC S9(0004) COMP.
  1577     05  PROCF PIC  X(0001).
  1578     05  FILLER REDEFINES PROCF.
  1579         10  PROCA PIC  X(0001).
  1580     05  PROCI PIC  X(0004).
  1581*    -------------------------------
  1582     05  SUPVL PIC S9(0004) COMP.
  1583     05  SUPVF PIC  X(0001).
  1584     05  FILLER REDEFINES SUPVF.
  1585         10  SUPVA PIC  X(0001).
  1586     05  SUPVI PIC  X(0001).
  1587*    -------------------------------
  1588     05  PRICDL PIC S9(0004) COMP.
  1589     05  PRICDF PIC  X(0001).
  1590     05  FILLER REDEFINES PRICDF.
  1591         10  PRICDA PIC  X(0001).
  1592     05  PRICDI PIC  X(0001).
  1593*    -------------------------------
  1594     05  CRITPL PIC S9(0004) COMP.
  1595     05  CRITPF PIC  X(0001).
  1596     05  FILLER REDEFINES CRITPF.
  1597         10  CRITPA PIC  X(0001).
  1598     05  CRITPI PIC  X(0002).
  1599*    -------------------------------
  1600     05  CRITPTL PIC S9(0004) COMP.
  1601     05  CRITPTF PIC  X(0001).
  1602     05  FILLER REDEFINES CRITPTF.
  1603         10  CRITPTA PIC  X(0001).
  1604     05  CRITPTI PIC  X(0002).
  1605*    -------------------------------
  1606     05  RTWMOSL PIC S9(0004) COMP.
  1607     05  RTWMOSF PIC  X(0001).
  1608     05  FILLER REDEFINES RTWMOSF.
  1609         10  RTWMOSA PIC  X(0001).
  1610     05  RTWMOSI PIC  X(0002).
  1611*    -------------------------------
  1612     05  FILETOL PIC S9(0004) COMP.
  1613     05  FILETOF PIC  X(0001).
  1614     05  FILLER REDEFINES FILETOF.
  1615         10  FILETOA PIC  X(0001).
  1616     05  FILETOI PIC  X(0004).
  1617*    -------------------------------
  1618     05  PTHRHDGL PIC S9(0004) COMP.
  1619     05  PTHRHDGF PIC  X(0001).
  1620     05  FILLER REDEFINES PTHRHDGF.
  1621         10  PTHRHDGA PIC  X(0001).
  1622     05  PTHRHDGI PIC  X(0010).
  1623*    -------------------------------
  1624     05  PDTHRUL PIC S9(0004) COMP.
  1625     05  PDTHRUF PIC  X(0001).
  1626     05  FILLER REDEFINES PDTHRUF.
  1627         10  PDTHRUA PIC  X(0001).
  1628     05  PDTHRUI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  33
* EL131.cbl
  1629*    -------------------------------
  1630     05  PDAMTL PIC S9(0004) COMP.
  1631     05  PDAMTF PIC  X(0001).
  1632     05  FILLER REDEFINES PDAMTF.
  1633         10  PDAMTA PIC  X(0001).
  1634     05  PDAMTI PIC  9(7)V99.
  1635*    -------------------------------
  1636     05  NODAYSL PIC S9(0004) COMP.
  1637     05  NODAYSF PIC  X(0001).
  1638     05  FILLER REDEFINES NODAYSF.
  1639         10  NODAYSA PIC  X(0001).
  1640     05  NODAYSI PIC  9(5).
  1641*    -------------------------------
  1642     05  NOPMTSL PIC S9(0004) COMP.
  1643     05  NOPMTSF PIC  X(0001).
  1644     05  FILLER REDEFINES NOPMTSF.
  1645         10  NOPMTSA PIC  X(0001).
  1646     05  NOPMTSI PIC  9(4).
  1647*    -------------------------------
  1648     05  FORMTYPL PIC S9(0004) COMP.
  1649     05  FORMTYPF PIC  X(0001).
  1650     05  FILLER REDEFINES FORMTYPF.
  1651         10  FORMTYPA PIC  X(0001).
  1652     05  FORMTYPI PIC  X(0001).
  1653*    -------------------------------
  1654     05  ESTL PIC S9(0004) COMP.
  1655     05  ESTF PIC  X(0001).
  1656     05  FILLER REDEFINES ESTF.
  1657         10  ESTA PIC  X(0001).
  1658     05  ESTI PIC  X(0008).
  1659*    -------------------------------
  1660     05  AUIDL PIC S9(0004) COMP.
  1661     05  AUIDF PIC  X(0001).
  1662     05  FILLER REDEFINES AUIDF.
  1663         10  AUIDA PIC  X(0001).
  1664     05  AUIDI PIC  X(0004).
  1665*    -------------------------------
  1666     05  OCCL PIC S9(0004) COMP.
  1667     05  OCCF PIC  X(0001).
  1668     05  FILLER REDEFINES OCCF.
  1669         10  OCCA PIC  X(0001).
  1670     05  OCCI PIC  X(0006).
  1671*    -------------------------------
  1672     05  MNTDTL PIC S9(0004) COMP.
  1673     05  MNTDTF PIC  X(0001).
  1674     05  FILLER REDEFINES MNTDTF.
  1675         10  MNTDTA PIC  X(0001).
  1676     05  MNTDTI PIC  X(0008).
  1677*    -------------------------------
  1678     05  MNTTYPEL PIC S9(0004) COMP.
  1679     05  MNTTYPEF PIC  X(0001).
  1680     05  FILLER REDEFINES MNTTYPEF.
  1681         10  MNTTYPEA PIC  X(0001).
  1682     05  MNTTYPEI PIC  X(0006).
  1683*    -------------------------------
  1684     05  CERTCARL PIC S9(0004) COMP.
  1685     05  CERTCARF PIC  X(0001).
  1686     05  FILLER REDEFINES CERTCARF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  34
* EL131.cbl
  1687         10  CERTCARA PIC  X(0001).
  1688     05  CERTCARI PIC  X(0001).
  1689*    -------------------------------
  1690     05  CERTGRPL PIC S9(0004) COMP.
  1691     05  CERTGRPF PIC  X(0001).
  1692     05  FILLER REDEFINES CERTGRPF.
  1693         10  CERTGRPA PIC  X(0001).
  1694     05  CERTGRPI PIC  X(0006).
  1695*    -------------------------------
  1696     05  CERTSTL PIC S9(0004) COMP.
  1697     05  CERTSTF PIC  X(0001).
  1698     05  FILLER REDEFINES CERTSTF.
  1699         10  CERTSTA PIC  X(0001).
  1700     05  CERTSTI PIC  X(0002).
  1701*    -------------------------------
  1702     05  CERTACTL PIC S9(0004) COMP.
  1703     05  CERTACTF PIC  X(0001).
  1704     05  FILLER REDEFINES CERTACTF.
  1705         10  CERTACTA PIC  X(0001).
  1706     05  CERTACTI PIC  X(0010).
  1707*    -------------------------------
  1708     05  CERTEFFL PIC S9(0004) COMP.
  1709     05  CERTEFFF PIC  X(0001).
  1710     05  FILLER REDEFINES CERTEFFF.
  1711         10  CERTEFFA PIC  X(0001).
  1712     05  CERTEFFI PIC  X(0008).
  1713*    -------------------------------
  1714     05  ISSAGEL PIC S9(0004) COMP.
  1715     05  ISSAGEF PIC  X(0001).
  1716     05  FILLER REDEFINES ISSAGEF.
  1717         10  ISSAGEA PIC  X(0001).
  1718     05  ISSAGEI PIC  X(0002).
  1719*    -------------------------------
  1720     05  APRL PIC S9(0004) COMP.
  1721     05  APRF PIC  X(0001).
  1722     05  FILLER REDEFINES APRF.
  1723         10  APRA PIC  X(0001).
  1724     05  APRI PIC  9(4)V9(4).
  1725*    -------------------------------
  1726     05  PMTFREQL PIC S9(0004) COMP.
  1727     05  PMTFREQF PIC  X(0001).
  1728     05  FILLER REDEFINES PMTFREQF.
  1729         10  PMTFREQA PIC  X(0001).
  1730     05  PMTFREQI PIC  99.
  1731*    -------------------------------
  1732     05  INDGRPL PIC S9(0004) COMP.
  1733     05  INDGRPF PIC  X(0001).
  1734     05  FILLER REDEFINES INDGRPF.
  1735         10  INDGRPA PIC  X(0001).
  1736     05  INDGRPI PIC  X(0001).
  1737*    -------------------------------
  1738     05  PREMTYPL PIC S9(0004) COMP.
  1739     05  PREMTYPF PIC  X(0001).
  1740     05  FILLER REDEFINES PREMTYPF.
  1741         10  PREMTYPA PIC  X(0001).
  1742     05  PREMTYPI PIC  X(0001).
  1743*    -------------------------------
  1744     05  REINCDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  35
* EL131.cbl
  1745     05  REINCDF PIC  X(0001).
  1746     05  FILLER REDEFINES REINCDF.
  1747         10  REINCDA PIC  X(0001).
  1748     05  REINCDI PIC  X(0001).
  1749*    -------------------------------
  1750     05  JNTLNMEL PIC S9(0004) COMP.
  1751     05  JNTLNMEF PIC  X(0001).
  1752     05  FILLER REDEFINES JNTLNMEF.
  1753         10  JNTLNMEA PIC  X(0001).
  1754     05  JNTLNMEI PIC  X(0015).
  1755*    -------------------------------
  1756     05  JNTFNMEL PIC S9(0004) COMP.
  1757     05  JNTFNMEF PIC  X(0001).
  1758     05  FILLER REDEFINES JNTFNMEF.
  1759         10  JNTFNMEA PIC  X(0001).
  1760     05  JNTFNMEI PIC  X(0012).
  1761*    -------------------------------
  1762     05  JNTINITL PIC S9(0004) COMP.
  1763     05  JNTINITF PIC  X(0001).
  1764     05  FILLER REDEFINES JNTINITF.
  1765         10  JNTINITA PIC  X(0001).
  1766     05  JNTINITI PIC  X(0001).
  1767*    -------------------------------
  1768     05  JNTAGEL PIC S9(0004) COMP.
  1769     05  JNTAGEF PIC  X(0001).
  1770     05  FILLER REDEFINES JNTAGEF.
  1771         10  JNTAGEA PIC  X(0001).
  1772     05  JNTAGEI PIC  X(0002).
  1773*    -------------------------------
  1774     05  ADDONDTL PIC S9(0004) COMP.
  1775     05  ADDONDTF PIC  X(0001).
  1776     05  FILLER REDEFINES ADDONDTF.
  1777         10  ADDONDTA PIC  X(0001).
  1778     05  ADDONDTI PIC  X(0008).
  1779*    -------------------------------
  1780     05  LCVDSCRL PIC S9(0004) COMP.
  1781     05  LCVDSCRF PIC  X(0001).
  1782     05  FILLER REDEFINES LCVDSCRF.
  1783         10  LCVDSCRA PIC  X(0001).
  1784     05  LCVDSCRI PIC  X(0006).
  1785*    -------------------------------
  1786     05  LCVKINDL PIC S9(0004) COMP.
  1787     05  LCVKINDF PIC  X(0001).
  1788     05  FILLER REDEFINES LCVKINDF.
  1789         10  LCVKINDA PIC  X(0001).
  1790     05  LCVKINDI PIC  X(0003).
  1791*    -------------------------------
  1792     05  LCVCDL PIC S9(0004) COMP.
  1793     05  LCVCDF PIC  X(0001).
  1794     05  FILLER REDEFINES LCVCDF.
  1795         10  LCVCDA PIC  X(0001).
  1796     05  LCVCDI PIC  X(0002).
  1797*    -------------------------------
  1798     05  LCVOTRML PIC S9(0004) COMP.
  1799     05  LCVOTRMF PIC  X(0001).
  1800     05  FILLER REDEFINES LCVOTRMF.
  1801         10  LCVOTRMA PIC  X(0001).
  1802     05  LCVOTRMI PIC  999.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  36
* EL131.cbl
  1803*    -------------------------------
  1804     05  LCVRTRML PIC S9(0004) COMP.
  1805     05  LCVRTRMF PIC  X(0001).
  1806     05  FILLER REDEFINES LCVRTRMF.
  1807         10  LCVRTRMA PIC  X(0001).
  1808     05  LCVRTRMI PIC  X(0003).
  1809*    -------------------------------
  1810     05  LCVRATEL PIC S9(0004) COMP.
  1811     05  LCVRATEF PIC  X(0001).
  1812     05  FILLER REDEFINES LCVRATEF.
  1813         10  LCVRATEA PIC  X(0001).
  1814     05  LCVRATEI PIC  9999V99.
  1815*    -------------------------------
  1816     05  LCVBENEL PIC S9(0004) COMP.
  1817     05  LCVBENEF PIC  X(0001).
  1818     05  FILLER REDEFINES LCVBENEF.
  1819         10  LCVBENEA PIC  X(0001).
  1820     05  LCVBENEI PIC  9(9)V99.
  1821*    -------------------------------
  1822     05  LCVFORML PIC S9(0004) COMP.
  1823     05  LCVFORMF PIC  X(0001).
  1824     05  FILLER REDEFINES LCVFORMF.
  1825         10  LCVFORMA PIC  X(0001).
  1826     05  LCVFORMI PIC  X(0012).
  1827*    -------------------------------
  1828     05  LCVCNDTL PIC S9(0004) COMP.
  1829     05  LCVCNDTF PIC  X(0001).
  1830     05  FILLER REDEFINES LCVCNDTF.
  1831         10  LCVCNDTA PIC  X(0001).
  1832     05  LCVCNDTI PIC  X(0008).
  1833*    -------------------------------
  1834     05  LCVEXITL PIC S9(0004) COMP.
  1835     05  LCVEXITF PIC  X(0001).
  1836     05  FILLER REDEFINES LCVEXITF.
  1837         10  LCVEXITA PIC  X(0001).
  1838     05  LCVEXITI PIC  X(0008).
  1839*    -------------------------------
  1840     05  LCVSTATL PIC S9(0004) COMP.
  1841     05  LCVSTATF PIC  X(0001).
  1842     05  FILLER REDEFINES LCVSTATF.
  1843         10  LCVSTATA PIC  X(0001).
  1844     05  LCVSTATI PIC  X(0006).
  1845*    -------------------------------
  1846     05  ACVDSCRL PIC S9(0004) COMP.
  1847     05  ACVDSCRF PIC  X(0001).
  1848     05  FILLER REDEFINES ACVDSCRF.
  1849         10  ACVDSCRA PIC  X(0001).
  1850     05  ACVDSCRI PIC  X(0006).
  1851*    -------------------------------
  1852     05  ACVKINDL PIC S9(0004) COMP.
  1853     05  ACVKINDF PIC  X(0001).
  1854     05  FILLER REDEFINES ACVKINDF.
  1855         10  ACVKINDA PIC  X(0001).
  1856     05  ACVKINDI PIC  X(0003).
  1857*    -------------------------------
  1858     05  ACVCDL PIC S9(0004) COMP.
  1859     05  ACVCDF PIC  X(0001).
  1860     05  FILLER REDEFINES ACVCDF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  37
* EL131.cbl
  1861         10  ACVCDA PIC  X(0001).
  1862     05  ACVCDI PIC  X(0002).
  1863*    -------------------------------
  1864     05  ACVOTRML PIC S9(0004) COMP.
  1865     05  ACVOTRMF PIC  X(0001).
  1866     05  FILLER REDEFINES ACVOTRMF.
  1867         10  ACVOTRMA PIC  X(0001).
  1868     05  ACVOTRMI PIC  999.
  1869*    -------------------------------
  1870     05  ACVRTRML PIC S9(0004) COMP.
  1871     05  ACVRTRMF PIC  X(0001).
  1872     05  FILLER REDEFINES ACVRTRMF.
  1873         10  ACVRTRMA PIC  X(0001).
  1874     05  ACVRTRMI PIC  X(0003).
  1875*    -------------------------------
  1876     05  ACVRATEL PIC S9(0004) COMP.
  1877     05  ACVRATEF PIC  X(0001).
  1878     05  FILLER REDEFINES ACVRATEF.
  1879         10  ACVRATEA PIC  X(0001).
  1880     05  ACVRATEI PIC  9999V99.
  1881*    -------------------------------
  1882     05  ACVBENEL PIC S9(0004) COMP.
  1883     05  ACVBENEF PIC  X(0001).
  1884     05  FILLER REDEFINES ACVBENEF.
  1885         10  ACVBENEA PIC  X(0001).
  1886     05  ACVBENEI PIC  9(9)V99.
  1887*    -------------------------------
  1888     05  ACVFORML PIC S9(0004) COMP.
  1889     05  ACVFORMF PIC  X(0001).
  1890     05  FILLER REDEFINES ACVFORMF.
  1891         10  ACVFORMA PIC  X(0001).
  1892     05  ACVFORMI PIC  X(0012).
  1893*    -------------------------------
  1894     05  ACVCNDTL PIC S9(0004) COMP.
  1895     05  ACVCNDTF PIC  X(0001).
  1896     05  FILLER REDEFINES ACVCNDTF.
  1897         10  ACVCNDTA PIC  X(0001).
  1898     05  ACVCNDTI PIC  X(0008).
  1899*    -------------------------------
  1900     05  ACVEXITL PIC S9(0004) COMP.
  1901     05  ACVEXITF PIC  X(0001).
  1902     05  FILLER REDEFINES ACVEXITF.
  1903         10  ACVEXITA PIC  X(0001).
  1904     05  ACVEXITI PIC  X(0008).
  1905*    -------------------------------
  1906     05  ACVSTATL PIC S9(0004) COMP.
  1907     05  ACVSTATF PIC  X(0001).
  1908     05  FILLER REDEFINES ACVSTATF.
  1909         10  ACVSTATA PIC  X(0001).
  1910     05  ACVSTATI PIC  X(0006).
  1911*    -------------------------------
  1912     05  LABEL2L PIC S9(0004) COMP.
  1913     05  LABEL2F PIC  X(0001).
  1914     05  FILLER REDEFINES LABEL2F.
  1915         10  LABEL2A PIC  X(0001).
  1916     05  LABEL2I PIC  X(0014).
  1917*    -------------------------------
  1918     05  BCERT1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  38
* EL131.cbl
  1919     05  BCERT1F PIC  X(0001).
  1920     05  FILLER REDEFINES BCERT1F.
  1921         10  BCERT1A PIC  X(0001).
  1922     05  BCERT1I PIC  X(0010).
  1923*    -------------------------------
  1924     05  BSUFX1L PIC S9(0004) COMP.
  1925     05  BSUFX1F PIC  X(0001).
  1926     05  FILLER REDEFINES BSUFX1F.
  1927         10  BSUFX1A PIC  X(0001).
  1928     05  BSUFX1I PIC  X(0001).
  1929*    -------------------------------
  1930     05  BCERT2L PIC S9(0004) COMP.
  1931     05  BCERT2F PIC  X(0001).
  1932     05  FILLER REDEFINES BCERT2F.
  1933         10  BCERT2A PIC  X(0001).
  1934     05  BCERT2I PIC  X(0010).
  1935*    -------------------------------
  1936     05  BSUFX2L PIC S9(0004) COMP.
  1937     05  BSUFX2F PIC  X(0001).
  1938     05  FILLER REDEFINES BSUFX2F.
  1939         10  BSUFX2A PIC  X(0001).
  1940     05  BSUFX2I PIC  X(0001).
  1941*    -------------------------------
  1942     05  BCERT3L PIC S9(0004) COMP.
  1943     05  BCERT3F PIC  X(0001).
  1944     05  FILLER REDEFINES BCERT3F.
  1945         10  BCERT3A PIC  X(0001).
  1946     05  BCERT3I PIC  X(0010).
  1947*    -------------------------------
  1948     05  BSUFX3L PIC S9(0004) COMP.
  1949     05  BSUFX3F PIC  X(0001).
  1950     05  FILLER REDEFINES BSUFX3F.
  1951         10  BSUFX3A PIC  X(0001).
  1952     05  BSUFX3I PIC  X(0001).
  1953*    -------------------------------
  1954     05  BCERT4L PIC S9(0004) COMP.
  1955     05  BCERT4F PIC  X(0001).
  1956     05  FILLER REDEFINES BCERT4F.
  1957         10  BCERT4A PIC  X(0001).
  1958     05  BCERT4I PIC  X(0010).
  1959*    -------------------------------
  1960     05  BSUFX4L PIC S9(0004) COMP.
  1961     05  BSUFX4F PIC  X(0001).
  1962     05  FILLER REDEFINES BSUFX4F.
  1963         10  BSUFX4A PIC  X(0001).
  1964     05  BSUFX4I PIC  X(0001).
  1965*    -------------------------------
  1966     05  BCERT5L PIC S9(0004) COMP.
  1967     05  BCERT5F PIC  X(0001).
  1968     05  FILLER REDEFINES BCERT5F.
  1969         10  BCERT5A PIC  X(0001).
  1970     05  BCERT5I PIC  X(0010).
  1971*    -------------------------------
  1972     05  BSUFX5L PIC S9(0004) COMP.
  1973     05  BSUFX5F PIC  X(0001).
  1974     05  FILLER REDEFINES BSUFX5F.
  1975         10  BSUFX5A PIC  X(0001).
  1976     05  BSUFX5I PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  39
* EL131.cbl
  1977*    -------------------------------
  1978     05  MSG1L PIC S9(0004) COMP.
  1979     05  MSG1F PIC  X(0001).
  1980     05  FILLER REDEFINES MSG1F.
  1981         10  MSG1A PIC  X(0001).
  1982     05  MSG1I PIC  X(0072).
  1983*    -------------------------------
  1984     05  MSG2L PIC S9(0004) COMP.
  1985     05  MSG2F PIC  X(0001).
  1986     05  FILLER REDEFINES MSG2F.
  1987         10  MSG2A PIC  X(0001).
  1988     05  MSG2I PIC  X(0072).
  1989*    -------------------------------
  1990     05  PFKEYL PIC S9(0004) COMP.
  1991     05  PFKEYF PIC  X(0001).
  1992     05  FILLER REDEFINES PFKEYF.
  1993         10  PFKEYA PIC  X(0001).
  1994     05  PFKEYI PIC  99.
  1995*    -------------------------------
  1996     05  PFKEY6L PIC S9(0004) COMP.
  1997     05  PFKEY6F PIC  X(0001).
  1998     05  FILLER REDEFINES PFKEY6F.
  1999         10  PFKEY6A PIC  X(0001).
  2000     05  PFKEY6I PIC  X(0016).
  2001 01  EL131AO REDEFINES EL131AI.
  2002     05  FILLER            PIC  X(0012).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  DATEO PIC  X(0008).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  TIMEO PIC  99.99.
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  SEQUO PIC  X(0010).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  COMPO PIC  X(0003).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  USERIDO PIC  X(0004).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  LABEL1O PIC  X(0011).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  PCERTNOO PIC  X(0010).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  PSUFXO PIC  X(0001).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  CCNOO PIC  X(0016).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  MAINTO PIC  X(0001).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  40
* EL131.cbl
  2035     05  CLAIMO PIC  X(0007).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  CARRO PIC  X(0001).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  CERTO PIC  X(0010).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  SUFXO PIC  X(0001).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  TYPEO PIC  X(0001).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  BENPERO PIC  X(0002).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  INSTYPEO PIC  X(0001).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  STATUSO PIC  X(0006).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  INCO PIC  X(0008).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  REPO PIC  X(0008).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  ICD1O PIC  X(0008).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  ICD2O PIC  X(0008).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  DIAGO PIC  X(0060).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  ACCSWO PIC  X(0001).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  BENEO PIC  X(0010).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  BIRTHO PIC  X(0008).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  SOCIALO PIC  X(0011).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  SEXO PIC  X(0001).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  MLNAMEO PIC  X(0015).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  MFNAMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  41
* EL131.cbl
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  MMINITO PIC  X(0001).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  LOANNOO PIC  X(0008).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  CRTLNMEO PIC  X(0015).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  CRTFNMEO PIC  X(0012).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  CRTINITO PIC  X(0001).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  LOANBALO PIC  ZZZZZ9.99.
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  PROCO PIC  X(0004).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  SUPVO PIC  X(0001).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  PRICDO PIC  X(0001).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  CRITPO PIC  X(0002).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  CRITPTO PIC  X(0002).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  RTWMOSO PIC  X(0002).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  FILETOO PIC  X(0004).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  PTHRHDGO PIC  X(0010).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  PDTHRUO PIC  X(0008).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  PDAMTO PIC  Z(06).99.
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  NODAYSO PIC  ZZZ99.
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  NOPMTSO PIC  ZZ99.
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  FORMTYPO PIC  X(0001).
  2150*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  42
* EL131.cbl
  2151     05  FILLER            PIC  X(0003).
  2152     05  ESTO PIC  X(0008).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  AUIDO PIC  X(0004).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  OCCO PIC  X(0006).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  MNTDTO PIC  X(0008).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  MNTTYPEO PIC  X(0006).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  CERTCARO PIC  X(0001).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  CERTGRPO PIC  X(0006).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  CERTSTO PIC  X(0002).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  CERTACTO PIC  X(0010).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  CERTEFFO PIC  X(0008).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  ISSAGEO PIC  X(0002).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  APRO PIC  9(3).9(4).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  PMTFREQO PIC  99.
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  INDGRPO PIC  X(0001).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  PREMTYPO PIC  X(0001).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  REINCDO PIC  X(0001).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  JNTLNMEO PIC  X(0015).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  JNTFNMEO PIC  X(0012).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  JNTINITO PIC  X(0001).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  43
* EL131.cbl
  2209     05  JNTAGEO PIC  X(0002).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  ADDONDTO PIC  X(0008).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  LCVDSCRO PIC  X(0006).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  LCVKINDO PIC  X(0003).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  LCVCDO PIC  X(0002).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  LCVOTRMO PIC  999.
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  LCVRTRMO PIC  999.
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  LCVRATEO PIC  ZZZ.ZZ.
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  LCVFORMO PIC  X(0012).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  LCVCNDTO PIC  X(0008).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  LCVEXITO PIC  X(0008).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  LCVSTATO PIC  X(0006).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  ACVDSCRO PIC  X(0006).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  ACVKINDO PIC  X(0003).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  ACVCDO PIC  X(0002).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  ACVOTRMO PIC  999.
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  ACVRTRMO PIC  999.
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  ACVRATEO PIC  ZZZ.ZZ.
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  44
* EL131.cbl
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  ACVFORMO PIC  X(0012).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  ACVCNDTO PIC  X(0008).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  ACVEXITO PIC  X(0008).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  ACVSTATO PIC  X(0006).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  LABEL2O PIC  X(0014).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  BCERT1O PIC  X(0010).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  BSUFX1O PIC  X(0001).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  BCERT2O PIC  X(0010).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  BSUFX2O PIC  X(0001).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  BCERT3O PIC  X(0010).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  BSUFX3O PIC  X(0001).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  BCERT4O PIC  X(0010).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  BSUFX4O PIC  X(0001).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  BCERT5O PIC  X(0010).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  BSUFX5O PIC  X(0001).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  MSG1O PIC  X(0072).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  MSG2O PIC  X(0072).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  PFKEYO PIC  X(0002).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  PFKEY6O PIC  X(0016).
  2324*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  45
* EL131.cbl
  2325
  2326*                                COPY ELCEMIB SUPPRESS.
  2327******************************************************************
  2328*                                                                *
  2329*                                                                *
  2330*                            ELCEMIB.                            *
  2331*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2332*                            VMOD=2.005                          *
  2333*                                                                *
  2334*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2335*                                                                *
  2336******************************************************************
  2337 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2338     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2339     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2340     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2341     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2342     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2343     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2344     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2345     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2346     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2347         88  EMI-NO-ERRORS                    VALUE '1'.
  2348         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2349         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2350     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2351         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2352     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2353         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2354         88  EMI-AREA1-FULL                   VALUE '2'.
  2355     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2356         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2357         88  EMI-AREA2-FULL                   VALUE '2'.
  2358     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2359         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2360         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2361         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2362         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2363         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2364     12  EMI-ERROR-LINES.
  2365         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2366         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2367         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2368         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2369             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2370                 24  EMI-ERR-NUM         PIC X(4).
  2371                 24  EMI-FILLER          PIC X.
  2372                 24  EMI-SEV             PIC X.
  2373                 24  FILLER              PIC X.
  2374             20  FILLER                  PIC X(02).
  2375     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2376         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2377             20  EMI-ERROR-NUMBER    PIC X(4).
  2378             20  EMI-FILL            PIC X.
  2379             20  EMI-SEVERITY        PIC X.
  2380             20  FILLER              PIC X.
  2381             20  EMI-ERROR-TEXT.
  2382                 24  EMI-TEXT-VARIABLE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  46
* EL131.cbl
  2383                 24  FILLER          PIC X(55).
  2384     12  EMI-SEVERITY-SAVE           PIC X.
  2385         88  EMI-NOTE                    VALUE 'N'.
  2386         88  EMI-WARNING                 VALUE 'W'.
  2387         88  EMI-FORCABLE                VALUE 'F'.
  2388         88  EMI-FATAL                   VALUE 'X'.
  2389     12  EMI-MESSAGE-FLAG            PIC X.
  2390         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2391         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2392     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2393     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2394         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2395         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2396         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2397     12  emi-claim-no                pic x(7).
  2398     12  emi-claim-type              pic x(6).
  2399     12  FILLER                      PIC X(124)  VALUE SPACES.
  2400     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2401     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2402     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2403     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2404
  2405*                                COPY ELCJPFX SUPPRESS.
  2406******************************************************************
  2407*                                                                *
  2408*                                                                *
  2409*                            ELCJPFX.                            *
  2410*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2411*                            VMOD=2.002                          *
  2412*                                                                *
  2413*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2414*                                                                *
  2415*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2416*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2417*        ELCNTL - CONTROL FILE                                   *
  2418*        ELMSTR - CLAIM MASTERS                                  *
  2419*        ELTRLR - ACTIVITY TRAILERS                              *
  2420*        ELCHKQ - CHECK QUE                                      *
  2421******************************************************************
  2422 01  JOURNAL-RECORD.
  2423     12  jp-date                     pic s9(5) comp-3.
  2424     12  jp-time                     pic s9(7) comp-3.
  2425     12  JP-USER-ID                  PIC X(4).
  2426     12  JP-FILE-ID                  PIC X(8).
  2427     12  JP-PROGRAM-ID               PIC X(8).
  2428     12  JP-RECORD-TYPE              PIC X.
  2429         88 JP-ADD              VALUE 'A'.
  2430         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2431         88 JP-AFTER-CHANGE     VALUE 'C'.
  2432         88 JP-DELETE           VALUE 'D'.
  2433         88 JP-GENERIC-DELETE   VALUE 'G'.
  2434         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2435         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2436     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2437     12  JP-RECORD-AREA
  2438
  2439
  2440                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  47
* EL131.cbl
  2441
  2442*                                COPY ELCCALC.
  2443******************************************************************
  2444*                                                                *
  2445*                           ELCCALC.                            *
  2446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2447*                            VMOD=2.025                          *
  2448*                                                                *
  2449*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2450*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2451*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2452*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2453*                                                                *
  2454*  PASSED TO ELRTRM                                              *
  2455*  -----------------                                             *
  2456*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2457*  ORIGINAL TERM                                                 *
  2458*  BEGINNING DATE                                                *
  2459*  ENDING DATE                                                   *
  2460*  COMPANY I.D.                                                  *
  2461*  ACCOUNT MASTER USER FIELD                                     *
  2462*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2463*  FREE LOOK DAYS                                                *
  2464*                                                                *
  2465*  RETURNED FROM ELRTRM                                          *
  2466*  ---------------------                                         *
  2467*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2468*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2469*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2470*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2471*----------------------------------------------------------------*
  2472*  PASSED TO ELRAMT                                              *
  2473*  ----------------                                              *
  2474*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2475*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2476*  ORIGINAL AMOUNT                                               *
  2477*  ALTERNATE BENEFIT (BALLON)                                    *
  2478*  A.P.R. - NET PAY ONLY                                         *
  2479*  METHOD
  2480*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2481*  COMPANY I.D.                                                  *
  2482*  BENEFIT TYPE                                                  *
  2483*                                                                *
  2484*  RETURNED FROM ELRAMT                                          *
  2485*  --------------------                                          *
  2486*  REMAINING AMOUNT 1 - CURRENT                                  *
  2487*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2488*  REMAINING AMOUNT FACTOR
  2489*----------------------------------------------------------------*
  2490*  PASSED TO ELRESV                                              *
  2491*  -----------------                                             *
  2492*  CERTIFICATE EFFECTIVE DATE                                    *
  2493*  VALUATION DATE                                                *
  2494*  PAID THRU DATE                                                *
  2495*  BENEFIT                                                       *
  2496*  INCURRED DATE                                                 *
  2497*  REPORTED DATE                                                 *
  2498*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  48
* EL131.cbl
  2499*  TERM                                                          *
  2500*  CDT PERCENT                                                   *
  2501*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2502* *CLAIM TYPE (LIFE, A/H)                                        *
  2503* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2504* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2505*                                                                *
  2506*  RETURNED FROM ELRESV                                          *
  2507*  --------------------                                          *
  2508*  CDT TABLE USED                                                *
  2509*  CDT FACTOR USED                                               *
  2510*  PAY TO CURRENT RESERVE                                        *
  2511*  I.B.N.R. - A/H ONLY                                           *
  2512*  FUTURE (ACCRUED) AH ONLY                                      *
  2513*----------------------------------------------------------------*
  2514*  PASSED TO ELRATE                                              *
  2515*  ----------------                                              *
  2516*  CERT ISSUE DATE                                               *
  2517*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2518*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2519*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2520*  STATE CODE (CLIENT DEFINED)                                   *
  2521*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2522*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2523*  DEVIATION CODE                                                *
  2524*  ISSUE AGE                                                     *
  2525*  ORIGINAL BENEFIT AMOUNT                                       *
  2526*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2527*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2528*  BENEFIT KIND (LIFE OR A/H)                                    *
  2529*  A.P.R.                                                        *
  2530*  METHOD
  2531*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2532*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2533*  COMPANY I.D. (3 CHARACTER)                                    *
  2534*  BENEFIT CODE                                                  *
  2535*  BENEFIT OVERRIDE CODE                                         *
  2536*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2537*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2538*  JOINT INDICATOR (CSL ONLY)                                    *
  2539*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2540*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2541*                                                                *
  2542*  RETURNED FROM ELRATE                                          *
  2543*  --------------------                                          *
  2544*  CALCULATED PREMIUM                                            *
  2545*  PREMIUM RATE                                                  *
  2546*  MORTALITY CODE                                                *
  2547*  MAX ATTAINED AGE                                              *
  2548*  MAX AGE                                                       *
  2549*  MAX TERM                                                      *
  2550*  MAX MONTHLY BENEFIT                                           *
  2551*  MAX TOTAL BENIFIT                                             *
  2552*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2553*----------------------------------------------------------------*
  2554*  PASSED TO ELRFND                                              *
  2555*  ----------------                                              *
  2556*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  49
* EL131.cbl
  2557*  REFUND DATE                                                   *
  2558*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2559*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2560*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2561*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2562*  STATE CODE (CLIENT DEFINED)                                   *
  2563*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2564*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2565*  DEVIATION CODE                                                *
  2566*  ISSUE AGE                                                     *
  2567*  ORIGINAL BENEFIT AMOUNT                                       *
  2568*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2569*  PROCESS TYPE (CANCEL)                                         *
  2570*  BENEFIT KIND (LIFE OR A/H)                                    *
  2571*  A.P.R.                                                        *
  2572*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2573*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2574*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2575*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2576*  COMPANY I.D. (3 CHARACTER)                                    *
  2577*  BENEFIT CODE                                                  *
  2578*  BENEFIT OVERRIDE CODE                                         *
  2579*                                                                *
  2580*  RETURNED FROM ELRFND                                          *
  2581*  --------------------                                          *
  2582*  CALCULATED REFUND                                             *
  2583*----------------------------------------------------------------*
  2584*  PASSED TO ELEARN                                              *
  2585*  ----------------                                              *
  2586*  CERT ISSUE DATE                                               *
  2587*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2588*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2589*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2590*  STATE CODE (CLIENT DEFINED)                                   *
  2591*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2592*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2593*  DEVIATION CODE                                                *
  2594*  ISSUE AGE                                                     *
  2595*  ORIGINAL BENEFIT AMOUNT                                       *
  2596*  BENEFIT KIND (LIFE OR A/H)                                    *
  2597*  A.P.R.                                                        *
  2598*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2599*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2600*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2601*  COMPANY I.D. (3 CHARACTER)                                    *
  2602*  BENEFIT CODE                                                  *
  2603*  BENEFIT OVERRIDE CODE                                         *
  2604*                                                                *
  2605*  RETURNED FROM ELEARN                                          *
  2606*  --------------------                                          *
  2607*  INDICATED  EARNINGS                                           *
  2608*----------------------------------------------------------------*
  2609*                 LENGTH = 450                                   *
  2610*                                                                *
  2611******************************************************************
  2612******************************************************************
  2613*                   C H A N G E   L O G
  2614*
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  50
* EL131.cbl
  2615* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2616*-----------------------------------------------------------------
  2617*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2618* EFFECTIVE    NUMBER
  2619*-----------------------------------------------------------------
  2620* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2621* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2622* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2623* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2624* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2625* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2626* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2627* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2628* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2629******************************************************************
  2630
  2631 01  CALCULATION-PASS-AREA.
  2632     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2633                                     COMP.
  2634
  2635     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2636       88  NO-CP-ERROR                             VALUE ZERO.
  2637       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2638                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2639       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2640       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2641       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2642       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2643       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2644       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2645       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2646       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2647       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2648       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2649       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2650       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2651       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2652       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2653       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2654       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2655       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2656
  2657     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2658       88  NO-CP-ERROR-2                           VALUE ZERO.
  2659***********************  INPUT AREAS ****************************
  2660
  2661     12  CP-CALCULATION-AREA.
  2662         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2663         16  CP-CERT-EFF-DT        PIC XX.
  2664         16  CP-VALUATION-DT       PIC XX.
  2665         16  CP-PAID-THRU-DT       PIC XX.
  2666         16  CP-BENEFIT-TYPE       PIC X.
  2667           88  CP-AH                               VALUE 'A' 'D'
  2668                                                   'I' 'U'.
  2669           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2670           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2671         16  CP-INCURRED-DT        PIC XX.
  2672         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  51
* EL131.cbl
  2673         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2674         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2675         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2676                                     COMP-3.
  2677         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2678                                     COMP-3.
  2679         16  CP-CDT-METHOD         PIC X.
  2680           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2681           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2682           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2683         16  CP-CLAIM-TYPE         PIC X.
  2684           88  CP-AH-CLAIM                         VALUE 'A'.
  2685           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2686         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2687                                     COMP-3.
  2688         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2689                                     COMP-3.
  2690         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2691                                     COMP-3.
  2692         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2693                                     COMP-3.
  2694         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2695                                     COMP-3.
  2696         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2697                                     COMP-3.
  2698         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2699                                     COMP-3.
  2700         16  CP-REM-TERM-METHOD    PIC X.
  2701           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2702           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2703           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2704           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2705           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2706           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2707           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2708         16  CP-EARNING-METHOD     PIC X.
  2709           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2710           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2711           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2712           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2713           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2714           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2715           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2716           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2717           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2718           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2719           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2720           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2721           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2722           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2723         16  CP-PROCESS-TYPE       PIC X.
  2724           88  CP-CLAIM                            VALUE '1'.
  2725           88  CP-CANCEL                           VALUE '2'.
  2726           88  CP-ISSUE                            VALUE '3'.
  2727         16  CP-SPECIAL-CALC-CD    PIC X.
  2728           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2729           88  CP-1-MTH-INTEREST               VALUE ' '.
  2730           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  52
* EL131.cbl
  2731           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2732           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2733           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2734           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2735           88  CP-FARM-PLAN                    VALUE 'F'.
  2736           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2737           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2738           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2739           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2740           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2741           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2742           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2743           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2744           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2745           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2746                                                     'W' 'X'.
  2747           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2748           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2749           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2750           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2751           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2752           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2753           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2754           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2755           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2756           88  CP-CSL-METH-1                   VALUE '5'.
  2757           88  CP-CSL-METH-2                   VALUE '6'.
  2758           88  CP-CSL-METH-3                   VALUE '7'.
  2759           88  CP-CSL-METH-4                   VALUE '8'.
  2760
  2761         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2762                                     COMP-3.
  2763         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2764         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2765         16  CP-STATE              PIC XX          VALUE SPACE.
  2766         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2767         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2768           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2769               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2770         16  CP-R78-OPTION         PIC X.
  2771           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2772           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2773
  2774         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2775         16  CP-IBNR-RESERVE-SW    PIC X.
  2776         16  CP-CLAIM-STATUS       PIC X.
  2777         16  CP-RATE-FILE          PIC X.
  2778         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2779                                     COMP-3.
  2780
  2781         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2782         16  CP-AH-OVERRIDE-CODE   PIC X.
  2783
  2784         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2785                                     COMP-3.
  2786         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2787                                   PIC S9(5)V99 COMP-3.
  2788         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  53
* EL131.cbl
  2789                                     COMP-3.
  2790         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2791                                     COMP-3.
  2792         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2793                                     COMP-3.
  2794         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2795                                  PIC S9(7)V99 COMP-3.
  2796
  2797         16  CP-PAID-FROM-DATE     PIC X(02).
  2798         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2799         16  CP-EXT-DAYS-CALC      PIC X.
  2800           88  CP-EXT-NO-CHG                   VALUE ' '.
  2801           88  CP-EXT-CHG-LF                   VALUE '1'.
  2802           88  CP-EXT-CHG-AH                   VALUE '2'.
  2803           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2804         16  CP-DOMICILE-STATE     PIC XX.
  2805         16  CP-CARRIER            PIC X.
  2806         16  CP-REIN-FLAG          PIC X.
  2807         16  CP-REM-TRM-CALC-OPTION PIC X.
  2808           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2809                      '2' '3' '4' '5'.
  2810           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2811           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2812           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2813           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2814           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2815           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2816           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2817           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2818         16  CP-SIG-SWITCH         PIC X.
  2819         16  CP-RATING-METHOD      PIC X.
  2820           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2821           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2822           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2823           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2824           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2825           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2826           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2827           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2828           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2829         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2830                                     COMP-3.
  2831         16  CP-BEN-CATEGORY       PIC X.
  2832         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2833         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2834                                   PIC S99V9(5) COMP-3.
  2835         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2836         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2837                                   PIC S99V9(5) COMP-3.
  2838         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2839         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2840         16  CP-EXPIRE-DT          PIC XX.
  2841         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2842         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2843         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2844         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2845         16  CP-DDF-SPEC-CALC      PIC X.
  2846             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  54
* EL131.cbl
  2847             88  CP-CALC-CLP              VALUE 'C'.
  2848         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2849         16  CP-CANCEL-REASON      PIC X.
  2850         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2851         16  CP-PMT-MODE           PIC X.
  2852         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2853         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2854         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2855         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2856         16  FILLER                PIC X.
  2857
  2858***************    OUTPUT FROM ELRESV   ************************
  2859
  2860         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2861
  2862         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2863                                     COMP-3.
  2864         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2865                                     COMP-3.
  2866         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2867                                     COMP-3.
  2868         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2869                                     COMP-3.
  2870         16  FILLER                PIC X(09).
  2871***************    OUTPUT FROM ELRTRM   *************************
  2872
  2873         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2874                                     COMP-3.
  2875         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2876                                     COMP-3.
  2877         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2878                                     COMP-3.
  2879         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2880                                     COMP-3.
  2881         16  FILLER                PIC X(12).
  2882
  2883***************    OUTPUT FROM ELRAMT   *************************
  2884
  2885         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2886                                     COMP-3.
  2887         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2888                                     COMP-3.
  2889         16  FILLER                PIC X(12).
  2890
  2891***************    OUTPUT FROM ELRATE   *************************
  2892
  2893         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2894                                     COMP-3.
  2895         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2896                                     COMP-3.
  2897         16  CP-MORTALITY-CODE     PIC X(4).
  2898         16  CP-RATE-EDIT-FLAG     PIC X.
  2899             88  CP-RATES-NEED-APR                  VALUE '1'.
  2900         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2901                                     COMP-3.
  2902         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2903         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2904         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  55
* EL131.cbl
  2905                                   PIC S9(7)V99 COMP-3.
  2906         16  FILLER                PIC X(07).
  2907
  2908***************    OUTPUT FROM ELRFND   *************************
  2909
  2910         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2911                                     COMP-3.
  2912         16  CP-REFUND-TYPE-USED   PIC X.
  2913           88  CP-R-AS-R78                         VALUE '1'.
  2914           88  CP-R-AS-PRORATA                     VALUE '2'.
  2915           88  CP-R-AS-CALIF                       VALUE '3'.
  2916           88  CP-R-AS-TEXAS                       VALUE '4'.
  2917           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2918           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2919           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2920           88  CP-R-AS-MEAN                        VALUE '8'.
  2921           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2922           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2923           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2924           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2925           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2926           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2927         16  FILLER                PIC X(12).
  2928
  2929***************    OUTPUT FROM ELEARN   *************************
  2930
  2931         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2932                                     COMP-3.
  2933         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2934                                     COMP-3.
  2935         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2936                                     COMP-3.
  2937         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2938                                     COMP-3.
  2939         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2940                                     COMP-3.
  2941         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2942                                     COMP-3.
  2943         16  CP-EARNING-TYPE-USED  PIC X.
  2944           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2945           88  CP-E-AS-R78                         VALUE '1'.
  2946           88  CP-E-AS-PRORATA                     VALUE '2'.
  2947           88  CP-E-AS-TEXAS                       VALUE '4'.
  2948           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2949           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2950           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2951           88  CP-E-AS-MEAN                        VALUE '8'.
  2952           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2953         16  FILLER                PIC X(12).
  2954
  2955***************    OUTPUT FROM ELPMNT   *************************
  2956
  2957         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2958                                     COMP-3.
  2959         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2960                                     COMP-3.
  2961         16  FILLER                PIC X(12).
  2962
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  56
* EL131.cbl
  2963***************   MISC WORK AREAS    *****************************
  2964         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2965                                     COMP-3.
  2966         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2967                                     COMP-3.
  2968         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2969                                     COMP-3.
  2970         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2971                                     COMP-3.
  2972         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2973                                     COMP-3.
  2974         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2975                                     COMP-3.
  2976         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2977             88  OPEN-RATE-FILE                   VALUE 'O'.
  2978             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2979             88  IO-ERROR                         VALUE 'E'.
  2980
  2981         16  CP-FIRST-PAY-DATE     PIC XX.
  2982
  2983         16  CP-JOINT-INDICATOR    PIC X.
  2984
  2985         16  CP-RESERVE-REMAINING-TERM
  2986                                   PIC S9(4)V9    VALUE ZERO
  2987                                     COMP-3.
  2988
  2989         16  CP-INSURED-BIRTH-DT   PIC XX.
  2990
  2991         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2992                                     COMP-3.
  2993
  2994         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2995                                     COMP-3.
  2996
  2997         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2998                                     COMP-3.
  2999
  3000         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3001                                     COMP-3.
  3002
  3003         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3004                                     COMP-3.
  3005
  3006         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3007                                     COMP-3.
  3008
  3009         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3010                                     COMP-3.
  3011
  3012         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3013             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3014
  3015         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3016                                     COMP-3.
  3017         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3018                                     COMP-3.
  3019         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3020         16  FILLER                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  57
* EL131.cbl
  3021******************************************************************
  3022
  3023*                                COPY ELCDATE.
  3024******************************************************************
  3025*                                                                *
  3026*                                                                *
  3027*                            ELCDATE.                            *
  3028*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3029*                            VMOD=2.003
  3030*                                                                *
  3031*                                                                *
  3032*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3033*                 LENGTH = 200                                   *
  3034******************************************************************
  3035
  3036 01  DATE-CONVERSION-DATA.
  3037     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3038     12  DC-OPTION-CODE                PIC X.
  3039         88  BIN-TO-GREG                VALUE ' '.
  3040         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3041         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3042         88  YMD-GREG-TO-BIN            VALUE '3'.
  3043         88  MDY-GREG-TO-BIN            VALUE '4'.
  3044         88  JULIAN-TO-BIN              VALUE '5'.
  3045         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3046         88  FIND-CENTURY               VALUE '7'.
  3047         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3048         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3049         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3050         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3051         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3052         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3053         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3054         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3055         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3056         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3057         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3058         88  BIN-3-TO-GREG              VALUE 'I'.
  3059         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3060         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3061         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3062         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3063         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3064         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3065         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3066         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3067         88  THREE-CHARACTER-BIN
  3068                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3069         88  GREGORIAN-TO-BIN
  3070                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3071         88  BIN-TO-GREGORIAN
  3072                  VALUES ' ' '1' 'I' '8' 'G'.
  3073         88  JULIAN-TO-BINARY
  3074                  VALUES '5' 'C' 'E' 'F'.
  3075     12  DC-ERROR-CODE                 PIC X.
  3076         88  NO-CONVERSION-ERROR        VALUE ' '.
  3077         88  DATE-CONVERSION-ERROR
  3078                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  58
* EL131.cbl
  3079         88  DATE-IS-ZERO               VALUE '1'.
  3080         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3081         88  DATE-IS-INVALID            VALUE '3'.
  3082         88  DATE1-GREATER-DATE2        VALUE '4'.
  3083         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3084         88  DATE-INVALID-OPTION        VALUE '9'.
  3085         88  INVALID-CENTURY            VALUE 'A'.
  3086         88  ONLY-CENTURY               VALUE 'B'.
  3087         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3088         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3089     12  DC-END-OF-MONTH               PIC X.
  3090         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3091     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3092         88  USE-NORMAL-PROCESS         VALUE ' '.
  3093         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3094         88  ADJUST-UP-100-YRS          VALUE '2'.
  3095     12  FILLER                        PIC X.
  3096     12  DC-CONVERSION-DATES.
  3097         16  DC-BIN-DATE-1             PIC XX.
  3098         16  DC-BIN-DATE-2             PIC XX.
  3099         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3100         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3101                       DC-GREG-DATE-1-EDIT.
  3102             20  DC-EDIT1-MONTH        PIC 99.
  3103             20  SLASH1-1              PIC X.
  3104             20  DC-EDIT1-DAY          PIC 99.
  3105             20  SLASH1-2              PIC X.
  3106             20  DC-EDIT1-YEAR         PIC 99.
  3107         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3108         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3109                     DC-GREG-DATE-2-EDIT.
  3110             20  DC-EDIT2-MONTH        PIC 99.
  3111             20  SLASH2-1              PIC X.
  3112             20  DC-EDIT2-DAY          PIC 99.
  3113             20  SLASH2-2              PIC X.
  3114             20  DC-EDIT2-YEAR         PIC 99.
  3115         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3116         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3117                     DC-GREG-DATE-1-YMD.
  3118             20  DC-YMD-YEAR           PIC 99.
  3119             20  DC-YMD-MONTH          PIC 99.
  3120             20  DC-YMD-DAY            PIC 99.
  3121         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3122         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3123                      DC-GREG-DATE-1-MDY.
  3124             20  DC-MDY-MONTH          PIC 99.
  3125             20  DC-MDY-DAY            PIC 99.
  3126             20  DC-MDY-YEAR           PIC 99.
  3127         16  DC-GREG-DATE-1-ALPHA.
  3128             20  DC-ALPHA-MONTH        PIC X(10).
  3129             20  DC-ALPHA-DAY          PIC 99.
  3130             20  FILLER                PIC XX.
  3131             20  DC-ALPHA-CENTURY.
  3132                 24 DC-ALPHA-CEN-N     PIC 99.
  3133             20  DC-ALPHA-YEAR         PIC 99.
  3134         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3135         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3136         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  59
* EL131.cbl
  3137         16  DC-JULIAN-DATE            PIC 9(05).
  3138         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3139                                       PIC 9(05).
  3140         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3141             20  DC-JULIAN-YEAR        PIC 99.
  3142             20  DC-JULIAN-DAYS        PIC 999.
  3143         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3144         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3145         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3146     12  DATE-CONVERSION-VARIBLES.
  3147         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3148         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3149             20  FILLER                PIC 9(3).
  3150             20  HOLD-CEN-1-CCYY.
  3151                 24  HOLD-CEN-1-CC     PIC 99.
  3152                 24  HOLD-CEN-1-YY     PIC 99.
  3153             20  HOLD-CEN-1-MO         PIC 99.
  3154             20  HOLD-CEN-1-DA         PIC 99.
  3155         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3156             20  HOLD-CEN-1-R-MO       PIC 99.
  3157             20  HOLD-CEN-1-R-DA       PIC 99.
  3158             20  HOLD-CEN-1-R-CCYY.
  3159                 24  HOLD-CEN-1-R-CC   PIC 99.
  3160                 24  HOLD-CEN-1-R-YY   PIC 99.
  3161             20  FILLER                PIC 9(3).
  3162         16  HOLD-CENTURY-1-X.
  3163             20  FILLER                PIC X(3)  VALUE SPACES.
  3164             20  HOLD-CEN-1-X-CCYY.
  3165                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3166                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3167             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3168             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3169         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3170             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3171             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3172             20  HOLD-CEN-1-R-X-CCYY.
  3173                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3174                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3175             20  FILLER                PIC XXX.
  3176         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3177         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3178         16  DC-JULIAN-DATE-1          PIC 9(07).
  3179         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3180             20  DC-JULIAN-1-CCYY.
  3181                 24  DC-JULIAN-1-CC    PIC 99.
  3182                 24  DC-JULIAN-1-YR    PIC 99.
  3183             20  DC-JULIAN-DA-1        PIC 999.
  3184         16  DC-JULIAN-DATE-2          PIC 9(07).
  3185         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3186             20  DC-JULIAN-2-CCYY.
  3187                 24  DC-JULIAN-2-CC    PIC 99.
  3188                 24  DC-JULIAN-2-YR    PIC 99.
  3189             20  DC-JULIAN-DA-2        PIC 999.
  3190         16  DC-GREG-DATE-A-EDIT.
  3191             20  DC-EDITA-MONTH        PIC 99.
  3192             20  SLASHA-1              PIC X VALUE '/'.
  3193             20  DC-EDITA-DAY          PIC 99.
  3194             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  60
* EL131.cbl
  3195             20  DC-EDITA-CCYY.
  3196                 24  DC-EDITA-CENT     PIC 99.
  3197                 24  DC-EDITA-YEAR     PIC 99.
  3198         16  DC-GREG-DATE-B-EDIT.
  3199             20  DC-EDITB-MONTH        PIC 99.
  3200             20  SLASHB-1              PIC X VALUE '/'.
  3201             20  DC-EDITB-DAY          PIC 99.
  3202             20  SLASHB-2              PIC X VALUE '/'.
  3203             20  DC-EDITB-CCYY.
  3204                 24  DC-EDITB-CENT     PIC 99.
  3205                 24  DC-EDITB-YEAR     PIC 99.
  3206         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3207         16  DC-GREG-DATE-CYMD-R REDEFINES
  3208                              DC-GREG-DATE-CYMD.
  3209             20  DC-CYMD-CEN           PIC 99.
  3210             20  DC-CYMD-YEAR          PIC 99.
  3211             20  DC-CYMD-MONTH         PIC 99.
  3212             20  DC-CYMD-DAY           PIC 99.
  3213         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3214         16  DC-GREG-DATE-MDCY-R REDEFINES
  3215                              DC-GREG-DATE-MDCY.
  3216             20  DC-MDCY-MONTH         PIC 99.
  3217             20  DC-MDCY-DAY           PIC 99.
  3218             20  DC-MDCY-CEN           PIC 99.
  3219             20  DC-MDCY-YEAR          PIC 99.
  3220    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3221        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3222    12  DC-EL310-DATE                  PIC X(21).
  3223    12  FILLER                         PIC X(28).
  3224
  3225*                                COPY ELCDMO.
  3226******************************************************************
  3227*                                                                *
  3228*                                                                *
  3229*                            ELCDMO.                             *
  3230*                            VMOD=2.004                          *
  3231*                                                                *
  3232*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3233*        COMMUNICATION AREA                                      *
  3234*   FILE TYPE = NA                                               *
  3235*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3236*                                                                *
  3237******************************************************************
  3238 01  DMO-COMMUNICATION-AREA.
  3239     12  DM-RECORD-TYPE                  PIC  X(02).
  3240             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3241             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3242             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3243     12  DM-DIST-CODE                    PIC  X(04).
  3244     12  DM-MAIL-CODE                    PIC  X(05).
  3245     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3246     12  DM-INSURED-NAME                 PIC  X(30).
  3247     12  DM-CLAIM-NO                     PIC  X(07).
  3248     12  DM-CLAIM-TYPE                   PIC  X.
  3249
  3250     12  DM-STATUS-DATA-AREA.
  3251         16  DM-CLAIM-STATUS             PIC  X.
  3252             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  61
* EL131.cbl
  3253             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3254             88  DM-CLOSED                        VALUE '3'.
  3255             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3256             88  DM-DEFAULT                       VALUE '9'.
  3257         16  DM-STATUS-DATE              PIC  X(08).
  3258******YYYYMMDD
  3259         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3260             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3261             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3262             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3263             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3264             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3265             88  DM-RE-OPENED                     VALUE 'R'.
  3266             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3267             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3268             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3269         16  DM-STAT-CARRIER             PIC X.
  3270
  3271     12  DM-DRAFT-DATA-AREA.
  3272         16  DM-PAYMENT-TYPE             PIC  X.
  3273             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3274         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3275         16  DM-PAYMENT-DATE             PIC  X(08).
  3276******YYYYMMDD
  3277         16  DM-CERT-NO                  PIC  X(11).
  3278         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3279         16  DM-CARRIER                  PIC  X.
  3280
  3281     12  DM-RETURN-CODE                  PIC  XX.
  3282*                                COPY ERCPDEF.
  3283******************************************************************
  3284*                                                                *
  3285*                                                                *
  3286*                            ERCPDEF.                            *
  3287*                                                                *
  3288*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3289*                                                                *
  3290*    FILE TYPE = VSAM,KSDS                                       *
  3291*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3292*                                                                *
  3293*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3294*                                                                *
  3295*    LOG = YES                                                   *
  3296*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3297******************************************************************
  3298*                   C H A N G E   L O G
  3299*
  3300* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3301*-----------------------------------------------------------------
  3302*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3303* EFFECTIVE    NUMBER
  3304*-----------------------------------------------------------------
  3305* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3306* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3307******************************************************************
  3308 01  PRODUCT-MASTER.
  3309    12  PD-RECORD-ID                 PIC X(02).
  3310        88  VALID-PD-ID                  VALUE 'PD'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  62
* EL131.cbl
  3311    12  PD-CONTROL-PRIMARY.
  3312        16  PD-COMPANY-CD            PIC X.
  3313        16  PD-STATE                 PIC XX.
  3314        16  PD-PRODUCT-CD            PIC XXX.
  3315        16  PD-FILLER                PIC X(7).
  3316        16  PD-BEN-TYPE              PIC X.
  3317        16  PD-BEN-CODE              PIC XX.
  3318        16  PD-PROD-EXP-DT           PIC XX.
  3319    12  FILLER                       PIC X(50).
  3320    12  PD-PRODUCT-DATA OCCURS 8.
  3321        16  PD-PROD-CODE             PIC X.
  3322            88  PD-PROD-LIFE           VALUE 'L'.
  3323            88  PD-PROD-PROP           VALUE 'P'.
  3324            88  PD-PROD-AH             VALUE 'A'.
  3325            88  PD-PROD-IU             VALUE 'I'.
  3326            88  PD-PROD-GAP            VALUE 'G'.
  3327            88  PD-PROD-FAML           VALUE 'F'.
  3328        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3329        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3330        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3331        16  PD-MAX-TERM              PIC S999        COMP-3.
  3332        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3333        16  FILLER                   PIC X.
  3334        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3335        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3336        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3337        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3338        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3339        16  PD-REC-CRIT-PERIOD       PIC 99.
  3340        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3341            20  PD-RECURRING-YN      PIC X.
  3342            20  FILLER               PIC X.
  3343        16  PD-RTW-MOS               PIC 99.
  3344        16  PD-MAX-EXTENSION         PIC 99.
  3345        16  FILLER                   PIC XX.
  3346    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3347    12  PD-TERM-LIMITS OCCURS 15.
  3348        16  PD-LOW-TERM              PIC S999        COMP-3.
  3349        16  PD-HI-TERM               PIC S999        COMP-3.
  3350*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3351    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3352        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3353        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3354    12  PD-EARN-FACTORS.
  3355        16  FILLER OCCURS 15.
  3356            20  FILLER OCCURS 15.
  3357                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3358    12  PD-PRODUCT-DESC              PIC X(80).
  3359    12  PD-TRUNCATED                 PIC X.
  3360    12  FILLER                       PIC X(59).
  3361    12  PD-MAINT-INFORMATION.
  3362        16  PD-LAST-MAINT-DT         PIC X(02).
  3363        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3364        16  PD-LAST-MAINT-BY         PIC X(04).
  3365*                                COPY ELCCRTT.
  3366******************************************************************
  3367*                                                                *
  3368*                            ELCCRTT.                            *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  63
* EL131.cbl
  3369*                                                                *
  3370*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3371*                                                                *
  3372*   FILE TYPE = VSAM,KSDS                                        *
  3373*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3374*                                                                *
  3375*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3376*                                                                *
  3377*   LOG = YES                                                    *
  3378*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3379******************************************************************
  3380*                   C H A N G E   L O G
  3381*
  3382* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3383*-----------------------------------------------------------------
  3384*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3385* EFFECTIVE    NUMBER
  3386*-----------------------------------------------------------------
  3387* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3388* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3389* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3390* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3391* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3392* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3393* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3394******************************************************************
  3395
  3396 01  CERTIFICATE-TRAILERS.
  3397     12  CS-RECORD-ID                      PIC XX.
  3398         88  VALID-CS-ID                      VALUE 'CS'.
  3399
  3400     12  CS-CONTROL-PRIMARY.
  3401         16  CS-COMPANY-CD                 PIC X.
  3402         16  CS-CARRIER                    PIC X.
  3403         16  CS-GROUPING                   PIC X(6).
  3404         16  CS-STATE                      PIC XX.
  3405         16  CS-ACCOUNT                    PIC X(10).
  3406         16  CS-CERT-EFF-DT                PIC XX.
  3407         16  CS-CERT-NO.
  3408             20  CS-CERT-PRIME             PIC X(10).
  3409             20  CS-CERT-SFX               PIC X.
  3410         16  CS-TRAILER-TYPE               PIC X.
  3411             88  COMM-TRLR           VALUE 'A'.
  3412             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3413             88  CERT-DATA-TRLR      VALUE 'C'.
  3414
  3415     12  CS-DATA-AREA                      PIC X(516).
  3416
  3417     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3418         16  CS-BANK-COMMISSION-AREA.
  3419             20  CS-BANK-COMMS       OCCURS 10.
  3420                 24  CS-AGT                PIC X(10).
  3421                 24  CS-COM-TYP            PIC X.
  3422                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3423                 24  CS-RECALC-LV-INDIC    PIC X.
  3424                 24  FILLER                PIC X(10).
  3425         16  FILLER                        PIC X(256).
  3426
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  64
* EL131.cbl
  3427     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3428****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3429         16  CS-MB-CLAIM-DATA OCCURS 24.
  3430             20  CS-CLAIM-NO               PIC X(7).
  3431             20  CS-CLAIM-TYPE             PIC X.
  3432                 88  CS-AH-CLM               VALUE 'A'.
  3433                 88  CS-IU-CLM               VALUE 'I'.
  3434                 88  CS-GP-CLM               VALUE 'G'.
  3435                 88  CS-LF-CLM               VALUE 'L'.
  3436                 88  CS-PR-CLM               VALUE 'P'.
  3437                 88  CS-FL-CLM               VALUE 'F'.
  3438             20  CS-INSURED-TYPE           PIC X.
  3439                 88  CS-PRIM-INSURED          VALUE 'P'.
  3440                 88  CS-CO-BORROWER           VALUE 'C'.
  3441             20  CS-BENEFIT-PERIOD         PIC 99.
  3442             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3443             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3444             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3445         16  FILLER                        PIC X(12).
  3446     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3447         16  CS-VIN-NUMBER                 PIC X(17).
  3448         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3449         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3450         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3451         16  FILLER                        PIC X(496).
  3452
  3453****************************************************************
  3454*
  3455* Copyright (c) 2007 by Clerity Solutions, Inc.
  3456* All rights reserved.
  3457*
  3458****************************************************************
  3459 01  DFHEIV.
  3460   02  DFHEIV0               PIC X(35).
  3461   02  DFHEIV1               PIC X(08).
  3462   02  DFHEIV2               PIC X(08).
  3463   02  DFHEIV3               PIC X(08).
  3464   02  DFHEIV4               PIC X(06).
  3465   02  DFHEIV5               PIC X(04).
  3466   02  DFHEIV6               PIC X(04).
  3467   02  DFHEIV7               PIC X(02).
  3468   02  DFHEIV8               PIC X(02).
  3469   02  DFHEIV9               PIC X(01).
  3470   02  DFHEIV10              PIC S9(7) COMP-3.
  3471   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3472   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3473   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3474   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3475   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3476   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3477   02  DFHEIV17              PIC X(04).
  3478   02  DFHEIV18              PIC X(04).
  3479   02  DFHEIV19              PIC X(04).
  3480   02  DFHEIV20              USAGE IS POINTER.
  3481   02  DFHEIV21              USAGE IS POINTER.
  3482   02  DFHEIV22              USAGE IS POINTER.
  3483   02  DFHEIV23              USAGE IS POINTER.
  3484   02  DFHEIV24              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  65
* EL131.cbl
  3485   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3486   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3487   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3488   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3489   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3490   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3491   02  FILLER                PIC X(02).
  3492   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3493   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3494   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3495   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3496   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3497 LINKAGE  SECTION.
  3498*****************************************************************
  3499*                                                               *
  3500* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3501* All rights reserved.                                          *
  3502*                                                               *
  3503*****************************************************************
  3504 01  dfheiblk.
  3505     02  eibtime          pic s9(7) comp-3.
  3506     02  eibdate          pic s9(7) comp-3.
  3507     02  eibtrnid         pic x(4).
  3508     02  eibtaskn         pic s9(7) comp-3.
  3509     02  eibtrmid         pic x(4).
  3510     02  dfheigdi         pic s9(4) comp.
  3511     02  eibcposn         pic s9(4) comp.
  3512     02  eibcalen         pic s9(4) comp.
  3513     02  eibaid           pic x(1).
  3514     02  eibfiller1       pic x(1).
  3515     02  eibfn            pic x(2).
  3516     02  eibfiller2       pic x(2).
  3517     02  eibrcode         pic x(6).
  3518     02  eibfiller3       pic x(2).
  3519     02  eibds            pic x(8).
  3520     02  eibreqid         pic x(8).
  3521     02  eibrsrce         pic x(8).
  3522     02  eibsync          pic x(1).
  3523     02  eibfree          pic x(1).
  3524     02  eibrecv          pic x(1).
  3525     02  eibsend          pic x(1).
  3526     02  eibatt           pic x(1).
  3527     02  eibeoc           pic x(1).
  3528     02  eibfmh           pic x(1).
  3529     02  eibcompl         pic x(1).
  3530     02  eibsig           pic x(1).
  3531     02  eibconf          pic x(1).
  3532     02  eiberr           pic x(1).
  3533     02  eibrldbk         pic x(1).
  3534     02  eiberrcd         pic x(4).
  3535     02  eibsynrb         pic x(1).
  3536     02  eibnodat         pic x(1).
  3537     02  eibfiller5       pic x(2).
  3538     02  eibresp          pic 9(09) comp.
  3539     02  eibresp2         pic 9(09) comp.
  3540     02  dfheigdj         pic s9(4) comp.
  3541     02  dfheigdk         pic s9(4) comp.
  3542 01  DFHCOMMAREA                 PIC X(1024).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  66
* EL131.cbl
  3543
  3544*                                COPY ELCMSTR.
  3545******************************************************************
  3546*                                                                *
  3547*                            ELCMSTR.                            *
  3548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3549*                            VMOD=2.012                          *
  3550*                                                                *
  3551*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3552*                                                                *
  3553*   FILE TYPE = VSAM,KSDS                                        *
  3554*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3555*                                                                *
  3556*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3557*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3558*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3559*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3560*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3561*                                                 RKP=75,LEN=21  *
  3562*                                                                *
  3563*   **** NOTE ****                                               *
  3564*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3565*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3566*                                                                *
  3567*   LOG = YES                                                    *
  3568*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3569******************************************************************
  3570*                   C H A N G E   L O G
  3571*
  3572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3573*-----------------------------------------------------------------
  3574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3575* EFFECTIVE    NUMBER
  3576*-----------------------------------------------------------------
  3577* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3578* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3579* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3580* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3581* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3582******************************************************************
  3583 01  CLAIM-MASTER.
  3584     12  CL-RECORD-ID                PIC XX.
  3585         88  VALID-CL-ID         VALUE 'CL'.
  3586
  3587     12  CL-CONTROL-PRIMARY.
  3588         16  CL-COMPANY-CD           PIC X.
  3589         16  CL-CARRIER              PIC X.
  3590         16  CL-CLAIM-NO             PIC X(7).
  3591         16  CL-CERT-NO.
  3592             20  CL-CERT-PRIME       PIC X(10).
  3593             20  CL-CERT-SFX         PIC X.
  3594
  3595     12  CL-CONTROL-BY-NAME.
  3596         16  CL-COMPANY-CD-A1        PIC X.
  3597         16  CL-INSURED-LAST-NAME    PIC X(15).
  3598         16  CL-INSURED-NAME.
  3599             20  CL-INSURED-1ST-NAME PIC X(12).
  3600             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  67
* EL131.cbl
  3601
  3602     12  CL-CONTROL-BY-SSN.
  3603         16  CL-COMPANY-CD-A2        PIC X.
  3604         16  CL-SOC-SEC-NO.
  3605             20  CL-SSN-STATE        PIC XX.
  3606             20  CL-SSN-ACCOUNT      PIC X(6).
  3607             20  CL-SSN-LN3          PIC X(3).
  3608
  3609     12  CL-CONTROL-BY-CERT-NO.
  3610         16  CL-COMPANY-CD-A4        PIC X.
  3611         16  CL-CERT-NO-A4.
  3612             20  CL-CERT-A4-PRIME    PIC X(10).
  3613             20  CL-CERT-A4-SFX      PIC X.
  3614
  3615     12  CL-CONTROL-BY-CCN.
  3616         16  CL-COMPANY-CD-A5        PIC X.
  3617         16  CL-CCN-A5.
  3618             20  CL-CCN.
  3619                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3620                 24  CL-CCN-PRIME-A5 PIC X(12).
  3621             20  CL-CCN-FILLER-A5    PIC X(4).
  3622
  3623     12  CL-INSURED-PROFILE-DATA.
  3624         16  CL-INSURED-BIRTH-DT     PIC XX.
  3625         16  CL-INSURED-SEX-CD       PIC X.
  3626             88  INSURED-IS-MALE        VALUE 'M'.
  3627             88  INSURED-IS-FEMALE      VALUE 'F'.
  3628             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3629         16  CL-INSURED-OCC-CD       PIC X(6).
  3630         16  FILLER                  PIC X(5).
  3631
  3632     12  CL-PROCESSING-INFO.
  3633         16  CL-PROCESSOR-ID         PIC X(4).
  3634         16  CL-CLAIM-STATUS         PIC X.
  3635             88  CLAIM-IS-OPEN          VALUE 'O'.
  3636             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3637         16  CL-CLAIM-TYPE           PIC X.
  3638*            88  AH-CLAIM               VALUE 'A'.
  3639*            88  LIFE-CLAIM             VALUE 'L'.
  3640*            88  PROPERTY-CLAIM         VALUE 'P'.
  3641*            88  IUI-CLAIM              VALUE 'I'.
  3642*            88  GAP-CLAIM              VALUE 'G'.
  3643*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3644         16  CL-CLAIM-PREM-TYPE      PIC X.
  3645             88  SINGLE-PREMIUM         VALUE '1'.
  3646             88  O-B-COVERAGE           VALUE '2'.
  3647             88  OPEN-END-COVERAGE      VALUE '3'.
  3648         16  CL-INCURRED-DT          PIC XX.
  3649         16  CL-REPORTED-DT          PIC XX.
  3650         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3651         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3652         16  CL-LAST-PMT-DT          PIC XX.
  3653         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3654         16  CL-PAID-THRU-DT         PIC XX.
  3655         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3656         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3657         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3658         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  68
* EL131.cbl
  3659             88  CL-360-DAY-YR          VALUE '1'.
  3660             88  CL-365-DAY-YR          VALUE '2'.
  3661             88  CL-FULL-MONTHS         VALUE '3'.
  3662         16  CL-CAUSE-CD             PIC X(6).
  3663
  3664         16  CL-PRIME-CERT-NO.
  3665             20  CL-PRIME-CERT-PRIME PIC X(10).
  3666             20  CL-PRIME-CERT-SFX   PIC X.
  3667
  3668         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3669             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3670             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3671
  3672         16  CL-MICROFILM-NO         PIC X(10).
  3673         16  FILLER REDEFINES CL-MICROFILM-NO.
  3674             20  CL-BENEFIT-PERIOD   PIC 99.
  3675             20  FILLER              PIC X(8).
  3676         16  CL-PROG-FORM-TYPE       PIC X.
  3677         16  CL-LAST-ADD-ON-DT       PIC XX.
  3678
  3679         16  CL-LAST-REOPEN-DT       PIC XX.
  3680         16  CL-LAST-CLOSE-DT        PIC XX.
  3681         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3682             88  FINAL-PAID             VALUE '1'.
  3683             88  CLAIM-DENIED           VALUE '2'.
  3684             88  AUTO-CLOSE             VALUE '3'.
  3685             88  MANUAL-CLOSE           VALUE '4'.
  3686             88  BENEFITS-CHANGED       VALUE 'C'.
  3687             88  SETUP-ERRORS           VALUE 'E'.
  3688         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3689         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3690         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3691             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3692         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3693         16  FILLER                  PIC X.
  3694
  3695     12  CL-CERTIFICATE-DATA.
  3696         16  CL-CERT-ORIGIN          PIC X.
  3697             88  CERT-WAS-ONLINE        VALUE '1'.
  3698             88  CERT-WAS-CREATED       VALUE '2'.
  3699             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3700         16  CL-CERT-KEY-DATA.
  3701             20  CL-CERT-CARRIER     PIC X.
  3702             20  CL-CERT-GROUPING    PIC X(6).
  3703             20  CL-CERT-STATE       PIC XX.
  3704             20  CL-CERT-ACCOUNT.
  3705                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3706                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3707             20  CL-CERT-EFF-DT      PIC XX.
  3708
  3709     12  CL-STATUS-CONTROLS.
  3710         16  CL-PRIORITY-CD          PIC X.
  3711             88  CONFIDENTIAL-DATA      VALUE '8'.
  3712             88  HIGHEST-PRIORITY       VALUE '9'.
  3713         16  CL-SUPV-ATTN-CD         PIC X.
  3714             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3715             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3716         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  69
* EL131.cbl
  3717         16  CL-RESTORED-DT          PIC XX.
  3718         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3719         16  CL-NEXT-RESEND-DT       PIC XX.
  3720         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3721         16  CL-CRITICAL-PERIOD      PIC 99.
  3722*        16  FILLER                  PIC XX.
  3723         16  CL-LAST-MAINT-DT        PIC XX.
  3724         16  CL-LAST-MAINT-USER      PIC X(4).
  3725         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3726         16  CL-LAST-MAINT-TYPE      PIC X.
  3727             88  CLAIM-SET-UP           VALUE ' '.
  3728             88  PAYMENT-MADE           VALUE '1'.
  3729             88  LETTER-SENT            VALUE '2'.
  3730             88  MASTER-WAS-ALTERED     VALUE '3'.
  3731             88  MASTER-WAS-RESTORED    VALUE '4'.
  3732             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3733             88  FILE-CONVERTED         VALUE '6'.
  3734             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3735             88  ERROR-CORRECTION       VALUE 'E'.
  3736         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3737         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3738         16  CL-BENEFICIARY          PIC X(10).
  3739         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3740         16  CL-DENIAL-TYPE          PIC X.
  3741             88  CL-TYPE-DENIAL          VALUE '1'.
  3742             88  CL-TYPE-RESCISSION      VALUE '2'.
  3743             88  CL-TYPE-REFORMATION     VALUE '3'.
  3744             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3745             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3746         16  filler                  pic x(5).
  3747*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3748*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3749*        16  CL-RTW-DT               PIC XX.
  3750
  3751     12  CL-TRAILER-CONTROLS.
  3752         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3753             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3754             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3755             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3756         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3757         16  FILLER                  PIC XX.
  3758         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3759         16  CL-ADDRESS-TRAILER-CNT.
  3760             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3761                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3762             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3763                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3764             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3765                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3766             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3767                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3768             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3769                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3770             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3771                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3772             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3773                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3774
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  70
* EL131.cbl
  3775     12  CL-CV-REFERENCE-NO.
  3776         16  CL-CV-REFNO-PRIME       PIC X(18).
  3777         16  CL-CV-REFNO-SFX         PIC XX.
  3778
  3779     12  CL-FILE-LOCATION            PIC X(4).
  3780
  3781     12  CL-PROCESS-ERRORS.
  3782         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3783             88  NO-FATAL-ERRORS        VALUE ZERO.
  3784         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3785             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3786
  3787     12  CL-PRODUCT-CD               PIC X.
  3788
  3789     12  CL-CURRENT-KEY-DATA.
  3790         16  CL-CURRENT-CARRIER      PIC X.
  3791         16  CL-CURRENT-GROUPING     PIC X(6).
  3792         16  CL-CURRENT-STATE        PIC XX.
  3793         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3794
  3795     12  CL-ASSOCIATES               PIC X.
  3796         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3797         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3798         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3799         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3800
  3801     12  CL-ACTIVITY-CODE            PIC 99.
  3802     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3803     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3804
  3805     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3806     12  CL-LAG-REPORT-CODE          PIC 9.
  3807     12  CL-LOAN-TYPE                PIC XX.
  3808     12  CL-LEGAL-STATE              PIC XX.
  3809
  3810     12  CL-YESNOSW                  PIC X.
  3811     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3812         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3813         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3814         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3815     12  cl-insured-type             pic x.
  3816         88  cl-claim-on-primary         value 'P'.
  3817         88  cl-claim-on-co-borrower     value 'C'.
  3818     12  cl-benefit-expiration-dt    PIC XX.
  3819
  3820*                                COPY ELCCERT.
  3821******************************************************************
  3822*                                                                *
  3823*                            ELCCERT.                            *
  3824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3825*                            VMOD=2.013                          *
  3826*                                                                *
  3827*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3828*                                                                *
  3829*   FILE TYPE = VSAM,KSDS                                        *
  3830*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3831*                                                                *
  3832*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  71
* EL131.cbl
  3833*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3834*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3835*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3836*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3837*                                                                *
  3838*   LOG = YES                                                    *
  3839*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3840******************************************************************
  3841*                   C H A N G E   L O G
  3842*
  3843* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3844*-----------------------------------------------------------------
  3845*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3846* EFFECTIVE    NUMBER
  3847*-----------------------------------------------------------------
  3848* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3849* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3850* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3851* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3852* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3853* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3854* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3855* 032612  CR2011110200001  PEMA  AHL CHANGES
  3856******************************************************************
  3857
  3858 01  CERTIFICATE-MASTER.
  3859     12  CM-RECORD-ID                      PIC XX.
  3860         88  VALID-CM-ID                      VALUE 'CM'.
  3861
  3862     12  CM-CONTROL-PRIMARY.
  3863         16  CM-COMPANY-CD                 PIC X.
  3864         16  CM-CARRIER                    PIC X.
  3865         16  CM-GROUPING.
  3866             20  CM-GROUPING-PREFIX        PIC X(3).
  3867             20  CM-GROUPING-PRIME         PIC X(3).
  3868         16  CM-STATE                      PIC XX.
  3869         16  CM-ACCOUNT.
  3870             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3871             20  CM-ACCOUNT-PRIME          PIC X(6).
  3872         16  CM-CERT-EFF-DT                PIC XX.
  3873         16  CM-CERT-NO.
  3874             20  CM-CERT-PRIME             PIC X(10).
  3875             20  CM-CERT-SFX               PIC X.
  3876
  3877     12  CM-CONTROL-BY-NAME.
  3878         16  CM-COMPANY-CD-A1              PIC X.
  3879         16  CM-INSURED-LAST-NAME          PIC X(15).
  3880         16  CM-INSURED-INITIALS.
  3881             20  CM-INSURED-INITIAL1       PIC X.
  3882             20  CM-INSURED-INITIAL2       PIC X.
  3883
  3884     12  CM-CONTROL-BY-SSN.
  3885         16  CM-COMPANY-CD-A2              PIC X.
  3886         16  CM-SOC-SEC-NO.
  3887             20  CM-SSN-STATE              PIC XX.
  3888             20  CM-SSN-ACCOUNT            PIC X(6).
  3889             20  CM-SSN-LN3.
  3890                 25  CM-INSURED-INITIALS-A2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  72
* EL131.cbl
  3891                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3892                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3893                 25 CM-PART-LAST-NAME-A2         PIC X.
  3894
  3895     12  CM-CONTROL-BY-CERT-NO.
  3896         16  CM-COMPANY-CD-A4              PIC X.
  3897         16  CM-CERT-NO-A4                 PIC X(11).
  3898
  3899     12  CM-CONTROL-BY-MEMB.
  3900         16  CM-COMPANY-CD-A5              PIC X.
  3901         16  CM-MEMBER-NO.
  3902             20  CM-MEMB-STATE             PIC XX.
  3903             20  CM-MEMB-ACCOUNT           PIC X(6).
  3904             20  CM-MEMB-LN4.
  3905                 25  CM-INSURED-INITIALS-A5.
  3906                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3907                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3908                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3909
  3910     12  CM-INSURED-PROFILE-DATA.
  3911         16  CM-INSURED-FIRST-NAME.
  3912             20  CM-INSURED-1ST-INIT       PIC X.
  3913             20  FILLER                    PIC X(9).
  3914         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3915         16  CM-INSURED-SEX                PIC X.
  3916             88  CM-SEX-MALE                  VALUE 'M'.
  3917             88  CM-SEX-FEMAL                 VALUE 'F'.
  3918         16  CM-INSURED-JOINT-AGE          PIC 99.
  3919         16  CM-JOINT-INSURED-NAME.
  3920             20  CM-JT-LAST-NAME           PIC X(15).
  3921             20  CM-JT-FIRST-NAME.
  3922                 24  CM-JT-1ST-INIT        PIC X.
  3923                 24  FILLER                PIC X(9).
  3924             20  CM-JT-INITIAL             PIC X.
  3925
  3926     12  CM-LIFE-DATA.
  3927         16  CM-LF-BENEFIT-CD              PIC XX.
  3928         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3929         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3930         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3931         16  CM-LF-DEV-CODE                PIC XXX.
  3932         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3933         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3934         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3935         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3936         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3937         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3938         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3939         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3940         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3941         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3942         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3943         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3944         16  FILLER                        PIC XX.
  3945
  3946     12  CM-AH-DATA.
  3947         16  CM-AH-BENEFIT-CD              PIC XX.
  3948         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  73
* EL131.cbl
  3949         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3950         16  CM-AH-DEV-CODE                PIC XXX.
  3951         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3952         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3953         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3954         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3955         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3956         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3957         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3958         16  CM-AH-PAID-THRU-DT            PIC XX.
  3959             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3960         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3961         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3962         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3963         16  FILLER                        PIC X.
  3964
  3965     12  CM-LOAN-INFORMATION.
  3966         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3967         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3968                                           PIC S9(5)V99  COMP-3.
  3969         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3970         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3971         16  CM-PAY-FREQUENCY              PIC S99.
  3972         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3973         16  CM-RATE-CLASS                 PIC XX.
  3974         16  CM-BENEFICIARY                PIC X(25).
  3975         16  CM-POLICY-FORM-NO             PIC X(12).
  3976         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3977         16  CM-LAST-ADD-ON-DT             PIC XX.
  3978         16  CM-DEDUCTIBLE-AMOUNTS.
  3979             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3980             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3981         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3982             20  CM-RESIDENT-STATE         PIC XX.
  3983             20  CM-RATE-CODE              PIC X(4).
  3984             20  FILLER                    PIC XX.
  3985         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3986             20  CM-LOAN-OFFICER           PIC X(5).
  3987             20  FILLER                    PIC XXX.
  3988         16  CM-CSR-CODE                   PIC XXX.
  3989         16  CM-UNDERWRITING-CODE          PIC X.
  3990             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3991         16  CM-POST-CARD-IND              PIC X.
  3992         16  CM-NH-INTERFACE-SW            PIC X.
  3993         16  CM-PREMIUM-TYPE               PIC X.
  3994             88  CM-SING-PRM                  VALUE '1'.
  3995             88  CM-O-B-COVERAGE              VALUE '2'.
  3996             88  CM-OPEN-END                  VALUE '3'.
  3997         16  CM-IND-GRP-TYPE               PIC X.
  3998             88  CM-INDIVIDUAL                VALUE 'I'.
  3999             88  CM-GROUP                     VALUE 'G'.
  4000         16  CM-SKIP-CODE                  PIC X.
  4001             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4002             88  SKIP-JULY                    VALUE '1'.
  4003             88  SKIP-AUGUST                  VALUE '2'.
  4004             88  SKIP-SEPTEMBER               VALUE '3'.
  4005             88  SKIP-JULY-AUG                VALUE '4'.
  4006             88  SKIP-AUG-SEPT                VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  74
* EL131.cbl
  4007             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4008             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4009             88  SKIP-JUNE                    VALUE '8'.
  4010             88  SKIP-JUNE-JULY               VALUE '9'.
  4011             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4012             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4013         16  CM-PAYMENT-MODE               PIC X.
  4014             88  PAY-MONTHLY                  VALUE SPACE.
  4015             88  PAY-WEEKLY                   VALUE '1'.
  4016             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4017             88  PAY-BI-WEEKLY                VALUE '3'.
  4018             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4019         16  CM-LOAN-NUMBER                PIC X(8).
  4020         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4021         16  CM-OLD-LOF                    PIC XXX.
  4022*        16  CM-LOAN-OFFICER               PIC XXX.
  4023         16  CM-REIN-TABLE                 PIC XXX.
  4024         16  CM-SPECIAL-REIN-CODE          PIC X.
  4025         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4026         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4027         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4028
  4029     12  CM-STATUS-DATA.
  4030         16  CM-ENTRY-STATUS               PIC X.
  4031         16  CM-ENTRY-DT                   PIC XX.
  4032
  4033         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4034         16  CM-LF-CANCEL-DT               PIC XX.
  4035         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4036
  4037         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4038         16  CM-LF-DEATH-DT                PIC XX.
  4039         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4040
  4041         16  CM-LF-CURRENT-STATUS          PIC X.
  4042             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4043                                                'M' '4' '5' '9'.
  4044             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4045             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4046             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4047             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4048             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4049             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4050             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4051             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4052             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4053             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4054             88  CM-LF-DECLINED               VALUE 'D'.
  4055             88  CM-LF-VOIDED                 VALUE 'V'.
  4056
  4057         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4058         16  CM-AH-CANCEL-DT               PIC XX.
  4059         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4060
  4061         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4062         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4063         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4064
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  75
* EL131.cbl
  4065         16  CM-AH-CURRENT-STATUS          PIC X.
  4066             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4067                                                'M' '4' '5' '9'.
  4068             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4069             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4070             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4071             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4072             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4073             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4074             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4075             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4076             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4077             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4078             88  CM-AH-DECLINED               VALUE 'D'.
  4079             88  CM-AH-VOIDED                 VALUE 'V'.
  4080
  4081         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4082             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4083             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4084             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4085         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4086
  4087         16  CM-ENTRY-BATCH                PIC X(6).
  4088         16  CM-LF-EXIT-BATCH              PIC X(6).
  4089         16  CM-AH-EXIT-BATCH              PIC X(6).
  4090         16  CM-LAST-MONTH-END             PIC XX.
  4091
  4092     12  CM-NOTE-SW                        PIC X.
  4093         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4094         88  CERT-NOTES-PRESENT               VALUE '1'.
  4095         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4096         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4097         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4098         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4099         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4100         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4101     12  CM-COMP-EXCP-SW                   PIC X.
  4102         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4103         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4104     12  CM-INSURED-ADDRESS-SW             PIC X.
  4105         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4106         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4107
  4108*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4109     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4110     12  FILLER                            PIC X.
  4111
  4112*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4113     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4114     12  FILLER                            PIC X.
  4115*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4116     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4117
  4118     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4119         88  CERT-ADDED-BATCH                 VALUE ' '.
  4120         88  CERT-ADDED-ONLINE                VALUE '1'.
  4121         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4122         88  CERT-PURGED-OFFLINE              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  76
* EL131.cbl
  4123         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4124     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4125         88  CERT-AS-LOADED                   VALUE ' '.
  4126         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4127         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4128         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4129         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4130         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4131         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4132         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4133
  4134     12  CM-ACCOUNT-COMM-PCTS.
  4135         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4136         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4137
  4138     12  CM-USER-FIELD                     PIC X.
  4139     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4140     12  CM-CLP-STATE                      PIC XX.
  4141     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4142     12  CM-USER-RESERVED                  PIC XXX.
  4143     12  FILLER REDEFINES CM-USER-RESERVED.
  4144         16  CM-AH-CLASS-CD                PIC XX.
  4145         16  F                             PIC X.
  4146******************************************************************
  4147
  4148*                                COPY ELCTRLR.
  4149******************************************************************
  4150*                                                                *
  4151*                            ELCTRLR.                            *
  4152*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4153*                            VMOD=2.014                          *
  4154*                                                                *
  4155*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4156*                                                                *
  4157*   FILE TYPE = VSAM,KSDS                                        *
  4158*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4159*                                                                *
  4160*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4161*       ALTERNATE INDEX = NONE                                   *
  4162*                                                                *
  4163*   LOG = YES                                                    *
  4164*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4165******************************************************************
  4166*                   C H A N G E   L O G
  4167*
  4168* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4169*-----------------------------------------------------------------
  4170*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4171* EFFECTIVE    NUMBER
  4172*-----------------------------------------------------------------
  4173* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4174* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4175* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4176* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4177* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4178* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4179* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4180* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  77
* EL131.cbl
  4181* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4182* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4183* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4184* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4185* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4186* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4187* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4188* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4189* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4190* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4191* 040814    2014030500002  AJRA  ADD ICD CODES
  4192* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4193******************************************************************
  4194 01  ACTIVITY-TRAILERS.
  4195     12  AT-RECORD-ID                    PIC XX.
  4196         88  VALID-AT-ID                       VALUE 'AT'.
  4197
  4198     12  AT-CONTROL-PRIMARY.
  4199         16  AT-COMPANY-CD               PIC X.
  4200         16  AT-CARRIER                  PIC X.
  4201         16  AT-CLAIM-NO                 PIC X(7).
  4202         16  AT-CERT-NO.
  4203             20  AT-CERT-PRIME           PIC X(10).
  4204             20  AT-CERT-SFX             PIC X.
  4205         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4206             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4207             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4208             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4209             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4210             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4211             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4212             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4213             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4214             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4215             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4216             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4217             88  AT-BENEFICIARY-TRL           VALUE +91.
  4218             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4219             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4220             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4221             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4222
  4223     12  AT-TRAILER-TYPE                 PIC X.
  4224         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4225         88  PAYMENT-TR                       VALUE '2'.
  4226         88  AUTO-PAY-TR                      VALUE '3'.
  4227         88  CORRESPONDENCE-TR                VALUE '4'.
  4228         88  ADDRESS-TR                       VALUE '5'.
  4229         88  GENERAL-INFO-TR                  VALUE '6'.
  4230         88  AUTO-PROMPT-TR                   VALUE '7'.
  4231         88  DENIAL-TR                        VALUE '8'.
  4232         88  INCURRED-CHG-TR                  VALUE '9'.
  4233         88  FORM-CONTROL-TR                  VALUE 'A'.
  4234
  4235     12  AT-RECORDED-DT                  PIC XX.
  4236     12  AT-RECORDED-BY                  PIC X(4).
  4237     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4238
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  78
* EL131.cbl
  4239     12  AT-TRAILER-BODY                 PIC X(165).
  4240
  4241     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4242         16  AT-RESERVE-CONTROLS.
  4243             20  AT-MANUAL-SW            PIC X.
  4244                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4245             20  AT-FUTURE-SW            PIC X.
  4246                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4247             20  AT-PTC-SW               PIC X.
  4248                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4249             20  AT-IBNR-SW              PIC X.
  4250                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4251             20  AT-PTC-LF-SW            PIC X.
  4252                 88  AT-LF-PTC-USED          VALUE '1'.
  4253             20  AT-CDT-ACCESS-METHOD    PIC X.
  4254                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4255                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4256                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4257             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4258         16  AT-LAST-COMPUTED-DT         PIC XX.
  4259         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4260         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4261         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4262         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4263         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4264         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4265         16  AT-EXPENSE-CONTROLS.
  4266             20  AT-EXPENSE-METHOD       PIC X.
  4267                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4268                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4269                 88  PERCENT-OF-PMT           VALUE '3'.
  4270                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4271             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4272             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4273         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4274         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4275
  4276         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4277         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4278
  4279*        16  FILLER                      PIC X(53).
  4280         16  FILLER                      PIC X(47).
  4281
  4282         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4283         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4284
  4285         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4286             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4287             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4288*                    C = CLOSED
  4289*                    O = OPEN
  4290             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4291*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4292
  4293     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4294         16  AT-PAYMENT-TYPE             PIC X.
  4295             88  PARTIAL-PAYMENT                VALUE '1'.
  4296             88  FINAL-PAYMENT                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  79
* EL131.cbl
  4297             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4298             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4299             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4300             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4301             88  VOIDED-PAYMENT                 VALUE '9'.
  4302             88  TRANSFER                       VALUE 'T'.
  4303             88  LIFE-INTEREST                  VALUE 'I'.
  4304
  4305         16  AT-CLAIM-TYPE               PIC X.
  4306             88  PAID-FOR-AH                    VALUE 'A'.
  4307             88  PAID-FOR-LIFE                  VALUE 'L'.
  4308             88  PAID-FOR-IUI                   VALUE 'I'.
  4309             88  PAID-FOR-GAP                   VALUE 'G'.
  4310             88  PAID-FOR-FAM                   VALUE 'F'.
  4311         16  AT-CLAIM-PREM-TYPE          PIC X.
  4312             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4313             88  AT-O-B-COVERAGE                VALUE '2'.
  4314             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4315         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4316         16  AT-CHECK-NO                 PIC X(7).
  4317         16  AT-PAID-FROM-DT             PIC XX.
  4318         16  AT-PAID-THRU-DT             PIC XX.
  4319         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4320         16  FILLER                      PIC X.
  4321         16  AT-PAYEES-NAME              PIC X(30).
  4322         16  AT-PAYMENT-ORIGIN           PIC X.
  4323             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4324             88  ONLINE-AUTO-PMT                VALUE '2'.
  4325             88  OFFLINE-PMT                    VALUE '3'.
  4326         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4327         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4328         16  AT-VOID-DATA.
  4329             20  AT-VOID-DT              PIC XX.
  4330*00144       20  AT-VOID-REASON          PIC X(30).
  4331             20  AT-VOID-REASON          PIC X(26).
  4332         16  AT-PMT-APPROVED-BY          PIC X(04).
  4333         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4334         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4335         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4336                                         PIC S99V9(5)  COMP-3.
  4337         16  AT-CREDIT-INTERFACE.
  4338             20  AT-PMT-SELECT-DT        PIC XX.
  4339                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4340             20  AT-PMT-ACCEPT-DT        PIC XX.
  4341                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4342             20  AT-VOID-SELECT-DT       PIC XX.
  4343                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4344             20  AT-VOID-ACCEPT-DT       PIC XX.
  4345                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4346
  4347         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4348                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4349                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4350         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4351
  4352         16  AT-FORCE-CONTROL            PIC X.
  4353             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4354         16  AT-PREV-LAST-PMT-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  80
* EL131.cbl
  4355         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4356         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4357         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4358         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4359         16  AT-BENEFIT-TYPE             PIC X.
  4360
  4361         16  AT-EXPENSE-TYPE             PIC X.
  4362         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4363
  4364         16  AT-PAYEE-TYPE-CD.
  4365             20  AT-PAYEE-TYPE           PIC X.
  4366                 88  INSURED-PAID           VALUE 'I'.
  4367                 88  BENEFICIARY-PAID       VALUE 'B'.
  4368                 88  ACCOUNT-PAID           VALUE 'A'.
  4369                 88  OTHER-1-PAID           VALUE 'O'.
  4370                 88  OTHER-2-PAID           VALUE 'Q'.
  4371                 88  DOCTOR-PAID            VALUE 'P'.
  4372                 88  EMPLOYER-PAID          VALUE 'E'.
  4373             20  AT-PAYEE-SEQ            PIC X.
  4374
  4375         16  AT-CASH-PAYMENT             PIC X.
  4376         16  AT-GROUPED-PAYMENT          PIC X.
  4377         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4378         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4379         16  AT-APPROVED-LEVEL           PIC X.
  4380         16  AT-VOID-TYPE                PIC X.
  4381             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4382             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4383         16  AT-AIG-UNEMP-IND            PIC X.
  4384             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4385         16  AT-ASSOCIATES               PIC X.
  4386             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4387             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4388
  4389         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4390         16  AT-CV-PMT-CODE              PIC X.
  4391             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4392             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4393             88  FULL-ADD-PAYMENT           VALUE '3'.
  4394             88  HALF-ADD-PAYMENT           VALUE '4'.
  4395             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4396             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4397             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4398             88  ADDL-PAYMENT               VALUE '8'.
  4399
  4400         16  AT-EOB-CODE1                PIC XXX.
  4401         16  AT-EOB-CODE2                PIC XXX.
  4402         16  AT-EOB-CODE3                PIC XXX.
  4403         16  FILLER REDEFINES AT-EOB-CODE3.
  4404             20  AT-PRINT-CLM-FORM       PIC X.
  4405             20  AT-PRINT-SURVEY         PIC X.
  4406             20  AT-SPECIAL-RELEASE      PIC X.
  4407         16  AT-EOB-CODE4                PIC XXX.
  4408         16  FILLER REDEFINES AT-EOB-CODE4.
  4409             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4410             20  FILLER                  PIC X.
  4411         16  AT-EOB-CODE5                PIC XXX.
  4412         16  FILLER REDEFINES AT-EOB-CODE5.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  81
* EL131.cbl
  4413             20  AT-PMT-PROOF-DT         PIC XX.
  4414             20  FILLER                  PIC X.
  4415
  4416         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4417             88  AT-PRINT-EOB            VALUE 'Y'.
  4418
  4419         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4420         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4421
  4422     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4423         16  AT-SCHEDULE-START-DT        PIC XX.
  4424         16  AT-SCHEDULE-END-DT          PIC XX.
  4425         16  AT-TERMINATED-DT            PIC XX.
  4426         16  AT-LAST-PMT-TYPE            PIC X.
  4427             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4428             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4429         16  AT-FIRST-PMT-DATA.
  4430             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4431             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4432             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4433         16  AT-REGULAR-PMT-DATA.
  4434             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4435             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4436             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4437         16  AT-AUTO-PAYEE-CD.
  4438             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4439                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4440                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4441                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4442                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4443                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4444             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4445         16  AT-AUTO-PAY-DAY             PIC 99.
  4446         16  AT-AUTO-CASH                PIC X.
  4447             88  AT-CASH                      VALUE 'Y'.
  4448             88  AT-NON-CASH                  VALUE 'N'.
  4449*        16  FILLER                      PIC X(129).
  4450         16  AT-AUTO-END-LETTER          PIC X(4).
  4451         16  FILLER                      PIC X(125).
  4452
  4453         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4454         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4455
  4456     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4457         16  AT-LETTER-SENT-DT           PIC XX.
  4458         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4459         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4460         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4461         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4462         16  AT-LETTER-ORIGIN            PIC X.
  4463             88  ONLINE-CREATION              VALUE '1' '3'.
  4464             88  OFFLINE-CREATION             VALUE '2' '4'.
  4465             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4466             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4467         16  AT-STD-LETTER-FORM          PIC X(4).
  4468         16  AT-REASON-TEXT              PIC X(70).
  4469         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4470         16  AT-ADDRESEE-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  82
* EL131.cbl
  4471              88  INSURED-ADDRESEE            VALUE 'I'.
  4472              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4473              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4474              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4475              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4476              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4477              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4478         16  AT-ADDRESSEE-NAME           PIC X(30).
  4479         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4480         16  AT-RESEND-PRINT-DATE        PIC XX.
  4481         16  AT-CORR-SOL-UNSOL           PIC X.
  4482         16  AT-LETTER-PURGED-DT         PIC XX.
  4483*
  4484*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4485*
  4486         16  AT-CSO-REDEFINITION.
  4487             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4488             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4489             20  AT-LETTER-TO-BENE       PIC X(1).
  4490             20  AT-STOP-LETTER-DT       PIC X(2).
  4491             20  FILLER                  PIC X(19).
  4492*             20  FILLER                  PIC X(27).
  4493             20  AT-CSO-LETTER-STATUS    PIC X.
  4494                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4495                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4496                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4497             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4498             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4499*
  4500*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4501*
  4502*        16  FILLER                      PIC X(26).
  4503*
  4504*        16  AT-DMD-BSR-CODE             PIC X.
  4505*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4506*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4507*
  4508*        16  AT-DMD-LETTER-STATUS        PIC X.
  4509*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4510*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4511*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4512*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4513*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4514
  4515         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4516         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4517
  4518     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4519         16  AT-ADDRESS-TYPE             PIC X.
  4520             88  INSURED-ADDRESS               VALUE 'I'.
  4521             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4522             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4523             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4524             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4525             88  OTHER-ADDRESS-1               VALUE 'O'.
  4526             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4527         16  AT-MAIL-TO-NAME             PIC X(30).
  4528         16  AT-ADDRESS-LINE-1           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  83
* EL131.cbl
  4529         16  AT-ADDRESS-LINE-2           PIC X(30).
  4530         16  AT-CITY-STATE.
  4531             20  AT-CITY                 PIC X(28).
  4532             20  AT-STATE                PIC XX.
  4533         16  AT-ZIP.
  4534             20  AT-ZIP-CODE.
  4535                 24  AT-ZIP-1ST          PIC X.
  4536                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4537                 24  FILLER              PIC X(4).
  4538             20  AT-ZIP-PLUS4            PIC X(4).
  4539         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4540             20  AT-CAN-POSTAL-1         PIC XXX.
  4541             20  AT-CAN-POSTAL-2         PIC XXX.
  4542             20  FILLER                  PIC XXX.
  4543         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4544*         16  FILLER                      PIC X(23).
  4545         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4546         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4547         16  FILLER                      PIC X(13).
  4548         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4549         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4550
  4551     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4552         16  AT-INFO-LINE-1              PIC X(60).
  4553         16  FILLER REDEFINES AT-INFO-LINE-1.
  4554             20  AT-NOTE-ERROR-NO OCCURS 15
  4555                                         PIC X(4).
  4556         16  AT-INFO-LINE-2              PIC X(60).
  4557         16  FILLER REDEFINES AT-INFO-LINE-2.
  4558             20  AT-ICD-CODE-1           PIC X(8).
  4559             20  AT-ICD-CODE-2           PIC X(8).
  4560             20  FILLER                  PIC X(44).
  4561         16  AT-INFO-TRAILER-TYPE        PIC X.
  4562             88  AT-ERRORS-NOTE          VALUE 'E'.
  4563             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4564             88  AT-CALL-NOTE            VALUE 'C'.
  4565             88  AT-MAINT-NOTE           VALUE 'M'.
  4566             88  AT-CERT-CHANGE          VALUE 'X'.
  4567             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4568             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4569             88  AT-CERT-CANCELLED       VALUE 'T'.
  4570         16  AT-CALL-TYPE                PIC X.
  4571             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4572             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4573         16  AT-NOTE-CONTINUATION        PIC X.
  4574             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4575         16  AT-EOB-CODES-EXIST          PIC X.
  4576             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4577         16  FILLER                      PIC X(35).
  4578         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4579         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4580
  4581     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4582         16  AT-PROMPT-LINE-1            PIC X(60).
  4583         16  AT-PROMPT-LINE-2            PIC X(60).
  4584         16  AT-PROMPT-START-DT          PIC XX.
  4585         16  AT-PROMPT-END-DT            PIC XX.
  4586         16  FILLER                      PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  84
* EL131.cbl
  4587         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4588         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4589
  4590     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4591         16  AT-DENIAL-INFO-1            PIC X(60).
  4592         16  AT-DENIAL-INFO-2            PIC X(60).
  4593         16  AT-DENIAL-DT                PIC XX.
  4594         16  AT-RETRACTION-DT            PIC XX.
  4595         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4596*         16  FILLER                      PIC X(31).
  4597         16  AT-DENIAL-PROOF-DT          PIC XX.
  4598         16  FILLER                      PIC X(29).
  4599         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4600         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4601
  4602     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4603         16  AT-OLD-INCURRED-DT          PIC XX.
  4604         16  AT-OLD-REPORTED-DT          PIC XX.
  4605         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4606         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4607         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4608         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4609         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4610         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4611         16  FILLER                      PIC X(26).
  4612         16  AT-OLD-DIAG-CODE            PIC X(6).
  4613         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4614         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4615         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4616         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4617         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4618         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4619         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4620         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4621         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4622         16  FILLER                      PIC X(9).
  4623         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4624
  4625     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4626         16  AT-FORM-SEND-ON-DT          PIC XX.
  4627         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4628         16  AT-FORM-RE-SEND-DT          PIC XX.
  4629         16  AT-FORM-ANSWERED-DT         PIC XX.
  4630         16  AT-FORM-PRINTED-DT          PIC XX.
  4631         16  AT-FORM-REPRINT-DT          PIC XX.
  4632         16  AT-FORM-TYPE                PIC X.
  4633             88  INITIAL-FORM                  VALUE '1'.
  4634             88  PROGRESS-FORM                 VALUE '2'.
  4635         16  AT-INSTRUCT-LN-1            PIC X(28).
  4636         16  AT-INSTRUCT-LN-2            PIC X(28).
  4637         16  AT-INSTRUCT-LN-3            PIC X(28).
  4638         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4639         16  AT-FORM-ADDRESS             PIC X.
  4640             88  FORM-TO-INSURED              VALUE 'I'.
  4641             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4642             88  FORM-TO-OTHER-1              VALUE 'O'.
  4643             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4644         16  AT-RELATED-1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  85
* EL131.cbl
  4645             20 AT-REL-CARR-1            PIC X.
  4646             20 AT-REL-CLAIM-1           PIC X(7).
  4647             20 AT-REL-CERT-1            PIC X(11).
  4648         16  AT-RELATED-2.
  4649             20 AT-REL-CARR-2            PIC X.
  4650             20 AT-REL-CLAIM-2           PIC X(7).
  4651             20 AT-REL-CERT-2            PIC X(11).
  4652         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4653         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4654         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4655         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4656         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4657         16  AT-STOP-FORM-DT             PIC X(2).
  4658
  4659         16  FILLER                      PIC X(09).
  4660         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4661         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4662******************************************************************
  4663
  4664*                                COPY ELCCNTL.
  4665******************************************************************
  4666*                                                                *
  4667*                                                                *
  4668*                            ELCCNTL.                            *
  4669*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4670*                            VMOD=2.059                          *
  4671*                                                                *
  4672*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4673*                                                                *
  4674*   FILE TYPE = VSAM,KSDS                                        *
  4675*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4676*                                                                *
  4677*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4678*       ALTERNATE INDEX = NONE                                   *
  4679*                                                                *
  4680*   LOG = YES                                                    *
  4681*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4682******************************************************************
  4683*                   C H A N G E   L O G
  4684*
  4685* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4686*-----------------------------------------------------------------
  4687*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4688* EFFECTIVE    NUMBER
  4689*-----------------------------------------------------------------
  4690* 082503                   PEMA  ADD BENEFIT GROUP
  4691* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4692* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4693* 092705    2005050300006  PEMA  ADD SPP LEASES
  4694* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4695* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4696* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4697* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4698* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4699* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4700* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4701* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4702* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  86
* EL131.cbl
  4703* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4704******************************************************************
  4705*
  4706 01  CONTROL-FILE.
  4707     12  CF-RECORD-ID                       PIC XX.
  4708         88  VALID-CF-ID                        VALUE 'CF'.
  4709
  4710     12  CF-CONTROL-PRIMARY.
  4711         16  CF-COMPANY-ID                  PIC XXX.
  4712         16  CF-RECORD-TYPE                 PIC X.
  4713             88  CF-COMPANY-MASTER              VALUE '1'.
  4714             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4715             88  CF-STATE-MASTER                VALUE '3'.
  4716             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4717             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4718             88  CF-CARRIER-MASTER              VALUE '6'.
  4719             88  CF-MORTALITY-MASTER            VALUE '7'.
  4720             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4721             88  CF-TERMINAL-MASTER             VALUE '9'.
  4722             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4723             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4724             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4725             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4726             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4727             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4728             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4729             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4730             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4731         16  CF-ACCESS-CD-GENL              PIC X(4).
  4732         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4733             20  CF-PROCESSOR               PIC X(4).
  4734         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4735             20  CF-STATE-CODE              PIC XX.
  4736             20  FILLER                     PIC XX.
  4737         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4738             20  FILLER                     PIC XX.
  4739             20  CF-HI-BEN-IN-REC           PIC XX.
  4740         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4741             20  FILLER                     PIC XXX.
  4742             20  CF-CARRIER-CNTL            PIC X.
  4743         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4744             20  FILLER                     PIC XX.
  4745             20  CF-HI-TYPE-IN-REC          PIC 99.
  4746         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4747             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4748                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4749             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4750             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4751         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4752             20  FILLER                     PIC X.
  4753             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4754         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4755             20  FILLER                     PIC XX.
  4756             20  CF-MORTGAGE-PLAN           PIC XX.
  4757         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4758
  4759     12  CF-LAST-MAINT-DT                   PIC XX.
  4760     12  CF-LAST-MAINT-BY                   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  87
* EL131.cbl
  4761     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4762
  4763     12  CF-RECORD-BODY                     PIC X(728).
  4764
  4765
  4766****************************************************************
  4767*             COMPANY MASTER RECORD                            *
  4768****************************************************************
  4769
  4770     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4771         16  CF-COMPANY-ADDRESS.
  4772             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4773             20  CF-CL-IN-CARE-OF           PIC X(30).
  4774             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4775             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4776             20  CF-CL-CITY-STATE           PIC X(30).
  4777             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4778             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4779         16  CF-COMPANY-CD                  PIC X.
  4780         16  CF-COMPANY-PASSWORD            PIC X(8).
  4781         16  CF-SECURITY-OPTION             PIC X.
  4782             88  ALL-SECURITY                   VALUE '1'.
  4783             88  COMPANY-VERIFY                 VALUE '2'.
  4784             88  PROCESSOR-VERIFY               VALUE '3'.
  4785             88  NO-SECURITY                    VALUE '4'.
  4786             88  ALL-BUT-TERM                   VALUE '5'.
  4787         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4788             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4789         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4790             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4791         16  CF-INFORCE-LOCATION            PIC X.
  4792             88  CERTS-ARE-ONLINE               VALUE '1'.
  4793             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4794             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4795         16  CF-LOWER-CASE-LETTERS          PIC X.
  4796         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4797             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4798             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4799             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4800             88  CF-ACCNT-CNTL                  VALUE '3'.
  4801             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4802
  4803         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4804         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4805
  4806         16  CF-LGX-CREDIT-USER             PIC X.
  4807             88  CO-IS-NOT-USER                 VALUE 'N'.
  4808             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4809
  4810         16 CF-CREDIT-CALC-CODES.
  4811             20  CF-CR-REM-TERM-CALC PIC X.
  4812               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4813               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4814               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4815               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4816               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4817               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4818               88  CR-EARN-AFTER-16TH           VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  88
* EL131.cbl
  4819             20  CF-CR-R78-METHOD           PIC X.
  4820               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4821               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4822
  4823         16  CF-CLAIM-CONTROL-COUNTS.
  4824             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4825                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4826
  4827             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4828                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4829
  4830             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4831                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4832
  4833             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4834                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4835
  4836         16  CF-CURRENT-MONTH-END           PIC XX.
  4837
  4838         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4839             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4840             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4841             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4842             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4843                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4844                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4845             20  CF-CO-PREM-REJECT-SW       PIC X.
  4846                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4847                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4848             20  CF-CO-REF-REJECT-SW        PIC X.
  4849                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4850                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4851
  4852         16  CF-CO-REPORTING-DT             PIC XX.
  4853         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4854         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4855           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4856           88  CF-CO-MONTH-END                  VALUE '1'.
  4857
  4858         16  CF-LGX-CLAIM-USER              PIC X.
  4859             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4860             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4861
  4862         16  CF-CREDIT-EDIT-CONTROLS.
  4863             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4864             20  CF-MIN-AGE                 PIC 99.
  4865             20  CF-DEFAULT-AGE             PIC 99.
  4866             20  CF-MIN-TERM                PIC S999      COMP-3.
  4867             20  CF-MAX-TERM                PIC S999      COMP-3.
  4868             20  CF-DEFAULT-SEX             PIC X.
  4869             20  CF-JOINT-AGE-INPUT         PIC X.
  4870                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4871             20  CF-BIRTH-DATE-INPUT        PIC X.
  4872                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4873             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4874                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4875                 88  CF-ZERO-CARRIER            VALUE '1'.
  4876                 88  CF-ZERO-GROUPING           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  89
* EL131.cbl
  4877                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4878             20  CF-EDIT-SW                 PIC X.
  4879                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4880             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4881             20  CF-CR-PR-METHOD            PIC X.
  4882               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4883               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4884             20  FILLER                     PIC X.
  4885
  4886         16  CF-CREDIT-MISC-CONTROLS.
  4887             20  CF-REIN-TABLE-SW           PIC X.
  4888                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4889             20  CF-COMP-TABLE-SW           PIC X.
  4890                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4891             20  CF-EXPERIENCE-RETENTION-AGE
  4892                                            PIC S9        COMP-3.
  4893             20  CF-CONVERSION-DT           PIC XX.
  4894             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4895             20  CF-RUN-FREQUENCY-SW        PIC X.
  4896                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4897                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4898
  4899             20  CF-CR-CHECK-NO-CONTROL.
  4900                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4901                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4902                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4903                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4904                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4905                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4906
  4907                 24  CF-CR-CHECK-COUNT       REDEFINES
  4908                     CF-CR-CHECK-COUNTER      PIC X(4).
  4909
  4910                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4911                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4912
  4913                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4914                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4915                 24  CF-MAIL-PROCESSING       PIC X.
  4916                     88  MAIL-PROCESSING          VALUE 'Y'.
  4917
  4918         16  CF-MISC-SYSTEM-CONTROL.
  4919             20  CF-SYSTEM-C                 PIC X.
  4920                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4921             20  CF-SYSTEM-D                 PIC X.
  4922                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4923             20  CF-SOC-SEC-NO-SW            PIC X.
  4924                 88  SOC-SEC-NO-USED             VALUE '1'.
  4925             20  CF-MEMBER-NO-SW             PIC X.
  4926                 88  MEMBER-NO-USED              VALUE '1'.
  4927             20  CF-TAX-ID-NUMBER            PIC X(11).
  4928             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4929             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4930                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4931                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4932                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4933                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4934             20  CF-SYSTEM-E                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  90
* EL131.cbl
  4935                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4936
  4937         16  CF-LGX-LIFE-USER               PIC X.
  4938             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4939             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4940
  4941         16  CF-CR-MONTH-END-DT             PIC XX.
  4942
  4943         16  CF-FILE-MAINT-DATES.
  4944             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4945                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4946             20  CF-LAST-BATCH       REDEFINES
  4947                 CF-LAST-BATCH-NO               PIC X(4).
  4948             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4949             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4950             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4951             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4952             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4953             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4954             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4955             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4956             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4957             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4958
  4959         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4960         16  FILLER                         PIC X.
  4961
  4962         16  CF-ALT-MORT-CODE               PIC X(4).
  4963         16  CF-MEMBER-CAPTION              PIC X(10).
  4964
  4965         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4966             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4967             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4968             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4969             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4970             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4971
  4972         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4973
  4974         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4975         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4976         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4977         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4978
  4979         16  CF-AH-OVERRIDE-L1              PIC X.
  4980         16  CF-AH-OVERRIDE-L2              PIC XX.
  4981         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4982         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4983
  4984         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4985         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4986
  4987         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4988         16  CF-AR-LAST-EL860-DT            PIC XX.
  4989         16  CF-MP-MONTH-END-DT             PIC XX.
  4990
  4991         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4992         16  CF-CLAIM-PAID-THRU-TO          PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  91
* EL131.cbl
  4993             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4994
  4995         16  CF-AR-MONTH-END-DT             PIC XX.
  4996
  4997         16  CF-CRDTCRD-USER                PIC X.
  4998             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4999             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5000
  5001         16  CF-CC-MONTH-END-DT             PIC XX.
  5002
  5003         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5004
  5005         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5006             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5007             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5008             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5009         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5010         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5011         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5012         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5013             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5014             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5015         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5016         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5017         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5018             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5019         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5020
  5021         16  CF-CL-ZIP-CODE.
  5022             20  CF-CL-ZIP-PRIME.
  5023                 24  CF-CL-ZIP-1ST          PIC X.
  5024                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5025                 24  FILLER                 PIC X(4).
  5026             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5027         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5028             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5029             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5030             20  FILLER                     PIC XXX.
  5031
  5032         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5033         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5034         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5035         16  CF-CO-OPTION-START-DATE        PIC XX.
  5036         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5037           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5038                                                      '3' '4'.
  5039           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5040           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5041           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5042           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5043           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5044           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5045
  5046         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5047
  5048         16  CF-PAYMENT-APPROVAL-LEVELS.
  5049             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5050             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  92
* EL131.cbl
  5051             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5052             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5053             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5054             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5055
  5056         16  CF-END-USER-REPORTING-USER     PIC X.
  5057             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5058             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5059
  5060         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5061             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5062             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5063
  5064         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5065
  5066         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5067         16  FILLER                         PIC X.
  5068
  5069         16  CF-CREDIT-ARCHIVE-CNTL.
  5070             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5071             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5072             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5073
  5074         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5075
  5076         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5077             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5078             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5079
  5080         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5081             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5082             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5083
  5084         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5085
  5086         16  CF-CO-ACH-ID-CODE              PIC  X.
  5087             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5088             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5089             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5090         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5091         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5092         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5093         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5094         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5095         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5096         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5097         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5098         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5099                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5100         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5101                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5102
  5103         16  CF-CO-OVER-SHORT.
  5104             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5105             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5106
  5107*         16  FILLER                         PIC X(102).
  5108         16  CF-PAYMENT-APPROVAL-LEVELS-2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  93
* EL131.cbl
  5109             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5110             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5111
  5112         16  CF-AH-APPROVAL-DAYS.
  5113             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5114             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5115             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5116             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5117
  5118         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5119
  5120         16  CF-APPROV-LEV-5.
  5121             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5122             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5123             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5124
  5125         16  FILLER                         PIC X(68).
  5126****************************************************************
  5127*             PROCESSOR/USER RECORD                            *
  5128****************************************************************
  5129
  5130     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5131         16  CF-PROCESSOR-NAME              PIC X(30).
  5132         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5133         16  CF-PROCESSOR-TITLE             PIC X(26).
  5134         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5135                 88  MESSAGE-YES                VALUE 'Y'.
  5136                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5137
  5138*****************************************************
  5139****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5140****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5141****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5142****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5143*****************************************************
  5144
  5145         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5146             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5147             20  CF-APPLICATION-FORCE       PIC X.
  5148             20  CF-INDIVIDUAL-APP.
  5149                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5150                     28  CF-BROWSE-APP      PIC X.
  5151                     28  CF-UPDATE-APP      PIC X.
  5152
  5153         16  CF-CURRENT-TERM-ON             PIC X(4).
  5154         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5155             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5156             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5157             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5158             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5159             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5160             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5161             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5162         16  CF-PROCESSOR-CARRIER           PIC X.
  5163             88  NO-CARRIER-SECURITY            VALUE ' '.
  5164         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5165             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5166         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  94
* EL131.cbl
  5167             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5168         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5169             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5170
  5171         16  CF-PROC-SYS-ACCESS-SW.
  5172             20  CF-PROC-CREDIT-CLAIMS-SW.
  5173                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5174                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5175                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5176                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5177             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5178                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5179                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5180             20  CF-PROC-LIFE-GNRLDGR-SW.
  5181                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5182                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5183                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5184                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5185             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5186                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5187                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5188         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5189             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5190             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5191         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5192
  5193         16  CF-APPROVAL-LEVEL                  PIC X.
  5194             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5195             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5196             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5197             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5198             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5199
  5200         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5201
  5202         16  CF-LANGUAGE-TYPE                   PIC X.
  5203             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5204             88  CF-LANG-IS-FR                      VALUE 'F'.
  5205
  5206         16  CF-CSR-IND                         PIC X.
  5207         16  FILLER                             PIC X(239).
  5208
  5209****************************************************************
  5210*             PROCESSOR/REMINDERS RECORD                       *
  5211****************************************************************
  5212
  5213     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5214         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5215             20  CF-START-REMIND-DT         PIC XX.
  5216             20  CF-END-REMIND-DT           PIC XX.
  5217             20  CF-REMINDER-TEXT           PIC X(50).
  5218         16  FILLER                         PIC X(296).
  5219
  5220
  5221****************************************************************
  5222*             STATE MASTER RECORD                              *
  5223****************************************************************
  5224
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  95
* EL131.cbl
  5225     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5226         16  CF-STATE-ABBREVIATION          PIC XX.
  5227         16  CF-STATE-NAME                  PIC X(25).
  5228         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5229         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5230             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5231             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5232             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5233             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5234                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5235                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5236             20  CF-ST-PREM-REJECT-SW       PIC X.
  5237                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5238                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5239             20  CF-ST-REF-REJECT-SW        PIC X.
  5240                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5241                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5242         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5243         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5244         16  CF-ST-REFUND-RULES.
  5245             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5246             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5247             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5248         16  CF-ST-FST-PMT-EXTENSION.
  5249             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5250             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5251                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5252                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5253                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5254                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5255         16  CF-ST-STATE-CALL.
  5256             20  CF-ST-CALL-UNEARNED        PIC X.
  5257             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5258             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5259         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5260             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5261             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5262         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5263         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5264         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5265         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5266         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5267         16  FILLER                         PIC X.
  5268         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5269             20  CF-ST-BENEFIT-CD           PIC XX.
  5270             20  CF-ST-BENEFIT-KIND         PIC X.
  5271                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5272                 88  CF-ST-AH-KIND              VALUE 'A'.
  5273             20  CF-ST-REM-TERM-CALC        PIC X.
  5274                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5275                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5276                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5277                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5278                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5279                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5280                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5281                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5282
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  96
* EL131.cbl
  5283             20  CF-ST-REFUND-CALC          PIC X.
  5284                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5285                 88  ST-REFD-BY-R78             VALUE '1'.
  5286                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5287                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5288                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5289                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5290                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5291                 88  ST-REFD-UTAH               VALUE '7'.
  5292                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5293                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5294                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5295
  5296             20  CF-ST-EARNING-CALC         PIC X.
  5297                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5298                 88  ST-EARN-BY-R78             VALUE '1'.
  5299                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5300                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5301                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5302                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5303                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5304                 88  ST-EARN-MEAN               VALUE '8'.
  5305                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5306
  5307             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5308                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5309                 88  ST-OVRD-BY-R78             VALUE '1'.
  5310                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5311                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5312                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5313                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5314                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5315                 88  ST-OVRD-MEAN               VALUE '8'.
  5316                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5317             20  FILLER                     PIC X.
  5318
  5319         16  CF-ST-COMMISSION-CAPS.
  5320             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5321             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5322             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5323             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5324         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5325                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5326
  5327         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5328
  5329         16  CF-ST-STATUTORY-INTEREST.
  5330             20  CF-ST-STAT-DATE-FROM       PIC X.
  5331                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5332                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5333             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5334             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5335             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5336             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5337             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5338
  5339         16  CF-ST-OVER-SHORT.
  5340             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  97
* EL131.cbl
  5341             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5342
  5343         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5344
  5345         16  CF-ST-RT-CALC                  PIC X.
  5346
  5347         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5348         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5349         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5350         16  CF-ST-RF-LR-CALC               PIC X.
  5351         16  CF-ST-RF-LL-CALC               PIC X.
  5352         16  CF-ST-RF-LN-CALC               PIC X.
  5353         16  CF-ST-RF-AH-CALC               PIC X.
  5354         16  CF-ST-RF-CP-CALC               PIC X.
  5355*        16  FILLER                         PIC X(206).
  5356*CIDMOD         16  FILLER                         PIC X(192).
  5357         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5358             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5359         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5360         16  CF-ST-VFY-2ND-BENE             PIC X.
  5361         16  CF-ST-CAUSAL-STATE             PIC X.
  5362         16  FILLER                         PIC X(185).
  5363
  5364****************************************************************
  5365*             BENEFIT MASTER RECORD                            *
  5366****************************************************************
  5367
  5368     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5369         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5370             20  CF-BENEFIT-CODE            PIC XX.
  5371             20  CF-BENEFIT-NUMERIC  REDEFINES
  5372                 CF-BENEFIT-CODE            PIC XX.
  5373             20  CF-BENEFIT-ALPHA           PIC XXX.
  5374             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5375             20  CF-BENEFIT-COMMENT         PIC X(10).
  5376
  5377             20  CF-LF-COVERAGE-TYPE        PIC X.
  5378                 88  CF-REDUCING                VALUE 'R'.
  5379                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5380
  5381             20  CF-SPECIAL-CALC-CD         PIC X.
  5382                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5383                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5384                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5385                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5386                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5387                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5388                 88  CF-FARM-PLAN               VALUE 'F'.
  5389                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5390                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5391                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5392                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5393                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5394                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5395                 88  CF-PRUDENTIAL              VALUE 'P'.
  5396                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5397                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5398                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  98
* EL131.cbl
  5399                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5400                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5401                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5402
  5403             20  CF-JOINT-INDICATOR         PIC X.
  5404                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5405
  5406*            20  FILLER                     PIC X(12).
  5407             20  cf-maximum-benefits        pic s999 comp-3.
  5408             20  FILLER                     PIC X(09).
  5409             20  CF-BENEFIT-CATEGORY        PIC X.
  5410             20  CF-LOAN-TYPE               PIC X(8).
  5411
  5412             20  CF-CO-REM-TERM-CALC        PIC X.
  5413                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5414                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5415                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5416                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5417                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5418
  5419             20  CF-CO-EARNINGS-CALC        PIC X.
  5420                 88  CO-EARN-BY-R78             VALUE '1'.
  5421                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5422                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5423                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5424                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5425                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5426                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5427                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5428
  5429             20  CF-CO-REFUND-CALC          PIC X.
  5430                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5431                 88  CO-REFD-BY-R78             VALUE '1'.
  5432                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5433                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5434                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5435                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5436                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5437                 88  CO-REFD-MEAN               VALUE '8'.
  5438                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5439                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5440                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5441
  5442             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5443                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5444                 88  CO-OVRD-BY-R78             VALUE '1'.
  5445                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5446                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5447                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5448                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5449                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5450                 88  CO-OVRD-MEAN               VALUE '8'.
  5451                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5452
  5453             20  CF-CO-BEN-I-G-CD           PIC X.
  5454                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5455                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5456                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  99
* EL131.cbl
  5457
  5458         16  FILLER                         PIC X(304).
  5459
  5460
  5461****************************************************************
  5462*             CARRIER MASTER RECORD                            *
  5463****************************************************************
  5464
  5465     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5466         16  CF-ADDRESS-DATA.
  5467             20  CF-MAIL-TO-NAME            PIC X(30).
  5468             20  CF-IN-CARE-OF              PIC X(30).
  5469             20  CF-ADDRESS-LINE-1          PIC X(30).
  5470             20  CF-ADDRESS-LINE-2          PIC X(30).
  5471             20  CF-CITY-STATE              PIC X(30).
  5472             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5473             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5474
  5475         16  CF-CLAIM-NO-CONTROL.
  5476             20  CF-CLAIM-NO-METHOD         PIC X.
  5477                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5478                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5479                 88  CLAIM-NO-SEQ               VALUE '3'.
  5480                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5481             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5482                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5483                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5484                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5485
  5486         16  CF-CHECK-NO-CONTROL.
  5487             20  CF-CHECK-NO-METHOD         PIC X.
  5488                 88  CHECK-NO-MANUAL            VALUE '1'.
  5489                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5490                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5491                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5492             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5493                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5494
  5495         16  CF-DOMICILE-STATE              PIC XX.
  5496
  5497         16  CF-EXPENSE-CONTROLS.
  5498             20  CF-EXPENSE-METHOD          PIC X.
  5499                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5500                 88  DOLLARS-PER-PMT            VALUE '2'.
  5501                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5502                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5503             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5504             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5505
  5506         16  CF-CORRESPONDENCE-CONTROL.
  5507             20  CF-LETTER-RESEND-OPT       PIC X.
  5508                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5509                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5510             20  FILLER                     PIC X(4).
  5511
  5512         16  CF-RESERVE-CONTROLS.
  5513             20  CF-MANUAL-SW               PIC X.
  5514                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 100
* EL131.cbl
  5515             20  CF-FUTURE-SW               PIC X.
  5516                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5517             20  CF-PTC-SW                  PIC X.
  5518                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5519             20  CF-IBNR-SW                 PIC X.
  5520                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5521             20  CF-PTC-LF-SW               PIC X.
  5522                 88  CF-LF-PTC-USED             VALUE '1'.
  5523             20  CF-CDT-ACCESS-METHOD       PIC X.
  5524                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5525                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5526                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5527             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5528
  5529         16  CF-CLAIM-CALC-METHOD           PIC X.
  5530             88  360-PLUS-MONTHS                VALUE '1'.
  5531             88  365-PLUS-MONTHS                VALUE '2'.
  5532             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5533             88  360-DAILY                      VALUE '4'.
  5534             88  365-DAILY                      VALUE '5'.
  5535
  5536         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5537         16  FILLER                         PIC X(11).
  5538
  5539         16  CF-LIMIT-AMOUNTS.
  5540             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5541             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5542             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5543             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5544             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5545             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5546             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5547             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5548             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5549             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5550
  5551         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5552         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5553         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5554
  5555         16  CF-ZIP-CODE.
  5556             20  CF-ZIP-PRIME.
  5557                 24  CF-ZIP-1ST             PIC X.
  5558                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5559                 24  FILLER                 PIC X(4).
  5560             20  CF-ZIP-PLUS4               PIC X(4).
  5561         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5562             20  CF-CAN-POSTAL-1            PIC XXX.
  5563             20  CF-CAN-POSTAL-2            PIC XXX.
  5564             20  FILLER                     PIC XXX.
  5565
  5566         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5567         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5568         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5569
  5570         16  CF-RATING-SWITCH               PIC X.
  5571             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5572             88  CF-NO-RATING                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 101
* EL131.cbl
  5573
  5574         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5575
  5576         16  CF-CARRIER-OVER-SHORT.
  5577             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5578             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5579
  5580         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5581         16  CF-SECPAY-SWITCH               PIC X.
  5582             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5583             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5584         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5585         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5586         16  FILLER                         PIC X(444).
  5587*        16  FILLER                         PIC X(452).
  5588
  5589
  5590****************************************************************
  5591*             MORTALITY MASTER RECORD                          *
  5592****************************************************************
  5593
  5594     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5595         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5596                                INDEXED BY CF-MORT-NDX.
  5597             20  CF-MORT-TABLE              PIC X(5).
  5598             20  CF-MORT-TABLE-TYPE         PIC X.
  5599                 88  CF-MORT-JOINT              VALUE 'J'.
  5600                 88  CF-MORT-SINGLE             VALUE 'S'.
  5601                 88  CF-MORT-COMBINED           VALUE 'C'.
  5602                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5603                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5604             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5605             20  CF-MORT-AGE-METHOD         PIC XX.
  5606                 88  CF-AGE-LAST                VALUE 'AL'.
  5607                 88  CF-AGE-NEAR                VALUE 'AN'.
  5608             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5609             20  CF-MORT-ADJUSTMENT-DIRECTION
  5610                                            PIC X.
  5611                 88  CF-MINUS                   VALUE '-'.
  5612                 88  CF-PLUS                    VALUE '+'.
  5613             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5614             20  CF-MORT-JOINT-CODE         PIC X.
  5615                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5616             20  CF-MORT-PC-Q               PIC X.
  5617                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5618             20  CF-MORT-TABLE-CODE         PIC X(4).
  5619             20  CF-MORT-COMMENTS           PIC X(15).
  5620             20  FILLER                     PIC X(14).
  5621
  5622         16  FILLER                         PIC X(251).
  5623
  5624
  5625****************************************************************
  5626*             BUSSINESS TYPE MASTER RECORD                     *
  5627****************************************************************
  5628
  5629     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5630* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 102
* EL131.cbl
  5631* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5632* AND RECORD 05 IS TYPES 81-99
  5633         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5634             20  CF-BUSINESS-TITLE          PIC  X(19).
  5635             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5636                                            PIC S9V9(4) COMP-3.
  5637             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5638             20  FILLER                     PIC  X.
  5639         16  FILLER                         PIC  X(248).
  5640
  5641
  5642****************************************************************
  5643*             TERMINAL MASTER RECORD                           *
  5644****************************************************************
  5645
  5646     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5647
  5648         16  CF-COMPANY-TERMINALS.
  5649             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5650                                  PIC X(4).
  5651         16  FILLER               PIC X(248).
  5652
  5653
  5654****************************************************************
  5655*             LIFE EDIT MASTER RECORD                          *
  5656****************************************************************
  5657
  5658     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5659         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5660             20  CF-LIFE-CODE-IN            PIC XX.
  5661             20  CF-LIFE-CODE-OUT           PIC XX.
  5662         16  FILLER                         PIC X(248).
  5663
  5664
  5665****************************************************************
  5666*             AH EDIT MASTER RECORD                            *
  5667****************************************************************
  5668
  5669     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5670         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5671             20  CF-AH-CODE-IN              PIC XXX.
  5672             20  CF-AH-CODE-OUT             PIC XX.
  5673         16  FILLER                         PIC X(248).
  5674
  5675
  5676****************************************************************
  5677*             CREDIBILITY TABLES                               *
  5678****************************************************************
  5679
  5680     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5681         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5682                             INDEXED BY CF-CRDB-NDX.
  5683             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5684             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5685             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5686         16  FILLER                         PIC  X(332).
  5687
  5688
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 103
* EL131.cbl
  5689****************************************************************
  5690*             REPORT CUSTOMIZATION RECORD                      *
  5691****************************************************************
  5692
  5693     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5694         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5695             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5696             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5697             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5698**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5699****       A T-TRANSFER.                                   ****
  5700             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5701
  5702         16  FILLER                         PIC XX.
  5703
  5704         16  CF-CARRIER-CNTL-OPT.
  5705             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5706                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5707                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5708             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5709                                            PIC X.
  5710         16  CF-GROUP-CNTL-OPT.
  5711             20  CF-GROUP-OPT-SEQ           PIC 9.
  5712                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5713                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5714             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5715                                            PIC X(6).
  5716         16  CF-STATE-CNTL-OPT.
  5717             20  CF-STATE-OPT-SEQ           PIC 9.
  5718                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5719                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5720             20  CF-STATE-SELECT OCCURS 3 TIMES
  5721                                            PIC XX.
  5722         16  CF-ACCOUNT-CNTL-OPT.
  5723             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5724                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5725                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5726             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5727                                            PIC X(10).
  5728         16  CF-BUS-TYP-CNTL-OPT.
  5729             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5730                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5731                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5732             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5733                                            PIC XX.
  5734         16  CF-LF-TYP-CNTL-OPT.
  5735             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5736                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5737                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5738             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5739                                            PIC XX.
  5740         16  CF-AH-TYP-CNTL-OPT.
  5741             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5742                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5743                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5744             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5745                                            PIC XX.
  5746         16  CF-REPTCD1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 104
* EL131.cbl
  5747             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5748                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5749                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5750             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5751                                            PIC X(10).
  5752         16  CF-REPTCD2-CNTL-OPT.
  5753             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5754                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5755                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5756             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5757                                            PIC X(10).
  5758         16  CF-USER1-CNTL-OPT.
  5759             20  CF-USER1-OPT-SEQ           PIC 9.
  5760                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5761                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5762             20  CF-USER1-SELECT OCCURS 3 TIMES
  5763                                            PIC X(10).
  5764         16  CF-USER2-CNTL-OPT.
  5765             20  CF-USER2-OPT-SEQ           PIC 9.
  5766                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5767                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5768             20  CF-USER2-SELECT OCCURS 3 TIMES
  5769                                            PIC X(10).
  5770         16  CF-USER3-CNTL-OPT.
  5771             20  CF-USER3-OPT-SEQ           PIC 9.
  5772                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5773                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5774             20  CF-USER3-SELECT OCCURS 3 TIMES
  5775                                            PIC X(10).
  5776         16  CF-USER4-CNTL-OPT.
  5777             20  CF-USER4-OPT-SEQ           PIC 9.
  5778                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5779                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5780             20  CF-USER4-SELECT OCCURS 3 TIMES
  5781                                            PIC X(10).
  5782         16  CF-USER5-CNTL-OPT.
  5783             20  CF-USER5-OPT-SEQ           PIC 9.
  5784                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5785                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5786             20  CF-USER5-SELECT OCCURS 3 TIMES
  5787                                            PIC X(10).
  5788         16  CF-REINS-CNTL-OPT.
  5789             20  CF-REINS-OPT-SEQ           PIC 9.
  5790                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5791                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5792             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5793                 24  CF-REINS-PRIME         PIC XXX.
  5794                 24  CF-REINS-SUB           PIC XXX.
  5795
  5796         16  CF-AGENT-CNTL-OPT.
  5797             20  CF-AGENT-OPT-SEQ           PIC 9.
  5798                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5799                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5800             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5801                                            PIC X(10).
  5802
  5803         16  FILLER                         PIC X(43).
  5804
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 105
* EL131.cbl
  5805         16  CF-LOSS-RATIO-SELECT.
  5806             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5807             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5808         16  CF-ENTRY-DATE-SELECT.
  5809             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5810             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5811         16  CF-EFFECTIVE-DATE-SELECT.
  5812             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5813             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5814
  5815         16  CF-EXCEPTION-LIST-IND          PIC X.
  5816             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5817
  5818         16  FILLER                         PIC X(318).
  5819
  5820****************************************************************
  5821*                  EXCEPTION REPORTING RECORD                  *
  5822****************************************************************
  5823
  5824     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5825         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5826             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5827
  5828         16  CF-COMBINED-LIFE-AH-OPT.
  5829             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5830             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5831             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5832             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5833
  5834         16  CF-LIFE-OPT.
  5835             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5836             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5837             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5838             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5839             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5840             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5841             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5842             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5843             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5844             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5845
  5846         16  CF-AH-OPT.
  5847             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5848             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5849             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5850             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5851             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5852             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5853             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5854             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5855             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5856             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5857
  5858         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5859             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5860             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5861             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5862
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 106
* EL131.cbl
  5863         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5864
  5865         16  FILLER                         PIC X(673).
  5866
  5867
  5868****************************************************************
  5869*             MORTGAGE SYSTEM PLAN RECORD                      *
  5870****************************************************************
  5871
  5872     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5873         16  CF-PLAN-TYPE                   PIC X.
  5874             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5875             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5876             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5877         16  CF-PLAN-ABBREV                 PIC XXX.
  5878         16  CF-PLAN-DESCRIPT               PIC X(10).
  5879         16  CF-PLAN-NOTES                  PIC X(20).
  5880         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5881         16  CF-PLAN-UNDERWRITING.
  5882             20  CF-PLAN-TERM-DATA.
  5883                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5884                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5885             20  CF-PLAN-AGE-DATA.
  5886                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5887                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5888                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5889             20  CF-PLAN-BENEFIT-DATA.
  5890                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5891                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5892                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5893                                            PIC S9(7)V99  COMP-3.
  5894         16  CF-PLAN-POLICY-FORMS.
  5895             20  CF-POLICY-FORM             PIC X(12).
  5896             20  CF-MASTER-APPLICATION      PIC X(12).
  5897             20  CF-MASTER-POLICY           PIC X(12).
  5898         16  CF-PLAN-RATING.
  5899             20  CF-RATE-CODE               PIC X(5).
  5900             20  CF-SEX-RATING              PIC X.
  5901                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5902                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5903             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5904             20  CF-SUB-STD-TYPE            PIC X.
  5905                 88  CF-PCT-OF-PREM            VALUE '1'.
  5906                 88  CF-PCT-OF-BENE            VALUE '2'.
  5907         16  CF-PLAN-PREM-TOLERANCES.
  5908             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5909             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5910         16  CF-PLAN-PYMT-TOLERANCES.
  5911             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5912             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5913         16  CF-PLAN-MISC-DATA.
  5914             20  FILLER                     PIC X.
  5915             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5916             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5917         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5918         16  CF-PLAN-IND-GRP                PIC X.
  5919             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5920                                                     '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 107
* EL131.cbl
  5921             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5922                                                     '2'.
  5923         16  CF-MIB-SEARCH-SW               PIC X.
  5924             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5925             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5926             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5927             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5928         16  CF-ALPHA-SEARCH-SW             PIC X.
  5929             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5930             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5931             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5932             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5933             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5934             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5935             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5936             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5937             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5938             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5939                                                     'A' 'B' 'C'
  5940                                                     'X' 'Y' 'Z'.
  5941         16  CF-EFF-DT-RULE-SW              PIC X.
  5942             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5943             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5944             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5945             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5946             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5947         16  FILLER                         PIC X(4).
  5948         16  CF-HEALTH-QUESTIONS            PIC X.
  5949             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5950         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5951         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5952         16  CF-PLAN-SNGL-JNT               PIC X.
  5953             88  CF-COMBINED-PLAN              VALUE 'C'.
  5954             88  CF-JNT-PLAN                   VALUE 'J'.
  5955             88  CF-SNGL-PLAN                  VALUE 'S'.
  5956         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5957         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5958         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5959         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5960         16  CF-RERATE-CNTL                 PIC  X.
  5961             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5962             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5963             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5964             88  CF-AUTO-RECALC                 VALUE '4'.
  5965         16  CF-BENEFIT-TYPE                PIC  X.
  5966             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5967             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5968         16  CF-POLICY-FEE                  PIC S999V99
  5969                                                    COMP-3.
  5970         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5971         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5972         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5973         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5974         16  FILLER                         PIC  X(32).
  5975         16  CF-TERMINATION-FORM            PIC  X(04).
  5976         16  FILLER                         PIC  X(08).
  5977         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5978                                                       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 108
* EL131.cbl
  5979         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5980         16  CF-ISSUE-LETTER                PIC  X(4).
  5981         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5982         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5983             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5984             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5985         16  CF-MP-REFUND-CALC              PIC X.
  5986             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5987             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5988             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5989             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5990             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5991             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5992             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5993             88  CF-MP-REFD-MEAN                VALUE '8'.
  5994         16  CF-ALT-RATE-CODE               PIC  X(5).
  5995
  5996
  5997         16  FILLER                         PIC X(498).
  5998****************************************************************
  5999*             MORTGAGE COMPANY MASTER RECORD                   *
  6000****************************************************************
  6001
  6002     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6003         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6004         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6005             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6006             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6007             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6008             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6009             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6010
  6011         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6012         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6013         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6014         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6015         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6016
  6017         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6018             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6019         16  CF-MP-RECON-USE-IND            PIC X(1).
  6020             88  CF-MP-USE-RECON             VALUE 'Y'.
  6021         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6022             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6023         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6024             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6025             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6026         16  FILLER                         PIC X(1).
  6027         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6028             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6029         16  CF-MORTG-MIB-VERSION           PIC X.
  6030             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6031             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6032             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6033         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6034             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6035                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6036             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 109
* EL131.cbl
  6037                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6038             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6039                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6040             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6041                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6042             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6043                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6044             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6045                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6046         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6047         16  FILLER                         PIC X(7).
  6048         16  CF-MORTG-DESTINATION-SYMBOL.
  6049             20  CF-MORTG-MIB-COMM          PIC X(5).
  6050             20  CF-MORTG-MIB-TERM          PIC X(5).
  6051         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6052             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6053         16  FILLER                         PIC X(03).
  6054         16  CF-MP-CHECK-NO-CONTROL.
  6055             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6056                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6057                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6058                                                ' ' LOW-VALUES.
  6059                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6060                                               VALUE '3'.
  6061         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6062         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6063         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6064             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6065                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6066             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6067                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6068             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6069                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6070             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6071                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6072             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6073                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6074             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6075                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6076         16  CF-MORTG-BILLING-AREA.
  6077             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6078                                            PIC X.
  6079         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6080         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6081         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6082         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6083             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6084             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6085         16  FILLER                         PIC X.
  6086         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6087             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6088             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6089         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6090         16  FILLER                         PIC X(8).
  6091         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6092         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6093         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6094         16  CF-ACH-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 110
* EL131.cbl
  6095             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6096                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6097                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6098                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6099             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6100         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6101             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6102         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6103             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6104             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6105         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6106         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6107         16  FILLER                         PIC X(536).
  6108
  6109****************************************************************
  6110*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6111****************************************************************
  6112
  6113     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6114         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6115             20  CF-FEMALE-HEIGHT.
  6116                 24  CF-FEMALE-FT           PIC 99.
  6117                 24  CF-FEMALE-IN           PIC 99.
  6118             20  CF-FEMALE-MIN-WT           PIC 999.
  6119             20  CF-FEMALE-MAX-WT           PIC 999.
  6120         16  FILLER                         PIC X(428).
  6121
  6122     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6123         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6124             20  CF-MALE-HEIGHT.
  6125                 24  CF-MALE-FT             PIC 99.
  6126                 24  CF-MALE-IN             PIC 99.
  6127             20  CF-MALE-MIN-WT             PIC 999.
  6128             20  CF-MALE-MAX-WT             PIC 999.
  6129         16  FILLER                         PIC X(428).
  6130******************************************************************
  6131*             AUTOMATIC ACTIVITY RECORD                          *
  6132******************************************************************
  6133     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6134         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6135             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6136             20  CF-SYS-LETTER-ID           PIC X(04).
  6137             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6138             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6139             20  CF-SYS-RESET-SW            PIC X(01).
  6140             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6141             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6142
  6143         16  FILLER                         PIC X(50).
  6144
  6145         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6146             20  CF-USER-ACTIVE-SW          PIC X(01).
  6147             20  CF-USER-LETTER-ID          PIC X(04).
  6148             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6149             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6150             20  CF-USER-RESET-SW           PIC X(01).
  6151             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6152             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 111
* EL131.cbl
  6153             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6154
  6155         16  FILLER                         PIC X(246).
  6156
  6157*                                COPY ELCACTQ.
  6158******************************************************************
  6159*                                                                *
  6160*                            ELCACTQ.                            *
  6161*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6162*                            VMOD=2.004                          *
  6163*                                                                *
  6164*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6165*                                                                *
  6166*   FILE TYPE = VSAM,KSDS                                        *
  6167*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6168*                                                                *
  6169*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6170*       ALTERNATE INDEX = NONE                                   *
  6171*                                                                *
  6172*   LOG = YES                                                    *
  6173*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6174*                                                                *
  6175*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6176******************************************************************
  6177
  6178 01  ACTIVITY-QUE.
  6179     12  AQ-RECORD-ID                PIC XX.
  6180         88  VALID-AQ-ID                VALUE 'AQ'.
  6181
  6182     12  AQ-CONTROL-PRIMARY.
  6183         16  AQ-COMPANY-CD           PIC X.
  6184         16  AQ-CARRIER              PIC X.
  6185         16  AQ-CLAIM-NO             PIC X(7).
  6186         16  AQ-CERT-NO.
  6187             20  AQ-CERT-PRIME       PIC X(10).
  6188             20  AQ-CERT-SFX         PIC X.
  6189
  6190     12  AQ-PENDING-ACTIVITY-FLAGS.
  6191         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6192         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6193             88  PENDING-PAYMENTS       VALUE '1'.
  6194         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6195             88  PENDING-FULL-PRINT     VALUE '1'.
  6196             88  PENDING-PART-PRINT     VALUE '2'.
  6197         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6198             88  PENDING-LETTERS        VALUE '1'.
  6199         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6200             88  PENDING-RESTORE        VALUE 'C'.
  6201             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6202
  6203     12  FILLER                      PIC X(20).
  6204
  6205     12  AQ-RESEND-DATE              PIC XX.
  6206     12  AQ-FOLLOWUP-DATE            PIC XX.
  6207     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6208     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6209     12  AQ-AUTO-LETTER              PIC X(4).
  6210     12  FILLER                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 112
* EL131.cbl
  6211     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6212*****************************************************************
  6213
  6214*                                COPY ERCACCT.
  6215******************************************************************
  6216*                                                                *
  6217*                                                                *
  6218*                            ERCACCT                             *
  6219*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6220*                            VMOD=2.031                          *
  6221*                                                                *
  6222*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6223*                                                                *
  6224*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6225*   VSAM ACCOUNT MASTER FILES.                                   *
  6226*                                                                *
  6227*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6228*                                                                *
  6229*   FILE TYPE = VSAM,KSDS                                        *
  6230*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6231*                                                                *
  6232*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6233*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6234*                                                                *
  6235*   LOG = NO                                                     *
  6236*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6237*                                                                *
  6238*                                                                *
  6239******************************************************************
  6240*                   C H A N G E   L O G
  6241*
  6242* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6243*-----------------------------------------------------------------
  6244*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6245* EFFECTIVE    NUMBER
  6246*-----------------------------------------------------------------
  6247* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6248* 092705    2005050300006  PEMA  ADD SPP LEASES
  6249* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6250* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6251* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6252* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6253* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6254******************************************************************
  6255
  6256 01  ACCOUNT-MASTER.
  6257     12  AM-RECORD-ID                      PIC XX.
  6258         88  VALID-AM-ID                      VALUE 'AM'.
  6259
  6260     12  AM-CONTROL-PRIMARY.
  6261         16  AM-COMPANY-CD                 PIC X.
  6262         16  AM-MSTR-CNTRL.
  6263             20  AM-CONTROL-A.
  6264                 24  AM-CARRIER            PIC X.
  6265                 24  AM-GROUPING.
  6266                     28 AM-GROUPING-PREFIX PIC XXX.
  6267                     28 AM-GROUPING-PRIME  PIC XXX.
  6268                 24  AM-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 113
* EL131.cbl
  6269                 24  AM-ACCOUNT.
  6270                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6271                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6272             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6273                                           PIC X(19).
  6274             20  AM-CNTRL-B.
  6275                 24  AM-EXPIRATION-DT      PIC XX.
  6276                 24  FILLER                PIC X(4).
  6277             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6278                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6279
  6280     12  AM-CONTROL-BY-VAR-GRP.
  6281         16  AM-COMPANY-CD-A1              PIC X.
  6282         16  AM-VG-CARRIER                 PIC X.
  6283         16  AM-VG-GROUPING                PIC X(6).
  6284         16  AM-VG-STATE                   PIC XX.
  6285         16  AM-VG-ACCOUNT                 PIC X(10).
  6286         16  AM-VG-DATE.
  6287             20  AM-VG-EXPIRATION-DT       PIC XX.
  6288             20  FILLER                    PIC X(4).
  6289         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6290                                           PIC 9(11)      COMP-3.
  6291     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6292         16  FILLER                        PIC X(10).
  6293         16  AM-VG-KEY3.
  6294             20  AM-VG3-ACCOUNT            PIC X(10).
  6295             20  AM-VG3-EXP-DT             PIC XX.
  6296         16  FILLER                        PIC X(4).
  6297     12  AM-MAINT-INFORMATION.
  6298         16  AM-LAST-MAINT-DT              PIC XX.
  6299         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6300         16  AM-LAST-MAINT-USER            PIC X(4).
  6301         16  FILLER                        PIC XX.
  6302
  6303     12  AM-EFFECTIVE-DT                   PIC XX.
  6304     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6305
  6306     12  AM-PREV-DATES  COMP-3.
  6307         16  AM-PREV-EXP-DT                PIC 9(11).
  6308         16  AM-PREV-EFF-DT                PIC 9(11).
  6309
  6310     12  AM-REPORT-CODE-1                  PIC X(10).
  6311     12  AM-REPORT-CODE-2                  PIC X(10).
  6312
  6313     12  AM-CITY-CODE                      PIC X(4).
  6314     12  AM-COUNTY-PARISH                  PIC X(6).
  6315
  6316     12  AM-NAME                           PIC X(30).
  6317     12  AM-PERSON                         PIC X(30).
  6318     12  AM-ADDRS                          PIC X(30).
  6319     12  AM-CITY.
  6320         16  AM-ADDR-CITY                  PIC X(28).
  6321         16  AM-ADDR-STATE                 PIC XX.
  6322     12  AM-ZIP.
  6323         16  AM-ZIP-PRIME.
  6324             20  AM-ZIP-PRI-1ST            PIC X.
  6325                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6326             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 114
* EL131.cbl
  6327         16  AM-ZIP-PLUS4                  PIC X(4).
  6328     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6329         16  AM-CAN-POSTAL-1               PIC XXX.
  6330         16  AM-CAN-POSTAL-2               PIC XXX.
  6331         16  FILLER                        PIC XXX.
  6332     12  AM-TEL-NO.
  6333         16  AM-AREA-CODE                  PIC 999.
  6334         16  AM-TEL-PRE                    PIC 999.
  6335         16  AM-TEL-NBR                    PIC 9(4).
  6336     12  AM-TEL-LOC                        PIC X.
  6337         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6338         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6339
  6340     12  AM-COMM-STRUCTURE.
  6341         16  AM-DEFN-1.
  6342             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6343                 24  AM-AGT.
  6344                     28  AM-AGT-PREFIX     PIC X(4).
  6345                     28  AM-AGT-PRIME      PIC X(6).
  6346                 24  AM-COM-TYP            PIC X.
  6347                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6348                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6349                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6350                 24  AM-RECALC-LV-INDIC    PIC X.
  6351                 24  AM-RETRO-LV-INDIC     PIC X.
  6352                 24  AM-GL-CODES           PIC X.
  6353                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6354                 24  FILLER                PIC X(01).
  6355         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6356             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6357                 24  FILLER                PIC X(11).
  6358                 24  AM-L-COMA             PIC XXX.
  6359                 24  AM-J-COMA             PIC XXX.
  6360                 24  AM-A-COMA             PIC XXX.
  6361                 24  FILLER                PIC X(6).
  6362
  6363     12  AM-COMM-CHANGE-STATUS             PIC X.
  6364         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6365
  6366     12  AM-CSR-CODE                       PIC X(4).
  6367
  6368     12  AM-BILLING-STATUS                 PIC X.
  6369         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6370         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6371     12  AM-AUTO-REFUND-SW                 PIC X.
  6372         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6373         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6374     12  AM-GPCD                           PIC 99.
  6375     12  AM-IG                             PIC X.
  6376         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6377         88  AM-HAS-GROUP                     VALUE '2'.
  6378     12  AM-STATUS                         PIC X.
  6379         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6380         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6381         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6382         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6383         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6384         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 115
* EL131.cbl
  6385     12  AM-REMIT-TO                       PIC 99.
  6386     12  AM-ID-NO                          PIC X(11).
  6387
  6388     12  AM-CAL-TABLE                      PIC XX.
  6389     12  AM-LF-DEVIATION                   PIC XXX.
  6390     12  AM-AH-DEVIATION                   PIC XXX.
  6391     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6392     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6393     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6394     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6395     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6396     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6397
  6398     12  AM-USER-FIELDS.
  6399         16  AM-FLD-1                      PIC XX.
  6400         16  AM-FLD-2                      PIC XX.
  6401         16  AM-FLD-3                      PIC XX.
  6402         16  AM-FLD-4                      PIC XX.
  6403         16  AM-FLD-5                      PIC XX.
  6404
  6405     12  AM-1ST-PROD-DATE.
  6406         16  AM-1ST-PROD-YR                PIC XX.
  6407         16  AM-1ST-PROD-MO                PIC XX.
  6408         16  AM-1ST-PROD-DA                PIC XX.
  6409     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6410     12  AM-CERTS-PURGED-DATE.
  6411         16  AM-PUR-YR                     PIC XX.
  6412         16  AM-PUR-MO                     PIC XX.
  6413         16  AM-PUR-DA                     PIC XX.
  6414     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6415     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6416     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6417     12  AM-INACTIVE-DATE.
  6418         16  AM-INA-MO                     PIC 99.
  6419         16  AM-INA-DA                     PIC 99.
  6420         16  AM-INA-YR                     PIC 99.
  6421     12  AM-AR-HI-CERT-DATE                PIC XX.
  6422
  6423     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6424     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6425
  6426     12  AM-OB-PAYMENT-MODE                PIC X.
  6427         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6428         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6429         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6430         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6431
  6432     12  AM-AH-ONLY-INDICATOR              PIC X.
  6433         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6434         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6435
  6436     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6437
  6438     12  AM-OVER-SHORT.
  6439         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6440         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6441
  6442     12  AM-DCC-PRODUCT-CODE               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 116
* EL131.cbl
  6443     12  AM-DCC-CLP-STATE                  PIC XX.
  6444
  6445     12  AM-RECALC-COMM                    PIC X.
  6446     12  AM-RECALC-REIN                    PIC X.
  6447
  6448     12  AM-REI-TABLE                      PIC XXX.
  6449     12  AM-REI-ET-LF                      PIC X.
  6450     12  AM-REI-ET-AH                      PIC X.
  6451     12  AM-REI-PE-LF                      PIC X.
  6452     12  AM-REI-PE-AH                      PIC X.
  6453     12  AM-REI-PRT-ST                     PIC X.
  6454     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6455     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6456     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6457     12  AM-REI-GROUP-A                    PIC X(6).
  6458     12  AM-REI-MORT                       PIC X(4).
  6459     12  AM-REI-PRT-OW                     PIC X.
  6460     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6461     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6462     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6463     12  AM-REI-GROUP-B                    PIC X(6).
  6464
  6465     12  AM-TRUST-TYPE                     PIC X(2).
  6466
  6467     12  AM-EMPLOYER-STMT-USED             PIC X.
  6468     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6469
  6470     12  AM-STD-AH-TYPE                    PIC XX.
  6471     12  AM-EARN-METHODS.
  6472         16  AM-EARN-METHOD-R              PIC X.
  6473             88 AM-REF-RL-R78                 VALUE 'R'.
  6474             88 AM-REF-RL-PR                  VALUE 'P'.
  6475             88 AM-REF-RL-MEAN                VALUE 'M'.
  6476             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6477         16  AM-EARN-METHOD-L              PIC X.
  6478             88 AM-REF-LL-R78                 VALUE 'R'.
  6479             88 AM-REF-LL-PR                  VALUE 'P'.
  6480             88 AM-REF-LL-MEAN                VALUE 'M'.
  6481             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6482         16  AM-EARN-METHOD-A              PIC X.
  6483             88 AM-REF-AH-R78                 VALUE 'R'.
  6484             88 AM-REF-AH-PR                  VALUE 'P'.
  6485             88 AM-REF-AH-MEAN                VALUE 'M'.
  6486             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6487             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6488             88 AM-REF-AH-NET                 VALUE 'N'.
  6489
  6490     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6491     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6492     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6493
  6494     12  AM-RET-Y-N                        PIC X.
  6495     12  AM-RET-P-E                        PIC X.
  6496     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6497     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6498     12  AM-RET-GRP                        PIC X(6).
  6499     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6500         16  AM-POOL-PRIME                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 117
* EL131.cbl
  6501         16  AM-POOL-SUB                   PIC XXX.
  6502     12  AM-RETRO-EARNINGS.
  6503         16  AM-RET-EARN-R                 PIC X.
  6504         16  AM-RET-EARN-L                 PIC X.
  6505         16  AM-RET-EARN-A                 PIC X.
  6506     12  AM-RET-ST-TAX-USE                 PIC X.
  6507         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6508         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6509     12  AM-RETRO-BEG-EARNINGS.
  6510         16  AM-RET-BEG-EARN-R             PIC X.
  6511         16  AM-RET-BEG-EARN-L             PIC X.
  6512         16  AM-RET-BEG-EARN-A             PIC X.
  6513     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6514     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6515
  6516     12  AM-USER-SELECT-OPTIONS.
  6517         16  AM-USER-SELECT-1              PIC X(10).
  6518         16  AM-USER-SELECT-2              PIC X(10).
  6519         16  AM-USER-SELECT-3              PIC X(10).
  6520         16  AM-USER-SELECT-4              PIC X(10).
  6521         16  AM-USER-SELECT-5              PIC X(10).
  6522
  6523     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6524
  6525     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6526
  6527     12  AM-RPT045A-SWITCH                 PIC X.
  6528         88  RPT045A-OFF                   VALUE 'N'.
  6529
  6530     12  AM-INSURANCE-LIMITS.
  6531         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6532         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6533
  6534     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6535         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6536
  6537     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6538         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6539         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6540
  6541     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6542
  6543     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6544     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6545     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6546     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6547     12  AM-DCC-UEF-STATE                  PIC XX.
  6548     12  FILLER                            PIC XXX.
  6549     12  AM-REPORT-CODE-3                  PIC X(10).
  6550*    12  FILLER                            PIC X(22).
  6551
  6552     12  AM-RESERVE-DATE.
  6553         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6554         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6555         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6556
  6557     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6558     12  AM-NOTIFICATION-TYPES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 118
* EL131.cbl
  6559         16  AM-NOTIF-OF-LETTERS           PIC X.
  6560         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6561         16  AM-NOTIF-OF-REPORTS           PIC X.
  6562         16  AM-NOTIF-OF-STATUS            PIC X.
  6563
  6564     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6565         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6566         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6567         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6568         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6569
  6570     12  AM-BENEFIT-CONTROLS.
  6571         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6572             20  AM-BENEFIT-CODE           PIC XX.
  6573             20  AM-BENEFIT-TYPE           PIC X.
  6574             20  AM-BENEFIT-REVISION       PIC XXX.
  6575             20  AM-BENEFIT-REM-TERM       PIC X.
  6576             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6577             20  FILLER                    PIC XX.
  6578         16  FILLER                        PIC X(80).
  6579
  6580     12  AM-TRANSFER-DATA.
  6581         16  AM-TRANSFERRED-FROM.
  6582             20  AM-TRNFROM-CARRIER        PIC X.
  6583             20  AM-TRNFROM-GROUPING.
  6584                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6585                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6586             20  AM-TRNFROM-STATE          PIC XX.
  6587             20  AM-TRNFROM-ACCOUNT.
  6588                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6589                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6590             20  AM-TRNFROM-DTE            PIC XX.
  6591         16  AM-TRANSFERRED-TO.
  6592             20  AM-TRNTO-CARRIER          PIC X.
  6593             20  AM-TRNTO-GROUPING.
  6594                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6595                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6596             20  AM-TRNTO-STATE            PIC XX.
  6597             20  AM-TRNTO-ACCOUNT.
  6598                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6599                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6600             20  AM-TRNTO-DTE              PIC XX.
  6601         16  FILLER                        PIC X(10).
  6602
  6603     12  AM-SAVED-REMIT-TO                 PIC 99.
  6604
  6605     12  AM-COMM-STRUCTURE-SAVED.
  6606         16  AM-DEFN-1-SAVED.
  6607             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6608                 24  AM-AGT-SV             PIC X(10).
  6609                 24  AM-COM-TYP-SV         PIC X.
  6610                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6611                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6612                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6613                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6614                 24  FILLER                PIC X.
  6615                 24  AM-GL-CODES-SV        PIC X.
  6616                 24  AM-COM-CHARGEBACK-SV  PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 119
* EL131.cbl
  6617                 24  FILLER                PIC X.
  6618         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6619             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6620                 24  FILLER                PIC X(11).
  6621                 24  AM-L-COMA-SV          PIC XXX.
  6622                 24  AM-J-COMA-SV          PIC XXX.
  6623                 24  AM-A-COMA-SV          PIC XXX.
  6624                 24  FILLER                PIC X(6).
  6625
  6626     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6627         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6628            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6629            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6630            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6631
  6632     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6633     12  FILLER                            PIC X(120).
  6634
  6635     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6636         16  AM-CONTROL-NAME               PIC X(30).
  6637         16  AM-EXECUTIVE-ONE.
  6638             20  AM-EXEC1-NAME             PIC X(15).
  6639             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6640                                                          COMP-3.
  6641             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6642                                                          COMP-3.
  6643         16  AM-EXECUTIVE-TWO.
  6644             20  AM-EXEC2-NAME             PIC X(15).
  6645             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6646                                                          COMP-3.
  6647             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6648                                                          COMP-3.
  6649
  6650     12  AM-RETRO-ADDITIONAL-DATA.
  6651         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6652         16  AM-RETRO-PREM-P-E             PIC X.
  6653         16  AM-RETRO-CLMS-P-I             PIC X.
  6654         16  AM-RETRO-RET-BRACKET-LF.
  6655             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6656                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6657                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6658             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6659                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6660                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6661             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6662                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6663                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6664         16  AM-RETRO-RET-BRACKET-AH.
  6665             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6666                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6667                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6668                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6669             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6670                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6671                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6672             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6673                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6674                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 120
* EL131.cbl
  6675
  6676     12  AM-COMMENTS.
  6677         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6678
  6679     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6680         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6681         16  AM-FLI-BILLING-CODE           PIC X.
  6682         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6683         16  AM-FLI-UNITED-IDENT           PIC X.
  6684         16  AM-FLI-INTEREST-LOST-DATA.
  6685             20  AM-FLI-BANK-NO            PIC X(5).
  6686             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6687             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6688             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6689         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6690             20  AM-FLI-AGT                PIC X(9).
  6691             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6692             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6693         16  FILLER                        PIC X(102).
  6694
  6695     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6696         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6697             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6698             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6699             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6700             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6701             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6702         16  FILLER                          PIC X(10).
  6703******************************************************************
  6704
  6705*                                COPY ELCCHKQ.
  6706******************************************************************
  6707*                                                                *
  6708*                                                                *
  6709*                            ELCCHKQ.                            *
  6710*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6711*                            VMOD=2.007                          *
  6712*                                                                *
  6713*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6714*                                                                *
  6715*   FILE TYPE = VSAM,KSDS                                        *
  6716*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6717*                                                                *
  6718*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6719*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6720*                                                                *
  6721*   LOG = YES                                                    *
  6722*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6723******************************************************************
  6724 01  CHECK-QUE.
  6725     12  CQ-RECORD-ID                PIC XX.
  6726         88  VALID-CQ-ID         VALUE 'CQ'.
  6727
  6728     12  CQ-CONTROL-PRIMARY.
  6729         16  CQ-COMPANY-CD           PIC X.
  6730         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6731         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6732
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 121
* EL131.cbl
  6733     12  CQ-CONTROL-BY-PAYEE.
  6734         16  CQ-CONTROL-BY-NUMBER.
  6735             20  CQ-COMPANY-CD-A1     PIC X.
  6736             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6737         16  CQ-PAYEE-CARRIER        PIC X.
  6738         16  CQ-PAYEE-GROUPING       PIC X(6).
  6739         16  CQ-PAYEE-STATE          PIC XX.
  6740         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6741         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6742
  6743     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6744         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6745         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6746         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6747         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6748         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6749         16  FILLER                  PIC X(3).
  6750
  6751     12  CQ-ENTRY-TYPE               PIC X.
  6752             88  CHECK-ON-QUE           VALUE 'Q'.
  6753             88  ALIGNMENT-CHECK        VALUE 'A'.
  6754             88  SPOILED-CHECK          VALUE 'S'.
  6755             88  PAYMENT-ABORTED        VALUE 'X'.
  6756
  6757     12  CQ-CLAIM-MAST-CNTL.
  6758         16  CQ-CARRIER              PIC X.
  6759         16  CQ-CLAIM-NO             PIC X(7).
  6760         16  CQ-CERT-NO.
  6761             20  CQ-CERT-PRIME       PIC X(10).
  6762             20  CQ-CERT-SFX         PIC X.
  6763         16  CQ-CLAIM-TYPE           PIC X.
  6764             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6765             88  CQ-AH-CLAIM            VALUE 'A'.
  6766         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6767             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6768             88  CQ-O-B-COVERAGE        VALUE '2'.
  6769             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6770
  6771     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6772     12  CQ-CHECK-NUMBER             PIC X(7).
  6773     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6774     12  CQ-PAYMENT-TYPE             PIC X.
  6775             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6776             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6777             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6778             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6779             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6780             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6781             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6782             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6783     12  CQ-VOID-INDICATOR           PIC X.
  6784             88  CHECK-IS-STOPPED          VALUE 'S'.
  6785             88  CHECK-IS-VOID             VALUE 'V'.
  6786     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6787     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6788     12  CQ-CHECK-BY-USER            PIC X(4).
  6789     12  CQ-PRE-NUMBERING-SW         PIC X.
  6790       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 122
* EL131.cbl
  6791       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6792
  6793     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6794     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6795     12  CQ-LEDGER-FLAG              PIC X(01).
  6796     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6797     12  CQ-LAST-UPDATED-DT          PIC XX.
  6798     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6799     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6800
  6801     12  FILLER                      PIC X(04).
  6802
  6803******************************************************************
  6804
  6805*                                COPY ELCARCH.
  6806******************************************************************
  6807*                                                                *
  6808*                            ELCARCH.                            *
  6809*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6810*                            VMOD=2.007                          *
  6811*                                                                *
  6812*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6813*                                                                *
  6814*   FILE TYPE = VSAM,KSDS                                        *
  6815*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6816*                                                                *
  6817*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6818*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6819*                                                                *
  6820*   LOG = NO                                                     *
  6821*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6822*                                                                *
  6823*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6824******************************************************************
  6825 01  LETTER-ARCHIVE.
  6826     12  LA-RECORD-ID                PIC XX.
  6827         88  VALID-LA-ID                VALUE 'LA'.
  6828
  6829     12  LA-CONTROL-PRIMARY.
  6830         16  LA-COMPANY-CD           PIC X.
  6831         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6832         16  LA-RECORD-TYPE          PIC X.
  6833             88  LA-HEADER-DATA         VALUE '1'.
  6834             88  LA-ADDRESS-DATA        VALUE '2'.
  6835             88  LA-TEXT-DATA           VALUE '3'.
  6836             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6837         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6838
  6839     12  LA-CONTROL-BY-TYPE.
  6840         16  LA-COMPANY-CD-A1        PIC X.
  6841         16  LA-RECORD-TYPE-A1       PIC X.
  6842         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6843         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6844
  6845     12  LA-TEXT-RECORD.
  6846         16  LA-SKIP-CONTROL         PIC XX.
  6847             88  NO-LINES-SKIPPED       VALUE SPACES.
  6848             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 123
* EL131.cbl
  6849         16  LA-TEXT-LINE            PIC X(70).
  6850
  6851     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6852         16  FILLER                  PIC XX.
  6853         16  LA-ADDRESS-LINE         PIC X(30).
  6854         16  FILLER                  PIC X(40).
  6855
  6856     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6857         16  FILLER                  PIC XX.
  6858         16  LA-CARRIER              PIC X.
  6859         16  LA-CLAIM-NO             PIC X(7).
  6860         16  LA-CERT-NO.
  6861             20  LA-CERT-PRIME       PIC X(10).
  6862             20  LA-CERT-SFX         PIC X.
  6863         16  LA-NO-OF-COPIES         PIC S9.
  6864         16  LA-RESEND-DATE          PIC XX.
  6865         16  LA-PROCESSOR-CD         PIC X(4).
  6866         16  LA-CREATION-DT          PIC XX.
  6867         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6868         16  LA-RESEND-PRINT-DATE    PIC XX.
  6869         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6870         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6871*
  6872* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6873*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6874*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6875*   I        20  LA-DMD-RES-ST           PIC XX.
  6876*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6877*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6878*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6879*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6880*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6881*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6882*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6883*   I        20  LA-DMD-UND-CODE         PIC XX.
  6884*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6885*   V    16  FILLER                  PIC X(15).
  6886* -----
  6887*
  6888* REINSERTED  CSO  MODS
  6889*
  6890         16  FILLER.
  6891             20  FILLER                  PIC X(29).
  6892             20  LA-CSO-LETTER-STATUS    PIC X.
  6893                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6894                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6895                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6896             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6897             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6898*
  6899
  6900     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6901         16  FILLER                  PIC XX.
  6902         16  LA4-CARRIER             PIC X.
  6903         16  LA4-CLAIM-NO            PIC X(7).
  6904         16  LA4-CERT-NO.
  6905             20  LA4-CERT-PRIME      PIC X(10).
  6906             20  LA4-CERT-SFX        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 124
* EL131.cbl
  6907         16  LA4-NO-OF-COPIES        PIC S9.
  6908         16  LA4-RESEND-DATE         PIC XX.
  6909         16  LA4-PROCESSOR-CD        PIC X(4).
  6910         16  LA4-CREATION-DT         PIC XX.
  6911         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6912         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6913         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6914         16  LA4-FORM-TYPE           PIC X.
  6915             88  LA4-INITIAL-FORM    VALUE '1'.
  6916             88  LA4-PROGRESS-FORM   VALUE '2'.
  6917         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6918         16  LA4-STATE               PIC X(02).
  6919         16  FILLER                  PIC X(31).
  6920******************************************************************
  6921
  6922*                                COPY ELCBENE.
  6923******************************************************************
  6924*                                                                *
  6925*                            ELCBENE.                            *
  6926*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6927*                            VMOD=2.006                          *
  6928*                                                                *
  6929*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6930*                                                                *
  6931*   FILE TYPE = VSAM,KSDS                                        *
  6932*   RECORD SIZE = 500   RECFORM = FIX                            *
  6933*                                                                *
  6934*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6935*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6936*                                                                *
  6937*   LOG = YES                                                    *
  6938*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6939*                                                                *
  6940*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6941******************************************************************
  6942
  6943 01  BENEFICIARY-MASTER.
  6944     12  BE-RECORD-ID                PIC XX.
  6945         88  VALID-BE-ID                VALUE 'BE'.
  6946
  6947     12  BE-CONTROL-PRIMARY.
  6948         16  BE-COMPANY-CD           PIC X.
  6949         16  BE-RECORD-TYPE          PIC X.
  6950             88  BENEFICIARY-RECORD  VALUE 'B'.
  6951             88  ADJUSTOR-RECORD     VALUE 'A'.
  6952         16  BE-BENEFICIARY          PIC X(10).
  6953     12  BE-CONTROL-BY-NAME.
  6954         16  BE-COMPANY-CD-A1        PIC X.
  6955         16  BE-RECORD-TYPE-A1       PIC X.
  6956         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6957         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6958
  6959     12  BE-LAST-MAINT-DT            PIC XX.
  6960     12  BE-LAST-MAINT-BY            PIC X(4).
  6961     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6962
  6963     12  BE-ADDRESS-DATA.
  6964         16  BE-MAIL-TO-NAME         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 125
* EL131.cbl
  6965         16  BE-ADDRESS-LINE-1       PIC X(30).
  6966         16  BE-ADDRESS-LINE-2       PIC X(30).
  6967         16  BE-ADDRESS-LINE-3       PIC X(30).
  6968         16  BE-CITY-STATE.
  6969             20  BE-CITY             PIC X(28).
  6970             20  BE-STATE            PIC XX.
  6971         16  BE-ZIP-CODE.
  6972             20  BE-ZIP-PRIME.
  6973                 24  BE-ZIP-1ST      PIC X.
  6974                     88  BE-CANADIAN-POST-CODE
  6975                                         VALUE 'A' THRU 'Z'.
  6976                 24  FILLER          PIC X(4).
  6977             20  BE-ZIP-PLUS4        PIC X(4).
  6978         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6979             20  BE-CAN-POSTAL-1     PIC XXX.
  6980             20  BE-CAN-POSTAL-2     PIC XXX.
  6981             20  FILLER              PIC XXX.
  6982         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6983         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6984
  6985******************************************************************
  6986*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6987*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6988******************************************************************
  6989     12  BE-CARRIER                  PIC X.
  6990
  6991     12  BE-ADDRESS-DATA2.
  6992         16  BE-MAIL-TO-NAME2        PIC X(30).
  6993         16  BE-ADDRESS-LINE-12      PIC X(30).
  6994         16  BE-ADDRESS-LINE-22      PIC X(30).
  6995         16  BE-ADDRESS-LINE-32      PIC X(30).
  6996         16  BE-CITY-STATE2.
  6997             20  BE-CITY2            PIC X(28).
  6998             20  BE-STATE2           PIC XX.
  6999         16  BE-ZIP-CODE2.
  7000             20  BE-ZIP-PRIME2.
  7001                 24  BE-ZIP-1ST2     PIC X.
  7002                     88  BE-CANADIAN-POST-CODE2
  7003                                         VALUE 'A' THRU 'Z'.
  7004                 24  FILLER          PIC X(4).
  7005             20  BE-ZIP-PLUS42       PIC X(4).
  7006         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7007             20  BE-CAN-POSTAL-12    PIC XXX.
  7008             20  BE-CAN-POSTAL-22    PIC XXX.
  7009             20  FILLER              PIC XXX.
  7010         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7011         16  BE-BILLING-STMT-DATA.
  7012             20  BE-BSR              PIC X.
  7013                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7014                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7015             20  BE-BSR-FROM         PIC X(30).
  7016             20  BE-BSR-DEPT         PIC X(30).
  7017             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7018             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7019             20  BE-OUTPUT-TYPE      PIC X.
  7020                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7021                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7022
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 126
* EL131.cbl
  7023     12  FILLER                      PIC X(28).
  7024******************************************************************
  7025
  7026*                                COPY ELCDAR.
  7027******************************************************************
  7028*                                                                *
  7029*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7030*   FILE TYPE = VSAM,KSDS                                        *
  7031*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7032*   BASE CLUSTER = DLYACTV                                       *
  7033*   LOG = YES                                                    *
  7034*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7035*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7036*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7037*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7038*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7039*               BY PROGRAM "LGINFCE".                            *
  7040*                                                                *
  7041******************************************************************
  7042 01  DAILY-ACTIVITY-RECORD.
  7043     05  DA-KEY.
  7044         10  DA-COMP-CD          PIC X.
  7045         10  DA-CARRIER          PIC X.
  7046         10  DA-CLAIM-NO         PIC X(7).
  7047         10  DA-CERT-NO.
  7048             15  DA-CERT-PRIME   PIC X(10).
  7049             15  DA-CERT-SFX     PIC X.
  7050     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7051     05  DA-RECORD-TYPE          PIC X.
  7052     05  FILLER                  PIC X(2).
  7053******************************************************************
  7054
  7055*                                COPY ELCALPH.
  7056******************************************************************
  7057*                                                                *
  7058*                            ELCALPH.                            *
  7059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7060*                            VMOD=2.003                          *
  7061*                                                                *
  7062*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7063*                                                                *
  7064*   FILE TYPE = VSAM,KSDS                                        *
  7065*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7066*                                                                *
  7067*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7068*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7069*                                                                *
  7070*   LOG = YES                                                    *
  7071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7072*                                                                *
  7073*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7074******************************************************************
  7075
  7076 01  ALPHA-INDEX.
  7077     12  AI-RECORD-ID                         PIC XX.
  7078         88  VALID-AI-ID                  VALUE 'AI'.
  7079     12  AI-CONTROL-PRIMARY.
  7080         16  AI-COMPANY-CD                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 127
* EL131.cbl
  7081         16  AI-SOURCE                         PIC X.
  7082             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7083             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7084         16  AI-NAME.
  7085             20  AI-LAST-NAME                  PIC X(15).
  7086             20  AI-FIRST-NAME.
  7087                 24  AI-FIRST-INITIAL          PIC X.
  7088                 24  FILLER                    PIC X(11).
  7089             20  AI-MIDDLE-INIT                PIC X.
  7090         16  AI-DATE                           PIC X(8).
  7091         16  AI-TIME                           PIC S9(07) COMP-3.
  7092
  7093     12  AI-CONTROL-BY-ADMIN-KEY.
  7094         16  AI-CM-COMPANY-CD                  PIC X.
  7095         16  AI-CM-SOURCE                      PIC X.
  7096         16  AI-CM-CARRIER                     PIC X.
  7097         16  AI-CM-GROUPING.
  7098             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7099             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7100         16  AI-CM-STATE                       PIC XX.
  7101         16  AI-CM-PRODUCER.
  7102             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7103             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7104         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7105         16  AI-CM-CERTIFICATE-NUMBER.
  7106             20  AI-CM-CERT-PRIME              PIC X(10).
  7107             20  AI-CM-CERT-SFX                PIC X.
  7108         16  AI-CM-DATE                        PIC X(8).
  7109         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7110         16  FILLER                            PIC X(11).
  7111
  7112     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7113         AI-CONTROL-BY-ADMIN-KEY.
  7114         16  AI-CL-COMPANY-CD                  PIC X.
  7115         16  AI-CL-SOURCE                      PIC X.
  7116         16  AI-CL-CARRIER                     PIC X.
  7117         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7118         16  AI-CL-CERTIFICATE-NUMBER.
  7119             20  AI-CL-CERT-PRIME              PIC X(10).
  7120             20  AI-CL-CERT-SFX                PIC X.
  7121         16  AI-CL-DATE                        PIC X(8).
  7122         16  AI-CL-INCURRED-DATE               PIC XX.
  7123         16  AI-CL-CLOSE-DATE                  PIC XX.
  7124         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7125         16  AI-CREDIT-CARD-NUMBER.
  7126             20  AI-CCN.
  7127                 24  AI-CCN-PREFIX             PIC X(4).
  7128                 24  AI-CCN-PRIME              PIC X(12).
  7129             20  AI-CCN-FILLER                 PIC X(4).
  7130
  7131     12  AI-MAINT-INFO.
  7132         16  AI-LAST-MAINT-BY                  PIC X(4).
  7133         16  AI-LAST-MAINT-DT                  PIC XX.
  7134         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7135
  7136     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7137
  7138     12  FILLER                                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 128
* EL131.cbl
  7139
  7140
  7141*                                COPY ERCDMDNT.
  7142******************************************************************
  7143*                                                                *
  7144*                            ERCDMDNT                            *
  7145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7146*                            VMOD=2.005                          *
  7147*                                                                *
  7148*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7149*                                                                *
  7150*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7151*                                                                *
  7152*        FILE TYPE= VSAM,KSDS                                    *
  7153*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7154*                                                                *
  7155*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7156*                                                                *
  7157*        LOG = YES                                               *
  7158*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7159*                                                                *
  7160******************************************************************
  7161
  7162 01  CERTIFICATE-NOTE.
  7163     12  CN-RECORD-ID                     PIC  XX.
  7164         88  VALID-CN-ID                      VALUE 'CN'.
  7165
  7166     12  CN-CONTROL-PRIMARY.
  7167         16  CN-COMPANY-CD                PIC X.
  7168         16  CN-CERT-KEY.
  7169             20  CN-CARRIER               PIC X.
  7170             20  CN-GROUPING.
  7171                 24  CN-GROUPING-PREFIX   PIC XXX.
  7172                 24  CN-GROUPING-PRIME    PIC XXX.
  7173             20  CN-STATE                 PIC XX.
  7174             20  CN-ACCOUNT.
  7175                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7176                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7177             20  CN-CERT-EFF-DT           PIC XX.
  7178             20  CN-CERT-NO.
  7179                 24  CN-CERT-PRIME        PIC X(10).
  7180                 24  CN-CERT-SFX          PIC X.
  7181
  7182     12  CN-BILLING-START-LINE-NO         PIC 99.
  7183     12  CN-BILLING-END-LINE-NO           PIC 99.
  7184
  7185     12  CN-LINES.
  7186         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7187
  7188     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7189         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7190         16  CN-CSI-GENERAL-DATA-AREA.
  7191             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7192
  7193         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7194             CN-CSI-GENERAL-DATA-AREA.
  7195             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7196             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 129
* EL131.cbl
  7197             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7198             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7199             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7200             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7201             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7202             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7203             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7204             20  FILLER                       PIC XX.
  7205             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7206             20  FILLER                       PIC X(38).
  7207
  7208         16  CN-CSI-PRODUCT-DATA-AREA.
  7209             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7210
  7211         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7212             CN-CSI-PRODUCT-DATA-AREA.
  7213             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7214             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7215             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7216             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7217             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7218             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7219             20  FILLER                   PIC XX.
  7220             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7221             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7222             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7223             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7224             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7225             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7226             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7227             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7228             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7229             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7230             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7231             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7232             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7233             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7234             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7235             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7236             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7237             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7238             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7239             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7240             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7241             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7242             20  FILLER                   PIC X(25).
  7243
  7244         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7245             CN-CSI-CREDIT-CARD-DATA.
  7246             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7247             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7248             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7249             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7250             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7251             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7252             20  FILLER                   PIC XX.
  7253             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7254             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 130
* EL131.cbl
  7255             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7256             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7257             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7258             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7259             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7260             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7261             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7262             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7263             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7264             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7265             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7266             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7267             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7268             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7269             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7270             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7271             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7272             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7273             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7274             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7275             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7276             20  FILLER                   PIC X(17).
  7277
  7278         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7279             CN-CSI-FAMILY-LEAVE-DATA.
  7280             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7281             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7282             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7283             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7284             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7285             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7286             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7287             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7288             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7289             20  CN-CSI-SL-INT-ON-PROCEEDS
  7290                                          PIC S9(5)V99  COMP-3.
  7291             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7292             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7293             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7294             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7295             20  CN-CSI-SL-POLICY-BENEFITS
  7296                                          PIC S9(5)V99  COMP-3.
  7297             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7298             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7299             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7300             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7301             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7302             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7303             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7304             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7305             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7306             20  CN-CSI-SL-STATE-NOT      PIC X.
  7307             20  FILLER                   PIC XX.
  7308
  7309         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7310             CN-CSI-SENIOR-LIFE-DATA.
  7311             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7312             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 131
* EL131.cbl
  7313             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7314                                          PIC S9(5)V99  COMP-3.
  7315             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7316             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7317             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7318             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7319             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7320             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7321             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7322             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7323             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7324             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7325             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7326             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7327             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7328             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7329             20  CN-CSI-PP-REPAIR         PIC X.
  7330             20  CN-CSI-PP-REPLACE        PIC X.
  7331             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7332             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7333             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7334             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7335             20  FILLER                   PIC X(5).
  7336
  7337         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7338             CN-CSI-PURCH-PROP-DATA.
  7339             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7340             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7341             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7342             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7343             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7344             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7345             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7346             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7347             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7348             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7349             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7350             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7351             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7352             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7353             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7354             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7355             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7356             20  CN-CSI-EW-REPLACE        PIC X.
  7357             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7358             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7359             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7360             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7361             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7362             20  FILLER                   PIC X(4).
  7363
  7364     12  CN-LAST-MAINT-DT                 PIC XX.
  7365     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7366     12  CN-LAST-MAINT-USER               PIC X(4).
  7367     12  FILLER                           PIC X(6).
  7368
  7369******************************************************************
  7370
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 132
* EL131.cbl
  7372 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7373                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7374                          CONTROL-FILE ACTIVITY-QUE
  7375                          ACCOUNT-MASTER CHECK-QUE
  7376                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7377                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7378                          CERTIFICATE-NOTE.
  7379 0000-DFHEXIT SECTION.
  7380     MOVE '9#                    $   ' TO DFHEIV0.
  7381     MOVE 'EL131' TO DFHEIV1.
  7382     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7383
  7384     IF EIBCALEN = ZERO
  7385         GO TO 8800-UNAUTHORIZED-ACCESS.
  7386
  7387     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7388     MOVE '5'                    TO DC-OPTION-CODE.
  7389     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7390     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7391     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7392     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7393
  7394     IF SAVE-DATE-YY GREATER 70
  7395         MOVE 19                 TO SAVE-DATE-CC
  7396      ELSE
  7397         MOVE 20                 TO SAVE-DATE-CC.
  7398
  7399
  7400* EXEC CICS HANDLE CONDITION
  7401*        PGMIDERR (8820-XCTL-ERROR)
  7402*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7403*        ERROR    (9990-ABEND)
  7404*    END-EXEC.
  7405*    MOVE '"$LI.                 ! " #00007395' TO DFHEIV0
  7406     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7408     MOVE X'2220233030303037333935' TO DFHEIV0(25:11)
  7409     CALL 'kxdfhei1' USING DFHEIV0
  7410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7411
  7412
  7413     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7414     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7415     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7416
  7417     INITIALIZE    EDIT-WORK-AREA.
  7418     MOVE '/'                    TO WORK-SLASH.
  7419     MOVE SPACES                 TO ERROR-SWITCHES.
  7420
  7421     MOVE TRAN-ID                TO TRANS-ID.
  7422     MOVE EIBTRMID               TO PI-TERM.
  7423     MOVE MAP-ID                 TO PI-QUAL.
  7424
  7425     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7426
  7427     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7428         MOVE LOW-VALUES         TO EL131AO
  7429         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 133
* EL131.cbl
  7430         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7431         MOVE -1                 TO MAINTL
  7432         GO TO 8110-SEND-DATA.
  7433
  7434     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7435         MOVE LOW-VALUES         TO EL131AO
  7436         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7437         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7438         MOVE 'X'                TO PI-RETURN-CD-1
  7439         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7440         MOVE -1                 TO MAINTL
  7441         IF WS-RETURNED-FROM = XCTL-EL114
  7442             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7443         END-IF
  7444         GO TO 8100-SEND-MAP.
  7445
  7446     IF EIBAID = DFHCLEAR
  7447         GO TO 8200-RETURN-PRIOR.
  7448
  7449     IF PI-PROCESSOR-ID = 'LGXX'
  7450         NEXT SENTENCE
  7451     ELSE
  7452
  7453* EXEC CICS READQ TS
  7454*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7455*            INTO    (SECURITY-CONTROL)
  7456*            LENGTH  (SC-COMM-LENGTH)
  7457*            ITEM    (SC-ITEM)
  7458*        END-EXEC
  7459*    MOVE '*$II   L              ''   #00007440' TO DFHEIV0
  7460     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7461     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7462     MOVE X'2020233030303037343430' TO DFHEIV0(25:11)
  7463     CALL 'kxdfhei1' USING DFHEIV0,
  7464           PI-SECURITY-TEMP-STORE-ID,
  7465           SECURITY-CONTROL,
  7466           SC-COMM-LENGTH,
  7467           SC-ITEM,
  7468           DFHEIV99,
  7469           DFHEIV99
  7470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7471         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7472         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7473         IF NOT DISPLAY-CAP
  7474             MOVE 'READ'               TO  SM-READ
  7475             PERFORM 9995-SECURITY-VIOLATION
  7476             MOVE ER-0070              TO  EMI-ERROR
  7477             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7478             GO TO 8100-SEND-MAP.
  7479
  7480
  7481* EXEC CICS RECEIVE
  7482*        MAP    ('EL131A')
  7483*        MAPSET ('EL131S')
  7484*    END-EXEC.
  7485     MOVE 'EL131A' TO DFHEIV1
  7486     MOVE 'EL131S' TO DFHEIV2
  7487*    MOVE '8"T                   ''   #00007455' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 134
* EL131.cbl
  7488     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7489     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7490     MOVE X'2020233030303037343535' TO DFHEIV0(25:11)
  7491     CALL 'kxdfhei1' USING DFHEIV0,
  7492           DFHEIV1,
  7493           EL131AI,
  7494           DFHEIV99,
  7495           DFHEIV2,
  7496           DFHEIV99,
  7497           DFHEIV99
  7498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7499
  7500
  7501     IF PFKEYL GREATER THAN ZERO
  7502         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7503
  7504     IF SCREEN-ERROR
  7505         MOVE ER-0004 TO EMI-ERROR
  7506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7507         MOVE -1 TO MAINTL
  7508         GO TO 8110-SEND-DATA.
  7509
  7510     IF EIBAID = DFHPF3
  7511         GO TO 8500-TRLR-MNT.
  7512
  7513     IF EIBAID = DFHPF4
  7514         GO TO 8600-ADDR-MNT.
  7515
  7516     IF EIBAID = DFHPF5
  7517         GO TO 8700-CERT-MNT.
  7518
  7519     IF PI-COMPANY-ID = 'DMD'
  7520       IF EIBAID = DFHPF6
  7521         GO TO 8750-DMD-CLM-FIX.
  7522
  7523     IF EIBAID = DFHPF7
  7524         GO TO 4000-FORCE-ERRORS.
  7525
  7526     IF EIBAID = DFHPF12
  7527         GO TO 8300-GET-HELP.
  7528
  7529     IF EIBAID = DFHPF15
  7530         GO TO 8725-BENEFICIARY-MNT
  7531     END-IF.
  7532
  7533     IF EIBAID = DFHPF23
  7534         GO TO 8810-PF23-ENTERED.
  7535
  7536     IF EIBAID = DFHPF24
  7537         GO TO 8400-RETURN-MASTER.
  7538
  7539     IF EIBAID NOT = DFHENTER
  7540         MOVE ER-0029            TO EMI-ERROR
  7541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7542         MOVE -1                 TO MAINTL
  7543         GO TO 8110-SEND-DATA.
  7544
  7545     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 135
* EL131.cbl
  7546         MOVE ER-0311            TO EMI-ERROR
  7547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7548         MOVE -1                 TO MAINTL
  7549         GO TO 8110-SEND-DATA.
  7550
  7551     IF MAINTI = 'A'
  7552         GO TO 0500-ADD-ALPHA-ONLY.
  7553
  7554     IF MAINTI = 'N'
  7555         GO TO 0600-CHANGE-NAME.
  7556
  7557     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7558
  7559     IF SCREEN-ERROR
  7560         GO TO 8110-SEND-DATA.
  7561
  7562     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7563         MOVE ER-0276            TO EMI-ERROR
  7564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7565         MOVE -1                 TO MAINTL
  7566         GO TO 8110-SEND-DATA.
  7567
  7568     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7569
  7570     IF SCREEN-ERROR
  7571         GO TO 8110-SEND-DATA.
  7572
  7573     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7574
  7575     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7576
  7577     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7578         GO TO 8110-SEND-DATA.
  7579
  7580     IF EMI-FATAL-CTR GREATER THAN ZERO
  7581         GO TO 8110-SEND-DATA.
  7582
  7583     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7584
  7585     IF WS-OPEN-CLOSE-SW = 'Y'
  7586         IF PI-LETTER-SW = 'Y'
  7587             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7588             MOVE 'T'            TO  CNTL-REC-TYPE
  7589             MOVE SPACES         TO  CNTL-PROC-ID
  7590             MOVE +0             TO  CNTL-SEQ-NO
  7591
  7592* EXEC CICS READ
  7593*                DATASET   (CNTL-FILE-ID)
  7594*                RIDFLD    (CNTL-KEY)
  7595*                SET       (ADDRESS OF CONTROL-FILE)
  7596*            END-EXEC
  7597*    MOVE '&"S        E          (   #00007550' TO DFHEIV0
  7598     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7600     MOVE X'2020233030303037353530' TO DFHEIV0(25:11)
  7601     CALL 'kxdfhei1' USING DFHEIV0,
  7602           CNTL-FILE-ID,
  7603           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 136
* EL131.cbl
  7604           DFHEIV99,
  7605           CNTL-KEY,
  7606           DFHEIV99,
  7607           DFHEIV99,
  7608           DFHEIV99
  7609     SET ADDRESS OF CONTROL-FILE TO
  7610         DFHEIV20
  7611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7612             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7613
  7614     MOVE ER-0000                TO EMI-ERROR.
  7615     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7616
  7617     MOVE SPACE                  TO MAINTO.
  7618     MOVE -1                     TO MAINTL.
  7619     GO TO 8100-SEND-MAP.
  7620
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 137
* EL131.cbl
  7622 0100-UPDATE-PI.
  7623
  7624     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7625     IF WS-RETURNED-FROM = XCTL-EL114
  7626***sometimes there is crap in positions 7-10 when no code was sele
  7627        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7628          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7629        END-IF
  7630     END-IF.
  7631
  7632     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7633         GO TO 0110-UPDATE-UP.
  7634
  7635     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7636     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7637     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7638     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7639     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7640     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7641     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7642     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7643     GO TO 0120-UPDATE-PI-EXIT.
  7644
  7645 0110-UPDATE-UP.
  7646     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7647     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7648     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7649     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7650     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7651     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7652     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7653     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7654
  7655
  7656* EXEC CICS HANDLE CONDITION
  7657*         QIDERR    (0130-TS-ERROR)
  7658*         ITEMERR   (0130-TS-ERROR)
  7659*    END-EXEC.
  7660*    MOVE '"$N<                  ! # #00007598' TO DFHEIV0
  7661     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7663     MOVE X'2320233030303037353938' TO DFHEIV0(25:11)
  7664     CALL 'kxdfhei1' USING DFHEIV0
  7665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7666
  7667
  7668     IF WS-RETURNED-FROM = XCTL-EL114
  7669
  7670* EXEC CICS READQ TS
  7671*            QUEUE    (PI-KEY)
  7672*            INTO     (EL131AI)
  7673*            LENGTH   (MAP-LENGTH)
  7674*       END-EXEC
  7675*    MOVE '*$I    L              ''   #00007604' TO DFHEIV0
  7676     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7677     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7678     MOVE X'2020233030303037363034' TO DFHEIV0(25:11)
  7679     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 138
* EL131.cbl
  7680           PI-KEY,
  7681           EL131AI,
  7682           MAP-LENGTH,
  7683           DFHEIV99,
  7684           DFHEIV99,
  7685           DFHEIV99
  7686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7687
  7688        IF WS-SAVE-BENEFICIARY > SPACES
  7689            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7690            MOVE +10            TO BENEL
  7691            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7692        END-IF
  7693        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7694     END-IF.
  7695
  7696
  7697* EXEC CICS READQ TS
  7698*         QUEUE    (PI-KEY)
  7699*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7700*         LENGTH   (PI-COMM-LENGTH)
  7701*    END-EXEC.
  7702*    MOVE '*$I    L              ''   #00007618' TO DFHEIV0
  7703     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7704     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7705     MOVE X'2020233030303037363138' TO DFHEIV0(25:11)
  7706     CALL 'kxdfhei1' USING DFHEIV0,
  7707           PI-KEY,
  7708           PROGRAM-INTERFACE-BLOCK,
  7709           PI-COMM-LENGTH,
  7710           DFHEIV99,
  7711           DFHEIV99,
  7712           DFHEIV99
  7713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7714
  7715
  7716
  7717* EXEC CICS DELETEQ TS
  7718*         QUEUE    (PI-KEY)
  7719*    END-EXEC.
  7720*    MOVE '*&                    #   #00007624' TO DFHEIV0
  7721     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7722     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7723     MOVE X'2020233030303037363234' TO DFHEIV0(25:11)
  7724     CALL 'kxdfhei1' USING DFHEIV0,
  7725           PI-KEY,
  7726           DFHEIV99
  7727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7728
  7729
  7730 0120-UPDATE-PI-EXIT.
  7731     EXIT.
  7732
  7733 0130-TS-ERROR.
  7734     MOVE LOW-VALUES             TO EL131AO.
  7735     MOVE ER-0192                TO EMI-ERROR.
  7736
  7737     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 139
* EL131.cbl
  7738
  7739     GO TO 8100-SEND-MAP.
  7740
  7741 0200-TRANS-PF.
  7742     IF EIBAID NOT = DFHENTER
  7743         MOVE 'X'                TO ERROR-SWITCH
  7744         GO TO 0210-EXIT.
  7745
  7746     IF PFKEYI NOT NUMERIC
  7747         MOVE 'X'                TO ERROR-SWITCH
  7748         GO TO 0210-EXIT.
  7749
  7750     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7751
  7752     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7753         MOVE 'X' TO ERROR-SWITCH
  7754         GO TO 0210-EXIT.
  7755
  7756     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7757
  7758 0210-EXIT.
  7759     EXIT.
  7760
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 140
* EL131.cbl
  7762 0500-ADD-ALPHA-ONLY.
  7763******************************************************************
  7764*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7765*    RECORD.                                                     *
  7766******************************************************************
  7767
  7768     IF MLNAMEL = +0 AND
  7769        MFNAMEL = +0 AND
  7770        MMINITL = +0
  7771         MOVE ER-0797                TO  EMI-ERROR
  7772         MOVE -1                     TO  MAINTL
  7773         MOVE AL-UABON               TO  MAINTA
  7774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7775         GO TO 8110-SEND-DATA.
  7776
  7777     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7778     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7779     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7780     MOVE PI-CERT-NO                 TO  CERT-NO.
  7781
  7782
  7783* EXEC CICS READ
  7784*        DATASET   (CLMS-FILE-ID)
  7785*        RIDFLD    (MSTR-KEY)
  7786*        SET       (ADDRESS OF CLAIM-MASTER)
  7787*    END-EXEC.
  7788*    MOVE '&"S        E          (   #00007680' TO DFHEIV0
  7789     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7791     MOVE X'2020233030303037363830' TO DFHEIV0(25:11)
  7792     CALL 'kxdfhei1' USING DFHEIV0,
  7793           CLMS-FILE-ID,
  7794           DFHEIV20,
  7795           DFHEIV99,
  7796           MSTR-KEY,
  7797           DFHEIV99,
  7798           DFHEIV99,
  7799           DFHEIV99
  7800     SET ADDRESS OF CLAIM-MASTER TO
  7801         DFHEIV20
  7802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7803
  7804
  7805
  7806* EXEC CICS GETMAIN
  7807*        SET       (ADDRESS OF ALPHA-INDEX)
  7808*        LENGTH    (ALPH-LENGTH)
  7809*        INITIMG   (GETMAIN-SPACE)
  7810*    END-EXEC.
  7811*    MOVE ',"IL                  $   #00007686' TO DFHEIV0
  7812     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7813     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7814     MOVE X'2020233030303037363836' TO DFHEIV0(25:11)
  7815     CALL 'kxdfhei1' USING DFHEIV0,
  7816           DFHEIV20,
  7817           ALPH-LENGTH,
  7818           GETMAIN-SPACE
  7819     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 141
* EL131.cbl
  7820         DFHEIV20
  7821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7822
  7823
  7824     MOVE 'AI'                       TO  AI-RECORD-ID.
  7825     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7826                                         AI-CL-COMPANY-CD.
  7827     MOVE 'C'                        TO  AI-SOURCE
  7828                                         AI-CL-SOURCE.
  7829
  7830     IF MLNAMEL IS GREATER THAN +0
  7831         MOVE MLNAMEI                TO  AI-LAST-NAME
  7832     ELSE
  7833         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7834
  7835     IF MFNAMEL IS GREATER THAN +0
  7836         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7837     ELSE
  7838         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7839
  7840     IF MMINITL IS GREATER THAN +0
  7841         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7842     ELSE
  7843         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7844
  7845     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7846     MOVE '5'                        TO  DC-OPTION-CODE.
  7847     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7848     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7849     IF BUILD-YEAR IS GREATER THAN 50
  7850         MOVE '19'                   TO  WS-ALPHA-YY-1
  7851         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7852         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7853         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7854     ELSE
  7855         MOVE '20'                   TO  WS-ALPHA-YY-1
  7856         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7857         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7858         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7859
  7860     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7861                                         AI-CL-DATE.
  7862
  7863     MOVE EIBTIME                    TO  AI-TIME
  7864                                         AI-CL-TIME.
  7865
  7866     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7867     MOVE 'C'                        TO  AI-CL-SOURCE.
  7868     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7869     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7870     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7871     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7872     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7873
  7874     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7875     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7876     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7877
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 142
* EL131.cbl
  7878
  7879* EXEC CICS WRITE
  7880*        DATASET   (ALPH-FILE-ID)
  7881*        RIDFLD    (AI-CONTROL-PRIMARY)
  7882*        FROM      (ALPHA-INDEX)
  7883*    END-EXEC.
  7884     MOVE LENGTH OF
  7885      ALPHA-INDEX
  7886       TO DFHEIV11
  7887*    MOVE '&$ L                  ''   #00007746' TO DFHEIV0
  7888     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7889     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7890     MOVE X'2020233030303037373436' TO DFHEIV0(25:11)
  7891     CALL 'kxdfhei1' USING DFHEIV0,
  7892           ALPH-FILE-ID,
  7893           ALPHA-INDEX,
  7894           DFHEIV11,
  7895           AI-CONTROL-PRIMARY,
  7896           DFHEIV99,
  7897           DFHEIV99
  7898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7899
  7900
  7901     MOVE LOW-VALUES                 TO  EL131AO.
  7902     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7903     MOVE ER-0000                    TO  EMI-ERROR.
  7904     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7905     MOVE -1                         TO  MAINTL.
  7906     GO TO 8100-SEND-MAP.
  7907
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 143
* EL131.cbl
  7909 0600-CHANGE-NAME.
  7910******************************************************************
  7911*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7912*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7913******************************************************************
  7914
  7915     IF MLNAMEL = +0 AND
  7916        MFNAMEL = +0 AND
  7917        MMINITL = +0
  7918         MOVE ER-0276                TO  EMI-ERROR
  7919         MOVE -1                     TO  MAINTL
  7920         MOVE AL-UABON               TO  MAINTA
  7921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7922         GO TO 8110-SEND-DATA.
  7923
  7924     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7925     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7926     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7927     MOVE PI-CERT-NO                 TO  CERT-NO.
  7928
  7929
  7930* EXEC CICS READ
  7931*        DATASET   (CLMS-FILE-ID)
  7932*        RIDFLD    (MSTR-KEY)
  7933*        SET       (ADDRESS OF CLAIM-MASTER)
  7934*    END-EXEC.
  7935*    MOVE '&"S        E          (   #00007780' TO DFHEIV0
  7936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7937     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7938     MOVE X'2020233030303037373830' TO DFHEIV0(25:11)
  7939     CALL 'kxdfhei1' USING DFHEIV0,
  7940           CLMS-FILE-ID,
  7941           DFHEIV20,
  7942           DFHEIV99,
  7943           MSTR-KEY,
  7944           DFHEIV99,
  7945           DFHEIV99,
  7946           DFHEIV99
  7947     SET ADDRESS OF CLAIM-MASTER TO
  7948         DFHEIV20
  7949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7950
  7951
  7952
  7953* EXEC CICS GETMAIN
  7954*        SET       (ADDRESS OF ALPHA-INDEX)
  7955*        LENGTH    (ALPH-LENGTH)
  7956*        INITIMG   (GETMAIN-SPACE)
  7957*    END-EXEC.
  7958*    MOVE ',"IL                  $   #00007786' TO DFHEIV0
  7959     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7960     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7961     MOVE X'2020233030303037373836' TO DFHEIV0(25:11)
  7962     CALL 'kxdfhei1' USING DFHEIV0,
  7963           DFHEIV20,
  7964           ALPH-LENGTH,
  7965           GETMAIN-SPACE
  7966     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 144
* EL131.cbl
  7967         DFHEIV20
  7968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7969
  7970
  7971     MOVE 'AI'                       TO  AI-RECORD-ID.
  7972     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7973                                         AI-CL-COMPANY-CD.
  7974     MOVE 'C'                        TO  AI-SOURCE
  7975                                         AI-CL-SOURCE.
  7976
  7977     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7978     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7979     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7980
  7981     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7982     MOVE '5'                        TO  DC-OPTION-CODE.
  7983     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7984     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7985     IF BUILD-YEAR IS GREATER THAN 50
  7986         MOVE '19'                   TO  WS-ALPHA-YY-1
  7987         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7988         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7989         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7990     ELSE
  7991         MOVE '20'                   TO  WS-ALPHA-YY-1
  7992         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7993         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7994         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7995
  7996     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7997                                         AI-CL-DATE.
  7998
  7999     MOVE EIBTIME                    TO  AI-TIME
  8000                                         AI-CL-TIME.
  8001
  8002     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8003     MOVE 'C'                        TO  AI-CL-SOURCE.
  8004     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8005     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8006     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8007     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8008     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8009
  8010     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8011     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8012     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8013
  8014     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8015         MOVE 'Y'                TO CL-YESNOSW
  8016     END-IF.
  8017
  8018
  8019* EXEC CICS WRITE
  8020*        DATASET   (ALPH-FILE-ID)
  8021*        RIDFLD    (AI-CONTROL-PRIMARY)
  8022*        FROM      (ALPHA-INDEX)
  8023*    END-EXEC.
  8024     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 145
* EL131.cbl
  8025      ALPHA-INDEX
  8026       TO DFHEIV11
  8027*    MOVE '&$ L                  ''   #00007839' TO DFHEIV0
  8028     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8029     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8030     MOVE X'2020233030303037383339' TO DFHEIV0(25:11)
  8031     CALL 'kxdfhei1' USING DFHEIV0,
  8032           ALPH-FILE-ID,
  8033           ALPHA-INDEX,
  8034           DFHEIV11,
  8035           AI-CONTROL-PRIMARY,
  8036           DFHEIV99,
  8037           DFHEIV99
  8038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8039
  8040
  8041
  8042* EXEC CICS READ
  8043*        DATASET   (CLMS-FILE-ID)
  8044*        RIDFLD    (MSTR-KEY)
  8045*        SET       (ADDRESS OF CLAIM-MASTER)
  8046*        UPDATE
  8047*    END-EXEC.
  8048*    MOVE '&"S        EU         (   #00007845' TO DFHEIV0
  8049     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8050     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8051     MOVE X'2020233030303037383435' TO DFHEIV0(25:11)
  8052     CALL 'kxdfhei1' USING DFHEIV0,
  8053           CLMS-FILE-ID,
  8054           DFHEIV20,
  8055           DFHEIV99,
  8056           MSTR-KEY,
  8057           DFHEIV99,
  8058           DFHEIV99,
  8059           DFHEIV99
  8060     SET ADDRESS OF CLAIM-MASTER TO
  8061         DFHEIV20
  8062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8063
  8064
  8065     if (cl-priority-cd = '8')
  8066        and (pi-processor-id not = 'PEMA'and 'JMS '
  8067             AND 'AMWA' AND 'KMSB')
  8068        MOVE ER-8003             TO EMI-ERROR
  8069        PERFORM 9900-ERROR-FORMAT
  8070                                 THRU 9900-EXIT
  8071        MOVE -1                  TO MAINTL
  8072        GO TO 8110-SEND-DATA
  8073     end-if
  8074
  8075     IF MLNAMEL IS GREATER THAN +0
  8076         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8077
  8078     IF MFNAMEL IS GREATER THAN +0
  8079         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8080
  8081     IF MMINITL IS GREATER THAN +0
  8082         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 146
* EL131.cbl
  8083
  8084     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8085     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8086     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8087     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8088
  8089     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8090         MOVE 'Y'                TO CL-YESNOSW
  8091     END-IF.
  8092
  8093
  8094* EXEC CICS HANDLE CONDITION
  8095*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8096*    END-EXEC.
  8097*    MOVE '"$$                   ! $ #00007880' TO DFHEIV0
  8098     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8100     MOVE X'2420233030303037383830' TO DFHEIV0(25:11)
  8101     CALL 'kxdfhei1' USING DFHEIV0
  8102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8103
  8104
  8105
  8106* EXEC CICS REWRITE
  8107*        DATASET   (CLMS-FILE-ID)
  8108*        FROM      (CLAIM-MASTER)
  8109*    END-EXEC.
  8110     MOVE LENGTH OF
  8111      CLAIM-MASTER
  8112       TO DFHEIV11
  8113*    MOVE '&& L                  %   #00007884' TO DFHEIV0
  8114     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8115     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8116     MOVE X'2020233030303037383834' TO DFHEIV0(25:11)
  8117     CALL 'kxdfhei1' USING DFHEIV0,
  8118           CLMS-FILE-ID,
  8119           CLAIM-MASTER,
  8120           DFHEIV11,
  8121           DFHEIV99
  8122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8123
  8124
  8125 0600-CONTINUE-NAME-UPDATE.
  8126
  8127     MOVE LOW-VALUES                 TO  EL131AO.
  8128     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8129     MOVE ER-0000                    TO  EMI-ERROR.
  8130     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8131     MOVE -1                         TO  MAINTL.
  8132     GO TO 8100-SEND-MAP.
  8133
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 147
* EL131.cbl
  8135 1000-EDIT-SCREEN.
  8136
  8137     MOVE MAINTI                 TO CHECK-MAINT.
  8138
  8139     IF NOT VALID-OPTIONS
  8140         MOVE 'X'                TO ERROR-SWITCH
  8141         MOVE -1                 TO MAINTL
  8142         MOVE AL-UABON           TO MAINTA
  8143         MOVE ER-0023            TO EMI-ERROR
  8144         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8145         GO TO 1010-EXIT.
  8146
  8147     IF NOT MODIFY-CAP
  8148         MOVE 'UPDATE'           TO  SM-READ
  8149         PERFORM 9995-SECURITY-VIOLATION
  8150         MOVE ER-0070               TO  EMI-ERROR
  8151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8152         GO TO 8100-SEND-MAP.
  8153
  8154     IF DELETE-CLAIM
  8155         MOVE AL-UANON TO MAINTA
  8156         GO TO 1010-EXIT.
  8157
  8158     MOVE AL-UANON               TO MAINTA.
  8159
  8160     IF CCNOI GREATER THAN LOW-VALUES
  8161         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8162
  8163     IF PI-COMPANY-ID = 'CSL'
  8164        CONTINUE
  8165     ELSE
  8166        IF TYPEL > ZERO
  8167           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8168              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8169                    PI-LIFE-OVERRIDE-L1))
  8170                       OR
  8171              ((PI-COMPANY-ID = 'DCC')
  8172              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8173                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8174              MOVE AL-UANON      TO TYPEA
  8175              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8176           ELSE
  8177              MOVE ER-0199       TO EMI-ERROR
  8178              PERFORM 9900-ERROR-FORMAT
  8179                                 THRU 9900-EXIT
  8180              MOVE AL-UABON      TO TYPEA
  8181              MOVE -1            TO TYPEL
  8182              MOVE 'X'           TO ERROR-SWITCH
  8183           END-IF
  8184        ELSE
  8185           MOVE AL-UANOF         TO TYPEA
  8186        END-IF
  8187     END-IF
  8188     IF STATUSI GREATER THAN LOW-VALUES
  8189         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8190             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8191             MOVE AL-UANON       TO STATUSA
  8192             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 148
* EL131.cbl
  8193             MOVE 'Y'            TO DLYACTV-SW
  8194         ELSE
  8195             MOVE ER-0333        TO EMI-ERROR
  8196             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8197             MOVE AL-UABON       TO STATUSA
  8198             MOVE -1             TO STATUSL
  8199             MOVE 'X'            TO ERROR-SWITCH
  8200         END-IF
  8201     ELSE
  8202         MOVE SPACE              TO TRLR-SWITCH
  8203         MOVE 'N'                TO DLYACTV-SW
  8204         MOVE AL-UANOF           TO STATUSA.
  8205
  8206     IF PROCI GREATER THAN LOW-VALUES
  8207         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8208     ELSE
  8209         MOVE AL-UANOF TO PROCA.
  8210
  8211     IF SEXI GREATER THAN LOW-VALUES
  8212         IF SEXI = 'F' OR 'M'
  8213             MOVE AL-UANON       TO SEXA
  8214             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8215           ELSE
  8216             MOVE ER-0219        TO EMI-ERROR
  8217             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8218             MOVE AL-UABON       TO SEXA
  8219             MOVE -1             TO SEXL
  8220             MOVE 'X'            TO ERROR-SWITCH
  8221       ELSE
  8222         MOVE AL-UANOF           TO SEXA.
  8223
  8224     IF BIRTHL = +0
  8225         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8226         MOVE AL-UANOF           TO  BIRTHA
  8227         GO TO 1000-CONTINUE-EDITS.
  8228
  8229     IF BIRTHI = SPACES
  8230         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8231         MOVE 'X'                TO  UPDATE-SWITCH
  8232                                     MSTR-SWITCH
  8233         GO TO 1000-CONTINUE-EDITS.
  8234
  8235     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8236     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8237     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8238     MOVE '4'                    TO  DC-OPTION-CODE.
  8239     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8240     IF DATE-CONVERSION-ERROR
  8241         MOVE ER-0220            TO  EMI-ERROR
  8242         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8243         MOVE AL-UABON           TO  BIRTHA
  8244         MOVE -1                 TO  BIRTHL
  8245         MOVE 'X'                TO  ERROR-SWITCH
  8246         GO TO 1000-CONTINUE-EDITS.
  8247
  8248******************************************************************
  8249**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8250**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 149
* EL131.cbl
  8251**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8252******************************************************************
  8253     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8254         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8255         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8256         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8257         MOVE '4'                TO  DC-OPTION-CODE
  8258         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8259         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8260                                     DC-ELAPSED-DAYS
  8261         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8262         IF DATE-CONVERSION-ERROR
  8263             MOVE ER-0220        TO  EMI-ERROR
  8264             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8265             MOVE AL-UABON       TO  BIRTHA
  8266             MOVE -1             TO  BIRTHL
  8267             MOVE 'X'            TO  ERROR-SWITCH
  8268             GO TO 1000-CONTINUE-EDITS.
  8269
  8270     MOVE AL-UANON               TO  BIRTHA.
  8271     MOVE 'X'                    TO  UPDATE-SWITCH
  8272                                     MSTR-SWITCH.
  8273     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8274     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8275     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8276
  8277 1000-CONTINUE-EDITS.
  8278
  8279     IF SOCIALI GREATER THAN LOW-VALUES
  8280         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8281         IF WS-SOC-SEC-NO NUMERIC AND
  8282           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8283             NEXT SENTENCE
  8284         ELSE
  8285            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8286               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8287               WS-SSN-DASH2 = '-'
  8288                 NEXT SENTENCE
  8289            ELSE
  8290                 MOVE ER-0887        TO  EMI-ERROR
  8291                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8292                 MOVE AL-UABON       TO  SOCIALA
  8293                 MOVE -1             TO  SOCIALL
  8294                 MOVE 'X'            TO  ERROR-SWITCH
  8295            END-IF
  8296        END-IF
  8297     END-IF.
  8298
  8299     IF SOCIALI GREATER THAN LOW-VALUES
  8300         MOVE AL-UANON           TO SOCIALA
  8301         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8302     ELSE
  8303         MOVE AL-UANOF           TO SOCIALA.
  8304
  8305     IF OCCI GREATER THAN LOW-VALUES
  8306         MOVE AL-UANON           TO OCCA
  8307         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8308     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 150
* EL131.cbl
  8309         MOVE AL-UANOF           TO OCCA.
  8310
  8311     IF BENEL NOT GREATER THAN ZERO
  8312            GO TO 1005-CONTINUE-EDITS.
  8313
  8314     IF BENEI = SPACES
  8315        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8316           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8317           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8318           IF AUTO-PAY-TO-BENE = 'Y'
  8319               MOVE ER-1773      TO  EMI-ERROR
  8320               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8321               MOVE 'X'          TO ERROR-SWITCH
  8322               MOVE AL-UABON     TO BENEA
  8323               MOVE -1           TO BENEL
  8324           ELSE
  8325               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8326           END-IF
  8327        ELSE
  8328           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8329        END-IF
  8330        GO TO 1005-CONTINUE-EDITS.
  8331
  8332
  8333* EXEC CICS HANDLE CONDITION
  8334*        NOTFND (1004-BENE-NOT-FOUND)
  8335*    END-EXEC.
  8336*    MOVE '"$I                   ! % #00008096' TO DFHEIV0
  8337     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8339     MOVE X'2520233030303038303936' TO DFHEIV0(25:11)
  8340     CALL 'kxdfhei1' USING DFHEIV0
  8341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8342
  8343
  8344     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8345     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8346     MOVE BENEI                  TO  WS-ELBENE-ID.
  8347
  8348
  8349* EXEC CICS READ
  8350*        DATASET ('ELBENE')
  8351*        RIDFLD  (WS-ELBENE-KEY)
  8352*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8353*    END-EXEC.
  8354     MOVE 'ELBENE' TO DFHEIV1
  8355*    MOVE '&"S        E          (   #00008104' TO DFHEIV0
  8356     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8357     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8358     MOVE X'2020233030303038313034' TO DFHEIV0(25:11)
  8359     CALL 'kxdfhei1' USING DFHEIV0,
  8360           DFHEIV1,
  8361           DFHEIV20,
  8362           DFHEIV99,
  8363           WS-ELBENE-KEY,
  8364           DFHEIV99,
  8365           DFHEIV99,
  8366           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 151
* EL131.cbl
  8367     SET ADDRESS OF BENEFICIARY-MASTER TO
  8368         DFHEIV20
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8370
  8371
  8372     MOVE AL-UANON               TO  BENEA.
  8373     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8374
  8375     GO TO 1005-CONTINUE-EDITS.
  8376
  8377 1004-BENE-NOT-FOUND.
  8378     MOVE ER-0565                TO  EMI-ERROR.
  8379
  8380     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8381     MOVE 'X'                    TO ERROR-SWITCH.
  8382     MOVE AL-UABON               TO BENEA.
  8383     MOVE -1                     TO BENEL.
  8384
  8385 1005-CONTINUE-EDITS.
  8386
  8387     IF DIAGI GREATER THAN LOW-VALUES
  8388         MOVE AL-UANON           TO DIAGA
  8389         MOVE 'X'                TO UPDATE-SWITCH
  8390                                    NINETY-TRLR-SWITCH
  8391     ELSE
  8392         MOVE AL-UANOF           TO DIAGA.
  8393
  8394     IF ICD1I GREATER THAN LOW-VALUES
  8395         IF (ICD1I GREATER THAN SPACES) AND
  8396            (ICD1I(4:1) NOT = '.')
  8397             IF ICD1I(4:1) = ' '
  8398                 MOVE '.' TO ICD1I(4:1)
  8399             ELSE
  8400                 IF ICD1I(8:1) = ' '
  8401                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8402                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8403                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8404                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8405                     MOVE '.'        TO ICD1I(4:1)
  8406                 END-IF
  8407             END-IF
  8408         END-IF
  8409         IF (ICD1I GREATER THAN SPACES) AND
  8410            (ICD1I(1:1) NOT > ' ' OR
  8411             ICD1I(2:1) NOT > ' ' OR
  8412             ICD1I(3:1) NOT > ' ' OR
  8413             ICD1I(4:1) NOT = '.')
  8414              MOVE ER-0992        TO  EMI-ERROR
  8415              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8416              MOVE 'X'            TO ERROR-SWITCH
  8417              MOVE AL-UABON       TO ICD1A
  8418              MOVE -1             TO ICD1L
  8419         ELSE
  8420             MOVE AL-UANON       TO ICD1A
  8421             MOVE 'X'            TO UPDATE-SWITCH
  8422                                    NINETY-TRLR-SWITCH
  8423         END-IF
  8424     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 152
* EL131.cbl
  8425         MOVE AL-UANOF           TO ICD1A
  8426     END-IF.
  8427
  8428     IF ICD2I GREATER THAN LOW-VALUES
  8429         IF (ICD2I GREATER THAN SPACES) AND
  8430            (ICD2I(4:1) NOT = '.')
  8431             IF ICD2I(4:1) = ' '
  8432                 MOVE '.' TO ICD2I(4:1)
  8433             ELSE
  8434                 IF ICD2I(8:1) = ' '
  8435                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8436                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8437                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8438                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8439                     MOVE '.'        TO ICD2I(4:1)
  8440                 END-IF
  8441             END-IF
  8442         END-IF
  8443         IF (ICD2I GREATER THAN SPACES) AND
  8444            (ICD2I(1:1) NOT > ' ' OR
  8445             ICD2I(2:1) NOT > ' ' OR
  8446             ICD2I(3:1) NOT > ' ' OR
  8447             ICD2I(4:1) NOT = '.')
  8448              MOVE ER-0992        TO EMI-ERROR
  8449              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8450              MOVE 'X'            TO ERROR-SWITCH
  8451              MOVE AL-UABON       TO ICD2A
  8452              MOVE -1             TO ICD2L
  8453         ELSE
  8454             MOVE AL-UANON       TO ICD2A
  8455             MOVE 'X'            TO UPDATE-SWITCH
  8456                                    NINETY-TRLR-SWITCH
  8457         END-IF
  8458     ELSE
  8459         MOVE AL-UANOF           TO ICD2A
  8460     END-IF.
  8461
  8462*    IF CAUSEI GREATER THAN LOW-VALUES
  8463*        MOVE AL-UANON           TO CAUSEA
  8464*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8465*    ELSE
  8466*        MOVE AL-UANOF           TO CAUSEA.
  8467
  8468*    IF ENDL GREATER THAN ZERO
  8469*        MOVE LOW-VALUES         TO HOLD-END
  8470*        IF ENDI = SPACES
  8471*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8472*        ELSE
  8473*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8474*            EXEC CICS BIF DEEDIT
  8475*                FIELD    (DEEDIT-DATE-INPUT)
  8476*                LENGTH   (DATE-LENGTH)
  8477*            END-EXEC
  8478*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8479*            MOVE '4'            TO DC-OPTION-CODE
  8480*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8481*            IF NOT DATE-CONVERSION-ERROR
  8482*                MOVE DC-BIN-DATE-1      TO HOLD-END
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 153
* EL131.cbl
  8483*                MOVE AL-UANON   TO ENDA
  8484*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8485*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8486*            ELSE
  8487*                MOVE ER-0224    TO EMI-ERROR
  8488*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8489*                MOVE AL-UABON   TO ENDA
  8490*                MOVE -1         TO ENDL
  8491*                MOVE 'X'        TO ERROR-SWITCH
  8492*      ELSE
  8493*          MOVE AL-UANOF         TO ENDA.
  8494
  8495     IF INCL GREATER THAN ZERO
  8496         MOVE LOW-VALUES         TO HOLD-INCUR
  8497         IF INCI = SPACES
  8498             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8499         ELSE
  8500             MOVE INCI           TO DEEDIT-DATE-INPUT
  8501
  8502* EXEC CICS BIF DEEDIT
  8503*                FIELD    (DEEDIT-DATE-INPUT)
  8504*                LENGTH   (DATE-LENGTH)
  8505*            END-EXEC
  8506*    MOVE '@"L                   #   #00008239' TO DFHEIV0
  8507     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8509     MOVE X'2020233030303038323339' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0,
  8511           DEEDIT-DATE-INPUT,
  8512           DATE-LENGTH
  8513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8514             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8515             MOVE '4'            TO DC-OPTION-CODE
  8516             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8517             IF NOT DATE-CONVERSION-ERROR
  8518                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8519                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8520                 MOVE AL-UANON           TO INCA
  8521                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8522             ELSE
  8523                 MOVE ER-0222    TO EMI-ERROR
  8524                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8525                 MOVE AL-UABON   TO INCA
  8526                 MOVE -1         TO INCL
  8527                 MOVE 'X'        TO ERROR-SWITCH
  8528       ELSE
  8529           IF PI-NO-PMTS = ZEROS
  8530               MOVE AL-UANOF     TO INCA.
  8531
  8532     IF REPL GREATER THAN ZERO
  8533         MOVE LOW-VALUES         TO HOLD-REPORTED
  8534         IF REPI = SPACES
  8535             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8536         ELSE
  8537             MOVE REPI           TO DEEDIT-DATE-INPUT
  8538
  8539* EXEC CICS BIF DEEDIT
  8540*                FIELD    (DEEDIT-DATE-INPUT)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 154
* EL131.cbl
  8541*                LENGTH   (DATE-LENGTH)
  8542*            END-EXEC
  8543*    MOVE '@"L                   #   #00008267' TO DFHEIV0
  8544     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8545     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8546     MOVE X'2020233030303038323637' TO DFHEIV0(25:11)
  8547     CALL 'kxdfhei1' USING DFHEIV0,
  8548           DEEDIT-DATE-INPUT,
  8549           DATE-LENGTH
  8550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8551             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8552             MOVE '4'            TO DC-OPTION-CODE
  8553             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8554             IF NOT DATE-CONVERSION-ERROR
  8555                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8556                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8557                 MOVE AL-UANON   TO REPA
  8558                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8559             ELSE
  8560                 MOVE ER-0223    TO EMI-ERROR
  8561                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8562                 MOVE AL-UABON   TO REPA
  8563                 MOVE -1         TO REPL
  8564                 MOVE 'X'        TO ERROR-SWITCH
  8565       ELSE
  8566         MOVE AL-UANOF TO REPA.
  8567
  8568     IF PDTHRUI GREATER THAN LOW-VALUES
  8569        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8570        IF PDTHRUI = SPACES
  8571           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8572        ELSE
  8573           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8574
  8575* EXEC CICS BIF DEEDIT
  8576*               FIELD    (DEEDIT-DATE-INPUT)
  8577*               LENGTH   (DATE-LENGTH)
  8578*          END-EXEC
  8579*    MOVE '@"L                   #   #00008294' TO DFHEIV0
  8580     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8581     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8582     MOVE X'2020233030303038323934' TO DFHEIV0(25:11)
  8583     CALL 'kxdfhei1' USING DFHEIV0,
  8584           DEEDIT-DATE-INPUT,
  8585           DATE-LENGTH
  8586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8587           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8588           MOVE '4'            TO DC-OPTION-CODE
  8589           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8590           IF NOT DATE-CONVERSION-ERROR
  8591              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8592              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8593              MOVE AL-UANON   TO PDTHRUA
  8594              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8595              IF PI-USES-PAID-TO
  8596                 MOVE '6'            TO DC-OPTION-CODE
  8597                 MOVE -1             TO DC-ELAPSED-DAYS
  8598                 MOVE +0             TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 155
* EL131.cbl
  8599                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8600                 IF NO-CONVERSION-ERROR
  8601                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8602                 ELSE
  8603                    NEXT SENTENCE
  8604              ELSE
  8605                 NEXT SENTENCE
  8606           ELSE
  8607              MOVE ER-0475    TO EMI-ERROR
  8608              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8609              MOVE AL-UABON   TO PDTHRUA
  8610              MOVE -1         TO PDTHRUL
  8611              MOVE 'X'        TO ERROR-SWITCH
  8612     ELSE
  8613        IF MODIFY-CAP
  8614           MOVE AL-UANOF        TO PDTHRUA.
  8615
  8616     IF PDAMTL GREATER THAN +0
  8617         MOVE ZEROS              TO HOLD-PDAMT
  8618
  8619* EXEC CICS BIF DEEDIT
  8620*            FIELD    (PDAMTI)
  8621*            LENGTH   (9)
  8622*        END-EXEC
  8623     MOVE 9
  8624       TO DFHEIV11
  8625*    MOVE '@"L                   #   #00008329' TO DFHEIV0
  8626     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8627     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8628     MOVE X'2020233030303038333239' TO DFHEIV0(25:11)
  8629     CALL 'kxdfhei1' USING DFHEIV0,
  8630           PDAMTI,
  8631           DFHEIV11
  8632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8633         IF PDAMTI NUMERIC
  8634             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8635             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8636             MOVE AL-UNNON       TO PDAMTA
  8637         ELSE
  8638             MOVE ER-0547        TO EMI-ERROR
  8639             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8640             MOVE AL-UNBON       TO PDAMTA
  8641             MOVE -1             TO PDAMTL
  8642             MOVE 'X'            TO ERROR-SWITCH
  8643     ELSE
  8644         IF MODIFY-CAP
  8645            MOVE AL-UNNOF        TO PDAMTA.
  8646
  8647     IF NODAYSI GREATER THAN LOW-VALUES
  8648         MOVE ZEROS              TO HOLD-NODAYS
  8649
  8650* EXEC CICS BIF DEEDIT
  8651*            FIELD (NODAYSI)
  8652*            LENGTH (5)
  8653*        END-EXEC
  8654     MOVE 5
  8655       TO DFHEIV11
  8656*    MOVE '@"L                   #   #00008349' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 156
* EL131.cbl
  8657     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8658     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8659     MOVE X'2020233030303038333439' TO DFHEIV0(25:11)
  8660     CALL 'kxdfhei1' USING DFHEIV0,
  8661           NODAYSI,
  8662           DFHEIV11
  8663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8664         IF NODAYSI NUMERIC
  8665             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8666             MOVE AL-UNNON       TO NODAYSA
  8667             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8668         ELSE
  8669             MOVE ER-0491        TO EMI-ERROR
  8670             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8671             MOVE AL-UNBON       TO NODAYSA
  8672             MOVE -1             TO NODAYSL
  8673             MOVE 'X'            TO ERROR-SWITCH
  8674     ELSE
  8675         IF MODIFY-CAP
  8676            MOVE AL-UNNOF        TO NODAYSA.
  8677
  8678     IF NOPMTSI GREATER THAN LOW-VALUES
  8679         MOVE ZEROS              TO HOLD-NOPMTS
  8680
  8681* EXEC CICS BIF DEEDIT
  8682*            FIELD (NOPMTSI)
  8683*            LENGTH (4)
  8684*        END-EXEC
  8685     MOVE 4
  8686       TO DFHEIV11
  8687*    MOVE '@"L                   #   #00008369' TO DFHEIV0
  8688     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8689     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8690     MOVE X'2020233030303038333639' TO DFHEIV0(25:11)
  8691     CALL 'kxdfhei1' USING DFHEIV0,
  8692           NOPMTSI,
  8693           DFHEIV11
  8694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8695         IF NOPMTSI NUMERIC
  8696             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8697             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8698             MOVE AL-UNNON       TO NOPMTSA
  8699           ELSE
  8700             MOVE ER-0548        TO EMI-ERROR
  8701             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8702             MOVE AL-UNBON       TO NOPMTSA
  8703             MOVE -1             TO NOPMTSL
  8704             MOVE 'X'            TO ERROR-SWITCH
  8705       ELSE
  8706         IF MODIFY-CAP
  8707            MOVE AL-UNNOF        TO NOPMTSA.
  8708
  8709     IF FORMTYPI GREATER THAN LOW-VALUES
  8710         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8711             MOVE AL-UANON       TO FORMTYPA
  8712             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8713           ELSE
  8714             MOVE ER-7650        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 157
* EL131.cbl
  8715             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8716             MOVE AL-UABON       TO FORMTYPA
  8717             MOVE -1             TO FORMTYPL
  8718             MOVE 'X'            TO ERROR-SWITCH
  8719       ELSE
  8720         MOVE AL-UANOF           TO FORMTYPA.
  8721
  8722     IF PRICDL GREATER THAN ZERO
  8723         IF (PRICDI = ' ') OR
  8724            (PRICDI GREATER THAN ZERO   AND
  8725             PRICDI NOT GREATER THAN '9')
  8726             MOVE AL-UANON       TO PRICDA
  8727             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8728         ELSE
  8729             MOVE ER-0274        TO EMI-ERROR
  8730             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8731             MOVE AL-UABON       TO PRICDA
  8732             MOVE -1             TO PRICDL
  8733             MOVE 'X'            TO ERROR-SWITCH
  8734     ELSE
  8735         MOVE AL-UANOF TO PRICDA.
  8736
  8737     IF PI-COMPANY-ID = 'DMD'
  8738     IF PRICDL GREATER THAN ZERO
  8739       IF SYSTEM-MODIFY-CAP  OR
  8740          PI-PROCESSOR-ID = 'LGXX'
  8741             NEXT SENTENCE
  8742           ELSE
  8743            IF CL-PRIORITY-CD = '9'  OR
  8744               PRICDI         = '9'
  8745                  MOVE ER-0938        TO EMI-ERROR
  8746                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8747                  MOVE AL-UABON       TO PRICDA
  8748                  MOVE -1             TO PRICDL
  8749                  MOVE 'X'            TO ERROR-SWITCH.
  8750
  8751     IF FILETOL GREATER THAN ZERO
  8752         MOVE AL-UANON           TO FILETOA
  8753         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8754     ELSE
  8755         MOVE AL-UANOF TO FILETOA.
  8756
  8757     IF SUPVL GREATER THAN ZERO
  8758         IF SUPVI = 'Y' OR 'N' OR SPACE
  8759             MOVE AL-UANON       TO SUPVA
  8760             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8761         ELSE
  8762             MOVE ER-0230        TO EMI-ERROR
  8763             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8764             MOVE AL-UABON       TO SUPVA
  8765             MOVE -1             TO SUPVL
  8766             MOVE 'X'            TO ERROR-SWITCH
  8767     ELSE
  8768         MOVE AL-UANOF           TO SUPVA.
  8769
  8770     IF MLNAMEL GREATER THAN ZERO
  8771         IF MLNAMEI GREATER THAN SPACES
  8772            MOVE AL-UANON        TO MLNAMEA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 158
* EL131.cbl
  8773            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8774                                     MSTR-KEY-SWITCH
  8775         ELSE
  8776            MOVE ER-0236         TO EMI-ERROR
  8777            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8778            MOVE AL-UABON        TO MLNAMEA
  8779            MOVE -1              TO MLNAMEL
  8780            MOVE 'X'             TO ERROR-SWITCH
  8781     ELSE
  8782         MOVE AL-UANOF           TO MLNAMEA.
  8783
  8784     IF MFNAMEI GREATER THAN LOW-VALUES
  8785         MOVE AL-UANON           TO MFNAMEA
  8786         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8787     ELSE
  8788         MOVE AL-UANOF           TO MFNAMEA.
  8789
  8790     IF MMINITI GREATER THAN LOW-VALUES
  8791         MOVE AL-UANON           TO MMINITA
  8792         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8793     ELSE
  8794         MOVE AL-UANOF           TO MMINITA.
  8795
  8796     IF CRTLNMEI GREATER THAN LOW-VALUES
  8797         IF CRTLNMEI NOT = SPACES
  8798            MOVE AL-UANON        TO CRTLNMEA
  8799            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8800                                     CERT-KEY-SWITCH
  8801        ELSE
  8802            MOVE ER-0236         TO EMI-ERROR
  8803            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8804            MOVE AL-UABON        TO CRTLNMEA
  8805            MOVE -1              TO CRTLNMEL
  8806            MOVE 'X'             TO ERROR-SWITCH
  8807     ELSE
  8808         MOVE AL-UANOF           TO CRTLNMEA.
  8809
  8810     IF CRTFNMEI GREATER THAN LOW-VALUES
  8811         MOVE AL-UANON           TO CRTFNMEA
  8812         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8813     ELSE
  8814         MOVE AL-UANOF           TO CRTFNMEA.
  8815
  8816     IF CRTINITI GREATER THAN LOW-VALUES
  8817         MOVE AL-UANON           TO CRTINITA
  8818         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8819     ELSE
  8820         MOVE AL-UANOF           TO CRTINITA.
  8821
  8822     IF ISSAGEL GREATER THAN ZERO
  8823         IF ISSAGEI NUMERIC
  8824            MOVE AL-UANON        TO ISSAGEA
  8825            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8826         ELSE
  8827            MOVE ER-0237         TO EMI-ERROR
  8828            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8829            MOVE AL-UABON        TO ISSAGEA
  8830            MOVE -1              TO ISSAGEL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 159
* EL131.cbl
  8831            MOVE 'X'             TO ERROR-SWITCH
  8832     ELSE
  8833         MOVE AL-UANOF           TO ISSAGEA.
  8834
  8835     IF JNTFNMEI GREATER THAN LOW-VALUES
  8836         MOVE AL-UANON           TO JNTFNMEA
  8837         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8838     ELSE
  8839         MOVE AL-UANOF           TO JNTFNMEA.
  8840
  8841     IF JNTLNMEI GREATER THAN LOW-VALUES
  8842         MOVE AL-UANON           TO JNTLNMEA
  8843         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8844     ELSE
  8845         MOVE AL-UANOF           TO JNTLNMEA.
  8846
  8847     IF JNTINITI GREATER THAN LOW-VALUES
  8848         MOVE AL-UANON           TO JNTINITA
  8849         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8850     ELSE
  8851         MOVE AL-UANOF           TO JNTINITA.
  8852
  8853     IF JNTAGEL GREATER THAN ZERO
  8854         IF JNTAGEI NUMERIC
  8855            MOVE AL-UANON        TO JNTAGEA
  8856            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8857         ELSE
  8858            MOVE ER-0238         TO EMI-ERROR
  8859            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8860            MOVE AL-UABON        TO JNTAGEA
  8861            MOVE -1              TO JNTAGEL
  8862            MOVE 'X'             TO ERROR-SWITCH
  8863     ELSE
  8864         MOVE AL-UANOF           TO JNTAGEA.
  8865
  8866     IF ADDONDTI GREATER THAN LOW-VALUES
  8867         MOVE LOW-VALUES         TO HOLD-ADDON
  8868         IF ADDONDTI = SPACES
  8869             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8870         ELSE
  8871             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8872
  8873* EXEC CICS BIF DEEDIT
  8874*                FIELD    (DEEDIT-DATE-INPUT)
  8875*                LENGTH   (DATE-LENGTH)
  8876*            END-EXEC
  8877*    MOVE '@"L                   #   #00008550' TO DFHEIV0
  8878     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8879     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8880     MOVE X'2020233030303038353530' TO DFHEIV0(25:11)
  8881     CALL 'kxdfhei1' USING DFHEIV0,
  8882           DEEDIT-DATE-INPUT,
  8883           DATE-LENGTH
  8884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8885             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8886             MOVE '4'            TO DC-OPTION-CODE
  8887             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8888             IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 160
* EL131.cbl
  8889                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8890                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8891                                                  CERT-SWITCH
  8892                 MOVE AL-UANON   TO ADDONDTA
  8893                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8894             ELSE
  8895                 MOVE ER-7651    TO EMI-ERROR
  8896                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8897                 MOVE AL-UABON   TO ADDONDTA
  8898                 MOVE -1         TO ADDONDTL
  8899                 MOVE 'X'        TO ERROR-SWITCH
  8900       ELSE
  8901         MOVE AL-UANOF TO ADDONDTA.
  8902
  8903     IF LCVCDI GREATER THAN LOW-VALUES
  8904         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8905         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8906     ELSE
  8907         MOVE AL-UANOF           TO LCVCDA.
  8908
  8909     IF ACVCDI GREATER THAN LOW-VALUES
  8910         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8911         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8912     ELSE
  8913         MOVE AL-UANOF           TO ACVCDA.
  8914
  8915     IF LCVOTRMI GREATER THAN LOW-VALUES
  8916
  8917* EXEC CICS BIF DEEDIT
  8918*            FIELD (LCVOTRMI)
  8919*            LENGTH(3)
  8920*        END-EXEC
  8921     MOVE 3
  8922       TO DFHEIV11
  8923*    MOVE '@"L                   #   #00008585' TO DFHEIV0
  8924     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8925     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8926     MOVE X'2020233030303038353835' TO DFHEIV0(25:11)
  8927     CALL 'kxdfhei1' USING DFHEIV0,
  8928           LCVOTRMI,
  8929           DFHEIV11
  8930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8931         IF LCVOTRMI IS NUMERIC
  8932             MOVE LCVOTRMI       TO LCVOTRMO
  8933             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8934             MOVE AL-UANON       TO LCVOTRMA
  8935         ELSE
  8936             MOVE ER-0241        TO EMI-ERROR
  8937             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8938             MOVE AL-UNBON       TO LCVOTRMA
  8939             MOVE 'X'            TO ERROR-SWITCH
  8940             MOVE -1             TO LCVOTRML
  8941     ELSE
  8942         MOVE AL-UANOF           TO LCVOTRMA.
  8943
  8944     IF ACVOTRMI GREATER THAN LOW-VALUES
  8945
  8946* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 161
* EL131.cbl
  8947*            FIELD (ACVOTRMI)
  8948*            LENGTH(3)
  8949*        END-EXEC
  8950     MOVE 3
  8951       TO DFHEIV11
  8952*    MOVE '@"L                   #   #00008603' TO DFHEIV0
  8953     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8954     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8955     MOVE X'2020233030303038363033' TO DFHEIV0(25:11)
  8956     CALL 'kxdfhei1' USING DFHEIV0,
  8957           ACVOTRMI,
  8958           DFHEIV11
  8959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8960         IF ACVOTRMI IS NUMERIC
  8961             MOVE ACVOTRMI       TO ACVOTRMO
  8962             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8963             MOVE AL-UANON       TO ACVOTRMA
  8964         ELSE
  8965             MOVE ER-0241        TO EMI-ERROR
  8966             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8967             MOVE AL-UNBON       TO ACVOTRMA
  8968             MOVE 'X'            TO ERROR-SWITCH
  8969             MOVE -1             TO ACVOTRML
  8970     ELSE
  8971         MOVE AL-UANOF           TO ACVOTRMA.
  8972
  8973     IF LCVRATEL GREATER THAN +0
  8974
  8975* EXEC CICS BIF DEEDIT
  8976*            FIELD (LCVRATEI)
  8977*            LENGTH(6)
  8978*        END-EXEC
  8979     MOVE 6
  8980       TO DFHEIV11
  8981*    MOVE '@"L                   #   #00008621' TO DFHEIV0
  8982     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8983     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8984     MOVE X'2020233030303038363231' TO DFHEIV0(25:11)
  8985     CALL 'kxdfhei1' USING DFHEIV0,
  8986           LCVRATEI,
  8987           DFHEIV11
  8988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8989         IF LCVRATEI IS NUMERIC
  8990             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8991             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8992             MOVE AL-UNNON       TO LCVRATEA
  8993         ELSE
  8994             MOVE ER-2280        TO EMI-ERROR
  8995             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8996             MOVE AL-UNBON       TO LCVRATEA
  8997             MOVE 'X'            TO ERROR-SWITCH
  8998             MOVE -1             TO LCVRATEL
  8999     ELSE
  9000         MOVE AL-UNNOF           TO LCVRATEA.
  9001
  9002     IF ACVRATEL GREATER THAN +0
  9003
  9004* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 162
* EL131.cbl
  9005*            FIELD (ACVRATEI)
  9006*            LENGTH(6)
  9007*        END-EXEC
  9008     MOVE 6
  9009       TO DFHEIV11
  9010*    MOVE '@"L                   #   #00008639' TO DFHEIV0
  9011     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9013     MOVE X'2020233030303038363339' TO DFHEIV0(25:11)
  9014     CALL 'kxdfhei1' USING DFHEIV0,
  9015           ACVRATEI,
  9016           DFHEIV11
  9017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9018         IF ACVRATEI IS NUMERIC
  9019             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9020             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9021             MOVE AL-UNNON       TO ACVRATEA
  9022         ELSE
  9023             MOVE ER-2280        TO EMI-ERROR
  9024             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9025             MOVE AL-UNBON       TO ACVRATEA
  9026             MOVE 'X'            TO ERROR-SWITCH
  9027             MOVE -1             TO ACVRATEL
  9028     ELSE
  9029         MOVE AL-UNNOF           TO ACVRATEA.
  9030
  9031     IF LCVBENEL GREATER THAN ZERO
  9032
  9033* EXEC CICS BIF DEEDIT
  9034*            FIELD (LCVBENEI)
  9035*            LENGTH (11)
  9036*        END-EXEC
  9037     MOVE 11
  9038       TO DFHEIV11
  9039*    MOVE '@"L                   #   #00008657' TO DFHEIV0
  9040     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9041     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9042     MOVE X'2020233030303038363537' TO DFHEIV0(25:11)
  9043     CALL 'kxdfhei1' USING DFHEIV0,
  9044           LCVBENEI,
  9045           DFHEIV11
  9046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9047         IF LCVBENEI IS NUMERIC
  9048            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9049            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9050            MOVE AL-UNNON        TO LCVBENEA
  9051         ELSE
  9052            MOVE ER-0243         TO EMI-ERROR
  9053            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9054            MOVE AL-UNBON        TO LCVBENEA
  9055            MOVE -1              TO LCVBENEL
  9056            MOVE 'X'             TO ERROR-SWITCH
  9057     ELSE
  9058         MOVE AL-UANOF           TO LCVBENEA.
  9059
  9060     IF ACVBENEL GREATER THAN ZERO
  9061
  9062* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 163
* EL131.cbl
  9063*            FIELD (ACVBENEI)
  9064*            LENGTH (11)
  9065*        END-EXEC
  9066     MOVE 11
  9067       TO DFHEIV11
  9068*    MOVE '@"L                   #   #00008675' TO DFHEIV0
  9069     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9070     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9071     MOVE X'2020233030303038363735' TO DFHEIV0(25:11)
  9072     CALL 'kxdfhei1' USING DFHEIV0,
  9073           ACVBENEI,
  9074           DFHEIV11
  9075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9076         IF ACVBENEI IS NUMERIC
  9077            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9078            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9079            MOVE AL-UNNON        TO ACVBENEA
  9080         ELSE
  9081            MOVE ER-0243         TO EMI-ERROR
  9082            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9083            MOVE AL-UNBON        TO ACVBENEA
  9084            MOVE -1              TO ACVBENEL
  9085            MOVE 'X'             TO ERROR-SWITCH
  9086     ELSE
  9087         MOVE AL-UANOF           TO ACVBENEA.
  9088
  9089     IF LCVFORMI GREATER THAN LOW-VALUES
  9090        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9091        MOVE AL-UANON            TO LCVFORMA
  9092     ELSE
  9093        MOVE AL-UANOF            TO LCVFORMA.
  9094
  9095     IF ACVFORMI GREATER THAN LOW-VALUES
  9096        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9097        MOVE AL-UANON            TO ACVFORMA
  9098     ELSE
  9099        MOVE AL-UANOF            TO ACVFORMA.
  9100
  9101     IF LCVCNDTL GREATER THAN ZERO
  9102         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9103         IF LCVCNDTI = SPACES
  9104             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9105         ELSE
  9106             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9107             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9108             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9109             MOVE '4'            TO DC-OPTION-CODE
  9110             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9111             IF NOT DATE-CONVERSION-ERROR
  9112                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9113                 MOVE AL-UANON   TO LCVCNDTA
  9114                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9115                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9116             ELSE
  9117                 MOVE ER-0246    TO EMI-ERROR
  9118                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9119                 MOVE AL-UABON   TO LCVCNDTA
  9120                 MOVE -1         TO LCVCNDTL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 164
* EL131.cbl
  9121                 MOVE 'X'        TO ERROR-SWITCH
  9122     ELSE
  9123         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9124         MOVE AL-UANOF           TO LCVCNDTA.
  9125
  9126     IF ACVCNDTL GREATER THAN ZERO
  9127         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9128         IF ACVCNDTI = SPACES
  9129             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9130         ELSE
  9131             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9132             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9133             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9134             MOVE '4'            TO DC-OPTION-CODE
  9135             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9136             IF NOT DATE-CONVERSION-ERROR
  9137                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9138                 MOVE AL-UANON   TO ACVCNDTA
  9139                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9140                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9141             ELSE
  9142                 MOVE ER-0246    TO EMI-ERROR
  9143                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9144                 MOVE AL-UABON   TO ACVCNDTA
  9145                 MOVE -1         TO ACVCNDTL
  9146                 MOVE 'X'        TO ERROR-SWITCH
  9147     ELSE
  9148         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9149         MOVE AL-UANOF           TO ACVCNDTA.
  9150
  9151     IF APRL GREATER THAN +0
  9152
  9153* EXEC CICS BIF DEEDIT
  9154*            FIELD    (APRI)
  9155*            LENGTH   (8)
  9156*        END-EXEC
  9157     MOVE 8
  9158       TO DFHEIV11
  9159*    MOVE '@"L                   #   #00008755' TO DFHEIV0
  9160     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9161     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9162     MOVE X'2020233030303038373535' TO DFHEIV0(25:11)
  9163     CALL 'kxdfhei1' USING DFHEIV0,
  9164           APRI,
  9165           DFHEIV11
  9166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9167         IF APRI NUMERIC
  9168            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9169            MOVE APRI            TO HOLD-APR APRO
  9170            MOVE AL-UANON        TO APRA
  9171          ELSE
  9172            MOVE ER-0259         TO EMI-ERROR
  9173            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9174            MOVE AL-UABON        TO APRA
  9175            MOVE -1              TO APRL
  9176            MOVE 'X'             TO ERROR-SWITCH
  9177     ELSE
  9178         MOVE AL-UANOF           TO APRA.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 165
* EL131.cbl
  9179
  9180     IF PMTFREQL GREATER THAN ZERO
  9181
  9182* EXEC CICS BIF DEEDIT
  9183*            FIELD    (PMTFREQI)
  9184*            LENGTH   (2)
  9185*        END-EXEC
  9186     MOVE 2
  9187       TO DFHEIV11
  9188*    MOVE '@"L                   #   #00008773' TO DFHEIV0
  9189     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9190     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9191     MOVE X'2020233030303038373733' TO DFHEIV0(25:11)
  9192     CALL 'kxdfhei1' USING DFHEIV0,
  9193           PMTFREQI,
  9194           DFHEIV11
  9195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9196         IF PMTFREQI NUMERIC
  9197            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9198            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9199            MOVE AL-UANON        TO PMTFREQA
  9200          ELSE
  9201            MOVE ER-0427         TO EMI-ERROR
  9202            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9203            MOVE AL-UABON        TO PMTFREQA
  9204            MOVE -1              TO PMTFREQL
  9205            MOVE 'X'             TO ERROR-SWITCH
  9206     ELSE
  9207         MOVE AL-UANOF           TO PMTFREQA.
  9208
  9209     IF INDGRPL GREATER THAN ZERO
  9210         IF INDGRPI = 'I' OR 'G' OR SPACE
  9211             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9212             MOVE AL-UANON       TO INDGRPA
  9213          ELSE
  9214             MOVE ER-0260        TO EMI-ERROR
  9215             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9216             MOVE AL-UABON       TO INDGRPA
  9217             MOVE -1             TO INDGRPL
  9218             MOVE 'X'            TO ERROR-SWITCH
  9219     ELSE
  9220         MOVE AL-UANOF           TO INDGRPA.
  9221
  9222     IF PREMTYPL GREATER THAN ZERO
  9223         IF PREMTYPI = '1' OR '2' OR '3'
  9224            MOVE PREMTYPI        TO PI-PREM-TYPE
  9225            MOVE AL-UNNON        TO PREMTYPA
  9226            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9227          ELSE
  9228            MOVE ER-0227         TO EMI-ERROR
  9229            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9230            MOVE AL-UNBON        TO PREMTYPA
  9231            MOVE -1              TO PREMTYPL
  9232            MOVE 'X'             TO ERROR-SWITCH
  9233     ELSE
  9234         MOVE AL-UANOF           TO PREMTYPA.
  9235
  9236     IF LOANBALL GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 166
* EL131.cbl
  9237
  9238* EXEC CICS BIF DEEDIT
  9239*             FIELD    (LOANBALI)
  9240*             LENGTH   (9)
  9241*        END-EXEC
  9242     MOVE 9
  9243       TO DFHEIV11
  9244*    MOVE '@"L                   #   #00008818' TO DFHEIV0
  9245     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9246     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9247     MOVE X'2020233030303038383138' TO DFHEIV0(25:11)
  9248     CALL 'kxdfhei1' USING DFHEIV0,
  9249           LOANBALI,
  9250           DFHEIV11
  9251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9252         IF LOANBALI NUMERIC
  9253             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9254             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9255             MOVE AL-UNNON TO LOANBALA
  9256         ELSE
  9257             MOVE ER-0639        TO EMI-ERROR
  9258             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9259             MOVE AL-UNBON       TO LOANBALA
  9260             MOVE -1             TO LOANBALL
  9261             MOVE 'X'            TO ERROR-SWITCH
  9262     ELSE
  9263         MOVE AL-UNNOF           TO LOANBALA.
  9264
  9265     IF LOANNOL GREATER THAN ZERO
  9266        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9267        MOVE AL-UANON            TO LOANNOA
  9268     ELSE
  9269        MOVE AL-UANOF            TO LOANNOA.
  9270
  9271     IF REINCDI GREATER THAN LOW-VALUES
  9272        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9273        MOVE AL-UANON            TO REINCDA
  9274     ELSE
  9275        MOVE AL-UANOF            TO REINCDA.
  9276
  9277     IF CERTI GREATER THAN LOW-VALUES
  9278         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9279     ELSE
  9280         MOVE AL-UANOF           TO CERTA.
  9281
  9282     IF CERTEFFI GREATER THAN LOW-VALUES
  9283         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9284     ELSE
  9285         MOVE AL-UANOF           TO CERTEFFA.
  9286
  9287     IF CERTACTI GREATER THAN LOW-VALUES
  9288         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9289     ELSE
  9290         MOVE AL-UANOF           TO CERTACTA.
  9291
  9292     IF CERTSTI GREATER THAN LOW-VALUES
  9293         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9294     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 167
* EL131.cbl
  9295         MOVE AL-UANOF           TO CERTSTA.
  9296
  9297     IF CERTCARI GREATER THAN LOW-VALUES
  9298         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9299     ELSE
  9300         MOVE AL-UANOF           TO CERTCARA.
  9301
  9302     IF DLYACTV-RECORD-NEEDED
  9303         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9304                 1150-EXIT
  9305     END-IF.
  9306
  9307     IF CERTEFFI GREATER LOW-VALUES OR
  9308        CERTACTI GREATER LOW-VALUES OR
  9309        CERTSTI  GREATER LOW-VALUES OR
  9310        CERTCARI GREATER LOW-VALUES OR
  9311        CERTGRPI GREATER LOW-VALUES
  9312        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9313
  9314*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9315*      IF PI-PREM-TYPE NOT = '1'  AND
  9316*         PI-NO-PMTS = ZEROS
  9317*          IF LOANBALL GREATER +0 OR
  9318*             ACVBENEL GREATER +0
  9319*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9320     if not acct-found
  9321        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9322     end-if
  9323     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9324     MOVE PI-CARRIER             TO CARRIER-CODE
  9325     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9326     MOVE PI-CERT-NO             TO CERT-NO
  9327
  9328* EXEC CICS READ
  9329*        DATASET   (CLMS-FILE-ID)
  9330*        RIDFLD    (MSTR-KEY)
  9331*        SET       (ADDRESS OF CLAIM-MASTER)
  9332*        RESP      (WS-RESPONSE)
  9333*    END-EXEC
  9334*    MOVE '&"S        E          (  N#00008897' TO DFHEIV0
  9335     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9336     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9337     MOVE X'204E233030303038383937' TO DFHEIV0(25:11)
  9338     CALL 'kxdfhei1' USING DFHEIV0,
  9339           CLMS-FILE-ID,
  9340           DFHEIV20,
  9341           DFHEIV99,
  9342           MSTR-KEY,
  9343           DFHEIV99,
  9344           DFHEIV99,
  9345           DFHEIV99
  9346     SET ADDRESS OF CLAIM-MASTER TO
  9347         DFHEIV20
  9348     MOVE EIBRESP  TO WS-RESPONSE
  9349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9350     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9351     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9352     MOVE CL-CERT-GROUPING       TO CERT-GROUP
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 168
* EL131.cbl
  9353     MOVE CL-CERT-STATE          TO CERT-STATE
  9354     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9355     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9356     MOVE CL-CERT-NO             TO CERT-CERT
  9357
  9358* EXEC CICS READ
  9359*       DATASET   (CERT-FILE-ID)
  9360*       RIDFLD    (CERT-KEY)
  9361*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9362*       RESP      (WS-RESPONSE)
  9363*    END-EXEC
  9364*    MOVE '&"S        E          (  N#00008910' TO DFHEIV0
  9365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9367     MOVE X'204E233030303038393130' TO DFHEIV0(25:11)
  9368     CALL 'kxdfhei1' USING DFHEIV0,
  9369           CERT-FILE-ID,
  9370           DFHEIV20,
  9371           DFHEIV99,
  9372           CERT-KEY,
  9373           DFHEIV99,
  9374           DFHEIV99,
  9375           DFHEIV99
  9376     SET ADDRESS OF CERTIFICATE-MASTER TO
  9377         DFHEIV20
  9378     MOVE EIBRESP  TO WS-RESPONSE
  9379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9380     if mfnamei > low-values
  9381        move mfnamei to w-name-first
  9382     else
  9383        move cl-insured-1st-name to w-name-first
  9384     end-if
  9385     if mlnamei > low-values
  9386        move mlnamei to w-name-last
  9387     else
  9388        move cl-insured-last-name to w-name-last
  9389     end-if
  9390     if instypel > zeros
  9391        evaluate true
  9392           when cl-no-of-days-paid > zeros
  9393              move er-1668       to emi-error
  9394              perform 9900-error-format
  9395                                 thru 9900-exit
  9396              move al-uabon      to instypea
  9397              move -1            to instypel
  9398              move 'X'           to error-switch
  9399           when instypei = 'C'
  9400              if w-name-first (1:10) = cm-insured-first-name
  9401                 move er-1666    to emi-error
  9402                 PERFORM 9900-ERROR-FORMAT
  9403                                 THRU 9900-EXIT
  9404                 move al-uabon   to instypea
  9405                 move -1         to instypel
  9406                 move 'X'        to error-switch
  9407              end-if
  9408           when instypei = 'P'
  9409              if (w-name-first (1:10) <> cm-insured-first-name)
  9410                 or (w-name-last <> cm-insured-last-name)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 169
* EL131.cbl
  9411                 move er-1676    to emi-error
  9412                 PERFORM 9900-ERROR-FORMAT
  9413                                 THRU 9900-EXIT
  9414                 move al-uabon   to instypea
  9415                 move -1         to instypel
  9416                 move 'X'        to error-switch
  9417              end-if
  9418        end-evaluate
  9419     end-if
  9420*    if (instypel > zeros)
  9421*       and (cl-no-of-days-paid > zero)
  9422*       move er-1668             to emi-error
  9423*       perform 9900-error-format thru 9900-exit
  9424*       move al-uabon            to instypea
  9425*       move -1                  to instypel
  9426*       move 'X'                 to error-switch
  9427*    end-if
  9428*
  9429*    if instypel > zero
  9430*       if instypei = 'C'
  9431*          if w-name-first (1:10) = cm-insured-first-name
  9432*             move er-1666          to emi-error
  9433*             PERFORM 9900-ERROR-FORMAT
  9434*                                   THRU 9900-EXIT
  9435*             move al-uabon         to instypea
  9436*             move -1               to instypel
  9437*             move 'X'              to error-switch
  9438*          end-if
  9439*       end-if
  9440*    end-if
  9441
  9442     if (pi-company-id = 'DCC')
  9443        and (acct-found)
  9444        perform 2120-check-pdef  thru 2120-exit
  9445     end-if
  9446     if benperl > zeros
  9447        move al-uanon            to benpera
  9448     end-if
  9449     if benperl > zeros
  9450        if benperi numeric
  9451           perform 1015-edit-benefit-period
  9452                                 thru 1015-exit
  9453        else
  9454           move er-1669          to emi-error
  9455           PERFORM 9900-ERROR-FORMAT
  9456                                 THRU 9900-EXIT
  9457           move al-uabon         to benpera
  9458           move -1               to benperl
  9459           move 'X'              to error-switch
  9460        end-if
  9461    end-if
  9462     if instypel > zeros
  9463        if instypei = 'P' OR 'C'
  9464           move 'X'              to update-switch
  9465                                    mstr-switch
  9466           move al-uanon         to instypea
  9467        else
  9468            move er-1654          to emi-error
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 170
* EL131.cbl
  9469           PERFORM 9900-ERROR-FORMAT
  9470                                 THRU 9900-EXIT
  9471           move al-uabon         to instypea
  9472           move -1               to instypel
  9473           move 'X'              to error-switch
  9474        end-if
  9475    end-if
  9476     if accswl > zeros
  9477        if accswi = 'Y' OR 'N'
  9478           MOVE 'X'              TO UPDATE-SWITCH
  9479                                    MSTR-SWITCH
  9480           MOVE AL-UANON         TO accswa
  9481*       else
  9482*          move er-1656          to emi-error
  9483*          PERFORM 9900-ERROR-FORMAT
  9484*                                THRU 9900-EXIT
  9485*          move al-uabon         to accswa
  9486*          move -1               to accswl
  9487*          move 'X'              to error-switch
  9488*          move al-uanof         to accswa
  9489        end-if
  9490     end-if
  9491     IF CERTL = ZEROS AND
  9492        SUFXL = ZEROS
  9493          GO TO 1010-EXIT.
  9494
  9495     IF CERTL GREATER THAN ZEROS
  9496         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9497             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9498             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9499             MOVE 'X'            TO ERROR-SWITCH
  9500             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9501
  9502     IF SUFXL GREATER THAN ZEROS
  9503         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9504             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9505             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9506             MOVE 'X'            TO ERROR-SWITCH
  9507             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9508
  9509 1010-EXIT.
  9510     EXIT.
  9511
  9512 1015-edit-benefit-period.
  9513     move ' '                    to ws-benper-sw
  9514     evaluate true
  9515        when not erpdef-found
  9516           set good-benper       to true
  9517        when pd-recurring-yn (a1) = 'Y'
  9518           set good-benper       to true
  9519        when pd-recurring-yn (a1) = 'N'
  9520           if benperi < 02
  9521              set good-benper    to true
  9522           end-if
  9523        when pd-rec-crit-period (a1) numeric
  9524           if benperi <= pd-rec-crit-period (a1)
  9525              set good-benper    to true
  9526           end-if
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 171
* EL131.cbl
  9527     end-evaluate
  9528     MOVE CERT-KEY               TO ELCRTT-KEY
  9529     MOVE 'B'                    TO CTRLR-REC-TYPE
  9530
  9531* EXEC CICS READ
  9532*       DATASET   ('ELCRTT')
  9533*       RIDFLD    (ELCRTT-KEY)
  9534*       INTO      (CERTIFICATE-TRAILERS)
  9535*       RESP      (WS-RESPONSE)
  9536*    END-EXEC
  9537     MOVE LENGTH OF
  9538      CERTIFICATE-TRAILERS
  9539       TO DFHEIV11
  9540     MOVE 'ELCRTT' TO DFHEIV1
  9541*    MOVE '&"IL       E          (  N#00009066' TO DFHEIV0
  9542     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9544     MOVE X'204E233030303039303636' TO DFHEIV0(25:11)
  9545     CALL 'kxdfhei1' USING DFHEIV0,
  9546           DFHEIV1,
  9547           CERTIFICATE-TRAILERS,
  9548           DFHEIV11,
  9549           ELCRTT-KEY,
  9550           DFHEIV99,
  9551           DFHEIV99,
  9552           DFHEIV99
  9553     MOVE EIBRESP  TO WS-RESPONSE
  9554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9555     IF WS-RESP-NORMAL
  9556        perform varying s1 from +1 by +1 until
  9557           (s1 > +24)
  9558           or ((cs-claim-type (s1) = cl-claim-type)
  9559           and (cs-insured-type (s1) = cl-insured-type)
  9560           and (cs-benefit-period (s1) > benperi))
  9561        end-perform
  9562        if s1 < +25
  9563           move er-1665          to emi-error
  9564           PERFORM 9900-ERROR-FORMAT
  9565                                 THRU 9900-EXIT
  9566           move al-uabon         to benpera
  9567           move -1               to benperl
  9568           move 'X'              to error-switch
  9569           go to 1015-exit
  9570*       else
  9571*          set good-benper       to true
  9572        end-if
  9573     end-if
  9574     if good-benper
  9575        move 'X'                 to update-switch
  9576                                    mstr-switch
  9577        move al-uanon            to benpera
  9578     else
  9579        move er-1669             to emi-error
  9580        PERFORM 9900-ERROR-FORMAT
  9581                                 THRU 9900-EXIT
  9582        move al-uabon            to benpera
  9583        move -1                  to benperl
  9584        move 'X'                 to error-switch
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 172
* EL131.cbl
  9585     end-if
  9586     .
  9587 1015-exit.
  9588     exit.
  9589 1120-EDIT-PROC.
  9590     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9591     MOVE '2'                    TO CNTL-REC-TYPE.
  9592     MOVE PROCI                  TO CNTL-PROC-ID.
  9593     MOVE ZERO                   TO CNTL-SEQ-NO.
  9594
  9595
  9596* EXEC CICS HANDLE CONDITION
  9597*         NOTFND    (1120-CNTL-NOTFND)
  9598*    END-EXEC.
  9599*    MOVE '"$I                   ! & #00009112' TO DFHEIV0
  9600     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9602     MOVE X'2620233030303039313132' TO DFHEIV0(25:11)
  9603     CALL 'kxdfhei1' USING DFHEIV0
  9604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9605
  9606
  9607
  9608* EXEC CICS READ
  9609*         SET      (ADDRESS OF CONTROL-FILE)
  9610*         DATASET  (CNTL-FILE-ID)
  9611*         RIDFLD   (CNTL-KEY)
  9612*    END-EXEC.
  9613*    MOVE '&"S        E          (   #00009116' TO DFHEIV0
  9614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9616     MOVE X'2020233030303039313136' TO DFHEIV0(25:11)
  9617     CALL 'kxdfhei1' USING DFHEIV0,
  9618           CNTL-FILE-ID,
  9619           DFHEIV20,
  9620           DFHEIV99,
  9621           CNTL-KEY,
  9622           DFHEIV99,
  9623           DFHEIV99,
  9624           DFHEIV99
  9625     SET ADDRESS OF CONTROL-FILE TO
  9626         DFHEIV20
  9627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9628
  9629
  9630     MOVE AL-UANON               TO PROCA.
  9631     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9632     GO TO 1120-EXIT.
  9633
  9634 1120-CNTL-NOTFND.
  9635     MOVE ER-0273                TO EMI-ERROR.
  9636     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9637     MOVE AL-UABON               TO PROCA.
  9638     MOVE -1                     TO PROCL.
  9639     MOVE 'X'                    TO ERROR-SWITCH.
  9640
  9641 1120-EXIT.
  9642     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 173
* EL131.cbl
  9643
  9644*************************************************************
  9645*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9646*************************************************************
  9647
  9648 1150-OUTPUT-ACTIVITY-RECORD.
  9649
  9650
  9651* EXEC CICS GETMAIN
  9652*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9653*        LENGTH (25)
  9654*        INITIMG (WS-BLANK)
  9655*    END-EXEC.
  9656     MOVE 25
  9657       TO DFHEIV11
  9658*    MOVE ',"IL                  $   #00009142' TO DFHEIV0
  9659     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9660     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9661     MOVE X'2020233030303039313432' TO DFHEIV0(25:11)
  9662     CALL 'kxdfhei1' USING DFHEIV0,
  9663           DFHEIV20,
  9664           DFHEIV11,
  9665           WS-BLANK
  9666     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9667         DFHEIV20
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9669
  9670
  9671     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9672     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9673     MOVE PI-CARRIER             TO DA-CARRIER.
  9674     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9675     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9676     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9677     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9678
  9679
  9680* EXEC CICS HANDLE CONDITION
  9681*        NOTOPEN (1150-NOTOPEN-ERROR)
  9682*        DUPREC (1150-EXIT)
  9683*    END-EXEC.
  9684*    MOVE '"$J%                  ! '' #00009156' TO DFHEIV0
  9685     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9687     MOVE X'2720233030303039313536' TO DFHEIV0(25:11)
  9688     CALL 'kxdfhei1' USING DFHEIV0
  9689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9690
  9691     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9692     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9693     MOVE 'A'                    TO JP-RECORD-TYPE.
  9694     MOVE +48                    TO JOURNAL-LENGTH.
  9695
  9696
  9697* EXEC CICS WRITE
  9698*        DATASET ('DLYACTV')
  9699*        RIDFLD (DA-KEY)
  9700*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 174
* EL131.cbl
  9701*        LENGTH (25)
  9702*    END-EXEC.
  9703     MOVE 'DLYACTV' TO DFHEIV1
  9704     MOVE 25
  9705       TO DFHEIV11
  9706*    MOVE '&$ L                  ''   #00009165' TO DFHEIV0
  9707     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9708     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9709     MOVE X'2020233030303039313635' TO DFHEIV0(25:11)
  9710     CALL 'kxdfhei1' USING DFHEIV0,
  9711           DFHEIV1,
  9712           DAILY-ACTIVITY-RECORD,
  9713           DFHEIV11,
  9714           DA-KEY,
  9715           DFHEIV99,
  9716           DFHEIV99
  9717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9718
  9719
  9720     GO TO 1150-EXIT.
  9721
  9722 1150-NOTOPEN-ERROR.
  9723
  9724     MOVE '2955'                 TO EMI-ERROR.
  9725     MOVE -1                     TO MAINTL.
  9726     MOVE AL-UANON               TO MAINTA.
  9727     MOVE 'X'                    TO ERROR-SWITCH.
  9728     PERFORM 9900-ERROR-FORMAT THRU
  9729             9900-EXIT.
  9730
  9731 1150-EXIT.
  9732     EXIT.
  9733
  9734*************************************************************
  9735*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9736*************************************************************
  9737
  9738 1240-EDIT-LIFE-CODE.
  9739
  9740     IF INVALID-BENEFIT-CODE
  9741         GO TO 1240-SET-ERROR.
  9742
  9743     MOVE SPACES                 TO BENEFIT-KEY.
  9744     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9745     MOVE '4'                    TO BEN-REC-TYPE.
  9746     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9747     MOVE ZERO                   TO BEN-SEQ-NO.
  9748
  9749
  9750* EXEC CICS READ GTEQ
  9751*         DATASET  (CNTL-FILE-ID)
  9752*         RIDFLD   (BENEFIT-KEY)
  9753*         SET      (ADDRESS OF CONTROL-FILE)
  9754*    END-EXEC.
  9755*    MOVE '&"S        G          (   #00009201' TO DFHEIV0
  9756     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9757     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9758     MOVE X'2020233030303039323031' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 175
* EL131.cbl
  9759     CALL 'kxdfhei1' USING DFHEIV0,
  9760           CNTL-FILE-ID,
  9761           DFHEIV20,
  9762           DFHEIV99,
  9763           BENEFIT-KEY,
  9764           DFHEIV99,
  9765           DFHEIV99,
  9766           DFHEIV99
  9767     SET ADDRESS OF CONTROL-FILE TO
  9768         DFHEIV20
  9769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9770
  9771
  9772     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9773        CF-RECORD-TYPE NOT = '4'
  9774         GO TO 1240-SET-ERROR.
  9775
  9776     MOVE ZERO                   TO COUNT-2.
  9777     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9778
  9779     IF SCREEN-ERROR
  9780         GO TO 1240-SET-ERROR.
  9781
  9782 1240-SET-CODE-SWITCHES.
  9783     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9784     MOVE AL-UANON               TO LCVCDA.
  9785     GO TO 1240-EXIT.
  9786
  9787 1240-SET-ERROR.
  9788     MOVE ER-0240                TO EMI-ERROR.
  9789     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9790     MOVE 'X'                    TO ERROR-SWITCH.
  9791     MOVE AL-UABON               TO LCVCDA.
  9792     MOVE -1                     TO LCVCDL.
  9793
  9794 1240-EXIT.
  9795     EXIT.
  9796
  9797 1310-EDIT-AH-CODE.
  9798     IF INVALID-BENEFIT-CODE
  9799         GO TO 1310-SET-ERROR.
  9800
  9801     MOVE SPACES                 TO BENEFIT-KEY.
  9802     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9803     MOVE '5'                    TO BEN-REC-TYPE.
  9804     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9805     MOVE ZERO                   TO BEN-SEQ-NO.
  9806
  9807
  9808* EXEC CICS READ GTEQ
  9809*         DATASET  (CNTL-FILE-ID)
  9810*         RIDFLD   (BENEFIT-KEY)
  9811*         SET      (ADDRESS OF CONTROL-FILE)
  9812*    END-EXEC.
  9813*    MOVE '&"S        G          (   #00009242' TO DFHEIV0
  9814     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9816     MOVE X'2020233030303039323432' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 176
* EL131.cbl
  9817     CALL 'kxdfhei1' USING DFHEIV0,
  9818           CNTL-FILE-ID,
  9819           DFHEIV20,
  9820           DFHEIV99,
  9821           BENEFIT-KEY,
  9822           DFHEIV99,
  9823           DFHEIV99,
  9824           DFHEIV99
  9825     SET ADDRESS OF CONTROL-FILE TO
  9826         DFHEIV20
  9827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9828
  9829
  9830     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9831        CF-RECORD-TYPE NOT = '5'
  9832         GO TO 1310-SET-ERROR.
  9833
  9834     MOVE ZERO                   TO COUNT-2.
  9835     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9836     IF SCREEN-ERROR
  9837         GO TO 1310-SET-ERROR.
  9838
  9839 1310-SET-CODE-SWITCHES.
  9840     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9841     MOVE AL-UANON               TO ACVCDA.
  9842     GO TO 1310-EXIT.
  9843
  9844 1310-SET-ERROR.
  9845     MOVE ER-0250                TO EMI-ERROR.
  9846     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9847     MOVE AL-UABON               TO ACVCDA.
  9848     MOVE 'X'                    TO ERROR-SWITCH.
  9849     MOVE -1                     TO ACVCDL.
  9850
  9851 1310-EXIT.
  9852     EXIT.
  9853
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 177
* EL131.cbl
  9855 1460-EDIT-CERT-NO.
  9856     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9857     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9858
  9859     IF WS-SAVE-CERT-NO = SPACES
  9860         MOVE ER-0203            TO EMI-ERROR
  9861         GO TO 1460-CERT-NO-ERROR.
  9862
  9863     IF WS-CERT-NO-PRIME = SPACES AND
  9864        WS-CERT-NO-SUFX GREATER THAN SPACE
  9865            MOVE ER-0210         TO EMI-ERROR
  9866            GO TO 1460-CERT-NO-ERROR.
  9867
  9868     MOVE 'X'                    TO UPDATE-SWITCH.
  9869     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9870     MOVE AL-UANON               TO CERTA.
  9871
  9872     IF SUFXL IS GREATER THAN 0
  9873         MOVE AL-UANON           TO SUFXA.
  9874
  9875     GO TO 1460-EXIT.
  9876
  9877 1460-CERT-NO-ERROR.
  9878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9879     MOVE AL-UABON               TO SUFXA.
  9880     MOVE AL-UABON               TO CERTA.
  9881     MOVE -1                     TO CERTL.
  9882     MOVE 'X'                    TO ERROR-SWITCH.
  9883
  9884 1460-EXIT.
  9885     EXIT.
  9886
  9887 1470-EDIT-EFF.
  9888     IF CERTEFFI = SPACES
  9889         GO TO 1470-DATE-ERROR.
  9890
  9891     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9892     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9893     IF DEEDIT-DATE = ZERO
  9894         GO TO 1470-DATE-ERROR.
  9895
  9896     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9897     MOVE '4'                    TO DC-OPTION-CODE.
  9898     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9899     IF NOT DATE-CONVERSION-ERROR
  9900         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9901         MOVE AL-UANON           TO CERTEFFA
  9902         MOVE 'X'                TO UPDATE-SWITCH
  9903         MOVE 'Y'                TO CERT-KEY-SWITCH
  9904         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9905         GO TO 1470-EXIT.
  9906
  9907 1470-DATE-ERROR.
  9908     MOVE ER-0215                TO EMI-ERROR.
  9909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9910     MOVE AL-UABON               TO CERTEFFA.
  9911     MOVE -1                     TO CERTEFFL.
  9912     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 178
* EL131.cbl
  9913
  9914 1470-EXIT.
  9915     EXIT.
  9916
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 179
* EL131.cbl
  9918 1480-EDIT-ACCT.
  9919     IF CERTACTI = SPACES
  9920         MOVE ER-0232            TO EMI-ERROR
  9921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9922         MOVE AL-UABON           TO CERTACTA
  9923         MOVE -1                 TO CERTACTL
  9924         MOVE 'X'                TO ERROR-SWITCH
  9925     ELSE
  9926         MOVE 'X'                TO UPDATE-SWITCH
  9927         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9928
  9929 1480-EXIT.
  9930     EXIT.
  9931
  9932 1490-EDIT-STATE.
  9933     IF CERTSTI = SPACES
  9934         MOVE ER-0233            TO EMI-ERROR
  9935         GO TO 1490-STATE-ERROR.
  9936
  9937     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9938     MOVE '3'                    TO CNTL-REC-TYPE.
  9939     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9940     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9941     MOVE ZERO                   TO CNTL-SEQ-NO.
  9942
  9943
  9944* EXEC CICS HANDLE CONDITION
  9945*         NOTFND (1490-STATE-NOTFND)
  9946*    END-EXEC.
  9947*    MOVE '"$I                   ! ( #00009361' TO DFHEIV0
  9948     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9950     MOVE X'2820233030303039333631' TO DFHEIV0(25:11)
  9951     CALL 'kxdfhei1' USING DFHEIV0
  9952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9953
  9954
  9955
  9956* EXEC CICS READ
  9957*         SET        (ADDRESS OF CONTROL-FILE)
  9958*         DATASET    ('ELCNTL')
  9959*         RIDFLD     (CNTL-KEY)
  9960*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9961*         GENERIC
  9962*    END-EXEC.
  9963     MOVE 'ELCNTL' TO DFHEIV1
  9964*    MOVE '&"S  KG    E          (   #00009365' TO DFHEIV0
  9965     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9966     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9967     MOVE X'2020233030303039333635' TO DFHEIV0(25:11)
  9968     CALL 'kxdfhei1' USING DFHEIV0,
  9969           DFHEIV1,
  9970           DFHEIV20,
  9971           DFHEIV99,
  9972           CNTL-KEY,
  9973           CNTL-GENERIC-LENGTH,
  9974           DFHEIV99,
  9975           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 180
* EL131.cbl
  9976     SET ADDRESS OF CONTROL-FILE TO
  9977         DFHEIV20
  9978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9979
  9980
  9981     MOVE AL-UANON               TO CERTSTA.
  9982     MOVE 'X'                    TO UPDATE-SWITCH.
  9983     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9984     GO TO 1490-EXIT.
  9985
  9986 1490-STATE-NOTFND.
  9987     MOVE ER-0149                TO EMI-ERROR.
  9988
  9989 1490-STATE-ERROR.
  9990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9991     MOVE AL-UABON               TO CERTSTA.
  9992     MOVE -1                     TO CERTSTL.
  9993     MOVE 'X'                    TO ERROR-SWITCH.
  9994
  9995 1490-EXIT.
  9996     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 181
* EL131.cbl
  9998 1500-EDIT-CARR.
  9999     IF CERTCARI = SPACES
 10000         GO TO 1500-CARR-NOTFND.
 10001
 10002     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10003     MOVE '6'                    TO CNTL-REC-TYPE.
 10004     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10005     MOVE CERTCARI               TO CNTL-CARRIER.
 10006     MOVE ZERO                   TO CNTL-SEQ-NO.
 10007
 10008
 10009* EXEC CICS HANDLE CONDITION
 10010*         NOTFND   (1500-CARR-NOTFND)
 10011*    END-EXEC.
 10012*    MOVE '"$I                   ! ) #00009400' TO DFHEIV0
 10013     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10015     MOVE X'2920233030303039343030' TO DFHEIV0(25:11)
 10016     CALL 'kxdfhei1' USING DFHEIV0
 10017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10018
 10019
 10020
 10021* EXEC CICS READ
 10022*         SET        (ADDRESS OF CONTROL-FILE)
 10023*         DATASET    ('ELCNTL')
 10024*         RIDFLD     (CNTL-KEY)
 10025*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10026*         GENERIC
 10027*    END-EXEC.
 10028     MOVE 'ELCNTL' TO DFHEIV1
 10029*    MOVE '&"S  KG    E          (   #00009404' TO DFHEIV0
 10030     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10032     MOVE X'2020233030303039343034' TO DFHEIV0(25:11)
 10033     CALL 'kxdfhei1' USING DFHEIV0,
 10034           DFHEIV1,
 10035           DFHEIV20,
 10036           DFHEIV99,
 10037           CNTL-KEY,
 10038           CNTL-GENERIC-LENGTH,
 10039           DFHEIV99,
 10040           DFHEIV99
 10041     SET ADDRESS OF CONTROL-FILE TO
 10042         DFHEIV20
 10043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10044
 10045
 10046     MOVE AL-UANON               TO CERTCARA.
 10047     MOVE 'X'                    TO UPDATE-SWITCH.
 10048     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10049     GO TO 1500-EXIT.
 10050
 10051 1500-CARR-NOTFND.
 10052     MOVE ER-0360                TO EMI-ERROR.
 10053     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10054     MOVE AL-UABON               TO CERTCARA.
 10055     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 182
* EL131.cbl
 10056     MOVE 'X'                    TO ERROR-SWITCH.
 10057
 10058 1500-EXIT.
 10059     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 183
* EL131.cbl
 10061 1510-DEEDIT-DATE.
 10062
 10063* EXEC CICS BIF DEEDIT
 10064*         FIELD    (DEEDIT-DATE-INPUT)
 10065*         LENGTH   (DATE-LENGTH)
 10066*    END-EXEC.
 10067*    MOVE '@"L                   #   #00009428' TO DFHEIV0
 10068     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10069     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10070     MOVE X'2020233030303039343238' TO DFHEIV0(25:11)
 10071     CALL 'kxdfhei1' USING DFHEIV0,
 10072           DEEDIT-DATE-INPUT,
 10073           DATE-LENGTH
 10074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10075
 10076
 10077 1510-EXIT.
 10078     EXIT.
 10079
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 184
* EL131.cbl
 10081 1620-VERIFY-ACCT.
 10082
 10083     move ' '                    to ws-eracct-sw
 10084     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10085     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10086     MOVE PI-GROUPING            TO ACCT-GROUP.
 10087     MOVE PI-STATE               TO ACCT-STATE.
 10088     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10089
 10090     IF CERTEFFI GREATER THAN LOW-VALUES
 10091         MOVE HOLD-EFF           TO ACCT-DATE
 10092     ELSE
 10093         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10094
 10095     IF CERTACTI GREATER THAN LOW-VALUES
 10096         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10097     IF CERTSTI GREATER THAN LOW-VALUES
 10098         MOVE CERTSTI            TO  ACCT-STATE.
 10099     IF CERTCARI GREATER THAN LOW-VALUES
 10100         MOVE CERTCARI           TO  ACCT-CARRIER.
 10101     IF CERTGRPI GREATER THAN LOW-VALUES
 10102         MOVE CERTGRPI           TO ACCT-GROUP.
 10103
 10104     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10105
 10106
 10107* EXEC CICS HANDLE CONDITION
 10108*         NOTFND  (1620-ACCT-NOTFND)
 10109*    END-EXEC.
 10110*    MOVE '"$I                   ! * #00009462' TO DFHEIV0
 10111     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10113     MOVE X'2A20233030303039343632' TO DFHEIV0(25:11)
 10114     CALL 'kxdfhei1' USING DFHEIV0
 10115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10116
 10117
 10118
 10119* EXEC CICS STARTBR
 10120*         DATASET   (ACCT-FILE-ID)
 10121*         RIDFLD    (ACCT-KEY)
 10122*    END-EXEC.
 10123     MOVE 0
 10124       TO DFHEIV11
 10125*    MOVE '&,         G          &   #00009466' TO DFHEIV0
 10126     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10127     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10128     MOVE X'2020233030303039343636' TO DFHEIV0(25:11)
 10129     CALL 'kxdfhei1' USING DFHEIV0,
 10130           ACCT-FILE-ID,
 10131           ACCT-KEY,
 10132           DFHEIV99,
 10133           DFHEIV11,
 10134           DFHEIV99
 10135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10136
 10137
 10138 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 185
* EL131.cbl
 10139
 10140
 10141* EXEC CICS READNEXT
 10142*         DATASET  (ACCT-FILE-ID)
 10143*         RIDFLD   (ACCT-KEY)
 10144*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10145*    END-EXEC.
 10146     MOVE 0
 10147       TO DFHEIV11
 10148*    MOVE '&.S                   )   #00009473' TO DFHEIV0
 10149     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10150     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10151     MOVE X'2020233030303039343733' TO DFHEIV0(25:11)
 10152     CALL 'kxdfhei1' USING DFHEIV0,
 10153           ACCT-FILE-ID,
 10154           DFHEIV20,
 10155           DFHEIV99,
 10156           ACCT-KEY,
 10157           DFHEIV99,
 10158           DFHEIV11,
 10159           DFHEIV99,
 10160           DFHEIV99
 10161     SET ADDRESS OF ACCOUNT-MASTER TO
 10162         DFHEIV20
 10163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10164
 10165
 10166     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10167         GO TO 1620-ACCT-NOTFND.
 10168
 10169     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10170        HOLD-EFF     LESS AM-EXPIRATION-DT
 10171         NEXT SENTENCE
 10172     ELSE
 10173         GO TO 1620-ACCT-LOOP.
 10174
 10175     set acct-found to true
 10176     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10177         GO TO 1620-ACCT-END-BROWSE.
 10178
 10179     IF LOANBALL GREATER THAN +0
 10180         IF AM-MAX-TOT-BEN NUMERIC  AND
 10181            AM-MAX-TOT-BEN GREATER THAN ZERO
 10182             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10183                 MOVE AL-UNBON     TO LOANBALA
 10184                 MOVE -1           TO LOANBALL
 10185                 MOVE 'X'          TO ERROR-SWITCH
 10186                 MOVE ER-7641      TO EMI-ERROR
 10187                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10188
 10189     IF ACVBENEL GREATER THAN +0
 10190         IF AM-MAX-MON-BEN NUMERIC  AND
 10191            AM-MAX-MON-BEN GREATER THAN ZERO
 10192             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10193                 MOVE AL-UNBON     TO ACVBENEA
 10194                 MOVE -1           TO ACVBENEL
 10195                 MOVE 'X'          TO ERROR-SWITCH
 10196                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 186
* EL131.cbl
 10197                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10198
 10199 1620-ACCT-END-BROWSE.
 10200
 10201
 10202* EXEC CICS ENDBR
 10203*         DATASET (ACCT-FILE-ID)
 10204*    END-EXEC.
 10205     MOVE 0
 10206       TO DFHEIV11
 10207*    MOVE '&2                    $   #00009514' TO DFHEIV0
 10208     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10209     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10210     MOVE X'2020233030303039353134' TO DFHEIV0(25:11)
 10211     CALL 'kxdfhei1' USING DFHEIV0,
 10212           ACCT-FILE-ID,
 10213           DFHEIV11,
 10214           DFHEIV99
 10215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10216
 10217
 10218     GO TO 1620-EXIT.
 10219
 10220 1620-ACCT-NOTFND.
 10221
 10222     MOVE -1                     TO MAINTL.
 10223     MOVE 'X'                    TO ERROR-SWITCH.
 10224     MOVE ER-0426                TO EMI-ERROR.
 10225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10226
 10227 1620-EXIT.
 10228     EXIT.
 10229
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 187
* EL131.cbl
 10231 2000-UPDATE-CLAIM.
 10232
 10233     MOVE SPACES                 TO ERROR-SWITCH.
 10234     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10235     MOVE PI-CARRIER             TO CARRIER-CODE.
 10236     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10237     MOVE PI-CERT-NO             TO CERT-NO.
 10238
 10239     IF DELETE-CLAIM
 10240         GO TO 3000-DELETE-CLAIM.
 10241
 10242     IF  NOT MODIFY-CAP
 10243         MOVE ER-0070            TO EMI-ERROR
 10244         MOVE 'X'                TO ERROR-SWITCH
 10245         MOVE -1                 TO MAINTL
 10246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10247         GO TO 2000-EXIT.
 10248
 10249     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10250     MOVE ZERO                   TO TRLR-SEQ-NO.
 10251
 10252
 10253* EXEC CICS READ UPDATE
 10254*         SET       (ADDRESS OF CLAIM-MASTER)
 10255*         DATASET   (CLMS-FILE-ID)
 10256*         RIDFLD    (MSTR-KEY)
 10257*    END-EXEC.
 10258*    MOVE '&"S        EU         (   #00009552' TO DFHEIV0
 10259     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10260     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10261     MOVE X'2020233030303039353532' TO DFHEIV0(25:11)
 10262     CALL 'kxdfhei1' USING DFHEIV0,
 10263           CLMS-FILE-ID,
 10264           DFHEIV20,
 10265           DFHEIV99,
 10266           MSTR-KEY,
 10267           DFHEIV99,
 10268           DFHEIV99,
 10269           DFHEIV99
 10270     SET ADDRESS OF CLAIM-MASTER TO
 10271         DFHEIV20
 10272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10273
 10274
 10275     if (incl > zeros)
 10276        and (cl-no-of-pmts-made > 0)
 10277        and (hold-incur > low-values)
 10278        and (hold-incur not = cl-incurred-dt)
 10279        if hold-incur > cl-incurred-dt
 10280           move cl-incurred-dt   to dc-bin-date-1
 10281           move hold-incur       to dc-bin-date-2
 10282        else
 10283           move hold-incur       to dc-bin-date-1
 10284           move cl-incurred-dt   to dc-bin-date-2
 10285        end-if
 10286        move '1'                 to dc-option-code
 10287        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10288        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 188
* EL131.cbl
 10289           MOVE ER-1663             TO EMI-ERROR
 10290           PERFORM 9900-ERROR-FORMAT
 10291                                 THRU 9900-EXIT
 10292           MOVE -1                  TO MAINTL
 10293           GO TO 8110-SEND-DATA
 10294        end-if
 10295     end-if
 10296     IF (CL-PRIORITY-CD = '8')
 10297        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10298             AND 'AMWA' AND 'KMSB')
 10299        MOVE ER-8003             TO EMI-ERROR
 10300        PERFORM 9900-ERROR-FORMAT
 10301                                 THRU 9900-EXIT
 10302        MOVE -1                  TO MAINTL
 10303        GO TO 8110-SEND-DATA
 10304     END-IF
 10305
 10306     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10307         MOVE ER-0068            TO EMI-ERROR
 10308         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10309         GO TO 2000-EXIT.
 10310
 10311     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10312         MOVE ER-0068            TO EMI-ERROR
 10313         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10314         GO TO 2000-EXIT.
 10315
 10316     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10317         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10318
 10319     IF CL-PURGED-DT NOT = LOW-VALUES
 10320         MOVE ER-7691            TO EMI-ERROR
 10321         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10322         GO TO 2000-EXIT.
 10323
 10324     IF CERT-KEY-CHANGED
 10325         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10326
 10327     IF SCREEN-ERROR
 10328         MOVE ER-0068            TO EMI-ERROR
 10329         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10330         GO TO 2000-EXIT.
 10331
 10332     IF NINETY-TRLR-UPDATED
 10333         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10334
 10335     IF MSTR-KEY-CHANGED
 10336         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10337        ELSE
 10338         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10339
 10340     IF TRLR-UPDATE-REQUIRED
 10341         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10342
 10343 2000-CHECK-CERT.
 10344     IF NOT CERT-UPDATES
 10345         GO TO 2000-EXIT.
 10346
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 189
* EL131.cbl
 10347     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10348     MOVE PI-CARRIER             TO CERT-CARRIER.
 10349     MOVE PI-GROUPING            TO CERT-GROUP.
 10350     MOVE PI-STATE               TO CERT-STATE.
 10351     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10352     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10353     MOVE PI-CERT-NO             TO CERT-CERT.
 10354
 10355     IF CERT-ALT-KEY-CHANGED
 10356         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10357     ELSE
 10358         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10359
 10360 2000-EXIT.
 10361     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 190
* EL131.cbl
 10363 2010-RELEASE-REC.
 10364
 10365* EXEC CICS UNLOCK
 10366*         DATASET  (CLMS-FILE-ID)
 10367*    END-EXEC
 10368*    MOVE '&*                    #   #00009647' TO DFHEIV0
 10369     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10370     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10371     MOVE X'2020233030303039363437' TO DFHEIV0(25:11)
 10372     CALL 'kxdfhei1' USING DFHEIV0,
 10373           CLMS-FILE-ID,
 10374           DFHEIV99
 10375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10376
 10377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10378     MOVE 'X'                    TO ERROR-SWITCH.
 10379
 10380 2010-EXIT.
 10381     EXIT.
 10382
 10383 2020-NORMAL-UPDATE.
 10384     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10385
 10386     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10387
 10388     IF WS-OPEN-CLOSE-SW = 'Y'
 10389       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10390       IF PI-REC-FOUND-SW = 'Y'
 10391         IF CL-ACTIVITY-CODE = 09
 10392           NEXT SENTENCE
 10393         ELSE
 10394           IF WS-RESET-SW = 'Y'
 10395             IF CL-CLAIM-STATUS = 'C'
 10396               MOVE 07               TO  CL-ACTIVITY-CODE
 10397               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10398               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10399             ELSE
 10400               MOVE 08               TO  CL-ACTIVITY-CODE
 10401               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10402               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10403
 10404     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10405         MOVE 'Y'                TO CL-YESNOSW
 10406     END-IF.
 10407
 10408     if pi-company-id = 'DCC'
 10409        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10410        perform 2120-check-pdef  thru 2120-exit
 10411     end-if
 10412     if ((benperl <> zeros)
 10413        and (benperi numeric))
 10414                  or
 10415            (instypel <> zeros)
 10416        perform 2140-update-elcrtt thru 2140-exit
 10417     end-if
 10418
 10419* EXEC CICS HANDLE CONDITION
 10420*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 191
* EL131.cbl
 10421*    END-EXEC.
 10422*    MOVE '"$$                   ! + #00009692' TO DFHEIV0
 10423     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10424     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10425     MOVE X'2B20233030303039363932' TO DFHEIV0(25:11)
 10426     CALL 'kxdfhei1' USING DFHEIV0
 10427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10428
 10429
 10430
 10431* EXEC CICS REWRITE
 10432*         DATASET   (CLMS-FILE-ID)
 10433*         FROM      (CLAIM-MASTER)
 10434*    END-EXEC.
 10435     MOVE LENGTH OF
 10436      CLAIM-MASTER
 10437       TO DFHEIV11
 10438*    MOVE '&& L                  %   #00009696' TO DFHEIV0
 10439     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10440     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10441     MOVE X'2020233030303039363936' TO DFHEIV0(25:11)
 10442     CALL 'kxdfhei1' USING DFHEIV0,
 10443           CLMS-FILE-ID,
 10444           CLAIM-MASTER,
 10445           DFHEIV11,
 10446           DFHEIV99
 10447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10448
 10449
 10450 2020-EXIT.
 10451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 192
* EL131.cbl
 10453 2030-KEY-UPDATE.
 10454     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10455
 10456
 10457* EXEC CICS DELETE
 10458*        DATASET  (CLMS-FILE-ID)
 10459*    END-EXEC.
 10460*    MOVE '&(                    &   #00009707' TO DFHEIV0
 10461     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10462     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10463     MOVE X'2020233030303039373037' TO DFHEIV0(25:11)
 10464     CALL 'kxdfhei1' USING DFHEIV0,
 10465           CLMS-FILE-ID,
 10466           DFHEIV99,
 10467           DFHEIV99,
 10468           DFHEIV99,
 10469           DFHEIV99
 10470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10471
 10472
 10473
 10474* EXEC CICS GETMAIN
 10475*         SET      (ADDRESS OF CLAIM-MASTER)
 10476*         LENGTH   (MSTR-LENGTH)
 10477*         INITIMG  (GETMAIN-SPACE)
 10478*    END-EXEC.
 10479*    MOVE ',"IL                  $   #00009711' TO DFHEIV0
 10480     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10481     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10482     MOVE X'2020233030303039373131' TO DFHEIV0(25:11)
 10483     CALL 'kxdfhei1' USING DFHEIV0,
 10484           DFHEIV20,
 10485           MSTR-LENGTH,
 10486           GETMAIN-SPACE
 10487     SET ADDRESS OF CLAIM-MASTER TO
 10488         DFHEIV20
 10489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10490
 10491
 10492     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10493
 10494     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10495
 10496     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10497
 10498     IF WS-OPEN-CLOSE-SW = 'Y'
 10499       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10500         IF PI-REC-FOUND-SW = 'Y'
 10501           IF CL-ACTIVITY-CODE = 09
 10502             NEXT SENTENCE
 10503           ELSE
 10504             IF WS-RESET-SW = 'Y'
 10505               IF CL-CLAIM-STATUS = 'C'
 10506                 MOVE 07             TO  CL-ACTIVITY-CODE
 10507                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10508                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10509               ELSE
 10510                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 193
* EL131.cbl
 10511                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10512                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10513
 10514
 10515* EXEC CICS HANDLE CONDITION
 10516*         DUPKEY    (2030-EXIT)
 10517*    END-EXEC.
 10518*    MOVE '"$$                   ! , #00009739' TO DFHEIV0
 10519     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10521     MOVE X'2C20233030303039373339' TO DFHEIV0(25:11)
 10522     CALL 'kxdfhei1' USING DFHEIV0
 10523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10524
 10525
 10526** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10527*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10528
 10529     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10530         MOVE 'Y'                TO CL-YESNOSW
 10531     END-IF.
 10532
 10533
 10534* EXEC CICS WRITE
 10535*         DATASET   (CLMS-FILE-ID)
 10536*         RIDFLD    (MSTR-KEY)
 10537*         FROM      (CLAIM-MASTER)
 10538*    END-EXEC.
 10539     MOVE LENGTH OF
 10540      CLAIM-MASTER
 10541       TO DFHEIV11
 10542*    MOVE '&$ L                  ''   #00009750' TO DFHEIV0
 10543     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10544     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10545     MOVE X'2020233030303039373530' TO DFHEIV0(25:11)
 10546     CALL 'kxdfhei1' USING DFHEIV0,
 10547           CLMS-FILE-ID,
 10548           CLAIM-MASTER,
 10549           DFHEIV11,
 10550           MSTR-KEY,
 10551           DFHEIV99,
 10552           DFHEIV99
 10553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10554
 10555
 10556 2030-EXIT.
 10557     EXIT.
 10558
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 194
* EL131.cbl
 10560 2040-NORMAL-UPDATE.
 10561
 10562* EXEC CICS READ UPDATE
 10563*         DATASET  (CERT-FILE-ID)
 10564*         RIDFLD   (CERT-KEY)
 10565*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10566*    END-EXEC.
 10567*    MOVE '&"S        EU         (   #00009761' TO DFHEIV0
 10568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10569     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10570     MOVE X'2020233030303039373631' TO DFHEIV0(25:11)
 10571     CALL 'kxdfhei1' USING DFHEIV0,
 10572           CERT-FILE-ID,
 10573           DFHEIV20,
 10574           DFHEIV99,
 10575           CERT-KEY,
 10576           DFHEIV99,
 10577           DFHEIV99,
 10578           DFHEIV99
 10579     SET ADDRESS OF CERTIFICATE-MASTER TO
 10580         DFHEIV20
 10581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10582
 10583
 10584     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10585
 10586
 10587* EXEC CICS HANDLE CONDITION
 10588*         DUPKEY   (2040-EXIT)
 10589*    END-EXEC.
 10590*    MOVE '"$$                   ! - #00009769' TO DFHEIV0
 10591     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10592     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10593     MOVE X'2D20233030303039373639' TO DFHEIV0(25:11)
 10594     CALL 'kxdfhei1' USING DFHEIV0
 10595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10596
 10597
 10598
 10599* EXEC CICS REWRITE
 10600*         DATASET  (CERT-FILE-ID)
 10601*         FROM     (CERTIFICATE-MASTER)
 10602*    END-EXEC.
 10603     MOVE LENGTH OF
 10604      CERTIFICATE-MASTER
 10605       TO DFHEIV11
 10606*    MOVE '&& L                  %   #00009773' TO DFHEIV0
 10607     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10608     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10609     MOVE X'2020233030303039373733' TO DFHEIV0(25:11)
 10610     CALL 'kxdfhei1' USING DFHEIV0,
 10611           CERT-FILE-ID,
 10612           CERTIFICATE-MASTER,
 10613           DFHEIV11,
 10614           DFHEIV99
 10615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10616
 10617
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 195
* EL131.cbl
 10618 2040-EXIT.
 10619     EXIT.
 10620
 10621 2050-KEY-UPDATE.
 10622
 10623* EXEC CICS READ UPDATE
 10624*         DATASET  (CERT-FILE-ID)
 10625*         RIDFLD   (CERT-KEY)
 10626*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10627*    END-EXEC.
 10628*    MOVE '&"S        EU         (   #00009782' TO DFHEIV0
 10629     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10630     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10631     MOVE X'2020233030303039373832' TO DFHEIV0(25:11)
 10632     CALL 'kxdfhei1' USING DFHEIV0,
 10633           CERT-FILE-ID,
 10634           DFHEIV20,
 10635           DFHEIV99,
 10636           CERT-KEY,
 10637           DFHEIV99,
 10638           DFHEIV99,
 10639           DFHEIV99
 10640     SET ADDRESS OF CERTIFICATE-MASTER TO
 10641         DFHEIV20
 10642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10643
 10644
 10645     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10646
 10647
 10648* EXEC CICS DELETE
 10649*         DATASET   (CERT-FILE-ID)
 10650*    END-EXEC.
 10651*    MOVE '&(                    &   #00009790' TO DFHEIV0
 10652     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10653     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10654     MOVE X'2020233030303039373930' TO DFHEIV0(25:11)
 10655     CALL 'kxdfhei1' USING DFHEIV0,
 10656           CERT-FILE-ID,
 10657           DFHEIV99,
 10658           DFHEIV99,
 10659           DFHEIV99,
 10660           DFHEIV99
 10661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10662
 10663
 10664
 10665* EXEC CICS GETMAIN
 10666*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10667*         LENGTH    (CERT-LENGTH)
 10668*         INITIMG   (GETMAIN-SPACE)
 10669*    END-EXEC.
 10670*    MOVE ',"IL                  $   #00009794' TO DFHEIV0
 10671     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10672     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10673     MOVE X'2020233030303039373934' TO DFHEIV0(25:11)
 10674     CALL 'kxdfhei1' USING DFHEIV0,
 10675           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 196
* EL131.cbl
 10676           CERT-LENGTH,
 10677           GETMAIN-SPACE
 10678     SET ADDRESS OF CERTIFICATE-MASTER TO
 10679         DFHEIV20
 10680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10681
 10682
 10683     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10684
 10685     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10686
 10687
 10688* EXEC CICS HANDLE CONDITION
 10689*         DUPKEY (2050-EXIT)
 10690*    END-EXEC.
 10691*    MOVE '"$$                   ! . #00009804' TO DFHEIV0
 10692     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10694     MOVE X'2E20233030303039383034' TO DFHEIV0(25:11)
 10695     CALL 'kxdfhei1' USING DFHEIV0
 10696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10697
 10698
 10699
 10700* EXEC CICS WRITE
 10701*         DATASET  (CERT-FILE-ID)
 10702*         RIDFLD   (CERT-KEY)
 10703*         FROM     (CERTIFICATE-MASTER)
 10704*    END-EXEC.
 10705     MOVE LENGTH OF
 10706      CERTIFICATE-MASTER
 10707       TO DFHEIV11
 10708*    MOVE '&$ L                  ''   #00009808' TO DFHEIV0
 10709     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10710     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10711     MOVE X'2020233030303039383038' TO DFHEIV0(25:11)
 10712     CALL 'kxdfhei1' USING DFHEIV0,
 10713           CERT-FILE-ID,
 10714           CERTIFICATE-MASTER,
 10715           DFHEIV11,
 10716           CERT-KEY,
 10717           DFHEIV99,
 10718           DFHEIV99
 10719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10720
 10721
 10722 2050-EXIT.
 10723     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 197
* EL131.cbl
 10725 2060-CHANGE-CERT.
 10726     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10727     MOVE PI-CARRIER             TO CERT-CARRIER.
 10728     MOVE PI-GROUPING            TO CERT-GROUP.
 10729     MOVE PI-STATE               TO CERT-STATE.
 10730     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10731     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10732     MOVE PI-CERT-NO             TO CERT-CERT.
 10733     IF CERTEFFI GREATER THAN LOW-VALUES
 10734         MOVE HOLD-EFF           TO CERT-DATE.
 10735     IF CERTACTI GREATER THAN LOW-VALUES
 10736         MOVE CERTACTI           TO CERT-ACCOUNT.
 10737     IF CERTSTI GREATER THAN LOW-VALUES
 10738         MOVE CERTSTI            TO CERT-STATE.
 10739     IF CERTCARI GREATER THAN LOW-VALUES
 10740         MOVE CERTCARI           TO CERT-CARRIER.
 10741     IF CERTGRPI GREATER THAN LOW-VALUES
 10742         MOVE CERTGRPI           TO CERT-GROUP.
 10743     IF CERTI GREATER THAN LOW-VALUES
 10744         MOVE CERTI              TO CERT-CERT-PRIME.
 10745     IF SUFXI GREATER THAN LOW-VALUES
 10746         MOVE SUFXI              TO CERT-CERT-SUFX.
 10747
 10748
 10749* EXEC CICS HANDLE CONDITION
 10750*         NOTFND   (2060-CERT-NOTFND)
 10751*    END-EXEC.
 10752*    MOVE '"$I                   ! / #00009840' TO DFHEIV0
 10753     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10754     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10755     MOVE X'2F20233030303039383430' TO DFHEIV0(25:11)
 10756     CALL 'kxdfhei1' USING DFHEIV0
 10757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10758
 10759
 10760
 10761* EXEC CICS READ UPDATE
 10762*         DATASET  (CERT-FILE-ID)
 10763*         RIDFLD   (CERT-KEY)
 10764*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10765*    END-EXEC.
 10766*    MOVE '&"S        EU         (   #00009844' TO DFHEIV0
 10767     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10768     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10769     MOVE X'2020233030303039383434' TO DFHEIV0(25:11)
 10770     CALL 'kxdfhei1' USING DFHEIV0,
 10771           CERT-FILE-ID,
 10772           DFHEIV20,
 10773           DFHEIV99,
 10774           CERT-KEY,
 10775           DFHEIV99,
 10776           DFHEIV99,
 10777           DFHEIV99
 10778     SET ADDRESS OF CERTIFICATE-MASTER TO
 10779         DFHEIV20
 10780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10781
 10782
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 198
* EL131.cbl
 10783     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10784
 10785     IF CM-CLAIM-INTERFACE-SW = SPACES
 10786        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10787
 10788
 10789* EXEC CICS HANDLE CONDITION
 10790*         DUPKEY   (2060-DUPKEY)
 10791*    END-EXEC.
 10792*    MOVE '"$$                   ! 0 #00009855' TO DFHEIV0
 10793     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10795     MOVE X'3020233030303039383535' TO DFHEIV0(25:11)
 10796     CALL 'kxdfhei1' USING DFHEIV0
 10797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10798
 10799
 10800
 10801* EXEC CICS REWRITE
 10802*         DATASET  (CERT-FILE-ID)
 10803*         FROM     (CERTIFICATE-MASTER)
 10804*    END-EXEC.
 10805     MOVE LENGTH OF
 10806      CERTIFICATE-MASTER
 10807       TO DFHEIV11
 10808*    MOVE '&& L                  %   #00009859' TO DFHEIV0
 10809     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10810     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10811     MOVE X'2020233030303039383539' TO DFHEIV0(25:11)
 10812     CALL 'kxdfhei1' USING DFHEIV0,
 10813           CERT-FILE-ID,
 10814           CERTIFICATE-MASTER,
 10815           DFHEIV11,
 10816           DFHEIV99
 10817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10818
 10819
 10820 2060-DUPKEY.
 10821
 10822     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10823
 10824 2060-CHANGE-TRLR-ACTQ.
 10825     IF SCREEN-ERROR
 10826         GO TO 2060-EXIT.
 10827
 10828     IF CERTI    GREATER LOW-VALUES OR
 10829        SUFXI    GREATER LOW-VALUES OR
 10830        CERTCARI GREATER LOW-VALUES
 10831         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10832         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10833
 10834     MOVE SPACES                 TO CERT-KEY-SWITCH
 10835                                    CERT-SWITCH
 10836                                    TRLR-SWITCH
 10837                                    NINETY-TRLR-SWITCH.
 10838     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10839     GO TO 2060-EXIT.
 10840
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 199
* EL131.cbl
 10841 2060-CERT-NOTFND.
 10842     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10843
 10844     IF WS-REC-FOUND-SW = 'N'
 10845         MOVE ER-0206            TO  EMI-ERROR
 10846         MOVE -1                 TO  MAINTL
 10847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10848
 10849* EXEC CICS UNLOCK
 10850*            DATASET   (CLMS-FILE-ID)
 10851*        END-EXEC
 10852*    MOVE '&*                    #   #00009892' TO DFHEIV0
 10853     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10854     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10855     MOVE X'2020233030303039383932' TO DFHEIV0(25:11)
 10856     CALL 'kxdfhei1' USING DFHEIV0,
 10857           CLMS-FILE-ID,
 10858           DFHEIV99
 10859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10860         GO TO 8110-SEND-DATA.
 10861
 10862     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10863
 10864     GO TO 2060-CHANGE-TRLR-ACTQ.
 10865
 10866 2060-EXIT.
 10867     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 200
* EL131.cbl
 10869 2070-CHECK-OLD.
 10870
 10871
 10872* EXEC CICS HANDLE CONDITION
 10873*        NOTFND   (2070-NOT-FOUND)
 10874*    END-EXEC.
 10875*    MOVE '"$I                   ! 1 #00009906' TO DFHEIV0
 10876     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10878     MOVE X'3120233030303039393036' TO DFHEIV0(25:11)
 10879     CALL 'kxdfhei1' USING DFHEIV0
 10880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10881
 10882
 10883     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10884     MOVE PI-CARRIER             TO CERT-CARRIER.
 10885     MOVE PI-GROUPING            TO CERT-GROUP.
 10886     MOVE PI-STATE               TO CERT-STATE.
 10887     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10888     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10889     MOVE PI-CERT-NO             TO CERT-CERT.
 10890
 10891
 10892* EXEC CICS READ UPDATE
 10893*         DATASET  (CERT-FILE-ID)
 10894*         RIDFLD   (CERT-KEY)
 10895*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10896*    END-EXEC.
 10897*    MOVE '&"S        EU         (   #00009918' TO DFHEIV0
 10898     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10899     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10900     MOVE X'2020233030303039393138' TO DFHEIV0(25:11)
 10901     CALL 'kxdfhei1' USING DFHEIV0,
 10902           CERT-FILE-ID,
 10903           DFHEIV20,
 10904           DFHEIV99,
 10905           CERT-KEY,
 10906           DFHEIV99,
 10907           DFHEIV99,
 10908           DFHEIV99
 10909     SET ADDRESS OF CERTIFICATE-MASTER TO
 10910         DFHEIV20
 10911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10912
 10913
 10914     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10915     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10916     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10917
 10918     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10919         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10920
 10921     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10922       AND
 10923        CERT-WAS-CREATED-FOR-CLAIM
 10924         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10925
 10926* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 201
* EL131.cbl
 10927*             DATASET   (CERT-FILE-ID)
 10928*        END-EXEC
 10929*    MOVE '&(                    &   #00009935' TO DFHEIV0
 10930     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10931     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10932     MOVE X'2020233030303039393335' TO DFHEIV0(25:11)
 10933     CALL 'kxdfhei1' USING DFHEIV0,
 10934           CERT-FILE-ID,
 10935           DFHEIV99,
 10936           DFHEIV99,
 10937           DFHEIV99,
 10938           DFHEIV99
 10939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10940         GO TO 2070-EXIT.
 10941
 10942     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10943         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10944
 10945
 10946* EXEC CICS HANDLE CONDITION
 10947*         DUPKEY   (2070-EXIT)
 10948*    END-EXEC.
 10949*    MOVE '"$$                   ! 2 #00009943' TO DFHEIV0
 10950     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10952     MOVE X'3220233030303039393433' TO DFHEIV0(25:11)
 10953     CALL 'kxdfhei1' USING DFHEIV0
 10954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10955
 10956
 10957
 10958* EXEC CICS REWRITE
 10959*         DATASET  (CERT-FILE-ID)
 10960*         FROM     (CERTIFICATE-MASTER)
 10961*    END-EXEC.
 10962     MOVE LENGTH OF
 10963      CERTIFICATE-MASTER
 10964       TO DFHEIV11
 10965*    MOVE '&& L                  %   #00009947' TO DFHEIV0
 10966     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10967     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10968     MOVE X'2020233030303039393437' TO DFHEIV0(25:11)
 10969     CALL 'kxdfhei1' USING DFHEIV0,
 10970           CERT-FILE-ID,
 10971           CERTIFICATE-MASTER,
 10972           DFHEIV11,
 10973           DFHEIV99
 10974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10975
 10976
 10977     GO TO 2070-EXIT.
 10978
 10979 2070-NOT-FOUND.
 10980     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10981
 10982 2070-EXIT.
 10983     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 202
* EL131.cbl
 10985 2080-CREATE-CERT.
 10986
 10987* EXEC CICS GETMAIN
 10988*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10989*         LENGTH    (CERT-LENGTH)
 10990*         INITIMG   (GETMAIN-SPACE)
 10991*    END-EXEC.
 10992*    MOVE ',"IL                  $   #00009961' TO DFHEIV0
 10993     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10994     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10995     MOVE X'2020233030303039393631' TO DFHEIV0(25:11)
 10996     CALL 'kxdfhei1' USING DFHEIV0,
 10997           DFHEIV20,
 10998           CERT-LENGTH,
 10999           GETMAIN-SPACE
 11000     SET ADDRESS OF CERTIFICATE-MASTER TO
 11001         DFHEIV20
 11002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11003
 11004
 11005     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11006
 11007     IF CERTEFFI GREATER THAN LOW-VALUES
 11008         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11009                                    DC-BIN-DATE-1
 11010         MOVE '6'                TO DC-OPTION-CODE
 11011         MOVE +1                 TO DC-ELAPSED-MONTHS
 11012         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11013         IF NO-CONVERSION-ERROR
 11014             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11015
 11016     IF CERTACTI GREATER THAN LOW-VALUES
 11017         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11018     IF CERTSTI GREATER THAN LOW-VALUES
 11019         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11020     IF CERTCARI GREATER THAN LOW-VALUES
 11021         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11022     IF CERTGRPI GREATER THAN LOW-VALUES
 11023         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11024     IF CERTI GREATER THAN LOW-VALUES
 11025         MOVE CERTI              TO CERT-CERT-PRIME
 11026                                    CM-CERT-PRIME
 11027         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11028
 11029     IF SUFXI GREATER THAN LOW-VALUES
 11030         MOVE SUFXI              TO CERT-CERT-SUFX
 11031                                    CM-CERT-SFX
 11032         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11033
 11034     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11035
 11036     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11037
 11038     MOVE SPACES                 TO CM-ENTRY-BATCH
 11039                                    CM-LF-EXIT-BATCH
 11040                                    CM-AH-EXIT-BATCH
 11041                                    CM-CREDIT-INTERFACE-SW-1
 11042                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 203
* EL131.cbl
 11043
 11044     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11045                               '9' OR 'D' OR 'V'
 11046         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11047
 11048     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11049                               '9' OR 'D' OR 'V'
 11050         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11051
 11052     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11053                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11054     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11055
 11056
 11057* EXEC CICS HANDLE CONDITION
 11058*         DUPKEY (2080-EXIT)
 11059*    END-EXEC.
 11060*    MOVE '"$$                   ! 3 #00010018' TO DFHEIV0
 11061     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11063     MOVE X'3320233030303130303138' TO DFHEIV0(25:11)
 11064     CALL 'kxdfhei1' USING DFHEIV0
 11065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11066
 11067
 11068
 11069* EXEC CICS WRITE
 11070*         DATASET  (CERT-FILE-ID)
 11071*         RIDFLD   (CERT-KEY)
 11072*         FROM     (CERTIFICATE-MASTER)
 11073*    END-EXEC.
 11074     MOVE LENGTH OF
 11075      CERTIFICATE-MASTER
 11076       TO DFHEIV11
 11077*    MOVE '&$ L                  ''   #00010022' TO DFHEIV0
 11078     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11079     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11080     MOVE X'2020233030303130303232' TO DFHEIV0(25:11)
 11081     CALL 'kxdfhei1' USING DFHEIV0,
 11082           CERT-FILE-ID,
 11083           CERTIFICATE-MASTER,
 11084           DFHEIV11,
 11085           CERT-KEY,
 11086           DFHEIV99,
 11087           DFHEIV99
 11088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11089
 11090
 11091 2080-EXIT.
 11092     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 204
* EL131.cbl
 11094 2100-MOVE-MSTR.
 11095     IF TYPEI GREATER THAN LOW-VALUES
 11096         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11097
 11098     IF STATUSI = LOW-VALUES
 11099         GO TO 2100-NO-STATUS-CHANGE.
 11100
 11101     IF STATUSI = 'OPEN' OR 'O'
 11102         IF CL-CLAIM-STATUS = 'O'
 11103             MOVE SPACES         TO TRLR-SWITCH
 11104                 GO TO 2100-NO-STATUS-CHANGE.
 11105
 11106     IF STATUSI = 'CLOSED' OR 'C'
 11107         IF CL-CLAIM-STATUS = 'C'
 11108             MOVE SPACES         TO TRLR-SWITCH
 11109                 GO TO 2100-NO-STATUS-CHANGE.
 11110
 11111     IF PI-COMPANY-ID = 'DMD'
 11112        IF STATUSI = 'OPEN' OR 'O'
 11113           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11114              MOVE ZERO       TO STATUSL
 11115              MOVE LOW-VALUES TO STATUSI
 11116              GO TO 2100-NO-STATUS-CHANGE.
 11117
 11118     IF PI-COMPANY-ID = 'DMD'
 11119         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11120
 11121     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11122
 11123 2100-NO-STATUS-CHANGE.
 11124
 11125     IF CCNOI GREATER THAN LOW-VALUES
 11126         MOVE CCNOI              TO CL-CCN.
 11127
 11128     IF PROCI GREATER THAN LOW-VALUES
 11129         MOVE PROCI              TO CL-PROCESSOR-ID.
 11130
 11131     if (accswi > low-values)
 11132        and (accswi = 'Y' OR 'N')
 11133        move accswi              to cl-accident-claim-sw
 11134     end-if
 11135     if benperi > low-values
 11136        and benperi numeric
 11137        move benperi             to cl-benefit-period
 11138     end-if
 11139     if instypei > low-values
 11140        move instypei            to cl-insured-type
 11141     end-if
 11142     IF SEXI GREATER THAN LOW-VALUES
 11143         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11144
 11145     IF BIRTHI GREATER THAN LOW-VALUES
 11146         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11147
 11148     IF SOCIALI GREATER THAN LOW-VALUES
 11149       AND
 11150        SOCIALI = SPACES
 11151         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 205
* EL131.cbl
 11152         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11153         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11154     ELSE
 11155         IF SOCIALI GREATER THAN LOW-VALUES
 11156             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11157
 11158     IF OCCI GREATER THAN LOW-VALUES
 11159         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11160
 11161     IF BENEL GREATER THAN ZERO
 11162         MOVE BENEI              TO CL-BENEFICIARY.
 11163
 11164     IF DIAGI GREATER THAN LOW-VALUES
 11165         MOVE DIAGI              TO WS-DIAGNOSIS.
 11166
 11167     IF ICD1I GREATER THAN LOW-VALUES
 11168         MOVE ICD1I              TO WS-ICD-CODE-1
 11169     END-IF.
 11170
 11171     IF ICD2I GREATER THAN LOW-VALUES
 11172         MOVE ICD2I              TO WS-ICD-CODE-2
 11173     END-IF.
 11174
 11175     IF PREMTYPI GREATER THAN LOW-VALUES
 11176         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11177
 11178*    IF CAUSEI GREATER THAN LOW-VALUES
 11179*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11180
 11181*    IF ENDI GREATER THAN LOW-VALUES
 11182*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11183
 11184     IF PDTHRUI GREATER THAN LOW-VALUES
 11185        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11186
 11187     IF PDAMTL GREATER THAN +0
 11188        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11189
 11190     IF NODAYSI GREATER THAN LOW-VALUES
 11191        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11192
 11193     IF NOPMTSI GREATER THAN LOW-VALUES
 11194        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11195
 11196     IF FORMTYPI GREATER THAN LOW-VALUES
 11197        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11198
 11199     IF INCI GREATER THAN LOW-VALUES
 11200        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11201
 11202     IF REPI GREATER THAN LOW-VALUES
 11203        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11204
 11205     IF ADDONDTI GREATER THAN LOW-VALUES
 11206        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11207
 11208     IF PRICDI GREATER THAN LOW-VALUES
 11209         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 206
* EL131.cbl
 11210
 11211     IF CRITPL  > ZEROS
 11212        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11213     END-IF
 11214
 11215*    IF CRITPTL > ZEROS
 11216*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11217*    END-IF
 11218
 11219*    IF RTWMOSL > ZEROS
 11220*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11221*    END-IF
 11222     IF FILETOI GREATER THAN LOW-VALUES
 11223         MOVE FILETOI            TO CL-FILE-LOCATION.
 11224
 11225     IF SUPVI GREATER THAN LOW-VALUES
 11226         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11227
 11228     IF MLNAMEI GREATER THAN LOW-VALUES
 11229         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11230
 11231     IF MFNAMEI GREATER THAN LOW-VALUES
 11232         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11233
 11234     IF MMINITI GREATER THAN LOW-VALUES
 11235         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11236
 11237     IF CERTEFFI GREATER THAN LOW-VALUES
 11238         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11239
 11240     IF CERTACTI GREATER THAN LOW-VALUES
 11241         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11242
 11243     IF CERTSTI GREATER THAN LOW-VALUES
 11244         MOVE CERTSTI            TO CL-CERT-STATE.
 11245
 11246     IF CERTCARI GREATER THAN LOW-VALUES
 11247         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11248                                    CL-CARRIER.
 11249
 11250     IF CERTGRPI GREATER THAN LOW-VALUES
 11251         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11252
 11253     IF CERTI GREATER THAN LOW-VALUES
 11254         MOVE CERTI              TO CERT-NO-PRIME.
 11255
 11256     IF SUFXI GREATER THAN LOW-VALUES
 11257         MOVE SUFXI              TO CERT-NO-SUFX.
 11258
 11259     MOVE CERT-NO                TO CL-CERT-NO
 11260                                    CL-CERT-NO-A4.
 11261
 11262     IF PI-COMPANY-ID = 'FLA'
 11263          NEXT SENTENCE
 11264     ELSE
 11265         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11266         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11267         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 207
* EL131.cbl
 11268         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11269
 11270     IF TRLR-UPDATE-REQUIRED
 11271        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11272        MOVE ZEROS              TO TRLR-SEQ-NO
 11273
 11274* EXEC CICS READ
 11275*            DATASET   (TRLR-FILE-ID)
 11276*            RIDFLD    (TRLR-KEY)
 11277*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11278*       END-EXEC
 11279*    MOVE '&"S        E          (   #00010210' TO DFHEIV0
 11280     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11282     MOVE X'2020233030303130323130' TO DFHEIV0(25:11)
 11283     CALL 'kxdfhei1' USING DFHEIV0,
 11284           TRLR-FILE-ID,
 11285           DFHEIV20,
 11286           DFHEIV99,
 11287           TRLR-KEY,
 11288           DFHEIV99,
 11289           DFHEIV99,
 11290           DFHEIV99
 11291     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11292         DFHEIV20
 11293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11294        IF AT-TRAILER-TYPE = '1'
 11295           MOVE +1 TO MISC-SUB
 11296           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11297           MISC-SUB GREATER THAN +6 OR
 11298           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11299           IF MISC-SUB GREATER THAN +1
 11300              SUBTRACT +1 FROM MISC-SUB
 11301              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11302                 GO TO 2100-BYPASS-LAST-UPDATE.
 11303
 11304     IF TRLR-UPDATE-REQUIRED AND
 11305        CLAIM-IS-OPEN
 11306         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11307     ELSE
 11308         IF TRLR-UPDATE-REQUIRED AND
 11309            CLAIM-IS-CLOSED
 11310             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11311             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11312
 11313 2100-BYPASS-LAST-UPDATE.
 11314     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11315     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11316
 11317     GO TO 2100-EXIT.
 11318
 11319 2100-BUMP-OPEN-CLOSE-HIST.
 11320     ADD +1                      TO MISC-SUB.
 11321
 11322 2100-EXIT.
 11323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 208
* EL131.cbl
 11325 2120-check-pdef.
 11326     move +0                     to s1
 11327     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11328     move spaces                 to ws-dcc-error-line
 11329     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11330     IF ERPDEF-FOUND
 11331        perform 2130-check-trlr  thru 2130-exit
 11332        move +1                  to s1
 11333*       if cl-accident-claim-sw = ' '
 11334*          move er-1655             to ws-error-no (s1)
 11335*          add +1 to s1
 11336*       end-if
 11337        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11338        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11339        if (hold-incur > low-values)
 11340           and (incl > zeros)
 11341           and (hold-incur not = cl-incurred-dt)
 11342           move hold-incur       to dc-bin-date-2
 11343        end-if
 11344        MOVE '1'                 TO DC-OPTION-CODE
 11345        MOVE +0                  TO DC-ELAPSED-MONTHS
 11346                                    DC-ELAPSED-DAYS
 11347        PERFORM 9800-CONVERT-DATE
 11348                                 THRU 9800-EXIT
 11349        IF NO-CONVERSION-ERROR
 11350           MOVE DC-ELAPSED-MONTHS
 11351                                 TO WS-MONTHS-BETWEEN
 11352           IF DC-ELAPSED-DAYS > 1
 11353              ADD 1 TO WS-MONTHS-BETWEEN
 11354           END-IF
 11355        ELSE
 11356           display ' dte conv error ' dc-error-code
 11357           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11358        END-IF
 11359        IF (WS-EXCL-PERIOD = ZEROS)
 11360           OR (WS-MONTHS-BETWEEN = ZEROS)
 11361           CONTINUE
 11362        ELSE
 11363           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11364              MOVE ER-1651       TO ws-error-no (s1)
 11365              add +1             to s1
 11366           END-IF
 11367        END-IF
 11368        IF (WS-COV-ENDS = ZEROS)
 11369           OR (WS-MONTHS-BETWEEN = ZEROS)
 11370           CONTINUE
 11371        ELSE
 11372           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11373              MOVE -1            TO MAINTL
 11374              MOVE ER-1653       TO ws-error-no (s1)
 11375              add +1 to s1
 11376           END-IF
 11377        END-IF
 11378        IF (WS-ACC-PERIOD = ZEROS)
 11379           OR (WS-MONTHS-BETWEEN = ZEROS)
 11380           CONTINUE
 11381        ELSE
 11382           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 209
* EL131.cbl
 11383              and (accswi = spaces or low-values)
 11384*             and (cl-accident-claim-sw = ' ')
 11385              move er-1655       to ws-error-no (s1)
 11386              add +1             to s1
 11387           end-if
 11388           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11389*             if (cl-accident-claim-sw not = 'Y')
 11390              if (accswi not = 'Y')
 11391                 MOVE ER-1652    TO ws-error-no (s1)
 11392              else
 11393                 move er-1662    to ws-error-no (s1)
 11394              end-if
 11395              MOVE -1            TO MAINTL
 11396              add +1             to s1
 11397           END-IF
 11398        END-IF
 11399        if cl-claim-type  = 'I'
 11400           move er-1661          to ws-error-no (s1)
 11401           add +1                to s1
 11402        end-if
 11403        perform 2130-check-trlr  thru 2130-exit
 11404     END-IF
 11405
 11406     .
 11407 2120-exit.
 11408     exit.
 11409
 11410 2130-check-trlr.
 11411
 11412     evaluate true
 11413        when s1 = +0
 11414           move cl-control-primary
 11415                                 to trlr-key
 11416           MOVE +95              TO TRLR-SEQ-NO
 11417
 11418* EXEC CICS READ
 11419*             update
 11420*             DATASET  ('ELTRLR')
 11421*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11422*             RIDFLD   (TRLR-KEY)
 11423*             RESP     (WS-RESPONSE)
 11424*          END-EXEC
 11425     MOVE 'ELTRLR' TO DFHEIV1
 11426*    MOVE '&"S        EU         (  N#00010338' TO DFHEIV0
 11427     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11428     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11429     MOVE X'204E233030303130333338' TO DFHEIV0(25:11)
 11430     CALL 'kxdfhei1' USING DFHEIV0,
 11431           DFHEIV1,
 11432           DFHEIV20,
 11433           DFHEIV99,
 11434           TRLR-KEY,
 11435           DFHEIV99,
 11436           DFHEIV99,
 11437           DFHEIV99
 11438     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11439         DFHEIV20
 11440     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 210
* EL131.cbl
 11441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11442           if ws-resp-normal
 11443              move spaces        to at-info-line-1
 11444           end-if
 11445        when s1 = +1
 11446           if ws-resp-normal
 11447
 11448* exec cics rewrite
 11449*                dataset   ('ELTRLR')
 11450*                from      (activity-trailers)
 11451*             end-exec
 11452     MOVE LENGTH OF
 11453      activity-trailers
 11454       TO DFHEIV11
 11455     MOVE 'ELTRLR' TO DFHEIV1
 11456*    MOVE '&& L                  %   #00010350' TO DFHEIV0
 11457     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11458     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11459     MOVE X'2020233030303130333530' TO DFHEIV0(25:11)
 11460     CALL 'kxdfhei1' USING DFHEIV0,
 11461           DFHEIV1,
 11462           activity-trailers,
 11463           DFHEIV11,
 11464           DFHEIV99
 11465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11466           end-if
 11467        when s1 > +1
 11468           if ws-resp-normal
 11469              move ws-dcc-error-line
 11470                                 to at-info-line-1
 11471
 11472* exec cics rewrite
 11473*                dataset   ('ELTRLR')
 11474*                from      (activity-trailers)
 11475*             end-exec
 11476     MOVE LENGTH OF
 11477      activity-trailers
 11478       TO DFHEIV11
 11479     MOVE 'ELTRLR' TO DFHEIV1
 11480*    MOVE '&& L                  %   #00010359' TO DFHEIV0
 11481     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11482     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11483     MOVE X'2020233030303130333539' TO DFHEIV0(25:11)
 11484     CALL 'kxdfhei1' USING DFHEIV0,
 11485           DFHEIV1,
 11486           activity-trailers,
 11487           DFHEIV11,
 11488           DFHEIV99
 11489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11490           else
 11491
 11492* EXEC CICS GETMAIN
 11493*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11494*                LENGTH   (TRLR-LENGTH)
 11495*                INITIMG  (GETMAIN-SPACE)
 11496*             END-EXEC
 11497*    MOVE ',"IL                  $   #00010364' TO DFHEIV0
 11498     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 211
* EL131.cbl
 11499     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11500     MOVE X'2020233030303130333634' TO DFHEIV0(25:11)
 11501     CALL 'kxdfhei1' USING DFHEIV0,
 11502           DFHEIV20,
 11503           TRLR-LENGTH,
 11504           GETMAIN-SPACE
 11505     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11506         DFHEIV20
 11507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11508              move 'AT'          to at-record-id
 11509              move cl-control-primary
 11510                                 to at-control-primary
 11511              move +95           to at-sequence-no
 11512              move '6'           to at-trailer-type
 11513              move ws-dcc-error-line
 11514                                 to at-info-line-1
 11515              move 'E'           to at-info-trailer-type
 11516              move save-bin-date to at-recorded-dt
 11517                                    at-gen-info-last-maint-dt
 11518              move pi-processor-id
 11519                                 to at-recorded-by
 11520                                    at-gen-info-last-updated-by
 11521              move eibtime       to at-last-maint-hhmmss
 11522
 11523* exec cics write
 11524*                dataset   ('ELTRLR')
 11525*                from      (activity-trailers)
 11526*                ridfld    (trlr-key)
 11527*             end-exec
 11528     MOVE LENGTH OF
 11529      activity-trailers
 11530       TO DFHEIV11
 11531     MOVE 'ELTRLR' TO DFHEIV1
 11532*    MOVE '&$ L                  ''   #00010383' TO DFHEIV0
 11533     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11535     MOVE X'2020233030303130333833' TO DFHEIV0(25:11)
 11536     CALL 'kxdfhei1' USING DFHEIV0,
 11537           DFHEIV1,
 11538           activity-trailers,
 11539           DFHEIV11,
 11540           trlr-key,
 11541           DFHEIV99,
 11542           DFHEIV99
 11543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11544              perform varying s1 from +1 by +1 until
 11545                 ws-error-no (s1) = spaces
 11546                 move ws-error-no (s1)
 11547                                 to emi-error
 11548                 PERFORM 9900-ERROR-FORMAT
 11549                                 THRU 9900-EXIT
 11550              end-perform
 11551           end-if
 11552     end-evaluate
 11553
 11554     .
 11555 2130-exit.
 11556     exit.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 212
* EL131.cbl
 11557 2140-update-elcrtt.
 11558     move ' '                    to crtt-switch
 11559     MOVE CERT-KEY               TO ELCRTT-KEY
 11560     MOVE 'B'                    TO CTRLR-REC-TYPE
 11561
 11562* EXEC CICS READ
 11563*       UPDATE
 11564*       DATASET   ('ELCRTT')
 11565*       RIDFLD    (ELCRTT-KEY)
 11566*       INTO      (CERTIFICATE-TRAILERS)
 11567*       RESP      (WS-RESPONSE)
 11568*    END-EXEC
 11569     MOVE LENGTH OF
 11570      CERTIFICATE-TRAILERS
 11571       TO DFHEIV11
 11572     MOVE 'ELCRTT' TO DFHEIV1
 11573*    MOVE '&"IL       EU         (  N#00010405' TO DFHEIV0
 11574     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11575     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11576     MOVE X'204E233030303130343035' TO DFHEIV0(25:11)
 11577     CALL 'kxdfhei1' USING DFHEIV0,
 11578           DFHEIV1,
 11579           CERTIFICATE-TRAILERS,
 11580           DFHEIV11,
 11581           ELCRTT-KEY,
 11582           DFHEIV99,
 11583           DFHEIV99,
 11584           DFHEIV99
 11585     MOVE EIBRESP  TO WS-RESPONSE
 11586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11587     IF WS-RESP-NORMAL
 11588        perform varying s1 from +1 by +1 until
 11589           (s1 > +24)
 11590           or (cs-claim-no (s1) = cl-claim-no)
 11591        end-perform
 11592        if (s1 < +25)
 11593           if (benperl <> zeros)
 11594              and (cs-benefit-period (s1) not = benperi)
 11595              move benperi       to cs-benefit-period (s1)
 11596              set crtt-update    to true
 11597          end-if
 11598          if (instypel <> zeros)
 11599             and (instypei not = cs-insured-type (s1))
 11600             move instypei      to cs-insured-type (s1)
 11601             set crtt-update    to true
 11602          end-if
 11603          move cs-claim-type (s1) to ws-claim-type
 11604          move cs-benefit-period (s1) to ws-ben-per
 11605        end-if
 11606        if crtt-update
 11607           perform 2150-accum    thru 2150-exit
 11608
 11609* EXEC CICS REWRITE
 11610*             DATASET   ('ELCRTT')
 11611*             FROM      (CERTIFICATE-TRAILERS)
 11612*          END-EXEC
 11613     MOVE LENGTH OF
 11614      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 213
* EL131.cbl
 11615       TO DFHEIV11
 11616     MOVE 'ELCRTT' TO DFHEIV1
 11617*    MOVE '&& L                  %   #00010433' TO DFHEIV0
 11618     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11619     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11620     MOVE X'2020233030303130343333' TO DFHEIV0(25:11)
 11621     CALL 'kxdfhei1' USING DFHEIV0,
 11622           DFHEIV1,
 11623           CERTIFICATE-TRAILERS,
 11624           DFHEIV11,
 11625           DFHEIV99
 11626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11627        else
 11628
 11629* exec cics unlock
 11630*             dataset   ('ELCRTT')
 11631*          end-exec
 11632     MOVE 'ELCRTT' TO DFHEIV1
 11633*    MOVE '&*                    #   #00010438' TO DFHEIV0
 11634     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11635     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11636     MOVE X'2020233030303130343338' TO DFHEIV0(25:11)
 11637     CALL 'kxdfhei1' USING DFHEIV0,
 11638           DFHEIV1,
 11639           DFHEIV99
 11640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11641        end-if
 11642     end-if
 11643     .
 11644 2140-exit.
 11645     exit.
 11646 2150-accum.
 11647     if not erpdef-found
 11648        perform 3997-get-erpdef  thru 3997-exit
 11649     end-if
 11650     if (erpdef-found)
 11651        and (ws-max-moben not = zeros)
 11652        and (ws-max-moben < cm-ah-benefit-amt)
 11653        continue
 11654     else
 11655        move cm-ah-benefit-amt   to ws-max-moben
 11656     end-if
 11657     move cm-ah-orig-term        to ws-max-bens
 11658     if cl-critical-period not = zeros and spaces
 11659        move cl-critical-period  to ws-max-bens
 11660     end-if
 11661     move zeros to ws-tot-days-paid ws-tot-amt-paid
 11662     perform varying s2 from +1 by +1 until
 11663        (s2 > +24)
 11664        or (cs-claim-no (s2) = spaces)
 11665        if (cs-benefit-period (s2) = ws-ben-per)
 11666           and (cs-claim-type (s2) = ws-claim-type)
 11667           and (cs-insured-type (s2) = cl-insured-type)
 11668*          compute ws-tot-days-paid =
 11669*             ws-tot-days-paid + cs-days-paid (s2)
 11670           compute ws-tot-amt-paid =
 11671              ws-tot-amt-paid + cs-total-paid (s2)
 11672        end-if
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 214
* EL131.cbl
 11673     end-perform
 11674     if s2 < +25
 11675        compute ws-pd-bens rounded =
 11676           ws-tot-amt-paid / ws-max-moben
 11677        compute cs-remaining-bens (s1) =
 11678           ws-max-bens - ws-pd-bens
 11679        if cs-remaining-bens (s1) < zeros
 11680           move zeros            to cs-remaining-bens (s1)
 11681        end-if
 11682     end-if
 11683     .
 11684 2150-exit.
 11685     exit.
 11686 2200-MOVE-CERT.
 11687     IF CRTLNMEI GREATER THAN LOW-VALUES
 11688         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11689
 11690     IF CRTFNMEI GREATER THAN LOW-VALUES
 11691         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 11692         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11693
 11694     IF CRTINITI GREATER THAN LOW-VALUES
 11695         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11696
 11697     IF CM-INSURED-INITIALS = SPACES
 11698         MOVE '**'               TO CM-INSURED-INITIALS.
 11699
 11700     IF ISSAGEI GREATER THAN LOW-VALUES
 11701         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11702
 11703     IF JNTFNMEI GREATER THAN LOW-VALUES
 11704         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11705
 11706     IF JNTLNMEI GREATER THAN LOW-VALUES
 11707         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11708
 11709     IF JNTINITI GREATER THAN LOW-VALUES
 11710         MOVE JNTINITI           TO CM-JT-INITIAL.
 11711
 11712     IF JNTAGEI GREATER THAN LOW-VALUES
 11713         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11714
 11715     IF ADDONDTI GREATER THAN LOW-VALUES
 11716        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11717
 11718     IF LCVCDI GREATER THAN LOW-VALUES
 11719        IF LCVCDI = SPACES OR ZEROS
 11720           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11721        ELSE
 11722           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11723
 11724     IF LCVOTRMI GREATER THAN LOW-VALUES
 11725         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11726
 11727     IF LCVRATEL GREATER THAN +0
 11728         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11729
 11730     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 215
* EL131.cbl
 11731         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11732
 11733     IF LCVFORMI GREATER THAN LOW-VALUES
 11734         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11735
 11736     IF LCVCNDTI = LOW-VALUES
 11737        GO TO 2210-SET-STATUS.
 11738
 11739     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11740        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11741        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11742        GO TO 2210-SET-STATUS.
 11743
 11744     IF CM-LF-CURRENT-STATUS = '7'
 11745        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11746        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11747        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11748                                    CM-LF-DEATH-DT
 11749        GO TO 2210-SET-STATUS.
 11750
 11751     IF CM-LF-CURRENT-STATUS = '8'
 11752        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11753        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11754                                    CM-LF-CANCEL-DT.
 11755
 11756 2210-SET-STATUS.
 11757
 11758     IF CM-LF-CURRENT-STATUS = SPACES
 11759         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11760
 11761     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11762         MOVE '6'                TO DC-OPTION-CODE
 11763         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11764         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11765         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11766         IF NO-CONVERSION-ERROR
 11767             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11768         ELSE
 11769             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11770     ELSE
 11771         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11772
 11773 2215-PROCESS-AH-SIDE.
 11774
 11775     IF ACVCDI GREATER THAN LOW-VALUES
 11776        IF ACVCDI = SPACES OR ZEROS
 11777           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11778        ELSE
 11779           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11780
 11781     IF ACVOTRMI GREATER THAN LOW-VALUES
 11782         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11783
 11784     IF ACVRATEL GREATER THAN +0
 11785         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11786
 11787     IF ACVBENEL GREATER THAN +0
 11788         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 216
* EL131.cbl
 11789                                    PI-PAYMENT-AMT.
 11790
 11791     IF ACVFORMI GREATER THAN LOW-VALUES
 11792         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11793
 11794     IF ACVCNDTI = LOW-VALUES
 11795        GO TO 2220-SET-STATUS.
 11796
 11797     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11798        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11799        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11800        GO TO 2220-SET-STATUS.
 11801
 11802     IF CM-AH-CURRENT-STATUS = '6'
 11803        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11804                                 TO CM-AH-CURRENT-STATUS
 11805        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11806        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11807                                    CM-AH-SETTLEMENT-DT
 11808        GO TO 2220-SET-STATUS.
 11809
 11810     IF CM-AH-CURRENT-STATUS = '8'
 11811        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11812        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11813                                    CM-AH-CANCEL-DT.
 11814
 11815 2220-SET-STATUS.
 11816     IF CM-AH-CURRENT-STATUS = SPACES
 11817         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11818
 11819     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11820         MOVE '6'                TO DC-OPTION-CODE
 11821         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11822         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11823         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11824         IF NO-CONVERSION-ERROR
 11825             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11826         ELSE
 11827             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11828     ELSE
 11829         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11830
 11831 2225-FINISH-CERT.
 11832     IF APRL GREATER THAN +0
 11833         MOVE HOLD-APR           TO CM-LOAN-APR.
 11834
 11835     IF PMTFREQI GREATER THAN LOW-VALUES
 11836         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11837
 11838     IF INDGRPI GREATER THAN LOW-VALUES
 11839         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11840
 11841     IF LOANNOI GREATER THAN LOW-VALUES
 11842        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11843
 11844     IF LOANBALL GREATER THAN +0
 11845        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11846
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 217
* EL131.cbl
 11847     IF PREMTYPI GREATER THAN LOW-VALUES
 11848         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11849
 11850     IF REINCDI GREATER THAN LOW-VALUES
 11851         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11852                                    WS-REIN-1
 11853                                    WS-REIN-2
 11854                                    WS-REIN-3
 11855         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11856
 11857     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11858
 11859     MOVE ZEROS                  TO CM-LOAN-TERM
 11860                                    CM-LIFE-COMM-PCT
 11861                                    CM-AH-COMM-PCT.
 11862
 11863*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11864*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11865*         PI-NO-PMTS = ZEROS
 11866*          IF LOANBALL GREATER THAN +0          OR
 11867*             ACVBENEL GREATER THAN +0          OR
 11868*             APRL     GREATER THAN +0          OR
 11869*             LCVRATEL GREATER THAN +0          OR
 11870*             ACVRATEL GREATER THAN +0
 11871*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11872
 11873 2200-EXIT.
 11874     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 218
* EL131.cbl
 11876 2300-UPDATE-TRLR.
 11877     MOVE ZERO                   TO TRLR-SEQ-NO.
 11878
 11879* EXEC CICS READ UPDATE
 11880*         DATASET  (TRLR-FILE-ID)
 11881*         RIDFLD   (TRLR-KEY)
 11882*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11883*    END-EXEC.
 11884*    MOVE '&"S        EU         (   #00010678' TO DFHEIV0
 11885     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11886     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11887     MOVE X'2020233030303130363738' TO DFHEIV0(25:11)
 11888     CALL 'kxdfhei1' USING DFHEIV0,
 11889           TRLR-FILE-ID,
 11890           DFHEIV20,
 11891           DFHEIV99,
 11892           TRLR-KEY,
 11893           DFHEIV99,
 11894           DFHEIV99,
 11895           DFHEIV99
 11896     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11897         DFHEIV20
 11898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11899
 11900
 11901     MOVE ZERO                   TO COUNT-2.
 11902
 11903     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11904         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11905
 11906     IF NOT UPDATE-MADE
 11907         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11908
 11909
 11910* EXEC CICS REWRITE
 11911*         DATASET  (TRLR-FILE-ID)
 11912*         FROM     (ACTIVITY-TRAILERS)
 11913*    END-EXEC.
 11914     MOVE LENGTH OF
 11915      ACTIVITY-TRAILERS
 11916       TO DFHEIV11
 11917*    MOVE '&& L                  %   #00010692' TO DFHEIV0
 11918     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11919     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11920     MOVE X'2020233030303130363932' TO DFHEIV0(25:11)
 11921     CALL 'kxdfhei1' USING DFHEIV0,
 11922           TRLR-FILE-ID,
 11923           ACTIVITY-TRAILERS,
 11924           DFHEIV11,
 11925           DFHEIV99
 11926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11927
 11928
 11929 2300-EXIT.
 11930     EXIT.
 11931
 11932 2310-INS-STATUS.
 11933     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 219
* EL131.cbl
 11934     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11935         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11936         MOVE 'Y'                TO TRLR-SWITCH.
 11937
 11938 2310-EXIT.
 11939     EXIT.
 11940
 11941 2320-SHIFT-STATUS.
 11942     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11943        MOVE 6                   TO COUNT-2
 11944        GO TO 2320-EXIT.
 11945
 11946     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11947     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11948     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11949     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11950     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11951     MOVE 6       TO COUNT-2.
 11952     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11953
 11954 2320-EXIT.
 11955     EXIT.
 11956
 11957 2330-ADD-UPDATE.
 11958
 11959     IF COUNT-2 GREATER THAN 1
 11960        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11961        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11962           GO TO 2330-EXIT.
 11963
 11964     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11965                                   AT-RESERVES-LAST-MAINT-DT
 11966
 11967     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11968     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11969     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11970     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11971
 11972 2330-EXIT.
 11973     EXIT.
 11974
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 220
* EL131.cbl
 11976 2400-UPDATE-TRLR.
 11977
 11978* EXEC CICS HANDLE CONDITION
 11979*         NOTFND    (2400-TRLR-NOTFND)
 11980*         ENDFILE   (2410-EXIT)
 11981*    END-EXEC.
 11982*    MOVE '"$I''                  ! 4 #00010745' TO DFHEIV0
 11983     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11984     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11985     MOVE X'3420233030303130373435' TO DFHEIV0(25:11)
 11986     CALL 'kxdfhei1' USING DFHEIV0
 11987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11988
 11989
 11990
 11991* EXEC CICS STARTBR
 11992*        DATASET (TRLR-FILE-ID)
 11993*        RIDFLD  (TRLR-KEY)
 11994*    END-EXEC.
 11995     MOVE 0
 11996       TO DFHEIV11
 11997*    MOVE '&,         G          &   #00010750' TO DFHEIV0
 11998     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11999     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12000     MOVE X'2020233030303130373530' TO DFHEIV0(25:11)
 12001     CALL 'kxdfhei1' USING DFHEIV0,
 12002           TRLR-FILE-ID,
 12003           TRLR-KEY,
 12004           DFHEIV99,
 12005           DFHEIV11,
 12006           DFHEIV99
 12007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12008
 12009
 12010
 12011* EXEC CICS GETMAIN
 12012*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12013*         LENGTH    (TRLR-LENGTH)
 12014*         INITIMG   (GETMAIN-SPACE)
 12015*    END-EXEC.
 12016*    MOVE ',"IL                  $   #00010755' TO DFHEIV0
 12017     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12018     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12019     MOVE X'2020233030303130373535' TO DFHEIV0(25:11)
 12020     CALL 'kxdfhei1' USING DFHEIV0,
 12021           DFHEIV20,
 12022           TRLR-LENGTH,
 12023           GETMAIN-SPACE
 12024     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12025         DFHEIV20
 12026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12027
 12028
 12029     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12030
 12031
 12032* EXEC CICS ENDBR
 12033*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 221
* EL131.cbl
 12034*    END-EXEC.
 12035     MOVE 0
 12036       TO DFHEIV11
 12037*    MOVE '&2                    $   #00010763' TO DFHEIV0
 12038     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12039     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12040     MOVE X'2020233030303130373633' TO DFHEIV0(25:11)
 12041     CALL 'kxdfhei1' USING DFHEIV0,
 12042           TRLR-FILE-ID,
 12043           DFHEIV11,
 12044           DFHEIV99
 12045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12046
 12047
 12048     GO TO 2400-EXIT.
 12049
 12050 2400-TRLR-NOTFND.
 12051     MOVE ER-0205                TO EMI-ERROR.
 12052     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12053     MOVE 'X'                    TO ERROR-SWITCH.
 12054
 12055 2400-EXIT.
 12056     EXIT.
 12057
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 222
* EL131.cbl
 12059 2410-CHANGE-TRLR.
 12060
 12061* EXEC CICS READNEXT
 12062*        DATASET (TRLR-FILE-ID)
 12063*        RIDFLD  (TRLR-KEY)
 12064*        INTO    (ACTIVITY-TRAILERS)
 12065*    END-EXEC.
 12066     MOVE LENGTH OF
 12067      ACTIVITY-TRAILERS
 12068       TO DFHEIV12
 12069     MOVE 0
 12070       TO DFHEIV11
 12071*    MOVE '&.IL                  )   #00010779' TO DFHEIV0
 12072     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12073     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12074     MOVE X'2020233030303130373739' TO DFHEIV0(25:11)
 12075     CALL 'kxdfhei1' USING DFHEIV0,
 12076           TRLR-FILE-ID,
 12077           ACTIVITY-TRAILERS,
 12078           DFHEIV12,
 12079           TRLR-KEY,
 12080           DFHEIV99,
 12081           DFHEIV11,
 12082           DFHEIV99,
 12083           DFHEIV99
 12084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12085
 12086
 12087     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12088        GO TO 2410-CHANGE-TRLR.
 12089
 12090     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12091                                    CHECK-KEY.
 12092
 12093     IF CHECK-KEY NOT = MSTR-KEY
 12094         GO TO 2410-EXIT.
 12095
 12096
 12097* EXEC CICS ENDBR
 12098*        DATASET (TRLR-FILE-ID)
 12099*    END-EXEC.
 12100     MOVE 0
 12101       TO DFHEIV11
 12102*    MOVE '&2                    $   #00010794' TO DFHEIV0
 12103     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12104     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12105     MOVE X'2020233030303130373934' TO DFHEIV0(25:11)
 12106     CALL 'kxdfhei1' USING DFHEIV0,
 12107           TRLR-FILE-ID,
 12108           DFHEIV11,
 12109           DFHEIV99
 12110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12111
 12112
 12113
 12114* EXEC CICS READ UPDATE
 12115*        DATASET (TRLR-FILE-ID)
 12116*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 223
* EL131.cbl
 12117*        INTO    (ACTIVITY-TRAILERS)
 12118*    END-EXEC.
 12119     MOVE LENGTH OF
 12120      ACTIVITY-TRAILERS
 12121       TO DFHEIV11
 12122*    MOVE '&"IL       EU         (   #00010798' TO DFHEIV0
 12123     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12124     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12125     MOVE X'2020233030303130373938' TO DFHEIV0(25:11)
 12126     CALL 'kxdfhei1' USING DFHEIV0,
 12127           TRLR-FILE-ID,
 12128           ACTIVITY-TRAILERS,
 12129           DFHEIV11,
 12130           TRLR-KEY,
 12131           DFHEIV99,
 12132           DFHEIV99,
 12133           DFHEIV99
 12134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12135
 12136
 12137
 12138* EXEC CICS DELETE
 12139*        DATASET (TRLR-FILE-ID)
 12140*    END-EXEC.
 12141*    MOVE '&(                    &   #00010804' TO DFHEIV0
 12142     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12143     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12144     MOVE X'2020233030303130383034' TO DFHEIV0(25:11)
 12145     CALL 'kxdfhei1' USING DFHEIV0,
 12146           TRLR-FILE-ID,
 12147           DFHEIV99,
 12148           DFHEIV99,
 12149           DFHEIV99,
 12150           DFHEIV99
 12151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12152
 12153
 12154     IF AT-SEQUENCE-NO = ZERO AND
 12155        TRLR-UPDATE-REQUIRED
 12156         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12157
 12158     IF CERTI GREATER THAN LOW-VALUES
 12159        MOVE CERTI               TO AT-CERT-PRIME.
 12160
 12161     IF SUFXI GREATER THAN LOW-VALUES
 12162        MOVE SUFXI               TO AT-CERT-SFX.
 12163
 12164     IF CERTCARI GREATER THAN LOW-VALUES
 12165        MOVE CERTCARI            TO AT-CARRIER.
 12166
 12167     IF PAYMENT-TR
 12168        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12169           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12170              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12171
 12172     IF CORRESPONDENCE-TR
 12173        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12174           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 224
* EL131.cbl
 12175
 12176
 12177* EXEC CICS WRITE
 12178*         DATASET  (TRLR-FILE-ID)
 12179*         RIDFLD   (AT-CONTROL-PRIMARY)
 12180*         FROM     (ACTIVITY-TRAILERS)
 12181*    END-EXEC.
 12182     MOVE LENGTH OF
 12183      ACTIVITY-TRAILERS
 12184       TO DFHEIV11
 12185*    MOVE '&$ L                  ''   #00010830' TO DFHEIV0
 12186     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12187     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12188     MOVE X'2020233030303130383330' TO DFHEIV0(25:11)
 12189     CALL 'kxdfhei1' USING DFHEIV0,
 12190           TRLR-FILE-ID,
 12191           ACTIVITY-TRAILERS,
 12192           DFHEIV11,
 12193           AT-CONTROL-PRIMARY,
 12194           DFHEIV99,
 12195           DFHEIV99
 12196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12197
 12198
 12199
 12200* EXEC CICS STARTBR
 12201*         DATASET  (TRLR-FILE-ID)
 12202*         RIDFLD   (TRLR-KEY)
 12203*    END-EXEC.
 12204     MOVE 0
 12205       TO DFHEIV11
 12206*    MOVE '&,         G          &   #00010836' TO DFHEIV0
 12207     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12208     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12209     MOVE X'2020233030303130383336' TO DFHEIV0(25:11)
 12210     CALL 'kxdfhei1' USING DFHEIV0,
 12211           TRLR-FILE-ID,
 12212           TRLR-KEY,
 12213           DFHEIV99,
 12214           DFHEIV11,
 12215           DFHEIV99
 12216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12217
 12218
 12219     GO TO 2410-CHANGE-TRLR.
 12220
 12221 2410-EXIT.
 12222     EXIT.
 12223
 12224 2420-UPDATE-TRLR.
 12225     MOVE ZERO TO COUNT-2.
 12226     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12227         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12228
 12229     IF NOT UPDATE-MADE
 12230         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12231
 12232 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 225
* EL131.cbl
 12233     EXIT.
 12234
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 226
* EL131.cbl
 12236 2425-UPDATE-NINETY-TRLR.
 12237
 12238     MOVE +90                    TO TRLR-SEQ-NO.
 12239
 12240
 12241* EXEC CICS HANDLE CONDITION
 12242*         NOTFND    (2425-NINETY-NOTFND)
 12243*         ENDFILE   (2425-NINETY-NOTFND)
 12244*    END-EXEC.
 12245*    MOVE '"$I''                  ! 5 #00010862' TO DFHEIV0
 12246     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12248     MOVE X'3520233030303130383632' TO DFHEIV0(25:11)
 12249     CALL 'kxdfhei1' USING DFHEIV0
 12250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12251
 12252
 12253
 12254* EXEC CICS READ UPDATE
 12255*        DATASET (TRLR-FILE-ID)
 12256*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12257*        RIDFLD  (TRLR-KEY)
 12258*    END-EXEC.
 12259*    MOVE '&"S        EU         (   #00010867' TO DFHEIV0
 12260     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12261     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12262     MOVE X'2020233030303130383637' TO DFHEIV0(25:11)
 12263     CALL 'kxdfhei1' USING DFHEIV0,
 12264           TRLR-FILE-ID,
 12265           DFHEIV20,
 12266           DFHEIV99,
 12267           TRLR-KEY,
 12268           DFHEIV99,
 12269           DFHEIV99,
 12270           DFHEIV99
 12271     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12272         DFHEIV20
 12273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12274
 12275
 12276     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 12277     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12278     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12279
 12280     IF DIAGI GREATER THAN LOW-VALUES
 12281         MOVE DIAGI             TO AT-INFO-LINE-1
 12282     END-IF.
 12283
 12284     IF ICD1I GREATER THAN LOW-VALUES
 12285         MOVE ICD1I             TO AT-ICD-CODE-1
 12286     END-IF.
 12287
 12288     IF ICD2I GREATER THAN LOW-VALUES
 12289         MOVE ICD2I             TO AT-ICD-CODE-2
 12290     END-IF.
 12291
 12292
 12293* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 227
* EL131.cbl
 12294*        DATASET (TRLR-FILE-ID)
 12295*        FROM    (ACTIVITY-TRAILERS)
 12296*    END-EXEC.
 12297     MOVE LENGTH OF
 12298      ACTIVITY-TRAILERS
 12299       TO DFHEIV11
 12300*    MOVE '&& L                  %   #00010889' TO DFHEIV0
 12301     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12302     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12303     MOVE X'2020233030303130383839' TO DFHEIV0(25:11)
 12304     CALL 'kxdfhei1' USING DFHEIV0,
 12305           TRLR-FILE-ID,
 12306           ACTIVITY-TRAILERS,
 12307           DFHEIV11,
 12308           DFHEIV99
 12309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12310
 12311
 12312     IF DIAGI GREATER THAN LOW-VALUES
 12313       AND DIAGI NOT = WS-DIAGNOSIS
 12314         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12315         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12316         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12317
 12318     IF ICD1I GREATER THAN LOW-VALUES
 12319       AND ICD1I NOT = WS-ICD-CODE-1
 12320         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12321         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12322         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12323     END-IF.
 12324
 12325     IF ICD2I GREATER THAN LOW-VALUES
 12326       AND ICD2I NOT = WS-ICD-CODE-2
 12327         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12328         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12329         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12330     END-IF.
 12331
 12332     GO TO 2425-EXIT.
 12333
 12334 2425-NINETY-NOTFND.
 12335
 12336
 12337* EXEC CICS GETMAIN
 12338*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12339*         LENGTH    (TRLR-LENGTH)
 12340*         INITIMG   (GETMAIN-SPACE)
 12341*    END-EXEC.
 12342*    MOVE ',"IL                  $   #00010918' TO DFHEIV0
 12343     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12344     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12345     MOVE X'2020233030303130393138' TO DFHEIV0(25:11)
 12346     CALL 'kxdfhei1' USING DFHEIV0,
 12347           DFHEIV20,
 12348           TRLR-LENGTH,
 12349           GETMAIN-SPACE
 12350     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12351         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 228
* EL131.cbl
 12352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12353
 12354
 12355     MOVE +90                  TO TRLR-SEQ-NO.
 12356     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12357
 12358     MOVE 'AT'                 TO AT-RECORD-ID
 12359     MOVE '6'                  TO AT-TRAILER-TYPE
 12360     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12361                                  AT-GEN-INFO-LAST-MAINT-DT
 12362     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12363                                  AT-GEN-INFO-LAST-UPDATED-BY
 12364     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12365     MOVE DIAGI                TO AT-INFO-LINE-1.
 12366     MOVE ICD1I                TO AT-ICD-CODE-1.
 12367     MOVE ICD2I                TO AT-ICD-CODE-2.
 12368
 12369
 12370* EXEC CICS WRITE
 12371*        DATASET (TRLR-FILE-ID)
 12372*        FROM    (ACTIVITY-TRAILERS)
 12373*        RIDFLD  (TRLR-KEY)
 12374*    END-EXEC.
 12375     MOVE LENGTH OF
 12376      ACTIVITY-TRAILERS
 12377       TO DFHEIV11
 12378*    MOVE '&$ L                  ''   #00010938' TO DFHEIV0
 12379     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12380     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12381     MOVE X'2020233030303130393338' TO DFHEIV0(25:11)
 12382     CALL 'kxdfhei1' USING DFHEIV0,
 12383           TRLR-FILE-ID,
 12384           ACTIVITY-TRAILERS,
 12385           DFHEIV11,
 12386           TRLR-KEY,
 12387           DFHEIV99,
 12388           DFHEIV99
 12389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12390
 12391
 12392 2425-EXIT.
 12393     EXIT.
 12394
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 229
* EL131.cbl
 12396 2430-UPDATE-ACTQ.
 12397
 12398* EXEC CICS HANDLE CONDITION
 12399*         NOTFND    (2430-EXIT)
 12400*         ENDFILE   (2440-EXIT)
 12401*    END-EXEC.
 12402*    MOVE '"$I''                  ! 6 #00010949' TO DFHEIV0
 12403     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12405     MOVE X'3620233030303130393439' TO DFHEIV0(25:11)
 12406     CALL 'kxdfhei1' USING DFHEIV0
 12407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12408
 12409
 12410
 12411* EXEC CICS STARTBR
 12412*         DATASET  (ACTQ-FILE-ID)
 12413*         RIDFLD   (ACTQ-KEY)
 12414*    END-EXEC.
 12415     MOVE 0
 12416       TO DFHEIV11
 12417*    MOVE '&,         G          &   #00010954' TO DFHEIV0
 12418     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12419     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12420     MOVE X'2020233030303130393534' TO DFHEIV0(25:11)
 12421     CALL 'kxdfhei1' USING DFHEIV0,
 12422           ACTQ-FILE-ID,
 12423           ACTQ-KEY,
 12424           DFHEIV99,
 12425           DFHEIV11,
 12426           DFHEIV99
 12427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12428
 12429
 12430
 12431* EXEC CICS GETMAIN
 12432*         SET      (ADDRESS OF ACTIVITY-QUE)
 12433*         LENGTH   (ACTQ-LENGTH)
 12434*         INITIMG  (GETMAIN-SPACE)
 12435*    END-EXEC.
 12436*    MOVE ',"IL                  $   #00010959' TO DFHEIV0
 12437     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12438     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12439     MOVE X'2020233030303130393539' TO DFHEIV0(25:11)
 12440     CALL 'kxdfhei1' USING DFHEIV0,
 12441           DFHEIV20,
 12442           ACTQ-LENGTH,
 12443           GETMAIN-SPACE
 12444     SET ADDRESS OF ACTIVITY-QUE TO
 12445         DFHEIV20
 12446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12447
 12448
 12449     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12450
 12451 2430-EXIT.
 12452     EXIT.
 12453
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 230
* EL131.cbl
 12454 2440-CHANGE-ACTQ.
 12455
 12456
 12457* EXEC CICS READNEXT
 12458*         DATASET  (ACTQ-FILE-ID)
 12459*         RIDFLD   (ACTQ-KEY)
 12460*         INTO     (ACTIVITY-QUE)
 12461*    END-EXEC.
 12462     MOVE LENGTH OF
 12463      ACTIVITY-QUE
 12464       TO DFHEIV12
 12465     MOVE 0
 12466       TO DFHEIV11
 12467*    MOVE '&.IL                  )   #00010972' TO DFHEIV0
 12468     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12469     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12470     MOVE X'2020233030303130393732' TO DFHEIV0(25:11)
 12471     CALL 'kxdfhei1' USING DFHEIV0,
 12472           ACTQ-FILE-ID,
 12473           ACTIVITY-QUE,
 12474           DFHEIV12,
 12475           ACTQ-KEY,
 12476           DFHEIV99,
 12477           DFHEIV11,
 12478           DFHEIV99,
 12479           DFHEIV99
 12480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12481
 12482
 12483
 12484* EXEC CICS ENDBR
 12485*         DATASET (ACTQ-FILE-ID)
 12486*    END-EXEC.
 12487     MOVE 0
 12488       TO DFHEIV11
 12489*    MOVE '&2                    $   #00010978' TO DFHEIV0
 12490     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12491     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12492     MOVE X'2020233030303130393738' TO DFHEIV0(25:11)
 12493     CALL 'kxdfhei1' USING DFHEIV0,
 12494           ACTQ-FILE-ID,
 12495           DFHEIV11,
 12496           DFHEIV99
 12497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12498
 12499
 12500     IF ACTQ-KEY NOT = MSTR-KEY
 12501         GO TO 2440-EXIT.
 12502
 12503
 12504* EXEC CICS READ UPDATE
 12505*         DATASET  (ACTQ-FILE-ID)
 12506*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12507*         SET      (ADDRESS OF ACTIVITY-QUE)
 12508*    END-EXEC.
 12509*    MOVE '&"S        EU         (   #00010985' TO DFHEIV0
 12510     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12511     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 231
* EL131.cbl
 12512     MOVE X'2020233030303130393835' TO DFHEIV0(25:11)
 12513     CALL 'kxdfhei1' USING DFHEIV0,
 12514           ACTQ-FILE-ID,
 12515           DFHEIV20,
 12516           DFHEIV99,
 12517           AQ-CONTROL-PRIMARY,
 12518           DFHEIV99,
 12519           DFHEIV99,
 12520           DFHEIV99
 12521     SET ADDRESS OF ACTIVITY-QUE TO
 12522         DFHEIV20
 12523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12524
 12525
 12526     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12527
 12528
 12529* EXEC CICS DELETE
 12530*         DATASET (ACTQ-FILE-ID)
 12531*    END-EXEC.
 12532*    MOVE '&(                    &   #00010993' TO DFHEIV0
 12533     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12534     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12535     MOVE X'2020233030303130393933' TO DFHEIV0(25:11)
 12536     CALL 'kxdfhei1' USING DFHEIV0,
 12537           ACTQ-FILE-ID,
 12538           DFHEIV99,
 12539           DFHEIV99,
 12540           DFHEIV99,
 12541           DFHEIV99
 12542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12543
 12544
 12545     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12546     IF CERTI GREATER THAN LOW-VALUES
 12547        MOVE CERTI               TO AQ-CERT-PRIME.
 12548     IF SUFXI GREATER THAN LOW-VALUES
 12549        MOVE SUFXI               TO AQ-CERT-SFX.
 12550     IF CERTCARI GREATER THAN LOW-VALUES
 12551        MOVE CERTCARI            TO AQ-CARRIER.
 12552
 12553
 12554* EXEC CICS HANDLE CONDITION
 12555*         DUPREC   (2440-EXIT)
 12556*    END-EXEC.
 12557*    MOVE '"$%                   ! 7 #00011005' TO DFHEIV0
 12558     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12560     MOVE X'3720233030303131303035' TO DFHEIV0(25:11)
 12561     CALL 'kxdfhei1' USING DFHEIV0
 12562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12563
 12564
 12565
 12566* EXEC CICS WRITE
 12567*         DATASET  (ACTQ-FILE-ID)
 12568*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12569*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 232
* EL131.cbl
 12570*    END-EXEC.
 12571     MOVE LENGTH OF
 12572      ACTIVITY-QUE
 12573       TO DFHEIV11
 12574*    MOVE '&$ L                  ''   #00011009' TO DFHEIV0
 12575     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12576     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12577     MOVE X'2020233030303131303039' TO DFHEIV0(25:11)
 12578     CALL 'kxdfhei1' USING DFHEIV0,
 12579           ACTQ-FILE-ID,
 12580           ACTIVITY-QUE,
 12581           DFHEIV11,
 12582           AQ-CONTROL-PRIMARY,
 12583           DFHEIV99,
 12584           DFHEIV99
 12585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12586
 12587
 12588 2440-EXIT.
 12589     EXIT.
 12590
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 233
* EL131.cbl
 12592 2460-UPDATE-CHECKQ.
 12593
 12594* EXEC CICS HANDLE CONDITION
 12595*         NOTFND   (2460-EXIT)
 12596*    END-EXEC.
 12597*    MOVE '"$I                   ! 8 #00011020' TO DFHEIV0
 12598     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12600     MOVE X'3820233030303131303230' TO DFHEIV0(25:11)
 12601     CALL 'kxdfhei1' USING DFHEIV0
 12602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12603
 12604
 12605     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12606     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12607     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12608
 12609
 12610* EXEC CICS READ UPDATE
 12611*         DATASET   (CHKQ-FILE-ID)
 12612*         RIDFLD    (CHKQ-KEY)
 12613*         SET       (ADDRESS OF CHECK-QUE)
 12614*    END-EXEC.
 12615*    MOVE '&"S        EU         (   #00011028' TO DFHEIV0
 12616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12617     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12618     MOVE X'2020233030303131303238' TO DFHEIV0(25:11)
 12619     CALL 'kxdfhei1' USING DFHEIV0,
 12620           CHKQ-FILE-ID,
 12621           DFHEIV20,
 12622           DFHEIV99,
 12623           CHKQ-KEY,
 12624           DFHEIV99,
 12625           DFHEIV99,
 12626           DFHEIV99
 12627     SET ADDRESS OF CHECK-QUE TO
 12628         DFHEIV20
 12629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12630
 12631
 12632     IF CERTI GREATER THAN LOW-VALUES
 12633        MOVE CERTI               TO CQ-CERT-PRIME.
 12634     IF SUFXI GREATER THAN LOW-VALUES
 12635        MOVE SUFXI               TO CQ-CERT-SFX.
 12636     IF CERTCARI GREATER THAN LOW-VALUES
 12637        MOVE CERTCARI            TO CQ-CARRIER.
 12638
 12639
 12640* EXEC CICS REWRITE
 12641*         DATASET  (CHKQ-FILE-ID)
 12642*         FROM     (CHECK-QUE)
 12643*    END-EXEC.
 12644     MOVE LENGTH OF
 12645      CHECK-QUE
 12646       TO DFHEIV11
 12647*    MOVE '&& L                  %   #00011041' TO DFHEIV0
 12648     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12649     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 234
* EL131.cbl
 12650     MOVE X'2020233030303131303431' TO DFHEIV0(25:11)
 12651     CALL 'kxdfhei1' USING DFHEIV0,
 12652           CHKQ-FILE-ID,
 12653           CHECK-QUE,
 12654           DFHEIV11,
 12655           DFHEIV99
 12656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12657
 12658
 12659 2460-EXIT.
 12660     EXIT.
 12661
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 235
* EL131.cbl
 12663 2475-UPDATE-LETTER.
 12664
 12665* EXEC CICS HANDLE CONDITION
 12666*         NOTFND   (2475-EXIT)
 12667*    END-EXEC.
 12668*    MOVE '"$I                   ! 9 #00011051' TO DFHEIV0
 12669     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12671     MOVE X'3920233030303131303531' TO DFHEIV0(25:11)
 12672     CALL 'kxdfhei1' USING DFHEIV0
 12673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12674
 12675
 12676     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12677     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12678     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12679     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12680
 12681
 12682* EXEC CICS READ UPDATE
 12683*         DATASET   (ARCH-FILE-ID)
 12684*         RIDFLD    (ARCH-KEY)
 12685*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12686*    END-EXEC.
 12687*    MOVE '&"S        EU         (   #00011060' TO DFHEIV0
 12688     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12689     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12690     MOVE X'2020233030303131303630' TO DFHEIV0(25:11)
 12691     CALL 'kxdfhei1' USING DFHEIV0,
 12692           ARCH-FILE-ID,
 12693           DFHEIV20,
 12694           DFHEIV99,
 12695           ARCH-KEY,
 12696           DFHEIV99,
 12697           DFHEIV99,
 12698           DFHEIV99
 12699     SET ADDRESS OF LETTER-ARCHIVE TO
 12700         DFHEIV20
 12701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12702
 12703
 12704* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12705* TO THIS MASTER-KEY INFORMATION.
 12706
 12707     IF LA-CARRIER  = CARRIER-CODE AND
 12708        LA-CLAIM-NO = CLAIM-NO     AND
 12709        LA-CERT-NO  = CERT-NO
 12710        NEXT SENTENCE
 12711     ELSE
 12712        GO TO 2475-UNLOCK.
 12713
 12714     IF CERTI GREATER THAN LOW-VALUES
 12715        MOVE CERTI               TO LA-CERT-PRIME.
 12716     IF SUFXI GREATER THAN LOW-VALUES
 12717        MOVE SUFXI               TO LA-CERT-SFX.
 12718     IF CERTCARI GREATER THAN LOW-VALUES
 12719        MOVE CERTCARI            TO LA-CARRIER.
 12720
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 236
* EL131.cbl
 12721
 12722* EXEC CICS REWRITE
 12723*         DATASET  (ARCH-FILE-ID)
 12724*         FROM     (LETTER-ARCHIVE)
 12725*    END-EXEC.
 12726     MOVE LENGTH OF
 12727      LETTER-ARCHIVE
 12728       TO DFHEIV11
 12729*    MOVE '&& L                  %   #00011083' TO DFHEIV0
 12730     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12731     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12732     MOVE X'2020233030303131303833' TO DFHEIV0(25:11)
 12733     CALL 'kxdfhei1' USING DFHEIV0,
 12734           ARCH-FILE-ID,
 12735           LETTER-ARCHIVE,
 12736           DFHEIV11,
 12737           DFHEIV99
 12738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12739
 12740
 12741     GO TO 2475-EXIT.
 12742
 12743 2475-UNLOCK.
 12744
 12745* EXEC CICS UNLOCK
 12746*         DATASET  (ARCH-FILE-ID)
 12747*    END-EXEC.
 12748*    MOVE '&*                    #   #00011091' TO DFHEIV0
 12749     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12750     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12751     MOVE X'2020233030303131303931' TO DFHEIV0(25:11)
 12752     CALL 'kxdfhei1' USING DFHEIV0,
 12753           ARCH-FILE-ID,
 12754           DFHEIV99
 12755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12756
 12757
 12758 2475-EXIT.
 12759     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 237
* EL131.cbl
 12761 2600-CREATE-MAINT-NOTE.
 12762     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12763     MOVE '1'                    TO CNTL-REC-TYPE.
 12764     MOVE SPACES                 TO CNTL-PROC-ID.
 12765     MOVE ZERO                   TO CNTL-SEQ-NO.
 12766
 12767
 12768* EXEC CICS READ
 12769*         SET        (ADDRESS OF CONTROL-FILE)
 12770*         DATASET    ('ELCNTL')
 12771*         RIDFLD     (CNTL-KEY)
 12772*    END-EXEC.
 12773     MOVE 'ELCNTL' TO DFHEIV1
 12774*    MOVE '&"S        E          (   #00011104' TO DFHEIV0
 12775     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12776     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12777     MOVE X'2020233030303131313034' TO DFHEIV0(25:11)
 12778     CALL 'kxdfhei1' USING DFHEIV0,
 12779           DFHEIV1,
 12780           DFHEIV20,
 12781           DFHEIV99,
 12782           CNTL-KEY,
 12783           DFHEIV99,
 12784           DFHEIV99,
 12785           DFHEIV99
 12786     SET ADDRESS OF CONTROL-FILE TO
 12787         DFHEIV20
 12788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12789
 12790
 12791     IF CO-NO-USE-AUDIT-CHANGES
 12792         GO TO 2600-EXIT.
 12793
 12794     IF PROCL GREATER ZERO
 12795     IF PROCI NOT = LOW-VALUES
 12796     IF PROCI NOT = CL-PROCESSOR-ID
 12797         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12798         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12799         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12800
 12801     IF SEXL GREATER ZERO
 12802     IF SEXI NOT = LOW-VALUES
 12803     IF SEXI NOT = CL-INSURED-SEX-CD
 12804         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12805         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12806         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12807
 12808     IF BIRTHL GREATER ZERO
 12809     IF HOLD-BIRTH NOT = LOW-VALUES
 12810     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12811         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12812         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12813         MOVE SPACES               TO DC-OPTION-CODE
 12814         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12815         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12816         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12817
 12818     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 238
* EL131.cbl
 12819     IF SOCIALI NOT = LOW-VALUES
 12820     IF SOCIALI NOT = CL-SOC-SEC-NO
 12821         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12822         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12823         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12824
 12825     IF OCCL GREATER ZERO
 12826     IF OCCI NOT = LOW-VALUES
 12827     IF OCCI NOT = CL-INSURED-OCC-CD
 12828         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12829         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12830         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12831
 12832     IF BENEL GREATER ZERO
 12833     IF BENEI NOT = LOW-VALUES
 12834     IF BENEI NOT = CL-BENEFICIARY
 12835         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12836         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12837         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12838
 12839     IF PREMTYPL GREATER ZERO
 12840     IF PREMTYPI NOT = LOW-VALUES
 12841     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12842         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12843         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12844         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12845
 12846*    IF CAUSEL GREATER ZERO
 12847*    IF CAUSEI NOT = LOW-VALUES
 12848*    IF CAUSEI NOT = CL-CAUSE-CD
 12849*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12850*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12851*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12852
 12853*    IF ENDL GREATER ZERO
 12854*    IF HOLD-END NOT = LOW-VALUES
 12855*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12856*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 12857*        MOVE CL-EST-END-OF-DISAB-DT
 12858*                                  TO DC-BIN-DATE-1
 12859*        MOVE SPACES               TO DC-OPTION-CODE
 12860*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12861*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12862*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12863
 12864     IF PDTHRUL GREATER ZERO
 12865     IF HOLD-PDTHRU NOT = LOW-VALUES
 12866     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12867         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12868         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12869         MOVE SPACES               TO DC-OPTION-CODE
 12870         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12871         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12872         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12873
 12874     IF PDAMTL GREATER ZERO
 12875     IF HOLD-PDAMT NOT = ZEROS
 12876     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 239
* EL131.cbl
 12877         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12878         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12879         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12880         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12881
 12882     IF NODAYSL GREATER ZERO
 12883     IF HOLD-NODAYS NOT = ZEROS
 12884     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12885         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12886         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12887         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12888         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12889
 12890     IF NOPMTSL GREATER ZERO
 12891     IF HOLD-NOPMTS NOT = ZEROS
 12892     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12893         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12894         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12895         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12896         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12897
 12898     IF FORMTYPL GREATER ZERO
 12899     IF FORMTYPI NOT = LOW-VALUES
 12900     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12901         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12902         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12903         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12904
 12905     IF REPL GREATER ZERO
 12906     IF HOLD-REPORTED NOT = LOW-VALUES
 12907     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12908         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12909         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12910         MOVE SPACES               TO DC-OPTION-CODE
 12911         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12912         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12913         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12914
 12915     IF ADDONDTL GREATER ZERO
 12916     IF HOLD-ADDON NOT = LOW-VALUES
 12917     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12918         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12919         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12920         MOVE SPACES               TO DC-OPTION-CODE
 12921         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12922         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12923         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12924
 12925     IF PRICDL GREATER ZERO
 12926     IF PRICDI NOT = LOW-VALUES
 12927     IF PRICDI NOT = CL-PRIORITY-CD
 12928         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12929         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12930         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12931
 12932     IF FILETOL GREATER ZERO
 12933     IF FILETOI NOT = LOW-VALUES
 12934     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 240
* EL131.cbl
 12935         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12936         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12937         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12938
 12939     IF SUPVL GREATER ZERO
 12940     IF SUPVI NOT = LOW-VALUES
 12941     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12942         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12943         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12944         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12945*    IF (CRITPTL > ZERO)
 12946*       AND (CRITPTI NOT = LOW-VALUES)
 12947*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12948*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12949*       MOVE CL-CRIT-PER-RECURRENT
 12950*                                TO SPLIT-INFO-OLD
 12951*       PERFORM 2650-WRITE-MAINT-NOTE
 12952*                                THRU 2650-EXIT
 12953*    END-IF
 12954
 12955*    IF (RTWMOSL > ZERO)
 12956*       AND (RTWMOSI NOT = LOW-VALUES)
 12957*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12958*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12959*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12960*       PERFORM 2650-WRITE-MAINT-NOTE
 12961*                                THRU 2650-EXIT
 12962*    END-IF
 12963     IF MLNAMEL GREATER ZERO
 12964     IF MLNAMEI NOT = LOW-VALUES
 12965     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12966         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12967         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12968         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12969
 12970     IF MFNAMEL GREATER ZERO
 12971     IF MFNAMEI NOT = LOW-VALUES
 12972     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12973         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12974         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12975         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12976
 12977     IF MMINITL GREATER ZERO
 12978     IF MMINITI NOT = LOW-VALUES
 12979     IF MMINITI NOT = CL-INSURED-MID-INIT
 12980         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12981         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12982         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12983
 12984     IF CERTEFFL GREATER ZERO
 12985     IF HOLD-EFF NOT = LOW-VALUES
 12986     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12987         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12988         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12989         MOVE SPACES               TO DC-OPTION-CODE
 12990         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12991         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12992         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 241
* EL131.cbl
 12993
 12994     IF CERTACTL GREATER ZERO
 12995     IF CERTACTI NOT = LOW-VALUES
 12996     IF CERTACTI NOT = CL-CERT-ACCOUNT
 12997         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 12998         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 12999         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13000
 13001     IF CERTSTL GREATER ZERO
 13002     IF CERTSTI NOT = LOW-VALUES
 13003     IF CERTSTI NOT = CL-CERT-STATE
 13004         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13005         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13006         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13007
 13008     IF CERTCARL GREATER ZERO
 13009     IF CERTCARI NOT = LOW-VALUES
 13010     IF CERTCARI NOT = CL-CERT-CARRIER
 13011         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13012         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13013         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13014
 13015     IF CERTGRPL GREATER ZERO
 13016     IF CERTGRPI NOT = LOW-VALUES
 13017     IF CERTGRPI NOT = CL-CERT-GROUPING
 13018         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13019         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13020         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13021
 13022     IF CERTL GREATER ZERO OR
 13023        SUFXL GREATER ZERO
 13024     IF (CERTI NOT = LOW-VALUES AND
 13025                     CL-CERT-PRIME)
 13026                OR
 13027        (SUFXI NOT = LOW-VALUES AND
 13028                     CL-CERT-SFX)
 13029         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13030         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13031         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13032     IF incl > zeros
 13033        IF (HOLD-INCUR NOT = LOW-VALUES)
 13034           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13035           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13036           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13037           MOVE SPACES           TO DC-OPTION-CODE
 13038           PERFORM 9800-CONVERT-DATE
 13039                                 THRU 9800-EXIT
 13040           MOVE DC-GREG-DATE-1-EDIT
 13041                                 TO SPLIT-INFO-OLD
 13042           PERFORM 2650-WRITE-MAINT-NOTE
 13043                                 THRU 2650-EXIT
 13044        END-IF
 13045     END-IF
 13046     .
 13047 2600-EXIT.
 13048      EXIT.
 13049
 13050 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 242
* EL131.cbl
 13051
 13052* EXEC CICS GETMAIN
 13053*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13054*         LENGTH   (TRLR-LENGTH)
 13055*         INITIMG  (GETMAIN-SPACE)
 13056*    END-EXEC.
 13057*    MOVE ',"IL                  $   #00011370' TO DFHEIV0
 13058     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13060     MOVE X'2020233030303131333730' TO DFHEIV0(25:11)
 13061     CALL 'kxdfhei1' USING DFHEIV0,
 13062           DFHEIV20,
 13063           TRLR-LENGTH,
 13064           GETMAIN-SPACE
 13065     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13066         DFHEIV20
 13067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13068
 13069
 13070
 13071* EXEC CICS HANDLE CONDITION
 13072*         DUPREC   (2650-EXIT)
 13073*    END-EXEC.
 13074*    MOVE '"$%                   ! : #00011376' TO DFHEIV0
 13075     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13076     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13077     MOVE X'3A20233030303131333736' TO DFHEIV0(25:11)
 13078     CALL 'kxdfhei1' USING DFHEIV0
 13079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13080
 13081
 13082     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13083
 13084     IF CERTL GREATER ZERO
 13085         MOVE CERTI          TO CL-CERT-PRIME.
 13086
 13087     IF SUFXL GREATER ZERO
 13088         MOVE SUFXI          TO CL-CERT-SFX.
 13089
 13090     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13091
 13092     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13093     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13094
 13095     MOVE 'AT'               TO AT-RECORD-ID.
 13096
 13097     MOVE '6'                TO AT-TRAILER-TYPE.
 13098     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13099                                AT-GEN-INFO-LAST-MAINT-DT.
 13100     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13101                                AT-GEN-INFO-LAST-UPDATED-BY.
 13102     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13103     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13104     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13105
 13106
 13107* EXEC CICS WRITE
 13108*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 243
* EL131.cbl
 13109*         RIDFLD   (AT-CONTROL-PRIMARY)
 13110*         FROM     (ACTIVITY-TRAILERS)
 13111*    END-EXEC.
 13112     MOVE LENGTH OF
 13113      ACTIVITY-TRAILERS
 13114       TO DFHEIV11
 13115*    MOVE '&$ L                  ''   #00011404' TO DFHEIV0
 13116     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13117     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13118     MOVE X'2020233030303131343034' TO DFHEIV0(25:11)
 13119     CALL 'kxdfhei1' USING DFHEIV0,
 13120           TRLR-FILE-ID,
 13121           ACTIVITY-TRAILERS,
 13122           DFHEIV11,
 13123           AT-CONTROL-PRIMARY,
 13124           DFHEIV99,
 13125           DFHEIV99
 13126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13127
 13128
 13129 2650-EXIT.
 13130      EXIT.
 13131
 13132 2800-CHECK-AUTO-PAY.
 13133
 13134     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13135     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13136     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13137     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13138     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13139
 13140
 13141* EXEC CICS HANDLE CONDITION
 13142*         NOTFND    (2800-EXIT)
 13143*         ENDFILE   (2800-EXIT)
 13144*    END-EXEC.
 13145*    MOVE '"$I''                  ! ; #00011421' TO DFHEIV0
 13146     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13148     MOVE X'3B20233030303131343231' TO DFHEIV0(25:11)
 13149     CALL 'kxdfhei1' USING DFHEIV0
 13150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13151
 13152
 13153
 13154* EXEC CICS READ
 13155*        DATASET (TRLR-FILE-ID)
 13156*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13157*        RIDFLD  (TRLR-KEY)
 13158*    END-EXEC.
 13159*    MOVE '&"S        E          (   #00011426' TO DFHEIV0
 13160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13162     MOVE X'2020233030303131343236' TO DFHEIV0(25:11)
 13163     CALL 'kxdfhei1' USING DFHEIV0,
 13164           TRLR-FILE-ID,
 13165           DFHEIV20,
 13166           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 244
* EL131.cbl
 13167           TRLR-KEY,
 13168           DFHEIV99,
 13169           DFHEIV99,
 13170           DFHEIV99
 13171     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13172         DFHEIV20
 13173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13174
 13175
 13176     IF BENEFICIARY-PAID-AUTO
 13177         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13178     END-IF.
 13179
 13180 2800-EXIT.
 13181      EXIT.
 13182
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 245
* EL131.cbl
 13184 3000-DELETE-CLAIM.
 13185     IF  NOT MODIFY-CAP
 13186         MOVE ER-0070            TO EMI-ERROR
 13187         MOVE -1                 TO MAINTL
 13188         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13189         GO TO 8110-SEND-DATA.
 13190
 13191
 13192* EXEC CICS READ
 13193*         SET      (ADDRESS OF CLAIM-MASTER)
 13194*         DATASET  (CLMS-FILE-ID)
 13195*         RIDFLD   (MSTR-KEY)
 13196*    END-EXEC.
 13197*    MOVE '&"S        E          (   #00011447' TO DFHEIV0
 13198     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13199     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13200     MOVE X'2020233030303131343437' TO DFHEIV0(25:11)
 13201     CALL 'kxdfhei1' USING DFHEIV0,
 13202           CLMS-FILE-ID,
 13203           DFHEIV20,
 13204           DFHEIV99,
 13205           MSTR-KEY,
 13206           DFHEIV99,
 13207           DFHEIV99,
 13208           DFHEIV99
 13209     SET ADDRESS OF CLAIM-MASTER TO
 13210         DFHEIV20
 13211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13212
 13213
 13214     IF CL-1ST-TRL-AVAIL
 13215         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13216     ELSE
 13217        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13218        MOVE 0                   TO TRLR-SEQ-NO
 13219
 13220* EXEC CICS STARTBR
 13221*            DATASET (TRLR-FILE-ID)
 13222*            RIDFLD  (TRLR-KEY)
 13223*        END-EXEC
 13224     MOVE 0
 13225       TO DFHEIV11
 13226*    MOVE '&,         G          &   #00011458' TO DFHEIV0
 13227     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13228     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13229     MOVE X'2020233030303131343538' TO DFHEIV0(25:11)
 13230     CALL 'kxdfhei1' USING DFHEIV0,
 13231           TRLR-FILE-ID,
 13232           TRLR-KEY,
 13233           DFHEIV99,
 13234           DFHEIV11,
 13235           DFHEIV99
 13236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13237         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13238
 13239* EXEC CICS ENDBR
 13240*            DATASET (TRLR-FILE-ID)
 13241*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 246
* EL131.cbl
 13242     MOVE 0
 13243       TO DFHEIV11
 13244*    MOVE '&2                    $   #00011463' TO DFHEIV0
 13245     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13246     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13247     MOVE X'2020233030303131343633' TO DFHEIV0(25:11)
 13248     CALL 'kxdfhei1' USING DFHEIV0,
 13249           TRLR-FILE-ID,
 13250           DFHEIV11,
 13251           DFHEIV99
 13252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13253        IF SCREEN-ERROR
 13254            MOVE ER-0208         TO EMI-ERROR
 13255            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13256            MOVE -1              TO MAINTL
 13257            GO TO 8110-SEND-DATA
 13258        ELSE
 13259            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13260
 13261     IF SCREEN-ERROR
 13262         MOVE -1                 TO MAINTL
 13263         GO TO 8110-SEND-DATA.
 13264
 13265     MOVE -1                     TO ONE-OR-MIN1.
 13266     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13267
 13268     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13269         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13270                                    WS-SAVE-CLAIM-KEY
 13271         MOVE +1                 TO ONE-OR-MIN1
 13272         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13273
 13274     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13275
 13276     MOVE LOW-VALUES             TO EL131AO.
 13277     MOVE ER-0000                TO EMI-ERROR.
 13278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13279     MOVE 'X'                    TO PI-RETURN-CD-1.
 13280     MOVE -1                     TO MAINTL.
 13281     GO TO 8100-SEND-MAP.
 13282
 13283 3010-DEL-MSTR-TRLR.
 13284
 13285* EXEC CICS READ UPDATE
 13286*         SET       (ADDRESS OF CLAIM-MASTER)
 13287*         DATASET   (CLMS-FILE-ID)
 13288*         RIDFLD    (MSTR-KEY)
 13289*    END-EXEC.
 13290*    MOVE '&"S        EU         (   #00011497' TO DFHEIV0
 13291     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13292     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13293     MOVE X'2020233030303131343937' TO DFHEIV0(25:11)
 13294     CALL 'kxdfhei1' USING DFHEIV0,
 13295           CLMS-FILE-ID,
 13296           DFHEIV20,
 13297           DFHEIV99,
 13298           MSTR-KEY,
 13299           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 247
* EL131.cbl
 13300           DFHEIV99,
 13301           DFHEIV99
 13302     SET ADDRESS OF CLAIM-MASTER TO
 13303         DFHEIV20
 13304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13305
 13306
 13307     if (cl-priority-cd = '8')
 13308        and (pi-processor-id not = 'PEMA' and 'JMS '
 13309             AND 'AMWA')
 13310        MOVE ER-8003             TO EMI-ERROR
 13311        PERFORM 9900-ERROR-FORMAT
 13312                                 THRU 9900-EXIT
 13313        MOVE -1                  TO MAINTL
 13314        GO TO 8110-SEND-DATA
 13315     end-if
 13316
 13317     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13318     MOVE ZERO                   TO TRLR-SEQ-NO.
 13319
 13320
 13321* EXEC CICS HANDLE CONDITION
 13322*         NOTFND    (3010-DEL-ACTQ)
 13323*         ENDFILE   (3040-EXIT)
 13324*    END-EXEC.
 13325*    MOVE '"$I''                  ! < #00011516' TO DFHEIV0
 13326     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13328     MOVE X'3C20233030303131353136' TO DFHEIV0(25:11)
 13329     CALL 'kxdfhei1' USING DFHEIV0
 13330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13331
 13332
 13333     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13334
 13335 3010-DEL-ACTQ.
 13336
 13337
 13338* EXEC CICS HANDLE CONDITION
 13339*         NOTFND    (3010-NO-ACTIVITY)
 13340*         ENDFILE   (3050-EXIT)
 13341*    END-EXEC.
 13342*    MOVE '"$I''                  ! = #00011525' TO DFHEIV0
 13343     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13345     MOVE X'3D20233030303131353235' TO DFHEIV0(25:11)
 13346     CALL 'kxdfhei1' USING DFHEIV0
 13347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13348
 13349
 13350
 13351* EXEC CICS STARTBR
 13352*         DATASET  (ACTQ-FILE-ID)
 13353*         RIDFLD   (ACTQ-KEY)
 13354*    END-EXEC.
 13355     MOVE 0
 13356       TO DFHEIV11
 13357*    MOVE '&,         G          &   #00011530' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 248
* EL131.cbl
 13358     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13359     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13360     MOVE X'2020233030303131353330' TO DFHEIV0(25:11)
 13361     CALL 'kxdfhei1' USING DFHEIV0,
 13362           ACTQ-FILE-ID,
 13363           ACTQ-KEY,
 13364           DFHEIV99,
 13365           DFHEIV11,
 13366           DFHEIV99
 13367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13368
 13369
 13370
 13371* EXEC CICS GETMAIN
 13372*         SET      (ADDRESS OF ACTIVITY-QUE)
 13373*         LENGTH   (ACTQ-LENGTH)
 13374*         INITIMG  (GETMAIN-SPACE)
 13375*    END-EXEC.
 13376*    MOVE ',"IL                  $   #00011535' TO DFHEIV0
 13377     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13378     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13379     MOVE X'2020233030303131353335' TO DFHEIV0(25:11)
 13380     CALL 'kxdfhei1' USING DFHEIV0,
 13381           DFHEIV20,
 13382           ACTQ-LENGTH,
 13383           GETMAIN-SPACE
 13384     SET ADDRESS OF ACTIVITY-QUE TO
 13385         DFHEIV20
 13386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13387
 13388
 13389     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13390
 13391
 13392* EXEC CICS ENDBR
 13393*         DATASET (ACTQ-FILE-ID)
 13394*    END-EXEC.
 13395     MOVE 0
 13396       TO DFHEIV11
 13397*    MOVE '&2                    $   #00011543' TO DFHEIV0
 13398     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13399     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13400     MOVE X'2020233030303131353433' TO DFHEIV0(25:11)
 13401     CALL 'kxdfhei1' USING DFHEIV0,
 13402           ACTQ-FILE-ID,
 13403           DFHEIV11,
 13404           DFHEIV99
 13405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13406
 13407
 13408 3010-NO-ACTIVITY.
 13409
 13410
 13411* EXEC CICS HANDLE CONDITION
 13412*        NOTFND   (3010-CERT-NOT-FOUND)
 13413*    END-EXEC.
 13414*    MOVE '"$I                   ! > #00011549' TO DFHEIV0
 13415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 249
* EL131.cbl
 13416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13417     MOVE X'3E20233030303131353439' TO DFHEIV0(25:11)
 13418     CALL 'kxdfhei1' USING DFHEIV0
 13419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13420
 13421
 13422     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13423     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13424     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13425     MOVE CL-CERT-STATE          TO CERT-STATE.
 13426     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13427     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13428     MOVE CL-CERT-NO             TO CERT-CERT.
 13429
 13430
 13431* EXEC CICS READ
 13432*        DATASET   (CERT-FILE-ID)
 13433*        RIDFLD    (CERT-KEY)
 13434*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13435*    END-EXEC.
 13436*    MOVE '&"S        E          (   #00011561' TO DFHEIV0
 13437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13439     MOVE X'2020233030303131353631' TO DFHEIV0(25:11)
 13440     CALL 'kxdfhei1' USING DFHEIV0,
 13441           CERT-FILE-ID,
 13442           DFHEIV20,
 13443           DFHEIV99,
 13444           CERT-KEY,
 13445           DFHEIV99,
 13446           DFHEIV99,
 13447           DFHEIV99
 13448     SET ADDRESS OF CERTIFICATE-MASTER TO
 13449         DFHEIV20
 13450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13451
 13452
 13453     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 13454       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 13455         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 13456     ELSE
 13457         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13458
 13459 3010-UPDATE-CERT-TRLR.
 13460
 13461     MOVE CERT-KEY               TO ELCRTT-KEY
 13462     MOVE 'B'                    TO CTRLR-REC-TYPE
 13463
 13464* EXEC CICS READ
 13465*       UPDATE
 13466*       DATASET   ('ELCRTT')
 13467*       RIDFLD    (ELCRTT-KEY)
 13468*       INTO      (CERTIFICATE-TRAILERS)
 13469*       RESP      (WS-RESPONSE)
 13470*    END-EXEC
 13471     MOVE LENGTH OF
 13472      CERTIFICATE-TRAILERS
 13473       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 250
* EL131.cbl
 13474     MOVE 'ELCRTT' TO DFHEIV1
 13475*    MOVE '&"IL       EU         (  N#00011577' TO DFHEIV0
 13476     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13477     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13478     MOVE X'204E233030303131353737' TO DFHEIV0(25:11)
 13479     CALL 'kxdfhei1' USING DFHEIV0,
 13480           DFHEIV1,
 13481           CERTIFICATE-TRAILERS,
 13482           DFHEIV11,
 13483           ELCRTT-KEY,
 13484           DFHEIV99,
 13485           DFHEIV99,
 13486           DFHEIV99
 13487     MOVE EIBRESP  TO WS-RESPONSE
 13488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13489     IF WS-RESP-NORMAL
 13490        perform varying s1 from +1 by +1 until
 13491           (s1 > +24)
 13492           or (cs-claim-no (s1) = cl-claim-no)
 13493        end-perform
 13494        if s1 < +25
 13495           move spaces           to cs-claim-no (s1)
 13496                                    cs-claim-type (s1)
 13497                                    cs-insured-type (s1)
 13498           move zeros            to cs-days-paid (s1)
 13499                                    cs-total-paid (s1)
 13500                                    cs-benefit-period (s1)
 13501           if s1 not = +24
 13502              compute s2 = s1 + +1
 13503              perform 3015-bump  thru 3015-exit
 13504           end-if
 13505
 13506* EXEC CICS REWRITE
 13507*             DATASET   ('ELCRTT')
 13508*             FROM      (CERTIFICATE-TRAILERS)
 13509*          END-EXEC
 13510     MOVE LENGTH OF
 13511      CERTIFICATE-TRAILERS
 13512       TO DFHEIV11
 13513     MOVE 'ELCRTT' TO DFHEIV1
 13514*    MOVE '&& L                  %   #00011600' TO DFHEIV0
 13515     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13516     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13517     MOVE X'2020233030303131363030' TO DFHEIV0(25:11)
 13518     CALL 'kxdfhei1' USING DFHEIV0,
 13519           DFHEIV1,
 13520           CERTIFICATE-TRAILERS,
 13521           DFHEIV11,
 13522           DFHEIV99
 13523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13524        end-if
 13525     end-if
 13526     .
 13527 3010-CERT-NOT-FOUND.
 13528
 13529
 13530* EXEC CICS DELETE
 13531*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 251
* EL131.cbl
 13532*    END-EXEC.
 13533*    MOVE '&(                    &   #00011609' TO DFHEIV0
 13534     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13535     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13536     MOVE X'2020233030303131363039' TO DFHEIV0(25:11)
 13537     CALL 'kxdfhei1' USING DFHEIV0,
 13538           CLMS-FILE-ID,
 13539           DFHEIV99,
 13540           DFHEIV99,
 13541           DFHEIV99,
 13542           DFHEIV99
 13543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13544
 13545
 13546 3010-EXIT.
 13547      EXIT.
 13548
 13549 3015-bump.
 13550     perform varying s2 from s2 by +1 until s2 > +24
 13551        move cs-mb-claim-data (s2)
 13552                                 to cs-mb-claim-data (s1)
 13553        move spaces              to cs-mb-claim-data (s2)
 13554        add +1 to s1
 13555     end-perform
 13556     .
 13557 3015-exit.
 13558     exit.
 13559 3020-UPDATE-CERT.
 13560
 13561* EXEC CICS READ UPDATE
 13562*         DATASET  (CERT-FILE-ID)
 13563*         RIDFLD   (CERT-KEY)
 13564*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13565*    END-EXEC.
 13566*    MOVE '&"S        EU         (   #00011627' TO DFHEIV0
 13567     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13568     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13569     MOVE X'2020233030303131363237' TO DFHEIV0(25:11)
 13570     CALL 'kxdfhei1' USING DFHEIV0,
 13571           CERT-FILE-ID,
 13572           DFHEIV20,
 13573           DFHEIV99,
 13574           CERT-KEY,
 13575           DFHEIV99,
 13576           DFHEIV99,
 13577           DFHEIV99
 13578     SET ADDRESS OF CERTIFICATE-MASTER TO
 13579         DFHEIV20
 13580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13581
 13582
 13583     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13584
 13585
 13586* EXEC CICS HANDLE CONDITION
 13587*         DUPKEY   (3020-EXIT)
 13588*    END-EXEC.
 13589*    MOVE '"$$                   ! ? #00011635' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 252
* EL131.cbl
 13590     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13592     MOVE X'3F20233030303131363335' TO DFHEIV0(25:11)
 13593     CALL 'kxdfhei1' USING DFHEIV0
 13594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13595
 13596
 13597
 13598* EXEC CICS REWRITE
 13599*         DATASET  (CERT-FILE-ID)
 13600*         FROM     (CERTIFICATE-MASTER)
 13601*    END-EXEC.
 13602     MOVE LENGTH OF
 13603      CERTIFICATE-MASTER
 13604       TO DFHEIV11
 13605*    MOVE '&& L                  %   #00011639' TO DFHEIV0
 13606     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13607     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13608     MOVE X'2020233030303131363339' TO DFHEIV0(25:11)
 13609     CALL 'kxdfhei1' USING DFHEIV0,
 13610           CERT-FILE-ID,
 13611           CERTIFICATE-MASTER,
 13612           DFHEIV11,
 13613           DFHEIV99
 13614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13615
 13616
 13617 3020-EXIT.
 13618     EXIT.
 13619
 13620 3030-DELETE-CERT.
 13621
 13622* EXEC CICS READ UPDATE
 13623*         DATASET  (CERT-FILE-ID)
 13624*         RIDFLD   (CERT-KEY)
 13625*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13626*    END-EXEC.
 13627*    MOVE '&"S        EU         (   #00011648' TO DFHEIV0
 13628     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13629     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13630     MOVE X'2020233030303131363438' TO DFHEIV0(25:11)
 13631     CALL 'kxdfhei1' USING DFHEIV0,
 13632           CERT-FILE-ID,
 13633           DFHEIV20,
 13634           DFHEIV99,
 13635           CERT-KEY,
 13636           DFHEIV99,
 13637           DFHEIV99,
 13638           DFHEIV99
 13639     SET ADDRESS OF CERTIFICATE-MASTER TO
 13640         DFHEIV20
 13641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13642
 13643
 13644
 13645* EXEC CICS DELETE
 13646*         DATASET   (CERT-FILE-ID)
 13647*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 253
* EL131.cbl
 13648*    MOVE '&(                    &   #00011654' TO DFHEIV0
 13649     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13650     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13651     MOVE X'2020233030303131363534' TO DFHEIV0(25:11)
 13652     CALL 'kxdfhei1' USING DFHEIV0,
 13653           CERT-FILE-ID,
 13654           DFHEIV99,
 13655           DFHEIV99,
 13656           DFHEIV99,
 13657           DFHEIV99
 13658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13659
 13660
 13661 3030-EXIT.
 13662     EXIT.
 13663
 13664 3040-DELETE-TRLR.
 13665
 13666* EXEC CICS READ
 13667*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13668*         DATASET  (TRLR-FILE-ID)
 13669*         RIDFLD   (TRLR-KEY)
 13670*         GTEQ
 13671*    END-EXEC.
 13672*    MOVE '&"S        G          (   #00011662' TO DFHEIV0
 13673     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13674     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13675     MOVE X'2020233030303131363632' TO DFHEIV0(25:11)
 13676     CALL 'kxdfhei1' USING DFHEIV0,
 13677           TRLR-FILE-ID,
 13678           DFHEIV20,
 13679           DFHEIV99,
 13680           TRLR-KEY,
 13681           DFHEIV99,
 13682           DFHEIV99,
 13683           DFHEIV99
 13684     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13685         DFHEIV20
 13686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13687
 13688
 13689     IF PI-COMPANY-CD = AT-COMPANY-CD
 13690        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13691        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13692           GO TO 3040-EXIT
 13693        ELSE
 13694           NEXT SENTENCE
 13695     ELSE
 13696        GO TO 3040-EXIT.
 13697
 13698
 13699* EXEC CICS DELETE
 13700*         DATASET  (TRLR-FILE-ID)
 13701*         RIDFLD   (TRLR-KEY)
 13702*    END-EXEC.
 13703*    MOVE '&(  R                 &   #00011678' TO DFHEIV0
 13704     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13705     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 254
* EL131.cbl
 13706     MOVE X'2020233030303131363738' TO DFHEIV0(25:11)
 13707     CALL 'kxdfhei1' USING DFHEIV0,
 13708           TRLR-FILE-ID,
 13709           TRLR-KEY,
 13710           DFHEIV99,
 13711           DFHEIV99,
 13712           DFHEIV99
 13713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13714
 13715
 13716     GO TO 3040-DELETE-TRLR.
 13717
 13718 3040-EXIT.
 13719     EXIT.
 13720
 13721 3050-DELETE-ACTQ.
 13722
 13723* EXEC CICS READNEXT
 13724*         DATASET  (ACTQ-FILE-ID)
 13725*         RIDFLD   (ACTQ-KEY)
 13726*         INTO     (ACTIVITY-QUE)
 13727*    END-EXEC.
 13728     MOVE LENGTH OF
 13729      ACTIVITY-QUE
 13730       TO DFHEIV12
 13731     MOVE 0
 13732       TO DFHEIV11
 13733*    MOVE '&.IL                  )   #00011689' TO DFHEIV0
 13734     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13735     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13736     MOVE X'2020233030303131363839' TO DFHEIV0(25:11)
 13737     CALL 'kxdfhei1' USING DFHEIV0,
 13738           ACTQ-FILE-ID,
 13739           ACTIVITY-QUE,
 13740           DFHEIV12,
 13741           ACTQ-KEY,
 13742           DFHEIV99,
 13743           DFHEIV11,
 13744           DFHEIV99,
 13745           DFHEIV99
 13746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13747
 13748
 13749     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13750         GO TO 3050-EXIT.
 13751
 13752
 13753* EXEC CICS ENDBR
 13754*         DATASET  (ACTQ-FILE-ID)
 13755*    END-EXEC.
 13756     MOVE 0
 13757       TO DFHEIV11
 13758*    MOVE '&2                    $   #00011698' TO DFHEIV0
 13759     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13760     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13761     MOVE X'2020233030303131363938' TO DFHEIV0(25:11)
 13762     CALL 'kxdfhei1' USING DFHEIV0,
 13763           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 255
* EL131.cbl
 13764           DFHEIV11,
 13765           DFHEIV99
 13766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13767
 13768
 13769
 13770* EXEC CICS DELETE
 13771*         DATASET   (ACTQ-FILE-ID)
 13772*         RIDFLD    (ACTQ-KEY)
 13773*    END-EXEC.
 13774*    MOVE '&(  R                 &   #00011702' TO DFHEIV0
 13775     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13777     MOVE X'2020233030303131373032' TO DFHEIV0(25:11)
 13778     CALL 'kxdfhei1' USING DFHEIV0,
 13779           ACTQ-FILE-ID,
 13780           ACTQ-KEY,
 13781           DFHEIV99,
 13782           DFHEIV99,
 13783           DFHEIV99
 13784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13785
 13786
 13787
 13788* EXEC CICS STARTBR
 13789*         DATASET   (ACTQ-FILE-ID)
 13790*         RIDFLD    (ACTQ-KEY)
 13791*    END-EXEC.
 13792     MOVE 0
 13793       TO DFHEIV11
 13794*    MOVE '&,         G          &   #00011707' TO DFHEIV0
 13795     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13796     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13797     MOVE X'2020233030303131373037' TO DFHEIV0(25:11)
 13798     CALL 'kxdfhei1' USING DFHEIV0,
 13799           ACTQ-FILE-ID,
 13800           ACTQ-KEY,
 13801           DFHEIV99,
 13802           DFHEIV11,
 13803           DFHEIV99
 13804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13805
 13806
 13807     GO TO 3050-DELETE-ACTQ.
 13808
 13809 3050-EXIT.
 13810     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 256
* EL131.cbl
 13812 3060-READ-TRLR.
 13813
 13814* EXEC CICS HANDLE CONDITION
 13815*         NOTFND    (3060-EXIT)
 13816*         ENDFILE   (3060-EXIT)
 13817*    END-EXEC.
 13818*    MOVE '"$I''                  ! @ #00011718' TO DFHEIV0
 13819     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13821     MOVE X'4020233030303131373138' TO DFHEIV0(25:11)
 13822     CALL 'kxdfhei1' USING DFHEIV0
 13823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13824
 13825
 13826 3060-LOOP.
 13827
 13828* EXEC CICS READNEXT
 13829*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13830*         DATASET  (TRLR-FILE-ID)
 13831*         RIDFLD   (TRLR-KEY)
 13832*    END-EXEC.
 13833     MOVE 0
 13834       TO DFHEIV11
 13835*    MOVE '&.S                   )   #00011724' TO DFHEIV0
 13836     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13837     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13838     MOVE X'2020233030303131373234' TO DFHEIV0(25:11)
 13839     CALL 'kxdfhei1' USING DFHEIV0,
 13840           TRLR-FILE-ID,
 13841           DFHEIV20,
 13842           DFHEIV99,
 13843           TRLR-KEY,
 13844           DFHEIV99,
 13845           DFHEIV11,
 13846           DFHEIV99,
 13847           DFHEIV99
 13848     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13849         DFHEIV20
 13850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13851
 13852
 13853     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13854         GO TO 3060-EXIT.
 13855
 13856     IF FORM-CONTROL-TR
 13857         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13858             NEXT SENTENCE
 13859         ELSE
 13860             MOVE 'X'            TO ERROR-SWITCH
 13861             GO TO 3060-EXIT
 13862     ELSE
 13863         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13864            MOVE 'X'                 TO ERROR-SWITCH
 13865            GO TO 3060-EXIT.
 13866
 13867     GO TO 3060-LOOP.
 13868
 13869 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 257
* EL131.cbl
 13870     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 258
* EL131.cbl
 13872 3997-GET-ERPDEF.
 13873
 13874     move cl-company-cd          to cert-company-code
 13875     move cl-cert-key-data       to cert-key (2:21)
 13876     move cl-cert-no             to cert-cert
 13877
 13878
 13879* EXEC CICS READ
 13880*        DATASET   (CERT-FILE-ID)
 13881*        RIDFLD    (CERT-KEY)
 13882*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13883*        resp      (ws-response)
 13884*    END-EXEC
 13885*    MOVE '&"S        E          (  N#00011755' TO DFHEIV0
 13886     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13887     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13888     MOVE X'204E233030303131373535' TO DFHEIV0(25:11)
 13889     CALL 'kxdfhei1' USING DFHEIV0,
 13890           CERT-FILE-ID,
 13891           DFHEIV20,
 13892           DFHEIV99,
 13893           CERT-KEY,
 13894           DFHEIV99,
 13895           DFHEIV99,
 13896           DFHEIV99
 13897     SET ADDRESS OF CERTIFICATE-MASTER TO
 13898         DFHEIV20
 13899     MOVE EIBRESP  TO ws-response
 13900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13901
 13902     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 13903                                    WS-ERPDEF-SW
 13904     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13905                                    WS-CRIT-PER-RTW-MOS
 13906
 13907     if cm-clp-state = spaces or low-values or zeros
 13908        move cm-state            to cm-clp-state
 13909     end-if
 13910     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13911     MOVE CM-clp-state           TO ERPDEF-STATE
 13912     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13913     if (cl-claim-type = 'L' or 'P')
 13914        and (cm-lf-benefit-cd not = '00' and '  ' and 'DD')
 13915        move 'L'                 to erpdef-ben-type
 13916        move cm-lf-benefit-cd    to erpdef-ben-code
 13917     else
 13918        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 13919        MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 13920     end-if
 13921     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13922     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13923
 13924
 13925* EXEC CICS STARTBR
 13926*        DATASET  ('ERPDEF')
 13927*        RIDFLD   (ERPDEF-KEY)
 13928*        GTEQ
 13929*        RESP     (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 259
* EL131.cbl
 13930*    END-EXEC
 13931     MOVE 'ERPDEF' TO DFHEIV1
 13932     MOVE 0
 13933       TO DFHEIV11
 13934*    MOVE '&,         G          &  N#00011784' TO DFHEIV0
 13935     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13936     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13937     MOVE X'204E233030303131373834' TO DFHEIV0(25:11)
 13938     CALL 'kxdfhei1' USING DFHEIV0,
 13939           DFHEIV1,
 13940           ERPDEF-KEY,
 13941           DFHEIV99,
 13942           DFHEIV11,
 13943           DFHEIV99
 13944     MOVE EIBRESP  TO WS-RESPONSE
 13945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13946
 13947     IF WS-RESP-NORMAL
 13948
 13949* EXEC CICS READNEXT
 13950*          DATASET  ('ERPDEF')
 13951*          INTO     (PRODUCT-MASTER)
 13952*          RIDFLD   (ERPDEF-KEY)
 13953*          RESP     (WS-RESPONSE)
 13954*       END-EXEC
 13955     MOVE LENGTH OF
 13956      PRODUCT-MASTER
 13957       TO DFHEIV12
 13958     MOVE 'ERPDEF' TO DFHEIV1
 13959     MOVE 0
 13960       TO DFHEIV11
 13961*    MOVE '&.IL                  )  N#00011792' TO DFHEIV0
 13962     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13963     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13964     MOVE X'204E233030303131373932' TO DFHEIV0(25:11)
 13965     CALL 'kxdfhei1' USING DFHEIV0,
 13966           DFHEIV1,
 13967           PRODUCT-MASTER,
 13968           DFHEIV12,
 13969           ERPDEF-KEY,
 13970           DFHEIV99,
 13971           DFHEIV11,
 13972           DFHEIV99,
 13973           DFHEIV99
 13974     MOVE EIBRESP  TO WS-RESPONSE
 13975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13976        IF WS-RESP-NORMAL
 13977           IF (ERPDEF-KEY-SAVE (1:16) =
 13978              PD-CONTROL-PRIMARY (1:16))
 13979              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 13980              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 13981                 (A1 > +8)
 13982                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 13983              END-PERFORM
 13984              IF A1 < +9
 13985                 SET ERPDEF-FOUND TO TRUE
 13986                 MOVE PD-CRIT-PERIOD (A1)
 13987                              TO WS-CRITICAL-PERIOD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 260
* EL131.cbl
 13988                 MOVE PD-REC-CRIT-PERIOD (A1)
 13989                              TO WS-CRIT-PER-RECURRENT
 13990                 IF PD-RTW-MOS (A1) NUMERIC
 13991                    MOVE PD-RTW-MOS (A1)
 13992                              TO WS-CRIT-PER-RTW-MOS
 13993                 ELSE
 13994                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 13995                 END-IF
 13996                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 13997                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 13998                                 TO WS-EXCL-PERIOD
 13999                 END-IF
 14000                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14001                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14002                                 TO WS-COV-ENDS
 14003                 END-IF
 14004                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14005                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14006                                 TO WS-ACC-PERIOD
 14007                 END-IF
 14008                 if pd-max-extension (a1) numeric
 14009                    move pd-max-extension (a1)
 14010                                 to ws-max-extension
 14011                 end-if
 14012                 if pd-max-amt (a1) numeric
 14013                    move pd-max-amt (a1)
 14014                                 to ws-max-moben
 14015                 end-if
 14016              END-IF
 14017           END-IF
 14018        END-IF
 14019     END-IF
 14020
 14021     .
 14022 3997-EXIT.
 14023     EXIT.
 14024 4000-FORCE-ERRORS.
 14025     IF PI-RETURN-CD-1 = 'X'
 14026         MOVE ER-0311            TO EMI-ERROR
 14027         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14028         MOVE -1                 TO MAINTL
 14029         GO TO 8110-SEND-DATA.
 14030
 14031     IF NOT FORCE-CAP
 14032         MOVE ER-0416            TO EMI-ERROR
 14033         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14034         MOVE -1                 TO MAINTL
 14035         GO TO 8110-SEND-DATA.
 14036
 14037     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14038     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14039     IF EMI-FATAL-CTR GREATER THAN ZERO
 14040         GO TO 4000-FATAL-ERRORS.
 14041
 14042     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14043
 14044     IF EMI-FATAL-CTR GREATER THAN ZERO
 14045         GO TO 4000-FATAL-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 261
* EL131.cbl
 14046
 14047     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14048
 14049     IF EMI-FATAL-CTR GREATER THAN ZERO
 14050         GO TO 4000-FATAL-ERRORS.
 14051
 14052     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14053     MOVE AL-UANOF               TO CERTA.
 14054     MOVE ER-0000 TO EMI-ERROR.
 14055     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14056
 14057 4000-FATAL-ERRORS.
 14058     MOVE -1                     TO MAINTL.
 14059     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 262
* EL131.cbl
 14061
 14062 4100-SAVE-CHANGES.
 14063     IF MAINTL > 0
 14064         MOVE MAINTI  TO WS-SAVE-MAINTI
 14065         MOVE MAINTL  TO WS-SAVE-MAINTL
 14066     END-IF
 14067     IF STATUSL > 0
 14068         MOVE STATUSI  TO WS-SAVE-STATUSI
 14069         MOVE STATUSL  TO WS-SAVE-STATUSL
 14070     END-IF
 14071     IF REPL > 0
 14072         MOVE REPI  TO WS-SAVE-REPI
 14073         MOVE REPL  TO WS-SAVE-REPL
 14074     END-IF
 14075*    IF CAUSEL > 0
 14076*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14077*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14078*    END-IF
 14079*    IF ENDL > 0
 14080*        MOVE ENDI  TO WS-SAVE-ENDI
 14081*        MOVE ENDL  TO WS-SAVE-ENDL
 14082*    END-IF
 14083     IF DIAGL > 0
 14084         MOVE DIAGI  TO WS-SAVE-DIAGI
 14085         MOVE DIAGL  TO WS-SAVE-DIAGL
 14086     END-IF
 14087     IF ICD1L > 0
 14088         MOVE ICD1I  TO WS-SAVE-ICD1I
 14089         MOVE ICD1L  TO WS-SAVE-ICD1L
 14090     END-IF
 14091     IF ICD2L > 0
 14092         MOVE ICD2I  TO WS-SAVE-ICD2I
 14093         MOVE ICD2L  TO WS-SAVE-ICD2L
 14094     END-IF
 14095     IF BENEL > 0
 14096         MOVE BENEI  TO WS-SAVE-BENEI
 14097         MOVE BENEL  TO WS-SAVE-BENEL
 14098     END-IF
 14099     IF BIRTHL > 0
 14100         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14101         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14102     END-IF
 14103     IF SOCIALL > 0
 14104         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14105         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14106     END-IF
 14107     IF SEXL > 0
 14108         MOVE SEXI  TO WS-SAVE-SEXI
 14109         MOVE SEXL  TO WS-SAVE-SEXL
 14110     END-IF
 14111     IF MLNAMEL > 0
 14112         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14113         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14114     END-IF
 14115     IF MFNAMEL > 0
 14116         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14117         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14118     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 263
* EL131.cbl
 14119     IF MMINITL > 0
 14120         MOVE MMINITI  TO WS-SAVE-MMINITI
 14121         MOVE MMINITL  TO WS-SAVE-MMINITL
 14122     END-IF
 14123     IF LOANNOL > 0
 14124         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14125         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14126     END-IF
 14127     IF LOANBALL > 0
 14128         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14129         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14130     END-IF
 14131     IF PROCL > 0
 14132         MOVE PROCI  TO WS-SAVE-PROCI
 14133         MOVE PROCL  TO WS-SAVE-PROCL
 14134     END-IF
 14135     IF SUPVL > 0
 14136         MOVE SUPVI  TO WS-SAVE-SUPVI
 14137         MOVE SUPVL  TO WS-SAVE-SUPVL
 14138     END-IF
 14139     IF PRICDL > 0
 14140         MOVE PRICDI  TO WS-SAVE-PRICDI
 14141         MOVE PRICDL  TO WS-SAVE-PRICDL
 14142     END-IF
 14143     IF FILETOL > 0
 14144         MOVE FILETOI  TO WS-SAVE-FILETOI
 14145         MOVE FILETOL  TO WS-SAVE-FILETOL
 14146     END-IF
 14147     IF PDTHRUL > 0
 14148         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14149         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14150     END-IF
 14151     IF PDAMTL > 0
 14152         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14153         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14154     END-IF
 14155     IF NODAYSL > 0
 14156         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14157         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14158     END-IF
 14159     IF NOPMTSL > 0
 14160         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14161         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14162     END-IF
 14163     IF FORMTYPL > 0
 14164         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14165         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14166     END-IF
 14167     IF OCCL > 0
 14168         MOVE OCCI  TO WS-SAVE-OCCI
 14169         MOVE OCCL  TO WS-SAVE-OCCL
 14170     END-IF.
 14171 4100-EXIT.
 14172      EXIT.
 14173
 14174 4200-LOAD-CHANGES.
 14175     IF WS-SAVE-MAINTL > 0
 14176         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 264
* EL131.cbl
 14177         MOVE WS-SAVE-MAINTL  TO MAINTL
 14178         MOVE AL-UANON        TO MAINTA
 14179     END-IF
 14180     IF WS-SAVE-STATUSL > 0
 14181         MOVE WS-SAVE-STATUSI  TO STATUSI
 14182         MOVE WS-SAVE-STATUSL  TO STATUSL
 14183         MOVE AL-UANON         TO STATUSA
 14184     END-IF
 14185     IF WS-SAVE-REPL > 0
 14186         MOVE WS-SAVE-REPI  TO REPI
 14187         MOVE WS-SAVE-REPL  TO REPL
 14188         MOVE AL-UANON      TO REPA
 14189     END-IF
 14190*    IF WS-SAVE-CAUSEL > 0
 14191*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14192*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14193*        MOVE AL-UANON        TO CAUSEA
 14194*    END-IF
 14195*    IF WS-SAVE-ENDL > 0
 14196*        MOVE WS-SAVE-ENDI  TO ENDI
 14197*        MOVE WS-SAVE-ENDL  TO ENDL
 14198*        MOVE AL-UANON      TO ENDA
 14199*    END-IF
 14200     IF WS-SAVE-DIAGL > 0
 14201         MOVE WS-SAVE-DIAGI  TO DIAGI
 14202         MOVE WS-SAVE-DIAGL  TO DIAGL
 14203         MOVE AL-UANON       TO DIAGA
 14204     END-IF
 14205     IF WS-SAVE-ICD1L > 0
 14206         MOVE WS-SAVE-ICD1I  TO ICD1I
 14207         MOVE WS-SAVE-ICD1L  TO ICD1L
 14208         MOVE AL-UANON       TO ICD1A
 14209     END-IF
 14210     IF WS-SAVE-ICD2L > 0
 14211         MOVE WS-SAVE-ICD2I  TO ICD2I
 14212         MOVE WS-SAVE-ICD2L  TO ICD2L
 14213         MOVE AL-UANON       TO ICD2A
 14214     END-IF
 14215     IF WS-SAVE-BENEL > 0
 14216         MOVE WS-SAVE-BENEI  TO BENEI
 14217         MOVE WS-SAVE-BENEL  TO BENEL
 14218         MOVE AL-UANON       TO BENEA
 14219     END-IF
 14220     IF WS-SAVE-BIRTHL > 0
 14221         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14222         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14223         MOVE AL-UANON        TO BIRTHA
 14224     END-IF
 14225     IF WS-SAVE-SOCIALL > 0
 14226         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14227         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14228         MOVE AL-UANON         TO SOCIALA
 14229     END-IF
 14230     IF WS-SAVE-SEXL > 0
 14231         MOVE WS-SAVE-SEXI  TO SEXI
 14232         MOVE WS-SAVE-SEXL  TO SEXL
 14233         MOVE AL-UANON      TO SEXA
 14234     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 265
* EL131.cbl
 14235     IF WS-SAVE-MLNAMEL > 0
 14236         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14237         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14238         MOVE AL-UANON         TO MLNAMEA
 14239     END-IF
 14240     IF WS-SAVE-MFNAMEL > 0
 14241         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14242         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14243         MOVE AL-UANON         TO MFNAMEA
 14244     END-IF
 14245     IF WS-SAVE-MMINITL > 0
 14246         MOVE WS-SAVE-MMINITI  TO MMINITI
 14247         MOVE WS-SAVE-MMINITL  TO MMINITL
 14248         MOVE AL-UANON         TO MMINITA
 14249     END-IF
 14250     IF WS-SAVE-LOANNOL > 0
 14251         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14252         MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14253         MOVE AL-UANON         TO LOANNOA
 14254     END-IF
 14255     IF WS-SAVE-LOANBALL > 0
 14256         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14257         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14258         MOVE AL-UANON          TO LOANBALA
 14259     END-IF
 14260     IF WS-SAVE-PROCL > 0
 14261         MOVE WS-SAVE-PROCI  TO PROCI
 14262         MOVE WS-SAVE-PROCL  TO PROCL
 14263         MOVE AL-UANON       TO PROCA
 14264     END-IF
 14265     IF WS-SAVE-SUPVL > 0
 14266         MOVE WS-SAVE-SUPVI  TO SUPVI
 14267         MOVE WS-SAVE-SUPVL  TO SUPVL
 14268         MOVE AL-UANON       TO SUPVA
 14269     END-IF
 14270     IF WS-SAVE-PRICDL > 0
 14271         MOVE WS-SAVE-PRICDI  TO PRICDI
 14272         MOVE WS-SAVE-PRICDL  TO PRICDL
 14273         MOVE AL-UANON        TO PRICDA
 14274     END-IF
 14275     IF WS-SAVE-FILETOL > 0
 14276         MOVE WS-SAVE-FILETOI  TO FILETOI
 14277         MOVE WS-SAVE-FILETOL  TO FILETOL
 14278         MOVE AL-UANON         TO FILETOA
 14279     END-IF
 14280     IF WS-SAVE-PDTHRUL > 0
 14281         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14282         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14283         MOVE AL-UANON         TO PDTHRUA
 14284     END-IF
 14285     IF WS-SAVE-PDAMTL > 0
 14286         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14287         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14288         MOVE AL-UANON        TO PDAMTA
 14289     END-IF
 14290     IF WS-SAVE-NODAYSL > 0
 14291         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14292         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 266
* EL131.cbl
 14293         MOVE AL-UANON         TO NODAYSA
 14294     END-IF
 14295     IF WS-SAVE-NOPMTSL > 0
 14296         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14297         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14298         MOVE AL-UANON         TO NOPMTSA
 14299     END-IF
 14300     IF WS-SAVE-FORMTYPL > 0
 14301         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14302         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14303         MOVE AL-UANON          TO FORMTYPA
 14304     END-IF
 14305     IF WS-SAVE-OCCL > 0
 14306         MOVE WS-SAVE-OCCI  TO OCCI
 14307         MOVE WS-SAVE-OCCL  TO OCCL
 14308         MOVE AL-UANON      TO OCCA
 14309     END-IF.
 14310 4200-EXIT.
 14311      EXIT.
 14312
 14313 5000-BUILD-MAP.
 14314     IF PI-RETURN-CD-1 = SPACE
 14315         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14316
 14317     MOVE SPACE                  TO PI-RETURN-CD-1.
 14318
 14319     MOVE LOW-VALUES             TO EL131AI.
 14320
 14321     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14322     MOVE PI-CARRIER             TO CARRIER-CODE.
 14323     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14324     MOVE PI-CERT-NO             TO CERT-NO.
 14325
 14326 5000-READ-CLAIM-MASTER.
 14327
 14328
 14329* EXEC CICS READ
 14330*         SET      (ADDRESS OF CLAIM-MASTER)
 14331*         DATASET  (CLMS-FILE-ID)
 14332*         RIDFLD   (MSTR-KEY)
 14333*    END-EXEC.
 14334*    MOVE '&"S        E          (   #00012150' TO DFHEIV0
 14335     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14336     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14337     MOVE X'2020233030303132313530' TO DFHEIV0(25:11)
 14338     CALL 'kxdfhei1' USING DFHEIV0,
 14339           CLMS-FILE-ID,
 14340           DFHEIV20,
 14341           DFHEIV99,
 14342           MSTR-KEY,
 14343           DFHEIV99,
 14344           DFHEIV99,
 14345           DFHEIV99
 14346     SET ADDRESS OF CLAIM-MASTER TO
 14347         DFHEIV20
 14348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14349
 14350
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 267
* EL131.cbl
 14351     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14352
 14353 5000-READ-DIAGNOSIS-TRAILER.
 14354
 14355
 14356* EXEC CICS HANDLE CONDITION
 14357*         NOTFND (5000-TRLR-NOT-FOUND)
 14358*    END-EXEC.
 14359*    MOVE '"$I                   ! A #00012160' TO DFHEIV0
 14360     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14362     MOVE X'4120233030303132313630' TO DFHEIV0(25:11)
 14363     CALL 'kxdfhei1' USING DFHEIV0
 14364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14365
 14366
 14367     MOVE MSTR-KEY               TO TRLR-KEY.
 14368     MOVE NINETY                 TO TRLR-SEQ-NO.
 14369
 14370
 14371* EXEC CICS READ
 14372*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14373*         DATASET  (TRLR-FILE-ID)
 14374*         RIDFLD   (TRLR-KEY)
 14375*    END-EXEC.
 14376*    MOVE '&"S        E          (   #00012167' TO DFHEIV0
 14377     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14379     MOVE X'2020233030303132313637' TO DFHEIV0(25:11)
 14380     CALL 'kxdfhei1' USING DFHEIV0,
 14381           TRLR-FILE-ID,
 14382           DFHEIV20,
 14383           DFHEIV99,
 14384           TRLR-KEY,
 14385           DFHEIV99,
 14386           DFHEIV99,
 14387           DFHEIV99
 14388     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14389         DFHEIV20
 14390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14391
 14392
 14393     MOVE AT-INFO-LINE-1         TO DIAGO.
 14394     MOVE AT-ICD-CODE-1          TO ICD1O.
 14395     MOVE AT-ICD-CODE-2          TO ICD2O.
 14396
 14397 5000-READ-CERTIFICATE-MASTER.
 14398
 14399     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14400     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14401     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14402     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14403     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14404     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 14405     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 14406
 14407
 14408* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 268
* EL131.cbl
 14409*         NOTFND (5000-CERT-NOT-FOUND)
 14410*    END-EXEC.
 14411*    MOVE '"$I                   ! B #00012187' TO DFHEIV0
 14412     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14414     MOVE X'4220233030303132313837' TO DFHEIV0(25:11)
 14415     CALL 'kxdfhei1' USING DFHEIV0
 14416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14417
 14418
 14419
 14420* EXEC CICS READ
 14421*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14422*         DATASET  (CERT-FILE-ID)
 14423*         RIDFLD   (CERT-KEY)
 14424*    END-EXEC.
 14425*    MOVE '&"S        E          (   #00012191' TO DFHEIV0
 14426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14428     MOVE X'2020233030303132313931' TO DFHEIV0(25:11)
 14429     CALL 'kxdfhei1' USING DFHEIV0,
 14430           CERT-FILE-ID,
 14431           DFHEIV20,
 14432           DFHEIV99,
 14433           CERT-KEY,
 14434           DFHEIV99,
 14435           DFHEIV99,
 14436           DFHEIV99
 14437     SET ADDRESS OF CERTIFICATE-MASTER TO
 14438         DFHEIV20
 14439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14440
 14441
 14442     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 14443     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 14444
 14445     GO TO 5000-EXIT.
 14446
 14447 5000-TRLR-NOT-FOUND.
 14448     MOVE ER-7687                TO EMI-ERROR.
 14449     MOVE -1                     TO DIAGL.
 14450     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14451     GO TO 5000-EXIT.
 14452
 14453 5000-CERT-NOT-FOUND.
 14454     MOVE ER-0206                TO EMI-ERROR.
 14455     MOVE -1                     TO CERTL.
 14456     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14457
 14458 5000-EXIT.
 14459     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 269
* EL131.cbl
 14461 5010-RESET-PI-AREA.
 14462     IF CERTI GREATER THAN LOW-VALUES
 14463         MOVE CERTI              TO PI-CERT-PRIME.
 14464
 14465     IF SUFXI GREATER THAN LOW-VALUES
 14466         MOVE SUFXI              TO PI-CERT-SFX.
 14467
 14468     IF CERTEFFI GREATER THAN LOW-VALUES
 14469         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 14470
 14471     IF CERTACTI GREATER THAN LOW-VALUES
 14472         MOVE CERTACTI           TO PI-ACCOUNT.
 14473
 14474     IF CERTSTI GREATER THAN LOW-VALUES
 14475         MOVE CERTSTI            TO PI-STATE.
 14476
 14477     IF CERTCARI GREATER THAN LOW-VALUES
 14478         MOVE CERTCARI           TO PI-CARRIER.
 14479
 14480     IF CERTGRPI GREATER THAN LOW-VALUES
 14481         MOVE CERTGRPI           TO PI-GROUPING.
 14482
 14483 5010-EXIT.
 14484     EXIT.
 14485
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 270
* EL131.cbl
 14487 5020-MOVE-MSTR.
 14488
 14489     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14490     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14491     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14492     MOVE AL-SABON               TO SEQUA.
 14493     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14494     MOVE CL-CLAIM-TYPE          TO TYPEO
 14495                                    pi-claim-type
 14496
 14497     IF CL-TOTAL-PAID-AMT  = +0 AND
 14498        CL-LAST-PMT-AMT    = +0 AND
 14499        CL-NO-OF-PMTS-MADE = +0
 14500          MOVE AL-UANON          TO TYPEA.
 14501
 14502     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14503     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14504     MOVE CL-CERT-PRIME          TO CERTO.
 14505     MOVE CL-CERT-SFX            TO SUFXO.
 14506     MOVE CL-CERT-CARRIER        TO CARRO.
 14507
 14508     IF CL-CLAIM-STATUS = 'C'
 14509         MOVE 'CLOSED'           TO STATUSO
 14510     ELSE
 14511         MOVE 'OPEN  '           TO STATUSO.
 14512
 14513     move cl-accident-claim-sw   to accswo
 14514     if cl-benefit-period not numeric
 14515        move zeros               to cl-benefit-period
 14516     end-if
 14517     move cl-benefit-period      to benpero
 14518     move cl-insured-type        to instypeo
 14519     MOVE CL-PROCESSOR-ID        TO PROCO.
 14520
 14521     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 14522     MOVE CL-CCN                 TO CCNOO.
 14523
 14524     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 14525     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 14526     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 14527     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14528
 14529     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 14530         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14531         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14532         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14533         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 14534     ELSE
 14535         MOVE SPACES             TO BIRTHO.
 14536
 14537     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 14538        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 14539         NEXT SENTENCE
 14540       ELSE
 14541         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 14542
 14543     IF PI-COMPANY-ID = 'DMD'
 14544       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 271
* EL131.cbl
 14545          IF SOCIALO = SPACES OR LOW-VALUES
 14546            MOVE ER-0885         TO EMI-ERROR
 14547            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14548
 14549     MOVE CL-INSURED-OCC-CD      TO OCCO.
 14550*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14551
 14552*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 14553*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14554*        MOVE SPACES                 TO DC-OPTION-CODE
 14555*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14556*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 14557*    ELSE
 14558*        MOVE SPACES             TO ENDO.
 14559
 14560     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 14561        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14562        MOVE SPACES             TO DC-OPTION-CODE
 14563        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14564        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14565        IF PI-USES-PAID-TO
 14566           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14567           MOVE '6'                TO DC-OPTION-CODE
 14568           MOVE +1                 TO DC-ELAPSED-DAYS
 14569           MOVE +0                 TO DC-ELAPSED-MONTHS
 14570           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14571           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14572        ELSE
 14573           NEXT SENTENCE
 14574     ELSE
 14575        MOVE SPACES             TO PDTHRUO.
 14576
 14577     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 14578     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 14579     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 14580     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 14581
 14582     IF MODIFY-CAP
 14583        MOVE AL-UNNOF            TO PDAMTA
 14584                                    NODAYSA
 14585                                    NOPMTSA
 14586        MOVE AL-UANOF            TO PDTHRUA.
 14587     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 14588     MOVE '2'                    TO CNTL-REC-TYPE
 14589     MOVE +0                     TO CNTL-SEQ-NO
 14590     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 14591
 14592
 14593* EXEC CICS READ
 14594*         DATASET  (CNTL-FILE-ID)
 14595*         SET      (ADDRESS OF CONTROL-FILE)
 14596*         RIDFLD   (CNTL-KEY)
 14597*         RESP     (WS-RESPONSE)
 14598*    END-EXEC
 14599*    MOVE '&"S        E          (  N#00012347' TO DFHEIV0
 14600     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14601     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14602     MOVE X'204E233030303132333437' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 272
* EL131.cbl
 14603     CALL 'kxdfhei1' USING DFHEIV0,
 14604           CNTL-FILE-ID,
 14605           DFHEIV20,
 14606           DFHEIV99,
 14607           CNTL-KEY,
 14608           DFHEIV99,
 14609           DFHEIV99,
 14610           DFHEIV99
 14611     SET ADDRESS OF CONTROL-FILE TO
 14612         DFHEIV20
 14613     MOVE EIBRESP  TO WS-RESPONSE
 14614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14615
 14616     IF WS-RESP-NORMAL
 14617        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14618     end-if
 14619     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14620         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14621         MOVE SPACES             TO DC-OPTION-CODE
 14622         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14623         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14624     ELSE
 14625         MOVE SPACES             TO INCO.
 14626
 14627     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14628        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14629        MOVE AL-UANOF            TO INCA
 14630     end-if
 14631     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14632
 14633     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14634         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14635         MOVE SPACES             TO DC-OPTION-CODE
 14636         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14637         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14638     ELSE
 14639         MOVE SPACES             TO REPO.
 14640
 14641     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14642         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14643         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14644         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14645         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14646     ELSE
 14647         MOVE SPACES             TO ESTO.
 14648
 14649     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14650         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14651         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14652         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14653         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14654     ELSE
 14655         MOVE SPACES             TO MNTDTO.
 14656
 14657
 14658     IF CL-LAST-MAINT-TYPE = SPACE
 14659         MOVE 'SET-UP'           TO MNTTYPEO
 14660     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 273
* EL131.cbl
 14661     IF CL-LAST-MAINT-TYPE = '1'
 14662         MOVE 'PAYMNT'           TO MNTTYPEO
 14663     ELSE
 14664     IF CL-LAST-MAINT-TYPE = '2'
 14665         MOVE 'LETTER'           TO MNTTYPEO
 14666     ELSE
 14667     IF CL-LAST-MAINT-TYPE = '3'
 14668         MOVE 'UPDATE'           TO MNTTYPEO
 14669     ELSE
 14670     IF CL-LAST-MAINT-TYPE = '4'
 14671         MOVE 'RESTOR'           TO MNTTYPEO
 14672     ELSE
 14673     IF CL-LAST-MAINT-TYPE = '5'
 14674         MOVE 'INC DT'           TO MNTTYPEO
 14675     ELSE
 14676     IF CL-LAST-MAINT-TYPE = '6'
 14677         MOVE ' CONV'            TO MNTTYPEO
 14678     ELSE
 14679     IF CL-LAST-MAINT-TYPE = 'C'
 14680         MOVE 'CHGBEN'           TO MNTTYPEO
 14681     ELSE
 14682     IF CL-LAST-MAINT-TYPE = 'E'
 14683         MOVE 'ERRCOR'           TO MNTTYPEO
 14684     ELSE
 14685         MOVE SPACES             TO MNTTYPEO.
 14686
 14687     MOVE CL-BENEFICIARY         TO BENEO.
 14688     MOVE CL-FILE-LOCATION       TO FILETOO.
 14689     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14690        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14691     END-IF
 14692     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14693*    MOVE CL-CRIT-PER-RECURRENT
 14694*                                TO CRITPTO
 14695*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14696*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14697*    END-IF
 14698*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14699     MOVE CL-PRIORITY-CD         TO PRICDO.
 14700     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14701     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14702     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14703     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14704
 14705 5020-EXIT.
 14706     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 274
* EL131.cbl
 14708 5030-MOVE-CERT.
 14709
 14710     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14711         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14712         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14713         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14714         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14715       ELSE
 14716         MOVE SPACES             TO CERTEFFO
 14717         MOVE ZERO               TO HOLD-DATE.
 14718
 14719     MOVE CM-ACCOUNT             TO CERTACTO.
 14720     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14721     MOVE CM-GROUPING            TO CERTGRPO.
 14722     MOVE CM-CARRIER             TO CERTCARO.
 14723     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14724     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14725     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14726     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14727     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14728     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14729     MOVE CM-JT-INITIAL          TO JNTINITO.
 14730     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14731
 14732*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14733     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14734     MOVE '3'                    TO CNTL-REC-TYPE.
 14735     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14736     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14737     MOVE ZERO                   TO CNTL-SEQ-NO.
 14738
 14739
 14740* EXEC CICS READ
 14741*         SET        (ADDRESS OF CONTROL-FILE)
 14742*         DATASET    ('ELCNTL')
 14743*         RIDFLD     (CNTL-KEY)
 14744*         RESP       (WS-RESPONSE)
 14745*    END-EXEC.
 14746     MOVE 'ELCNTL' TO DFHEIV1
 14747*    MOVE '&"S        E          (  N#00012477' TO DFHEIV0
 14748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14750     MOVE X'204E233030303132343737' TO DFHEIV0(25:11)
 14751     CALL 'kxdfhei1' USING DFHEIV0,
 14752           DFHEIV1,
 14753           DFHEIV20,
 14754           DFHEIV99,
 14755           CNTL-KEY,
 14756           DFHEIV99,
 14757           DFHEIV99,
 14758           DFHEIV99
 14759     SET ADDRESS OF CONTROL-FILE TO
 14760         DFHEIV20
 14761     MOVE EIBRESP  TO WS-RESPONSE
 14762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14763
 14764
 14765     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 275
* EL131.cbl
 14766        MOVE ZERO                TO CP-FREE-LOOK
 14767     ELSE
 14768        MOVE CF-ST-FREE-LOOK-PERIOD
 14769                                 TO CP-FREE-LOOK.
 14770
 14771     IF CM-LF-BENEFIT-CD = '00'
 14772        GO TO 5030-MOVE-CERT-AH.
 14773
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 276
* EL131.cbl
 14775     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 14776     MOVE '5'                    TO DC-OPTION-CODE
 14777     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14778     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 14779     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14780     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 14781     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 14782     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14783     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14784     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 14785     MOVE '4'                    TO CP-REM-TERM-METHOD
 14786     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 14787     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14788     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14789
 14790     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14791     IF CM-LF-PREMIUM-RATE NUMERIC
 14792         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14793     ELSE
 14794         MOVE ZEROS              TO LCVRATEO.
 14795
 14796     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14797         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 14798
 14799     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 14800
 14801     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 14802
 14803     IF CM-LF-CURRENT-STATUS = '8'
 14804        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14805            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14806            MOVE ' '             TO DC-OPTION-CODE
 14807            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14808            IF NOT DATE-CONVERSION-ERROR
 14809                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14810
 14811     IF CM-LF-CURRENT-STATUS = '7'
 14812        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14813            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 14814            MOVE ' '             TO DC-OPTION-CODE
 14815            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14816            IF NOT DATE-CONVERSION-ERROR
 14817                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14818
 14819     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14820         MOVE ' '                TO DC-OPTION-CODE
 14821         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 14822         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14823         IF NOT DATE-CONVERSION-ERROR
 14824             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 14825             MOVE HOLD-MONTH     TO WORK-MONTH
 14826             MOVE HOLD-YEAR      TO WORK-YEAR
 14827             MOVE WORK-DATE-MY   TO LCVEXITO.
 14828
 14829     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14830        IF CP-REMAINING-TERM-3 = ZEROS
 14831           MOVE 'EXPIRED'        TO LCVSTATO
 14832        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 277
* EL131.cbl
 14833           MOVE 'ACTIVE'         TO LCVSTATO.
 14834
 14835     IF CM-LF-CURRENT-STATUS = '2'
 14836        MOVE 'PEND   '           TO LCVSTATO.
 14837     IF CM-LF-CURRENT-STATUS = '3'
 14838        MOVE 'RESTORE'           TO LCVSTATO.
 14839     IF CM-LF-CURRENT-STATUS = '5'
 14840        MOVE 'REISSUE'           TO LCVSTATO.
 14841     IF CM-LF-CURRENT-STATUS = '6'
 14842        MOVE 'LMP DIS'           TO LCVSTATO.
 14843     IF CM-LF-CURRENT-STATUS = '7'
 14844        MOVE 'DEATH  '           TO LCVSTATO.
 14845     IF CM-LF-CURRENT-STATUS = '8'
 14846        MOVE 'CANCEL '           TO LCVSTATO.
 14847     IF CM-LF-CURRENT-STATUS = '9'
 14848        MOVE 'RE-ONLY'           TO LCVSTATO.
 14849     IF CM-LF-CURRENT-STATUS = 'V'
 14850        MOVE 'VOID   '           TO LCVSTATO.
 14851     IF CM-LF-CURRENT-STATUS = 'D'
 14852        MOVE 'DECLINE'           TO LCVSTATO.
 14853
 14854     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14855     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14856     MOVE '4'                    TO BEN-REC-TYPE.
 14857     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 14858     MOVE ZERO                   TO BEN-SEQ-NO.
 14859
 14860
 14861* EXEC CICS READ GTEQ
 14862*         DATASET  (CNTL-FILE-ID)
 14863*         RIDFLD   (BENEFIT-KEY)
 14864*         SET      (ADDRESS OF CONTROL-FILE)
 14865*    END-EXEC.
 14866*    MOVE '&"S        G          (   #00012579' TO DFHEIV0
 14867     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14869     MOVE X'2020233030303132353739' TO DFHEIV0(25:11)
 14870     CALL 'kxdfhei1' USING DFHEIV0,
 14871           CNTL-FILE-ID,
 14872           DFHEIV20,
 14873           DFHEIV99,
 14874           BENEFIT-KEY,
 14875           DFHEIV99,
 14876           DFHEIV99,
 14877           DFHEIV99
 14878     SET ADDRESS OF CONTROL-FILE TO
 14879         DFHEIV20
 14880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14881
 14882
 14883     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14884        CF-RECORD-TYPE NOT = '4'
 14885         MOVE ER-0240            TO EMI-ERROR
 14886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14887         GO TO 5030-MOVE-CERT-FINISH.
 14888
 14889     MOVE ZERO                   TO COUNT-2.
 14890     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 278
* EL131.cbl
 14891
 14892     IF SCREEN-ERROR
 14893         MOVE ER-0282            TO EMI-ERROR
 14894         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14895        ELSE
 14896         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 14897
 14898 5030-MOVE-CERT-AH.
 14899
 14900     IF CM-LF-BENEFIT-CD = '00'
 14901         IF CM-AH-BENEFIT-CD = '00'
 14902             GO TO 5030-MOVE-CERT-FINISH.
 14903
 14904     IF CM-AH-BENEFIT-CD = '00'
 14905        MOVE SPACES             TO ACVKINDO
 14906        COMPUTE PI-PAYMENT-AMT =
 14907                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 14908        GO TO 5030-MOVE-CERT-FINISH.
 14909
 14910     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14911     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 14912     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 14913     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 14914     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14915     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14916     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14917     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 14918
 14919**DMD **********************************************
 14920     IF PI-COMPANY-ID = 'DMD'
 14921         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 14922                                   CM-PMT-EXTENSION-DAYS
 14923         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 14924                                      CL-NO-OF-DAYS-PAID
 14925         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 14926             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 14927         MOVE WS-REM-MOS         TO ACVRTRMO
 14928                                    CP-REMAINING-TERM-3
 14929*        MOVE WS-REM-DAYS        TO DAYSPO
 14930         GO TO 5030-SKIP-RTRM.
 14931**DMD **********************************************
 14932
 14933     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14934     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14935     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14936     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14937
 14938 5030-SKIP-RTRM.
 14939     IF CM-AH-PREMIUM-RATE NUMERIC
 14940         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14941     ELSE
 14942         MOVE ZEROS              TO ACVRATEO.
 14943
 14944     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 14945     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 14946
 14947     IF CM-AH-CURRENT-STATUS = '8'
 14948        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 279
* EL131.cbl
 14949            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14950            MOVE ' '             TO DC-OPTION-CODE
 14951            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14952            IF NOT DATE-CONVERSION-ERROR
 14953                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14954
 14955     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14956        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14957            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 14958            MOVE ' '             TO DC-OPTION-CODE
 14959            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14960            IF NOT DATE-CONVERSION-ERROR
 14961                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14962
 14963     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14964        IF CP-REMAINING-TERM-3 = ZEROS
 14965           MOVE 'EXPIRED'        TO ACVSTATO
 14966        ELSE
 14967           MOVE 'ACTIVE'         TO ACVSTATO.
 14968
 14969     IF CM-AH-CURRENT-STATUS = '2'
 14970        MOVE 'PEND   '           TO ACVSTATO.
 14971     IF CM-AH-CURRENT-STATUS = '3'
 14972        MOVE 'RESTORE'           TO ACVSTATO.
 14973     IF CM-AH-CURRENT-STATUS = '5'
 14974        MOVE 'REISSUE'           TO ACVSTATO.
 14975     IF CM-AH-CURRENT-STATUS = '6'
 14976        MOVE 'LMP DIS'           TO ACVSTATO.
 14977     IF CM-AH-CURRENT-STATUS = '7'
 14978        MOVE 'DEATH  '           TO ACVSTATO.
 14979     IF CM-AH-CURRENT-STATUS = '8'
 14980        MOVE 'CANCEL '           TO ACVSTATO.
 14981     IF CM-AH-CURRENT-STATUS = '9'
 14982        MOVE 'RE-ONLY'           TO ACVSTATO.
 14983     IF CM-AH-CURRENT-STATUS = 'V'
 14984        MOVE 'VOID   '           TO ACVSTATO.
 14985     IF CM-AH-CURRENT-STATUS = '9'
 14986        MOVE 'DECLINE'           TO ACVSTATO.
 14987
 14988     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14989         MOVE ' '                TO DC-OPTION-CODE
 14990         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14991         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14992         IF NOT DATE-CONVERSION-ERROR
 14993             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 14994             MOVE HOLD-MONTH     TO WORK-MONTH
 14995             MOVE HOLD-YEAR      TO WORK-YEAR
 14996             MOVE WORK-DATE-MY   TO ACVEXITO.
 14997
 14998     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14999
 15000     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15001     MOVE '5'                    TO BEN-REC-TYPE.
 15002     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15003     MOVE ZERO                   TO BEN-SEQ-NO.
 15004
 15005
 15006* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 280
* EL131.cbl
 15007*         DATASET  (CNTL-FILE-ID)
 15008*         RIDFLD   (BENEFIT-KEY)
 15009*         SET      (ADDRESS OF CONTROL-FILE)
 15010*    END-EXEC.
 15011*    MOVE '&"S        G          (   #00012707' TO DFHEIV0
 15012     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15014     MOVE X'2020233030303132373037' TO DFHEIV0(25:11)
 15015     CALL 'kxdfhei1' USING DFHEIV0,
 15016           CNTL-FILE-ID,
 15017           DFHEIV20,
 15018           DFHEIV99,
 15019           BENEFIT-KEY,
 15020           DFHEIV99,
 15021           DFHEIV99,
 15022           DFHEIV99
 15023     SET ADDRESS OF CONTROL-FILE TO
 15024         DFHEIV20
 15025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15026
 15027
 15028     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15029        CF-RECORD-TYPE NOT = '5'
 15030         MOVE ER-0250            TO EMI-ERROR
 15031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15032         GO TO 5030-MOVE-CERT-FINISH.
 15033
 15034     MOVE ZERO                   TO COUNT-2.
 15035     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15036
 15037     IF SCREEN-ERROR
 15038         MOVE ER-0283            TO EMI-ERROR
 15039         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15040       ELSE
 15041         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15042
 15043 5030-MOVE-CERT-FINISH.
 15044
 15045     MOVE CM-LOAN-APR            TO APRO.
 15046     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15047     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15048     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15049     MOVE CM-LOAN-NUMBER         TO LOANNOO
 15050     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15051     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15052
 15053     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15054         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15055         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15056         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15057         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15058     ELSE
 15059         MOVE SPACES               TO ADDONDTO.
 15060
 15061     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15062
 15063 5030-EXIT.
 15064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 281
* EL131.cbl
 15066 5040-FIND-BENEFIT.
 15067     ADD 1                       TO COUNT-2.
 15068     IF COUNT-2 GREATER THAN 8
 15069         GO TO 5050-BENEFIT-NOTFND.
 15070
 15071     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15072         GO TO 5060-EXIT.
 15073
 15074     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15075         GO TO 5050-BENEFIT-NOTFND.
 15076
 15077     GO TO 5040-FIND-BENEFIT.
 15078
 15079 5050-BENEFIT-NOTFND.
 15080     MOVE 'X'                    TO ERROR-SWITCH.
 15081
 15082 5060-EXIT.
 15083     EXIT.
 15084
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 282
* EL131.cbl
 15086 6000-CALCULATE-CERT-TERM.
 15087
 15088     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15089         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15090     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15091         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15092     IF CM-LOAN-APR NOT NUMERIC
 15093         MOVE ZEROS              TO CM-LOAN-APR.
 15094
 15095*    IF WS-CALC-METHOD  = 'G'
 15096         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15097*     ELSE
 15098*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15099
 15100     IF N GREATER 120
 15101         MOVE 120                TO N.
 15102
 15103     MOVE '6'                    TO DC-OPTION-CODE.
 15104     MOVE N                      TO DC-ELAPSED-MONTHS.
 15105     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15106     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15107
 15108     IF CM-LF-BENEFIT-CD NOT = ZERO
 15109         MOVE N                  TO CM-LF-ORIG-TERM
 15110         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15111         IF NO-CONVERSION-ERROR
 15112             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15113
 15114     IF CM-AH-BENEFIT-CD NOT = ZERO
 15115         MOVE N                  TO CM-AH-ORIG-TERM
 15116         IF NO-CONVERSION-ERROR
 15117             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15118
 15119 6000-EXIT.
 15120      EXIT.
 15121
 15122 6100-CALC-GROSS-TERM.
 15123     MOVE CM-LOAN-BALANCE         TO L.
 15124     MOVE PI-PAYMENT-AMT          TO M.
 15125
 15126     COMPUTE N = L / M.
 15127     IF N LESS 1
 15128         MOVE 1  TO N.
 15129
 15130     IF CM-LF-BENEFIT-CD NOT = ZERO
 15131         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15132     ELSE
 15133         MOVE ZEROS               TO WS-LF-RATE.
 15134
 15135     IF CM-AH-BENEFIT-CD NOT = ZERO
 15136         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15137     ELSE
 15138         MOVE ZEROS               TO WS-AH-RATE.
 15139
 15140     COMPUTE I = CM-LOAN-APR / +1200.
 15141
 15142 6105-LOOP.
 15143     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 283
* EL131.cbl
 15144         GO TO 6200-EXIT.
 15145     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15146     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15147         ADD 1 TO N
 15148         GO TO 6105-LOOP.
 15149
 15150 6200-EXIT.
 15151      EXIT.
 15152
 15153 6210-CALC-LEFT-RIGHTONE.
 15154      MOVE L         TO LEFT-TOT-1.
 15155      SUBTRACT 1 FROM N.
 15156      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15157      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15158      ADD 1 TO N.
 15159 6211-CALC-TERM1.
 15160      MOVE N         TO TERM1.
 15161      MULTIPLY M BY TERM1.
 15162 6212-LOOP.
 15163      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15164      ADD 1 TO A-N.
 15165      MULTIPLY A-N BY TERM1.
 15166      SUBTRACT 1 FROM A-N.
 15167      ADD TERM1 TO LEFT-TOT-1.
 15168 6213-CALC-TERM2.
 15169      MOVE M         TO TERM2.
 15170      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15171      MULTIPLY IA-N BY TERM2.
 15172      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15173 6215-CALC-RIGHTONE.
 15174      MOVE M         TO RIGHT-TOT-1.
 15175      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15176      MULTIPLY A-N BY RIGHT-TOT-1.
 15177 6220-EXIT.
 15178      EXIT.
 15179
 15180 6300-CALC-A-N.
 15181     IF N LESS 1
 15182         MOVE 0     TO A-N
 15183         GO TO 6300-EXIT.
 15184     IF I = 0
 15185         MOVE .00001 TO I.
 15186     ADD 1 TO I.
 15187     DIVIDE I INTO 1 GIVING V.
 15188     SUBTRACT 1 FROM I.
 15189     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15190     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15191     DIVIDE I INTO TERM3 GIVING A-N.
 15192 6300-EXIT.
 15193      EXIT.
 15194
 15195 6350-CALC-IA-N.
 15196     IF N LESS 1
 15197         MOVE 0      TO IA-N
 15198         GO TO 6400-EXIT.
 15199     ADD 1 TO N.
 15200     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15201     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 284
* EL131.cbl
 15202     MULTIPLY N BY V-EX-N GIVING TERM3.
 15203     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15204     SUBTRACT V FROM 1 GIVING TERM4.
 15205     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15206 6400-EXIT.
 15207      EXIT.
 15208
 15209 6450-CALC-V-EX-N.
 15210     IF N LESS 1
 15211         MOVE 1    TO V-EX-N
 15212         GO TO 6490-EXIT.
 15213     MOVE N        TO NV-STORE.
 15214     IF V-EX-ONETIME = 1  OR
 15215        V NOT = V-EXPONENT (1)
 15216          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15217 6460-LOOP.
 15218     IF N GREATER 248
 15219         MOVE 248 TO N.
 15220     IF N = 1
 15221         MOVE V               TO V-EX-N
 15222      ELSE
 15223         MOVE V-EXPONENT (N)  TO V-EX-N.
 15224     GO TO 6490-EXIT.
 15225
 15226 6470-BUILD-V-EX-TABLE.
 15227     MOVE 2      TO N.
 15228     MOVE V      TO V-EXPONENT (1)
 15229                    V-EX-N.
 15230 6471-LOOP.
 15231     MULTIPLY V BY V-EX-N.
 15232     MOVE V-EX-N   TO V-EXPONENT (N).
 15233     ADD 1 TO N.
 15234     IF N LESS 248
 15235         GO TO 6471-LOOP.
 15236     MOVE NV-STORE     TO N.
 15237     MOVE 0            TO V-EX-ONETIME.
 15238 6480-EXIT.
 15239      EXIT.
 15240
 15241 6490-EXIT.
 15242      EXIT.
 15243
 15244 6500-CALC-NET-TERM.
 15245     MOVE CM-LOAN-BALANCE         TO L.
 15246     MOVE PI-PAYMENT-AMT          TO M.
 15247
 15248     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15249     IF WS-REMAIN GREATER ZERO
 15250         ADD 1 TO N.
 15251     IF N = 0
 15252         MOVE 1 TO N.
 15253
 15254 6700-EXIT.
 15255      EXIT.
 15256
 15257 6999-CALC-TERM-EXIT.
 15258     EXIT.
 15259
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 285
* EL131.cbl
 15261 7000-RESET-ATTRIBUTE.
 15262
 15263     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15264                                    CERTSTA   CERTCARA
 15265                                    CERTGRPA.
 15266     MOVE -1                     TO CERTCARL.
 15267
 15268 7000-EXIT.
 15269     EXIT.
 15270
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 286
* EL131.cbl
 15272 7600-BROWSE-CLAIM.
 15273
 15274
 15275* EXEC CICS READ
 15276*        DATASET(CLMS-FILE-ID)
 15277*        SET    (ADDRESS OF CLAIM-MASTER)
 15278*        RIDFLD (MSTR-KEY)
 15279*        GENERIC
 15280*        EQUAL
 15281*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15282*    END-EXEC.
 15283*    MOVE '&"S  KG    E          (   #00012959' TO DFHEIV0
 15284     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15285     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15286     MOVE X'2020233030303132393539' TO DFHEIV0(25:11)
 15287     CALL 'kxdfhei1' USING DFHEIV0,
 15288           CLMS-FILE-ID,
 15289           DFHEIV20,
 15290           DFHEIV99,
 15291           MSTR-KEY,
 15292           ELMSTR-GENERIC-LENGTH,
 15293           DFHEIV99,
 15294           DFHEIV99
 15295     SET ADDRESS OF CLAIM-MASTER TO
 15296         DFHEIV20
 15297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15298
 15299
 15300     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15301
 15302     if cl-assoc-cert-total = 0
 15303        move 1 to cl-assoc-cert-total
 15304     end-if
 15305     IF CL-ASSOC-CERT-SEQU = 0
 15306        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15307     END-IF
 15308
 15309     IF CL-ASSOC-CERT-TOTAL = 1
 15310         MOVE AL-SADOF           TO BCERT1A
 15311                                    BSUFX1A
 15312                                    BCERT2A
 15313                                    BSUFX2A
 15314                                    BCERT3A
 15315                                    BSUFX3A
 15316                                    BCERT4A
 15317                                    BSUFX4A
 15318                                    BCERT5A
 15319                                    BSUFX5A
 15320                                    PCERTNOA
 15321                                    PSUFXA
 15322                                    LABEL1A
 15323                                    LABEL2A
 15324         GO TO 7699-EXIT.
 15325
 15326 7610-BROWSE-CLAIM-LOOP.
 15327
 15328     MOVE LOW-VALUES             TO BCERT1O
 15329                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 287
* EL131.cbl
 15330                                    BCERT2O
 15331                                    BSUFX2O
 15332                                    BCERT3O
 15333                                    BSUFX3O
 15334                                    BCERT4O
 15335                                    BSUFX4O
 15336                                    BCERT5O
 15337                                    BSUFX5O.
 15338
 15339
 15340* EXEC CICS HANDLE CONDITION
 15341*        ENDFILE  (7630-END-BROWSE)
 15342*    END-EXEC.
 15343*    MOVE '"$''                   ! C #00013007' TO DFHEIV0
 15344     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15346     MOVE X'4320233030303133303037' TO DFHEIV0(25:11)
 15347     CALL 'kxdfhei1' USING DFHEIV0
 15348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15349
 15350
 15351
 15352* EXEC CICS STARTBR
 15353*        DATASET    (CLMS-FILE-ID)
 15354*        RIDFLD     (MSTR-KEY)
 15355*    END-EXEC.
 15356     MOVE 0
 15357       TO DFHEIV11
 15358*    MOVE '&,         G          &   #00013011' TO DFHEIV0
 15359     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15360     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15361     MOVE X'2020233030303133303131' TO DFHEIV0(25:11)
 15362     CALL 'kxdfhei1' USING DFHEIV0,
 15363           CLMS-FILE-ID,
 15364           MSTR-KEY,
 15365           DFHEIV99,
 15366           DFHEIV11,
 15367           DFHEIV99
 15368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15369
 15370
 15371     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15372
 15373 7620-READ-CLAIM-LOOP.
 15374
 15375
 15376* EXEC CICS READNEXT
 15377*        DATASET   (CLMS-FILE-ID)
 15378*        SET       (ADDRESS OF CLAIM-MASTER)
 15379*        RIDFLD    (MSTR-KEY)
 15380*    END-EXEC.
 15381     MOVE 0
 15382       TO DFHEIV11
 15383*    MOVE '&.S                   )   #00013020' TO DFHEIV0
 15384     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15385     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15386     MOVE X'2020233030303133303230' TO DFHEIV0(25:11)
 15387     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 288
* EL131.cbl
 15388           CLMS-FILE-ID,
 15389           DFHEIV20,
 15390           DFHEIV99,
 15391           MSTR-KEY,
 15392           DFHEIV99,
 15393           DFHEIV11,
 15394           DFHEIV99,
 15395           DFHEIV99
 15396     SET ADDRESS OF CLAIM-MASTER TO
 15397         DFHEIV20
 15398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15399
 15400
 15401     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 15402        CL-CARRIER     NOT = CARRI           OR
 15403        CL-CLAIM-NO    NOT = CLAIMI
 15404        GO TO 7630-END-BROWSE.
 15405
 15406     IF WS-ASSOCIATED-CERTS = 1
 15407         MOVE CL-CERT-PRIME      TO BCERT1O
 15408         MOVE CL-CERT-SFX        TO BSUFX1O.
 15409
 15410     IF WS-ASSOCIATED-CERTS = 2
 15411         MOVE CL-CERT-PRIME      TO BCERT2O
 15412         MOVE CL-CERT-SFX        TO BSUFX2O.
 15413
 15414     IF WS-ASSOCIATED-CERTS = 3
 15415         MOVE CL-CERT-PRIME      TO BCERT3O
 15416         MOVE CL-CERT-SFX        TO BSUFX3O.
 15417
 15418     IF WS-ASSOCIATED-CERTS = 4
 15419         MOVE CL-CERT-PRIME      TO BCERT4O
 15420         MOVE CL-CERT-SFX        TO BSUFX4O.
 15421
 15422     IF WS-ASSOCIATED-CERTS = 5
 15423         MOVE CL-CERT-PRIME      TO BCERT5O
 15424         MOVE CL-CERT-SFX        TO BSUFX5O
 15425     ELSE
 15426         ADD +1                  TO WS-ASSOCIATED-CERTS
 15427         GO TO 7620-READ-CLAIM-LOOP.
 15428
 15429 7630-END-BROWSE.
 15430
 15431
 15432* EXEC CICS ENDBR
 15433*        DATASET   (CLMS-FILE-ID)
 15434*    END-EXEC.
 15435     MOVE 0
 15436       TO DFHEIV11
 15437*    MOVE '&2                    $   #00013056' TO DFHEIV0
 15438     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15439     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15440     MOVE X'2020233030303133303536' TO DFHEIV0(25:11)
 15441     CALL 'kxdfhei1' USING DFHEIV0,
 15442           CLMS-FILE-ID,
 15443           DFHEIV11,
 15444           DFHEIV99
 15445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 289
* EL131.cbl
 15446
 15447
 15448 7640-HIGHLIGHT-CERT-DISPLAYED.
 15449
 15450     MOVE AL-SANON               TO BCERT1A
 15451                                    BSUFX1A
 15452                                    BCERT2A
 15453                                    BSUFX2A
 15454                                    BCERT3A
 15455                                    BSUFX3A
 15456                                    BCERT4A
 15457                                    BSUFX4A
 15458                                    BCERT5A
 15459                                    BSUFX5A.
 15460
 15461     IF BCERT1O = CERTI AND
 15462        BSUFX1O = SUFXI
 15463            MOVE AL-SABON        TO BCERT1A
 15464                                    BSUFX1A.
 15465
 15466     IF BCERT2O = CERTI AND
 15467        BSUFX2O = SUFXI
 15468            MOVE AL-SABON        TO BCERT2A
 15469                                    BSUFX2A.
 15470
 15471     IF BCERT3O = CERTI AND
 15472        BSUFX3O = SUFXI
 15473            MOVE AL-SABON        TO BCERT3A
 15474                                    BSUFX3A.
 15475
 15476     IF BCERT4O = CERTI AND
 15477        BSUFX4O = SUFXI
 15478            MOVE AL-SABON        TO BCERT4A
 15479                                    BSUFX4A.
 15480
 15481     IF BCERT5O = CERTI AND
 15482        BSUFX5O = SUFXI
 15483            MOVE AL-SABON        TO BCERT5A
 15484                                    BSUFX5A.
 15485
 15486 7699-EXIT.
 15487     EXIT.
 15488
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 290
* EL131.cbl
 15490 7700-CHECK-SEQUENCE.
 15491
 15492
 15493* EXEC CICS HANDLE CONDITION
 15494*        ENDFILE  (7799-EXIT)
 15495*        NOTFND   (7799-EXIT)
 15496*    END-EXEC.
 15497*    MOVE '"$''I                  ! D #00013104' TO DFHEIV0
 15498     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15500     MOVE X'4420233030303133313034' TO DFHEIV0(25:11)
 15501     CALL 'kxdfhei1' USING DFHEIV0
 15502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15503
 15504
 15505
 15506* EXEC CICS READ
 15507*        DATASET(CLMS-FILE-ID)
 15508*        SET    (ADDRESS OF CLAIM-MASTER)
 15509*        RIDFLD (MSTR-KEY)
 15510*        GENERIC
 15511*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15512*    END-EXEC.
 15513*    MOVE '&"S  KG    E          (   #00013109' TO DFHEIV0
 15514     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15516     MOVE X'2020233030303133313039' TO DFHEIV0(25:11)
 15517     CALL 'kxdfhei1' USING DFHEIV0,
 15518           CLMS-FILE-ID,
 15519           DFHEIV20,
 15520           DFHEIV99,
 15521           MSTR-KEY,
 15522           ELMSTR-GENERIC-LENGTH,
 15523           DFHEIV99,
 15524           DFHEIV99
 15525     SET ADDRESS OF CLAIM-MASTER TO
 15526         DFHEIV20
 15527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15528
 15529
 15530     COMPUTE WS-ASSOC-CERT-TOTAL =
 15531             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15532
 15533     GO TO 7799-EXIT.
 15534
 15535 7710-RESEQUENCE-CLAIMS.
 15536
 15537
 15538* EXEC CICS HANDLE CONDITION
 15539*        ENDFILE  (7799-EXIT)
 15540*    END-EXEC.
 15541*    MOVE '"$''                   ! E #00013124' TO DFHEIV0
 15542     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15544     MOVE X'4520233030303133313234' TO DFHEIV0(25:11)
 15545     CALL 'kxdfhei1' USING DFHEIV0
 15546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15547
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 291
* EL131.cbl
 15548
 15549
 15550* EXEC CICS STARTBR
 15551*        DATASET(CLMS-FILE-ID)
 15552*        RIDFLD (MSTR-KEY)
 15553*    END-EXEC.
 15554     MOVE 0
 15555       TO DFHEIV11
 15556*    MOVE '&,         G          &   #00013128' TO DFHEIV0
 15557     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15558     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15559     MOVE X'2020233030303133313238' TO DFHEIV0(25:11)
 15560     CALL 'kxdfhei1' USING DFHEIV0,
 15561           CLMS-FILE-ID,
 15562           MSTR-KEY,
 15563           DFHEIV99,
 15564           DFHEIV11,
 15565           DFHEIV99
 15566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15567
 15568
 15569     COMPUTE WS-ASSOC-CERT-SEQU =
 15570             WS-ASSOC-CERT-SEQU + 1.
 15571
 15572     COMPUTE WS-READNEXT-SWITCH =
 15573             WS-READNEXT-SWITCH + 1.
 15574
 15575 7720-READ-CLAIM-LOOP.
 15576
 15577
 15578* EXEC CICS READNEXT
 15579*        DATASET(CLMS-FILE-ID)
 15580*        SET    (ADDRESS OF CLAIM-MASTER)
 15581*        RIDFLD (MSTR-KEY)
 15582*    END-EXEC.
 15583     MOVE 0
 15584       TO DFHEIV11
 15585*    MOVE '&.S                   )   #00013141' TO DFHEIV0
 15586     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15587     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15588     MOVE X'2020233030303133313431' TO DFHEIV0(25:11)
 15589     CALL 'kxdfhei1' USING DFHEIV0,
 15590           CLMS-FILE-ID,
 15591           DFHEIV20,
 15592           DFHEIV99,
 15593           MSTR-KEY,
 15594           DFHEIV99,
 15595           DFHEIV11,
 15596           DFHEIV99,
 15597           DFHEIV99
 15598     SET ADDRESS OF CLAIM-MASTER TO
 15599         DFHEIV20
 15600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15601
 15602
 15603     IF WS-READNEXT-SWITCH = 1
 15604         ADD 1                   TO WS-READNEXT-SWITCH
 15605         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 292
* EL131.cbl
 15606
 15607 7730-END-BROWSE.
 15608
 15609
 15610* EXEC CICS ENDBR
 15611*        DATASET(CLMS-FILE-ID)
 15612*    END-EXEC.
 15613     MOVE 0
 15614       TO DFHEIV11
 15615*    MOVE '&2                    $   #00013153' TO DFHEIV0
 15616     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15617     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15618     MOVE X'2020233030303133313533' TO DFHEIV0(25:11)
 15619     CALL 'kxdfhei1' USING DFHEIV0,
 15620           CLMS-FILE-ID,
 15621           DFHEIV11,
 15622           DFHEIV99
 15623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15624
 15625
 15626 7740-READ-CLAIM-UPDATE.
 15627
 15628     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15629        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15630        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15631        GO TO 7799-EXIT
 15632     ELSE
 15633        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15634
 15635
 15636* EXEC CICS READ
 15637*        DATASET(CLMS-FILE-ID)
 15638*        SET    (ADDRESS OF CLAIM-MASTER)
 15639*        RIDFLD (MSTR-KEY)
 15640*        UPDATE
 15641*    END-EXEC.
 15642*    MOVE '&"S        EU         (   #00013166' TO DFHEIV0
 15643     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15644     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15645     MOVE X'2020233030303133313636' TO DFHEIV0(25:11)
 15646     CALL 'kxdfhei1' USING DFHEIV0,
 15647           CLMS-FILE-ID,
 15648           DFHEIV20,
 15649           DFHEIV99,
 15650           MSTR-KEY,
 15651           DFHEIV99,
 15652           DFHEIV99,
 15653           DFHEIV99
 15654     SET ADDRESS OF CLAIM-MASTER TO
 15655         DFHEIV20
 15656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15657
 15658
 15659     if (cl-priority-cd = '8')
 15660        and (pi-processor-id not = 'PEMA' and 'JMS '
 15661             AND 'AMWA')
 15662        MOVE ER-8003             TO EMI-ERROR
 15663        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 293
* EL131.cbl
 15664                                 THRU 9900-EXIT
 15665        MOVE -1                  TO MAINTL
 15666        GO TO 8110-SEND-DATA
 15667     end-if
 15668
 15669     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15670         MOVE 'Y'                TO CL-YESNOSW
 15671     END-IF.
 15672
 15673     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15674     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15675
 15676
 15677* EXEC CICS REWRITE
 15678*         DATASET(CLMS-FILE-ID)
 15679*         FROM   (CLAIM-MASTER)
 15680*    END-EXEC.
 15681     MOVE LENGTH OF
 15682      CLAIM-MASTER
 15683       TO DFHEIV11
 15684*    MOVE '&& L                  %   #00013190' TO DFHEIV0
 15685     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15686     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15687     MOVE X'2020233030303133313930' TO DFHEIV0(25:11)
 15688     CALL 'kxdfhei1' USING DFHEIV0,
 15689           CLMS-FILE-ID,
 15690           CLAIM-MASTER,
 15691           DFHEIV11,
 15692           DFHEIV99
 15693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15694
 15695
 15696     GO TO 7710-RESEQUENCE-CLAIMS.
 15697
 15698 7799-EXIT.
 15699     EXIT.
 15700
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 294
* EL131.cbl
 15702 7800-CHECK-AUTO-ACTIVITY.
 15703
 15704
 15705* EXEC CICS HANDLE CONDITION
 15706*        NOTFND   (7800-NOT-FOUND)
 15707*    END-EXEC.
 15708*    MOVE '"$I                   ! F #00013203' TO DFHEIV0
 15709     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15711     MOVE X'4620233030303133323033' TO DFHEIV0(25:11)
 15712     CALL 'kxdfhei1' USING DFHEIV0
 15713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15714
 15715
 15716     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15717     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15718     MOVE SPACES                     TO  CNTL-PROC-ID.
 15719     MOVE +0                         TO  CNTL-SEQ-NO.
 15720
 15721
 15722* EXEC CICS READ
 15723*        DATASET   (CNTL-FILE-ID)
 15724*        RIDFLD    (CNTL-KEY)
 15725*        SET       (ADDRESS OF CONTROL-FILE)
 15726*    END-EXEC.
 15727*    MOVE '&"S        E          (   #00013212' TO DFHEIV0
 15728     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15729     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15730     MOVE X'2020233030303133323132' TO DFHEIV0(25:11)
 15731     CALL 'kxdfhei1' USING DFHEIV0,
 15732           CNTL-FILE-ID,
 15733           DFHEIV20,
 15734           DFHEIV99,
 15735           CNTL-KEY,
 15736           DFHEIV99,
 15737           DFHEIV99,
 15738           DFHEIV99
 15739     SET ADDRESS OF CONTROL-FILE TO
 15740         DFHEIV20
 15741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15742
 15743
 15744     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15745         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15746
 15747     IF CL-ACTIVITY-CODE NOT = ZEROS
 15748         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15749         IF MISC-SUB IS GREATER THAN +9
 15750             SUBTRACT +9 FROM MISC-SUB
 15751             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15752         ELSE
 15753             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15754     ELSE
 15755         MOVE 'Y'                              TO  WS-RESET-SW.
 15756
 15757     IF STATUSI = 'C' OR 'CLOSED'
 15758         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15759             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 295
* EL131.cbl
 15760                                         PI-LETTER-SW
 15761             GO TO 7800-EXIT.
 15762
 15763     IF STATUSI = 'C' OR 'CLOSED'
 15764         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15765             MOVE 'N'                TO  PI-LETTER-SW
 15766         ELSE
 15767             MOVE 'Y'                TO  PI-LETTER-SW.
 15768
 15769     IF STATUSI = 'O' OR 'OPEN'
 15770         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 15771             MOVE 'N'                TO  PI-REC-FOUND-SW
 15772                                         PI-LETTER-SW
 15773             GO TO 7800-EXIT.
 15774
 15775     IF STATUSI = 'O' OR 'OPEN'
 15776         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 15777             MOVE 'N'                TO  PI-LETTER-SW
 15778         ELSE
 15779             MOVE 'Y'                TO  PI-LETTER-SW.
 15780
 15781     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 15782     GO TO 7800-EXIT.
 15783
 15784 7800-NOT-FOUND.
 15785
 15786     MOVE 'N'                        TO  PI-REC-FOUND-SW
 15787                                         PI-LETTER-SW.
 15788
 15789 7800-EXIT.
 15790     EXIT.
 15791
 15792 7850-AUTO-LETTER-WRITER.
 15793
 15794     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 15795     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 15796
 15797     IF STATUSI = 'C' OR 'CLOSED'
 15798         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 15799     ELSE
 15800         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 15801
 15802     IF STATUSI = 'C' OR 'CLOSED'
 15803         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 15804             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15805             MOVE '6'                TO  DC-OPTION-CODE
 15806             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 15807             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15808             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15809             IF NO-CONVERSION-ERROR
 15810                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15811             ELSE
 15812                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15813
 15814     IF STATUSI = 'C' OR 'CLOSED'
 15815         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 15816             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15817             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 296
* EL131.cbl
 15818             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 15819             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15820             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15821             IF NO-CONVERSION-ERROR
 15822                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15823             ELSE
 15824                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15825
 15826     IF STATUSI = 'O' OR 'OPEN'
 15827         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 15828             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15829             MOVE '6'                TO  DC-OPTION-CODE
 15830             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 15831             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15832             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15833             IF NO-CONVERSION-ERROR
 15834                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15835             ELSE
 15836                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15837
 15838     IF STATUSI = 'O' OR 'OPEN'
 15839         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 15840             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15841             MOVE '6'                TO  DC-OPTION-CODE
 15842             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 15843             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15844             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15845             IF NO-CONVERSION-ERROR
 15846                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15847             ELSE
 15848                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15849
 15850
 15851* EXEC CICS LINK
 15852*        PROGRAM    (LINK-1523)
 15853*        COMMAREA   (W-1523-LINKDATA)
 15854*        LENGTH     (W-1523-COMM-LENGTH)
 15855*    END-EXEC.
 15856*    MOVE '."C                   (   #00013324' TO DFHEIV0
 15857     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15858     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15859     MOVE X'2020233030303133333234' TO DFHEIV0(25:11)
 15860     CALL 'kxdfhei1' USING DFHEIV0,
 15861           LINK-1523,
 15862           W-1523-LINKDATA,
 15863           W-1523-COMM-LENGTH,
 15864           DFHEIV99,
 15865           DFHEIV99,
 15866           DFHEIV99,
 15867           DFHEIV99
 15868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15869
 15870
 15871     IF W-1523-ERROR-CODE = ZEROS
 15872         GO TO 7850-EXIT.
 15873
 15874     IF W-1523-FATAL-ERROR
 15875         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 297
* EL131.cbl
 15876         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15877
 15878     IF W-1523-ERROR-CODE = 0191
 15879         MOVE ER-0803                TO  EMI-ERROR
 15880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15881
 15882 7850-EXIT.
 15883     EXIT.
 15884
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 298
* EL131.cbl
 15886 8000-CREATE-DMO-REC.
 15887     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 15888     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 15889     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 15890
 15891
 15892* EXEC CICS HANDLE CONDITION
 15893*         NOTFND   (8000-NOTE-NOT-FOUND)
 15894*    END-EXEC.
 15895*    MOVE '"$I                   ! G #00013350' TO DFHEIV0
 15896     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15898     MOVE X'4720233030303133333530' TO DFHEIV0(25:11)
 15899     CALL 'kxdfhei1' USING DFHEIV0
 15900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15901
 15902
 15903
 15904* EXEC CICS READ
 15905*         DATASET(NOTE-FILE-ID)
 15906*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 15907*         RIDFLD (NOTE-KEY)
 15908*    END-EXEC.
 15909*    MOVE '&"S        E          (   #00013354' TO DFHEIV0
 15910     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15912     MOVE X'2020233030303133333534' TO DFHEIV0(25:11)
 15913     CALL 'kxdfhei1' USING DFHEIV0,
 15914           NOTE-FILE-ID,
 15915           DFHEIV20,
 15916           DFHEIV99,
 15917           NOTE-KEY,
 15918           DFHEIV99,
 15919           DFHEIV99,
 15920           DFHEIV99
 15921     SET ADDRESS OF CERTIFICATE-NOTE TO
 15922         DFHEIV20
 15923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15924
 15925
 15926     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 15927     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 15928     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 15929
 15930     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 15931         MOVE 'CC'               TO DCT-PRODUCT-CODE
 15932     ELSE
 15933         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 15934
 15935     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 15936     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 15937
 15938
 15939* EXEC CICS LINK
 15940*        PROGRAM    ('DLO006')
 15941*        COMMAREA   (DCT-COMMUNICATION-AREA)
 15942*        LENGTH     (WS-DCT-LENGTH)
 15943*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 299
* EL131.cbl
 15944     MOVE 'DLO006' TO DFHEIV1
 15945*    MOVE '."C                   (   #00013372' TO DFHEIV0
 15946     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15948     MOVE X'2020233030303133333732' TO DFHEIV0(25:11)
 15949     CALL 'kxdfhei1' USING DFHEIV0,
 15950           DFHEIV1,
 15951           DCT-COMMUNICATION-AREA,
 15952           WS-DCT-LENGTH,
 15953           DFHEIV99,
 15954           DFHEIV99,
 15955           DFHEIV99,
 15956           DFHEIV99
 15957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15958
 15959
 15960     IF  DCT-RETURN-CODE = 'OK'
 15961         GO TO 8000-CONT.
 15962
 15963     IF DCT-RETURN-CODE = '01' OR '02'
 15964         GO TO 8000-EXIT.
 15965
 15966     IF DCT-RETURN-CODE = '03'
 15967         MOVE ER-0951            TO EMI-ERROR
 15968         MOVE -1                 TO MAINTL
 15969         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15970         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15971         GO TO 8110-SEND-DATA.
 15972
 15973     IF DCT-RETURN-CODE = '04'
 15974         MOVE ER-0946            TO EMI-ERROR
 15975         MOVE -1                 TO MAINTL
 15976         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15977         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15978         GO TO 8110-SEND-DATA.
 15979
 15980     IF DCT-RETURN-CODE = '05'
 15981         MOVE ER-0947            TO EMI-ERROR
 15982         MOVE -1                 TO MAINTL
 15983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15984         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15985         GO TO 8110-SEND-DATA.
 15986
 15987     IF DCT-RETURN-CODE = '06'
 15988         MOVE ER-0921            TO EMI-ERROR
 15989         MOVE -1                 TO MAINTL
 15990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15991         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15992         GO TO 8110-SEND-DATA.
 15993
 15994     IF DCT-RETURN-CODE = '07'
 15995         MOVE ER-0919            TO EMI-ERROR
 15996         MOVE -1                 TO MAINTL
 15997         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15998         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15999         GO TO 8110-SEND-DATA.
 16000
 16001     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 300
* EL131.cbl
 16002         MOVE ER-0948            TO EMI-ERROR
 16003         MOVE -1                 TO MAINTL
 16004         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16005         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16006         GO TO 8110-SEND-DATA.
 16007
 16008     IF DCT-RETURN-CODE = 'N1'
 16009         MOVE ER-0950            TO EMI-ERROR
 16010         MOVE -1                 TO MAINTL
 16011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16012         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16013         GO TO 8110-SEND-DATA.
 16014
 16015     IF DCT-RETURN-CODE = 'E1'
 16016         MOVE ER-0974            TO EMI-ERROR
 16017         MOVE -1                 TO MAINTL
 16018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16019         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16020         GO TO 8110-SEND-DATA.
 16021
 16022     IF DCT-RETURN-CODE = 'E2'
 16023         MOVE ER-0975            TO EMI-ERROR
 16024         MOVE -1                 TO MAINTL
 16025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16026         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16027         GO TO 8110-SEND-DATA.
 16028
 16029     IF DCT-RETURN-CODE NOT = 'OK'
 16030         MOVE ER-0949            TO EMI-ERROR
 16031         MOVE -1                 TO MAINTL
 16032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16033         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16034         GO TO 8110-SEND-DATA.
 16035
 16036 8000-CONT.
 16037
 16038     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16039     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16040     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16041     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16042     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16043     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16044     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16045     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16046
 16047     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16048     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16049     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16050     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16051     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16052
 16053     IF STATUSI = 'OPEN' OR 'O'
 16054         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16055      ELSE
 16056         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16057
 16058     IF STATUSI = 'OPEN' OR 'O'
 16059        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 301
* EL131.cbl
 16060         MOVE '1'                TO DM-CLAIM-STATUS
 16061      ELSE
 16062         MOVE '2'                TO DM-CLAIM-STATUS.
 16063
 16064     IF STATUSI = 'CLOSED' OR 'C'
 16065        IF NOT FINAL-PAID
 16066         MOVE '3'                TO DM-CLAIM-STATUS
 16067      ELSE
 16068         MOVE '4'                TO DM-CLAIM-STATUS.
 16069
 16070     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16071
 16072
 16073* EXEC CICS LINK
 16074*        PROGRAM    ('DLO025')
 16075*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16076*        LENGTH     (WS-DMO-LENGTH)
 16077*    END-EXEC.
 16078     MOVE 'DLO025' TO DFHEIV1
 16079*    MOVE '."C                   (   #00013490' TO DFHEIV0
 16080     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16081     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16082     MOVE X'2020233030303133343930' TO DFHEIV0(25:11)
 16083     CALL 'kxdfhei1' USING DFHEIV0,
 16084           DFHEIV1,
 16085           DMO-COMMUNICATION-AREA,
 16086           WS-DMO-LENGTH,
 16087           DFHEIV99,
 16088           DFHEIV99,
 16089           DFHEIV99,
 16090           DFHEIV99
 16091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16092
 16093
 16094     IF  DM-RETURN-CODE = 'OK'
 16095         GO TO 8000-EXIT.
 16096
 16097     IF DM-RETURN-CODE = '01'
 16098         MOVE ER-8051            TO EMI-ERROR
 16099         MOVE -1                 TO MAINTL
 16100         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16101         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16102         GO TO 8110-SEND-DATA.
 16103
 16104     IF DM-RETURN-CODE = '02'
 16105         MOVE ER-8052            TO EMI-ERROR
 16106         MOVE -1                 TO MAINTL
 16107         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16108         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16109         GO TO 8110-SEND-DATA.
 16110
 16111     IF DM-RETURN-CODE = '03'
 16112         MOVE ER-8053            TO EMI-ERROR
 16113         MOVE -1                 TO MAINTL
 16114         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16115         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16116         GO TO 8110-SEND-DATA.
 16117
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 302
* EL131.cbl
 16118     IF DM-RETURN-CODE = '04'
 16119         MOVE ER-8054            TO EMI-ERROR
 16120         MOVE -1                 TO MAINTL
 16121         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16122         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16123         GO TO 8110-SEND-DATA.
 16124
 16125     IF DM-RETURN-CODE = '05'
 16126         MOVE ER-8055            TO EMI-ERROR
 16127         MOVE -1                 TO MAINTL
 16128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16129         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16130         GO TO 8110-SEND-DATA.
 16131
 16132     IF DM-RETURN-CODE = '06'
 16133         MOVE ER-8056            TO EMI-ERROR
 16134         MOVE -1                 TO MAINTL
 16135         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16136         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16137         GO TO 8110-SEND-DATA.
 16138
 16139     IF DM-RETURN-CODE = '07'
 16140         MOVE ER-8057            TO EMI-ERROR
 16141         MOVE -1                 TO MAINTL
 16142         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16143         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16144         GO TO 8110-SEND-DATA.
 16145
 16146     IF DM-RETURN-CODE = '08'
 16147         MOVE ER-8058            TO EMI-ERROR
 16148         MOVE -1                 TO MAINTL
 16149         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16150         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16151         GO TO 8110-SEND-DATA.
 16152
 16153     IF DM-RETURN-CODE = '09'
 16154         MOVE ER-8059            TO EMI-ERROR
 16155         MOVE -1                 TO MAINTL
 16156         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16157         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16158         GO TO 8110-SEND-DATA.
 16159
 16160     IF DM-RETURN-CODE = '10'
 16161         MOVE ER-8060            TO EMI-ERROR
 16162         MOVE -1                 TO MAINTL
 16163         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16164         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16165         GO TO 8110-SEND-DATA.
 16166
 16167     IF DM-RETURN-CODE = '11'
 16168         MOVE ER-8061            TO EMI-ERROR
 16169         MOVE -1                 TO MAINTL
 16170         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16171         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16172         GO TO 8110-SEND-DATA.
 16173
 16174     IF DM-RETURN-CODE = '12'
 16175         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 303
* EL131.cbl
 16176         MOVE -1                 TO MAINTL
 16177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16178         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16179         GO TO 8110-SEND-DATA.
 16180
 16181     IF DM-RETURN-CODE = '13'
 16182         MOVE ER-8063            TO EMI-ERROR
 16183         MOVE -1                 TO MAINTL
 16184         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16185         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16186         GO TO 8110-SEND-DATA.
 16187
 16188     IF DM-RETURN-CODE = '14'
 16189         MOVE ER-8064            TO EMI-ERROR
 16190         MOVE -1                 TO MAINTL
 16191         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16192         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16193         GO TO 8110-SEND-DATA.
 16194
 16195     IF DM-RETURN-CODE = '15'
 16196         MOVE ER-8065            TO EMI-ERROR
 16197         MOVE -1                 TO MAINTL
 16198         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16199         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16200         GO TO 8110-SEND-DATA.
 16201
 16202     IF DM-RETURN-CODE = '16'
 16203         MOVE ER-8154            TO EMI-ERROR
 16204         MOVE -1                 TO MAINTL
 16205         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16206         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16207         GO TO 8110-SEND-DATA.
 16208
 16209     IF DM-RETURN-CODE = '17'
 16210         MOVE ER-8155            TO EMI-ERROR
 16211         MOVE -1                 TO MAINTL
 16212         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16213         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16214         GO TO 8110-SEND-DATA.
 16215
 16216     IF DM-RETURN-CODE = 'N1'
 16217         MOVE ER-8152            TO EMI-ERROR
 16218         MOVE -1                 TO MAINTL
 16219         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16220         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16221         GO TO 8110-SEND-DATA.
 16222
 16223     IF DM-RETURN-CODE = 'E1'
 16224         MOVE ER-8153            TO EMI-ERROR
 16225         MOVE -1                 TO MAINTL
 16226         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16227         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16228         GO TO 8110-SEND-DATA.
 16229
 16230     MOVE ER-8066                TO EMI-ERROR.
 16231     MOVE -1                     TO MAINTL.
 16232     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16233     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 304
* EL131.cbl
 16234     GO TO 8110-SEND-DATA.
 16235
 16236 8000-NOTE-NOT-FOUND.
 16237
 16238* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16239*    MOVE '6"R                   !   #00013639' TO DFHEIV0
 16240     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16242     MOVE X'2020233030303133363339' TO DFHEIV0(25:11)
 16243     CALL 'kxdfhei1' USING DFHEIV0
 16244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16245
 16246     MOVE ER-0954                TO EMI-ERROR.
 16247     MOVE -1                     TO MAINTL.
 16248     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16249     GO TO 8110-SEND-DATA.
 16250
 16251 8000-EXIT.
 16252     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 305
* EL131.cbl
 16254 8050-FORMAT-LAST-NAME-1ST.
 16255*****************************************************************
 16256*             M O V E   N A M E   R O U T I N E                 *
 16257*                                                               *
 16258*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16259*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16260*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16261*                                                               *
 16262*                  FIELD               VALUE                    *
 16263*                  -----               -----                    *
 16264*           W-NAME-LAST    (CL15)      SMITH                    *
 16265*           W-NAME-FIRST   (CL15)      JOHN                     *
 16266*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16267*                                                               *
 16268*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16269*                SMITH, JOHN ALLEN                              *
 16270*                     OR                                        *
 16271*                SMITH, JOHN A.                                 *
 16272*                                                               *
 16273*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16274*     COPYBOOK, ELCNWA.                                         *
 16275*****************************************************************.
 16276
 16277     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16278     MOVE ZERO                   TO WS-NAME-SW.
 16279     SET NWA-INDEX               TO +1.
 16280
 16281     IF W-NAME-LAST   = SPACES  AND
 16282        W-NAME-MIDDLE = SPACES
 16283          MOVE +1                TO WS-NAME-SW.
 16284
 16285     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16286     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16287
 16288     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16289     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16290
 16291     SET NWA-INDEX UP BY +1.
 16292
 16293     IF W-NAME-MIDDLE NOT = SPACES
 16294         IF W-NAME-MIDDLE-2 = SPACES
 16295             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16296             SET NWA-INDEX UP BY +1
 16297             MOVE '.'            TO WS-NW (NWA-INDEX)
 16298             SET NWA-INDEX UP BY +2
 16299         ELSE
 16300             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16301             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16302
 16303 8050-EXIT.
 16304     EXIT.
 16305
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 306
* EL131.cbl
 16307 8060-MOVE-NAME.
 16308     IF WS-NAME-SW GREATER THAN +1
 16309         GO TO 8060-EXIT.
 16310
 16311     IF WS-NAME-WORK2 = SPACES
 16312         GO TO 8060-EXIT.
 16313
 16314     SET NWA-INDEX2            TO +1.
 16315     SET NWA-INDEX3            TO +2.
 16316
 16317 8060-MOVE-NAME-CYCLE.
 16318     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16319
 16320     IF NWA-INDEX LESS THAN +30
 16321         SET NWA-INDEX UP BY +1
 16322     ELSE
 16323         ADD +2 TO  WS-NAME-SW
 16324         GO TO 8060-EXIT.
 16325
 16326     IF NWA-INDEX2 LESS THAN +20
 16327         SET NWA-INDEX3 UP BY +1
 16328         SET NWA-INDEX2 UP BY +1.
 16329
 16330     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 16331        WS-NW2 (NWA-INDEX3) = SPACES
 16332         IF WS-NAME-SW = ZERO
 16333             MOVE ','            TO WS-NW (NWA-INDEX)
 16334             SET NWA-INDEX UP BY +2
 16335             MOVE +1             TO WS-NAME-SW
 16336             GO TO 8060-EXIT
 16337         ELSE
 16338             GO TO 8060-EXIT.
 16339
 16340     GO TO 8060-MOVE-NAME-CYCLE.
 16341
 16342 8060-EXIT.
 16343     EXIT.
 16344
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 307
* EL131.cbl
 16346
 16347 8070-UNLOCK-CLAIM-MSTR.
 16348
 16349* EXEC CICS UNLOCK
 16350*        DATASET   (CLMS-FILE-ID)
 16351*    END-EXEC.
 16352*    MOVE '&*                    #   #00013742' TO DFHEIV0
 16353     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16354     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16355     MOVE X'2020233030303133373432' TO DFHEIV0(25:11)
 16356     CALL 'kxdfhei1' USING DFHEIV0,
 16357           CLMS-FILE-ID,
 16358           DFHEIV99
 16359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16360
 16361
 16362 8070-EXIT.
 16363      EXIT.
 16364
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 308
* EL131.cbl
 16366 8100-SEND-MAP.
 16367     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16368
 16369     move al-uanon               to accswa
 16370     IF NOT PI-NO-CARRIER-SECURITY
 16371        MOVE AL-SANOF            TO CERTCARA.
 16372     IF NOT PI-NO-ACCOUNT-SECURITY
 16373        MOVE AL-SANOF            TO CERTACTA.
 16374
 16375     IF PI-PROCESSOR-ID = 'LGXX'
 16376        MOVE AL-UANON            TO CCNOA.
 16377
 16378     IF PI-COMPANY-ID = 'DMD'
 16379        NEXT SENTENCE
 16380     ELSE
 16381        MOVE AL-SADOF            TO PFKEY6A.
 16382
 16383     IF PI-USES-PAID-TO
 16384        MOVE 'PAID TO  :' TO PTHRHDGO.
 16385
 16386
 16387* EXEC CICS SEND
 16388*         MAP     ('EL131A')
 16389*         MAPSET  ('EL131S')
 16390*         ERASE
 16391*         FREEKB
 16392*         CURSOR
 16393*    END-EXEC.
 16394     MOVE 'EL131A' TO DFHEIV1
 16395     MOVE -1
 16396       TO DFHEIV11
 16397     MOVE 'EL131S' TO DFHEIV2
 16398*    MOVE '8$     CT  E F  H     ,   #00013770' TO DFHEIV0
 16399     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16400     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16401     MOVE X'2020233030303133373730' TO DFHEIV0(25:11)
 16402     CALL 'kxdfhei1' USING DFHEIV0,
 16403           DFHEIV1,
 16404           EL131AO,
 16405           DFHEIV99,
 16406           DFHEIV2,
 16407           DFHEIV99,
 16408           DFHEIV99,
 16409           DFHEIV99,
 16410           DFHEIV11,
 16411           DFHEIV99,
 16412           DFHEIV99,
 16413           DFHEIV99
 16414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16415
 16416
 16417     GO TO 9000-RETURN-TRANS.
 16418
 16419 8110-SEND-DATA.
 16420     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16421
 16422     IF PI-USES-PAID-TO
 16423        MOVE 'PAID TO  :' TO PTHRHDGO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 309
* EL131.cbl
 16424
 16425     IF PI-PROCESSOR-ID = 'LGXX'
 16426        MOVE AL-UANON            TO CCNOA.
 16427
 16428     IF PI-COMPANY-ID = 'DMD'
 16429        NEXT SENTENCE
 16430     ELSE
 16431        MOVE AL-SADOF            TO PFKEY6A.
 16432
 16433
 16434* EXEC CICS SEND
 16435*         MAP      ('EL131A')
 16436*         MAPSET   ('EL131S')
 16437*         DATAONLY
 16438*         FREEKB
 16439*         CURSOR
 16440*    END-EXEC.
 16441     MOVE 'EL131A' TO DFHEIV1
 16442     MOVE -1
 16443       TO DFHEIV11
 16444     MOVE 'EL131S' TO DFHEIV2
 16445*    MOVE '8$D    CT    F  H     ,   #00013794' TO DFHEIV0
 16446     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16447     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16448     MOVE X'2020233030303133373934' TO DFHEIV0(25:11)
 16449     CALL 'kxdfhei1' USING DFHEIV0,
 16450           DFHEIV1,
 16451           EL131AO,
 16452           DFHEIV99,
 16453           DFHEIV2,
 16454           DFHEIV99,
 16455           DFHEIV99,
 16456           DFHEIV99,
 16457           DFHEIV11,
 16458           DFHEIV99,
 16459           DFHEIV99,
 16460           DFHEIV99
 16461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16462
 16463
 16464     GO TO 9000-RETURN-TRANS.
 16465
 16466 8120-FORMAT-TIME-DATE.
 16467     perform 8140-check-for-prev-errors
 16468                                 thru 8140-exit
 16469     IF SKIP-ATTRIBUTE = 'Y'
 16470        MOVE SPACES              TO SKIP-ATTRIBUTE
 16471        MOVE ER-0598             TO EMI-ERROR
 16472        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16473        GO TO 8125-SKIP-ATTRIBUTE.
 16474
 16475*     IF PI-COMPANY-ID = 'DMD'
 16476      IF PI-PROCESSOR-ID <> 'EMER'
 16477         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 16478                                    CERTCARA  CERTGRPA CERTA SUFXA
 16479
 16480     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 16481                                    ISSAGEA   JNTLNMEA  JNTFNMEA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 310
* EL131.cbl
 16482                                    JNTINITA  JNTAGEA   APRA
 16483                                    LCVCDA    LCVOTRMA  LCVRTRMA
 16484                                    LCVBENEA  LCVFORMA  LCVCNDTA
 16485                                    LCVEXITA  LCVSTATA  LCVKINDA
 16486                                    ACVCDA    ACVOTRMA  ACVRTRMA
 16487                                    ACVBENEA  ACVFORMA  ACVCNDTA
 16488                                    ACVEXITA  ACVSTATA  ACVKINDA
 16489                                    PMTFREQA  INDGRPA   PREMTYPA
 16490                                    REINCDA   LCVRATEA  ACVRATEA
 16491                                    ADDONDTA.
 16492
 16493*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 16494*       IF PI-COMPANY-ID = 'DMD'
 16495*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 16496*                                   SUFXA
 16497*                                   PDAMTA    NODAYSA   NOPMTSA
 16498*                                   INCA      OCCA
 16499*          IF NOT SYSTEM-MODIFY-CAP
 16500*              MOVE AL-SANOF         TO PDTHRUA.
 16501
 16502     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 16503         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 16504
 16505 8125-SKIP-ATTRIBUTE.
 16506
 16507     MOVE SAVE-DATE              TO DATEO.
 16508
 16509* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 16510*    END-EXEC
 16511*    MOVE '0"A                   "   #00013846' TO DFHEIV0
 16512     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 16513     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 16514     MOVE X'2020233030303133383436' TO DFHEIV0(25:11)
 16515     CALL 'kxdfhei1' USING DFHEIV0,
 16516           LCP-CICS-TIME
 16517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16518
 16519* EXEC CICS FORMATTIME
 16520*              ABSTIME(LCP-CICS-TIME)
 16521*              TIME(LCP-TIME-OF-DAY-XX)
 16522*    END-EXEC
 16523*    MOVE 'j$(     (             #   #00013848' TO DFHEIV0
 16524     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 16525     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16526     MOVE X'2020233030303133383438' TO DFHEIV0(25:11)
 16527     CALL 'kxdfhei1' USING DFHEIV0,
 16528           LCP-CICS-TIME,
 16529           LCP-TIME-OF-DAY-XX
 16530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16531     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 16532     MOVE UN-HOURS               TO FOR-HOURS.
 16533     MOVE UN-MINUTES             TO FOR-MINUTES.
 16534     MOVE TIME-OUT               TO TIMEO.
 16535     MOVE PI-COMPANY-ID          TO COMPO.
 16536     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16537     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 16538     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16539     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 311
* EL131.cbl
 16540     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 16541
 16542 8130-EXIT.
 16543     EXIT.
 16544
 16545 8140-check-for-prev-errors.
 16546
 16547     MOVE PI-COMPANY-CD          TO trlr-company-cd
 16548     MOVE PI-CARRIER             TO trlr-carrier
 16549     MOVE PI-CLAIM-NO            TO trlr-claim-no
 16550     MOVE PI-CERT-NO             TO trlr-cert-no
 16551     MOVE +95                    TO TRLR-SEQ-NO
 16552
 16553
 16554* EXEC CICS READ
 16555*       DATASET  ('ELTRLR')
 16556*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16557*       RIDFLD   (TRLR-KEY)
 16558*       RESP     (WS-RESPONSE)
 16559*    END-EXEC
 16560     MOVE 'ELTRLR' TO DFHEIV1
 16561*    MOVE '&"S        E          (  N#00013874' TO DFHEIV0
 16562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16564     MOVE X'204E233030303133383734' TO DFHEIV0(25:11)
 16565     CALL 'kxdfhei1' USING DFHEIV0,
 16566           DFHEIV1,
 16567           DFHEIV20,
 16568           DFHEIV99,
 16569           TRLR-KEY,
 16570           DFHEIV99,
 16571           DFHEIV99,
 16572           DFHEIV99
 16573     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16574         DFHEIV20
 16575     MOVE EIBRESP  TO WS-RESPONSE
 16576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16577
 16578     if ws-resp-normal
 16579        perform varying s1 from +1 by +1 until
 16580           at-note-error-no (s1) = spaces
 16581           if at-note-error-no (s1) = '1652'
 16582              continue
 16583           else
 16584              move at-note-error-no (s1)
 16585                                 to emi-error
 16586              move -1 to maintl
 16587              if at-note-error-no (s1) = '1653'
 16588                 evaluate true
 16589                    when pi-claim-type = 'L'
 16590                       move '  LF  '
 16591                        to emi-claim-type
 16592                    when pi-claim-type = 'I'
 16593                       move '  IU  '
 16594                        to emi-claim-type
 16595                    WHEN PI-CLAIM-TYPE = 'F'
 16596                       MOVE '  FL  '
 16597                        TO EMI-CLAIM-TYPE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 312
* EL131.cbl
 16598                    when other
 16599                       move '  AH  '
 16600                        to emi-claim-type
 16601                 end-evaluate
 16602              end-if
 16603              PERFORM 9900-ERROR-FORMAT
 16604                                 THRU 9900-EXIT
 16605           end-if
 16606*          if at-note-error-no (s1) = '1653'
 16607*             perform varying emi-sub from 1 by 1 until
 16608*                emi-sub > 3
 16609*                if emi-error-number (emi-sub) = '1653'
 16610*                   evaluate true
 16611*                      when pi-claim-type = 'L'
 16612*                         move '  LF  '
 16613*                          to emi-claim-type
 16614*                      when pi-claim-type = 'I'
 16615*                         move '  IU  '
 16616*                          to emi-claim-type
 16617*                      when other
 16618*                         move '  AH  '
 16619*                          to emi-claim-type
 16620*                   end-evaluate
 16621*                end-if
 16622*             end-perform
 16623*          end-if
 16624        end-perform
 16625     else
 16626        display ' resp not normal ' ws-response ' '
 16627        trlr-key (2:19)
 16628     end-if
 16629
 16630     .
 16631 8140-exit.
 16632     exit.
 16633 8150-ENTERED-CLAIM-NOTFOUND.
 16634
 16635     MOVE ER-0204                TO EMI-ERROR.
 16636     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16637     MOVE -1                     TO MAINTL.
 16638     GO TO 8100-SEND-MAP.
 16639
 16640 8200-RETURN-PRIOR.
 16641     MOVE SPACE                  TO PI-RETURN-CD-1.
 16642     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16643     GO TO 9200-XCTL.
 16644
 16645 8300-GET-HELP.
 16646     MOVE XCTL-EL010             TO CALL-PGM.
 16647     GO TO 9200-XCTL.
 16648
 16649 8400-RETURN-MASTER.
 16650     MOVE SPACE                  TO PI-RETURN-CD-1.
 16651     MOVE XCTL-EL126             TO CALL-PGM.
 16652     GO TO 9200-XCTL.
 16653
 16654 8500-TRLR-MNT.
 16655     IF PI-RETURN-CD-1 = 'X'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 313
* EL131.cbl
 16656         MOVE ER-0311            TO EMI-ERROR
 16657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16658         MOVE -1                 TO MAINTL
 16659         GO TO 8110-SEND-DATA.
 16660
 16661
 16662* EXEC CICS WRITEQ TS
 16663*         QUEUE     (PI-KEY)
 16664*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16665*         LENGTH    (PI-COMM-LENGTH)
 16666*    END-EXEC.
 16667*    MOVE '*"                    ''   #00013964' TO DFHEIV0
 16668     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16669     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16670     MOVE X'2020233030303133393634' TO DFHEIV0(25:11)
 16671     CALL 'kxdfhei1' USING DFHEIV0,
 16672           PI-KEY,
 16673           PROGRAM-INTERFACE-BLOCK,
 16674           PI-COMM-LENGTH,
 16675           DFHEIV99,
 16676           DFHEIV99,
 16677           DFHEIV99
 16678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16679
 16680
 16681     MOVE XCTL-EL142             TO CALL-PGM.
 16682     GO TO 9200-XCTL.
 16683
 16684 8600-ADDR-MNT.
 16685     IF PI-RETURN-CD-1 = 'X'
 16686         MOVE ER-0311            TO EMI-ERROR
 16687         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16688         MOVE -1                 TO MAINTL
 16689         GO TO 8110-SEND-DATA.
 16690
 16691
 16692* EXEC CICS WRITEQ TS
 16693*         QUEUE     (PI-KEY)
 16694*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16695*         LENGTH    (PI-COMM-LENGTH)
 16696*    END-EXEC.
 16697*    MOVE '*"                    ''   #00013980' TO DFHEIV0
 16698     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16699     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16700     MOVE X'2020233030303133393830' TO DFHEIV0(25:11)
 16701     CALL 'kxdfhei1' USING DFHEIV0,
 16702           PI-KEY,
 16703           PROGRAM-INTERFACE-BLOCK,
 16704           PI-COMM-LENGTH,
 16705           DFHEIV99,
 16706           DFHEIV99,
 16707           DFHEIV99
 16708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16709
 16710
 16711     MOVE XCTL-EL141             TO CALL-PGM.
 16712     GO TO 9200-XCTL.
 16713
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 314
* EL131.cbl
 16714 8700-CERT-MNT.
 16715     IF PI-RETURN-CD-1 = 'X'
 16716         MOVE ER-7690            TO EMI-ERROR
 16717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16718         MOVE -1                 TO MAINTL
 16719         GO TO 8110-SEND-DATA.
 16720
 16721
 16722* EXEC CICS WRITEQ TS
 16723*         QUEUE     (PI-KEY)
 16724*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16725*         LENGTH    (PI-COMM-LENGTH)
 16726*    END-EXEC.
 16727*    MOVE '*"                    ''   #00013996' TO DFHEIV0
 16728     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16729     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16730     MOVE X'2020233030303133393936' TO DFHEIV0(25:11)
 16731     CALL 'kxdfhei1' USING DFHEIV0,
 16732           PI-KEY,
 16733           PROGRAM-INTERFACE-BLOCK,
 16734           PI-COMM-LENGTH,
 16735           DFHEIV99,
 16736           DFHEIV99,
 16737           DFHEIV99
 16738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16739
 16740
 16741     MOVE XCTL-EL1273            TO CALL-PGM.
 16742     GO TO 9200-XCTL.
 16743
 16744 8725-BENEFICIARY-MNT.
 16745     IF PI-RETURN-CD-1 = 'X'
 16746         MOVE ER-0311            TO EMI-ERROR
 16747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16748         MOVE -1                 TO MAINTL
 16749         GO TO 8110-SEND-DATA.
 16750
 16751
 16752* EXEC CICS WRITEQ TS
 16753*         QUEUE     (PI-KEY)
 16754*         FROM      (EL131AI)
 16755*         LENGTH    (MAP-LENGTH)
 16756*    END-EXEC.
 16757*    MOVE '*"                    ''   #00014012' TO DFHEIV0
 16758     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16760     MOVE X'2020233030303134303132' TO DFHEIV0(25:11)
 16761     CALL 'kxdfhei1' USING DFHEIV0,
 16762           PI-KEY,
 16763           EL131AI,
 16764           MAP-LENGTH,
 16765           DFHEIV99,
 16766           DFHEIV99,
 16767           DFHEIV99
 16768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16769
 16770
 16771
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 315
* EL131.cbl
 16772* EXEC CICS WRITEQ TS
 16773*         QUEUE     (PI-KEY)
 16774*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16775*         LENGTH    (PI-COMM-LENGTH)
 16776*    END-EXEC.
 16777*    MOVE '*"                    ''   #00014018' TO DFHEIV0
 16778     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16779     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16780     MOVE X'2020233030303134303138' TO DFHEIV0(25:11)
 16781     CALL 'kxdfhei1' USING DFHEIV0,
 16782           PI-KEY,
 16783           PROGRAM-INTERFACE-BLOCK,
 16784           PI-COMM-LENGTH,
 16785           DFHEIV99,
 16786           DFHEIV99,
 16787           DFHEIV99
 16788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16789
 16790
 16791     MOVE XCTL-EL114             TO CALL-PGM.
 16792     GO TO 9200-XCTL.
 16793
 16794 8750-DMD-CLM-FIX.
 16795
 16796* EXEC CICS WRITEQ TS
 16797*         QUEUE     (PI-KEY)
 16798*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16799*         LENGTH    (PI-COMM-LENGTH)
 16800*    END-EXEC.
 16801*    MOVE '*"                    ''   #00014028' TO DFHEIV0
 16802     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16803     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16804     MOVE X'2020233030303134303238' TO DFHEIV0(25:11)
 16805     CALL 'kxdfhei1' USING DFHEIV0,
 16806           PI-KEY,
 16807           PROGRAM-INTERFACE-BLOCK,
 16808           PI-COMM-LENGTH,
 16809           DFHEIV99,
 16810           DFHEIV99,
 16811           DFHEIV99
 16812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16813
 16814
 16815     MOVE XCTL-EL400DMD          TO CALL-PGM.
 16816     GO TO 9200-XCTL.
 16817
 16818 8800-UNAUTHORIZED-ACCESS.
 16819     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16820     GO TO 8990-SEND-TEXT.
 16821
 16822 8810-PF23-ENTERED.
 16823     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 16824     MOVE XCTL-EL005             TO CALL-PGM.
 16825     GO TO 9200-XCTL.
 16826
 16827 8820-XCTL-ERROR.
 16828
 16829* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 316
* EL131.cbl
 16830*        PGMIDERR (8990-SEND-TEXT)
 16831*    END-EXEC.
 16832*    MOVE '"$L                   ! H #00014047' TO DFHEIV0
 16833     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16835     MOVE X'4820233030303134303437' TO DFHEIV0(25:11)
 16836     CALL 'kxdfhei1' USING DFHEIV0
 16837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16838
 16839
 16840     MOVE SPACE                 TO PI-ENTRY-CD-1.
 16841     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 16842     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 16843     MOVE XCTL-EL005            TO CALL-PGM.
 16844     GO TO 9200-XCTL.
 16845
 16846 8990-SEND-TEXT.
 16847
 16848* EXEC CICS SEND TEXT
 16849*         FROM      (LOGOFF-TEXT)
 16850*         LENGTH    (LOGOFF-LENGTH)
 16851*         ERASE
 16852*         FREEKB
 16853*    END-EXEC.
 16854*    MOVE '8&      T  E F  H   F -   #00014058' TO DFHEIV0
 16855     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16856     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16857     MOVE X'2020233030303134303538' TO DFHEIV0(25:11)
 16858     CALL 'kxdfhei1' USING DFHEIV0,
 16859           LOGOFF-TEXT,
 16860           LOGOFF-LENGTH,
 16861           DFHEIV99,
 16862           DFHEIV99,
 16863           DFHEIV99,
 16864           DFHEIV99,
 16865           DFHEIV99,
 16866           DFHEIV99,
 16867           DFHEIV99,
 16868           DFHEIV99,
 16869           DFHEIV99,
 16870           DFHEIV99
 16871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16872
 16873
 16874     GO TO 9100-RETURN-CICS.
 16875
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 317
* EL131.cbl
 16877 9000-RETURN-TRANS.
 16878
 16879* EXEC CICS RETURN
 16880*         TRANSID   (TRANS-ID)
 16881*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16882*         LENGTH    (PI-COMM-LENGTH)
 16883*    END-EXEC.
 16884*    MOVE '.(CT                  ''   #00014069' TO DFHEIV0
 16885     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16887     MOVE X'2020233030303134303639' TO DFHEIV0(25:11)
 16888     CALL 'kxdfhei1' USING DFHEIV0,
 16889           TRANS-ID,
 16890           PROGRAM-INTERFACE-BLOCK,
 16891           PI-COMM-LENGTH,
 16892           DFHEIV99,
 16893           DFHEIV99,
 16894           DFHEIV99
 16895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16896
 16897
 16898
 16899* GOBACK.
 16900     MOVE '9%                    "   ' TO DFHEIV0
 16901     MOVE 'EL131' TO DFHEIV1
 16902     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16903     GOBACK.
 16904
 16905 9100-RETURN-CICS.
 16906
 16907* EXEC CICS RETURN
 16908*    END-EXEC.
 16909*    MOVE '.(                    ''   #00014078' TO DFHEIV0
 16910     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16911     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16912     MOVE X'2020233030303134303738' TO DFHEIV0(25:11)
 16913     CALL 'kxdfhei1' USING DFHEIV0,
 16914           DFHEIV99,
 16915           DFHEIV99,
 16916           DFHEIV99,
 16917           DFHEIV99,
 16918           DFHEIV99,
 16919           DFHEIV99
 16920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16921
 16922
 16923
 16924* GOBACK.
 16925     MOVE '9%                    "   ' TO DFHEIV0
 16926     MOVE 'EL131' TO DFHEIV1
 16927     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16928     GOBACK.
 16929
 16930 9200-XCTL.
 16931
 16932* EXEC CICS XCTL
 16933*         PROGRAM    (CALL-PGM)
 16934*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 318
* EL131.cbl
 16935*         LENGTH     (PI-COMM-LENGTH)
 16936*    END-EXEC.
 16937*    MOVE '.$C                   %   #00014084' TO DFHEIV0
 16938     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16939     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16940     MOVE X'2020233030303134303834' TO DFHEIV0(25:11)
 16941     CALL 'kxdfhei1' USING DFHEIV0,
 16942           CALL-PGM,
 16943           PROGRAM-INTERFACE-BLOCK,
 16944           PI-COMM-LENGTH,
 16945           DFHEIV99
 16946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16947
 16948
 16949 9700-LINK-RTRM-FILE-ID.
 16950
 16951* EXEC CICS LINK
 16952*        PROGRAM  (RTRM-FILE-ID)
 16953*        COMMAREA (CALCULATION-PASS-AREA)
 16954*        LENGTH   (CP-COMM-LENGTH)
 16955*    END-EXEC.
 16956*    MOVE '."C                   (   #00014091' TO DFHEIV0
 16957     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16959     MOVE X'2020233030303134303931' TO DFHEIV0(25:11)
 16960     CALL 'kxdfhei1' USING DFHEIV0,
 16961           RTRM-FILE-ID,
 16962           CALCULATION-PASS-AREA,
 16963           CP-COMM-LENGTH,
 16964           DFHEIV99,
 16965           DFHEIV99,
 16966           DFHEIV99,
 16967           DFHEIV99
 16968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16969
 16970
 16971 9700-EXIT.
 16972      EXIT.
 16973
 16974 9800-CONVERT-DATE.
 16975     MOVE SPACES TO DC-ERROR-CODE.
 16976
 16977* EXEC CICS LINK
 16978*         PROGRAM    (DATE-CONV)
 16979*         COMMAREA   (DATE-CONVERSION-DATA)
 16980*         LENGTH     (DC-COMM-LENGTH)
 16981*    END-EXEC.
 16982*    MOVE '."C                   (   #00014102' TO DFHEIV0
 16983     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16985     MOVE X'2020233030303134313032' TO DFHEIV0(25:11)
 16986     CALL 'kxdfhei1' USING DFHEIV0,
 16987           DATE-CONV,
 16988           DATE-CONVERSION-DATA,
 16989           DC-COMM-LENGTH,
 16990           DFHEIV99,
 16991           DFHEIV99,
 16992           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 319
* EL131.cbl
 16993           DFHEIV99
 16994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16995
 16996
 16997 9800-EXIT.
 16998     EXIT.
 16999
 17000 9900-ERROR-FORMAT.
 17001
 17002* EXEC CICS LINK
 17003*         PROGRAM    (XCTL-EL001)
 17004*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17005*         LENGTH     (EMI-COMM-LENGTH)
 17006*    END-EXEC.
 17007*    MOVE '."C                   (   #00014112' TO DFHEIV0
 17008     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17010     MOVE X'2020233030303134313132' TO DFHEIV0(25:11)
 17011     CALL 'kxdfhei1' USING DFHEIV0,
 17012           XCTL-EL001,
 17013           ERROR-MESSAGE-INTERFACE-BLOCK,
 17014           EMI-COMM-LENGTH,
 17015           DFHEIV99,
 17016           DFHEIV99,
 17017           DFHEIV99,
 17018           DFHEIV99
 17019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17020
 17021
 17022 9900-EXIT.
 17023     EXIT.
 17024
 17025 9990-ABEND.
 17026     MOVE DFHEIBLK               TO EMI-LINE1.
 17027
 17028* EXEC CICS LINK
 17029*         PROGRAM   (XCTL-EL004)
 17030*         COMMAREA  (EMI-LINE1)
 17031*         LENGTH    (72)
 17032*     END-EXEC.
 17033     MOVE 72
 17034       TO DFHEIV11
 17035*    MOVE '."C                   (   #00014123' TO DFHEIV0
 17036     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17038     MOVE X'2020233030303134313233' TO DFHEIV0(25:11)
 17039     CALL 'kxdfhei1' USING DFHEIV0,
 17040           XCTL-EL004,
 17041           EMI-LINE1,
 17042           DFHEIV11,
 17043           DFHEIV99,
 17044           DFHEIV99,
 17045           DFHEIV99,
 17046           DFHEIV99
 17047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17048
 17049
 17050     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 320
* EL131.cbl
 17051
 17052     GO TO 8110-SEND-DATA.
 17053
 17054 9995-SECURITY-VIOLATION.
 17055*           COPY ELCSCTP.
 17056******************************************************************
 17057*                                                                *
 17058*                            ELCSCTP                             *
 17059*                            VMOD=2.001                          *
 17060*                                                                *
 17061*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17062******************************************************************
 17063
 17064
 17065     MOVE EIBDATE          TO SM-JUL-DATE.
 17066     MOVE EIBTRMID         TO SM-TERMID.
 17067     MOVE THIS-PGM         TO SM-PGM.
 17068     MOVE EIBTIME          TO TIME-IN.
 17069     MOVE TIME-OUT         TO SM-TIME.
 17070     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17071
 17072
 17073* EXEC CICS LINK
 17074*         PROGRAM  ('EL003')
 17075*         COMMAREA (SECURITY-MESSAGE)
 17076*         LENGTH   (80)
 17077*    END-EXEC.
 17078     MOVE 'EL003' TO DFHEIV1
 17079     MOVE 80
 17080       TO DFHEIV11
 17081*    MOVE '."C                   (   #00014151' TO DFHEIV0
 17082     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17084     MOVE X'2020233030303134313531' TO DFHEIV0(25:11)
 17085     CALL 'kxdfhei1' USING DFHEIV0,
 17086           DFHEIV1,
 17087           SECURITY-MESSAGE,
 17088           DFHEIV11,
 17089           DFHEIV99,
 17090           DFHEIV99,
 17091           DFHEIV99,
 17092           DFHEIV99
 17093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17094
 17095
 17096******************************************************************
 17097
 17098
 17099
 17100 9999-DFHBACK SECTION.
 17101     MOVE '9%                    "   ' TO DFHEIV0
 17102     MOVE 'EL131' TO DFHEIV1
 17103     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17104     GOBACK.
 17105 9999-DFHEXIT.
 17106     IF DFHEIGDJ EQUAL 0001
 17107         NEXT SENTENCE
 17108     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 321
* EL131.cbl
 17109         GO TO 8820-XCTL-ERROR,
 17110               8150-ENTERED-CLAIM-NOTFOUND,
 17111               9990-ABEND
 17112         DEPENDING ON DFHEIGDI
 17113     ELSE IF DFHEIGDJ EQUAL 3
 17114         GO TO 0130-TS-ERROR,
 17115               0130-TS-ERROR
 17116         DEPENDING ON DFHEIGDI
 17117     ELSE IF DFHEIGDJ EQUAL 4
 17118         GO TO 0600-CONTINUE-NAME-UPDATE
 17119         DEPENDING ON DFHEIGDI
 17120     ELSE IF DFHEIGDJ EQUAL 5
 17121         GO TO 1004-BENE-NOT-FOUND
 17122         DEPENDING ON DFHEIGDI
 17123     ELSE IF DFHEIGDJ EQUAL 6
 17124         GO TO 1120-CNTL-NOTFND
 17125         DEPENDING ON DFHEIGDI
 17126     ELSE IF DFHEIGDJ EQUAL 7
 17127         GO TO 1150-NOTOPEN-ERROR,
 17128               1150-EXIT
 17129         DEPENDING ON DFHEIGDI
 17130     ELSE IF DFHEIGDJ EQUAL 8
 17131         GO TO 1490-STATE-NOTFND
 17132         DEPENDING ON DFHEIGDI
 17133     ELSE IF DFHEIGDJ EQUAL 9
 17134         GO TO 1500-CARR-NOTFND
 17135         DEPENDING ON DFHEIGDI
 17136     ELSE IF DFHEIGDJ EQUAL 10
 17137         GO TO 1620-ACCT-NOTFND
 17138         DEPENDING ON DFHEIGDI
 17139     ELSE IF DFHEIGDJ EQUAL 11
 17140         GO TO 2020-EXIT
 17141         DEPENDING ON DFHEIGDI
 17142     ELSE IF DFHEIGDJ EQUAL 12
 17143         GO TO 2030-EXIT
 17144         DEPENDING ON DFHEIGDI
 17145     ELSE IF DFHEIGDJ EQUAL 13
 17146         GO TO 2040-EXIT
 17147         DEPENDING ON DFHEIGDI
 17148     ELSE IF DFHEIGDJ EQUAL 14
 17149         GO TO 2050-EXIT
 17150         DEPENDING ON DFHEIGDI
 17151     ELSE IF DFHEIGDJ EQUAL 15
 17152         GO TO 2060-CERT-NOTFND
 17153         DEPENDING ON DFHEIGDI
 17154     ELSE IF DFHEIGDJ EQUAL 16
 17155         GO TO 2060-DUPKEY
 17156         DEPENDING ON DFHEIGDI
 17157     ELSE IF DFHEIGDJ EQUAL 17
 17158         GO TO 2070-NOT-FOUND
 17159         DEPENDING ON DFHEIGDI
 17160     ELSE IF DFHEIGDJ EQUAL 18
 17161         GO TO 2070-EXIT
 17162         DEPENDING ON DFHEIGDI
 17163     ELSE IF DFHEIGDJ EQUAL 19
 17164         GO TO 2080-EXIT
 17165         DEPENDING ON DFHEIGDI
 17166     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 322
* EL131.cbl
 17167         GO TO 2400-TRLR-NOTFND,
 17168               2410-EXIT
 17169         DEPENDING ON DFHEIGDI
 17170     ELSE IF DFHEIGDJ EQUAL 21
 17171         GO TO 2425-NINETY-NOTFND,
 17172               2425-NINETY-NOTFND
 17173         DEPENDING ON DFHEIGDI
 17174     ELSE IF DFHEIGDJ EQUAL 22
 17175         GO TO 2430-EXIT,
 17176               2440-EXIT
 17177         DEPENDING ON DFHEIGDI
 17178     ELSE IF DFHEIGDJ EQUAL 23
 17179         GO TO 2440-EXIT
 17180         DEPENDING ON DFHEIGDI
 17181     ELSE IF DFHEIGDJ EQUAL 24
 17182         GO TO 2460-EXIT
 17183         DEPENDING ON DFHEIGDI
 17184     ELSE IF DFHEIGDJ EQUAL 25
 17185         GO TO 2475-EXIT
 17186         DEPENDING ON DFHEIGDI
 17187     ELSE IF DFHEIGDJ EQUAL 26
 17188         GO TO 2650-EXIT
 17189         DEPENDING ON DFHEIGDI
 17190     ELSE IF DFHEIGDJ EQUAL 27
 17191         GO TO 2800-EXIT,
 17192               2800-EXIT
 17193         DEPENDING ON DFHEIGDI
 17194     ELSE IF DFHEIGDJ EQUAL 28
 17195         GO TO 3010-DEL-ACTQ,
 17196               3040-EXIT
 17197         DEPENDING ON DFHEIGDI
 17198     ELSE IF DFHEIGDJ EQUAL 29
 17199         GO TO 3010-NO-ACTIVITY,
 17200               3050-EXIT
 17201         DEPENDING ON DFHEIGDI
 17202     ELSE IF DFHEIGDJ EQUAL 30
 17203         GO TO 3010-CERT-NOT-FOUND
 17204         DEPENDING ON DFHEIGDI
 17205     ELSE IF DFHEIGDJ EQUAL 31
 17206         GO TO 3020-EXIT
 17207         DEPENDING ON DFHEIGDI
 17208     ELSE IF DFHEIGDJ EQUAL 32
 17209         GO TO 3060-EXIT,
 17210               3060-EXIT
 17211         DEPENDING ON DFHEIGDI
 17212     ELSE IF DFHEIGDJ EQUAL 33
 17213         GO TO 5000-TRLR-NOT-FOUND
 17214         DEPENDING ON DFHEIGDI
 17215     ELSE IF DFHEIGDJ EQUAL 34
 17216         GO TO 5000-CERT-NOT-FOUND
 17217         DEPENDING ON DFHEIGDI
 17218     ELSE IF DFHEIGDJ EQUAL 35
 17219         GO TO 7630-END-BROWSE
 17220         DEPENDING ON DFHEIGDI
 17221     ELSE IF DFHEIGDJ EQUAL 36
 17222         GO TO 7799-EXIT,
 17223               7799-EXIT
 17224         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 323
* EL131.cbl
 17225     ELSE IF DFHEIGDJ EQUAL 37
 17226         GO TO 7799-EXIT
 17227         DEPENDING ON DFHEIGDI
 17228     ELSE IF DFHEIGDJ EQUAL 38
 17229         GO TO 7800-NOT-FOUND
 17230         DEPENDING ON DFHEIGDI
 17231     ELSE IF DFHEIGDJ EQUAL 39
 17232         GO TO 8000-NOTE-NOT-FOUND
 17233         DEPENDING ON DFHEIGDI
 17234     ELSE IF DFHEIGDJ EQUAL 40
 17235         GO TO 8990-SEND-TEXT
 17236         DEPENDING ON DFHEIGDI.
 17237     MOVE '9%                    "   ' TO DFHEIV0
 17238     MOVE 'EL131' TO DFHEIV1
 17239     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17240     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13572     Code:       59550
